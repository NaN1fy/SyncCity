"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[4785],{89858:(X,C,s)=>{s.r(C),s.d(C,{DataTrailsPage:()=>L,default:()=>Q});var t=s(74848),f=s(96540),g=s(24180),H=s(64388),I=s(12131),m=s(80943),F=s(69444),i=s(32196),k=s(40845),p=s(67061),M=s(55852),N=s(94753),U=s(72724),v=s(10860),V=s(78369),$=s(29158),l=s(74764),y=s(4200),c=s(51080);function A(e){const{onSelect:a,onDelete:o,bookmark:r}=e,n=(0,k.of)(E),T=(0,f.useMemo)(()=>{let x=e.trail||r&&(0,l._r)().getTrailForBookmark(r);if(!x)return null;const z=m.jh.lookupVariable(y.Ao,x);if(!(z instanceof m.H9))return null;const W=r?.createdAt||x.state.createdAt;return{dsValue:(0,c.U4)(x),filters:z.state.filters,metric:x.state.metric,createdAt:W}},[e.trail,r]);if(!T)return null;const{dsValue:d,filters:h,metric:u,createdAt:R}=T;return(0,t.jsxs)(v.Z,{onClick:a,className:n.card,children:[(0,t.jsx)(v.Z.Heading,{children:(0,c.aO)(u)}),(0,t.jsx)("div",{className:n.description,children:(0,t.jsx)(p.B,{gap:1.5,wrap:"wrap",children:h.map(x=>(0,t.jsx)(V.v,{name:`${x.key}: ${x.value}`,colorIndex:12},x.key))})}),(0,t.jsx)(v.Z.Actions,{className:n.actions,children:(0,t.jsxs)(p.B,{gap:1,justifyContent:"space-between",grow:1,children:[(0,t.jsxs)("div",{className:n.secondary,children:[(0,t.jsx)("b",{children:"Datasource:"})," ",(0,c.nH)(d)]}),R&&(0,t.jsxs)("i",{className:n.secondary,children:[(0,t.jsx)("b",{children:"Created:"})," ",(0,U.LE)(R,{format:"LL"})]})]})}),o&&(0,t.jsx)(v.Z.SecondaryActions,{children:(0,t.jsx)($.K,{name:"trash-alt",className:n.secondary,tooltip:"Remove bookmark",onClick:o},"delete")})]})}function E(e){return{tag:(0,i.css)({maxWidth:"260px",overflow:"hidden",textOverflow:"ellipsis"}),card:(0,i.css)({padding:e.spacing(1)}),secondary:(0,i.css)({color:e.colors.text.secondary,fontSize:"12px"}),description:(0,i.css)({width:"100%",gridArea:"Description",margin:e.spacing(1,0,0),color:e.colors.text.secondary,lineHeight:e.typography.body.lineHeight}),actions:(0,i.css)({marginRight:e.spacing(1)})}}var j=s(40588);class P extends m.Bs{constructor(a){super(a),this.onNewMetricsTrail=()=>{const o=S(this),r=(0,c.ef)((0,c.hR)());(0,j.z)("exploration_started",{cause:"new_clicked"}),(0,l._r)().setRecentTrail(r),o.goToUrlForTrail(r)},this.onSelectRecentTrail=o=>{const r=S(this);(0,j.z)("exploration_started",{cause:"recent_clicked"}),(0,l._r)().setRecentTrail(o),r.goToUrlForTrail(o)},this.onSelectBookmark=o=>{const r=S(this);(0,j.z)("exploration_started",{cause:"bookmark_clicked"});const n=(0,l._r)().getTrailForBookmarkIndex(o);(0,l._r)().setRecentTrail(n),r.goToUrlForTrail(n)}}static{this.Component=({model:a})=>{const[o,r]=(0,f.useState)(Date.now()),n=(0,k.of)(Z),T=d=>{(0,l._r)().removeBookmark(d),(0,j.z)("bookmark_changed",{action:"deleted"}),r(Date.now())};if(!(0,l._r)().recent.length){const d=(0,c.ef)((0,c.hR)());return(0,t.jsx)(g.rd,{to:(0,c.xi)(d)})}return(0,t.jsxs)("div",{className:n.container,children:[(0,t.jsx)(p.B,{direction:"column",gap:1,alignItems:"start",children:(0,t.jsx)(M.$n,{icon:"plus",size:"md",variant:"primary",onClick:a.onNewMetricsTrail,children:"New metric exploration"})}),(0,t.jsxs)(p.B,{gap:5,children:[(0,t.jsxs)("div",{className:n.column,children:[(0,t.jsx)(N.E,{variant:"h4",children:"Recent metrics explorations"}),(0,t.jsx)("div",{className:n.trailList,children:(0,l._r)().recent.map((d,h)=>{const u=d.resolve();return(0,t.jsx)(A,{trail:u,onSelect:()=>a.onSelectRecentTrail(u)},(u.state.key||"")+h)})})]}),(0,t.jsx)("div",{className:n.verticalLine}),(0,t.jsxs)("div",{className:n.column,children:[(0,t.jsx)(N.E,{variant:"h4",children:"Bookmarks"}),(0,t.jsx)("div",{className:n.trailList,children:(0,l._r)().bookmarks.map((d,h)=>(0,t.jsx)(A,{bookmark:d,onSelect:()=>a.onSelectBookmark(h),onDelete:()=>T(h)},(0,l.yn)(d)))})]})]})]})}}}function S(e){return m.jh.getAncestor(e,B)}function Z(e){return{container:(0,i.css)({flexGrow:1,display:"flex",flexDirection:"column",gap:e.spacing(3)}),column:(0,i.css)({display:"flex",flexGrow:1,flexDirection:"column",gap:e.spacing(2)}),newTrail:(0,i.css)({height:"auto",justifyContent:"center",fontSize:e.typography.h5.fontSize}),trailCard:(0,i.css)({}),trailList:(0,i.css)({display:"flex",flexDirection:"column",gap:e.spacing(2)}),verticalLine:(0,i.css)({borderLeft:`1px solid ${e.colors.border.weak}`})}}var O=s(90623);class B extends m.Bs{constructor(a){super(a)}goToUrlForTrail(a){I.Ny.push((0,c.xi)(a)),this.setState({trail:a})}static{this.Component=({model:a})=>{const{trail:o,home:r}=a.useState();return(0,t.jsxs)(g.dO,{children:[(0,t.jsx)(g.qh,{exact:!0,path:y.QX,render:()=>(0,t.jsx)(F.Y,{navId:"explore/metrics",layout:H.k.Standard,renderTitle:()=>(0,t.jsx)(O.p,{}),subTitle:"",children:(0,t.jsx)(r.Component,{model:r})})}),(0,t.jsx)(g.qh,{exact:!0,path:y.km,render:()=>(0,t.jsx)(G,{trail:o})})]})}}}function G({trail:e}){const[a,o]=(0,f.useState)(!1);return(0,f.useEffect)(()=>{a||((0,l._r)().setRecentTrail(e),o(!0))},[e,a]),a?(0,t.jsx)(m.$L,{scene:e,children:(0,t.jsx)(e.Component,{model:e})}):null}let D;function K(){return D||(D=new B({trail:(0,c.ef)(),home:new P({})})),D}function L(){const e=K();return(0,t.jsx)(e.Component,{model:e})}const Q=L}}]);

//# sourceMappingURL=DataTrailsPage.7da4ba50494969eab6d6.js.map