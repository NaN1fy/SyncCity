"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[6562],{64047:(F,P,n)=>{n.d(P,{e:()=>h});var t=n(74848),u=n(55852);const h=({isCollapsed:g,onToggle:R,idControlled:v,className:p,text:O,size:y="xl",...B})=>(0,t.jsx)(u.$n,{type:"button",fill:"text",variant:"secondary","aria-expanded":!g,"aria-controls":v,className:p,icon:g?"angle-right":"angle-down",onClick:()=>R(!g),...B,children:O})},23896:(F,P,n)=>{n.d(P,{A:()=>h});var t=n(96540);function u({children:g,shouldWrap:R,wrap:v},p){return R?(0,t.cloneElement)(v(g)):g}const h=(0,t.forwardRef)(u)},10685:(F,P,n)=>{n.d(P,{S:()=>h});var t=n(74848),u=n(94753);const h=({content:g})=>(0,t.jsx)(u.E,{color:"primary",children:g})},88344:(F,P,n)=>{n.d(P,{z8:()=>Y,yz:()=>st,uO:()=>H});var t=n(74848),u=n(32196),h=n(2543),g=n(96540),R=n(47232),v=n(40845),p=n(67061),O=n(14578),y=n(94753),B=n(56034),j=n(8484),D=n(10685),W=n(38138),I=n(72109),S=n(55852),E=n(83122),e=n(23896),a=n(29554),s=n(19073),i=n(3704),c=n(90141),d=n(48205),o=n(26058),l=n(39938);const r=()=>(0,t.jsx)(l.E,{text:"Unused","aria-label":"unused",color:"orange",icon:"exclamation-triangle",tooltip:"This contact point is not used in any notification policy"}),m=f=>{const{name:_,disabled:T=!1,provisioned:C=!1,policies:L=[],onDelete:b}=f,G=(0,v.of)(x),[Q,$]=(0,s.L7)(s.QI.ExportContactPoint),[q,tt]=(0,s.L7)(s.QI.UpdateContactPoint),[J,nt]=(0,s.L7)(s.QI.UpdateContactPoint),[et,at]=(0,a.G)(),rt=L.length,it=rt>0,dt=L.some(ot=>ot.route.type!=="auto-generated"),X=q&&tt&&!C,lt=J&&nt&&!C&&!dt,w=[];Q&&w.push((0,t.jsxs)(g.Fragment,{children:[(0,t.jsx)(W.W.Item,{icon:"download-alt",label:"Export",ariaLabel:"export",disabled:!$,"data-testid":"export",onClick:()=>at(_)}),(0,t.jsx)(W.W.Divider,{})]},"export-contact-point")),J&&w.push((0,t.jsx)(e.A,{shouldWrap:!lt,wrap:ot=>(0,t.jsx)(B.m,{content:"Contact point is currently in use by one or more notification policies",placement:"top",children:(0,t.jsx)("span",{children:ot})}),children:(0,t.jsx)(W.W.Item,{label:"Delete",ariaLabel:"delete",icon:"trash-alt",destructive:!0,disabled:T||!lt,onClick:()=>b(_)})},"delete-contact-point"));const ut=(0,j.t)("alerting.contact-points.used-by","Used by {{ count }} notification policy",{count:rt});return(0,t.jsxs)("div",{className:G.headerWrapper,children:[(0,t.jsxs)(p.B,{direction:"row",alignItems:"center",gap:1,children:[(0,t.jsx)(p.B,{alignItems:"center",gap:1,children:(0,t.jsx)(y.E,{element:"h2",variant:"body",weight:"medium",children:_})}),it&&(0,t.jsx)(I.Y,{href:(0,i.c)("/alerting/routes",{contactPoint:_}),variant:"bodySmall",color:"primary",inline:!1,children:ut}),C&&(0,t.jsx)(d.rS,{}),!it&&(0,t.jsx)(r,{}),(0,t.jsx)(o.h,{}),(0,t.jsx)(S.z9,{tooltipPlacement:"top",tooltip:C?"Provisioned contact points cannot be edited in the UI":void 0,variant:"secondary",size:"sm",icon:X?"pen":"eye",type:"button",disabled:T,"aria-label":`${X?"edit":"view"}-action`,"data-testid":`${X?"edit":"view"}-action`,href:`/alerting/notifications/receivers/${encodeURIComponent(_)}/edit`,children:X?"Edit":"View"}),w.length>0&&(0,t.jsx)(E.m,{overlay:(0,t.jsx)(W.W,{children:w}),children:(0,t.jsx)(c.A,{})})]}),et]})},x=f=>({headerWrapper:(0,u.css)({background:`${f.colors.background.secondary}`,padding:`${f.spacing(1)} ${f.spacing(1.5)}`,borderBottom:`solid 1px ${f.colors.border.weak}`,borderTopLeftRadius:`${f.shape.radius.default}`,borderTopRightRadius:`${f.shape.radius.default}`})}),M={pagerduty:"PagerDuty",pushover:"Pushover",slack:"Slack",opsgenie:"OpsGenie",webhook:"Webhook",victorops:"VictorOps",wechat:"WeChat",discord:"Discord",webex:"Cisco Webex Teams",sns:"Amazon SNS",telegram:"Telegram",msteams:"Microsoft Teams"};var A=n(19645),K=n(55196);const V=({metadata:{icon:f,title:_,externalUrl:T,warning:C}})=>{const L=(0,v.of)(U);return(0,t.jsxs)(p.B,{alignItems:"center",gap:.5,children:[(0,t.jsxs)(p.B,{direction:"row",alignItems:"center",gap:.5,children:[C?(0,t.jsx)(B.m,{content:C,theme:"error",children:(0,t.jsx)(O.I,{name:"exclamation-triangle",className:L.warnIcon})}):(0,t.jsx)("img",{src:f,alt:_,height:"16px"}),(0,t.jsx)("span",{children:_})]}),T&&(0,t.jsx)(S.z9,{icon:"external-link-alt",href:T,target:"_blank",variant:"secondary",size:"sm"})]})},U=f=>({warnIcon:(0,u.css)({fill:f.colors.warning.text})});var z=n(79381),N=n(77141);const Y=({name:f,disabled:_=!1,provisioned:T=!1,receivers:C,policies:L=[],onDelete:b})=>{const G=(0,v.of)(k),Q=C.some($=>!!$[z.v4]);return(0,t.jsx)("div",{className:G.contactPointWrapper,"data-testid":"contact-point",children:(0,t.jsxs)(p.B,{direction:"column",gap:0,children:[(0,t.jsx)(m,{name:f,policies:L,provisioned:T,disabled:_,onDelete:b}),Q?(0,t.jsx)("div",{children:C.map(($,q)=>{const tt=$[z.v4],J=$[z.MX],nt=!$.disableResolveMessage,et=$[z.sW],at=J.name+q;return(0,t.jsx)(Z,{name:J.name,type:$.type,description:(0,N.aM)($),diagnostics:tt,pluginMetadata:et,sendingResolved:nt},at)})}):(0,t.jsx)("div",{className:G.integrationWrapper,children:(0,t.jsx)(st,{receivers:C})})]})})},Z=f=>{const{name:_,type:T,description:C,diagnostics:L,pluginMetadata:b,sendingResolved:G=!0}=f,Q=(0,v.of)(k),$=L!==void 0;return(0,t.jsx)("div",{className:Q.integrationWrapper,children:(0,t.jsxs)(p.B,{direction:"column",gap:.5,children:[(0,t.jsx)(H,{name:_,type:T,description:C,pluginMetadata:b}),$&&(0,t.jsx)(ct,{diagnostics:L,sendingResolved:G})]})})};function H(f){const{name:_,type:T,description:C,pluginMetadata:L}=f,b=A.M[T];return(0,t.jsxs)(p.B,{direction:"row",alignItems:"center",gap:1,children:[(0,t.jsxs)(p.B,{direction:"row",alignItems:"center",gap:.5,children:[b&&(0,t.jsx)(O.I,{name:b}),L?(0,t.jsx)(V,{metadata:L}):(0,t.jsx)(y.E,{variant:"body",color:"primary",children:_})]}),C&&(0,t.jsx)(y.E,{variant:"bodySmall",color:"secondary",children:C})]})}const st=({receivers:f})=>{const _=(0,h.groupBy)(f,T=>T.type);return(0,t.jsx)(p.B,{direction:"column",gap:0,children:(0,t.jsx)(p.B,{direction:"row",alignItems:"center",gap:1,children:Object.entries(_).map(([T,C],L)=>{const b=A.M[T],G=M[T]??(0,h.upperFirst)(T),Q=(0,h.size)(_)-1===L;return(0,t.jsxs)(g.Fragment,{children:[(0,t.jsxs)(p.B,{direction:"row",alignItems:"center",gap:.5,children:[b&&(0,t.jsx)(O.I,{name:b}),(0,t.jsxs)(y.E,{variant:"body",children:[G,C.length>1&&C.length]})]}),!Q&&"\u22C5"]},T)})})})},ct=({diagnostics:f,sendingResolved:_})=>{const T=(0,v.of)(k),C=!!f.lastNotifyAttemptError,L=(0,R.KQ)(f.lastNotifyAttempt),b=f.lastNotifyAttemptDuration,G=L.isValid();return(0,t.jsx)("div",{className:T.metadataRow,children:(0,t.jsx)(p.B,{direction:"row",gap:1,children:C?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(K.P,{color:"error",icon:"exclamation-circle",children:(0,t.jsx)(B.m,{content:f.lastNotifyAttemptError,children:(0,t.jsx)("span",{children:(0,t.jsx)(j.x6,{i18nKey:"alerting.contact-points.last-delivery-failed",children:"Last delivery attempt failed"})})})})}):(0,t.jsxs)(t.Fragment,{children:[G&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(K.P,{icon:"clock-nine",children:[(0,t.jsx)(j.x6,{i18nKey:"alerting.contact-points.last-delivery-attempt",children:"Last delivery attempt"}),(0,t.jsx)(B.m,{content:L.toLocaleString(),children:(0,t.jsx)("span",{children:(0,t.jsx)(y.E,{color:"primary",children:L.locale("en").fromNow()})})})]}),(0,t.jsx)(K.P,{icon:"stopwatch",children:(0,t.jsxs)(j.x6,{i18nKey:"alerting.contact-points.delivery-duration",children:["Last delivery took ",(0,t.jsx)(D.S,{content:b})]})})]}),!G&&(0,t.jsx)(K.P,{icon:"clock-nine",children:(0,t.jsx)(j.x6,{i18nKey:"alerting.contact-points.no-delivery-attempts",children:"No delivery attempts"})}),!_&&(0,t.jsx)(K.P,{icon:"info-circle",children:(0,t.jsxs)(j.x6,{i18nKey:"alerting.contact-points.only-firing",children:["Delivering ",(0,t.jsx)(y.E,{color:"primary",children:"only firing"})," notifications"]})})]})})})},k=f=>({contactPointWrapper:(0,u.css)({borderRadius:`${f.shape.radius.default}`,border:`solid 1px ${f.colors.border.weak}`,borderBottom:"none"}),integrationWrapper:(0,u.css)({position:"relative",background:`${f.colors.background.primary}`,padding:`${f.spacing(1)} ${f.spacing(1.5)}`,borderBottom:`solid 1px ${f.colors.border.weak}`}),metadataRow:(0,u.css)({borderBottomLeftRadius:`${f.shape.radius.default}`,borderBottomRightRadius:`${f.shape.radius.default}`})})},79381:(F,P,n)=>{n.d(P,{$x:()=>E,MX:()=>j,dK:()=>S,sW:()=>D,v4:()=>B});var t=n(1932),u=n(2543),h=n.n(u),g=n(82843),R=n(26423),v=n(12210),p=n(70383),O=n(99494),y=n(77141);const B=Symbol("receiver_status"),j=Symbol("receiver_metadata"),D=Symbol("receiver_plugin_metadata"),I={includePoliciesCount:!0,receiverStatusPollingInterval:10*1e3};function S({includePoliciesCount:e,receiverStatusPollingInterval:a}=I){const{selectedAlertmanager:s,isGrafanaAlertmanager:i}=(0,p.VI)(),{installed:c,loading:d}=(0,v._)(O.W.OnCall),o=g.m.endpoints.getContactPointsStatus.useQuery(void 0,{refetchOnFocus:!0,refetchOnReconnect:!0,pollingInterval:a,skip:!i}),l=g.m.endpoints.grafanaNotifiers.useQuery(void 0,{skip:!i}),{data:r,isLoading:m}=R.WG.endpoints.grafanaOnCallIntegrations.useQuery(void 0,{skip:!c||!i});let x;c?x=r??[]:c===!1&&(x=null);const M=g.m.endpoints.getAlertmanagerConfiguration.useQuery(s,{refetchOnFocus:!0,refetchOnReconnect:!0,selectFromResult:N=>({...N,contactPoints:N.data?(0,y.Rm)(o.data,l.data,x,N.data.alertmanager_config.receivers??[],N.data):[]}),skip:!e}),A=g.m.endpoints.getContactPointsList.useQuery(void 0,{refetchOnFocus:!0,refetchOnReconnect:!0,selectFromResult:N=>({...N,contactPoints:N.data?(0,y.Rm)(o.data,l.data,x,N.data,void 0):[]}),skip:e||!i}),K=M.error||A.error||o.error,V=M.isLoading||A.isLoading||o.isLoading||d||m,z=(e?M.contactPoints:A.contactPoints).sort((N,Y)=>N.name.localeCompare(Y.name));return{error:K,isLoading:V,contactPoints:z,refetchReceivers:A.refetch}}function E(e){const[a]=g.m.endpoints.getAlertmanagerConfiguration.useLazyQuery(),[s,i]=g.m.endpoints.updateAlertmanagerConfiguration.useMutation();return{deleteTrigger:d=>a(e).then(({data:o})=>{if(!o)return;const l=(0,t.jM)(o,r=>((0,u.remove)(r?.alertmanager_config?.receivers??[],m=>m.name===d),r));return s({selectedAlertmanager:e,config:l}).unwrap()}),updateAlertmanagerState:i}}},29554:(F,P,n)=>{n.d(P,{B:()=>I,G:()=>S});var t=n(74848),u=n(96540),h=n(42941),g=n(19073),R=n(39558),v=n(79938),p=n(16293),O=n(76648),y=n(84029);const B=({receiverName:E,decrypt:e,exportFormat:a,onClose:s})=>{const{currentData:i="",isFetching:c}=v.hK.useExportReceiverQuery({receiverName:E,decrypt:e,format:a}),d=`cp-${E}-${new Date().getTime()}`;return c?(0,t.jsx)(R._,{text:"Loading...."}):(0,t.jsx)(p.J,{format:a,textDefinition:i,downloadFileName:d,onClose:s})},j=({onClose:E,receiverName:e,decrypt:a})=>{const[s,i]=(0,u.useState)("yaml");return(0,t.jsx)(O.m,{activeTab:s,onTabChange:i,onClose:E,formatProviders:Object.values(y.sl),children:(0,t.jsx)(B,{receiverName:e,decrypt:a,exportFormat:s,onClose:E})})},D=({decrypt:E,exportFormat:e,onClose:a})=>{const{currentData:s="",isFetching:i}=v.hK.useExportReceiversQuery({decrypt:E,format:e}),c=`contact-points-${new Date().getTime()}`;return i?(0,t.jsx)(R._,{text:"Loading...."}):(0,t.jsx)(p.J,{format:e,textDefinition:s,downloadFileName:c,onClose:a})},W=({onClose:E,decrypt:e})=>{const[a,s]=(0,u.useState)("yaml");return(0,t.jsx)(O.m,{activeTab:a,onTabChange:s,onClose:E,formatProviders:Object.values(y.sl),children:(0,t.jsx)(D,{decrypt:e,exportFormat:a,onClose:E})})},I=Symbol("all contact points"),S=()=>{const[E,e]=(0,u.useState)(null),[a,s]=(0,h.A)(!1),[i,c]=(0,g.L7)(g.QI.DecryptSecrets),d=i&&c,o=(0,u.useCallback)(()=>{e(null),s(!1)},[s]),l=m=>{e(m),s(!0)};return[(0,u.useMemo)(()=>!E||!a?null:E===I?(0,t.jsx)(W,{decrypt:d,onClose:o}):(0,t.jsx)(j,{receiverName:E,decrypt:d,onClose:o}),[d,a,o,E]),l]}},77141:(F,P,n)=>{n.d(P,{Rm:()=>s,aM:()=>e,NY:()=>E});var t=n(2543),u=n(32264),h=n(60021),g=n(79581);function R(o){return"grafana_managed_receiver_configs"in o?o.grafana_managed_receiver_configs??[]:Object.entries(o).filter(([r])=>r!=="grafana_managed_receiver_configs"&&r.endsWith("_configs")).filter(([r,m])=>Array.isArray(m)&&!(0,t.isEmpty)(m)).reduce((r,[m,x])=>{const M=m.replace("_configs",""),A=(0,t.times)(x.length,()=>({name:o.name,type:M,settings:[],disableResolveMessage:!1}));return r.concat(A)},[])}var v=n(37534),p=n(99494),O=n(76156),y=n(86768);const D={title:"Grafana OnCall",icon:y.K[p.W.OnCall]};function W(o,l,r=!0){if(!r||o===void 0)return D;if(o==null)return{...D,warning:"Grafana OnCall is not installed or is disabled"};const m=o.find(x=>x.integration_url===l.settings?.url);return{...D,description:m?.display_name,externalUrl:m?(0,O.h)(p.W.OnCall,`/integrations/${m.value}`):void 0,warning:m?void 0:"OnCall Integration no longer exists"}}var I=n(79381);const S="__grafana_receiver__";function E(o){return!!o.grafana_managed_receiver_configs?.find(r=>r.provenance)?.provenance}function e(o){if(o.settings)switch(o.type){case"email":return"addresses"in o.settings?a(o.settings.addresses):void 0;case"slack":{const l=o.settings.recipient;return l?`#${l.replace(/^#/,"")}`:void 0}case"kafka":return o.settings.kafkaTopic;case"webhook":return o.settings.url;case v.J4.OnCall:return o[I.sW]?.description;default:return o[I.MX]?.description}}function a(o){const r=/,|;|\n+/g,m=o.trim().split(r).map(t.trim),x=(0,t.take)(m,3),M=(0,t.difference)(m,x);return M.length&&x.push(`+${M.length} more`),x.join(", ")}function s(o=[],l=[],r,m,x){const M=(0,g._I)(x?.alertmanager_config?.route??{}),A=c(M),K=(0,t.groupBy)(A,"receiver");return(x?x?.alertmanager_config.receivers??[]:m??[]).map(U=>{const z=R(U),N=o.find(Y=>Y.name===U.name);return{...U,policies:x&&K&&(K[U.name]??[]),grafana_managed_receiver_configs:z.map((Y,Z)=>{const H=Y.type===v.J4.OnCall;return{...Y,[I.v4]:N?.integrations[Z],[I.MX]:d(l,Y),[I.sW]:H?W(r,Y,!!x):void 0}})}})}function i(o){return!(u.$.featureToggles.alertingSimplifiedRouting??!1)||!o.object_matchers?!1:o.object_matchers.some(r=>r[0]===S&&r[1]===h.ho.equal)??!1}function c(o){const l=o.routes?.flatMap(r=>c(r))??[];return o.receiver?[{receiver:o.receiver,route:{type:i(o)?"auto-generated":"normal"}},...l]:l}function d(o,l){const r=o.find(m=>m.type===l.type);return{name:r?.name??(0,t.upperFirst)(l.type),description:r?.description}}},16293:(F,P,n)=>{n.d(P,{J:()=>I});var t=n(74848),u=n(32196),h=n(4213),g=n.n(h),R=n(96540),v=n(70713),p=n(40845),O=n(32372),y=n(55852),B=n(10534),j=n(72109),D=n(42418),W=n(84029);function I({format:e,textDefinition:a,downloadFileName:s,onClose:i}){const c=(0,p.of)(S),d=W.sl[e],o=(0,R.useCallback)(()=>{const r=new Blob([a],{type:`application/${e};charset=utf-8`});g()(r,`${s}.${e}`)},[a,s,e]),l=(0,R.useMemo)(()=>d.formatter?d.formatter(a):a,[d,a]);return(0,t.jsxs)("div",{className:c.container,children:[(0,t.jsx)(E,{exportProvider:d}),(0,t.jsx)("div",{className:c.content,children:(0,t.jsx)(v.Ay,{disableWidth:!0,children:({height:r})=>(0,t.jsx)(O.B,{width:"100%",height:r,language:e,value:l,monacoOptions:{minimap:{enabled:!1},scrollBeyondLastLine:!1,lineNumbers:"on",readOnly:!0}})})}),(0,t.jsxs)("div",{className:c.actions,children:[(0,t.jsx)(y.$n,{variant:"secondary",onClick:i,children:"Cancel"}),(0,t.jsx)(B.b,{icon:"copy",getText:()=>a,children:"Copy code"}),(0,t.jsx)(y.$n,{icon:"download-alt",onClick:o,children:"Download"})]})]})}const S=e=>({container:(0,u.css)({display:"flex",flexDirection:"column",height:"100%",gap:e.spacing(2)}),content:(0,u.css)({flex:"1 1 100%"}),actions:(0,u.css)({flex:0,justifyContent:"flex-end",display:"flex",gap:e.spacing(1)})});function E({exportProvider:e}){const{name:a,type:s}=e,i={file:{title:"File-provisioning format",component:(0,t.jsxs)(t.Fragment,{children:[a," format is only valid for File Provisioning."," ",(0,t.jsx)(j.Y,{href:"https://grafana.com/docs/grafana/latest/alerting/set-up/provision-alerting-resources/file-provisioning/",external:!0,children:"Read more in the docs."})]})},api:{title:"API-provisioning format",component:(0,t.jsxs)(t.Fragment,{children:[a," format is only valid for API Provisioning."," ",(0,t.jsx)(j.Y,{href:"https://grafana.com/docs/grafana/latest/alerting/set-up/provision-alerting-resources/http-api-provisioning/",external:!0,children:"Read more in the docs."})]})},terraform:{title:"Terraform-provisioning format",component:(0,t.jsxs)(t.Fragment,{children:[a," format is only valid for Terraform Provisioning."," ",(0,t.jsx)(j.Y,{href:"https://grafana.com/docs/grafana/latest/alerting/set-up/provision-alerting-resources/terraform-provisioning/",external:!0,children:"Read more in the docs."})]})}},{title:c,component:d}=i[s];return(0,t.jsx)(D.F,{title:c,severity:"info",bottomSpacing:0,topSpacing:0,children:d})}},76648:(F,P,n)=>{n.d(P,{m:()=>g});var t=n(74848),u=n(87978),h=n(73716);function g({activeTab:R,onTabChange:v,children:p,onClose:O,formatProviders:y,title:B="Export"}){const j=Object.values(y).map(D=>({label:D.name,value:D.exportFormat}));return(0,t.jsx)(u._,{title:B,subtitle:"Select the format and download the file or copy the contents to clipboard",tabs:(0,t.jsx)(h.sb,{tabs:j,setActiveTab:v,activeTab:R}),onClose:O,size:"md",children:p})}},84029:(F,P,n)=>{n.d(P,{sl:()=>g});const t={name:"JSON",exportFormat:"json",type:"file",formatter:v=>{try{return JSON.stringify(JSON.parse(v),null,4)}catch{return v}}},u={name:"YAML",exportFormat:"yaml",type:"file"},h={name:"Terraform (HCL)",exportFormat:"hcl",type:"terraform"},g={[t.exportFormat]:t,[u.exportFormat]:u,[h.exportFormat]:h},R=[t,u]},86768:(F,P,n)=>{n.d(P,{K:()=>u});var t=n(99494);const u={[t.W.OnCall]:"public/img/alerting/oncall_logo.svg",[t.W.Incident]:"",[t.W.MachineLearning]:"",[t.W.Labels]:"",[t.W.Slo]:""}},73716:(F,P,n)=>{n.d(P,{G_:()=>a,sb:()=>s});var t=n(74848),u=n(32196),h=n(20382),g=n(96540),R=n(49785),v=n(70713),p=n(40845),O=n(87978),y=n(63021),B=n(40675),j=n(55852),D=n(56034),W=n(14578),I=n(32372),S=n(63066),E=n(23662);const e=[{label:"Yaml",value:"yaml"}],a=({onClose:r})=>{const[m,x]=(0,g.useState)("yaml"),{setValue:M}=(0,R.xW)(),A=(0,p.of)(l),K=V=>{for(const U in V)M(U,V[U]);r()};return(0,t.jsx)(O._,{title:"Inspect Alert rule",subtitle:(0,t.jsx)("div",{className:A.subtitle,children:(0,t.jsx)(s,{tabs:e,setActiveTab:x,activeTab:m})}),onClose:r,children:m==="yaml"&&(0,t.jsx)(i,{onSubmit:K})})};function s({tabs:r,activeTab:m,setActiveTab:x}){return(0,t.jsx)(y.U,{children:r.map((M,A)=>(0,t.jsx)(B.o,{label:M.label,value:M.value,onChangeTab:()=>x(M.value),active:m===M.value},`${M.value}-${A}`))})}const i=({onSubmit:r})=>{const m=(0,p.of)(o),{getValues:x}=(0,R.xW)(),M=(0,S.l1)(x()),[A,K]=(0,g.useState)((0,h.Bh)(M)),V=()=>{const U=(0,h.Hh)(A),z=x(),N=d(U);r({...z,...N})};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:m.applyButton,children:[(0,t.jsx)(j.$n,{type:"button",onClick:V,children:"Apply"}),(0,t.jsx)(D.m,{content:(0,t.jsx)(c,{}),theme:"info",placement:"left-start",interactive:!0,children:(0,t.jsx)(W.I,{name:"exclamation-triangle",size:"xl"})})]}),(0,t.jsx)("div",{className:m.content,children:(0,t.jsx)(v.Ay,{disableWidth:!0,children:({height:U})=>(0,t.jsx)(I.B,{width:"100%",height:U,language:"yaml",value:A,onBlur:K,monacoOptions:{minimap:{enabled:!1}}})})})]})};function c(){return(0,t.jsxs)("div",{children:["The YAML content in the editor only contains alert rule configuration ",(0,t.jsx)("br",{}),"To configure Prometheus, you need to provide the rest of the"," ",(0,t.jsx)("a",{href:"https://prometheus.io/docs/prometheus/latest/configuration/alerting_rules/",target:"_blank",rel:"noreferrer",children:"configuration file content."})]})}function d(r){return(0,E.$y)(r)?(0,S.Qk)(r):(0,E.i7)(r)?(0,S.XI)(r):{}}const o=r=>({content:(0,u.css)({flexGrow:1,height:"100%",paddingBottom:"16px",marginBottom:r.spacing(2)}),applyButton:(0,u.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",flexGrow:0,marginBottom:r.spacing(2)})}),l=()=>({subtitle:(0,u.css)({display:"flex",alignItems:"center",justifyContent:"space-between"})})},19645:(F,P,n)=>{n.d(P,{M:()=>t});const t={discord:"discord",email:"envelope",googlechat:"google-hangouts-alt",hipchat:"hipchat",line:"line",pagerduty:"pagerduty",slack:"slack",teams:"microsoft",telegram:"telegram-alt",webhook:"link",sns:"amazon"}},79581:(F,P,n)=>{n.d(P,{W$:()=>D,_I:()=>W,rJ:()=>y});var t=n(2543),u=n.n(t),h=n(60021),g=n(32642);const R=["receiver","group_by","group_wait","group_interval","repeat_interval"];function v(e,a){const s=p(e,a),i=new Map(a.map(c=>[c,{match:!1,matcher:null}]));return e.forEach(c=>{const d=a.find(o=>E(c,o));d&&i.set(d,{match:!0,matcher:c})}),{matches:s,labelsMatch:i}}function p(e,a){for(const s of e)if(!S(s,a))return!1;return!0}function O(e,a){let s=[];const i=v(e.object_matchers??[],a);if(!i.matches)return[];if(e.routes)for(const c of e.routes){let d=O(c,a);if(s=s.concat(d),d.length&&!c.continue)break}return s.length===0&&s.push({route:e,labelsMatch:i.labelsMatch}),s}function y(e){function a(i){i.object_matchers=(0,g.J$)(i),delete i.matchers,delete i.match,delete i.match_re,i.routes?.forEach(a)}const s=structuredClone(e);return a(s),s}function B(e){function a(i){i.object_matchers=i.object_matchers?.map(([c,d,o])=>[unquoteWithUnescape(c),d,unquoteWithUnescape(o)]),i.routes?.forEach(a)}const s=structuredClone(e);return a(s),s}function j(e,a,s){const i=[];return s.reduce((c,d)=>{const o=d.alerts.filter(l=>{const r=Object.entries(l.labels);return O(e,r).some(m=>m.route===a)});return o.length&&c.push({...d,alerts:o}),c},i)}function D(e,a,s){const c={...(0,t.pick)(e,R),...s};return(0,t.reduce)(c,(o,l,r)=>{const m=l!=null,A=[void 0,"",null].some(U=>a[r]===U)&&m,K=r==="group_by"&&m&&(0,t.isArray)(a[r])&&a[r]?.length===0;return(A||K)&&(o[r]=l),o},{})}function W(e){return{...e,routes:e.routes?.map(a=>{const s=D(e,a);return W({...a,...s})})}}const I={[h.ho.equal]:(e,a)=>e===a,[h.ho.notEqual]:(e,a)=>e!==a,[h.ho.regex]:(e,a)=>new RegExp(`^(?:${a})$`).test(e),[h.ho.notRegex]:(e,a)=>!new RegExp(`^(?:${a})$`).test(e)};function S(e,a){const[s,i,c]=e;let d="";const o=Object.fromEntries(a)[s];o&&(d=o);const l=I[i];if(!l)throw new Error(`no such operator: ${i}`);return l(d,c)}function E(e,a){let[s,i]=a;const[c,d,o]=e;if(s!==c)return!1;const l=I[d];if(!l)throw new Error(`no such operator: ${d}`);return l(i,o)}}}]);

//# sourceMappingURL=6562.2bb4b6816be6d5dee14e.js.map