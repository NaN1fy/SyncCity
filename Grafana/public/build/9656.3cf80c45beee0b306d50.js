(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[9656],{35931:(rt,Ne,h)=>{"use strict";h.d(Ne,{H:()=>b});var N=h(32196),Ee=h(96540),H=h(40845);function b(le){const{description:d,suffix:ce,feature:G}=le,oe=`Learn more about ${G}`,ge=(0,H.of)(S);return Ee.createElement("span",{className:ge.container},d,Ee.createElement("a",{"aria-label":oe,href:`https://grafana.com/docs/grafana/next/datasources/${ce}`,rel:"noreferrer",target:"_blank"},oe))}const S=le=>({container:(0,N.css)({color:le.colors.text.secondary,a:(0,N.css)({color:le.colors.text.link,textDecoration:"underline",marginLeft:"5px","&:hover":{textDecoration:"none"}})})})},6191:(rt,Ne,h)=>{"use strict";h.d(Ne,{X:()=>b});var N=h(32196),Ee=h(96540),H=h(40845);const b=({children:le})=>{const d=(0,H.of)(S);return Ee.createElement("div",{className:d.root},le)},S=le=>({root:(0,N.css)({display:"flex",flexWrap:"wrap",alignItems:"center",gap:le.spacing(3),minHeight:le.spacing(4)})})},31347:(rt,Ne,h)=>{"use strict";h.d(Ne,{Z:()=>Ee});var N=h(96540);const Ee=({grow:H,shrink:b})=>N.createElement("div",{style:{display:"block",flexGrow:H,flexShrink:b}})},92762:(rt,Ne,h)=>{"use strict";h.d(Ne,{Z:()=>d});var N=h(32196),Ee=h(28848),H=h.n(Ee),b=h(96540),S=h(80997),le=h(40845);function d({query:G,language:oe,className:ge}){const F=(0,le.$j)(),xe=ce(F),Fe=H().highlight(G,oe.grammar,oe.name);return b.createElement("div",{className:(0,N.cx)(xe.editorField,"prism-syntax-highlight",ge),"aria-label":"selector",dangerouslySetInnerHTML:{__html:S.sQ.sanitize(Fe)}})}const ce=G=>({editorField:(0,N.css)({fontFamily:G.typography.fontFamilyMonospace,fontSize:G.typography.bodySmall.fontSize})})},42952:(rt,Ne,h)=>{"use strict";h.d(Ne,{T:()=>Ee,f:()=>N});var N=(H=>(H.Code="code",H.Builder="builder",H))(N||{});const Ee="Binary operations"},60016:(rt,Ne,h)=>{"use strict";h.d(Ne,{TO:()=>Fe,iB:()=>Le,kl:()=>ye,wU:()=>me});var N=h(74848),Ee=h(2543),H=h.n(Ee),b=h(96540),S=h(32264),le=h(67061),d=h(38894),ce=h(94354),G=h(14186),oe=h(10354),ge=h(90182),F=h(56587),xe=h(13137);const Fe=[{value:xe.U3.Range,label:"Range",description:"Run query over a range of time."},{value:xe.U3.Instant,label:"Instant",description:'Run query against a single point in time. For this query, the "To" time is used.'}];S.$.featureToggles.lokiExperimentalStreaming&&Fe.push({value:xe.U3.Stream,label:"Stream",description:"Run a query and keep sending results on an interval"});const Le=[{value:1,label:"1/1"}].concat((0,Ee.map)([2,3,4,5,10],Se=>({value:Se,label:"1/"+Se})));function ye(Se){const{lineLimitValue:he,resolution:Pe,onRunQuery:de,runOnBlur:we,onChange:De}=Se,Y=Se.query??{},Qe=(0,F.Io)(Y);function Me(ne){const B={...Y,maxLines:me(ne)};De(B)}function Ye(ne){const{instant:B,range:k,...q}=Y;De({...q,queryType:ne})}function T(ne){Y.maxLines!==me(ne.currentTarget.value)&&Me(ne.currentTarget.value)}function _(ne){ne.key==="Enter"&&de()}function pe(ne){const B={...Y,resolution:ne.value};De(B)}return(0,N.jsxs)(le.B,{alignItems:"flex-start",gap:.5,"aria-label":"Loki extra field",children:[(0,N.jsxs)(le.B,{wrap:"nowrap",gap:0,"data-testid":"queryTypeField","aria-label":"Query type field",children:[(0,N.jsx)(d.I,{width:"auto",children:"Query type"}),(0,N.jsx)(ce.z,{options:Fe,value:Qe,onChange:ne=>{Ye(ne),we&&de()}})]}),(0,N.jsxs)(le.B,{wrap:"nowrap",gap:0,"data-testid":"lineLimitField","aria-label":"Line limit field",children:[(0,N.jsx)(G.I,{label:"Line limit",tooltip:"Upper limit for number of log lines returned by query.",children:(0,N.jsx)(oe.p,{className:"width-4",placeholder:"auto",type:"number",min:0,onChange:T,onKeyDown:_,value:he,onBlur:()=>{we&&de()}})}),(0,N.jsx)(G.I,{label:"Resolution",tooltip:"Resolution 1/1 sets step parameter of Loki metrics range queries such that each pixel corresponds to one data point. For better performance, lower resolutions can be picked. 1/2 only retrieves a data point for every other pixel, and 1/10 retrieves one data point per 10 pixels.",children:(0,N.jsx)(ge.l6,{isSearchable:!1,onChange:pe,options:Le,value:Pe,"aria-label":"Select resolution"})})]})]})}var Ce=(0,b.memo)(ye);function me(Se){const he=parseInt(Se,10);if(!(isNaN(he)||he<0))return he}},95881:(rt,Ne,h)=>{"use strict";h.d(Ne,{W:()=>d});var N=h(74848),Ee=h(96540),H=h(97535);const b=(0,Ee.lazy)(()=>h.e(1952).then(h.bind(h,51639))),S=ce=>(0,N.jsx)(Ee.Suspense,{fallback:null,children:(0,N.jsx)(b,{...ce})}),le=ce=>{const G=(0,Ee.useRef)(null),{onRunQuery:oe,onChange:ge,...F}=ce,xe=W=>{G.current=W,ge(W),oe()},Fe=W=>{ge(W)};return(0,N.jsx)(S,{onRunQuery:xe,onBlur:Fe,onChange:ge,...F})};class d extends Ee.PureComponent{constructor(G){super(G),this._isMounted=!1,this.onChangeQuery=(oe,ge)=>{const{query:F,onChange:xe,onRunQuery:Fe}=this.props;if(xe){const W={...F,expr:oe};xe(W),ge&&Fe&&Fe()}},this.state={labelsLoaded:!1}}async componentDidMount(){this._isMounted=!0,await this.props.datasource.languageProvider.start(this.props.range),this._isMounted&&this.setState({labelsLoaded:!0})}componentWillUnmount(){this._isMounted=!1}componentDidUpdate(G){const{range:oe,datasource:{languageProvider:ge}}=this.props;(0,H.WV)(oe,G.range)&&ge.fetchLabels({timeRange:oe})}render(){const{ExtraFieldElement:G,query:oe,datasource:ge,history:F,onRunQuery:xe,range:Fe}=this.props,W=this.props.placeholder??"Enter a Loki query (run with Shift+Enter)";return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("div",{className:"gf-form-inline gf-form-inline--xs-view-flex-column flex-grow-1","data-testid":this.props["data-testid"],children:(0,N.jsx)("div",{className:"gf-form--grow flex-shrink-1 min-width-15",children:(0,N.jsx)(le,{datasource:ge,history:F??[],onChange:this.onChangeQuery,onRunQuery:xe,initialValue:oe.expr??"",placeholder:W,timeRange:Fe})})}),G]})}}},20065:(rt,Ne,h)=>{"use strict";h.d(Ne,{B:()=>Ee,a:()=>le});var N=h(56245);function Ee(d,ce,G,oe){if(!d)return!1;const ge=H(ce,oe);if(!ge.length)return!1;let F=ge;if(d!==ce){const xe=H(d,oe);F=ge.flatMap(Fe=>xe.filter(W=>Fe.text===W.text)||Fe)}return F.map(xe=>b(d,G,xe)).filter(S)}function H(d,ce){const G=[];return ce.parse(d).iterate({enter:ge=>{if(ge.type.id===N.Ql){const F=ge.node;G.push({node:F,text:d.substring(F.from,F.to)})}}}),G}function b(d,ce,G){if(ce.length===1){const F=G.node.from===G.node.to,xe=F&&G.node.parent?G.node.parent:G.node,Fe=F?d.substring(xe.from,xe.to):G.text;return{startLineNumber:1,startColumn:xe.from+1,endLineNumber:1,endColumn:xe.to+1,error:Fe}}let oe=0,ge=0;for(let F=0;F<ce.length;F++){if(ge=oe+ce[F].length,G.node.from>ge){oe+=ce[F].length+1;continue}return{startLineNumber:F+1,startColumn:G.node.from-oe+1,endLineNumber:F+1,endColumn:G.node.to-oe+1,error:G.text}}return null}function S(d){return d!==null}const le={__interval:{text:"1s",value:"1s"},__rate_interval:{text:"1s",value:"1s"},__auto:{text:"1s",value:"1s"},__interval_ms:{text:"1000",value:1e3},__range_ms:{text:"1000",value:1e3},__range_s:{text:"1",value:1},__range:{text:"1s",value:"1s"}}},27724:(rt,Ne,h)=>{"use strict";h.d(Ne,{we:()=>Tr,VQ:()=>ai,lb:()=>st,Gf:()=>ar,M1:()=>ln,ow:()=>Jn,mL:()=>Zn,In:()=>Ir});var N=h(2543),Ee=h(13288),H=h(44240),b=h(62467),S=h(75505),le=h(81160),d=h(66847),ce=h(59099),G=h(63720),oe=h(65879),ge=h(39070),F=h(9557),xe=h(76885),Fe=h(41987),W=h(78368),Le=h(43659),ye=h(36195),Ce=h(26657),me=h(72574),Se=h(32264);const he=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,Pe=new Set,de=typeof process=="object"&&process?process:{},we=(L,u,l,f)=>{typeof de.emitWarning=="function"?de.emitWarning(L,u,l,f):console.error(`[${l}] ${u}: ${L}`)};let De=globalThis.AbortController,Y=globalThis.AbortSignal;if(typeof De>"u"){Y=class{onabort;_onabort=[];reason;aborted=!1;addEventListener(f,y){this._onabort.push(y)}},De=class{constructor(){u()}signal=new Y;abort(f){if(!this.signal.aborted){this.signal.reason=f,this.signal.aborted=!0;for(const y of this.signal._onabort)y(f);this.signal.onabort?.(f)}}};let L=de.env?.LRU_CACHE_IGNORE_AC_WARNING!=="1";const u=()=>{L&&(L=!1,we("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",u))}}const Qe=L=>!Pe.has(L),Me=Symbol("type"),Ye=L=>L&&L===Math.floor(L)&&L>0&&isFinite(L),T=L=>Ye(L)?L<=Math.pow(2,8)?Uint8Array:L<=Math.pow(2,16)?Uint16Array:L<=Math.pow(2,32)?Uint32Array:L<=Number.MAX_SAFE_INTEGER?_:null:null;class _ extends Array{constructor(u){super(u),this.fill(0)}}class pe{heap;length;static#l=!1;static create(u){const l=T(u);if(!l)return[];pe.#l=!0;const f=new pe(u,l);return pe.#l=!1,f}constructor(u,l){if(!pe.#l)throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new l(u),this.length=0}push(u){this.heap[this.length++]=u}pop(){return this.heap[--this.length]}}class ne{#l;#d;#v;#m;#R;ttl;ttlResolution;ttlAutopurge;updateAgeOnGet;updateAgeOnHas;allowStale;noDisposeOnSet;noUpdateTTL;maxEntrySize;sizeCalculation;noDeleteOnFetchRejection;noDeleteOnStaleGet;allowStaleOnFetchAbort;allowStaleOnFetchRejection;ignoreFetchAbort;#a;#h;#n;#r;#e;#u;#f;#s;#i;#b;#o;#y;#O;#p;#x;#D;#c;static unsafeExposeInternals(u){return{starts:u.#O,ttls:u.#p,sizes:u.#y,keyMap:u.#n,keyList:u.#r,valList:u.#e,next:u.#u,prev:u.#f,get head(){return u.#s},get tail(){return u.#i},free:u.#b,isBackgroundFetch:l=>u.#t(l),backgroundFetch:(l,f,y,x)=>u.#A(l,f,y,x),moveToTail:l=>u.#C(l),indexes:l=>u.#E(l),rindexes:l=>u.#S(l),isStale:l=>u.#g(l)}}get max(){return this.#l}get maxSize(){return this.#d}get calculatedSize(){return this.#h}get size(){return this.#a}get fetchMethod(){return this.#R}get dispose(){return this.#v}get disposeAfter(){return this.#m}constructor(u){const{max:l=0,ttl:f,ttlResolution:y=1,ttlAutopurge:x,updateAgeOnGet:w,updateAgeOnHas:E,allowStale:I,dispose:z,disposeAfter:te,noDisposeOnSet:ie,noUpdateTTL:ue,maxSize:fe=0,maxEntrySize:je=0,sizeCalculation:Ie,fetchMethod:Ze,noDeleteOnFetchRejection:Ae,noDeleteOnStaleGet:We,allowStaleOnFetchRejection:ze,allowStaleOnFetchAbort:ke,ignoreFetchAbort:et}=u;if(l!==0&&!Ye(l))throw new TypeError("max option must be a nonnegative integer");const mt=l?T(l):Array;if(!mt)throw new Error("invalid max value: "+l);if(this.#l=l,this.#d=fe,this.maxEntrySize=je||this.#d,this.sizeCalculation=Ie,this.sizeCalculation){if(!this.#d&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(Ze!==void 0&&typeof Ze!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.#R=Ze,this.#D=!!Ze,this.#n=new Map,this.#r=new Array(l).fill(void 0),this.#e=new Array(l).fill(void 0),this.#u=new mt(l),this.#f=new mt(l),this.#s=0,this.#i=0,this.#b=pe.create(l),this.#a=0,this.#h=0,typeof z=="function"&&(this.#v=z),typeof te=="function"?(this.#m=te,this.#o=[]):(this.#m=void 0,this.#o=void 0),this.#x=!!this.#v,this.#c=!!this.#m,this.noDisposeOnSet=!!ie,this.noUpdateTTL=!!ue,this.noDeleteOnFetchRejection=!!Ae,this.allowStaleOnFetchRejection=!!ze,this.allowStaleOnFetchAbort=!!ke,this.ignoreFetchAbort=!!et,this.maxEntrySize!==0){if(this.#d!==0&&!Ye(this.#d))throw new TypeError("maxSize must be a positive integer if specified");if(!Ye(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.#B()}if(this.allowStale=!!I,this.noDeleteOnStaleGet=!!We,this.updateAgeOnGet=!!w,this.updateAgeOnHas=!!E,this.ttlResolution=Ye(y)||y===0?y:1,this.ttlAutopurge=!!x,this.ttl=f||0,this.ttl){if(!Ye(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.#$()}if(this.#l===0&&this.ttl===0&&this.#d===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.#l&&!this.#d){const pt="LRU_CACHE_UNBOUNDED";Qe(pt)&&(Pe.add(pt),we("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",pt,ne))}}getRemainingTTL(u){return this.#n.has(u)?1/0:0}#$(){const u=new _(this.#l),l=new _(this.#l);this.#p=u,this.#O=l,this.#F=(x,w,E=he.now())=>{if(l[x]=w!==0?E:0,u[x]=w,w!==0&&this.ttlAutopurge){const I=setTimeout(()=>{this.#g(x)&&this.delete(this.#r[x])},w+1);I.unref&&I.unref()}},this.#w=x=>{l[x]=u[x]!==0?he.now():0},this.#P=(x,w)=>{if(u[w]){const E=u[w],I=l[w];if(!E||!I)return;x.ttl=E,x.start=I,x.now=f||y();const z=x.now-I;x.remainingTTL=E-z}};let f=0;const y=()=>{const x=he.now();if(this.ttlResolution>0){f=x;const w=setTimeout(()=>f=0,this.ttlResolution);w.unref&&w.unref()}return x};this.getRemainingTTL=x=>{const w=this.#n.get(x);if(w===void 0)return 0;const E=u[w],I=l[w];if(!E||!I)return 1/0;const z=(f||y())-I;return E-z},this.#g=x=>{const w=l[x],E=u[x];return!!E&&!!w&&(f||y())-w>E}}#w=()=>{};#P=()=>{};#F=()=>{};#g=()=>!1;#B(){const u=new _(this.#l);this.#h=0,this.#y=u,this.#L=l=>{this.#h-=u[l],u[l]=0},this.#Q=(l,f,y,x)=>{if(this.#t(f))return 0;if(!Ye(y))if(x){if(typeof x!="function")throw new TypeError("sizeCalculation must be a function");if(y=x(f,l),!Ye(y))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return y},this.#T=(l,f,y)=>{if(u[l]=f,this.#d){const x=this.#d-u[l];for(;this.#h>x;)this.#I(!0)}this.#h+=u[l],y&&(y.entrySize=f,y.totalCalculatedSize=this.#h)}}#L=u=>{};#T=(u,l,f)=>{};#Q=(u,l,f,y)=>{if(f||y)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0};*#E({allowStale:u=this.allowStale}={}){if(this.#a)for(let l=this.#i;!(!this.#M(l)||((u||!this.#g(l))&&(yield l),l===this.#s));)l=this.#f[l]}*#S({allowStale:u=this.allowStale}={}){if(this.#a)for(let l=this.#s;!(!this.#M(l)||((u||!this.#g(l))&&(yield l),l===this.#i));)l=this.#u[l]}#M(u){return u!==void 0&&this.#n.get(this.#r[u])===u}*entries(){for(const u of this.#E())this.#e[u]!==void 0&&this.#r[u]!==void 0&&!this.#t(this.#e[u])&&(yield[this.#r[u],this.#e[u]])}*rentries(){for(const u of this.#S())this.#e[u]!==void 0&&this.#r[u]!==void 0&&!this.#t(this.#e[u])&&(yield[this.#r[u],this.#e[u]])}*keys(){for(const u of this.#E()){const l=this.#r[u];l!==void 0&&!this.#t(this.#e[u])&&(yield l)}}*rkeys(){for(const u of this.#S()){const l=this.#r[u];l!==void 0&&!this.#t(this.#e[u])&&(yield l)}}*values(){for(const u of this.#E())this.#e[u]!==void 0&&!this.#t(this.#e[u])&&(yield this.#e[u])}*rvalues(){for(const u of this.#S())this.#e[u]!==void 0&&!this.#t(this.#e[u])&&(yield this.#e[u])}[Symbol.iterator](){return this.entries()}[Symbol.toStringTag]="LRUCache";find(u,l={}){for(const f of this.#E()){const y=this.#e[f],x=this.#t(y)?y.__staleWhileFetching:y;if(x!==void 0&&u(x,this.#r[f],this))return this.get(this.#r[f],l)}}forEach(u,l=this){for(const f of this.#E()){const y=this.#e[f],x=this.#t(y)?y.__staleWhileFetching:y;x!==void 0&&u.call(l,x,this.#r[f],this)}}rforEach(u,l=this){for(const f of this.#S()){const y=this.#e[f],x=this.#t(y)?y.__staleWhileFetching:y;x!==void 0&&u.call(l,x,this.#r[f],this)}}purgeStale(){let u=!1;for(const l of this.#S({allowStale:!0}))this.#g(l)&&(this.delete(this.#r[l]),u=!0);return u}info(u){const l=this.#n.get(u);if(l===void 0)return;const f=this.#e[l],y=this.#t(f)?f.__staleWhileFetching:f;if(y===void 0)return;const x={value:y};if(this.#p&&this.#O){const w=this.#p[l],E=this.#O[l];if(w&&E){const I=w-(he.now()-E);x.ttl=I,x.start=Date.now()}}return this.#y&&(x.size=this.#y[l]),x}dump(){const u=[];for(const l of this.#E({allowStale:!0})){const f=this.#r[l],y=this.#e[l],x=this.#t(y)?y.__staleWhileFetching:y;if(x===void 0||f===void 0)continue;const w={value:x};if(this.#p&&this.#O){w.ttl=this.#p[l];const E=he.now()-this.#O[l];w.start=Math.floor(Date.now()-E)}this.#y&&(w.size=this.#y[l]),u.unshift([f,w])}return u}load(u){this.clear();for(const[l,f]of u){if(f.start){const y=Date.now()-f.start;f.start=he.now()-y}this.set(l,f.value,f)}}set(u,l,f={}){if(l===void 0)return this.delete(u),this;const{ttl:y=this.ttl,start:x,noDisposeOnSet:w=this.noDisposeOnSet,sizeCalculation:E=this.sizeCalculation,status:I}=f;let{noUpdateTTL:z=this.noUpdateTTL}=f;const te=this.#Q(u,l,f.size||0,E);if(this.maxEntrySize&&te>this.maxEntrySize)return I&&(I.set="miss",I.maxEntrySizeExceeded=!0),this.delete(u),this;let ie=this.#a===0?void 0:this.#n.get(u);if(ie===void 0)ie=this.#a===0?this.#i:this.#b.length!==0?this.#b.pop():this.#a===this.#l?this.#I(!1):this.#a,this.#r[ie]=u,this.#e[ie]=l,this.#n.set(u,ie),this.#u[this.#i]=ie,this.#f[ie]=this.#i,this.#i=ie,this.#a++,this.#T(ie,te,I),I&&(I.set="add"),z=!1;else{this.#C(ie);const ue=this.#e[ie];if(l!==ue){if(this.#D&&this.#t(ue)){ue.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:fe}=ue;fe!==void 0&&!w&&(this.#x&&this.#v?.(fe,u,"set"),this.#c&&this.#o?.push([fe,u,"set"]))}else w||(this.#x&&this.#v?.(ue,u,"set"),this.#c&&this.#o?.push([ue,u,"set"]));if(this.#L(ie),this.#T(ie,te,I),this.#e[ie]=l,I){I.set="replace";const fe=ue&&this.#t(ue)?ue.__staleWhileFetching:ue;fe!==void 0&&(I.oldValue=fe)}}else I&&(I.set="update")}if(y!==0&&!this.#p&&this.#$(),this.#p&&(z||this.#F(ie,y,x),I&&this.#P(I,ie)),!w&&this.#c&&this.#o){const ue=this.#o;let fe;for(;fe=ue?.shift();)this.#m?.(...fe)}return this}pop(){try{for(;this.#a;){const u=this.#e[this.#s];if(this.#I(!0),this.#t(u)){if(u.__staleWhileFetching)return u.__staleWhileFetching}else if(u!==void 0)return u}}finally{if(this.#c&&this.#o){const u=this.#o;let l;for(;l=u?.shift();)this.#m?.(...l)}}}#I(u){const l=this.#s,f=this.#r[l],y=this.#e[l];return this.#D&&this.#t(y)?y.__abortController.abort(new Error("evicted")):(this.#x||this.#c)&&(this.#x&&this.#v?.(y,f,"evict"),this.#c&&this.#o?.push([y,f,"evict"])),this.#L(l),u&&(this.#r[l]=void 0,this.#e[l]=void 0,this.#b.push(l)),this.#a===1?(this.#s=this.#i=0,this.#b.length=0):this.#s=this.#u[l],this.#n.delete(f),this.#a--,l}has(u,l={}){const{updateAgeOnHas:f=this.updateAgeOnHas,status:y}=l,x=this.#n.get(u);if(x!==void 0){const w=this.#e[x];if(this.#t(w)&&w.__staleWhileFetching===void 0)return!1;if(this.#g(x))y&&(y.has="stale",this.#P(y,x));else return f&&this.#w(x),y&&(y.has="hit",this.#P(y,x)),!0}else y&&(y.has="miss");return!1}peek(u,l={}){const{allowStale:f=this.allowStale}=l,y=this.#n.get(u);if(y===void 0||!f&&this.#g(y))return;const x=this.#e[y];return this.#t(x)?x.__staleWhileFetching:x}#A(u,l,f,y){const x=l===void 0?void 0:this.#e[l];if(this.#t(x))return x;const w=new De,{signal:E}=f;E?.addEventListener("abort",()=>w.abort(E.reason),{signal:w.signal});const I={signal:w.signal,options:f,context:y},z=(Ie,Ze=!1)=>{const{aborted:Ae}=w.signal,We=f.ignoreFetchAbort&&Ie!==void 0;if(f.status&&(Ae&&!Ze?(f.status.fetchAborted=!0,f.status.fetchError=w.signal.reason,We&&(f.status.fetchAbortIgnored=!0)):f.status.fetchResolved=!0),Ae&&!We&&!Ze)return ie(w.signal.reason);const ze=fe;return this.#e[l]===fe&&(Ie===void 0?ze.__staleWhileFetching?this.#e[l]=ze.__staleWhileFetching:this.delete(u):(f.status&&(f.status.fetchUpdated=!0),this.set(u,Ie,I.options))),Ie},te=Ie=>(f.status&&(f.status.fetchRejected=!0,f.status.fetchError=Ie),ie(Ie)),ie=Ie=>{const{aborted:Ze}=w.signal,Ae=Ze&&f.allowStaleOnFetchAbort,We=Ae||f.allowStaleOnFetchRejection,ze=We||f.noDeleteOnFetchRejection,ke=fe;if(this.#e[l]===fe&&(!ze||ke.__staleWhileFetching===void 0?this.delete(u):Ae||(this.#e[l]=ke.__staleWhileFetching)),We)return f.status&&ke.__staleWhileFetching!==void 0&&(f.status.returnedStale=!0),ke.__staleWhileFetching;if(ke.__returned===ke)throw Ie},ue=(Ie,Ze)=>{const Ae=this.#R?.(u,x,I);Ae&&Ae instanceof Promise&&Ae.then(We=>Ie(We===void 0?void 0:We),Ze),w.signal.addEventListener("abort",()=>{(!f.ignoreFetchAbort||f.allowStaleOnFetchAbort)&&(Ie(void 0),f.allowStaleOnFetchAbort&&(Ie=We=>z(We,!0)))})};f.status&&(f.status.fetchDispatched=!0);const fe=new Promise(ue).then(z,te),je=Object.assign(fe,{__abortController:w,__staleWhileFetching:x,__returned:void 0});return l===void 0?(this.set(u,je,{...I.options,status:void 0}),l=this.#n.get(u)):this.#e[l]=je,je}#t(u){if(!this.#D)return!1;const l=u;return!!l&&l instanceof Promise&&l.hasOwnProperty("__staleWhileFetching")&&l.__abortController instanceof De}async fetch(u,l={}){const{allowStale:f=this.allowStale,updateAgeOnGet:y=this.updateAgeOnGet,noDeleteOnStaleGet:x=this.noDeleteOnStaleGet,ttl:w=this.ttl,noDisposeOnSet:E=this.noDisposeOnSet,size:I=0,sizeCalculation:z=this.sizeCalculation,noUpdateTTL:te=this.noUpdateTTL,noDeleteOnFetchRejection:ie=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:ue=this.allowStaleOnFetchRejection,ignoreFetchAbort:fe=this.ignoreFetchAbort,allowStaleOnFetchAbort:je=this.allowStaleOnFetchAbort,context:Ie,forceRefresh:Ze=!1,status:Ae,signal:We}=l;if(!this.#D)return Ae&&(Ae.fetch="get"),this.get(u,{allowStale:f,updateAgeOnGet:y,noDeleteOnStaleGet:x,status:Ae});const ze={allowStale:f,updateAgeOnGet:y,noDeleteOnStaleGet:x,ttl:w,noDisposeOnSet:E,size:I,sizeCalculation:z,noUpdateTTL:te,noDeleteOnFetchRejection:ie,allowStaleOnFetchRejection:ue,allowStaleOnFetchAbort:je,ignoreFetchAbort:fe,status:Ae,signal:We};let ke=this.#n.get(u);if(ke===void 0){Ae&&(Ae.fetch="miss");const et=this.#A(u,ke,ze,Ie);return et.__returned=et}else{const et=this.#e[ke];if(this.#t(et)){const ir=f&&et.__staleWhileFetching!==void 0;return Ae&&(Ae.fetch="inflight",ir&&(Ae.returnedStale=!0)),ir?et.__staleWhileFetching:et.__returned=et}const mt=this.#g(ke);if(!Ze&&!mt)return Ae&&(Ae.fetch="hit"),this.#C(ke),y&&this.#w(ke),Ae&&this.#P(Ae,ke),et;const pt=this.#A(u,ke,ze,Ie),Ar=pt.__staleWhileFetching!==void 0&&f;return Ae&&(Ae.fetch=mt?"stale":"refresh",Ar&&mt&&(Ae.returnedStale=!0)),Ar?pt.__staleWhileFetching:pt.__returned=pt}}get(u,l={}){const{allowStale:f=this.allowStale,updateAgeOnGet:y=this.updateAgeOnGet,noDeleteOnStaleGet:x=this.noDeleteOnStaleGet,status:w}=l,E=this.#n.get(u);if(E!==void 0){const I=this.#e[E],z=this.#t(I);return w&&this.#P(w,E),this.#g(E)?(w&&(w.get="stale"),z?(w&&f&&I.__staleWhileFetching!==void 0&&(w.returnedStale=!0),f?I.__staleWhileFetching:void 0):(x||this.delete(u),w&&f&&(w.returnedStale=!0),f?I:void 0)):(w&&(w.get="hit"),z?I.__staleWhileFetching:(this.#C(E),y&&this.#w(E),I))}else w&&(w.get="miss")}#N(u,l){this.#f[l]=u,this.#u[u]=l}#C(u){u!==this.#i&&(u===this.#s?this.#s=this.#u[u]:this.#N(this.#f[u],this.#u[u]),this.#N(this.#i,u),this.#i=u)}delete(u){let l=!1;if(this.#a!==0){const f=this.#n.get(u);if(f!==void 0)if(l=!0,this.#a===1)this.clear();else{this.#L(f);const y=this.#e[f];if(this.#t(y)?y.__abortController.abort(new Error("deleted")):(this.#x||this.#c)&&(this.#x&&this.#v?.(y,u,"delete"),this.#c&&this.#o?.push([y,u,"delete"])),this.#n.delete(u),this.#r[f]=void 0,this.#e[f]=void 0,f===this.#i)this.#i=this.#f[f];else if(f===this.#s)this.#s=this.#u[f];else{const x=this.#f[f];this.#u[x]=this.#u[f];const w=this.#u[f];this.#f[w]=this.#f[f]}this.#a--,this.#b.push(f)}}if(this.#c&&this.#o?.length){const f=this.#o;let y;for(;y=f?.shift();)this.#m?.(...y)}return l}clear(){for(const u of this.#S({allowStale:!0})){const l=this.#e[u];if(this.#t(l))l.__abortController.abort(new Error("deleted"));else{const f=this.#r[u];this.#x&&this.#v?.(l,f,"delete"),this.#c&&this.#o?.push([l,f,"delete"])}}if(this.#n.clear(),this.#e.fill(void 0),this.#r.fill(void 0),this.#p&&this.#O&&(this.#p.fill(0),this.#O.fill(0)),this.#y&&this.#y.fill(0),this.#s=0,this.#i=0,this.#b.length=0,this.#h=0,this.#a=0,this.#c&&this.#o){const u=this.#o;let l;for(;l=u?.shift();)this.#m?.(...l)}}}var B=h(40187),k=h(43127),q=h(97535),ee=h(56587),Ve=h(60706),P=h(75723),R=h(13137);const Q=1e6,V="{}";class K extends B.Is{constructor(u,l){super(),this.started=!1,this.seriesCache=new ne({max:10}),this.labelsCache=new ne({max:10}),this.request=async(f,y)=>{try{return await this.datasource.metadataRequest(f,y)}catch(x){console.error(x)}},this.start=f=>{const y=f??this.getDefaultTimeRange();return(!this.startTask||this.startedTimeRange?.from.isSame(y.from)===!1||this.startedTimeRange?.to.isSame(y.to)===!1)&&(this.startedTimeRange=y,this.startTask=this.fetchLabels({timeRange:y}).then(()=>(this.started=!0,[]))),this.startTask},this.fetchSeriesLabels=async(f,y)=>{const x=this.datasource.interpolateString(f),w="series",E=y?.timeRange??this.getDefaultTimeRange(),{start:I,end:z}=this.datasource.getTimeRangeParams(E),te=this.generateCacheKey(w,I,z,x);let ie=this.seriesCache.get(te);if(!ie){const ue={"match[]":x,start:I,end:z},fe=await this.request(w,ue);if(!Array.isArray(fe))return{};const{values:je}=(0,q.P7)(fe);ie=je,this.seriesCache.set(te,ie)}return ie},this.fetchSeries=async(f,y)=>{const x="series",w=y?.timeRange??this.getDefaultTimeRange(),{start:E,end:I}=this.datasource.getTimeRangeParams(w),z={"match[]":f,start:E,end:I};return await this.request(x,z)},this.datasource=u,this.labelKeys=[],Object.assign(this,l)}getLabelKeys(){return this.labelKeys}importFromAbstractQuery(u){return{refId:u.refId,expr:(0,q.tt)(u),queryType:R.U3.Range}}exportToAbstractQuery(u){if(!u.expr||u.expr.length===0)return{refId:u.refId,labelMatchers:[]};const f=(0,ee.pk)(u.expr).map(y=>(0,Ve.u_)(y).query.labels.map(E=>({name:E.label,value:E.value,operator:q.sM[E.op]})));return{refId:u.refId,labelMatchers:(0,N.flatten)(f)}}async fetchLabels(u){if(!u||!u.streamSelector)return this.fetchLabelsByLabelsEndpoint(u);{const l=await this.fetchSeriesLabels(u.streamSelector,{timeRange:u.timeRange});return Object.keys(l??{})}}async fetchLabelsByLabelsEndpoint(u){const l="labels",f=u?.timeRange??this.getDefaultTimeRange(),y=this.datasource.getTimeRangeParams(f),x=await this.request(l,y);if(Array.isArray(x)){const w=x.slice().sort().filter(E=>E!=="__name__");return this.labelKeys=w,this.labelKeys}return[]}generateCacheKey(u,l,f,y){return[u,this.roundTime(l),this.roundTime(f),y].join()}roundTime(u){return u?Math.floor(u/Q/1e3/60/5):0}async fetchLabelValues(u,l){const f=encodeURIComponent(this.datasource.interpolateString(u)),y=l?.streamSelector&&l.streamSelector!==V?this.datasource.interpolateString(l.streamSelector):void 0,x=`label/${f}/values`,w=l?.timeRange??this.getDefaultTimeRange(),E=this.datasource.getTimeRangeParams(w),{start:I,end:z}=E,te={start:I,end:z};let ie=f;y&&(te.query=y,ie+=y);const ue=this.generateCacheKey(x,I,z,ie);let fe=this.labelsCache.get(ue);if(!fe){this.labelsCache.set(ue,[]);const je=await this.request(x,te);Array.isArray(je)&&(fe=je.slice().sort(),this.labelsCache.set(ue,fe))}return fe??[]}async getParserAndLabelKeys(u,l){const f={extractedLabelKeys:[],structuredMetadataKeys:[],unwrapLabelKeys:[],hasJSON:!1,hasLogfmt:!1,hasPack:!1};if(!Se.$.featureToggles.lokiQueryHints)return f;const y=await this.datasource.getDataSamples({expr:u,refId:"data-samples",maxLines:l?.maxLines||Tr},l?.timeRange??this.getDefaultTimeRange());if(!y.length)return f;const{hasLogfmt:x,hasJSON:w,hasPack:E}=(0,P.YB)(y[0]);return{extractedLabelKeys:[...(0,P.fV)(y[0],R.HD.Indexed),...(0,P.fV)(y[0],R.HD.Parsed)],structuredMetadataKeys:(0,P.fV)(y[0],R.HD.StructuredMetadata),unwrapLabelKeys:(0,P.aN)(y[0]),hasJSON:w,hasPack:E,hasLogfmt:x}}getDefaultTimeRange(){return(0,k.E2)()}}var ae=h(39697),Oe=h(37748),ve=h(69862),He=h(69850),_e=h(31635),lt=h(13752),Pt=h(75508),xt=h(88483),sr=h(64423),Vt=h(39741),Er={url:"",deserializer:function(L){return JSON.parse(L.data)},serializer:function(L){return JSON.stringify(L)}},Xt="WebSocketSubject.error must be called with an object with an error code, and an optional reason: { code: number, reason: string }",jr=function(L){(0,_e.__extends)(u,L);function u(l,f){var y=L.call(this)||this;if(y._socket=null,l instanceof xt.c)y.destination=f,y.source=l;else{var x=y._config=(0,_e.__assign)({},Er);if(y._output=new lt.B,typeof l=="string")x.url=l;else for(var w in l)l.hasOwnProperty(w)&&(x[w]=l[w]);if(!x.WebSocketCtor&&WebSocket)x.WebSocketCtor=WebSocket;else if(!x.WebSocketCtor)throw new Error("no WebSocket constructor can be found");y.destination=new Vt.m}return y}return u.prototype.lift=function(l){var f=new u(this._config,this.destination);return f.operator=l,f.source=this,f},u.prototype._resetState=function(){this._socket=null,this.source||(this.destination=new Vt.m),this._output=new lt.B},u.prototype.multiplex=function(l,f,y){var x=this;return new xt.c(function(w){try{x.next(l())}catch(I){w.error(I)}var E=x.subscribe({next:function(I){try{y(I)&&w.next(I)}catch(z){w.error(z)}},error:function(I){return w.error(I)},complete:function(){return w.complete()}});return function(){try{x.next(f())}catch(I){w.error(I)}E.unsubscribe()}})},u.prototype._connectSocket=function(){var l=this,f=this._config,y=f.WebSocketCtor,x=f.protocol,w=f.url,E=f.binaryType,I=this._output,z=null;try{z=x?new y(w,x):new y(w),this._socket=z,E&&(this._socket.binaryType=E)}catch(ie){I.error(ie);return}var te=new sr.yU(function(){l._socket=null,z&&z.readyState===1&&z.close()});z.onopen=function(ie){var ue=l._socket;if(!ue){z.close(),l._resetState();return}var fe=l._config.openObserver;fe&&fe.next(ie);var je=l.destination;l.destination=Pt.vU.create(function(Ie){if(z.readyState===1)try{var Ze=l._config.serializer;z.send(Ze(Ie))}catch(Ae){l.destination.error(Ae)}},function(Ie){var Ze=l._config.closingObserver;Ze&&Ze.next(void 0),Ie&&Ie.code?z.close(Ie.code,Ie.reason):I.error(new TypeError(Xt)),l._resetState()},function(){var Ie=l._config.closingObserver;Ie&&Ie.next(void 0),z.close(),l._resetState()}),je&&je instanceof Vt.m&&te.add(je.subscribe(l.destination))},z.onerror=function(ie){l._resetState(),I.error(ie)},z.onclose=function(ie){z===l._socket&&l._resetState();var ue=l._config.closeObserver;ue&&ue.next(ie),ie.wasClean?I.complete():I.error(ie)},z.onmessage=function(ie){try{var ue=l._config.deserializer;I.next(ue(ie))}catch(fe){I.error(fe)}}},u.prototype._subscribe=function(l){var f=this,y=this.source;return y?y.subscribe(l):(this._socket||this._connectSocket(),this._output.subscribe(l),l.add(function(){var x=f._socket;f._output.observers.length===0&&(x&&(x.readyState===1||x.readyState===0)&&x.close(),f._resetState())}),l)},u.prototype.unsubscribe=function(){var l=this._socket;l&&(l.readyState===1||l.readyState===0)&&l.close(),this._resetState(),L.prototype.unsubscribe.call(this)},u}(lt.k);function Ur(L){return new jr(L)}var Da=h(33526),ut=h(11261),kt=h(38823),wa=h(8227);function Pn(L){if(!(0,wa.A)(L))throw TypeError("Invalid UUID");let u;const l=new Uint8Array(16);return l[0]=(u=parseInt(L.slice(0,8),16))>>>24,l[1]=u>>>16&255,l[2]=u>>>8&255,l[3]=u&255,l[4]=(u=parseInt(L.slice(9,13),16))>>>8,l[5]=u&255,l[6]=(u=parseInt(L.slice(14,18),16))>>>8,l[7]=u&255,l[8]=(u=parseInt(L.slice(19,23),16))>>>8,l[9]=u&255,l[10]=(u=parseInt(L.slice(24,36),16))/1099511627776&255,l[11]=u/4294967296&255,l[12]=u>>>24&255,l[13]=u>>>16&255,l[14]=u>>>8&255,l[15]=u&255,l}const Dn=Pn;function wn(L){L=unescape(encodeURIComponent(L));const u=[];for(let l=0;l<L.length;++l)u.push(L.charCodeAt(l));return u}const Ln="6ba7b810-9dad-11d1-80b4-00c04fd430c8",La="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function Ca(L,u,l){function f(y,x,w,E){var I;if(typeof y=="string"&&(y=wn(y)),typeof x=="string"&&(x=Dn(x)),((I=x)===null||I===void 0?void 0:I.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let z=new Uint8Array(16+y.length);if(z.set(x),z.set(y,x.length),z=l(z),z[6]=z[6]&15|u,z[8]=z[8]&63|128,w){E=E||0;for(let te=0;te<16;++te)w[E+te]=z[te];return w}return(0,kt.k)(z)}try{f.name=L}catch{}return f.DNS=Ln,f.URL=La,f}function vt(L,u,l,f){switch(L){case 0:return u&l^~u&f;case 1:return u^l^f;case 2:return u&l^u&f^l&f;case 3:return u^l^f}}function Qt(L,u){return L<<u|L>>>32-u}function Ra(L){const u=[1518500249,1859775393,2400959708,3395469782],l=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof L=="string"){const w=unescape(encodeURIComponent(L));L=[];for(let E=0;E<w.length;++E)L.push(w.charCodeAt(E))}else Array.isArray(L)||(L=Array.prototype.slice.call(L));L.push(128);const f=L.length/4+2,y=Math.ceil(f/16),x=new Array(y);for(let w=0;w<y;++w){const E=new Uint32Array(16);for(let I=0;I<16;++I)E[I]=L[w*64+I*4]<<24|L[w*64+I*4+1]<<16|L[w*64+I*4+2]<<8|L[w*64+I*4+3];x[w]=E}x[y-1][14]=(L.length-1)*8/Math.pow(2,32),x[y-1][14]=Math.floor(x[y-1][14]),x[y-1][15]=(L.length-1)*8&4294967295;for(let w=0;w<y;++w){const E=new Uint32Array(80);for(let fe=0;fe<16;++fe)E[fe]=x[w][fe];for(let fe=16;fe<80;++fe)E[fe]=Qt(E[fe-3]^E[fe-8]^E[fe-14]^E[fe-16],1);let I=l[0],z=l[1],te=l[2],ie=l[3],ue=l[4];for(let fe=0;fe<80;++fe){const je=Math.floor(fe/20),Ie=Qt(I,5)+vt(je,z,te,ie)+ue+u[je]+E[fe]>>>0;ue=ie,ie=te,te=Qt(z,30)>>>0,z=I,I=Ie}l[0]=l[0]+I>>>0,l[1]=l[1]+z>>>0,l[2]=l[2]+te>>>0,l[3]=l[3]+ie>>>0,l[4]=l[4]+ue>>>0}return[l[0]>>24&255,l[0]>>16&255,l[0]>>8&255,l[0]&255,l[1]>>24&255,l[1]>>16&255,l[1]>>8&255,l[1]&255,l[2]>>24&255,l[2]>>16&255,l[2]>>8&255,l[2]&255,l[3]>>24&255,l[3]>>16&255,l[3]>>8&255,l[3]&255,l[4]>>24&255,l[4]>>16&255,l[4]>>8&255,l[4]&255]}const Rn=Ca("v5",80,Ra),Ta="6ec946da-0f49-47a8-983a-1d76d17e7c92";function Tn(L,u){const l=L.streams;if(!l||!l.length)return;const f=u.fields[0],y=u.fields[1],x=u.fields[2],w={};for(const E of l){const I=Object.entries(E.stream).map(([z,te])=>`${z}="${te}"`).sort().join("");for(const[z,te]of E.values)f.values.push(new Date(parseInt(z.slice(0,-6),10)).toISOString()),y.values.push(te),x.values.push(Ht(z,I,te,w,u.refId))}}function Ht(L,u,l,f,y){let x=Rn(`${L}_${u}_${l}`,Ta);if(x in f){const w=f[x]+1;f[x]=w,x=`${x}_${w}`}else f[x]=0;return y?`${y}_${x}`:x}class zt{constructor(){this.streams={}}getStream(u,l=5e3){let f=this.streams[u.url];if(f)return f;const y=new Da.x({capacity:u.size});return y.addField({name:"Time",type:ut.PU.time,config:{}}),y.addField({name:"Line",type:ut.PU.string}),y.addField({name:"id",type:ut.PU.string}),y.meta={...y.meta,preferredVisualisationType:"logs"},y.refId=u.refId,f=Ur(u.url).pipe((0,le.T)(x=>(Tn(x,y),[y])),(0,Oe.l)(x=>x.pipe((0,ve.Z)((w,E)=>{const I=E+1;return w.code===1006&&I<30?(I>10&&console.warn(`Websocket connection is being disrupted. We keep reconnecting but consider starting new live tailing again. Error: ${w.reason}`),(0,ae.O)(l)):(0,Ee.$)(w)}))),(0,He.j)(()=>{delete this.streams[u.url]})),this.streams[u.url]=f,f}}var at=h(47232),In=h(85404),Be=h(74848),ht=h(32196),nt=h(96540),An=h(16817),Wr=h(36663),$n=h(92762),Mt=h(14110),Vr=h(40845),lr=h(42418),rr=h(56034),Ia=h(55852),Fn=h(82762),kr=h(14578),Qn=h(62930),Gr=h(60029),ur=h(90182),cr=h(39268),_t=h(14186),Aa=h(44522),dr=h(15292),Mn=h(71713);function Xr(L){return{labels:(0,ht.css)`
      display: flex;
      gap: ${L.spacing(.5)};
    `,wrapper:(0,ht.css)`
      display: flex;
      flex-direction: column;
      flex: 1;
      gap: ${L.spacing(.5)};
      position: relative;
    `,textWrapper:(0,ht.css)`
      display: flex;
      align-items: center;
    `,hidden:(0,ht.css)`
      visibility: hidden;
    `,label:(0,ht.css)`
      max-width: 100%;
      &:first-of-type {
        margin-bottom: ${L.spacing(2)};
      }
      &:not(:first-of-type) {
        margin: ${L.spacing(2)} 0;
      }
    `,rawQueryContainer:(0,ht.css)`
      text-align: start;
      line-break: anywhere;
      margin-top: -${L.spacing(.25)};
      margin-right: ${L.spacing(6)};
      min-height: ${L.spacing(4)};
    `,ui:(0,ht.css)`
      background-color: ${L.colors.background.secondary};
      padding: ${L.spacing(2)};
    `,notification:(0,ht.css)({position:"absolute",zIndex:L.zIndex.portal,top:0,right:0}),rawQuery:(0,ht.css)`
      display: inline;
    `,queryDescription:(0,ht.css)`
      margin-left: ${L.spacing(.5)};
    `,iconButton:(0,ht.css)`
      position: absolute;
      top: ${L.spacing(1)};
      right: ${L.spacing(1)};
      z-index: ${L.zIndex.navbarFixed};
    `,operationsToggle:(0,ht.css)`
      margin: ${L.spacing(1)} 0 ${L.spacing(-1)} 0;
      & > div {
        margin: 0;
        & > label {
          padding: 0;
        }
      }
    `}}const Te="isLogContextQueryUiOpen";function fr(L){const{row:u,logContextProvider:l,updateFilter:f,onClose:y,origQuery:x,runContextQuery:w}=L,E=(0,Vr.of)(Xr),[I,z]=(0,nt.useState)([]),[te,ie]=(0,nt.useState)(!1),[ue,fe]=(0,nt.useState)(!1),[je,Ie]=(0,nt.useState)(!1),[Ze,Ae]=(0,nt.useState)(window.localStorage.getItem(Te)==="true"),[We,ze]=(0,nt.useState)(window.localStorage.getItem(pr)==="true"),ke=(0,nt.useRef)(),et=(0,nt.useRef)(!1),mt=(0,nt.useRef)([]),pt=(0,nt.useMemo)(()=>!(ue&&I.some(Ke=>Ke.nonIndexed===Ke.enabled)||We&&l.queryContainsValidPipelineStages(x)),[I,We,ue,l,x]);(0,nt.useEffect)(()=>{if(ue){if(!et.current){et.current=ue;return}if(I.filter(({enabled:Ke,nonIndexed:yt})=>Ke&&!yt).length===0){z(mt.current);return}return mt.current=structuredClone(I),ke.current&&clearTimeout(ke.current),Ie(!0),ke.current=window.setTimeout(()=>{f(I.filter(({enabled:yt})=>yt));const Ke={removedLabels:[],selectedExtractedLabels:[]};I.forEach(({enabled:yt,nonIndexed:ft,label:Rt})=>{!yt&&!ft&&Ke.removedLabels.push(Rt),yt&&ft&&Ke.selectedExtractedLabels.push(Rt)}),window.localStorage.setItem(Sr,JSON.stringify(Ke)),Ie(!1)},1500),()=>{clearTimeout(ke.current)}}},[I,ue]),(0,nt.useEffect)(()=>()=>{clearTimeout(ke.current),y()},[y]),(0,An.A)(async()=>{Ie(!0);const Ke=await l.getInitContextFilters(u,x,{from:(0,at.KQ)(u.timeEpochMs),to:(0,at.KQ)(u.timeEpochMs),raw:{from:(0,at.KQ)(u.timeEpochMs),to:(0,at.KQ)(u.timeEpochMs)}});z(Ke.contextFilters),ie(Ke.preservedFiltersApplied),fe(!0),Ie(!1)}),(0,nt.useEffect)(()=>{te&&setTimeout(()=>{ie(!1)},2e3)},[te]),(0,nt.useEffect)(()=>((0,Mt.rR)("grafana_explore_logs_loki_log_context_loaded",{logRowUid:u.uid,type:"load"}),()=>{(0,Mt.rR)("grafana_explore_logs_loki_log_context_loaded",{logRowUid:u.uid,type:"unload"})}),[u.uid]);const Kt=I.filter(({nonIndexed:Ke})=>!Ke),Ar=Kt.filter(({enabled:Ke})=>Ke),ir=I.filter(({nonIndexed:Ke})=>Ke),Ni=ir.filter(({enabled:Ke})=>Ke),Yt=(0,nt.useCallback)(Ke=>({label:`${Ke.label}="${(0,q.Bb)(Ke.value)}"`,value:Ke.label}),[]),ii=ir.length>0;let Bi=l.prepareExpression(I.filter(({enabled:Ke})=>Ke),x);return(0,Be.jsxs)("div",{className:E.wrapper,children:[te&&(0,Be.jsx)(lr.F,{className:E.notification,title:"Previously used filters have been applied.",severity:"info",elevated:!0}),(0,Be.jsx)(rr.m,{content:"Revert to initial log context query.",children:(0,Be.jsx)("div",{className:E.iconButton,children:(0,Be.jsx)(Ia.$n,{"data-testid":"revert-button",icon:"history-alt",variant:"secondary",disabled:pt,onClick:Ke=>{(0,Mt.rR)("grafana_explore_logs_loki_log_context_reverted",{logRowUid:u.uid}),z(yt=>yt.map(ft=>({...ft,enabled:!ft.nonIndexed}))),window.localStorage.removeItem(Sr),window.localStorage.removeItem(pr),ze(!1)}})})}),(0,Be.jsx)(Fn.S,{collapsible:!0,isOpen:Ze,onToggle:()=>{window.localStorage.setItem(Te,(!Ze).toString()),Ae(Ke=>!Ke),(0,Mt.rR)("grafana_explore_logs_loki_log_context_toggled",{logRowUid:u.uid,action:Ze?"close":"open"})},label:(0,Be.jsx)("div",{className:E.rawQueryContainer,children:ue?(0,Be.jsxs)(Be.Fragment,{children:[(0,Be.jsx)($n.Z,{language:{grammar:Mn.vB,name:"loki"},query:Bi,className:E.rawQuery}),(0,Be.jsx)(rr.m,{content:"The initial log context query is created from all labels defining the stream for the selected log line. Use the editor below to customize the log context query.",children:(0,Be.jsx)(kr.I,{name:"info-circle",size:"sm",className:E.queryDescription})})]}):(0,Be.jsx)(Qn.y,{})}),children:(0,Be.jsxs)("div",{className:E.ui,children:[(0,Be.jsx)(Gr.J,{className:E.label,description:"The initial log context query is created from all labels defining the stream for the selected log line. You can broaden your search by removing one or more of the label filters.",children:"Widen the search"}),(0,Be.jsx)(ur.KF,{isLoading:je,options:Kt.map(Yt),value:Ar.map(Yt),closeMenuOnSelect:!0,maxMenuHeight:200,noOptionsMessage:"No further labels available",onChange:(Ke,yt)=>(yt.action==="select-option"&&(0,Mt.rR)("grafana_explore_logs_loki_log_context_filtered",{logRowUid:u.uid,type:"label",action:"select"}),yt.action==="remove-value"&&(0,Mt.rR)("grafana_explore_logs_loki_log_context_filtered",{logRowUid:u.uid,type:"label",action:"remove"}),z(I.map(ft=>(ft.nonIndexed||(ft.enabled=Ke.some(Rt=>Rt.value===ft.label)),ft))))}),ii&&(0,Be.jsxs)(Be.Fragment,{children:[(0,Be.jsx)(Gr.J,{className:E.label,description:"By using a parser in your original query, you can use filters for extracted labels. Refine your search by applying extracted labels created from the selected log line.",children:"Refine the search"}),(0,Be.jsx)(ur.KF,{isLoading:je,options:ir.map(Yt),value:Ni.map(Yt),closeMenuOnSelect:!0,maxMenuHeight:200,noOptionsMessage:"No further labels available",isClearable:!0,onChange:(Ke,yt)=>{yt.action==="select-option"&&(0,Mt.rR)("grafana_explore_logs_loki_log_context_filtered",{logRowUid:u.uid,type:"parsed_label",action:"select"}),yt.action==="remove-value"&&(0,Mt.rR)("grafana_explore_logs_loki_log_context_filtered",{logRowUid:u.uid,type:"parsed_label",action:"remove"}),z(I.map(ft=>(ft.nonIndexed&&(ft.enabled=Ke.some(Rt=>Rt.value===ft.label)),ft)))}})]}),l.queryContainsValidPipelineStages(x)&&(0,Be.jsx)(cr.C,{className:E.operationsToggle,children:(0,Be.jsx)(_t.I,{label:"Include LogQL pipeline operations",tooltip:(0,Be.jsx)(Aa.I,{content:(0,Wr.G)("This will include LogQL operations such as `line_format` or `label_format`. It won't include line or label filter operations.")}),children:(0,Be.jsx)(dr.K,{value:We,showLabel:!0,transparent:!0,onChange:Ke=>{(0,Mt.rR)("grafana_explore_logs_loki_log_context_pipeline_toggled",{logRowUid:u.uid,action:Ke.currentTarget.checked?"enable":"disable"}),window.localStorage.setItem(pr,Ke.currentTarget.checked.toString()),ze(Ke.currentTarget.checked),w&&w()}})})})]})})]})}var qe=h(12798),$a=(L=>(L[L.Ascending=0]="Ascending",L[L.Descending=1]="Descending",L))($a||{});function Nn(L,u){const l=L.values,{nanos:f}=L,y=Array(l.length);for(let w=0;w<y.length;w++)y[w]=w;const x=u===0;return y.sort((w,E)=>{const I=l[w],z=l[E];if(I<z)return x?-1:1;if(I>z)return x?1:-1;if(f===void 0)return 0;const te=f[w],ie=f[E];return te<ie?x?-1:1:te>ie?x?1:-1:0}),y}function Hr(L,u){const{fields:l,...f}=L,y=l.find(w=>w.type===ut.PU.time);if(y===void 0)throw new Error("missing timestamp field. should never happen");const x=Nn(y,u);return{...f,fields:l.map(w=>({...w,values:zr(w.values,x),nanos:w.nanos===void 0?void 0:zr(w.nanos,x)}))}}function zr(L,u){return L.map((l,f)=>L[u[f]])}const Sr="lokiLogContextPreservedLabels",pr="lokiLogContextShouldIncludePipelineOperations";class _r{constructor(u){this.getLogRowContextQuery=async(l,f,y,x=!0)=>{const{query:w}=await this.getQueryAndRange(l,f,y,x);return x||(this.cachedContextFilters=[]),w},this.getLogRowContext=async(l,f,y)=>{const x=f&&f.direction||F.ZF.Backward,{query:w,range:E}=await this.getQueryAndRange(l,f,y),I=te=>{const ue=te.data.map(fe=>Hr(fe,$a.Descending));return{...te,data:ue}},z=Fe.Jk.Explore;return(0,S.s)(this.datasource.query(Ir(w,E,z,`${ln}${x}`)).pipe((0,d.W)(te=>{throw{message:"Error during context query. Please check JS console logs.",status:te.status,statusText:te.statusText}}),(0,G.n)(te=>(0,b.of)(I(te)))))},this.processContextFiltersToExpr=(l,f)=>{let x=`{${l.map(w=>!w.nonIndexed&&w.enabled?`${w.label}="${(0,q.Qn)(w.value)}"`:"").filter(w=>!!w).join(",")}}`;if(f){let w=!1;if((0,ee.MX)(f.expr).parserCount===1){w=!0;const I=(0,ee.aw)(f.expr);I&&(x=(0,qe.aH)(x,I))}const E=l.filter(I=>I.nonIndexed&&I.enabled);for(const I of E)I.enabled&&(x=(0,qe.tE)(x,I.label,"=",I.value,w?R.HD.Parsed:R.HD.StructuredMetadata))}return x},this.processPipelineStagesToExpr=(l,f)=>{let y=l;const x=f?.expr??"";if((0,ee.MX)(x).parserCount>1)return y;const w=(0,ee.TQ)(x,[ye.t3,ye.iT,ye.c$,ye.LM,ye.CX,ye.bY]),E=w.filter(z=>z.type?.id===ye.t3),I=w.filter(z=>z.type?.id!==ye.t3);for(const z of E)I.some(te=>z.contains(te))||(y+=` ${z.getExpression(x)}`);return y},this.queryContainsValidPipelineStages=l=>{const f=l?.expr??"",y=(0,ee.TQ)(f,[ye.t3,ye.iT,ye.CX,ye.bY]),x=y.filter(E=>E.type?.id===ye.t3),w=y.filter(E=>E.type?.id!==ye.t3);return x.some(E=>w.every(I=>E.contains(I)===!1))},this.getInitContextFilters=async(l,f,y)=>{let x=!1;if(!f||(0,N.isEmpty)(l.labels))return{contextFilters:[],preservedFiltersApplied:x};const w=l.labels;let E=[];if(!(0,ee.MX)(f.expr).queryWithParser)await this.datasource.languageProvider.start(y),E=this.datasource.languageProvider.getLabelKeys();else{const ie=(0,ee.pk)(f.expr);E=await this.datasource.languageProvider.fetchLabels({streamSelector:ie[0],timeRange:y})}const I=[];Object.entries(w).forEach(([ie,ue])=>{const fe=(0,q.Ed)(ie,l.dataFrame,l.rowIndex),je={label:ie,value:ue,enabled:E.includes(ie),nonIndexed:fe!==null&&fe!==R.HD.Indexed};I.push(je)});let z;const te=window.localStorage.getItem(Sr);if(te)try{z=JSON.parse(te)}catch{}if(z){let ie=!1;const ue=I.map(je=>z.removedLabels.includes(je.label)?(ie=!0,{...je,enabled:!1}):z.selectedExtractedLabels.includes(je.label)?(ie=!0,{...je,enabled:!0}):{...je});return ue.some(({enabled:je,nonIndexed:Ie})=>je&&!Ie)?(ie&&(x=!0),{contextFilters:ue,preservedFiltersApplied:x}):{contextFilters:I,preservedFiltersApplied:x}}else return{contextFilters:I,preservedFiltersApplied:x}},this.datasource=u,this.cachedContextFilters=[]}async getQueryAndRange(u,l,f,y=!0){const x=l&&l.direction||F.ZF.Backward,w=l&&l.limit||this.datasource.maxLines;if(this.cachedContextFilters.length===0||!y){const E=(await this.getInitContextFilters(u,f,{from:(0,at.KQ)(u.timeEpochMs),to:(0,at.KQ)(u.timeEpochMs),raw:{from:(0,at.KQ)(u.timeEpochMs),to:(0,at.KQ)(u.timeEpochMs)}})).contextFilters.filter(I=>I.enabled);this.cachedContextFilters=E}return await this.prepareLogRowContextQueryTarget(u,w,x,f)}async prepareLogRowContextQueryTarget(u,l,f,y){const x=this.prepareExpression(this.cachedContextFilters,y),w=2*60*60*1e3,E=f===F.ZF.Forward?R.ti.Forward:R.ti.Backward,I={expr:x,queryType:R.U3.Range,refId:`${ln}_${Math.random().toString()}`,maxLines:l,direction:E,datasource:{uid:this.datasource.uid,type:this.datasource.type}},te=new In.L(u.dataFrame).getFirstFieldOfType(ut.PU.time);if(te===void 0)throw new Error("loki: data frame missing time-field, should never happen");const ie=te.values[u.rowIndex],ue=(0,at.yT)(ie),fe=E===R.ti.Forward?{from:ue,to:(0,at.yT)(u.timeEpochMs+w)}:{from:(0,at.yT)(u.timeEpochMs-w),to:ue};return{query:I,range:{from:fe.from,to:fe.to,raw:fe}}}getLogRowContextUi(u,l,f){const y=x=>{this.cachedContextFilters=x,l&&l()};return this.onContextClose=this.onContextClose??(()=>{this.cachedContextFilters=[]}),fr({row:u,origQuery:f,updateFilter:y,onClose:this.onContextClose,logContextProvider:this,runContextQuery:l})}prepareExpression(u,l){let f=this.processContextFiltersToExpr(u,l);return window.localStorage.getItem(pr)==="true"&&(f=this.processPipelineStagesToExpr(f,l)),f}}var Kr=h(65474),Yr=h(29505),Bn=h(84596),Pr=h(10354);const nr=/^label_names\(\)\s*$/,Zr=/^label_values\((?:(.+),\s*)?([a-zA-Z_$][a-zA-Z0-9_]*)\)\s*$/;function jn(L){if(typeof L!="string")return L;const u={refId:"LokiVariableQueryEditor-VariableQuery",type:R.ie.LabelNames};if(L.match(nr))return{...u,type:R.ie.LabelNames};const f=L.match(Zr);return f?{...u,type:R.ie.LabelValues,label:f[2]?f[2]:f[1],stream:f[2]?f[1]:void 0}:u}const Fa=[{label:"Label names",value:R.ie.LabelNames},{label:"Label values",value:R.ie.LabelValues}],Qa="LokiVariableQueryEditor-VariableQuery",Ma=({onChange:L,query:u,datasource:l,range:f})=>{const[y,x]=(0,nt.useState)(void 0),[w,E]=(0,nt.useState)(""),[I,z]=(0,nt.useState)([]),[te,ie]=(0,nt.useState)(""),ue=(0,Bn.A)(y);(0,nt.useEffect)(()=>{if(!u)return;const Ae=typeof u=="string"?jn(u):u;x(Ae.type),E(Ae.label||""),ie(Ae.stream||"")},[u]),(0,nt.useEffect)(()=>{y!==R.ie.LabelValues||ue===y||l.languageProvider.fetchLabels({timeRange:f}).then(Ae=>{z(Ae.map(We=>({label:We,value:We})))})},[l,y,f,ue]);const fe=Ae=>{x(Ae.value),Ae.value!==void 0&&L({type:Ae.value,label:w,stream:te,refId:Qa})},je=Ae=>{E(Ae.value||"")},Ie=Ae=>{ie(Ae.currentTarget.value)},Ze=()=>{y!==void 0&&L({type:y,label:w,stream:te,refId:"LokiVariableQueryEditor-VariableQuery"})};return(0,Be.jsxs)(Be.Fragment,{children:[(0,Be.jsxs)(cr.C,{children:[(0,Be.jsx)(_t.I,{label:"Query type",labelWidth:20,children:(0,Be.jsx)(ur.l6,{"aria-label":"Query type",onChange:fe,onBlur:Ze,value:y,options:Fa,width:16})}),y===R.ie.LabelValues&&(0,Be.jsx)(Be.Fragment,{children:(0,Be.jsx)(_t.I,{label:"Label",labelWidth:20,children:(0,Be.jsx)(ur.l6,{"aria-label":"Label",onChange:je,onBlur:Ze,value:{label:w,value:w},options:I,width:16,allowCustomValue:!0})})})]}),y===R.ie.LabelValues&&(0,Be.jsx)(cr.C,{children:(0,Be.jsx)(_t.I,{label:"Stream selector",labelWidth:20,grow:!0,tooltip:(0,Be.jsx)("div",{children:'Optional. If defined, a list of values for the specified log stream selector is returned. For example: {label="value"} or {label="$variable"}'}),children:(0,Be.jsx)(Pr.p,{type:"text","aria-label":"Stream selector",placeholder:"Optional stream selector",value:te,onChange:Ie,onBlur:Ze})})})]})};class Na extends Yr.f5{constructor(u){super(),this.datasource=u,this.editor=Ma}async execute(u,l,f){return this.datasource.metricFindQuery(u,{scopedVars:l,range:f})}query(u){const l=this.execute(u.targets[0],u.scopedVars,u.range);return(0,Kr.H)(l).pipe((0,le.T)(f=>({data:f})))}}var Ba=h(14236),Fi=h(19347);function Un(L,u){if(!u.length)return[];const l=(0,N.groupBy)(u,"name"),f=Object.values(l).map(Jr),y=L.fields.find(w=>w.type===ut.PU.string);if(y===void 0)throw new Error("invalid logs-dataframe, string-field missing");const x=L.fields.find(w=>w.type===ut.PU.other&&w.name==="labels");for(let w=0;w<y.values.length;w++)for(const E of f)if(l[E.name][0].matcherType==="label"&&x){const I=x.values[w];if(I){const z=Object.keys(I).find(te=>l[E.name][0].matcherRegex===te);if(z){E.values.push(I[z]);continue}}E.values.push(null)}else if(l[E.name][0].matcherType==="regex"||l[E.name][0].matcherType===void 0){const z=y.values[w].match(l[E.name][0].matcherRegex);if(z&&z[1]){E.values.push(z[1]);continue}E.values.push(null)}else E.values.push(null);return f}function Jr(L){const u=(0,Fi.l)(),l=L.reduce((f,y)=>{if(y.datasourceUid){const x=u.getInstanceSettings(y.datasourceUid),w=E=>{switch(E){case"tempo":return"traceql";case"grafana-x-ray-datasource":return"getTrace";default:return}};f.push({title:y.urlDisplayLabel||"",url:"",internal:{query:{query:y.url,queryType:w(x?.type)},datasourceUid:y.datasourceUid,datasourceName:x?.name??"Data source not found"}})}else y.url&&f.push({title:y.urlDisplayLabel||"",url:y.url});return f},[]);return{name:L[0].name,type:ut.PU.string,config:{links:l},values:[]}}function ja(L){const u=L.filter(f=>f.refId!==void 0),l=(0,N.groupBy)(u,f=>f.refId);return Object.entries(l).map(([f,y])=>Ua(y,f))}function Ua(L,u){const l={name:"Time",config:{},values:[],type:ut.PU.time},f={name:`Value #${u}`,config:{},values:[],type:ut.PU.number},y=new Set(L.map(E=>E.fields.map(I=>Object.keys(I.labels??{})).flat()).flat()),w=Array.from(y).sort().map(E=>({name:E,config:{filterable:!0},values:[],type:ut.PU.string}));return L.forEach(E=>{const I=E.fields.find(fe=>fe.type===ut.PU.time),z=E.fields.find(fe=>fe.type===ut.PU.number);if(I==null||z==null)return;const te=I.values,ie=z.values;for(let fe of te)l.values.push(fe);for(let fe of ie)f.values.push(fe);const ue=z.labels??{};for(let fe of w){const je=ue[fe.name]??"";for(let Ie=0;Ie<ie.length;Ie++)fe.values.push(je)}}),{fields:[l,...w,f],refId:u,meta:{preferredVisualisationType:"table"},length:l.values.length}}function Wn(L){return L.fields.every(u=>u.type===ut.PU.time||u.type===ut.PU.number)}function qr(L,u){const{meta:l,...f}=L,y={...l,...u};return{...f,meta:y}}function Vn(L,u,l){const f={...L.meta?.custom,lokiQueryStatKey:"Summary: total bytes processed"};(0,P.nE)(L)&&(f.error="Error when parsing some of the logs");const y={preferredVisualisationType:"logs",limit:u?.maxLines,searchWords:u!==void 0?(0,ee.H0)(u.expr):void 0,custom:f},x=qr(L,y),w=Un(x,l);return{...x,fields:[...x.fields,...w]}}function Dr(L,u,l){return L.map(f=>{const y=f.refId!==void 0?u.get(f.refId):void 0;return Vn(f,y,l)})}function Wa(L){return L.length>0?ja(L):[]}function wr(L){const u={preferredVisualisationType:"graph"};return L.map(l=>qr(l,u))}function en(L,u){const l=[],f=[],y=[];return L.forEach(x=>{Wn(x)?x.refId!=null&&u.get(x.refId)?.queryType===R.U3.Instant?f.push(x):y.push(x):l.push(x)}),{streamsFrames:l,metricInstantFrames:f,metricRangeFrames:y}}function tn(L,u){if(L===void 0)return L;const{refId:l,message:f}=L;if(l===void 0||f===void 0)return L;const y=u.get(l);return y===void 0?L:f.includes("escape")&&y.expr.includes("\\")?{...L,message:`${f}. Make sure that all special characters are escaped with \\. For more information on escaping of special characters visit LogQL documentation at https://grafana.com/docs/loki/latest/logql/.`}:L}function kn(L,u,l){const{data:f,error:y,...x}=L,w=f.map(ie=>{if(!(0,Ba.ci)(ie))throw new Error("transformation only supports dataframe responses");return ie}),E=new Map(u.map(ie=>[ie.refId,ie])),{streamsFrames:I,metricInstantFrames:z,metricRangeFrames:te}=en(w,E);return{...x,error:tn(y,E),data:[...wr(te),...Wa(z),...Dr(I,E,l)]}}var Gn=h(9e4),Lr=h(81580),rn=h(67061),Xn=h(60016),Hn=h(95881);const Va=(0,nt.memo)(function(u){const{annotation:l,onAnnotationChange:f,history:y}=u;if(l===void 0||f===void 0)return null;const x=E=>{const I=(0,ee.vV)(E).queryType===R.U3.Instant;f({...l,expr:E.expr,maxLines:E.maxLines,instant:I})},w={refId:"",expr:l.expr,maxLines:l.maxLines,instant:l.instant,queryType:l.queryType};return(0,Be.jsxs)(rn.B,{gap:5,direction:"column",children:[(0,Be.jsx)(rn.B,{gap:0,direction:"column",children:(0,Be.jsx)(Hn.W,{datasource:u.datasource,query:w,onChange:x,onRunQuery:()=>{},history:y,ExtraFieldElement:(0,Be.jsx)(Xn.kl,{lineLimitValue:w?.maxLines?.toString()||"",resolution:w.resolution||1,query:w,onRunQuery:()=>{},onChange:x})})}),(0,Be.jsxs)(Gn.U,{children:[(0,Be.jsx)(Lr.c,{label:"Title",tooltip:"Use either the name or a pattern. For example, {{instance}} is replaced with label value for the label instance.",children:(0,Be.jsx)(Pr.p,{type:"text",placeholder:"alertname",value:l.titleFormat,onChange:E=>{f({...l,titleFormat:E.currentTarget.value})}})}),(0,Be.jsx)(Lr.c,{label:"Tags",children:(0,Be.jsx)(Pr.p,{type:"text",placeholder:"label1,label2",value:l.tagKeys,onChange:E=>{f({...l,tagKeys:E.currentTarget.value})}})}),(0,Be.jsx)(Lr.c,{label:"Text",tooltip:"Use either the name or a pattern. For example, {{instance}} is replaced with label value for the label instance.",children:(0,Be.jsx)(Pr.p,{type:"text",placeholder:"instance",value:l.textFormat,onChange:E=>{f({...l,textFormat:E.currentTarget.value})}})})]})]})});var nn=h(20065);function ka(L,u){if(u.length===0)return[];const l=[],{queryWithParser:f,parserCount:y}=(0,ee.MX)(L);if(!f){const{hasLogfmt:E,hasJSON:I,hasPack:z}=(0,P.YB)(u[0]);I&&(z?l.push({type:"ADD_UNPACK_PARSER",label:"Selected log stream selector has packed logs.",fix:{title:"add unpack parser",label:"Consider using unpack parser.",action:{type:"ADD_UNPACK_PARSER",query:L}}}):l.push({type:"ADD_JSON_PARSER",label:"Selected log stream selector has JSON formatted logs.",fix:{title:"add json parser",label:"Consider using JSON parser.",action:{type:"ADD_JSON_PARSER",query:L}}})),E&&l.push({type:"ADD_LOGFMT_PARSER",label:"Selected log stream selector has logfmt formatted logs.",fix:{title:"add logfmt parser",label:"Consider using logfmt parser to turn key-value pairs in your log lines to labels.",action:{type:"ADD_LOGFMT_PARSER",query:L}}})}if(f){if(y===1){const I=(0,ee.d_)(L);(0,P.db)(u[0])&&!I&&l.push({type:"ADD_NO_PIPELINE_ERROR",label:"Some logs in your selected log streams have parsing error.",fix:{title:"remove pipeline errors",label:"Consider filtering out logs with parsing errors.",action:{type:"ADD_NO_PIPELINE_ERROR",query:L}}})}(0,ee.pS)(L)||l.push({type:"ADD_LABEL_FILTER",label:"Consider filtering logs by their label and value.",fix:{title:"add label filter",label:"",action:{type:"ADD_LABEL_FILTER",query:L}}})}if(!(0,ee._i)(L)){const E=(0,P.Ac)(u[0]),I=(0,P.sz)(u[0]);!E&&I&&l.push({type:"ADD_LEVEL_LABEL_FORMAT",label:`Some logs in your selected log stream have "${I}" label.`,fix:{title:"add label level format",label:`If ${I} label has level values, consider using label_format to rename it to "level". Level label can be then visualized in log volumes.`,action:{type:"ADD_LEVEL_LABEL_FORMAT",query:L,options:{renameTo:"level",originalLabel:I}}}})}return(0,ee.Rn)(L)||l.push({type:"ADD_LINE_FILTER",label:"Consider filtering logs for specific string.",fix:{title:"add line filter",label:"",action:{type:"ADD_LINE_FILTER",query:L}}}),l}var zn=h(62938),Ga=h(33948),Xa=h(52622),Cr=h(70416),Ha=h(80822);function za(L,u,l){if(u-L<=l)return[[L,u]];const f=[];for(let y=u;y>L;y-=l){const x=Math.max(y-l,L);f.push([x,y])}return f.reverse(),f}function _a(L,u,l,f){if(f<l)return[[L,u]];const y=Math.trunc(f/l)*l,x=L-L%l,w=[];for(let E=x;E<u;E+=y){const I=Math.min(E+y-l,u);w.push([E,I])}return w}var _n=h(79007);function Rr(L,u,l,f){const y=u.from.toDate().getTime(),x=u.to.toDate().getTime();return(L?za(y,x,f):_a(y,x,l,f)).map(([E,I])=>{const z=(0,at.KQ)(E),te=(0,at.KQ)(I);return{from:z,to:te,raw:{from:z,to:te}}})}function Ka(L,u){return u?L.map(l=>{if(!l.maxLines||!(0,ee.sI)(l.expr))return l;const f=u.data.find(x=>x.refId===l.refId);if(!f)return l;const y=l.maxLines-f.length;return{...l,maxLines:y<0?0:y}}).filter(l=>l.maxLines===void 0||l.maxLines>0):L}function Ya(L,u){const l=u.length?u[0].request.queryGroupId:(0,zn.A)();let f={data:[],state:ge.Gu.Streaming,key:l};const y=Math.max(...u.map(({partition:te})=>te.length)),x=u.filter(({partition:te})=>te.length===y)[0].partition;let w=!1,E=null;const I=(te,ie,ue)=>{if(w){te.complete();return}const fe=()=>{f.state=ge.Gu.Done,te.next(f),te.complete()},je=()=>{const{nextRequestN:ze,nextRequestGroup:ke}=Ja(u,ue,ie);if(ze>0&&ke>=0){I(te,ze,ke);return}fe()},Ie=u[ue],Ze=Ie.partition[ie-1],Ae=Ka(Ie.request.targets,f);if(!Ae.length){je();return}const We={...u[ue].request,range:Ze,targets:Ae};Ie.request.requestId&&(We.requestId=`${Ie.request.requestId}_${ie}`),E=L.runQuery(We).subscribe({next:ze=>{f=(0,Ha.Wn)(f,ze),f=Za(f,We,x,ie),((f.errors??[]).length>0||f.error!=null)&&(w=!0)},complete:()=>{te.next(f),je()},error:ze=>{te.error(ze)}})};return new xt.c(te=>(I(te,y,0),()=>{w=!0,E?.unsubscribe()}))}const an="loki-splitting-progress";function Za(L,u,l,f){if((0,ee.sI)(u.targets[0].expr)||(L.data=L.data.filter(x=>x.name!==an),f<=1))return L;const y=(0,Ga.I)([{time:l[0].from.valueOf(),timeEnd:l[f-2].to.valueOf(),isRegion:!0,color:"rgba(120, 120, 120, 0.1)"}]);return y.name=an,y.meta={dataTopic:Xa.QR.Annotations},L.data.push(y),L}function Ja(L,u,l){for(let f=u+1;f<L.length;f++)if(L[f].partition[l-1])return{nextRequestGroup:f,nextRequestN:l};return{nextRequestGroup:L.findIndex(f=>f?.partition[l-1]!==void 0),nextRequestN:l-1}}function Qi(L){return L.queryType!==R.U3.Instant&&!(0,ee.Cg)(L.expr)}function qa(L,u){const l=u.targets.filter(ue=>!ue.hide).filter(ue=>ue.expr),[f,y]=(0,N.partition)(l,ue=>!Qi(ue)),[x,w]=(0,N.partition)(y,ue=>(0,ee.sI)(ue.expr));u.queryGroupId=(0,zn.A)();const E=24*60*60*1e3,I=(0,N.groupBy)(x,ue=>ue.splitDuration?(0,Cr.WT)((0,Cr.E9)(ue.splitDuration)):E),z=(0,N.groupBy)(w,ue=>ue.splitDuration?(0,Cr.WT)((0,Cr.E9)(ue.splitDuration)):E),te=[];for(const[ue,fe]of Object.entries(I)){const je=(0,N.groupBy)(fe,Ie=>Ie.resolution||1);for(const Ie in je)te.push({request:{...u,targets:je[Ie]},partition:Rr(!0,u.range,u.intervalMs,Number(ue))})}for(const[ue,fe]of Object.entries(z)){const je=(0,N.groupBy)(fe,Ie=>ei(u.intervalMs,u.range,Ie.resolution||1,Ie.step));for(const Ie in je){const Ze=je[Ie].map(Ae=>{const{maxLines:We,...ze}=Ae;return ze});te.push({request:{...u,targets:Ze},partition:Rr(!1,u.range,Number(Ie),Number(ue))})}}f.length&&te.push({request:{...u,targets:f},partition:[u.range]});const ie=new Date;return Ya(L,te).pipe((0,ce.M)(ue=>{ue.state===ge.Gu.Done&&(0,_n.uJ)(ue,te,u,ie,{predefinedOperations:L.predefinedOperations})}))}function ei(L,u,l,f){const y=/(-?\d+(?:\.\d+)?)(ms|[Mwdhmsy])/;if(f?.match(y))return oe.intervalToMs(f)*l;const x=L*l,w=Math.round((u.to.valueOf()-u.from.valueOf())/11e3);return Math.max(x,w)}var Kn=h(56245),ti=h(72316),Mi=h(9631),ri=h(55004),on=h(78731);async function se(L){const u=JSON.stringify({expr:L.expr}),l=new TextEncoder().encode(u),f=await crypto.subtle.digest("SHA-1",l);return Array.from(new Uint8Array(f.slice(0,8))).map(x=>x.toString(16).padStart(2,"0")).join("")}function ot(L,u,l){const f=l.range,y=f.to.valueOf()-f.from.valueOf()+1e3;let x=l.maxDataPoints??1e3;x>100&&(x*=2);let w;const E=I=>{if(I?.message){const z=I.message;w?w.push(z):w=Mi.k9.fromDataFrameJSON(z,{maxLength:x,maxDelta:y,displayNameFormat:L.legendFormat})}return w};return(0,ti.v)(()=>se(L)).pipe((0,ve.Z)(I=>(0,on.oF)().getStream({scope:ri.qD.DataSource,namespace:u.uid,path:`tail/${I}`,data:{...L,timeRange:{from:f.from.valueOf().toString(),to:f.to.valueOf().toString()}}}).pipe((0,le.T)(z=>{const te=E(z);return{data:te?[te]:[],state:ge.Gu.Streaming}}))))}const sn=L=>{let l=`${window.location.protocol==="https:"?"wss://":"ws://"}${window.location.host}${Se.$.appSubUrl}`;return l.endsWith("/")&&(l=l.slice(0,-1)),`${l}${L}`},Yn=1e3,Tr=10,ni="/loki/api/v1",st="loki-data-samples",ar="annotation-",ln="log-row-context-query-",Zn="log-volume-",Jn="log-sample-",qn="log-stats-",ea=1e6;function Ir(L,u,l,f,y){const x=oe.calculateInterval(u,1);return{targets:[L],requestId:f,interval:x.interval,intervalMs:x.intervalMs,range:u,scopedVars:{},timezone:"UTC",app:l,startTime:Date.now(),hideFromInspector:y}}class ai extends Ce.iy{constructor(u,l=(0,me.w)()){super(u),this.instanceSettings=u,this.templateSrv=l,this.streams=new zt,this.runLiveQuery=(y,x)=>{const w=this.createLiveTarget(y,x);return this.streams.getStream(w).pipe((0,le.T)(E=>({data:E||[],key:`loki-${w.refId}`,state:ge.Gu.Streaming})),(0,d.W)(E=>(0,Ee.$)(()=>`Live tailing was stopped due to following error: ${E.reason}`)))},this.getLogRowContext=async(y,x,w)=>await this.logContextProvider.getLogRowContext(y,x,(0,ee.sc)(w)),this.getLogRowContextQuery=async(y,x,w,E)=>await this.logContextProvider.getLogRowContextQuery(y,x,(0,ee.sc)(w),E),this.languageProvider=new K(this);const f=u.jsonData||{};this.maxLines=parseInt(f.maxLines??"0",10)||Yn,this.predefinedOperations=f.predefinedOperations??"",this.annotations={QueryEditor:Va},this.variables=new Na(this),this.logContextProvider=new _r(this)}getSupplementaryRequest(u,l,f){switch(u){case F.cF.LogsVolume:const y=f?.type===F.cF.LogsVolume?f:{type:u};return this.getLogsVolumeDataProvider(l,y);case F.cF.LogsSample:const x=f?.type===F.cF.LogsSample?f:{type:u};return this.getLogsSampleDataProvider(l,x);default:return}}getSupportedSupplementaryQueryTypes(){return[F.cF.LogsVolume,F.cF.LogsSample]}getSupplementaryQuery(u,l){const f=(0,ee.vV)(l);let y=(0,qe.Lv)(f.expr),x=!1;switch(u.type){case F.cF.LogsVolume:if(x=!!(y&&(0,ee.sI)(y)&&f.queryType===R.U3.Range),!x)return;const w=`${y} | drop __error__`,E=u.field||"level";return(0,ee.FV)(this.interpolateString(w,nn.a))===!1&&(y=w),{...f,refId:`${Zn}${f.refId}`,queryType:R.U3.Range,supportingQueryType:R.Q$.LogsVolume,expr:`sum by (${E}) (count_over_time(${y}[$__auto]))`,legendFormat:`{{ ${E} }}`};case F.cF.LogsSample:return x=!!(y&&!(0,ee.sI)(y)),x?{...f,queryType:R.U3.Range,refId:`${Jn}${f.refId}`,expr:(0,ee.OT)(y),maxLines:Number.isNaN(Number(u.limit))?this.maxLines:Number(u.limit)}:void 0;default:return}}getLogsVolumeDataProvider(u,l){const f=(0,N.cloneDeep)(u),y=f.targets.map(x=>this.getSupplementaryQuery(l,x)).filter(x=>!!x);if(y.length)return{...f,targets:y}}getLogsSampleDataProvider(u,l){const f=(0,N.cloneDeep)(u),y=f.targets.map(x=>this.getSupplementaryQuery({type:F.cF.LogsSample,limit:100},x)).filter(x=>!!x);if(y.length)return{...f,targets:y}}query(u){const l=u.targets.map(ee.vV).map(w=>({...w,maxLines:w.maxLines??this.maxLines})),f={...u,targets:l},y=f.targets.filter(w=>w.queryType===R.U3.Stream);if(Se.$.featureToggles.lokiExperimentalStreaming&&y.length>0&&f.rangeRaw?.to==="now"){const w={...f,targets:y};return(0,H.h)(...y.map(E=>ot(this.applyTemplateVariables(E,u.scopedVars,u.filters),this,w)))}if(f.liveStreaming)return this.runLiveQueryThroughBackend(f);if(Se.$.featureToggles.lokiQuerySplitting&&(0,ee.gy)(f.targets))return qa(this,f);const x=new Date;return this.runQuery(f).pipe((0,ce.M)(w=>(0,_n.Ex)(w,f,x,{predefinedOperations:this.predefinedOperations})))}runQuery(u){return super.query(u).pipe((0,le.T)(l=>kn(l,u.targets,this.instanceSettings.jsonData.derivedFields??[])))}runLiveQueryThroughBackend(u){const l=u.targets.filter(y=>y.expr!==""&&(0,ee.sI)(y.expr));if(l.length===0)return(0,b.of)({data:[],state:ge.Gu.Done});const f=l.map(y=>{const x=this.applyTemplateVariables(y,u.scopedVars,u.filters),w=x.maxLines||this.maxLines;return this.runLiveQuery(x,w)});return(0,H.h)(...f)}createLiveTarget(u,l){const f=u.expr,y=this.instanceSettings.url,x=xe.kM.serializeParams({query:f});return{query:f,url:sn(`${y}/loki/api/v1/tail?${x}`),refId:u.refId,size:l}}interpolateVariablesInQueries(u,l,f){let y=u;return u&&u.length&&(y=u.map(x=>({...x,datasource:this.getRef(),expr:this.addAdHocFilters(this.templateSrv.replace(x.expr,l,this.interpolateQueryExpr),f)}))),y}getQueryDisplayText(u){return u.expr}getTimeRangeParams(u){return{start:u.from.valueOf()*ea,end:u.to.valueOf()*ea}}async importFromAbstractQueries(u){await this.languageProvider.start();const l=this.languageProvider.labelKeys;return l&&l.length&&(u=u.map(f=>(f.labelMatchers=f.labelMatchers.filter(y=>l.includes(y.name)),f))),u.map(f=>this.languageProvider.importFromAbstractQuery(f))}async exportToAbstractQueries(u){return u.map(l=>this.languageProvider.exportToAbstractQuery(l))}async metadataRequest(u,l,f){if(u.startsWith("/"))throw new Error(`invalid metadata request url: ${u}`);return(await this.getResource(u,l,f)).data||[]}async statsMetadataRequest(u,l,f){if(u.startsWith("/"))throw new Error(`invalid metadata request url: ${u}`);return await this.getResource(u,l,f)}async getQueryStats(u,l){if((0,ee.FV)(this.interpolateString(u.expr,nn.a)))return;const f=(0,ee.pk)(u.expr);let y={streams:0,chunks:0,bytes:0,entries:0};for(const x in f){const{start:w,end:E}=this.getStatsTimeRange(u,Number(x),l);if(w===void 0||E===void 0)return{streams:0,chunks:0,bytes:0,entries:0,message:"Query size estimate not available."};try{const I=await this.statsMetadataRequest("index/stats",{query:f[x],start:w,end:E},{showErrorAlert:!1,requestId:`${qn}${u.refId}`});y={streams:y.streams+I.streams,chunks:y.chunks+I.chunks,bytes:y.bytes+I.bytes,entries:y.entries+I.entries}}catch{break}}return y}getStatsTimeRange(u,l,f){let y,x;const I=(0,ee.QH)(u.expr,[ye.dw]).map(z=>u.expr.substring(z.from,z.to));return(0,ee.sI)(u.expr)?u.queryType===R.U3.Instant?{start:void 0,end:void 0}:this.getTimeRangeParams(f):u.queryType===R.U3.Instant?I[l]?(x=this.getTimeRangeParams(f).end,y=x-oe.intervalToMs(I[l])*1e6,{start:y,end:x}):/(\$__auto|\$__range)/.test(u.expr)?this.getTimeRangeParams(f):{start:void 0,end:void 0}:this.getTimeRangeParams(f)}async getStats(u,l){if(!u.expr)return null;const f=await this.getQueryStats(u,l);return f?Object.values(f).every(y=>y===0)?null:f:null}async metricFindQuery(u,l){if(!u)return Promise.resolve([]);let f;return typeof u=="string"?f=this.parseStringToVariableQuery(this.interpolateString(u,l?.scopedVars)):f={...u,label:this.interpolateString(u.label||"",l?.scopedVars),stream:this.interpolateString(u.stream||"",l?.scopedVars)},f?await this.processMetricFindQuery(f,l?.range):Promise.resolve([])}async processMetricFindQuery(u,l){return u.type===R.ie.LabelNames?(await this.languageProvider.fetchLabels({timeRange:l})).map(x=>({text:x})):u.label?(await this.languageProvider.fetchLabelValues(u.label,{streamSelector:u.stream,timeRange:l})).map(y=>({text:y})):[]}parseStringToVariableQuery(u){const l="LokiVariableQueryEditor-VariableQuery";if(u.match(nr))return{type:R.ie.LabelNames,refId:l};const y=u.match(Zr);if(y)return{type:R.ie.LabelValues,label:y[2],stream:y[1],refId:l}}async getDataSamples(u,l){if(!(0,ee.sI)(u.expr)||(0,ee.FV)(this.interpolateString(u.expr,nn.a)))return[];const f={expr:u.expr,queryType:R.U3.Range,refId:st,maxLines:u.maxLines||Tr,supportingQueryType:R.Q$.DataSample},y=Ir(f,l,Fe.Jk.Unknown,st,!0);return await(0,S.s)(this.query(y).pipe((0,G.n)(x=>(0,b.of)(x.data))))}async getTagKeys(u){let l="{}";for(const y of u?.filters??[])l=(0,qe.tE)(l,y.key,y.operator,y.value);return(await this.languageProvider.fetchLabels({timeRange:u?.timeRange,streamSelector:l})).map(y=>({text:y}))}async getTagValues(u){let l="{}";for(const y of u?.filters??[])l=(0,qe.tE)(l,y.key,y.operator,y.value);return(await this.languageProvider.fetchLabelValues(u.key,{timeRange:u.timeRange,streamSelector:l})).map(y=>({text:y}))}interpolateQueryExpr(u,l){return!l.multi&&!l.includeAll?bt(u):typeof u=="string"?ta(u):(0,N.map)(u,ta).join("|")}toggleQueryFilter(u,l){let f=u.expr??"";const y=(0,q.Ed)(l.options.key,l.frame,0);switch(l.type){case"FILTER_FOR":{if(l.options?.key&&l.options?.value){const x=(0,q.Bb)(l.options.value);f=(0,qe.je)(f,l.options.key,"=",x)?(0,qe.FN)(f,l.options.key,"=",x):(0,qe.tE)(f,l.options.key,"=",x,y)}break}case"FILTER_OUT":{if(l.options?.key&&l.options?.value){const x=(0,q.Bb)(l.options.value);(0,qe.je)(f,l.options.key,"=",x)&&(f=(0,qe.FN)(f,l.options.key,"=",x)),f=(0,qe.tE)(f,l.options.key,"!=",x,y)}break}default:break}return{...u,expr:f}}queryHasFilter(u,l){let f=u.expr??"";return(0,qe.je)(f,l.key,"=",l.value)}modifyQuery(u,l){let f=u.expr??"";switch(l.type){case"ADD_FILTER":{if(l.options?.key&&l.options?.value){const y=(0,q.Ed)(l.options.key,l.frame,0),x=(0,q.Bb)(l.options.value);f=(0,qe.tE)(f,l.options.key,"=",x,y)}break}case"ADD_FILTER_OUT":{if(l.options?.key&&l.options?.value){const y=(0,q.Ed)(l.options.key,l.frame,0),x=(0,q.Bb)(l.options.value);f=(0,qe.tE)(f,l.options.key,"!=",x,y)}break}case"ADD_LOGFMT_PARSER":{f=(0,qe.aH)(f,"logfmt");break}case"ADD_JSON_PARSER":{f=(0,qe.aH)(f,"json");break}case"ADD_UNPACK_PARSER":{f=(0,qe.aH)(f,"unpack");break}case"ADD_NO_PIPELINE_ERROR":{f=(0,qe.yI)(f);break}case"ADD_LEVEL_LABEL_FORMAT":{l.options?.originalLabel&&l.options?.renameTo&&(f=(0,qe.o9)(f,{renameTo:l.options.renameTo,originalLabel:l.options.originalLabel}));break}case"ADD_LABEL_FILTER":{const y=(0,qe.cH)(u.expr),x=(0,qe.lN)(u.expr),w=(0,qe.lq)([...y,...x]),E=(0,qe.i6)("","","=");f=(0,qe.cQ)(f,[w],E);break}case"ADD_STRING_FILTER":case"ADD_LINE_FILTER":{f=(0,qe.OS)(f,l.options?.value);break}case"ADD_STRING_FILTER_OUT":case"ADD_LINE_FILTER_OUT":{f=(0,qe.OS)(f,l.options?.value,"!=");break}default:break}return{...u,expr:f}}getSupportedQueryModifications(){return["ADD_FILTER","ADD_FILTER_OUT","ADD_LOGFMT_PARSER","ADD_JSON_PARSER","ADD_UNPACK_PARSER","ADD_NO_PIPELINE_ERROR","ADD_LEVEL_LABEL_FORMAT","ADD_LABEL_FILTER","ADD_STRING_FILTER","ADD_STRING_FILTER_OUT"]}getLogRowContextUi(u,l,f){return this.logContextProvider.getLogRowContextUi(u,l,(0,ee.sc)(f))}async annotationQuery(u){const{expr:l,maxLines:f,instant:y,tagKeys:x="",titleFormat:w="",textFormat:E=""}=u.annotation;if(!l)return[];const I=`${ar}${u.annotation.name}`,z={refId:I,expr:l,maxLines:f,instant:y,queryType:y?R.U3.Instant:R.U3.Range},te=Ir(z,u.range,Fe.Jk.Dashboard,I),{data:ie}=await(0,S.s)(this.query(te)),ue=[],fe=x.split(",").filter(je=>je!=="");for(const je of ie)new W.R(je).forEach(Ze=>{const{labels:Ae}=Ze,We=Object.entries(Ae).map(([ke,et])=>[ke,et.trim()]).filter(([ke,et])=>!(et===""||fe.length&&!fe.includes(ke))).map(([ke,et])=>et),ze=Array.from(new Set(We));ue.push({time:new Date(Ze.Time).valueOf(),title:(0,Le.j)(w,Ae),text:(0,Le.j)(E,Ae)||Ze.Line,tags:ze})});return ue}addAdHocFilters(u,l){if(!l?.length)return u;let f=(0,Kn.qk)(u);return f=l.reduce((y,x)=>{const{key:w,operator:E}=x;let{value:I}=x;return(0,q.N4)(E)?I=bt(I):I=(0,q.Bb)(I,E),(0,qe.tE)(y,w,E,I)},f),(0,Kn.If)(f)}filterQuery(u){return!(u.hide||u.expr==="")}applyTemplateVariables(u,l,f){const{__auto:y,__interval:x,__interval_ms:w,__range:E,__range_s:I,__range_ms:z,...te}=l||{},ie={...te,__interval:{value:"$__interval"},__interval_ms:{value:"$__interval_ms"}},ue=this.addAdHocFilters(this.templateSrv.replace(u.expr,ie,this.interpolateQueryExpr),f);return{...u,legendFormat:this.templateSrv.replace(u.legendFormat,te),expr:ue}}interpolateString(u,l){return this.templateSrv.replace(u,l,this.interpolateQueryExpr)}getVariables(){return this.templateSrv.getVariables().map(u=>`$${u.name}`)}getQueryHints(u,l){return ka(u.expr,l)}getDefaultQuery(u){const l={refId:"A",expr:""};return u===Fe.Jk.UnifiedAlerting?{...l,queryType:R.U3.Instant}:{...l,queryType:R.U3.Range}}}function bt(L){return typeof L=="string"?L.replace(/'/g,"\\\\'"):L}function ta(L){return typeof L=="string"?bt(L.replace(/\\/g,"\\\\\\\\").replace(/[$^*{}\[\]+?.()|]/g,"\\\\$&")):L}},97535:(rt,Ne,h)=>{"use strict";h.d(Ne,{Bb:()=>xe,Cs:()=>F,Ed:()=>Le,N4:()=>Fe,P7:()=>Se,Qn:()=>oe,WV:()=>d,qv:()=>ge,sM:()=>Ce,tY:()=>W,tt:()=>me});var N=h(2543),Ee=h.n(N),H=h(73372),b=h(13137);function S(de){return le(de/1e3)}function le(de){return Math.floor(de/60)}function d(de,we){if(de&&we){const De=S(de.from.valueOf())===S(we.from.valueOf()),Y=S(de.to.valueOf())===S(we.to.valueOf());return!(De&&Y)}return!1}const ce=/[*+?()|\\.\[\]{}^$]/g;function G(de){return de.replace(ce,"\\$&")}function oe(de){return de.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/"/g,'\\"')}function ge(de){return de.replace(/\\n/g,`
`).replace(/\\"/g,'"').replace(/\\\\/g,"\\")}function F(de){return oe(G(de))}function xe(de,we){return Fe(we)?F(de):oe(de)}function Fe(de){return!!(de&&(de.includes("=~")||de.includes("!~")))}function W(de){const we=["b","kib","Kib","kb","KB","mib","Mib","mb","MB","gib","Gib","gb","GB","tib","Tib","tb","TB","pib","Pib","pb","PB","eib","Eib","eb","EB"],De=new RegExp(`^(?:-?\\d+(?:\\.\\d+)?)(?:${we.join("|")})$`);return!!de.match(De)}function Le(de,we,De){if(!we||De===void 0)return null;const Y=we.fields.find(Qe=>Qe.name==="labelTypes")?.values[De];if(!Y)return null;switch(Y[de]){case"I":return b.HD.Indexed;case"S":return b.HD.StructuredMetadata;case"P":return b.HD.Parsed;default:return null}}const ye={[H.D_.Equal]:"=",[H.D_.NotEqual]:"!=",[H.D_.EqualRegEx]:"=~",[H.D_.NotEqualRegEx]:"!~"},Ce=(0,N.invert)(ye);function me(de){const we=de.labelMatchers.map(De=>{const Y=ye[De.operator];return Y?`${De.name}${Y}"${De.value}"`:""}).filter(De=>De!=="").join(", ");return we?`{${we}}`:""}function Se(de){const we={};de.forEach(Y=>{Object.keys(Y).forEach(Qe=>{we[Qe]||(we[Qe]=new Set),we[Qe].has(Y[Qe])||we[Qe].add(Y[Qe])})});const De={};return Pe(Object.keys(we)).forEach(Y=>{De[Y]=Pe(Array.from(we[Y]))}),{values:De,keys:Object.keys(De)}}const he=1e4;function Pe(de){return de.slice(0,he)}},12798:(rt,Ne,h)=>{"use strict";h.d(Ne,{Ch:()=>G,FN:()=>ge,Lv:()=>Se,OS:()=>_,aH:()=>ye,cH:()=>Pe,cQ:()=>Me,i6:()=>Y,je:()=>oe,lN:()=>de,lq:()=>B,o9:()=>me,tE:()=>W,yB:()=>he,yI:()=>Ce});var N=h(2543),Ee=h.n(N),H=h(36195),b=h(97535),S=h(56587),le=h(43548),d=h(60706),ce=h(13137);class G{constructor(R,Q,V){this.from=R,this.to=Q,this.type=V}static fromNode(R){return new G(R.from,R.to,R.type)}contains(R){return this.from<=R.from&&this.to>=R.to}getExpression(R){return R.substring(this.from,this.to)}}function oe(P,R,Q,V){return Fe(P,R,Q,V).length>0}function ge(P,R,Q,V){const K=Fe(P,R,Q,V);for(const ae of K)P=ae.parent?.type.id===H.bY?F(P,ae):xe(P,ae);return P}function F(P,R){const Q=R.parent?.parent;return!Q||Q.type.id!==H.t3?P:(P.substring(0,Q.from)+P.substring(Q.to)).trim()}function xe(P,R){let Q=R;do Q=Q.parent;while(Q&&Q.type.id!==H.MD);const V=R.getChild(H.gw);if(!Q||!V)return P;const K=P.substring(V.from,V.to),ae=P.substring(0,Q.from),Oe=P.substring(Q.to),ve=(0,d.u_)(P.substring(Q.from,Q.to));return ve.query.labels=ve.query.labels.filter(He=>He.label!==K),ae+le.y.renderQuery(ve.query)+Oe}function Fe(P,R,Q,V){const K=H.K3.parse(P),ae=[];return K.iterate({enter:({type:Oe,node:ve})=>{Oe.id===H.g$&&ae.push(ve)}}),ae.filter(Oe=>{const ve=Oe.getChild(H.gw),He=ve?.nextSibling,_e=Oe.getChild(H.Qf);if(!ve||!He||!_e||P.substring(ve.from,ve.to)!==R)return!1;const Pt=P.substring(_e.from,_e.to);return!((0,d.w4)(Pt)!==(0,b.qv)(V)||P.substring(He.from,He.to)!==Q)})}function W(P,R,Q,V,K){if(!R||!V)throw new Error("Need label to add to query.");const ae=he(P);if(!ae.length)return P;const Oe=Pe(P),ve=de(P),He=ee(P),_e=(0,S.TQ)(P,[H.J_]);K||Ve(P).map(Vt=>Vt.getExpression(P)).includes(R)&&(K=ce.HD.Indexed);const lt=ae.every(xt=>He.some(sr=>sr.from>=xt.from&&sr.to<=xt.to)),Pt=Y(R,V,Q);if(K===ce.HD.Parsed||K===ce.HD.StructuredMetadata){const xt=Le(P,[...ae,...ve,...Oe,..._e]);return Me(P,xt,Pt)}else{if(K===ce.HD.Indexed)return Qe(P,ae,Pt);if(Oe.length===0||lt===!1)return Qe(P,ae,Pt);{const xt=Le(P,[...Oe,...ve,..._e]);return Me(P,xt,Pt)}}}function Le(P,R){const Q=k((0,S.TQ)(P,[H.GN])),V=[...R];return Q.map(ae=>B(V.filter(Oe=>ae.contains(Oe))))}function ye(P,R){const Q=we(P);if(Q.length)return Ye(P,Q,R);{const V=he(P);return V.length?Ye(P,V,R):P}}function Ce(P){const R=Pe(P);if(!R.length)return P;const Q=Y("__error__","","=");return Me(P,R,Q)}function me(P,R){const Q=De(P);return T(P,Q,R)}function Se(P){const R=pe(P);if(!R.length)return P;let Q="",V=0;for(let K of R)Q=Q+P.substring(V,K.from),V=K.to;return Q=Q+P.substring(V),Q}function he(P){const R=H.K3.parse(P),Q=[];return R.iterate({enter:({type:V,node:K})=>{if(V.id===H.MD)return Q.push(G.fromNode(K)),!1}}),Q}function Pe(P){const R=H.K3.parse(P),Q=[],V=[H.iT,H.eF,H.Zj,H.Tz];return R.iterate({enter:({type:K,node:ae})=>{if(V.includes(K.id))return Q.push(G.fromNode(ae)),!1}}),Q}function de(P){const R=H.K3.parse(P),Q=[];return R.iterate({enter:({type:V,node:K})=>{if(V.id===H.bY)return Q.push(G.fromNode(K)),!1}}),Q}function we(P){const R=H.K3.parse(P),Q=[];return R.iterate({enter:({type:V,node:K})=>{if(V.id===H.CX)return Q.push(G.fromNode(K)),!1}}),Q}function De(P){const R=H.K3.parse(P),Q=[];return R.iterate({enter:({type:V,node:K})=>{if(V.id===H.UK)return Q.push(G.fromNode(K)),!1;if(V.id===H.xo){const ae=[],Oe=K.getChild(H.MD);Oe&&ae.push(G.fromNode(Oe));const ve=K.getChild(H.AL);ve&&ae.push(G.fromNode(ve));const He=K.getChild(H.HV);He&&ae.push(G.fromNode(He));const _e=(0,N.sortBy)(ae,lt=>lt.to);return Q.push(new G(_e[0].from,_e[_e.length-1].to)),!1}}}),Q}function Y(P,R,Q){return{label:P,op:Q,value:R}}function Qe(P,R,Q){let V="",K=0;for(let ae=0;ae<R.length;ae++){const Oe=R[ae],ve=ae===R.length-1,He=P.substring(K,Oe.from),_e=ve?P.substring(Oe.to):"",lt=(0,d.u_)(P.substring(Oe.from,Oe.to));ne(lt.query.labels,Q)||lt.query.labels.push(Q);const Pt=le.y.renderQuery(lt.query);V+=He+Pt+_e,K=Oe.to}return V}function Me(P,R,Q){let V="",K=0;for(let ae=0;ae<R.length;ae++){const Oe=R[ae],ve=ae===R.length-1,He=P.substring(K,Oe.to),_e=ve?P.substring(Oe.to):"";let lt="";!Number.isNaN(Number(Q.value))&&(Q.op==="<"||Q.op===">")?lt=` | ${Q.label}${Q.op}${Number(Q.value)}`:lt=` | ${Q.label}${Q.op}\`${(0,b.qv)(Q.value)}\``,V+=He+lt+_e,K=Oe.to}return V}function Ye(P,R,Q){let V="",K=0;for(let ae=0;ae<R.length;ae++){const Oe=R[ae],ve=ae===R.length-1,He=P.substring(K,Oe.to),_e=ve?P.substring(Oe.to):"";V+=He+` | ${Q}`+_e,K=Oe.to}return V}function T(P,R,Q){let V="",K=0;for(let ae=0;ae<R.length;ae++){const Oe=R[ae],ve=ae===R.length-1,He=P.substring(K,Oe.to),_e=ve?P.substring(Oe.to):"",lt=` | label_format ${Q.renameTo}=${Q.originalLabel}`;V+=He+lt+_e,K=Oe.to}return V}function _(P,R="",Q="|="){const V=he(P);if(!V.length)return P;const K=V[0].to;return P.slice(0,K)+` ${Q} \`${R}\``+P.slice(K)}function pe(P){const R=H.K3.parse(P),Q=[];return R.iterate({enter:({type:V,from:K,to:ae})=>{if(V.id===H.uk)return Q.push(new G(K,ae,V)),!1}}),Q}function ne(P,R){return P.find(Q=>Q.label===R.label&&Q.value===R.value)}function B(P){return P.length?P.reduce((R,Q)=>R.to>Q.to?R:Q):new G(0,0)}function k(P){return P.filter(R=>P.every(Q=>R.contains(Q)===!1||R===Q))}function q(P,R){if(P.type.id===R)return[G.fromNode(P)];const Q=[];let V=0,K=P.childAfter(V);for(;K;)Q.push(...q(K,R)),V=K.to,K=P.childAfter(V);return Q}function ee(P){const R=H.K3.parse(P),Q=[];return R.iterate({enter:({node:V})=>{V.type.id===H.MD&&Q.push(...q(V,H.g$))}}),Q}function Ve(P){const R=H.K3.parse(P),Q=[];return R.iterate({enter:({node:V})=>{V.type.id===H.MD&&Q.push(...q(V,H.gw))}}),Q}},99656:(rt,Ne,h)=>{"use strict";h.r(Ne),h.d(Ne,{plugin:()=>Ym});var N=h(40187),Ee=h(69129),H=h(3591),b=h(74848),S=h(32196),le=h(2543),d=h(96540),ce=h(14110),G=h(40845),oe=h(97535);const ge=['{job="default/prometheus"}'],F=["job","app","k8s_app"],xe=5,Fe=[{title:"Log pipeline",expression:'{job="mysql"} |= "metrics" | logfmt | duration > 10s',label:'This query targets the MySQL job, keeps logs that contain the substring "metrics", and then parses and filters the logs further.'},{title:"Count over time",expression:'count_over_time({job="mysql"}[5m])',label:"This query counts all the log lines within the last five minutes for the MySQL job."},{title:"Rate",expression:'rate(({job="mysql"} |= "error" != "timeout")[10s])',label:"This query gets the per-second rate of all non-timeout errors within the last ten seconds for the MySQL job."},{title:"Aggregate, count, and group",expression:'sum(count_over_time({job="mysql"}[5m])) by (level)',label:"Get the count of logs during the last five minutes, grouping by level."}];class W extends d.PureComponent{constructor(){super(...arguments),this.state={userExamples:[]},this.checkUserLabels=async()=>{const t=this.props.datasource?.languageProvider;if(t.started){const r=t.getLabelKeys()||[],n=F.find(a=>r.includes(a));if(n){const a=await t.fetchLabelValues(n),i=(0,le.shuffle)(a).slice(0,xe).map(o=>`{${n}="${(0,oe.Qn)(o)}"}`);this.setState({userExamples:i})}}else this.scheduleUserLabelChecking()}}componentDidMount(){this.scheduleUserLabelChecking(),(0,ce.rR)("grafana_loki_cheatsheet_opened",{})}componentWillUnmount(){clearTimeout(this.userLabelTimer)}scheduleUserLabelChecking(){this.userLabelTimer=setTimeout(this.checkUserLabels,1e3)}renderExpression(t){const{onClickExample:r,theme:n}=this.props,a=ye(n),i=o=>{r(o),(0,ce.rR)("grafana_loki_cheatsheet_example_clicked",{})};return(0,b.jsx)("button",{type:"button",className:a.cheatSheetExample,onClick:()=>i({refId:"A",expr:t}),children:(0,b.jsx)("code",{children:t})},t)}render(){const{userExamples:t}=this.state,{theme:r}=this.props,n=t.length>0,a=ye(r);return(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{children:"Loki Cheat Sheet"}),(0,b.jsxs)("div",{className:a.cheatSheetItem,children:[(0,b.jsx)("div",{className:a.cheatSheetItemTitle,children:"See your logs"}),"Start by selecting a log stream from the Label browser, or alternatively you can write a stream selector into the query field.",n?(0,b.jsxs)("div",{children:["Here are some example streams from your logs:",t.map(i=>this.renderExpression(i))]}):(0,b.jsxs)("div",{children:["Here is an example of a log stream:",this.renderExpression(ge[0])]})]}),(0,b.jsxs)("div",{className:a.cheatSheetItem,children:[(0,b.jsx)("div",{className:a.cheatSheetItemTitle,children:"Combine stream selectors"}),this.renderExpression('{app="cassandra",namespace="prod"}'),"Returns all log lines from streams that have both labels."]}),(0,b.jsxs)("div",{className:a.cheatSheetItem,children:[(0,b.jsx)("div",{className:a.cheatSheetItemTitle,children:"Filtering for search terms."}),this.renderExpression('{app="cassandra"} |~ "(duration|latency)s*(=|is|of)s*[d.]+"'),this.renderExpression('{app="cassandra"} |= "exact match"'),this.renderExpression('{app="cassandra"} != "do not match"'),(0,b.jsx)("a",{href:"https://grafana.com/docs/loki/latest/logql/#log-pipeline",target:"logql",children:"LogQL"})," ","supports exact and regular expression filters."]}),Fe.map(i=>(0,b.jsxs)("div",{className:a.cheatSheetItem,children:[(0,b.jsx)("div",{className:a.cheatSheetItemTitle,children:i.title}),this.renderExpression(i.expression),i.label]},i.expression))]})}}const Le=(0,G.cV)(W),ye=e=>({cheatSheetItem:(0,S.css)({margin:e.spacing(3,0)}),cheatSheetItemTitle:(0,S.css)({fontSize:e.typography.h3.fontSize}),cheatSheetExample:(0,S.css)({margin:e.spacing(.5,0),textAlign:"left",border:"none",background:"transparent",display:"block"})});var Ce=h(41987),me=h(84596),Se=h(39070),he=h(13544),Pe=h(42952),de=h(6191),we=h(15292),De=h(46819),Y=Object.defineProperty,Qe=Object.defineProperties,Me=Object.getOwnPropertyDescriptors,Ye=Object.getOwnPropertySymbols,T=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable,pe=(e,t,r)=>t in e?Y(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ne=(e,t)=>{for(var r in t||(t={}))T.call(t,r)&&pe(e,r,t[r]);if(Ye)for(var r of Ye(t))_.call(t,r)&&pe(e,r,t[r]);return e},B=(e,t)=>Qe(e,Me(t)),k=(e,t)=>{var r={};for(var n in e)T.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&Ye)for(var n of Ye(e))t.indexOf(n)<0&&_.call(e,n)&&(r[n]=e[n]);return r};function q(e){var t=e,{label:r}=t,n=k(t,["label"]);const a=r.replace(" ","-"),i=(0,d.useRef)((0,le.uniqueId)(`switch-${a}`)),o=(0,G.of)(ee);return d.createElement(De.B,{gap:1},d.createElement("label",{htmlFor:i.current,className:o.switchLabel},r),d.createElement(we.d,B(ne({},n),{id:i.current})))}const ee=e=>({switchLabel:(0,S.css)({color:e.colors.text.secondary,cursor:"pointer",fontSize:e.typography.bodySmall.fontSize,"&:hover":{color:e.colors.text.primary}})});var Ve=h(31347),P=h(94354);const R=[{label:"Builder",value:Pe.f.Builder},{label:"Code",value:Pe.f.Code}];function Q({mode:e,onChange:t}){return d.createElement("div",{"data-testid":"QueryEditorModeToggle"},d.createElement(P.z,{options:R,size:"sm",value:e,onChange:t}))}var V=h(71087),K=h(32264),ae=h(96374),Oe=h(67061),ve=h(55852),He=h(68402),_e=h(7144),lt=h(37390),Pt=h(39558),xt=h(91793),sr=h(9830),Vt=h(60029),Er=h(54438),Xt=h(10354);const jr=1e3,Ur=1e4,Da=4,ut="{}";function kt(e){const t=[];for(const r of e)if(r.selected&&r.values&&r.values.length>0){const n=r.values.filter(a=>a.selected).map(a=>a.name);n.length>1?t.push(`${r.name}=~"${n.map(oe.Cs).join("|")}"`):n.length===1&&t.push(`${r.name}="${(0,oe.Qn)(n[0])}"`)}return["{",t.join(","),"}"].join("")}function wa(e,t,r){return e.map(n=>{const a=t[n.name];if(a){let i;if(n.name===r&&n.values)i=n.values;else{const o=new Set(n.values?.filter(s=>s.selected).map(s=>s.name)||[]);i=a.map(s=>({name:s,selected:o.has(s)}))}return{...n,loading:!1,values:i,facets:i.length}}return{...n,loading:!1,hidden:!a,values:void 0,facets:0}})}const Pn=e=>({wrapper:(0,S.css)`
    background-color: ${e.colors.background.secondary};
    width: 100%;
  `,wrapperPadding:(0,S.css)`
    padding: ${e.spacing(2)};
  `,list:(0,S.css)`
    margin-top: ${e.spacing(1)};
    display: flex;
    flex-wrap: wrap;
    max-height: 200px;
    overflow: auto;
  `,section:(0,S.css)`
    & + & {
      margin: ${e.spacing(2,0)};
    }

    position: relative;
  `,footerSectionStyles:(0,S.css)`
    padding: ${e.spacing(1)};
    background-color: ${e.colors.background.primary};
    position: sticky;
    bottom: -${e.spacing(3)}; /* offset the padding on modal */
    left: 0;
  `,selector:(0,S.css)`
    font-family: ${e.typography.fontFamilyMonospace};
    margin-bottom: ${e.spacing(1)};
    width: 100%;
  `,status:(0,S.css)`
    margin-bottom: ${e.spacing(1)};
    color: ${e.colors.text.secondary};
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    transition: opacity 100ms linear;
    opacity: 0;
    font-size: ${e.typography.bodySmall.fontSize};
    height: calc(${e.typography.bodySmall.fontSize} + 10px);
  `,statusShowing:(0,S.css)`
    opacity: 1;
  `,error:(0,S.css)`
    color: ${e.colors.error.main};
  `,valueList:(0,S.css)`
    margin-right: ${e.spacing(1)};
    resize: horizontal;
  `,valueListWrapper:(0,S.css)`
    border-left: 1px solid ${e.colors.border.medium};
    margin: ${e.spacing(1,0)};
    padding: ${e.spacing(1,0,1,1)};
  `,valueListArea:(0,S.css)`
    display: flex;
    flex-wrap: wrap;
    margin-top: ${e.spacing(1)};
  `,valueTitle:(0,S.css)`
    margin-left: -${e.spacing(.5)};
    margin-bottom: ${e.spacing(1)};
  `,validationStatus:(0,S.css)`
    padding: ${e.spacing(.5)};
    margin-bottom: ${e.spacing(1)};
    color: ${e.colors.text.maxContrast};
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  `});class Dn extends d.Component{constructor(){super(...arguments),this.state={labels:[],searchTerm:"",status:"Ready",error:"",validationStatus:""},this.onChangeSearch=t=>{this.setState({searchTerm:t.target.value})},this.onClickRunLogsQuery=()=>{(0,ce.rR)("grafana_loki_label_browser_closed",{app:this.props.app,closeType:"showLogsButton"});const t=kt(this.state.labels);this.props.onChange(t)},this.onClickRunMetricsQuery=()=>{(0,ce.rR)("grafana_loki_label_browser_closed",{app:this.props.app,closeType:"showLogsRateButton"});const r=`rate(${kt(this.state.labels)}[$__auto])`;this.props.onChange(r)},this.onClickClear=()=>{this.setState(t=>({labels:t.labels.map(n=>({...n,values:void 0,selected:!1,loading:!1,hidden:!1,facets:void 0})),searchTerm:"",status:"",error:"",validationStatus:""})),this.props.deleteLastUsedLabels()},this.onClickLabel=(t,r,n)=>{const a=this.state.labels.find(s=>s.name===t);if(!a)return;const i=!a.selected;let o={selected:i};if(a.values&&!i){const s=a.values.map(c=>({...c,selected:!1}));o={...o,facets:0,values:s}}this.setState({searchTerm:""}),this.updateLabelState(t,o,"",()=>this.doFacettingForLabel(t))},this.onClickValue=(t,r,n)=>{const a=this.state.labels.find(o=>o.name===t);if(!a||!a.values)return;this.setState({searchTerm:""});const i=a.values.map(o=>({...o,selected:o.name===r?!o.selected:o.selected}));this.updateLabelState(t,{values:i},"",()=>this.doFacetting(t))},this.onClickValidate=()=>{const t=kt(this.state.labels);this.validateSelector(t)},this.doFacetting=t=>{const r=kt(this.state.labels);if(r===ut){const n=this.state.labels.map(a=>({...a,facets:0,values:void 0,hidden:!1}));this.setState({labels:n},()=>{this.state.labels.forEach(a=>a.selected&&this.fetchValues(a.name,r))})}else this.fetchSeries(r,t)}}updateLabelState(t,r,n="",a){this.setState(i=>{const o=i.labels.map(c=>c.name===t?{...c,...r}:c),s=n?"":i.error;return{labels:o,status:n,error:s,validationStatus:""}},a)}componentDidMount(){const{languageProvider:t,autoSelect:r=Da,lastUsedLabels:n,timeRange:a}=this.props;if(t){const i=n;t.start(a).then(()=>{let o=t.getLabelKeys();if(o.length>jr){const c=`Too many labels found (showing only ${jr} of ${o.length})`;o=o.slice(0,jr),this.setState({error:c})}const s=o.map((c,p,v)=>({name:c,selected:v.length<=r&&i.length===0||i.includes(c),loading:!1}));this.setState({labels:s},()=>{this.state.labels.forEach(c=>{c.selected&&this.fetchValues(c.name,ut)})})})}}doFacettingForLabel(t){const r=this.state.labels.find(a=>a.name===t);if(!r)return;const n=this.state.labels.filter(a=>a.selected).map(a=>a.name);this.props.storeLastUsedLabels(n),r.selected?r.values||this.fetchValues(t,kt(this.state.labels)):this.doFacetting()}async fetchValues(t,r){const{languageProvider:n,timeRange:a}=this.props;this.updateLabelState(t,{loading:!0},`Fetching values for ${t}`);try{let i=await n.fetchLabelValues(t,{timeRange:a});if(r!==kt(this.state.labels)){this.updateLabelState(t,{loading:!1},"");return}if(i.length>Ur){const s=`Too many values for ${t} (showing only ${Ur} of ${i.length})`;i=i.slice(0,Ur),this.setState({error:s})}const o=i.map(s=>({name:s}));this.updateLabelState(t,{values:o,loading:!1})}catch(i){console.error(i)}}async fetchSeries(t,r){const{languageProvider:n,timeRange:a}=this.props;r&&this.updateLabelState(r,{loading:!0},`Loading labels for ${t}`);try{const i=await n.fetchSeriesLabels(t,{timeRange:a});if(t!==kt(this.state.labels)){r&&this.updateLabelState(r,{loading:!1});return}if(Object.keys(i).length===0){this.setState({error:`Empty results, no matching label for ${t}`});return}const o=wa(this.state.labels,i,r);this.setState({labels:o,error:""}),r&&this.updateLabelState(r,{loading:!1})}catch(i){console.error(i)}}async validateSelector(t){const{languageProvider:r,timeRange:n}=this.props;this.setState({validationStatus:`Validating selector ${t}`,error:""});const a=await r.fetchSeries(t,{timeRange:n});this.setState({validationStatus:`Selector is valid (${a.length} streams found)`})}render(){const{theme:t}=this.props,{labels:r,searchTerm:n,status:a,error:i,validationStatus:o}=this.state;if(r.length===0)return(0,b.jsx)(Pt._,{text:"Loading labels..."});const s=Pn(t),c=kt(this.state.labels),p=c===ut;let v=r.filter(g=>g.selected&&g.values);return n?v=v.map(g=>{const m=g.values.filter(O=>{if(O.selected)return O.highlightParts=void 0,!0;const D=(0,sr.I)(O.name.toLowerCase(),n.toLowerCase());return D.found?(O.highlightParts=D.ranges,O.order=D.distance,!0):!1});return{...g,values:(0,le.sortBy)(m,O=>O.selected?-1/0:O.order)}}):v=this.state.labels.filter(g=>g.selected&&g.values).map(g=>({...g,values:g?.values?g.values.map(m=>({...m,highlightParts:void 0})):[]})),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:s.wrapper,children:[(0,b.jsxs)("div",{className:(0,S.cx)(s.section,s.wrapperPadding),children:[(0,b.jsx)(Vt.J,{description:"Which labels would you like to consider for your search?",children:"1. Select labels to search in"}),(0,b.jsx)("div",{className:s.list,children:r.map(g=>(0,b.jsx)(Er.J,{name:g.name,loading:g.loading,active:g.selected,hidden:g.hidden,facets:g.facets,onClick:this.onClickLabel},g.name))})]}),(0,b.jsxs)("div",{className:(0,S.cx)(s.section,s.wrapperPadding),children:[(0,b.jsx)(Vt.J,{description:"Choose the label values that you would like to use for the query. Use the search field to find values across selected labels.",children:"2. Find values for the selected labels"}),(0,b.jsx)("div",{children:(0,b.jsx)(Xt.p,{onChange:this.onChangeSearch,"aria-label":"Filter expression for values",value:n,placeholder:"Enter a label value"})}),(0,b.jsx)("div",{className:s.valueListArea,children:v.map(g=>(0,b.jsxs)("div",{role:"list",className:s.valueListWrapper,children:[(0,b.jsx)("div",{className:s.valueTitle,"aria-label":`Values for ${g.name}`,children:(0,b.jsx)(Er.J,{name:g.name,loading:g.loading,active:g.selected,hidden:g.hidden,facets:g.facets||g.values?.length,onClick:this.onClickLabel})}),(0,b.jsx)(xt.Y1,{height:200,itemCount:g.values?.length||0,itemSize:28,itemKey:m=>g.values?.[m].name??m,width:200,className:s.valueList,children:({index:m,style:O})=>{const D=g.values?.[m];return D?(0,b.jsx)("div",{style:O,children:(0,b.jsx)(Er.J,{name:g.name,value:D?.name,active:D?.selected,highlightParts:D?.highlightParts,onClick:this.onClickValue,searchTerm:n})}):null}})]},g.name))})]})]}),(0,b.jsxs)("div",{className:s.footerSectionStyles,children:[(0,b.jsx)(Vt.J,{children:"3. Resulting selector"}),(0,b.jsx)("pre",{"aria-label":"selector",className:s.selector,children:c}),o&&(0,b.jsx)("div",{className:s.validationStatus,children:o}),(0,b.jsx)("div",{className:(0,S.cx)(s.status,(a||i)&&s.statusShowing),children:(0,b.jsx)("span",{className:i?s.error:"",children:i||a})}),(0,b.jsxs)(Oe.B,{gap:1,children:[(0,b.jsx)(ve.$n,{"aria-label":"Use selector as logs button",disabled:p,onClick:this.onClickRunLogsQuery,children:"Show logs"}),(0,b.jsx)(ve.$n,{"aria-label":"Use selector as metrics button",variant:"secondary",disabled:p,onClick:this.onClickRunMetricsQuery,children:"Show logs rate"}),(0,b.jsx)(ve.$n,{"aria-label":"Validate submit button",variant:"secondary",disabled:p,onClick:this.onClickValidate,children:"Validate selector"}),(0,b.jsx)(ve.$n,{"aria-label":"Selector clear button",variant:"secondary",onClick:this.onClickClear,children:"Clear"})]})]})]})}}const wn=(0,G.cV)(Dn),Ln=e=>{const{isOpen:t,onClose:r,datasource:n,app:a,timeRange:i}=e,[o,s]=(0,d.useState)(!1),[c,p]=(0,d.useState)(!1),v="grafana.datasources.loki.browser.labels",g=(0,G.of)(La);(0,d.useEffect)(()=>{t&&n.languageProvider.fetchLabels({timeRange:i}).then(C=>{s(!0),p(C.length>0)})},[n,t,i]);const m=C=>{const{query:A,onChange:M,onRunQuery:$}=e,j={...A,expr:C};M(j),$()},O=C=>{m(C),r()},D=()=>{(0,ce.rR)("grafana_loki_label_browser_closed",{app:a,closeType:"modalClose"}),r()};return(0,b.jsxs)(lt.a,{isOpen:t,title:"Label browser",onDismiss:D,className:g.modal,children:[!o&&(0,b.jsx)(Pt._,{text:"Loading labels..."}),o&&!c&&(0,b.jsx)("p",{children:"No labels found."}),o&&c&&(0,b.jsx)(_e.b,{storageKey:v,defaultValue:[],children:(C,A,M)=>(0,b.jsx)(wn,{languageProvider:n.languageProvider,onChange:O,lastUsedLabels:C,storeLastUsedLabels:A,deleteLastUsedLabels:M,app:a,timeRange:i})})]})},La=e=>({modal:(0,S.css)`
      width: 85vw;
      ${e.breakpoints.down("md")} {
        width: 100%;
      }
    `});var Ca=h(65307),vt=h(43548),Qt=h(60706),Ra=h(43127),Cn=h(9e4),tr=h(81580),Rn=h(97801),Ta=h(85269),Tn=h(44600),Ht=h(50877),zt=h(14186),at=h(90182),In=h(81392),Be=h(3721),ht=Object.defineProperty,nt=Object.defineProperties,An=Object.getOwnPropertyDescriptors,Wr=Object.getOwnPropertySymbols,$n=Object.prototype.hasOwnProperty,Mt=Object.prototype.propertyIsEnumerable,Vr=(e,t,r)=>t in e?ht(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,lr=(e,t)=>{for(var r in t||(t={}))$n.call(t,r)&&Vr(e,r,t[r]);if(Wr)for(var r of Wr(t))Mt.call(t,r)&&Vr(e,r,t[r]);return e},rr=(e,t)=>nt(e,An(t));const Ia="You have conflicting label filters";function Fn({item:e,items:t,defaultOp:r,onChange:n,onDelete:a,onGetLabelNames:i,onGetLabelValues:o,invalidLabel:s,invalidValue:c,multiValueSeparator:p="|"}){var v;const[g,m]=(0,d.useState)({}),[O,D]=(0,d.useState)(!1),[C,A]=(0,d.useState)(!1),M=(X=e.op)=>{var re;return(re=kr.find(Z=>Z.label===X))==null?void 0:re.isMultiValue},$=X=>X?X.indexOf(p)>0?X.split(p):[X]:[],j=()=>{const X=g.labelValues?[...g.labelValues]:[],re=$(e?.value).map(Ht.z);return(0,le.uniqBy)([...re,...X],"value")},U=Qn(e,t),{current:J}=(0,d.useRef)((0,Tn.A)());return d.createElement("div",{"data-testid":"visual-query-builder-dimensions-filter-item"},d.createElement(zt.I,{error:Ia,invalid:U?!0:void 0},d.createElement(In.M,null,d.createElement(at.l6,{placeholder:"Select label","data-testid":he.Tp.components.QueryBuilder.labelSelect,inputId:`visual-query-builder-dimensions-filter-item-key-${J}`,width:"auto",value:e.label?(0,Ht.z)(e.label):null,allowCustomValue:!0,onOpenMenu:async()=>{m({isLoadingLabelNames:!0});const X=await i(e);D(!0),m({labelNames:X,isLoadingLabelNames:void 0})},onCloseMenu:()=>{D(!1)},isOpen:O,isLoading:g.isLoadingLabelNames,options:g.labelNames,onChange:X=>{var re;X.value&&n(rr(lr({},e),{op:(re=e.op)!=null?re:r,label:X.value}))},invalid:U||s}),d.createElement(at.l6,{"data-testid":he.Tp.components.QueryBuilder.matchOperatorSelect,value:(0,Ht.z)((v=e.op)!=null?v:r),options:kr,width:"auto",onChange:X=>{X.value&&n(rr(lr({},e),{op:X.value,value:M(X.value)?e.value:$(e?.value)[0]}))},invalid:U}),d.createElement(at.l6,{placeholder:"Select value","data-testid":he.Tp.components.QueryBuilder.valueSelect,inputId:`visual-query-builder-dimensions-filter-item-value-${J}`,width:"auto",value:M()?$(e?.value).map(Ht.z):$(e?.value).map(Ht.z)[0],allowCustomValue:!0,onOpenMenu:async()=>{m({isLoadingLabelValues:!0});const X=await o(e);m(rr(lr({},g),{labelValues:X,isLoadingLabelValues:void 0})),A(!0)},onCloseMenu:()=>{A(!1)},isOpen:C,isMulti:M(),isLoading:g.isLoadingLabelValues,options:j(),onChange:X=>{var re,Z;if(X.value)n(rr(lr({},e),{value:X.value,op:(re=e.op)!=null?re:r}));else{const be=X.map(Re=>{if(Re.value)return Re.value}).filter(Re=>Re!==void 0).join(p);n(rr(lr({},e),{value:be,op:(Z=e.op)!=null?Z:r}))}},invalid:U||c}),d.createElement(Be.Z,{"aria-label":"remove",icon:"times",variant:"secondary",onClick:a}))))}const kr=[{label:"=",value:"=",description:"Equals",isMultiValue:!1},{label:"!=",value:"!=",description:"Does not equal",isMultiValue:!1},{label:"=~",value:"=~",description:"Matches regex",isMultiValue:!0},{label:"!~",value:"!~",description:"Does not match regex",isMultiValue:!0}];function Qn(e,t){if(!e.label||!e.op||!e.value||t.length<2)return!1;const r=e.op.toString().startsWith("!");return t.filter(i=>i.label===e.label&&i.value===e.value&&i.op!==e.op).some(i=>{var o,s;return!!(r&&((o=i?.op)==null?void 0:o.toString().startsWith("!"))===!1||r===!1&&((s=i?.op)!=null&&s.toString().startsWith("!")))})}const Gr="Select at least 1 label filter (label and value)";function ur({labelsFilters:e,onChange:t,onGetLabelNames:r,onGetLabelValues:n,labelFilterRequired:a,multiValueSeparator:i}){const o="=",[s,c]=(0,d.useState)([{op:o}]);(0,d.useEffect)(()=>{e.length>0?c(e):c([{op:o}])},[e]);const p=g=>{c(g);const m=g.filter(O=>O.label!==void 0&&O.value!==void 0);(0,le.isEqual)(m,e)||t(m)},v=s.some(g=>g.label&&g.value);return d.createElement(Rn.B,null,d.createElement(tr.c,{label:"Label filters",error:Gr,invalid:a&&!v},d.createElement(Ta.o,{items:s,onChange:p,renderItem:(g,m,O)=>d.createElement(Fn,{item:g,items:s,defaultOp:o,onChange:m,onDelete:O,onGetLabelNames:r,onGetLabelValues:n,invalidLabel:a&&!g.label,invalidValue:a&&!g.value,multiValueSeparator:i})})))}var cr=h(36663);function _t({title:e,stepNumber:t,markdown:r,children:n}){const a=(0,G.of)(Aa);return d.createElement("div",{className:a.box},t!==void 0&&d.createElement("div",{className:a.stepNumber},t),d.createElement("div",{className:a.boxInner},e&&d.createElement("div",{className:a.header},d.createElement("span",null,e)),d.createElement("div",{className:a.body},r&&d.createElement("div",{dangerouslySetInnerHTML:{__html:(0,cr.G)(r)}}),n)))}const Aa=e=>({box:(0,S.css)({background:e.colors.background.secondary,padding:e.spacing(1),borderRadius:e.shape.radius.default,position:"relative"}),boxInner:(0,S.css)({marginLeft:e.spacing(4)}),stepNumber:(0,S.css)({fontWeight:e.typography.fontWeightMedium,background:e.colors.secondary.main,width:"20px",height:"20px",borderRadius:e.shape.radius.circle,display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"10px",left:"11px",fontSize:e.typography.bodySmall.fontSize}),header:(0,S.css)({paddingBottom:e.spacing(.5),display:"flex",alignItems:"center",fontFamily:e.typography.fontFamilyMonospace}),body:(0,S.css)({color:e.colors.text.secondary,"p:last-child":{margin:0},a:{color:e.colors.text.link,textDecoration:"underline"}})});var dr=h(92762),Mn=h(21103),Xr=h(77387),Te=h(58168),fr=h(14644),qe=d.createContext(null);const $a=null;function Nn(e){e()}var Hr=Nn,zr=function(t){return Hr=t},Sr=function(){return Hr};function pr(){var e=Sr(),t=null,r=null;return{clear:function(){t=null,r=null},notify:function(){e(function(){for(var a=t;a;)a.callback(),a=a.next})},get:function(){for(var a=[],i=t;i;)a.push(i),i=i.next;return a},subscribe:function(a){var i=!0,o=r={callback:a,next:null,prev:r};return o.prev?o.prev.next=o:t=o,function(){!i||t===null||(i=!1,o.next?o.next.prev=o.prev:r=o.prev,o.prev?o.prev.next=o.next:t=o.next)}}}}var _r={notify:function(){},get:function(){return[]}};function Kr(e,t){var r,n=_r;function a(g){return c(),n.subscribe(g)}function i(){n.notify()}function o(){v.onStateChange&&v.onStateChange()}function s(){return!!r}function c(){r||(r=t?t.addNestedSub(o):e.subscribe(o),n=pr())}function p(){r&&(r(),r=void 0,n.clear(),n=_r)}var v={addNestedSub:a,notifyNestedSubs:i,handleChangeWrapper:o,isSubscribed:s,trySubscribe:c,tryUnsubscribe:p,getListeners:function(){return n}};return v}var Yr=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?d.useLayoutEffect:d.useEffect;function Bn(e){var t=e.store,r=e.context,n=e.children,a=(0,d.useMemo)(function(){var s=Kr(t);return{store:t,subscription:s}},[t]),i=(0,d.useMemo)(function(){return t.getState()},[t]);Yr(function(){var s=a.subscription;return s.onStateChange=s.notifyNestedSubs,s.trySubscribe(),i!==t.getState()&&s.notifyNestedSubs(),function(){s.tryUnsubscribe(),s.onStateChange=null}},[a,i]);var o=r||qe;return d.createElement(o.Provider,{value:a},n)}const Pr=Bn;var nr=h(98587),Zr=h(4146),jn=h.n(Zr),Fa=h(61899),Qa=["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"],Ma=["reactReduxForwardedRef"],Na=[],Ba=[null,null],Fi=function(t){try{return JSON.stringify(t)}catch{return String(t)}};function Un(e,t){var r=e[1];return[t.payload,r+1]}function Jr(e,t,r){Yr(function(){return e.apply(void 0,t)},r)}function ja(e,t,r,n,a,i,o){e.current=n,t.current=a,r.current=!1,i.current&&(i.current=null,o())}function Ua(e,t,r,n,a,i,o,s,c,p){if(e){var v=!1,g=null,m=function(){if(!v){var C=t.getState(),A,M;try{A=n(C,a.current)}catch($){M=$,g=$}M||(g=null),A===i.current?o.current||c():(i.current=A,s.current=A,o.current=!0,p({type:"STORE_UPDATED",payload:{error:M}}))}};r.onStateChange=m,r.trySubscribe(),m();var O=function(){if(v=!0,r.tryUnsubscribe(),r.onStateChange=null,g)throw g};return O}}var Wn=function(){return[null,0]};function qr(e,t){t===void 0&&(t={});var r=t,n=r.getDisplayName,a=n===void 0?function(X){return"ConnectAdvanced("+X+")"}:n,i=r.methodName,o=i===void 0?"connectAdvanced":i,s=r.renderCountProp,c=s===void 0?void 0:s,p=r.shouldHandleStateChanges,v=p===void 0?!0:p,g=r.storeKey,m=g===void 0?"store":g,O=r.withRef,D=O===void 0?!1:O,C=r.forwardRef,A=C===void 0?!1:C,M=r.context,$=M===void 0?qe:M,j=(0,nr.A)(r,Qa);if(0)var U;var J=$;return function(re){var Z=re.displayName||re.name||"Component",be=a(Z),Re=(0,Te.A)({},j,{getDisplayName:a,methodName:o,renderCountProp:c,shouldHandleStateChanges:v,storeKey:m,displayName:be,wrappedComponentName:Z,WrappedComponent:re}),Ue=j.pure;function Je(Ge){return e(Ge.dispatch,Re)}var tt=Ue?d.useMemo:function(Ge){return Ge()};function it(Ge){var dt=(0,d.useMemo)(function(){var xr=Ge.reactReduxForwardedRef,Br=(0,nr.A)(Ge,Ma);return[Ge.context,xr,Br]},[Ge]),ct=dt[0],$t=dt[1],Lt=dt[2],gt=(0,d.useMemo)(function(){return ct&&ct.Consumer&&(0,Fa.isContextConsumer)(d.createElement(ct.Consumer,null))?ct:J},[ct,J]),St=(0,d.useContext)(gt),Ct=!!Ge.store&&!!Ge.store.getState&&!!Ge.store.dispatch,Ft=!!St&&!!St.store,Ot=Ct?Ge.store:St.store,qt=(0,d.useMemo)(function(){return Je(Ot)},[Ot]),Wt=(0,d.useMemo)(function(){if(!v)return Ba;var xr=Kr(Ot,Ct?null:St.subscription),Br=xr.notifyNestedSubs.bind(xr);return[xr,Br]},[Ot,Ct,St]),er=Wt[0],On=Wt[1],yr=(0,d.useMemo)(function(){return Ct?St:(0,Te.A)({},St,{subscription:er})},[Ct,St,er]),Ti=(0,d.useReducer)(Un,Na,Wn),Ii=Ti[0],xn=Ii[0],Go=Ti[1];if(xn&&xn.error)throw xn.error;var Pa=(0,d.useRef)(),En=(0,d.useRef)(Lt),Sn=(0,d.useRef)(),Ai=(0,d.useRef)(!1),Gt=tt(function(){return Sn.current&&Lt===En.current?Sn.current:qt(Ot.getState(),Lt)},[Ot,xn,Lt]);Jr(ja,[En,Pa,Ai,Lt,Gt,Sn,On]),Jr(Ua,[v,Ot,er,qt,En,Pa,Ai,Sn,On,Go],[Ot,er,qt]);var Or=(0,d.useMemo)(function(){return d.createElement(re,(0,Te.A)({},Gt,{ref:$t}))},[$t,re,Gt]),$i=(0,d.useMemo)(function(){return v?d.createElement(gt.Provider,{value:yr},Or):Or},[gt,Or,yr]);return $i}var Xe=Ue?d.memo(it):it;if(Xe.WrappedComponent=re,Xe.displayName=it.displayName=be,A){var $e=d.forwardRef(function(dt,ct){return d.createElement(Xe,(0,Te.A)({},dt,{reactReduxForwardedRef:ct}))});return $e.displayName=be,$e.WrappedComponent=re,jn()($e,re)}return jn()(Xe,re)}}function Vn(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function Dr(e,t){if(Vn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var a=0;a<r.length;a++)if(!Object.prototype.hasOwnProperty.call(t,r[a])||!Vn(e[r[a]],t[r[a]]))return!1;return!0}function Wa(e,t){var r={},n=function(o){var s=e[o];typeof s=="function"&&(r[o]=function(){return t(s.apply(void 0,arguments))})};for(var a in e)n(a);return r}function wr(e){return function(r,n){var a=e(r,n);function i(){return a}return i.dependsOnOwnProps=!1,i}}function en(e){return e.dependsOnOwnProps!==null&&e.dependsOnOwnProps!==void 0?!!e.dependsOnOwnProps:e.length!==1}function tn(e,t){return function(n,a){var i=a.displayName,o=function(c,p){return o.dependsOnOwnProps?o.mapToProps(c,p):o.mapToProps(c)};return o.dependsOnOwnProps=!0,o.mapToProps=function(c,p){o.mapToProps=e,o.dependsOnOwnProps=en(e);var v=o(c,p);return typeof v=="function"&&(o.mapToProps=v,o.dependsOnOwnProps=en(v),v=o(c,p)),v},o}}function kn(e){return typeof e=="function"?tn(e,"mapDispatchToProps"):void 0}function Gn(e){return e?void 0:wr(function(t){return{dispatch:t}})}function Lr(e){return e&&typeof e=="object"?wr(function(t){return Wa(e,t)}):void 0}const rn=[kn,Gn,Lr];function Xn(e){return typeof e=="function"?tn(e,"mapStateToProps"):void 0}function Hn(e){return e?void 0:wr(function(){return{}})}const Va=[Xn,Hn];function nn(e,t,r){return(0,Te.A)({},r,e,t)}function ka(e){return function(r,n){var a=n.displayName,i=n.pure,o=n.areMergedPropsEqual,s=!1,c;return function(v,g,m){var O=e(v,g,m);return s?(!i||!o(O,c))&&(c=O):(s=!0,c=O),c}}}function zn(e){return typeof e=="function"?ka(e):void 0}function Ga(e){return e?void 0:function(){return nn}}const Xa=[zn,Ga];var Cr=["initMapStateToProps","initMapDispatchToProps","initMergeProps"];function Ha(e,t,r,n){return function(i,o){return r(e(i,o),t(n,o),o)}}function za(e,t,r,n,a){var i=a.areStatesEqual,o=a.areOwnPropsEqual,s=a.areStatePropsEqual,c=!1,p,v,g,m,O;function D(j,U){return p=j,v=U,g=e(p,v),m=t(n,v),O=r(g,m,v),c=!0,O}function C(){return g=e(p,v),t.dependsOnOwnProps&&(m=t(n,v)),O=r(g,m,v),O}function A(){return e.dependsOnOwnProps&&(g=e(p,v)),t.dependsOnOwnProps&&(m=t(n,v)),O=r(g,m,v),O}function M(){var j=e(p,v),U=!s(j,g);return g=j,U&&(O=r(g,m,v)),O}function $(j,U){var J=!o(U,v),X=!i(j,p);return p=j,v=U,J&&X?C():J?A():X?M():O}return function(U,J){return c?$(U,J):D(U,J)}}function _a(e,t){var r=t.initMapStateToProps,n=t.initMapDispatchToProps,a=t.initMergeProps,i=(0,nr.A)(t,Cr),o=r(e,i),s=n(e,i),c=a(e,i),p=i.pure?za:Ha;return p(o,s,c,e,i)}var _n=["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"];function Rr(e,t,r){for(var n=t.length-1;n>=0;n--){var a=t[n](e);if(a)return a}return function(i,o){throw new Error("Invalid value of type "+typeof e+" for "+r+" argument when connecting component "+o.wrappedComponentName+".")}}function Ka(e,t){return e===t}function Ya(e){var t=e===void 0?{}:e,r=t.connectHOC,n=r===void 0?qr:r,a=t.mapStateToPropsFactories,i=a===void 0?Va:a,o=t.mapDispatchToPropsFactories,s=o===void 0?rn:o,c=t.mergePropsFactories,p=c===void 0?Xa:c,v=t.selectorFactory,g=v===void 0?_a:v;return function(O,D,C,A){A===void 0&&(A={});var M=A,$=M.pure,j=$===void 0?!0:$,U=M.areStatesEqual,J=U===void 0?Ka:U,X=M.areOwnPropsEqual,re=X===void 0?Dr:X,Z=M.areStatePropsEqual,be=Z===void 0?Dr:Z,Re=M.areMergedPropsEqual,Ue=Re===void 0?Dr:Re,Je=(0,nr.A)(M,_n),tt=Rr(O,i,"mapStateToProps"),it=Rr(D,s,"mapDispatchToProps"),Xe=Rr(C,p,"mergeProps");return n(g,(0,Te.A)({methodName:"connect",getDisplayName:function(Ge){return"Connect("+Ge+")"},shouldHandleStateChanges:!!O,initMapStateToProps:tt,initMapDispatchToProps:it,initMergeProps:Xe,pure:j,areStatesEqual:J,areOwnPropsEqual:re,areStatePropsEqual:be,areMergedPropsEqual:Ue},Je))}}const an=Ya();function Za(){var e=useContext(ReactReduxContext);return e}function Ja(e){e===void 0&&(e=ReactReduxContext);var t=e===ReactReduxContext?useDefaultReduxContext:function(){return useContext(e)};return function(){var n=t(),a=n.store;return a}}var Qi=null;function qa(e){e===void 0&&(e=ReactReduxContext);var t=e===ReactReduxContext?useDefaultStore:createStoreHook(e);return function(){var n=t();return n.dispatch}}var ei=null,Kn=function(t,r){return t===r};function ti(e,t,r,n){var a=useReducer(function(D){return D+1},0),i=a[1],o=useMemo(function(){return createSubscription(r,n)},[r,n]),s=useRef(),c=useRef(),p=useRef(),v=useRef(),g=r.getState(),m;try{if(e!==c.current||g!==p.current||s.current){var O=e(g);v.current===void 0||!t(O,v.current)?m=O:m=v.current}else m=v.current}catch(D){throw s.current&&(D.message+=`
The error may be correlated with this previous error:
`+s.current.stack+`

`),D}return useIsomorphicLayoutEffect(function(){c.current=e,p.current=g,v.current=m,s.current=void 0}),useIsomorphicLayoutEffect(function(){function D(){try{var C=r.getState();if(C===p.current)return;var A=c.current(C);if(t(A,v.current))return;v.current=A,p.current=C}catch(M){s.current=M}i()}return o.onStateChange=D,o.trySubscribe(),D(),function(){return o.tryUnsubscribe()}},[r,o]),m}function Mi(e){e===void 0&&(e=ReactReduxContext);var t=e===ReactReduxContext?useDefaultReduxContext:function(){return useContext(e)};return function(n,a){a===void 0&&(a=Kn);var i=t(),o=i.store,s=i.subscription,c=ti(n,a,o,s);return useDebugValue(c),c}}var ri=null,on=h(40961);zr(on.unstable_batchedUpdates);var se=h(32737),ot=h(86795),sn=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function Yn(e,t){return!!(e===t||sn(e)&&sn(t))}function Tr(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!Yn(e[r],t[r]))return!1;return!0}function ni(e,t){t===void 0&&(t=Tr);var r,n=[],a,i=!1;function o(){for(var s=[],c=0;c<arguments.length;c++)s[c]=arguments[c];return i&&r===this&&t(s,n)||(a=e.apply(this,s),i=!0,r=this,n=s),a}return o}const st=ni;var ar=h(10629),ln=!0,Zn=/[ \t]{2,}/g,Jn=/^[ \t]*/gm,qn=function(t){return t.replace(Zn," ").replace(Jn,"").trim()},ea=function(t){return qn(`
  %creact-beautiful-dnd

  %c`+qn(t)+`

  %c\u{1F477}\u200D This is a development only message. It will be removed in production builds.
`)},Ir=function(t){return[ea(t),"color: #00C584; font-size: 1.2em; font-weight: bold;","line-height: 1.5","color: #723874;"]},ai="__react-beautiful-dnd-disable-dev-warnings";function bt(e,t){var r;ln||typeof window<"u"&&window[ai]||(r=console)[e].apply(r,Ir(t))}var ta=bt.bind(null,"warn"),L=bt.bind(null,"error");function u(){}function l(e,t){return(0,Te.A)({},e,{},t)}function f(e,t,r){var n=t.map(function(a){var i=l(r,a.options);return e.addEventListener(a.eventName,a.fn,i),function(){e.removeEventListener(a.eventName,a.fn,i)}});return function(){n.forEach(function(i){i()})}}var y=!0,x="Invariant failed";function w(e){this.message=e}w.prototype.toString=function(){return this.message};function E(e,t){if(!e)throw y?new w(x):new w(x+": "+(t||""))}var I=function(e){(0,Xr.A)(t,e);function t(){for(var n,a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return n=e.call.apply(e,[this].concat(i))||this,n.callbacks=null,n.unbind=u,n.onWindowError=function(s){var c=n.getCallbacks();c.isDragging()&&c.tryAbort();var p=s.error;p instanceof w&&s.preventDefault()},n.getCallbacks=function(){if(!n.callbacks)throw new Error("Unable to find AppCallbacks in <ErrorBoundary/>");return n.callbacks},n.setCallbacks=function(s){n.callbacks=s},n}var r=t.prototype;return r.componentDidMount=function(){this.unbind=f(window,[{eventName:"error",fn:this.onWindowError}])},r.componentDidCatch=function(a){if(a instanceof w){this.setState({});return}throw a},r.componentWillUnmount=function(){this.unbind()},r.render=function(){return this.props.children(this.setCallbacks)},t}(d.Component),z=`
  Press space bar to start a drag.
  When dragging you can use the arrow keys to move the item around and escape to cancel.
  Some screen readers may require you to be in focus mode or to use your pass through key
`,te=function(t){return t+1},ie=function(t){return`
  You have lifted an item in position `+te(t.source.index)+`
`},ue=function(t,r){var n=t.droppableId===r.droppableId,a=te(t.index),i=te(r.index);return n?`
      You have moved the item from position `+a+`
      to position `+i+`
    `:`
    You have moved the item from position `+a+`
    in list `+t.droppableId+`
    to list `+r.droppableId+`
    in position `+i+`
  `},fe=function(t,r,n){var a=r.droppableId===n.droppableId;return a?`
      The item `+t+`
      has been combined with `+n.draggableId:`
      The item `+t+`
      in list `+r.droppableId+`
      has been combined with `+n.draggableId+`
      in list `+n.droppableId+`
    `},je=function(t){var r=t.destination;if(r)return ue(t.source,r);var n=t.combine;return n?fe(t.draggableId,t.source,n):"You are over an area that cannot be dropped on"},Ie=function(t){return`
  The item has returned to its starting position
  of `+te(t.index)+`
`},Ze=function(t){if(t.reason==="CANCEL")return`
      Movement cancelled.
      `+Ie(t.source)+`
    `;var r=t.destination,n=t.combine;return r?`
      You have dropped the item.
      `+ue(t.source,r)+`
    `:n?`
      You have dropped the item.
      `+fe(t.draggableId,t.source,n)+`
    `:`
    The item has been dropped while not over a drop area.
    `+Ie(t.source)+`
  `},Ae={dragHandleUsageInstructions:z,onDragStart:ie,onDragUpdate:je,onDragEnd:Ze},We={x:0,y:0},ze=function(t,r){return{x:t.x+r.x,y:t.y+r.y}},ke=function(t,r){return{x:t.x-r.x,y:t.y-r.y}},et=function(t,r){return t.x===r.x&&t.y===r.y},mt=function(t){return{x:t.x!==0?-t.x:0,y:t.y!==0?-t.y:0}},pt=function(t,r,n){var a;return n===void 0&&(n=0),a={},a[t]=r,a[t==="x"?"y":"x"]=n,a},Kt=function(t,r){return Math.sqrt(Math.pow(r.x-t.x,2)+Math.pow(r.y-t.y,2))},Ar=function(t,r){return Math.min.apply(Math,r.map(function(n){return Kt(t,n)}))},ir=function(t){return function(r){return{x:t(r.x),y:t(r.y)}}},Ni=function(e,t){var r=(0,ot.l)({top:Math.max(t.top,e.top),right:Math.min(t.right,e.right),bottom:Math.min(t.bottom,e.bottom),left:Math.max(t.left,e.left)});return r.width<=0||r.height<=0?null:r},Yt=function(t,r){return{top:t.top+r.y,left:t.left+r.x,bottom:t.bottom+r.y,right:t.right+r.x}},ii=function(t){return[{x:t.left,y:t.top},{x:t.right,y:t.top},{x:t.left,y:t.bottom},{x:t.right,y:t.bottom}]},Bi={top:0,right:0,bottom:0,left:0},Ke=function(t,r){return r?Yt(t,r.scroll.diff.displacement):t},yt=function(t,r,n){if(n&&n.increasedBy){var a;return(0,Te.A)({},t,(a={},a[r.end]=t[r.end]+n.increasedBy[r.line],a))}return t},ft=function(t,r){return r&&r.shouldClipSubject?Ni(r.pageMarginBox,t):(0,ot.l)(t)},Rt=function(e){var t=e.page,r=e.withPlaceholder,n=e.axis,a=e.frame,i=Ke(t.marginBox,a),o=yt(i,n,r),s=ft(o,a);return{page:t,withPlaceholder:r,active:s}},ji=function(e,t){e.frame||E(!1);var r=e.frame,n=ke(t,r.scroll.initial),a=mt(n),i=(0,Te.A)({},r,{scroll:{initial:r.scroll.initial,current:t,diff:{value:n,displacement:a},max:r.scroll.max}}),o=Rt({page:e.subject.page,withPlaceholder:e.subject.withPlaceholder,axis:e.axis,frame:i}),s=(0,Te.A)({},e,{frame:i,subject:o});return s};function fu(e){return Number.isInteger?Number.isInteger(e):typeof e=="number"&&isFinite(e)&&Math.floor(e)===e}function oi(e){return Object.values?Object.values(e):Object.keys(e).map(function(t){return e[t]})}function Ui(e,t){if(e.findIndex)return e.findIndex(t);for(var r=0;r<e.length;r++)if(t(e[r]))return r;return-1}function gr(e,t){if(e.find)return e.find(t);var r=Ui(e,t);if(r!==-1)return e[r]}function Xo(e){return Array.prototype.slice.call(e)}var Ho=st(function(e){return e.reduce(function(t,r){return t[r.descriptor.id]=r,t},{})}),zo=st(function(e){return e.reduce(function(t,r){return t[r.descriptor.id]=r,t},{})}),si=st(function(e){return oi(e)}),pu=st(function(e){return oi(e)}),un=st(function(e,t){var r=pu(t).filter(function(n){return e===n.descriptor.droppableId}).sort(function(n,a){return n.descriptor.index-a.descriptor.index});return r});function Wi(e){return e.at&&e.at.type==="REORDER"?e.at.destination:null}function li(e){return e.at&&e.at.type==="COMBINE"?e.at.combine:null}var ui=st(function(e,t){return t.filter(function(r){return r.descriptor.id!==e.descriptor.id})}),gu=function(e){var t=e.isMovingForward,r=e.draggable,n=e.destination,a=e.insideDestination,i=e.previousImpact;if(!n.isCombineEnabled)return null;var o=Wi(i);if(!o)return null;function s(C){var A={type:"COMBINE",combine:{draggableId:C,droppableId:n.descriptor.id}};return(0,Te.A)({},i,{at:A})}var c=i.displaced.all,p=c.length?c[0]:null;if(t)return p?s(p):null;var v=ui(r,a);if(!p){if(!v.length)return null;var g=v[v.length-1];return s(g.descriptor.id)}var m=Ui(v,function(C){return C.descriptor.id===p});m===-1&&E(!1);var O=m-1;if(O<0)return null;var D=v[O];return s(D.descriptor.id)},cn=function(e,t){return e.descriptor.droppableId===t.descriptor.id},_o={point:We,value:0},ra={invisible:{},visible:{},all:[]},vu={displaced:ra,displacedBy:_o,at:null},Nt=function(e,t){return function(r){return e<=r&&r<=t}},Ko=function(e){var t=Nt(e.top,e.bottom),r=Nt(e.left,e.right);return function(n){var a=t(n.top)&&t(n.bottom)&&r(n.left)&&r(n.right);if(a)return!0;var i=t(n.top)||t(n.bottom),o=r(n.left)||r(n.right),s=i&&o;if(s)return!0;var c=n.top<e.top&&n.bottom>e.bottom,p=n.left<e.left&&n.right>e.right,v=c&&p;if(v)return!0;var g=c&&o||p&&i;return g}},mu=function(e){var t=Nt(e.top,e.bottom),r=Nt(e.left,e.right);return function(n){var a=t(n.top)&&t(n.bottom)&&r(n.left)&&r(n.right);return a}},Vi={direction:"vertical",line:"y",crossAxisLine:"x",start:"top",end:"bottom",size:"height",crossAxisStart:"left",crossAxisEnd:"right",crossAxisSize:"width"},Yo={direction:"horizontal",line:"x",crossAxisLine:"y",start:"left",end:"right",size:"width",crossAxisStart:"top",crossAxisEnd:"bottom",crossAxisSize:"height"},hu=function(e){return function(t){var r=Nt(t.top,t.bottom),n=Nt(t.left,t.right);return function(a){return e===Vi?r(a.top)&&r(a.bottom):n(a.left)&&n(a.right)}}},bu=function(t,r){var n=r.frame?r.frame.scroll.diff.displacement:We;return Yt(t,n)},yu=function(t,r,n){return r.subject.active?n(r.subject.active)(t):!1},Ou=function(t,r,n){return n(r)(t)},ki=function(t){var r=t.target,n=t.destination,a=t.viewport,i=t.withDroppableDisplacement,o=t.isVisibleThroughFrameFn,s=i?bu(r,n):r;return yu(s,n,o)&&Ou(s,a,o)},xu=function(t){return ki((0,Te.A)({},t,{isVisibleThroughFrameFn:Ko}))},Zo=function(t){return ki((0,Te.A)({},t,{isVisibleThroughFrameFn:mu}))},Eu=function(t){return ki((0,Te.A)({},t,{isVisibleThroughFrameFn:hu(t.destination.axis)}))},Su=function(t,r,n){if(typeof n=="boolean")return n;if(!r)return!0;var a=r.invisible,i=r.visible;if(a[t])return!1;var o=i[t];return o?o.shouldAnimate:!0};function Pu(e,t){var r=e.page.marginBox,n={top:t.point.y,right:0,bottom:0,left:t.point.x};return(0,ot.l)((0,ot.fT)(r,n))}function na(e){var t=e.afterDragging,r=e.destination,n=e.displacedBy,a=e.viewport,i=e.forceShouldAnimate,o=e.last;return t.reduce(function(c,p){var v=Pu(p,n),g=p.descriptor.id;c.all.push(g);var m=xu({target:v,destination:r,viewport:a,withDroppableDisplacement:!0});if(!m)return c.invisible[p.descriptor.id]=!0,c;var O=Su(g,o,i),D={draggableId:g,shouldAnimate:O};return c.visible[g]=D,c},{all:[],visible:{},invisible:{}})}function Du(e,t){if(!e.length)return 0;var r=e[e.length-1].descriptor.index;return t.inHomeList?r:r+1}function Jo(e){var t=e.insideDestination,r=e.inHomeList,n=e.displacedBy,a=e.destination,i=Du(t,{inHomeList:r});return{displaced:ra,displacedBy:n,at:{type:"REORDER",destination:{droppableId:a.descriptor.id,index:i}}}}function ci(e){var t=e.draggable,r=e.insideDestination,n=e.destination,a=e.viewport,i=e.displacedBy,o=e.last,s=e.index,c=e.forceShouldAnimate,p=cn(t,n);if(s==null)return Jo({insideDestination:r,inHomeList:p,displacedBy:i,destination:n});var v=gr(r,function(C){return C.descriptor.index===s});if(!v)return Jo({insideDestination:r,inHomeList:p,displacedBy:i,destination:n});var g=ui(t,r),m=r.indexOf(v),O=g.slice(m),D=na({afterDragging:O,destination:n,displacedBy:i,last:o,viewport:a.frame,forceShouldAnimate:c});return{displaced:D,displacedBy:i,at:{type:"REORDER",destination:{droppableId:n.descriptor.id,index:s}}}}function vr(e,t){return!!t.effected[e]}var wu=function(e){var t=e.isMovingForward,r=e.destination,n=e.draggables,a=e.combine,i=e.afterCritical;if(!r.isCombineEnabled)return null;var o=a.draggableId,s=n[o],c=s.descriptor.index,p=vr(o,i);return p?t?c:c-1:t?c+1:c},Lu=function(e){var t=e.isMovingForward,r=e.isInHomeList,n=e.insideDestination,a=e.location;if(!n.length)return null;var i=a.index,o=t?i+1:i-1,s=n[0].descriptor.index,c=n[n.length-1].descriptor.index,p=r?c:c+1;return o<s||o>p?null:o},Cu=function(e){var t=e.isMovingForward,r=e.isInHomeList,n=e.draggable,a=e.draggables,i=e.destination,o=e.insideDestination,s=e.previousImpact,c=e.viewport,p=e.afterCritical,v=s.at;if(v||E(!1),v.type==="REORDER"){var g=Lu({isMovingForward:t,isInHomeList:r,location:v.destination,insideDestination:o});return g==null?null:ci({draggable:n,insideDestination:o,destination:i,viewport:c,last:s.displaced,displacedBy:s.displacedBy,index:g})}var m=wu({isMovingForward:t,destination:i,displaced:s.displaced,draggables:a,combine:v.combine,afterCritical:p});return m==null?null:ci({draggable:n,insideDestination:o,destination:i,viewport:c,last:s.displaced,displacedBy:s.displacedBy,index:m})},Ru=function(e){var t=e.displaced,r=e.afterCritical,n=e.combineWith,a=e.displacedBy,i=!!(t.visible[n]||t.invisible[n]);return vr(n,r)?i?We:mt(a.point):i?a.point:We},Tu=function(e){var t=e.afterCritical,r=e.impact,n=e.draggables,a=li(r);a||E(!1);var i=a.draggableId,o=n[i].page.borderBox.center,s=Ru({displaced:r.displaced,afterCritical:t,combineWith:i,displacedBy:r.displacedBy});return ze(o,s)},qo=function(t,r){return r.margin[t.start]+r.borderBox[t.size]/2},Iu=function(t,r){return r.margin[t.end]+r.borderBox[t.size]/2},Gi=function(t,r,n){return r[t.crossAxisStart]+n.margin[t.crossAxisStart]+n.borderBox[t.crossAxisSize]/2},es=function(t){var r=t.axis,n=t.moveRelativeTo,a=t.isMoving;return pt(r.line,n.marginBox[r.end]+qo(r,a),Gi(r,n.marginBox,a))},ts=function(t){var r=t.axis,n=t.moveRelativeTo,a=t.isMoving;return pt(r.line,n.marginBox[r.start]-Iu(r,a),Gi(r,n.marginBox,a))},Au=function(t){var r=t.axis,n=t.moveInto,a=t.isMoving;return pt(r.line,n.contentBox[r.start]+qo(r,a),Gi(r,n.contentBox,a))},$u=function(e){var t=e.impact,r=e.draggable,n=e.draggables,a=e.droppable,i=e.afterCritical,o=un(a.descriptor.id,n),s=r.page,c=a.axis;if(!o.length)return Au({axis:c,moveInto:a.page,isMoving:s});var p=t.displaced,v=t.displacedBy,g=p.all[0];if(g){var m=n[g];if(vr(g,i))return ts({axis:c,moveRelativeTo:m.page,isMoving:s});var O=(0,ot.cY)(m.page,v.point);return ts({axis:c,moveRelativeTo:O,isMoving:s})}var D=o[o.length-1];if(D.descriptor.id===r.descriptor.id)return s.borderBox.center;if(vr(D.descriptor.id,i)){var C=(0,ot.cY)(D.page,mt(i.displacedBy.point));return es({axis:c,moveRelativeTo:C,isMoving:s})}return es({axis:c,moveRelativeTo:D.page,isMoving:s})},Xi=function(e,t){var r=e.frame;return r?ze(t,r.scroll.diff.displacement):t},Fu=function(t){var r=t.impact,n=t.draggable,a=t.droppable,i=t.draggables,o=t.afterCritical,s=n.page.borderBox.center,c=r.at;return!a||!c?s:c.type==="REORDER"?$u({impact:r,draggable:n,draggables:i,droppable:a,afterCritical:o}):Tu({impact:r,draggables:i,afterCritical:o})},di=function(e){var t=Fu(e),r=e.droppable,n=r?Xi(r,t):t;return n},rs=function(e,t){var r=ke(t,e.scroll.initial),n=mt(r),a=(0,ot.l)({top:t.y,bottom:t.y+e.frame.height,left:t.x,right:t.x+e.frame.width}),i={frame:a,scroll:{initial:e.scroll.initial,max:e.scroll.max,current:t,diff:{value:r,displacement:n}}};return i};function ns(e,t){return e.map(function(r){return t[r]})}function Qu(e,t){for(var r=0;r<t.length;r++){var n=t[r].visible[e];if(n)return n}return null}var Mu=function(e){var t=e.impact,r=e.viewport,n=e.destination,a=e.draggables,i=e.maxScrollChange,o=rs(r,ze(r.scroll.current,i)),s=n.frame?ji(n,ze(n.frame.scroll.current,i)):n,c=t.displaced,p=na({afterDragging:ns(c.all,a),destination:n,displacedBy:t.displacedBy,viewport:o.frame,last:c,forceShouldAnimate:!1}),v=na({afterDragging:ns(c.all,a),destination:s,displacedBy:t.displacedBy,viewport:r.frame,last:c,forceShouldAnimate:!1}),g={},m={},O=[c,p,v];c.all.forEach(function(C){var A=Qu(C,O);if(A){m[C]=A;return}g[C]=!0});var D=(0,Te.A)({},t,{displaced:{all:c.all,invisible:g,visible:m}});return D},Nu=function(e,t){return ze(e.scroll.diff.displacement,t)},Hi=function(e){var t=e.pageBorderBoxCenter,r=e.draggable,n=e.viewport,a=Nu(n,t),i=ke(a,r.page.borderBox.center);return ze(r.client.borderBox.center,i)},as=function(e){var t=e.draggable,r=e.destination,n=e.newPageBorderBoxCenter,a=e.viewport,i=e.withDroppableDisplacement,o=e.onlyOnMainAxis,s=o===void 0?!1:o,c=ke(n,t.page.borderBox.center),p=Yt(t.page.borderBox,c),v={target:p,destination:r,withDroppableDisplacement:i,viewport:a};return s?Eu(v):Zo(v)},Bu=function(e){var t=e.isMovingForward,r=e.draggable,n=e.destination,a=e.draggables,i=e.previousImpact,o=e.viewport,s=e.previousPageBorderBoxCenter,c=e.previousClientSelection,p=e.afterCritical;if(!n.isEnabled)return null;var v=un(n.descriptor.id,a),g=cn(r,n),m=gu({isMovingForward:t,draggable:r,destination:n,insideDestination:v,previousImpact:i})||Cu({isMovingForward:t,isInHomeList:g,draggable:r,draggables:a,destination:n,insideDestination:v,previousImpact:i,viewport:o,afterCritical:p});if(!m)return null;var O=di({impact:m,draggable:r,droppable:n,draggables:a,afterCritical:p}),D=as({draggable:r,destination:n,newPageBorderBoxCenter:O,viewport:o.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0});if(D){var C=Hi({pageBorderBoxCenter:O,draggable:r,viewport:o});return{clientSelection:C,impact:m,scrollJumpRequest:null}}var A=ke(O,s),M=Mu({impact:m,viewport:o,destination:n,draggables:a,maxScrollChange:A});return{clientSelection:c,impact:M,scrollJumpRequest:A}},Et=function(t){var r=t.subject.active;return r||E(!1),r},ju=function(e){var t=e.isMovingForward,r=e.pageBorderBoxCenter,n=e.source,a=e.droppables,i=e.viewport,o=n.subject.active;if(!o)return null;var s=n.axis,c=Nt(o[s.start],o[s.end]),p=si(a).filter(function(g){return g!==n}).filter(function(g){return g.isEnabled}).filter(function(g){return!!g.subject.active}).filter(function(g){return Ko(i.frame)(Et(g))}).filter(function(g){var m=Et(g);return t?o[s.crossAxisEnd]<m[s.crossAxisEnd]:m[s.crossAxisStart]<o[s.crossAxisStart]}).filter(function(g){var m=Et(g),O=Nt(m[s.start],m[s.end]);return c(m[s.start])||c(m[s.end])||O(o[s.start])||O(o[s.end])}).sort(function(g,m){var O=Et(g)[s.crossAxisStart],D=Et(m)[s.crossAxisStart];return t?O-D:D-O}).filter(function(g,m,O){return Et(g)[s.crossAxisStart]===Et(O[0])[s.crossAxisStart]});if(!p.length)return null;if(p.length===1)return p[0];var v=p.filter(function(g){var m=Nt(Et(g)[s.start],Et(g)[s.end]);return m(r[s.line])});return v.length===1?v[0]:v.length>1?v.sort(function(g,m){return Et(g)[s.start]-Et(m)[s.start]})[0]:p.sort(function(g,m){var O=Ar(r,ii(Et(g))),D=Ar(r,ii(Et(m)));return O!==D?O-D:Et(g)[s.start]-Et(m)[s.start]})[0]},is=function(t,r){var n=t.page.borderBox.center;return vr(t.descriptor.id,r)?ke(n,r.displacedBy.point):n},Uu=function(t,r){var n=t.page.borderBox;return vr(t.descriptor.id,r)?Yt(n,mt(r.displacedBy.point)):n},Wu=function(e){var t=e.pageBorderBoxCenter,r=e.viewport,n=e.destination,a=e.insideDestination,i=e.afterCritical,o=a.filter(function(s){return Zo({target:Uu(s,i),destination:n,viewport:r.frame,withDroppableDisplacement:!0})}).sort(function(s,c){var p=Kt(t,Xi(n,is(s,i))),v=Kt(t,Xi(n,is(c,i)));return p<v?-1:v<p?1:s.descriptor.index-c.descriptor.index});return o[0]||null},aa=st(function(t,r){var n=r[t.line];return{value:n,point:pt(t.line,n)}}),Vu=function(t,r,n){var a=t.axis;if(t.descriptor.mode==="virtual")return pt(a.line,r[a.line]);var i=t.subject.page.contentBox[a.size],o=un(t.descriptor.id,n),s=o.reduce(function(v,g){return v+g.client.marginBox[a.size]},0),c=s+r[a.line],p=c-i;return p<=0?null:pt(a.line,p)},os=function(t,r){return(0,Te.A)({},t,{scroll:(0,Te.A)({},t.scroll,{max:r})})},ss=function(t,r,n){var a=t.frame;cn(r,t)&&E(!1),t.subject.withPlaceholder&&E(!1);var i=aa(t.axis,r.displaceBy).point,o=Vu(t,i,n),s={placeholderSize:i,increasedBy:o,oldFrameMaxScroll:t.frame?t.frame.scroll.max:null};if(!a){var c=Rt({page:t.subject.page,withPlaceholder:s,axis:t.axis,frame:t.frame});return(0,Te.A)({},t,{subject:c})}var p=o?ze(a.scroll.max,o):a.scroll.max,v=os(a,p),g=Rt({page:t.subject.page,withPlaceholder:s,axis:t.axis,frame:v});return(0,Te.A)({},t,{subject:g,frame:v})},ku=function(t){var r=t.subject.withPlaceholder;r||E(!1);var n=t.frame;if(!n){var a=Rt({page:t.subject.page,axis:t.axis,frame:null,withPlaceholder:null});return(0,Te.A)({},t,{subject:a})}var i=r.oldFrameMaxScroll;i||E(!1);var o=os(n,i),s=Rt({page:t.subject.page,axis:t.axis,frame:o,withPlaceholder:null});return(0,Te.A)({},t,{subject:s,frame:o})},Gu=function(e){var t=e.previousPageBorderBoxCenter,r=e.moveRelativeTo,n=e.insideDestination,a=e.draggable,i=e.draggables,o=e.destination,s=e.viewport,c=e.afterCritical;if(!r){if(n.length)return null;var p={displaced:ra,displacedBy:_o,at:{type:"REORDER",destination:{droppableId:o.descriptor.id,index:0}}},v=di({impact:p,draggable:a,droppable:o,draggables:i,afterCritical:c}),g=cn(a,o)?o:ss(o,a,i),m=as({draggable:a,destination:g,newPageBorderBoxCenter:v,viewport:s.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0});return m?p:null}var O=t[o.axis.line]<=r.page.borderBox.center[o.axis.line],D=function(){var A=r.descriptor.index;return r.descriptor.id===a.descriptor.id||O?A:A+1}(),C=aa(o.axis,a.displaceBy);return ci({draggable:a,insideDestination:n,destination:o,viewport:s,displacedBy:C,last:ra,index:D})},Xu=function(e){var t=e.isMovingForward,r=e.previousPageBorderBoxCenter,n=e.draggable,a=e.isOver,i=e.draggables,o=e.droppables,s=e.viewport,c=e.afterCritical,p=ju({isMovingForward:t,pageBorderBoxCenter:r,source:a,droppables:o,viewport:s});if(!p)return null;var v=un(p.descriptor.id,i),g=Wu({pageBorderBoxCenter:r,viewport:s,destination:p,insideDestination:v,afterCritical:c}),m=Gu({previousPageBorderBoxCenter:r,destination:p,draggable:n,draggables:i,moveRelativeTo:g,insideDestination:v,viewport:s,afterCritical:c});if(!m)return null;var O=di({impact:m,draggable:n,droppable:p,draggables:i,afterCritical:c}),D=Hi({pageBorderBoxCenter:O,draggable:n,viewport:s});return{clientSelection:D,impact:m,scrollJumpRequest:null}},Tt=function(e){var t=e.at;return t?t.type==="REORDER"?t.destination.droppableId:t.combine.droppableId:null},Hu=function(t,r){var n=Tt(t);return n?r[n]:null},zu=function(e){var t=e.state,r=e.type,n=Hu(t.impact,t.dimensions.droppables),a=!!n,i=t.dimensions.droppables[t.critical.droppable.id],o=n||i,s=o.axis.direction,c=s==="vertical"&&(r==="MOVE_UP"||r==="MOVE_DOWN")||s==="horizontal"&&(r==="MOVE_LEFT"||r==="MOVE_RIGHT");if(c&&!a)return null;var p=r==="MOVE_DOWN"||r==="MOVE_RIGHT",v=t.dimensions.draggables[t.critical.draggable.id],g=t.current.page.borderBoxCenter,m=t.dimensions,O=m.draggables,D=m.droppables;return c?Bu({isMovingForward:p,previousPageBorderBoxCenter:g,draggable:v,destination:o,draggables:O,viewport:t.viewport,previousClientSelection:t.current.client.selection,previousImpact:t.impact,afterCritical:t.afterCritical}):Xu({isMovingForward:p,previousPageBorderBoxCenter:g,draggable:v,isOver:o,draggables:O,droppables:D,viewport:t.viewport,afterCritical:t.afterCritical})};function $r(e){return e.phase==="DRAGGING"||e.phase==="COLLECTING"}function ls(e){var t=Nt(e.top,e.bottom),r=Nt(e.left,e.right);return function(a){return t(a.y)&&r(a.x)}}function _u(e,t){return e.left<t.right&&e.right>t.left&&e.top<t.bottom&&e.bottom>t.top}function Ku(e){var t=e.pageBorderBox,r=e.draggable,n=e.candidates,a=r.page.borderBox.center,i=n.map(function(o){var s=o.axis,c=pt(o.axis.line,t.center[s.line],o.page.borderBox.center[s.crossAxisLine]);return{id:o.descriptor.id,distance:Kt(a,c)}}).sort(function(o,s){return s.distance-o.distance});return i[0]?i[0].id:null}function Yu(e){var t=e.pageBorderBox,r=e.draggable,n=e.droppables,a=si(n).filter(function(i){if(!i.isEnabled)return!1;var o=i.subject.active;if(!o||!_u(t,o))return!1;if(ls(o)(t.center))return!0;var s=i.axis,c=o.center[s.crossAxisLine],p=t[s.crossAxisStart],v=t[s.crossAxisEnd],g=Nt(o[s.crossAxisStart],o[s.crossAxisEnd]),m=g(p),O=g(v);return!m&&!O?!0:m?p<c:v>c});return a.length?a.length===1?a[0].descriptor.id:Ku({pageBorderBox:t,draggable:r,candidates:a}):null}var us=function(t,r){return(0,ot.l)(Yt(t,r))},Zu=function(e,t){var r=e.frame;return r?us(t,r.scroll.diff.value):t};function cs(e){var t=e.displaced,r=e.id;return!!(t.visible[r]||t.invisible[r])}function Ju(e){var t=e.draggable,r=e.closest,n=e.inHomeList;return r?n&&r.descriptor.index>t.descriptor.index?r.descriptor.index-1:r.descriptor.index:null}var qu=function(e){var t=e.pageBorderBoxWithDroppableScroll,r=e.draggable,n=e.destination,a=e.insideDestination,i=e.last,o=e.viewport,s=e.afterCritical,c=n.axis,p=aa(n.axis,r.displaceBy),v=p.value,g=t[c.start],m=t[c.end],O=ui(r,a),D=gr(O,function(A){var M=A.descriptor.id,$=A.page.borderBox.center[c.line],j=vr(M,s),U=cs({displaced:i,id:M});return j?U?m<=$:g<$-v:U?m<=$+v:g<$}),C=Ju({draggable:r,closest:D,inHomeList:cn(r,n)});return ci({draggable:r,insideDestination:a,destination:n,viewport:o,last:i,displacedBy:p,index:C})},ec=4,tc=function(e){var t=e.draggable,r=e.pageBorderBoxWithDroppableScroll,n=e.previousImpact,a=e.destination,i=e.insideDestination,o=e.afterCritical;if(!a.isCombineEnabled)return null;var s=a.axis,c=aa(a.axis,t.displaceBy),p=c.value,v=r[s.start],g=r[s.end],m=ui(t,i),O=gr(m,function(C){var A=C.descriptor.id,M=C.page.borderBox,$=M[s.size],j=$/ec,U=vr(A,o),J=cs({displaced:n.displaced,id:A});return U?J?g>M[s.start]+j&&g<M[s.end]-j:v>M[s.start]-p+j&&v<M[s.end]-p-j:J?g>M[s.start]+p+j&&g<M[s.end]+p-j:v>M[s.start]+j&&v<M[s.end]-j});if(!O)return null;var D={displacedBy:c,displaced:n.displaced,at:{type:"COMBINE",combine:{draggableId:O.descriptor.id,droppableId:a.descriptor.id}}};return D},ds=function(e){var t=e.pageOffset,r=e.draggable,n=e.draggables,a=e.droppables,i=e.previousImpact,o=e.viewport,s=e.afterCritical,c=us(r.page.borderBox,t),p=Yu({pageBorderBox:c,draggable:r,droppables:a});if(!p)return vu;var v=a[p],g=un(v.descriptor.id,n),m=Zu(v,c);return tc({pageBorderBoxWithDroppableScroll:m,draggable:r,previousImpact:i,destination:v,insideDestination:g,afterCritical:s})||qu({pageBorderBoxWithDroppableScroll:m,draggable:r,destination:v,insideDestination:g,last:i.displaced,viewport:o,afterCritical:s})},zi=function(e,t){var r;return(0,Te.A)({},e,(r={},r[t.descriptor.id]=t,r))},rc=function(t){var r=t.previousImpact,n=t.impact,a=t.droppables,i=Tt(r),o=Tt(n);if(!i||i===o)return a;var s=a[i];if(!s.subject.withPlaceholder)return a;var c=ku(s);return zi(a,c)},nc=function(e){var t=e.draggable,r=e.draggables,n=e.droppables,a=e.previousImpact,i=e.impact,o=rc({previousImpact:a,impact:i,droppables:n}),s=Tt(i);if(!s)return o;var c=n[s];if(cn(t,c)||c.subject.withPlaceholder)return o;var p=ss(c,t,r);return zi(o,p)},ia=function(e){var t=e.state,r=e.clientSelection,n=e.dimensions,a=e.viewport,i=e.impact,o=e.scrollJumpRequest,s=a||t.viewport,c=n||t.dimensions,p=r||t.current.client.selection,v=ke(p,t.initial.client.selection),g={offset:v,selection:p,borderBoxCenter:ze(t.initial.client.borderBoxCenter,v)},m={selection:ze(g.selection,s.scroll.current),borderBoxCenter:ze(g.borderBoxCenter,s.scroll.current),offset:ze(g.offset,s.scroll.diff.value)},O={client:g,page:m};if(t.phase==="COLLECTING")return(0,Te.A)({phase:"COLLECTING"},t,{dimensions:c,viewport:s,current:O});var D=c.draggables[t.critical.draggable.id],C=i||ds({pageOffset:m.offset,draggable:D,draggables:c.draggables,droppables:c.droppables,previousImpact:t.impact,viewport:s,afterCritical:t.afterCritical}),A=nc({draggable:D,impact:C,previousImpact:t.impact,draggables:c.draggables,droppables:c.droppables}),M=(0,Te.A)({},t,{current:O,dimensions:{draggables:c.draggables,droppables:A},impact:C,viewport:s,scrollJumpRequest:o||null,forceShouldAnimate:o?!1:null});return M};function ac(e,t){return e.map(function(r){return t[r]})}var fs=function(e){var t=e.impact,r=e.viewport,n=e.draggables,a=e.destination,i=e.forceShouldAnimate,o=t.displaced,s=ac(o.all,n),c=na({afterDragging:s,destination:a,displacedBy:t.displacedBy,viewport:r.frame,forceShouldAnimate:i,last:o});return(0,Te.A)({},t,{displaced:c})},ps=function(e){var t=e.impact,r=e.draggable,n=e.droppable,a=e.draggables,i=e.viewport,o=e.afterCritical,s=di({impact:t,draggable:r,draggables:a,droppable:n,afterCritical:o});return Hi({pageBorderBoxCenter:s,draggable:r,viewport:i})},gs=function(e){var t=e.state,r=e.dimensions,n=e.viewport;t.movementMode!=="SNAP"&&E(!1);var a=t.impact,i=n||t.viewport,o=r||t.dimensions,s=o.draggables,c=o.droppables,p=s[t.critical.draggable.id],v=Tt(a);v||E(!1);var g=c[v],m=fs({impact:a,viewport:i,destination:g,draggables:s}),O=ps({impact:m,draggable:p,droppable:g,draggables:s,viewport:i,afterCritical:t.afterCritical});return ia({impact:m,clientSelection:O,state:t,dimensions:o,viewport:i})},ic=function(e){return{index:e.index,droppableId:e.droppableId}},vs=function(e){var t=e.draggable,r=e.home,n=e.draggables,a=e.viewport,i=aa(r.axis,t.displaceBy),o=un(r.descriptor.id,n),s=o.indexOf(t);s===-1&&E(!1);var c=o.slice(s+1),p=c.reduce(function(O,D){return O[D.descriptor.id]=!0,O},{}),v={inVirtualList:r.descriptor.mode==="virtual",displacedBy:i,effected:p},g=na({afterDragging:c,destination:r,displacedBy:i,last:null,viewport:a.frame,forceShouldAnimate:!1}),m={displaced:g,displacedBy:i,at:{type:"REORDER",destination:ic(t.descriptor)}};return{impact:m,afterCritical:v}},oc=function(e,t){return{draggables:e.draggables,droppables:zi(e.droppables,t)}},oa=function(t){},sa=function(t){},sc=function(e){var t=e.draggable,r=e.offset,n=e.initialWindowScroll,a=(0,ot.cY)(t.client,r),i=(0,ot.SQ)(a,n),o=(0,Te.A)({},t,{placeholder:(0,Te.A)({},t.placeholder,{client:a}),client:a,page:i});return o},lc=function(e){var t=e.frame;return t||E(!1),t},uc=function(e){var t=e.additions,r=e.updatedDroppables,n=e.viewport,a=n.scroll.diff.value;return t.map(function(i){var o=i.descriptor.droppableId,s=r[o],c=lc(s),p=c.scroll.diff.value,v=ze(a,p),g=sc({draggable:i,offset:v,initialWindowScroll:n.scroll.initial});return g})},cc=function(e){var t=e.state,r=e.published;oa();var n=r.modified.map(function(j){var U=t.dimensions.droppables[j.droppableId],J=ji(U,j.scroll);return J}),a=(0,Te.A)({},t.dimensions.droppables,{},Ho(n)),i=zo(uc({additions:r.additions,updatedDroppables:a,viewport:t.viewport})),o=(0,Te.A)({},t.dimensions.draggables,{},i);r.removals.forEach(function(j){delete o[j]});var s={droppables:a,draggables:o},c=Tt(t.impact),p=c?s.droppables[c]:null,v=s.draggables[t.critical.draggable.id],g=s.droppables[t.critical.droppable.id],m=vs({draggable:v,home:g,draggables:o,viewport:t.viewport}),O=m.impact,D=m.afterCritical,C=p&&p.isCombineEnabled?t.impact:O,A=ds({pageOffset:t.current.page.offset,draggable:s.draggables[t.critical.draggable.id],draggables:s.draggables,droppables:s.droppables,previousImpact:C,viewport:t.viewport,afterCritical:D});sa();var M=(0,Te.A)({phase:"DRAGGING"},t,{phase:"DRAGGING",impact:A,onLiftImpact:O,dimensions:s,afterCritical:D,forceShouldAnimate:!1});if(t.phase==="COLLECTING")return M;var $=(0,Te.A)({phase:"DROP_PENDING"},M,{phase:"DROP_PENDING",reason:t.reason,isWaiting:!1});return $},_i=function(t){return t.movementMode==="SNAP"},Ki=function(t,r,n){var a=oc(t.dimensions,r);return!_i(t)||n?ia({state:t,dimensions:a}):gs({state:t,dimensions:a})};function Yi(e){return e.isDragging&&e.movementMode==="SNAP"?(0,Te.A)({phase:"DRAGGING"},e,{scrollJumpRequest:null}):e}var ms={phase:"IDLE",completed:null,shouldFlush:!1},dc=function(e,t){if(e===void 0&&(e=ms),t.type==="FLUSH")return(0,Te.A)({},ms,{shouldFlush:!0});if(t.type==="INITIAL_PUBLISH"){e.phase!=="IDLE"&&E(!1);var r=t.payload,n=r.critical,a=r.clientSelection,i=r.viewport,o=r.dimensions,s=r.movementMode,c=o.draggables[n.draggable.id],p=o.droppables[n.droppable.id],v={selection:a,borderBoxCenter:c.client.borderBox.center,offset:We},g={client:v,page:{selection:ze(v.selection,i.scroll.initial),borderBoxCenter:ze(v.selection,i.scroll.initial),offset:ze(v.selection,i.scroll.diff.value)}},m=si(o.droppables).every(function(yr){return!yr.isFixedOnPage}),O=vs({draggable:c,home:p,draggables:o.draggables,viewport:i}),D=O.impact,C=O.afterCritical,A={phase:"DRAGGING",isDragging:!0,critical:n,movementMode:s,dimensions:o,initial:g,current:g,isWindowScrollAllowed:m,impact:D,afterCritical:C,onLiftImpact:D,viewport:i,scrollJumpRequest:null,forceShouldAnimate:null};return A}if(t.type==="COLLECTION_STARTING"){if(e.phase==="COLLECTING"||e.phase==="DROP_PENDING")return e;e.phase!=="DRAGGING"&&E(!1);var M=(0,Te.A)({phase:"COLLECTING"},e,{phase:"COLLECTING"});return M}if(t.type==="PUBLISH_WHILE_DRAGGING")return e.phase==="COLLECTING"||e.phase==="DROP_PENDING"||E(!1),cc({state:e,published:t.payload});if(t.type==="MOVE"){if(e.phase==="DROP_PENDING")return e;$r(e)||E(!1);var $=t.payload.client;return et($,e.current.client.selection)?e:ia({state:e,clientSelection:$,impact:_i(e)?e.impact:null})}if(t.type==="UPDATE_DROPPABLE_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="COLLECTING")return Yi(e);$r(e)||E(!1);var j=t.payload,U=j.id,J=j.newScroll,X=e.dimensions.droppables[U];if(!X)return e;var re=ji(X,J);return Ki(e,re,!1)}if(t.type==="UPDATE_DROPPABLE_IS_ENABLED"){if(e.phase==="DROP_PENDING")return e;$r(e)||E(!1);var Z=t.payload,be=Z.id,Re=Z.isEnabled,Ue=e.dimensions.droppables[be];Ue||E(!1),Ue.isEnabled===Re&&E(!1);var Je=(0,Te.A)({},Ue,{isEnabled:Re});return Ki(e,Je,!0)}if(t.type==="UPDATE_DROPPABLE_IS_COMBINE_ENABLED"){if(e.phase==="DROP_PENDING")return e;$r(e)||E(!1);var tt=t.payload,it=tt.id,Xe=tt.isCombineEnabled,$e=e.dimensions.droppables[it];$e||E(!1),$e.isCombineEnabled===Xe&&E(!1);var Ge=(0,Te.A)({},$e,{isCombineEnabled:Xe});return Ki(e,Ge,!0)}if(t.type==="MOVE_BY_WINDOW_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="DROP_ANIMATING")return e;$r(e)||E(!1),e.isWindowScrollAllowed||E(!1);var dt=t.payload.newScroll;if(et(e.viewport.scroll.current,dt))return Yi(e);var ct=rs(e.viewport,dt);return _i(e)?gs({state:e,viewport:ct}):ia({state:e,viewport:ct})}if(t.type==="UPDATE_VIEWPORT_MAX_SCROLL"){if(!$r(e))return e;var $t=t.payload.maxScroll;if(et($t,e.viewport.scroll.max))return e;var Lt=(0,Te.A)({},e.viewport,{scroll:(0,Te.A)({},e.viewport.scroll,{max:$t})});return(0,Te.A)({phase:"DRAGGING"},e,{viewport:Lt})}if(t.type==="MOVE_UP"||t.type==="MOVE_DOWN"||t.type==="MOVE_LEFT"||t.type==="MOVE_RIGHT"){if(e.phase==="COLLECTING"||e.phase==="DROP_PENDING")return e;e.phase!=="DRAGGING"&&E(!1);var gt=zu({state:e,type:t.type});return gt?ia({state:e,impact:gt.impact,clientSelection:gt.clientSelection,scrollJumpRequest:gt.scrollJumpRequest}):e}if(t.type==="DROP_PENDING"){var St=t.payload.reason;e.phase!=="COLLECTING"&&E(!1);var Ct=(0,Te.A)({phase:"DROP_PENDING"},e,{phase:"DROP_PENDING",isWaiting:!0,reason:St});return Ct}if(t.type==="DROP_ANIMATE"){var Ft=t.payload,Ot=Ft.completed,qt=Ft.dropDuration,Wt=Ft.newHomeClientOffset;e.phase==="DRAGGING"||e.phase==="DROP_PENDING"||E(!1);var er={phase:"DROP_ANIMATING",completed:Ot,dropDuration:qt,newHomeClientOffset:Wt,dimensions:e.dimensions};return er}if(t.type==="DROP_COMPLETE"){var On=t.payload.completed;return{phase:"IDLE",completed:On,shouldFlush:!1}}return e},fc=function(t){return{type:"BEFORE_INITIAL_CAPTURE",payload:t}},pc=function(t){return{type:"LIFT",payload:t}},gc=function(t){return{type:"INITIAL_PUBLISH",payload:t}},vc=function(t){return{type:"PUBLISH_WHILE_DRAGGING",payload:t}},mc=function(){return{type:"COLLECTION_STARTING",payload:null}},hc=function(t){return{type:"UPDATE_DROPPABLE_SCROLL",payload:t}},bc=function(t){return{type:"UPDATE_DROPPABLE_IS_ENABLED",payload:t}},yc=function(t){return{type:"UPDATE_DROPPABLE_IS_COMBINE_ENABLED",payload:t}},hs=function(t){return{type:"MOVE",payload:t}},Oc=function(t){return{type:"MOVE_BY_WINDOW_SCROLL",payload:t}},xc=function(t){return{type:"UPDATE_VIEWPORT_MAX_SCROLL",payload:t}},Ec=function(){return{type:"MOVE_UP",payload:null}},Sc=function(){return{type:"MOVE_DOWN",payload:null}},Pc=function(){return{type:"MOVE_RIGHT",payload:null}},Dc=function(){return{type:"MOVE_LEFT",payload:null}},Zi=function(){return{type:"FLUSH",payload:null}},wc=function(t){return{type:"DROP_ANIMATE",payload:t}},Ji=function(t){return{type:"DROP_COMPLETE",payload:t}},bs=function(t){return{type:"DROP",payload:t}},Lc=function(t){return{type:"DROP_PENDING",payload:t}},ys=function(){return{type:"DROP_ANIMATION_FINISHED",payload:null}};function Zm(e){if(!(e.length<=1)){for(var t=e.map(function(s){return s.descriptor.index}),r={},n=1;n<t.length;n++){var a=t[n],i=t[n-1];a!==i+1&&(r[a]=!0)}if(Object.keys(r).length)var o=t.map(function(s){var c=!!r[s];return c?"[\u{1F525}"+s+"]":""+s}).join(", ")}}function Cc(e,t){if(0)var r}var Rc=function(e){return function(t){var r=t.getState,n=t.dispatch;return function(a){return function(i){if(i.type!=="LIFT"){a(i);return}var o=i.payload,s=o.id,c=o.clientSelection,p=o.movementMode,v=r();v.phase==="DROP_ANIMATING"&&n(Ji({completed:v.completed})),r().phase!=="IDLE"&&E(!1),n(Zi()),n(fc({draggableId:s,movementMode:p}));var g={shouldPublishImmediately:p==="SNAP"},m={draggableId:s,scrollOptions:g},O=e.startPublishing(m),D=O.critical,C=O.dimensions,A=O.viewport;Cc(D,C),n(gc({critical:D,dimensions:C,clientSelection:c,movementMode:p,viewport:A}))}}}},Tc=function(e){return function(){return function(t){return function(r){r.type==="INITIAL_PUBLISH"&&e.dragging(),r.type==="DROP_ANIMATE"&&e.dropping(r.payload.completed.result.reason),(r.type==="FLUSH"||r.type==="DROP_COMPLETE")&&e.resting(),t(r)}}}},qi={outOfTheWay:"cubic-bezier(0.2, 0, 0, 1)",drop:"cubic-bezier(.2,1,.1,1)"},la={opacity:{drop:0,combining:.7},scale:{drop:.75}},eo={outOfTheWay:.2,minDropTime:.33,maxDropTime:.55},Fr=eo.outOfTheWay+"s "+qi.outOfTheWay,ua={fluid:"opacity "+Fr,snap:"transform "+Fr+", opacity "+Fr,drop:function(t){var r=t+"s "+qi.drop;return"transform "+r+", opacity "+r},outOfTheWay:"transform "+Fr,placeholder:"height "+Fr+", width "+Fr+", margin "+Fr},Os=function(t){return et(t,We)?null:"translate("+t.x+"px, "+t.y+"px)"},to={moveTo:Os,drop:function(t,r){var n=Os(t);return n?r?n+" scale("+la.scale.drop+")":n:null}},ro=eo.minDropTime,xs=eo.maxDropTime,Ic=xs-ro,Es=1500,Ac=.6,$c=function(e){var t=e.current,r=e.destination,n=e.reason,a=Kt(t,r);if(a<=0)return ro;if(a>=Es)return xs;var i=a/Es,o=ro+Ic*i,s=n==="CANCEL"?o*Ac:o;return Number(s.toFixed(2))},Fc=function(e){var t=e.impact,r=e.draggable,n=e.dimensions,a=e.viewport,i=e.afterCritical,o=n.draggables,s=n.droppables,c=Tt(t),p=c?s[c]:null,v=s[r.descriptor.droppableId],g=ps({impact:t,draggable:r,draggables:o,afterCritical:i,droppable:p||v,viewport:a}),m=ke(g,r.client.borderBox.center);return m},Qc=function(e){var t=e.draggables,r=e.reason,n=e.lastImpact,a=e.home,i=e.viewport,o=e.onLiftImpact;if(!n.at||r!=="DROP"){var s=fs({draggables:t,impact:o,destination:a,viewport:i,forceShouldAnimate:!0});return{impact:s,didDropInsideDroppable:!1}}if(n.at.type==="REORDER")return{impact:n,didDropInsideDroppable:!0};var c=(0,Te.A)({},n,{displaced:ra});return{impact:c,didDropInsideDroppable:!0}},Mc=function(e){var t=e.getState,r=e.dispatch;return function(n){return function(a){if(a.type!=="DROP"){n(a);return}var i=t(),o=a.payload.reason;if(i.phase==="COLLECTING"){r(Lc({reason:o}));return}if(i.phase!=="IDLE"){var s=i.phase==="DROP_PENDING"&&i.isWaiting;s&&E(!1),i.phase==="DRAGGING"||i.phase==="DROP_PENDING"||E(!1);var c=i.critical,p=i.dimensions,v=p.draggables[i.critical.draggable.id],g=Qc({reason:o,lastImpact:i.impact,afterCritical:i.afterCritical,onLiftImpact:i.onLiftImpact,home:i.dimensions.droppables[i.critical.droppable.id],viewport:i.viewport,draggables:i.dimensions.draggables}),m=g.impact,O=g.didDropInsideDroppable,D=O?Wi(m):null,C=O?li(m):null,A={index:c.draggable.index,droppableId:c.droppable.id},M={draggableId:v.descriptor.id,type:v.descriptor.type,source:A,reason:o,mode:i.movementMode,destination:D,combine:C},$=Fc({impact:m,draggable:v,dimensions:p,viewport:i.viewport,afterCritical:i.afterCritical}),j={critical:i.critical,afterCritical:i.afterCritical,result:M,impact:m},U=!et(i.current.client.offset,$)||!!M.combine;if(!U){r(Ji({completed:j}));return}var J=$c({current:i.current.client.offset,destination:$,reason:o}),X={newHomeClientOffset:$,dropDuration:J,completed:j};r(wc(X))}}}},Ss=function(){return{x:window.pageXOffset,y:window.pageYOffset}};function Nc(e){return{eventName:"scroll",options:{passive:!0,capture:!1},fn:function(r){r.target!==window&&r.target!==window.document||e()}}}function Bc(e){var t=e.onWindowScroll;function r(){t(Ss())}var n=(0,ar.A)(r),a=Nc(n),i=u;function o(){return i!==u}function s(){o()&&E(!1),i=f(window,[a])}function c(){o()||E(!1),n.cancel(),i(),i=u}return{start:s,stop:c,isActive:o}}var jc=function(t){return t.type==="DROP_COMPLETE"||t.type==="DROP_ANIMATE"||t.type==="FLUSH"},Uc=function(e){var t=Bc({onWindowScroll:function(n){e.dispatch(Oc({newScroll:n}))}});return function(r){return function(n){!t.isActive()&&n.type==="INITIAL_PUBLISH"&&t.start(),t.isActive()&&jc(n)&&t.stop(),r(n)}}},Wc=function(e){var t=!1,r=!1,n=setTimeout(function(){r=!0}),a=function(o){t||r||(t=!0,e(o),clearTimeout(n))};return a.wasCalled=function(){return t},a},Vc=function(){var e=[],t=function(i){var o=Ui(e,function(p){return p.timerId===i});o===-1&&E(!1);var s=e.splice(o,1),c=s[0];c.callback()},r=function(i){var o=setTimeout(function(){return t(o)}),s={timerId:o,callback:i};e.push(s)},n=function(){if(e.length){var i=[].concat(e);e.length=0,i.forEach(function(o){clearTimeout(o.timerId),o.callback()})}};return{add:r,flush:n}},kc=function(t,r){return t==null&&r==null?!0:t==null||r==null?!1:t.droppableId===r.droppableId&&t.index===r.index},Gc=function(t,r){return t==null&&r==null?!0:t==null||r==null?!1:t.draggableId===r.draggableId&&t.droppableId===r.droppableId},Xc=function(t,r){if(t===r)return!0;var n=t.draggable.id===r.draggable.id&&t.draggable.droppableId===r.draggable.droppableId&&t.draggable.type===r.draggable.type&&t.draggable.index===r.draggable.index,a=t.droppable.id===r.droppable.id&&t.droppable.type===r.droppable.type;return n&&a},ca=function(t,r){oa(),r(),sa()},fi=function(t,r){return{draggableId:t.draggable.id,type:t.droppable.type,source:{droppableId:t.droppable.id,index:t.draggable.index},mode:r}},no=function(t,r,n,a){if(!t){n(a(r));return}var i=Wc(n),o={announce:i};t(r,o),i.wasCalled()||n(a(r))},Hc=function(e,t){var r=Vc(),n=null,a=function(m,O){n&&E(!1),ca("onBeforeCapture",function(){var D=e().onBeforeCapture;if(D){var C={draggableId:m,mode:O};D(C)}})},i=function(m,O){n&&E(!1),ca("onBeforeDragStart",function(){var D=e().onBeforeDragStart;D&&D(fi(m,O))})},o=function(m,O){n&&E(!1);var D=fi(m,O);n={mode:O,lastCritical:m,lastLocation:D.source,lastCombine:null},r.add(function(){ca("onDragStart",function(){return no(e().onDragStart,D,t,Ae.onDragStart)})})},s=function(m,O){var D=Wi(O),C=li(O);n||E(!1);var A=!Xc(m,n.lastCritical);A&&(n.lastCritical=m);var M=!kc(n.lastLocation,D);M&&(n.lastLocation=D);var $=!Gc(n.lastCombine,C);if($&&(n.lastCombine=C),!(!A&&!M&&!$)){var j=(0,Te.A)({},fi(m,n.mode),{combine:C,destination:D});r.add(function(){ca("onDragUpdate",function(){return no(e().onDragUpdate,j,t,Ae.onDragUpdate)})})}},c=function(){n||E(!1),r.flush()},p=function(m){n||E(!1),n=null,ca("onDragEnd",function(){return no(e().onDragEnd,m,t,Ae.onDragEnd)})},v=function(){if(n){var m=(0,Te.A)({},fi(n.lastCritical,n.mode),{combine:null,destination:null,reason:"CANCEL"});p(m)}};return{beforeCapture:a,beforeStart:i,start:o,update:s,flush:c,drop:p,abort:v}},zc=function(e,t){var r=Hc(e,t);return function(n){return function(a){return function(i){if(i.type==="BEFORE_INITIAL_CAPTURE"){r.beforeCapture(i.payload.draggableId,i.payload.movementMode);return}if(i.type==="INITIAL_PUBLISH"){var o=i.payload.critical;r.beforeStart(o,i.payload.movementMode),a(i),r.start(o,i.payload.movementMode);return}if(i.type==="DROP_COMPLETE"){var s=i.payload.completed.result;r.flush(),a(i),r.drop(s);return}if(a(i),i.type==="FLUSH"){r.abort();return}var c=n.getState();c.phase==="DRAGGING"&&r.update(c.critical,c.impact)}}}},_c=function(e){return function(t){return function(r){if(r.type!=="DROP_ANIMATION_FINISHED"){t(r);return}var n=e.getState();n.phase!=="DROP_ANIMATING"&&E(!1),e.dispatch(Ji({completed:n.completed}))}}},Kc=function(e){var t=null,r=null;function n(){r&&(cancelAnimationFrame(r),r=null),t&&(t(),t=null)}return function(a){return function(i){if((i.type==="FLUSH"||i.type==="DROP_COMPLETE"||i.type==="DROP_ANIMATION_FINISHED")&&n(),a(i),i.type==="DROP_ANIMATE"){var o={eventName:"scroll",options:{capture:!0,passive:!1,once:!0},fn:function(){var c=e.getState();c.phase==="DROP_ANIMATING"&&e.dispatch(ys())}};r=requestAnimationFrame(function(){r=null,t=f(window,[o])})}}}},Yc=function(e){return function(){return function(t){return function(r){(r.type==="DROP_COMPLETE"||r.type==="FLUSH"||r.type==="DROP_ANIMATE")&&e.stopPublishing(),t(r)}}}},Zc=function(e){var t=!1;return function(){return function(r){return function(n){if(n.type==="INITIAL_PUBLISH"){t=!0,e.tryRecordFocus(n.payload.critical.draggable.id),r(n),e.tryRestoreFocusRecorded();return}if(r(n),!!t){if(n.type==="FLUSH"){t=!1,e.tryRestoreFocusRecorded();return}if(n.type==="DROP_COMPLETE"){t=!1;var a=n.payload.completed.result;a.combine&&e.tryShiftRecord(a.draggableId,a.combine.draggableId),e.tryRestoreFocusRecorded()}}}}}},Jc=function(t){return t.type==="DROP_COMPLETE"||t.type==="DROP_ANIMATE"||t.type==="FLUSH"},qc=function(e){return function(t){return function(r){return function(n){if(Jc(n)){e.stop(),r(n);return}if(n.type==="INITIAL_PUBLISH"){r(n);var a=t.getState();a.phase!=="DRAGGING"&&E(!1),e.start(a);return}r(n),e.scroll(t.getState())}}}},ed=function(e){return function(t){return function(r){if(t(r),r.type==="PUBLISH_WHILE_DRAGGING"){var n=e.getState();n.phase==="DROP_PENDING"&&(n.isWaiting||e.dispatch(bs({reason:n.reason})))}}}},td=fr.compose,rd=function(e){var t=e.dimensionMarshal,r=e.focusMarshal,n=e.styleMarshal,a=e.getResponders,i=e.announce,o=e.autoScroller;return(0,fr.createStore)(dc,td((0,fr.applyMiddleware)(Tc(n),Yc(t),Rc(t),Mc,_c,Kc,ed,qc(o),Uc,Zc(r),zc(a,i))))},ao=function(){return{additions:{},removals:{},modified:{}}};function nd(e){var t=e.registry,r=e.callbacks,n=ao(),a=null,i=function(){a||(r.collectionStarting(),a=requestAnimationFrame(function(){a=null,oa();var v=n,g=v.additions,m=v.removals,O=v.modified,D=Object.keys(g).map(function(M){return t.draggable.getById(M).getDimension(We)}).sort(function(M,$){return M.descriptor.index-$.descriptor.index}),C=Object.keys(O).map(function(M){var $=t.droppable.getById(M),j=$.callbacks.getScrollWhileDragging();return{droppableId:M,scroll:j}}),A={additions:D,removals:Object.keys(m),modified:C};n=ao(),sa(),r.publish(A)}))},o=function(v){var g=v.descriptor.id;n.additions[g]=v,n.modified[v.descriptor.droppableId]=!0,n.removals[g]&&delete n.removals[g],i()},s=function(v){var g=v.descriptor;n.removals[g.id]=!0,n.modified[g.droppableId]=!0,n.additions[g.id]&&delete n.additions[g.id],i()},c=function(){a&&(cancelAnimationFrame(a),a=null,n=ao())};return{add:o,remove:s,stop:c}}var Ps=function(e){var t=e.scrollHeight,r=e.scrollWidth,n=e.height,a=e.width,i=ke({x:r,y:t},{x:a,y:n}),o={x:Math.max(0,i.x),y:Math.max(0,i.y)};return o},Ds=function(){var e=document.documentElement;return e||E(!1),e},ws=function(){var e=Ds(),t=Ps({scrollHeight:e.scrollHeight,scrollWidth:e.scrollWidth,width:e.clientWidth,height:e.clientHeight});return t},ad=function(){var e=Ss(),t=ws(),r=e.y,n=e.x,a=Ds(),i=a.clientWidth,o=a.clientHeight,s=n+i,c=r+o,p=(0,ot.l)({top:r,left:n,right:s,bottom:c}),v={frame:p,scroll:{initial:e,current:e,max:t,diff:{value:We,displacement:We}}};return v},id=function(e){var t=e.critical,r=e.scrollOptions,n=e.registry;oa();var a=ad(),i=a.scroll.current,o=t.droppable,s=n.droppable.getAllByType(o.type).map(function(g){return g.callbacks.getDimensionAndWatchScroll(i,r)}),c=n.draggable.getAllByType(t.draggable.type).map(function(g){return g.getDimension(i)}),p={draggables:zo(c),droppables:Ho(s)};sa();var v={dimensions:p,critical:t,viewport:a};return v};function Ls(e,t,r){if(r.descriptor.id===t.id||r.descriptor.type!==t.type)return!1;var n=e.droppable.getById(r.descriptor.droppableId);return n.descriptor.mode==="virtual"}var od=function(e,t){var r=null,n=nd({callbacks:{publish:t.publishWhileDragging,collectionStarting:t.collectionStarting},registry:e}),a=function(O,D){e.droppable.exists(O)||E(!1),r&&t.updateDroppableIsEnabled({id:O,isEnabled:D})},i=function(O,D){r&&(e.droppable.exists(O)||E(!1),t.updateDroppableIsCombineEnabled({id:O,isCombineEnabled:D}))},o=function(O,D){r&&(e.droppable.exists(O)||E(!1),t.updateDroppableScroll({id:O,newScroll:D}))},s=function(O,D){r&&e.droppable.getById(O).callbacks.scroll(D)},c=function(){if(r){n.stop();var O=r.critical.droppable;e.droppable.getAllByType(O.type).forEach(function(D){return D.callbacks.dragStopped()}),r.unsubscribe(),r=null}},p=function(O){r||E(!1);var D=r.critical.draggable;O.type==="ADDITION"&&Ls(e,D,O.value)&&n.add(O.value),O.type==="REMOVAL"&&Ls(e,D,O.value)&&n.remove(O.value)},v=function(O){r&&E(!1);var D=e.draggable.getById(O.draggableId),C=e.droppable.getById(D.descriptor.droppableId),A={draggable:D.descriptor,droppable:C.descriptor},M=e.subscribe(p);return r={critical:A,unsubscribe:M},id({critical:A,registry:e,scrollOptions:O.scrollOptions})},g={updateDroppableIsEnabled:a,updateDroppableIsCombineEnabled:i,scrollDroppable:s,updateDroppableScroll:o,startPublishing:v,stopPublishing:c};return g},Cs=function(e,t){return e.phase==="IDLE"?!0:e.phase!=="DROP_ANIMATING"||e.completed.result.draggableId===t?!1:e.completed.result.reason==="DROP"},sd=function(e){window.scrollBy(e.x,e.y)},ld=st(function(e){return si(e).filter(function(t){return!(!t.isEnabled||!t.frame)})}),ud=function(t,r){var n=gr(ld(r),function(a){return a.frame||E(!1),ls(a.frame.pageMarginBox)(t)});return n},cd=function(e){var t=e.center,r=e.destination,n=e.droppables;if(r){var a=n[r];return a.frame?a:null}var i=ud(t,n);return i},mr={startFromPercentage:.25,maxScrollAtPercentage:.05,maxPixelScroll:28,ease:function(t){return Math.pow(t,2)},durationDampening:{stopDampeningAt:1200,accelerateAt:360}},dd=function(e,t){var r=e[t.size]*mr.startFromPercentage,n=e[t.size]*mr.maxScrollAtPercentage,a={startScrollingFrom:r,maxScrollValueAt:n};return a},Rs=function(e){var t=e.startOfRange,r=e.endOfRange,n=e.current,a=r-t;if(a===0)return 0;var i=n-t,o=i/a;return o},io=1,fd=function(e,t){if(e>t.startScrollingFrom)return 0;if(e<=t.maxScrollValueAt)return mr.maxPixelScroll;if(e===t.startScrollingFrom)return io;var r=Rs({startOfRange:t.maxScrollValueAt,endOfRange:t.startScrollingFrom,current:e}),n=1-r,a=mr.maxPixelScroll*mr.ease(n);return Math.ceil(a)},Ts=mr.durationDampening.accelerateAt,Is=mr.durationDampening.stopDampeningAt,pd=function(e,t){var r=t,n=Is,a=Date.now(),i=a-r;if(i>=Is)return e;if(i<Ts)return io;var o=Rs({startOfRange:Ts,endOfRange:n,current:i}),s=e*mr.ease(o);return Math.ceil(s)},As=function(e){var t=e.distanceToEdge,r=e.thresholds,n=e.dragStartTime,a=e.shouldUseTimeDampening,i=fd(t,r);return i===0?0:a?Math.max(pd(i,n),io):i},$s=function(e){var t=e.container,r=e.distanceToEdges,n=e.dragStartTime,a=e.axis,i=e.shouldUseTimeDampening,o=dd(t,a),s=r[a.end]<r[a.start];return s?As({distanceToEdge:r[a.end],thresholds:o,dragStartTime:n,shouldUseTimeDampening:i}):-1*As({distanceToEdge:r[a.start],thresholds:o,dragStartTime:n,shouldUseTimeDampening:i})},gd=function(e){var t=e.container,r=e.subject,n=e.proposedScroll,a=r.height>t.height,i=r.width>t.width;return!i&&!a?n:i&&a?null:{x:i?0:n.x,y:a?0:n.y}},vd=ir(function(e){return e===0?0:e}),Fs=function(e){var t=e.dragStartTime,r=e.container,n=e.subject,a=e.center,i=e.shouldUseTimeDampening,o={top:a.y-r.top,right:r.right-a.x,bottom:r.bottom-a.y,left:a.x-r.left},s=$s({container:r,distanceToEdges:o,dragStartTime:t,axis:Vi,shouldUseTimeDampening:i}),c=$s({container:r,distanceToEdges:o,dragStartTime:t,axis:Yo,shouldUseTimeDampening:i}),p=vd({x:c,y:s});if(et(p,We))return null;var v=gd({container:r,subject:n,proposedScroll:p});return v?et(v,We)?null:v:null},md=ir(function(e){return e===0?0:e>0?1:-1}),oo=function(){var e=function(r,n){return r<0?r:r>n?r-n:0};return function(t){var r=t.current,n=t.max,a=t.change,i=ze(r,a),o={x:e(i.x,n.x),y:e(i.y,n.y)};return et(o,We)?null:o}}(),Qs=function(t){var r=t.max,n=t.current,a=t.change,i={x:Math.max(n.x,r.x),y:Math.max(n.y,r.y)},o=md(a),s=oo({max:i,current:n,change:o});return!s||o.x!==0&&s.x===0||o.y!==0&&s.y===0},so=function(t,r){return Qs({current:t.scroll.current,max:t.scroll.max,change:r})},hd=function(t,r){if(!so(t,r))return null;var n=t.scroll.max,a=t.scroll.current;return oo({current:a,max:n,change:r})},lo=function(t,r){var n=t.frame;return n?Qs({current:n.scroll.current,max:n.scroll.max,change:r}):!1},bd=function(t,r){var n=t.frame;return!n||!lo(t,r)?null:oo({current:n.scroll.current,max:n.scroll.max,change:r})},yd=function(e){var t=e.viewport,r=e.subject,n=e.center,a=e.dragStartTime,i=e.shouldUseTimeDampening,o=Fs({dragStartTime:a,container:t.frame,subject:r,center:n,shouldUseTimeDampening:i});return o&&so(t,o)?o:null},Od=function(e){var t=e.droppable,r=e.subject,n=e.center,a=e.dragStartTime,i=e.shouldUseTimeDampening,o=t.frame;if(!o)return null;var s=Fs({dragStartTime:a,container:o.pageMarginBox,subject:r,center:n,shouldUseTimeDampening:i});return s&&lo(t,s)?s:null},Ms=function(e){var t=e.state,r=e.dragStartTime,n=e.shouldUseTimeDampening,a=e.scrollWindow,i=e.scrollDroppable,o=t.current.page.borderBoxCenter,s=t.dimensions.draggables[t.critical.draggable.id],c=s.page.marginBox;if(t.isWindowScrollAllowed){var p=t.viewport,v=yd({dragStartTime:r,viewport:p,subject:c,center:o,shouldUseTimeDampening:n});if(v){a(v);return}}var g=cd({center:o,destination:Tt(t.impact),droppables:t.dimensions.droppables});if(g){var m=Od({dragStartTime:r,droppable:g,subject:c,center:o,shouldUseTimeDampening:n});m&&i(g.descriptor.id,m)}},xd=function(e){var t=e.scrollWindow,r=e.scrollDroppable,n=(0,ar.A)(t),a=(0,ar.A)(r),i=null,o=function(v){i||E(!1);var g=i,m=g.shouldUseTimeDampening,O=g.dragStartTime;Ms({state:v,scrollWindow:n,scrollDroppable:a,dragStartTime:O,shouldUseTimeDampening:m})},s=function(v){oa(),i&&E(!1);var g=Date.now(),m=!1,O=function(){m=!0};Ms({state:v,dragStartTime:0,shouldUseTimeDampening:!1,scrollWindow:O,scrollDroppable:O}),i={dragStartTime:g,shouldUseTimeDampening:m},sa(),m&&o(v)},c=function(){i&&(n.cancel(),a.cancel(),i=null)};return{start:s,stop:c,scroll:o}},Ed=function(e){var t=e.move,r=e.scrollDroppable,n=e.scrollWindow,a=function(p,v){var g=ze(p.current.client.selection,v);t({client:g})},i=function(p,v){if(!lo(p,v))return v;var g=bd(p,v);if(!g)return r(p.descriptor.id,v),null;var m=ke(v,g);r(p.descriptor.id,m);var O=ke(v,m);return O},o=function(p,v,g){if(!p||!so(v,g))return g;var m=hd(v,g);if(!m)return n(g),null;var O=ke(g,m);n(O);var D=ke(g,O);return D},s=function(p){var v=p.scrollJumpRequest;if(v){var g=Tt(p.impact);g||E(!1);var m=i(p.dimensions.droppables[g],v);if(m){var O=p.viewport,D=o(p.isWindowScrollAllowed,O,m);D&&a(p,D)}}};return s},Sd=function(e){var t=e.scrollDroppable,r=e.scrollWindow,n=e.move,a=xd({scrollWindow:r,scrollDroppable:t}),i=Ed({move:n,scrollWindow:r,scrollDroppable:t}),o=function(p){if(p.phase==="DRAGGING"){if(p.movementMode==="FLUID"){a.scroll(p);return}p.scrollJumpRequest&&i(p)}},s={scroll:o,start:a.start,stop:a.stop};return s},dn="data-rbd",fn=function(){var e=dn+"-drag-handle";return{base:e,draggableId:e+"-draggable-id",contextId:e+"-context-id"}}(),uo=function(){var e=dn+"-draggable";return{base:e,contextId:e+"-context-id",id:e+"-id"}}(),Pd=function(){var e=dn+"-droppable";return{base:e,contextId:e+"-context-id",id:e+"-id"}}(),Ns={contextId:dn+"-scroll-container-context-id"},Dd=function(t){return function(r){return"["+r+'="'+t+'"]'}},da=function(t,r){return t.map(function(n){var a=n.styles[r];return a?n.selector+" { "+a+" }":""}).join(" ")},wd="pointer-events: none;",Ld=function(e){var t=Dd(e),r=function(){var s=`
      cursor: -webkit-grab;
      cursor: grab;
    `;return{selector:t(fn.contextId),styles:{always:`
          -webkit-touch-callout: none;
          -webkit-tap-highlight-color: rgba(0,0,0,0);
          touch-action: manipulation;
        `,resting:s,dragging:wd,dropAnimating:s}}}(),n=function(){var s=`
      transition: `+ua.outOfTheWay+`;
    `;return{selector:t(uo.contextId),styles:{dragging:s,dropAnimating:s,userCancel:s}}}(),a={selector:t(Pd.contextId),styles:{always:"overflow-anchor: none;"}},i={selector:"body",styles:{dragging:`
        cursor: grabbing;
        cursor: -webkit-grabbing;
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        overflow-anchor: none;
      `}},o=[n,r,a,i];return{always:da(o,"always"),resting:da(o,"resting"),dragging:da(o,"dragging"),dropAnimating:da(o,"dropAnimating"),userCancel:da(o,"userCancel")}},It=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?d.useLayoutEffect:d.useEffect,co=function(){var t=document.querySelector("head");return t||E(!1),t},Bs=function(t){var r=document.createElement("style");return t&&r.setAttribute("nonce",t),r.type="text/css",r};function Cd(e,t){var r=(0,se.Kr)(function(){return Ld(e)},[e]),n=(0,d.useRef)(null),a=(0,d.useRef)(null),i=(0,se.hb)(st(function(g){var m=a.current;m||E(!1),m.textContent=g}),[]),o=(0,se.hb)(function(g){var m=n.current;m||E(!1),m.textContent=g},[]);It(function(){!n.current&&!a.current||E(!1);var g=Bs(t),m=Bs(t);return n.current=g,a.current=m,g.setAttribute(dn+"-always",e),m.setAttribute(dn+"-dynamic",e),co().appendChild(g),co().appendChild(m),o(r.always),i(r.resting),function(){var O=function(C){var A=C.current;A||E(!1),co().removeChild(A),C.current=null};O(n),O(a)}},[t,o,i,r.always,r.resting,e]);var s=(0,se.hb)(function(){return i(r.dragging)},[i,r.dragging]),c=(0,se.hb)(function(g){if(g==="DROP"){i(r.dropAnimating);return}i(r.userCancel)},[i,r.dropAnimating,r.userCancel]),p=(0,se.hb)(function(){a.current&&i(r.resting)},[i,r.resting]),v=(0,se.Kr)(function(){return{dragging:s,dropping:c,resting:p}},[s,c,p]);return v}var js=function(e){return e&&e.ownerDocument?e.ownerDocument.defaultView:window};function fa(e){return e instanceof js(e).HTMLElement}function Us(e,t){var r="["+fn.contextId+'="'+e+'"]',n=Xo(document.querySelectorAll(r));if(!n.length)return null;var a=gr(n,function(i){return i.getAttribute(fn.draggableId)===t});return!a||!fa(a)?null:a}function Rd(e){var t=(0,d.useRef)({}),r=(0,d.useRef)(null),n=(0,d.useRef)(null),a=(0,d.useRef)(!1),i=(0,se.hb)(function(m,O){var D={id:m,focus:O};return t.current[m]=D,function(){var A=t.current,M=A[m];M!==D&&delete A[m]}},[]),o=(0,se.hb)(function(m){var O=Us(e,m);O&&O!==document.activeElement&&O.focus()},[e]),s=(0,se.hb)(function(m,O){r.current===m&&(r.current=O)},[]),c=(0,se.hb)(function(){n.current||a.current&&(n.current=requestAnimationFrame(function(){n.current=null;var m=r.current;m&&o(m)}))},[o]),p=(0,se.hb)(function(m){r.current=null;var O=document.activeElement;O&&O.getAttribute(fn.draggableId)===m&&(r.current=m)},[]);It(function(){return a.current=!0,function(){a.current=!1;var m=n.current;m&&cancelAnimationFrame(m)}},[]);var v=(0,se.Kr)(function(){return{register:i,tryRecordFocus:p,tryRestoreFocusRecorded:c,tryShiftRecord:s}},[i,p,c,s]);return v}function Td(){var e={draggables:{},droppables:{}},t=[];function r(g){return t.push(g),function(){var O=t.indexOf(g);O!==-1&&t.splice(O,1)}}function n(g){t.length&&t.forEach(function(m){return m(g)})}function a(g){return e.draggables[g]||null}function i(g){var m=a(g);return m||E(!1),m}var o={register:function(m){e.draggables[m.descriptor.id]=m,n({type:"ADDITION",value:m})},update:function(m,O){var D=e.draggables[O.descriptor.id];D&&D.uniqueId===m.uniqueId&&(delete e.draggables[O.descriptor.id],e.draggables[m.descriptor.id]=m)},unregister:function(m){var O=m.descriptor.id,D=a(O);D&&m.uniqueId===D.uniqueId&&(delete e.draggables[O],n({type:"REMOVAL",value:m}))},getById:i,findById:a,exists:function(m){return!!a(m)},getAllByType:function(m){return oi(e.draggables).filter(function(O){return O.descriptor.type===m})}};function s(g){return e.droppables[g]||null}function c(g){var m=s(g);return m||E(!1),m}var p={register:function(m){e.droppables[m.descriptor.id]=m},unregister:function(m){var O=s(m.descriptor.id);O&&m.uniqueId===O.uniqueId&&delete e.droppables[m.descriptor.id]},getById:c,findById:s,exists:function(m){return!!s(m)},getAllByType:function(m){return oi(e.droppables).filter(function(O){return O.descriptor.type===m})}};function v(){e.draggables={},e.droppables={},t.length=0}return{draggable:o,droppable:p,subscribe:r,clean:v}}function Id(){var e=(0,se.Kr)(Td,[]);return(0,d.useEffect)(function(){return function(){requestAnimationFrame(e.clean)}},[e]),e}var fo=d.createContext(null),pa=function(){var e=document.body;return e||E(!1),e},Ad={position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0 0 0 0)","clip-path":"inset(100%)"},$d=function(t){return"rbd-announcement-"+t};function Fd(e){var t=(0,se.Kr)(function(){return $d(e)},[e]),r=(0,d.useRef)(null);(0,d.useEffect)(function(){var i=document.createElement("div");return r.current=i,i.id=t,i.setAttribute("aria-live","assertive"),i.setAttribute("aria-atomic","true"),(0,Te.A)(i.style,Ad),pa().appendChild(i),function(){setTimeout(function(){var c=pa();c.contains(i)&&c.removeChild(i),i===r.current&&(r.current=null)})}},[t]);var n=(0,se.hb)(function(a){var i=r.current;if(i){i.textContent=a;return}},[]);return n}var Ws=0,Qd={separator:"::"};function Md(){Ws=0}function po(e,t){return t===void 0&&(t=Qd),(0,se.Kr)(function(){return""+e+t.separator+Ws++},[t.separator,e])}function Nd(e){var t=e.contextId,r=e.uniqueId;return"rbd-hidden-text-"+t+"-"+r}function Bd(e){var t=e.contextId,r=e.text,n=po("hidden-text",{separator:"-"}),a=(0,se.Kr)(function(){return Nd({contextId:t,uniqueId:n})},[n,t]);return(0,d.useEffect)(function(){var o=document.createElement("div");return o.id=a,o.textContent=r,o.style.display="none",pa().appendChild(o),function(){var c=pa();c.contains(o)&&c.removeChild(o)}},[a,r]),a}var pi=d.createContext(null),jd={react:"^16.8.5 || ^17.0.0 || ^18.0.0","react-dom":"^16.8.5 || ^17.0.0 || ^18.0.0"},Ud=/(\d+)\.(\d+)\.(\d+)/,Vs=function(t){var r=Ud.exec(t);r==null&&E(!1);var n=Number(r[1]),a=Number(r[2]),i=Number(r[3]);return{major:n,minor:a,patch:i,raw:t}},Wd=function(t,r){return r.major>t.major?!0:r.major<t.major?!1:r.minor>t.minor?!0:r.minor<t.minor?!1:r.patch>=t.patch},Vd=function(e,t){var r=Vs(e),n=Vs(t);Wd(r,n)},Jm=`
  We expect a html5 doctype: <!doctype html>
  This is to ensure consistent browser layout and measurement

  More information: https://github.com/atlassian/react-beautiful-dnd/blob/master/docs/guides/doctype.md
`,kd=function(e){var t=e.doctype;t&&(t.name.toLowerCase(),t.publicId)};function qm(e){}function ga(e,t){}function Gd(){ga(function(){Vd(jd.react,d.version),kd(document)},[])}function go(e){var t=(0,d.useRef)(e);return(0,d.useEffect)(function(){t.current=e}),t}function Xd(){var e=null;function t(){return!!e}function r(o){return o===e}function n(o){e&&E(!1);var s={abandon:o};return e=s,s}function a(){e||E(!1),e=null}function i(){e&&(e.abandon(),a())}return{isClaimed:t,isActive:r,claim:n,release:a,tryAbandon:i}}var Hd=9,zd=13,vo=27,ks=32,_d=33,Kd=34,Yd=35,Zd=36,Jd=37,qd=38,ef=39,tf=40,gi,rf=(gi={},gi[zd]=!0,gi[Hd]=!0,gi),Gs=function(e){rf[e.keyCode]&&e.preventDefault()},vi=function(){var e="visibilitychange";if(typeof document>"u")return e;var t=[e,"ms"+e,"webkit"+e,"moz"+e,"o"+e],r=gr(t,function(n){return"on"+n in document});return r||e}(),Xs=0,Hs=5;function nf(e,t){return Math.abs(t.x-e.x)>=Hs||Math.abs(t.y-e.y)>=Hs}var zs={type:"IDLE"};function af(e){var t=e.cancel,r=e.completed,n=e.getPhase,a=e.setPhase;return[{eventName:"mousemove",fn:function(o){var s=o.button,c=o.clientX,p=o.clientY;if(s===Xs){var v={x:c,y:p},g=n();if(g.type==="DRAGGING"){o.preventDefault(),g.actions.move(v);return}g.type!=="PENDING"&&E(!1);var m=g.point;if(nf(m,v)){o.preventDefault();var O=g.actions.fluidLift(v);a({type:"DRAGGING",actions:O})}}}},{eventName:"mouseup",fn:function(o){var s=n();if(s.type!=="DRAGGING"){t();return}o.preventDefault(),s.actions.drop({shouldBlockNextClick:!0}),r()}},{eventName:"mousedown",fn:function(o){n().type==="DRAGGING"&&o.preventDefault(),t()}},{eventName:"keydown",fn:function(o){var s=n();if(s.type==="PENDING"){t();return}if(o.keyCode===vo){o.preventDefault(),t();return}Gs(o)}},{eventName:"resize",fn:t},{eventName:"scroll",options:{passive:!0,capture:!1},fn:function(){n().type==="PENDING"&&t()}},{eventName:"webkitmouseforcedown",fn:function(o){var s=n();if(s.type==="IDLE"&&E(!1),s.actions.shouldRespectForcePress()){t();return}o.preventDefault()}},{eventName:vi,fn:t}]}function of(e){var t=(0,d.useRef)(zs),r=(0,d.useRef)(u),n=(0,se.Kr)(function(){return{eventName:"mousedown",fn:function(g){if(!g.defaultPrevented&&g.button===Xs&&!(g.ctrlKey||g.metaKey||g.shiftKey||g.altKey)){var m=e.findClosestDraggableId(g);if(m){var O=e.tryGetLock(m,o,{sourceEvent:g});if(O){g.preventDefault();var D={x:g.clientX,y:g.clientY};r.current(),p(O,D)}}}}}},[e]),a=(0,se.Kr)(function(){return{eventName:"webkitmouseforcewillbegin",fn:function(g){if(!g.defaultPrevented){var m=e.findClosestDraggableId(g);if(m){var O=e.findOptionsForDraggable(m);O&&(O.shouldRespectForcePress||e.canGetLock(m)&&g.preventDefault())}}}}},[e]),i=(0,se.hb)(function(){var g={passive:!1,capture:!0};r.current=f(window,[a,n],g)},[a,n]),o=(0,se.hb)(function(){var v=t.current;v.type!=="IDLE"&&(t.current=zs,r.current(),i())},[i]),s=(0,se.hb)(function(){var v=t.current;o(),v.type==="DRAGGING"&&v.actions.cancel({shouldBlockNextClick:!0}),v.type==="PENDING"&&v.actions.abort()},[o]),c=(0,se.hb)(function(){var g={capture:!0,passive:!1},m=af({cancel:s,completed:o,getPhase:function(){return t.current},setPhase:function(D){t.current=D}});r.current=f(window,m,g)},[s,o]),p=(0,se.hb)(function(g,m){t.current.type!=="IDLE"&&E(!1),t.current={type:"PENDING",point:m,actions:g},c()},[c]);It(function(){return i(),function(){r.current()}},[i])}var pn;function sf(){}var lf=(pn={},pn[Kd]=!0,pn[_d]=!0,pn[Zd]=!0,pn[Yd]=!0,pn);function uf(e,t){function r(){t(),e.cancel()}function n(){t(),e.drop()}return[{eventName:"keydown",fn:function(i){if(i.keyCode===vo){i.preventDefault(),r();return}if(i.keyCode===ks){i.preventDefault(),n();return}if(i.keyCode===tf){i.preventDefault(),e.moveDown();return}if(i.keyCode===qd){i.preventDefault(),e.moveUp();return}if(i.keyCode===ef){i.preventDefault(),e.moveRight();return}if(i.keyCode===Jd){i.preventDefault(),e.moveLeft();return}if(lf[i.keyCode]){i.preventDefault();return}Gs(i)}},{eventName:"mousedown",fn:r},{eventName:"mouseup",fn:r},{eventName:"click",fn:r},{eventName:"touchstart",fn:r},{eventName:"resize",fn:r},{eventName:"wheel",fn:r,options:{passive:!0}},{eventName:vi,fn:r}]}function cf(e){var t=(0,d.useRef)(sf),r=(0,se.Kr)(function(){return{eventName:"keydown",fn:function(i){if(i.defaultPrevented||i.keyCode!==ks)return;var o=e.findClosestDraggableId(i);if(!o)return;var s=e.tryGetLock(o,v,{sourceEvent:i});if(!s)return;i.preventDefault();var c=!0,p=s.snapLift();t.current();function v(){c||E(!1),c=!1,t.current(),n()}t.current=f(window,uf(p,v),{capture:!0,passive:!1})}}},[e]),n=(0,se.hb)(function(){var i={passive:!1,capture:!0};t.current=f(window,[r],i)},[r]);It(function(){return n(),function(){t.current()}},[n])}var mo={type:"IDLE"},df=120,ff=.15;function pf(e){var t=e.cancel,r=e.getPhase;return[{eventName:"orientationchange",fn:t},{eventName:"resize",fn:t},{eventName:"contextmenu",fn:function(a){a.preventDefault()}},{eventName:"keydown",fn:function(a){if(r().type!=="DRAGGING"){t();return}a.keyCode===vo&&a.preventDefault(),t()}},{eventName:vi,fn:t}]}function gf(e){var t=e.cancel,r=e.completed,n=e.getPhase;return[{eventName:"touchmove",options:{capture:!1},fn:function(i){var o=n();if(o.type!=="DRAGGING"){t();return}o.hasMoved=!0;var s=i.touches[0],c=s.clientX,p=s.clientY,v={x:c,y:p};i.preventDefault(),o.actions.move(v)}},{eventName:"touchend",fn:function(i){var o=n();if(o.type!=="DRAGGING"){t();return}i.preventDefault(),o.actions.drop({shouldBlockNextClick:!0}),r()}},{eventName:"touchcancel",fn:function(i){if(n().type!=="DRAGGING"){t();return}i.preventDefault(),t()}},{eventName:"touchforcechange",fn:function(i){var o=n();o.type==="IDLE"&&E(!1);var s=i.touches[0];if(s){var c=s.force>=ff;if(c){var p=o.actions.shouldRespectForcePress();if(o.type==="PENDING"){p&&t();return}if(p){if(o.hasMoved){i.preventDefault();return}t();return}i.preventDefault()}}}},{eventName:vi,fn:t}]}function vf(e){var t=(0,d.useRef)(mo),r=(0,d.useRef)(u),n=(0,se.hb)(function(){return t.current},[]),a=(0,se.hb)(function(O){t.current=O},[]),i=(0,se.Kr)(function(){return{eventName:"touchstart",fn:function(O){if(!O.defaultPrevented){var D=e.findClosestDraggableId(O);if(D){var C=e.tryGetLock(D,s,{sourceEvent:O});if(C){var A=O.touches[0],M=A.clientX,$=A.clientY,j={x:M,y:$};r.current(),g(C,j)}}}}}},[e]),o=(0,se.hb)(function(){var O={capture:!0,passive:!1};r.current=f(window,[i],O)},[i]),s=(0,se.hb)(function(){var m=t.current;m.type!=="IDLE"&&(m.type==="PENDING"&&clearTimeout(m.longPressTimerId),a(mo),r.current(),o())},[o,a]),c=(0,se.hb)(function(){var m=t.current;s(),m.type==="DRAGGING"&&m.actions.cancel({shouldBlockNextClick:!0}),m.type==="PENDING"&&m.actions.abort()},[s]),p=(0,se.hb)(function(){var O={capture:!0,passive:!1},D={cancel:c,completed:s,getPhase:n},C=f(window,gf(D),O),A=f(window,pf(D),O);r.current=function(){C(),A()}},[c,n,s]),v=(0,se.hb)(function(){var O=n();O.type!=="PENDING"&&E(!1);var D=O.actions.fluidLift(O.point);a({type:"DRAGGING",actions:D,hasMoved:!1})},[n,a]),g=(0,se.hb)(function(O,D){n().type!=="IDLE"&&E(!1);var C=setTimeout(v,df);a({type:"PENDING",point:D,actions:O,longPressTimerId:C}),p()},[p,n,a,v]);It(function(){return o(),function(){r.current();var D=n();D.type==="PENDING"&&(clearTimeout(D.longPressTimerId),a(mo))}},[n,o,a]),It(function(){var O=f(window,[{eventName:"touchmove",fn:function(){},options:{capture:!1,passive:!1}}]);return O},[])}function mf(e){}var hf={input:!0,button:!0,textarea:!0,select:!0,option:!0,optgroup:!0,video:!0,audio:!0};function _s(e,t){if(t==null)return!1;var r=!!hf[t.tagName.toLowerCase()];if(r)return!0;var n=t.getAttribute("contenteditable");return n==="true"||n===""?!0:t===e?!1:_s(e,t.parentElement)}function bf(e,t){var r=t.target;return fa(r)?_s(e,r):!1}var yf=function(e){return(0,ot.l)(e.getBoundingClientRect()).center};function Of(e){return e instanceof js(e).Element}var xf=function(){var e="matches";if(typeof document>"u")return e;var t=[e,"msMatchesSelector","webkitMatchesSelector"],r=gr(t,function(n){return n in Element.prototype});return r||e}();function Ks(e,t){return e==null?null:e[xf](t)?e:Ks(e.parentElement,t)}function Ef(e,t){return e.closest?e.closest(t):Ks(e,t)}function Sf(e){return"["+fn.contextId+'="'+e+'"]'}function Pf(e,t){var r=t.target;if(!Of(r))return null;var n=Sf(e),a=Ef(r,n);return!a||!fa(a)?null:a}function Df(e,t){var r=Pf(e,t);return r?r.getAttribute(fn.draggableId):null}function wf(e,t){var r="["+uo.contextId+'="'+e+'"]',n=Xo(document.querySelectorAll(r)),a=gr(n,function(i){return i.getAttribute(uo.id)===t});return!a||!fa(a)?null:a}function Lf(e){e.preventDefault()}function mi(e){var t=e.expected,r=e.phase,n=e.isLockActive,a=e.shouldWarn;return!(!n()||t!==r)}function Ys(e){var t=e.lockAPI,r=e.store,n=e.registry,a=e.draggableId;if(t.isClaimed())return!1;var i=n.draggable.findById(a);return!(!i||!i.options.isEnabled||!Cs(r.getState(),a))}function Cf(e){var t=e.lockAPI,r=e.contextId,n=e.store,a=e.registry,i=e.draggableId,o=e.forceSensorStop,s=e.sourceEvent,c=Ys({lockAPI:t,store:n,registry:a,draggableId:i});if(!c)return null;var p=a.draggable.getById(i),v=wf(r,p.descriptor.id);if(!v||s&&!p.options.canDragInteractiveElements&&bf(v,s))return null;var g=t.claim(o||u),m="PRE_DRAG";function O(){return p.options.shouldRespectForcePress}function D(){return t.isActive(g)}function C(X,re){mi({expected:X,phase:m,isLockActive:D,shouldWarn:!0})&&n.dispatch(re())}var A=C.bind(null,"DRAGGING");function M(X){function re(){t.release(),m="COMPLETED"}m!=="PRE_DRAG"&&(re(),m!=="PRE_DRAG"&&E(!1)),n.dispatch(pc(X.liftActionArgs)),m="DRAGGING";function Z(be,Re){if(Re===void 0&&(Re={shouldBlockNextClick:!1}),X.cleanup(),Re.shouldBlockNextClick){var Ue=f(window,[{eventName:"click",fn:Lf,options:{once:!0,passive:!1,capture:!0}}]);setTimeout(Ue)}re(),n.dispatch(bs({reason:be}))}return(0,Te.A)({isActive:function(){return mi({expected:"DRAGGING",phase:m,isLockActive:D,shouldWarn:!1})},shouldRespectForcePress:O,drop:function(Re){return Z("DROP",Re)},cancel:function(Re){return Z("CANCEL",Re)}},X.actions)}function $(X){var re=(0,ar.A)(function(be){A(function(){return hs({client:be})})}),Z=M({liftActionArgs:{id:i,clientSelection:X,movementMode:"FLUID"},cleanup:function(){return re.cancel()},actions:{move:re}});return(0,Te.A)({},Z,{move:re})}function j(){var X={moveUp:function(){return A(Ec)},moveRight:function(){return A(Pc)},moveDown:function(){return A(Sc)},moveLeft:function(){return A(Dc)}};return M({liftActionArgs:{id:i,clientSelection:yf(v),movementMode:"SNAP"},cleanup:u,actions:X})}function U(){var X=mi({expected:"PRE_DRAG",phase:m,isLockActive:D,shouldWarn:!0});X&&t.release()}var J={isActive:function(){return mi({expected:"PRE_DRAG",phase:m,isLockActive:D,shouldWarn:!1})},shouldRespectForcePress:O,fluidLift:$,snapLift:j,abort:U};return J}var Rf=[of,cf,vf];function Tf(e){var t=e.contextId,r=e.store,n=e.registry,a=e.customSensors,i=e.enableDefaultSensors,o=[].concat(i?Rf:[],a||[]),s=(0,d.useState)(function(){return Xd()})[0],c=(0,se.hb)(function($,j){$.isDragging&&!j.isDragging&&s.tryAbandon()},[s]);It(function(){var $=r.getState(),j=r.subscribe(function(){var U=r.getState();c($,U),$=U});return j},[s,r,c]),It(function(){return s.tryAbandon},[s.tryAbandon]);var p=(0,se.hb)(function(M){return Ys({lockAPI:s,registry:n,store:r,draggableId:M})},[s,n,r]),v=(0,se.hb)(function(M,$,j){return Cf({lockAPI:s,registry:n,contextId:t,store:r,draggableId:M,forceSensorStop:$,sourceEvent:j&&j.sourceEvent?j.sourceEvent:null})},[t,s,n,r]),g=(0,se.hb)(function(M){return Df(t,M)},[t]),m=(0,se.hb)(function(M){var $=n.draggable.findById(M);return $?$.options:null},[n.draggable]),O=(0,se.hb)(function(){s.isClaimed()&&(s.tryAbandon(),r.getState().phase!=="IDLE"&&r.dispatch(Zi()))},[s,r]),D=(0,se.hb)(s.isClaimed,[s]),C=(0,se.Kr)(function(){return{canGetLock:p,tryGetLock:v,findClosestDraggableId:g,findOptionsForDraggable:m,tryReleaseLock:O,isLockClaimed:D}},[p,v,g,m,O,D]);mf(o);for(var A=0;A<o.length;A++)o[A](C)}var If=function(t){return{onBeforeCapture:t.onBeforeCapture,onBeforeDragStart:t.onBeforeDragStart,onDragStart:t.onDragStart,onDragEnd:t.onDragEnd,onDragUpdate:t.onDragUpdate}};function va(e){return e.current||E(!1),e.current}function Af(e){var t=e.contextId,r=e.setCallbacks,n=e.sensors,a=e.nonce,i=e.dragHandleUsageInstructions,o=(0,d.useRef)(null);Gd();var s=go(e),c=(0,se.hb)(function(){return If(s.current)},[s]),p=Fd(t),v=Bd({contextId:t,text:i}),g=Cd(t,a),m=(0,se.hb)(function(be){va(o).dispatch(be)},[]),O=(0,se.Kr)(function(){return(0,fr.bindActionCreators)({publishWhileDragging:vc,updateDroppableScroll:hc,updateDroppableIsEnabled:bc,updateDroppableIsCombineEnabled:yc,collectionStarting:mc},m)},[m]),D=Id(),C=(0,se.Kr)(function(){return od(D,O)},[D,O]),A=(0,se.Kr)(function(){return Sd((0,Te.A)({scrollWindow:sd,scrollDroppable:C.scrollDroppable},(0,fr.bindActionCreators)({move:hs},m)))},[C.scrollDroppable,m]),M=Rd(t),$=(0,se.Kr)(function(){return rd({announce:p,autoScroller:A,dimensionMarshal:C,focusMarshal:M,getResponders:c,styleMarshal:g})},[p,A,C,M,c,g]);o.current=$;var j=(0,se.hb)(function(){var be=va(o),Re=be.getState();Re.phase!=="IDLE"&&be.dispatch(Zi())},[]),U=(0,se.hb)(function(){var be=va(o).getState();return be.isDragging||be.phase==="DROP_ANIMATING"},[]),J=(0,se.Kr)(function(){return{isDragging:U,tryAbort:j}},[U,j]);r(J);var X=(0,se.hb)(function(be){return Cs(va(o).getState(),be)},[]),re=(0,se.hb)(function(){return $r(va(o).getState())},[]),Z=(0,se.Kr)(function(){return{marshal:C,focus:M,contextId:t,canLift:X,isMovementAllowed:re,dragHandleUsageInstructionsId:v,registry:D}},[t,C,v,M,X,re,D]);return Tf({contextId:t,store:$,registry:D,customSensors:n,enableDefaultSensors:e.enableDefaultSensors!==!1}),(0,d.useEffect)(function(){return j},[j]),d.createElement(pi.Provider,{value:Z},d.createElement(Pr,{context:fo,store:$},e.children))}var Zs=0;function $f(){Zs=0}function Ff(){return(0,se.Kr)(function(){return""+Zs++},[])}function eh(){$f(),Md()}function Qf(e){var t=Ff(),r=e.dragHandleUsageInstructions||Ae.dragHandleUsageInstructions;return d.createElement(I,null,function(n){return d.createElement(Af,{nonce:e.nonce,contextId:t,setCallbacks:n,dragHandleUsageInstructions:r,enableDefaultSensors:e.enableDefaultSensors,sensors:e.sensors,onBeforeCapture:e.onBeforeCapture,onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragUpdate:e.onDragUpdate,onDragEnd:e.onDragEnd},e.children)})}var ho=function(t){return function(r){return t===r}},Mf=ho("scroll"),Nf=ho("auto"),Bf=ho("visible"),Js=function(t,r){return r(t.overflowX)||r(t.overflowY)},jf=function(t,r){return r(t.overflowX)&&r(t.overflowY)},qs=function(t){var r=window.getComputedStyle(t),n={overflowX:r.overflowX,overflowY:r.overflowY};return Js(n,Mf)||Js(n,Nf)},Uf=function(){return!1;var t,r,n,a},el=function e(t){return t==null?null:t===document.body?Uf()?t:null:t===document.documentElement?null:qs(t)?t:e(t.parentElement)},th=function(e){if(e)var t=el(e.parentElement)},bo=function(e){return{x:e.scrollLeft,y:e.scrollTop}},Wf=function e(t){if(!t)return!1;var r=window.getComputedStyle(t);return r.position==="fixed"?!0:e(t.parentElement)},Vf=function(e){var t=el(e),r=Wf(e);return{closestScrollable:t,isFixedOnPage:r}},kf=function(e){var t=e.descriptor,r=e.isEnabled,n=e.isCombineEnabled,a=e.isFixedOnPage,i=e.direction,o=e.client,s=e.page,c=e.closest,p=function(){if(!c)return null;var O=c.scrollSize,D=c.client,C=Ps({scrollHeight:O.scrollHeight,scrollWidth:O.scrollWidth,height:D.paddingBox.height,width:D.paddingBox.width});return{pageMarginBox:c.page.marginBox,frameClient:D,scrollSize:O,shouldClipSubject:c.shouldClipSubject,scroll:{initial:c.scroll,current:c.scroll,max:C,diff:{value:We,displacement:We}}}}(),v=i==="vertical"?Vi:Yo,g=Rt({page:s,withPlaceholder:null,axis:v,frame:p}),m={descriptor:t,isCombineEnabled:n,isFixedOnPage:a,axis:v,isEnabled:r,client:o,page:s,frame:p,subject:g};return m},Gf=function(t,r){var n=(0,ot.YH)(t);if(!r||t!==r)return n;var a=n.paddingBox.top-r.scrollTop,i=n.paddingBox.left-r.scrollLeft,o=a+r.scrollHeight,s=i+r.scrollWidth,c={top:a,right:s,bottom:o,left:i},p=(0,ot.fT)(c,n.border),v=(0,ot.ge)({borderBox:p,margin:n.margin,border:n.border,padding:n.padding});return v},Xf=function(e){var t=e.ref,r=e.descriptor,n=e.env,a=e.windowScroll,i=e.direction,o=e.isDropDisabled,s=e.isCombineEnabled,c=e.shouldClipSubject,p=n.closestScrollable,v=Gf(t,p),g=(0,ot.SQ)(v,a),m=function(){if(!p)return null;var D=(0,ot.YH)(p),C={scrollHeight:p.scrollHeight,scrollWidth:p.scrollWidth};return{client:D,page:(0,ot.SQ)(D,a),scroll:bo(p),scrollSize:C,shouldClipSubject:c}}(),O=kf({descriptor:r,isEnabled:!o,isCombineEnabled:s,isFixedOnPage:n.isFixedOnPage,direction:i,client:v,page:g,closest:m});return O},Hf={passive:!1},zf={passive:!0},tl=function(e){return e.shouldPublishImmediately?Hf:zf};function hi(e){var t=(0,d.useContext)(e);return t||E(!1),t}var bi=function(t){return t&&t.env.closestScrollable||null};function _f(e){var t=(0,d.useRef)(null),r=hi(pi),n=po("droppable"),a=r.registry,i=r.marshal,o=go(e),s=(0,se.Kr)(function(){return{id:e.droppableId,type:e.type,mode:e.mode}},[e.droppableId,e.mode,e.type]),c=(0,d.useRef)(s),p=(0,se.Kr)(function(){return st(function(U,J){t.current||E(!1);var X={x:U,y:J};i.updateDroppableScroll(s.id,X)})},[s.id,i]),v=(0,se.hb)(function(){var U=t.current;return!U||!U.env.closestScrollable?We:bo(U.env.closestScrollable)},[]),g=(0,se.hb)(function(){var U=v();p(U.x,U.y)},[v,p]),m=(0,se.Kr)(function(){return(0,ar.A)(g)},[g]),O=(0,se.hb)(function(){var U=t.current,J=bi(U);U&&J||E(!1);var X=U.scrollOptions;if(X.shouldPublishImmediately){g();return}m()},[m,g]),D=(0,se.hb)(function(U,J){t.current&&E(!1);var X=o.current,re=X.getDroppableRef();re||E(!1);var Z=Vf(re),be={ref:re,descriptor:s,env:Z,scrollOptions:J};t.current=be;var Re=Xf({ref:re,descriptor:s,env:Z,windowScroll:U,direction:X.direction,isDropDisabled:X.isDropDisabled,isCombineEnabled:X.isCombineEnabled,shouldClipSubject:!X.ignoreContainerClipping}),Ue=Z.closestScrollable;return Ue&&(Ue.setAttribute(Ns.contextId,r.contextId),Ue.addEventListener("scroll",O,tl(be.scrollOptions))),Re},[r.contextId,s,O,o]),C=(0,se.hb)(function(){var U=t.current,J=bi(U);return U&&J||E(!1),bo(J)},[]),A=(0,se.hb)(function(){var U=t.current;U||E(!1);var J=bi(U);t.current=null,J&&(m.cancel(),J.removeAttribute(Ns.contextId),J.removeEventListener("scroll",O,tl(U.scrollOptions)))},[O,m]),M=(0,se.hb)(function(U){var J=t.current;J||E(!1);var X=bi(J);X||E(!1),X.scrollTop+=U.y,X.scrollLeft+=U.x},[]),$=(0,se.Kr)(function(){return{getDimensionAndWatchScroll:D,getScrollWhileDragging:C,dragStopped:A,scroll:M}},[A,D,C,M]),j=(0,se.Kr)(function(){return{uniqueId:n,descriptor:s,callbacks:$}},[$,s,n]);It(function(){return c.current=j.descriptor,a.droppable.register(j),function(){t.current&&A(),a.droppable.unregister(j)}},[$,s,A,j,i,a.droppable]),It(function(){t.current&&i.updateDroppableIsEnabled(c.current.id,!e.isDropDisabled)},[e.isDropDisabled,i]),It(function(){t.current&&i.updateDroppableIsCombineEnabled(c.current.id,e.isCombineEnabled)},[e.isCombineEnabled,i])}function yo(){}var rl={width:0,height:0,margin:Bi},Kf=function(t){var r=t.isAnimatingOpenOnMount,n=t.placeholder,a=t.animate;return r||a==="close"?rl:{height:n.client.borderBox.height,width:n.client.borderBox.width,margin:n.client.margin}},Yf=function(t){var r=t.isAnimatingOpenOnMount,n=t.placeholder,a=t.animate,i=Kf({isAnimatingOpenOnMount:r,placeholder:n,animate:a});return{display:n.display,boxSizing:"border-box",width:i.width,height:i.height,marginTop:i.margin.top,marginRight:i.margin.right,marginBottom:i.margin.bottom,marginLeft:i.margin.left,flexShrink:"0",flexGrow:"0",pointerEvents:"none",transition:a!=="none"?ua.placeholder:null}};function Zf(e){var t=(0,d.useRef)(null),r=(0,se.hb)(function(){t.current&&(clearTimeout(t.current),t.current=null)},[]),n=e.animate,a=e.onTransitionEnd,i=e.onClose,o=e.contextId,s=(0,d.useState)(e.animate==="open"),c=s[0],p=s[1];(0,d.useEffect)(function(){return c?n!=="open"?(r(),p(!1),yo):t.current?yo:(t.current=setTimeout(function(){t.current=null,p(!1)}),r):yo},[n,c,r]);var v=(0,se.hb)(function(m){m.propertyName==="height"&&(a(),n==="close"&&i())},[n,i,a]),g=Yf({isAnimatingOpenOnMount:c,animate:e.animate,placeholder:e.placeholder});return d.createElement(e.placeholder.tagName,{style:g,"data-rbd-placeholder-context-id":o,onTransitionEnd:v,ref:e.innerRef})}var Jf=d.memo(Zf),Oo=d.createContext(null);function nl(e){e&&fa(e)||E(!1)}function xo(e){return typeof e=="boolean"}function Eo(e,t){t.forEach(function(r){return r(e)})}var qf=[function(t){var r=t.props;r.droppableId||E(!1),typeof r.droppableId!="string"&&E(!1)},function(t){var r=t.props;xo(r.isDropDisabled)||E(!1),xo(r.isCombineEnabled)||E(!1),xo(r.ignoreContainerClipping)||E(!1)},function(t){var r=t.getDroppableRef;nl(r())}],ep=[function(t){var r=t.props,n=t.getPlaceholderRef;if(r.placeholder)var a=n()}],tp=[function(t){var r=t.props;r.renderClone||E(!1)},function(t){var r=t.getPlaceholderRef;r()&&E(!1)}];function rp(e){ga(function(){Eo(e,qf),e.props.mode==="standard"&&Eo(e,ep),e.props.mode==="virtual"&&Eo(e,tp)})}var np=function(e){(0,Xr.A)(t,e);function t(){for(var n,a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return n=e.call.apply(e,[this].concat(i))||this,n.state={isVisible:!!n.props.on,data:n.props.on,animate:n.props.shouldAnimate&&n.props.on?"open":"none"},n.onClose=function(){n.state.animate==="close"&&n.setState({isVisible:!1})},n}t.getDerivedStateFromProps=function(a,i){return a.shouldAnimate?a.on?{isVisible:!0,data:a.on,animate:"open"}:i.isVisible?{isVisible:!0,data:i.data,animate:"close"}:{isVisible:!1,animate:"close",data:null}:{isVisible:!!a.on,data:a.on,animate:"none"}};var r=t.prototype;return r.render=function(){if(!this.state.isVisible)return null;var a={onClose:this.onClose,data:this.state.data,animate:this.state.animate};return this.props.children(a)},t}(d.PureComponent),al={dragging:5e3,dropAnimating:4500},ap=function(t,r){return r?ua.drop(r.duration):t?ua.snap:ua.fluid},ip=function(t,r){return t?r?la.opacity.drop:la.opacity.combining:null},op=function(t){return t.forceShouldAnimate!=null?t.forceShouldAnimate:t.mode==="SNAP"};function sp(e){var t=e.dimension,r=t.client,n=e.offset,a=e.combineWith,i=e.dropping,o=!!a,s=op(e),c=!!i,p=c?to.drop(n,o):to.moveTo(n),v={position:"fixed",top:r.marginBox.top,left:r.marginBox.left,boxSizing:"border-box",width:r.borderBox.width,height:r.borderBox.height,transition:ap(s,i),transform:p,opacity:ip(o,c),zIndex:c?al.dropAnimating:al.dragging,pointerEvents:"none"};return v}function lp(e){return{transform:to.moveTo(e.offset),transition:e.shouldAnimateDisplacement?null:"none"}}function up(e){return e.type==="DRAGGING"?sp(e):lp(e)}function cp(e,t,r){r===void 0&&(r=We);var n=window.getComputedStyle(t),a=t.getBoundingClientRect(),i=(0,ot.a)(a,n),o=(0,ot.SQ)(i,r),s={client:i,tagName:t.tagName.toLowerCase(),display:n.display},c={x:i.marginBox.width,y:i.marginBox.height},p={descriptor:e,placeholder:s,displaceBy:c,client:i,page:o};return p}function dp(e){var t=po("draggable"),r=e.descriptor,n=e.registry,a=e.getDraggableRef,i=e.canDragInteractiveElements,o=e.shouldRespectForcePress,s=e.isEnabled,c=(0,se.Kr)(function(){return{canDragInteractiveElements:i,shouldRespectForcePress:o,isEnabled:s}},[i,s,o]),p=(0,se.hb)(function(O){var D=a();return D||E(!1),cp(r,D,O)},[r,a]),v=(0,se.Kr)(function(){return{uniqueId:t,descriptor:r,options:c,getDimension:p}},[r,p,c,t]),g=(0,d.useRef)(v),m=(0,d.useRef)(!0);It(function(){return n.draggable.register(g.current),function(){return n.draggable.unregister(g.current)}},[n.draggable]),It(function(){if(m.current){m.current=!1;return}var O=g.current;g.current=v,n.draggable.update(v,O)},[v,n.draggable])}function fp(e,t,r){ga(function(){function n(i){return"Draggable[id: "+i+"]: "}var a=e.draggableId;a||E(!1),typeof a!="string"&&E(!1),fu(e.index)||E(!1),e.mapped.type!=="DRAGGING"&&(nl(r()),e.isEnabled&&(Us(t,a)||E(!1)))})}function pp(e){}function gp(e){e.preventDefault()}function vp(e){var t=(0,d.useRef)(null),r=(0,se.hb)(function(be){t.current=be},[]),n=(0,se.hb)(function(){return t.current},[]),a=hi(pi),i=a.contextId,o=a.dragHandleUsageInstructionsId,s=a.registry,c=hi(Oo),p=c.type,v=c.droppableId,g=(0,se.Kr)(function(){return{id:e.draggableId,index:e.index,type:p,droppableId:v}},[e.draggableId,e.index,p,v]),m=e.children,O=e.draggableId,D=e.isEnabled,C=e.shouldRespectForcePress,A=e.canDragInteractiveElements,M=e.isClone,$=e.mapped,j=e.dropAnimationFinished;if(fp(e,i,n),pp(M),!M){var U=(0,se.Kr)(function(){return{descriptor:g,registry:s,getDraggableRef:n,canDragInteractiveElements:A,shouldRespectForcePress:C,isEnabled:D}},[g,s,n,A,C,D]);dp(U)}var J=(0,se.Kr)(function(){return D?{tabIndex:0,role:"button","aria-describedby":o,"data-rbd-drag-handle-draggable-id":O,"data-rbd-drag-handle-context-id":i,draggable:!1,onDragStart:gp}:null},[i,o,O,D]),X=(0,se.hb)(function(be){$.type==="DRAGGING"&&$.dropping&&be.propertyName==="transform"&&j()},[j,$]),re=(0,se.Kr)(function(){var be=up($),Re=$.type==="DRAGGING"&&$.dropping?X:null,Ue={innerRef:r,draggableProps:{"data-rbd-draggable-context-id":i,"data-rbd-draggable-id":O,style:be,onTransitionEnd:Re},dragHandleProps:J};return Ue},[i,J,O,$,X,r]),Z=(0,se.Kr)(function(){return{draggableId:g.id,type:g.type,source:{index:g.index,droppableId:g.droppableId}}},[g.droppableId,g.id,g.index,g.type]);return m(re,$.snapshot,Z)}var il=function(e,t){return e===t},ol=function(e){var t=e.combine,r=e.destination;return r?r.droppableId:t?t.droppableId:null},mp=function(t){return t.combine?t.combine.draggableId:null},hp=function(t){return t.at&&t.at.type==="COMBINE"?t.at.combine.draggableId:null};function bp(){var e=st(function(a,i){return{x:a,y:i}}),t=st(function(a,i,o,s,c){return{isDragging:!0,isClone:i,isDropAnimating:!!c,dropAnimation:c,mode:a,draggingOver:o,combineWith:s,combineTargetFor:null}}),r=st(function(a,i,o,s,c,p,v){return{mapped:{type:"DRAGGING",dropping:null,draggingOver:c,combineWith:p,mode:i,offset:a,dimension:o,forceShouldAnimate:v,snapshot:t(i,s,c,p,null)}}}),n=function(i,o){if(i.isDragging){if(i.critical.draggable.id!==o.draggableId)return null;var s=i.current.client.offset,c=i.dimensions.draggables[o.draggableId],p=Tt(i.impact),v=hp(i.impact),g=i.forceShouldAnimate;return r(e(s.x,s.y),i.movementMode,c,o.isClone,p,v,g)}if(i.phase==="DROP_ANIMATING"){var m=i.completed;if(m.result.draggableId!==o.draggableId)return null;var O=o.isClone,D=i.dimensions.draggables[o.draggableId],C=m.result,A=C.mode,M=ol(C),$=mp(C),j=i.dropDuration,U={duration:j,curve:qi.drop,moveTo:i.newHomeClientOffset,opacity:$?la.opacity.drop:null,scale:$?la.scale.drop:null};return{mapped:{type:"DRAGGING",offset:i.newHomeClientOffset,dimension:D,dropping:U,draggingOver:M,combineWith:$,mode:A,forceShouldAnimate:null,snapshot:t(A,O,M,$,U)}}}return null};return n}function sl(e){return{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,mode:null,draggingOver:null,combineTargetFor:e,combineWith:null}}var yp={mapped:{type:"SECONDARY",offset:We,combineTargetFor:null,shouldAnimateDisplacement:!0,snapshot:sl(null)}};function Op(){var e=st(function(o,s){return{x:o,y:s}}),t=st(sl),r=st(function(o,s,c){return s===void 0&&(s=null),{mapped:{type:"SECONDARY",offset:o,combineTargetFor:s,shouldAnimateDisplacement:c,snapshot:t(s)}}}),n=function(s){return s?r(We,s,!0):null},a=function(s,c,p,v){var g=p.displaced.visible[s],m=!!(v.inVirtualList&&v.effected[s]),O=li(p),D=O&&O.draggableId===s?c:null;if(!g){if(!m)return n(D);if(p.displaced.invisible[s])return null;var C=mt(v.displacedBy.point),A=e(C.x,C.y);return r(A,D,!0)}if(m)return n(D);var M=p.displacedBy.point,$=e(M.x,M.y);return r($,D,g.shouldAnimate)},i=function(s,c){if(s.isDragging)return s.critical.draggable.id===c.draggableId?null:a(c.draggableId,s.critical.draggable.id,s.impact,s.afterCritical);if(s.phase==="DROP_ANIMATING"){var p=s.completed;return p.result.draggableId===c.draggableId?null:a(c.draggableId,p.result.draggableId,p.impact,p.afterCritical)}return null};return i}var xp=function(){var t=bp(),r=Op(),n=function(i,o){return t(i,o)||r(i,o)||yp};return n},Ep={dropAnimationFinished:ys},Sp=an(xp,Ep,null,{context:fo,pure:!0,areStatePropsEqual:il})(vp);function ll(e){var t=hi(Oo),r=t.isUsingCloneFor;return r===e.draggableId&&!e.isClone?null:d.createElement(Sp,e)}function Pp(e){var t=typeof e.isDragDisabled=="boolean"?!e.isDragDisabled:!0,r=!!e.disableInteractiveElementBlocking,n=!!e.shouldRespectForcePress;return d.createElement(ll,(0,Te.A)({},e,{isClone:!1,isEnabled:t,canDragInteractiveElements:r,shouldRespectForcePress:n}))}function Dp(e){var t=(0,d.useContext)(pi);t||E(!1);var r=t.contextId,n=t.isMovementAllowed,a=(0,d.useRef)(null),i=(0,d.useRef)(null),o=e.children,s=e.droppableId,c=e.type,p=e.mode,v=e.direction,g=e.ignoreContainerClipping,m=e.isDropDisabled,O=e.isCombineEnabled,D=e.snapshot,C=e.useClone,A=e.updateViewportMaxScroll,M=e.getContainerForClone,$=(0,se.hb)(function(){return a.current},[]),j=(0,se.hb)(function(Je){a.current=Je},[]),U=(0,se.hb)(function(){return i.current},[]),J=(0,se.hb)(function(Je){i.current=Je},[]);rp({props:e,getDroppableRef:$,getPlaceholderRef:U});var X=(0,se.hb)(function(){n()&&A({maxScroll:ws()})},[n,A]);_f({droppableId:s,type:c,mode:p,direction:v,isDropDisabled:m,isCombineEnabled:O,ignoreContainerClipping:g,getDroppableRef:$});var re=d.createElement(np,{on:e.placeholder,shouldAnimate:e.shouldAnimatePlaceholder},function(Je){var tt=Je.onClose,it=Je.data,Xe=Je.animate;return d.createElement(Jf,{placeholder:it,onClose:tt,innerRef:J,animate:Xe,contextId:r,onTransitionEnd:X})}),Z=(0,se.Kr)(function(){return{innerRef:j,placeholder:re,droppableProps:{"data-rbd-droppable-id":s,"data-rbd-droppable-context-id":r}}},[r,s,re,j]),be=C?C.dragging.draggableId:null,Re=(0,se.Kr)(function(){return{droppableId:s,type:c,isUsingCloneFor:be}},[s,be,c]);function Ue(){if(!C)return null;var Je=C.dragging,tt=C.render,it=d.createElement(ll,{draggableId:Je.draggableId,index:Je.source.index,isClone:!0,isEnabled:!0,shouldRespectForcePress:!1,canDragInteractiveElements:!0},function(Xe,$e){return tt(Xe,$e,Je)});return on.createPortal(it,M())}return d.createElement(Oo.Provider,{value:Re},o(Z,D),Ue())}var So=function(t,r){return t===r.droppable.type},ul=function(t,r){return r.draggables[t.draggable.id]},wp=function(){var t={placeholder:null,shouldAnimatePlaceholder:!0,snapshot:{isDraggingOver:!1,draggingOverWith:null,draggingFromThisWith:null,isUsingPlaceholder:!1},useClone:null},r=(0,Te.A)({},t,{shouldAnimatePlaceholder:!1}),n=st(function(o){return{draggableId:o.id,type:o.type,source:{index:o.index,droppableId:o.droppableId}}}),a=st(function(o,s,c,p,v,g){var m=v.descriptor.id,O=v.descriptor.droppableId===o;if(O){var D=g?{render:g,dragging:n(v.descriptor)}:null,C={isDraggingOver:c,draggingOverWith:c?m:null,draggingFromThisWith:m,isUsingPlaceholder:!0};return{placeholder:v.placeholder,shouldAnimatePlaceholder:!1,snapshot:C,useClone:D}}if(!s)return r;if(!p)return t;var A={isDraggingOver:c,draggingOverWith:m,draggingFromThisWith:null,isUsingPlaceholder:!0};return{placeholder:v.placeholder,shouldAnimatePlaceholder:!0,snapshot:A,useClone:null}}),i=function(s,c){var p=c.droppableId,v=c.type,g=!c.isDropDisabled,m=c.renderClone;if(s.isDragging){var O=s.critical;if(!So(v,O))return r;var D=ul(O,s.dimensions),C=Tt(s.impact)===p;return a(p,g,C,C,D,m)}if(s.phase==="DROP_ANIMATING"){var A=s.completed;if(!So(v,A.critical))return r;var M=ul(A.critical,s.dimensions);return a(p,g,ol(A.result)===p,Tt(A.impact)===p,M,m)}if(s.phase==="IDLE"&&s.completed&&!s.shouldFlush){var $=s.completed;if(!So(v,$.critical))return r;var j=Tt($.impact)===p,U=!!($.impact.at&&$.impact.at.type==="COMBINE"),J=$.critical.droppable.id===p;return j?U?t:r:J?t:r}return r};return i},Lp={updateViewportMaxScroll:xc};function Cp(){return document.body||E(!1),document.body}var Rp={mode:"standard",type:"DEFAULT",direction:"vertical",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,renderClone:null,getContainerForClone:Cp},cl=an(wp,Lp,null,{context:fo,pure:!0,areStatePropsEqual:il})(Dp);cl.defaultProps=Rp;var Tp=h(1604),Ip=h(3988),yi=h(56034),Po=h(14578);function At(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Qr(e){var t=At(e).Element;return e instanceof t||e instanceof Element}function Bt(e){var t=At(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function Do(e){if(typeof ShadowRoot>"u")return!1;var t=At(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}var Mr=Math.max,Oi=Math.min,gn=Math.round;function wo(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function dl(){return!/^((?!chrome|android).)*safari/i.test(wo())}function vn(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!1);var n=e.getBoundingClientRect(),a=1,i=1;t&&Bt(e)&&(a=e.offsetWidth>0&&gn(n.width)/e.offsetWidth||1,i=e.offsetHeight>0&&gn(n.height)/e.offsetHeight||1);var o=Qr(e)?At(e):window,s=o.visualViewport,c=!dl()&&r,p=(n.left+(c&&s?s.offsetLeft:0))/a,v=(n.top+(c&&s?s.offsetTop:0))/i,g=n.width/a,m=n.height/i;return{width:g,height:m,top:v,right:p+g,bottom:v+m,left:p,x:p,y:v}}function Lo(e){var t=At(e),r=t.pageXOffset,n=t.pageYOffset;return{scrollLeft:r,scrollTop:n}}function Ap(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function $p(e){return e===At(e)||!Bt(e)?Lo(e):Ap(e)}function Zt(e){return e?(e.nodeName||"").toLowerCase():null}function hr(e){return((Qr(e)?e.ownerDocument:e.document)||window.document).documentElement}function Co(e){return vn(hr(e)).left+Lo(e).scrollLeft}function or(e){return At(e).getComputedStyle(e)}function Ro(e){var t=or(e),r=t.overflow,n=t.overflowX,a=t.overflowY;return/auto|scroll|overlay|hidden/.test(r+a+n)}function Fp(e){var t=e.getBoundingClientRect(),r=gn(t.width)/e.offsetWidth||1,n=gn(t.height)/e.offsetHeight||1;return r!==1||n!==1}function Qp(e,t,r){r===void 0&&(r=!1);var n=Bt(t),a=Bt(t)&&Fp(t),i=hr(t),o=vn(e,a,r),s={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(n||!n&&!r)&&((Zt(t)!=="body"||Ro(i))&&(s=$p(t)),Bt(t)?(c=vn(t,!0),c.x+=t.clientLeft,c.y+=t.clientTop):i&&(c.x=Co(i))),{x:o.left+s.scrollLeft-c.x,y:o.top+s.scrollTop-c.y,width:o.width,height:o.height}}function To(e){var t=vn(e),r=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-r)<=1&&(r=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:r,height:n}}function xi(e){return Zt(e)==="html"?e:e.assignedSlot||e.parentNode||(Do(e)?e.host:null)||hr(e)}function fl(e){return["html","body","#document"].indexOf(Zt(e))>=0?e.ownerDocument.body:Bt(e)&&Ro(e)?e:fl(xi(e))}function ma(e,t){var r;t===void 0&&(t=[]);var n=fl(e),a=n===((r=e.ownerDocument)==null?void 0:r.body),i=At(n),o=a?[i].concat(i.visualViewport||[],Ro(n)?n:[]):n,s=t.concat(o);return a?s:s.concat(ma(xi(o)))}function Mp(e){return["table","td","th"].indexOf(Zt(e))>=0}function pl(e){return!Bt(e)||or(e).position==="fixed"?null:e.offsetParent}function Np(e){var t=/firefox/i.test(wo()),r=/Trident/i.test(wo());if(r&&Bt(e)){var n=or(e);if(n.position==="fixed")return null}var a=xi(e);for(Do(a)&&(a=a.host);Bt(a)&&["html","body"].indexOf(Zt(a))<0;){var i=or(a);if(i.transform!=="none"||i.perspective!=="none"||i.contain==="paint"||["transform","perspective"].indexOf(i.willChange)!==-1||t&&i.willChange==="filter"||t&&i.filter&&i.filter!=="none")return a;a=a.parentNode}return null}function ha(e){for(var t=At(e),r=pl(e);r&&Mp(r)&&or(r).position==="static";)r=pl(r);return r&&(Zt(r)==="html"||Zt(r)==="body"&&or(r).position==="static")?t:r||Np(e)||t}var Dt="top",jt="bottom",Ut="right",wt="left",Io="auto",ba=[Dt,jt,Ut,wt],mn="start",ya="end",Bp="clippingParents",gl="viewport",Oa="popper",jp="reference",vl=ba.reduce(function(e,t){return e.concat([t+"-"+mn,t+"-"+ya])},[]),ml=[].concat(ba,[Io]).reduce(function(e,t){return e.concat([t,t+"-"+mn,t+"-"+ya])},[]),Up="beforeRead",Wp="read",Vp="afterRead",kp="beforeMain",Gp="main",Xp="afterMain",Hp="beforeWrite",zp="write",_p="afterWrite",Kp=[Up,Wp,Vp,kp,Gp,Xp,Hp,zp,_p];function Yp(e){var t=new Map,r=new Set,n=[];e.forEach(function(i){t.set(i.name,i)});function a(i){r.add(i.name);var o=[].concat(i.requires||[],i.requiresIfExists||[]);o.forEach(function(s){if(!r.has(s)){var c=t.get(s);c&&a(c)}}),n.push(i)}return e.forEach(function(i){r.has(i.name)||a(i)}),n}function Zp(e){var t=Yp(e);return Kp.reduce(function(r,n){return r.concat(t.filter(function(a){return a.phase===n}))},[])}function Jp(e){var t;return function(){return t||(t=new Promise(function(r){Promise.resolve().then(function(){t=void 0,r(e())})})),t}}function qp(e){var t=e.reduce(function(r,n){var a=r[n.name];return r[n.name]=a?Object.assign({},a,n,{options:Object.assign({},a.options,n.options),data:Object.assign({},a.data,n.data)}):n,r},{});return Object.keys(t).map(function(r){return t[r]})}var hl={placement:"bottom",modifiers:[],strategy:"absolute"};function bl(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!t.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function eg(e){e===void 0&&(e={});var t=e,r=t.defaultModifiers,n=r===void 0?[]:r,a=t.defaultOptions,i=a===void 0?hl:a;return function(s,c,p){p===void 0&&(p=i);var v={placement:"bottom",orderedModifiers:[],options:Object.assign({},hl,i),modifiersData:{},elements:{reference:s,popper:c},attributes:{},styles:{}},g=[],m=!1,O={state:v,setOptions:function(M){var $=typeof M=="function"?M(v.options):M;C(),v.options=Object.assign({},i,v.options,$),v.scrollParents={reference:Qr(s)?ma(s):s.contextElement?ma(s.contextElement):[],popper:ma(c)};var j=Zp(qp([].concat(n,v.options.modifiers)));return v.orderedModifiers=j.filter(function(U){return U.enabled}),D(),O.update()},forceUpdate:function(){if(!m){var M=v.elements,$=M.reference,j=M.popper;if(bl($,j)){v.rects={reference:Qp($,ha(j),v.options.strategy==="fixed"),popper:To(j)},v.reset=!1,v.placement=v.options.placement,v.orderedModifiers.forEach(function(Re){return v.modifiersData[Re.name]=Object.assign({},Re.data)});for(var U=0;U<v.orderedModifiers.length;U++){if(v.reset===!0){v.reset=!1,U=-1;continue}var J=v.orderedModifiers[U],X=J.fn,re=J.options,Z=re===void 0?{}:re,be=J.name;typeof X=="function"&&(v=X({state:v,options:Z,name:be,instance:O})||v)}}}},update:Jp(function(){return new Promise(function(A){O.forceUpdate(),A(v)})}),destroy:function(){C(),m=!0}};if(!bl(s,c))return O;O.setOptions(p).then(function(A){!m&&p.onFirstUpdate&&p.onFirstUpdate(A)});function D(){v.orderedModifiers.forEach(function(A){var M=A.name,$=A.options,j=$===void 0?{}:$,U=A.effect;if(typeof U=="function"){var J=U({state:v,name:M,instance:O,options:j}),X=function(){};g.push(J||X)}})}function C(){g.forEach(function(A){return A()}),g=[]}return O}}var rh=null,Ei={passive:!0};function tg(e){var t=e.state,r=e.instance,n=e.options,a=n.scroll,i=a===void 0?!0:a,o=n.resize,s=o===void 0?!0:o,c=At(t.elements.popper),p=[].concat(t.scrollParents.reference,t.scrollParents.popper);return i&&p.forEach(function(v){v.addEventListener("scroll",r.update,Ei)}),s&&c.addEventListener("resize",r.update,Ei),function(){i&&p.forEach(function(v){v.removeEventListener("scroll",r.update,Ei)}),s&&c.removeEventListener("resize",r.update,Ei)}}const rg={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:tg,data:{}};function Jt(e){return e.split("-")[0]}function hn(e){return e.split("-")[1]}function Ao(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function yl(e){var t=e.reference,r=e.element,n=e.placement,a=n?Jt(n):null,i=n?hn(n):null,o=t.x+t.width/2-r.width/2,s=t.y+t.height/2-r.height/2,c;switch(a){case Dt:c={x:o,y:t.y-r.height};break;case jt:c={x:o,y:t.y+t.height};break;case Ut:c={x:t.x+t.width,y:s};break;case wt:c={x:t.x-r.width,y:s};break;default:c={x:t.x,y:t.y}}var p=a?Ao(a):null;if(p!=null){var v=p==="y"?"height":"width";switch(i){case mn:c[p]=c[p]-(t[v]/2-r[v]/2);break;case ya:c[p]=c[p]+(t[v]/2-r[v]/2);break;default:}}return c}function ng(e){var t=e.state,r=e.name;t.modifiersData[r]=yl({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})}const ag={name:"popperOffsets",enabled:!0,phase:"read",fn:ng,data:{}};var ig={top:"auto",right:"auto",bottom:"auto",left:"auto"};function og(e,t){var r=e.x,n=e.y,a=t.devicePixelRatio||1;return{x:gn(r*a)/a||0,y:gn(n*a)/a||0}}function Ol(e){var t,r=e.popper,n=e.popperRect,a=e.placement,i=e.variation,o=e.offsets,s=e.position,c=e.gpuAcceleration,p=e.adaptive,v=e.roundOffsets,g=e.isFixed,m=o.x,O=m===void 0?0:m,D=o.y,C=D===void 0?0:D,A=typeof v=="function"?v({x:O,y:C}):{x:O,y:C};O=A.x,C=A.y;var M=o.hasOwnProperty("x"),$=o.hasOwnProperty("y"),j=wt,U=Dt,J=window;if(p){var X=ha(r),re="clientHeight",Z="clientWidth";if(X===At(r)&&(X=hr(r),or(X).position!=="static"&&s==="absolute"&&(re="scrollHeight",Z="scrollWidth")),X=X,a===Dt||(a===wt||a===Ut)&&i===ya){U=jt;var be=g&&X===J&&J.visualViewport?J.visualViewport.height:X[re];C-=be-n.height,C*=c?1:-1}if(a===wt||(a===Dt||a===jt)&&i===ya){j=Ut;var Re=g&&X===J&&J.visualViewport?J.visualViewport.width:X[Z];O-=Re-n.width,O*=c?1:-1}}var Ue=Object.assign({position:s},p&&ig),Je=v===!0?og({x:O,y:C},At(r)):{x:O,y:C};if(O=Je.x,C=Je.y,c){var tt;return Object.assign({},Ue,(tt={},tt[U]=$?"0":"",tt[j]=M?"0":"",tt.transform=(J.devicePixelRatio||1)<=1?"translate("+O+"px, "+C+"px)":"translate3d("+O+"px, "+C+"px, 0)",tt))}return Object.assign({},Ue,(t={},t[U]=$?C+"px":"",t[j]=M?O+"px":"",t.transform="",t))}function sg(e){var t=e.state,r=e.options,n=r.gpuAcceleration,a=n===void 0?!0:n,i=r.adaptive,o=i===void 0?!0:i,s=r.roundOffsets,c=s===void 0?!0:s,p={placement:Jt(t.placement),variation:hn(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:a,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,Ol(Object.assign({},p,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:o,roundOffsets:c})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,Ol(Object.assign({},p,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const lg={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:sg,data:{}};function ug(e){var t=e.state;Object.keys(t.elements).forEach(function(r){var n=t.styles[r]||{},a=t.attributes[r]||{},i=t.elements[r];!Bt(i)||!Zt(i)||(Object.assign(i.style,n),Object.keys(a).forEach(function(o){var s=a[o];s===!1?i.removeAttribute(o):i.setAttribute(o,s===!0?"":s)}))})}function cg(e){var t=e.state,r={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,r.popper),t.styles=r,t.elements.arrow&&Object.assign(t.elements.arrow.style,r.arrow),function(){Object.keys(t.elements).forEach(function(n){var a=t.elements[n],i=t.attributes[n]||{},o=Object.keys(t.styles.hasOwnProperty(n)?t.styles[n]:r[n]),s=o.reduce(function(c,p){return c[p]="",c},{});!Bt(a)||!Zt(a)||(Object.assign(a.style,s),Object.keys(i).forEach(function(c){a.removeAttribute(c)}))})}}const dg={name:"applyStyles",enabled:!0,phase:"write",fn:ug,effect:cg,requires:["computeStyles"]};function fg(e,t,r){var n=Jt(e),a=[wt,Dt].indexOf(n)>=0?-1:1,i=typeof r=="function"?r(Object.assign({},t,{placement:e})):r,o=i[0],s=i[1];return o=o||0,s=(s||0)*a,[wt,Ut].indexOf(n)>=0?{x:s,y:o}:{x:o,y:s}}function pg(e){var t=e.state,r=e.options,n=e.name,a=r.offset,i=a===void 0?[0,0]:a,o=ml.reduce(function(v,g){return v[g]=fg(g,t.rects,i),v},{}),s=o[t.placement],c=s.x,p=s.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=c,t.modifiersData.popperOffsets.y+=p),t.modifiersData[n]=o}const gg={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:pg};var vg={left:"right",right:"left",bottom:"top",top:"bottom"};function Si(e){return e.replace(/left|right|bottom|top/g,function(t){return vg[t]})}var mg={start:"end",end:"start"};function xl(e){return e.replace(/start|end/g,function(t){return mg[t]})}function hg(e,t){var r=At(e),n=hr(e),a=r.visualViewport,i=n.clientWidth,o=n.clientHeight,s=0,c=0;if(a){i=a.width,o=a.height;var p=dl();(p||!p&&t==="fixed")&&(s=a.offsetLeft,c=a.offsetTop)}return{width:i,height:o,x:s+Co(e),y:c}}function bg(e){var t,r=hr(e),n=Lo(e),a=(t=e.ownerDocument)==null?void 0:t.body,i=Mr(r.scrollWidth,r.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),o=Mr(r.scrollHeight,r.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0),s=-n.scrollLeft+Co(e),c=-n.scrollTop;return or(a||r).direction==="rtl"&&(s+=Mr(r.clientWidth,a?a.clientWidth:0)-i),{width:i,height:o,x:s,y:c}}function El(e,t){var r=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(r&&Do(r)){var n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function $o(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function yg(e,t){var r=vn(e,!1,t==="fixed");return r.top=r.top+e.clientTop,r.left=r.left+e.clientLeft,r.bottom=r.top+e.clientHeight,r.right=r.left+e.clientWidth,r.width=e.clientWidth,r.height=e.clientHeight,r.x=r.left,r.y=r.top,r}function Sl(e,t,r){return t===gl?$o(hg(e,r)):Qr(t)?yg(t,r):$o(bg(hr(e)))}function Og(e){var t=ma(xi(e)),r=["absolute","fixed"].indexOf(or(e).position)>=0,n=r&&Bt(e)?ha(e):e;return Qr(n)?t.filter(function(a){return Qr(a)&&El(a,n)&&Zt(a)!=="body"}):[]}function xg(e,t,r,n){var a=t==="clippingParents"?Og(e):[].concat(t),i=[].concat(a,[r]),o=i[0],s=i.reduce(function(c,p){var v=Sl(e,p,n);return c.top=Mr(v.top,c.top),c.right=Oi(v.right,c.right),c.bottom=Oi(v.bottom,c.bottom),c.left=Mr(v.left,c.left),c},Sl(e,o,n));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function Pl(){return{top:0,right:0,bottom:0,left:0}}function Dl(e){return Object.assign({},Pl(),e)}function wl(e,t){return t.reduce(function(r,n){return r[n]=e,r},{})}function xa(e,t){t===void 0&&(t={});var r=t,n=r.placement,a=n===void 0?e.placement:n,i=r.strategy,o=i===void 0?e.strategy:i,s=r.boundary,c=s===void 0?Bp:s,p=r.rootBoundary,v=p===void 0?gl:p,g=r.elementContext,m=g===void 0?Oa:g,O=r.altBoundary,D=O===void 0?!1:O,C=r.padding,A=C===void 0?0:C,M=Dl(typeof A!="number"?A:wl(A,ba)),$=m===Oa?jp:Oa,j=e.rects.popper,U=e.elements[D?$:m],J=xg(Qr(U)?U:U.contextElement||hr(e.elements.popper),c,v,o),X=vn(e.elements.reference),re=yl({reference:X,element:j,strategy:"absolute",placement:a}),Z=$o(Object.assign({},j,re)),be=m===Oa?Z:X,Re={top:J.top-be.top+M.top,bottom:be.bottom-J.bottom+M.bottom,left:J.left-be.left+M.left,right:be.right-J.right+M.right},Ue=e.modifiersData.offset;if(m===Oa&&Ue){var Je=Ue[a];Object.keys(Re).forEach(function(tt){var it=[Ut,jt].indexOf(tt)>=0?1:-1,Xe=[Dt,jt].indexOf(tt)>=0?"y":"x";Re[tt]+=Je[Xe]*it})}return Re}function Eg(e,t){t===void 0&&(t={});var r=t,n=r.placement,a=r.boundary,i=r.rootBoundary,o=r.padding,s=r.flipVariations,c=r.allowedAutoPlacements,p=c===void 0?ml:c,v=hn(n),g=v?s?vl:vl.filter(function(D){return hn(D)===v}):ba,m=g.filter(function(D){return p.indexOf(D)>=0});m.length===0&&(m=g);var O=m.reduce(function(D,C){return D[C]=xa(e,{placement:C,boundary:a,rootBoundary:i,padding:o})[Jt(C)],D},{});return Object.keys(O).sort(function(D,C){return O[D]-O[C]})}function Sg(e){if(Jt(e)===Io)return[];var t=Si(e);return[xl(e),t,xl(t)]}function Pg(e){var t=e.state,r=e.options,n=e.name;if(!t.modifiersData[n]._skip){for(var a=r.mainAxis,i=a===void 0?!0:a,o=r.altAxis,s=o===void 0?!0:o,c=r.fallbackPlacements,p=r.padding,v=r.boundary,g=r.rootBoundary,m=r.altBoundary,O=r.flipVariations,D=O===void 0?!0:O,C=r.allowedAutoPlacements,A=t.options.placement,M=Jt(A),$=M===A,j=c||($||!D?[Si(A)]:Sg(A)),U=[A].concat(j).reduce(function(Ct,Ft){return Ct.concat(Jt(Ft)===Io?Eg(t,{placement:Ft,boundary:v,rootBoundary:g,padding:p,flipVariations:D,allowedAutoPlacements:C}):Ft)},[]),J=t.rects.reference,X=t.rects.popper,re=new Map,Z=!0,be=U[0],Re=0;Re<U.length;Re++){var Ue=U[Re],Je=Jt(Ue),tt=hn(Ue)===mn,it=[Dt,jt].indexOf(Je)>=0,Xe=it?"width":"height",$e=xa(t,{placement:Ue,boundary:v,rootBoundary:g,altBoundary:m,padding:p}),Ge=it?tt?Ut:wt:tt?jt:Dt;J[Xe]>X[Xe]&&(Ge=Si(Ge));var dt=Si(Ge),ct=[];if(i&&ct.push($e[Je]<=0),s&&ct.push($e[Ge]<=0,$e[dt]<=0),ct.every(function(Ct){return Ct})){be=Ue,Z=!1;break}re.set(Ue,ct)}if(Z)for(var $t=D?3:1,Lt=function(Ft){var Ot=U.find(function(qt){var Wt=re.get(qt);if(Wt)return Wt.slice(0,Ft).every(function(er){return er})});if(Ot)return be=Ot,"break"},gt=$t;gt>0;gt--){var St=Lt(gt);if(St==="break")break}t.placement!==be&&(t.modifiersData[n]._skip=!0,t.placement=be,t.reset=!0)}}const Dg={name:"flip",enabled:!0,phase:"main",fn:Pg,requiresIfExists:["offset"],data:{_skip:!1}};function wg(e){return e==="x"?"y":"x"}function Ea(e,t,r){return Mr(e,Oi(t,r))}function Lg(e,t,r){var n=Ea(e,t,r);return n>r?r:n}function Cg(e){var t=e.state,r=e.options,n=e.name,a=r.mainAxis,i=a===void 0?!0:a,o=r.altAxis,s=o===void 0?!1:o,c=r.boundary,p=r.rootBoundary,v=r.altBoundary,g=r.padding,m=r.tether,O=m===void 0?!0:m,D=r.tetherOffset,C=D===void 0?0:D,A=xa(t,{boundary:c,rootBoundary:p,padding:g,altBoundary:v}),M=Jt(t.placement),$=hn(t.placement),j=!$,U=Ao(M),J=wg(U),X=t.modifiersData.popperOffsets,re=t.rects.reference,Z=t.rects.popper,be=typeof C=="function"?C(Object.assign({},t.rects,{placement:t.placement})):C,Re=typeof be=="number"?{mainAxis:be,altAxis:be}:Object.assign({mainAxis:0,altAxis:0},be),Ue=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,Je={x:0,y:0};if(X){if(i){var tt,it=U==="y"?Dt:wt,Xe=U==="y"?jt:Ut,$e=U==="y"?"height":"width",Ge=X[U],dt=Ge+A[it],ct=Ge-A[Xe],$t=O?-Z[$e]/2:0,Lt=$===mn?re[$e]:Z[$e],gt=$===mn?-Z[$e]:-re[$e],St=t.elements.arrow,Ct=O&&St?To(St):{width:0,height:0},Ft=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:Pl(),Ot=Ft[it],qt=Ft[Xe],Wt=Ea(0,re[$e],Ct[$e]),er=j?re[$e]/2-$t-Wt-Ot-Re.mainAxis:Lt-Wt-Ot-Re.mainAxis,On=j?-re[$e]/2+$t+Wt+qt+Re.mainAxis:gt+Wt+qt+Re.mainAxis,yr=t.elements.arrow&&ha(t.elements.arrow),Ti=yr?U==="y"?yr.clientTop||0:yr.clientLeft||0:0,Ii=(tt=Ue?.[U])!=null?tt:0,xn=Ge+er-Ii-Ti,Go=Ge+On-Ii,Pa=Ea(O?Oi(dt,xn):dt,Ge,O?Mr(ct,Go):ct);X[U]=Pa,Je[U]=Pa-Ge}if(s){var En,Sn=U==="x"?Dt:wt,Ai=U==="x"?jt:Ut,Gt=X[J],Or=J==="y"?"height":"width",$i=Gt+A[Sn],xr=Gt-A[Ai],Br=[Dt,wt].indexOf(M)!==-1,lu=(En=Ue?.[J])!=null?En:0,uu=Br?$i:Gt-re[Or]-Z[Or]-lu+Re.altAxis,cu=Br?Gt+re[Or]+Z[Or]-lu-Re.altAxis:xr,du=O&&Br?Lg(uu,Gt,cu):Ea(O?uu:$i,Gt,O?cu:xr);X[J]=du,Je[J]=du-Gt}t.modifiersData[n]=Je}}const Rg={name:"preventOverflow",enabled:!0,phase:"main",fn:Cg,requiresIfExists:["offset"]};var Tg=function(t,r){return t=typeof t=="function"?t(Object.assign({},r.rects,{placement:r.placement})):t,Dl(typeof t!="number"?t:wl(t,ba))};function Ig(e){var t,r=e.state,n=e.name,a=e.options,i=r.elements.arrow,o=r.modifiersData.popperOffsets,s=Jt(r.placement),c=Ao(s),p=[wt,Ut].indexOf(s)>=0,v=p?"height":"width";if(!(!i||!o)){var g=Tg(a.padding,r),m=To(i),O=c==="y"?Dt:wt,D=c==="y"?jt:Ut,C=r.rects.reference[v]+r.rects.reference[c]-o[c]-r.rects.popper[v],A=o[c]-r.rects.reference[c],M=ha(i),$=M?c==="y"?M.clientHeight||0:M.clientWidth||0:0,j=C/2-A/2,U=g[O],J=$-m[v]-g[D],X=$/2-m[v]/2+j,re=Ea(U,X,J),Z=c;r.modifiersData[n]=(t={},t[Z]=re,t.centerOffset=re-X,t)}}function Ag(e){var t=e.state,r=e.options,n=r.element,a=n===void 0?"[data-popper-arrow]":n;a!=null&&(typeof a=="string"&&(a=t.elements.popper.querySelector(a),!a)||El(t.elements.popper,a)&&(t.elements.arrow=a))}const $g={name:"arrow",enabled:!0,phase:"main",fn:Ig,effect:Ag,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Ll(e,t,r){return r===void 0&&(r={x:0,y:0}),{top:e.top-t.height-r.y,right:e.right-t.width+r.x,bottom:e.bottom-t.height+r.y,left:e.left-t.width-r.x}}function Cl(e){return[Dt,Ut,jt,wt].some(function(t){return e[t]>=0})}function Fg(e){var t=e.state,r=e.name,n=t.rects.reference,a=t.rects.popper,i=t.modifiersData.preventOverflow,o=xa(t,{elementContext:"reference"}),s=xa(t,{altBoundary:!0}),c=Ll(o,n),p=Ll(s,a,i),v=Cl(c),g=Cl(p);t.modifiersData[r]={referenceClippingOffsets:c,popperEscapeOffsets:p,isReferenceHidden:v,hasPopperEscaped:g},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":v,"data-popper-escaped":g})}var Qg=[rg,ag,lg,dg,gg,Dg,Rg,$g,{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Fg}],Mg=eg({defaultModifiers:Qg}),Ng=h(30115),Bg=h.n(Ng),ah=function(t){return Array.isArray(t)?t[0]:t},jg=function(t){if(typeof t=="function"){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return t.apply(void 0,n)}},ih=function(t,r){if(typeof t=="function")return jg(t,r);t!=null&&(t.current=r)},Rl=function(t){return t.reduce(function(r,n){var a=n[0],i=n[1];return r[a]=i,r},{})},Tl=typeof window<"u"&&window.document&&window.document.createElement?d.useLayoutEffect:d.useEffect,Ug=[],Wg=function(t,r,n){n===void 0&&(n={});var a=d.useRef(null),i={onFirstUpdate:n.onFirstUpdate,placement:n.placement||"bottom",strategy:n.strategy||"absolute",modifiers:n.modifiers||Ug},o=d.useState({styles:{popper:{position:i.strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),s=o[0],c=o[1],p=d.useMemo(function(){return{name:"updateState",enabled:!0,phase:"write",fn:function(O){var D=O.state,C=Object.keys(D.elements);on.flushSync(function(){c({styles:Rl(C.map(function(A){return[A,D.styles[A]||{}]})),attributes:Rl(C.map(function(A){return[A,D.attributes[A]]}))})})},requires:["computeStyles"]}},[]),v=d.useMemo(function(){var m={onFirstUpdate:i.onFirstUpdate,placement:i.placement,strategy:i.strategy,modifiers:[].concat(i.modifiers,[p,{name:"applyStyles",enabled:!1}])};return Bg()(a.current,m)?a.current||m:(a.current=m,m)},[i.onFirstUpdate,i.placement,i.strategy,i.modifiers,p]),g=d.useRef();return Tl(function(){g.current&&g.current.setOptions(v)},[v]),Tl(function(){if(!(t==null||r==null)){var m=n.createPopper||Mg,O=m(t,r,v);return g.current=O,function(){O.destroy(),g.current=null}}},[t,r,n.createPopper]),{state:g.current?g.current.state:null,styles:s.styles,attributes:s.attributes,update:g.current?g.current.update:null,forceUpdate:g.current?g.current.forceUpdate:null}};function Il(e){var t=d.useRef(e);return t.current=e,d.useCallback(function(){return t.current},[])}var Vg=function(){};function kg(e){var t=e.initial,r=e.value,n=e.onChange,a=n===void 0?Vg:n;if(t===void 0&&r===void 0)throw new TypeError('Either "value" or "initial" variable must be set. Now both are undefined');var i=d.useState(t),o=i[0],s=i[1],c=Il(o),p=d.useCallback(function(g){var m=c(),O=typeof g=="function"?g(m):g;typeof O.persist=="function"&&O.persist(),s(O),typeof a=="function"&&a(O)},[c,a]),v=r!==void 0;return[v?r:o,v?a:p]}function Al(e,t){return e===void 0&&(e=0),t===void 0&&(t=0),function(){return{width:0,height:0,top:t,right:e,bottom:t,left:e,x:0,y:0,toJSON:function(){return null}}}}var Gg=["styles","attributes"],$l={getBoundingClientRect:Al()},Fl={closeOnOutsideClick:!0,closeOnTriggerHidden:!1,defaultVisible:!1,delayHide:0,delayShow:0,followCursor:!1,interactive:!1,mutationObserverOptions:{attributes:!0,childList:!0,subtree:!0},offset:[0,6],trigger:"hover"};function Xg(e,t){var r,n,a;e===void 0&&(e={}),t===void 0&&(t={});var i=Object.keys(Fl).reduce(function(Xe,$e){var Ge;return(0,Te.A)({},Xe,(Ge={},Ge[$e]=Xe[$e]!==void 0?Xe[$e]:Fl[$e],Ge))},e),o=d.useMemo(function(){return[{name:"offset",options:{offset:i.offset}}]},Array.isArray(i.offset)?i.offset:[]),s=(0,Te.A)({},t,{placement:t.placement||i.placement,modifiers:t.modifiers||o}),c=d.useState(null),p=c[0],v=c[1],g=d.useState(null),m=g[0],O=g[1],D=kg({initial:i.defaultVisible,value:i.visible,onChange:i.onVisibleChange}),C=D[0],A=D[1],M=d.useRef();d.useEffect(function(){return function(){return clearTimeout(M.current)}},[]);var $=Wg(i.followCursor?$l:p,m,s),j=$.styles,U=$.attributes,J=(0,nr.A)($,Gg),X=J.update,re=Il({visible:C,triggerRef:p,tooltipRef:m,finalConfig:i}),Z=d.useCallback(function(Xe){return Array.isArray(i.trigger)?i.trigger.includes(Xe):i.trigger===Xe},Array.isArray(i.trigger)?i.trigger:[i.trigger]),be=d.useCallback(function(){clearTimeout(M.current),M.current=window.setTimeout(function(){return A(!1)},i.delayHide)},[i.delayHide,A]),Re=d.useCallback(function(){clearTimeout(M.current),M.current=window.setTimeout(function(){return A(!0)},i.delayShow)},[i.delayShow,A]),Ue=d.useCallback(function(){re().visible?be():Re()},[re,be,Re]);d.useEffect(function(){if(re().finalConfig.closeOnOutsideClick){var Xe=function(Ge){var dt,ct=re(),$t=ct.tooltipRef,Lt=ct.triggerRef,gt=(Ge.composedPath==null||(dt=Ge.composedPath())==null?void 0:dt[0])||Ge.target;gt instanceof Node&&$t!=null&&Lt!=null&&!$t.contains(gt)&&!Lt.contains(gt)&&be()};return document.addEventListener("mousedown",Xe),function(){return document.removeEventListener("mousedown",Xe)}}},[re,be]),d.useEffect(function(){if(!(p==null||!Z("click")))return p.addEventListener("click",Ue),function(){return p.removeEventListener("click",Ue)}},[p,Z,Ue]),d.useEffect(function(){if(!(p==null||!Z("double-click")))return p.addEventListener("dblclick",Ue),function(){return p.removeEventListener("dblclick",Ue)}},[p,Z,Ue]),d.useEffect(function(){if(!(p==null||!Z("right-click"))){var Xe=function(Ge){Ge.preventDefault(),Ue()};return p.addEventListener("contextmenu",Xe),function(){return p.removeEventListener("contextmenu",Xe)}}},[p,Z,Ue]),d.useEffect(function(){if(!(p==null||!Z("focus")))return p.addEventListener("focus",Re),p.addEventListener("blur",be),function(){p.removeEventListener("focus",Re),p.removeEventListener("blur",be)}},[p,Z,Re,be]),d.useEffect(function(){if(!(p==null||!Z("hover")))return p.addEventListener("mouseenter",Re),p.addEventListener("mouseleave",be),function(){p.removeEventListener("mouseenter",Re),p.removeEventListener("mouseleave",be)}},[p,Z,Re,be]),d.useEffect(function(){if(!(m==null||!Z("hover")||!re().finalConfig.interactive))return m.addEventListener("mouseenter",Re),m.addEventListener("mouseleave",be),function(){m.removeEventListener("mouseenter",Re),m.removeEventListener("mouseleave",be)}},[m,Z,Re,be,re]);var Je=J==null||(r=J.state)==null||(n=r.modifiersData)==null||(a=n.hide)==null?void 0:a.isReferenceHidden;d.useEffect(function(){i.closeOnTriggerHidden&&Je&&be()},[i.closeOnTriggerHidden,be,Je]),d.useEffect(function(){if(!i.followCursor||p==null)return;function Xe($e){var Ge=$e.clientX,dt=$e.clientY;$l.getBoundingClientRect=Al(Ge,dt),X?.()}return p.addEventListener("mousemove",Xe),function(){return p.removeEventListener("mousemove",Xe)}},[i.followCursor,p,X]),d.useEffect(function(){if(!(m==null||X==null||i.mutationObserverOptions==null)){var Xe=new MutationObserver(X);return Xe.observe(m,i.mutationObserverOptions),function(){return Xe.disconnect()}}},[i.mutationObserverOptions,m,X]);var tt=function($e){return $e===void 0&&($e={}),(0,Te.A)({},$e,{style:(0,Te.A)({},$e.style,j.popper)},U.popper,{"data-popper-interactive":i.interactive})},it=function($e){return $e===void 0&&($e={}),(0,Te.A)({},$e,U.arrow,{style:(0,Te.A)({},$e.style,j.arrow),"data-popper-arrow":!0})};return(0,Te.A)({getArrowProps:it,getTooltipProps:tt,setTooltipRef:O,setTriggerRef:v,tooltipRef:m,triggerRef:p,visible:C},J)}var Hg=h(17464),zg=Object.defineProperty,_g=Object.defineProperties,Kg=Object.getOwnPropertyDescriptors,Ql=Object.getOwnPropertySymbols,Yg=Object.prototype.hasOwnProperty,Zg=Object.prototype.propertyIsEnumerable,Ml=(e,t,r)=>t in e?zg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Jg=(e,t)=>{for(var r in t||(t={}))Yg.call(t,r)&&Ml(e,r,t[r]);if(Ql)for(var r of Ql(t))Zg.call(t,r)&&Ml(e,r,t[r]);return e},qg=(e,t)=>_g(e,Kg(t));const Nl=d.memo(({definition:e,operation:t,innerQueryPlaceholder:r})=>{const n=(0,G.of)(ev),[a,i]=(0,d.useState)(!1),{getTooltipProps:o,setTooltipRef:s,setTriggerRef:c,visible:p}=Xg({placement:"top",visible:a,offset:[0,16],onVisibleChange:i,interactive:!0,trigger:["click"]});return d.createElement(d.Fragment,null,d.createElement(ve.$n,{title:"Click to show description",ref:c,icon:"info-circle",size:"sm",variant:"secondary",fill:"text"}),p&&d.createElement(Hg.ZL,null,d.createElement("div",qg(Jg({ref:s},o()),{className:n.docBox}),d.createElement("div",{className:n.docBoxHeader},d.createElement("span",null,e.renderer(t,e,r)),d.createElement(Ve.Z,{grow:1}),d.createElement(ve.$n,{icon:"times",onClick:()=>i(!1),fill:"text",variant:"secondary",title:"Remove operation"})),d.createElement("div",{className:n.docBoxBody,dangerouslySetInnerHTML:{__html:tv(e,t)}}))))});Nl.displayName="OperationDocs";const ev=e=>({docBox:(0,S.css)({overflow:"hidden",background:e.colors.background.primary,border:`1px solid ${e.colors.border.strong}`,boxShadow:e.shadows.z3,maxWidth:"600px",padding:e.spacing(1),borderRadius:e.shape.radius.default,zIndex:e.zIndex.tooltip}),docBoxHeader:(0,S.css)({fontSize:e.typography.h5.fontSize,fontFamily:e.typography.fontFamilyMonospace,paddingBottom:e.spacing(1),display:"flex",alignItems:"center"}),docBoxBody:(0,S.css)({marginBottom:e.spacing(-1),color:e.colors.text.secondary}),signature:(0,S.css)({fontSize:e.typography.bodySmall.fontSize,fontFamily:e.typography.fontFamilyMonospace}),dropdown:(0,S.css)({opacity:0,color:e.colors.text.secondary})});function tv(e,t){var r;return(0,cr.G)(e.explainHandler?e.explainHandler(t,e):(r=e.documentation)!=null?r:"no docs")}var rv=Object.defineProperty,nv=Object.defineProperties,av=Object.getOwnPropertyDescriptors,Bl=Object.getOwnPropertySymbols,iv=Object.prototype.hasOwnProperty,ov=Object.prototype.propertyIsEnumerable,jl=(e,t,r)=>t in e?rv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Fo=(e,t)=>{for(var r in t||(t={}))iv.call(t,r)&&jl(e,r,t[r]);if(Bl)for(var r of Bl(t))ov.call(t,r)&&jl(e,r,t[r]);return e},Ul=(e,t)=>nv(e,av(t));const Wl=d.memo(({operation:e,definition:t,index:r,onChange:n,onRemove:a,queryModeller:i,dragHandleProps:o})=>{var s;const c=(0,G.of)(sv),[p,v]=(0,d.useState)({}),g=()=>{if(p.isOpen)v(Ul(Fo({},p),{isOpen:!1}));else{const m=i.getAlternativeOperations(t.alternativesKey).map(O=>({label:O.name,value:O}));v({isOpen:!0,alternatives:m})}};return d.createElement("div",{className:c.header},!p.isOpen&&d.createElement(d.Fragment,null,d.createElement("div",Fo({},o),(s=t.name)!=null?s:t.id),d.createElement(Ve.Z,{grow:1}),d.createElement("div",{className:`${c.operationHeaderButtons} operation-header-show-on-hover`},d.createElement(ve.$n,{icon:"angle-down",size:"sm",onClick:g,fill:"text",variant:"secondary",title:"Click to view alternative operations"}),d.createElement(Nl,{definition:t,operation:e,innerQueryPlaceholder:i.innerQueryPlaceholder}),d.createElement(ve.$n,{icon:"times",size:"sm",onClick:()=>a(r),fill:"text",variant:"secondary",title:"Remove operation"}))),p.isOpen&&d.createElement("div",{className:c.selectWrapper},d.createElement(at.l6,{autoFocus:!0,openMenuOnFocus:!0,placeholder:"Replace with",options:p.alternatives,isOpen:!0,onCloseMenu:g,onChange:m=>{if(m.value){const O=i.getOperationDefinition(m.value.id),D=[...O.defaultParams];for(let A=0;A<Math.min(e.params.length,D.length);A++)O.params[A].type===t.params[A].type&&(D[A]=e.params[A]);const C=Ul(Fo({},e),{params:D,id:m.value.id});n(r,t.changeTypeHandler?t.changeTypeHandler(C,O):C)}}})))});Wl.displayName="OperationHeader";const sv=e=>({header:(0,S.css)({borderBottom:`1px solid ${e.colors.border.medium}`,padding:e.spacing(.5,.5,.5,1),display:"flex",alignItems:"center"}),operationHeaderButtons:(0,S.css)({opacity:1}),selectWrapper:(0,S.css)({paddingRight:e.spacing(2)})});var bn=h(51440),lv=h(10880);function uv(e){if(e.editor)return e.editor;if(e.options)return fv;switch(e.type){case"boolean":return dv;case"number":case"string":default:return cv}}function cv(e){var t;return d.createElement(bn.D,{id:Pi(e.operationId,e.index),defaultValue:(t=e.value)==null?void 0:t.toString(),minWidth:e.paramDef.minWidth,placeholder:e.paramDef.placeholder,title:e.paramDef.description,maxWidth:(e.paramDef.minWidth||20)*3,onCommitChange:r=>{e.onChange(e.index,r.currentTarget.value),e.paramDef.runQueryOnEnter&&r.type==="keydown"&&e.onRunQuery()}})}function dv(e){return d.createElement(lv.S,{id:Pi(e.operationId,e.index),value:!!e.value,onChange:t=>e.onChange(e.index,t.currentTarget.checked)})}function fv({paramDef:e,value:t,index:r,operationId:n,onChange:a}){var i,o;const s=(0,G.of)(pv);let c=e.options;(i=c[0])!=null&&i.label||(c=e.options.map(v=>({label:v.toString(),value:v})));let p=(o=c.find(v=>v.value===t))!=null?o:(0,Ht.z)(t);return!t&&e.optional?d.createElement("div",{className:s.optionalParam},d.createElement(ve.$n,{size:"sm",variant:"secondary",title:`Add ${e.name}`,icon:"plus",onClick:()=>a(r,c[0].value)},e.name)):d.createElement(De.B,{gap:.5,direction:"row",alignItems:"center"},d.createElement(at.l6,{id:Pi(n,r),value:p,options:c,placeholder:e.placeholder,allowCustomValue:!0,onChange:v=>a(r,v.value),width:e.minWidth||"auto"}),e.optional&&d.createElement(ve.$n,{"data-testid":`operations.${r}.remove-param`,size:"sm",fill:"text",icon:"times",variant:"secondary",title:`Remove ${e.name}`,onClick:()=>a(r,"")}))}const pv=e=>({optionalParam:(0,S.css)({marginTop:e.spacing(1)})});function Pi(e,t){return`operations.${e}.param.${t}`}var gv=Object.defineProperty,vv=Object.defineProperties,mv=Object.getOwnPropertyDescriptors,Vl=Object.getOwnPropertySymbols,hv=Object.prototype.hasOwnProperty,bv=Object.prototype.propertyIsEnumerable,kl=(e,t,r)=>t in e?gv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Di=(e,t)=>{for(var r in t||(t={}))hv.call(t,r)&&kl(e,r,t[r]);if(Vl)for(var r of Vl(t))bv.call(t,r)&&kl(e,r,t[r]);return e},wi=(e,t)=>vv(e,mv(t));function yv({provided:e,flash:t,isConflicting:r,highlight:n,index:a,queryModeller:i,onChange:o,onRemove:s,operation:c,definition:p,query:v,timeRange:g,onRunQuery:m,datasource:O}){const D=(0,G.$j)(),C=Ov(D,r),A=xv(t),{current:M}=(0,d.useRef)((0,Tn.A)()),$=(X,re)=>{const Z=wi(Di({},c),{params:[...c.params]});Z.params[X]=re,Qo(p,Z,a,X,o)},j=()=>{const X=wi(Di({},c),{params:[...c.params,""]});Qo(p,X,a,c.params.length,o)},U=X=>{const re=wi(Di({},c),{params:[...c.params.slice(0,X),...c.params.slice(X+1)]});Qo(p,re,a,X,o)};let J;if(p.params.length>0){const X=p.params[p.params.length-1];X.restParam&&(J=Ev(X,j,a,c.params.length,C))}return d.createElement("div",wi(Di({className:(0,S.cx)(C.card,(A||n)&&C.cardHighlight,r&&C.cardError),ref:e.innerRef},e.draggableProps),{"data-testid":`operations.${a}.wrapper`}),d.createElement(Wl,{operation:c,dragHandleProps:e.dragHandleProps,definition:p,index:a,onChange:o,onRemove:s,queryModeller:i}),d.createElement("div",{className:C.body},c.params.map((X,re)=>{const Z=p.params[Math.min(p.params.length-1,re)],be=uv(Z);return d.createElement("div",{className:C.paramRow,key:`${re}-1`},!Z.hideName&&d.createElement("div",{className:C.paramName},d.createElement("label",{htmlFor:Pi(M,re)},Z.name),Z.description&&d.createElement(yi.m,{placement:"top",content:Z.description,theme:"info"},d.createElement(Po.I,{name:"info-circle",size:"sm",className:C.infoIcon}))),d.createElement("div",{className:C.paramValue},d.createElement(De.B,{gap:.5,direction:"row",alignItems:"center",wrap:!1},d.createElement(be,{index:re,paramDef:Z,value:c.params[re],operation:c,operationId:M,onChange:$,onRunQuery:m,query:v,datasource:O,timeRange:g,queryModeller:i}),Z.restParam&&(c.params.length>p.params.length||Z.optional)&&d.createElement(ve.$n,{"data-testid":`operations.${a}.remove-rest-param`,size:"sm",fill:"text",icon:"times",variant:"secondary",title:`Remove ${Z.name}`,onClick:()=>U(re)}))))})),J,a<v.operations.length-1&&d.createElement("div",{className:C.arrow},d.createElement("div",{className:C.arrowLine}),d.createElement("div",{className:C.arrowArrow})))}const Ov=(e,t)=>({cardWrapper:(0,S.css)({alignItems:"stretch"}),error:(0,S.css)({marginBottom:e.spacing(1)}),card:(0,S.css)({background:e.colors.background.primary,border:`1px solid ${e.colors.border.medium}`,cursor:"grab",borderRadius:e.shape.radius.default,position:"relative",transition:"all 0.5s ease-in 0s",height:t?"auto":"100%"}),cardError:(0,S.css)({boxShadow:`0px 0px 4px 0px ${e.colors.warning.main}`,border:`1px solid ${e.colors.warning.main}`}),cardHighlight:(0,S.css)({boxShadow:`0px 0px 4px 0px ${e.colors.primary.border}`,border:`1px solid ${e.colors.primary.border}`}),infoIcon:(0,S.css)({marginLeft:e.spacing(.5),color:e.colors.text.secondary,":hover":{color:e.colors.text.primary}}),body:(0,S.css)({margin:e.spacing(1,1,.5,1),display:"table"}),paramRow:(0,S.css)({label:"paramRow",display:"table-row",verticalAlign:"middle"}),paramName:(0,S.css)({display:"table-cell",padding:e.spacing(0,1,0,0),fontSize:e.typography.bodySmall.fontSize,fontWeight:e.typography.fontWeightMedium,verticalAlign:"middle",height:"32px"}),paramValue:(0,S.css)({label:"paramValue",display:"table-cell",verticalAlign:"middle"}),restParam:(0,S.css)({padding:e.spacing(0,1,1,1)}),arrow:(0,S.css)({position:"absolute",top:"0",right:"-18px",display:"flex"}),arrowLine:(0,S.css)({height:"2px",width:"8px",backgroundColor:e.colors.border.strong,position:"relative",top:"14px"}),arrowArrow:(0,S.css)({width:0,height:0,borderTop:"5px solid transparent",borderBottom:"5px solid transparent",borderLeft:`7px solid ${e.colors.border.strong}`,position:"relative",top:"10px"})});function xv(e){const[t,r]=(0,d.useState)(!0);return(0,d.useEffect)(()=>{let n;return e?n=setTimeout(()=>{r(!1)},1e3):r(!0),()=>clearTimeout(n)},[e]),t&&e}function Qo(e,t,r,n,a){e.paramChangedHandler?a(r,e.paramChangedHandler(n,t,e)):a(r,t)}function Ev(e,t,r,n,a){return d.createElement("div",{className:a.restParam,key:`${n}-2`},d.createElement(ve.$n,{size:"sm",icon:"plus",title:`Add ${e.name}`.trimEnd(),variant:"secondary",onClick:t,"data-testid":`operations.${r}.add-rest-param`},e.name))}function Sv({operation:e,index:t,onRemove:r,onChange:n,onRunQuery:a,queryModeller:i,query:o,datasource:s,flash:c,highlight:p,timeRange:v,isConflictingOperation:g}){const m=i.getOperationDefinition(e.id),O=(0,G.$j)(),D=g?g(e,o.operations):!1,C=Pv(O);if(!m)return d.createElement("span",null,"Operation ",e.id," not found");const A=M=>{if(!M)return D?!0:void 0};return d.createElement(Pp,{draggableId:`operation-${t}`,index:t},(M,$)=>d.createElement(zt.I,{error:"You have conflicting label filters",invalid:A($.isDragging),className:(0,S.cx)(C.error,C.cardWrapper)},d.createElement(yv,{provided:M,flash:c,highlight:p,isConflicting:D,index:t,operation:e,definition:m,onChange:n,onRemove:r,queryModeller:i,query:o,timeRange:v,onRunQuery:a,datasource:s})))}const Pv=(e,t)=>({cardWrapper:(0,S.css)({alignItems:"stretch"}),error:(0,S.css)({marginBottom:e.spacing(1)})});var Dv=Object.defineProperty,wv=Object.defineProperties,Lv=Object.getOwnPropertyDescriptors,Gl=Object.getOwnPropertySymbols,Cv=Object.prototype.hasOwnProperty,Rv=Object.prototype.propertyIsEnumerable,Xl=(e,t,r)=>t in e?Dv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Li=(e,t)=>{for(var r in t||(t={}))Cv.call(t,r)&&Xl(e,r,t[r]);if(Gl)for(var r of Gl(t))Rv.call(t,r)&&Xl(e,r,t[r]);return e},Mo=(e,t)=>wv(e,Lv(t));function Tv({query:e,datasource:t,queryModeller:r,onChange:n,onRunQuery:a,highlightedOp:i,timeRange:o,isConflictingOperation:s}){const c=(0,G.of)($v),{operations:p}=e,v=Iv(p),[g,m]=(0,d.useState)(!1),O=(j,U)=>{const J=[...p];J.splice(j,1,U),n(Mo(Li({},e),{operations:J}))},D=j=>{const U=[...p.slice(0,j),...p.slice(j+1)];n(Mo(Li({},e),{operations:U}))},C=r.getCategories().map(j=>({value:j,label:j,items:r.getOperationsForCategory(j).map(U=>({value:U.id,label:U.name,isLeaf:!0}))})),A=j=>{const U=r.getOperationDefinition(j);U&&(n(U.addOperationHandler(U,e,r)),m(!1))},M=j=>{if(!j.destination)return;const U=[...p],J=U[j.source.index];U.splice(j.source.index,1),U.splice(j.destination.index,0,J),n(Mo(Li({},e),{operations:U}))},$=()=>{m(!1)};return d.createElement(De.B,{gap:1,direction:"column"},d.createElement(De.B,{gap:1},p.length>0&&d.createElement(Qf,{onDragEnd:M},d.createElement(cl,{droppableId:"sortable-field-mappings",direction:"horizontal"},j=>d.createElement("div",Li({className:c.operationList,ref:j.innerRef},j.droppableProps),p.map((U,J)=>d.createElement(Sv,{key:U.id+JSON.stringify(U.params)+J,queryModeller:r,index:J,operation:U,query:e,datasource:t,onChange:O,onRemove:D,onRunQuery:a,flash:v[J],highlight:i===U,timeRange:o,isConflictingOperation:s})),j.placeholder))),d.createElement("div",{className:c.addButton},g?d.createElement(Ip.v,{options:C,onSelect:A,onBlur:$,autoFocus:!0,alwaysOpen:!0,hideActiveLevelLabel:!0,placeholder:"Search"}):d.createElement(ve.$n,{icon:"plus",variant:"secondary",onClick:()=>m(!0),title:"Add operation"},"Operations"))))}function Iv(e){const t=(0,Tp.A)(),r=(0,me.A)(e);if(!t())return e.map(()=>!1);if(!r)return e.map(()=>!0);let n=[];if(r.length-1===e.length&&e.every(a=>r.includes(a)))return e.map(()=>!1);if(r.length+1===e.length&&r.every(a=>e.includes(a))){const a=e.find(i=>!r.includes(i));n=e.map(i=>i===a)}else n=e.map((a,i)=>{var o;return!Av(a.id,(o=r[i])==null?void 0:o.id)});return n}function Av(e,t){return e===t||`__${e}_by`===t||e===`__${t}_by`}const $v=e=>({heading:(0,S.css)({label:"heading",fontSize:12,fontWeight:e.typography.fontWeightMedium,marginBottom:0}),operationList:(0,S.css)({label:"operationList",display:"flex",flexWrap:"wrap",gap:e.spacing(2)}),addButton:(0,S.css)({label:"addButton",width:126,paddingBottom:e.spacing(1)})}),Hl=({datasource:e,query:t,onChange:r,data:n,queryModeller:a,buildVisualQueryFromString:i,buildDataQueryFromQueryString:o,buildQueryStringFromDataQuery:s})=>{const[c,p]=(0,d.useState)([]),v=(0,G.of)(Fv);return(0,d.useEffect)(()=>{var g;const m=o(a.renderQuery(t)),O=(g=e.getQueryHints)==null?void 0:g.call(e,m,n?.series||[]).filter(D=>{var C;return(C=D.fix)==null?void 0:C.action});p(O??[])},[e,t,n,a,o]),d.createElement(d.Fragment,null,c.length>0&&d.createElement("div",{className:v.container},c.map(g=>{var m,O,D,C;return d.createElement(yi.m,{content:`${g.label} ${(m=g.fix)==null?void 0:m.label}`,key:g.type},d.createElement(ve.$n,{onClick:()=>{var A,M,$;if((0,ce.rR)("grafana_query_builder_hints_clicked",{hint:g.type,datasourceType:e.type}),(A=g?.fix)!=null&&A.action){const j=o(a.renderQuery(t)),U=(M=e.modifyQuery)==null?void 0:M.call(e,j,g.fix.action);if(U){const J=i(($=s(U))!=null?$:"");return r(J.query)}}},fill:"outline",size:"sm",className:v.hint},"hint: ",((O=g.fix)==null?void 0:O.title)||((C=(D=g.fix)==null?void 0:D.action)==null?void 0:C.type.toLowerCase().replace("_"," "))))})))};Hl.displayName="QueryBuilderHints";const Fv=e=>({container:(0,S.css)`
      display: flex;
      align-items: start;
    `,hint:(0,S.css)`
      margin-right: ${e.spacing(1)};
    `});function zl({query:e,queryModeller:t,stepNumber:r,language:n,onMouseEnter:a,onMouseLeave:i}){return d.createElement(d.Fragment,null,e.operations.map((o,s)=>{var c;const p=t.getOperationDefinition(o.id);if(!p)return`Operation ${o.id} not found`;const v=p.renderer(o,p,t.innerQueryPlaceholder),g=p.explainHandler?p.explainHandler(o,p):(c=p.documentation)!=null?c:"no docs";return d.createElement("div",{key:s,onMouseEnter:()=>a?.(o,s),onMouseLeave:()=>i?.(o,s)},d.createElement(_t,{stepNumber:s+r,title:d.createElement(dr.Z,{query:v,language:n}),markdown:g}))}))}var Ci=h(71713),Qv=h(11216),Nr=h(54623);const _l="Fetch all log lines matching label filters.",Kl=(0,d.memo)(({query:e})=>{const t=(0,Qt.u_)(e||"").query,r={grammar:Ci.vB,name:"lokiql"};return(0,b.jsxs)(Oe.B,{gap:0,direction:"column",children:[(0,b.jsx)(_t,{stepNumber:1,title:(0,b.jsx)(dr.Z,{query:`${vt.y.renderLabels(t.labels)}`,language:r}),children:_l}),(0,b.jsx)(zl,{stepNumber:2,queryModeller:vt.y,query:t,language:r})]})});Kl.displayName="LokiQueryBuilderExplained";var Mv=h(29158),Nv=h(58592);const Yl=(0,d.memo)(({nestedQuery:e,index:t,datasource:r,onChange:n,onRemove:a,onRunQuery:i,showExplain:o})=>{const s=(0,G.of)(jv);return(0,b.jsxs)("div",{className:s.card,children:[(0,b.jsxs)("div",{className:s.header,children:[(0,b.jsx)("div",{className:s.name,children:"Operator"}),(0,b.jsx)(at.l6,{"aria-label":"Select operator",width:"auto",options:Bv,value:(0,Ht.z)(e.operator),onChange:c=>{n(t,{...e,operator:c.value})}}),(0,b.jsx)("div",{className:s.name,children:"Vector matches"}),(0,b.jsxs)("div",{className:s.vectorMatchWrapper,children:[(0,b.jsx)(at.l6,{width:"auto",value:e.vectorMatchesType||"on",allowCustomValue:!0,options:[{value:"on",label:"on"},{value:"ignoring",label:"ignoring"}],onChange:c=>{n(t,{...e,vectorMatchesType:c.value})}}),(0,b.jsx)(bn.D,{className:s.vectorMatchInput,minWidth:20,defaultValue:e.vectorMatches,onCommitChange:c=>{n(t,{...e,vectorMatches:c.currentTarget.value,vectorMatchesType:e.vectorMatchesType||"on"})}})]}),(0,b.jsx)(Ve.Z,{grow:1}),(0,b.jsx)(Mv.K,{name:"times",size:"sm",onClick:()=>a(t),tooltip:"Remove nested query"})]}),(0,b.jsx)("div",{className:s.body,children:(0,b.jsx)(V.D,{children:(0,b.jsx)(No,{showExplain:o,query:e.query,datasource:r,onRunQuery:i,onChange:c=>{n(t,{...e,query:c})}})})})]})}),Bv=Nv.C.map(e=>({label:e.sign,value:e.sign}));Yl.displayName="NestedQuery";const jv=e=>({card:(0,S.css)({label:"card",display:"flex",flexDirection:"column",gap:e.spacing(.5)}),header:(0,S.css)({label:"header",padding:e.spacing(.5,.5,.5,1),gap:e.spacing(1),display:"flex",alignItems:"center"}),name:(0,S.css)({label:"name",whiteSpace:"nowrap"}),body:(0,S.css)({label:"body",paddingLeft:e.spacing(2)}),vectorMatchInput:(0,S.css)({label:"vectorMatchInput",marginLeft:-1}),vectorMatchWrapper:(0,S.css)({label:"vectorMatchWrapper",display:"flex"})});function Uv({query:e,datasource:t,onChange:r,onRunQuery:n,showExplain:a}){const i=e.binaryQueries??[],o=(c,p)=>{const v=[...i];v.splice(c,1,p),r({...e,binaryQueries:v})},s=c=>{const p=[...i.slice(0,c),...i.slice(c+1)];r({...e,binaryQueries:p})};return(0,b.jsx)(Oe.B,{direction:"column",gap:1,children:i.map((c,p)=>(0,b.jsx)(Yl,{nestedQuery:c,index:p,onChange:o,datasource:t,onRemove:s,onRunQuery:n,showExplain:a},p.toString()))})}const Zl=5*60*1e3,No=(0,d.memo)(({datasource:e,query:t,onChange:r,onRunQuery:n,showExplain:a,timeRange:i})=>{const[o,s]=(0,d.useState)(),[c,p]=(0,d.useState)(void 0),v=(0,me.A)(t),g=(0,me.A)(i),m=$=>{r({...t,labels:$})},O=async $=>{const j=await $;return[...e.getVariables(),...j].map(U=>({label:U,value:U}))},D=async $=>{const j=t.labels.filter(Z=>Z!==$),U=j.find(Z=>Z.op==="="||Z.op==="=~"&&new RegExp(Z.value).test("")===!1);if(j.length===0||!U)return await e.languageProvider.fetchLabels({timeRange:i});const J=vt.y.renderLabels(j),X=await e.languageProvider.fetchLabels({streamSelector:J,timeRange:i}),re=j.map(Z=>Z.label);return X.filter(Z=>!re.includes(Z)).sort()},C=async $=>{if(!$.label)return[];let j;const U=t.labels.filter(X=>X!==$),J=U.find(X=>X.op==="="||X.op==="=~"&&new RegExp(X.value).test("")===!1);if(U.length===0||!J)j=await e.languageProvider.fetchLabelValues($.label,{timeRange:i});else{const X=vt.y.renderLabels(U);j=await e.languageProvider.fetchLabelValues($.label,{streamSelector:X,timeRange:i})}return j?j.map(X=>(0,oe.Bb)(X,$.op)):[]},A=(0,d.useMemo)(()=>{const{labels:$,operations:j}=t;return!$.length&&j.length?!(j.length===1&&j[0].id===Nr.EF.LineContains&&j[0].params[0]===""):!1},[t]);(0,d.useEffect)(()=>{const $=async()=>{const J={expr:vt.y.renderQuery(t),refId:"data-samples"},X=i??(0,Ra.E2)(),Z={series:await e.getDataSamples(J,X),state:Se.Gu.Done,timeRange:X};s(Z)},j=g&&i&&(Math.abs(i.to.valueOf()-g.to.valueOf())>Zl||Math.abs(i.from.valueOf()-g.from.valueOf())>Zl),U=!(0,le.isEqual)(v,t);K.$.featureToggles.lokiQueryHints&&(j||U)&&$().catch(console.error)},[e,t,i,v,g]);const M={grammar:Ci.Ay,name:"logql"};return(0,b.jsxs)("div",{"data-testid":jo.editor,children:[(0,b.jsx)(Cn.U,{children:(0,b.jsx)(ur,{onGetLabelNames:$=>O(D($)),onGetLabelValues:$=>O(C($)),labelsFilters:t.labels,onChange:m,labelFilterRequired:A})}),a&&(0,b.jsx)(_t,{stepNumber:1,title:(0,b.jsx)(dr.Z,{query:`${vt.y.renderLabels(t.labels)}`,language:M}),children:_l}),(0,b.jsxs)(Mn.i,{children:[(0,b.jsx)(Tv,{queryModeller:vt.y,query:t,onChange:r,onRunQuery:n,datasource:e,highlightedOp:c,isConflictingOperation:($,j)=>$.id===Nr.EF.LabelFilter&&(0,Qv.hh)($,j)}),(0,b.jsx)(Hl,{datasource:e,query:t,onChange:r,data:o,queryModeller:vt.y,buildVisualQueryFromString:Qt.u_,buildDataQueryFromQueryString:$=>({expr:$,refId:"hints"}),buildQueryStringFromDataQuery:$=>$.expr})]}),a&&(0,b.jsx)(zl,{stepNumber:2,queryModeller:vt.y,query:t,language:M,onMouseEnter:$=>{p($)},onMouseLeave:()=>{p(void 0)}}),t.binaryQueries&&t.binaryQueries.length>0&&(0,b.jsx)(Uv,{query:t,datasource:e,onChange:r,onRunQuery:n,showExplain:a})]})});No.displayName="LokiQueryBuilder";function Wv({query:e}){return(0,b.jsx)(Cn.U,{children:(0,b.jsx)(Rn.B,{children:(0,b.jsx)(dr.Z,{query:e,language:{grammar:Ci.vB,name:"lokiql"}})})})}function Vv(e){const{query:t,onChange:r,onRunQuery:n,datasource:a,showExplain:i,timeRange:o}=e,[s,c]=(0,d.useReducer)(Jl.reducer,{expr:t.expr,visQuery:t.expr===""?{labels:[],operations:[{id:"__line_contains",params:[""]}]}:void 0});(0,d.useEffect)(()=>{c(Xv(t.expr))},[t.expr]);const p=v=>{const g=vt.y.renderQuery(v);c(Gv({visQuery:v,expr:g})),r({...e.query,expr:g})};return s.visQuery?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(No,{query:s.visQuery,datasource:a,onChange:p,onRunQuery:n,showExplain:i,"data-testid":jo.editor,timeRange:o}),t.expr!==""&&(0,b.jsx)(Wv,{query:t.expr})]}):null}const kv={expr:""},Jl=(0,Ca.Z0)({name:"loki-builder-container",initialState:kv,reducers:{visualQueryChange:(e,t)=>{e.expr=t.payload.expr,e.visQuery=t.payload.visQuery},exprChanged:(e,t)=>{if(!e.visQuery||e.expr!==t.payload){e.expr=t.payload;const r=(0,Qt.u_)(t.payload);e.visQuery=r.query}}}}),{visualQueryChange:Gv,exprChanged:Xv}=Jl.actions;var ql=h(70416),Hv=h(42941),zv=h(83195),eu=h(82762);function _v({title:e,children:t,collapsedInfo:r,queryStats:n}){const[a,i]=(0,Hv.A)(!1),o=(0,G.of)(Kv);return d.createElement("div",{className:o.wrapper},d.createElement(eu.S,{className:o.collapse,collapsible:!0,isOpen:a,onToggle:i,label:d.createElement(De.B,{gap:0},d.createElement("h6",{className:o.title},e),!a&&d.createElement("div",{className:o.description},r.map((s,c)=>d.createElement("span",{key:c},s))))},d.createElement("div",{className:o.body},t)),n&&K.$.featureToggles.lokiQuerySplitting&&d.createElement(yi.m,{content:"Note: the query will be split into multiple parts and executed in sequence. Query limits will only apply each individual part."},d.createElement(Po.I,{tabIndex:0,name:"info-circle",className:o.tooltip,size:"sm"})),n&&d.createElement("p",{className:o.stats},Yv(n)))}const Kv=e=>({collapse:(0,S.css)({backgroundColor:"unset",border:"unset",marginBottom:0,"> button":{padding:e.spacing(0,1)}}),wrapper:(0,S.css)({width:"100%",display:"flex",justifyContent:"space-between",alignItems:"baseline"}),title:(0,S.css)({flexGrow:1,overflow:"hidden",fontSize:e.typography.bodySmall.fontSize,fontWeight:e.typography.fontWeightMedium,margin:0}),description:(0,S.css)({color:e.colors.text.secondary,fontSize:e.typography.bodySmall.fontSize,fontWeight:e.typography.bodySmall.fontWeight,paddingLeft:e.spacing(2),gap:e.spacing(2),display:"flex"}),body:(0,S.css)({display:"flex",gap:e.spacing(2),flexWrap:"wrap"}),stats:(0,S.css)({margin:"0px",color:e.colors.text.secondary,fontSize:e.typography.bodySmall.fontSize}),tooltip:(0,S.css)({marginRight:e.spacing(.25)})}),Yv=e=>e.message?e.message:`This query will process approximately ${Zv(e)}.`,Zv=e=>{const{text:t,suffix:r}=(0,zv.j_)("bytes")(e.bytes,1);return t+r};var Jv=h(42418),yn=h(60016),tu=h(56587),Sa=h(13137);const ru=d.memo(({app:e,query:t,onChange:r,onRunQuery:n,maxLines:a,queryStats:i})=>{const[o,s]=(0,d.useState)(!0),c=$=>{r({...t,queryType:$}),n()},p=$=>{(0,ce.rR)("grafana_loki_resolution_clicked",{app:e,resolution:$.value}),r({...t,resolution:$.value}),n()},v=$=>{const j=$.currentTarget.value;if(!(0,ql.di)(j)){s(!1);return}s(!0),r({...t,splitDuration:j}),n()},g=$=>{r({...t,legendFormat:$.currentTarget.value}),n()};function m($){const j=(0,yn.wU)($.currentTarget.value);t.maxLines!==j&&(r({...t,maxLines:j}),n())}function O($){r({...t,step:(0,le.trim)($.currentTarget.value)}),n()}let D=(0,tu.Io)(t);const C=(0,tu.sI)(t.expr),A=C?yn.TO.filter($=>$.value!==Sa.U3.Instant):yn.TO;C&&D===Sa.U3.Instant&&(r({...t,queryType:Sa.U3.Range}),D=Sa.U3.Range);const M=(0,d.useMemo)(()=>!!(!t.step||(0,ql.V3)(t.step)||!isNaN(Number(t.step))),[t.step]);return(0,b.jsx)(Cn.U,{children:(0,b.jsxs)(_v,{title:"Options",collapsedInfo:qv(t,D,a,C,M),queryStats:i,children:[(0,b.jsx)(tr.c,{label:"Legend",tooltip:"Series name override or template. Ex. {{hostname}} will be replaced with label value for hostname.",children:(0,b.jsx)(bn.D,{placeholder:"{{label}}",type:"string",minWidth:14,defaultValue:t.legendFormat,onCommitChange:g})}),A.length>1&&(0,b.jsx)(tr.c,{label:"Type",children:(0,b.jsx)(P.z,{options:A,value:D,onChange:c})}),C&&(0,b.jsx)(tr.c,{label:"Line limit",tooltip:"Upper limit for number of log lines returned by query.",children:(0,b.jsx)(bn.D,{className:"width-4",placeholder:a.toString(),type:"number",min:0,defaultValue:t.maxLines?.toString()??"",onCommitChange:m})}),!C&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(tr.c,{label:"Step",tooltip:"Use the step parameter when making metric queries to Loki. If not filled, Grafana's calculated interval will be used. Example valid values: 1s, 5m, 10h, 1d.",invalid:!M,error:"Invalid step. Example valid values: 1s, 5m, 10h, 1d.",children:(0,b.jsx)(bn.D,{className:"width-6",placeholder:"auto",type:"string",defaultValue:t.step??"",onCommitChange:O})}),t.resolution!==void 0&&t.resolution>1&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(tr.c,{label:"Resolution",tooltip:"Changes the step parameter of Loki metrics range queries. With a resolution of 1/1, each pixel corresponds to one data point. 1/10 retrieves one data point per 10 pixels. Lower resolutions perform better.",children:(0,b.jsx)(at.l6,{isSearchable:!1,onChange:p,options:yn.iB,value:t.resolution||1,"aria-label":"Select resolution"})}),(0,b.jsx)(Jv.F,{severity:"warning",title:"The 'Resolution' is deprecated. Use 'Step' editor instead to change step parameter."})]})]}),K.$.featureToggles.lokiQuerySplittingConfig&&K.$.featureToggles.lokiQuerySplitting&&(0,b.jsx)(tr.c,{label:"Split Duration",tooltip:"Defines the duration of a single query when query splitting is enabled.",children:(0,b.jsx)(bn.D,{minWidth:14,type:"string",min:0,defaultValue:t.splitDuration??"1d",onCommitChange:v,invalid:!o})})]})})});function qv(e,t,r,n,a){const i=yn.TO.find(c=>c.value===t),o=yn.iB.find(c=>c.value===(e.resolution??1)),s=[];return e.legendFormat&&s.push(`Legend: ${e.legendFormat}`),s.push(`Type: ${i?.label}`),n&&s.push(`Line limit: ${e.maxLines??r}`),n||(e.step&&s.push(`Step: ${a?e.step:"Invalid value"}`),e.resolution&&s.push(`Resolution: ${o?.label}`)),s}ru.displayName="LokiQueryBuilderOptions";var nu=h(95881);function em({query:e,datasource:t,range:r,onRunQuery:n,onChange:a,data:i,app:o,showExplain:s,history:c}){const p=(0,G.of)(tm);return(0,b.jsxs)("div",{className:p.wrapper,children:[(0,b.jsx)(nu.W,{datasource:t,query:e,range:r,onRunQuery:n,onChange:a,history:c,data:i,app:o,"data-testid":jo.editor}),s&&(0,b.jsx)(Kl,{query:e.expr})]})}const tm=e=>({wrapper:(0,S.css)`
      max-width: 100%;
      .gf-form {
        margin-bottom: 0.5;
      }
    `,buttonGroup:(0,S.css)`
      border: 1px solid ${e.colors.border.medium};
      border-top: none;
      padding: ${e.spacing(.5,.5,.5,.5)};
      margin-bottom: ${e.spacing(.5)};
      display: flex;
      flex-grow: 1;
      justify-content: end;
      font-size: ${e.typography.bodySmall.fontSize};
    `,hint:(0,S.css)`
      color: ${e.colors.text.disabled};
      white-space: nowrap;
      cursor: help;
    `});var rm=h(77789),nm=h(83657),Bo=h(10860);const am=e=>{const{pattern:t,onPatternSelect:r,hasNewQueryOption:n,hasPreviousQuery:a,selectedPatternName:i,setSelectedPatternName:o}=e,s=(0,G.of)(im),c={grammar:Ci.Ay,name:"logql"};return(0,b.jsxs)(Bo.Z,{className:s.card,children:[(0,b.jsx)(Bo.Z.Heading,{children:t.name}),(0,b.jsx)("div",{className:s.rawQueryContainer,children:(0,b.jsx)(dr.Z,{query:vt.y.renderQuery({labels:[],operations:t.operations}),language:c,className:s.rawQuery})}),(0,b.jsx)(Bo.Z.Actions,{children:i!==t.name?(0,b.jsx)(ve.$n,{size:"sm",onClick:()=>{a?o(t.name):r(t)},children:"Use this query"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:s.spacing,children:`If you would like to use this query, ${n?"you can either replace your current query or create a new query":"your current query will be replaced"}.`}),(0,b.jsx)(ve.$n,{size:"sm",fill:"outline",onClick:()=>o(null),children:"Back"}),(0,b.jsx)(ve.$n,{size:"sm",onClick:()=>{r(t)},children:"Apply to query"}),n&&(0,b.jsx)(ve.$n,{size:"sm",onClick:()=>{r(t,!0)},children:"Create new query"})]})})]})},im=e=>({card:(0,S.css)`
      width: 49.5%;
      display: flex;
      flex-direction: column;
    `,rawQueryContainer:(0,S.css)`
      flex-grow: 1;
    `,rawQuery:(0,S.css)`
      background-color: ${e.colors.background.primary};
      padding: ${e.spacing(1)};
      margin-top: ${e.spacing(1)};
    `,spacing:(0,S.css)`
      margin-bottom: ${e.spacing(1)};
    `}),om=[Nr.Ln.Formats,Nr.Ln.LineFilters,Nr.Ln.LabelFilters],sm=[Nr.EF.Unwrap],lm=nm.sp.filter(e=>e.category&&om.includes(e.category)&&!sm.includes(e.id)).map(e=>e.id),um=e=>{const{isOpen:t,onClose:r,onChange:n,onAddQuery:a,query:i,queries:o,app:s}=e,[c,p]=(0,d.useState)([]),[v,g]=(0,d.useState)(null),m=(0,G.of)(cm),O=!!a,D=(0,d.useMemo)(()=>(0,Qt.u_)(i.expr).query.operations.length>0,[i.expr]),C=(A,M=!1)=>{const $=(0,Qt.u_)(M?"":i.expr);(0,ce.rR)("grafana_loki_query_patterns_selected",{version:"v2",app:s??"",editorMode:i.editorMode,selectedPattern:A.name,preSelectedOperationsCount:$.query.operations.length,preSelectedLabelsCount:$.query.labels.length,createNewQuery:O&&M}),$.query.operations=$.query.operations.filter(U=>lm.includes(U.id));const j=A.operations.filter(U=>$.query.operations.findIndex(J=>J.id===U.id)<0);$.query.operations=[...$.query.operations,...j],O&&M?a({...i,refId:(0,rm.M)(o??[i]),expr:vt.y.renderQuery($.query)}):n({...i,expr:vt.y.renderQuery($.query)}),g(null),r()};return(0,b.jsxs)(lt.a,{isOpen:t,title:"Kick start your query",onDismiss:r,className:m.modal,children:[(0,b.jsx)("div",{className:m.spacing,children:"Kick start your query by selecting one of these queries. You can then continue to complete your query."}),Object.values(Nr.IQ).map(A=>(0,b.jsx)(eu.S,{label:`${(0,le.capitalize)(A)} query starters`,isOpen:c.includes(A),collapsible:!0,onToggle:()=>p(M=>M.includes(A)?M.filter($=>$!==A):[...M,A]),children:(0,b.jsx)("div",{className:m.cardsContainer,children:vt.y.getQueryPatterns().filter(M=>M.type===A).map(M=>(0,b.jsx)(am,{pattern:M,hasNewQueryOption:O,hasPreviousQuery:D,onPatternSelect:C,selectedPatternName:v,setSelectedPatternName:g},M.name))})},A)),(0,b.jsx)(ve.$n,{variant:"secondary",onClick:r,children:"Close"})]})},cm=e=>({cardsContainer:(0,S.css)`
      display: flex;
      flex-direction: row;
      flex-wrap: wrap;
      justify-content: space-between;
    `,spacing:(0,S.css)`
      margin-bottom: ${e.spacing(1)};
    `,modal:(0,S.css)`
      width: 85vw;
      ${e.breakpoints.down("md")} {
        width: 100%;
      }
    `}),au="LokiQueryEditorModeDefault";function dm(e,t,r){e.expr===""&&window.localStorage.setItem(au,t),r({...e,editorMode:t})}function fm(e){if(e!=null&&e!=="")return Pe.f.Code;switch(window.localStorage.getItem(au)){case"code":return Pe.f.Code;case"builder":default:return Pe.f.Builder}}function pm(e){let t=e;return e.editorMode||(t={...e,editorMode:fm(e.expr)}),e.expr==null&&(t={...t,expr:""}),e.queryType==null&&(t={...t,queryType:Sa.U3.Range}),t}var gm=h(47232);function iu(e,t){return!e||!t?!1:(0,gm.Ar)(e)?e.isSame(t):e===t}function vm(e,t,r,n,a,i){return t===void 0||e.trim()!==t.trim()||a!==i?!0:!(iu(r?.raw.from,n?.raw.from)&&iu(r?.raw.to,n?.raw.to))}const jo={editor:"loki-editor"},ou="LokiQueryEditorExplainDefault",su=(0,d.memo)(e=>{const t=(0,d.useId)(),{onChange:r,onRunQuery:n,onAddQuery:a,data:i,app:o,queries:s,datasource:c,range:p}=e,[v,g]=(0,d.useState)(!1),[m,O]=(0,d.useState)(!1),[D,C]=(0,d.useState)(!1),[A,M]=(0,d.useState)(!1),[$,j]=(0,d.useState)(null),[U,J]=(0,d.useState)(window.localStorage.getItem(ou)==="true"),X=c.predefinedOperations,re=(0,me.A)(p),Z=pm(e.query);K.$.featureToggles.lokiPredefinedOperations&&!Z.expr&&X&&(Z.expr=`{} ${X}`);const be=(0,me.A)(Z.expr),Re=(0,me.A)(Z.queryType),Ue=Z.editorMode,Je=$e=>{window.localStorage.setItem(ou,$e.currentTarget.checked?"true":"false"),J($e.currentTarget.checked)},tt=(0,d.useCallback)($e=>{if((0,ce.rR)("grafana_loki_editor_mode_clicked",{newEditor:$e,previousEditor:Z.editorMode??"",newQuery:!Z.expr,app:o??""}),$e===Pe.f.Builder&&(0,Qt.u_)(Z.expr||"").errors.length){g(!0);return}dm(Z,$e,r)},[r,Z,o]);(0,d.useEffect)(()=>{C(!1)},[i]);const it=$e=>{(0,le.isEqual)($e,e.query)||C(!0),r($e)},Xe=()=>{(0,ce.rR)("grafana_loki_label_browser_opened",{app:o}),M($e=>!$e)};return(0,d.useEffect)(()=>{vm(Z.expr,be,p,re,Z.queryType,Re)&&p&&(async()=>{const dt=await c.getStats({...Z,refId:`${t}_${Z.refId}`},p);j(dt)})()},[c,p,re,Z,be,Re,j,t]),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(ae.u,{isOpen:v,title:"Query parsing",body:"There were errors while trying to parse the query. Continuing to visual builder may lose some parts of the query.",confirmText:"Continue",onConfirm:()=>{r({...Z,editorMode:Pe.f.Builder}),g(!1)},onDismiss:()=>g(!1)}),(0,b.jsx)(um,{isOpen:m,onClose:()=>O(!1),query:Z,queries:s,app:o,onChange:r,onAddQuery:a}),(0,b.jsx)(Ln,{isOpen:A,datasource:c,query:Z,app:o,onClose:()=>M(!1),onChange:it,onRunQuery:n,timeRange:p}),(0,b.jsxs)(de.X,{children:[(0,b.jsxs)(Oe.B,{gap:1,children:[(0,b.jsx)(ve.$n,{"data-testid":he.Tp.components.QueryBuilder.queryPatterns,variant:"secondary",size:"sm",onClick:()=>{O(Ge=>!Ge);const $e=(0,Qt.u_)(Z.expr||"");(0,ce.rR)("grafana_loki_query_patterns_opened",{version:"v2",app:o??"",editorMode:Z.editorMode,preSelectedOperationsCount:$e.query.operations.length,preSelectedLabelsCount:$e.query.labels.length})},children:"Kick start your query"}),(0,b.jsx)(ve.$n,{variant:"secondary",size:"sm",onClick:Xe,"data-testid":"label-browser-button",children:"Label browser"})]}),(0,b.jsx)(q,{label:"Explain query",value:U,onChange:Je}),(0,b.jsx)(Ve.Z,{grow:1}),o!==Ce.Jk.Explore&&o!==Ce.Jk.Correlations&&(0,b.jsx)(ve.$n,{variant:D?"primary":"secondary",size:"sm",onClick:n,icon:i?.state===Se.Gu.Loading?"spinner":void 0,disabled:i?.state===Se.Gu.Loading,children:s&&s.length>1?"Run queries":"Run query"}),(0,b.jsx)(Q,{mode:Ue,onChange:tt})]}),(0,b.jsx)(He.$,{v:.5}),(0,b.jsxs)(V.D,{children:[Ue===Pe.f.Code&&(0,b.jsx)(em,{...e,query:Z,onChange:it,showExplain:U}),Ue===Pe.f.Builder&&(0,b.jsx)(Vv,{datasource:e.datasource,query:Z,onChange:it,onRunQuery:e.onRunQuery,showExplain:U,timeRange:p}),(0,b.jsx)(ru,{query:Z,onChange:r,onRunQuery:n,app:o,maxLines:c.maxLines,queryStats:$})]})]})});su.displayName="LokiQueryEditor";function mm(e){const{query:t,data:r,datasource:n,onChange:a,onRunQuery:i,history:o}=e;return(0,b.jsx)(nu.W,{datasource:n,query:t,onChange:a,onRunQuery:i,history:o,data:r,placeholder:"Enter a Loki query","data-testid":hm.editor})}const hm={editor:"loki-editor-cloud-alerting"};function bm(e){const{app:t}=e;switch(t){case Ce.Jk.CloudAlerting:return(0,b.jsx)(mm,{...e});default:return(0,b.jsx)(su,{...e})}}const ym=(0,d.memo)(bm),oh={editor:"loki-editor"};var Om=h(68704),xm=h(77657),Em=h(39748),Sm=h(66025),Pm=h(91062),Dm=h(32346),Uo=h(25994),wm=h(17081),Wo=h(29020),Vo=h(35931);function Lm({options:e,onOptionsChange:t}){return(0,b.jsx)(Wo.I,{title:"Alerting",description:(0,b.jsx)(Vo.H,{description:"Manage alert rules for the Loki data source.",suffix:"loki/configure-loki-data-source/#alerting",feature:"alerting"}),children:(0,b.jsx)(zt.I,{labelWidth:29,label:"Manage alert rules in Alerting UI",disabled:e.readOnly,tooltip:"Manage alert rules for this data source. To manage other alerting resources, add an Alertmanager data source.",children:(0,b.jsx)(we.K,{value:e.jsonData.manageAlerts!==!1,onChange:r=>t({...e,jsonData:{...e.jsonData,manageAlerts:r.currentTarget.checked}})})})})}var Cm=h(6709),Rm=h(91890),Tm=h(72574),Im=h(21744);const Am=e=>{const{derivedFields:t,className:r}=e,[n,a]=(0,d.useState)("");let i=[];return n&&t&&(i=Fm(t,n)),(0,b.jsxs)("div",{className:r,children:[(0,b.jsx)(zt.I,{label:"Debug log message",labelWidth:24,grow:!0,children:(0,b.jsx)(Im.f,{type:"text","aria-label":"Loki query",placeholder:"Paste an example log line here to test the regular expressions of your derived fields",value:n,onChange:o=>a(o.currentTarget.value)})}),!!i.length&&(0,b.jsx)($m,{fields:i})]})},$m=({fields:e})=>(0,b.jsxs)("table",{className:"filter-table",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{children:"Name"}),(0,b.jsx)("th",{children:"Value"}),(0,b.jsx)("th",{children:"Url"})]})}),(0,b.jsx)("tbody",{children:e.map(t=>{let r=t.value;return t.error&&t.error instanceof Error?r=t.error.message:t.href&&(r=(0,b.jsx)("a",{href:t.href,children:r})),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:t.name}),(0,b.jsx)("td",{children:r}),(0,b.jsx)("td",{children:t.href?(0,b.jsx)("a",{href:t.href,children:t.href}):""})]},`${t.name}=${t.value}`)})})]});function Fm(e,t){return e.filter(r=>r.name&&r.matcherRegex).map(r=>{try{const n=t.match(r.matcherRegex);let a;const i=n&&n[1];return i&&(a=(0,Tm.w)().replace(r.url,{__value:{value:{raw:i},text:"Raw value"}})),{name:r.name,value:i||"<no match>",href:a}}catch(n){return{name:r.name,error:n}}})}var Qm=h(55882),br=h(88575),Mm=h(64078);const Nm=e=>({row:(0,S.css)`
    display: flex;
    align-items: baseline;
  `,nameField:(0,S.css)`
    flex: 2;
    margin-right: ${e.spacing(.5)};
  `,regexField:(0,S.css)`
    flex: 3;
    margin-right: ${e.spacing(.5)};
  `,urlField:(0,S.css)`
    flex: 1;
    margin-right: ${e.spacing(.5)};
  `,urlDisplayLabelField:(0,S.css)`
    flex: 1;
  `,internalLink:(0,S.css)`
    margin-right: ${e.spacing(1)};
  `,dataSource:(0,S.css)``,nameMatcherField:(0,S.css)({width:e.spacing(20),marginRight:e.spacing(.5)})}),Bm=e=>{const{value:t,onChange:r,onDelete:n,suggestions:a,className:i,validateName:o}=e,s=(0,G.of)(Nm),[c,p]=(0,d.useState)(!!t.datasourceUid),v=(0,me.A)(t.datasourceUid),[g,m]=(0,d.useState)(t.matcherType??"regex");(0,d.useEffect)(()=>{!v&&t.datasourceUid&&!c&&p(!0),v&&!t.datasourceUid&&c&&p(!1)},[v,t.datasourceUid,c]);const O=C=>A=>{r({...t,[C]:A.currentTarget.value})},D=!o(t.name);return(0,b.jsxs)("div",{className:i,"data-testid":"derived-field",children:[(0,b.jsxs)("div",{className:"gf-form",children:[(0,b.jsx)(br.D,{className:s.nameField,label:"Name",invalid:D,error:"The name is already in use",children:(0,b.jsx)(Xt.p,{value:t.name,onChange:O("name"),placeholder:"Field name",invalid:D})}),(0,b.jsx)(br.D,{className:s.nameMatcherField,label:(0,b.jsx)(Ri,{label:"Type",content:"Derived fields can be created from labels or by applying a regular expression to the log message."}),children:(0,b.jsx)(at.l6,{options:[{label:"Regex in log line",value:"regex"},{label:"Label",value:"label"}],value:g,onChange:C=>{(C.value==="label"||C.value==="regex")&&(m(C.value),r({...t,matcherType:C.value}))}})}),(0,b.jsx)(br.D,{className:s.regexField,label:(0,b.jsxs)(b.Fragment,{children:[g==="regex"&&(0,b.jsx)(Ri,{label:"Regex",content:"Use to parse and capture some part of the log message. You can use the captured groups in the template."}),g==="label"&&(0,b.jsx)(Ri,{label:"Label",content:"Use to derive the field from a label."})]}),children:(0,b.jsx)(Xt.p,{value:t.matcherRegex,onChange:O("matcherRegex")})}),(0,b.jsx)(br.D,{label:"",children:(0,b.jsx)(ve.$n,{variant:"destructive",title:"Remove field",icon:"times",onClick:C=>{C.preventDefault(),n()}})})]}),(0,b.jsxs)("div",{className:"gf-form",children:[(0,b.jsx)(br.D,{label:c?"Query":"URL",className:s.urlField,children:(0,b.jsx)(Mm.l,{placeholder:c?"${__value.raw}":"http://example.com/${__value.raw}",value:t.url||"",onChange:C=>r({...t,url:C}),suggestions:a})}),(0,b.jsx)(br.D,{className:s.urlDisplayLabelField,label:(0,b.jsx)(Ri,{label:"URL Label",content:"Use to override the button label when this derived field is found in a log."}),children:(0,b.jsx)(Xt.p,{value:t.urlDisplayLabel,onChange:O("urlDisplayLabel")})})]}),(0,b.jsxs)("div",{className:"gf-form",children:[(0,b.jsx)(br.D,{label:"Internal link",className:s.internalLink,children:(0,b.jsx)(we.d,{value:c,onChange:C=>{const{checked:A}=C.currentTarget;A||r({...t,datasourceUid:void 0}),p(A)}})}),c&&(0,b.jsx)(br.D,{label:"",className:s.dataSource,children:(0,b.jsx)(Qm.s,{tracing:!0,onChange:C=>r({...t,datasourceUid:C.uid}),current:t.datasourceUid,noDefault:!0})})]})]})},Ri=({content:e,label:t})=>(0,b.jsxs)(Vt.J,{children:[t,(0,b.jsx)(yi.m,{placement:"top",content:e,theme:"info",children:(0,b.jsx)(Po.I,{tabIndex:0,name:"info-circle",size:"sm",style:{marginLeft:"10px"}})})]}),jm=e=>({addButton:(0,S.css)`
    margin-right: 10px;
  `,derivedField:(0,S.css)`
    margin-bottom: ${e.spacing(1)};
  `,container:(0,S.css)`
    margin-bottom: ${e.spacing(4)};
  `,debugSection:(0,S.css)`
    margin-top: ${e.spacing(4)};
  `}),Um=({fields:e=[],onChange:t})=>{const r=(0,G.$j)(),n=jm(r),[a,i]=(0,d.useState)(!1),o=(0,d.useCallback)(s=>e.filter(c=>c.name&&c.name===s).length<=1,[e]);return(0,b.jsx)(Wo.I,{title:"Derived fields",description:(0,b.jsx)(Vo.H,{description:"Derived fields can be used to extract new fields from a log message and create a link from its value.",suffix:"loki/configure-loki-data-source/#derived-fields",feature:"derived fields"}),children:(0,b.jsxs)("div",{className:n.container,children:[e.map((s,c)=>(0,b.jsx)(Bm,{className:n.derivedField,value:s,onChange:p=>{const v=[...e];v.splice(c,1,p),t(v)},onDelete:()=>{const p=[...e];p.splice(c,1),t(p)},validateName:o,suggestions:[{value:Cm.c.valueRaw,label:"Raw value",documentation:"Exact string captured by the regular expression",origin:Rm.$0.Value}]},c)),(0,b.jsxs)("div",{children:[(0,b.jsx)(ve.$n,{variant:"secondary",className:n.addButton,icon:"plus",onClick:s=>{s.preventDefault();const c={name:"",matcherRegex:"",urlDisplayLabel:"",url:"",matcherType:"regex"},p=[...e,c];t(p)},children:"Add"}),e.length>0&&(0,b.jsx)(ve.$n,{variant:"secondary",type:"button",onClick:()=>i(!a),children:a?"Hide example log message":"Show example log message"})]}),a&&(0,b.jsx)("div",{className:n.debugSection,children:(0,b.jsx)(Am,{className:(0,S.css)`
                margin-bottom: 10px;
              `,derivedFields:e})})]})})};var Wm=h(39268),Vm=h(39938);const km=e=>{const{maxLines:t,onMaxLinedChange:r,predefinedOperations:n,onPredefinedOperationsChange:a}=e;return(0,b.jsxs)(Wo.I,{title:"Queries",description:(0,b.jsx)(Vo.H,{description:"Additional options to customize your querying experience.",suffix:"loki/configure-loki-data-source/#queries",feature:"query settings"}),children:[(0,b.jsx)(zt.I,{label:"Maximum lines",htmlFor:"loki_config_maxLines",labelWidth:22,tooltip:(0,b.jsx)(b.Fragment,{children:"Loki queries must contain a limit of the maximum number of lines returned (default: 1000). Increase this limit to have a bigger result set for ad-hoc analysis. Decrease this limit if your browser becomes sluggish when displaying the log results."}),children:(0,b.jsx)(Xt.p,{type:"number",id:"loki_config_maxLines",value:t,onChange:i=>r(i.currentTarget.value),width:16,placeholder:"1000",spellCheck:!1})}),K.$.featureToggles.lokiPredefinedOperations&&(0,b.jsxs)(Wm.C,{children:[(0,b.jsx)(zt.I,{label:"Predefined operations",htmlFor:"loki_config_predefinedOperations",labelWidth:22,tooltip:(0,b.jsx)(b.Fragment,{children:'Predefined operations are used as an initial state for your queries. They are useful, if you want to unpack, parse or format all log lines. Currently we support only log operations starting with |. For example: | unpack | line_format "{{.message}}".'}),children:(0,b.jsx)(Xt.p,{type:"string",id:"loki_config_predefinedOperations",value:n,onChange:i=>a(i.currentTarget.value),width:40,placeholder:"| unpack | line_format",spellCheck:!1})}),(0,b.jsx)(zt.I,{children:(0,b.jsx)(Vm.E,{text:"Experimental",color:"orange",icon:"exclamation-triangle",tooltip:"Predefined operations is an experimental feature that may change in the future."})})]})]})},ko=e=>(t,r)=>({...t,jsonData:{...t.jsonData,[e]:r}}),Gm=ko("maxLines"),Xm=ko("predefinedOperations"),Hm=ko("derivedFields"),zm=e=>{const{options:t,onOptionsChange:r}=e,n=(0,d.useCallback)(a=>{(0,ce.rR)("grafana_loki_predefined_operations_changed",{value:a}),r(Xm(t,a))},[t,r]);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Om.I,{dataSourceName:"Loki",docsLink:"https://grafana.com/docs/grafana/latest/datasources/loki/configure-loki-data-source/",hasRequiredFields:!1}),(0,b.jsx)(Uo.c,{spacing:4}),(0,b.jsx)(xm.u,{config:t,onChange:r,urlPlaceholder:"http://localhost:3100"}),(0,b.jsx)(Uo.c,{spacing:4}),(0,b.jsx)(Em.N,{...(0,Sm.pe)({config:t,onChange:r})}),(0,b.jsx)(Uo.c,{spacing:4}),(0,b.jsx)(Pm.A,{title:"Additional settings",description:"Additional settings are optional settings that can be configured for more control over your data source.",isCollapsible:!0,isInitiallyOpen:!0,children:(0,b.jsxs)(Oe.B,{gap:5,direction:"column",children:[(0,b.jsx)(Dm.g,{config:t,onChange:r}),K.$.secureSocksDSProxyEnabled&&(0,b.jsx)(wm.Y,{options:t,onOptionsChange:r}),(0,b.jsx)(Lm,{options:t,onOptionsChange:r}),(0,b.jsx)(km,{maxLines:t.jsonData.maxLines||"",onMaxLinedChange:a=>r(Gm(t,a)),predefinedOperations:t.jsonData.predefinedOperations||"",onPredefinedOperationsChange:n}),(0,b.jsx)(Um,{fields:t.jsonData.derivedFields,onChange:a=>r(Hm(t,a))})]})})]})};var _m=h(27724),Km=h(79007);const Ym=new N.tD(_m.VQ).setQueryEditor(ym).setConfigEditor(zm).setQueryEditorHelp(Le);(0,H.J7)().subscribe(Ee.gc,Km.jg)},56587:(rt,Ne,h)=>{"use strict";h.d(Ne,{$F:()=>xe,Cg:()=>Ye,FV:()=>me,H0:()=>d,Io:()=>oe,MX:()=>he,OT:()=>De,QH:()=>Le,Rn:()=>Me,TQ:()=>ye,_i:()=>we,aw:()=>Pe,d_:()=>de,g5:()=>Y,gy:()=>_,pS:()=>Qe,pk:()=>T,sI:()=>Se,sc:()=>ne,vV:()=>G});var N=h(2543),Ee=h.n(N),H=h(36195),b=h(12798),S=h(56245),le=h(13137);function d(B=""){const k=[],q=Le(B,[H.PN]);for(const ee of q){const Ve=ee.getChild(H.dJ)?.getChild(H.Sg),P=ee.getChild(H.dJ)?.getChild(H.q5),R=ce(ee);if(!(!Ve&&!P||!R.length))for(const Q of R){const V=B.substring(Q.from,Q.to).trim(),K=V[0]==="`",ae=V.substring(1,V.length-1);if(!ae)continue;let Oe="";P?Oe=K?ae:ae.replace(/\\\\/g,"\\"):Oe=(0,N.escapeRegExp)(ae),Oe&&k.push(Oe)}}return k}function ce(B){const k=[];let q=B;do{const ee=q.getChild(H.Qf);ee&&!q.getChild(H.w7)&&k.push(ee),q=q.getChild(H.ih)}while(q!=null);return k}function G(B){let k=oe(B);const{instant:q,range:ee,...Ve}=B;try{Se(B.expr)&&k===le.U3.Instant&&(k=le.U3.Range)}catch{}return{...Ve,queryType:k}}function oe(B){const{queryType:k}=B;return k===le.U3.Range||k===le.U3.Instant||k===le.U3.Stream?k:B.instant===!0?le.U3.Instant:le.U3.Range}const ge=["String","Identifier","LineComment","Number"],F=["__error__","__interval","__interval_ms","__auto"];function xe(B){let k=B;return H.K3.parse(B).iterate({enter:({name:ee,from:Ve,to:P})=>{const R=B.substring(Ve,P);ge.includes(ee)&&!F.includes(R)&&(k=k.replace(R,ee))}}),k}function Fe(B){const k=[];return parser.parse(B).iterate({enter:({name:ee})=>{k.push(ee)}}),k}function W(B,k){let q=!1;return H.K3.parse(B).iterate({enter:({type:Ve})=>{if(Ve.id===k)return q=!0,!1}}),q}function Le(B,k){const q=[];return H.K3.parse(B).iterate({enter:Ve=>{(k===void 0||k.includes(Ve.type.id))&&q.push(Ve.node)}}),q}function ye(B,k){const q=[];return H.K3.parse(B).iterate({enter:Ve=>{(k===void 0||k.includes(Ve.type.id))&&q.push(b.Ch.fromNode(Ve.node))}}),q}function Ce(B,k){const q=Le(B,[k]);return q.length>0?q[0]:void 0}function me(B){return W(B,S.Ql)}function Se(B){return B.trim().length>2&&!W(B,H.Yw)}function he(B){const q=Le(B,[H.iT,H.eF,H.c$]).length;return{queryWithParser:q>0,parserCount:q}}function Pe(B){const k=Le(B,[H.iT,H.LM,H.c$]);return k.length>0?B.substring(k[0].from,k[0].to).trim():void 0}function de(B){const k=Le(B,[H.bY]);for(const q of k){const ee=q.getChild(H.g$)?.getChild(H.gw);if(ee&&B.substring(ee.from,ee.to)==="__error__")return!0}return!1}function we(B){return W(B,H.J_)}function De(B){if(Se(B))return B;const k=Ce(B,H.MD);if(!k)return"";const q=B.substring(k.from,k.to),ee=Ce(B,H.AL),Ve=ee?B.substring(ee.from,ee.to):"";return`${q} ${Ve}`.trim()}function Y(B,k){if(Se(B))return B;const q=Le(B,[H.Yw]).reverse().find(ee=>ee.from<=k&&ee.to>=k);return q?De(B.substring(q.from,q.to)):""}function Qe(B){return W(B,H.bY)}function Me(B){return W(B,H.PN)}function Ye(B){const k=Le(B,[H.Q6]);for(const q of k)if(B.substring(q.from,q.to).match(/\[\$__range(_s|_ms)?/))return!0;return!1}function T(B){return(0,b.yB)(B).map(ee=>B.slice(ee.from,ee.to))}function _(B){return B.filter(q=>!q.hide).filter(q=>!q.refId.includes("do-not-chunk")).filter(q=>q.expr).length>0}const pe=B=>B?"expr"in B&&B.expr!==void 0:!1,ne=B=>{if(!(!B||!pe(B)))return B}},43548:(rt,Ne,h)=>{"use strict";h.d(Ne,{y:()=>d});var N=h(83077),Ee=h(42952);class H{constructor(G,oe){this.categories=[],this.operationsRegistry=new N.O(()=>G),this.innerQueryPlaceholder=oe||"<query>"}setOperationCategories(G){this.categories=G}getOperationsForCategory(G){return this.operationsRegistry.list().filter(oe=>oe.category===G&&!oe.hideFromList)}getAlternativeOperations(G){return this.operationsRegistry.list().filter(oe=>oe.alternativesKey&&oe.alternativesKey===G)}getCategories(){return this.categories}getOperationDefinition(G){return this.operationsRegistry.getIfExists(G)}hasBinaryOp(G){return G.operations.find(oe=>{const ge=this.getOperationDefinition(oe.id);return ge?.category===Ee.T})!==void 0}}var b=h(83657),S=h(54623);class le extends H{constructor(){super(b.sp,"<expr>"),this.setOperationCategories([S.Ln.Aggregations,S.Ln.RangeFunctions,S.Ln.Formats,S.Ln.BinaryOps,S.Ln.LabelFilters,S.Ln.LineFilters])}renderOperations(G,oe){for(const ge of oe){const F=this.operationsRegistry.getIfExists(ge.id);if(!F){console.error(`Could not find operation ${ge.id} in the registry`);continue}G=F.renderer(ge,F,G)}return G}renderBinaryQueries(G,oe){if(oe)for(const ge of oe)G=`${this.renderBinaryQuery(G,ge)}`;return G}renderBinaryQuery(G,oe){let ge=G+` ${oe.operator} `;return oe.vectorMatches&&(ge+=`${oe.vectorMatchesType}(${oe.vectorMatches}) `),ge+this.renderQuery(oe.query,!0)}renderLabels(G){if(G.length===0)return"{}";let oe="{";for(const ge of G)oe!=="{"&&(oe+=", "),oe+=`${ge.label}${ge.op}"${ge.value}"`;return oe+"}"}renderQuery(G,oe){let ge=this.renderLabels(G.labels);return ge=this.renderOperations(ge,G.operations),!oe&&this.hasBinaryOp(G)&&G.binaryQueries?.length&&(ge=`(${ge})`),ge=this.renderBinaryQueries(ge,G.binaryQueries),ge}getQueryPatterns(){return[{name:"Parse log lines with logfmt parser",type:S.IQ.Log,operations:[{id:S.EF.Logfmt,params:[]},{id:S.EF.LabelFilterNoErrors,params:[]}]},{name:"Parse log lines with JSON parser",type:S.IQ.Log,operations:[{id:S.EF.Json,params:[]},{id:S.EF.LabelFilterNoErrors,params:[]}]},{name:"Filter log line and parse with logfmt parser",type:S.IQ.Log,operations:[{id:S.EF.LineContains,params:[""]},{id:S.EF.Logfmt,params:[]},{id:S.EF.LabelFilterNoErrors,params:[]}]},{name:"Filter log lines and parse with json parser",type:S.IQ.Log,operations:[{id:S.EF.LineContains,params:[""]},{id:S.EF.Json,params:[]},{id:S.EF.LabelFilterNoErrors,params:[]}]},{name:"Parse log line with logfmt parser and use label filter",type:S.IQ.Log,operations:[{id:S.EF.LineContains,params:[""]},{id:S.EF.Logfmt,params:[]},{id:S.EF.LabelFilterNoErrors,params:[]},{id:S.EF.LabelFilter,params:["label","=","value"]}]},{name:"Parse log lines with nested json",type:S.IQ.Log,operations:[{id:S.EF.LineContains,params:[""]},{id:S.EF.Json,params:[]},{id:S.EF.LabelFilterNoErrors,params:[]},{id:S.EF.LineFormat,params:["{{.message}}"]},{id:S.EF.Json,params:[]},{id:S.EF.LabelFilterNoErrors,params:[]}]},{name:"Reformat log lines",type:S.IQ.Log,operations:[{id:S.EF.LineContains,params:[""]},{id:S.EF.Logfmt,params:[]},{id:S.EF.LabelFilterNoErrors,params:[]},{id:S.EF.LineFormat,params:["{{.message}}"]}]},{name:"Rename lvl label to level",type:S.IQ.Log,operations:[{id:S.EF.LineContains,params:[""]},{id:S.EF.Logfmt,params:[]},{id:S.EF.LabelFilterNoErrors,params:[]},{id:S.EF.LabelFormat,params:["lvl","level"]}]},{name:"Query on value inside a log line",type:S.IQ.Metric,operations:[{id:S.EF.LineContains,params:[""]},{id:S.EF.Logfmt,params:[]},{id:S.EF.LabelFilterNoErrors,params:[]},{id:S.EF.Unwrap,params:[""]},{id:S.EF.LabelFilterNoErrors,params:[]},{id:S.EF.SumOverTime,params:["$__auto"]},{id:S.EF.Sum,params:[]}]},{name:"Total requests per label of streams",type:S.IQ.Metric,operations:[{id:S.EF.LineContains,params:[""]},{id:S.EF.CountOverTime,params:["$__auto"]},{id:S.EF.Sum,params:[]}]},{name:"Total requests per parsed label or label of streams",type:S.IQ.Metric,operations:[{id:S.EF.LineContains,params:[""]},{id:S.EF.Logfmt,params:[]},{id:S.EF.LabelFilterNoErrors,params:[]},{id:S.EF.CountOverTime,params:["$__auto"]},{id:S.EF.Sum,params:[]}]},{name:"Bytes used by a log stream",type:S.IQ.Metric,operations:[{id:S.EF.LineContains,params:[""]},{id:S.EF.BytesOverTime,params:["$__auto"]}]},{name:"Count of log lines per stream",type:S.IQ.Metric,operations:[{id:S.EF.LineContains,params:[""]},{id:S.EF.CountOverTime,params:["$__auto"]}]},{name:"Top N results by label or parsed label",type:S.IQ.Metric,operations:[{id:S.EF.Logfmt,params:[]},{id:S.EF.LabelFilterNoErrors,params:[]},{id:S.EF.CountOverTime,params:["$__auto"]},{id:S.EF.Sum,params:[]},{id:S.EF.TopK,params:[10]}]},{name:"Extracted quantile",type:S.IQ.Metric,operations:[{id:S.EF.Logfmt,params:[]},{id:S.EF.LabelFilterNoErrors,params:[]},{id:S.EF.Unwrap,params:["latency"]},{id:S.EF.LabelFilterNoErrors,params:[]},{id:S.EF.QuantileOverTime,params:["$__auto",.5]},{id:S.EF.Sum,params:[]}]}]}}const d=new le},58592:(rt,Ne,h)=>{"use strict";h.d(Ne,{C:()=>H,I:()=>b});var N=h(11216),Ee=h(54623);const H=[{id:Ee.EF.Addition,name:"Add scalar",sign:"+"},{id:Ee.EF.Subtraction,name:"Subtract scalar",sign:"-"},{id:Ee.EF.MultiplyBy,name:"Multiply by scalar",sign:"*"},{id:Ee.EF.DivideBy,name:"Divide by scalar",sign:"/"},{id:Ee.EF.Modulo,name:"Modulo by scalar",sign:"%"},{id:Ee.EF.Exponent,name:"Exponent",sign:"^"},{id:Ee.EF.EqualTo,name:"Equal to",sign:"==",comparison:!0},{id:Ee.EF.NotEqualTo,name:"Not equal to",sign:"!=",comparison:!0},{id:Ee.EF.GreaterThan,name:"Greater than",sign:">",comparison:!0},{id:Ee.EF.LessThan,name:"Less than",sign:"<",comparison:!0},{id:Ee.EF.GreaterOrEqual,name:"Greater or equal to",sign:">=",comparison:!0},{id:Ee.EF.LessOrEqual,name:"Less or equal to",sign:"<=",comparison:!0}],b=H.map(le=>{const d=[{name:"Value",type:"number"}];let ce=[2];return le.comparison&&(d.push({name:"Bool",type:"boolean",description:"If checked comparison will return 0 or 1 for the value rather than filtering."}),ce=[2,!1]),{id:le.id,name:le.name,params:d,defaultParams:ce,alternativesKey:"binary scalar operations",category:Ee.Ln.BinaryOps,renderer:S(le.sign),addOperationHandler:N.iZ}});function S(le){return function(ce,G,oe){let ge=ce.params[0],F="";return ce.params.length===2&&(F=ce.params[1]?" bool":""),`${oe} ${le}${F} ${ge}`}}},11216:(rt,Ne,h)=>{"use strict";h.d(Ne,{af:()=>Pe,VR:()=>de,G3:()=>pe,jC:()=>ee,fu:()=>xe,yD:()=>Fe,iZ:()=>_,UF:()=>we,OS:()=>Y,hh:()=>Ce,sn:()=>ye,EP:()=>me});var N=h(2543),Ee=h(55127),H=h.n(Ee),b=h(97535),S=h(71713),le=h(74848),d=h(96540),ce=h(90182);const G=({onChange:P,index:R,operationId:Q,value:V,query:K,datasource:ae,queryModeller:Oe})=>{const[ve,He]=(0,d.useState)({});return(0,le.jsx)(ce.l6,{inputId:Y(Q,R),autoFocus:V==="",openMenuOnFocus:!0,onOpenMenu:async()=>{He({isLoading:!0});const _e=await oe(K,ae,Oe);He({options:_e,isLoading:void 0})},isLoading:ve.isLoading,allowCustomValue:!0,noOptionsMessage:"No labels found",loadingMessage:"Loading labels",options:ve.options,value:ge(V),onChange:_e=>P(R,_e.value)})};async function oe(P,R,Q){let V=P.labels;const K=Q.renderLabels(V);return(await R.languageProvider.fetchLabels({streamSelector:K})).map(Oe=>({label:Oe,value:Oe}))}const ge=P=>({label:P?.toString(),value:P});var F=h(54623);function xe(P,R){const Q=[De()],V=["$__auto"];let K;return P===F.EF.QuantileOverTime&&(V.push("0.95"),Q.push({name:"Quantile",type:"number"})),R&&(Q.push({name:"By label",type:"string",restParam:!0,optional:!0}),K=Qe(`__${P}_by`)),{id:P,name:T(P),params:Q,defaultParams:V,alternativesKey:"range function",category:F.Ln.RangeFunctions,orderRank:F.h5.RangeVectorFunction,renderer:Le,addOperationHandler:Pe,paramChangedHandler:K,explainHandler:(ae,Oe)=>{let ve=S.AW.find(He=>He.insertText===ae.id)?.documentation??"";return ae.params[0]==="$__auto"?`${ve} \`$__auto\` is a variable that will be replaced with the [value of step](https://grafana.com/docs/grafana/next/datasources/loki/query-editor/#options) for range queries and with the value of the selected time range (calculated to - from) for instant queries.`:`${ve} The [range vector](https://grafana.com/docs/loki/latest/logql/metric_queries/#range-vector-aggregation) is set to \`${ae.params[0]}\`.`}}}function Fe(P){const R=xe(P,!0),Q=R.params.slice(0,-1);return[R,{id:`__${P}_by`,name:`${T(P)} by`,params:[...Q,{name:"Label",type:"string",restParam:!0,optional:!0,editor:G}],defaultParams:[...R.defaultParams,""],alternativesKey:"range function with grouping",category:F.Ln.RangeFunctions,renderer:W(P,"by"),paramChangedHandler:Ye(P),explainHandler:Me(P,"by"),addOperationHandler:Pe,hideFromList:!0},{id:`__${P}_without`,name:`${T(P)} without`,params:[...Q,{name:"Label",type:"string",restParam:!0,optional:!0,editor:G}],defaultParams:[...R.defaultParams,""],alternativesKey:"range function with grouping",category:F.Ln.RangeFunctions,renderer:W(P,"without"),paramChangedHandler:Ye(P),explainHandler:Me(P,"without"),addOperationHandler:Pe,hideFromList:!0}]}function W(P,R){return function(V,K,ae){const Oe=K.params.findIndex(_e=>_e.restParam),ve=V.params.slice(0,Oe),He=V.params.slice(Oe);return ve.length===2&&P===F.EF.QuantileOverTime?`${P}(${ve[1]}, ${ae} [${ve[0]}]) ${R} (${He.join(", ")})`:`${P}(${ae} [${ve[0]}]) ${R} (${He.join(", ")})`}}function Le(P,R,Q){const V=P.params??[],K=V[0]??"$__auto";if(V.length===2&&P.id===F.EF.QuantileOverTime){const ae=V[1];return`${P.id}(${ae}, ${Q} [${K}])`}return`${P.id}(${Q} [${V[0]??"$__auto"}])`}function ye(P,R,Q){return["<","<=",">",">="].includes(String(P.params[1]))?`${Q} | ${P.params[0]} ${P.params[1]} ${P.params[2]}`:`${Q} | ${P.params[0]} ${P.params[1]} \`${P.params[2]}\``}function Ce(P,R){if(!P)return!1;const Q=P.params[1].toString().startsWith("!");return R.filter(ae=>ae.id===F.EF.LabelFilter&&ae.params[0]===P.params[0]&&ae.params[2]===P.params[2]).some(ae=>!!(Q&&ae.params[1].toString().startsWith("!")===!1||Q===!1&&ae.params[1].toString().startsWith("!")))}function me(P,R,Q){switch(P.id){case F.EF.Logfmt:const[V=!1,K=!1,...ae]=P.params;return`${Q} | logfmt${V?" --strict":""}${K?" --keep-empty":""} ${ae.filter(Oe=>Oe).join(", ")}`.trim();case F.EF.Json:return`${Q} | json ${P.params.filter(Oe=>Oe).join(", ")}`.trim();case F.EF.Drop:return`${Q} | drop ${P.params.filter(Oe=>Oe).join(", ")}`.trim();case F.EF.Keep:return`${Q} | keep ${P.params.filter(Oe=>Oe).join(", ")}`.trim();default:return`${Q} | ${P.id}`}}function Se(P){return P.category===F.Ln.RangeFunctions}function he(P,R,Q){const V=P.findIndex(K=>{const ae=R.getOperationDefinition(K.id);return ae?Q(ae):!1});return V===-1?P.length:V}function Pe(P,R,Q){const V={id:P.id,params:P.defaultParams},K=[...R.operations],ae=K.find(Oe=>{const ve=Q.getOperationDefinition(Oe.id);return ve?Se(ve):!1});switch(P.category){case F.Ln.Aggregations:case F.Ln.Functions:if(!ae){const ve=he(K,Q,He=>He.category===F.Ln.Functions);K.splice(ve,0,{id:F.EF.Rate,params:["$__auto"]})}K.push(V);break;case F.Ln.RangeFunctions:if(ae){const ve=K.indexOf(ae);K[ve]=V;break}default:const Oe=he(K,Q,ve=>(P.orderRank??100)<(ve.orderRank??100));K.splice(Oe,0,V);break}return{...R,operations:K}}function de(P,R){return{...R,binaryQueries:[...R.binaryQueries??[],{operator:"/",query:R}]}}function we(P,R){return function(V,K,ae){const Oe=V.params.some(_e=>typeof _e=="string"&&_e.includes("`")),ve=Oe?'"':"`";let He;return Oe?He=V.params.map(_e=>typeof _e=="string"?(0,b.Qn)(_e):_e):He=V.params,R?`${ae} ${P} ${ve}(?i)${He.join(`${ve} or ${ve}(?i)`)}${ve}`:`${ae} ${P} ${ve}${He.join(`${ve} or ${ve}`)}${ve}`}}function De(){return{name:"Range",type:"string",options:["$__auto","1m","5m","10m","1h","24h"]}}function Y(P,R){return`operations.${P}.param.${R}`}function Qe(P){return function(Q,V,K){return V.params.length===K.params.length?{...V,id:P}:V}}function Me(P,R){return function(V){const K=V.params.map(Oe=>`\`${Oe}\``).join(" and "),ae=H()("label",V.params.length);switch(R){case"by":return`Calculates ${P} over dimensions while preserving ${ae} ${K}.`;case"without":return`Calculates ${P} over the dimensions ${K}. All other labels are preserved.`;default:return`Calculates ${P} over the dimensions.`}}}function Ye(P){return function(Q,V,K){return V.params.length<K.params.length?{...V,id:P}:V}}function T(P){return(0,N.capitalize)(P.replace(/_/g," "))}function _(P,R){const Q={id:P.id,params:P.defaultParams};return{...R,operations:[...R.operations,Q]}}function pe(P,R={}){return[{id:P,name:T(P),params:[{name:"By label",type:"string",restParam:!0,optional:!0}],defaultParams:[],alternativesKey:"plain aggregations",category:F.Ln.Aggregations,renderer:B,paramChangedHandler:Qe(`__${P}_by`),explainHandler:Me(P,""),addOperationHandler:_,...R},{id:`__${P}_by`,name:`${T(P)} by`,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:G}],defaultParams:[""],alternativesKey:"aggregations by",category:F.Ln.Aggregations,renderer:q(P),paramChangedHandler:Ye(P),explainHandler:Me(P,"by"),addOperationHandler:_,hideFromList:!0,...R},{id:`__${P}_without`,name:`${T(P)} without`,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:G}],defaultParams:[""],alternativesKey:"aggregations by",category:F.Ln.Aggregations,renderer:ne(P),paramChangedHandler:Ye(P),explainHandler:Me(P,"without"),addOperationHandler:_,hideFromList:!0,...R}]}function ne(P){return function(Q,V,K){return`${P} without(${Q.params.join(", ")}) (${K})`}}function B(P,R,Q){const V=k(P,R,Q),K=P.id+"(";return Q&&V.push(Q),K+V.join(", ")+")"}function k(P,R,Q){return(P.params??[]).map((V,K)=>R.params[K].type==="string"?'"'+V+'"':V)}function q(P){return function(Q,V,K){return`${P} by(${Q.params.join(", ")}) (${K})`}}function ee(P,R,Q={}){const V=pe(P,Q);return V[0].params.unshift(...R.params),V[1].params.unshift(...R.params),V[2].params.unshift(...R.params),V[0].defaultParams=R.defaultParams,V[1].defaultParams=[...R.defaultParams,""],V[2].defaultParams=[...R.defaultParams,""],V[1].renderer=Ve(P),V[2].renderer=Ve(P),V}function Ve(P){return function(Q,V,K){const ae=V.params.findIndex(He=>He.restParam),Oe=Q.params.slice(0,ae),ve=Q.params.slice(ae);return`${P} by(${ve.join(", ")}) (${Oe.map((He,_e)=>V.params[_e].type==="string"?`"${He}"`:He).join(", ")}, ${K})`}}},83657:(rt,Ne,h)=>{"use strict";h.d(Ne,{VI:()=>Se,y6:()=>Ce,mD:()=>me,sp:()=>ye});var N=h(58592),Ee=h(74848),H=h(96540),b=h(50877),S=h(43127),le=h(32264),d=h(90182),ce=h(20065),G=h(27724),oe=h(56587),ge=h(75723),F=h(11216);function xe({onChange:he,index:Pe,operationId:de,value:we,query:De,datasource:Y,timeRange:Qe,queryModeller:Me}){const[Ye,T]=(0,H.useState)({});return(0,Ee.jsx)(d.l6,{inputId:(0,F.OS)(de,Pe),onOpenMenu:async()=>{if(Y instanceof G.VQ&&le.$.featureToggles.lokiQueryHints){T({isLoading:!0});const _=await Fe(De,Y,Me,Qe);T({options:_,isLoading:void 0})}},isLoading:Ye.isLoading,allowCustomValue:!0,noOptionsMessage:"No labels found",loadingMessage:"Loading labels",options:Ye.options,value:we?(0,b.z)(we.toString()):null,onChange:_=>{_.value&&he(Pe,_.value)}})}async function Fe(he,Pe,de,we=(0,S.E2)()){const De=de.renderQuery(he),Y=(0,oe.OT)(De);if((0,oe.FV)(Pe.interpolateString(Y,ce.a)))return[];const Qe=await Pe.getDataSamples({expr:Y,refId:"unwrap_samples"},we);return(0,ge.aN)(Qe[0]).map(T=>({label:T,value:T}))}var W=h(54623);function Le(){const he=[W.EF.Sum,W.EF.Min,W.EF.Max,W.EF.Avg,W.EF.Stddev,W.EF.Stdvar,W.EF.Count].flatMap(Y=>(0,F.G3)(Y,{addOperationHandler:F.af,orderRank:W.h5.Last})),Pe=[W.EF.TopK,W.EF.BottomK].flatMap(Y=>(0,F.jC)(Y,{params:[{name:"K-value",type:"number"}],defaultParams:[5]},{addOperationHandler:F.af,orderRank:W.h5.Last})),de=[(0,F.fu)(W.EF.Rate),(0,F.fu)(W.EF.RateCounter),(0,F.fu)(W.EF.CountOverTime),(0,F.fu)(W.EF.SumOverTime),(0,F.fu)(W.EF.BytesRate),(0,F.fu)(W.EF.BytesOverTime),(0,F.fu)(W.EF.AbsentOverTime)],we=[...(0,F.yD)(W.EF.AvgOverTime),...(0,F.yD)(W.EF.MaxOverTime),...(0,F.yD)(W.EF.MinOverTime),...(0,F.yD)(W.EF.FirstOverTime),...(0,F.yD)(W.EF.LastOverTime),...(0,F.yD)(W.EF.StdvarOverTime),...(0,F.yD)(W.EF.StddevOverTime),...(0,F.yD)(W.EF.QuantileOverTime)];return[...he,...Pe,...de,...we,{id:W.EF.Json,name:"Json",params:[{name:"Expression",type:"string",restParam:!0,optional:!0,minWidth:18,placeholder:'server="servers[0]"',description:"Using expressions with your json parser will extract only the specified json fields to labels. You can specify one or more expressions in this way. All expressions must be quoted."}],defaultParams:[],alternativesKey:"format",category:W.Ln.Formats,orderRank:W.h5.Parsers,renderer:F.EP,addOperationHandler:F.af,explainHandler:()=>"This will extract keys and values from a [json](https://grafana.com/docs/loki/latest/logql/log_queries/#json) formatted log line as labels. The extracted labels can be used in label filter expressions and used as values for a range aggregation via the unwrap operation."},{id:W.EF.Logfmt,name:"Logfmt",params:[{name:"Strict",type:"boolean",optional:!0,description:"With strict parsing enabled, the logfmt parser immediately stops scanning the log line and returns early with an error when it encounters any poorly formatted key/value pair."},{name:"Keep empty",type:"boolean",optional:!0,description:"The logfmt parser retains standalone keys (keys without a value) as labels with its value set to empty string. "},{name:"Expression",type:"string",optional:!0,restParam:!0,minWidth:18,placeholder:"field_name",description:"Using expressions with your logfmt parser will extract and rename (if provided) only the specified fields to labels. You can specify one or more expressions in this way."}],defaultParams:[!1,!1],alternativesKey:"format",category:W.Ln.Formats,orderRank:W.h5.Parsers,renderer:F.EP,addOperationHandler:F.af,explainHandler:()=>"This will extract all keys and values from a [logfmt](https://grafana.com/docs/loki/latest/logql/log_queries/#logfmt) formatted log line as labels. The extracted labels can be used in label filter expressions and used as values for a range aggregation via the unwrap operation."},{id:W.EF.Regexp,name:"Regexp",params:[{name:"String",type:"string",hideName:!0,placeholder:"<re>",description:"The regexp expression that matches the structure of a log line.",minWidth:20}],defaultParams:[""],alternativesKey:"format",category:W.Ln.Formats,orderRank:W.h5.Parsers,renderer:(Y,Qe,Me)=>`${Me} | regexp \`${Y.params[0]}\``,addOperationHandler:F.af,explainHandler:()=>'The [regexp parser](https://grafana.com/docs/loki/latest/logql/log_queries/#regular-expression) takes a single parameter | regexp "<re>" which is the regular expression using the Golang RE2 syntax. The regular expression must contain a least one named sub-match (e.g (?P<name>re)), each sub-match will extract a different label. The expression matches the structure of a log line. The extracted labels can be used in label filter expressions and used as values for a range aggregation via the unwrap operation.'},{id:W.EF.Pattern,name:"Pattern",params:[{name:"String",type:"string",hideName:!0,placeholder:"<pattern-expression>",description:"The expression that matches the structure of a log line.",minWidth:20}],defaultParams:[""],alternativesKey:"format",category:W.Ln.Formats,orderRank:W.h5.Parsers,renderer:(Y,Qe,Me)=>`${Me} | pattern \`${Y.params[0]}\``,addOperationHandler:F.af,explainHandler:()=>"The [pattern parser](https://grafana.com/docs/loki/latest/logql/log_queries/#pattern) allows the explicit extraction of fields from log lines by defining a pattern expression (| pattern `<pattern-expression>`). The expression matches the structure of a log line. The extracted labels can be used in label filter expressions and used as values for a range aggregation via the unwrap operation."},{id:W.EF.Unpack,name:"Unpack",params:[],defaultParams:[],alternativesKey:"format",category:W.Ln.Formats,orderRank:W.h5.Parsers,renderer:F.EP,addOperationHandler:F.af,explainHandler:()=>"This will extract all keys and values from a JSON log line, [unpacking](https://grafana.com/docs/loki/latest/logql/log_queries/#unpack) all embedded labels in the pack stage. The extracted labels can be used in label filter expressions and used as values for a range aggregation via the unwrap operation."},{id:W.EF.LineFormat,name:"Line format",params:[{name:"String",type:"string",hideName:!0,placeholder:"{{.status_code}}",description:"A line template that can refer to stream labels and extracted labels.",minWidth:20}],defaultParams:[""],alternativesKey:"format",category:W.Ln.Formats,orderRank:W.h5.PipeOperations,renderer:(Y,Qe,Me)=>`${Me} | line_format \`${Y.params[0]}\``,addOperationHandler:F.af,explainHandler:()=>`This will replace log line using a specified template. The template can refer to stream labels and extracted labels.

Example: \`{{.status_code}} - {{.message}}\`

[Read the docs](https://grafana.com/docs/loki/latest/logql/log_queries/#line-format-expression) for more.
        `},{id:W.EF.LabelFormat,name:"Label format",params:[{name:"Label",type:"string"},{name:"Rename to",type:"string"}],defaultParams:["",""],alternativesKey:"format",category:W.Ln.Formats,orderRank:W.h5.PipeOperations,renderer:(Y,Qe,Me)=>`${Me} | label_format ${Y.params[1]}=${Y.params[0]}`,addOperationHandler:F.af,explainHandler:()=>'This will change name of label to desired new label. In the example below, label "error_level" will be renamed to "level".\n\nExample: ``error_level=`level` ``\n\n[Read the docs](https://grafana.com/docs/loki/latest/logql/log_queries/#labels-format-expression) for more.\n        '},{id:W.EF.LineContains,name:"Line contains",params:[{name:"",type:"string",hideName:!0,restParam:!0,placeholder:"Text to find",description:"Find log lines that contains this text",minWidth:20,runQueryOnEnter:!0}],defaultParams:[""],alternativesKey:"line filter",category:W.Ln.LineFilters,orderRank:W.h5.LineFilters,renderer:(0,F.UF)("|="),addOperationHandler:F.af,explainHandler:Y=>`Return log lines that contain string \`${Y.params?.join("`, or `")}\`.`},{id:W.EF.LineContainsNot,name:"Line does not contain",params:[{name:"",type:"string",hideName:!0,restParam:!0,placeholder:"Text to exclude",description:"Find log lines that does not contain this text",minWidth:26,runQueryOnEnter:!0}],defaultParams:[""],alternativesKey:"line filter",category:W.Ln.LineFilters,orderRank:W.h5.LineFilters,renderer:(0,F.UF)("!="),addOperationHandler:F.af,explainHandler:Y=>`Return log lines that does not contain string \`${Y.params?.join("`, or `")}\`.`},{id:W.EF.LineContainsCaseInsensitive,name:"Line contains case insensitive",params:[{name:"",type:"string",hideName:!0,restParam:!0,placeholder:"Text to find",description:"Find log lines that contains this text",minWidth:33,runQueryOnEnter:!0}],defaultParams:[""],alternativesKey:"line filter",category:W.Ln.LineFilters,orderRank:W.h5.LineFilters,renderer:(0,F.UF)("|~",!0),addOperationHandler:F.af,explainHandler:Y=>`Return log lines that match regex \`(?i)${Y.params?.join("`, or `(?i)")}\`.`},{id:W.EF.LineContainsNotCaseInsensitive,name:"Line does not contain case insensitive",params:[{name:"",type:"string",hideName:!0,restParam:!0,placeholder:"Text to exclude",description:"Find log lines that does not contain this text",minWidth:40,runQueryOnEnter:!0}],defaultParams:[""],alternativesKey:"line filter",category:W.Ln.LineFilters,orderRank:W.h5.LineFilters,renderer:(0,F.UF)("!~",!0),addOperationHandler:F.af,explainHandler:Y=>`Return log lines that does not match regex \`(?i)${Y.params?.join("`, or `(?i)")}\`.`},{id:W.EF.LineMatchesRegex,name:"Line contains regex match",params:[{name:"",type:"string",hideName:!0,restParam:!0,placeholder:"Pattern to match",description:"Find log lines that match this regex pattern",minWidth:30,runQueryOnEnter:!0}],defaultParams:[""],alternativesKey:"line filter",category:W.Ln.LineFilters,orderRank:W.h5.LineFilters,renderer:(0,F.UF)("|~"),addOperationHandler:F.af,explainHandler:Y=>`Return log lines that match a \`RE2\` regex pattern. \`${Y.params?.join("`, or `")}\`.`},{id:W.EF.LineMatchesRegexNot,name:"Line does not match regex",params:[{name:"",type:"string",hideName:!0,restParam:!0,placeholder:"Pattern to exclude",description:"Find log lines that does not match this regex pattern",minWidth:30,runQueryOnEnter:!0}],defaultParams:[""],alternativesKey:"line filter",category:W.Ln.LineFilters,orderRank:W.h5.LineFilters,renderer:(0,F.UF)("!~"),addOperationHandler:F.af,explainHandler:Y=>`Return log lines that doesn't match a \`RE2\` regex pattern. \`${Y.params?.join("`, or `")}\`.`},{id:W.EF.LineFilterIpMatches,name:"IP line filter expression",params:[{name:"Operator",type:"string",minWidth:16,options:[W.NS.contains,W.NS.doesNotContain]},{name:"Pattern",type:"string",placeholder:"<pattern>",minWidth:16,runQueryOnEnter:!0}],defaultParams:["|=",""],alternativesKey:"line filter",category:W.Ln.LineFilters,orderRank:W.h5.LineFilters,renderer:(Y,Qe,Me)=>`${Me} ${Y.params[0]} ip(\`${Y.params[1]}\`)`,addOperationHandler:F.af,explainHandler:Y=>`Return log lines using IP matching of \`${Y.params[1]}\``},{id:W.EF.LabelFilter,name:"Label filter expression",params:[{name:"Label",type:"string",minWidth:14},{name:"Operator",type:"string",minWidth:14,options:[W.NS.equals,W.NS.doesNotEqual,W.NS.matchesRegex,W.NS.doesNotMatchRegex,W.NS.greaterThan,W.NS.lessThan,W.NS.greaterThanOrEqual,W.NS.lessThanOrEqual]},{name:"Value",type:"string",minWidth:14}],defaultParams:["","=",""],alternativesKey:"label filter",category:W.Ln.LabelFilters,orderRank:W.h5.PipeOperations,renderer:F.sn,addOperationHandler:F.af,explainHandler:()=>"Label expression filter allows filtering using original and extracted labels."},{id:W.EF.LabelFilterIpMatches,name:"IP label filter expression",params:[{name:"Label",type:"string",minWidth:14},{name:"Operator",type:"string",minWidth:14,options:[W.NS.equals,W.NS.doesNotEqual]},{name:"Value",type:"string",minWidth:14}],defaultParams:["","=",""],alternativesKey:"label filter",category:W.Ln.LabelFilters,orderRank:W.h5.PipeOperations,renderer:(Y,Qe,Me)=>`${Me} | ${Y.params[0]} ${Y.params[1]} ip(\`${Y.params[2]}\`)`,addOperationHandler:F.af,explainHandler:Y=>`Return log lines using IP matching of \`${Y.params[2]}\` for \`${Y.params[0]}\` label`},{id:W.EF.LabelFilterNoErrors,name:"No pipeline errors",params:[],defaultParams:[],alternativesKey:"label filter",category:W.Ln.LabelFilters,orderRank:W.h5.NoErrors,renderer:(Y,Qe,Me)=>`${Me} | __error__=\`\``,addOperationHandler:F.af,explainHandler:()=>"Filter out all formatting and parsing errors."},{id:W.EF.Unwrap,name:"Unwrap",params:[{name:"Identifier",type:"string",hideName:!0,minWidth:16,placeholder:"Label key",editor:xe},{name:"Conversion function",hideName:!0,type:"string",options:["duration","duration_seconds","bytes"],optional:!0}],defaultParams:["",""],alternativesKey:"format",category:W.Ln.Formats,orderRank:W.h5.Unwrap,renderer:(Y,Qe,Me)=>`${Me} | unwrap ${Y.params[1]?`${Y.params[1]}(${Y.params[0]})`:Y.params[0]}`,addOperationHandler:F.af,explainHandler:Y=>{let Qe=String(Y.params[0]).length>0?Y.params[0]:"<label>";return`Use the extracted label \`${Qe}\` as sample values instead of log lines for the subsequent range aggregation.${Y.params[1]?` Conversion function \`${Y.params[1]}\` wrapping \`${Qe}\` will attempt to convert this label from a specific format (e.g. 3k, 500ms).`:""}`}},{id:W.EF.Decolorize,name:"Decolorize",params:[],defaultParams:[],alternativesKey:"format",category:W.Ln.Formats,orderRank:W.h5.PipeOperations,renderer:(Y,Qe,Me)=>`${Me} | decolorize`,addOperationHandler:F.af,explainHandler:()=>"This will remove ANSI color codes from log lines."},{id:W.EF.Drop,name:"Drop",params:[{name:"Label",type:"string",restParam:!0,optional:!0,minWidth:18,placeholder:'job="grafana"',description:"Specify labels or expressions to drop."}],defaultParams:[""],alternativesKey:"format",category:W.Ln.Formats,orderRank:W.h5.PipeOperations,renderer:F.EP,addOperationHandler:F.af,explainHandler:()=>"The drop expression will drop the given labels in the pipeline."},{id:W.EF.Keep,name:"Keep",params:[{name:"Label",type:"string",restParam:!0,optional:!0,minWidth:18,placeholder:'job="grafana"',description:"Specify labels or expressions to keep."}],defaultParams:[""],alternativesKey:"format",category:W.Ln.Formats,orderRank:W.h5.PipeOperations,renderer:F.EP,addOperationHandler:F.af,explainHandler:()=>"The keep expression will keep only the specified labels in the pipeline and drop all the other labels."},...N.I,{id:W.EF.NestedQuery,name:"Binary operation with query",params:[],defaultParams:[],category:W.Ln.BinaryOps,renderer:(Y,Qe,Me)=>Me,addOperationHandler:F.VR}]}const ye=Le();function Ce(he){return(ye.find(we=>we.id===he)?.explainHandler?.({id:"",params:["<value>"]})||"").replace(/\[(.*)\]\(.*\)/g,"$1")}function me(he){return ye.find(Pe=>Pe.id===he)}function Se(he,Pe){return!(Pe.length<he.params.filter(de=>!de.optional).length)}},60706:(rt,Ne,h)=>{"use strict";h.d(Ne,{u_:()=>le,w4:()=>we});var N=h(36195),Ee=h(58592),H=h(83657),b=h(56245),S=h(54623);function le(T){const _=(0,b.qk)(T),ne=N.K3.parse(_).topNode,k={query:{labels:[],operations:[]},errors:[]};try{d(_,ne,k)}catch(q){console.error(q),q instanceof Error&&k.errors.push({text:q.message})}return Qe(k.query)&&(k.errors=[]),k}function d(T,_,pe){const ne=pe.query;switch(_.type.id){case N.g$:{ne.labels.push(ce(T,_));const B=_.getChild(b.Ql);B&&pe.errors.push((0,b.xz)(T,B));break}case N.PN:{const{operation:B,error:k}=G(T,_);B&&ne.operations.push(B),k&&pe.errors.push(Y(T,_,k));break}case N.iT:{ne.operations.push(oe(T,_));break}case N.bY:{const{operation:B,error:k}=xe(T,_);B&&ne.operations.push(B),k&&pe.errors.push(Y(T,_,k));break}case N.eF:{ne.operations.push(ge(T,_));break}case N.Zj:case N.Tz:{const{operation:B,error:k}=F(T,_);B&&ne.operations.push(B),k&&pe.errors.push(Y(T,_,k));break}case N.pH:{ne.operations.push(Fe(T,_));break}case N.e_:{ne.operations.push(W(T,_));break}case N.HV:{const{operation:B,error:k}=ye(T,_,pe);B&&ne.operations.push(B),k&&pe.errors.push(Y(T,_,k));break}case N.Zg:{ne.operations.push(Le());break}case N.h1:{ne.operations.push(Ce(T,_,pe));break}case N.Rh:{ne.operations.push(me(T,_,pe));break}case N.MK:{he(T,_,pe);break}case b.Ql:{if(de(_))break;pe.errors.push((0,b.xz)(T,_));break}case N.i8:{ne.operations.push(Me(T,_,pe));break}case N.UP:{ne.operations.push(Ye(T,_,pe));break}default:{let B=_.firstChild;for(;B;)d(T,B,pe),B=B.nextSibling}}}function ce(T,_){const pe=_.getChild(N.gw),ne=(0,b.AA)(T,pe),B=(0,b.AA)(T,pe?.nextSibling);let k=(0,b.AA)(T,_.getChild(N.Qf));return k=k.substring(1,k.length-1),{label:ne,op:B,value:k}}function G(T,_){const pe=(0,b.AA)(T,_.getChild(N.dJ)),ne=we((0,b.AA)(T,_.getChild(N.Qf)));if(_.getChild(N.w7)?.getChild(N.Ip))return{operation:{id:S.EF.LineFilterIpMatches,params:[pe,ne]}};const k=[ne];let q=_.getChild(N.ih);for(;q;)k.push(we((0,b.AA)(T,q.getChild(N.Qf)))),q=q.getChild(N.ih);return{operation:{id:{"|=":S.EF.LineContains,"!=":S.EF.LineContainsNot,"|~":S.EF.LineMatchesRegex,"!~":S.EF.LineMatchesRegexNot}[pe],params:k}}}function oe(T,_){const pe=_.firstChild,ne=(0,b.AA)(T,pe),B=we((0,b.AA)(T,_.getChild(N.Qf)));let k=B?[B]:[];const q=(0,H.mD)(ne);return q&&!(0,H.VI)(q,k)&&(k=q?.defaultParams||[]),{id:ne,params:k}}function ge(T,_){const pe=_.getChild(N.LM),ne=(0,b.AA)(T,pe),B=[...(0,b.R1)(T,_,N.Gn)];return{id:ne,params:B}}function F(T,_){const pe=[],ne=[];let B;const k=_.from;return _.toTree().iterate({enter:ee=>{ee.type.id===N.ov?pe.push(T.substring(ee.from+k,ee.to+k)):ee.type.id===N.Gn?ne.push(T.substring(ee.from+k,ee.to+k)):ee.type.id===b.Ql&&(B=`Unexpected string "${T.substring(ee.from+k,ee.to+k)}"`)}}),{operation:{id:S.EF.Logfmt,params:[pe.includes("--strict"),pe.includes("--keep-empty"),...ne]},error:B}}function xe(T,_){if(_.getChild(N.Or)||_.getChild(N.KD)||_.getChild("Comma"))return{error:'Label filter with comma, "and", "or" not supported in query builder'};if(_.firstChild.type.id===N.GA){const Ve=_.firstChild,P=Ve?.getChild(N.gw),R=P?.nextSibling,Q=Ve?.getChild(N.Qf),V=we((0,b.AA)(T,Q));return{operation:{id:S.EF.LabelFilterIpMatches,params:[(0,b.AA)(T,P),(0,b.AA)(T,R),V]}}}const pe=S.EF.LabelFilter;if(_.firstChild.type.id===N.Jq){const P=_.firstChild.firstChild.firstChild,R=P.nextSibling,Q=R.nextSibling,V=we((0,b.AA)(T,Q));return{operation:{id:pe,params:[(0,b.AA)(T,P),(0,b.AA)(T,R),V]}}}const B=_.firstChild.firstChild,k=B.nextSibling,q=k.nextSibling,ee=[(0,b.AA)(T,B),(0,b.AA)(T,k),we((0,b.AA)(T,q))];return ee.join("")==="__error__="?{operation:{id:S.EF.LabelFilterNoErrors,params:[]}}:{operation:{id:pe,params:ee}}}function Fe(T,_){const pe=S.EF.LineFormat,ne=we((0,b.AA)(T,_.getChild(N.Qf)));return{id:pe,params:[ne]}}function W(T,_){const pe=S.EF.LabelFormat,ne=_.getChild(N.gw),k=ne.nextSibling.nextSibling;return{id:pe,params:[(0,b.AA)(T,k),we((0,b.AA)(T,ne))]}}function Le(){return{id:S.EF.Decolorize,params:[]}}function ye(T,_,pe){const ne=_.getChild(N.HV),B=_.getChild(N.bY),k=_.getChild(N.sK);if(ne&&d(T,ne,pe),B&&d(T,B,pe),k){if(k.nextSibling?.type.id===N.yW){const q=k.nextSibling,ee=q.nextSibling;return{operation:{id:S.EF.Unwrap,params:[(0,b.AA)(T,ee),(0,b.AA)(T,q)]}}}return{operation:{id:S.EF.Unwrap,params:[(0,b.AA)(T,k?.nextSibling),""]}}}return{}}function Ce(T,_,pe){const ne=_.getChild(N.lo),B=(0,b.AA)(T,ne),k=_.getChild(N.wN),q=_.getChild(N.xo),ee=k!=null?[(0,b.AA)(T,k)]:[],Ve=q?.getChild(N.Q6),P=Ve?(0,b.AA)(T,Ve):null,R=_.getChild(N.aU);P&&ee.unshift(P.substring(1,P.length-1)),R&&ee.push(...(0,b.R1)(T,R,N.gw));const Q={id:B,params:ee};return q&&d(T,q,pe),Q}function me(T,_,pe){const ne=_.getChild(N.ZQ);let B=(0,b.AA)(T,ne);const k=_.getChild(N.aU),q=[],ee=_.getChild(N.wN);ee&&q.push(Number((0,b.AA)(T,ee))),k&&(k.getChild(N.By)&&B&&(B=`__${B}_by`),k.getChild(N.xB)&&(B=`__${B}_without`),q.push(...(0,b.R1)(T,k,N.gw)));const Ve=_.getChild(N.Yw),P={id:B,params:q};return Ve&&(Ve.firstChild?.type.id===N.MK&&pe.errors.push({text:"Query parsing is ambiguous.",from:Ve.firstChild.from,to:Ve.firstChild?.to}),d(T,Ve,pe)),P}const Se=Ee.C.reduce((T,_)=>(T[_.sign]={id:_.id,comparison:_.comparison},T),{});function he(T,_,pe){const ne=pe.query,B=_.firstChild,k=(0,b.AA)(T,B.nextSibling),q=Pe(T,_.getChild(N.o5)),ee=_.lastChild,Ve=Se[k],P=De(B,"MetricExpr.LiteralExpr.Number"),R=De(ee,"MetricExpr.LiteralExpr.Number"),Q=ee.getChild(N.MK);if(P||d(T,B,pe),R)ne.operations.push((0,b.rq)(Ve,T,ee,!!q?.isBool));else if(Q){const V=(0,b.z9)(ee);V?.type.id===N.wN&&ne.operations.push((0,b.rq)(Ve,T,V,!!q?.isBool)),d(T,ee,pe)}else{ne.binaryQueries=ne.binaryQueries||[];const V={operator:k,query:{labels:[],operations:[]}};q?.isMatcher&&(V.vectorMatchesType=q.matchType,V.vectorMatches=q.matches),ne.binaryQueries.push(V),d(T,ee,{query:V.query,errors:pe.errors})}}function Pe(T,_){if(!_)return;const pe=_.getChild(N.wT),ne=_.getChild(N.x);if(!pe&&ne)return{isBool:!0,isMatcher:!1};{if(!pe)return;const B=(0,b.AA)(T,pe.getChild(N.x$)?.getChild(N.qJ));return{isMatcher:!0,isBool:!!ne,matches:B,matchType:pe.getChild(N.On)?"on":"ignoring"}}}function de(T){return T?.parent?.type.id===N.Q6}function we(T){return T[0]==='"'&&T[T.length-1]==='"'?T.substring(1,T.length-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"):T.replace(/`/g,"")}function De(T,_){let pe=T;const ne=_.split(".");for(const B of ne)if(pe=pe.getChild(B),!pe)return null;return pe}function Y(T,_,pe){const ne=(0,b.xz)(T,_);return ne.text=`${pe}: ${ne.text}`,ne}function Qe(T){return T.labels.length===0&&T.operations.length===0}function Me(T,_,pe){const ne=[];let B=_.getChild(N.LQ);for(;B;){const k=(0,b.AA)(T,B.getChild(N.yj));k&&ne.push(k),B=B?.getChild(N.LQ)}return ne.reverse(),{id:S.EF.Drop,params:ne}}function Ye(T,_,pe){const ne=[];let B=_.getChild(N.J3);for(;B;){const k=(0,b.AA)(T,B.getChild(N.UM));k&&ne.push(k),B=B?.getChild(N.J3)}return ne.reverse(),{id:S.EF.Keep,params:ne}}},56245:(rt,Ne,h)=>{"use strict";h.d(Ne,{AA:()=>ce,If:()=>d,Ql:()=>N,R1:()=>oe,SY:()=>b,qk:()=>S,rq:()=>G,xz:()=>H,z9:()=>Ee});const N=0;function Ee(F){return F.firstChild?Ee(F.firstChild):F}function H(F,xe){return{text:ce(F,xe),from:xe.from,to:xe.to,parentType:xe.parent?.name}}const b=/\$(\w+)|\[\[([\s\S]+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g;function S(F){return F.replace(b,(xe,Fe,W,Le,ye,Ce,me)=>{const Se=Le||me;let he=Fe,Pe="0";return W&&(he=W,Pe="1"),ye&&(he=ye,Pe="2"),`__V_${Pe}__`+he+"__V__"+(Se?"__F__"+Se+"__F__":"")})}const le=[(F,xe)=>`$${F}`,(F,xe)=>`[[${F}${xe?`:${xe}`:""}]]`,(F,xe)=>`\${${F}${xe?`:${xe}`:""}}`];function d(F){return F.replace(/__V_(\d)__(.+?)__V__(?:__F__(\w+)__F__)?/g,(xe,Fe,W,Le)=>le[parseInt(Fe,10)](W,Le))}function ce(F,xe){return xe?d(F.substring(xe.from,xe.to)):""}function G(F,xe,Fe,W){const Le=[parseFloat(ce(xe,Fe))];return F.comparison&&Le.push(W),{id:F.id,params:Le}}function oe(F,xe,Fe){if(xe.type.id===Fe||xe.name===Fe)return[ce(F,xe)];const W=[];let Le=0,ye=xe.childAfter(Le);for(;ye;)W.push(...oe(F,ye,Fe)),Le=ye.to,ye=xe.childAfter(Le);return W}const ge=F=>F.split(" ").map(Fe=>`${Fe}.*`).join("")},54623:(rt,Ne,h)=>{"use strict";h.d(Ne,{EF:()=>b,IQ:()=>Ee,Ln:()=>H,NS:()=>le,h5:()=>S});var N=h(42952),Ee=(d=>(d.Log="log",d.Metric="metric",d))(Ee||{}),H=(d=>(d.Aggregations="Aggregations",d.RangeFunctions="Range functions",d.Functions="Functions",d.Formats="Formats",d.LineFilters="Line filters",d.LabelFilters="Label filters",d[d.BinaryOps=N.T]="BinaryOps",d))(H||{}),b=(d=>(d.Json="json",d.Logfmt="logfmt",d.Regexp="regexp",d.Pattern="pattern",d.Unpack="unpack",d.LineFormat="line_format",d.LabelFormat="label_format",d.Decolorize="decolorize",d.Drop="drop",d.Keep="keep",d.Rate="rate",d.RateCounter="rate_counter",d.CountOverTime="count_over_time",d.SumOverTime="sum_over_time",d.AvgOverTime="avg_over_time",d.MaxOverTime="max_over_time",d.MinOverTime="min_over_time",d.FirstOverTime="first_over_time",d.LastOverTime="last_over_time",d.StdvarOverTime="stdvar_over_time",d.StddevOverTime="stddev_over_time",d.QuantileOverTime="quantile_over_time",d.BytesRate="bytes_rate",d.BytesOverTime="bytes_over_time",d.AbsentOverTime="absent_over_time",d.Sum="sum",d.Avg="avg",d.Min="min",d.Max="max",d.Stddev="stddev",d.Stdvar="stdvar",d.Count="count",d.TopK="topk",d.BottomK="bottomk",d.LineContains="__line_contains",d.LineContainsNot="__line_contains_not",d.LineContainsCaseInsensitive="__line_contains_case_insensitive",d.LineContainsNotCaseInsensitive="__line_contains_not_case_insensitive",d.LineMatchesRegex="__line_matches_regex",d.LineMatchesRegexNot="__line_matches_regex_not",d.LineFilterIpMatches="__line_filter_ip_matches",d.LabelFilter="__label_filter",d.LabelFilterNoErrors="__label_filter_no_errors",d.LabelFilterIpMatches="__label_filter_ip_marches",d.Unwrap="unwrap",d.SumBy="__sum_by",d.SumWithout="__sum_without",d.Addition="__addition",d.Subtraction="__subtraction",d.MultiplyBy="__multiply_by",d.DivideBy="__divide_by",d.Modulo="__modulo",d.Exponent="__exponent",d.NestedQuery="__nested_query",d.EqualTo="__equal_to",d.NotEqualTo="__not_equal_to",d.GreaterThan="__greater_than",d.LessThan="__less_than",d.GreaterOrEqual="__greater_or_equal",d.LessOrEqual="__less_or_equal",d))(b||{}),S=(d=>(d[d.LineFilters=1]="LineFilters",d[d.Parsers=2]="Parsers",d[d.PipeOperations=3]="PipeOperations",d[d.Unwrap=4]="Unwrap",d[d.NoErrors=5]="NoErrors",d[d.RangeVectorFunction=5]="RangeVectorFunction",d[d.Last=6]="Last",d))(S||{});const le={equals:{label:"=",value:"=",description:"Equals",isMultiValue:!1},doesNotEqual:{label:"!=",value:"!=",description:"Does not equal",isMultiValue:!1},matchesRegex:{label:"=~",value:"=~",description:"Matches regex",isMultiValue:!0},doesNotMatchRegex:{label:"!~",value:"!~",description:"Does not match regex",isMultiValue:!0},greaterThan:{label:">",value:">",description:"Greater than",isMultiValue:!1},greaterThanOrEqual:{label:">=",value:">=",description:"Greater than or equal to",isMultiValue:!1},lessThan:{label:"<",value:"<",description:"Less than",isMultiValue:!1},lessThanOrEqual:{label:"<=",value:"<=",description:"Less than or equal to",isMultiValue:!1},contains:{label:"|=",value:"|=",description:"Contains",isMultiValue:!1},doesNotContain:{label:"!=",value:"!=",description:"Does not contain",isMultiValue:!1}}},75723:(rt,Ne,h)=>{"use strict";h.d(Ne,{Ac:()=>oe,nE:()=>G,db:()=>Fe,fV:()=>F,sz:()=>W,YB:()=>ge,aN:()=>xe});var N=h(11261),Ee=h(70416),H=h(97535);function b(Le){let ye;try{ye=JSON.parse(Le)}catch{}return typeof ye=="object"}const S=/(?:^|\s)([\w\(\)\[\]\{\}]+)=(""|(?:".*?[^\\]"|[^"\s]\S*))/;function le(Le){return S.test(Le)}function d(Le){let ye;try{return ye=JSON.parse(Le),ye.hasOwnProperty("_entry")}catch{return!1}}var ce=h(13137);function G(Le){return(Le.fields.find(Ce=>Ce.name==="labels")?.values??[]).some(Ce=>Ce.__error__!==void 0)}function oe(Le){return(Le.fields.find(Ce=>Ce.name==="labels")?.values??[]).some(Ce=>Ce.level!==void 0)}function ge(Le){const ye=Le.fields.find(Pe=>Pe.type===N.PU.string);if(ye==null)return{hasJSON:!1,hasLogfmt:!1,hasPack:!1};const Ce=ye.values;let me=!1,Se=!1,he=!1;return Ce.forEach(Pe=>{b(Pe)&&(me=!0,he=d(Pe)),le(Pe)&&(Se=!0)}),{hasLogfmt:Se,hasJSON:me,hasPack:he}}function F(Le,ye=ce.HD.Indexed){const Ce=Le?.fields?.find(he=>he.name==="labels")?.values??[],me=Le?.fields?.find(he=>he.name==="labelTypes")?.values??[];if(!Ce?.length)return[];if(!me?.length){if(ye===ce.HD.Indexed){const{keys:he}=(0,H.P7)(Ce);return he}return[]}let Se=new Set;for(let he=0;he<Ce.length;he++){const Pe=Ce[he],de=me[he],we=Object.keys(Pe).filter(De=>de[De]===ye);Se=new Set([...Se,...we])}return Array.from(Se)}function xe(Le){const ye=Le?.fields?.find(me=>me.name==="labels")?.values??[];return ye?.length?Object.keys(ye[0]).filter(me=>{const Se=ye[0][me];return Se?!isNaN(Number(Se))||(0,Ee.pp)(Se)||(0,H.tY)(Se):!1}).filter(me=>ye.every(Se=>Se[me])):[]}function Fe(Le){const ye=Le.fields.find(me=>me.name==="labels"&&me.type===N.PU.other);return ye==null?!1:ye.values.some(me=>me.__error__)}function W(Le){const ye=Le.fields.find(Se=>Se.name==="labels"&&Se.type===N.PU.other);if(ye==null)return null;const Ce=ye.values.slice(0,2);let me=null;for(let Se of Ce){const he=Object.keys(Se).find(Pe=>Pe==="lvl"||Pe.includes("level"));if(he){me=he;break}}return me}},79007:(rt,Ne,h)=>{"use strict";h.d(Ne,{Ex:()=>ye,jg:()=>oe,uJ:()=>Ce});var N=h(41987),Ee=h(42952),H=h(14110),b=h(32264),S=h(27724),le=h(51814),d=h(56587),ce=h(56245),G=h(13137);const oe=({payload:{dashboardId:me,orgId:Se,grafanaVersion:he,queries:Pe}})=>{try{const de=Pe[le.id]?.filter(k=>!k.hide)?.map(k=>(0,d.vV)(k));if(!de?.length)return;const we=de.filter(k=>(0,d.sI)(k.expr)),De=de.filter(k=>!(0,d.sI)(k.expr)),Y=de.filter(k=>k.queryType===G.U3.Instant),Qe=de.filter(k=>k.queryType===G.U3.Range),Me=de.filter(k=>k.editorMode===Ee.f.Builder),Ye=de.filter(k=>k.editorMode===Ee.f.Code),T=de.filter(ge),_=de.filter(F),pe=de.filter(xe),ne=de.filter(Fe),B={grafana_version:he,dashboard_id:me,org_id:Se,queries_count:de.length,logs_queries_count:we.length,metric_queries_count:De.length,instant_queries_count:Y.length,range_queries_count:Qe.length,builder_mode_queries_count:Me.length,code_mode_queries_count:Ye.length,queries_with_template_variables_count:T.length,queries_with_changed_resolution_count:_.length,queries_with_changed_line_limit_count:pe.length,queries_with_changed_legend_count:ne.length};(0,H.rR)("grafana_loki_dashboard_loaded",B)}catch(de){console.error("error in loki tracking handler",de)}},ge=me=>ce.SY.test(me.expr),F=me=>me.resolution?me.resolution!==1:!1,xe=me=>me.maxLines!==null&&me.maxLines!==void 0,Fe=me=>me.legendFormat?me.legendFormat!=="":!1,W=me=>!![S.Gf,S.M1,S.mL,S.ow,S.lb].some(he=>me.startsWith(he)),Le=me=>{let Se=0;for(const he of me.data){const Pe=he.meta?.custom?.lokiQueryStatKey;Pe&&(Se+=he.meta?.stats?.find(de=>de.displayName===Pe)?.value??0)}return Se};function ye(me,Se,he,Pe={},de={}){const{app:we,targets:De}=Se;if(we!==N.Jk.Explore)return;let Y=Le(me);for(const Qe of De){if(W(Qe.refId))return;(0,H.rR)("grafana_explore_loki_query_executed",{grafana_version:b.$.buildInfo.version,editor_mode:Qe.editorMode,has_data:me.data.some(Me=>Me.length>0),has_error:me.error!==void 0,legend:Qe.legendFormat,line_limit:Qe.maxLines,obfuscated_query:(0,d.$F)(Qe.expr),query_type:(0,d.sI)(Qe.expr)?"logs":"metric",query_vector_type:Qe.queryType,resolution:Qe.resolution,simultaneously_executed_query_count:De.filter(Me=>!Me.hide).length,simultaneously_hidden_query_count:De.filter(Me=>Me.hide).length,time_range_from:Se?.range?.from?.toISOString(),time_range_to:Se?.range?.to?.toISOString(),time_taken:Date.now()-he.getTime(),bytes_processed:Y,is_split:!1,predefined_operations_applied:Pe.predefinedOperations?Qe.expr.includes(Pe.predefinedOperations):"n/a",...de})}}function Ce(me,Se,he,Pe,de={}){const we={split_query_group_count:Se.length,split_query_largest_partition_size:Math.max(...Se.map(({partition:De})=>De.length)),split_query_total_request_count:Se.reduce((De,{partition:Y})=>De+Y.length,0),is_split:!0,simultaneously_executed_query_count:he.targets.filter(De=>!De.hide).length,simultaneously_hidden_query_count:he.targets.filter(De=>De.hide).length};for(const De of Se){const Y=De.partition.length;ye(me,De.request,Pe,de,{...we,split_query_partition_size:Y})}}},69775:(rt,Ne)=>{"use strict";var h;/** @license React v17.0.2
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var N=60103,Ee=60106,H=60107,b=60108,S=60114,le=60109,d=60110,ce=60112,G=60113,oe=60120,ge=60115,F=60116,xe=60121,Fe=60122,W=60117,Le=60129,ye=60131;if(typeof Symbol=="function"&&Symbol.for){var Ce=Symbol.for;N=Ce("react.element"),Ee=Ce("react.portal"),H=Ce("react.fragment"),b=Ce("react.strict_mode"),S=Ce("react.profiler"),le=Ce("react.provider"),d=Ce("react.context"),ce=Ce("react.forward_ref"),G=Ce("react.suspense"),oe=Ce("react.suspense_list"),ge=Ce("react.memo"),F=Ce("react.lazy"),xe=Ce("react.block"),Fe=Ce("react.server.block"),W=Ce("react.fundamental"),Le=Ce("react.debug_trace_mode"),ye=Ce("react.legacy_hidden")}function me(T){if(typeof T=="object"&&T!==null){var _=T.$$typeof;switch(_){case N:switch(T=T.type,T){case H:case S:case b:case G:case oe:return T;default:switch(T=T&&T.$$typeof,T){case d:case ce:case F:case ge:case le:return T;default:return _}}case Ee:return _}}}var Se=le,he=N,Pe=ce,de=H,we=F,De=ge,Y=Ee,Qe=S,Me=b,Ye=G;h=d,h=Se,h=he,h=Pe,h=de,h=we,h=De,h=Y,h=Qe,h=Me,h=Ye,h=function(){return!1},h=function(){return!1},Ne.isContextConsumer=function(T){return me(T)===d},h=function(T){return me(T)===le},h=function(T){return typeof T=="object"&&T!==null&&T.$$typeof===N},h=function(T){return me(T)===ce},h=function(T){return me(T)===H},h=function(T){return me(T)===F},h=function(T){return me(T)===ge},h=function(T){return me(T)===Ee},h=function(T){return me(T)===S},h=function(T){return me(T)===b},h=function(T){return me(T)===G},h=function(T){return typeof T=="string"||typeof T=="function"||T===H||T===S||T===Le||T===b||T===G||T===oe||T===ye||typeof T=="object"&&T!==null&&(T.$$typeof===F||T.$$typeof===ge||T.$$typeof===le||T.$$typeof===d||T.$$typeof===ce||T.$$typeof===W||T.$$typeof===xe||T[0]===Fe)},h=me},61899:(rt,Ne,h)=>{"use strict";rt.exports=h(69775)},30115:rt=>{var Ne=typeof Element<"u",h=typeof Map=="function",N=typeof Set=="function",Ee=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function H(b,S){if(b===S)return!0;if(b&&S&&typeof b=="object"&&typeof S=="object"){if(b.constructor!==S.constructor)return!1;var le,d,ce;if(Array.isArray(b)){if(le=b.length,le!=S.length)return!1;for(d=le;d--!==0;)if(!H(b[d],S[d]))return!1;return!0}var G;if(h&&b instanceof Map&&S instanceof Map){if(b.size!==S.size)return!1;for(G=b.entries();!(d=G.next()).done;)if(!S.has(d.value[0]))return!1;for(G=b.entries();!(d=G.next()).done;)if(!H(d.value[1],S.get(d.value[0])))return!1;return!0}if(N&&b instanceof Set&&S instanceof Set){if(b.size!==S.size)return!1;for(G=b.entries();!(d=G.next()).done;)if(!S.has(d.value[0]))return!1;return!0}if(Ee&&ArrayBuffer.isView(b)&&ArrayBuffer.isView(S)){if(le=b.length,le!=S.length)return!1;for(d=le;d--!==0;)if(b[d]!==S[d])return!1;return!0}if(b.constructor===RegExp)return b.source===S.source&&b.flags===S.flags;if(b.valueOf!==Object.prototype.valueOf)return b.valueOf()===S.valueOf();if(b.toString!==Object.prototype.toString)return b.toString()===S.toString();if(ce=Object.keys(b),le=ce.length,le!==Object.keys(S).length)return!1;for(d=le;d--!==0;)if(!Object.prototype.hasOwnProperty.call(S,ce[d]))return!1;if(Ne&&b instanceof Element)return!1;for(d=le;d--!==0;)if(!((ce[d]==="_owner"||ce[d]==="__v"||ce[d]==="__o")&&b.$$typeof)&&!H(b[ce[d]],S[ce[d]]))return!1;return!0}return b!==b&&S!==S}rt.exports=function(S,le){try{return H(S,le)}catch(d){if((d.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw d}}},8227:(rt,Ne,h)=>{"use strict";h.d(Ne,{A:()=>H});const N=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Ee(b){return typeof b=="string"&&N.test(b)}const H=Ee},36195:(rt,Ne,h)=>{"use strict";h.d(Ne,{AL:()=>Fn,By:()=>Pn,CX:()=>Qn,GA:()=>Yr,GN:()=>Be,Gn:()=>pr,HV:()=>qa,I4:()=>Sr,Ip:()=>Xr,J3:()=>Gn,J_:()=>qr,Jq:()=>Bn,K0:()=>In,K3:()=>V,KD:()=>wn,LM:()=>K,LQ:()=>en,MD:()=>nt,MK:()=>sn,Nl:()=>Un,On:()=>Xt,Or:()=>Ln,PN:()=>Gr,Q6:()=>Ja,Qf:()=>Vr,Rh:()=>se,Sg:()=>cr,Tz:()=>_r,UK:()=>ht,UM:()=>Lr,UP:()=>kn,Yw:()=>rn,ZQ:()=>ot,Zg:()=>ut,Zj:()=>qe,aU:()=>ri,bY:()=>Kr,c$:()=>ae,dJ:()=>ur,dw:()=>Zr,eF:()=>zr,e_:()=>Dr,g$:()=>Wr,gw:()=>$n,h1:()=>Xn,i8:()=>wr,iT:()=>Hr,ih:()=>Te,lo:()=>Hn,o5:()=>Yn,ov:()=>Nn,pH:()=>Wn,q5:()=>_t,qJ:()=>st,sK:()=>_e,sq:()=>An,t3:()=>kr,uk:()=>at,w7:()=>Mn,wN:()=>Jr,wT:()=>Tr,x:()=>Er,x$:()=>ni,xB:()=>Dn,xo:()=>Za,yW:()=>ei,yj:()=>tn});var N=h(48820);const Ee=1,H=2,b=3,S=4,le=5,d=6,ce=7,G=8,oe=9,ge=10,F=11,xe=12,Fe=13,W=14,Le=15,ye=16,Ce=17,me=18,Se=19,he=20,Pe=21,de=22,we=23,De=24,Y=25,Qe=26,Me=27,Ye=28,T=29,_=30,pe=31,ne=32,B=33,k=34,q=35,ee={json:Ee,logfmt:H,unpack:b,pattern:S,regexp:le,label_format:ce,line_format:G,label_replace:oe,vector:ge,offset:F,bool:xe,on:Fe,ignoring:W,group_left:Le,group_right:ye,unwrap:d,decolorize:Ce,drop:me,keep:Se},Ve=bt=>ee[bt.toLowerCase()]||-1,P={by:he,without:Pe,and:de,or:we,unless:De,sum:Y,avg:Qe,count:Me,max:Ye,min:T,stddev:_,stdvar:pe,bottomk:ne,topk:B,sort:k,sort_desc:q},R=bt=>P[bt.toLowerCase()]||-1,Q={__proto__:null,ip:295,count_over_time:301,rate:303,rate_counter:305,bytes_over_time:307,bytes_rate:309,avg_over_time:311,sum_over_time:313,min_over_time:315,max_over_time:317,stddev_over_time:319,stdvar_over_time:321,quantile_over_time:323,first_over_time:325,last_over_time:327,absent_over_time:329,bytes:335,duration:337,duration_seconds:339},V=N.U1.deserialize({version:14,states:"EtOYQPOOO#cQPO'#DUOOQO'#ER'#ERO#hQPO'#ERO$}QPO'#DTOYQPO'#DTOOQO'#Ed'#EdO%[QPO'#EcOOQO'#FP'#FPO%aQPO'#FOQ%lQPOOO&mQPO'#F]O&rQPO'#F^OOQO'#Eb'#EbOOQO'#DS'#DSOOQO'#Ee'#EeOOQO'#Ef'#EfOOQO'#Eg'#EgOOQO'#Eh'#EhOOQO'#Ei'#EiOOQO'#Ej'#EjOOQO'#Ek'#EkOOQO'#El'#ElOOQO'#Em'#EmOOQO'#En'#EnOOQO'#Eo'#EoOOQO'#Ep'#EpOOQO'#Eq'#EqOOQO'#Er'#ErOOQO'#Es'#EsO&wQPO'#DWOOQO'#DV'#DVO'VQPO,59pOOQO,5:m,5:mOOQO'#Dc'#DcO'_QPO'#DbO'gQPO'#DaO)lQPO'#D`O*{QPO'#D`OOQO'#D_'#D_O+sQPO,59oO-}QPO,59oO.UQPO,5:|O.]QPO,5:}O.hQPO'#E|O0sQPO,5;jO0zQPO,5;jO1PQPO,5;lO1PQPO,5;lO1PQPO,5;lO1PQPO,5;lO1PQPO,5;lO1PQPO,5;lOYQPO,5;wO3cQPO,5;xO3hQPO,59rO#cQPO,59qOOQO1G/[1G/[OOQO'#Dh'#DhO3mQPO,59|O5^QPO,59|OOQO'#Di'#DiO5cQPO,59{OOQO,59{,59{O5kQPO'#DWO6YQPO'#DlO8PQPO'#DoO9sQPO'#DoOOQO'#Do'#DoOOQO'#Dv'#DvOOQO'#Dt'#DtO+kQPO'#DtO9xQPO,59zO;iQPO'#EVO;nQPO'#EWOOQO'#EZ'#EZO;sQPO'#E[O;xQPO'#E_OOQO,59z,59zOOQO,59y,59yOOQO1G/Z1G/ZOOQO1G0h1G0hO;}QPO'#EtO.`QPO'#EtO<XQPO1G0iO<^QPO1G0iO<cQPO,5;hO=oQPO1G1UO=vQPO1G1UO=}QPO1G1UO>UQPO'#FSO@dQPO'#FRO@nQPO'#FROYQPO1G1WOYQPO1G1WOYQPO1G1WOYQPO1G1WOYQPO1G1WOYQPO1G1WO@xQPO1G1cOAPQPO1G1dOOQO1G/^1G/^OOQO1G/]1G/]O5cQPO1G/hOAUQPO1G/hOAZQPO'#DjOBzQPO'#DjOOQO1G/g1G/gOCbQPO,59rOCPQPO,5:cOOQO'#Dm'#DmOClQPO,5:WOEcQPO'#DrOOQO'#Dq'#DqOGVQPO,5:_OHvQPO,5:[OOQO,5:Z,5:ZOJgQPO,5:`O+kQPO,5:`O+kQPO,5:`OOQO,5:q,5:qOJuQPO'#EYOOQO'#EX'#EXOJzQPO,5:rOLkQPO'#E^OOQO'#E^'#E^OOQO'#E]'#E]ONbQPO,5:vO!!RQPO'#EaOOQO'#Ea'#EaOOQO'#E`'#E`O!#xQPO,5:yO!%iQPO'#D`O;}QPO,5;`O!%pQPO'#EuO!%uQPO,5;`O!%}QPO,5;`O!&[QPO,5;`O!&iQPO,5;`O!&nQPO7+&TO.`QPO7+&TOOQO'#E}'#E}O!(OQPO1G1SOOQO1G1S1G1SOYQPO7+&pO!(WQPO7+&pO!)hQPO7+&pO!)oQPO7+&pO!)vQQO'#FTOOQO,5;n,5;nO!,UQPO,5;mO!,]QPO,5;mO!-nQPO7+&rO!-uQPO7+&rOOQO7+&r7+&rO!.SQPO7+&rO!.ZQPO7+&rO!/`QPO7+&rO!/pQPO7+&}OOQO7+'O7+'OOOQO7+%S7+%SO!/uQPO7+%SO5cQPO,5:UO!/zQPO,5:UO!0PQPO1G/{OOQO1G/}1G/}OOQO1G0U1G0UOOQO1G0W1G0WOOQO,5:X,5:XO!0UQPO1G/yO!1uQPO,5:^O!1zQPO,5:]OOQO1G/z1G/zO!2PQPO1G/zO!3pQPO,5:tO;nQPO,5:sO;sQPO,5:wO;xQPO,5:zO!3xQPO,5;cO!%uQPO1G0zO!4WQPO1G0zO!4`QPO,5;aO+kQPO,5;cO!4eQPO1G0zO!4oQPO'#EvO!4tQPO1G0zO!4eQPO1G0zO!4|QPO1G0zO!5ZQPO1G0zO!%xQPO1G0zOOQO1G0z1G0zOOQO<<Io<<IoO!5fQPO<<IoO!5kQPO,5;iOOQO7+&n7+&nO!5pQPO<<J[OOQO<<J[<<J[OYQPO<<J[OOQO'#FV'#FVO!5wQPO,5;oOOQO'#FU'#FUOOQO,5;o,5;oOOQO1G1X1G1XO!6PQPO1G1XO!8YQPO<<JiOOQO<<Hn<<HnOOQO1G/p1G/pO!8_QPO1G/pO!8dQPO7+%gOOQO1G/x1G/xOOQO1G/w1G/wOOQO1G0`1G0`OOQO1G0_1G0_OOQO1G0c1G0cOOQO1G0f1G0fOOQO'#Ex'#ExOOQO1G0}1G0}O!8iQPO1G0}OOQO'#Ey'#EyOOQO'#Ez'#EzOOQO'#E{'#E{OOQO7+&f7+&fOOQO1G0{1G0{O!8nQPO1G0}O!9SQPO7+&fOOQO,5;b,5;bO!9[QPO7+&fO!%xQPO7+&fO!9fQPO7+&fO!9qQPOAN?ZOOQO1G1T1G1TO!;RQPOAN?vO!<cQPOAN?vO!<jQQO1G1ZOOQO1G1Z1G1ZOOQO7+&s7+&sO!<rQPOAN@TOOQO7+%[7+%[O!<wQPO<<IRO!<|QPO7+&iO!=RQPO<<JQO!=ZQPO<<JQO!=cQPO'#EwO!=hQPO<<JQOOQOG24uG24uOOQOG25bG25bOOQO1G1[1G1[OOQO7+&u7+&uO!=pQPOG25oOOQOAN>mAN>mO!=uQPO<<JTOOQOAN?lAN?lO!=zQPOAN?lO!>SQPOLD+ZOOQOAN?oAN?oOOQO,5:r,5:rO!>XQPO!$'NuO!>^QPO!)9DaO!>cQPO!.K9{OOQO!4//g!4//gO;nQPO'#EWO!>hQPO'#D`O!?`QPO,59oO!@fQPO'#DTOYQPO1G1WOYQPO1G1WOYQPO1G1WOYQPO1G1WOYQPO1G1WOYQPO1G1WO1PQPO,5;lO1PQPO,5;lO1PQPO,5;lO1PQPO,5;lO1PQPO,5;lO1PQPO,5;lO!AqQPO7+&rO!AxQPO7+&rO!BVQPO7+&rO!C_QPO7+&rO!CfQPO7+&rO!B^QPO'#FQ",stateData:"!Cs~O$TOStOS~OXZOY[OiWOjWOkWOlWOmWOnWOoWOpWOqWOrWOsWO!vQO!wRO!xRO$UPO$YTO$[_O$]`O$^aO$_bO$`cO$adO$beO$cfO$dgO$ehO$fiO$gjO$hkO$ilO$jmO~O{nO~O!vqO~O!OrO!QrO!WrO!XrO!YrO!ZrOfwXgwXhwX!lwX!nwX!owX!pwX!qwX!wwX!xwX#{wX#|wX#}wX$OwX~O!_vO$RwX$ZwX~P#mO$Y{O~Od|Oe|O$Y}O~Of!QOg!POh!QO!O!UO!l!UO!n!UO!o!UO!p!UO!q!UO!w!RO!x!RO#{!SO#|!SO#}!SO$O!TO~O$Y!VO~O$Y!WO~O|!XO!O!XO!P!XO!Q!XO~O$V!YO$W!ZO~O}!]O$X!_O~Og!`Of!TXh!TX!O!TX!Q!TX!W!TX!X!TX!Y!TX!Z!TX!_!TX!l!TX!n!TX!o!TX!p!TX!q!TX!w!TX!x!TX#{!TX#|!TX#}!TX$O!TX$R!TX$Z!TX$k!TX$V!TX~O!OrO!QrO!WrO!XrO!YrO!ZrO~Of!SXg!SXh!SX!_!SX!l!SX!n!SX!o!SX!p!SX!q!SX!w!SX!x!SX#{!SX#|!SX#}!SX$O!SX$R!SX$Z!SX$k!SX$V!SX~P)WOP!dOQ!cOR!fOS!eOT!eOV!lOW!kOa!mOb!nOc!oO{!bO$Y!iO~O!_vOfwagwahwa!lwa!nwa!owa!pwa!qwa!wwa!xwa#{wa#|wa#}wa$Owa$Rwa$Zwa~P)WOfvXgvXhvX!OvX!lvX!nvX!ovX!pvX!qvX!wvX!xvX#{vX#|vX#}vX$OvX~O$Z!rO~P,|O$Z!sO~P,|O!v!wO$UPO$Y!uO~O$Y!xO~OXZOY[OiWOjWOkWOlWOmWOnWOoWOpWOqWOrWOsWO!wRO!xRO$UPO$YTO$[_O$]`O$^aO$_bO$`cO$adO$beO$cfO$dgO$ehO$fiO$gjO$hkO$ilO$jmO~O!v!yO~P.mO$Y!{O~O[#OO]!|O^!|OX#uPY#uPi#uPj#uPk#uPl#uPm#uPn#uPo#uPp#uPq#uPr#uPs#uP!v#uP!w#uP!x#uP$U#uP$Y#uP$[#uP$]#uP$^#uP$_#uP$`#uP$a#uP$b#uP$c#uP$d#uP$e#uP$f#uP$g#uP$h#uP$i#uP$j#uP~O!v#WO~O}#XO~Og#ZOf!Uah!Ua!O!Ua!Q!Ua!W!Ua!X!Ua!Y!Ua!Z!Ua!_!Ua!l!Ua!n!Ua!o!Ua!p!Ua!q!Ua!w!Ua!x!Ua#{!Ua#|!Ua#}!Ua$O!Ua$R!Ua$Z!Ua$k!Ua$V!Ua~O$Y#[O~O}#]O$X!_O~O|#`O!O#`O!P!XO!Q!XO!l#aO!n#aO!o#aO!p#aO!q#aO~O{#dO!b#bOf!`Xg!`Xh!`X!O!`X!Q!`X!W!`X!X!`X!Y!`X!Z!`X!_!`X!l!`X!n!`X!o!`X!p!`X!q!`X!w!`X!x!`X#{!`X#|!`X#}!`X$O!`X$R!`X$Z!`X$k!`X$V!`X~O{#dOf!cXg!cXh!cX!O!cX!Q!cX!W!cX!X!cX!Y!cX!Z!cX!_!cX!l!cX!n!cX!o!cX!p!cX!q!cX!w!cX!x!cX#{!cX#|!cX#}!cX$O!cX$R!cX$Z!cX$k!cX$V!cX~O}#hO~Of#jOg#kO$V#jOh!Sa!O!Sa!Q!Sa!W!Sa!X!Sa!Y!Sa!Z!Sa!_!Sa!l!Sa!n!Sa!o!Sa!p!Sa!q!Sa!w!Sa!x!Sa#{!Sa#|!Sa#}!Sa$O!Sa$R!Sa$Z!Sa$k!Sa~O}#lO~O{#mO~O{#pO~O{#tO~O!_#xO$k#zO~P)WO$Z$PO~O$V$QO~O{$RO$Z$TO~Of!uXg!uXh!uX!O!uX!l!uX!n!uX!o!uX!p!uX!q!uX!w!uX!x!uX#{!uX#|!uX#}!uX$O!uX$Z!uX~O$V$UO~P<kO$Z$VO~P,|O!v$WO~P.mO$Y$YO~OX#uXY#uXi#uXj#uXk#uXl#uXm#uXn#uXo#uXp#uXq#uXr#uXs#uX!v#uX!w#uX!x#uX$U#uX$Y#uX$[#uX$]#uX$^#uX$_#uX$`#uX$a#uX$b#uX$c#uX$d#uX$e#uX$f#uX$g#uX$h#uX$i#uX$j#uX~O_$[O`$[O~P>ZO]!|O^!|O~P>ZO$V$dO~P,|O$Z$eO~O}$gO~Og$hOf!^Xh!^X!O!^X!Q!^X!W!^X!X!^X!Y!^X!Z!^X!_!^X!l!^X!n!^X!o!^X!p!^X!q!^X!w!^X!x!^X#{!^X#|!^X#}!^X$O!^X$R!^X$Z!^X$k!^X$V!^X~O$Y$iO~O!m$kO!s$lO!vQO!wRO!xRO~O}#XO$X!_O~PCPO{#dO!b$nOf!`ag!`ah!`a!O!`a!Q!`a!W!`a!X!`a!Y!`a!Z!`a!_!`a!l!`a!n!`a!o!`a!p!`a!q!`a!w!`a!x!`a#{!`a#|!`a#}!`a$O!`a$R!`a$Z!`a$k!`a$V!`a~O|$pOf!fXg!fXh!fX!O!fX!Q!fX!W!fX!X!fX!Y!fX!Z!fX!_!fX!l!fX!n!fX!o!fX!p!fX!q!fX!w!fX!x!fX#{!fX#|!fX#}!fX$O!fX$R!fX$V!fX$Z!fX$k!fX~O$V$qOf!gag!gah!ga!O!ga!Q!ga!W!ga!X!ga!Y!ga!Z!ga!_!ga!l!ga!n!ga!o!ga!p!ga!q!ga!w!ga!x!ga#{!ga#|!ga#}!ga$O!ga$R!ga$Z!ga$k!ga~O$V$qOf!dag!dah!da!O!da!Q!da!W!da!X!da!Y!da!Z!da!_!da!l!da!n!da!o!da!p!da!q!da!w!da!x!da#{!da#|!da#}!da$O!da$R!da$Z!da$k!da~Of#jOg#kO$V#jO$Z$rO~O|$tO~O$V$uOf!zag!zah!za!O!za!Q!za!W!za!X!za!Y!za!Z!za!_!za!l!za!n!za!o!za!p!za!q!za!w!za!x!za#{!za#|!za#}!za$O!za$R!za$Z!za$k!za~O|!XO!O!XO!P!XO!Q!XOf#QXg#QXh#QX!W#QX!X#QX!Y#QX!Z#QX!_#QX!l#QX!n#QX!o#QX!p#QX!q#QX!w#QX!x#QX#{#QX#|#QX#}#QX$O#QX$R#QX$V#QX$Z#QX$k#QX~O$V$vOf#Oag#Oah#Oa!O#Oa!Q#Oa!W#Oa!X#Oa!Y#Oa!Z#Oa!_#Oa!l#Oa!n#Oa!o#Oa!p#Oa!q#Oa!w#Oa!x#Oa#{#Oa#|#Oa#}#Oa$O#Oa$R#Oa$Z#Oa$k#Oa~O|!XO!O!XO!P!XO!Q!XOf#TXg#TXh#TX!W#TX!X#TX!Y#TX!Z#TX!_#TX!l#TX!n#TX!o#TX!p#TX!q#TX!w#TX!x#TX#{#TX#|#TX#}#TX$O#TX$R#TX$V#TX$Z#TX$k#TX~O$V$wOf#Rag#Rah#Ra!O#Ra!Q#Ra!W#Ra!X#Ra!Y#Ra!Z#Ra!_#Ra!l#Ra!n#Ra!o#Ra!p#Ra!q#Ra!w#Ra!x#Ra#{#Ra#|#Ra#}#Ra$O#Ra$R#Ra$Z#Ra$k#Ra~OU$xO~P*{O!m${O~O!_$|O$k#zO~OZ%OO!_#xO$Z#ha~P)WO!_#xO$Z%TO$k#zO~P)WO$Z%UO~Od|Oe|Of#Vqg#Vqh#Vq!O#Vq!l#Vq!n#Vq!o#Vq!p#Vq!q#Vq!w#Vq!x#Vq#{#Vq#|#Vq#}#Vq$O#Vq$R#Vq$Z#Vq$V#Vq~O$V%XO$Z%YO~Od|Oe|Of#rqg#rqh#rq!O#rq!l#rq!n#rq!o#rq!p#rq!q#rq!w#rq!x#rq#{#rq#|#rq#}#rq$O#rq$R#rq$Z#rq$V#rq~O$V%]O~P<kO$Z%[O~P,|O#z%^O$Z%aO~OX#uaY#uai#uaj#uak#ual#uam#uan#uao#uap#uaq#uar#uas#ua!v#ua!w#ua!x#ua$U#ua$[#ua$]#ua$^#ua$_#ua$`#ua$a#ua$b#ua$c#ua$d#ua$e#ua$f#ua$g#ua$h#ua$i#ua$j#ua~O$Y$YO~P!*OO_%cO`%cO$Y#ua~P!*OOf!QOh!QO!O!UO!l!UO!n!UO!o!UO!p!UO!q!UO!w!RO!x!RO#{#tq#|#tq#}#tq$O#tq$R#tq$Z#tq~Og#tq~P!,jOf#tqg#tqh#tq~P!,pOg!PO~P!,jO$R#tq$Z#tq~P%lOf#tqg#tqh#tq!O#tq!l#tq!n#tq!o#tq!p#tq!q#tq#{#tq#|#tq#}#tq$O#tq~O!w!RO!x!RO$R#tq$Z#tq~P!.eO}%dO~O$Z%eO~O}%gO~O$Y%hO~O$V$qOf!gig!gih!gi!O!gi!Q!gi!W!gi!X!gi!Y!gi!Z!gi!_!gi!l!gi!n!gi!o!gi!p!gi!q!gi!w!gi!x!gi#{!gi#|!gi#}!gi$O!gi$R!gi$Z!gi$k!gi~O}%iO~O{#dO~Of#jO$V#jOg!hih!hi!O!hi!Q!hi!W!hi!X!hi!Y!hi!Z!hi!_!hi!l!hi!n!hi!o!hi!p!hi!q!hi!w!hi!x!hi#{!hi#|!hi#}!hi$O!hi$R!hi$Z!hi$k!hi~O{%kO}%kO~O{%pO$m%rO$n%sO$o%tO~OZ%OO$Z#hi~O$l%vO~O!_#xO$Z#hi~P)WO!m%yO~O!_$|O$Z#hi~O!_#xO$Z%{O$k#zO~P)WO!_$|O$Z%{O$k#zO~O$Z%}O~O{&OO~O$Z&PO~P,|O$V&RO$Z&SO~O$Y$YOX#uiY#uii#uij#uik#uil#uim#uin#uio#uip#uiq#uir#uis#ui!v#ui!w#ui!x#ui$U#ui$[#ui$]#ui$^#ui$_#ui$`#ui$a#ui$b#ui$c#ui$d#ui$e#ui$f#ui$g#ui$h#ui$i#ui$j#ui~O$V&UO~O$Z&VO~O}&WO~O$Y&XO~Of#jOg#kO$V#jO!_#ki$k#ki$Z#ki~O!_$|O$Z#hq~O!_#xO$Z#hq~P)WOZ%OO!_&[O$Z#hq~Od|Oe|Of#V!Rg#V!Rh#V!R!O#V!R!l#V!R!n#V!R!o#V!R!p#V!R!q#V!R!w#V!R!x#V!R#{#V!R#|#V!R#}#V!R$O#V!R$R#V!R$Z#V!R$V#V!R~Od|Oe|Of#r!Rg#r!Rh#r!R!O#r!R!l#r!R!n#r!R!o#r!R!p#r!R!q#r!R!w#r!R!x#r!R#{#r!R#|#r!R#}#r!R$O#r!R$R#r!R$Z#r!R$V#r!R~O$Z&_O~P,|O#z%^O$Z&aO~O}&bO~O$Z&cO~O{&dO~O!_$|O$Z#hy~OZ%OO$Z#hy~OU$xO~O!_&[O$Z#hy~O$V&gO~O$Z&hO~O!_$|O$Z#h!R~O}&jO~O$V&kO~O}&lO~O$Z&mO~OP!dOQ!cOR!fOS!eOT!eOV&nOW!kOa!mOb!nOc!oO{!bO$Y!iO~O!_&oOfwagwahwa!lwa!nwa!owa!pwa!qwa!wwa!xwa#{wa#|wa#}wa$Owa$Vwa~P)WO!_&oO$VwX~P#mOf&yOh&yO!O&}O!l&}O!n&}O!o&}O!p&}O!q&}O!w&zO!x&zO#{#tq#|#tq#}#tq$O#tq$V#tq~Og#tq~P!@pOf#tqg#tqh#tq~P!@vOg&xO~P!@pOf&yOg&xOh&yO!O&}O!l&}O!n&}O!o&}O!p&}O!q&}O!w&zO!x&zO#{&{O#|&{O#}&{O$O&|O~O$V#tq~P!B^O!w&zO!x&zO$V#tq~P!.eO",goto:"1l$RPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP$S%R%j&Y&]PPPPPP&t'W'h'v(XPPPP(h(p(yP)S)XP)S)S)[)e)S)m*O*O*XPPPPPP*XP*O*bPPP)S)S*{+R)S)S+Y+])S+c+f+l,_,t-Z-Z-Z-Z-Z-Z-Z-Z-Z-Z-Z-Z-Z-Z-Z-p-y.^.j/S/V/V/V/Y/i,_/l,_0R0w1Y1c1fPPPPP,_,_[YOT}!{$U%]Q$^#PQ$_#QS$`#R&tQ$a#SQ$b#TQ$c#UQ'O&rQ'P&sQ'Q&uQ'R&vQ'S&wR'T!Vt^O}!V!{#P#Q#R#S#T#U$U%]&r&s&t&u&v&wRyTjSOT}!V!{#P#Q#R#S#T#U$U%]S!t{$QQ#}!u]&q&r&s&t&u&v&wRpPQoP^!hv!i#j#k#x$|&oQ#Y!YS#q!n$vT#u!o$wQxSQ#y!tQ$}#|Q%R#}Q%z%QR&p&q[wS!t#|#}%Q&q]!qx#y$}%R%z&piuSx!t#y#|#}$}%Q%R%z&p&qhtSx!t#y#|#}$}%Q%R%z&p&qR!auksSux!t#y#|#}$}%Q%R%z&p&qQ!^sV#^!`#Z$hW![s!`#Z$hR$j#`Q#_!`Q$f#ZR%f$hV!pv#x&oR#c!cQ#f!cQ#g!dR$o#cU#e!c!d#cR%j$qU!jv#x&oQ#i!iQ$r#jQ$s#kR%w$|_!hv!i#j#k#x$|&o_!gv!i#j#k#x$|&ov]OT}!V!{#P#Q#R#S#T#U$U%]&r&s&t&u&v&wT$m#`#aQ#o!lR&i&nS#n!l&nR%l$uR#s!nQ#r!nR%m$vR#w!oQ#v!oR%n$wj^O#P#Q#R#S#T#U&r&s&t&u&v&wQzTQ!z}Q#V!VQ$X!{Q%Z$UR&Q%]w]OT}!V!{#P#Q#R#S#T#U$U%]&r&s&t&u&v&wwVOT}!V!{#P#Q#R#S#T#U$U%]&r&s&t&u&v&wwUOT}!V!{#P#Q#R#S#T#U$U%]&r&s&t&u&v&wQ!v{Q$O!uR%W$QS#|!t#}W$z#y#{%R%SQ%u$yQ%|%TR&Z%{Q%Q#|Q%u$zQ&]%|R&e&ZQ#{!tS$y#y%RQ%P#|Q%S#}S%x$}%QS&Y%z%|R&f&]R%q$xR%o$xQ!OXQ%V$PQ%[$VQ&^%}R&_&PR$S!xwXOT}!V!{#P#Q#R#S#T#U$U%]&r&s&t&u&v&wQ#P!PQ#Q!QQ#R!RQ#S!SQ#T!TQ#U!UQ&r&xQ&s&yQ&t&zQ&u&{Q&v&|R&w&}h!}!P!Q!R!S!T!U&x&y&z&{&|&}R$]#OQ$Z!|Q%b$[R&T%cR%_$YQ%`$YR&`&R",nodeNames:"\u26A0 Json Logfmt Unpack Pattern Regexp Unwrap LabelFormat LineFormat LabelReplace Vector Offset Bool On Ignoring GroupLeft GroupRight Decolorize Drop Keep By Without And Or Unless Sum Avg Count Max Min Stddev Stdvar Bottomk Topk Sort Sort_Desc LineComment LogQL Expr LogExpr Selector Matchers Matcher Identifier Eq String Neq Re Nre PipelineExpr PipelineStage LineFilters LineFilter Filter PipeExact PipeMatch PipePattern Npa FilterOp Ip OrFilter Pipe LogfmtParser LogfmtParserFlags ParserFlag LabelParser JsonExpressionParser LabelExtractionExpressionList LabelExtractionExpression LogfmtExpressionParser LabelFilter IpLabelFilter UnitFilter DurationFilter Gtr Duration Gte Lss Lte Eql BytesFilter Bytes NumberFilter LiteralExpr Number Add Sub LineFormatExpr LabelFormatExpr LabelsFormat LabelFormatMatcher DecolorizeExpr DropLabelsExpr DropLabels DropLabel KeepLabelsExpr KeepLabels KeepLabel MetricExpr RangeAggregationExpr RangeOp CountOverTime Rate RateCounter BytesOverTime BytesRate AvgOverTime SumOverTime MinOverTime MaxOverTime StddevOverTime StdvarOverTime QuantileOverTime FirstOverTime LastOverTime AbsentOverTime LogRangeExpr Range OffsetExpr UnwrapExpr ConvOp BytesConv DurationConv DurationSecondsConv Grouping Labels VectorAggregationExpr VectorOp BinOpExpr BinOpModifier OnOrIgnoringModifier GroupingLabels GroupingLabelList GroupingLabel LabelName Mul Div Mod Pow LabelReplaceExpr VectorExpr",maxTerm:169,skippedNodes:[0,36],repeatNodeCount:0,tokenData:"5r~RvX^#ipq#iqr$^rs$yst%kuv%vxy%{yz&Qz{&V{|&[|}&a}!O&f!O!P(t!P!Q)t!Q!R)y!R![+a![!]2a!^!_2u!_!`3S!`!a3i!c!}3v!}#O4^#P#Q4c#Q#R4h#R#S3v#S#T4m#T#o3v#o#p4y#p#q5O#q#r5m#y#z#i$f$g#i#BY#BZ#i$IS$I_#i$I|$JO#i$JT$JU#i$KV$KW#i&FU&FV#i~#nY$T~X^#ipq#i#y#z#i$f$g#i#BY#BZ#i$IS$I_#i$I|$JO#i$JT$JU#i$KV$KW#i&FU&FV#i~$aR!_!`$j!`!a$o#r#s$t~$oO!O~~$tO!Z~~$yO!Q~~$|UOY$yZr$yrs%`s#O$y#O#P%e#P~$y~%eO}~~%hPO~$y~%pQt~OY%kZ~%k~%{O#}~~&QO$Y~~&VO$Z~~&[O#{~~&aO!w~~&fO$V~~&kP!x~}!O&n~&qQ#_#`&w#g#h(U~&zP#X#Y&}~'QP#X#Y'T~'WP#d#e'Z~'^P}!O'a~'dP#X#Y'g~'jP#a#b'm~'pP#d#e's~'vP#h#i'y~'|P#m#n(P~(UO!b~~(XP#h#i([~(_P#f#g(b~(eP#]#^(h~(kP#V#W(n~(qP#h#i(P~(wP!Q![(z~)PR!v~!Q![(z!g!h)Y#X#Y)Y~)]R{|)f}!O)f!Q![)l~)iP!Q![)l~)qP!v~!Q![)l~)yO#|~~*Oe!v~!O!P(z!Q![+a!g!h,t!i!j-c!m!n-c!o!p-c!r!s-c!v!w-c#U#V-W#W#X-l#X#Y/n#Z#[0Q#[#].T#_#`0Q#a#b0Z#d#e0Q#g#h/]#h#i0Q#k#l0l#l#m1u#m#n1W~+fd!v~!O!P(z!Q![+a!g!h,t!i!j-c!m!n-c!o!p-c!r!s-c!v!w-c#U#V-W#W#X-l#X#Y/n#Z#[0Q#[#].T#_#`0Q#a#b0Z#d#e0Q#g#h/]#h#i0Q#k#l0l#m#n1W~,wT{|)f}!O)f!Q![)l!d!e-W#]#^-]~-]O!s~~-`P#U#V-W~-fQ!d!e-W#]#^-]~-qP!m~!Q![-t~-wS!Q![-t#[#].T#a#b.i#g#h/]~.YP!m~!Q![.]~.`R!Q![.]#a#b.i#g#h/]~.nQ!m~!Q![.t#g#h/W~.wR!Q![.t#a#b/Q#g#h/]~/TP#g#h/W~/]O!m~~/bP!m~!Q![/e~/hQ!Q![/e#a#b/Q~/qT{|)f}!O)f!Q![)l#U#V-W#]#^-]~0TQ#U#V-W#]#^-]~0`S!m~!Q![.t#U#V-W#]#^-]#g#h/W~0qP!m~!Q![0t~0wT!Q![0t#W#X-l#[#].T#a#b.i#g#h/]~1]P!m~!Q![1`~1cU!Q![1`#W#X-l#[#].T#a#b.i#g#h/]#k#l0l~1xR!Q![2R!c!i2R#T#Z2R~2WR!v~!Q![2R!c!i2R#T#Z2RP2fT{P!Q![2a![!]2a!c!}2a#R#S2a#T#o2a~2zP!o~!_!`2}~3SO!p~~3XQ|~!_!`3_#r#s3d~3dO!q~~3iO!P~~3nP!l~!_!`3q~3vO!n~R3}T{P#zQ!Q![3v![!]2a!c!}3v#R#S3v#T#o3v~4cO$k~~4hO$l~~4mO$O~~4pRO#S4m#S#T%`#T~4m~5OO$U~~5TR!_~!_!`5^!`!a5c#r#s5h~5cO!W~~5hO!Y~~5mO!X~~5rO$W~",tokenizers:[0,1],topRules:{LogQL:[0,37]},specialized:[{term:43,get:(bt,ta)=>Ve(bt)<<1},{term:43,get:(bt,ta)=>R(bt)<<1|1},{term:43,get:bt=>Q[bt]||-1}],tokenPrec:0}),K=1,ae=2,Oe=3,ve=4,He=5,_e=6,lt=7,Pt=8,xt=9,sr=10,Vt=11,Er=12,Xt=13,jr=14,Ur=15,Da=16,ut=17,kt=18,wa=19,Pn=20,Dn=21,wn=22,Ln=23,La=24,Ca=25,vt=26,Qt=27,Ra=28,Cn=29,tr=30,Rn=31,Ta=32,Tn=33,Ht=34,zt=35,at=36,In=37,Be=38,ht=39,nt=40,An=41,Wr=42,$n=43,Mt=44,Vr=45,lr=46,rr=47,Ia=48,Fn=49,kr=50,Qn=51,Gr=52,ur=53,cr=54,_t=55,Aa=56,dr=57,Mn=58,Xr=59,Te=60,fr=61,qe=62,$a=63,Nn=64,Hr=65,zr=66,Sr=67,pr=68,_r=69,Kr=70,Yr=71,Bn=72,Pr=73,nr=74,Zr=75,jn=76,Fa=77,Qa=78,Ma=79,Na=80,Ba=81,Fi=82,Un=83,Jr=84,ja=85,Ua=86,Wn=87,qr=88,Vn=89,Dr=90,Wa=91,wr=92,en=93,tn=94,kn=95,Gn=96,Lr=97,rn=98,Xn=99,Hn=100,Va=101,nn=102,ka=103,zn=104,Ga=105,Xa=106,Cr=107,Ha=108,za=109,_a=110,_n=111,Rr=112,Ka=113,Ya=114,an=115,Za=116,Ja=117,Qi=118,qa=119,ei=120,Kn=121,ti=122,Mi=123,ri=124,on=125,se=126,ot=127,sn=128,Yn=129,Tr=130,ni=131,st=132,ar=133,ln=134,Zn=135,Jn=136,qn=137,ea=138,Ir=139,ai=140}}]);

//# sourceMappingURL=9656.3cf80c45beee0b306d50.js.map