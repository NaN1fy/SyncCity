"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[2154],{72557:(ye,U,o)=>{o.d(U,{A:()=>i});var e=o(74848),g=o(96540),u=o(14186),h=o(67647),p=o(55852),C=o(73725);class i extends g.PureComponent{render(){const{searchQuery:P,linkButton:m,setSearchQuery:G,target:R,placeholder:L="Search by name or type",sortPicker:O}=this.props,T={href:m?.href,disabled:m?.disabled};return R&&(T.target=R),(0,e.jsxs)("div",{className:"page-action-bar",children:[(0,e.jsx)(u.I,{grow:!0,children:(0,e.jsx)(h.Z,{value:P,onChange:G,placeholder:L})}),O&&(0,e.jsx)(C.r,{onChange:O.onChange,value:O.value,getSortOptions:O.getSortOptions}),m&&(0,e.jsx)(p.z9,{...T,children:m.title})]})}}},19514:(ye,U,o)=>{o.r(U),o.d(U,{default:()=>es});var e=o(74848),g=o(24180),u=o(85464),h=o(31678),p=o(6320),C=o(69444),i=o(32196),N=o(96540),P=o(43429),m=o(40845),G=o(39558),R=o(69529),L=o(10096),O=o(83277),T=o(8484),W=o(83391),De=o(71259),f=o(10860),Ce=o(50691);const Ne=t=>({heading:(0,i.css)({fontSize:t.typography.h5.fontSize,fontWeight:"inherit"}),figure:(0,i.css)({width:"inherit",marginRight:"0px","> img":{width:t.spacing(7)}}),meta:(0,i.css)({marginTop:"6px",position:"relative"}),description:(0,i.css)({margin:"0px",fontSize:t.typography.bodySmall.fontSize}),card:(0,i.css)({gridTemplateAreas:`
        "Figure   Heading   Actions"
        "Figure Description Actions"
        "Figure    Meta     Actions"
        "Figure     -       Actions"`}),logo:(0,i.css)({marginRight:t.spacing(3),marginLeft:t.spacing(1),width:t.spacing(7),maxHeight:t.spacing(7)})}),be=({items:t,onClickItem:s})=>{const n=(0,m.of)(Ne);return(0,e.jsx)(De.x,{gap:1.5,minColumnWidth:44,children:t.map(a=>(0,e.jsxs)(f.Z,{className:n.card,href:a.url,onClick:r=>{s&&s(r,a)},children:[(0,e.jsx)(f.Z.Heading,{className:n.heading,children:a.name}),(0,e.jsx)(f.Z.Figure,{align:"center",className:n.figure,children:(0,e.jsx)("img",{className:n.logo,src:a.logo,alt:""})}),a.angularDetected?(0,e.jsx)(f.Z.Meta,{className:n.meta,children:(0,e.jsx)(Ce.fk,{})}):null]},a.id))})};var Y=o(14578);const Pe=t=>({categoryHeader:(0,i.css)`
    align-items: center;
    display: flex;
    margin-bottom: 24px;
  `,categoryLabel:(0,i.css)`
    margin-bottom: 0px;
    margin-left: 8px;
  `}),Te=({iconName:t,label:s})=>{const n=(0,m.of)(Pe);return(0,e.jsxs)("div",{className:n.categoryHeader,children:[(0,e.jsx)(Y.I,{name:t,size:"xl"}),(0,e.jsx)("h3",{className:n.categoryLabel,children:s})]})};var Ae=o(37390),j=o(55852);const te=t=>({modal:(0,i.css)`
    width: 500px;
  `,modalContent:(0,i.css)`
    overflow: visible;
    color: ${t.colors.text.secondary};

    a {
      color: ${t.colors.text.link};
    }
  `,description:(0,i.css)`
    margin-bottom: ${t.spacing(2)};
  `,bottomSection:(0,i.css)`
    display: flex;
    border-top: 1px solid ${t.colors.border.weak};
    padding-top: ${t.spacing(3)};
    margin-top: ${t.spacing(3)};
  `,actionsSection:(0,i.css)`
    display: flex;
    justify-content: end;
    margin-top: ${t.spacing(3)};
  `,warningIcon:(0,i.css)`
    color: ${t.colors.warning.main};
    padding-right: ${t.spacing()};
    margin-top: ${t.spacing(.25)};
  `,header:(0,i.css)`
    display: flex;
    align-items: center;
  `,headerTitle:(0,i.css)`
    margin: 0;
  `,headerLogo:(0,i.css)`
    margin-right: ${t.spacing(2)};
    width: 32px;
    height: 32px;
  `});function Ie({item:t,isOpen:s,onDismiss:n}){const a=(0,m.of)(te);return(0,e.jsx)(Ae.a,{className:a.modal,contentClassName:a.modalContent,title:(0,e.jsx)(Ee,{item:t}),isOpen:s,onDismiss:n,children:(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{children:[t.description&&(0,e.jsx)("div",{className:a.description,children:t.description}),(0,e.jsxs)("div",{children:["Links",(0,e.jsx)("br",{}),(0,e.jsx)("a",{href:`https://grafana.com/grafana/plugins/${t.id}`,title:`${t.name} on Grafana.com`,target:"_blank",rel:"noopener noreferrer",children:t.name})]})]}),(0,e.jsxs)("div",{className:a.bottomSection,children:[(0,e.jsx)("div",{className:a.warningIcon,children:(0,e.jsx)(Y.I,{name:"exclamation-triangle"})}),(0,e.jsxs)("div",{children:[(0,e.jsxs)("p",{children:["Editors cannot add new connections. You may check to see if it is already configured in"," ",(0,e.jsx)("a",{href:"/connections/datasources",children:"Data sources"}),"."]}),(0,e.jsx)("p",{children:"To add a new connection, contact your Grafana admin."})]})]}),(0,e.jsx)("div",{className:a.actionsSection,children:(0,e.jsx)(j.$n,{onClick:n,children:"Okay"})})]})})}function Ee({item:t}){const s=(0,m.of)(te);return(0,e.jsx)("div",{children:(0,e.jsxs)("div",{className:s.header,children:[t.logo&&(0,e.jsx)("img",{className:s.headerLogo,src:t.logo,alt:`logo of ${t.name}`}),(0,e.jsx)("h4",{className:s.headerTitle,children:t.name})]})})}var Le=o(23172),M=o(32264),se=o(10354);const Me=(t,s)=>({searchContainer:(0,i.css)({display:"flex",justifyContent:"space-between",position:"sticky",top:s,backgroundColor:t.colors.background.primary,zIndex:2,padding:t.spacing(2,0)})}),we=(0,T.t)("connections.search.placeholder","Search all"),$e=({onChange:t,value:s})=>{const n=(0,Le.k)(),a=(0,m.of)(Me,M.$.featureToggles.bodyScrolling?n??0:0);return(0,e.jsx)("div",{className:a.searchContainer,children:(0,e.jsx)(se.p,{value:s,onChange:t,prefix:(0,e.jsx)(Y.I,{name:"search"}),placeholder:we,"aria-label":"Search all"})})},Be=t=>({spacer:(0,i.css)({height:t.spacing(2)}),modal:(0,i.css)({width:"500px"}),modalContent:(0,i.css)({overflow:"visible"})});function Re(){const[t,s]=(0,O.s)(),n=t.search?String(t.search):"",[a,r]=(0,N.useState)(!1),[l,c]=(0,N.useState)(null),d=(0,m.of)(Be),v=L.TP.hasPermission(h.AccessControlAction.DataSourcesCreate),A=x=>{s({search:x.currentTarget.value.toLowerCase()})},{error:S,plugins:D,isLoading:I}=(0,W.PW)({keyword:n,type:P.QE.datasource}),B=(0,N.useMemo)(()=>D.map(x=>({id:x.id,name:x.name,description:x.description,logo:x.info.logos.small,url:p.b.DataSourcesDetails.replace(":id",x.id),angularDetected:x.angularDetected})),[D]),b=(x,H)=>{v||(x.preventDefault(),x.stopPropagation(),z(H))},z=x=>{r(!0),c(x)},w=()=>{r(!1),c(null)},E=(0,N.useMemo)(()=>!I&&!S&&D.length<1,[I,S,D]),K=(0,T.t)("connections.connect-data.category-header-label","Data sources");return(0,e.jsxs)(e.Fragment,{children:[l&&(0,e.jsx)(Ie,{item:l,isOpen:a,onDismiss:w}),(0,e.jsx)($e,{onChange:A,value:n}),(0,e.jsx)("div",{className:d.spacer}),(0,e.jsx)(Te,{iconName:"database",label:K}),I?(0,e.jsx)(G._,{text:"Loading..."}):S?(0,e.jsxs)("p",{children:["Error: ",S.message]}):(0,e.jsx)(be,{items:B,onClickItem:b}),E&&(0,e.jsx)(R.p,{variant:"not-found",message:(0,T.t)("connections.connect-data.empty-message","No results matching your query were found")})]})}function Oe(){return(0,e.jsx)(C.Y,{navId:"connections-add-new-connection",children:(0,e.jsx)(C.Y.Contents,{children:(0,e.jsx)(Re,{})})})}var F=o(42418),ne=o(39938),Fe=o(93418);function ze(){const t="standalone-plugin-page-/connections/add-new-connection",{id:s}=(0,g.g)(),r=!!(0,h.useSelector)(l=>l.navIndex)[t]?t:"connections-add-new-connection";return(0,e.jsx)(Fe.V,{pluginId:s,navId:r,notFoundComponent:(0,e.jsx)(ke,{}),notFoundNavModel:{text:"Unknown datasource",subTitle:"No datasource with this ID could be found.",active:!0}})}function ke(){const{id:t}=(0,g.g)();return(0,e.jsxs)(F.F,{severity:h.AppNotificationSeverity.Warning,title:"",children:["Maybe you mistyped the URL or the plugin with the id ",(0,e.jsx)(ne.E,{text:t,color:"orange"})," is unavailable.",(0,e.jsx)("br",{}),"To see a list of available datasources please ",(0,e.jsx)("a",{href:p.b.AddNewConnection,children:"click here"}),"."]})}function Ze(){const t=L.TP.hasPermission(h.AccessControlAction.DataSourcesCreate),s=(0,u.aM)();return t?(0,e.jsx)(j.z9,{icon:"plus",href:M.$.appSubUrl+s.New,children:(0,e.jsx)(T.x6,{i18nKey:"data-sources.datasource-add-button.label",children:"Add new data source"})}):null}var He=o(72109),y=o(4589),Z=o(70255),Ue=o(78369),ae=o(67061),oe=o(11959);function Q({dataSource:t,hasWriteRights:s,hasExploreRights:n}){const a=(0,u.aM)(),r=M.$.appSubUrl+a.Edit.replace(/:uid/gi,t.uid),l=(0,m.of)(Ke);return(0,e.jsxs)(f.Z,{href:s?r:void 0,children:[(0,e.jsx)(f.Z.Heading,{children:t.name}),(0,e.jsx)(f.Z.Figure,{children:(0,e.jsx)("img",{src:t.typeLogoUrl,alt:"",height:"40px",width:"40px",className:l.logo})}),(0,e.jsx)(f.Z.Meta,{children:[t.typeName,t.url,t.isDefault&&(0,e.jsx)(Ue.v,{name:"default",colorIndex:1},"default-tag")]}),(0,e.jsxs)(f.Z.Tags,{children:[(0,e.jsx)(j.z9,{icon:"apps",fill:"outline",variant:"secondary",href:`dashboard/new-with-ds/${t.uid}`,onClick:()=>{(0,y.TR)({grafana_version:M.$.buildInfo.version,datasource_uid:t.uid,plugin_name:t.typeName,path:location.pathname})},children:"Build a dashboard"}),n&&(0,e.jsx)(j.z9,{icon:"compass",fill:"outline",variant:"secondary",className:l.button,href:(0,oe.h)(t),onClick:()=>{(0,y.M1)({grafana_version:M.$.buildInfo.version,datasource_uid:t.uid,plugin_name:t.typeName,path:location.pathname})},children:"Explore"})]})]})}function We({hasExploreRights:t}){const s=(0,m.of)(Ye);return(0,e.jsxs)(f.Z,{children:[(0,e.jsx)(f.Z.Heading,{children:(0,e.jsx)(Z.A,{width:140})}),(0,e.jsx)(f.Z.Figure,{children:(0,e.jsx)(Z.A,{width:40,height:40,containerClassName:s.figure})}),(0,e.jsx)(f.Z.Meta,{children:(0,e.jsx)(Z.A,{width:120})}),(0,e.jsx)(f.Z.Tags,{children:(0,e.jsxs)(ae.B,{direction:"row",gap:2,children:[(0,e.jsx)(Z.A,{height:32,width:179,containerClassName:s.button}),t&&(0,e.jsx)(Z.A,{height:32,width:107,containerClassName:s.button})]})})]})}Q.Skeleton=We;const Ye=()=>({button:(0,i.css)({lineHeight:1}),figure:(0,i.css)({lineHeight:1})}),Ke=t=>({logo:(0,i.css)({objectFit:"contain"}),button:(0,i.css)({marginLeft:t.spacing(2)})});var Ve=o(72557);const J="alpha-asc",re="alpha-desc",Ge=[{label:"Sort by A\u2013Z",value:J},{label:"Sort by Z\u2013A",value:re}];function Qe(){const t=(0,h.useDispatch)(),s=(0,N.useCallback)(c=>t((0,u.Bs)(c)),[t]),n=(0,h.useSelector)(({dataSources:c})=>(0,u.xs)(c)),a=(0,N.useCallback)(c=>t((0,u.Tk)(c.value===J)),[t]),r=(0,h.useSelector)(({dataSources:c})=>(0,u.lv)(c)),l={onChange:a,value:r?J:re,getSortOptions:()=>Promise.resolve(Ge)};return(0,e.jsx)(Ve.A,{searchQuery:n,setSearchQuery:s,sortPicker:l},"action-bar")}function Je(){const{isLoading:t}=(0,u.US)(),s=(0,h.useSelector)(c=>(0,u.zC)(c.dataSources)),n=(0,h.useSelector)(({dataSources:c})=>(0,u.wC)(c)),a=L.TP.hasPermission(h.AccessControlAction.DataSourcesCreate),r=L.TP.hasPermission(h.AccessControlAction.DataSourcesWrite),l=L.TP.hasAccessToExplore();return(0,e.jsx)(Xe,{dataSources:s,dataSourcesCount:n,isLoading:t,hasCreateRights:a,hasWriteRights:r,hasExploreRights:l})}function Xe({dataSources:t,dataSourcesCount:s,isLoading:n,hasCreateRights:a,hasWriteRights:r,hasExploreRights:l}){const c=(0,m.of)(qe),d=(0,u.aM)(),v=(0,g.zy)();if((0,N.useEffect)(()=>{(0,y.kg)({grafana_version:M.$.buildInfo.version,path:v.pathname})},[v]),!n&&s===0)return(0,e.jsx)(R.p,{variant:"call-to-action",button:(0,e.jsx)(j.z9,{disabled:!a,href:d.New,icon:"database",size:"lg",children:(0,e.jsx)(T.x6,{i18nKey:"data-source-list.empty-state.button-title",children:"Add data source"})}),message:(0,T.t)("data-source-list.empty-state.title","No data sources defined"),children:(0,e.jsxs)(T.x6,{i18nKey:"data-source-list.empty-state.pro-tip",children:["You can also define data sources through configuration files."," ",(0,e.jsx)(He.Y,{external:!0,href:"http://docs.grafana.org/administration/provisioning/?utm_source=grafana_ds_list#data-sources",children:"Learn more"})]})});const A=()=>n?new Array(20).fill(null).map((S,D)=>(0,e.jsx)(Q.Skeleton,{hasExploreRights:l},D)):t.map(S=>(0,e.jsx)("li",{children:(0,e.jsx)(Q,{dataSource:S,hasWriteRights:r,hasExploreRights:l})},S.uid));return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Qe,{}),t.length===0&&!n?(0,e.jsx)(R.p,{variant:"not-found",message:(0,T.t)("data-sources.empty-state.message","No data sources found")}):(0,e.jsx)("ul",{className:c.list,children:A()})]})}const qe=t=>({list:(0,i.css)({listStyle:"none",display:"grid"})});function _e(){const s=(0,h.useSelector)(({dataSources:n})=>(0,u.wC)(n))>0?(0,e.jsx)(Ze,{}):void 0;return(0,e.jsx)(C.Y,{navId:"connections-datasources",actions:s,children:(0,e.jsx)(C.Y.Contents,{children:(0,e.jsx)(Je,{})})})}var X=o(39419),ie=o(3673),et=o(20701),tt=o(38348);function st({uid:t}){(0,u.oU)(t);const s=(0,h.useDispatch)(),n=(0,h.useSelector)(d=>d.dataSources.dataSource),a=(0,h.useSelector)(d=>d.plugins.dashboards),r=(0,h.useSelector)(d=>d.plugins.isLoadingPluginDashboards);(0,N.useEffect)(()=>{n.id>0&&s((0,et.h9)())},[s,n.id]);const l=(d,v)=>{s((0,ie.Q9)({pluginId:d.pluginId,path:d.path,overwrite:v,inputs:[{name:"*",type:"datasource",pluginId:n.type,value:n.name}]},d.title))},c=({uid:d})=>{s((0,ie.TA)(d))};return(0,e.jsx)(nt,{dashboards:a,isLoading:r,onImportDashboard:l,onRemoveDashboard:c})}const nt=({isLoading:t,dashboards:s,onImportDashboard:n,onRemoveDashboard:a})=>t?(0,e.jsx)(X.A,{}):(0,e.jsx)(tt.A,{dashboards:s,onImport:n,onRemove:a});var ce=o(19347),le=o(17422),q=o(11084),_=o(74984);function de(t){const{uid:s}=(0,g.g)(),n=(0,g.zy)(),a=(0,q.xw)(s),r=(0,q.S4)(a.type),l=(0,W.ob)(a.type),c=new URLSearchParams(n.search),d=t||c.get("page"),{plugin:v,loadError:A,loading:S}=(0,q._e)(),D=(0,ce.l)()?.getInstanceSettings(s),I=!!(D?.meta?.alerting??!1),B=D?.type==="alertmanager",b=I||B,z=(0,h.useSelector)(x=>x.navIndex),w=d?`datasource-${d}-${s}`:`datasource-settings-${s}`;let E={node:{text:"Data Source Nav Node"},main:{text:"Data Source Nav Node"}};if(A){const x={text:A,subTitle:"Data Source Error",icon:"exclamation-triangle"};E={node:x,main:x}}return(S||!v)&&(E=(0,le.tc)(z,w,(0,_.$m)("settings"))),v&&(E=(0,le.tc)(z,w,(0,_.Vh)((0,_.R4)(a,v),d||"settings"))),{navId:"connections-datasources",pageNav:{...E.main,dataSourcePluginName:l?.name||v?.meta.name||"",active:!0,text:a.name,subTitle:`Type: ${r.name}`,children:(E.main.children||[]).map(x=>({...x,url:x.url?.replace("datasources/edit/","/connections/datasources/edit/")}))},dataSourceHeader:{alertingSupported:b}}}function at(){const{uid:t}=(0,g.g)(),{navId:s,pageNav:n}=de("dashboards");return(0,e.jsx)(C.Y,{navId:s,pageNav:n,children:(0,e.jsx)(C.Y.Contents,{children:(0,e.jsx)(st,{uid:t})})})}var ee=o(2543),ot=o(69129),rt=o(74135),ue=o(76287),it=o(3197),ct=o(28138),$=o(13544),ge=o(14186),lt=o(15292);function dt({dataSourceName:t,isDefault:s,onDefaultChange:n,onNameChange:a,disabled:r}){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)("div",{className:"gf-form-group","aria-label":"Datasource settings page basic settings",children:(0,e.jsxs)("div",{className:"gf-form-inline",children:[(0,e.jsx)("div",{className:"gf-form max-width-30",children:(0,e.jsx)(ge.I,{label:"Name",tooltip:`The name is used when you select the data source in panels. The default data source is
              'preselected in new panels.`,grow:!0,disabled:r,labelWidth:14,children:(0,e.jsx)(se.p,{id:"basic-settings-name",type:"text",value:t,placeholder:"Name",onChange:l=>a(l.currentTarget.value),required:!0,"data-testid":$.Tp.pages.DataSource.name})})}),(0,e.jsx)(ge.I,{label:"Default",labelWidth:8,disabled:r,children:(0,e.jsx)(lt.K,{id:"basic-settings-default",value:s,onChange:l=>{n(l.currentTarget.checked)}})})]})})})}function as({enabled:t}){const s=useStyles2(ut);return jsx("div",{className:s.badge,children:t?jsx(Badge,{color:"green",icon:"check-circle",text:"Alerting supported"}):jsx(Badge,{color:"orange",icon:"exclamation-triangle",text:"Alerting not supported"})})}const ut=t=>({badge:css`
    margin-bottom: ${t.spacing(2)};
  `});function gt({canSave:t,canDelete:s,onDelete:n,onSubmit:a,onTest:r}){return(0,e.jsxs)("div",{className:"gf-form-button-row",children:[(0,e.jsx)(j.$n,{type:"button",variant:"destructive",disabled:!s,onClick:n,"data-testid":$.Tp.pages.DataSource.delete,children:"Delete"}),t&&(0,e.jsx)(j.$n,{type:"submit",variant:"primary",disabled:!t,onClick:a,"data-testid":$.Tp.pages.DataSource.saveAndTest,children:"Save & test"}),!t&&(0,e.jsx)(j.$n,{variant:"primary",onClick:r,children:"Test"})]})}var ht=o(61268),pt=o(61680),xt=o(2913);const mt="datasources.settings.cloudInfoBox.isDismissed";function ft({dataSource:t}){let s="",n="";if(t.readOnly||(t.version??0)>2||xt.config.buildInfo.edition!==ht.r.OpenSource)return null;switch(t.type){case"prometheus":s="Prometheus",n="Loki";break;case"loki":s="Loki",n="Prometheus";break;default:return null}return(0,e.jsx)(pt.b,{storageKey:mt,defaultValue:!1,children:(a,r)=>a?null:(0,e.jsxs)(F.F,{title:`Configure your ${s} data source below`,severity:"info",bottomSpacing:4,onRemove:()=>{r(!0)},children:["Or skip the effort and get ",s," (and ",n,") as fully-managed, scalable, and hosted data sources from Grafana Labs with the"," ",(0,e.jsx)("a",{className:"external-link",href:`https://grafana.com/signup/cloud/connect-account?src=grafana-oss&cnt=${t.type}-settings`,target:"_blank",rel:"noreferrer",title:"The free plan includes 10k active metrics and 50gb storage.",children:"free-forever Grafana Cloud plan"}),"."]})})}const vt="This data source was added by config and cannot be modified using the UI. Please contact your server admin to update this data source.";function he(){return(0,e.jsx)(F.F,{"data-testid":$.Tp.pages.DataSource.readOnly,severity:"info",title:"Provisioned data source",children:vt})}function jt({dataSourceRights:t,onDelete:s}){const{readOnly:n,hasDeleteRights:a}=t,r=!n&&a,l=()=>history.back();return(0,e.jsxs)(e.Fragment,{children:[n&&(0,e.jsx)(he,{}),(0,e.jsxs)("div",{className:"gf-form-button-row",children:[r&&(0,e.jsx)(j.$n,{type:"submit",variant:"destructive",onClick:s,children:"Delete"}),(0,e.jsx)(j.$n,{variant:"secondary",fill:"outline",type:"button",onClick:l,children:"Back"})]})]})}const St="You are not allowed to modify this data source. Please contact your server admin to update this data source.";function yt(){return(0,e.jsx)(F.F,{severity:"info",title:"Missing rights",children:St})}function Dt({plugin:t,pageId:s}){if(!t||!t.configPages)return null;const n=t.configPages.find(({id:a})=>a===s);return n?(0,e.jsx)(n.body,{plugin:t,query:{}}):(0,e.jsxs)("div",{children:["Page not found: ",n]})}var Ct=o(7376);class Nt extends N.PureComponent{constructor(s){super(s),this.element=null,this.onModelChanged=n=>{this.props.onModelChange(n)},this.scopeProps={ctrl:{datasourceMeta:s.dataSourceMeta,current:(0,ee.cloneDeep)(s.dataSource)},onModelChanged:this.onModelChanged},this.onModelChanged=this.onModelChanged.bind(this)}componentDidMount(){const{plugin:s}=this.props;if(this.element&&!s.components.ConfigEditor){const n=(0,Ct.E)(),a='<plugin-component type="datasource-config-ctrl" />';this.component=n.load(this.element,this.scopeProps,a)}}componentDidUpdate(s){const{plugin:n}=this.props;!n.components.ConfigEditor&&this.props.dataSource!==s.dataSource&&(this.scopeProps.ctrl.current=(0,ee.cloneDeep)(this.props.dataSource),this.component?.digest())}componentWillUnmount(){this.component&&this.component.destroy()}render(){const{plugin:s,dataSource:n}=this.props;return s?(0,e.jsx)("div",{ref:a=>this.element=a,children:s.components.ConfigEditor&&(0,N.createElement)(s.components.ConfigEditor,{options:n,onOptionsChange:this.onModelChanged})}):null}}var bt=o(10803);function Pt({state:t}){return(0,e.jsxs)("div",{className:"gf-form",children:[(0,e.jsx)("div",{className:"gf-form-label width-10",children:"Plugin state"}),(0,e.jsx)("div",{className:"gf-form-label gf-form-label--transparent",children:(0,e.jsx)(bt.p,{state:t})})]})}var pe=o(50720);const Tt=(t,s)=>({content:(0,i.css)({color:t.colors.text.secondary,paddingTop:s?t.spacing(1):0,maxHeight:"50vh",overflowY:"auto"}),disabled:(0,i.css)({pointerEvents:"none",color:t.colors.text.secondary})}),xe=({title:t,exploreUrl:s,dataSourceId:n,onDashboardLinkClicked:a})=>{const r=(0,m.$j)(),c=Tt(r,!!t),d=L.TP.hasAccessToExplore();return(0,e.jsxs)("div",{className:c.content,children:["Next, you can start to visualize data by"," ",(0,e.jsx)(pe.N,{"aria-label":"Create a dashboard",href:`/dashboard/new-with-ds/${n}`,className:"external-link",onClick:a,children:"building a dashboard"}),", or by querying data in the"," ",(0,e.jsx)(pe.N,{"aria-label":"Explore data",className:(0,i.cx)("external-link",{[`${c.disabled}`]:!d,"test-disabled":!d}),href:s,children:"Explore view"}),"."]})};xe.displayName="AlertSuccessMessage";const At=new Set(["success","info","warning","error"]),It=t=>At.has(t),Et=t=>t.toLowerCase()==="ok"?"success":It(t)?t:"info";function Lt({testingStatus:t,exploreUrl:s,dataSource:n}){const a=Et(t?.status??"error"),r=t?.message,l=t?.details?.message,c=t?.details?.verboseMessage,d=()=>{(0,y.TR)({grafana_version:M.$.buildInfo.version,datasource_uid:n.uid,plugin_name:n.typeName,path:location.pathname})},v=(0,m.of)(Mt);return r?(0,e.jsx)("div",{className:(0,i.cx)("gf-form-group",v.container),children:(0,e.jsx)(F.F,{severity:a,title:r,"data-testid":$.Tp.pages.DataSource.alert,children:t?.details&&(0,e.jsxs)(e.Fragment,{children:[l,a==="success"?(0,e.jsx)(xe,{title:r,exploreUrl:s,dataSourceId:n.uid,onDashboardLinkClicked:d}):null,c?(0,e.jsx)("details",{style:{whiteSpace:"pre-wrap"},children:String(c)}):null]})})}):null}const Mt=t=>({container:(0,i.css)({paddingTop:t.spacing(3)})});function wt({uid:t,pageId:s}){(0,u.oU)(t);const n=(0,h.useDispatch)(),a=(0,u.xw)(t),r=(0,u.S4)(a.type),l=(0,u._e)(),c=(0,u.u1)(t),d=(0,u.Tn)(t),v=(0,u.$k)(),A=(0,u.BY)(t),S=(0,u.k9)(),D=b=>n((0,u.C_)(b)),I=b=>n((0,u.rb)(b)),B=b=>n((0,u.jz)(b));return(0,e.jsx)($t,{pageId:s,dataSource:a,dataSourceMeta:r,dataSourceSettings:l,dataSourceRights:c,exploreUrl:d,onDelete:v,onDefaultChange:D,onNameChange:I,onOptionsChange:B,onTest:A,onUpdate:S})}function $t({pageId:t,dataSource:s,dataSourceMeta:n,dataSourceSettings:a,dataSourceRights:r,exploreUrl:l,onDelete:c,onDefaultChange:d,onNameChange:v,onOptionsChange:A,onTest:S,onUpdate:D}){const{plugin:I,loadError:B,testingStatus:b,loading:z}=a,{readOnly:w,hasWriteRights:E,hasDeleteRights:K}=r,x=s.id>0,H=(0,ce.l)()?.getInstanceSettings(s.uid),je=async k=>{k.preventDefault(),(0,y._i)("save_and_test");try{await D({...s}),(0,y.m3)({item:"success"}),ct.A.publish(new ot.wE)}catch{(0,y.m3)({item:"fail"});return}S()},ts=rt.S.DataSourceConfig,{extensions:Se}=(0,it.kr)({extensionPointId:ts}),ss=(0,N.useMemo)(()=>{const k=["grafana-pdc-app","grafana-auth-app"];return Se.filter(V=>k.includes(V.pluginId))},[Se]);return B?(0,e.jsx)(jt,{dataSourceRights:r,onDelete:()=>{(0,y._i)("delete"),c()}}):z?(0,e.jsx)(X.A,{}):!x||!H?null:t?(0,e.jsx)(ue.p,{instanceSettings:H,children:(0,e.jsx)(Dt,{pageId:t,plugin:I})}):(0,e.jsxs)("form",{onSubmit:je,children:[!E&&(0,e.jsx)(yt,{}),w&&(0,e.jsx)(he,{}),n.state&&(0,e.jsx)(Pt,{state:n.state}),(0,e.jsx)(ft,{dataSource:s}),(0,e.jsx)(dt,{dataSourceName:s.name,isDefault:s.isDefault,onDefaultChange:d,onNameChange:v,disabled:w||!E}),I&&(0,e.jsx)(ue.p,{instanceSettings:H,children:(0,e.jsx)(Nt,{plugin:I,dataSource:s,dataSourceMeta:n,onModelChange:A})}),ss.map(k=>{const V=k.component;return(0,e.jsx)("div",{children:(0,e.jsx)(V,{context:{dataSource:(0,ee.omit)(s,["secureJsonData"]),dataSourceMeta:n,testingStatus:b,setJsonData:ns=>A({...s,jsonData:{...s.jsonData,...ns}})}})},k.id)}),(0,e.jsx)(Lt,{testingStatus:b,exploreUrl:l,dataSource:s}),(0,e.jsx)(gt,{onSubmit:je,onDelete:()=>{(0,y._i)("delete"),c()},onTest:()=>{(0,y._i)("test"),S()},canDelete:!w&&K,canSave:!w&&E})]})}function Bt({uid:t}){const s=(0,u.xw)(t),n=L.TP.hasAccessToExplore();return(0,e.jsxs)(e.Fragment,{children:[n&&(0,e.jsx)(j.z9,{variant:"secondary",size:"sm",href:(0,oe.h)(s),onClick:()=>{(0,y._i)("explore"),(0,y.M1)({grafana_version:M.$.buildInfo.version,datasource_uid:s.uid,plugin_name:s.typeName,path:location.pathname})},children:"Explore data"}),(0,e.jsx)(j.z9,{size:"sm",variant:"secondary",href:`dashboard/new-with-ds/${s.uid}`,onClick:()=>{(0,y._i)("build_a_dashboard"),(0,y.TR)({grafana_version:M.$.buildInfo.version,datasource_uid:s.uid,plugin_name:s.typeName,path:location.pathname})},children:"Build a dashboard"})]})}const Rt=t=>{const s=[],n=t.alertingSupported;return s.push({label:"Type",value:t.dataSourcePluginName}),s.push({label:"Alerting",value:(0,e.jsx)(ne.E,{color:n?"green":"red",text:n?"Supported":"Not supported"})}),s};function Ot({title:t}){const s=(0,m.of)(Ft);return(0,e.jsx)("div",{className:s.container,children:(0,e.jsx)("h1",{className:s.title,children:t})})}const Ft=t=>({container:(0,i.css)({marginBottom:t.spacing(2),h1:{display:"inline-block"}}),title:(0,i.css)({display:"inline-block",margin:"0 0 0 0",maxWidth:"40vw",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"})});function zt({uid:t,pageId:s}){const{navId:n,pageNav:a,dataSourceHeader:r}=de(),l=Rt({dataSourcePluginName:a.dataSourcePluginName,alertingSupported:r.alertingSupported});return(0,e.jsx)(C.Y,{navId:n,pageNav:a,renderTitle:c=>(0,e.jsx)(Ot,{title:c}),info:l,actions:(0,e.jsx)(Bt,{uid:t}),children:(0,e.jsx)(C.Y.Contents,{children:(0,e.jsx)(wt,{uid:t,pageId:s})})})}const kt=zt;function Zt(){const{uid:t}=(0,g.g)(),s=(0,g.zy)(),a=new URLSearchParams(s.search).get("page");return(0,e.jsx)(kt,{uid:t,pageId:a})}var Ht=o(67647),me=o(33552),fe=o(98624);function Ut({filterByPluginType:t}){let s=(0,W.F9)(t);const{isLoading:n}=(0,W.m5)(),a=(0,m.of)(Yt);return n||s.length===0?null:(0,e.jsxs)(F.F,{title:"Unsigned plugins were found during plugin initialization. Grafana Labs cannot guarantee the integrity of these plugins. We recommend only using signed plugins.","data-testid":$.Tp.pages.PluginsList.signatureErrorNotice,severity:"warning",children:[(0,e.jsx)("p",{children:"The following plugins are disabled and not shown in the list below:"}),(0,e.jsx)(me.B,{items:s,className:a.list,renderItem:r=>(0,e.jsx)("div",{className:a.wrapper,children:(0,e.jsxs)(ae.B,{justifyContent:"flex-start",alignItems:"center",children:[(0,e.jsx)("strong",{children:r.pluginId}),(0,e.jsx)(fe.B,{status:Wt(r.errorCode),className:a.badge})]})})}),(0,e.jsxs)("a",{href:"https://grafana.com/docs/grafana/latest/plugins/plugin-signatures/",className:a.docsLink,target:"_blank",rel:"noreferrer",children:[(0,e.jsx)(Y.I,{name:"book"})," Read more about plugin signing"]})]})}function Wt(t){switch(t){case P.ZK.invalidSignature:return P.Ac.invalid;case P.ZK.missingSignature:return P.Ac.missing;case P.ZK.modifiedSignature:return P.Ac.modified;default:return P.Ac.missing}}function Yt(t){return{list:(0,i.css)({listStyleType:"circle"}),wrapper:(0,i.css)({marginTop:t.spacing(1)}),badge:(0,i.css)({marginTop:0}),docsLink:(0,i.css)({display:"inline-block",color:t.colors.text.link,marginTop:t.spacing(2)})}}function Kt({onClick:t,dataSourcePlugin:s}){const n=s.module==="phantom",a=!n&&!s.unlicensed,r=s.info?.links?.length>0?s.info.links[0]:null,l=r?.target??"_blank",c=(0,m.of)(Vt);return(0,e.jsxs)(f.Z,{className:(0,i.cx)(c.card,"card-parent"),onClick:a?t:()=>{},children:[(0,e.jsx)(f.Z.Heading,{className:c.heading,"aria-label":$.Tp.pages.AddDataSource.dataSourcePluginsV2(s.name),children:s.name}),(0,e.jsx)(f.Z.Figure,{align:"center",className:c.figure,children:(0,e.jsx)("img",{className:c.logo,src:s.info.logos.small,alt:""})}),(0,e.jsx)(f.Z.Description,{className:c.description,children:s.info.description}),!n&&(0,e.jsx)(f.Z.Meta,{className:c.meta,children:(0,e.jsx)(fe.B,{status:s.signature})}),(0,e.jsx)(f.Z.Actions,{className:c.actions,children:r&&(0,e.jsx)(j.z9,{"aria-label":`${s.name}, learn more.`,href:`${r.url}?utm_source=grafana_add_ds`,onClick:d=>d.stopPropagation(),rel:"noopener",target:l,variant:"secondary",children:r.name})})]})}function Vt(t){return{heading:(0,i.css)({fontSize:t.v1.typography.heading.h5,fontWeight:"inherit"}),figure:(0,i.css)({width:"inherit",marginRight:"0px","> img":{width:t.spacing(7)}}),meta:(0,i.css)({marginTop:"6px",position:"relative"}),description:(0,i.css)({margin:"0px",fontSize:t.typography.size.sm}),actions:(0,i.css)({position:"relative",alignSelf:"center",marginTop:"0px",opacity:0,".card-parent:hover &, .card-parent:focus-within &":{opacity:1}}),card:(0,i.css)({gridTemplateAreas:`
        "Figure   Heading   Actions"
        "Figure Description Actions"
        "Figure    Meta     Actions"
        "Figure     -       Actions"`}),logo:(0,i.css)({marginRight:t.v1.spacing.lg,marginLeft:t.v1.spacing.sm,width:t.spacing(7),maxHeight:t.spacing(7)})}}function ve({dataSourcePlugins:t,onClickDataSourceType:s}){return!t||!t.length?null:(0,e.jsx)(me.B,{items:t,getItemKey:n=>n.id.toString(),renderItem:n=>(0,e.jsx)(Kt,{dataSourcePlugin:n,onClick:()=>s(n)}),className:(0,i.css)`
        > li {
          margin-bottom: 2px;
        }
      `})}function Gt({categories:t,onClickDataSourceType:s}){const n=`${p.b.AddNewConnection}?cat=data-source`,a=(0,m.of)(Qt);return(0,e.jsxs)(e.Fragment,{children:[t.map(({id:r,title:l,plugins:c})=>(0,e.jsxs)("div",{className:a.category,children:[(0,e.jsx)("div",{className:a.header,id:r,children:l}),(0,e.jsx)(ve,{dataSourcePlugins:c,onClickDataSourceType:s})]},r)),(0,e.jsx)("div",{className:a.more,children:(0,e.jsx)(j.z9,{variant:"secondary",href:n,target:"_self",rel:"noopener",children:"Find more data source plugins"})})]})}const Qt=t=>({category:(0,i.css)({marginBottom:t.spacing(2)}),header:(0,i.css)({fontSize:t.typography.h5.fontSize,marginBottom:t.spacing(1)}),more:(0,i.css)({margin:t.spacing(4),textAlign:"center"})});function Jt(){(0,u.hx)();const t=(0,h.useDispatch)(),s=(0,h.useSelector)(d=>(0,u.hp)(d.dataSources)),n=(0,h.useSelector)(d=>d.dataSources.dataSourceTypeSearchQuery),a=(0,h.useSelector)(d=>d.dataSources.isLoadingDataSourcePlugins),r=(0,h.useSelector)(d=>d.dataSources.categories),l=(0,u.Um)(),c=d=>t((0,u.eB)(d));return(0,e.jsx)(Xt,{dataSources:s,dataSourceCategories:r,searchQuery:n,isLoading:a,onAddDataSource:l,onSetSearchQuery:c})}function Xt({dataSources:t,dataSourceCategories:s,searchQuery:n,isLoading:a,onAddDataSource:r,onSetSearchQuery:l}){const c=(0,u.aM)();return a?(0,e.jsx)(X.A,{}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"page-action-bar",children:[(0,e.jsx)(Ht.Z,{value:n,onChange:l,placeholder:"Filter by name or type"}),(0,e.jsx)("div",{className:"page-action-bar__spacer"}),(0,e.jsx)(j.z9,{href:c.List,fill:"outline",variant:"secondary",icon:"arrow-left",children:"Cancel"})]}),!n&&(0,e.jsx)(Ut,{filterByPluginType:P.QE.datasource}),(0,e.jsxs)("div",{children:[n&&(0,e.jsx)(ve,{dataSourcePlugins:t,onClickDataSourceType:r}),!n&&(0,e.jsx)(Gt,{categories:s,onClickDataSourceType:r})]})]})}function qt(){return(0,e.jsx)(C.Y,{navId:"connections-datasources",pageNav:{text:"Add data source",subTitle:"Choose a data source type",active:!0},children:(0,e.jsx)(C.Y.Contents,{children:(0,e.jsx)(Jt,{})})})}function _t(){const{search:t}=(0,g.zy)();return(0,e.jsx)(g.rd,{to:{pathname:p.b.AddNewConnection,search:t}})}function es(){const s=!!(0,h.useSelector)(n=>n.navIndex)["standalone-plugin-page-/connections/add-new-connection"];return(0,e.jsx)(u.CR.Provider,{value:{New:p.b.DataSourcesNew,List:p.b.DataSources,Edit:p.b.DataSourcesEdit,Dashboards:p.b.DataSourcesDashboards},children:(0,e.jsxs)(g.dO,{children:[(0,e.jsx)(g.qh,{exact:!0,sensitive:!0,path:p.b.Base,component:()=>(0,e.jsx)(g.rd,{to:p.b.AddNewConnection})}),(0,e.jsx)(g.qh,{exact:!0,sensitive:!0,path:p.b.DataSources,component:_e}),(0,e.jsx)(g.qh,{exact:!0,sensitive:!0,path:p.b.DataSourcesNew,component:qt}),(0,e.jsx)(g.qh,{exact:!0,sensitive:!0,path:p.b.DataSourcesDetails,component:ze}),(0,e.jsx)(g.qh,{exact:!0,sensitive:!0,path:p.b.DataSourcesEdit,component:Zt}),(0,e.jsx)(g.qh,{exact:!0,sensitive:!0,path:p.b.DataSourcesDashboards,component:at}),!s&&(0,e.jsx)(g.qh,{exact:!0,sensitive:!0,path:p.b.AddNewConnection,component:Oe}),(0,e.jsx)(g.qh,{exact:!0,path:p.b.ConnectDataOutdated,component:_t}),(0,e.jsx)(g.rd,{from:`${p.b.Base}/your-connections/:page`,to:`${p.b.Base}/:page`}),(0,e.jsx)(g.rd,{from:p.b.YourConnectionsOutdated,to:p.b.DataSources}),(0,e.jsx)(g.qh,{component:()=>(0,e.jsx)(g.rd,{to:"/notfound"})})]})})}}}]);

//# sourceMappingURL=Connections.b268371f88912c01838f.js.map