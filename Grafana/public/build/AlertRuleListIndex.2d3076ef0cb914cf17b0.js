"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[3511],{40715:(ae,F,a)=>{a.d(F,{o:()=>E});var s=a(96540),e=a(31678),g=a(97007);function E(x){const C=(0,e.useDispatch)(),A=(0,s.useRef)(x);A.current=x,(0,s.useEffect)(()=>()=>{C((0,g.N)({cleanupAction:A.current}))},[C])}},31987:(ae,F,a)=>{a.r(F),a.d(F,{CreateAlertButton:()=>mt,default:()=>fa});var s=a(32196),e=a(96540),g=a(58476),E=a(41053),x=a(10940),C=a(76885),A=a(66602),R=a(40845),S=a(55852),T=a(83277),D=a(31678),v=a(25027),$=a(37959),P=a(67061),ve=a(76442),Q=a(7521),X=a(41520);const le=()=>{const{canCreateGrafanaRules:t,canCreateCloudRules:n}=(0,X.V)(),r=(0,R.of)(de);return t||n?e.createElement("div",null,e.createElement("p",null,"You haven't created any alert rules yet"),e.createElement(P.B,{gap:1},e.createElement("div",{className:r.newRuleCard},e.createElement(Q.A,{title:"",buttonIcon:"bell",buttonLink:"alerting/new/alerting",buttonTitle:"New alert rule",proTip:"you can also create alert rules from existing panels and queries.",proTipLink:"https://grafana.com/docs/",proTipLinkTitle:"Learn more",proTipTarget:"_blank",onClick:()=>(0,v.fH)(v.le.alertRuleFromScratch)})),e.createElement("div",{className:r.newRuleCard},e.createElement(Q.A,{title:"",buttonIcon:"plus",buttonLink:"alerting/new/recording",buttonTitle:"New recording rule",onClick:()=>(0,v.fH)(v.le.recordingRuleFromScratch)})))):e.createElement(ve.c,{message:"No rules exist yet.",callToActionElement:e.createElement("div",null)})},de=t=>({newRuleCard:(0,s.css)`
    width: calc(50% - ${t.spacing(1)});

    > div {
      height: 100%;
    }
  `});var se=a(15300),ne=a(55127),ge=a.n(ne),Ce=a(78685),W=a(42418),ee=a(56034),Z=a(61410),M=a(57220),k=a(56361),H=a(23662);function he(){const[t,n]=(0,e.useState)(!1),[r,o]=(0,Ce.A)("grafana.unifiedalerting.hideErrors",!1),l=(0,Z.$)(d=>d.dataSources),c=(0,Z.$)(d=>d.promRules),u=(0,Z.$)(d=>d.rulerRules),i=(0,R.of)(De),m=(0,e.useMemo)(()=>{const[d,f,K]=[l,c,u].map(p=>(0,M.qi)().reduce((y,I)=>{const V=p[I.name]?.error;return p[I.name]&&V&&!(0,H.$7)(p[I.name])?[...y,{dataSource:I,error:V}]:y},[])),B=c[M.hY]?.error,U=u[M.hY]?.error,O=[];return B&&O.push(e.createElement(e.Fragment,null,"Failed to load Grafana rules state: ",B.message||"Unknown error.")),U&&O.push(e.createElement(e.Fragment,null,"Failed to load Grafana rules config: ",U.message||"Unknown error.")),d.forEach(({dataSource:p,error:y})=>{O.push(e.createElement(e.Fragment,null,"Failed to load the data source configuration for"," ",e.createElement("a",{href:(0,k.GD)(p.uid),className:i.dsLink},p.name),": ",y.message||"Unknown error."))}),f.forEach(({dataSource:p,error:y})=>O.push(e.createElement(e.Fragment,null,"Failed to load rules state from"," ",e.createElement("a",{href:(0,k.GD)(p.uid),className:i.dsLink},p.name),": ",y.message||"Unknown error."))),K.forEach(({dataSource:p,error:y})=>O.push(e.createElement(e.Fragment,null,"Failed to load rules config from"," ",e.createElement("a",{href:(0,k.GD)(p.uid),className:i.dsLink},p.name),": ",y.message||"Unknown error."))),O},[l,c,u,i.dsLink]);return e.createElement(e.Fragment,null,!!m.length&&r&&e.createElement(ue,{count:m.length,onClick:()=>o(d=>!d)}),!!m.length&&!r&&e.createElement(W.F,{"data-testid":"cloud-rulessource-errors",title:"Errors loading rules",severity:"error",onRemove:()=>o(!0)},t&&m.map((d,f)=>e.createElement("div",{key:f},d)),!t&&e.createElement(e.Fragment,null,e.createElement("div",null,m[0]),m.length>=2&&e.createElement(S.$n,{className:i.moreButton,fill:"text",icon:"angle-right",size:"sm",onClick:()=>n(!0)},m.length-1," more ",ge()("error",m.length-1)))))}const ue=({count:t,onClick:n})=>{const r=(0,R.of)(De);return e.createElement("div",{className:r.floatRight},e.createElement(ee.m,{content:"Show all errors",placement:"bottom"},e.createElement(S.$n,{fill:"text",variant:"destructive",icon:"exclamation-triangle",onClick:n},t>1?e.createElement(e.Fragment,null,t," errors"):e.createElement(e.Fragment,null,"1 error"))))},De=t=>({moreButton:(0,s.css)`
    padding: 0;
  `,floatRight:(0,s.css)`
    display: flex;
    justify-content: flex-end;
  `,dsLink:(0,s.css)`
    font-weight: ${t.typography.fontWeightBold};
  `});var te=a(19073),Ye=a(64853),xe=a(39558),Te=a(62930),Ve=a(19384),we=a(15054),Je=a(98439),Qe=a(22620),Pe=a(88467),Ne=a(13544),Xe=a(66864),Ee=a(14578),Le=a(39938),dt=a(96374),gt=a(11167),Et=a(83903),Me=a(23770),Ze=a(64047),ke=a(82437),be=a(79938),Fe=a(16293),Be=a(76648),$e=a(84029);function pt({folder:t,onClose:n}){const[r,o]=(0,e.useState)("yaml");return e.createElement(Be.m,{title:`Export ${t.title} rules`,activeTab:r,onTabChange:o,onClose:n,formatProviders:Object.values($e.sl)},e.createElement(ft,{folder:t,exportFormat:r,onClose:n}))}function ft({folder:t,exportFormat:n,onClose:r}){const{currentData:o="",isFetching:l}=be.hK.endpoints.exportRules.useQuery({folderUid:t.uid,format:n});if(l)return e.createElement(xe._,{text:"Loading...."});const c=`${t.title}-${t.uid}`;return e.createElement(Fe.J,{format:n,textDefinition:o,downloadFileName:c,onClose:r})}function vt({folderUid:t,groupName:n,onClose:r}){const[o,l]=(0,e.useState)("yaml");return e.createElement(Be.m,{title:`Export ${n} rules`,activeTab:o,onTabChange:l,onClose:r,formatProviders:Object.values($e.sl)},e.createElement(ht,{folderUid:t,groupName:n,exportFormat:o,onClose:r}))}function ht({folderUid:t,groupName:n,exportFormat:r,onClose:o}){const{currentData:l="",isFetching:c}=be.hK.endpoints.exportRules.useQuery({folderUid:t,group:n,format:r});return c?e.createElement(xe._,{text:"Loading...."}):e.createElement(Fe.J,{format:r,textDefinition:l,downloadFileName:n,onClose:o})}var qe=a(99106),oe=a(72275),yt=a(46479),Rt=a(46942),_e=a.n(Rt),ye=a(2543),Ue=a(55244),Ct=a(37390),Re=a(9518),xt=a(99140),St=a(18461),Dt=a(30423);const Pt=t=>{const{group:n,namespace:r,onClose:o,folderUid:l}=t,i=(0,Re.dy)().find(p=>p.rulesSource===r.rulesSource&&p.name===r.name)?.groups.find(p=>p.name===n.name),[m,d]=(0,e.useState)(!1),[f,K]=(0,e.useState)(i?.rules||[]),B=(0,R.of)(We),U=(0,e.useCallback)(p=>{if(!p.destination||p.destination.index===p.source.index)return;const I=It(f,p.source.index,p.destination.index);K(I);const V=(0,M.EV)(r.rulesSource),N=(0,ye.compact)(I.map(L=>L.rulerRule));d(!0),(0,xt.JD)((0,Me.DN)({namespaceName:r.name,groupName:n.name,rulesSourceName:V,newRules:N,folderUid:l||r.name})).unwrap().finally(()=>{d(!1)})},[n.name,r.name,r.rulesSource,f,l]),O=f.map(p=>({...p,uid:String((0,St.Ns)(p.rulerRule))}));return e.createElement(Ct.a,{className:B.modal,isOpen:!0,title:e.createElement(Mt,{namespace:r,group:n}),onDismiss:o,onClickBackdrop:o},e.createElement(Ue.JY,{onDragEnd:U},e.createElement(Ue.gL,{droppableId:"alert-list",mode:"standard",renderClone:(p,y,I)=>e.createElement(et,{provided:p,rule:O[I.source.index],isClone:!0})},p=>e.createElement("div",{ref:p.innerRef,className:_e()(B.listContainer,m&&B.disabled),...p.droppableProps},O.map((y,I)=>e.createElement(Ue.sx,{key:y.uid,draggableId:y.uid,index:I,isDragDisabled:m},V=>e.createElement(et,{key:y.uid,provided:V,rule:y}))),p.placeholder))))},et=({provided:t,rule:n,isClone:r=!1,isDragging:o=!1})=>{const l=(0,R.of)(We);return e.createElement("div",{"data-testid":"reorder-alert-rule",className:_e()(l.listItem,r&&"isClone",o&&"isDragging"),ref:t.innerRef,...t.draggableProps,...t.dragHandleProps},(0,H.Z8)(n.promRule)&&e.createElement(Dt.C,{state:n.promRule.state}),(0,H.KB)(n.promRule)&&e.createElement(Le.E,{text:"Recording",color:"blue"}),e.createElement("div",{className:l.listItemName},n.name),e.createElement(Ee.I,{name:"draggabledots"}))},Mt=({namespace:t,group:n})=>{const r=(0,R.of)(We);return e.createElement("div",{className:r.header},e.createElement(Ee.I,{name:"folder"}),(0,M.Eb)(t.rulesSource)&&e.createElement(ee.m,{content:t.rulesSource.name,placement:"top"},e.createElement("img",{alt:t.rulesSource.meta.name,className:r.dataSourceIcon,src:t.rulesSource.meta.info.logos.small})),e.createElement("span",null,t.name),e.createElement(Ee.I,{name:"angle-right"}),e.createElement("span",null,n.name))},We=t=>({modal:(0,s.css)`
    max-width: 640px;
    max-height: 80%;
    overflow: hidden;
  `,listItem:(0,s.css)`
    display: flex;
    flex-direction: row;
    align-items: center;

    gap: ${t.spacing()};

    background: ${t.colors.background.primary};
    color: ${t.colors.text.secondary};

    border-bottom: solid 1px ${t.colors.border.medium};
    padding: ${t.spacing(1)} ${t.spacing(2)};

    &:last-child {
      border-bottom: none;
    }

    &.isClone {
      border: solid 1px ${t.colors.primary.shade};
    }
  `,listContainer:(0,s.css)`
    user-select: none;
    border: solid 1px ${t.colors.border.medium};
  `,disabled:(0,s.css)`
    opacity: 0.5;
    pointer-events: none;
  `,listItemName:(0,s.css)`
    flex: 1;

    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  `,header:(0,s.css)`
    display: flex;
    align-items: center;

    gap: ${t.spacing(1)};
  `,dataSourceIcon:(0,s.css)`
    width: ${t.spacing(2)};
    height: ${t.spacing(2)};
  `});function It(t,n,r){const o=Array.from(t),[l]=o.splice(n,1);return o.splice(r,0,l),o}var tt=a(92467),at=a(14618);const Ke=e.memo(({group:t,namespace:n,expandAll:r,viewMode:o})=>{const{rulesSource:l}=n,c=(0,D.useDispatch)(),u=(0,R.of)(Ot),[i,m]=(0,e.useState)(!1),[d,f]=(0,e.useState)(!1),[K,B]=(0,e.useState)(!1),[U,O]=(0,e.useState)(void 0),[p,y]=(0,e.useState)(!r),{canEditRules:I}=(0,X.V)();(0,e.useEffect)(()=>{y(!r)},[r]);const{hasRuler:V,rulerRulesLoaded:N}=(0,Et.y)(),L=t.rules[0]?.rulerRule,G=L&&(0,H.lT)(L)&&L.grafana_alert.namespace_uid||void 0,{folder:b}=(0,gt.a)(G),Y=V(l)&&N(l)&&!t.rules.find(q=>!!q.rulerRule),z=(0,H.YN)(t),ie=t.rules.some(q=>(0,H.lT)(q.rulerRule)&&q.rulerRule.grafana_alert.provenance),re=o==="list",w=o==="grouped",h=()=>{c((0,Me.g6)(n,t)),f(!1)},J=[];if(Y)J.push(e.createElement(Xe.Gy,{key:"is-deleting"},e.createElement(Te.y,null),"deleting"));else if(l===M.hY){if(G){const q=(0,k.NH)(G);b?.canSave&&(w&&!ie&&(J.push(e.createElement(oe.M,{"aria-label":"edit rule group","data-testid":"edit-group",key:"edit",icon:"pen",tooltip:"edit rule group",onClick:()=>m(!0)})),J.push(e.createElement(oe.M,{"data-testid":"reorder-group",key:"reorder",icon:"exchange-alt",tooltip:"reorder rules",className:u.rotate90,onClick:()=>B(!0)}))),re&&(J.push(e.createElement(oe.M,{"aria-label":"go to folder",key:"goto",icon:"folder-open",tooltip:"go to folder",to:q,target:"__blank"})),b?.canAdmin&&J.push(e.createElement(oe.M,{"aria-label":"manage permissions",key:"manage-perms",icon:"lock",tooltip:"manage permissions",to:q+"/permissions",target:"__blank"})))),b&&(re?J.push(e.createElement(oe.M,{"aria-label":"export rule folder","data-testid":"export-folder",key:"export-folder",icon:"download-alt",tooltip:"Export rules folder",onClick:()=>O("folder")})):w&&J.push(e.createElement(oe.M,{"aria-label":"export rule group","data-testid":"export-group",key:"export-group",icon:"download-alt",tooltip:"Export rule group",onClick:()=>O("group")})))}}else I(l.name)&&V(l)&&(z||(J.push(e.createElement(oe.M,{"aria-label":"edit rule group","data-testid":"edit-group",key:"edit",icon:"pen",tooltip:"edit rule group",onClick:()=>m(!0)})),J.push(e.createElement(oe.M,{"data-testid":"reorder-group",key:"reorder",icon:"exchange-alt",tooltip:"reorder rules",className:u.rotate90,onClick:()=>B(!0)}))),J.push(e.createElement(oe.M,{"aria-label":"delete rule group","data-testid":"delete-group",key:"delete-group",icon:"trash-alt",tooltip:"delete rule group",onClick:()=>f(!0)})));const fe=re?e.createElement(ke.c,{namespace:(0,qe.EL)(n).name}):e.createElement(ke.c,{namespace:(0,qe.EL)(n).name,group:t.name}),me=(q=!1)=>{q||(0,v.fH)(v.le.leavingRuleGroupEdit),m(!1)};return e.createElement("div",{className:u.wrapper,"data-testid":"rule-group"},e.createElement("div",{className:u.header,"data-testid":"rule-group-header"},e.createElement(Ze.e,{size:"sm",className:u.collapseToggle,isCollapsed:p,onToggle:y,"data-testid":Ne.Tp.components.AlertRules.groupToggle}),e.createElement(Ee.I,{name:p?"folder":"folder-open"}),(0,M.Eb)(l)&&e.createElement(ee.m,{content:l.name,placement:"top"},e.createElement("img",{alt:l.meta.name,className:u.dataSourceIcon,src:l.meta.info.logos.small})),e.createElement("div",{className:u.groupName,onClick:()=>y(!p)},z&&e.createElement(Le.E,{color:"purple",text:"Federated"})," ",fe),e.createElement("div",{className:u.spacer}),e.createElement("div",{className:u.headerStats},e.createElement(tt.j7,{group:t})),ie&&e.createElement(e.Fragment,null,e.createElement("div",{className:u.actionsSeparator},"|"),e.createElement("div",{className:u.actionIcons},e.createElement(Le.E,{color:"purple",text:"Provisioned"}))),!!J.length&&e.createElement(e.Fragment,null,e.createElement("div",{className:u.actionsSeparator},"|"),e.createElement("div",{className:u.actionIcons},e.createElement(P.B,{gap:.5},J)))),!p&&e.createElement(at.s,{showSummaryColumn:!0,className:u.rulesTable,showGuidelines:!0,showNextEvaluationColumn:!!t.interval,rules:t.rules}),i&&e.createElement(yt.u5,{namespace:n,group:t,onClose:()=>me(),folderUrl:b?.canEdit?(0,k.qN)(b.uid):void 0,folderUid:G}),K&&e.createElement(Pt,{group:t,folderUid:G,namespace:n,onClose:()=>B(!1)}),e.createElement(dt.u,{isOpen:d,title:"Delete group",body:e.createElement("div",null,e.createElement("p",null,'Deleting "',e.createElement("strong",null,t.name),'" will permanently remove the group and'," ",t.rules.length," alert ",ge()("rule",t.rules.length)," belonging to it."),e.createElement("p",null,"Are you sure you want to delete this group?")),onConfirm:h,onDismiss:()=>f(!1),confirmText:"Delete"}),b&&U==="folder"&&e.createElement(pt,{folder:b,onClose:()=>O(void 0)}),b&&U==="group"&&e.createElement(vt,{folderUid:b.uid,groupName:t.name,onClose:()=>O(void 0)}))});Ke.displayName="RulesGroup";const Ot=t=>({wrapper:(0,s.css)``,header:(0,s.css)`
      display: flex;
      flex-direction: row;
      align-items: center;
      padding: ${t.spacing(1)} ${t.spacing(1)} ${t.spacing(1)} 0;
      flex-wrap: nowrap;
      border-bottom: 1px solid ${t.colors.border.weak};

      &:hover {
        background-color: ${t.components.table.rowHoverBackground};
      }
    `,headerStats:(0,s.css)`
      flex-shrink: 0;

      span {
        vertical-align: middle;
      }

      ${t.breakpoints.down("sm")} {
        order: 2;
        width: 100%;
        padding-left: ${t.spacing(1)};
      }
    `,groupName:(0,s.css)`
      margin-left: ${t.spacing(1)};
      margin-bottom: 0;
      cursor: pointer;

      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    `,spacer:(0,s.css)`
      flex: 1;
    `,collapseToggle:(0,s.css)`
      background: none;
      border: none;
      margin-top: -${t.spacing(1)};
      margin-bottom: -${t.spacing(1)};

      svg {
        margin-bottom: 0;
      }
    `,dataSourceIcon:(0,s.css)`
      width: ${t.spacing(2)};
      height: ${t.spacing(2)};
      margin-left: ${t.spacing(2)};
    `,dataSourceOrigin:(0,s.css)`
      margin-right: 1em;
      color: ${t.colors.text.disabled};
    `,actionsSeparator:(0,s.css)`
      margin: 0 ${t.spacing(2)};
    `,actionIcons:(0,s.css)`
      width: 80px;
      align-items: center;

      flex-shrink: 0;
    `,rulesTable:(0,s.css)`
      margin: ${t.spacing(2,0)};
    `,rotate90:(0,s.css)`
      transform: rotate(90deg);
    `});function nt(t){return(0,e.useMemo)(()=>t.flatMap(n=>n.groups.map(r=>({namespace:n,group:r}))),[t])}const At=({namespaces:t,expandAll:n})=>{const r=(0,R.of)(Tt),o=(0,Z.$)(y=>y.dataSources),l=(0,Z.$)(y=>y.promRules),c=(0,e.useMemo)(M.qi,[]),u=nt(t),i=(0,e.useMemo)(()=>c.filter(y=>(0,Pe.ML)(l[y.name])||(0,Pe.ML)(o[y.name])),[l,o,c]),m=c.some(y=>!!l[y.name]?.result?.length),d=c.length>0,f=i.length>0,K=t.length>0,{numberOfPages:B,onPageChange:U,page:O,pageItems:p}=(0,Je.W)(u,1,we.FG);return e.createElement("section",{className:r.wrapper},e.createElement("div",{className:r.sectionHeader},e.createElement("div",{className:r.headerRow},e.createElement("h5",null,"Mimir / Cortex / Loki"),i.length?e.createElement(xe._,{className:r.loader,text:`Loading rules from ${i.length} ${ge()("source",i.length)}`}):e.createElement("div",null),e.createElement(Nt,null))),p.map(({group:y,namespace:I})=>e.createElement(Ke,{group:y,key:`${(0,M.v0)(I.rulesSource)}-${I.name}-${y.name}`,namespace:I,expandAll:n,viewMode:"grouped"})),!d&&e.createElement("p",null,"There are no Prometheus or Loki data sources configured."),d&&!f&&!K&&e.createElement("p",null,"No rules found."),!m&&f&&e.createElement(Te.y,{size:"xl",className:r.spinner}),e.createElement(Ve.d,{className:r.pagination,currentPage:O,numberOfPages:B,onNavigate:U,hideWhenSinglePage:!0}))},Tt=t=>({loader:(0,s.css)`
    margin-bottom: 0;
  `,sectionHeader:(0,s.css)`
    display: flex;
    justify-content: space-between;
  `,wrapper:(0,s.css)`
    margin-bottom: ${t.spacing(4)};
  `,spinner:(0,s.css)`
    text-align: center;
    padding: ${t.spacing(2)};
  `,pagination:(0,Qe.H)(t),headerRow:(0,s.css)({display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",marginBottom:t.spacing(1)})});function Nt(){const[t,n]=(0,te.Ej)(te.RY.CreateExternalAlertRule),r=(0,g.zy)();return t&&n?e.createElement(S.z9,{key:"new-recording-rule",href:C.kM.renderUrl("alerting/new/recording",{returnTo:r.pathname+r.search}),icon:"plus",variant:"secondary"},"New recording rule"):null}var Lt=a(42941);function bt({onClose:t}){const[n,r]=(0,e.useState)("yaml");return e.createElement(Be.m,{activeTab:n,onTabChange:r,onClose:t,formatProviders:Object.values($e.sl)},e.createElement(Ft,{exportFormat:n,onClose:t}))}function Ft({exportFormat:t,onClose:n}){const{currentData:r="",isFetching:o}=be.hK.endpoints.exportRules.useQuery({format:t}),l=`alert-rules-${new Date().getTime()}`;return o?e.createElement(xe._,{text:"Loading...."}):e.createElement(Fe.J,{format:t,textDefinition:r,downloadFileName:l,onClose:n})}const Bt=({namespaces:t,expandAll:n})=>{const r=(0,R.of)($t),[o]=(0,T.s)(),{prom:l,ruler:c}=(0,Z.$)(G=>({prom:G.promRules[M.hY]||Pe.jA,ruler:G.rulerRules[M.hY]||Pe.jA})),u=l.loading||c.loading,i=!!l.result||!!c.result,m=o.view==="list",d=m?(0,Re.Jr)(t):t,f=nt(d),{numberOfPages:K,onPageChange:B,page:U,pageItems:O}=(0,Je.W)(f,1,we.FG),[p,y]=(0,te.Ej)(te.RY.ExportGrafanaManagedRules),I=p&&y,[V,N]=(0,Lt.A)(!1),L=t.length>0;return e.createElement("section",{className:r.wrapper},e.createElement("div",{className:r.sectionHeader},e.createElement("div",{className:r.headerRow},e.createElement("h5",null,"SyncCity"),u?e.createElement(xe._,{className:r.loader,text:"Loading..."}):e.createElement("div",null),L&&I&&e.createElement(S.$n,{"aria-label":"export all grafana rules","data-testid":"export-all-grafana-rules",icon:"download-alt",tooltip:"Export all Grafana-managed rules",onClick:N,variant:"secondary"},"Export rules"))),O.map(({group:G,namespace:b})=>e.createElement(Ke,{group:G,key:`${b.name}-${G.name}`,namespace:b,expandAll:n,viewMode:m?"list":"grouped"})),i&&d?.length===0&&e.createElement("p",null,"No rules found."),!i&&u&&e.createElement(Te.y,{size:"xl",className:r.spinner}),e.createElement(Ve.d,{className:r.pagination,currentPage:U,numberOfPages:K,onNavigate:B,hideWhenSinglePage:!0}),I&&V&&e.createElement(bt,{onClose:N}))},$t=t=>({loader:(0,s.css)`
    margin-bottom: 0;
  `,sectionHeader:(0,s.css)`
    display: flex;
    justify-content: space-between;
    margin-bottom: ${t.spacing(1)};
  `,wrapper:(0,s.css)`
    margin-bottom: ${t.spacing(4)};
  `,spinner:(0,s.css)`
    text-align: center;
    padding: ${t.spacing(2)};
  `,pagination:(0,Qe.H)(t),headerRow:(0,s.css)({display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",flexDirection:"row"})}),Ut=({namespaces:t,expandAll:n})=>{const[r,o]=(0,e.useMemo)(()=>{const l=t.map(c=>({...c,groups:c.groups.sort((u,i)=>u.name.localeCompare(i.name))})).sort((c,u)=>c.name.localeCompare(u.name));return[l.filter(c=>(0,M.z2)(c.rulesSource)),l.filter(c=>(0,M.Eb)(c.rulesSource))]},[t]);return(0,e.useEffect)(()=>{(0,v.fH)(v.le.loadedList)},[]),e.createElement(e.Fragment,null,e.createElement(Ye._,{actions:[te.RY.ViewAlertRule]},e.createElement(Bt,{namespaces:r,expandAll:n})),e.createElement(Ye._,{actions:[te.RY.ViewExternalAlertRule]},e.createElement(At,{namespaces:o,expandAll:n})))};var j=a(94822);const Ge=({rules:t,state:n,defaultCollapsed:r=!1})=>{const[o,l]=(0,e.useState)(r),c=(0,R.of)(Wt);return e.createElement(e.Fragment,null,e.createElement("h4",{className:c.header},e.createElement(Ze.e,{className:c.collapseToggle,size:"xxl",isCollapsed:o,onToggle:()=>l(!o)}),(0,H.XI)(n)," (",t.length,")"),!o&&e.createElement(at.s,{className:c.rulesTable,rules:t,showGroupColumn:!0}))},Wt=t=>({collapseToggle:(0,s.css)`
    vertical-align: middle;
  `,header:(0,s.css)`
    margin-top: ${t.spacing(2)};
  `,rulesTable:(0,s.css)`
    margin-top: ${t.spacing(3)};
  `}),Kt=({namespaces:t})=>{const n=(0,k.Ht)((0,T.s)()[0]),r=(0,e.useMemo)(()=>{const o={[j.cF.Firing]:[],[j.cF.Inactive]:[],[j.cF.Pending]:[]};return t.forEach(l=>l.groups.forEach(c=>c.rules.forEach(u=>{u.promRule&&(0,H.Z8)(u.promRule)&&o[u.promRule.state].push(u)}))),Object.values(o).forEach(l=>l.sort((c,u)=>c.name.localeCompare(u.name))),o},[t]);return e.createElement(e.Fragment,null,(!n.alertState||n.alertState===j.cF.Firing)&&e.createElement(Ge,{state:j.cF.Firing,rules:r[j.cF.Firing]}),(!n.alertState||n.alertState===j.cF.Pending)&&e.createElement(Ge,{state:j.cF.Pending,rules:r[j.cF.Pending]}),(!n.alertState||n.alertState===j.cF.Inactive)&&e.createElement(Ge,{defaultCollapsed:n.alertState!==j.cF.Inactive,state:j.cF.Inactive,rules:r[j.cF.Inactive]}))};var Gt=a(49785),ze=a(88575),pe=a(60029),Ie=a(94354),zt=a(10354),Ht=a(59429),jt=a(53076),Yt=a(1932),rt=a(19347),Se=a(28475),Oe=a(98164),lt=a(55740),Vt=a(32642),wt=a(39964);const Jt=25,He=1/0;function st(){const[t,n]=(0,wt.l)(),r=t.get("search")??"",o=(0,e.useMemo)(()=>(0,Se.XY)(r),[r]),l=(0,e.useMemo)(()=>Object.values(o).some(i=>!(0,ye.isEmpty)(i)),[o]),c=(0,e.useCallback)(i=>{const m=(0,Se.kL)(r,i);n({search:m})},[r,n]),u=(0,e.useCallback)(i=>{n({search:i})},[n]);return(0,e.useEffect)(()=>{const i={dataSource:t.get("dataSource")??void 0,alertState:t.get("alertState")??void 0,ruleType:t.get("ruleType")??void 0,labels:(0,Oe.J$)(t.get("queryString")??"").map(Oe.MU)};Object.values(i).some(d=>!(0,ye.isEmpty)(d))&&(n({dataSource:void 0,alertState:void 0,ruleType:void 0,queryString:void 0}),c((0,Yt.jM)(o,d=>{if(d.dataSourceNames??=i.dataSource?[i.dataSource]:[],i.alertState&&(0,j.Si)(i.alertState)&&(d.ruleState??=i.alertState),i.ruleType&&(0,H.nf)(i.ruleType)&&(d.ruleType??=i.ruleType),d.labels.length===0&&i.labels.length>0){const f=i.labels.map(({name:K,operator:B,value:U})=>`${K}${B}${U}`);d.labels.push(...f)}})))},[t,c,o,n]),{filterState:o,hasActiveFilters:l,searchQuery:r,setSearchQuery:u,updateFilters:c}}const Qt=(t,n)=>(0,e.useMemo)(()=>{const r=Xt(t,n);return r.forEach(o=>{o.groups.forEach(l=>{l.rules.forEach(c=>{(0,H.Z8)(c.promRule)&&(c.instanceTotals=(0,Re.Ug)(c.promRule),c.filteredInstanceTotals=(0,Re.NW)(c.promRule))}),l.totals=(0,Re.Tj)({rules:l.rules.map(c=>c.promRule).filter(c=>!!c)})})}),r},[t,n]),Xt=(t,n={dataSourceNames:[],labels:[],freeFormWords:[]})=>{let r=t;const o=n.dataSourceNames;o.length&&(r=r.filter(({rulesSource:c})=>(0,M.Eb)(c)?o.includes(c.name):!0));const l=n.namespace;if(l){const c=r.map(f=>f.name),u=Ae(l),[i,m,d]=u.search(c,l,je(l),He);m&&d?r=d.map(f=>r[m.idx[f]]):i&&(r=i.map(f=>r[f]))}return r.reduce(Zt(n),[])},Zt=t=>(n,r)=>{const o=t.groupName;let l=r.groups;if(o){const c=l.map(f=>f.name),u=Ae(o),[i,m,d]=u.search(c,o,je(o),He);m&&d?l=d.map(f=>l[m.idx[f]]):i&&(l=i.map(f=>l[f]))}return l=l.reduce(kt(t),[]),l.length&&n.push({...r,groups:l}),n},kt=t=>{const n=t.ruleName??t.freeFormWords.join(" ");return(r,o)=>{let l=o.rules;if(n){const c=l.map(f=>f.name),u=Ae(n),[i,m,d]=u.search(c,n,je(n),He);m&&d?l=d.map(f=>l[m.idx[f]]):i&&(l=i.map(f=>l[f]))}return l=l.filter(c=>{const u=c.promRule,i=(0,ye.chain)(t).pick(["ruleType","dataSourceNames","ruleHealth","labels","ruleState","dashboardUid"]).omitBy(ye.isEmpty).mapValues(()=>!1).value();if("ruleType"in i&&t.ruleType===u?.type&&(i.ruleType=!0),"dataSourceNames"in i&&((0,H.lT)(c.rulerRule)?_t(c.rulerRule,t)&&(i.dataSourceNames=!0):i.dataSourceNames=!0),"ruleHealth"in t&&u){const m=(0,H.f6)(u.health);t.ruleHealth===m&&(i.ruleHealth=!0)}if("labels"in i){const m=(0,ye.compact)(t.labels.map(qt)),d=m.length>0&&(0,Oe.Av)(c.labels,m),f=m.length>0&&u&&u.type===j.JS.Alerting&&u.alerts&&u.alerts.some(K=>(0,Oe.Av)(K.labels,m));(d||f)&&(i.labels=!0)}if("ruleState"in i){const m=c.promRule;m&&(0,H.Z8)(m)&&m.state===t.ruleState&&(i.ruleState=!0)}return"dashboardUid"in i&&c.annotations[lt.YH.dashboardUID]===t.dashboardUid&&(i.dashboardUid=!0),Object.values(i).every(m=>m===!0)}),l.length&&r.push({...o,rules:l}),r}};function je(t){return Ae(t).split(t).length<5?4:0}function qt(t){try{return(0,Vt.qR)(t)}catch{return{name:t,value:"",isRegex:!0,isEqual:!0}}}function Ae(t){const n=t.length>Jt;return new jt.A({intraMode:n?0:1,interSplit:"\\s+"})}const _t=(t,n)=>n.dataSourceNames?.length?!!t.grafana_alert.data.find(r=>{if(!r.datasourceUid)return!1;const o=(0,rt.l)().getInstanceSettings(r.datasourceUid);return o?.name&&n?.dataSourceNames?.includes(o.name)}):!0;var ea=a(35108),ta=a(22391),aa=a(51527),ot=a(26657),na=a(88323),ra=a(98624);const la=t=>{const n=(0,rt.l)(),[r,o]=(0,e.useState)(),l=(N,L)=>{if(L.action==="clear"&&t.onClear){t.onClear();return}const G=N[N.length-1];let b,Y;L.action==="pop-value"||L.action==="remove-value"?(b=L.removedValue?.value,Y="remove"):(b=G.value,Y="add");const z=n.getInstanceSettings(b);z&&(t.onChange(z,Y),o({error:void 0}))},c=()=>{const{current:N,hideTextValue:L,noDefault:G}=t;if(!(!N&&G))return N?.map(b=>{const Y=n.getInstanceSettings(b);if(Y)return{label:Y.name.slice(0,37),value:Y.name,imgUrl:Y.meta.info.logos.small,hideText:L,meta:Y.meta};const z=(0,ta.Iz)(b);return z===ot.dR.uid||z===ot.dR.name?{label:z,value:z,hideText:L}:{label:(z??"no name")+" - not found",value:z??void 0,imgUrl:"",hideText:L}})},u=()=>{const{alerting:N,tracing:L,metrics:G,mixed:b,dashboard:Y,variables:z,annotations:ie,pluginId:re,type:w,filter:h,logs:J}=t,fe=n.getList({alerting:N,tracing:L,metrics:G,logs:J,dashboard:Y,mixed:b,variables:z,annotations:ie,pluginId:re,filter:h,type:w}),me=fe.filter(M.hP).map(_=>({value:_.name,label:`${_.name}${_.isDefault?" (default)":""}`,imgUrl:_.meta.info.logos.small,meta:_.meta})),q=fe.filter(_=>!(0,M.hP)(_)).map(_=>({value:_.name,label:`${_.name}${_.isDefault?" (default)":""}`,imgUrl:_.meta.info.logos.small,meta:_.meta}));return[{label:"Data sources with configured alert rules",options:me,expanded:!0},{label:"Other data sources",options:q,expanded:!0}]},{autoFocus:i,onBlur:m,onClear:d,openMenuOnFocus:f,placeholder:K,width:B,inputId:U,disabled:O=!1,isLoading:p=!1}=t,y=u(),I=c(),V=typeof d=="function";return e.createElement("div",{"data-testid":Ne.Tp.components.DataSourcePicker.container},e.createElement(na.KF,{isLoading:p,disabled:O,"data-testid":Ne.Tp.components.DataSourcePicker.inputV2,inputId:U||"data-source-picker",className:"ds-picker select-container",isClearable:V,backspaceRemovesValue:!0,onChange:l,options:y,autoFocus:i,onBlur:m,width:B,openMenuOnFocus:f,maxMenuHeight:500,placeholder:K,noOptionsMessage:"No datasources found",value:I??[],invalid:!!r?.error||!!t.invalid,getOptionLabel:N=>N.meta&&(0,aa.x)(N.meta.signature)&&N!==I?e.createElement(Xe.Gy,{align:"center",justify:"space-between",height:"auto"},e.createElement("span",null,N.label)," ",e.createElement(ra.B,{status:N.meta.signature})):N.label||""}))},ct=[{icon:"folder",label:"Grouped",value:"grouped"},{icon:"list-ul",label:"List",value:"list"},{icon:"heart-rate",label:"State",value:"state"}],sa=[{label:"Alert ",value:j.JS.Alerting},{label:"Recording ",value:j.JS.Recording}],oa=[{label:"Ok",value:Se.Jc.Ok},{label:"No Data",value:Se.Jc.NoData},{label:"Error",value:Se.Jc.Error}],ca=Object.entries(j.cF).map(([t,n])=>({label:(0,H.XI)(n),value:n})),ia=({onFilterCleared:t=()=>{}})=>{const n=(0,R.of)(ua),[r,o]=(0,T.s)(),{filterState:l,hasActiveFilters:c,searchQuery:u,setSearchQuery:i,updateFilters:m}=st(),[d,f]=(0,e.useState)(Math.floor(Math.random()*100)),K=`dataSource-${d}`,B=`queryString-${d}`,U=(0,e.useRef)(null),{handleSubmit:O,register:p,setValue:y}=(0,Gt.mN)({defaultValues:{searchQuery:u}}),{ref:I,...V}=p("searchQuery");(0,e.useEffect)(()=>{y("searchQuery",u)},[u,y]);const N=(h,J)=>{const fe=J==="add"?[...l.dataSourceNames].concat([h.name]):l.dataSourceNames.filter(me=>me!==h.name);m({...l,dataSourceNames:fe}),f(me=>me+1),(0,v.Sn)("dataSourceNames")},L=h=>{m({...l,dashboardUid:h}),(0,v.Sn)("dashboardUid")},G=()=>{m({...l,dataSourceNames:[]}),f(h=>h+1)},b=h=>{(0,v.fH)(v.le.clickingAlertStateFilters),m({...l,ruleState:h}),(0,v.Sn)("ruleState")},Y=h=>{m({...l,ruleType:h}),(0,v.Sn)("ruleType")},z=h=>{m({...l,ruleHealth:h}),(0,v.Sn)("ruleHealth")},ie=()=>{i(void 0),t(),setTimeout(()=>f(d+1),100)},re=h=>{o({view:h}),(0,v.aL)({view:h})},w=e.createElement(Ee.I,{name:"search"});return e.createElement("div",{className:n.container},e.createElement(P.B,{direction:"column",gap:1},e.createElement(P.B,{direction:"row",gap:1,wrap:"wrap"},e.createElement(ze.D,{className:n.dsPickerContainer,label:e.createElement(pe.J,{htmlFor:"data-source-picker"},e.createElement(P.B,{gap:.5},e.createElement("span",null,"Search by data sources"),e.createElement(ee.m,{content:e.createElement("div",null,e.createElement("p",null,"Data sources containing configured alert rules are Mimir or Loki data sources where alert rules are stored and evaluated in the data source itself."),e.createElement("p",null,"In these data sources, you can select Manage alerts via Alerting UI to be able to manage these alert rules in the Grafana UI as well as in the data source where they were configured."))},e.createElement(Ee.I,{id:"data-source-picker-inline-help",name:"info-circle",size:"sm"}))))},e.createElement(la,{key:K,alerting:!0,noDefault:!0,placeholder:"All data sources",current:l.dataSourceNames,onChange:N,onClear:G})),e.createElement(ze.D,{className:n.dashboardPickerContainer,label:e.createElement(pe.J,{htmlFor:"filters-dashboard-picker"},"Dashboard")},e.createElement(Ht.b,{inputId:"filters-dashboard-picker",key:l.dashboardUid?"dashboard-defined":"dashboard-not-defined",value:l.dashboardUid,onChange:h=>L(h?.uid),isClearable:!0,cacheOptions:!0})),e.createElement("div",null,e.createElement(pe.J,null,"State"),e.createElement(Ie.z,{options:ca,value:l.ruleState,onChange:b})),e.createElement("div",null,e.createElement(pe.J,null,"Rule type"),e.createElement(Ie.z,{options:sa,value:l.ruleType,onChange:Y})),e.createElement("div",null,e.createElement(pe.J,null,"Health"),e.createElement(Ie.z,{options:oa,value:l.ruleHealth,onChange:z}))),e.createElement(P.B,{direction:"column",gap:1},e.createElement(P.B,{direction:"row",gap:1},e.createElement("form",{className:n.searchInput,onSubmit:O(h=>{i(h.searchQuery),U.current?.blur(),(0,v.zs)({oldQuery:u,newQuery:h.searchQuery})})},e.createElement(ze.D,{label:e.createElement(pe.J,{htmlFor:"rulesSearchInput"},e.createElement(P.B,{gap:.5},e.createElement("span",null,"Search"),e.createElement(ea.j,{content:e.createElement(ma,null)},e.createElement(Ee.I,{name:"info-circle",size:"sm",tabIndex:0}))))},e.createElement(zt.p,{id:"rulesSearchInput",key:B,prefix:w,ref:h=>{I(h),U.current=h},...V,placeholder:"Search","data-testid":"search-query-input"})),e.createElement("input",{type:"submit",hidden:!0})),e.createElement("div",null,e.createElement(pe.J,null,"View as"),e.createElement(Ie.z,{options:ct,value:String(r.view??ct[0].value),onChange:re}))),c&&e.createElement("div",null,e.createElement(S.$n,{fullWidth:!1,icon:"times",variant:"secondary",onClick:ie},"Clear filters")))))},ua=t=>({container:(0,s.css)({marginBottom:t.spacing(1)}),dsPickerContainer:(0,s.css)({width:t.spacing(60),flexGrow:0,margin:0}),dashboardPickerContainer:(0,s.css)({minWidth:t.spacing(50)}),searchInput:(0,s.css)({flex:1,margin:0})});function ma(){const t=(0,R.of)(it);return e.createElement("div",null,e.createElement("div",null,"Search syntax allows to query alert rules by the parameters defined below."),e.createElement("hr",null),e.createElement("div",{className:t.grid},e.createElement("div",null,"Filter type"),e.createElement("div",null,"Expression"),e.createElement(ce,{title:"Datasources",expr:"datasource:mimir datasource:prometheus"}),e.createElement(ce,{title:"Folder/Namespace",expr:"namespace:global"}),e.createElement(ce,{title:"Group",expr:"group:cpu-usage"}),e.createElement(ce,{title:"Rule",expr:'rule:"cpu 80%"'}),e.createElement(ce,{title:"Labels",expr:"label:team=A label:cluster=a1"}),e.createElement(ce,{title:"State",expr:"state:firing|normal|pending"}),e.createElement(ce,{title:"Type",expr:"type:alerting|recording"}),e.createElement(ce,{title:"Health",expr:"health:ok|nodata|error"}),e.createElement(ce,{title:"Dashboard UID",expr:"dashboard:eadde4c7-54e6-4964-85c0-484ab852fd04"})))}function ce({title:t,expr:n}){const r=(0,R.of)(it);return e.createElement(e.Fragment,null,e.createElement("div",null,t),e.createElement("code",{className:r.code},n))}const it=t=>({grid:(0,s.css)({display:"grid",gridTemplateColumns:"max-content auto",gap:t.spacing(1),alignItems:"center"}),code:(0,s.css)({display:"block",textAlign:"center"})}),da=ia,ut={groups:Ut,state:Kt},ga=se.Ys+1,Ea=(0,A.Xc)(()=>{const t=(0,D.useDispatch)(),n=(0,R.of)(pa),r=(0,e.useMemo)(M.gR,[]),[o,l]=(0,e.useState)(!1),c=(0,e.useCallback)(()=>l(!1),[]),[u]=(0,T.s)(),{filterState:i,hasActiveFilters:m}=st(),d=ut[u.view]?u.view:"groups",f=ut[d],K=(0,Z.$)(w=>w.promRules),B=(0,Z.$)(w=>w.rulerRules),U=r.some(w=>K[w]?.loading||B[w]?.loading),O=Object.entries(K),p=Object.entries(B),y=O.every(([w,h])=>h.dispatched&&(h?.result!==void 0||h?.error!==void 0)),I=p.every(([w,h])=>h.dispatched&&(h?.result!==void 0||h?.error!==void 0)),V=O.every(([w,h])=>h.dispatched&&h?.result?.length===0),N=p.every(([w,h])=>Object.entries(h?.result??{}).every(([me,q])=>q?.length===0)&&h.dispatched),L=m?void 0:ga,[G,b]=(0,E.A)(async()=>{U||await t((0,Me.yo)(!1,{limitAlerts:L}))},[U,L,t]);(0,e.useEffect)(()=>{(0,v.Sq)().catch(()=>{})},[]),(0,e.useEffect)(()=>{t((0,Me.yo)(!1,{limitAlerts:L}))},[t,L]),(0,x.A)(b,lt.HH);const Y=y&&V&&O.length>0&&N&&I,z=!Y,ie=(0,Re.dy)(),re=Qt(ie,i);return e.createElement($.d,{navId:"alert-list",isLoading:!1,actions:z&&e.createElement(mt,null)},e.createElement(he,null),e.createElement(da,{onFilterCleared:c}),z&&e.createElement(e.Fragment,null,e.createElement("div",{className:n.break}),e.createElement("div",{className:n.buttonsContainer},e.createElement("div",{className:n.statsContainer},d==="groups"&&m&&e.createElement(S.$n,{className:n.expandAllButton,icon:o?"angle-double-up":"angle-double-down",variant:"secondary",onClick:()=>l(!o)},o?"Collapse all":"Expand all"),e.createElement(tt.M_,{namespaces:re})))),Y&&e.createElement(le,null),z&&e.createElement(f,{expandAll:o,namespaces:re}))},{style:"page"}),pa=t=>({break:(0,s.css)`
    width: 100%;
    height: 0;
    margin-bottom: ${t.spacing(2)};
    border-bottom: solid 1px ${t.colors.border.medium};
  `,buttonsContainer:(0,s.css)`
    margin-bottom: ${t.spacing(2)};
    display: flex;
    justify-content: space-between;
  `,statsContainer:(0,s.css)`
    display: flex;
    flex-direction: row;
    align-items: center;
  `,expandAllButton:(0,s.css)`
    margin-right: ${t.spacing(1)};
  `}),fa=Ea;function mt(){const[t,n]=(0,te.Ej)(te.RY.CreateAlertRule),[r,o]=(0,te.Ej)(te.RY.CreateExternalAlertRule),l=(0,g.zy)();return t&&n||r&&o?e.createElement(S.z9,{href:C.kM.renderUrl("alerting/new/alerting",{returnTo:l.pathname+l.search}),icon:"plus",onClick:()=>(0,v.fH)(v.le.alertRuleFromScratch)},"New alert rule"):null}},64853:(ae,F,a)=>{a.d(F,{_:()=>x});var s=a(2543),e=a.n(s),g=a(96540),E=a(19073);const x=({actions:D,children:v})=>{const $=(0,s.filter)(D,S),P=(0,s.filter)(D,T);return $.length?g.createElement(C,{actions:$},v):P.length?g.createElement(A,{actions:P},v):null},C=({actions:D,children:v})=>{const $=(0,E.iI)();return R($,D)?g.createElement(g.Fragment,null,v):null},A=({actions:D,children:v})=>{const $=(0,E.e2)();return R($,D)?g.createElement(g.Fragment,null,v):null};function R(D,v){return(0,s.chain)(D).pick(v).values().value().some(([$,P])=>P===!0)}function S(D){return Object.values(E.QI).includes(D)}function T(D){return Object.values(E.RY).includes(D)}},64047:(ae,F,a)=>{a.d(F,{e:()=>g});var s=a(96540),e=a(55852);const g=({isCollapsed:E,onToggle:x,idControlled:C,className:A,text:R,size:S="xl",...T})=>s.createElement(e.$n,{type:"button",fill:"text",variant:"secondary","aria-expanded":!E,"aria-controls":C,className:A,icon:E?"angle-right":"angle-down",onClick:()=>x(!E),...T},R)},16293:(ae,F,a)=>{a.d(F,{J:()=>$});var s=a(32196),e=a(4213),g=a.n(e),E=a(96540),x=a(70713),C=a(40845),A=a(32372),R=a(55852),S=a(10534),T=a(72109),D=a(42418),v=a(84029);function $({format:Q,textDefinition:X,downloadFileName:le,onClose:de}){const se=(0,C.of)(P),ne=v.sl[Q],ge=(0,E.useCallback)(()=>{const W=new Blob([X],{type:`application/${Q};charset=utf-8`});g()(W,`${le}.${Q}`)},[X,le,Q]),Ce=(0,E.useMemo)(()=>ne.formatter?ne.formatter(X):X,[ne,X]);return E.createElement("div",{className:se.container},E.createElement(ve,{exportProvider:ne}),E.createElement("div",{className:se.content},E.createElement(x.Ay,{disableWidth:!0},({height:W})=>E.createElement(A.B,{width:"100%",height:W,language:Q,value:Ce,monacoOptions:{minimap:{enabled:!1},scrollBeyondLastLine:!1,lineNumbers:"on",readOnly:!0}}))),E.createElement("div",{className:se.actions},E.createElement(R.$n,{variant:"secondary",onClick:de},"Cancel"),E.createElement(S.b,{icon:"copy",getText:()=>X},"Copy code"),E.createElement(R.$n,{icon:"download-alt",onClick:ge},"Download")))}const P=Q=>({container:(0,s.css)`
    display: flex;
    flex-direction: column;
    height: 100%;
    gap: ${Q.spacing(2)};
  `,content:(0,s.css)`
    flex: 1 1 100%;
  `,actions:(0,s.css)`
    flex: 0;
    justify-content: flex-end;
    display: flex;
    gap: ${Q.spacing(1)};
  `});function ve({exportProvider:Q}){const{name:X,type:le}=Q,de={file:{title:"File-provisioning format",component:E.createElement(E.Fragment,null,X," format is only valid for File Provisioning."," ",E.createElement(T.Y,{href:"https://grafana.com/docs/grafana/latest/alerting/set-up/provision-alerting-resources/file-provisioning/",external:!0},"Read more in the docs."))},api:{title:"API-provisioning format",component:E.createElement(E.Fragment,null,X," format is only valid for API Provisioning."," ",E.createElement(T.Y,{href:"https://grafana.com/docs/grafana/latest/alerting/set-up/provision-alerting-resources/http-api-provisioning/",external:!0},"Read more in the docs."))},terraform:{title:"Terraform-provisioning format",component:E.createElement(E.Fragment,null,X," format is only valid for Terraform Provisioning."," ",E.createElement(T.Y,{href:"https://grafana.com/docs/grafana/latest/alerting/set-up/provision-alerting-resources/terraform-provisioning/",external:!0},"Read more in the docs."))}},{title:se,component:ne}=de[le];return E.createElement(D.F,{title:se,severity:"info",bottomSpacing:0,topSpacing:0},ne)}},76648:(ae,F,a)=>{a.d(F,{m:()=>E});var s=a(96540),e=a(87978),g=a(73716);function E({activeTab:x,onTabChange:C,children:A,onClose:R,formatProviders:S,title:T="Export"}){const D=Object.values(S).map(v=>({label:v.name,value:v.exportFormat}));return s.createElement(e._,{title:T,subtitle:"Select the format and download the file or copy the contents to clipboard",tabs:s.createElement(g.sb,{tabs:D,setActiveTab:C,activeTab:x}),onClose:R,size:"md"},A)}},84029:(ae,F,a)=>{a.d(F,{sl:()=>E});const s={name:"JSON",exportFormat:"json",type:"file",formatter:C=>{try{return JSON.stringify(JSON.parse(C),null,4)}catch{return C}}},e={name:"YAML",exportFormat:"yaml",type:"file"},g={name:"Terraform (HCL)",exportFormat:"hcl",type:"terraform"},E={[s.exportFormat]:s,[e.exportFormat]:e,[g.exportFormat]:g},x=[s,e]},64100:(ae,F,a)=>{a.d(F,{G:()=>R});var s=a(32196),e=a(96540),g=a(40845),E=a(60782),x=a(67061),C=a(14578),A=a(94753);function R({contentText:T,externalLink:D,linkText:v,title:$}){const P=(0,g.of)(S);return e.createElement(E.G,{content:e.createElement("div",{className:P.mutedText},T),title:e.createElement(x.B,{gap:1,direction:"row"},e.createElement(C.I,{name:"question-circle"}),$),footer:D?e.createElement("a",{href:D,target:"_blank",rel:"noreferrer"},e.createElement(x.B,{direction:"row",gap:.5,alignItems:"center"},e.createElement(A.E,{color:"link"},v," ",e.createElement(C.I,{size:"sm",name:"external-link-alt"})))):void 0,closeButton:!0,placement:"bottom-start"},e.createElement("div",{className:P.helpInfo},e.createElement(x.B,{direction:"row",alignItems:"center",gap:.5},e.createElement(C.I,{name:"question-circle",size:"sm"}),e.createElement(A.E,{variant:"bodySmall",color:"primary"},"Need help?"))))}const S=T=>({mutedText:(0,s.css)`
    color: ${T.colors.text.secondary};
    font-size: ${T.typography.size.sm};
  `,helpInfo:(0,s.css)`
    cursor: pointer;
    text-decoration: underline;
  `})},271:(ae,F,a)=>{a.d(F,{P:()=>A});var s=a(32196),e=a(96540),g=a(40845),E=a(84167),x=a(94753),C=a(67061);const A=({title:S,stepNo:T,children:D,fullWidth:v=!1,description:$})=>{const P=(0,g.of)(R);return e.createElement("div",{className:P.parent},e.createElement(E.n,{className:(0,s.cx)(v&&P.fullWidth),label:e.createElement(x.E,{variant:"h3"},T,". ",S)},e.createElement(C.B,{direction:"column"},$&&e.createElement("div",{className:P.description},$),D)))},R=S=>({parent:(0,s.css)`
    display: flex;
    flex-direction: row;
    max-width: ${S.breakpoints.values.xl}px;
    border: solid 1px ${S.colors.border.weak};
    border-radius: ${S.shape.radius.default};
    padding: ${S.spacing(2)} ${S.spacing(3)};
  `,description:(0,s.css)`
    margin-top: -${S.spacing(2)};
  `,fullWidth:(0,s.css)`
    width: 100%;
  `})},73716:(ae,F,a)=>{a.d(F,{G_:()=>X,sb:()=>le});var s=a(32196),e=a(20382),g=a(96540),E=a(49785),x=a(70713),C=a(40845),A=a(87978),R=a(63021),S=a(40675),T=a(55852),D=a(56034),v=a(14578),$=a(32372),P=a(63066),ve=a(23662);const Q=[{label:"Yaml",value:"yaml"}],X=({onClose:W})=>{const[ee,Z]=(0,g.useState)("yaml"),{setValue:M}=(0,E.xW)(),k=(0,C.of)(Ce),H=he=>{for(const ue in he)M(ue,he[ue]);W()};return g.createElement(A._,{title:"Inspect Alert rule",subtitle:g.createElement("div",{className:k.subtitle},g.createElement(le,{tabs:Q,setActiveTab:Z,activeTab:ee})),onClose:W},ee==="yaml"&&g.createElement(de,{onSubmit:H}))};function le({tabs:W,activeTab:ee,setActiveTab:Z}){return g.createElement(R.U,null,W.map((M,k)=>g.createElement(S.o,{key:`${M.value}-${k}`,label:M.label,value:M.value,onChangeTab:()=>Z(M.value),active:ee===M.value})))}const de=({onSubmit:W})=>{const ee=(0,C.of)(ge),{getValues:Z}=(0,E.xW)(),M=(0,P.l1)(Z()),[k,H]=(0,g.useState)((0,e.Bh)(M)),he=()=>{const ue=(0,e.Hh)(k),De=Z(),te=ne(ue);W({...De,...te})};return g.createElement(g.Fragment,null,g.createElement("div",{className:ee.applyButton},g.createElement(T.$n,{type:"button",onClick:he},"Apply"),g.createElement(D.m,{content:g.createElement(se,null),theme:"info",placement:"left-start",interactive:!0},g.createElement(v.I,{name:"exclamation-triangle",size:"xl"}))),g.createElement("div",{className:ee.content},g.createElement(x.Ay,{disableWidth:!0},({height:ue})=>g.createElement($.B,{width:"100%",height:ue,language:"yaml",value:k,onBlur:H,monacoOptions:{minimap:{enabled:!1}}}))))};function se(){return g.createElement("div",null,"The YAML content in the editor only contains alert rule configuration ",g.createElement("br",null),"To configure Prometheus, you need to provide the rest of the"," ",g.createElement("a",{href:"https://prometheus.io/docs/prometheus/latest/configuration/alerting_rules/",target:"_blank",rel:"noreferrer"},"configuration file content."))}function ne(W){return(0,ve.$y)(W)?(0,P.Qk)(W):(0,ve.i7)(W)?(0,P.XI)(W):{}}const ge=W=>({content:(0,s.css)`
    flex-grow: 1;
    height: 100%;
    padding-bottom: 16px;
    margin-bottom: ${W.spacing(2)};
  `,applyButton:(0,s.css)`
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    align-items: center;
    flex-grow: 0;
    margin-bottom: ${W.spacing(2)};
  `}),Ce=()=>({subtitle:(0,s.css)`
    display: flex;
    align-items: center;
    justify-content: space-between;
  `})},72275:(ae,F,a)=>{a.d(F,{M:()=>E});var s=a(96540),e=a(56034),g=a(55852);const E=({tooltip:x,icon:C,to:A,target:R,onClick:S,className:T,tooltipPlacement:D="top",...v})=>{const $=typeof x=="string"?x:void 0;return s.createElement(e.m,{content:x,placement:D},A?s.createElement(g.z9,{variant:"secondary",fill:"text",icon:C,href:A,size:"sm",target:R,...v,"aria-label":$}):s.createElement(g.$n,{className:T,variant:"secondary",fill:"text",size:"sm",icon:C,type:"button",onClick:S,...v,"aria-label":$}))}},10940:(ae,F,a)=>{a.d(F,{A:()=>g});var s=a(96540),e=function(E,x){var C=(0,s.useRef)(function(){});(0,s.useEffect)(function(){C.current=E}),(0,s.useEffect)(function(){if(x!==null){var A=setInterval(function(){return C.current()},x||0);return function(){return clearInterval(A)}}},[x])};const g=e}}]);

//# sourceMappingURL=AlertRuleListIndex.2d3076ef0cb914cf17b0.js.map