{"version":3,"file":"9656.3cf80c45beee0b306d50.js","mappings":"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","sources":["webpack://grafana/./node_modules/@grafana/experimental/dist/esm/ConfigEditor/ConfigSection/ConfigDescriptionLink.js","webpack://grafana/./node_modules/@grafana/experimental/dist/esm/QueryEditor/EditorHeader.js","webpack://grafana/./node_modules/@grafana/experimental/dist/esm/QueryEditor/FlexItem.js","webpack://grafana/./node_modules/@grafana/experimental/dist/esm/VisualQueryBuilder/components/RawQuery.js","webpack://grafana/./node_modules/@grafana/experimental/dist/esm/VisualQueryBuilder/types.js","webpack://grafana/./public/app/plugins/datasource/loki/components/LokiOptionFields.tsx","webpack://grafana/./public/app/plugins/datasource/loki/components/monaco-query-field/MonacoQueryFieldLazy.tsx","webpack://grafana/./public/app/plugins/datasource/loki/components/monaco-query-field/MonacoQueryFieldWrapper.tsx","webpack://grafana/./public/app/plugins/datasource/loki/components/LokiQueryField.tsx","webpack://grafana/./public/app/plugins/datasource/loki/components/monaco-query-field/monaco-completion-provider/validation.ts","webpack://grafana/./node_modules/lru-cache/dist/esm/index.js","webpack://grafana/./public/app/plugins/datasource/loki/LanguageProvider.ts","webpack://grafana/./node_modules/rxjs/dist/esm5/internal/observable/dom/WebSocketSubject.js","webpack://grafana/./node_modules/rxjs/dist/esm5/internal/observable/dom/webSocket.js","webpack://grafana/./node_modules/uuid/dist/esm-browser/parse.js","webpack://grafana/./node_modules/uuid/dist/esm-browser/v35.js","webpack://grafana/./node_modules/uuid/dist/esm-browser/sha1.js","webpack://grafana/./node_modules/uuid/dist/esm-browser/v5.js","webpack://grafana/./public/app/plugins/datasource/loki/liveStreamsResultTransformer.ts","webpack://grafana/./public/app/plugins/datasource/loki/LiveStreams.ts","webpack://grafana/./public/app/plugins/datasource/loki/components/LokiContextUi.tsx","webpack://grafana/./public/app/plugins/datasource/loki/sortDataFrame.ts","webpack://grafana/./public/app/plugins/datasource/loki/LogContextProvider.ts","webpack://grafana/./public/app/plugins/datasource/loki/migrations/variableQueryMigrations.ts","webpack://grafana/./public/app/plugins/datasource/loki/components/VariableQueryEditor.tsx","webpack://grafana/./public/app/plugins/datasource/loki/LokiVariableSupport.ts","webpack://grafana/./public/app/plugins/datasource/loki/getDerivedFields.ts","webpack://grafana/./public/app/plugins/datasource/loki/makeTableFrames.ts","webpack://grafana/./public/app/plugins/datasource/loki/backendResultTransformer.ts","webpack://grafana/./public/app/plugins/datasource/loki/components/AnnotationsQueryEditor.tsx","webpack://grafana/./public/app/plugins/datasource/loki/queryHints.ts","webpack://grafana/./public/app/plugins/datasource/loki/logsTimeSplitting.ts","webpack://grafana/./public/app/plugins/datasource/loki/metricTimeSplitting.ts","webpack://grafana/./public/app/plugins/datasource/loki/querySplitting.ts","webpack://grafana/./public/app/plugins/datasource/loki/streaming.ts","webpack://grafana/./public/app/plugins/datasource/loki/datasource.ts","webpack://grafana/./public/app/plugins/datasource/loki/languageUtils.ts","webpack://grafana/./public/app/plugins/datasource/loki/modifyQuery.ts","webpack://grafana/./public/app/plugins/datasource/loki/components/LokiCheatSheet.tsx","webpack://grafana/./node_modules/@grafana/experimental/dist/esm/VisualQueryBuilder/components/QueryHeaderSwitch.js","webpack://grafana/./node_modules/@grafana/experimental/dist/esm/VisualQueryBuilder/components/QueryEditorModeToggle.js","webpack://grafana/./public/app/plugins/datasource/loki/components/LokiLabelBrowser.tsx","webpack://grafana/./public/app/plugins/datasource/loki/querybuilder/components/LabelBrowserModal.tsx","webpack://grafana/./node_modules/@grafana/experimental/dist/esm/VisualQueryBuilder/components/LabelFilterItem.js","webpack://grafana/./node_modules/@grafana/experimental/dist/esm/VisualQueryBuilder/components/LabelFilters.js","webpack://grafana/./node_modules/@grafana/experimental/dist/esm/VisualQueryBuilder/components/OperationExplainedBox.js","webpack://grafana/./node_modules/react-beautiful-dnd/node_modules/react-redux/es/components/Context.js","webpack://grafana/./node_modules/react-beautiful-dnd/node_modules/react-redux/es/utils/batch.js","webpack://grafana/./node_modules/react-beautiful-dnd/node_modules/react-redux/es/utils/Subscription.js","webpack://grafana/./node_modules/react-beautiful-dnd/node_modules/react-redux/es/utils/useIsomorphicLayoutEffect.js","webpack://grafana/./node_modules/react-beautiful-dnd/node_modules/react-redux/es/components/Provider.js","webpack://grafana/./node_modules/react-beautiful-dnd/node_modules/react-redux/es/components/connectAdvanced.js","webpack://grafana/./node_modules/react-beautiful-dnd/node_modules/react-redux/es/utils/shallowEqual.js","webpack://grafana/./node_modules/react-beautiful-dnd/node_modules/react-redux/es/utils/bindActionCreators.js","webpack://grafana/./node_modules/react-beautiful-dnd/node_modules/react-redux/es/connect/wrapMapToProps.js","webpack://grafana/./node_modules/react-beautiful-dnd/node_modules/react-redux/es/connect/mapDispatchToProps.js","webpack://grafana/./node_modules/react-beautiful-dnd/node_modules/react-redux/es/connect/mapStateToProps.js","webpack://grafana/./node_modules/react-beautiful-dnd/node_modules/react-redux/es/connect/mergeProps.js","webpack://grafana/./node_modules/react-beautiful-dnd/node_modules/react-redux/es/connect/selectorFactory.js","webpack://grafana/./node_modules/react-beautiful-dnd/node_modules/react-redux/es/connect/connect.js","webpack://grafana/./node_modules/react-beautiful-dnd/node_modules/react-redux/es/hooks/useReduxContext.js","webpack://grafana/./node_modules/react-beautiful-dnd/node_modules/react-redux/es/hooks/useStore.js","webpack://grafana/./node_modules/react-beautiful-dnd/node_modules/react-redux/es/hooks/useDispatch.js","webpack://grafana/./node_modules/react-beautiful-dnd/node_modules/react-redux/es/hooks/useSelector.js","webpack://grafana/./node_modules/react-beautiful-dnd/node_modules/react-redux/es/index.js","webpack://grafana/./node_modules/react-beautiful-dnd/node_modules/memoize-one/dist/memoize-one.esm.js","webpack://grafana/./node_modules/react-beautiful-dnd/dist/react-beautiful-dnd.esm.js","webpack://grafana/./node_modules/@popperjs/core/lib/dom-utils/getWindow.js","webpack://grafana/./node_modules/@popperjs/core/lib/dom-utils/instanceOf.js","webpack://grafana/./node_modules/@popperjs/core/lib/utils/math.js","webpack://grafana/./node_modules/@popperjs/core/lib/utils/userAgent.js","webpack://grafana/./node_modules/@popperjs/core/lib/dom-utils/isLayoutViewport.js","webpack://grafana/./node_modules/@popperjs/core/lib/dom-utils/getBoundingClientRect.js","webpack://grafana/./node_modules/@popperjs/core/lib/dom-utils/getWindowScroll.js","webpack://grafana/./node_modules/@popperjs/core/lib/dom-utils/getHTMLElementScroll.js","webpack://grafana/./node_modules/@popperjs/core/lib/dom-utils/getNodeScroll.js","webpack://grafana/./node_modules/@popperjs/core/lib/dom-utils/getNodeName.js","webpack://grafana/./node_modules/@popperjs/core/lib/dom-utils/getDocumentElement.js","webpack://grafana/./node_modules/@popperjs/core/lib/dom-utils/getWindowScrollBarX.js","webpack://grafana/./node_modules/@popperjs/core/lib/dom-utils/getComputedStyle.js","webpack://grafana/./node_modules/@popperjs/core/lib/dom-utils/isScrollParent.js","webpack://grafana/./node_modules/@popperjs/core/lib/dom-utils/getCompositeRect.js","webpack://grafana/./node_modules/@popperjs/core/lib/dom-utils/getLayoutRect.js","webpack://grafana/./node_modules/@popperjs/core/lib/dom-utils/getParentNode.js","webpack://grafana/./node_modules/@popperjs/core/lib/dom-utils/getScrollParent.js","webpack://grafana/./node_modules/@popperjs/core/lib/dom-utils/listScrollParents.js","webpack://grafana/./node_modules/@popperjs/core/lib/dom-utils/isTableElement.js","webpack://grafana/./node_modules/@popperjs/core/lib/dom-utils/getOffsetParent.js","webpack://grafana/./node_modules/@popperjs/core/lib/enums.js","webpack://grafana/./node_modules/@popperjs/core/lib/utils/orderModifiers.js","webpack://grafana/./node_modules/@popperjs/core/lib/utils/debounce.js","webpack://grafana/./node_modules/@popperjs/core/lib/utils/mergeByName.js","webpack://grafana/./node_modules/@popperjs/core/lib/createPopper.js","webpack://grafana/./node_modules/@popperjs/core/lib/modifiers/eventListeners.js","webpack://grafana/./node_modules/@popperjs/core/lib/utils/getBasePlacement.js","webpack://grafana/./node_modules/@popperjs/core/lib/utils/getVariation.js","webpack://grafana/./node_modules/@popperjs/core/lib/utils/getMainAxisFromPlacement.js","webpack://grafana/./node_modules/@popperjs/core/lib/utils/computeOffsets.js","webpack://grafana/./node_modules/@popperjs/core/lib/modifiers/popperOffsets.js","webpack://grafana/./node_modules/@popperjs/core/lib/modifiers/computeStyles.js","webpack://grafana/./node_modules/@popperjs/core/lib/modifiers/applyStyles.js","webpack://grafana/./node_modules/@popperjs/core/lib/modifiers/offset.js","webpack://grafana/./node_modules/@popperjs/core/lib/utils/getOppositePlacement.js","webpack://grafana/./node_modules/@popperjs/core/lib/utils/getOppositeVariationPlacement.js","webpack://grafana/./node_modules/@popperjs/core/lib/dom-utils/getViewportRect.js","webpack://grafana/./node_modules/@popperjs/core/lib/dom-utils/getDocumentRect.js","webpack://grafana/./node_modules/@popperjs/core/lib/dom-utils/contains.js","webpack://grafana/./node_modules/@popperjs/core/lib/utils/rectToClientRect.js","webpack://grafana/./node_modules/@popperjs/core/lib/dom-utils/getClippingRect.js","webpack://grafana/./node_modules/@popperjs/core/lib/utils/getFreshSideObject.js","webpack://grafana/./node_modules/@popperjs/core/lib/utils/mergePaddingObject.js","webpack://grafana/./node_modules/@popperjs/core/lib/utils/expandToHashMap.js","webpack://grafana/./node_modules/@popperjs/core/lib/utils/detectOverflow.js","webpack://grafana/./node_modules/@popperjs/core/lib/utils/computeAutoPlacement.js","webpack://grafana/./node_modules/@popperjs/core/lib/modifiers/flip.js","webpack://grafana/./node_modules/@popperjs/core/lib/utils/getAltAxis.js","webpack://grafana/./node_modules/@popperjs/core/lib/utils/within.js","webpack://grafana/./node_modules/@popperjs/core/lib/modifiers/preventOverflow.js","webpack://grafana/./node_modules/@popperjs/core/lib/modifiers/arrow.js","webpack://grafana/./node_modules/@popperjs/core/lib/modifiers/hide.js","webpack://grafana/./node_modules/@popperjs/core/lib/popper.js","webpack://grafana/./node_modules/react-popper/lib/esm/utils.js","webpack://grafana/./node_modules/react-popper/lib/esm/usePopper.js","webpack://grafana/./node_modules/react-popper-tooltip/dist/esm/react-popper-tooltip.js","webpack://grafana/./node_modules/@grafana/experimental/dist/esm/VisualQueryBuilder/components/OperationInfoButton.js","webpack://grafana/./node_modules/@grafana/experimental/dist/esm/VisualQueryBuilder/components/OperationHeader.js","webpack://grafana/./node_modules/@grafana/experimental/dist/esm/VisualQueryBuilder/components/OperationParamEditor.js","webpack://grafana/./node_modules/@grafana/experimental/dist/esm/VisualQueryBuilder/components/OperationEditorBody.js","webpack://grafana/./node_modules/@grafana/experimental/dist/esm/VisualQueryBuilder/components/OperationEditor.js","webpack://grafana/./node_modules/@grafana/experimental/dist/esm/VisualQueryBuilder/components/OperationList.js","webpack://grafana/./node_modules/@grafana/experimental/dist/esm/VisualQueryBuilder/components/QueryBuilderHints.js","webpack://grafana/./node_modules/@grafana/experimental/dist/esm/VisualQueryBuilder/components/OperationListExplained.js","webpack://grafana/./public/app/plugins/datasource/loki/querybuilder/components/LokiQueryBuilderExplained.tsx","webpack://grafana/./public/app/plugins/datasource/loki/querybuilder/components/NestedQuery.tsx","webpack://grafana/./public/app/plugins/datasource/loki/querybuilder/components/NestedQueryList.tsx","webpack://grafana/./public/app/plugins/datasource/loki/querybuilder/components/LokiQueryBuilder.tsx","webpack://grafana/./public/app/plugins/datasource/loki/querybuilder/components/QueryPreview.tsx","webpack://grafana/./public/app/plugins/datasource/loki/querybuilder/components/LokiQueryBuilderContainer.tsx","webpack://grafana/./node_modules/@grafana/experimental/dist/esm/VisualQueryBuilder/components/QueryOptionGroup.js","webpack://grafana/./public/app/plugins/datasource/loki/querybuilder/components/LokiQueryBuilderOptions.tsx","webpack://grafana/./public/app/plugins/datasource/loki/querybuilder/components/LokiQueryCodeEditor.tsx","webpack://grafana/./public/app/plugins/datasource/loki/querybuilder/components/QueryPattern.tsx","webpack://grafana/./public/app/plugins/datasource/loki/querybuilder/components/QueryPatternsModal.tsx","webpack://grafana/./public/app/plugins/datasource/loki/querybuilder/state.ts","webpack://grafana/./public/app/plugins/datasource/loki/components/stats.ts","webpack://grafana/./public/app/plugins/datasource/loki/components/LokiQueryEditor.tsx","webpack://grafana/./public/app/plugins/datasource/loki/components/LokiQueryEditorForAlerting.tsx","webpack://grafana/./public/app/plugins/datasource/loki/components/LokiQueryEditorByApp.tsx","webpack://grafana/./public/app/plugins/datasource/loki/configuration/AlertingSettings.tsx","webpack://grafana/./public/app/plugins/datasource/loki/configuration/DebugSection.tsx","webpack://grafana/./public/app/plugins/datasource/loki/configuration/DerivedField.tsx","webpack://grafana/./public/app/plugins/datasource/loki/configuration/DerivedFields.tsx","webpack://grafana/./public/app/plugins/datasource/loki/configuration/QuerySettings.tsx","webpack://grafana/./public/app/plugins/datasource/loki/configuration/ConfigEditor.tsx","webpack://grafana/./public/app/plugins/datasource/loki/module.ts","webpack://grafana/./public/app/plugins/datasource/loki/queryUtils.ts","webpack://grafana/./node_modules/@grafana/experimental/dist/esm/VisualQueryBuilder/QueryModellerBase.js","webpack://grafana/./public/app/plugins/datasource/loki/querybuilder/LokiQueryModeller.ts","webpack://grafana/./public/app/plugins/datasource/loki/querybuilder/binaryScalarOperations.ts","webpack://grafana/./public/app/plugins/datasource/loki/querybuilder/components/LabelParamEditor.tsx","webpack://grafana/./public/app/plugins/datasource/loki/querybuilder/operationUtils.ts","webpack://grafana/./public/app/plugins/datasource/loki/querybuilder/components/UnwrapParamEditor.tsx","webpack://grafana/./public/app/plugins/datasource/loki/querybuilder/operations.ts","webpack://grafana/./public/app/plugins/datasource/loki/querybuilder/parsing.ts","webpack://grafana/./public/app/plugins/datasource/loki/querybuilder/parsingUtils.ts","webpack://grafana/./public/app/plugins/datasource/loki/querybuilder/types.ts","webpack://grafana/./public/app/plugins/datasource/loki/lineParser.ts","webpack://grafana/./public/app/plugins/datasource/loki/responseUtils.ts","webpack://grafana/./public/app/plugins/datasource/loki/tracking.ts","webpack://grafana/./node_modules/react-beautiful-dnd/node_modules/react-is/cjs/react-is.production.min.js","webpack://grafana/./node_modules/react-beautiful-dnd/node_modules/react-is/index.js","webpack://grafana/./node_modules/react-fast-compare/index.js","webpack://grafana/./node_modules/uuid/dist/esm-browser/regex.js","webpack://grafana/./node_modules/uuid/dist/esm-browser/validate.js","webpack://grafana/./node_modules/@grafana/lezer-logql/index.es.js"],"sourcesContent":["import { css } from '@emotion/css';\nimport React from 'react';\nimport { useStyles2 } from '@grafana/ui';\n\nfunction ConfigDescriptionLink(props) {\n  const { description, suffix, feature } = props;\n  const text = `Learn more about ${feature}`;\n  const styles = useStyles2(getStyles);\n  return /* @__PURE__ */ React.createElement(\"span\", { className: styles.container }, description, /* @__PURE__ */ React.createElement(\n    \"a\",\n    {\n      \"aria-label\": text,\n      href: `https://grafana.com/docs/grafana/next/datasources/${suffix}`,\n      rel: \"noreferrer\",\n      target: \"_blank\"\n    },\n    text\n  ));\n}\nconst getStyles = (theme) => {\n  return {\n    container: css({\n      color: theme.colors.text.secondary,\n      a: css({\n        color: theme.colors.text.link,\n        textDecoration: \"underline\",\n        marginLeft: \"5px\",\n        \"&:hover\": {\n          textDecoration: \"none\"\n        }\n      })\n    })\n  };\n};\n\nexport { ConfigDescriptionLink };\n//# sourceMappingURL=ConfigDescriptionLink.js.map\n","import { css } from '@emotion/css';\nimport React from 'react';\nimport { useStyles2 } from '@grafana/ui';\n\nconst EditorHeader = ({ children }) => {\n  const styles = useStyles2(getStyles);\n  return /* @__PURE__ */ React.createElement(\"div\", { className: styles.root }, children);\n};\nconst getStyles = (theme) => ({\n  root: css({\n    display: \"flex\",\n    flexWrap: \"wrap\",\n    alignItems: \"center\",\n    gap: theme.spacing(3),\n    minHeight: theme.spacing(4)\n  })\n});\n\nexport { EditorHeader };\n//# sourceMappingURL=EditorHeader.js.map\n","import React from 'react';\n\nconst FlexItem = ({ grow, shrink }) => {\n  return /* @__PURE__ */ React.createElement(\"div\", { style: { display: \"block\", flexGrow: grow, flexShrink: shrink } });\n};\n\nexport { FlexItem };\n//# sourceMappingURL=FlexItem.js.map\n","import { cx, css } from '@emotion/css';\nimport Prism from 'prismjs';\nimport React from 'react';\nimport { textUtil } from '@grafana/data';\nimport { useTheme2 } from '@grafana/ui';\n\nfunction RawQuery({ query, language, className }) {\n  const theme = useTheme2();\n  const styles = getStyles(theme);\n  const highlighted = Prism.highlight(query, language.grammar, language.name);\n  return /* @__PURE__ */ React.createElement(\n    \"div\",\n    {\n      className: cx(styles.editorField, \"prism-syntax-highlight\", className),\n      \"aria-label\": \"selector\",\n      dangerouslySetInnerHTML: { __html: textUtil.sanitize(highlighted) }\n    }\n  );\n}\nconst getStyles = (theme) => {\n  return {\n    editorField: css({\n      fontFamily: theme.typography.fontFamilyMonospace,\n      fontSize: theme.typography.bodySmall.fontSize\n    })\n  };\n};\n\nexport { RawQuery };\n//# sourceMappingURL=RawQuery.js.map\n","var QueryEditorMode = /* @__PURE__ */ ((QueryEditorMode2) => {\n  QueryEditorMode2[\"Code\"] = \"code\";\n  QueryEditorMode2[\"Builder\"] = \"builder\";\n  return QueryEditorMode2;\n})(QueryEditorMode || {});\nconst BINARY_OPERATIONS_KEY = \"Binary operations\";\n\nexport { BINARY_OPERATIONS_KEY, QueryEditorMode };\n//# sourceMappingURL=types.js.map\n","// Libraries\nimport { map } from 'lodash';\nimport { memo } from 'react';\nimport * as React from 'react';\n\n// Types\nimport { SelectableValue } from '@grafana/data';\nimport { config } from '@grafana/runtime';\nimport { InlineFormLabel, RadioButtonGroup, InlineField, Input, Select, Stack } from '@grafana/ui';\n\nimport { getLokiQueryType } from '../queryUtils';\nimport { LokiQuery, LokiQueryType } from '../types';\n\nexport interface LokiOptionFieldsProps {\n  lineLimitValue: string;\n  resolution: number;\n  query: LokiQuery;\n  onChange: (value: LokiQuery) => void;\n  onRunQuery: () => void;\n  runOnBlur?: boolean;\n}\n\nexport const queryTypeOptions: Array<SelectableValue<LokiQueryType>> = [\n  { value: LokiQueryType.Range, label: 'Range', description: 'Run query over a range of time.' },\n  {\n    value: LokiQueryType.Instant,\n    label: 'Instant',\n    description: 'Run query against a single point in time. For this query, the \"To\" time is used.',\n  },\n];\n\nif (config.featureToggles.lokiExperimentalStreaming) {\n  queryTypeOptions.push({\n    value: LokiQueryType.Stream,\n    label: 'Stream',\n    description: 'Run a query and keep sending results on an interval',\n  });\n}\n\nexport const DEFAULT_RESOLUTION: SelectableValue<number> = {\n  value: 1,\n  label: '1/1',\n};\n\nexport const RESOLUTION_OPTIONS: Array<SelectableValue<number>> = [DEFAULT_RESOLUTION].concat(\n  map([2, 3, 4, 5, 10], (value: number) => ({\n    value,\n    label: '1/' + value,\n  }))\n);\n\nexport function LokiOptionFields(props: LokiOptionFieldsProps) {\n  const { lineLimitValue, resolution, onRunQuery, runOnBlur, onChange } = props;\n  const query = props.query ?? {};\n  const queryType = getLokiQueryType(query);\n\n  function onChangeQueryLimit(value: string) {\n    const nextQuery = { ...query, maxLines: preprocessMaxLines(value) };\n    onChange(nextQuery);\n  }\n\n  function onQueryTypeChange(queryType: LokiQueryType) {\n    const { instant, range, ...rest } = query;\n    onChange({ ...rest, queryType });\n  }\n\n  function onMaxLinesChange(e: React.SyntheticEvent<HTMLInputElement>) {\n    if (query.maxLines !== preprocessMaxLines(e.currentTarget.value)) {\n      onChangeQueryLimit(e.currentTarget.value);\n    }\n  }\n\n  function onReturnKeyDown(e: React.KeyboardEvent<HTMLInputElement>) {\n    if (e.key === 'Enter') {\n      onRunQuery();\n    }\n  }\n\n  function onResolutionChange(option: SelectableValue<number>) {\n    const nextQuery = { ...query, resolution: option.value };\n    onChange(nextQuery);\n  }\n\n  return (\n    <Stack alignItems=\"flex-start\" gap={0.5} aria-label=\"Loki extra field\">\n      {/*Query type field*/}\n      <Stack wrap=\"nowrap\" gap={0} data-testid=\"queryTypeField\" aria-label=\"Query type field\">\n        <InlineFormLabel width=\"auto\">Query type</InlineFormLabel>\n\n        <RadioButtonGroup\n          options={queryTypeOptions}\n          value={queryType}\n          onChange={(type: LokiQueryType) => {\n            onQueryTypeChange(type);\n            if (runOnBlur) {\n              onRunQuery();\n            }\n          }}\n        />\n      </Stack>\n      {/*Line limit field*/}\n      <Stack wrap=\"nowrap\" gap={0} data-testid=\"lineLimitField\" aria-label=\"Line limit field\">\n        <InlineField label=\"Line limit\" tooltip={'Upper limit for number of log lines returned by query.'}>\n          <Input\n            className=\"width-4\"\n            placeholder=\"auto\"\n            type=\"number\"\n            min={0}\n            onChange={onMaxLinesChange}\n            onKeyDown={onReturnKeyDown}\n            value={lineLimitValue}\n            onBlur={() => {\n              if (runOnBlur) {\n                onRunQuery();\n              }\n            }}\n          />\n        </InlineField>\n        <InlineField\n          label=\"Resolution\"\n          tooltip={\n            'Resolution 1/1 sets step parameter of Loki metrics range queries such that each pixel corresponds to one data point. For better performance, lower resolutions can be picked. 1/2 only retrieves a data point for every other pixel, and 1/10 retrieves one data point per 10 pixels.'\n          }\n        >\n          <Select\n            isSearchable={false}\n            onChange={onResolutionChange}\n            options={RESOLUTION_OPTIONS}\n            value={resolution}\n            aria-label=\"Select resolution\"\n          />\n        </InlineField>\n      </Stack>\n    </Stack>\n  );\n}\n\nexport default memo(LokiOptionFields);\n\nexport function preprocessMaxLines(value: string): number | undefined {\n  const maxLines = parseInt(value, 10);\n  if (isNaN(maxLines) || maxLines < 0) {\n    return undefined;\n  }\n\n  return maxLines;\n}\n","import { lazy, Suspense } from 'react';\n\nimport { Props } from './MonacoQueryFieldProps';\n\nconst Field = lazy(() => import(/* webpackChunkName: \"loki-query-field\" */ './MonacoQueryField'));\n\nexport const MonacoQueryFieldLazy = (props: Props) => {\n  return (\n    <Suspense fallback={null}>\n      <Field {...props} />\n    </Suspense>\n  );\n};\n","import { useRef } from 'react';\n\nimport { MonacoQueryFieldLazy } from './MonacoQueryFieldLazy';\nimport { Props as MonacoProps } from './MonacoQueryFieldProps';\n\nexport type Props = Omit<MonacoProps, 'onRunQuery' | 'onBlur'> & {\n  onChange: (query: string) => void;\n  onRunQuery: () => void;\n  onQueryType?: (query: string) => void;\n};\n\nexport const MonacoQueryFieldWrapper = (props: Props) => {\n  const lastRunValueRef = useRef<string | null>(null);\n  const { onRunQuery, onChange, ...rest } = props;\n\n  const handleRunQuery = (value: string) => {\n    lastRunValueRef.current = value;\n    onChange(value);\n    onRunQuery();\n  };\n\n  const handleBlur = (value: string) => {\n    onChange(value);\n  };\n\n  return <MonacoQueryFieldLazy onRunQuery={handleRunQuery} onBlur={handleBlur} onChange={onChange} {...rest} />;\n};\n","import { PureComponent, ReactNode } from 'react';\n\nimport { QueryEditorProps } from '@grafana/data';\n\nimport { LokiDatasource } from '../datasource';\nimport { shouldRefreshLabels } from '../languageUtils';\nimport { LokiQuery, LokiOptions } from '../types';\n\nimport { MonacoQueryFieldWrapper } from './monaco-query-field/MonacoQueryFieldWrapper';\n\nexport interface LokiQueryFieldProps extends QueryEditorProps<LokiDatasource, LokiQuery, LokiOptions> {\n  ExtraFieldElement?: ReactNode;\n  placeholder?: string;\n  'data-testid'?: string;\n}\n\ninterface LokiQueryFieldState {\n  labelsLoaded: boolean;\n}\n\nexport class LokiQueryField extends PureComponent<LokiQueryFieldProps, LokiQueryFieldState> {\n  _isMounted = false;\n\n  constructor(props: LokiQueryFieldProps) {\n    super(props);\n\n    this.state = { labelsLoaded: false };\n  }\n\n  async componentDidMount() {\n    this._isMounted = true;\n    await this.props.datasource.languageProvider.start(this.props.range);\n    if (this._isMounted) {\n      this.setState({ labelsLoaded: true });\n    }\n  }\n\n  componentWillUnmount() {\n    this._isMounted = false;\n  }\n\n  componentDidUpdate(prevProps: LokiQueryFieldProps) {\n    const {\n      range,\n      datasource: { languageProvider },\n    } = this.props;\n    const refreshLabels = shouldRefreshLabels(range, prevProps.range);\n    // We want to refresh labels when range changes (we round up intervals to a minute)\n    if (refreshLabels) {\n      languageProvider.fetchLabels({ timeRange: range });\n    }\n  }\n\n  onChangeQuery = (value: string, override?: boolean) => {\n    // Send text change to parent\n    const { query, onChange, onRunQuery } = this.props;\n    if (onChange) {\n      const nextQuery = { ...query, expr: value };\n      onChange(nextQuery);\n\n      if (override && onRunQuery) {\n        onRunQuery();\n      }\n    }\n  };\n\n  render() {\n    const { ExtraFieldElement, query, datasource, history, onRunQuery, range } = this.props;\n    const placeholder = this.props.placeholder ?? 'Enter a Loki query (run with Shift+Enter)';\n\n    return (\n      <>\n        <div\n          className=\"gf-form-inline gf-form-inline--xs-view-flex-column flex-grow-1\"\n          data-testid={this.props['data-testid']}\n        >\n          <div className=\"gf-form--grow flex-shrink-1 min-width-15\">\n            <MonacoQueryFieldWrapper\n              datasource={datasource}\n              history={history ?? []}\n              onChange={this.onChangeQuery}\n              onRunQuery={onRunQuery}\n              initialValue={query.expr ?? ''}\n              placeholder={placeholder}\n              timeRange={range}\n            />\n          </div>\n        </div>\n        {ExtraFieldElement}\n      </>\n    );\n  }\n}\n","import { SyntaxNode } from '@lezer/common';\nimport { LRParser } from '@lezer/lr';\n\nimport { ErrorId } from '../../../querybuilder/parsingUtils';\n\ninterface ParserErrorBoundary {\n  startLineNumber: number;\n  startColumn: number;\n  endLineNumber: number;\n  endColumn: number;\n  error: string;\n}\n\ninterface ParseError {\n  text: string;\n  node: SyntaxNode;\n}\n\n/**\n * Conceived to work in combination with the MonacoQueryField component.\n * Given an original query, and it's interpolated version, it will return an array of ParserErrorBoundary\n * objects containing nodes which are actual errors. The interpolated version (even with placeholder variables)\n * is required because variables look like errors for Lezer.\n * @internal\n */\nexport function validateQuery(\n  query: string,\n  interpolatedQuery: string,\n  queryLines: string[],\n  parser: LRParser\n): ParserErrorBoundary[] | false {\n  if (!query) {\n    return false;\n  }\n\n  /**\n   * To provide support to variable interpolation in query validation, we run the parser in the interpolated\n   * query. If there are errors there, we trace them back to the original unparsed query, so we can more\n   * accurately highlight the error in the query, since it's likely that the variable name and variable value\n   * have different lengths. With this, we also exclude irrelevant parser errors that are produced by\n   * lezer not understanding $variables and $__variables, which usually generate 2 or 3 error SyntaxNode.\n   */\n  const interpolatedErrors: ParseError[] = parseQuery(interpolatedQuery, parser);\n  if (!interpolatedErrors.length) {\n    return false;\n  }\n\n  let parseErrors: ParseError[] = interpolatedErrors;\n  if (query !== interpolatedQuery) {\n    const queryErrors: ParseError[] = parseQuery(query, parser);\n    parseErrors = interpolatedErrors.flatMap(\n      (interpolatedError) =>\n        queryErrors.filter((queryError) => interpolatedError.text === queryError.text) || interpolatedError\n    );\n  }\n\n  return parseErrors.map((parseError) => findErrorBoundary(query, queryLines, parseError)).filter(isErrorBoundary);\n}\n\nfunction parseQuery(query: string, parser: LRParser) {\n  const parseErrors: ParseError[] = [];\n  const tree = parser.parse(query);\n  tree.iterate({\n    enter: (nodeRef): false | void => {\n      if (nodeRef.type.id === ErrorId) {\n        const node = nodeRef.node;\n        parseErrors.push({\n          node: node,\n          text: query.substring(node.from, node.to),\n        });\n      }\n    },\n  });\n  return parseErrors;\n}\n\nfunction findErrorBoundary(query: string, queryLines: string[], parseError: ParseError): ParserErrorBoundary | null {\n  if (queryLines.length === 1) {\n    const isEmptyString = parseError.node.from === parseError.node.to;\n    const errorNode = isEmptyString && parseError.node.parent ? parseError.node.parent : parseError.node;\n    const error = isEmptyString ? query.substring(errorNode.from, errorNode.to) : parseError.text;\n    return {\n      startLineNumber: 1,\n      startColumn: errorNode.from + 1,\n      endLineNumber: 1,\n      endColumn: errorNode.to + 1,\n      error,\n    };\n  }\n\n  let startPos = 0,\n    endPos = 0;\n  for (let line = 0; line < queryLines.length; line++) {\n    endPos = startPos + queryLines[line].length;\n\n    if (parseError.node.from > endPos) {\n      startPos += queryLines[line].length + 1;\n      continue;\n    }\n\n    return {\n      startLineNumber: line + 1,\n      startColumn: parseError.node.from - startPos + 1,\n      endLineNumber: line + 1,\n      endColumn: parseError.node.to - startPos + 1,\n      error: parseError.text,\n    };\n  }\n\n  return null;\n}\n\nfunction isErrorBoundary(boundary: ParserErrorBoundary | null): boundary is ParserErrorBoundary {\n  return boundary !== null;\n}\n\nexport const placeHolderScopedVars = {\n  __interval: { text: '1s', value: '1s' },\n  __rate_interval: { text: '1s', value: '1s' },\n  __auto: { text: '1s', value: '1s' },\n  __interval_ms: { text: '1000', value: 1000 },\n  __range_ms: { text: '1000', value: 1000 },\n  __range_s: { text: '1', value: 1 },\n  __range: { text: '1s', value: '1s' },\n};\n","/**\n * @module LRUCache\n */\nconst perf = typeof performance === 'object' &&\n    performance &&\n    typeof performance.now === 'function'\n    ? performance\n    : Date;\nconst warned = new Set();\n/* c8 ignore start */\nconst PROCESS = (typeof process === 'object' && !!process ? process : {});\n/* c8 ignore start */\nconst emitWarning = (msg, type, code, fn) => {\n    typeof PROCESS.emitWarning === 'function'\n        ? PROCESS.emitWarning(msg, type, code, fn)\n        : console.error(`[${code}] ${type}: ${msg}`);\n};\nlet AC = globalThis.AbortController;\nlet AS = globalThis.AbortSignal;\n/* c8 ignore start */\nif (typeof AC === 'undefined') {\n    //@ts-ignore\n    AS = class AbortSignal {\n        onabort;\n        _onabort = [];\n        reason;\n        aborted = false;\n        addEventListener(_, fn) {\n            this._onabort.push(fn);\n        }\n    };\n    //@ts-ignore\n    AC = class AbortController {\n        constructor() {\n            warnACPolyfill();\n        }\n        signal = new AS();\n        abort(reason) {\n            if (this.signal.aborted)\n                return;\n            //@ts-ignore\n            this.signal.reason = reason;\n            //@ts-ignore\n            this.signal.aborted = true;\n            //@ts-ignore\n            for (const fn of this.signal._onabort) {\n                fn(reason);\n            }\n            this.signal.onabort?.(reason);\n        }\n    };\n    let printACPolyfillWarning = PROCESS.env?.LRU_CACHE_IGNORE_AC_WARNING !== '1';\n    const warnACPolyfill = () => {\n        if (!printACPolyfillWarning)\n            return;\n        printACPolyfillWarning = false;\n        emitWarning('AbortController is not defined. If using lru-cache in ' +\n            'node 14, load an AbortController polyfill from the ' +\n            '`node-abort-controller` package. A minimal polyfill is ' +\n            'provided for use by LRUCache.fetch(), but it should not be ' +\n            'relied upon in other contexts (eg, passing it to other APIs that ' +\n            'use AbortController/AbortSignal might have undesirable effects). ' +\n            'You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.', 'NO_ABORT_CONTROLLER', 'ENOTSUP', warnACPolyfill);\n    };\n}\n/* c8 ignore stop */\nconst shouldWarn = (code) => !warned.has(code);\nconst TYPE = Symbol('type');\nconst isPosInt = (n) => n && n === Math.floor(n) && n > 0 && isFinite(n);\n/* c8 ignore start */\n// This is a little bit ridiculous, tbh.\n// The maximum array length is 2^32-1 or thereabouts on most JS impls.\n// And well before that point, you're caching the entire world, I mean,\n// that's ~32GB of just integers for the next/prev links, plus whatever\n// else to hold that many keys and values.  Just filling the memory with\n// zeroes at init time is brutal when you get that big.\n// But why not be complete?\n// Maybe in the future, these limits will have expanded.\nconst getUintArray = (max) => !isPosInt(max)\n    ? null\n    : max <= Math.pow(2, 8)\n        ? Uint8Array\n        : max <= Math.pow(2, 16)\n            ? Uint16Array\n            : max <= Math.pow(2, 32)\n                ? Uint32Array\n                : max <= Number.MAX_SAFE_INTEGER\n                    ? ZeroArray\n                    : null;\n/* c8 ignore stop */\nclass ZeroArray extends Array {\n    constructor(size) {\n        super(size);\n        this.fill(0);\n    }\n}\nclass Stack {\n    heap;\n    length;\n    // private constructor\n    static #constructing = false;\n    static create(max) {\n        const HeapCls = getUintArray(max);\n        if (!HeapCls)\n            return [];\n        Stack.#constructing = true;\n        const s = new Stack(max, HeapCls);\n        Stack.#constructing = false;\n        return s;\n    }\n    constructor(max, HeapCls) {\n        /* c8 ignore start */\n        if (!Stack.#constructing) {\n            throw new TypeError('instantiate Stack using Stack.create(n)');\n        }\n        /* c8 ignore stop */\n        this.heap = new HeapCls(max);\n        this.length = 0;\n    }\n    push(n) {\n        this.heap[this.length++] = n;\n    }\n    pop() {\n        return this.heap[--this.length];\n    }\n}\n/**\n * Default export, the thing you're using this module to get.\n *\n * All properties from the options object (with the exception of\n * {@link OptionsBase.max} and {@link OptionsBase.maxSize}) are added as\n * normal public members. (`max` and `maxBase` are read-only getters.)\n * Changing any of these will alter the defaults for subsequent method calls,\n * but is otherwise safe.\n */\nexport class LRUCache {\n    // properties coming in from the options of these, only max and maxSize\n    // really *need* to be protected. The rest can be modified, as they just\n    // set defaults for various methods.\n    #max;\n    #maxSize;\n    #dispose;\n    #disposeAfter;\n    #fetchMethod;\n    /**\n     * {@link LRUCache.OptionsBase.ttl}\n     */\n    ttl;\n    /**\n     * {@link LRUCache.OptionsBase.ttlResolution}\n     */\n    ttlResolution;\n    /**\n     * {@link LRUCache.OptionsBase.ttlAutopurge}\n     */\n    ttlAutopurge;\n    /**\n     * {@link LRUCache.OptionsBase.updateAgeOnGet}\n     */\n    updateAgeOnGet;\n    /**\n     * {@link LRUCache.OptionsBase.updateAgeOnHas}\n     */\n    updateAgeOnHas;\n    /**\n     * {@link LRUCache.OptionsBase.allowStale}\n     */\n    allowStale;\n    /**\n     * {@link LRUCache.OptionsBase.noDisposeOnSet}\n     */\n    noDisposeOnSet;\n    /**\n     * {@link LRUCache.OptionsBase.noUpdateTTL}\n     */\n    noUpdateTTL;\n    /**\n     * {@link LRUCache.OptionsBase.maxEntrySize}\n     */\n    maxEntrySize;\n    /**\n     * {@link LRUCache.OptionsBase.sizeCalculation}\n     */\n    sizeCalculation;\n    /**\n     * {@link LRUCache.OptionsBase.noDeleteOnFetchRejection}\n     */\n    noDeleteOnFetchRejection;\n    /**\n     * {@link LRUCache.OptionsBase.noDeleteOnStaleGet}\n     */\n    noDeleteOnStaleGet;\n    /**\n     * {@link LRUCache.OptionsBase.allowStaleOnFetchAbort}\n     */\n    allowStaleOnFetchAbort;\n    /**\n     * {@link LRUCache.OptionsBase.allowStaleOnFetchRejection}\n     */\n    allowStaleOnFetchRejection;\n    /**\n     * {@link LRUCache.OptionsBase.ignoreFetchAbort}\n     */\n    ignoreFetchAbort;\n    // computed properties\n    #size;\n    #calculatedSize;\n    #keyMap;\n    #keyList;\n    #valList;\n    #next;\n    #prev;\n    #head;\n    #tail;\n    #free;\n    #disposed;\n    #sizes;\n    #starts;\n    #ttls;\n    #hasDispose;\n    #hasFetchMethod;\n    #hasDisposeAfter;\n    /**\n     * Do not call this method unless you need to inspect the\n     * inner workings of the cache.  If anything returned by this\n     * object is modified in any way, strange breakage may occur.\n     *\n     * These fields are private for a reason!\n     *\n     * @internal\n     */\n    static unsafeExposeInternals(c) {\n        return {\n            // properties\n            starts: c.#starts,\n            ttls: c.#ttls,\n            sizes: c.#sizes,\n            keyMap: c.#keyMap,\n            keyList: c.#keyList,\n            valList: c.#valList,\n            next: c.#next,\n            prev: c.#prev,\n            get head() {\n                return c.#head;\n            },\n            get tail() {\n                return c.#tail;\n            },\n            free: c.#free,\n            // methods\n            isBackgroundFetch: (p) => c.#isBackgroundFetch(p),\n            backgroundFetch: (k, index, options, context) => c.#backgroundFetch(k, index, options, context),\n            moveToTail: (index) => c.#moveToTail(index),\n            indexes: (options) => c.#indexes(options),\n            rindexes: (options) => c.#rindexes(options),\n            isStale: (index) => c.#isStale(index),\n        };\n    }\n    // Protected read-only members\n    /**\n     * {@link LRUCache.OptionsBase.max} (read-only)\n     */\n    get max() {\n        return this.#max;\n    }\n    /**\n     * {@link LRUCache.OptionsBase.maxSize} (read-only)\n     */\n    get maxSize() {\n        return this.#maxSize;\n    }\n    /**\n     * The total computed size of items in the cache (read-only)\n     */\n    get calculatedSize() {\n        return this.#calculatedSize;\n    }\n    /**\n     * The number of items stored in the cache (read-only)\n     */\n    get size() {\n        return this.#size;\n    }\n    /**\n     * {@link LRUCache.OptionsBase.fetchMethod} (read-only)\n     */\n    get fetchMethod() {\n        return this.#fetchMethod;\n    }\n    /**\n     * {@link LRUCache.OptionsBase.dispose} (read-only)\n     */\n    get dispose() {\n        return this.#dispose;\n    }\n    /**\n     * {@link LRUCache.OptionsBase.disposeAfter} (read-only)\n     */\n    get disposeAfter() {\n        return this.#disposeAfter;\n    }\n    constructor(options) {\n        const { max = 0, ttl, ttlResolution = 1, ttlAutopurge, updateAgeOnGet, updateAgeOnHas, allowStale, dispose, disposeAfter, noDisposeOnSet, noUpdateTTL, maxSize = 0, maxEntrySize = 0, sizeCalculation, fetchMethod, noDeleteOnFetchRejection, noDeleteOnStaleGet, allowStaleOnFetchRejection, allowStaleOnFetchAbort, ignoreFetchAbort, } = options;\n        if (max !== 0 && !isPosInt(max)) {\n            throw new TypeError('max option must be a nonnegative integer');\n        }\n        const UintArray = max ? getUintArray(max) : Array;\n        if (!UintArray) {\n            throw new Error('invalid max value: ' + max);\n        }\n        this.#max = max;\n        this.#maxSize = maxSize;\n        this.maxEntrySize = maxEntrySize || this.#maxSize;\n        this.sizeCalculation = sizeCalculation;\n        if (this.sizeCalculation) {\n            if (!this.#maxSize && !this.maxEntrySize) {\n                throw new TypeError('cannot set sizeCalculation without setting maxSize or maxEntrySize');\n            }\n            if (typeof this.sizeCalculation !== 'function') {\n                throw new TypeError('sizeCalculation set to non-function');\n            }\n        }\n        if (fetchMethod !== undefined &&\n            typeof fetchMethod !== 'function') {\n            throw new TypeError('fetchMethod must be a function if specified');\n        }\n        this.#fetchMethod = fetchMethod;\n        this.#hasFetchMethod = !!fetchMethod;\n        this.#keyMap = new Map();\n        this.#keyList = new Array(max).fill(undefined);\n        this.#valList = new Array(max).fill(undefined);\n        this.#next = new UintArray(max);\n        this.#prev = new UintArray(max);\n        this.#head = 0;\n        this.#tail = 0;\n        this.#free = Stack.create(max);\n        this.#size = 0;\n        this.#calculatedSize = 0;\n        if (typeof dispose === 'function') {\n            this.#dispose = dispose;\n        }\n        if (typeof disposeAfter === 'function') {\n            this.#disposeAfter = disposeAfter;\n            this.#disposed = [];\n        }\n        else {\n            this.#disposeAfter = undefined;\n            this.#disposed = undefined;\n        }\n        this.#hasDispose = !!this.#dispose;\n        this.#hasDisposeAfter = !!this.#disposeAfter;\n        this.noDisposeOnSet = !!noDisposeOnSet;\n        this.noUpdateTTL = !!noUpdateTTL;\n        this.noDeleteOnFetchRejection = !!noDeleteOnFetchRejection;\n        this.allowStaleOnFetchRejection = !!allowStaleOnFetchRejection;\n        this.allowStaleOnFetchAbort = !!allowStaleOnFetchAbort;\n        this.ignoreFetchAbort = !!ignoreFetchAbort;\n        // NB: maxEntrySize is set to maxSize if it's set\n        if (this.maxEntrySize !== 0) {\n            if (this.#maxSize !== 0) {\n                if (!isPosInt(this.#maxSize)) {\n                    throw new TypeError('maxSize must be a positive integer if specified');\n                }\n            }\n            if (!isPosInt(this.maxEntrySize)) {\n                throw new TypeError('maxEntrySize must be a positive integer if specified');\n            }\n            this.#initializeSizeTracking();\n        }\n        this.allowStale = !!allowStale;\n        this.noDeleteOnStaleGet = !!noDeleteOnStaleGet;\n        this.updateAgeOnGet = !!updateAgeOnGet;\n        this.updateAgeOnHas = !!updateAgeOnHas;\n        this.ttlResolution =\n            isPosInt(ttlResolution) || ttlResolution === 0\n                ? ttlResolution\n                : 1;\n        this.ttlAutopurge = !!ttlAutopurge;\n        this.ttl = ttl || 0;\n        if (this.ttl) {\n            if (!isPosInt(this.ttl)) {\n                throw new TypeError('ttl must be a positive integer if specified');\n            }\n            this.#initializeTTLTracking();\n        }\n        // do not allow completely unbounded caches\n        if (this.#max === 0 && this.ttl === 0 && this.#maxSize === 0) {\n            throw new TypeError('At least one of max, maxSize, or ttl is required');\n        }\n        if (!this.ttlAutopurge && !this.#max && !this.#maxSize) {\n            const code = 'LRU_CACHE_UNBOUNDED';\n            if (shouldWarn(code)) {\n                warned.add(code);\n                const msg = 'TTL caching without ttlAutopurge, max, or maxSize can ' +\n                    'result in unbounded memory consumption.';\n                emitWarning(msg, 'UnboundedCacheWarning', code, LRUCache);\n            }\n        }\n    }\n    /**\n     * Return the remaining TTL time for a given entry key\n     */\n    getRemainingTTL(key) {\n        return this.#keyMap.has(key) ? Infinity : 0;\n    }\n    #initializeTTLTracking() {\n        const ttls = new ZeroArray(this.#max);\n        const starts = new ZeroArray(this.#max);\n        this.#ttls = ttls;\n        this.#starts = starts;\n        this.#setItemTTL = (index, ttl, start = perf.now()) => {\n            starts[index] = ttl !== 0 ? start : 0;\n            ttls[index] = ttl;\n            if (ttl !== 0 && this.ttlAutopurge) {\n                const t = setTimeout(() => {\n                    if (this.#isStale(index)) {\n                        this.delete(this.#keyList[index]);\n                    }\n                }, ttl + 1);\n                // unref() not supported on all platforms\n                /* c8 ignore start */\n                if (t.unref) {\n                    t.unref();\n                }\n                /* c8 ignore stop */\n            }\n        };\n        this.#updateItemAge = index => {\n            starts[index] = ttls[index] !== 0 ? perf.now() : 0;\n        };\n        this.#statusTTL = (status, index) => {\n            if (ttls[index]) {\n                const ttl = ttls[index];\n                const start = starts[index];\n                /* c8 ignore next */\n                if (!ttl || !start)\n                    return;\n                status.ttl = ttl;\n                status.start = start;\n                status.now = cachedNow || getNow();\n                const age = status.now - start;\n                status.remainingTTL = ttl - age;\n            }\n        };\n        // debounce calls to perf.now() to 1s so we're not hitting\n        // that costly call repeatedly.\n        let cachedNow = 0;\n        const getNow = () => {\n            const n = perf.now();\n            if (this.ttlResolution > 0) {\n                cachedNow = n;\n                const t = setTimeout(() => (cachedNow = 0), this.ttlResolution);\n                // not available on all platforms\n                /* c8 ignore start */\n                if (t.unref) {\n                    t.unref();\n                }\n                /* c8 ignore stop */\n            }\n            return n;\n        };\n        this.getRemainingTTL = key => {\n            const index = this.#keyMap.get(key);\n            if (index === undefined) {\n                return 0;\n            }\n            const ttl = ttls[index];\n            const start = starts[index];\n            if (!ttl || !start) {\n                return Infinity;\n            }\n            const age = (cachedNow || getNow()) - start;\n            return ttl - age;\n        };\n        this.#isStale = index => {\n            const s = starts[index];\n            const t = ttls[index];\n            return !!t && !!s && (cachedNow || getNow()) - s > t;\n        };\n    }\n    // conditionally set private methods related to TTL\n    #updateItemAge = () => { };\n    #statusTTL = () => { };\n    #setItemTTL = () => { };\n    /* c8 ignore stop */\n    #isStale = () => false;\n    #initializeSizeTracking() {\n        const sizes = new ZeroArray(this.#max);\n        this.#calculatedSize = 0;\n        this.#sizes = sizes;\n        this.#removeItemSize = index => {\n            this.#calculatedSize -= sizes[index];\n            sizes[index] = 0;\n        };\n        this.#requireSize = (k, v, size, sizeCalculation) => {\n            // provisionally accept background fetches.\n            // actual value size will be checked when they return.\n            if (this.#isBackgroundFetch(v)) {\n                return 0;\n            }\n            if (!isPosInt(size)) {\n                if (sizeCalculation) {\n                    if (typeof sizeCalculation !== 'function') {\n                        throw new TypeError('sizeCalculation must be a function');\n                    }\n                    size = sizeCalculation(v, k);\n                    if (!isPosInt(size)) {\n                        throw new TypeError('sizeCalculation return invalid (expect positive integer)');\n                    }\n                }\n                else {\n                    throw new TypeError('invalid size value (must be positive integer). ' +\n                        'When maxSize or maxEntrySize is used, sizeCalculation ' +\n                        'or size must be set.');\n                }\n            }\n            return size;\n        };\n        this.#addItemSize = (index, size, status) => {\n            sizes[index] = size;\n            if (this.#maxSize) {\n                const maxSize = this.#maxSize - sizes[index];\n                while (this.#calculatedSize > maxSize) {\n                    this.#evict(true);\n                }\n            }\n            this.#calculatedSize += sizes[index];\n            if (status) {\n                status.entrySize = size;\n                status.totalCalculatedSize = this.#calculatedSize;\n            }\n        };\n    }\n    #removeItemSize = _i => { };\n    #addItemSize = (_i, _s, _st) => { };\n    #requireSize = (_k, _v, size, sizeCalculation) => {\n        if (size || sizeCalculation) {\n            throw new TypeError('cannot set size without setting maxSize or maxEntrySize on cache');\n        }\n        return 0;\n    };\n    *#indexes({ allowStale = this.allowStale } = {}) {\n        if (this.#size) {\n            for (let i = this.#tail; true;) {\n                if (!this.#isValidIndex(i)) {\n                    break;\n                }\n                if (allowStale || !this.#isStale(i)) {\n                    yield i;\n                }\n                if (i === this.#head) {\n                    break;\n                }\n                else {\n                    i = this.#prev[i];\n                }\n            }\n        }\n    }\n    *#rindexes({ allowStale = this.allowStale } = {}) {\n        if (this.#size) {\n            for (let i = this.#head; true;) {\n                if (!this.#isValidIndex(i)) {\n                    break;\n                }\n                if (allowStale || !this.#isStale(i)) {\n                    yield i;\n                }\n                if (i === this.#tail) {\n                    break;\n                }\n                else {\n                    i = this.#next[i];\n                }\n            }\n        }\n    }\n    #isValidIndex(index) {\n        return (index !== undefined &&\n            this.#keyMap.get(this.#keyList[index]) === index);\n    }\n    /**\n     * Return a generator yielding `[key, value]` pairs,\n     * in order from most recently used to least recently used.\n     */\n    *entries() {\n        for (const i of this.#indexes()) {\n            if (this.#valList[i] !== undefined &&\n                this.#keyList[i] !== undefined &&\n                !this.#isBackgroundFetch(this.#valList[i])) {\n                yield [this.#keyList[i], this.#valList[i]];\n            }\n        }\n    }\n    /**\n     * Inverse order version of {@link LRUCache.entries}\n     *\n     * Return a generator yielding `[key, value]` pairs,\n     * in order from least recently used to most recently used.\n     */\n    *rentries() {\n        for (const i of this.#rindexes()) {\n            if (this.#valList[i] !== undefined &&\n                this.#keyList[i] !== undefined &&\n                !this.#isBackgroundFetch(this.#valList[i])) {\n                yield [this.#keyList[i], this.#valList[i]];\n            }\n        }\n    }\n    /**\n     * Return a generator yielding the keys in the cache,\n     * in order from most recently used to least recently used.\n     */\n    *keys() {\n        for (const i of this.#indexes()) {\n            const k = this.#keyList[i];\n            if (k !== undefined &&\n                !this.#isBackgroundFetch(this.#valList[i])) {\n                yield k;\n            }\n        }\n    }\n    /**\n     * Inverse order version of {@link LRUCache.keys}\n     *\n     * Return a generator yielding the keys in the cache,\n     * in order from least recently used to most recently used.\n     */\n    *rkeys() {\n        for (const i of this.#rindexes()) {\n            const k = this.#keyList[i];\n            if (k !== undefined &&\n                !this.#isBackgroundFetch(this.#valList[i])) {\n                yield k;\n            }\n        }\n    }\n    /**\n     * Return a generator yielding the values in the cache,\n     * in order from most recently used to least recently used.\n     */\n    *values() {\n        for (const i of this.#indexes()) {\n            const v = this.#valList[i];\n            if (v !== undefined &&\n                !this.#isBackgroundFetch(this.#valList[i])) {\n                yield this.#valList[i];\n            }\n        }\n    }\n    /**\n     * Inverse order version of {@link LRUCache.values}\n     *\n     * Return a generator yielding the values in the cache,\n     * in order from least recently used to most recently used.\n     */\n    *rvalues() {\n        for (const i of this.#rindexes()) {\n            const v = this.#valList[i];\n            if (v !== undefined &&\n                !this.#isBackgroundFetch(this.#valList[i])) {\n                yield this.#valList[i];\n            }\n        }\n    }\n    /**\n     * Iterating over the cache itself yields the same results as\n     * {@link LRUCache.entries}\n     */\n    [Symbol.iterator]() {\n        return this.entries();\n    }\n    /**\n     * A String value that is used in the creation of the default string description of an object.\n     * Called by the built-in method Object.prototype.toString.\n     */\n    [Symbol.toStringTag] = 'LRUCache';\n    /**\n     * Find a value for which the supplied fn method returns a truthy value,\n     * similar to Array.find().  fn is called as fn(value, key, cache).\n     */\n    find(fn, getOptions = {}) {\n        for (const i of this.#indexes()) {\n            const v = this.#valList[i];\n            const value = this.#isBackgroundFetch(v)\n                ? v.__staleWhileFetching\n                : v;\n            if (value === undefined)\n                continue;\n            if (fn(value, this.#keyList[i], this)) {\n                return this.get(this.#keyList[i], getOptions);\n            }\n        }\n    }\n    /**\n     * Call the supplied function on each item in the cache, in order from\n     * most recently used to least recently used.  fn is called as\n     * fn(value, key, cache).  Does not update age or recenty of use.\n     * Does not iterate over stale values.\n     */\n    forEach(fn, thisp = this) {\n        for (const i of this.#indexes()) {\n            const v = this.#valList[i];\n            const value = this.#isBackgroundFetch(v)\n                ? v.__staleWhileFetching\n                : v;\n            if (value === undefined)\n                continue;\n            fn.call(thisp, value, this.#keyList[i], this);\n        }\n    }\n    /**\n     * The same as {@link LRUCache.forEach} but items are iterated over in\n     * reverse order.  (ie, less recently used items are iterated over first.)\n     */\n    rforEach(fn, thisp = this) {\n        for (const i of this.#rindexes()) {\n            const v = this.#valList[i];\n            const value = this.#isBackgroundFetch(v)\n                ? v.__staleWhileFetching\n                : v;\n            if (value === undefined)\n                continue;\n            fn.call(thisp, value, this.#keyList[i], this);\n        }\n    }\n    /**\n     * Delete any stale entries. Returns true if anything was removed,\n     * false otherwise.\n     */\n    purgeStale() {\n        let deleted = false;\n        for (const i of this.#rindexes({ allowStale: true })) {\n            if (this.#isStale(i)) {\n                this.delete(this.#keyList[i]);\n                deleted = true;\n            }\n        }\n        return deleted;\n    }\n    /**\n     * Get the extended info about a given entry, to get its value, size, and\n     * TTL info simultaneously. Like {@link LRUCache#dump}, but just for a\n     * single key. Always returns stale values, if their info is found in the\n     * cache, so be sure to check for expired TTLs if relevant.\n     */\n    info(key) {\n        const i = this.#keyMap.get(key);\n        if (i === undefined)\n            return undefined;\n        const v = this.#valList[i];\n        const value = this.#isBackgroundFetch(v)\n            ? v.__staleWhileFetching\n            : v;\n        if (value === undefined)\n            return undefined;\n        const entry = { value };\n        if (this.#ttls && this.#starts) {\n            const ttl = this.#ttls[i];\n            const start = this.#starts[i];\n            if (ttl && start) {\n                const remain = ttl - (perf.now() - start);\n                entry.ttl = remain;\n                entry.start = Date.now();\n            }\n        }\n        if (this.#sizes) {\n            entry.size = this.#sizes[i];\n        }\n        return entry;\n    }\n    /**\n     * Return an array of [key, {@link LRUCache.Entry}] tuples which can be\n     * passed to cache.load()\n     */\n    dump() {\n        const arr = [];\n        for (const i of this.#indexes({ allowStale: true })) {\n            const key = this.#keyList[i];\n            const v = this.#valList[i];\n            const value = this.#isBackgroundFetch(v)\n                ? v.__staleWhileFetching\n                : v;\n            if (value === undefined || key === undefined)\n                continue;\n            const entry = { value };\n            if (this.#ttls && this.#starts) {\n                entry.ttl = this.#ttls[i];\n                // always dump the start relative to a portable timestamp\n                // it's ok for this to be a bit slow, it's a rare operation.\n                const age = perf.now() - this.#starts[i];\n                entry.start = Math.floor(Date.now() - age);\n            }\n            if (this.#sizes) {\n                entry.size = this.#sizes[i];\n            }\n            arr.unshift([key, entry]);\n        }\n        return arr;\n    }\n    /**\n     * Reset the cache and load in the items in entries in the order listed.\n     * Note that the shape of the resulting cache may be different if the\n     * same options are not used in both caches.\n     */\n    load(arr) {\n        this.clear();\n        for (const [key, entry] of arr) {\n            if (entry.start) {\n                // entry.start is a portable timestamp, but we may be using\n                // node's performance.now(), so calculate the offset, so that\n                // we get the intended remaining TTL, no matter how long it's\n                // been on ice.\n                //\n                // it's ok for this to be a bit slow, it's a rare operation.\n                const age = Date.now() - entry.start;\n                entry.start = perf.now() - age;\n            }\n            this.set(key, entry.value, entry);\n        }\n    }\n    /**\n     * Add a value to the cache.\n     *\n     * Note: if `undefined` is specified as a value, this is an alias for\n     * {@link LRUCache#delete}\n     */\n    set(k, v, setOptions = {}) {\n        if (v === undefined) {\n            this.delete(k);\n            return this;\n        }\n        const { ttl = this.ttl, start, noDisposeOnSet = this.noDisposeOnSet, sizeCalculation = this.sizeCalculation, status, } = setOptions;\n        let { noUpdateTTL = this.noUpdateTTL } = setOptions;\n        const size = this.#requireSize(k, v, setOptions.size || 0, sizeCalculation);\n        // if the item doesn't fit, don't do anything\n        // NB: maxEntrySize set to maxSize by default\n        if (this.maxEntrySize && size > this.maxEntrySize) {\n            if (status) {\n                status.set = 'miss';\n                status.maxEntrySizeExceeded = true;\n            }\n            // have to delete, in case something is there already.\n            this.delete(k);\n            return this;\n        }\n        let index = this.#size === 0 ? undefined : this.#keyMap.get(k);\n        if (index === undefined) {\n            // addition\n            index = (this.#size === 0\n                ? this.#tail\n                : this.#free.length !== 0\n                    ? this.#free.pop()\n                    : this.#size === this.#max\n                        ? this.#evict(false)\n                        : this.#size);\n            this.#keyList[index] = k;\n            this.#valList[index] = v;\n            this.#keyMap.set(k, index);\n            this.#next[this.#tail] = index;\n            this.#prev[index] = this.#tail;\n            this.#tail = index;\n            this.#size++;\n            this.#addItemSize(index, size, status);\n            if (status)\n                status.set = 'add';\n            noUpdateTTL = false;\n        }\n        else {\n            // update\n            this.#moveToTail(index);\n            const oldVal = this.#valList[index];\n            if (v !== oldVal) {\n                if (this.#hasFetchMethod && this.#isBackgroundFetch(oldVal)) {\n                    oldVal.__abortController.abort(new Error('replaced'));\n                    const { __staleWhileFetching: s } = oldVal;\n                    if (s !== undefined && !noDisposeOnSet) {\n                        if (this.#hasDispose) {\n                            this.#dispose?.(s, k, 'set');\n                        }\n                        if (this.#hasDisposeAfter) {\n                            this.#disposed?.push([s, k, 'set']);\n                        }\n                    }\n                }\n                else if (!noDisposeOnSet) {\n                    if (this.#hasDispose) {\n                        this.#dispose?.(oldVal, k, 'set');\n                    }\n                    if (this.#hasDisposeAfter) {\n                        this.#disposed?.push([oldVal, k, 'set']);\n                    }\n                }\n                this.#removeItemSize(index);\n                this.#addItemSize(index, size, status);\n                this.#valList[index] = v;\n                if (status) {\n                    status.set = 'replace';\n                    const oldValue = oldVal && this.#isBackgroundFetch(oldVal)\n                        ? oldVal.__staleWhileFetching\n                        : oldVal;\n                    if (oldValue !== undefined)\n                        status.oldValue = oldValue;\n                }\n            }\n            else if (status) {\n                status.set = 'update';\n            }\n        }\n        if (ttl !== 0 && !this.#ttls) {\n            this.#initializeTTLTracking();\n        }\n        if (this.#ttls) {\n            if (!noUpdateTTL) {\n                this.#setItemTTL(index, ttl, start);\n            }\n            if (status)\n                this.#statusTTL(status, index);\n        }\n        if (!noDisposeOnSet && this.#hasDisposeAfter && this.#disposed) {\n            const dt = this.#disposed;\n            let task;\n            while ((task = dt?.shift())) {\n                this.#disposeAfter?.(...task);\n            }\n        }\n        return this;\n    }\n    /**\n     * Evict the least recently used item, returning its value or\n     * `undefined` if cache is empty.\n     */\n    pop() {\n        try {\n            while (this.#size) {\n                const val = this.#valList[this.#head];\n                this.#evict(true);\n                if (this.#isBackgroundFetch(val)) {\n                    if (val.__staleWhileFetching) {\n                        return val.__staleWhileFetching;\n                    }\n                }\n                else if (val !== undefined) {\n                    return val;\n                }\n            }\n        }\n        finally {\n            if (this.#hasDisposeAfter && this.#disposed) {\n                const dt = this.#disposed;\n                let task;\n                while ((task = dt?.shift())) {\n                    this.#disposeAfter?.(...task);\n                }\n            }\n        }\n    }\n    #evict(free) {\n        const head = this.#head;\n        const k = this.#keyList[head];\n        const v = this.#valList[head];\n        if (this.#hasFetchMethod && this.#isBackgroundFetch(v)) {\n            v.__abortController.abort(new Error('evicted'));\n        }\n        else if (this.#hasDispose || this.#hasDisposeAfter) {\n            if (this.#hasDispose) {\n                this.#dispose?.(v, k, 'evict');\n            }\n            if (this.#hasDisposeAfter) {\n                this.#disposed?.push([v, k, 'evict']);\n            }\n        }\n        this.#removeItemSize(head);\n        // if we aren't about to use the index, then null these out\n        if (free) {\n            this.#keyList[head] = undefined;\n            this.#valList[head] = undefined;\n            this.#free.push(head);\n        }\n        if (this.#size === 1) {\n            this.#head = this.#tail = 0;\n            this.#free.length = 0;\n        }\n        else {\n            this.#head = this.#next[head];\n        }\n        this.#keyMap.delete(k);\n        this.#size--;\n        return head;\n    }\n    /**\n     * Check if a key is in the cache, without updating the recency of use.\n     * Will return false if the item is stale, even though it is technically\n     * in the cache.\n     *\n     * Will not update item age unless\n     * {@link LRUCache.OptionsBase.updateAgeOnHas} is set.\n     */\n    has(k, hasOptions = {}) {\n        const { updateAgeOnHas = this.updateAgeOnHas, status } = hasOptions;\n        const index = this.#keyMap.get(k);\n        if (index !== undefined) {\n            const v = this.#valList[index];\n            if (this.#isBackgroundFetch(v) &&\n                v.__staleWhileFetching === undefined) {\n                return false;\n            }\n            if (!this.#isStale(index)) {\n                if (updateAgeOnHas) {\n                    this.#updateItemAge(index);\n                }\n                if (status) {\n                    status.has = 'hit';\n                    this.#statusTTL(status, index);\n                }\n                return true;\n            }\n            else if (status) {\n                status.has = 'stale';\n                this.#statusTTL(status, index);\n            }\n        }\n        else if (status) {\n            status.has = 'miss';\n        }\n        return false;\n    }\n    /**\n     * Like {@link LRUCache#get} but doesn't update recency or delete stale\n     * items.\n     *\n     * Returns `undefined` if the item is stale, unless\n     * {@link LRUCache.OptionsBase.allowStale} is set.\n     */\n    peek(k, peekOptions = {}) {\n        const { allowStale = this.allowStale } = peekOptions;\n        const index = this.#keyMap.get(k);\n        if (index === undefined ||\n            (!allowStale && this.#isStale(index))) {\n            return;\n        }\n        const v = this.#valList[index];\n        // either stale and allowed, or forcing a refresh of non-stale value\n        return this.#isBackgroundFetch(v) ? v.__staleWhileFetching : v;\n    }\n    #backgroundFetch(k, index, options, context) {\n        const v = index === undefined ? undefined : this.#valList[index];\n        if (this.#isBackgroundFetch(v)) {\n            return v;\n        }\n        const ac = new AC();\n        const { signal } = options;\n        // when/if our AC signals, then stop listening to theirs.\n        signal?.addEventListener('abort', () => ac.abort(signal.reason), {\n            signal: ac.signal,\n        });\n        const fetchOpts = {\n            signal: ac.signal,\n            options,\n            context,\n        };\n        const cb = (v, updateCache = false) => {\n            const { aborted } = ac.signal;\n            const ignoreAbort = options.ignoreFetchAbort && v !== undefined;\n            if (options.status) {\n                if (aborted && !updateCache) {\n                    options.status.fetchAborted = true;\n                    options.status.fetchError = ac.signal.reason;\n                    if (ignoreAbort)\n                        options.status.fetchAbortIgnored = true;\n                }\n                else {\n                    options.status.fetchResolved = true;\n                }\n            }\n            if (aborted && !ignoreAbort && !updateCache) {\n                return fetchFail(ac.signal.reason);\n            }\n            // either we didn't abort, and are still here, or we did, and ignored\n            const bf = p;\n            if (this.#valList[index] === p) {\n                if (v === undefined) {\n                    if (bf.__staleWhileFetching) {\n                        this.#valList[index] = bf.__staleWhileFetching;\n                    }\n                    else {\n                        this.delete(k);\n                    }\n                }\n                else {\n                    if (options.status)\n                        options.status.fetchUpdated = true;\n                    this.set(k, v, fetchOpts.options);\n                }\n            }\n            return v;\n        };\n        const eb = (er) => {\n            if (options.status) {\n                options.status.fetchRejected = true;\n                options.status.fetchError = er;\n            }\n            return fetchFail(er);\n        };\n        const fetchFail = (er) => {\n            const { aborted } = ac.signal;\n            const allowStaleAborted = aborted && options.allowStaleOnFetchAbort;\n            const allowStale = allowStaleAborted || options.allowStaleOnFetchRejection;\n            const noDelete = allowStale || options.noDeleteOnFetchRejection;\n            const bf = p;\n            if (this.#valList[index] === p) {\n                // if we allow stale on fetch rejections, then we need to ensure that\n                // the stale value is not removed from the cache when the fetch fails.\n                const del = !noDelete || bf.__staleWhileFetching === undefined;\n                if (del) {\n                    this.delete(k);\n                }\n                else if (!allowStaleAborted) {\n                    // still replace the *promise* with the stale value,\n                    // since we are done with the promise at this point.\n                    // leave it untouched if we're still waiting for an\n                    // aborted background fetch that hasn't yet returned.\n                    this.#valList[index] = bf.__staleWhileFetching;\n                }\n            }\n            if (allowStale) {\n                if (options.status && bf.__staleWhileFetching !== undefined) {\n                    options.status.returnedStale = true;\n                }\n                return bf.__staleWhileFetching;\n            }\n            else if (bf.__returned === bf) {\n                throw er;\n            }\n        };\n        const pcall = (res, rej) => {\n            const fmp = this.#fetchMethod?.(k, v, fetchOpts);\n            if (fmp && fmp instanceof Promise) {\n                fmp.then(v => res(v === undefined ? undefined : v), rej);\n            }\n            // ignored, we go until we finish, regardless.\n            // defer check until we are actually aborting,\n            // so fetchMethod can override.\n            ac.signal.addEventListener('abort', () => {\n                if (!options.ignoreFetchAbort ||\n                    options.allowStaleOnFetchAbort) {\n                    res(undefined);\n                    // when it eventually resolves, update the cache.\n                    if (options.allowStaleOnFetchAbort) {\n                        res = v => cb(v, true);\n                    }\n                }\n            });\n        };\n        if (options.status)\n            options.status.fetchDispatched = true;\n        const p = new Promise(pcall).then(cb, eb);\n        const bf = Object.assign(p, {\n            __abortController: ac,\n            __staleWhileFetching: v,\n            __returned: undefined,\n        });\n        if (index === undefined) {\n            // internal, don't expose status.\n            this.set(k, bf, { ...fetchOpts.options, status: undefined });\n            index = this.#keyMap.get(k);\n        }\n        else {\n            this.#valList[index] = bf;\n        }\n        return bf;\n    }\n    #isBackgroundFetch(p) {\n        if (!this.#hasFetchMethod)\n            return false;\n        const b = p;\n        return (!!b &&\n            b instanceof Promise &&\n            b.hasOwnProperty('__staleWhileFetching') &&\n            b.__abortController instanceof AC);\n    }\n    async fetch(k, fetchOptions = {}) {\n        const { \n        // get options\n        allowStale = this.allowStale, updateAgeOnGet = this.updateAgeOnGet, noDeleteOnStaleGet = this.noDeleteOnStaleGet, \n        // set options\n        ttl = this.ttl, noDisposeOnSet = this.noDisposeOnSet, size = 0, sizeCalculation = this.sizeCalculation, noUpdateTTL = this.noUpdateTTL, \n        // fetch exclusive options\n        noDeleteOnFetchRejection = this.noDeleteOnFetchRejection, allowStaleOnFetchRejection = this.allowStaleOnFetchRejection, ignoreFetchAbort = this.ignoreFetchAbort, allowStaleOnFetchAbort = this.allowStaleOnFetchAbort, context, forceRefresh = false, status, signal, } = fetchOptions;\n        if (!this.#hasFetchMethod) {\n            if (status)\n                status.fetch = 'get';\n            return this.get(k, {\n                allowStale,\n                updateAgeOnGet,\n                noDeleteOnStaleGet,\n                status,\n            });\n        }\n        const options = {\n            allowStale,\n            updateAgeOnGet,\n            noDeleteOnStaleGet,\n            ttl,\n            noDisposeOnSet,\n            size,\n            sizeCalculation,\n            noUpdateTTL,\n            noDeleteOnFetchRejection,\n            allowStaleOnFetchRejection,\n            allowStaleOnFetchAbort,\n            ignoreFetchAbort,\n            status,\n            signal,\n        };\n        let index = this.#keyMap.get(k);\n        if (index === undefined) {\n            if (status)\n                status.fetch = 'miss';\n            const p = this.#backgroundFetch(k, index, options, context);\n            return (p.__returned = p);\n        }\n        else {\n            // in cache, maybe already fetching\n            const v = this.#valList[index];\n            if (this.#isBackgroundFetch(v)) {\n                const stale = allowStale && v.__staleWhileFetching !== undefined;\n                if (status) {\n                    status.fetch = 'inflight';\n                    if (stale)\n                        status.returnedStale = true;\n                }\n                return stale ? v.__staleWhileFetching : (v.__returned = v);\n            }\n            // if we force a refresh, that means do NOT serve the cached value,\n            // unless we are already in the process of refreshing the cache.\n            const isStale = this.#isStale(index);\n            if (!forceRefresh && !isStale) {\n                if (status)\n                    status.fetch = 'hit';\n                this.#moveToTail(index);\n                if (updateAgeOnGet) {\n                    this.#updateItemAge(index);\n                }\n                if (status)\n                    this.#statusTTL(status, index);\n                return v;\n            }\n            // ok, it is stale or a forced refresh, and not already fetching.\n            // refresh the cache.\n            const p = this.#backgroundFetch(k, index, options, context);\n            const hasStale = p.__staleWhileFetching !== undefined;\n            const staleVal = hasStale && allowStale;\n            if (status) {\n                status.fetch = isStale ? 'stale' : 'refresh';\n                if (staleVal && isStale)\n                    status.returnedStale = true;\n            }\n            return staleVal ? p.__staleWhileFetching : (p.__returned = p);\n        }\n    }\n    /**\n     * Return a value from the cache. Will update the recency of the cache\n     * entry found.\n     *\n     * If the key is not found, get() will return `undefined`.\n     */\n    get(k, getOptions = {}) {\n        const { allowStale = this.allowStale, updateAgeOnGet = this.updateAgeOnGet, noDeleteOnStaleGet = this.noDeleteOnStaleGet, status, } = getOptions;\n        const index = this.#keyMap.get(k);\n        if (index !== undefined) {\n            const value = this.#valList[index];\n            const fetching = this.#isBackgroundFetch(value);\n            if (status)\n                this.#statusTTL(status, index);\n            if (this.#isStale(index)) {\n                if (status)\n                    status.get = 'stale';\n                // delete only if not an in-flight background fetch\n                if (!fetching) {\n                    if (!noDeleteOnStaleGet) {\n                        this.delete(k);\n                    }\n                    if (status && allowStale)\n                        status.returnedStale = true;\n                    return allowStale ? value : undefined;\n                }\n                else {\n                    if (status &&\n                        allowStale &&\n                        value.__staleWhileFetching !== undefined) {\n                        status.returnedStale = true;\n                    }\n                    return allowStale ? value.__staleWhileFetching : undefined;\n                }\n            }\n            else {\n                if (status)\n                    status.get = 'hit';\n                // if we're currently fetching it, we don't actually have it yet\n                // it's not stale, which means this isn't a staleWhileRefetching.\n                // If it's not stale, and fetching, AND has a __staleWhileFetching\n                // value, then that means the user fetched with {forceRefresh:true},\n                // so it's safe to return that value.\n                if (fetching) {\n                    return value.__staleWhileFetching;\n                }\n                this.#moveToTail(index);\n                if (updateAgeOnGet) {\n                    this.#updateItemAge(index);\n                }\n                return value;\n            }\n        }\n        else if (status) {\n            status.get = 'miss';\n        }\n    }\n    #connect(p, n) {\n        this.#prev[n] = p;\n        this.#next[p] = n;\n    }\n    #moveToTail(index) {\n        // if tail already, nothing to do\n        // if head, move head to next[index]\n        // else\n        //   move next[prev[index]] to next[index] (head has no prev)\n        //   move prev[next[index]] to prev[index]\n        // prev[index] = tail\n        // next[tail] = index\n        // tail = index\n        if (index !== this.#tail) {\n            if (index === this.#head) {\n                this.#head = this.#next[index];\n            }\n            else {\n                this.#connect(this.#prev[index], this.#next[index]);\n            }\n            this.#connect(this.#tail, index);\n            this.#tail = index;\n        }\n    }\n    /**\n     * Deletes a key out of the cache.\n     * Returns true if the key was deleted, false otherwise.\n     */\n    delete(k) {\n        let deleted = false;\n        if (this.#size !== 0) {\n            const index = this.#keyMap.get(k);\n            if (index !== undefined) {\n                deleted = true;\n                if (this.#size === 1) {\n                    this.clear();\n                }\n                else {\n                    this.#removeItemSize(index);\n                    const v = this.#valList[index];\n                    if (this.#isBackgroundFetch(v)) {\n                        v.__abortController.abort(new Error('deleted'));\n                    }\n                    else if (this.#hasDispose || this.#hasDisposeAfter) {\n                        if (this.#hasDispose) {\n                            this.#dispose?.(v, k, 'delete');\n                        }\n                        if (this.#hasDisposeAfter) {\n                            this.#disposed?.push([v, k, 'delete']);\n                        }\n                    }\n                    this.#keyMap.delete(k);\n                    this.#keyList[index] = undefined;\n                    this.#valList[index] = undefined;\n                    if (index === this.#tail) {\n                        this.#tail = this.#prev[index];\n                    }\n                    else if (index === this.#head) {\n                        this.#head = this.#next[index];\n                    }\n                    else {\n                        const pi = this.#prev[index];\n                        this.#next[pi] = this.#next[index];\n                        const ni = this.#next[index];\n                        this.#prev[ni] = this.#prev[index];\n                    }\n                    this.#size--;\n                    this.#free.push(index);\n                }\n            }\n        }\n        if (this.#hasDisposeAfter && this.#disposed?.length) {\n            const dt = this.#disposed;\n            let task;\n            while ((task = dt?.shift())) {\n                this.#disposeAfter?.(...task);\n            }\n        }\n        return deleted;\n    }\n    /**\n     * Clear the cache entirely, throwing away all values.\n     */\n    clear() {\n        for (const index of this.#rindexes({ allowStale: true })) {\n            const v = this.#valList[index];\n            if (this.#isBackgroundFetch(v)) {\n                v.__abortController.abort(new Error('deleted'));\n            }\n            else {\n                const k = this.#keyList[index];\n                if (this.#hasDispose) {\n                    this.#dispose?.(v, k, 'delete');\n                }\n                if (this.#hasDisposeAfter) {\n                    this.#disposed?.push([v, k, 'delete']);\n                }\n            }\n        }\n        this.#keyMap.clear();\n        this.#valList.fill(undefined);\n        this.#keyList.fill(undefined);\n        if (this.#ttls && this.#starts) {\n            this.#ttls.fill(0);\n            this.#starts.fill(0);\n        }\n        if (this.#sizes) {\n            this.#sizes.fill(0);\n        }\n        this.#head = 0;\n        this.#tail = 0;\n        this.#free.length = 0;\n        this.#calculatedSize = 0;\n        this.#size = 0;\n        if (this.#hasDisposeAfter && this.#disposed) {\n            const dt = this.#disposed;\n            let task;\n            while ((task = dt?.shift())) {\n                this.#disposeAfter?.(...task);\n            }\n        }\n    }\n}\n//# sourceMappingURL=index.js.map","import { flatten } from 'lodash';\nimport { LRUCache } from 'lru-cache';\n\nimport { LanguageProvider, AbstractQuery, KeyValue, getDefaultTimeRange, TimeRange } from '@grafana/data';\nimport { config } from '@grafana/runtime';\n\nimport { DEFAULT_MAX_LINES_SAMPLE, LokiDatasource } from './datasource';\nimport { abstractQueryToExpr, mapAbstractOperatorsToOp, processLabels } from './languageUtils';\nimport { getStreamSelectorsFromQuery } from './queryUtils';\nimport { buildVisualQueryFromString } from './querybuilder/parsing';\nimport {\n  extractLabelKeysFromDataFrame,\n  extractLogParserFromDataFrame,\n  extractUnwrapLabelKeysFromDataFrame,\n} from './responseUtils';\nimport { ParserAndLabelKeysResult, LokiQuery, LokiQueryType, LabelType } from './types';\n\nconst NS_IN_MS = 1000000;\nconst EMPTY_SELECTOR = '{}';\n\nexport default class LokiLanguageProvider extends LanguageProvider {\n  labelKeys: string[];\n  started = false;\n  startedTimeRange?: TimeRange;\n  datasource: LokiDatasource;\n\n  /**\n   *  Cache for labels of series. This is bit simplistic in the sense that it just counts responses each as a 1 and does\n   *  not account for different size of a response. If that is needed a `length` function can be added in the options.\n   *  10 as a max size is totally arbitrary right now.\n   */\n  private seriesCache = new LRUCache<string, Record<string, string[]>>({ max: 10 });\n  private labelsCache = new LRUCache<string, string[]>({ max: 10 });\n\n  constructor(datasource: LokiDatasource, initialValues?: any) {\n    super();\n\n    this.datasource = datasource;\n    this.labelKeys = [];\n\n    Object.assign(this, initialValues);\n  }\n\n  request = async (url: string, params?: Record<string, string | number>) => {\n    try {\n      return await this.datasource.metadataRequest(url, params);\n    } catch (error) {\n      console.error(error);\n    }\n\n    return undefined;\n  };\n\n  /**\n   * Initialize the language provider by fetching set of labels.\n   */\n  start = (timeRange?: TimeRange) => {\n    const range = timeRange ?? this.getDefaultTimeRange();\n    // refetch labels if either there's not already a start task or the time range has changed\n    if (\n      !this.startTask ||\n      this.startedTimeRange?.from.isSame(range.from) === false ||\n      this.startedTimeRange?.to.isSame(range.to) === false\n    ) {\n      this.startedTimeRange = range;\n      this.startTask = this.fetchLabels({ timeRange: range }).then(() => {\n        this.started = true;\n        return [];\n      });\n    }\n\n    return this.startTask;\n  };\n\n  /**\n   * Returns the label keys that have been fetched.\n   * If labels have not been fetched yet, it will return an empty array.\n   * For updated labels (which should not happen often), use fetchLabels.\n   * @todo It is quite complicated to know when to use fetchLabels and when to use getLabelKeys.\n   * We should consider simplifying this and use caching in the same way as with seriesCache and labelsCache\n   * and just always use fetchLabels.\n   * Caching should be thought out properly, so we are not fetching this often, as labelKeys should not be changing often.\n   *\n   * @returns {string[]} An array of label keys or an empty array if labels have not been fetched.\n   */\n  getLabelKeys(): string[] {\n    return this.labelKeys;\n  }\n\n  importFromAbstractQuery(labelBasedQuery: AbstractQuery): LokiQuery {\n    return {\n      refId: labelBasedQuery.refId,\n      expr: abstractQueryToExpr(labelBasedQuery),\n      queryType: LokiQueryType.Range,\n    };\n  }\n\n  exportToAbstractQuery(query: LokiQuery): AbstractQuery {\n    if (!query.expr || query.expr.length === 0) {\n      return { refId: query.refId, labelMatchers: [] };\n    }\n    const streamSelectors = getStreamSelectorsFromQuery(query.expr);\n\n    const labelMatchers = streamSelectors.map((streamSelector) => {\n      const visualQuery = buildVisualQueryFromString(streamSelector).query;\n      const matchers = visualQuery.labels.map((label) => {\n        return {\n          name: label.label,\n          value: label.value,\n          operator: mapAbstractOperatorsToOp[label.op],\n        };\n      });\n      return matchers;\n    });\n\n    return {\n      refId: query.refId,\n      labelMatchers: flatten(labelMatchers),\n    };\n  }\n\n  /**\n   * Fetch label keys using the best applicable endpoint.\n   *\n   * This asynchronous function returns all available label keys from the data source.\n   * It returns a promise that resolves to an array of strings containing the label keys.\n   *\n   * @param options - (Optional) An object containing additional options.\n   * @param options.streamSelector - (Optional) The stream selector to filter label keys. If not provided, all label keys are fetched.\n   * @param options.timeRange - (Optional) The time range for which you want to retrieve label keys. If not provided, the default time range is used.\n   * @returns A promise containing an array of label keys.\n   * @throws An error if the fetch operation fails.\n   */\n  async fetchLabels(options?: { streamSelector?: string; timeRange?: TimeRange }): Promise<string[]> {\n    // If there is no stream selector - use /labels endpoint (https://github.com/grafana/loki/pull/11982)\n    if (!options || !options.streamSelector) {\n      return this.fetchLabelsByLabelsEndpoint(options);\n    } else {\n      const data = await this.fetchSeriesLabels(options.streamSelector, { timeRange: options.timeRange });\n      return Object.keys(data ?? {});\n    }\n  }\n\n  /**\n   * Fetch all label keys\n   * This asynchronous function returns all available label keys from the data source.\n   * It returns a promise that resolves to an array of strings containing the label keys.\n   *\n   * @param options - (Optional) An object containing additional options - currently only time range.\n   * @param options.timeRange - (Optional) The time range for which you want to retrieve label keys. If not provided, the default time range is used.\n   * @returns A promise containing an array of label keys.\n   * @throws An error if the fetch operation fails.\n   */\n  private async fetchLabelsByLabelsEndpoint(options?: { timeRange?: TimeRange }): Promise<string[]> {\n    const url = 'labels';\n    const range = options?.timeRange ?? this.getDefaultTimeRange();\n    const timeRange = this.datasource.getTimeRangeParams(range);\n\n    const res = await this.request(url, timeRange);\n    if (Array.isArray(res)) {\n      const labels = res\n        .slice()\n        .sort()\n        .filter((label) => label !== '__name__');\n      this.labelKeys = labels;\n      return this.labelKeys;\n    }\n\n    return [];\n  }\n\n  /**\n   * Fetch series labels for a selector\n   *\n   * This method fetches labels for a given stream selector, such as `{job=\"grafana\"}`.\n   * It returns a promise that resolves to a record mapping label names to their corresponding values.\n   *\n   * @param streamSelector - The stream selector for which you want to retrieve labels.\n   * @param options - (Optional) An object containing additional options - currently only time range.\n   * @param options.timeRange - (Optional) The time range for which you want to retrieve label keys. If not provided, the default time range is used.\n   * @returns A promise containing a record of label names and their values.\n   * @throws An error if the fetch operation fails.\n   */\n  fetchSeriesLabels = async (\n    streamSelector: string,\n    options?: { timeRange?: TimeRange }\n  ): Promise<Record<string, string[]>> => {\n    const interpolatedMatch = this.datasource.interpolateString(streamSelector);\n    const url = 'series';\n    const range = options?.timeRange ?? this.getDefaultTimeRange();\n    const { start, end } = this.datasource.getTimeRangeParams(range);\n\n    const cacheKey = this.generateCacheKey(url, start, end, interpolatedMatch);\n    let value = this.seriesCache.get(cacheKey);\n    if (!value) {\n      const params = { 'match[]': interpolatedMatch, start, end };\n      const data = await this.request(url, params);\n      if (!Array.isArray(data)) {\n        return {};\n      }\n      const { values } = processLabels(data);\n      value = values;\n      this.seriesCache.set(cacheKey, value);\n    }\n    return value;\n  };\n\n  /**\n   * Fetch series for a selector. Use this for raw results. Use fetchSeriesLabels() to get labels.\n   * @param match\n   * @param streamSelector - The stream selector for which you want to retrieve labels.\n   * @param options - (Optional) An object containing additional options.\n   * @param options.timeRange - (Optional) The time range for which you want to retrieve label keys. If not provided, the default time range is used.\n   * @returns A promise containing array with records of label names and their value.\n   */\n  fetchSeries = async (match: string, options?: { timeRange?: TimeRange }): Promise<Array<Record<string, string>>> => {\n    const url = 'series';\n    const range = options?.timeRange ?? this.getDefaultTimeRange();\n    const { start, end } = this.datasource.getTimeRangeParams(range);\n    const params = { 'match[]': match, start, end };\n    return await this.request(url, params);\n  };\n\n  // Cache key is a bit different here. We round up to a minute the intervals.\n  // The rounding may seem strange but makes relative intervals like now-1h less prone to need separate request every\n  // millisecond while still actually getting all the keys for the correct interval. This still can create problems\n  // when user does not the newest values for a minute if already cached.\n  private generateCacheKey(url: string, start: number, end: number, param: string): string {\n    return [url, this.roundTime(start), this.roundTime(end), param].join();\n  }\n\n  // Round nanoseconds epoch to nearest 5 minute interval\n  private roundTime(nanoseconds: number): number {\n    return nanoseconds ? Math.floor(nanoseconds / NS_IN_MS / 1000 / 60 / 5) : 0;\n  }\n\n  /**\n   * Fetch label values\n   *\n   * This asynchronous function fetches values associated with a specified label name.\n   * It returns a promise that resolves to an array of strings containing the label values.\n   *\n   * @param labelName - The name of the label for which you want to retrieve values.\n   * @param options - (Optional) An object containing additional options.\n   * @param options.streamSelector - (Optional) The stream selector to filter label values. If not provided, all label values are fetched.\n   * @param options.timeRange - (Optional) The time range for which you want to retrieve label values. If not provided, the default time range is used.\n   * @returns A promise containing an array of label values.\n   * @throws An error if the fetch operation fails.\n   */\n  async fetchLabelValues(\n    labelName: string,\n    options?: { streamSelector?: string; timeRange?: TimeRange }\n  ): Promise<string[]> {\n    const label = encodeURIComponent(this.datasource.interpolateString(labelName));\n    // Loki doesn't allow empty streamSelector {}, so we should not send it.\n    const streamParam =\n      options?.streamSelector && options.streamSelector !== EMPTY_SELECTOR\n        ? this.datasource.interpolateString(options.streamSelector)\n        : undefined;\n\n    const url = `label/${label}/values`;\n    const range = options?.timeRange ?? this.getDefaultTimeRange();\n    const rangeParams = this.datasource.getTimeRangeParams(range);\n    const { start, end } = rangeParams;\n    const params: KeyValue<string | number> = { start, end };\n    let paramCacheKey = label;\n\n    if (streamParam) {\n      params.query = streamParam;\n      paramCacheKey += streamParam;\n    }\n\n    const cacheKey = this.generateCacheKey(url, start, end, paramCacheKey);\n\n    let labelValues = this.labelsCache.get(cacheKey);\n    if (!labelValues) {\n      // Clear value when requesting new one. Empty object being truthy also makes sure we don't request twice.\n      this.labelsCache.set(cacheKey, []);\n      const res = await this.request(url, params);\n      if (Array.isArray(res)) {\n        labelValues = res.slice().sort();\n        this.labelsCache.set(cacheKey, labelValues);\n      }\n    }\n\n    return labelValues ?? [];\n  }\n\n  /**\n   * Get parser and label keys for a selector\n   *\n   * This asynchronous function is used to fetch parsers and label keys for a selected log stream based on sampled lines.\n   * It returns a promise that resolves to an object with the following properties:\n   *\n   * - `extractedLabelKeys`: An array of available label keys associated with the log stream.\n   * - `hasJSON`: A boolean indicating whether JSON parsing is available for the stream.\n   * - `hasLogfmt`: A boolean indicating whether Logfmt parsing is available for the stream.\n   * - `hasPack`: A boolean indicating whether Pack parsing is available for the stream.\n   * - `unwrapLabelKeys`: An array of label keys that can be used for unwrapping log data.\n   *\n   * @param streamSelector - The selector for the log stream you want to analyze.\n   * @param options - (Optional) An object containing additional options.\n   * @param options.maxLines - (Optional) The number of log lines requested when determining parsers and label keys.\n   * @param options.timeRange - (Optional) The time range for which you want to retrieve label keys. If not provided, the default time range is used.\n   * Smaller maxLines is recommended for improved query performance. The default count is 10.\n   * @returns A promise containing an object with parser and label key information.\n   * @throws An error if the fetch operation fails.\n   */\n  async getParserAndLabelKeys(\n    streamSelector: string,\n    options?: { maxLines?: number; timeRange?: TimeRange }\n  ): Promise<ParserAndLabelKeysResult> {\n    const empty = {\n      extractedLabelKeys: [],\n      structuredMetadataKeys: [],\n      unwrapLabelKeys: [],\n      hasJSON: false,\n      hasLogfmt: false,\n      hasPack: false,\n    };\n    if (!config.featureToggles.lokiQueryHints) {\n      return empty;\n    }\n\n    const series = await this.datasource.getDataSamples(\n      {\n        expr: streamSelector,\n        refId: 'data-samples',\n        maxLines: options?.maxLines || DEFAULT_MAX_LINES_SAMPLE,\n      },\n      options?.timeRange ?? this.getDefaultTimeRange()\n    );\n\n    if (!series.length) {\n      return empty;\n    }\n\n    const { hasLogfmt, hasJSON, hasPack } = extractLogParserFromDataFrame(series[0]);\n\n    return {\n      extractedLabelKeys: [\n        ...extractLabelKeysFromDataFrame(series[0], LabelType.Indexed),\n        ...extractLabelKeysFromDataFrame(series[0], LabelType.Parsed),\n      ],\n      structuredMetadataKeys: extractLabelKeysFromDataFrame(series[0], LabelType.StructuredMetadata),\n      unwrapLabelKeys: extractUnwrapLabelKeysFromDataFrame(series[0]),\n      hasJSON,\n      hasPack,\n      hasLogfmt,\n    };\n  }\n\n  /**\n   * Get the default time range\n   *\n   * @returns {TimeRange} The default time range\n   */\n  private getDefaultTimeRange(): TimeRange {\n    return getDefaultTimeRange();\n  }\n}\n","import { __assign, __extends } from \"tslib\";\nimport { Subject, AnonymousSubject } from '../../Subject';\nimport { Subscriber } from '../../Subscriber';\nimport { Observable } from '../../Observable';\nimport { Subscription } from '../../Subscription';\nimport { ReplaySubject } from '../../ReplaySubject';\nvar DEFAULT_WEBSOCKET_CONFIG = {\n    url: '',\n    deserializer: function (e) { return JSON.parse(e.data); },\n    serializer: function (value) { return JSON.stringify(value); },\n};\nvar WEBSOCKETSUBJECT_INVALID_ERROR_OBJECT = 'WebSocketSubject.error must be called with an object with an error code, and an optional reason: { code: number, reason: string }';\nvar WebSocketSubject = (function (_super) {\n    __extends(WebSocketSubject, _super);\n    function WebSocketSubject(urlConfigOrSource, destination) {\n        var _this = _super.call(this) || this;\n        _this._socket = null;\n        if (urlConfigOrSource instanceof Observable) {\n            _this.destination = destination;\n            _this.source = urlConfigOrSource;\n        }\n        else {\n            var config = (_this._config = __assign({}, DEFAULT_WEBSOCKET_CONFIG));\n            _this._output = new Subject();\n            if (typeof urlConfigOrSource === 'string') {\n                config.url = urlConfigOrSource;\n            }\n            else {\n                for (var key in urlConfigOrSource) {\n                    if (urlConfigOrSource.hasOwnProperty(key)) {\n                        config[key] = urlConfigOrSource[key];\n                    }\n                }\n            }\n            if (!config.WebSocketCtor && WebSocket) {\n                config.WebSocketCtor = WebSocket;\n            }\n            else if (!config.WebSocketCtor) {\n                throw new Error('no WebSocket constructor can be found');\n            }\n            _this.destination = new ReplaySubject();\n        }\n        return _this;\n    }\n    WebSocketSubject.prototype.lift = function (operator) {\n        var sock = new WebSocketSubject(this._config, this.destination);\n        sock.operator = operator;\n        sock.source = this;\n        return sock;\n    };\n    WebSocketSubject.prototype._resetState = function () {\n        this._socket = null;\n        if (!this.source) {\n            this.destination = new ReplaySubject();\n        }\n        this._output = new Subject();\n    };\n    WebSocketSubject.prototype.multiplex = function (subMsg, unsubMsg, messageFilter) {\n        var self = this;\n        return new Observable(function (observer) {\n            try {\n                self.next(subMsg());\n            }\n            catch (err) {\n                observer.error(err);\n            }\n            var subscription = self.subscribe({\n                next: function (x) {\n                    try {\n                        if (messageFilter(x)) {\n                            observer.next(x);\n                        }\n                    }\n                    catch (err) {\n                        observer.error(err);\n                    }\n                },\n                error: function (err) { return observer.error(err); },\n                complete: function () { return observer.complete(); },\n            });\n            return function () {\n                try {\n                    self.next(unsubMsg());\n                }\n                catch (err) {\n                    observer.error(err);\n                }\n                subscription.unsubscribe();\n            };\n        });\n    };\n    WebSocketSubject.prototype._connectSocket = function () {\n        var _this = this;\n        var _a = this._config, WebSocketCtor = _a.WebSocketCtor, protocol = _a.protocol, url = _a.url, binaryType = _a.binaryType;\n        var observer = this._output;\n        var socket = null;\n        try {\n            socket = protocol ? new WebSocketCtor(url, protocol) : new WebSocketCtor(url);\n            this._socket = socket;\n            if (binaryType) {\n                this._socket.binaryType = binaryType;\n            }\n        }\n        catch (e) {\n            observer.error(e);\n            return;\n        }\n        var subscription = new Subscription(function () {\n            _this._socket = null;\n            if (socket && socket.readyState === 1) {\n                socket.close();\n            }\n        });\n        socket.onopen = function (evt) {\n            var _socket = _this._socket;\n            if (!_socket) {\n                socket.close();\n                _this._resetState();\n                return;\n            }\n            var openObserver = _this._config.openObserver;\n            if (openObserver) {\n                openObserver.next(evt);\n            }\n            var queue = _this.destination;\n            _this.destination = Subscriber.create(function (x) {\n                if (socket.readyState === 1) {\n                    try {\n                        var serializer = _this._config.serializer;\n                        socket.send(serializer(x));\n                    }\n                    catch (e) {\n                        _this.destination.error(e);\n                    }\n                }\n            }, function (err) {\n                var closingObserver = _this._config.closingObserver;\n                if (closingObserver) {\n                    closingObserver.next(undefined);\n                }\n                if (err && err.code) {\n                    socket.close(err.code, err.reason);\n                }\n                else {\n                    observer.error(new TypeError(WEBSOCKETSUBJECT_INVALID_ERROR_OBJECT));\n                }\n                _this._resetState();\n            }, function () {\n                var closingObserver = _this._config.closingObserver;\n                if (closingObserver) {\n                    closingObserver.next(undefined);\n                }\n                socket.close();\n                _this._resetState();\n            });\n            if (queue && queue instanceof ReplaySubject) {\n                subscription.add(queue.subscribe(_this.destination));\n            }\n        };\n        socket.onerror = function (e) {\n            _this._resetState();\n            observer.error(e);\n        };\n        socket.onclose = function (e) {\n            if (socket === _this._socket) {\n                _this._resetState();\n            }\n            var closeObserver = _this._config.closeObserver;\n            if (closeObserver) {\n                closeObserver.next(e);\n            }\n            if (e.wasClean) {\n                observer.complete();\n            }\n            else {\n                observer.error(e);\n            }\n        };\n        socket.onmessage = function (e) {\n            try {\n                var deserializer = _this._config.deserializer;\n                observer.next(deserializer(e));\n            }\n            catch (err) {\n                observer.error(err);\n            }\n        };\n    };\n    WebSocketSubject.prototype._subscribe = function (subscriber) {\n        var _this = this;\n        var source = this.source;\n        if (source) {\n            return source.subscribe(subscriber);\n        }\n        if (!this._socket) {\n            this._connectSocket();\n        }\n        this._output.subscribe(subscriber);\n        subscriber.add(function () {\n            var _socket = _this._socket;\n            if (_this._output.observers.length === 0) {\n                if (_socket && (_socket.readyState === 1 || _socket.readyState === 0)) {\n                    _socket.close();\n                }\n                _this._resetState();\n            }\n        });\n        return subscriber;\n    };\n    WebSocketSubject.prototype.unsubscribe = function () {\n        var _socket = this._socket;\n        if (_socket && (_socket.readyState === 1 || _socket.readyState === 0)) {\n            _socket.close();\n        }\n        this._resetState();\n        _super.prototype.unsubscribe.call(this);\n    };\n    return WebSocketSubject;\n}(AnonymousSubject));\nexport { WebSocketSubject };\n//# sourceMappingURL=WebSocketSubject.js.map","import { WebSocketSubject } from './WebSocketSubject';\nexport function webSocket(urlConfigOrSource) {\n    return new WebSocketSubject(urlConfigOrSource);\n}\n//# sourceMappingURL=webSocket.js.map","import validate from './validate.js';\n\nfunction parse(uuid) {\n  if (!validate(uuid)) {\n    throw TypeError('Invalid UUID');\n  }\n\n  let v;\n  const arr = new Uint8Array(16); // Parse ########-....-....-....-............\n\n  arr[0] = (v = parseInt(uuid.slice(0, 8), 16)) >>> 24;\n  arr[1] = v >>> 16 & 0xff;\n  arr[2] = v >>> 8 & 0xff;\n  arr[3] = v & 0xff; // Parse ........-####-....-....-............\n\n  arr[4] = (v = parseInt(uuid.slice(9, 13), 16)) >>> 8;\n  arr[5] = v & 0xff; // Parse ........-....-####-....-............\n\n  arr[6] = (v = parseInt(uuid.slice(14, 18), 16)) >>> 8;\n  arr[7] = v & 0xff; // Parse ........-....-....-####-............\n\n  arr[8] = (v = parseInt(uuid.slice(19, 23), 16)) >>> 8;\n  arr[9] = v & 0xff; // Parse ........-....-....-....-############\n  // (Use \"/\" to avoid 32-bit truncation when bit-shifting high-order bytes)\n\n  arr[10] = (v = parseInt(uuid.slice(24, 36), 16)) / 0x10000000000 & 0xff;\n  arr[11] = v / 0x100000000 & 0xff;\n  arr[12] = v >>> 24 & 0xff;\n  arr[13] = v >>> 16 & 0xff;\n  arr[14] = v >>> 8 & 0xff;\n  arr[15] = v & 0xff;\n  return arr;\n}\n\nexport default parse;","import { unsafeStringify } from './stringify.js';\nimport parse from './parse.js';\n\nfunction stringToBytes(str) {\n  str = unescape(encodeURIComponent(str)); // UTF8 escape\n\n  const bytes = [];\n\n  for (let i = 0; i < str.length; ++i) {\n    bytes.push(str.charCodeAt(i));\n  }\n\n  return bytes;\n}\n\nexport const DNS = '6ba7b810-9dad-11d1-80b4-00c04fd430c8';\nexport const URL = '6ba7b811-9dad-11d1-80b4-00c04fd430c8';\nexport default function v35(name, version, hashfunc) {\n  function generateUUID(value, namespace, buf, offset) {\n    var _namespace;\n\n    if (typeof value === 'string') {\n      value = stringToBytes(value);\n    }\n\n    if (typeof namespace === 'string') {\n      namespace = parse(namespace);\n    }\n\n    if (((_namespace = namespace) === null || _namespace === void 0 ? void 0 : _namespace.length) !== 16) {\n      throw TypeError('Namespace must be array-like (16 iterable integer values, 0-255)');\n    } // Compute hash of namespace and value, Per 4.3\n    // Future: Use spread syntax when supported on all platforms, e.g. `bytes =\n    // hashfunc([...namespace, ... value])`\n\n\n    let bytes = new Uint8Array(16 + value.length);\n    bytes.set(namespace);\n    bytes.set(value, namespace.length);\n    bytes = hashfunc(bytes);\n    bytes[6] = bytes[6] & 0x0f | version;\n    bytes[8] = bytes[8] & 0x3f | 0x80;\n\n    if (buf) {\n      offset = offset || 0;\n\n      for (let i = 0; i < 16; ++i) {\n        buf[offset + i] = bytes[i];\n      }\n\n      return buf;\n    }\n\n    return unsafeStringify(bytes);\n  } // Function#name is not settable on some platforms (#270)\n\n\n  try {\n    generateUUID.name = name; // eslint-disable-next-line no-empty\n  } catch (err) {} // For CommonJS default export support\n\n\n  generateUUID.DNS = DNS;\n  generateUUID.URL = URL;\n  return generateUUID;\n}","// Adapted from Chris Veness' SHA1 code at\n// http://www.movable-type.co.uk/scripts/sha1.html\nfunction f(s, x, y, z) {\n  switch (s) {\n    case 0:\n      return x & y ^ ~x & z;\n\n    case 1:\n      return x ^ y ^ z;\n\n    case 2:\n      return x & y ^ x & z ^ y & z;\n\n    case 3:\n      return x ^ y ^ z;\n  }\n}\n\nfunction ROTL(x, n) {\n  return x << n | x >>> 32 - n;\n}\n\nfunction sha1(bytes) {\n  const K = [0x5a827999, 0x6ed9eba1, 0x8f1bbcdc, 0xca62c1d6];\n  const H = [0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476, 0xc3d2e1f0];\n\n  if (typeof bytes === 'string') {\n    const msg = unescape(encodeURIComponent(bytes)); // UTF8 escape\n\n    bytes = [];\n\n    for (let i = 0; i < msg.length; ++i) {\n      bytes.push(msg.charCodeAt(i));\n    }\n  } else if (!Array.isArray(bytes)) {\n    // Convert Array-like to Array\n    bytes = Array.prototype.slice.call(bytes);\n  }\n\n  bytes.push(0x80);\n  const l = bytes.length / 4 + 2;\n  const N = Math.ceil(l / 16);\n  const M = new Array(N);\n\n  for (let i = 0; i < N; ++i) {\n    const arr = new Uint32Array(16);\n\n    for (let j = 0; j < 16; ++j) {\n      arr[j] = bytes[i * 64 + j * 4] << 24 | bytes[i * 64 + j * 4 + 1] << 16 | bytes[i * 64 + j * 4 + 2] << 8 | bytes[i * 64 + j * 4 + 3];\n    }\n\n    M[i] = arr;\n  }\n\n  M[N - 1][14] = (bytes.length - 1) * 8 / Math.pow(2, 32);\n  M[N - 1][14] = Math.floor(M[N - 1][14]);\n  M[N - 1][15] = (bytes.length - 1) * 8 & 0xffffffff;\n\n  for (let i = 0; i < N; ++i) {\n    const W = new Uint32Array(80);\n\n    for (let t = 0; t < 16; ++t) {\n      W[t] = M[i][t];\n    }\n\n    for (let t = 16; t < 80; ++t) {\n      W[t] = ROTL(W[t - 3] ^ W[t - 8] ^ W[t - 14] ^ W[t - 16], 1);\n    }\n\n    let a = H[0];\n    let b = H[1];\n    let c = H[2];\n    let d = H[3];\n    let e = H[4];\n\n    for (let t = 0; t < 80; ++t) {\n      const s = Math.floor(t / 20);\n      const T = ROTL(a, 5) + f(s, b, c, d) + e + K[s] + W[t] >>> 0;\n      e = d;\n      d = c;\n      c = ROTL(b, 30) >>> 0;\n      b = a;\n      a = T;\n    }\n\n    H[0] = H[0] + a >>> 0;\n    H[1] = H[1] + b >>> 0;\n    H[2] = H[2] + c >>> 0;\n    H[3] = H[3] + d >>> 0;\n    H[4] = H[4] + e >>> 0;\n  }\n\n  return [H[0] >> 24 & 0xff, H[0] >> 16 & 0xff, H[0] >> 8 & 0xff, H[0] & 0xff, H[1] >> 24 & 0xff, H[1] >> 16 & 0xff, H[1] >> 8 & 0xff, H[1] & 0xff, H[2] >> 24 & 0xff, H[2] >> 16 & 0xff, H[2] >> 8 & 0xff, H[2] & 0xff, H[3] >> 24 & 0xff, H[3] >> 16 & 0xff, H[3] >> 8 & 0xff, H[3] & 0xff, H[4] >> 24 & 0xff, H[4] >> 16 & 0xff, H[4] >> 8 & 0xff, H[4] & 0xff];\n}\n\nexport default sha1;","import v35 from './v35.js';\nimport sha1 from './sha1.js';\nconst v5 = v35('v5', 0x50, sha1);\nexport default v5;","import { v5 as uuidv5 } from 'uuid';\n\nimport { MutableDataFrame } from '@grafana/data';\n\nimport { LokiStreamResult, LokiTailResponse } from './types';\n\nconst UUID_NAMESPACE = '6ec946da-0f49-47a8-983a-1d76d17e7c92';\n\n/**\n * Transform LokiResponse data and appends it to MutableDataFrame. Used for streaming where the dataFrame can be\n * a CircularDataFrame creating a fixed size rolling buffer.\n * TODO: Probably could be unified with the logStreamToDataFrame function.\n * @param response\n * @param data Needs to have ts, line, labels, id as fields\n */\nexport function appendResponseToBufferedData(response: LokiTailResponse, data: MutableDataFrame) {\n  // Should we do anything with: response.dropped_entries?\n\n  const streams: LokiStreamResult[] = response.streams;\n  if (!streams || !streams.length) {\n    return;\n  }\n\n  const tsField = data.fields[0];\n  const lineField = data.fields[1];\n  const idField = data.fields[2];\n\n  // We are comparing used ids only within the received stream. This could be a problem if the same line + labels + nanosecond timestamp came in 2 separate batches.\n  // As this is very unlikely, and the result would only affect live-tailing css animation we have decided to not compare all received uids from data param as this would slow down processing.\n  const usedUids: Record<string, number> = {};\n\n  for (const stream of streams) {\n    // Find unique labels\n    const allLabelsString = Object.entries(stream.stream)\n      .map(([key, val]) => `${key}=\"${val}\"`)\n      .sort()\n      .join('');\n\n    // Add each line\n    for (const [ts, line] of stream.values) {\n      tsField.values.push(new Date(parseInt(ts.slice(0, -6), 10)).toISOString());\n      lineField.values.push(line);\n      idField.values.push(createUid(ts, allLabelsString, line, usedUids, data.refId));\n    }\n  }\n}\n\nfunction createUid(\n  ts: string,\n  labelsString: string,\n  line: string,\n  usedUids: Record<string, number>,\n  refId?: string\n): string {\n  // Generate id as hashed nanosecond timestamp, labels and line (this does not have to be unique)\n  let id = uuidv5(`${ts}_${labelsString}_${line}`, UUID_NAMESPACE);\n\n  // Check if generated id is unique\n  // If not and we've already used it, append its count after it\n  if (id in usedUids) {\n    // Increase the count\n    const newCount = usedUids[id] + 1;\n    usedUids[id] = newCount;\n    // Append count to generated id to make it unique\n    id = `${id}_${newCount}`;\n  } else {\n    // If id is unique and wasn't used, add it to usedUids and start count at 0\n    usedUids[id] = 0;\n  }\n  // Return unique id\n  if (refId) {\n    return `${refId}_${id}`;\n  }\n  return id;\n}\n","import { Observable, throwError, timer } from 'rxjs';\nimport { finalize, map, retryWhen, mergeMap } from 'rxjs/operators';\nimport { webSocket } from 'rxjs/webSocket';\n\nimport { DataFrame, FieldType, KeyValue, CircularDataFrame } from '@grafana/data';\n\nimport { appendResponseToBufferedData } from './liveStreamsResultTransformer';\nimport { LokiTailResponse } from './types';\n\n/**\n * Maps directly to a query in the UI (refId is key)\n */\nexport interface LokiLiveTarget {\n  query: string;\n  url: string;\n  refId: string;\n  size: number;\n}\n\n/**\n * Cache of websocket streams that can be returned as observable. In case there already is a stream for particular\n * target it is returned and on subscription returns the latest dataFrame.\n */\nexport class LiveStreams {\n  private streams: KeyValue<Observable<DataFrame[]>> = {};\n\n  getStream(target: LokiLiveTarget, retryInterval = 5000): Observable<DataFrame[]> {\n    let stream = this.streams[target.url];\n\n    if (stream) {\n      return stream;\n    }\n\n    const data = new CircularDataFrame({ capacity: target.size });\n    data.addField({ name: 'Time', type: FieldType.time, config: {} });\n    data.addField({ name: 'Line', type: FieldType.string });\n    data.addField({ name: 'id', type: FieldType.string });\n    data.meta = { ...data.meta, preferredVisualisationType: 'logs' };\n    data.refId = target.refId;\n\n    stream = webSocket<LokiTailResponse>(target.url).pipe(\n      map((response: LokiTailResponse) => {\n        appendResponseToBufferedData(response, data);\n        return [data];\n      }),\n      retryWhen((attempts) =>\n        attempts.pipe(\n          mergeMap((error, i) => {\n            const retryAttempt = i + 1;\n            // Code 1006 is used to indicate that a connection was closed abnormally.\n            // Added hard limit of 30 on number of retries.\n            // If connection was closed abnormally, and we wish to retry, otherwise throw error.\n            if (error.code === 1006 && retryAttempt < 30) {\n              if (retryAttempt > 10) {\n                // If more than 10 times retried, consol.warn, but keep reconnecting\n                console.warn(\n                  `Websocket connection is being disrupted. We keep reconnecting but consider starting new live tailing again. Error: ${error.reason}`\n                );\n              }\n              // Retry every 5s\n              return timer(retryInterval);\n            }\n            return throwError(error);\n          })\n        )\n      ),\n      finalize(() => {\n        delete this.streams[target.url];\n      })\n    );\n    this.streams[target.url] = stream;\n\n    return stream;\n  }\n}\n","import { css } from '@emotion/css';\nimport { useRef, useCallback, useEffect, useMemo, useState } from 'react';\nimport { useAsync } from 'react-use';\n\nimport { dateTime, GrafanaTheme2, LogRowModel, renderMarkdown, SelectableValue } from '@grafana/data';\nimport { RawQuery } from '@grafana/experimental';\nimport { reportInteraction } from '@grafana/runtime';\nimport {\n  Alert,\n  Button,\n  Collapse,\n  Icon,\n  InlineField,\n  InlineFieldRow,\n  InlineSwitch,\n  Label,\n  MultiSelect,\n  RenderUserContentAsHTML,\n  Spinner,\n  Tooltip,\n  useStyles2,\n} from '@grafana/ui';\n\nimport {\n  LogContextProvider,\n  LOKI_LOG_CONTEXT_PRESERVED_LABELS,\n  PreservedLabels,\n  SHOULD_INCLUDE_PIPELINE_OPERATIONS,\n} from '../LogContextProvider';\nimport { escapeLabelValueInSelector } from '../languageUtils';\nimport { lokiGrammar } from '../syntax';\nimport { ContextFilter, LokiQuery } from '../types';\n\nexport interface LokiContextUiProps {\n  logContextProvider: LogContextProvider;\n  row: LogRowModel;\n  updateFilter: (value: ContextFilter[]) => void;\n  onClose: () => void;\n  origQuery?: LokiQuery;\n  runContextQuery?: () => void;\n}\n\nfunction getStyles(theme: GrafanaTheme2) {\n  return {\n    labels: css`\n      display: flex;\n      gap: ${theme.spacing(0.5)};\n    `,\n    wrapper: css`\n      display: flex;\n      flex-direction: column;\n      flex: 1;\n      gap: ${theme.spacing(0.5)};\n      position: relative;\n    `,\n    textWrapper: css`\n      display: flex;\n      align-items: center;\n    `,\n    hidden: css`\n      visibility: hidden;\n    `,\n    label: css`\n      max-width: 100%;\n      &:first-of-type {\n        margin-bottom: ${theme.spacing(2)};\n      }\n      &:not(:first-of-type) {\n        margin: ${theme.spacing(2)} 0;\n      }\n    `,\n    rawQueryContainer: css`\n      text-align: start;\n      line-break: anywhere;\n      margin-top: -${theme.spacing(0.25)};\n      margin-right: ${theme.spacing(6)};\n      min-height: ${theme.spacing(4)};\n    `,\n    ui: css`\n      background-color: ${theme.colors.background.secondary};\n      padding: ${theme.spacing(2)};\n    `,\n    notification: css({\n      position: 'absolute',\n      zIndex: theme.zIndex.portal,\n      top: 0,\n      right: 0,\n    }),\n    rawQuery: css`\n      display: inline;\n    `,\n    queryDescription: css`\n      margin-left: ${theme.spacing(0.5)};\n    `,\n    iconButton: css`\n      position: absolute;\n      top: ${theme.spacing(1)};\n      right: ${theme.spacing(1)};\n      z-index: ${theme.zIndex.navbarFixed};\n    `,\n    operationsToggle: css`\n      margin: ${theme.spacing(1)} 0 ${theme.spacing(-1)} 0;\n      & > div {\n        margin: 0;\n        & > label {\n          padding: 0;\n        }\n      }\n    `,\n  };\n}\n\nexport const IS_LOKI_LOG_CONTEXT_UI_OPEN = 'isLogContextQueryUiOpen';\n\nexport function LokiContextUi(props: LokiContextUiProps) {\n  const { row, logContextProvider, updateFilter, onClose, origQuery, runContextQuery } = props;\n  const styles = useStyles2(getStyles);\n\n  const [contextFilters, setContextFilters] = useState<ContextFilter[]>([]);\n  const [showPreservedFiltersAppliedNotification, setShowPreservedFiltersAppliedNotification] = useState(false);\n\n  const [initialized, setInitialized] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [isOpen, setIsOpen] = useState(window.localStorage.getItem(IS_LOKI_LOG_CONTEXT_UI_OPEN) === 'true');\n  const [includePipelineOperations, setIncludePipelineOperations] = useState(\n    window.localStorage.getItem(SHOULD_INCLUDE_PIPELINE_OPERATIONS) === 'true'\n  );\n\n  const timerHandle = useRef<number>();\n  const previousInitialized = useRef<boolean>(false);\n  const previousContextFilters = useRef<ContextFilter[]>([]);\n\n  const isInitialState = useMemo(() => {\n    // Initial query has all regular labels enabled and all parsed labels disabled\n    if (initialized && contextFilters.some((filter) => filter.nonIndexed === filter.enabled)) {\n      return false;\n    }\n\n    // if we include pipeline operations, we also want to enable the revert button\n    if (includePipelineOperations && logContextProvider.queryContainsValidPipelineStages(origQuery)) {\n      return false;\n    }\n\n    return true;\n  }, [contextFilters, includePipelineOperations, initialized, logContextProvider, origQuery]);\n\n  useEffect(() => {\n    if (!initialized) {\n      return;\n    }\n\n    // don't trigger if we initialized, this will be the same query anyways.\n    if (!previousInitialized.current) {\n      previousInitialized.current = initialized;\n      return;\n    }\n\n    if (contextFilters.filter(({ enabled, nonIndexed }) => enabled && !nonIndexed).length === 0) {\n      setContextFilters(previousContextFilters.current);\n      return;\n    }\n\n    previousContextFilters.current = structuredClone(contextFilters);\n\n    if (timerHandle.current) {\n      clearTimeout(timerHandle.current);\n    }\n    setLoading(true);\n    timerHandle.current = window.setTimeout(() => {\n      updateFilter(contextFilters.filter(({ enabled }) => enabled));\n      // We are storing the removed labels and selected extracted labels in local storage so we can\n      // preselect the labels in the UI in the next log context view.\n      const preservedLabels: PreservedLabels = {\n        removedLabels: [],\n        selectedExtractedLabels: [],\n      };\n\n      contextFilters.forEach(({ enabled, nonIndexed, label }) => {\n        // We only want to store real labels that were removed from the initial query\n        if (!enabled && !nonIndexed) {\n          preservedLabels.removedLabels.push(label);\n        }\n        // Or extracted labels that were added to the initial query\n        if (enabled && nonIndexed) {\n          preservedLabels.selectedExtractedLabels.push(label);\n        }\n      });\n\n      window.localStorage.setItem(LOKI_LOG_CONTEXT_PRESERVED_LABELS, JSON.stringify(preservedLabels));\n      setLoading(false);\n    }, 1500);\n\n    return () => {\n      clearTimeout(timerHandle.current);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [contextFilters, initialized]);\n\n  useEffect(() => {\n    return () => {\n      clearTimeout(timerHandle.current);\n      onClose();\n    };\n  }, [onClose]);\n\n  useAsync(async () => {\n    setLoading(true);\n    const initContextFilters = await logContextProvider.getInitContextFilters(row, origQuery, {\n      from: dateTime(row.timeEpochMs),\n      to: dateTime(row.timeEpochMs),\n      raw: { from: dateTime(row.timeEpochMs), to: dateTime(row.timeEpochMs) },\n    });\n    setContextFilters(initContextFilters.contextFilters);\n    setShowPreservedFiltersAppliedNotification(initContextFilters.preservedFiltersApplied);\n    setInitialized(true);\n    setLoading(false);\n  });\n\n  // To hide previousContextFiltersApplied notification after 2 seconds\n  useEffect(() => {\n    if (showPreservedFiltersAppliedNotification) {\n      setTimeout(() => {\n        setShowPreservedFiltersAppliedNotification(false);\n      }, 2000);\n    }\n  }, [showPreservedFiltersAppliedNotification]);\n\n  useEffect(() => {\n    reportInteraction('grafana_explore_logs_loki_log_context_loaded', {\n      logRowUid: row.uid,\n      type: 'load',\n    });\n\n    return () => {\n      reportInteraction('grafana_explore_logs_loki_log_context_loaded', {\n        logRowUid: row.uid,\n        type: 'unload',\n      });\n    };\n  }, [row.uid]);\n\n  const realLabels = contextFilters.filter(({ nonIndexed }) => !nonIndexed);\n  const realLabelsEnabled = realLabels.filter(({ enabled }) => enabled);\n\n  const parsedLabels = contextFilters.filter(({ nonIndexed }) => nonIndexed);\n  const parsedLabelsEnabled = parsedLabels.filter(({ enabled }) => enabled);\n\n  const contextFilterToSelectFilter = useCallback((contextFilter: ContextFilter): SelectableValue<string> => {\n    return {\n      label: `${contextFilter.label}=\"${escapeLabelValueInSelector(contextFilter.value)}\"`,\n      value: contextFilter.label,\n    };\n  }, []);\n\n  // If there's any nonIndexed labels, that includes structured metadata and parsed labels, we show the nonIndexed labels input\n  const showNonIndexedLabels = parsedLabels.length > 0;\n\n  let queryExpr = logContextProvider.prepareExpression(\n    contextFilters.filter(({ enabled }) => enabled),\n    origQuery\n  );\n  return (\n    <div className={styles.wrapper}>\n      {showPreservedFiltersAppliedNotification && (\n        <Alert\n          className={styles.notification}\n          title=\"Previously used filters have been applied.\"\n          severity=\"info\"\n          elevated={true}\n        ></Alert>\n      )}\n      <Tooltip content={'Revert to initial log context query.'}>\n        <div className={styles.iconButton}>\n          <Button\n            data-testid=\"revert-button\"\n            icon=\"history-alt\"\n            variant=\"secondary\"\n            disabled={isInitialState}\n            onClick={(e) => {\n              reportInteraction('grafana_explore_logs_loki_log_context_reverted', {\n                logRowUid: row.uid,\n              });\n              setContextFilters((contextFilters) => {\n                return contextFilters.map((contextFilter) => ({\n                  ...contextFilter,\n                  // For revert to initial query we need to enable all labels and disable all parsed labels\n                  enabled: !contextFilter.nonIndexed,\n                }));\n              });\n              // We are removing the preserved labels from local storage so we can preselect the labels in the UI\n              window.localStorage.removeItem(LOKI_LOG_CONTEXT_PRESERVED_LABELS);\n              window.localStorage.removeItem(SHOULD_INCLUDE_PIPELINE_OPERATIONS);\n              setIncludePipelineOperations(false);\n            }}\n          />\n        </div>\n      </Tooltip>\n\n      <Collapse\n        collapsible={true}\n        isOpen={isOpen}\n        onToggle={() => {\n          window.localStorage.setItem(IS_LOKI_LOG_CONTEXT_UI_OPEN, (!isOpen).toString());\n          setIsOpen((isOpen) => !isOpen);\n          reportInteraction('grafana_explore_logs_loki_log_context_toggled', {\n            logRowUid: row.uid,\n            action: !isOpen ? 'open' : 'close',\n          });\n        }}\n        label={\n          <div className={styles.rawQueryContainer}>\n            {initialized ? (\n              <>\n                <RawQuery\n                  language={{ grammar: lokiGrammar, name: 'loki' }}\n                  query={queryExpr}\n                  className={styles.rawQuery}\n                />\n                <Tooltip content=\"The initial log context query is created from all labels defining the stream for the selected log line. Use the editor below to customize the log context query.\">\n                  <Icon name=\"info-circle\" size=\"sm\" className={styles.queryDescription} />\n                </Tooltip>\n              </>\n            ) : (\n              <Spinner />\n            )}\n          </div>\n        }\n      >\n        <div className={styles.ui}>\n          <Label\n            className={styles.label}\n            description=\"The initial log context query is created from all labels defining the stream for the selected log line. You can broaden your search by removing one or more of the label filters.\"\n          >\n            Widen the search\n          </Label>\n          <MultiSelect\n            isLoading={loading}\n            options={realLabels.map(contextFilterToSelectFilter)}\n            value={realLabelsEnabled.map(contextFilterToSelectFilter)}\n            closeMenuOnSelect={true}\n            maxMenuHeight={200}\n            noOptionsMessage=\"No further labels available\"\n            onChange={(keys, actionMeta) => {\n              if (actionMeta.action === 'select-option') {\n                reportInteraction('grafana_explore_logs_loki_log_context_filtered', {\n                  logRowUid: row.uid,\n                  type: 'label',\n                  action: 'select',\n                });\n              }\n              if (actionMeta.action === 'remove-value') {\n                reportInteraction('grafana_explore_logs_loki_log_context_filtered', {\n                  logRowUid: row.uid,\n                  type: 'label',\n                  action: 'remove',\n                });\n              }\n              return setContextFilters(\n                contextFilters.map((filter) => {\n                  if (filter.nonIndexed) {\n                    return filter;\n                  }\n                  filter.enabled = keys.some((key) => key.value === filter.label);\n                  return filter;\n                })\n              );\n            }}\n          />\n          {showNonIndexedLabels && (\n            <>\n              <Label\n                className={styles.label}\n                description={`By using a parser in your original query, you can use filters for extracted labels. Refine your search by applying extracted labels created from the selected log line.`}\n              >\n                Refine the search\n              </Label>\n              <MultiSelect\n                isLoading={loading}\n                options={parsedLabels.map(contextFilterToSelectFilter)}\n                value={parsedLabelsEnabled.map(contextFilterToSelectFilter)}\n                closeMenuOnSelect={true}\n                maxMenuHeight={200}\n                noOptionsMessage=\"No further labels available\"\n                isClearable={true}\n                onChange={(keys, actionMeta) => {\n                  if (actionMeta.action === 'select-option') {\n                    reportInteraction('grafana_explore_logs_loki_log_context_filtered', {\n                      logRowUid: row.uid,\n                      type: 'parsed_label',\n                      action: 'select',\n                    });\n                  }\n                  if (actionMeta.action === 'remove-value') {\n                    reportInteraction('grafana_explore_logs_loki_log_context_filtered', {\n                      logRowUid: row.uid,\n                      type: 'parsed_label',\n                      action: 'remove',\n                    });\n                  }\n                  setContextFilters(\n                    contextFilters.map((filter) => {\n                      if (!filter.nonIndexed) {\n                        return filter;\n                      }\n                      filter.enabled = keys.some((key) => key.value === filter.label);\n                      return filter;\n                    })\n                  );\n                }}\n              />\n            </>\n          )}\n          {logContextProvider.queryContainsValidPipelineStages(origQuery) && (\n            <InlineFieldRow className={styles.operationsToggle}>\n              <InlineField\n                label=\"Include LogQL pipeline operations\"\n                tooltip={\n                  <RenderUserContentAsHTML\n                    content={renderMarkdown(\n                      \"This will include LogQL operations such as `line_format` or `label_format`. It won't include line or label filter operations.\"\n                    )}\n                  />\n                }\n              >\n                <InlineSwitch\n                  value={includePipelineOperations}\n                  showLabel={true}\n                  transparent={true}\n                  onChange={(e) => {\n                    reportInteraction('grafana_explore_logs_loki_log_context_pipeline_toggled', {\n                      logRowUid: row.uid,\n                      action: e.currentTarget.checked ? 'enable' : 'disable',\n                    });\n                    window.localStorage.setItem(SHOULD_INCLUDE_PIPELINE_OPERATIONS, e.currentTarget.checked.toString());\n                    setIncludePipelineOperations(e.currentTarget.checked);\n                    if (runContextQuery) {\n                      runContextQuery();\n                    }\n                  }}\n                />\n              </InlineField>\n            </InlineFieldRow>\n          )}\n        </div>\n      </Collapse>\n    </div>\n  );\n}\n","import { DataFrame, Field, FieldType } from '@grafana/data';\n\nexport enum SortDirection {\n  Ascending,\n  Descending,\n}\n\n// creates the `index` for the sorting.\n// this is needed by the `SortedVector`.\n// the index is an array of numbers, and it defines an order.\n// at every slot in the index the values is the position of\n// the sorted item.\n// for example, an index of [3,1,2] means that\n// in the dataframe, that has 3 rows, after sorting:\n// - the third row will become the first\n// - the first row will become the second\n// - the second row will become the third\nfunction makeIndex(field: Field<number>, dir: SortDirection): number[] {\n  const fieldValues: number[] = field.values;\n  const { nanos } = field;\n\n  // we first build an array which is [0,1,2,3....]\n  const index = Array(fieldValues.length);\n  for (let i = 0; i < index.length; i++) {\n    index[i] = i;\n  }\n\n  const isAsc = dir === SortDirection.Ascending;\n\n  index.sort((a: number, b: number): number => {\n    // we need to answer this question:\n    // in the field-used-for-sorting, how would we compare value-at-index-a to value-at-index-b?\n    const valA = fieldValues[a];\n    const valB = fieldValues[b];\n    if (valA < valB) {\n      return isAsc ? -1 : 1;\n    }\n\n    if (valA > valB) {\n      return isAsc ? 1 : -1;\n    }\n\n    // the millisecond timestamps are equal,\n    // compare the nanosecond part, if available\n\n    if (nanos === undefined) {\n      return 0;\n    }\n\n    const nanoA = nanos[a];\n    const nanoB = nanos[b];\n\n    if (nanoA < nanoB) {\n      return isAsc ? -1 : 1;\n    }\n\n    if (nanoA > nanoB) {\n      return isAsc ? 1 : -1;\n    }\n\n    return 0;\n  });\n\n  return index;\n}\n\n// sort a dataframe that is in the Loki dataframe format ascending or desceding based on time,\n// with nanosecond precision.\nexport function sortDataFrameByTime(frame: DataFrame, dir: SortDirection): DataFrame {\n  const { fields, ...rest } = frame;\n\n  // we use the approach used in @grafana/data/sortDataframe.\n  // we cannot use it directly, because it does not take `.nanos` into account\n  // (see https://github.com/grafana/grafana/issues/72351).\n  // we can switch to to @grafana/data/sortDataframe when the issue is fixed.\n\n  const timeField = fields.find((field) => field.type === FieldType.time);\n  if (timeField === undefined) {\n    throw new Error('missing timestamp field. should never happen');\n  }\n\n  const index = makeIndex(timeField, dir);\n\n  return {\n    ...rest,\n    fields: fields.map((field) => ({\n      ...field,\n      values: sorted(field.values, index),\n      nanos: field.nanos === undefined ? undefined : sorted(field.nanos, index),\n    })),\n  };\n}\n\nfunction sorted<T>(vals: T[], index: number[]): T[] {\n  return vals.map((_, idx) => vals[index[idx]]);\n}\n","import { isEmpty } from 'lodash';\nimport { catchError, lastValueFrom, of, switchMap } from 'rxjs';\n\nimport {\n  CoreApp,\n  DataFrame,\n  DataQueryError,\n  DataQueryResponse,\n  FieldCache,\n  FieldType,\n  LogRowModel,\n  TimeRange,\n  toUtc,\n  LogRowContextQueryDirection,\n  LogRowContextOptions,\n  dateTime,\n} from '@grafana/data';\nimport { LabelParser, LabelFilter, LineFilters, PipelineStage, Logfmt, Json } from '@grafana/lezer-logql';\n\nimport { LokiContextUi } from './components/LokiContextUi';\nimport { LokiDatasource, makeRequest, REF_ID_STARTER_LOG_ROW_CONTEXT } from './datasource';\nimport { escapeLabelValueInExactSelector, getLabelTypeFromFrame } from './languageUtils';\nimport { addLabelToQuery, addParserToQuery } from './modifyQuery';\nimport {\n  getNodePositionsFromQuery,\n  getParserFromQuery,\n  getStreamSelectorsFromQuery,\n  isQueryWithParser,\n} from './queryUtils';\nimport { sortDataFrameByTime, SortDirection } from './sortDataFrame';\nimport { ContextFilter, LabelType, LokiQuery, LokiQueryDirection, LokiQueryType } from './types';\n\nexport const LOKI_LOG_CONTEXT_PRESERVED_LABELS = 'lokiLogContextPreservedLabels';\nexport const SHOULD_INCLUDE_PIPELINE_OPERATIONS = 'lokiLogContextShouldIncludePipelineOperations';\n\nexport type PreservedLabels = {\n  removedLabels: string[];\n  selectedExtractedLabels: string[];\n};\n\nexport class LogContextProvider {\n  datasource: LokiDatasource;\n  cachedContextFilters: ContextFilter[];\n  onContextClose: (() => void) | undefined;\n\n  constructor(datasource: LokiDatasource) {\n    this.datasource = datasource;\n    this.cachedContextFilters = [];\n  }\n\n  private async getQueryAndRange(\n    row: LogRowModel,\n    options?: LogRowContextOptions,\n    origQuery?: LokiQuery,\n    cacheFilters = true\n  ) {\n    const direction = (options && options.direction) || LogRowContextQueryDirection.Backward;\n    const limit = (options && options.limit) || this.datasource.maxLines;\n    // If the user doesn't have any filters applied already, or if we don't want\n    // to use the cached filters, we need to reinitialize them.\n    if (this.cachedContextFilters.length === 0 || !cacheFilters) {\n      const filters = (\n        await this.getInitContextFilters(row, origQuery, {\n          from: dateTime(row.timeEpochMs),\n          to: dateTime(row.timeEpochMs),\n          raw: { from: dateTime(row.timeEpochMs), to: dateTime(row.timeEpochMs) },\n        })\n      ).contextFilters.filter((filter) => filter.enabled);\n\n      this.cachedContextFilters = filters;\n    }\n\n    return await this.prepareLogRowContextQueryTarget(row, limit, direction, origQuery);\n  }\n\n  getLogRowContextQuery = async (\n    row: LogRowModel,\n    options?: LogRowContextOptions,\n    origQuery?: LokiQuery,\n    cacheFilters = true\n  ): Promise<LokiQuery> => {\n    const { query } = await this.getQueryAndRange(row, options, origQuery, cacheFilters);\n\n    if (!cacheFilters) {\n      // If the caller doesn't want to cache the filters, we need to reset them.\n      this.cachedContextFilters = [];\n    }\n\n    return query;\n  };\n\n  getLogRowContext = async (\n    row: LogRowModel,\n    options?: LogRowContextOptions,\n    origQuery?: LokiQuery\n  ): Promise<{ data: DataFrame[] }> => {\n    const direction = (options && options.direction) || LogRowContextQueryDirection.Backward;\n    const { query, range } = await this.getQueryAndRange(row, options, origQuery);\n\n    const processResults = (result: DataQueryResponse): DataQueryResponse => {\n      const frames: DataFrame[] = result.data;\n      const processedFrames = frames.map((frame) => sortDataFrameByTime(frame, SortDirection.Descending));\n\n      return {\n        ...result,\n        data: processedFrames,\n      };\n    };\n\n    // this can only be called from explore currently\n    const app = CoreApp.Explore;\n\n    return lastValueFrom(\n      this.datasource.query(makeRequest(query, range, app, `${REF_ID_STARTER_LOG_ROW_CONTEXT}${direction}`)).pipe(\n        catchError((err) => {\n          const error: DataQueryError = {\n            message: 'Error during context query. Please check JS console logs.',\n            status: err.status,\n            statusText: err.statusText,\n          };\n          throw error;\n        }),\n        switchMap((res) => of(processResults(res)))\n      )\n    );\n  };\n\n  async prepareLogRowContextQueryTarget(\n    row: LogRowModel,\n    limit: number,\n    direction: LogRowContextQueryDirection,\n    origQuery?: LokiQuery\n  ): Promise<{ query: LokiQuery; range: TimeRange }> {\n    const expr = this.prepareExpression(this.cachedContextFilters, origQuery);\n\n    const contextTimeBuffer = 2 * 60 * 60 * 1000; // 2h buffer\n\n    const queryDirection =\n      direction === LogRowContextQueryDirection.Forward ? LokiQueryDirection.Forward : LokiQueryDirection.Backward;\n\n    const query: LokiQuery = {\n      expr,\n      queryType: LokiQueryType.Range,\n      // refId has to be:\n      // - always different (temporarily, will be fixed later)\n      // - not increase in size\n      // because it may be called many times from logs-context\n      refId: `${REF_ID_STARTER_LOG_ROW_CONTEXT}_${Math.random().toString()}`,\n      maxLines: limit,\n      direction: queryDirection,\n      datasource: { uid: this.datasource.uid, type: this.datasource.type },\n    };\n\n    const fieldCache = new FieldCache(row.dataFrame);\n    const tsField = fieldCache.getFirstFieldOfType(FieldType.time);\n    if (tsField === undefined) {\n      throw new Error('loki: data frame missing time-field, should never happen');\n    }\n    const tsValue = tsField.values[row.rowIndex];\n    const timestamp = toUtc(tsValue);\n\n    const range =\n      queryDirection === LokiQueryDirection.Forward\n        ? {\n            // start param in Loki API is inclusive so we'll have to filter out the row that this request is based from\n            // and any other that were logged in the same ns but before the row. Right now these rows will be lost\n            // because the are before but came it he response that should return only rows after.\n            from: timestamp,\n            // convert to ns, we lose some precision here but it is not that important at the far points of the context\n            to: toUtc(row.timeEpochMs + contextTimeBuffer),\n          }\n        : {\n            // convert to ns, we lose some precision here but it is not that important at the far points of the context\n            from: toUtc(row.timeEpochMs - contextTimeBuffer),\n            to: timestamp,\n          };\n\n    return {\n      query,\n      range: {\n        from: range.from,\n        to: range.to,\n        raw: range,\n      },\n    };\n  }\n\n  getLogRowContextUi(row: LogRowModel, runContextQuery?: () => void, origQuery?: LokiQuery): React.ReactNode {\n    const updateFilter = (contextFilters: ContextFilter[]) => {\n      this.cachedContextFilters = contextFilters;\n\n      if (runContextQuery) {\n        runContextQuery();\n      }\n    };\n\n    // we need to cache this function so that it doesn't get recreated on every render\n    this.onContextClose =\n      this.onContextClose ??\n      (() => {\n        this.cachedContextFilters = [];\n      });\n\n    return LokiContextUi({\n      row,\n      origQuery,\n      updateFilter,\n      onClose: this.onContextClose,\n      logContextProvider: this,\n      runContextQuery,\n    });\n  }\n\n  prepareExpression(contextFilters: ContextFilter[], query: LokiQuery | undefined): string {\n    let preparedExpression = this.processContextFiltersToExpr(contextFilters, query);\n    if (window.localStorage.getItem(SHOULD_INCLUDE_PIPELINE_OPERATIONS) === 'true') {\n      preparedExpression = this.processPipelineStagesToExpr(preparedExpression, query);\n    }\n    return preparedExpression;\n  }\n\n  processContextFiltersToExpr = (contextFilters: ContextFilter[], query: LokiQuery | undefined): string => {\n    const labelFilters = contextFilters\n      .map((filter) => {\n        if (!filter.nonIndexed && filter.enabled) {\n          // escape backslashes in label as users can't escape them by themselves\n          return `${filter.label}=\"${escapeLabelValueInExactSelector(filter.value)}\"`;\n        }\n        return '';\n      })\n      // Filter empty strings\n      .filter((label) => !!label)\n      .join(',');\n\n    let expr = `{${labelFilters}}`;\n\n    // We need to have original query to get parser and include parsed labels\n    // We only add parser and parsed labels if there is only one parser in query\n    if (query) {\n      let hasParser = false;\n      if (isQueryWithParser(query.expr).parserCount === 1) {\n        hasParser = true;\n        const parser = getParserFromQuery(query.expr);\n        if (parser) {\n          expr = addParserToQuery(expr, parser);\n        }\n      }\n\n      const nonIndexedLabels = contextFilters.filter((filter) => filter.nonIndexed && filter.enabled);\n      for (const parsedLabel of nonIndexedLabels) {\n        if (parsedLabel.enabled) {\n          expr = addLabelToQuery(\n            expr,\n            parsedLabel.label,\n            '=',\n            parsedLabel.value,\n            hasParser ? LabelType.Parsed : LabelType.StructuredMetadata\n          );\n        }\n      }\n    }\n\n    return expr;\n  };\n\n  processPipelineStagesToExpr = (currentExpr: string, query: LokiQuery | undefined): string => {\n    let newExpr = currentExpr;\n    const origExpr = query?.expr ?? '';\n\n    if (isQueryWithParser(origExpr).parserCount > 1) {\n      return newExpr;\n    }\n\n    const allNodePositions = getNodePositionsFromQuery(origExpr, [\n      PipelineStage,\n      LabelParser,\n      Logfmt,\n      Json,\n      LineFilters,\n      LabelFilter,\n    ]);\n    const pipelineStagePositions = allNodePositions.filter((position) => position.type?.id === PipelineStage);\n    const otherNodePositions = allNodePositions.filter((position) => position.type?.id !== PipelineStage);\n\n    for (const pipelineStagePosition of pipelineStagePositions) {\n      // we don't process pipeline stages that contain label parsers, line filters or label filters\n      if (otherNodePositions.some((position) => pipelineStagePosition.contains(position))) {\n        continue;\n      }\n\n      newExpr += ` ${pipelineStagePosition.getExpression(origExpr)}`;\n    }\n\n    return newExpr;\n  };\n\n  queryContainsValidPipelineStages = (query: LokiQuery | undefined): boolean => {\n    const origExpr = query?.expr ?? '';\n    const allNodePositions = getNodePositionsFromQuery(origExpr, [\n      PipelineStage,\n      LabelParser,\n      LineFilters,\n      LabelFilter,\n    ]);\n    const pipelineStagePositions = allNodePositions.filter((position) => position.type?.id === PipelineStage);\n    const otherNodePositions = allNodePositions.filter((position) => position.type?.id !== PipelineStage);\n\n    return pipelineStagePositions.some((pipelineStagePosition) =>\n      otherNodePositions.every((position) => pipelineStagePosition.contains(position) === false)\n    );\n  };\n\n  getInitContextFilters = async (\n    row: LogRowModel,\n    query?: LokiQuery,\n    timeRange?: TimeRange\n  ): Promise<{ contextFilters: ContextFilter[]; preservedFiltersApplied: boolean }> => {\n    let preservedFiltersApplied = false;\n    if (!query || isEmpty(row.labels)) {\n      return { contextFilters: [], preservedFiltersApplied };\n    }\n    const rowLabels = row.labels;\n\n    // 1. First we need to get all labels from the log row's label\n    // and correctly set parsed and not parsed labels\n    let allLabels: string[] = [];\n    if (!isQueryWithParser(query.expr).queryWithParser) {\n      // If there is no parser, we use getLabelKeys because it has better caching\n      // and all labels should already be fetched\n      await this.datasource.languageProvider.start(timeRange);\n      allLabels = this.datasource.languageProvider.getLabelKeys();\n    } else {\n      // If we have parser, we use fetchLabels to fetch actual labels for selected stream\n      const stream = getStreamSelectorsFromQuery(query.expr);\n      // We are using stream[0] as log query can always have just 1 stream selector\n      allLabels = await this.datasource.languageProvider.fetchLabels({ streamSelector: stream[0], timeRange });\n    }\n\n    const contextFilters: ContextFilter[] = [];\n    Object.entries(rowLabels).forEach(([label, value]) => {\n      const labelType = getLabelTypeFromFrame(label, row.dataFrame, row.rowIndex);\n      const filter: ContextFilter = {\n        label,\n        value: value,\n        enabled: allLabels.includes(label),\n        nonIndexed: labelType !== null && labelType !== LabelType.Indexed,\n      };\n\n      contextFilters.push(filter);\n    });\n\n    // Secondly we check for preserved labels and update enabled state of filters based on that\n    let preservedLabels: undefined | PreservedLabels = undefined;\n    const preservedLabelsString = window.localStorage.getItem(LOKI_LOG_CONTEXT_PRESERVED_LABELS);\n    if (preservedLabelsString) {\n      try {\n        preservedLabels = JSON.parse(preservedLabelsString);\n        // Do nothing when error occurs\n      } catch (e) {}\n    }\n\n    if (!preservedLabels) {\n      // If we don't have preservedLabels, we return contextFilters as they are\n      return { contextFilters, preservedFiltersApplied };\n    } else {\n      // Otherwise, we need to update filters based on preserved labels\n      let arePreservedLabelsUsed = false;\n      const newContextFilters = contextFilters.map((contextFilter) => {\n        // We checked for undefined above\n        if (preservedLabels!.removedLabels.includes(contextFilter.label)) {\n          arePreservedLabelsUsed = true;\n          return { ...contextFilter, enabled: false };\n        }\n        // We checked for undefined above\n        if (preservedLabels!.selectedExtractedLabels.includes(contextFilter.label)) {\n          arePreservedLabelsUsed = true;\n          return { ...contextFilter, enabled: true };\n        }\n        return { ...contextFilter };\n      });\n\n      const isAtLeastOneRealLabelEnabled = newContextFilters.some(({ enabled, nonIndexed }) => enabled && !nonIndexed);\n      if (!isAtLeastOneRealLabelEnabled) {\n        // If we end up with no real labels enabled, we need to reset the init filters\n        return { contextFilters, preservedFiltersApplied };\n      } else {\n        if (arePreservedLabelsUsed) {\n          preservedFiltersApplied = true;\n        }\n        return { contextFilters: newContextFilters, preservedFiltersApplied };\n      }\n    }\n  };\n}\n","import { LokiVariableQuery, LokiVariableQueryType } from '../types';\n\nexport const labelNamesRegex = /^label_names\\(\\)\\s*$/;\nexport const labelValuesRegex = /^label_values\\((?:(.+),\\s*)?([a-zA-Z_$][a-zA-Z0-9_]*)\\)\\s*$/;\n\nexport function migrateVariableQuery(rawQuery: string | LokiVariableQuery): LokiVariableQuery {\n  // If not string, we assume LokiVariableQuery\n  if (typeof rawQuery !== 'string') {\n    return rawQuery;\n  }\n\n  const queryBase = {\n    refId: 'LokiVariableQueryEditor-VariableQuery',\n    type: LokiVariableQueryType.LabelNames,\n  };\n\n  const labelNames = rawQuery.match(labelNamesRegex);\n  if (labelNames) {\n    return {\n      ...queryBase,\n      type: LokiVariableQueryType.LabelNames,\n    };\n  }\n\n  const labelValues = rawQuery.match(labelValuesRegex);\n  if (labelValues) {\n    return {\n      ...queryBase,\n      type: LokiVariableQueryType.LabelValues,\n      label: labelValues[2] ? labelValues[2] : labelValues[1],\n      stream: labelValues[2] ? labelValues[1] : undefined,\n    };\n  }\n\n  return queryBase;\n}\n","import { FormEvent, useState, useEffect } from 'react';\nimport { usePrevious } from 'react-use';\n\nimport { QueryEditorProps, SelectableValue } from '@grafana/data';\nimport { InlineField, InlineFieldRow, Input, Select } from '@grafana/ui';\n\nimport { LokiDatasource } from '../datasource';\nimport { migrateVariableQuery } from '../migrations/variableQueryMigrations';\nimport { LokiOptions, LokiQuery, LokiVariableQuery, LokiVariableQueryType as QueryType } from '../types';\n\nconst variableOptions = [\n  { label: 'Label names', value: QueryType.LabelNames },\n  { label: 'Label values', value: QueryType.LabelValues },\n];\n\nexport type Props = QueryEditorProps<LokiDatasource, LokiQuery, LokiOptions, LokiVariableQuery>;\n\nconst refId = 'LokiVariableQueryEditor-VariableQuery';\n\nexport const LokiVariableQueryEditor = ({ onChange, query, datasource, range }: Props) => {\n  const [type, setType] = useState<number | undefined>(undefined);\n  const [label, setLabel] = useState('');\n  const [labelOptions, setLabelOptions] = useState<Array<SelectableValue<string>>>([]);\n  const [stream, setStream] = useState('');\n  const previousType = usePrevious(type);\n\n  useEffect(() => {\n    if (!query) {\n      return;\n    }\n\n    const variableQuery = typeof query === 'string' ? migrateVariableQuery(query) : query;\n    setType(variableQuery.type);\n    setLabel(variableQuery.label || '');\n    setStream(variableQuery.stream || '');\n  }, [query]);\n\n  useEffect(() => {\n    // Fetch label names when the query type is LabelValues, and the previous type was not the same\n    if (type !== QueryType.LabelValues || previousType === type) {\n      return;\n    }\n\n    datasource.languageProvider.fetchLabels({ timeRange: range }).then((labelNames) => {\n      setLabelOptions(labelNames.map((labelName) => ({ label: labelName, value: labelName })));\n    });\n  }, [datasource, type, range, previousType]);\n\n  const onQueryTypeChange = (newType: SelectableValue<QueryType>) => {\n    setType(newType.value);\n    if (newType.value !== undefined) {\n      onChange({\n        type: newType.value,\n        label,\n        stream,\n        refId,\n      });\n    }\n  };\n\n  const onLabelChange = (newLabel: SelectableValue<string>) => {\n    setLabel(newLabel.value || '');\n  };\n\n  const onStreamChange = (e: FormEvent<HTMLInputElement>) => {\n    setStream(e.currentTarget.value);\n  };\n\n  const handleBlur = () => {\n    if (type !== undefined) {\n      onChange({ type, label, stream, refId: 'LokiVariableQueryEditor-VariableQuery' });\n    }\n  };\n\n  return (\n    <>\n      <InlineFieldRow>\n        <InlineField label=\"Query type\" labelWidth={20}>\n          <Select\n            aria-label=\"Query type\"\n            onChange={onQueryTypeChange}\n            onBlur={handleBlur}\n            value={type}\n            options={variableOptions}\n            width={16}\n          />\n        </InlineField>\n        {type === QueryType.LabelValues && (\n          <>\n            <InlineField label=\"Label\" labelWidth={20}>\n              <Select\n                aria-label=\"Label\"\n                onChange={onLabelChange}\n                onBlur={handleBlur}\n                value={{ label: label, value: label }}\n                options={labelOptions}\n                width={16}\n                allowCustomValue\n              />\n            </InlineField>\n          </>\n        )}\n      </InlineFieldRow>\n      {type === QueryType.LabelValues && (\n        <InlineFieldRow>\n          <InlineField\n            label=\"Stream selector\"\n            labelWidth={20}\n            grow={true}\n            tooltip={\n              <div>\n                {\n                  'Optional. If defined, a list of values for the specified log stream selector is returned. For example: {label=\"value\"} or {label=\"$variable\"}'\n                }\n              </div>\n            }\n          >\n            <Input\n              type=\"text\"\n              aria-label=\"Stream selector\"\n              placeholder=\"Optional stream selector\"\n              value={stream}\n              onChange={onStreamChange}\n              onBlur={handleBlur}\n            />\n          </InlineField>\n        </InlineFieldRow>\n      )}\n    </>\n  );\n};\n","import { from, Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\n\nimport { CustomVariableSupport, DataQueryRequest, MetricFindValue, ScopedVars, TimeRange } from '@grafana/data';\n\nimport { LokiVariableQueryEditor } from './components/VariableQueryEditor';\nimport { LokiDatasource } from './datasource';\nimport { LokiVariableQuery } from './types';\n\nexport class LokiVariableSupport extends CustomVariableSupport<LokiDatasource, LokiVariableQuery> {\n  editor = LokiVariableQueryEditor;\n\n  constructor(private datasource: LokiDatasource) {\n    super();\n  }\n\n  async execute(query: LokiVariableQuery, scopedVars: ScopedVars, range: TimeRange) {\n    return this.datasource.metricFindQuery(query, { scopedVars, range });\n  }\n\n  query(request: DataQueryRequest<LokiVariableQuery>): Observable<{ data: MetricFindValue[] }> {\n    const result = this.execute(request.targets[0], request.scopedVars, request.range);\n\n    return from(result).pipe(map((data) => ({ data })));\n  }\n}\n","import { groupBy } from 'lodash';\n\nimport { FieldType, DataFrame, DataLink, Field } from '@grafana/data';\nimport { getDataSourceSrv } from '@grafana/runtime';\n\nimport { DerivedFieldConfig } from './types';\n\nexport function getDerivedFields(dataFrame: DataFrame, derivedFieldConfigs: DerivedFieldConfig[]): Field[] {\n  if (!derivedFieldConfigs.length) {\n    return [];\n  }\n  const derivedFieldsGrouped = groupBy(derivedFieldConfigs, 'name');\n\n  const newFields = Object.values(derivedFieldsGrouped).map(fieldFromDerivedFieldConfig);\n\n  // line-field is the first string-field\n  // NOTE: we should create some common log-frame-extra-string-field code somewhere\n  const lineField = dataFrame.fields.find((f) => f.type === FieldType.string);\n\n  if (lineField === undefined) {\n    // if this is happening, something went wrong, let's raise an error\n    throw new Error('invalid logs-dataframe, string-field missing');\n  }\n\n  const labelFields = dataFrame.fields.find((f) => f.type === FieldType.other && f.name === 'labels');\n\n  for (let i = 0; i < lineField.values.length; i++) {\n    for (const field of newFields) {\n      // `matcherRegex` can be either a RegExp that is used to extract the value from the log line, or it can be a label key to derive the field from the labels\n      if (derivedFieldsGrouped[field.name][0].matcherType === 'label' && labelFields) {\n        const label = labelFields.values[i];\n        if (label) {\n          // Find the key that matches both, the `matcherRegex` and the label key\n          const intersectingKey = Object.keys(label).find(\n            (key) => derivedFieldsGrouped[field.name][0].matcherRegex === key\n          );\n\n          if (intersectingKey) {\n            field.values.push(label[intersectingKey]);\n            continue;\n          }\n        }\n        field.values.push(null);\n      } else if (\n        derivedFieldsGrouped[field.name][0].matcherType === 'regex' ||\n        derivedFieldsGrouped[field.name][0].matcherType === undefined\n      ) {\n        // `matcherRegex` will actually be used as a RegExp here\n        const line = lineField.values[i];\n        const logMatch = line.match(derivedFieldsGrouped[field.name][0].matcherRegex);\n\n        if (logMatch && logMatch[1]) {\n          field.values.push(logMatch[1]);\n          continue;\n        }\n\n        field.values.push(null);\n      } else {\n        field.values.push(null);\n      }\n    }\n  }\n\n  return newFields;\n}\n\n/**\n * Transform derivedField config into dataframe field with config that contains link.\n */\nfunction fieldFromDerivedFieldConfig(derivedFieldConfigs: DerivedFieldConfig[]): Field {\n  const dataSourceSrv = getDataSourceSrv();\n\n  const dataLinks = derivedFieldConfigs.reduce<DataLink[]>((acc, derivedFieldConfig) => {\n    // Having field.datasourceUid means it is an internal link.\n    if (derivedFieldConfig.datasourceUid) {\n      const dsSettings = dataSourceSrv.getInstanceSettings(derivedFieldConfig.datasourceUid);\n      const queryType = (type: string | undefined): string | undefined => {\n        switch (type) {\n          case 'tempo':\n            return 'traceql';\n          case 'grafana-x-ray-datasource':\n            return 'getTrace';\n          default:\n            return undefined;\n        }\n      };\n\n      acc.push({\n        // Will be filled out later\n        title: derivedFieldConfig.urlDisplayLabel || '',\n        url: '',\n        // This is hardcoded for Jaeger or Zipkin not way right now to specify datasource specific query object\n        internal: {\n          query: { query: derivedFieldConfig.url, queryType: queryType(dsSettings?.type) },\n          datasourceUid: derivedFieldConfig.datasourceUid,\n          datasourceName: dsSettings?.name ?? 'Data source not found',\n        },\n      });\n    } else if (derivedFieldConfig.url) {\n      acc.push({\n        // We do not know what title to give here so we count on presentation layer to create a title from metadata.\n        title: derivedFieldConfig.urlDisplayLabel || '',\n        // This is hardcoded for Jaeger or Zipkin not way right now to specify datasource specific query object\n        url: derivedFieldConfig.url,\n      });\n    }\n    return acc;\n  }, []);\n\n  return {\n    name: derivedFieldConfigs[0].name,\n    type: FieldType.string,\n    config: {\n      links: dataLinks,\n    },\n    // We are adding values later on\n    values: [],\n  };\n}\n","import { groupBy } from 'lodash';\n\nimport { DataFrame, Field, FieldType } from '@grafana/data';\n\nexport function makeTableFrames(instantMetricFrames: DataFrame[]): DataFrame[] {\n  // first we remove frames that have no refId\n  // (we will group them by refId, so we need it to be set)\n  const framesWithRefId = instantMetricFrames.filter((f) => f.refId !== undefined);\n\n  const framesByRefId = groupBy(framesWithRefId, (frame) => frame.refId);\n\n  return Object.entries(framesByRefId).map(([refId, frames]) => makeTableFrame(frames, refId));\n}\n\ntype NumberField = Field<number>;\ntype StringField = Field<string>;\n\nfunction makeTableFrame(instantMetricFrames: DataFrame[], refId: string): DataFrame {\n  const tableTimeField: NumberField = { name: 'Time', config: {}, values: [], type: FieldType.time };\n  const tableValueField: NumberField = {\n    name: `Value #${refId}`,\n    config: {},\n    values: [],\n    type: FieldType.number,\n  };\n\n  // Sort metric labels, create columns for them and record their index\n  const allLabelNames = new Set(\n    instantMetricFrames.map((frame) => frame.fields.map((field) => Object.keys(field.labels ?? {})).flat()).flat()\n  );\n\n  const sortedLabelNames = Array.from(allLabelNames).sort();\n\n  const labelFields: StringField[] = sortedLabelNames.map((labelName) => ({\n    name: labelName,\n    config: { filterable: true },\n    values: [],\n    type: FieldType.string,\n  }));\n\n  instantMetricFrames.forEach((frame) => {\n    const timeField = frame.fields.find((field) => field.type === FieldType.time);\n    const valueField = frame.fields.find((field) => field.type === FieldType.number);\n    if (timeField == null || valueField == null) {\n      return;\n    }\n\n    const timeArray = timeField.values;\n    const valueArray = valueField.values;\n\n    for (let x of timeArray) {\n      tableTimeField.values.push(x);\n    }\n\n    for (let x of valueArray) {\n      tableValueField.values.push(x);\n    }\n\n    const labels = valueField.labels ?? {};\n\n    for (let f of labelFields) {\n      const text = labels[f.name] ?? '';\n      // we insert the labels as many times as we have values\n      for (let i = 0; i < valueArray.length; i++) {\n        f.values.push(text);\n      }\n    }\n  });\n\n  return {\n    fields: [tableTimeField, ...labelFields, tableValueField],\n    refId,\n    meta: { preferredVisualisationType: 'table' },\n    length: tableTimeField.values.length,\n  };\n}\n","import { DataQueryResponse, DataFrame, isDataFrame, FieldType, QueryResultMeta, DataQueryError } from '@grafana/data';\n\nimport { getDerivedFields } from './getDerivedFields';\nimport { makeTableFrames } from './makeTableFrames';\nimport { getHighlighterExpressionsFromQuery } from './queryUtils';\nimport { dataFrameHasLokiError } from './responseUtils';\nimport { DerivedFieldConfig, LokiQuery, LokiQueryType } from './types';\n\nfunction isMetricFrame(frame: DataFrame): boolean {\n  return frame.fields.every((field) => field.type === FieldType.time || field.type === FieldType.number);\n}\n\n// returns a new frame, with meta shallow merged with its original meta\nfunction setFrameMeta(frame: DataFrame, meta: QueryResultMeta): DataFrame {\n  const { meta: oldMeta, ...rest } = frame;\n  // meta maybe be undefined, we need to handle that\n  const newMeta = { ...oldMeta, ...meta };\n  return {\n    ...rest,\n    meta: newMeta,\n  };\n}\n\nfunction processStreamFrame(\n  frame: DataFrame,\n  query: LokiQuery | undefined,\n  derivedFieldConfigs: DerivedFieldConfig[]\n): DataFrame {\n  const custom: Record<string, string> = {\n    ...frame.meta?.custom, // keep the original meta.custom\n    // used by logsModel\n    lokiQueryStatKey: 'Summary: total bytes processed',\n  };\n\n  if (dataFrameHasLokiError(frame)) {\n    custom.error = 'Error when parsing some of the logs';\n  }\n\n  const meta: QueryResultMeta = {\n    preferredVisualisationType: 'logs',\n    limit: query?.maxLines,\n    searchWords: query !== undefined ? getHighlighterExpressionsFromQuery(query.expr) : undefined,\n    custom,\n  };\n\n  const newFrame = setFrameMeta(frame, meta);\n  const derivedFields = getDerivedFields(newFrame, derivedFieldConfigs);\n  return {\n    ...newFrame,\n    fields: [...newFrame.fields, ...derivedFields],\n  };\n}\n\nfunction processStreamsFrames(\n  frames: DataFrame[],\n  queryMap: Map<string, LokiQuery>,\n  derivedFieldConfigs: DerivedFieldConfig[]\n): DataFrame[] {\n  return frames.map((frame) => {\n    const query = frame.refId !== undefined ? queryMap.get(frame.refId) : undefined;\n    return processStreamFrame(frame, query, derivedFieldConfigs);\n  });\n}\n\nfunction processMetricInstantFrames(frames: DataFrame[]): DataFrame[] {\n  return frames.length > 0 ? makeTableFrames(frames) : [];\n}\n\nfunction processMetricRangeFrames(frames: DataFrame[]): DataFrame[] {\n  const meta: QueryResultMeta = { preferredVisualisationType: 'graph' };\n  return frames.map((frame) => setFrameMeta(frame, meta));\n}\n\n// we split the frames into 3 groups, because we will handle\n// each group slightly differently\nfunction groupFrames(\n  frames: DataFrame[],\n  queryMap: Map<string, LokiQuery>\n): {\n  streamsFrames: DataFrame[];\n  metricInstantFrames: DataFrame[];\n  metricRangeFrames: DataFrame[];\n} {\n  const streamsFrames: DataFrame[] = [];\n  const metricInstantFrames: DataFrame[] = [];\n  const metricRangeFrames: DataFrame[] = [];\n\n  frames.forEach((frame) => {\n    if (!isMetricFrame(frame)) {\n      streamsFrames.push(frame);\n    } else {\n      const isInstantFrame = frame.refId != null && queryMap.get(frame.refId)?.queryType === LokiQueryType.Instant;\n      if (isInstantFrame) {\n        metricInstantFrames.push(frame);\n      } else {\n        metricRangeFrames.push(frame);\n      }\n    }\n  });\n\n  return { streamsFrames, metricInstantFrames, metricRangeFrames };\n}\n\nfunction improveError(error: DataQueryError | undefined, queryMap: Map<string, LokiQuery>): DataQueryError | undefined {\n  // many things are optional in an error-object, we need an error-message to exist,\n  // and we need to find the loki-query, based on the refId in the error-object.\n  if (error === undefined) {\n    return error;\n  }\n\n  const { refId, message } = error;\n  if (refId === undefined || message === undefined) {\n    return error;\n  }\n\n  const query = queryMap.get(refId);\n  if (query === undefined) {\n    return error;\n  }\n\n  if (message.includes('escape') && query.expr.includes('\\\\')) {\n    return {\n      ...error,\n      message: `${message}. Make sure that all special characters are escaped with \\\\. For more information on escaping of special characters visit LogQL documentation at https://grafana.com/docs/loki/latest/logql/.`,\n    };\n  }\n\n  return error;\n}\n\nexport function transformBackendResult(\n  response: DataQueryResponse,\n  queries: LokiQuery[],\n  derivedFieldConfigs: DerivedFieldConfig[]\n): DataQueryResponse {\n  const { data, error, ...rest } = response;\n\n  // in the typescript type, data is an array of basically anything.\n  // we do know that they have to be dataframes, so we make a quick check,\n  // this way we can be sure, and also typescript is happy.\n  const dataFrames = data.map((d) => {\n    if (!isDataFrame(d)) {\n      throw new Error('transformation only supports dataframe responses');\n    }\n    return d;\n  });\n\n  const queryMap = new Map(queries.map((query) => [query.refId, query]));\n\n  const { streamsFrames, metricInstantFrames, metricRangeFrames } = groupFrames(dataFrames, queryMap);\n\n  return {\n    ...rest,\n    error: improveError(error, queryMap),\n    data: [\n      ...processMetricRangeFrames(metricRangeFrames),\n      ...processMetricInstantFrames(metricInstantFrames),\n      ...processStreamsFrames(streamsFrames, queryMap, derivedFieldConfigs),\n    ],\n  };\n}\n","// Libraries\nimport { memo } from 'react';\n\nimport { AnnotationQuery } from '@grafana/data';\nimport { EditorField, EditorRow } from '@grafana/experimental';\nimport { Input, Stack } from '@grafana/ui';\n\n// Types\nimport { getNormalizedLokiQuery } from '../queryUtils';\nimport { LokiQuery, LokiQueryType } from '../types';\n\nimport { LokiOptionFields } from './LokiOptionFields';\nimport { LokiQueryField } from './LokiQueryField';\nimport { LokiQueryEditorProps } from './types';\n\ntype Props = LokiQueryEditorProps & {\n  annotation?: AnnotationQuery<LokiQuery>;\n  onAnnotationChange?: (annotation: AnnotationQuery<LokiQuery>) => void;\n};\n\nexport const LokiAnnotationsQueryEditor = memo(function LokiAnnotationQueryEditor(props: Props) {\n  const { annotation, onAnnotationChange, history } = props;\n\n  // this should never happen, but we want to keep typescript happy\n  if (annotation === undefined || onAnnotationChange === undefined) {\n    return null;\n  }\n\n  const onChangeQuery = (query: LokiQuery) => {\n    // the current version of annotations only stores an optional boolean\n    // field `instant` to handle the instant/range switch.\n    // we need to maintain compatibility for now, so we do the same.\n    // we explicitly call `getNormalizedLokiQuery` to make sure `queryType`\n    // is set up correctly.\n    const instant = getNormalizedLokiQuery(query).queryType === LokiQueryType.Instant;\n    onAnnotationChange({\n      ...annotation,\n      expr: query.expr,\n      maxLines: query.maxLines,\n      instant,\n    });\n  };\n\n  const queryWithRefId: LokiQuery = {\n    refId: '',\n    expr: annotation.expr,\n    maxLines: annotation.maxLines,\n    instant: annotation.instant,\n    queryType: annotation.queryType,\n  };\n  return (\n    <Stack gap={5} direction=\"column\">\n      <Stack gap={0} direction=\"column\">\n        <LokiQueryField\n          datasource={props.datasource}\n          query={queryWithRefId}\n          onChange={onChangeQuery}\n          onRunQuery={() => {}}\n          history={history}\n          ExtraFieldElement={\n            <LokiOptionFields\n              lineLimitValue={queryWithRefId?.maxLines?.toString() || ''}\n              resolution={queryWithRefId.resolution || 1}\n              query={queryWithRefId}\n              onRunQuery={() => {}}\n              onChange={onChangeQuery}\n            />\n          }\n        />\n      </Stack>\n      <EditorRow>\n        <EditorField\n          label=\"Title\"\n          tooltip={\n            'Use either the name or a pattern. For example, {{instance}} is replaced with label value for the label instance.'\n          }\n        >\n          <Input\n            type=\"text\"\n            placeholder=\"alertname\"\n            value={annotation.titleFormat}\n            onChange={(event) => {\n              onAnnotationChange({\n                ...annotation,\n                titleFormat: event.currentTarget.value,\n              });\n            }}\n          />\n        </EditorField>\n        <EditorField label=\"Tags\">\n          <Input\n            type=\"text\"\n            placeholder=\"label1,label2\"\n            value={annotation.tagKeys}\n            onChange={(event) => {\n              onAnnotationChange({\n                ...annotation,\n                tagKeys: event.currentTarget.value,\n              });\n            }}\n          />\n        </EditorField>\n        <EditorField\n          label=\"Text\"\n          tooltip={\n            'Use either the name or a pattern. For example, {{instance}} is replaced with label value for the label instance.'\n          }\n        >\n          <Input\n            type=\"text\"\n            placeholder=\"instance\"\n            value={annotation.textFormat}\n            onChange={(event) => {\n              onAnnotationChange({\n                ...annotation,\n                textFormat: event.currentTarget.value,\n              });\n            }}\n          />\n        </EditorField>\n      </EditorRow>\n    </Stack>\n  );\n});\n","import { DataFrame, QueryHint } from '@grafana/data';\n\nimport {\n  isQueryWithLabelFilter,\n  isQueryPipelineErrorFiltering,\n  isQueryWithLabelFormat,\n  isQueryWithParser,\n  isQueryWithLineFilter,\n} from './queryUtils';\nimport {\n  dataFrameHasLevelLabel,\n  extractHasErrorLabelFromDataFrame,\n  extractLevelLikeLabelFromDataFrame,\n  extractLogParserFromDataFrame,\n} from './responseUtils';\n\nexport function getQueryHints(query: string, series: DataFrame[]): QueryHint[] {\n  if (series.length === 0) {\n    return [];\n  }\n\n  const hints: QueryHint[] = [];\n  const { queryWithParser, parserCount } = isQueryWithParser(query);\n\n  if (!queryWithParser) {\n    const { hasLogfmt, hasJSON, hasPack } = extractLogParserFromDataFrame(series[0]);\n    if (hasJSON) {\n      if (hasPack) {\n        hints.push({\n          type: 'ADD_UNPACK_PARSER',\n          label: 'Selected log stream selector has packed logs.',\n          fix: {\n            title: 'add unpack parser',\n            label: 'Consider using unpack parser.',\n            action: {\n              type: 'ADD_UNPACK_PARSER',\n              query,\n            },\n          },\n        });\n      } else {\n        hints.push({\n          type: 'ADD_JSON_PARSER',\n          label: 'Selected log stream selector has JSON formatted logs.',\n          fix: {\n            title: 'add json parser',\n            label: 'Consider using JSON parser.',\n            action: {\n              type: 'ADD_JSON_PARSER',\n              query,\n            },\n          },\n        });\n      }\n    }\n\n    if (hasLogfmt) {\n      hints.push({\n        type: 'ADD_LOGFMT_PARSER',\n        label: 'Selected log stream selector has logfmt formatted logs.',\n        fix: {\n          title: 'add logfmt parser',\n          label: 'Consider using logfmt parser to turn key-value pairs in your log lines to labels.',\n          action: {\n            type: 'ADD_LOGFMT_PARSER',\n            query,\n          },\n        },\n      });\n    }\n  }\n\n  if (queryWithParser) {\n    // To keep this simple, we consider pipeline error filtering hint only is query has up to 1 parser\n    if (parserCount === 1) {\n      const hasPipelineErrorFiltering = isQueryPipelineErrorFiltering(query);\n      const hasError = extractHasErrorLabelFromDataFrame(series[0]);\n      if (hasError && !hasPipelineErrorFiltering) {\n        hints.push({\n          type: 'ADD_NO_PIPELINE_ERROR',\n          label: 'Some logs in your selected log streams have parsing error.',\n          fix: {\n            title: 'remove pipeline errors',\n            label: 'Consider filtering out logs with parsing errors.',\n            action: {\n              type: 'ADD_NO_PIPELINE_ERROR',\n              query,\n            },\n          },\n        });\n      }\n    }\n\n    const hasLabelFilter = isQueryWithLabelFilter(query);\n\n    if (!hasLabelFilter) {\n      hints.push({\n        type: 'ADD_LABEL_FILTER',\n        label: 'Consider filtering logs by their label and value.',\n        fix: {\n          title: 'add label filter',\n          label: '',\n          action: {\n            type: 'ADD_LABEL_FILTER',\n            query,\n          },\n        },\n      });\n    }\n  }\n\n  const queryWithLabelFormat = isQueryWithLabelFormat(query);\n  if (!queryWithLabelFormat) {\n    const hasLevel = dataFrameHasLevelLabel(series[0]);\n    const levelLikeLabel = extractLevelLikeLabelFromDataFrame(series[0]);\n\n    // Add hint only if we don't have \"level\" label and have level-like label\n    if (!hasLevel && levelLikeLabel) {\n      hints.push({\n        type: 'ADD_LEVEL_LABEL_FORMAT',\n        label: `Some logs in your selected log stream have \"${levelLikeLabel}\" label.`,\n        fix: {\n          title: 'add label level format',\n          label: `If ${levelLikeLabel} label has level values, consider using label_format to rename it to \"level\". Level label can be then visualized in log volumes.`,\n          action: {\n            type: 'ADD_LEVEL_LABEL_FORMAT',\n            query,\n            options: {\n              renameTo: 'level',\n              originalLabel: levelLikeLabel,\n            },\n          },\n        },\n      });\n    }\n  }\n\n  const hasLineFilter = isQueryWithLineFilter(query);\n\n  if (!hasLineFilter) {\n    hints.push({\n      type: 'ADD_LINE_FILTER',\n      label: 'Consider filtering logs for specific string.',\n      fix: {\n        title: 'add line filter',\n        label: '',\n        action: {\n          type: 'ADD_LINE_FILTER',\n          query,\n        },\n      },\n    });\n  }\n\n  return hints;\n}\n","// every timestamp in this file is a number which contains an unix-timestamp-in-millisecond format,\n// like returned by `new Date().getTime()`. this is needed because the \"math\"\n// has to be done on integer numbers.\n\n// the way loki handles logs-range-queries is that if you specify start & end,\n// one of those will be included, but the other will not. this allows us to\n// make it easy to split ranges.\n// for example, if the time-range is 100<>150,\n// we can split it into:\n// - 100<>120\n// - 120<>140\n// - 140<>150\n// and no log-line will be skipped or duplicated\n// (NOTE: we do these calculations in milliseconds. at the end, Loki receives\n// nanoseconds, but it will be OK, because it's simply a matter to adding `000000`,\n// to the end, so if we do it right in milliseconds, it should be OK in\n// nanoseconds too\n\nexport function splitTimeRange(\n  startTime: number,\n  endTime: number,\n  idealRangeDuration: number\n): Array<[number, number]> {\n  if (endTime - startTime <= idealRangeDuration) {\n    return [[startTime, endTime]];\n  }\n\n  const result: Array<[number, number]> = [];\n\n  // we walk backward, because we need want the potentially smaller \"last\" chunk\n  // to be at the oldest timestamp.\n  for (let chunkEndTime = endTime; chunkEndTime > startTime; chunkEndTime -= idealRangeDuration) {\n    // when we get close to the start of the time range, we need to be sure not\n    // to cross over the startTime\n    const chunkStartTime = Math.max(chunkEndTime - idealRangeDuration, startTime);\n    result.push([chunkStartTime, chunkEndTime]);\n  }\n\n  // because we walked backwards, we need to reverse the array\n  result.reverse();\n\n  return result;\n}\n","// every timestamp in this file is a number which contains an unix-timestamp-in-millisecond format,\n// like returned by `new Date().getTime()`. this is needed because the \"math\"\n// has to be done on integer numbers.\n\n// we are trying to be compatible with\n// https://github.com/grafana/loki/blob/089ec1b05f5ec15a8851d0e8230153e0eeb4dcec/pkg/querier/queryrange/split_by_interval.go#L327-L336\n\nexport function splitTimeRange(\n  startTime: number,\n  endTime: number,\n  step: number,\n  idealRangeDuration: number\n): Array<[number, number]> {\n  if (idealRangeDuration < step) {\n    // we cannot create chunks smaller than `step`\n    return [[startTime, endTime]];\n  }\n\n  // we make the duration a multiple of `step`, lowering it if necessary\n  const alignedDuration = Math.trunc(idealRangeDuration / step) * step;\n\n  const alignedStartTime = startTime - (startTime % step);\n\n  const result: Array<[number, number]> = [];\n\n  // in a previous version we started iterating from the end, to the start.\n  // However this is not easily possible as end timestamps are always inclusive\n  // for Loki. So a `2022-02-08T00:00:00Z` end time with a 1day step would mean\n  // to include the 08.02.2022, which we don't want. So we have to start from\n  // the start, always ending at the last step before the actual end, or the total end.\n  for (let chunkStartTime = alignedStartTime; chunkStartTime < endTime; chunkStartTime += alignedDuration) {\n    const chunkEndTime = Math.min(chunkStartTime + alignedDuration - step, endTime);\n    result.push([chunkStartTime, chunkEndTime]);\n  }\n\n  return result;\n}\n","import { groupBy, partition } from 'lodash';\nimport { Observable, Subscriber, Subscription, tap } from 'rxjs';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport {\n  arrayToDataFrame,\n  DataQueryRequest,\n  DataQueryResponse,\n  DataTopic,\n  dateTime,\n  durationToMilliseconds,\n  parseDuration,\n  rangeUtil,\n  TimeRange,\n  LoadingState,\n} from '@grafana/data';\nimport { combineResponses } from '@grafana/o11y-ds-frontend';\n\nimport { LokiDatasource } from './datasource';\nimport { splitTimeRange as splitLogsTimeRange } from './logsTimeSplitting';\nimport { splitTimeRange as splitMetricTimeRange } from './metricTimeSplitting';\nimport { isLogsQuery, isQueryWithRangeVariable } from './queryUtils';\nimport { trackGroupedQueries } from './tracking';\nimport { LokiGroupedRequest, LokiQuery, LokiQueryType } from './types';\n\nexport function partitionTimeRange(\n  isLogsQuery: boolean,\n  originalTimeRange: TimeRange,\n  stepMs: number,\n  duration: number\n): TimeRange[] {\n  const start = originalTimeRange.from.toDate().getTime();\n  const end = originalTimeRange.to.toDate().getTime();\n\n  const ranges = isLogsQuery\n    ? splitLogsTimeRange(start, end, duration)\n    : splitMetricTimeRange(start, end, stepMs, duration);\n\n  return ranges.map(([start, end]) => {\n    const from = dateTime(start);\n    const to = dateTime(end);\n    return {\n      from,\n      to,\n      raw: { from, to },\n    };\n  });\n}\n\n/**\n * Based in the state of the current response, if any, adjust target parameters such as `maxLines`.\n * For `maxLines`, we will update it as `maxLines - current amount of lines`.\n * At the end, we will filter the targets that don't need to be executed in the next request batch,\n * becasue, for example, the `maxLines` have been reached.\n */\nfunction adjustTargetsFromResponseState(targets: LokiQuery[], response: DataQueryResponse | null): LokiQuery[] {\n  if (!response) {\n    return targets;\n  }\n\n  return targets\n    .map((target) => {\n      if (!target.maxLines || !isLogsQuery(target.expr)) {\n        return target;\n      }\n      const targetFrame = response.data.find((frame) => frame.refId === target.refId);\n      if (!targetFrame) {\n        return target;\n      }\n      const updatedMaxLines = target.maxLines - targetFrame.length;\n      return {\n        ...target,\n        maxLines: updatedMaxLines < 0 ? 0 : updatedMaxLines,\n      };\n    })\n    .filter((target) => target.maxLines === undefined || target.maxLines > 0);\n}\nexport function runSplitGroupedQueries(datasource: LokiDatasource, requests: LokiGroupedRequest[]) {\n  const responseKey = requests.length ? requests[0].request.queryGroupId : uuidv4();\n  let mergedResponse: DataQueryResponse = { data: [], state: LoadingState.Streaming, key: responseKey };\n  const totalRequests = Math.max(...requests.map(({ partition }) => partition.length));\n  const longestPartition = requests.filter(({ partition }) => partition.length === totalRequests)[0].partition;\n\n  let shouldStop = false;\n  let subquerySubsciption: Subscription | null = null;\n  const runNextRequest = (subscriber: Subscriber<DataQueryResponse>, requestN: number, requestGroup: number) => {\n    if (shouldStop) {\n      subscriber.complete();\n      return;\n    }\n\n    const done = () => {\n      mergedResponse.state = LoadingState.Done;\n      subscriber.next(mergedResponse);\n      subscriber.complete();\n    };\n\n    const nextRequest = () => {\n      const { nextRequestN, nextRequestGroup } = getNextRequestPointers(requests, requestGroup, requestN);\n      if (nextRequestN > 0 && nextRequestGroup >= 0) {\n        runNextRequest(subscriber, nextRequestN, nextRequestGroup);\n        return;\n      }\n      done();\n    };\n\n    const group = requests[requestGroup];\n    const range = group.partition[requestN - 1];\n    const targets = adjustTargetsFromResponseState(group.request.targets, mergedResponse);\n\n    if (!targets.length) {\n      nextRequest();\n      return;\n    }\n\n    const subRequest = { ...requests[requestGroup].request, range, targets };\n    // request may not have a request id\n    if (group.request.requestId) {\n      subRequest.requestId = `${group.request.requestId}_${requestN}`;\n    }\n\n    subquerySubsciption = datasource.runQuery(subRequest).subscribe({\n      next: (partialResponse) => {\n        mergedResponse = combineResponses(mergedResponse, partialResponse);\n        mergedResponse = updateLoadingFrame(mergedResponse, subRequest, longestPartition, requestN);\n        if ((mergedResponse.errors ?? []).length > 0 || mergedResponse.error != null) {\n          shouldStop = true;\n        }\n      },\n      complete: () => {\n        subscriber.next(mergedResponse);\n        nextRequest();\n      },\n      error: (error) => {\n        subscriber.error(error);\n      },\n    });\n  };\n\n  const response = new Observable<DataQueryResponse>((subscriber) => {\n    runNextRequest(subscriber, totalRequests, 0);\n    return () => {\n      shouldStop = true;\n      if (subquerySubsciption != null) {\n        subquerySubsciption.unsubscribe();\n      }\n    };\n  });\n\n  return response;\n}\n\nexport const LOADING_FRAME_NAME = 'loki-splitting-progress';\n\nfunction updateLoadingFrame(\n  response: DataQueryResponse,\n  request: DataQueryRequest<LokiQuery>,\n  partition: TimeRange[],\n  requestN: number\n): DataQueryResponse {\n  if (isLogsQuery(request.targets[0].expr)) {\n    return response;\n  }\n  response.data = response.data.filter((frame) => frame.name !== LOADING_FRAME_NAME);\n\n  if (requestN <= 1) {\n    return response;\n  }\n\n  const loadingFrame = arrayToDataFrame([\n    {\n      time: partition[0].from.valueOf(),\n      timeEnd: partition[requestN - 2].to.valueOf(),\n      isRegion: true,\n      color: 'rgba(120, 120, 120, 0.1)',\n    },\n  ]);\n  loadingFrame.name = LOADING_FRAME_NAME;\n  loadingFrame.meta = {\n    dataTopic: DataTopic.Annotations,\n  };\n\n  response.data.push(loadingFrame);\n\n  return response;\n}\n\nfunction getNextRequestPointers(requests: LokiGroupedRequest[], requestGroup: number, requestN: number) {\n  // There's a pending request from the next group:\n  for (let i = requestGroup + 1; i < requests.length; i++) {\n    const group = requests[i];\n    if (group.partition[requestN - 1]) {\n      return {\n        nextRequestGroup: i,\n        nextRequestN: requestN,\n      };\n    }\n  }\n  return {\n    // Find the first group where `[requestN - 1]` is defined\n    nextRequestGroup: requests.findIndex((group) => group?.partition[requestN - 1] !== undefined),\n    nextRequestN: requestN - 1,\n  };\n}\n\nfunction querySupportsSplitting(query: LokiQuery) {\n  return (\n    query.queryType !== LokiQueryType.Instant &&\n    // Queries with $__range variable should not be split because then the interpolated $__range variable is incorrect\n    // because it is interpolated on the backend with the split timeRange\n    !isQueryWithRangeVariable(query.expr)\n  );\n}\n\nexport function runSplitQuery(datasource: LokiDatasource, request: DataQueryRequest<LokiQuery>) {\n  const queries = request.targets.filter((query) => !query.hide).filter((query) => query.expr);\n  const [nonSplittingQueries, normalQueries] = partition(queries, (query) => !querySupportsSplitting(query));\n  const [logQueries, metricQueries] = partition(normalQueries, (query) => isLogsQuery(query.expr));\n\n  request.queryGroupId = uuidv4();\n  const oneDayMs = 24 * 60 * 60 * 1000;\n  const rangePartitionedLogQueries = groupBy(logQueries, (query) =>\n    query.splitDuration ? durationToMilliseconds(parseDuration(query.splitDuration)) : oneDayMs\n  );\n  const rangePartitionedMetricQueries = groupBy(metricQueries, (query) =>\n    query.splitDuration ? durationToMilliseconds(parseDuration(query.splitDuration)) : oneDayMs\n  );\n\n  const requests: LokiGroupedRequest[] = [];\n  for (const [chunkRangeMs, queries] of Object.entries(rangePartitionedLogQueries)) {\n    const resolutionPartition = groupBy(queries, (query) => query.resolution || 1);\n    for (const resolution in resolutionPartition) {\n      requests.push({\n        request: { ...request, targets: resolutionPartition[resolution] },\n        partition: partitionTimeRange(true, request.range, request.intervalMs, Number(chunkRangeMs)),\n      });\n    }\n  }\n\n  for (const [chunkRangeMs, queries] of Object.entries(rangePartitionedMetricQueries)) {\n    const stepMsPartition = groupBy(queries, (query) =>\n      calculateStep(request.intervalMs, request.range, query.resolution || 1, query.step)\n    );\n\n    for (const stepMs in stepMsPartition) {\n      const targets = stepMsPartition[stepMs].map((q) => {\n        const { maxLines, ...query } = q;\n        return query;\n      });\n      requests.push({\n        request: { ...request, targets },\n        partition: partitionTimeRange(false, request.range, Number(stepMs), Number(chunkRangeMs)),\n      });\n    }\n  }\n\n  if (nonSplittingQueries.length) {\n    requests.push({\n      request: { ...request, targets: nonSplittingQueries },\n      partition: [request.range],\n    });\n  }\n\n  const startTime = new Date();\n  return runSplitGroupedQueries(datasource, requests).pipe(\n    tap((response) => {\n      if (response.state === LoadingState.Done) {\n        trackGroupedQueries(response, requests, request, startTime, {\n          predefinedOperations: datasource.predefinedOperations,\n        });\n      }\n    })\n  );\n}\n\n// Replicate from backend for split queries for now, until we can move query splitting to the backend\n// https://github.com/grafana/grafana/blob/main/pkg/tsdb/loki/step.go#L23\nfunction calculateStep(intervalMs: number, range: TimeRange, resolution: number, step: string | undefined) {\n  // If we can parse step,the we use it\n  // Otherwise we will calculate step based on interval\n  const interval_regex = /(-?\\d+(?:\\.\\d+)?)(ms|[Mwdhmsy])/;\n  if (step?.match(interval_regex)) {\n    return rangeUtil.intervalToMs(step) * resolution;\n  }\n\n  const newStep = intervalMs * resolution;\n  const safeStep = Math.round((range.to.valueOf() - range.from.valueOf()) / 11000);\n  return Math.max(newStep, safeStep);\n}\n","import { map, Observable, defer, mergeMap } from 'rxjs';\n\nimport {\n  DataFrameJSON,\n  DataQueryRequest,\n  DataQueryResponse,\n  LiveChannelScope,\n  LoadingState,\n  StreamingDataFrame,\n} from '@grafana/data';\nimport { getGrafanaLiveSrv, config } from '@grafana/runtime';\n\nimport { LokiDatasource } from './datasource';\nimport { LokiQuery } from './types';\n\n/**\n * Calculate a unique key for the query.  The key is used to pick a channel and should\n * be unique for each distinct query execution plan.  This key is not secure and is only picked to avoid\n * possible collisions\n */\nexport async function getLiveStreamKey(query: LokiQuery): Promise<string> {\n  const str = JSON.stringify({ expr: query.expr });\n\n  const msgUint8 = new TextEncoder().encode(str); // encode as (utf-8) Uint8Array\n  const hashBuffer = await crypto.subtle.digest('SHA-1', msgUint8); // hash the message\n  const hashArray = Array.from(new Uint8Array(hashBuffer.slice(0, 8))); // first 8 bytes\n  return hashArray.map((b) => b.toString(16).padStart(2, '0')).join('');\n}\n\n// This will get both v1 and v2 result formats\nexport function doLokiChannelStream(\n  query: LokiQuery,\n  ds: LokiDatasource,\n  options: DataQueryRequest<LokiQuery>\n): Observable<DataQueryResponse> {\n  // maximum time to keep values\n  const range = options.range;\n  const maxDelta = range.to.valueOf() - range.from.valueOf() + 1000;\n  let maxLength = options.maxDataPoints ?? 1000;\n  if (maxLength > 100) {\n    // for small buffers, keep them small\n    maxLength *= 2;\n  }\n\n  let frame: StreamingDataFrame | undefined = undefined;\n  const updateFrame = (msg: any) => {\n    if (msg?.message) {\n      const p: DataFrameJSON = msg.message;\n      if (!frame) {\n        frame = StreamingDataFrame.fromDataFrameJSON(p, {\n          maxLength,\n          maxDelta,\n          displayNameFormat: query.legendFormat,\n        });\n      } else {\n        frame.push(p);\n      }\n    }\n    return frame;\n  };\n\n  return defer(() => getLiveStreamKey(query)).pipe(\n    mergeMap((key) => {\n      return getGrafanaLiveSrv()\n        .getStream({\n          scope: LiveChannelScope.DataSource,\n          namespace: ds.uid,\n          path: `tail/${key}`,\n          data: {\n            ...query,\n            timeRange: {\n              from: range.from.valueOf().toString(),\n              to: range.to.valueOf().toString(),\n            },\n          },\n        })\n        .pipe(\n          map((evt) => {\n            const frame = updateFrame(evt);\n            return {\n              data: frame ? [frame] : [],\n              state: LoadingState.Streaming,\n            };\n          })\n        );\n    })\n  );\n}\n\nexport const convertToWebSocketUrl = (url: string) => {\n  const protocol = window.location.protocol === 'https:' ? 'wss://' : 'ws://';\n  let backend = `${protocol}${window.location.host}${config.appSubUrl}`;\n  if (backend.endsWith('/')) {\n    backend = backend.slice(0, -1);\n  }\n  return `${backend}${url}`;\n};\n","import { cloneDeep, map as lodashMap } from 'lodash';\nimport { lastValueFrom, merge, Observable, of, throwError } from 'rxjs';\nimport { catchError, map, switchMap, tap } from 'rxjs/operators';\n\nimport {\n  AbstractQuery,\n  AnnotationEvent,\n  AnnotationQueryRequest,\n  CoreApp,\n  DataFrame,\n  DataFrameView,\n  DataQueryRequest,\n  DataQueryResponse,\n  DataSourceInstanceSettings,\n  DataSourceWithLogsContextSupport,\n  DataSourceWithSupplementaryQueriesSupport,\n  SupplementaryQueryType,\n  DataSourceWithQueryExportSupport,\n  DataSourceWithQueryImportSupport,\n  Labels,\n  LoadingState,\n  LogRowModel,\n  QueryFixAction,\n  QueryHint,\n  rangeUtil,\n  ScopedVars,\n  SupplementaryQueryOptions,\n  TimeRange,\n  LogRowContextOptions,\n  DataSourceWithToggleableQueryFiltersSupport,\n  ToggleFilterAction,\n  QueryFilterOptions,\n  renderLegendFormat,\n  LegacyMetricFindQueryOptions,\n  AdHocVariableFilter,\n  urlUtil,\n  MetricFindValue,\n  DataSourceGetTagValuesOptions,\n  DataSourceGetTagKeysOptions,\n  DataSourceWithQueryModificationSupport,\n  LogsVolumeOption,\n  LogsSampleOptions,\n  QueryVariableModel,\n  CustomVariableModel,\n} from '@grafana/data';\nimport { Duration } from '@grafana/lezer-logql';\nimport { BackendSrvRequest, config, DataSourceWithBackend, getTemplateSrv, TemplateSrv } from '@grafana/runtime';\nimport { DataQuery } from '@grafana/schema';\n\nimport LanguageProvider from './LanguageProvider';\nimport { LiveStreams, LokiLiveTarget } from './LiveStreams';\nimport { LogContextProvider } from './LogContextProvider';\nimport { LokiVariableSupport } from './LokiVariableSupport';\nimport { transformBackendResult } from './backendResultTransformer';\nimport { LokiAnnotationsQueryEditor } from './components/AnnotationsQueryEditor';\nimport { placeHolderScopedVars } from './components/monaco-query-field/monaco-completion-provider/validation';\nimport { escapeLabelValueInSelector, isRegexSelector, getLabelTypeFromFrame } from './languageUtils';\nimport { labelNamesRegex, labelValuesRegex } from './migrations/variableQueryMigrations';\nimport {\n  addLabelFormatToQuery,\n  addLabelToQuery,\n  addNoPipelineErrorToQuery,\n  addParserToQuery,\n  removeCommentsFromQuery,\n  addFilterAsLabelFilter,\n  getParserPositions,\n  toLabelFilter,\n  addLineFilter,\n  findLastPosition,\n  getLabelFilterPositions,\n  queryHasFilter,\n  removeLabelFromQuery,\n} from './modifyQuery';\nimport { getQueryHints } from './queryHints';\nimport { runSplitQuery } from './querySplitting';\nimport {\n  getLogQueryFromMetricsQuery,\n  getLokiQueryFromDataQuery,\n  getNodesFromQuery,\n  getNormalizedLokiQuery,\n  getStreamSelectorsFromQuery,\n  isLogsQuery,\n  isQueryWithError,\n  requestSupportsSplitting,\n} from './queryUtils';\nimport { replaceVariables, returnVariables } from './querybuilder/parsingUtils';\nimport { convertToWebSocketUrl, doLokiChannelStream } from './streaming';\nimport { trackQuery } from './tracking';\nimport {\n  LokiOptions,\n  LokiQuery,\n  LokiQueryType,\n  LokiVariableQuery,\n  LokiVariableQueryType,\n  QueryStats,\n  SupportingQueryType,\n} from './types';\n\nexport type RangeQueryOptions = DataQueryRequest<LokiQuery> | AnnotationQueryRequest<LokiQuery>;\nexport const DEFAULT_MAX_LINES = 1000;\nexport const DEFAULT_MAX_LINES_SAMPLE = 10;\nexport const LOKI_ENDPOINT = '/loki/api/v1';\nexport const REF_ID_DATA_SAMPLES = 'loki-data-samples';\nexport const REF_ID_STARTER_ANNOTATION = 'annotation-';\nexport const REF_ID_STARTER_LOG_ROW_CONTEXT = 'log-row-context-query-';\nexport const REF_ID_STARTER_LOG_VOLUME = 'log-volume-';\nexport const REF_ID_STARTER_LOG_SAMPLE = 'log-sample-';\nexport const REF_ID_STARTER_STATS = 'log-stats-';\n\nconst NS_IN_MS = 1000000;\n\nexport function makeRequest(\n  query: LokiQuery,\n  range: TimeRange,\n  app: CoreApp,\n  requestId: string,\n  hideFromInspector?: boolean\n): DataQueryRequest<LokiQuery> {\n  const intervalInfo = rangeUtil.calculateInterval(range, 1);\n  return {\n    targets: [query],\n    requestId,\n    interval: intervalInfo.interval,\n    intervalMs: intervalInfo.intervalMs,\n    range: range,\n    scopedVars: {},\n    timezone: 'UTC',\n    app,\n    startTime: Date.now(),\n    hideFromInspector,\n  };\n}\n\nexport class LokiDatasource\n  extends DataSourceWithBackend<LokiQuery, LokiOptions>\n  implements\n    DataSourceWithLogsContextSupport,\n    DataSourceWithSupplementaryQueriesSupport<LokiQuery>,\n    DataSourceWithQueryImportSupport<LokiQuery>,\n    DataSourceWithQueryExportSupport<LokiQuery>,\n    DataSourceWithToggleableQueryFiltersSupport<LokiQuery>,\n    DataSourceWithQueryModificationSupport<LokiQuery>\n{\n  private streams = new LiveStreams();\n  private logContextProvider: LogContextProvider;\n  languageProvider: LanguageProvider;\n  maxLines: number;\n  predefinedOperations: string;\n\n  constructor(\n    private instanceSettings: DataSourceInstanceSettings<LokiOptions>,\n    private readonly templateSrv: TemplateSrv = getTemplateSrv()\n  ) {\n    super(instanceSettings);\n\n    this.languageProvider = new LanguageProvider(this);\n    const settingsData = instanceSettings.jsonData || {};\n    this.maxLines = parseInt(settingsData.maxLines ?? '0', 10) || DEFAULT_MAX_LINES;\n    this.predefinedOperations = settingsData.predefinedOperations ?? '';\n    this.annotations = {\n      QueryEditor: LokiAnnotationsQueryEditor,\n    };\n    this.variables = new LokiVariableSupport(this);\n    this.logContextProvider = new LogContextProvider(this);\n  }\n\n  /**\n   * Implemented for DataSourceWithSupplementaryQueriesSupport.\n   * It generates a DataQueryRequest for a specific supplementary query type.\n   * @returns A DataQueryRequest for the supplementary queries or undefined if not supported.\n   */\n  getSupplementaryRequest(\n    type: SupplementaryQueryType,\n    request: DataQueryRequest<LokiQuery>,\n    options?: SupplementaryQueryOptions\n  ): DataQueryRequest<LokiQuery> | undefined {\n    switch (type) {\n      case SupplementaryQueryType.LogsVolume:\n        const logsVolumeOption: LogsVolumeOption =\n          options?.type === SupplementaryQueryType.LogsVolume ? options : { type };\n        return this.getLogsVolumeDataProvider(request, logsVolumeOption);\n      case SupplementaryQueryType.LogsSample:\n        const logsSampleOption: LogsSampleOptions =\n          options?.type === SupplementaryQueryType.LogsSample ? options : { type };\n        return this.getLogsSampleDataProvider(request, logsSampleOption);\n      default:\n        return undefined;\n    }\n  }\n\n  /**\n   * Implemented for DataSourceWithSupplementaryQueriesSupport.\n   * It returns the supplementary types that the data source supports.\n   * @returns An array of supported supplementary query types.\n   */\n  getSupportedSupplementaryQueryTypes(): SupplementaryQueryType[] {\n    return [SupplementaryQueryType.LogsVolume, SupplementaryQueryType.LogsSample];\n  }\n\n  /**\n   * Implemented for DataSourceWithSupplementaryQueriesSupport.\n   * It retrieves supplementary queries based on the provided options and Loki query.\n   * @returns A supplemented Loki query or undefined if unsupported.\n   */\n  getSupplementaryQuery(options: SupplementaryQueryOptions, query: LokiQuery): LokiQuery | undefined {\n    const normalizedQuery = getNormalizedLokiQuery(query);\n    let expr = removeCommentsFromQuery(normalizedQuery.expr);\n    let isQuerySuitable = false;\n\n    switch (options.type) {\n      case SupplementaryQueryType.LogsVolume:\n        // it has to be a logs-producing range-query\n        isQuerySuitable = !!(expr && isLogsQuery(expr) && normalizedQuery.queryType === LokiQueryType.Range);\n        if (!isQuerySuitable) {\n          return undefined;\n        }\n\n        const dropErrorExpression = `${expr} | drop __error__`;\n        const field = options.field || 'level';\n        if (isQueryWithError(this.interpolateString(dropErrorExpression, placeHolderScopedVars)) === false) {\n          expr = dropErrorExpression;\n        }\n\n        return {\n          ...normalizedQuery,\n          refId: `${REF_ID_STARTER_LOG_VOLUME}${normalizedQuery.refId}`,\n          queryType: LokiQueryType.Range,\n          supportingQueryType: SupportingQueryType.LogsVolume,\n          expr: `sum by (${field}) (count_over_time(${expr}[$__auto]))`,\n          legendFormat: `{{ ${field} }}`,\n        };\n\n      case SupplementaryQueryType.LogsSample:\n        // it has to be a metric query\n        isQuerySuitable = !!(expr && !isLogsQuery(expr));\n        if (!isQuerySuitable) {\n          return undefined;\n        }\n        return {\n          ...normalizedQuery,\n          queryType: LokiQueryType.Range,\n          refId: `${REF_ID_STARTER_LOG_SAMPLE}${normalizedQuery.refId}`,\n          expr: getLogQueryFromMetricsQuery(expr),\n          maxLines: Number.isNaN(Number(options.limit)) ? this.maxLines : Number(options.limit),\n        };\n\n      default:\n        return undefined;\n    }\n  }\n\n  /**\n   * Private method used in the `getDataProvider` for DataSourceWithSupplementaryQueriesSupport, specifically for Logs volume queries.\n   * @returns An Observable of DataQueryResponse or undefined if no suitable queries are found.\n   */\n  private getLogsVolumeDataProvider(\n    request: DataQueryRequest<LokiQuery>,\n    options: LogsVolumeOption\n  ): DataQueryRequest<LokiQuery> | undefined {\n    const logsVolumeRequest = cloneDeep(request);\n    const targets = logsVolumeRequest.targets\n      .map((query) => this.getSupplementaryQuery(options, query))\n      .filter((query): query is LokiQuery => !!query);\n\n    if (!targets.length) {\n      return undefined;\n    }\n\n    return { ...logsVolumeRequest, targets };\n  }\n\n  /**\n   * Private method used in the `getDataProvider` for DataSourceWithSupplementaryQueriesSupport, specifically for Logs sample queries.\n   * @returns An Observable of DataQueryResponse or undefined if no suitable queries are found.\n   */\n  private getLogsSampleDataProvider(\n    request: DataQueryRequest<LokiQuery>,\n    options?: LogsSampleOptions\n  ): DataQueryRequest<LokiQuery> | undefined {\n    const logsSampleRequest = cloneDeep(request);\n    const targets = logsSampleRequest.targets\n      .map((query) => this.getSupplementaryQuery({ type: SupplementaryQueryType.LogsSample, limit: 100 }, query))\n      .filter((query): query is LokiQuery => !!query);\n\n    if (!targets.length) {\n      return undefined;\n    }\n    return { ...logsSampleRequest, targets };\n  }\n\n  /**\n   * Required by DataSourceApi. It executes queries based on the provided DataQueryRequest.\n   * @returns An Observable of DataQueryResponse containing the query results.\n   */\n  query(request: DataQueryRequest<LokiQuery>): Observable<DataQueryResponse> {\n    const queries = request.targets\n      .map(getNormalizedLokiQuery) // used to \"fix\" the deprecated `.queryType` prop\n      .map((q) => ({ ...q, maxLines: q.maxLines ?? this.maxLines }));\n\n    const fixedRequest: DataQueryRequest<LokiQuery> = {\n      ...request,\n      targets: queries,\n    };\n\n    const streamQueries = fixedRequest.targets.filter((q) => q.queryType === LokiQueryType.Stream);\n    if (\n      config.featureToggles.lokiExperimentalStreaming &&\n      streamQueries.length > 0 &&\n      fixedRequest.rangeRaw?.to === 'now'\n    ) {\n      // this is still an in-development feature,\n      // we do not support mixing stream-queries with normal-queries for now.\n      const streamRequest = {\n        ...fixedRequest,\n        targets: streamQueries,\n      };\n      return merge(\n        ...streamQueries.map((q) =>\n          doLokiChannelStream(\n            this.applyTemplateVariables(q, request.scopedVars, request.filters),\n            this, // the datasource\n            streamRequest\n          )\n        )\n      );\n    }\n\n    if (fixedRequest.liveStreaming) {\n      return this.runLiveQueryThroughBackend(fixedRequest);\n    }\n\n    if (config.featureToggles.lokiQuerySplitting && requestSupportsSplitting(fixedRequest.targets)) {\n      return runSplitQuery(this, fixedRequest);\n    }\n\n    const startTime = new Date();\n    return this.runQuery(fixedRequest).pipe(\n      tap((response) =>\n        trackQuery(response, fixedRequest, startTime, { predefinedOperations: this.predefinedOperations })\n      )\n    );\n  }\n\n  /**\n   * Executes requests through the backend using the `super.query()`, as part of the `query` method in DataSourceWithBackend.\n   * @returns An Observable of transformed DataQueryResponse results from the backend.\n   */\n  runQuery(fixedRequest: DataQueryRequest<LokiQuery>) {\n    return super\n      .query(fixedRequest)\n      .pipe(\n        map((response) =>\n          transformBackendResult(response, fixedRequest.targets, this.instanceSettings.jsonData.derivedFields ?? [])\n        )\n      );\n  }\n\n  /**\n   * Used within the `query` to execute live queries.\n   * It is intended for logs-queries, not metric queries.\n   * @returns An Observable of DataQueryResponse with live query results or an empty response if no suitable queries are found.\n   * @todo: The name says \"backend\" but it's actually running the query through the frontend. We should fix this.\n   */\n  private runLiveQueryThroughBackend(request: DataQueryRequest<LokiQuery>): Observable<DataQueryResponse> {\n    // and only for logs-queries, not metric queries\n    const logsQueries = request.targets.filter((query) => query.expr !== '' && isLogsQuery(query.expr));\n    if (logsQueries.length === 0) {\n      return of({\n        data: [],\n        state: LoadingState.Done,\n      });\n    }\n\n    const subQueries = logsQueries.map((query) => {\n      const interpolatedQuery = this.applyTemplateVariables(query, request.scopedVars, request.filters);\n      const maxDataPoints = interpolatedQuery.maxLines || this.maxLines;\n      // FIXME: currently we are running it through the frontend still.\n      return this.runLiveQuery(interpolatedQuery, maxDataPoints);\n    });\n\n    return merge(...subQueries);\n  }\n\n  /**\n   * Used within the `runLiveQuery` to create a live target for a Loki query.\n   * @returns A LokiLiveTarget object containing the necessary information for a live query.\n   */\n  private createLiveTarget(target: LokiQuery, maxDataPoints: number): LokiLiveTarget {\n    const query = target.expr;\n    const baseUrl = this.instanceSettings.url;\n    const params = urlUtil.serializeParams({ query });\n\n    return {\n      query,\n      url: convertToWebSocketUrl(`${baseUrl}/loki/api/v1/tail?${params}`),\n      refId: target.refId,\n      size: maxDataPoints,\n    };\n  }\n\n  /**\n   * Runs live queries, which involves creating a WebSocket connection to listen for new logs.\n   * It returns a slightly different DataQueryResponse compared to runQueries. It provides a single DataFrame\n   * even if there are multiple Loki streams. Common labels are set on dataFrame.labels, and unique labels per row are\n   * available in dataFrame.fields.labels.\n   * @returns An Observable of DataQueryResponse with streaming data or an error message if live tailing encounters an issue.\n   */\n  private runLiveQuery = (target: LokiQuery, maxDataPoints: number): Observable<DataQueryResponse> => {\n    const liveTarget = this.createLiveTarget(target, maxDataPoints);\n\n    return this.streams.getStream(liveTarget).pipe(\n      map((data) => ({\n        data: data || [],\n        key: `loki-${liveTarget.refId}`,\n        state: LoadingState.Streaming,\n      })),\n      catchError((err) => {\n        return throwError(() => `Live tailing was stopped due to following error: ${err.reason}`);\n      })\n    );\n  };\n\n  /**\n   * Implemented as a part of DataSourceApi. Interpolates variables and adds ad hoc filters to a list of Loki queries.\n   * @returns An array of expanded Loki queries with interpolated variables and ad hoc filters.\n   */\n  interpolateVariablesInQueries(\n    queries: LokiQuery[],\n    scopedVars: ScopedVars,\n    adhocFilters?: AdHocVariableFilter[]\n  ): LokiQuery[] {\n    let expandedQueries = queries;\n    if (queries && queries.length) {\n      expandedQueries = queries.map((query) => ({\n        ...query,\n        datasource: this.getRef(),\n        expr: this.addAdHocFilters(\n          this.templateSrv.replace(query.expr, scopedVars, this.interpolateQueryExpr),\n          adhocFilters\n        ),\n      }));\n    }\n\n    return expandedQueries;\n  }\n\n  /**\n   * Implemented as part of DataSourceApi. Converts a Loki query to a simple text string.\n   * Used, for example, in Query history.\n   * @returns A text representation of the query.\n   */\n  getQueryDisplayText(query: LokiQuery) {\n    return query.expr;\n  }\n\n  /**\n   * Given a time range, returns it as Loki parameters.\n   * @returns An object containing the start and end times in nanoseconds since the Unix epoch.\n   */\n  getTimeRangeParams(timeRange: TimeRange) {\n    return { start: timeRange.from.valueOf() * NS_IN_MS, end: timeRange.to.valueOf() * NS_IN_MS };\n  }\n\n  /**\n   * Implemented as part of DataSourceWithQueryImportSupport.\n   * Imports queries from AbstractQuery objects when switching between different data source types.\n   * @returns A Promise that resolves to an array of Loki queries.\n   */\n  async importFromAbstractQueries(abstractQueries: AbstractQuery[]): Promise<LokiQuery[]> {\n    await this.languageProvider.start();\n    const existingKeys = this.languageProvider.labelKeys;\n\n    if (existingKeys && existingKeys.length) {\n      abstractQueries = abstractQueries.map((abstractQuery) => {\n        abstractQuery.labelMatchers = abstractQuery.labelMatchers.filter((labelMatcher) => {\n          return existingKeys.includes(labelMatcher.name);\n        });\n        return abstractQuery;\n      });\n    }\n\n    return abstractQueries.map((abstractQuery) => this.languageProvider.importFromAbstractQuery(abstractQuery));\n  }\n\n  /**\n   * Implemented as part of DataSourceWithQueryImportSupport.\n   * Exports Loki queries to AbstractQuery objects when switching between different data source types.\n   * @returns A Promise that resolves to an array of AbstractQuery objects.\n   */\n  async exportToAbstractQueries(queries: LokiQuery[]): Promise<AbstractQuery[]> {\n    return queries.map((query) => this.languageProvider.exportToAbstractQuery(query));\n  }\n\n  /**\n   * A method that wraps `getResource` from DataSourceWithBackend to perform metadata requests, with an additional check for valid URL values.\n   * @returns A Promise that resolves to the data retrieved from the metadata request, or an empty array if no data is available.\n   */\n  async metadataRequest(url: string, params?: Record<string, string | number>, options?: Partial<BackendSrvRequest>) {\n    // url must not start with a `/`, otherwise the AJAX-request\n    // going from the browser will contain `//`, which can cause problems.\n    if (url.startsWith('/')) {\n      throw new Error(`invalid metadata request url: ${url}`);\n    }\n\n    const res = await this.getResource(url, params, options);\n    return res.data || [];\n  }\n\n  /**\n   * Used in `getQueryStats`. It wraps `getResource` from DataSourceWithBackend to perform a stats request\n   * Specifically designed for the stats endpoint, which does not return data but includes stats directly in the response object.\n   * @returns A Promise that resolves to a QueryStats object containing the statistics retrieved from the stats request.\n   */\n  async statsMetadataRequest(\n    url: string,\n    params?: Record<string, string | number>,\n    options?: Partial<BackendSrvRequest>\n  ): Promise<QueryStats> {\n    if (url.startsWith('/')) {\n      throw new Error(`invalid metadata request url: ${url}`);\n    }\n\n    return await this.getResource(url, params, options);\n  }\n\n  /**\n   * Used in `getStats`. Retrieves statistics for a Loki query and processes them into a QueryStats object.\n   * @returns A Promise that resolves to a QueryStats object containing the query statistics or undefined if the query is invalid.\n   */\n  async getQueryStats(query: LokiQuery, timeRange: TimeRange): Promise<QueryStats | undefined> {\n    // if query is invalid, clear stats, and don't request\n    if (isQueryWithError(this.interpolateString(query.expr, placeHolderScopedVars))) {\n      return undefined;\n    }\n\n    const labelMatchers = getStreamSelectorsFromQuery(query.expr);\n    let statsForAll: QueryStats = { streams: 0, chunks: 0, bytes: 0, entries: 0 };\n\n    for (const idx in labelMatchers) {\n      const { start, end } = this.getStatsTimeRange(query, Number(idx), timeRange);\n\n      if (start === undefined || end === undefined) {\n        return { streams: 0, chunks: 0, bytes: 0, entries: 0, message: 'Query size estimate not available.' };\n      }\n\n      try {\n        const data = await this.statsMetadataRequest(\n          'index/stats',\n          {\n            query: labelMatchers[idx],\n            start: start,\n            end: end,\n          },\n          { showErrorAlert: false, requestId: `${REF_ID_STARTER_STATS}${query.refId}` }\n        );\n\n        statsForAll = {\n          streams: statsForAll.streams + data.streams,\n          chunks: statsForAll.chunks + data.chunks,\n          bytes: statsForAll.bytes + data.bytes,\n          entries: statsForAll.entries + data.entries,\n        };\n      } catch (e) {\n        break;\n      }\n    }\n\n    return statsForAll;\n  }\n\n  /**\n   * Used within the `getQueryStats`. Retrieves the time range for a Loki stats query, adjusting it to cover the requested period.\n   * In metric queries, this means extending it over the range interval.\n   * @returns An object containing the start and end time in nanoseconds (NS_IN_MS) or undefined if the time range cannot be estimated.\n   */\n\n  getStatsTimeRange(\n    query: LokiQuery,\n    idx: number,\n    timeRange: TimeRange\n  ): { start: number | undefined; end: number | undefined } {\n    let start: number, end: number;\n    const NS_IN_MS = 1000000;\n    const durationNodes = getNodesFromQuery(query.expr, [Duration]);\n    const durations = durationNodes.map((d) => query.expr.substring(d.from, d.to));\n\n    if (isLogsQuery(query.expr)) {\n      // logs query with instant type can not be estimated\n      if (query.queryType === LokiQueryType.Instant) {\n        return { start: undefined, end: undefined };\n      }\n      // logs query with range type\n      return this.getTimeRangeParams(timeRange);\n    }\n\n    if (query.queryType === LokiQueryType.Instant) {\n      // metric query with instant type\n\n      if (!!durations[idx]) {\n        // if query has a duration e.g. [1m]\n        end = this.getTimeRangeParams(timeRange).end;\n        start = end - rangeUtil.intervalToMs(durations[idx]) * NS_IN_MS;\n        return { start, end };\n      } else {\n        // if query has no duration e.g. [$__interval]\n\n        if (/(\\$__auto|\\$__range)/.test(query.expr)) {\n          // if $__auto or $__range is used, we can estimate the time range using the selected range\n          return this.getTimeRangeParams(timeRange);\n        }\n\n        // otherwise we cant estimate the time range\n        return { start: undefined, end: undefined };\n      }\n    }\n\n    // metric query with range type\n    return this.getTimeRangeParams(timeRange);\n  }\n\n  /**\n   * Retrieves statistics for a Loki query and returns the QueryStats object.\n   * @returns A Promise that resolves to a QueryStats object or null if the query is invalid or has no statistics.\n   */\n  async getStats(query: LokiQuery, timeRange: TimeRange): Promise<QueryStats | null> {\n    if (!query.expr) {\n      return null;\n    }\n\n    const response = await this.getQueryStats(query, timeRange);\n\n    if (!response) {\n      return null;\n    }\n\n    return Object.values(response).every((v) => v === 0) ? null : response;\n  }\n\n  /**\n   * Implemented as part of DataSourceAPI and used for template variable queries.\n   * @returns A Promise that resolves to an array of results from the metric find query.\n   */\n  async metricFindQuery(\n    query: LokiVariableQuery | string,\n    options?: LegacyMetricFindQueryOptions\n  ): Promise<MetricFindValue[]> {\n    if (!query) {\n      return Promise.resolve([]);\n    }\n\n    let interpolatedVariableQuery: LokiVariableQuery | undefined;\n\n    if (typeof query === 'string') {\n      interpolatedVariableQuery = this.parseStringToVariableQuery(this.interpolateString(query, options?.scopedVars));\n    } else {\n      interpolatedVariableQuery = {\n        ...query,\n        label: this.interpolateString(query.label || '', options?.scopedVars),\n        stream: this.interpolateString(query.stream || '', options?.scopedVars),\n      };\n    }\n\n    if (interpolatedVariableQuery) {\n      return await this.processMetricFindQuery(interpolatedVariableQuery, options?.range);\n    }\n\n    return Promise.resolve([]);\n  }\n\n  /**\n   * Used within the `metricFindQuery`. Retrieves the correct variable results based on the provided LokiVariableQuery.\n   * @returns A Promise that resolves to an array of variable results based on the query type and parameters.\n   */\n\n  private async processMetricFindQuery(query: LokiVariableQuery, timeRange?: TimeRange): Promise<MetricFindValue[]> {\n    if (query.type === LokiVariableQueryType.LabelNames) {\n      const result = await this.languageProvider.fetchLabels({ timeRange });\n      return result.map((value: string) => ({ text: value }));\n    }\n\n    if (!query.label) {\n      return [];\n    }\n\n    const result = await this.languageProvider.fetchLabelValues(query.label, {\n      streamSelector: query.stream,\n      timeRange,\n    });\n    return result.map((value: string) => ({ text: value }));\n  }\n\n  /**\n   * Used in `metricFindQuery` to process legacy query strings (label_name() and label_values()) to variable query objects.\n   * @returns LokiVariableQuery object based on the provided query string, or undefined if string can't be parsed.\n   */\n  private parseStringToVariableQuery(query: string): LokiVariableQuery | undefined {\n    const refId = 'LokiVariableQueryEditor-VariableQuery';\n    const labelNames = query.match(labelNamesRegex);\n    if (labelNames) {\n      return {\n        type: LokiVariableQueryType.LabelNames,\n        refId,\n      };\n    }\n\n    const labelValues = query.match(labelValuesRegex);\n    if (labelValues) {\n      return {\n        type: LokiVariableQueryType.LabelValues,\n        label: labelValues[2],\n        stream: labelValues[1],\n        refId,\n      };\n    }\n    return undefined;\n  }\n\n  /**\n   * Used to fetch data samples, typically for autocompletion and query building to recommend parsers, labels, and values based on sampled data.\n   * Currently, it works for logs data only.\n   * @returns A Promise that resolves to an array of DataFrames containing data samples.\n   */\n  async getDataSamples(query: LokiQuery, timeRange: TimeRange): Promise<DataFrame[]> {\n    // Currently works only for logs sample\n    if (!isLogsQuery(query.expr) || isQueryWithError(this.interpolateString(query.expr, placeHolderScopedVars))) {\n      return [];\n    }\n\n    const lokiLogsQuery: LokiQuery = {\n      expr: query.expr,\n      queryType: LokiQueryType.Range,\n      refId: REF_ID_DATA_SAMPLES,\n      maxLines: query.maxLines || DEFAULT_MAX_LINES_SAMPLE,\n      supportingQueryType: SupportingQueryType.DataSample,\n    };\n\n    const request = makeRequest(lokiLogsQuery, timeRange, CoreApp.Unknown, REF_ID_DATA_SAMPLES, true);\n    return await lastValueFrom(this.query(request).pipe(switchMap((res) => of(res.data))));\n  }\n\n  /**\n   * Implemented as part of the DataSourceAPI. Retrieves tag keys that can be used for ad-hoc filtering.\n   * @returns A Promise that resolves to an array of label names represented as MetricFindValue objects.\n   */\n  async getTagKeys(options?: DataSourceGetTagKeysOptions<LokiQuery>): Promise<MetricFindValue[]> {\n    let streamSelector = '{}';\n    for (const filter of options?.filters ?? []) {\n      streamSelector = addLabelToQuery(streamSelector, filter.key, filter.operator, filter.value);\n    }\n    const result = await this.languageProvider.fetchLabels({ timeRange: options?.timeRange, streamSelector });\n    return result.map((value: string) => ({ text: value }));\n  }\n\n  /**\n   * Implemented as part of the DataSourceAPI. Retrieves tag values that can be used for ad-hoc filtering.\n   * @returns A Promise that resolves to an array of label values represented as MetricFindValue objects\n   */\n  async getTagValues(options: DataSourceGetTagValuesOptions<LokiQuery>): Promise<MetricFindValue[]> {\n    let streamSelector = '{}';\n    for (const filter of options?.filters ?? []) {\n      streamSelector = addLabelToQuery(streamSelector, filter.key, filter.operator, filter.value);\n    }\n    const result = await this.languageProvider.fetchLabelValues(options.key, {\n      timeRange: options.timeRange,\n      streamSelector,\n    });\n    return result.map((value: string) => ({ text: value }));\n  }\n\n  /**\n   * Used for interpolation logic in `interpolateVariablesInQueries` and `applyTemplateVariables`.\n   * Handles escaping of special characters based on variable type and value.\n   * @returns The interpolated value with appropriate character escaping.\n   */\n  interpolateQueryExpr(value: any, variable: QueryVariableModel | CustomVariableModel) {\n    // if no multi or include all do not regexEscape\n    if (!variable.multi && !variable.includeAll) {\n      return lokiRegularEscape(value);\n    }\n\n    if (typeof value === 'string') {\n      return lokiSpecialRegexEscape(value);\n    }\n\n    const escapedValues = lodashMap(value, lokiSpecialRegexEscape);\n    return escapedValues.join('|');\n  }\n\n  /**\n   * Implemented for `DataSourceWithToggleableQueryFiltersSupport`. Toggles a filter on or off based on the provided filter action.\n   * It is used for example in Explore to toggle fields on and off trough log details.\n   * @returns A new LokiQuery with the filter toggled as specified.\n   */\n  toggleQueryFilter(query: LokiQuery, filter: ToggleFilterAction): LokiQuery {\n    let expression = query.expr ?? '';\n    const labelType = getLabelTypeFromFrame(filter.options.key, filter.frame, 0);\n    switch (filter.type) {\n      case 'FILTER_FOR': {\n        if (filter.options?.key && filter.options?.value) {\n          const value = escapeLabelValueInSelector(filter.options.value);\n\n          // This gives the user the ability to toggle a filter on and off.\n          expression = queryHasFilter(expression, filter.options.key, '=', value)\n            ? removeLabelFromQuery(expression, filter.options.key, '=', value)\n            : addLabelToQuery(expression, filter.options.key, '=', value, labelType);\n        }\n        break;\n      }\n      case 'FILTER_OUT': {\n        if (filter.options?.key && filter.options?.value) {\n          const value = escapeLabelValueInSelector(filter.options.value);\n\n          /**\n           * If there is a filter with the same key and value, remove it.\n           * This prevents the user from seeing no changes in the query when they apply\n           * this filter.\n           */\n          if (queryHasFilter(expression, filter.options.key, '=', value)) {\n            expression = removeLabelFromQuery(expression, filter.options.key, '=', value);\n          }\n\n          expression = addLabelToQuery(expression, filter.options.key, '!=', value, labelType);\n        }\n        break;\n      }\n      default:\n        break;\n    }\n    return { ...query, expr: expression };\n  }\n\n  /**\n   * Implemented for `DataSourceWithToggleableQueryFiltersSupport`. Checks if a query expression contains a filter based on the provided filter options.\n   * @returns A boolean value indicating whether the filter exists in the query expression.\n   */\n  queryHasFilter(query: LokiQuery, filter: QueryFilterOptions): boolean {\n    let expression = query.expr ?? '';\n    return queryHasFilter(expression, filter.key, '=', filter.value);\n  }\n\n  /**\n   * Implemented as part of `DataSourceWithQueryModificationSupport`. Used to modify a query based on the provided action.\n   * It is used, for example, in the Query Builder to apply hints such as parsers, operations, etc.\n   * @returns A new LokiQuery with the specified modification applied.\n   */\n  modifyQuery(query: LokiQuery, action: QueryFixAction): LokiQuery {\n    let expression = query.expr ?? '';\n    // NB: Usually the labelKeys should be fetched and cached in the datasource,\n    // but there might be some edge cases where this wouldn't be the case.\n    // However the changed would make this method `async`.\n    switch (action.type) {\n      case 'ADD_FILTER': {\n        if (action.options?.key && action.options?.value) {\n          const labelType = getLabelTypeFromFrame(action.options.key, action.frame, 0);\n          const value = escapeLabelValueInSelector(action.options.value);\n          expression = addLabelToQuery(expression, action.options.key, '=', value, labelType);\n        }\n        break;\n      }\n      case 'ADD_FILTER_OUT': {\n        if (action.options?.key && action.options?.value) {\n          const labelType = getLabelTypeFromFrame(action.options.key, action.frame, 0);\n          const value = escapeLabelValueInSelector(action.options.value);\n          expression = addLabelToQuery(expression, action.options.key, '!=', value, labelType);\n        }\n        break;\n      }\n      case 'ADD_LOGFMT_PARSER': {\n        expression = addParserToQuery(expression, 'logfmt');\n        break;\n      }\n      case 'ADD_JSON_PARSER': {\n        expression = addParserToQuery(expression, 'json');\n        break;\n      }\n      case 'ADD_UNPACK_PARSER': {\n        expression = addParserToQuery(expression, 'unpack');\n        break;\n      }\n      case 'ADD_NO_PIPELINE_ERROR': {\n        expression = addNoPipelineErrorToQuery(expression);\n        break;\n      }\n      case 'ADD_LEVEL_LABEL_FORMAT': {\n        if (action.options?.originalLabel && action.options?.renameTo) {\n          expression = addLabelFormatToQuery(expression, {\n            renameTo: action.options.renameTo,\n            originalLabel: action.options.originalLabel,\n          });\n        }\n        break;\n      }\n      case 'ADD_LABEL_FILTER': {\n        const parserPositions = getParserPositions(query.expr);\n        const labelFilterPositions = getLabelFilterPositions(query.expr);\n        const lastPosition = findLastPosition([...parserPositions, ...labelFilterPositions]);\n        const filter = toLabelFilter('', '', '=');\n        expression = addFilterAsLabelFilter(expression, [lastPosition], filter);\n        break;\n      }\n      case 'ADD_STRING_FILTER':\n      case 'ADD_LINE_FILTER': {\n        expression = addLineFilter(expression, action.options?.value);\n        break;\n      }\n      case 'ADD_STRING_FILTER_OUT':\n      case 'ADD_LINE_FILTER_OUT': {\n        expression = addLineFilter(expression, action.options?.value, '!=');\n        break;\n      }\n      default:\n        break;\n    }\n    return { ...query, expr: expression };\n  }\n\n  /**\n   * Implemented as part of `DataSourceWithQueryModificationSupport`. Returns a list of operation\n   * types that are supported by `modifyQuery()`.\n   */\n  getSupportedQueryModifications() {\n    return [\n      'ADD_FILTER',\n      'ADD_FILTER_OUT',\n      'ADD_LOGFMT_PARSER',\n      'ADD_JSON_PARSER',\n      'ADD_UNPACK_PARSER',\n      'ADD_NO_PIPELINE_ERROR',\n      'ADD_LEVEL_LABEL_FORMAT',\n      'ADD_LABEL_FILTER',\n      'ADD_STRING_FILTER',\n      'ADD_STRING_FILTER_OUT',\n    ];\n  }\n\n  /**\n   * Part of `DataSourceWithLogsContextSupport`, used to retrieve log context for a log row.\n   * @returns A promise that resolves to an object containing the log context data as DataFrames.\n   */\n  getLogRowContext = async (\n    row: LogRowModel,\n    options?: LogRowContextOptions,\n    origQuery?: DataQuery\n  ): Promise<{ data: DataFrame[] }> => {\n    return await this.logContextProvider.getLogRowContext(row, options, getLokiQueryFromDataQuery(origQuery));\n  };\n  /**\n   * Part of `DataSourceWithLogsContextSupport`, used to retrieve the log context query for the provided log row and original query.\n   * @returns A promise that resolves to a DataQuery representing the log context query.\n   */\n  getLogRowContextQuery = async (\n    row: LogRowModel,\n    options?: LogRowContextOptions,\n    origQuery?: DataQuery,\n    cacheFilters?: boolean\n  ): Promise<DataQuery> => {\n    return await this.logContextProvider.getLogRowContextQuery(\n      row,\n      options,\n      getLokiQueryFromDataQuery(origQuery),\n      cacheFilters\n    );\n  };\n\n  /**\n   * Part of `DataSourceWithLogsContextSupport`, used to retrieve the log context UI for the provided log row and original query.\n   * @returns A React component or element representing the log context UI for the log row.\n   */\n  getLogRowContextUi(row: LogRowModel, runContextQuery: () => void, origQuery: DataQuery): React.ReactNode {\n    return this.logContextProvider.getLogRowContextUi(row, runContextQuery, getLokiQueryFromDataQuery(origQuery));\n  }\n\n  /**\n   * Implemented as part of the DataSourceAPI. It allows the datasource to serve as a source of annotations for a dashboard.\n   * @returns A promise that resolves to an array of AnnotationEvent objects representing the annotations for the dashboard.\n   * @todo This is deprecated and it is recommended to use the `AnnotationSupport` feature for annotations.\n   */\n  async annotationQuery(options: any): Promise<AnnotationEvent[]> {\n    const { expr, maxLines, instant, tagKeys = '', titleFormat = '', textFormat = '' } = options.annotation;\n\n    if (!expr) {\n      return [];\n    }\n\n    const id = `${REF_ID_STARTER_ANNOTATION}${options.annotation.name}`;\n\n    const query: LokiQuery = {\n      refId: id,\n      expr,\n      maxLines,\n      instant,\n      queryType: instant ? LokiQueryType.Instant : LokiQueryType.Range,\n    };\n\n    const request = makeRequest(query, options.range, CoreApp.Dashboard, id);\n\n    const { data } = await lastValueFrom(this.query(request));\n\n    const annotations: AnnotationEvent[] = [];\n    const splitKeys: string[] = tagKeys.split(',').filter((v: string) => v !== '');\n\n    for (const frame of data) {\n      const view = new DataFrameView<{ Time: string; Line: string; labels: Labels }>(frame);\n\n      view.forEach((row) => {\n        const { labels } = row;\n\n        const maybeDuplicatedTags = Object.entries(labels)\n          .map(([key, val]) => [key, val.trim()]) // trim all label-values\n          .filter(([key, val]) => {\n            if (val === '') {\n              // remove empty\n              return false;\n            }\n\n            // if tags are specified, remove label if does not match tags\n            if (splitKeys.length && !splitKeys.includes(key)) {\n              return false;\n            }\n\n            return true;\n          })\n          .map(([key, val]) => val); // keep only the label-value\n\n        // remove duplicates\n        const tags = Array.from(new Set(maybeDuplicatedTags));\n\n        annotations.push({\n          time: new Date(row.Time).valueOf(),\n          title: renderLegendFormat(titleFormat, labels),\n          text: renderLegendFormat(textFormat, labels) || row.Line,\n          tags,\n        });\n      });\n    }\n\n    return annotations;\n  }\n\n  /**\n   * Adds ad hoc filters to a query expression, handling proper escaping of filter values.\n   * @returns The query expression with ad hoc filters and correctly escaped values.\n   * @todo this.templateSrv.getAdhocFilters() is deprecated\n   */\n  addAdHocFilters(queryExpr: string, adhocFilters?: AdHocVariableFilter[]) {\n    if (!adhocFilters?.length) {\n      return queryExpr;\n    }\n\n    let expr = replaceVariables(queryExpr);\n\n    expr = adhocFilters.reduce((acc: string, filter: { key: string; operator: string; value: string }) => {\n      const { key, operator } = filter;\n      let { value } = filter;\n      if (isRegexSelector(operator)) {\n        // Adhoc filters don't support multiselect, therefore if user selects regex operator\n        // we are going to consider value to be regex filter and use lokiRegularEscape\n        // that does not escape regex special characters (e.g. .*test.* => .*test.*)\n        value = lokiRegularEscape(value);\n      } else {\n        // Otherwise, we want to escape special characters in value\n        value = escapeLabelValueInSelector(value, operator);\n      }\n      return addLabelToQuery(acc, key, operator, value);\n    }, expr);\n\n    return returnVariables(expr);\n  }\n\n  /**\n   * Filters out queries that are empty or hidden. Used when running queries through backend.\n   * It is called from DatasourceWithBackend.\n   * @returns `true` if the query is not hidden and its expression is not empty; `false` otherwise.\n   */\n  filterQuery(query: LokiQuery): boolean {\n    if (query.hide || query.expr === '') {\n      return false;\n    }\n    return true;\n  }\n\n  /**\n   * Applies template variables and add hoc filters to a query. Used when running queries through backend.\n   * It is called from DatasourceWithBackend.\n   * @returns A modified Loki query with template variables and ad hoc filters applied.\n   */\n  applyTemplateVariables(target: LokiQuery, scopedVars: ScopedVars, adhocFilters?: AdHocVariableFilter[]): LokiQuery {\n    // We want to interpolate these variables on backend because we support using them in\n    // alerting/ML queries and we want to have consistent interpolation for all queries\n    const { __auto, __interval, __interval_ms, __range, __range_s, __range_ms, ...rest } = scopedVars || {};\n\n    const variables = {\n      ...rest,\n\n      // pass through for backend interpolation. Need to be in scopedVars for Scenes though\n      __interval: {\n        value: '$__interval',\n      },\n      __interval_ms: {\n        value: '$__interval_ms',\n      },\n    };\n\n    const exprWithAdHoc = this.addAdHocFilters(\n      this.templateSrv.replace(target.expr, variables, this.interpolateQueryExpr),\n      adhocFilters\n    );\n\n    return {\n      ...target,\n      legendFormat: this.templateSrv.replace(target.legendFormat, rest),\n      expr: exprWithAdHoc,\n    };\n  }\n\n  /**\n   * Interpolates template variables in a given string. Template variables are passed trough scopedVars.\n   * @returns The string with template variables replaced by their values.\n   */\n  interpolateString(string: string, scopedVars?: ScopedVars) {\n    return this.templateSrv.replace(string, scopedVars, this.interpolateQueryExpr);\n  }\n\n  /**\n   * Retrieves and returns a list of variable names used in the template service.\n   * Used for example in the Query Builder to populate the variable dropdown with template variables.\n   * @returns An array of variable names, each prefixed with '$'.\n   */\n  getVariables(): string[] {\n    return this.templateSrv.getVariables().map((v) => `$${v.name}`);\n  }\n  /**\n   * Retrieves query hints for query improvements based on a Loki query and its result data.\n   * Used in Query builder to provide hints for query improvements, such as adding a parser, etc.\n   * @returns An array of query hints for potential query improvements.\n   */\n  getQueryHints(query: LokiQuery, result: DataFrame[]): QueryHint[] {\n    return getQueryHints(query.expr, result);\n  }\n\n  /**\n   * Get a default LokiQuery based on the specified app. Currently used in UnifiedAlerting.\n   * @returns A default LokiQuery object with appropriate settings for the given application.\n   */\n  getDefaultQuery(app: CoreApp): LokiQuery {\n    const defaults = { refId: 'A', expr: '' };\n\n    if (app === CoreApp.UnifiedAlerting) {\n      return {\n        ...defaults,\n        queryType: LokiQueryType.Instant,\n      };\n    }\n\n    return {\n      ...defaults,\n      queryType: LokiQueryType.Range,\n    };\n  }\n}\n\n// NOTE: these two functions are very similar to the escapeLabelValueIn* functions\n// in language_utils.ts, but they are not exactly the same algorithm, and we found\n// no way to reuse one in the another or vice versa.\nexport function lokiRegularEscape<T>(value: T) {\n  if (typeof value === 'string') {\n    return value.replace(/'/g, \"\\\\\\\\'\");\n  }\n  return value;\n}\n\nexport function lokiSpecialRegexEscape<T>(value: T) {\n  if (typeof value === 'string') {\n    return lokiRegularEscape(value.replace(/\\\\/g, '\\\\\\\\\\\\\\\\').replace(/[$^*{}\\[\\]+?.()|]/g, '\\\\\\\\$&'));\n  }\n  return value;\n}\n","import { invert } from 'lodash';\n\nimport { AbstractLabelMatcher, AbstractLabelOperator, AbstractQuery, DataFrame, TimeRange } from '@grafana/data';\n\nimport { LabelType } from './types';\n\nfunction roundMsToMin(milliseconds: number): number {\n  return roundSecToMin(milliseconds / 1000);\n}\n\nfunction roundSecToMin(seconds: number): number {\n  return Math.floor(seconds / 60);\n}\n\nexport function shouldRefreshLabels(range?: TimeRange, prevRange?: TimeRange): boolean {\n  if (range && prevRange) {\n    const sameMinuteFrom = roundMsToMin(range.from.valueOf()) === roundMsToMin(prevRange.from.valueOf());\n    const sameMinuteTo = roundMsToMin(range.to.valueOf()) === roundMsToMin(prevRange.to.valueOf());\n    // If both are same, don't need to refresh\n    return !(sameMinuteFrom && sameMinuteTo);\n  }\n  return false;\n}\n\n// Loki regular-expressions use the RE2 syntax (https://github.com/google/re2/wiki/Syntax),\n// so every character that matches something in that list has to be escaped.\n// the list of meta characters is: *+?()|\\.[]{}^$\n// we make a javascript regular expression that matches those characters:\nconst RE2_METACHARACTERS = /[*+?()|\\\\.\\[\\]{}^$]/g;\nfunction escapeLokiRegexp(value: string): string {\n  return value.replace(RE2_METACHARACTERS, '\\\\$&');\n}\n\n// based on the openmetrics-documentation, the 3 symbols we have to handle are:\n// - \\n ... the newline character\n// - \\  ... the backslash character\n// - \"  ... the double-quote character\nexport function escapeLabelValueInExactSelector(labelValue: string): string {\n  return labelValue.replace(/\\\\/g, '\\\\\\\\').replace(/\\n/g, '\\\\n').replace(/\"/g, '\\\\\"');\n}\n\nexport function unescapeLabelValue(labelValue: string): string {\n  return labelValue.replace(/\\\\n/g, '\\n').replace(/\\\\\"/g, '\"').replace(/\\\\\\\\/g, '\\\\');\n}\n\nexport function escapeLabelValueInRegexSelector(labelValue: string): string {\n  return escapeLabelValueInExactSelector(escapeLokiRegexp(labelValue));\n}\n\nexport function escapeLabelValueInSelector(labelValue: string, selector?: string): string {\n  return isRegexSelector(selector)\n    ? escapeLabelValueInRegexSelector(labelValue)\n    : escapeLabelValueInExactSelector(labelValue);\n}\n\nexport function isRegexSelector(selector?: string) {\n  if (selector && (selector.includes('=~') || selector.includes('!~'))) {\n    return true;\n  }\n  return false;\n}\n\nexport function isBytesString(string: string) {\n  const BYTES_KEYWORDS = [\n    'b',\n    'kib',\n    'Kib',\n    'kb',\n    'KB',\n    'mib',\n    'Mib',\n    'mb',\n    'MB',\n    'gib',\n    'Gib',\n    'gb',\n    'GB',\n    'tib',\n    'Tib',\n    'tb',\n    'TB',\n    'pib',\n    'Pib',\n    'pb',\n    'PB',\n    'eib',\n    'Eib',\n    'eb',\n    'EB',\n  ];\n  const regex = new RegExp(`^(?:-?\\\\d+(?:\\\\.\\\\d+)?)(?:${BYTES_KEYWORDS.join('|')})$`);\n  const match = string.match(regex);\n  return !!match;\n}\n\nexport function getLabelTypeFromFrame(labelKey: string, frame?: DataFrame, index?: number): null | LabelType {\n  if (!frame || index === undefined) {\n    return null;\n  }\n\n  const typeField = frame.fields.find((field) => field.name === 'labelTypes')?.values[index];\n  if (!typeField) {\n    return null;\n  }\n  switch (typeField[labelKey]) {\n    case 'I':\n      return LabelType.Indexed;\n    case 'S':\n      return LabelType.StructuredMetadata;\n    case 'P':\n      return LabelType.Parsed;\n    default:\n      return null;\n  }\n}\n\nexport const mapOpToAbstractOp: Record<AbstractLabelOperator, string> = {\n  [AbstractLabelOperator.Equal]: '=',\n  [AbstractLabelOperator.NotEqual]: '!=',\n  [AbstractLabelOperator.EqualRegEx]: '=~',\n  [AbstractLabelOperator.NotEqualRegEx]: '!~',\n};\n\n// eslint-disable-next-line @typescript-eslint/consistent-type-assertions\nexport const mapAbstractOperatorsToOp = invert(mapOpToAbstractOp) as Record<string, AbstractLabelOperator>;\n\nexport function abstractQueryToExpr(labelBasedQuery: AbstractQuery): string {\n  const expr = labelBasedQuery.labelMatchers\n    .map((selector: AbstractLabelMatcher) => {\n      const operator = mapOpToAbstractOp[selector.operator];\n      if (operator) {\n        return `${selector.name}${operator}\"${selector.value}\"`;\n      } else {\n        return '';\n      }\n    })\n    .filter((e: string) => e !== '')\n    .join(', ');\n\n  return expr ? `{${expr}}` : '';\n}\n\nexport function processLabels(labels: Array<{ [key: string]: string }>) {\n  const valueSet: { [key: string]: Set<string> } = {};\n  labels.forEach((label) => {\n    Object.keys(label).forEach((key) => {\n      if (!valueSet[key]) {\n        valueSet[key] = new Set();\n      }\n      if (!valueSet[key].has(label[key])) {\n        valueSet[key].add(label[key]);\n      }\n    });\n  });\n\n  const valueArray: { [key: string]: string[] } = {};\n  limitSuggestions(Object.keys(valueSet)).forEach((key) => {\n    valueArray[key] = limitSuggestions(Array.from(valueSet[key]));\n  });\n\n  return { values: valueArray, keys: Object.keys(valueArray) };\n}\n\n// Max number of items (metrics, labels, values) that we display as suggestions. Prevents from running out of memory.\nexport const SUGGESTIONS_LIMIT = 10000;\nexport function limitSuggestions(items: string[]) {\n  return items.slice(0, SUGGESTIONS_LIMIT);\n}\n","import { NodeType, SyntaxNode } from '@lezer/common';\nimport { sortBy } from 'lodash';\n\nimport { QueryBuilderLabelFilter } from '@grafana/experimental';\nimport {\n  Identifier,\n  LabelFilter,\n  LabelParser,\n  LineComment,\n  LineFilters,\n  LogExpr,\n  LogRangeExpr,\n  Matcher,\n  parser,\n  PipelineExpr,\n  Selector,\n  UnwrapExpr,\n  String,\n  PipelineStage,\n  LogfmtParser,\n  JsonExpressionParser,\n  LogfmtExpressionParser,\n  Expr,\n  LabelFormatExpr,\n} from '@grafana/lezer-logql';\n\nimport { unescapeLabelValue } from './languageUtils';\nimport { getNodePositionsFromQuery } from './queryUtils';\nimport { lokiQueryModeller as modeller } from './querybuilder/LokiQueryModeller';\nimport { buildVisualQueryFromString, handleQuotes } from './querybuilder/parsing';\nimport { LabelType } from './types';\n\nexport class NodePosition {\n  from: number;\n  to: number;\n  type?: NodeType;\n\n  constructor(from: number, to: number, type?: NodeType) {\n    this.from = from;\n    this.to = to;\n    this.type = type;\n  }\n\n  static fromNode(node: SyntaxNode): NodePosition {\n    return new NodePosition(node.from, node.to, node.type);\n  }\n\n  contains(position: NodePosition): boolean {\n    return this.from <= position.from && this.to >= position.to;\n  }\n\n  getExpression(query: string): string {\n    return query.substring(this.from, this.to);\n  }\n}\n\n/**\n * Checks for the presence of a given label=value filter in any Matcher expression in the query.\n */\nexport function queryHasFilter(query: string, key: string, operator: string, value: string): boolean {\n  const matchers = getMatchersWithFilter(query, key, operator, value);\n  return matchers.length > 0;\n}\n\n/**\n * Removes a label=value Matcher expression from the query.\n */\nexport function removeLabelFromQuery(query: string, key: string, operator: string, value: string): string {\n  const matchers = getMatchersWithFilter(query, key, operator, value);\n  for (const matcher of matchers) {\n    query =\n      matcher.parent?.type.id === LabelFilter ? removeLabelFilter(query, matcher) : removeSelector(query, matcher);\n  }\n  return query;\n}\n\nfunction removeLabelFilter(query: string, matcher: SyntaxNode): string {\n  const pipelineStage = matcher.parent?.parent;\n  if (!pipelineStage || pipelineStage.type.id !== PipelineStage) {\n    return query;\n  }\n  return (query.substring(0, pipelineStage.from) + query.substring(pipelineStage.to)).trim();\n}\n\nfunction removeSelector(query: string, matcher: SyntaxNode): string {\n  let selector: SyntaxNode | null = matcher;\n  do {\n    selector = selector.parent;\n  } while (selector && selector.type.id !== Selector);\n  const label = matcher.getChild(Identifier);\n  if (!selector || !label) {\n    return query;\n  }\n  const labelName = query.substring(label.from, label.to);\n\n  const prefix = query.substring(0, selector.from);\n  const suffix = query.substring(selector.to);\n\n  const matchVisQuery = buildVisualQueryFromString(query.substring(selector.from, selector.to));\n  matchVisQuery.query.labels = matchVisQuery.query.labels.filter((label) => label.label !== labelName);\n\n  return prefix + modeller.renderQuery(matchVisQuery.query) + suffix;\n}\n\nfunction getMatchersWithFilter(query: string, label: string, operator: string, value: string): SyntaxNode[] {\n  const tree = parser.parse(query);\n  const matchers: SyntaxNode[] = [];\n  tree.iterate({\n    enter: ({ type, node }): void => {\n      if (type.id === Matcher) {\n        matchers.push(node);\n      }\n    },\n  });\n  return matchers.filter((matcher) => {\n    const labelNode = matcher.getChild(Identifier);\n    const opNode = labelNode?.nextSibling;\n    const valueNode = matcher.getChild(String);\n    if (!labelNode || !opNode || !valueNode) {\n      return false;\n    }\n    const labelName = query.substring(labelNode.from, labelNode.to);\n    if (labelName !== label) {\n      return false;\n    }\n    const labelValue = query.substring(valueNode.from, valueNode.to);\n    if (handleQuotes(labelValue) !== unescapeLabelValue(value)) {\n      return false;\n    }\n    const labelOperator = query.substring(opNode.from, opNode.to);\n    if (labelOperator !== operator) {\n      return false;\n    }\n    return true;\n  });\n}\n\n/**\n * Adds label filter to existing query. Useful for query modification for example for ad hoc filters.\n *\n * It uses LogQL parser to find instances of labels, alters them and then splices them back into the query.\n * In a case when we have parser, instead of adding new instance of label it adds label filter after the parser.\n *\n * This operates on substrings of the query with labels and operates just on those. This makes this\n * more robust and can alter even invalid queries, and preserves in general the query structure and whitespace.\n */\nexport function addLabelToQuery(\n  query: string,\n  key: string,\n  operator: string,\n  value: string,\n  labelType?: LabelType | null\n): string {\n  if (!key || !value) {\n    throw new Error('Need label to add to query.');\n  }\n\n  const streamSelectorPositions = getStreamSelectorPositions(query);\n  if (!streamSelectorPositions.length) {\n    return query;\n  }\n\n  const parserPositions = getParserPositions(query);\n  const labelFilterPositions = getLabelFilterPositions(query);\n  const hasStreamSelectorMatchers = getMatcherInStreamPositions(query);\n  // For non-indexed labels we want to add them after label_format to, for example, allow ad-hoc filters to use formatted labels\n  const labelFormatPositions = getNodePositionsFromQuery(query, [LabelFormatExpr]);\n\n  // If the label type wasn't passed in from the calling function, we can use lezer to figure out if this label is already in the stream selectors\n  if (!labelType) {\n    const identifierSelectorMatchers = getIdentifierInStreamPositions(query);\n    const indexedKeys = identifierSelectorMatchers.map((match) => match.getExpression(query));\n    if (indexedKeys.includes(key)) {\n      labelType = LabelType.Indexed;\n    }\n  }\n\n  const everyStreamSelectorHasMatcher = streamSelectorPositions.every((streamSelectorPosition) =>\n    hasStreamSelectorMatchers.some(\n      (matcherPosition) =>\n        matcherPosition.from >= streamSelectorPosition.from && matcherPosition.to <= streamSelectorPosition.to\n    )\n  );\n\n  const filter = toLabelFilter(key, value, operator);\n  if (labelType === LabelType.Parsed || labelType === LabelType.StructuredMetadata) {\n    const lastPositionsPerExpression = getLastPositionPerExpression(query, [\n      ...streamSelectorPositions,\n      ...labelFilterPositions,\n      ...parserPositions,\n      ...labelFormatPositions,\n    ]);\n\n    return addFilterAsLabelFilter(query, lastPositionsPerExpression, filter);\n  } else if (labelType === LabelType.Indexed) {\n    return addFilterToStreamSelector(query, streamSelectorPositions, filter);\n  } else {\n    // labelType is not set, so we need to figure out where to add the label\n    // if we don't have a parser, or have empty stream selectors, we will just add it to the stream selector\n    if (parserPositions.length === 0 || everyStreamSelectorHasMatcher === false) {\n      return addFilterToStreamSelector(query, streamSelectorPositions, filter);\n    } else {\n      // If `labelType` is not set, it indicates a potential metric query (`labelType` is present only in log queries that came from a Loki instance supporting the `categorize-labels` API). In case we are not adding the label to stream selectors we need to find the last position to add in each expression.\n      // E.g. in `sum(rate({foo=\"bar\"} | logfmt [$__auto])) / sum(rate({foo=\"baz\"} | logfmt [$__auto]))` we need to add the label at two places.\n      const lastPositionsPerExpression = getLastPositionPerExpression(query, [\n        ...parserPositions,\n        ...labelFilterPositions,\n        ...labelFormatPositions,\n      ]);\n\n      return addFilterAsLabelFilter(query, lastPositionsPerExpression, filter);\n    }\n  }\n}\n\nfunction getLastPositionPerExpression(query: string, positions: NodePosition[]): NodePosition[] {\n  const subExpressions = findLeaves(getNodePositionsFromQuery(query, [Expr]));\n  const subPositions = [...positions];\n\n  // find last position for each subexpression\n  const lastPositionsPerExpression = subExpressions.map((subExpression) => {\n    return findLastPosition(\n      subPositions.filter((p) => {\n        return subExpression.contains(p);\n      })\n    );\n  });\n  return lastPositionsPerExpression;\n}\n\n/**\n * Adds parser to existing query. Useful for query modification for hints.\n * It uses LogQL parser to find instances of stream selectors or line filters and adds parser after them.\n *\n * @param query\n * @param parser\n */\nexport function addParserToQuery(query: string, parser: string): string {\n  const lineFilterPositions = getLineFiltersPositions(query);\n\n  if (lineFilterPositions.length) {\n    return addParser(query, lineFilterPositions, parser);\n  } else {\n    const streamSelectorPositions = getStreamSelectorPositions(query);\n    if (!streamSelectorPositions.length) {\n      return query;\n    }\n    return addParser(query, streamSelectorPositions, parser);\n  }\n}\n\n/**\n * Adds filtering for pipeline errors to existing query. Useful for query modification for hints.\n * It uses LogQL parser to find parsers and adds pipeline errors filtering after them.\n *\n * @param query\n */\nexport function addNoPipelineErrorToQuery(query: string): string {\n  const parserPositions = getParserPositions(query);\n  if (!parserPositions.length) {\n    return query;\n  }\n\n  const filter = toLabelFilter('__error__', '', '=');\n  return addFilterAsLabelFilter(query, parserPositions, filter);\n}\n\n/**\n * Adds label format to existing query. Useful for query modification for hints.\n * It uses LogQL parser to find log query and add label format at the end.\n *\n * @param query\n * @param labelFormat\n */\nexport function addLabelFormatToQuery(query: string, labelFormat: { originalLabel: string; renameTo: string }): string {\n  const logQueryPositions = getLogQueryPositions(query);\n  return addLabelFormat(query, logQueryPositions, labelFormat);\n}\n\n/**\n * Removes all comments from query.\n * It uses  LogQL parser to find all LineComments and removes them.\n */\nexport function removeCommentsFromQuery(query: string): string {\n  const lineCommentPositions = getLineCommentPositions(query);\n\n  if (!lineCommentPositions.length) {\n    return query;\n  }\n\n  let newQuery = '';\n  let prev = 0;\n\n  for (let lineCommentPosition of lineCommentPositions) {\n    newQuery = newQuery + query.substring(prev, lineCommentPosition.from);\n    prev = lineCommentPosition.to;\n  }\n  newQuery = newQuery + query.substring(prev);\n  return newQuery;\n}\n\n/**\n * Parse the string and get all Selector positions in the query together with parsed representation of the\n * selector.\n * @param query\n */\nexport function getStreamSelectorPositions(query: string): NodePosition[] {\n  const tree = parser.parse(query);\n  const positions: NodePosition[] = [];\n  tree.iterate({\n    enter: ({ type, node }): false | void => {\n      if (type.id === Selector) {\n        positions.push(NodePosition.fromNode(node));\n        return false;\n      }\n    },\n  });\n  return positions;\n}\n\n/**\n * Parse the string and get all LabelParser positions in the query.\n * @param query\n */\nexport function getParserPositions(query: string): NodePosition[] {\n  const tree = parser.parse(query);\n  const positions: NodePosition[] = [];\n  const parserNodeTypes = [LabelParser, JsonExpressionParser, LogfmtParser, LogfmtExpressionParser];\n  tree.iterate({\n    enter: ({ type, node }): false | void => {\n      if (parserNodeTypes.includes(type.id)) {\n        positions.push(NodePosition.fromNode(node));\n        return false;\n      }\n    },\n  });\n  return positions;\n}\n\n/**\n * Parse the string and get all LabelFilter positions in the query.\n * @param query\n */\nexport function getLabelFilterPositions(query: string): NodePosition[] {\n  const tree = parser.parse(query);\n  const positions: NodePosition[] = [];\n  tree.iterate({\n    enter: ({ type, node }): false | void => {\n      if (type.id === LabelFilter) {\n        positions.push(NodePosition.fromNode(node));\n        return false;\n      }\n    },\n  });\n  return positions;\n}\n\n/**\n * Parse the string and get all Line filter positions in the query.\n * @param query\n */\nfunction getLineFiltersPositions(query: string): NodePosition[] {\n  const tree = parser.parse(query);\n  const positions: NodePosition[] = [];\n  tree.iterate({\n    enter: ({ type, node }): false | void => {\n      if (type.id === LineFilters) {\n        positions.push(NodePosition.fromNode(node));\n        return false;\n      }\n    },\n  });\n  return positions;\n}\n\n/**\n * Parse the string and get all Log query positions in the query.\n * @param query\n */\nfunction getLogQueryPositions(query: string): NodePosition[] {\n  const tree = parser.parse(query);\n  const positions: NodePosition[] = [];\n  tree.iterate({\n    enter: ({ type, node }): false | void => {\n      if (type.id === LogExpr) {\n        positions.push(NodePosition.fromNode(node));\n        return false;\n      }\n\n      // This is a case in metrics query\n      if (type.id === LogRangeExpr) {\n        // Unfortunately, LogRangeExpr includes both log and non-log (e.g. Duration/Range/...) parts of query.\n        // We get position of all log-parts within LogRangeExpr: Selector, PipelineExpr and UnwrapExpr.\n        const logPartsPositions: NodePosition[] = [];\n        const selector = node.getChild(Selector);\n        if (selector) {\n          logPartsPositions.push(NodePosition.fromNode(selector));\n        }\n\n        const pipeline = node.getChild(PipelineExpr);\n        if (pipeline) {\n          logPartsPositions.push(NodePosition.fromNode(pipeline));\n        }\n\n        const unwrap = node.getChild(UnwrapExpr);\n        if (unwrap) {\n          logPartsPositions.push(NodePosition.fromNode(unwrap));\n        }\n\n        // We sort them and then pick \"from\" from first position and \"to\" from last position.\n        const sorted = sortBy(logPartsPositions, (position) => position.to);\n        positions.push(new NodePosition(sorted[0].from, sorted[sorted.length - 1].to));\n        return false;\n      }\n    },\n  });\n  return positions;\n}\n\nexport function toLabelFilter(key: string, value: string, operator: string): QueryBuilderLabelFilter {\n  // We need to make sure that we convert the value back to string because it may be a number\n  return { label: key, op: operator, value };\n}\n\n/**\n * Add filter as to stream selectors\n * @param query\n * @param vectorSelectorPositions\n * @param filter\n */\nfunction addFilterToStreamSelector(\n  query: string,\n  vectorSelectorPositions: NodePosition[],\n  filter: QueryBuilderLabelFilter\n): string {\n  let newQuery = '';\n  let prev = 0;\n\n  for (let i = 0; i < vectorSelectorPositions.length; i++) {\n    // This is basically just doing splice on a string for each matched vector selector.\n    const match = vectorSelectorPositions[i];\n    const isLast = i === vectorSelectorPositions.length - 1;\n\n    const start = query.substring(prev, match.from);\n    const end = isLast ? query.substring(match.to) : '';\n    const matchVisQuery = buildVisualQueryFromString(query.substring(match.from, match.to));\n\n    if (!labelExists(matchVisQuery.query.labels, filter)) {\n      // We don't want to add duplicate labels.\n      matchVisQuery.query.labels.push(filter);\n    }\n    const newLabels = modeller.renderQuery(matchVisQuery.query);\n    newQuery += start + newLabels + end;\n    prev = match.to;\n  }\n  return newQuery;\n}\n\n/**\n * Add filter as label filter after the parsers\n * @param query\n * @param positionsToAddAfter\n * @param filter\n */\nexport function addFilterAsLabelFilter(\n  query: string,\n  positionsToAddAfter: NodePosition[],\n  filter: QueryBuilderLabelFilter\n): string {\n  let newQuery = '';\n  let prev = 0;\n\n  for (let i = 0; i < positionsToAddAfter.length; i++) {\n    // This is basically just doing splice on a string for each matched vector selector.\n    const match = positionsToAddAfter[i];\n    const isLast = i === positionsToAddAfter.length - 1;\n\n    const start = query.substring(prev, match.to);\n    const end = isLast ? query.substring(match.to) : '';\n\n    let labelFilter = '';\n    // For < and >, if the value is number, we don't add quotes around it and use it as number\n    if (!Number.isNaN(Number(filter.value)) && (filter.op === '<' || filter.op === '>')) {\n      labelFilter = ` | ${filter.label}${filter.op}${Number(filter.value)}`;\n    } else {\n      // we now unescape all escaped values again, because we are using backticks which can handle those cases.\n      // we also don't care about the operator here, because we need to unescape for both, regex and equal.\n      labelFilter = ` | ${filter.label}${filter.op}\\`${unescapeLabelValue(filter.value)}\\``;\n    }\n\n    newQuery += start + labelFilter + end;\n    prev = match.to;\n  }\n  return newQuery;\n}\n\n/**\n * Add parser after line filter or stream selector\n * @param query\n * @param queryPartPositions\n * @param parser\n */\nfunction addParser(query: string, queryPartPositions: NodePosition[], parser: string): string {\n  let newQuery = '';\n  let prev = 0;\n\n  for (let i = 0; i < queryPartPositions.length; i++) {\n    // Splice on a string for each matched vector selector\n    const match = queryPartPositions[i];\n    const isLast = i === queryPartPositions.length - 1;\n\n    const start = query.substring(prev, match.to);\n    const end = isLast ? query.substring(match.to) : '';\n\n    // Add parser\n    newQuery += start + ` | ${parser}` + end;\n    prev = match.to;\n  }\n  return newQuery;\n}\n\n/**\n * Add filter as label filter after the parsers\n * @param query\n * @param logQueryPositions\n * @param labelFormat\n */\nfunction addLabelFormat(\n  query: string,\n  logQueryPositions: NodePosition[],\n  labelFormat: { originalLabel: string; renameTo: string }\n): string {\n  let newQuery = '';\n  let prev = 0;\n\n  for (let i = 0; i < logQueryPositions.length; i++) {\n    // This is basically just doing splice on a string for each matched vector selector.\n    const match = logQueryPositions[i];\n    const isLast = i === logQueryPositions.length - 1;\n\n    const start = query.substring(prev, match.to);\n    const end = isLast ? query.substring(match.to) : '';\n\n    const labelFilter = ` | label_format ${labelFormat.renameTo}=${labelFormat.originalLabel}`;\n    newQuery += start + labelFilter + end;\n    prev = match.to;\n  }\n  return newQuery;\n}\n\nexport function addLineFilter(query: string, value = '', operator = '|='): string {\n  const streamSelectorPositions = getStreamSelectorPositions(query);\n  if (!streamSelectorPositions.length) {\n    return query;\n  }\n  const streamSelectorEnd = streamSelectorPositions[0].to;\n\n  const newQueryExpr = query.slice(0, streamSelectorEnd) + ` ${operator} \\`${value}\\`` + query.slice(streamSelectorEnd);\n  return newQueryExpr;\n}\n\nfunction getLineCommentPositions(query: string): NodePosition[] {\n  const tree = parser.parse(query);\n  const positions: NodePosition[] = [];\n  tree.iterate({\n    enter: ({ type, from, to }): false | void => {\n      if (type.id === LineComment) {\n        positions.push(new NodePosition(from, to, type));\n        return false;\n      }\n    },\n  });\n  return positions;\n}\n\n/**\n * Check if label exists in the list of labels but ignore the operator.\n * @param labels\n * @param filter\n */\nfunction labelExists(labels: QueryBuilderLabelFilter[], filter: QueryBuilderLabelFilter) {\n  return labels.find((label) => label.label === filter.label && label.value === filter.value);\n}\n\n/**\n * Return the last position based on \"to\" property\n * @param positions\n */\nexport function findLastPosition(positions: NodePosition[]): NodePosition {\n  if (!positions.length) {\n    return new NodePosition(0, 0);\n  }\n  return positions.reduce((prev, current) => (prev.to > current.to ? prev : current));\n}\n\n/**\n * Gets all leaves of the nodes given. Leaves are nodes that don't contain any other nodes.\n *\n * @param {NodePosition[]} nodes\n * @return\n */\nfunction findLeaves(nodes: NodePosition[]): NodePosition[] {\n  return nodes.filter((node) => nodes.every((n) => node.contains(n) === false || node === n));\n}\n\nfunction getAllPositionsInNodeByType(node: SyntaxNode, type: number): NodePosition[] {\n  if (node.type.id === type) {\n    return [NodePosition.fromNode(node)];\n  }\n\n  const positions: NodePosition[] = [];\n  let pos = 0;\n  let child = node.childAfter(pos);\n  while (child) {\n    positions.push(...getAllPositionsInNodeByType(child, type));\n    pos = child.to;\n    child = node.childAfter(pos);\n  }\n  return positions;\n}\n\nfunction getMatcherInStreamPositions(query: string): NodePosition[] {\n  const tree = parser.parse(query);\n  const positions: NodePosition[] = [];\n  tree.iterate({\n    enter: ({ node }): false | void => {\n      if (node.type.id === Selector) {\n        positions.push(...getAllPositionsInNodeByType(node, Matcher));\n      }\n    },\n  });\n  return positions;\n}\n\nexport function getIdentifierInStreamPositions(query: string): NodePosition[] {\n  const tree = parser.parse(query);\n  const positions: NodePosition[] = [];\n  tree.iterate({\n    enter: ({ node }): false | void => {\n      if (node.type.id === Selector) {\n        positions.push(...getAllPositionsInNodeByType(node, Identifier));\n      }\n    },\n  });\n  return positions;\n}\n","import { css } from '@emotion/css';\nimport { shuffle } from 'lodash';\nimport { PureComponent } from 'react';\n\nimport { GrafanaTheme2, QueryEditorHelpProps } from '@grafana/data';\nimport { reportInteraction } from '@grafana/runtime';\nimport { Themeable2, withTheme2 } from '@grafana/ui';\n\nimport LokiLanguageProvider from '../LanguageProvider';\nimport { escapeLabelValueInExactSelector } from '../languageUtils';\nimport { LokiQuery } from '../types';\n\nconst DEFAULT_EXAMPLES = ['{job=\"default/prometheus\"}'];\nconst PREFERRED_LABELS = ['job', 'app', 'k8s_app'];\nconst EXAMPLES_LIMIT = 5;\n\nconst LOGQL_EXAMPLES = [\n  {\n    title: 'Log pipeline',\n    expression: '{job=\"mysql\"} |= \"metrics\" | logfmt | duration > 10s',\n    label:\n      'This query targets the MySQL job, keeps logs that contain the substring \"metrics\", and then parses and filters the logs further.',\n  },\n  {\n    title: 'Count over time',\n    expression: 'count_over_time({job=\"mysql\"}[5m])',\n    label: 'This query counts all the log lines within the last five minutes for the MySQL job.',\n  },\n  {\n    title: 'Rate',\n    expression: 'rate(({job=\"mysql\"} |= \"error\" != \"timeout\")[10s])',\n    label:\n      'This query gets the per-second rate of all non-timeout errors within the last ten seconds for the MySQL job.',\n  },\n  {\n    title: 'Aggregate, count, and group',\n    expression: 'sum(count_over_time({job=\"mysql\"}[5m])) by (level)',\n    label: 'Get the count of logs during the last five minutes, grouping by level.',\n  },\n];\n\nclass UnthemedLokiCheatSheet extends PureComponent<\n  QueryEditorHelpProps<LokiQuery> & Themeable2,\n  { userExamples: string[] }\n> {\n  declare userLabelTimer: ReturnType<typeof setTimeout>;\n  state = {\n    userExamples: [],\n  };\n\n  componentDidMount() {\n    this.scheduleUserLabelChecking();\n    reportInteraction('grafana_loki_cheatsheet_opened', {});\n  }\n\n  componentWillUnmount() {\n    clearTimeout(this.userLabelTimer);\n  }\n\n  scheduleUserLabelChecking() {\n    this.userLabelTimer = setTimeout(this.checkUserLabels, 1000);\n  }\n\n  checkUserLabels = async () => {\n    // Set example from user labels\n    const provider: LokiLanguageProvider = this.props.datasource?.languageProvider;\n    if (provider.started) {\n      const labels = provider.getLabelKeys() || [];\n      const preferredLabel = PREFERRED_LABELS.find((l) => labels.includes(l));\n      if (preferredLabel) {\n        const values = await provider.fetchLabelValues(preferredLabel);\n        const userExamples = shuffle(values)\n          .slice(0, EXAMPLES_LIMIT)\n          .map((value) => `{${preferredLabel}=\"${escapeLabelValueInExactSelector(value)}\"}`);\n        this.setState({ userExamples });\n      }\n    } else {\n      this.scheduleUserLabelChecking();\n    }\n  };\n\n  renderExpression(expr: string) {\n    const { onClickExample, theme } = this.props;\n    const styles = getStyles(theme);\n    const onClick = (query: LokiQuery) => {\n      onClickExample(query);\n      reportInteraction('grafana_loki_cheatsheet_example_clicked', {});\n    };\n\n    return (\n      <button\n        type=\"button\"\n        className={styles.cheatSheetExample}\n        key={expr}\n        onClick={() => onClick({ refId: 'A', expr })}\n      >\n        <code>{expr}</code>\n      </button>\n    );\n  }\n\n  render() {\n    const { userExamples } = this.state;\n    const { theme } = this.props;\n    const hasUserExamples = userExamples.length > 0;\n    const styles = getStyles(theme);\n\n    return (\n      <div>\n        <h2>Loki Cheat Sheet</h2>\n        <div className={styles.cheatSheetItem}>\n          <div className={styles.cheatSheetItemTitle}>See your logs</div>\n          Start by selecting a log stream from the Label browser, or alternatively you can write a stream selector into\n          the query field.\n          {hasUserExamples ? (\n            <div>\n              Here are some example streams from your logs:\n              {userExamples.map((example) => this.renderExpression(example))}\n            </div>\n          ) : (\n            <div>\n              Here is an example of a log stream:\n              {this.renderExpression(DEFAULT_EXAMPLES[0])}\n            </div>\n          )}\n        </div>\n        <div className={styles.cheatSheetItem}>\n          <div className={styles.cheatSheetItemTitle}>Combine stream selectors</div>\n          {this.renderExpression('{app=\"cassandra\",namespace=\"prod\"}')}\n          Returns all log lines from streams that have both labels.\n        </div>\n\n        <div className={styles.cheatSheetItem}>\n          <div className={styles.cheatSheetItemTitle}>Filtering for search terms.</div>\n          {this.renderExpression('{app=\"cassandra\"} |~ \"(duration|latency)s*(=|is|of)s*[d.]+\"')}\n          {this.renderExpression('{app=\"cassandra\"} |= \"exact match\"')}\n          {this.renderExpression('{app=\"cassandra\"} != \"do not match\"')}\n          <a href=\"https://grafana.com/docs/loki/latest/logql/#log-pipeline\" target=\"logql\">\n            LogQL\n          </a>{' '}\n          supports exact and regular expression filters.\n        </div>\n        {LOGQL_EXAMPLES.map((item) => (\n          <div className={styles.cheatSheetItem} key={item.expression}>\n            <div className={styles.cheatSheetItemTitle}>{item.title}</div>\n            {this.renderExpression(item.expression)}\n            {item.label}\n          </div>\n        ))}\n      </div>\n    );\n  }\n}\n\nexport default withTheme2(UnthemedLokiCheatSheet);\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  cheatSheetItem: css({\n    margin: theme.spacing(3, 0),\n  }),\n  cheatSheetItemTitle: css({\n    fontSize: theme.typography.h3.fontSize,\n  }),\n  cheatSheetExample: css({\n    margin: theme.spacing(0.5, 0),\n    // element is interactive, clear button styles\n    textAlign: 'left',\n    border: 'none',\n    background: 'transparent',\n    display: 'block',\n  }),\n});\n","import { css } from '@emotion/css';\nimport { uniqueId } from 'lodash';\nimport React, { useRef } from 'react';\nimport { useStyles2, Switch } from '@grafana/ui';\nimport { Stack } from '../../QueryEditor/Stack.js';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nvar __objRest = (source, exclude) => {\n  var target = {};\n  for (var prop in source)\n    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)\n      target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(source)) {\n      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))\n        target[prop] = source[prop];\n    }\n  return target;\n};\nfunction QueryHeaderSwitch(_a) {\n  var _b = _a, { label } = _b, inputProps = __objRest(_b, [\"label\"]);\n  const dashedLabel = label.replace(\" \", \"-\");\n  const switchIdRef = useRef(uniqueId(`switch-${dashedLabel}`));\n  const styles = useStyles2(getStyles);\n  return /* @__PURE__ */ React.createElement(Stack, { gap: 1 }, /* @__PURE__ */ React.createElement(\"label\", { htmlFor: switchIdRef.current, className: styles.switchLabel }, label), /* @__PURE__ */ React.createElement(Switch, __spreadProps(__spreadValues({}, inputProps), { id: switchIdRef.current })));\n}\nconst getStyles = (theme) => {\n  return {\n    switchLabel: css({\n      color: theme.colors.text.secondary,\n      cursor: \"pointer\",\n      fontSize: theme.typography.bodySmall.fontSize,\n      \"&:hover\": {\n        color: theme.colors.text.primary\n      }\n    })\n  };\n};\n\nexport { QueryHeaderSwitch };\n//# sourceMappingURL=QueryHeaderSwitch.js.map\n","import React from 'react';\nimport { RadioButtonGroup } from '@grafana/ui';\nimport { QueryEditorMode } from '../types.js';\n\nconst editorModes = [\n  { label: \"Builder\", value: QueryEditorMode.Builder },\n  { label: \"Code\", value: QueryEditorMode.Code }\n];\nfunction QueryEditorModeToggle({ mode, onChange }) {\n  return /* @__PURE__ */ React.createElement(\"div\", { \"data-testid\": \"QueryEditorModeToggle\" }, /* @__PURE__ */ React.createElement(RadioButtonGroup, { options: editorModes, size: \"sm\", value: mode, onChange }));\n}\n\nexport { QueryEditorModeToggle };\n//# sourceMappingURL=QueryEditorModeToggle.js.map\n","import { css, cx } from '@emotion/css';\nimport { sortBy } from 'lodash';\nimport { ChangeEvent } from 'react';\nimport * as React from 'react';\nimport { FixedSizeList } from 'react-window';\n\nimport { CoreApp, GrafanaTheme2, TimeRange } from '@grafana/data';\nimport { reportInteraction } from '@grafana/runtime';\nimport {\n  Button,\n  HighlightPart,\n  Input,\n  Label,\n  LoadingPlaceholder,\n  withTheme2,\n  BrowserLabel as LokiLabel,\n  fuzzyMatch,\n  Stack,\n} from '@grafana/ui';\n\nimport LokiLanguageProvider from '../LanguageProvider';\nimport { escapeLabelValueInExactSelector, escapeLabelValueInRegexSelector } from '../languageUtils';\n\n// Hard limit on labels to render\nconst MAX_LABEL_COUNT = 1000;\nconst MAX_VALUE_COUNT = 10000;\nconst MAX_AUTO_SELECT = 4;\nconst EMPTY_SELECTOR = '{}';\n\nexport interface BrowserProps {\n  languageProvider: LokiLanguageProvider;\n  onChange: (selector: string) => void;\n  theme: GrafanaTheme2;\n  app?: CoreApp;\n  autoSelect?: number;\n  timeRange?: TimeRange;\n  hide?: () => void;\n  lastUsedLabels: string[];\n  storeLastUsedLabels: (labels: string[]) => void;\n  deleteLastUsedLabels: () => void;\n}\n\ninterface BrowserState {\n  labels: SelectableLabel[];\n  searchTerm: string;\n  status: string;\n  error: string;\n  validationStatus: string;\n}\n\ninterface FacettableValue {\n  name: string;\n  selected?: boolean;\n  highlightParts?: HighlightPart[];\n  order?: number;\n}\n\nexport interface SelectableLabel {\n  name: string;\n  selected?: boolean;\n  loading?: boolean;\n  values?: FacettableValue[];\n  hidden?: boolean;\n  facets?: number;\n}\n\nexport function buildSelector(labels: SelectableLabel[]): string {\n  const selectedLabels = [];\n  for (const label of labels) {\n    if (label.selected && label.values && label.values.length > 0) {\n      const selectedValues = label.values.filter((value) => value.selected).map((value) => value.name);\n      if (selectedValues.length > 1) {\n        selectedLabels.push(`${label.name}=~\"${selectedValues.map(escapeLabelValueInRegexSelector).join('|')}\"`);\n      } else if (selectedValues.length === 1) {\n        selectedLabels.push(`${label.name}=\"${escapeLabelValueInExactSelector(selectedValues[0])}\"`);\n      }\n    }\n  }\n  return ['{', selectedLabels.join(','), '}'].join('');\n}\n\nexport function facetLabels(\n  labels: SelectableLabel[],\n  possibleLabels: Record<string, string[]>,\n  lastFacetted?: string\n): SelectableLabel[] {\n  return labels.map((label) => {\n    const possibleValues = possibleLabels[label.name];\n    if (possibleValues) {\n      let existingValues: FacettableValue[];\n      if (label.name === lastFacetted && label.values) {\n        // Facetting this label, show all values\n        existingValues = label.values;\n      } else {\n        // Keep selection in other facets\n        const selectedValues: Set<string> = new Set(\n          label.values?.filter((value) => value.selected).map((value) => value.name) || []\n        );\n        // Values for this label have not been requested yet, let's use the facetted ones as the initial values\n        existingValues = possibleValues.map((value) => ({ name: value, selected: selectedValues.has(value) }));\n      }\n      return { ...label, loading: false, values: existingValues, facets: existingValues.length };\n    }\n\n    // Label is facetted out, hide all values\n    return { ...label, loading: false, hidden: !possibleValues, values: undefined, facets: 0 };\n  });\n}\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  wrapper: css`\n    background-color: ${theme.colors.background.secondary};\n    width: 100%;\n  `,\n  wrapperPadding: css`\n    padding: ${theme.spacing(2)};\n  `,\n  list: css`\n    margin-top: ${theme.spacing(1)};\n    display: flex;\n    flex-wrap: wrap;\n    max-height: 200px;\n    overflow: auto;\n  `,\n  section: css`\n    & + & {\n      margin: ${theme.spacing(2, 0)};\n    }\n\n    position: relative;\n  `,\n  footerSectionStyles: css`\n    padding: ${theme.spacing(1)};\n    background-color: ${theme.colors.background.primary};\n    position: sticky;\n    bottom: -${theme.spacing(3)}; /* offset the padding on modal */\n    left: 0;\n  `,\n  selector: css`\n    font-family: ${theme.typography.fontFamilyMonospace};\n    margin-bottom: ${theme.spacing(1)};\n    width: 100%;\n  `,\n  status: css`\n    margin-bottom: ${theme.spacing(1)};\n    color: ${theme.colors.text.secondary};\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    transition: opacity 100ms linear;\n    opacity: 0;\n    font-size: ${theme.typography.bodySmall.fontSize};\n    height: calc(${theme.typography.bodySmall.fontSize} + 10px);\n  `,\n  statusShowing: css`\n    opacity: 1;\n  `,\n  error: css`\n    color: ${theme.colors.error.main};\n  `,\n  valueList: css`\n    margin-right: ${theme.spacing(1)};\n    resize: horizontal;\n  `,\n  valueListWrapper: css`\n    border-left: 1px solid ${theme.colors.border.medium};\n    margin: ${theme.spacing(1, 0)};\n    padding: ${theme.spacing(1, 0, 1, 1)};\n  `,\n  valueListArea: css`\n    display: flex;\n    flex-wrap: wrap;\n    margin-top: ${theme.spacing(1)};\n  `,\n  valueTitle: css`\n    margin-left: -${theme.spacing(0.5)};\n    margin-bottom: ${theme.spacing(1)};\n  `,\n  validationStatus: css`\n    padding: ${theme.spacing(0.5)};\n    margin-bottom: ${theme.spacing(1)};\n    color: ${theme.colors.text.maxContrast};\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  `,\n});\n\nexport class UnthemedLokiLabelBrowser extends React.Component<BrowserProps, BrowserState> {\n  state: BrowserState = {\n    labels: [],\n    searchTerm: '',\n    status: 'Ready',\n    error: '',\n    validationStatus: '',\n  };\n\n  onChangeSearch = (event: ChangeEvent<HTMLInputElement>) => {\n    this.setState({ searchTerm: event.target.value });\n  };\n\n  onClickRunLogsQuery = () => {\n    reportInteraction('grafana_loki_label_browser_closed', {\n      app: this.props.app,\n      closeType: 'showLogsButton',\n    });\n    const selector = buildSelector(this.state.labels);\n    this.props.onChange(selector);\n  };\n\n  onClickRunMetricsQuery = () => {\n    reportInteraction('grafana_loki_label_browser_closed', {\n      app: this.props.app,\n      closeType: 'showLogsRateButton',\n    });\n    const selector = buildSelector(this.state.labels);\n    const query = `rate(${selector}[$__auto])`;\n    this.props.onChange(query);\n  };\n\n  onClickClear = () => {\n    this.setState((state) => {\n      const labels: SelectableLabel[] = state.labels.map((label) => ({\n        ...label,\n        values: undefined,\n        selected: false,\n        loading: false,\n        hidden: false,\n        facets: undefined,\n      }));\n      return { labels, searchTerm: '', status: '', error: '', validationStatus: '' };\n    });\n    this.props.deleteLastUsedLabels();\n  };\n\n  onClickLabel = (name: string, value: string | undefined, event: React.MouseEvent<HTMLElement>) => {\n    const label = this.state.labels.find((l) => l.name === name);\n    if (!label) {\n      return;\n    }\n    // Toggle selected state\n    const selected = !label.selected;\n    let nextValue: Partial<SelectableLabel> = { selected };\n    if (label.values && !selected) {\n      // Deselect all values if label was deselected\n      const values = label.values.map((value) => ({ ...value, selected: false }));\n      nextValue = { ...nextValue, facets: 0, values };\n    }\n    // Resetting search to prevent empty results\n    this.setState({ searchTerm: '' });\n    this.updateLabelState(name, nextValue, '', () => this.doFacettingForLabel(name));\n  };\n\n  onClickValue = (name: string, value: string | undefined, event: React.MouseEvent<HTMLElement>) => {\n    const label = this.state.labels.find((l) => l.name === name);\n    if (!label || !label.values) {\n      return;\n    }\n    // Resetting search to prevent empty results\n    this.setState({ searchTerm: '' });\n    // Toggling value for selected label, leaving other values intact\n    const values = label.values.map((v) => ({ ...v, selected: v.name === value ? !v.selected : v.selected }));\n    this.updateLabelState(name, { values }, '', () => this.doFacetting(name));\n  };\n\n  onClickValidate = () => {\n    const selector = buildSelector(this.state.labels);\n    this.validateSelector(selector);\n  };\n\n  updateLabelState(name: string, updatedFields: Partial<SelectableLabel>, status = '', cb?: () => void) {\n    this.setState((state) => {\n      const labels: SelectableLabel[] = state.labels.map((label) => {\n        if (label.name === name) {\n          return { ...label, ...updatedFields };\n        }\n        return label;\n      });\n      // New status overrides errors\n      const error = status ? '' : state.error;\n      return { labels, status, error, validationStatus: '' };\n    }, cb);\n  }\n\n  componentDidMount() {\n    const { languageProvider, autoSelect = MAX_AUTO_SELECT, lastUsedLabels, timeRange } = this.props;\n    if (languageProvider) {\n      const selectedLabels: string[] = lastUsedLabels;\n      languageProvider.start(timeRange).then(() => {\n        let rawLabels: string[] = languageProvider.getLabelKeys();\n        if (rawLabels.length > MAX_LABEL_COUNT) {\n          const error = `Too many labels found (showing only ${MAX_LABEL_COUNT} of ${rawLabels.length})`;\n          rawLabels = rawLabels.slice(0, MAX_LABEL_COUNT);\n          this.setState({ error });\n        }\n        // Auto-select all labels if label list is small enough\n        const labels: SelectableLabel[] = rawLabels.map((label, i, arr) => ({\n          name: label,\n          selected: (arr.length <= autoSelect && selectedLabels.length === 0) || selectedLabels.includes(label),\n          loading: false,\n        }));\n        // Pre-fetch values for selected labels\n        this.setState({ labels }, () => {\n          this.state.labels.forEach((label) => {\n            if (label.selected) {\n              this.fetchValues(label.name, EMPTY_SELECTOR);\n            }\n          });\n        });\n      });\n    }\n  }\n\n  doFacettingForLabel(name: string) {\n    const label = this.state.labels.find((l) => l.name === name);\n    if (!label) {\n      return;\n    }\n    const selectedLabels = this.state.labels.filter((label) => label.selected).map((label) => label.name);\n    this.props.storeLastUsedLabels(selectedLabels);\n    if (label.selected) {\n      // Refetch values for newly selected label...\n      if (!label.values) {\n        this.fetchValues(name, buildSelector(this.state.labels));\n      }\n    } else {\n      // Only need to facet when deselecting labels\n      this.doFacetting();\n    }\n  }\n\n  doFacetting = (lastFacetted?: string) => {\n    const selector = buildSelector(this.state.labels);\n    if (selector === EMPTY_SELECTOR) {\n      // Clear up facetting\n      const labels: SelectableLabel[] = this.state.labels.map((label) => {\n        return { ...label, facets: 0, values: undefined, hidden: false };\n      });\n      this.setState({ labels }, () => {\n        // Get fresh set of values\n        this.state.labels.forEach((label) => label.selected && this.fetchValues(label.name, selector));\n      });\n    } else {\n      // Do facetting\n      this.fetchSeries(selector, lastFacetted);\n    }\n  };\n\n  async fetchValues(name: string, selector: string) {\n    const { languageProvider, timeRange } = this.props;\n    this.updateLabelState(name, { loading: true }, `Fetching values for ${name}`);\n    try {\n      let rawValues = await languageProvider.fetchLabelValues(name, { timeRange });\n      // If selector changed, clear loading state and discard result by returning early\n      if (selector !== buildSelector(this.state.labels)) {\n        this.updateLabelState(name, { loading: false }, '');\n        return;\n      }\n      if (rawValues.length > MAX_VALUE_COUNT) {\n        const error = `Too many values for ${name} (showing only ${MAX_VALUE_COUNT} of ${rawValues.length})`;\n        rawValues = rawValues.slice(0, MAX_VALUE_COUNT);\n        this.setState({ error });\n      }\n      const values: FacettableValue[] = rawValues.map((value) => ({ name: value }));\n      this.updateLabelState(name, { values, loading: false });\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  async fetchSeries(selector: string, lastFacetted?: string) {\n    const { languageProvider, timeRange } = this.props;\n    if (lastFacetted) {\n      this.updateLabelState(lastFacetted, { loading: true }, `Loading labels for ${selector}`);\n    }\n    try {\n      const possibleLabels = await languageProvider.fetchSeriesLabels(selector, { timeRange });\n      // If selector changed, clear loading state and discard result by returning early\n      if (selector !== buildSelector(this.state.labels)) {\n        if (lastFacetted) {\n          this.updateLabelState(lastFacetted, { loading: false });\n        }\n        return;\n      }\n      if (Object.keys(possibleLabels).length === 0) {\n        this.setState({ error: `Empty results, no matching label for ${selector}` });\n        return;\n      }\n      const labels: SelectableLabel[] = facetLabels(this.state.labels, possibleLabels, lastFacetted);\n      this.setState({ labels, error: '' });\n      if (lastFacetted) {\n        this.updateLabelState(lastFacetted, { loading: false });\n      }\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  async validateSelector(selector: string) {\n    const { languageProvider, timeRange } = this.props;\n    this.setState({ validationStatus: `Validating selector ${selector}`, error: '' });\n    const streams = await languageProvider.fetchSeries(selector, { timeRange });\n    this.setState({ validationStatus: `Selector is valid (${streams.length} streams found)` });\n  }\n\n  render() {\n    const { theme } = this.props;\n    const { labels, searchTerm, status, error, validationStatus } = this.state;\n    if (labels.length === 0) {\n      return <LoadingPlaceholder text=\"Loading labels...\" />;\n    }\n    const styles = getStyles(theme);\n    const selector = buildSelector(this.state.labels);\n    const empty = selector === EMPTY_SELECTOR;\n\n    let selectedLabels = labels.filter((label) => label.selected && label.values);\n    if (searchTerm) {\n      selectedLabels = selectedLabels.map((label) => {\n        const searchResults = label.values!.filter((value) => {\n          // Always return selected values\n          if (value.selected) {\n            value.highlightParts = undefined;\n            return true;\n          }\n          const fuzzyMatchResult = fuzzyMatch(value.name.toLowerCase(), searchTerm.toLowerCase());\n          if (fuzzyMatchResult.found) {\n            value.highlightParts = fuzzyMatchResult.ranges;\n            value.order = fuzzyMatchResult.distance;\n            return true;\n          } else {\n            return false;\n          }\n        });\n        return {\n          ...label,\n          values: sortBy(searchResults, (value) => (value.selected ? -Infinity : value.order)),\n        };\n      });\n    } else {\n      // Clear highlight parts when searchTerm is cleared\n      selectedLabels = this.state.labels\n        .filter((label) => label.selected && label.values)\n        .map((label) => ({\n          ...label,\n          values: label?.values ? label.values.map((value) => ({ ...value, highlightParts: undefined })) : [],\n        }));\n    }\n\n    return (\n      <>\n        <div className={styles.wrapper}>\n          <div className={cx(styles.section, styles.wrapperPadding)}>\n            <Label description=\"Which labels would you like to consider for your search?\">\n              1. Select labels to search in\n            </Label>\n            <div className={styles.list}>\n              {labels.map((label) => (\n                <LokiLabel\n                  key={label.name}\n                  name={label.name}\n                  loading={label.loading}\n                  active={label.selected}\n                  hidden={label.hidden}\n                  facets={label.facets}\n                  onClick={this.onClickLabel}\n                />\n              ))}\n            </div>\n          </div>\n          <div className={cx(styles.section, styles.wrapperPadding)}>\n            <Label description=\"Choose the label values that you would like to use for the query. Use the search field to find values across selected labels.\">\n              2. Find values for the selected labels\n            </Label>\n            <div>\n              <Input\n                onChange={this.onChangeSearch}\n                aria-label=\"Filter expression for values\"\n                value={searchTerm}\n                placeholder={'Enter a label value'}\n              />\n            </div>\n            <div className={styles.valueListArea}>\n              {selectedLabels.map((label) => (\n                <div role=\"list\" key={label.name} className={styles.valueListWrapper}>\n                  <div className={styles.valueTitle} aria-label={`Values for ${label.name}`}>\n                    <LokiLabel\n                      name={label.name}\n                      loading={label.loading}\n                      active={label.selected}\n                      hidden={label.hidden}\n                      //If no facets, we want to show number of all label values\n                      facets={label.facets || label.values?.length}\n                      onClick={this.onClickLabel}\n                    />\n                  </div>\n                  <FixedSizeList\n                    height={200}\n                    itemCount={label.values?.length || 0}\n                    itemSize={28}\n                    itemKey={(i) => label.values?.[i].name ?? i}\n                    width={200}\n                    className={styles.valueList}\n                  >\n                    {({ index, style }) => {\n                      const value = label.values?.[index];\n                      if (!value) {\n                        return null;\n                      }\n                      return (\n                        <div style={style}>\n                          <LokiLabel\n                            name={label.name}\n                            value={value?.name}\n                            active={value?.selected}\n                            highlightParts={value?.highlightParts}\n                            onClick={this.onClickValue}\n                            searchTerm={searchTerm}\n                          />\n                        </div>\n                      );\n                    }}\n                  </FixedSizeList>\n                </div>\n              ))}\n            </div>\n          </div>\n        </div>\n        <div className={styles.footerSectionStyles}>\n          <Label>3. Resulting selector</Label>\n          <pre aria-label=\"selector\" className={styles.selector}>\n            {selector}\n          </pre>\n          {validationStatus && <div className={styles.validationStatus}>{validationStatus}</div>}\n          <div className={cx(styles.status, (status || error) && styles.statusShowing)}>\n            <span className={error ? styles.error : ''}>{error || status}</span>\n          </div>\n          <Stack gap={1}>\n            <Button aria-label=\"Use selector as logs button\" disabled={empty} onClick={this.onClickRunLogsQuery}>\n              Show logs\n            </Button>\n            <Button\n              aria-label=\"Use selector as metrics button\"\n              variant=\"secondary\"\n              disabled={empty}\n              onClick={this.onClickRunMetricsQuery}\n            >\n              Show logs rate\n            </Button>\n            <Button\n              aria-label=\"Validate submit button\"\n              variant=\"secondary\"\n              disabled={empty}\n              onClick={this.onClickValidate}\n            >\n              Validate selector\n            </Button>\n            <Button aria-label=\"Selector clear button\" variant=\"secondary\" onClick={this.onClickClear}>\n              Clear\n            </Button>\n          </Stack>\n        </div>\n      </>\n    );\n  }\n}\n\nexport const LokiLabelBrowser = withTheme2(UnthemedLokiLabelBrowser);\n","import { css } from '@emotion/css';\nimport { useState, useEffect } from 'react';\n\nimport { CoreApp, GrafanaTheme2, LocalStorageValueProvider, TimeRange } from '@grafana/data';\nimport { reportInteraction } from '@grafana/runtime';\nimport { LoadingPlaceholder, Modal, useStyles2 } from '@grafana/ui';\n\nimport { LokiLabelBrowser } from '../../components/LokiLabelBrowser';\nimport { LokiDatasource } from '../../datasource';\nimport { LokiQuery } from '../../types';\n\nexport interface Props {\n  isOpen: boolean;\n  datasource: LokiDatasource;\n  query: LokiQuery;\n  app?: CoreApp;\n  timeRange?: TimeRange;\n  onClose: () => void;\n  onChange: (query: LokiQuery) => void;\n  onRunQuery: () => void;\n}\n\nexport const LabelBrowserModal = (props: Props) => {\n  const { isOpen, onClose, datasource, app, timeRange } = props;\n  const [labelsLoaded, setLabelsLoaded] = useState(false);\n  const [hasLogLabels, setHasLogLabels] = useState(false);\n  const LAST_USED_LABELS_KEY = 'grafana.datasources.loki.browser.labels';\n\n  const styles = useStyles2(getStyles);\n\n  useEffect(() => {\n    if (!isOpen) {\n      return;\n    }\n\n    datasource.languageProvider.fetchLabels({ timeRange }).then((labels) => {\n      setLabelsLoaded(true);\n      setHasLogLabels(labels.length > 0);\n    });\n  }, [datasource, isOpen, timeRange]);\n\n  const changeQuery = (value: string) => {\n    const { query, onChange, onRunQuery } = props;\n    const nextQuery = { ...query, expr: value };\n    onChange(nextQuery);\n    onRunQuery();\n  };\n\n  const onChange = (selector: string) => {\n    changeQuery(selector);\n    onClose();\n  };\n\n  const reportInteractionAndClose = () => {\n    reportInteraction('grafana_loki_label_browser_closed', {\n      app,\n      closeType: 'modalClose',\n    });\n    onClose();\n  };\n\n  return (\n    <Modal isOpen={isOpen} title=\"Label browser\" onDismiss={reportInteractionAndClose} className={styles.modal}>\n      {!labelsLoaded && <LoadingPlaceholder text=\"Loading labels...\" />}\n      {labelsLoaded && !hasLogLabels && <p>No labels found.</p>}\n      {labelsLoaded && hasLogLabels && (\n        <LocalStorageValueProvider<string[]> storageKey={LAST_USED_LABELS_KEY} defaultValue={[]}>\n          {(lastUsedLabels, onLastUsedLabelsSave, onLastUsedLabelsDelete) => {\n            return (\n              <LokiLabelBrowser\n                languageProvider={datasource.languageProvider}\n                onChange={onChange}\n                lastUsedLabels={lastUsedLabels}\n                storeLastUsedLabels={onLastUsedLabelsSave}\n                deleteLastUsedLabels={onLastUsedLabelsDelete}\n                app={app}\n                timeRange={timeRange}\n              />\n            );\n          }}\n        </LocalStorageValueProvider>\n      )}\n    </Modal>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    modal: css`\n      width: 85vw;\n      ${theme.breakpoints.down('md')} {\n        width: 100%;\n      }\n    `,\n  };\n};\n","import { uniqBy } from 'lodash';\nimport React, { useState, useRef } from 'react';\nimport { v4 } from 'uuid';\nimport { toOption } from '@grafana/data';\nimport { selectors } from '@grafana/e2e-selectors';\nimport { InlineField, Select } from '@grafana/ui';\nimport { InputGroup } from '../../QueryEditor/InputGroup.js';\nimport { AccessoryButton } from '../../QueryEditor/AccessoryButton.js';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nconst CONFLICTING_LABEL_FILTER_ERROR_MESSAGE = \"You have conflicting label filters\";\nfunction LabelFilterItem({\n  item,\n  items,\n  defaultOp,\n  onChange,\n  onDelete,\n  onGetLabelNames,\n  onGetLabelValues,\n  invalidLabel,\n  invalidValue,\n  multiValueSeparator = \"|\"\n}) {\n  var _a;\n  const [state, setState] = useState({});\n  const [labelNamesMenuOpen, setLabelNamesMenuOpen] = useState(false);\n  const [labelValuesMenuOpen, setLabelValuesMenuOpen] = useState(false);\n  const isMultiSelect = (operator = item.op) => {\n    var _a2;\n    return (_a2 = operators.find((op) => op.label === operator)) == null ? void 0 : _a2.isMultiValue;\n  };\n  const getSelectOptionsFromString = (item2) => {\n    if (item2) {\n      if (item2.indexOf(multiValueSeparator) > 0) {\n        return item2.split(multiValueSeparator);\n      }\n      return [item2];\n    }\n    return [];\n  };\n  const getOptions = () => {\n    const labelValues = state.labelValues ? [...state.labelValues] : [];\n    const selectedOptions = getSelectOptionsFromString(item == null ? void 0 : item.value).map(toOption);\n    return uniqBy([...selectedOptions, ...labelValues], \"value\");\n  };\n  const isConflicting = isConflictingLabelFilter(item, items);\n  const { current: id } = useRef(v4());\n  return /* @__PURE__ */ React.createElement(\"div\", { \"data-testid\": \"visual-query-builder-dimensions-filter-item\" }, /* @__PURE__ */ React.createElement(InlineField, { error: CONFLICTING_LABEL_FILTER_ERROR_MESSAGE, invalid: isConflicting ? true : void 0 }, /* @__PURE__ */ React.createElement(InputGroup, null, /* @__PURE__ */ React.createElement(\n    Select,\n    {\n      placeholder: \"Select label\",\n      \"data-testid\": selectors.components.QueryBuilder.labelSelect,\n      inputId: `visual-query-builder-dimensions-filter-item-key-${id}`,\n      width: \"auto\",\n      value: item.label ? toOption(item.label) : null,\n      allowCustomValue: true,\n      onOpenMenu: async () => {\n        setState({ isLoadingLabelNames: true });\n        const labelNames = await onGetLabelNames(item);\n        setLabelNamesMenuOpen(true);\n        setState({ labelNames, isLoadingLabelNames: void 0 });\n      },\n      onCloseMenu: () => {\n        setLabelNamesMenuOpen(false);\n      },\n      isOpen: labelNamesMenuOpen,\n      isLoading: state.isLoadingLabelNames,\n      options: state.labelNames,\n      onChange: (change) => {\n        var _a2;\n        if (change.value) {\n          onChange(__spreadProps(__spreadValues({}, item), {\n            op: (_a2 = item.op) != null ? _a2 : defaultOp,\n            label: change.value\n          }));\n        }\n      },\n      invalid: isConflicting || invalidLabel\n    }\n  ), /* @__PURE__ */ React.createElement(\n    Select,\n    {\n      \"data-testid\": selectors.components.QueryBuilder.matchOperatorSelect,\n      value: toOption((_a = item.op) != null ? _a : defaultOp),\n      options: operators,\n      width: \"auto\",\n      onChange: (change) => {\n        if (change.value) {\n          onChange(__spreadProps(__spreadValues({}, item), {\n            op: change.value,\n            value: isMultiSelect(change.value) ? item.value : getSelectOptionsFromString(item == null ? void 0 : item.value)[0]\n          }));\n        }\n      },\n      invalid: isConflicting\n    }\n  ), /* @__PURE__ */ React.createElement(\n    Select,\n    {\n      placeholder: \"Select value\",\n      \"data-testid\": selectors.components.QueryBuilder.valueSelect,\n      inputId: `visual-query-builder-dimensions-filter-item-value-${id}`,\n      width: \"auto\",\n      value: isMultiSelect() ? getSelectOptionsFromString(item == null ? void 0 : item.value).map(toOption) : getSelectOptionsFromString(item == null ? void 0 : item.value).map(toOption)[0],\n      allowCustomValue: true,\n      onOpenMenu: async () => {\n        setState({ isLoadingLabelValues: true });\n        const labelValues = await onGetLabelValues(item);\n        setState(__spreadProps(__spreadValues({}, state), {\n          labelValues,\n          isLoadingLabelValues: void 0\n        }));\n        setLabelValuesMenuOpen(true);\n      },\n      onCloseMenu: () => {\n        setLabelValuesMenuOpen(false);\n      },\n      isOpen: labelValuesMenuOpen,\n      isMulti: isMultiSelect(),\n      isLoading: state.isLoadingLabelValues,\n      options: getOptions(),\n      onChange: (change) => {\n        var _a2, _b;\n        if (change.value) {\n          onChange(__spreadProps(__spreadValues({}, item), {\n            value: change.value,\n            op: (_a2 = item.op) != null ? _a2 : defaultOp\n          }));\n        } else {\n          const changes = change.map((change2) => {\n            if (change2.value) {\n              return change2.value;\n            } else {\n              return void 0;\n            }\n          }).filter((val) => val !== void 0).join(multiValueSeparator);\n          onChange(__spreadProps(__spreadValues({}, item), { value: changes, op: (_b = item.op) != null ? _b : defaultOp }));\n        }\n      },\n      invalid: isConflicting || invalidValue\n    }\n  ), /* @__PURE__ */ React.createElement(AccessoryButton, { \"aria-label\": \"remove\", icon: \"times\", variant: \"secondary\", onClick: onDelete }))));\n}\nconst operators = [\n  { label: \"=\", value: \"=\", description: \"Equals\", isMultiValue: false },\n  { label: \"!=\", value: \"!=\", description: \"Does not equal\", isMultiValue: false },\n  { label: \"=~\", value: \"=~\", description: \"Matches regex\", isMultiValue: true },\n  { label: \"!~\", value: \"!~\", description: \"Does not match regex\", isMultiValue: true }\n];\nfunction isConflictingLabelFilter(newLabel, labels) {\n  if (!newLabel.label || !newLabel.op || !newLabel.value) {\n    return false;\n  }\n  if (labels.length < 2) {\n    return false;\n  }\n  const operationIsNegative = newLabel.op.toString().startsWith(\"!\");\n  const candidates = labels.filter(\n    (label) => label.label === newLabel.label && label.value === newLabel.value && label.op !== newLabel.op\n  );\n  const conflict = candidates.some((candidate) => {\n    var _a, _b;\n    if (operationIsNegative && ((_a = candidate == null ? void 0 : candidate.op) == null ? void 0 : _a.toString().startsWith(\"!\")) === false) {\n      return true;\n    }\n    if (operationIsNegative === false && ((_b = candidate == null ? void 0 : candidate.op) == null ? void 0 : _b.toString().startsWith(\"!\"))) {\n      return true;\n    }\n    return false;\n  });\n  return conflict;\n}\n\nexport { LabelFilterItem, isConflictingLabelFilter };\n//# sourceMappingURL=LabelFilterItem.js.map\n","import { isEqual } from 'lodash';\nimport React, { useState, useEffect } from 'react';\nimport { EditorField } from '../../QueryEditor/EditorField.js';\nimport { EditorFieldGroup } from '../../QueryEditor/EditorFieldGroup.js';\nimport { EditorList } from '../../QueryEditor/EditorList.js';\nimport { LabelFilterItem } from './LabelFilterItem.js';\n\nconst MISSING_LABEL_FILTER_ERROR_MESSAGE = \"Select at least 1 label filter (label and value)\";\nfunction LabelFilters({\n  labelsFilters,\n  onChange,\n  onGetLabelNames,\n  onGetLabelValues,\n  labelFilterRequired,\n  multiValueSeparator\n}) {\n  const defaultOp = \"=\";\n  const [items, setItems] = useState([{ op: defaultOp }]);\n  useEffect(() => {\n    if (labelsFilters.length > 0) {\n      setItems(labelsFilters);\n    } else {\n      setItems([{ op: defaultOp }]);\n    }\n  }, [labelsFilters]);\n  const onLabelsChange = (newItems) => {\n    setItems(newItems);\n    const newLabels = newItems.filter((item) => item.label !== void 0 && item.value !== void 0);\n    if (!isEqual(newLabels, labelsFilters)) {\n      onChange(newLabels);\n    }\n  };\n  const hasLabelFilter = items.some((item) => item.label && item.value);\n  return /* @__PURE__ */ React.createElement(EditorFieldGroup, null, /* @__PURE__ */ React.createElement(\n    EditorField,\n    {\n      label: \"Label filters\",\n      error: MISSING_LABEL_FILTER_ERROR_MESSAGE,\n      invalid: labelFilterRequired && !hasLabelFilter\n    },\n    /* @__PURE__ */ React.createElement(\n      EditorList,\n      {\n        items,\n        onChange: onLabelsChange,\n        renderItem: (item, onChangeItem, onDelete) => /* @__PURE__ */ React.createElement(\n          LabelFilterItem,\n          {\n            item,\n            items,\n            defaultOp,\n            onChange: onChangeItem,\n            onDelete,\n            onGetLabelNames,\n            onGetLabelValues,\n            invalidLabel: labelFilterRequired && !item.label,\n            invalidValue: labelFilterRequired && !item.value,\n            multiValueSeparator\n          }\n        )\n      }\n    )\n  ));\n}\n\nexport { LabelFilters, MISSING_LABEL_FILTER_ERROR_MESSAGE };\n//# sourceMappingURL=LabelFilters.js.map\n","import { css } from '@emotion/css';\nimport React from 'react';\nimport { renderMarkdown } from '@grafana/data';\nimport { useStyles2 } from '@grafana/ui';\n\nfunction OperationExplainedBox({ title, stepNumber, markdown, children }) {\n  const styles = useStyles2(getStyles);\n  return /* @__PURE__ */ React.createElement(\"div\", { className: styles.box }, stepNumber !== void 0 && /* @__PURE__ */ React.createElement(\"div\", { className: styles.stepNumber }, stepNumber), /* @__PURE__ */ React.createElement(\"div\", { className: styles.boxInner }, title && /* @__PURE__ */ React.createElement(\"div\", { className: styles.header }, /* @__PURE__ */ React.createElement(\"span\", null, title)), /* @__PURE__ */ React.createElement(\"div\", { className: styles.body }, markdown && /* @__PURE__ */ React.createElement(\"div\", { dangerouslySetInnerHTML: { __html: renderMarkdown(markdown) } }), children)));\n}\nconst getStyles = (theme) => {\n  return {\n    box: css({\n      background: theme.colors.background.secondary,\n      padding: theme.spacing(1),\n      borderRadius: theme.shape.radius.default,\n      position: \"relative\"\n    }),\n    boxInner: css({\n      marginLeft: theme.spacing(4)\n    }),\n    stepNumber: css({\n      fontWeight: theme.typography.fontWeightMedium,\n      background: theme.colors.secondary.main,\n      width: \"20px\",\n      height: \"20px\",\n      borderRadius: theme.shape.radius.circle,\n      display: \"flex\",\n      alignItems: \"center\",\n      justifyContent: \"center\",\n      position: \"absolute\",\n      top: \"10px\",\n      left: \"11px\",\n      fontSize: theme.typography.bodySmall.fontSize\n    }),\n    header: css({\n      paddingBottom: theme.spacing(0.5),\n      display: \"flex\",\n      alignItems: \"center\",\n      fontFamily: theme.typography.fontFamilyMonospace\n    }),\n    body: css({\n      color: theme.colors.text.secondary,\n      \"p:last-child\": {\n        margin: 0\n      },\n      a: {\n        color: theme.colors.text.link,\n        textDecoration: \"underline\"\n      }\n    })\n  };\n};\n\nexport { OperationExplainedBox };\n//# sourceMappingURL=OperationExplainedBox.js.map\n","import React from 'react';\nexport var ReactReduxContext = /*#__PURE__*/React.createContext(null);\n\nif (process.env.NODE_ENV !== 'production') {\n  ReactReduxContext.displayName = 'ReactRedux';\n}\n\nexport default ReactReduxContext;","// Default to a dummy \"batch\" implementation that just runs the callback\nfunction defaultNoopBatch(callback) {\n  callback();\n}\n\nvar batch = defaultNoopBatch; // Allow injecting another batching function later\n\nexport var setBatch = function setBatch(newBatch) {\n  return batch = newBatch;\n}; // Supply a getter just to skip dealing with ESM bindings\n\nexport var getBatch = function getBatch() {\n  return batch;\n};","import { getBatch } from './batch'; // encapsulates the subscription logic for connecting a component to the redux store, as\n// well as nesting subscriptions of descendant components, so that we can ensure the\n// ancestor components re-render before descendants\n\nfunction createListenerCollection() {\n  var batch = getBatch();\n  var first = null;\n  var last = null;\n  return {\n    clear: function clear() {\n      first = null;\n      last = null;\n    },\n    notify: function notify() {\n      batch(function () {\n        var listener = first;\n\n        while (listener) {\n          listener.callback();\n          listener = listener.next;\n        }\n      });\n    },\n    get: function get() {\n      var listeners = [];\n      var listener = first;\n\n      while (listener) {\n        listeners.push(listener);\n        listener = listener.next;\n      }\n\n      return listeners;\n    },\n    subscribe: function subscribe(callback) {\n      var isSubscribed = true;\n      var listener = last = {\n        callback: callback,\n        next: null,\n        prev: last\n      };\n\n      if (listener.prev) {\n        listener.prev.next = listener;\n      } else {\n        first = listener;\n      }\n\n      return function unsubscribe() {\n        if (!isSubscribed || first === null) return;\n        isSubscribed = false;\n\n        if (listener.next) {\n          listener.next.prev = listener.prev;\n        } else {\n          last = listener.prev;\n        }\n\n        if (listener.prev) {\n          listener.prev.next = listener.next;\n        } else {\n          first = listener.next;\n        }\n      };\n    }\n  };\n}\n\nvar nullListeners = {\n  notify: function notify() {},\n  get: function get() {\n    return [];\n  }\n};\nexport function createSubscription(store, parentSub) {\n  var unsubscribe;\n  var listeners = nullListeners;\n\n  function addNestedSub(listener) {\n    trySubscribe();\n    return listeners.subscribe(listener);\n  }\n\n  function notifyNestedSubs() {\n    listeners.notify();\n  }\n\n  function handleChangeWrapper() {\n    if (subscription.onStateChange) {\n      subscription.onStateChange();\n    }\n  }\n\n  function isSubscribed() {\n    return Boolean(unsubscribe);\n  }\n\n  function trySubscribe() {\n    if (!unsubscribe) {\n      unsubscribe = parentSub ? parentSub.addNestedSub(handleChangeWrapper) : store.subscribe(handleChangeWrapper);\n      listeners = createListenerCollection();\n    }\n  }\n\n  function tryUnsubscribe() {\n    if (unsubscribe) {\n      unsubscribe();\n      unsubscribe = undefined;\n      listeners.clear();\n      listeners = nullListeners;\n    }\n  }\n\n  var subscription = {\n    addNestedSub: addNestedSub,\n    notifyNestedSubs: notifyNestedSubs,\n    handleChangeWrapper: handleChangeWrapper,\n    isSubscribed: isSubscribed,\n    trySubscribe: trySubscribe,\n    tryUnsubscribe: tryUnsubscribe,\n    getListeners: function getListeners() {\n      return listeners;\n    }\n  };\n  return subscription;\n}","import { useEffect, useLayoutEffect } from 'react'; // React currently throws a warning when using useLayoutEffect on the server.\n// To get around it, we can conditionally useEffect on the server (no-op) and\n// useLayoutEffect in the browser. We need useLayoutEffect to ensure the store\n// subscription callback always has the selector from the latest render commit\n// available, otherwise a store update may happen between render and the effect,\n// which may cause missed updates; we also must ensure the store subscription\n// is created synchronously, otherwise a store update may occur before the\n// subscription is created and an inconsistent state may be observed\n\nexport var useIsomorphicLayoutEffect = typeof window !== 'undefined' && typeof window.document !== 'undefined' && typeof window.document.createElement !== 'undefined' ? useLayoutEffect : useEffect;","import React, { useMemo } from 'react';\nimport PropTypes from 'prop-types';\nimport { ReactReduxContext } from './Context';\nimport { createSubscription } from '../utils/Subscription';\nimport { useIsomorphicLayoutEffect } from '../utils/useIsomorphicLayoutEffect';\n\nfunction Provider(_ref) {\n  var store = _ref.store,\n      context = _ref.context,\n      children = _ref.children;\n  var contextValue = useMemo(function () {\n    var subscription = createSubscription(store);\n    return {\n      store: store,\n      subscription: subscription\n    };\n  }, [store]);\n  var previousState = useMemo(function () {\n    return store.getState();\n  }, [store]);\n  useIsomorphicLayoutEffect(function () {\n    var subscription = contextValue.subscription;\n    subscription.onStateChange = subscription.notifyNestedSubs;\n    subscription.trySubscribe();\n\n    if (previousState !== store.getState()) {\n      subscription.notifyNestedSubs();\n    }\n\n    return function () {\n      subscription.tryUnsubscribe();\n      subscription.onStateChange = null;\n    };\n  }, [contextValue, previousState]);\n  var Context = context || ReactReduxContext;\n  return /*#__PURE__*/React.createElement(Context.Provider, {\n    value: contextValue\n  }, children);\n}\n\nif (process.env.NODE_ENV !== 'production') {\n  Provider.propTypes = {\n    store: PropTypes.shape({\n      subscribe: PropTypes.func.isRequired,\n      dispatch: PropTypes.func.isRequired,\n      getState: PropTypes.func.isRequired\n    }),\n    context: PropTypes.object,\n    children: PropTypes.any\n  };\n}\n\nexport default Provider;","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nvar _excluded = [\"getDisplayName\", \"methodName\", \"renderCountProp\", \"shouldHandleStateChanges\", \"storeKey\", \"withRef\", \"forwardRef\", \"context\"],\n    _excluded2 = [\"reactReduxForwardedRef\"];\nimport hoistStatics from 'hoist-non-react-statics';\nimport React, { useContext, useMemo, useRef, useReducer } from 'react';\nimport { isValidElementType, isContextConsumer } from 'react-is';\nimport { createSubscription } from '../utils/Subscription';\nimport { useIsomorphicLayoutEffect } from '../utils/useIsomorphicLayoutEffect';\nimport { ReactReduxContext } from './Context'; // Define some constant arrays just to avoid re-creating these\n\nvar EMPTY_ARRAY = [];\nvar NO_SUBSCRIPTION_ARRAY = [null, null];\n\nvar stringifyComponent = function stringifyComponent(Comp) {\n  try {\n    return JSON.stringify(Comp);\n  } catch (err) {\n    return String(Comp);\n  }\n};\n\nfunction storeStateUpdatesReducer(state, action) {\n  var updateCount = state[1];\n  return [action.payload, updateCount + 1];\n}\n\nfunction useIsomorphicLayoutEffectWithArgs(effectFunc, effectArgs, dependencies) {\n  useIsomorphicLayoutEffect(function () {\n    return effectFunc.apply(void 0, effectArgs);\n  }, dependencies);\n}\n\nfunction captureWrapperProps(lastWrapperProps, lastChildProps, renderIsScheduled, wrapperProps, actualChildProps, childPropsFromStoreUpdate, notifyNestedSubs) {\n  // We want to capture the wrapper props and child props we used for later comparisons\n  lastWrapperProps.current = wrapperProps;\n  lastChildProps.current = actualChildProps;\n  renderIsScheduled.current = false; // If the render was from a store update, clear out that reference and cascade the subscriber update\n\n  if (childPropsFromStoreUpdate.current) {\n    childPropsFromStoreUpdate.current = null;\n    notifyNestedSubs();\n  }\n}\n\nfunction subscribeUpdates(shouldHandleStateChanges, store, subscription, childPropsSelector, lastWrapperProps, lastChildProps, renderIsScheduled, childPropsFromStoreUpdate, notifyNestedSubs, forceComponentUpdateDispatch) {\n  // If we're not subscribed to the store, nothing to do here\n  if (!shouldHandleStateChanges) return; // Capture values for checking if and when this component unmounts\n\n  var didUnsubscribe = false;\n  var lastThrownError = null; // We'll run this callback every time a store subscription update propagates to this component\n\n  var checkForUpdates = function checkForUpdates() {\n    if (didUnsubscribe) {\n      // Don't run stale listeners.\n      // Redux doesn't guarantee unsubscriptions happen until next dispatch.\n      return;\n    }\n\n    var latestStoreState = store.getState();\n    var newChildProps, error;\n\n    try {\n      // Actually run the selector with the most recent store state and wrapper props\n      // to determine what the child props should be\n      newChildProps = childPropsSelector(latestStoreState, lastWrapperProps.current);\n    } catch (e) {\n      error = e;\n      lastThrownError = e;\n    }\n\n    if (!error) {\n      lastThrownError = null;\n    } // If the child props haven't changed, nothing to do here - cascade the subscription update\n\n\n    if (newChildProps === lastChildProps.current) {\n      if (!renderIsScheduled.current) {\n        notifyNestedSubs();\n      }\n    } else {\n      // Save references to the new child props.  Note that we track the \"child props from store update\"\n      // as a ref instead of a useState/useReducer because we need a way to determine if that value has\n      // been processed.  If this went into useState/useReducer, we couldn't clear out the value without\n      // forcing another re-render, which we don't want.\n      lastChildProps.current = newChildProps;\n      childPropsFromStoreUpdate.current = newChildProps;\n      renderIsScheduled.current = true; // If the child props _did_ change (or we caught an error), this wrapper component needs to re-render\n\n      forceComponentUpdateDispatch({\n        type: 'STORE_UPDATED',\n        payload: {\n          error: error\n        }\n      });\n    }\n  }; // Actually subscribe to the nearest connected ancestor (or store)\n\n\n  subscription.onStateChange = checkForUpdates;\n  subscription.trySubscribe(); // Pull data from the store after first render in case the store has\n  // changed since we began.\n\n  checkForUpdates();\n\n  var unsubscribeWrapper = function unsubscribeWrapper() {\n    didUnsubscribe = true;\n    subscription.tryUnsubscribe();\n    subscription.onStateChange = null;\n\n    if (lastThrownError) {\n      // It's possible that we caught an error due to a bad mapState function, but the\n      // parent re-rendered without this component and we're about to unmount.\n      // This shouldn't happen as long as we do top-down subscriptions correctly, but\n      // if we ever do those wrong, this throw will surface the error in our tests.\n      // In that case, throw the error from here so it doesn't get lost.\n      throw lastThrownError;\n    }\n  };\n\n  return unsubscribeWrapper;\n}\n\nvar initStateUpdates = function initStateUpdates() {\n  return [null, 0];\n};\n\nexport default function connectAdvanced(\n/*\r\n  selectorFactory is a func that is responsible for returning the selector function used to\r\n  compute new props from state, props, and dispatch. For example:\r\n      export default connectAdvanced((dispatch, options) => (state, props) => ({\r\n      thing: state.things[props.thingId],\r\n      saveThing: fields => dispatch(actionCreators.saveThing(props.thingId, fields)),\r\n    }))(YourComponent)\r\n    Access to dispatch is provided to the factory so selectorFactories can bind actionCreators\r\n  outside of their selector as an optimization. Options passed to connectAdvanced are passed to\r\n  the selectorFactory, along with displayName and WrappedComponent, as the second argument.\r\n    Note that selectorFactory is responsible for all caching/memoization of inbound and outbound\r\n  props. Do not use connectAdvanced directly without memoizing results between calls to your\r\n  selector, otherwise the Connect component will re-render on every state or props change.\r\n*/\nselectorFactory, // options object:\n_ref) {\n  if (_ref === void 0) {\n    _ref = {};\n  }\n\n  var _ref2 = _ref,\n      _ref2$getDisplayName = _ref2.getDisplayName,\n      getDisplayName = _ref2$getDisplayName === void 0 ? function (name) {\n    return \"ConnectAdvanced(\" + name + \")\";\n  } : _ref2$getDisplayName,\n      _ref2$methodName = _ref2.methodName,\n      methodName = _ref2$methodName === void 0 ? 'connectAdvanced' : _ref2$methodName,\n      _ref2$renderCountProp = _ref2.renderCountProp,\n      renderCountProp = _ref2$renderCountProp === void 0 ? undefined : _ref2$renderCountProp,\n      _ref2$shouldHandleSta = _ref2.shouldHandleStateChanges,\n      shouldHandleStateChanges = _ref2$shouldHandleSta === void 0 ? true : _ref2$shouldHandleSta,\n      _ref2$storeKey = _ref2.storeKey,\n      storeKey = _ref2$storeKey === void 0 ? 'store' : _ref2$storeKey,\n      _ref2$withRef = _ref2.withRef,\n      withRef = _ref2$withRef === void 0 ? false : _ref2$withRef,\n      _ref2$forwardRef = _ref2.forwardRef,\n      forwardRef = _ref2$forwardRef === void 0 ? false : _ref2$forwardRef,\n      _ref2$context = _ref2.context,\n      context = _ref2$context === void 0 ? ReactReduxContext : _ref2$context,\n      connectOptions = _objectWithoutPropertiesLoose(_ref2, _excluded);\n\n  if (process.env.NODE_ENV !== 'production') {\n    if (renderCountProp !== undefined) {\n      throw new Error(\"renderCountProp is removed. render counting is built into the latest React Dev Tools profiling extension\");\n    }\n\n    if (withRef) {\n      throw new Error('withRef is removed. To access the wrapped instance, use a ref on the connected component');\n    }\n\n    var customStoreWarningMessage = 'To use a custom Redux store for specific components, create a custom React context with ' + \"React.createContext(), and pass the context object to React Redux's Provider and specific components\" + ' like: <Provider context={MyContext}><ConnectedComponent context={MyContext} /></Provider>. ' + 'You may also pass a {context : MyContext} option to connect';\n\n    if (storeKey !== 'store') {\n      throw new Error('storeKey has been removed and does not do anything. ' + customStoreWarningMessage);\n    }\n  }\n\n  var Context = context;\n  return function wrapWithConnect(WrappedComponent) {\n    if (process.env.NODE_ENV !== 'production' && !isValidElementType(WrappedComponent)) {\n      throw new Error(\"You must pass a component to the function returned by \" + (methodName + \". Instead received \" + stringifyComponent(WrappedComponent)));\n    }\n\n    var wrappedComponentName = WrappedComponent.displayName || WrappedComponent.name || 'Component';\n    var displayName = getDisplayName(wrappedComponentName);\n\n    var selectorFactoryOptions = _extends({}, connectOptions, {\n      getDisplayName: getDisplayName,\n      methodName: methodName,\n      renderCountProp: renderCountProp,\n      shouldHandleStateChanges: shouldHandleStateChanges,\n      storeKey: storeKey,\n      displayName: displayName,\n      wrappedComponentName: wrappedComponentName,\n      WrappedComponent: WrappedComponent\n    });\n\n    var pure = connectOptions.pure;\n\n    function createChildSelector(store) {\n      return selectorFactory(store.dispatch, selectorFactoryOptions);\n    } // If we aren't running in \"pure\" mode, we don't want to memoize values.\n    // To avoid conditionally calling hooks, we fall back to a tiny wrapper\n    // that just executes the given callback immediately.\n\n\n    var usePureOnlyMemo = pure ? useMemo : function (callback) {\n      return callback();\n    };\n\n    function ConnectFunction(props) {\n      var _useMemo = useMemo(function () {\n        // Distinguish between actual \"data\" props that were passed to the wrapper component,\n        // and values needed to control behavior (forwarded refs, alternate context instances).\n        // To maintain the wrapperProps object reference, memoize this destructuring.\n        var reactReduxForwardedRef = props.reactReduxForwardedRef,\n            wrapperProps = _objectWithoutPropertiesLoose(props, _excluded2);\n\n        return [props.context, reactReduxForwardedRef, wrapperProps];\n      }, [props]),\n          propsContext = _useMemo[0],\n          reactReduxForwardedRef = _useMemo[1],\n          wrapperProps = _useMemo[2];\n\n      var ContextToUse = useMemo(function () {\n        // Users may optionally pass in a custom context instance to use instead of our ReactReduxContext.\n        // Memoize the check that determines which context instance we should use.\n        return propsContext && propsContext.Consumer && isContextConsumer( /*#__PURE__*/React.createElement(propsContext.Consumer, null)) ? propsContext : Context;\n      }, [propsContext, Context]); // Retrieve the store and ancestor subscription via context, if available\n\n      var contextValue = useContext(ContextToUse); // The store _must_ exist as either a prop or in context.\n      // We'll check to see if it _looks_ like a Redux store first.\n      // This allows us to pass through a `store` prop that is just a plain value.\n\n      var didStoreComeFromProps = Boolean(props.store) && Boolean(props.store.getState) && Boolean(props.store.dispatch);\n      var didStoreComeFromContext = Boolean(contextValue) && Boolean(contextValue.store);\n\n      if (process.env.NODE_ENV !== 'production' && !didStoreComeFromProps && !didStoreComeFromContext) {\n        throw new Error(\"Could not find \\\"store\\\" in the context of \" + (\"\\\"\" + displayName + \"\\\". Either wrap the root component in a <Provider>, \") + \"or pass a custom React context provider to <Provider> and the corresponding \" + (\"React context consumer to \" + displayName + \" in connect options.\"));\n      } // Based on the previous check, one of these must be true\n\n\n      var store = didStoreComeFromProps ? props.store : contextValue.store;\n      var childPropsSelector = useMemo(function () {\n        // The child props selector needs the store reference as an input.\n        // Re-create this selector whenever the store changes.\n        return createChildSelector(store);\n      }, [store]);\n\n      var _useMemo2 = useMemo(function () {\n        if (!shouldHandleStateChanges) return NO_SUBSCRIPTION_ARRAY; // This Subscription's source should match where store came from: props vs. context. A component\n        // connected to the store via props shouldn't use subscription from context, or vice versa.\n\n        // This Subscription's source should match where store came from: props vs. context. A component\n        // connected to the store via props shouldn't use subscription from context, or vice versa.\n        var subscription = createSubscription(store, didStoreComeFromProps ? null : contextValue.subscription); // `notifyNestedSubs` is duplicated to handle the case where the component is unmounted in\n        // the middle of the notification loop, where `subscription` will then be null. This can\n        // probably be avoided if Subscription's listeners logic is changed to not call listeners\n        // that have been unsubscribed in the  middle of the notification loop.\n\n        // `notifyNestedSubs` is duplicated to handle the case where the component is unmounted in\n        // the middle of the notification loop, where `subscription` will then be null. This can\n        // probably be avoided if Subscription's listeners logic is changed to not call listeners\n        // that have been unsubscribed in the  middle of the notification loop.\n        var notifyNestedSubs = subscription.notifyNestedSubs.bind(subscription);\n        return [subscription, notifyNestedSubs];\n      }, [store, didStoreComeFromProps, contextValue]),\n          subscription = _useMemo2[0],\n          notifyNestedSubs = _useMemo2[1]; // Determine what {store, subscription} value should be put into nested context, if necessary,\n      // and memoize that value to avoid unnecessary context updates.\n\n\n      var overriddenContextValue = useMemo(function () {\n        if (didStoreComeFromProps) {\n          // This component is directly subscribed to a store from props.\n          // We don't want descendants reading from this store - pass down whatever\n          // the existing context value is from the nearest connected ancestor.\n          return contextValue;\n        } // Otherwise, put this component's subscription instance into context, so that\n        // connected descendants won't update until after this component is done\n\n\n        return _extends({}, contextValue, {\n          subscription: subscription\n        });\n      }, [didStoreComeFromProps, contextValue, subscription]); // We need to force this wrapper component to re-render whenever a Redux store update\n      // causes a change to the calculated child component props (or we caught an error in mapState)\n\n      var _useReducer = useReducer(storeStateUpdatesReducer, EMPTY_ARRAY, initStateUpdates),\n          _useReducer$ = _useReducer[0],\n          previousStateUpdateResult = _useReducer$[0],\n          forceComponentUpdateDispatch = _useReducer[1]; // Propagate any mapState/mapDispatch errors upwards\n\n\n      if (previousStateUpdateResult && previousStateUpdateResult.error) {\n        throw previousStateUpdateResult.error;\n      } // Set up refs to coordinate values between the subscription effect and the render logic\n\n\n      var lastChildProps = useRef();\n      var lastWrapperProps = useRef(wrapperProps);\n      var childPropsFromStoreUpdate = useRef();\n      var renderIsScheduled = useRef(false);\n      var actualChildProps = usePureOnlyMemo(function () {\n        // Tricky logic here:\n        // - This render may have been triggered by a Redux store update that produced new child props\n        // - However, we may have gotten new wrapper props after that\n        // If we have new child props, and the same wrapper props, we know we should use the new child props as-is.\n        // But, if we have new wrapper props, those might change the child props, so we have to recalculate things.\n        // So, we'll use the child props from store update only if the wrapper props are the same as last time.\n        if (childPropsFromStoreUpdate.current && wrapperProps === lastWrapperProps.current) {\n          return childPropsFromStoreUpdate.current;\n        } // TODO We're reading the store directly in render() here. Bad idea?\n        // This will likely cause Bad Things (TM) to happen in Concurrent Mode.\n        // Note that we do this because on renders _not_ caused by store updates, we need the latest store state\n        // to determine what the child props should be.\n\n\n        return childPropsSelector(store.getState(), wrapperProps);\n      }, [store, previousStateUpdateResult, wrapperProps]); // We need this to execute synchronously every time we re-render. However, React warns\n      // about useLayoutEffect in SSR, so we try to detect environment and fall back to\n      // just useEffect instead to avoid the warning, since neither will run anyway.\n\n      useIsomorphicLayoutEffectWithArgs(captureWrapperProps, [lastWrapperProps, lastChildProps, renderIsScheduled, wrapperProps, actualChildProps, childPropsFromStoreUpdate, notifyNestedSubs]); // Our re-subscribe logic only runs when the store/subscription setup changes\n\n      useIsomorphicLayoutEffectWithArgs(subscribeUpdates, [shouldHandleStateChanges, store, subscription, childPropsSelector, lastWrapperProps, lastChildProps, renderIsScheduled, childPropsFromStoreUpdate, notifyNestedSubs, forceComponentUpdateDispatch], [store, subscription, childPropsSelector]); // Now that all that's done, we can finally try to actually render the child component.\n      // We memoize the elements for the rendered child component as an optimization.\n\n      var renderedWrappedComponent = useMemo(function () {\n        return /*#__PURE__*/React.createElement(WrappedComponent, _extends({}, actualChildProps, {\n          ref: reactReduxForwardedRef\n        }));\n      }, [reactReduxForwardedRef, WrappedComponent, actualChildProps]); // If React sees the exact same element reference as last time, it bails out of re-rendering\n      // that child, same as if it was wrapped in React.memo() or returned false from shouldComponentUpdate.\n\n      var renderedChild = useMemo(function () {\n        if (shouldHandleStateChanges) {\n          // If this component is subscribed to store updates, we need to pass its own\n          // subscription instance down to our descendants. That means rendering the same\n          // Context instance, and putting a different value into the context.\n          return /*#__PURE__*/React.createElement(ContextToUse.Provider, {\n            value: overriddenContextValue\n          }, renderedWrappedComponent);\n        }\n\n        return renderedWrappedComponent;\n      }, [ContextToUse, renderedWrappedComponent, overriddenContextValue]);\n      return renderedChild;\n    } // If we're in \"pure\" mode, ensure our wrapper component only re-renders when incoming props have changed.\n\n\n    var Connect = pure ? React.memo(ConnectFunction) : ConnectFunction;\n    Connect.WrappedComponent = WrappedComponent;\n    Connect.displayName = ConnectFunction.displayName = displayName;\n\n    if (forwardRef) {\n      var forwarded = React.forwardRef(function forwardConnectRef(props, ref) {\n        return /*#__PURE__*/React.createElement(Connect, _extends({}, props, {\n          reactReduxForwardedRef: ref\n        }));\n      });\n      forwarded.displayName = displayName;\n      forwarded.WrappedComponent = WrappedComponent;\n      return hoistStatics(forwarded, WrappedComponent);\n    }\n\n    return hoistStatics(Connect, WrappedComponent);\n  };\n}","function is(x, y) {\n  if (x === y) {\n    return x !== 0 || y !== 0 || 1 / x === 1 / y;\n  } else {\n    return x !== x && y !== y;\n  }\n}\n\nexport default function shallowEqual(objA, objB) {\n  if (is(objA, objB)) return true;\n\n  if (typeof objA !== 'object' || objA === null || typeof objB !== 'object' || objB === null) {\n    return false;\n  }\n\n  var keysA = Object.keys(objA);\n  var keysB = Object.keys(objB);\n  if (keysA.length !== keysB.length) return false;\n\n  for (var i = 0; i < keysA.length; i++) {\n    if (!Object.prototype.hasOwnProperty.call(objB, keysA[i]) || !is(objA[keysA[i]], objB[keysA[i]])) {\n      return false;\n    }\n  }\n\n  return true;\n}","export default function bindActionCreators(actionCreators, dispatch) {\n  var boundActionCreators = {};\n\n  var _loop = function _loop(key) {\n    var actionCreator = actionCreators[key];\n\n    if (typeof actionCreator === 'function') {\n      boundActionCreators[key] = function () {\n        return dispatch(actionCreator.apply(void 0, arguments));\n      };\n    }\n  };\n\n  for (var key in actionCreators) {\n    _loop(key);\n  }\n\n  return boundActionCreators;\n}","import verifyPlainObject from '../utils/verifyPlainObject';\nexport function wrapMapToPropsConstant(getConstant) {\n  return function initConstantSelector(dispatch, options) {\n    var constant = getConstant(dispatch, options);\n\n    function constantSelector() {\n      return constant;\n    }\n\n    constantSelector.dependsOnOwnProps = false;\n    return constantSelector;\n  };\n} // dependsOnOwnProps is used by createMapToPropsProxy to determine whether to pass props as args\n// to the mapToProps function being wrapped. It is also used by makePurePropsSelector to determine\n// whether mapToProps needs to be invoked when props have changed.\n//\n// A length of one signals that mapToProps does not depend on props from the parent component.\n// A length of zero is assumed to mean mapToProps is getting args via arguments or ...args and\n// therefore not reporting its length accurately..\n\nexport function getDependsOnOwnProps(mapToProps) {\n  return mapToProps.dependsOnOwnProps !== null && mapToProps.dependsOnOwnProps !== undefined ? Boolean(mapToProps.dependsOnOwnProps) : mapToProps.length !== 1;\n} // Used by whenMapStateToPropsIsFunction and whenMapDispatchToPropsIsFunction,\n// this function wraps mapToProps in a proxy function which does several things:\n//\n//  * Detects whether the mapToProps function being called depends on props, which\n//    is used by selectorFactory to decide if it should reinvoke on props changes.\n//\n//  * On first call, handles mapToProps if returns another function, and treats that\n//    new function as the true mapToProps for subsequent calls.\n//\n//  * On first call, verifies the first result is a plain object, in order to warn\n//    the developer that their mapToProps function is not returning a valid result.\n//\n\nexport function wrapMapToPropsFunc(mapToProps, methodName) {\n  return function initProxySelector(dispatch, _ref) {\n    var displayName = _ref.displayName;\n\n    var proxy = function mapToPropsProxy(stateOrDispatch, ownProps) {\n      return proxy.dependsOnOwnProps ? proxy.mapToProps(stateOrDispatch, ownProps) : proxy.mapToProps(stateOrDispatch);\n    }; // allow detectFactoryAndVerify to get ownProps\n\n\n    proxy.dependsOnOwnProps = true;\n\n    proxy.mapToProps = function detectFactoryAndVerify(stateOrDispatch, ownProps) {\n      proxy.mapToProps = mapToProps;\n      proxy.dependsOnOwnProps = getDependsOnOwnProps(mapToProps);\n      var props = proxy(stateOrDispatch, ownProps);\n\n      if (typeof props === 'function') {\n        proxy.mapToProps = props;\n        proxy.dependsOnOwnProps = getDependsOnOwnProps(props);\n        props = proxy(stateOrDispatch, ownProps);\n      }\n\n      if (process.env.NODE_ENV !== 'production') verifyPlainObject(props, displayName, methodName);\n      return props;\n    };\n\n    return proxy;\n  };\n}","import bindActionCreators from '../utils/bindActionCreators';\nimport { wrapMapToPropsConstant, wrapMapToPropsFunc } from './wrapMapToProps';\nexport function whenMapDispatchToPropsIsFunction(mapDispatchToProps) {\n  return typeof mapDispatchToProps === 'function' ? wrapMapToPropsFunc(mapDispatchToProps, 'mapDispatchToProps') : undefined;\n}\nexport function whenMapDispatchToPropsIsMissing(mapDispatchToProps) {\n  return !mapDispatchToProps ? wrapMapToPropsConstant(function (dispatch) {\n    return {\n      dispatch: dispatch\n    };\n  }) : undefined;\n}\nexport function whenMapDispatchToPropsIsObject(mapDispatchToProps) {\n  return mapDispatchToProps && typeof mapDispatchToProps === 'object' ? wrapMapToPropsConstant(function (dispatch) {\n    return bindActionCreators(mapDispatchToProps, dispatch);\n  }) : undefined;\n}\nexport default [whenMapDispatchToPropsIsFunction, whenMapDispatchToPropsIsMissing, whenMapDispatchToPropsIsObject];","import { wrapMapToPropsConstant, wrapMapToPropsFunc } from './wrapMapToProps';\nexport function whenMapStateToPropsIsFunction(mapStateToProps) {\n  return typeof mapStateToProps === 'function' ? wrapMapToPropsFunc(mapStateToProps, 'mapStateToProps') : undefined;\n}\nexport function whenMapStateToPropsIsMissing(mapStateToProps) {\n  return !mapStateToProps ? wrapMapToPropsConstant(function () {\n    return {};\n  }) : undefined;\n}\nexport default [whenMapStateToPropsIsFunction, whenMapStateToPropsIsMissing];","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport verifyPlainObject from '../utils/verifyPlainObject';\nexport function defaultMergeProps(stateProps, dispatchProps, ownProps) {\n  return _extends({}, ownProps, stateProps, dispatchProps);\n}\nexport function wrapMergePropsFunc(mergeProps) {\n  return function initMergePropsProxy(dispatch, _ref) {\n    var displayName = _ref.displayName,\n        pure = _ref.pure,\n        areMergedPropsEqual = _ref.areMergedPropsEqual;\n    var hasRunOnce = false;\n    var mergedProps;\n    return function mergePropsProxy(stateProps, dispatchProps, ownProps) {\n      var nextMergedProps = mergeProps(stateProps, dispatchProps, ownProps);\n\n      if (hasRunOnce) {\n        if (!pure || !areMergedPropsEqual(nextMergedProps, mergedProps)) mergedProps = nextMergedProps;\n      } else {\n        hasRunOnce = true;\n        mergedProps = nextMergedProps;\n        if (process.env.NODE_ENV !== 'production') verifyPlainObject(mergedProps, displayName, 'mergeProps');\n      }\n\n      return mergedProps;\n    };\n  };\n}\nexport function whenMergePropsIsFunction(mergeProps) {\n  return typeof mergeProps === 'function' ? wrapMergePropsFunc(mergeProps) : undefined;\n}\nexport function whenMergePropsIsOmitted(mergeProps) {\n  return !mergeProps ? function () {\n    return defaultMergeProps;\n  } : undefined;\n}\nexport default [whenMergePropsIsFunction, whenMergePropsIsOmitted];","import _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nvar _excluded = [\"initMapStateToProps\", \"initMapDispatchToProps\", \"initMergeProps\"];\nimport verifySubselectors from './verifySubselectors';\nexport function impureFinalPropsSelectorFactory(mapStateToProps, mapDispatchToProps, mergeProps, dispatch) {\n  return function impureFinalPropsSelector(state, ownProps) {\n    return mergeProps(mapStateToProps(state, ownProps), mapDispatchToProps(dispatch, ownProps), ownProps);\n  };\n}\nexport function pureFinalPropsSelectorFactory(mapStateToProps, mapDispatchToProps, mergeProps, dispatch, _ref) {\n  var areStatesEqual = _ref.areStatesEqual,\n      areOwnPropsEqual = _ref.areOwnPropsEqual,\n      areStatePropsEqual = _ref.areStatePropsEqual;\n  var hasRunAtLeastOnce = false;\n  var state;\n  var ownProps;\n  var stateProps;\n  var dispatchProps;\n  var mergedProps;\n\n  function handleFirstCall(firstState, firstOwnProps) {\n    state = firstState;\n    ownProps = firstOwnProps;\n    stateProps = mapStateToProps(state, ownProps);\n    dispatchProps = mapDispatchToProps(dispatch, ownProps);\n    mergedProps = mergeProps(stateProps, dispatchProps, ownProps);\n    hasRunAtLeastOnce = true;\n    return mergedProps;\n  }\n\n  function handleNewPropsAndNewState() {\n    stateProps = mapStateToProps(state, ownProps);\n    if (mapDispatchToProps.dependsOnOwnProps) dispatchProps = mapDispatchToProps(dispatch, ownProps);\n    mergedProps = mergeProps(stateProps, dispatchProps, ownProps);\n    return mergedProps;\n  }\n\n  function handleNewProps() {\n    if (mapStateToProps.dependsOnOwnProps) stateProps = mapStateToProps(state, ownProps);\n    if (mapDispatchToProps.dependsOnOwnProps) dispatchProps = mapDispatchToProps(dispatch, ownProps);\n    mergedProps = mergeProps(stateProps, dispatchProps, ownProps);\n    return mergedProps;\n  }\n\n  function handleNewState() {\n    var nextStateProps = mapStateToProps(state, ownProps);\n    var statePropsChanged = !areStatePropsEqual(nextStateProps, stateProps);\n    stateProps = nextStateProps;\n    if (statePropsChanged) mergedProps = mergeProps(stateProps, dispatchProps, ownProps);\n    return mergedProps;\n  }\n\n  function handleSubsequentCalls(nextState, nextOwnProps) {\n    var propsChanged = !areOwnPropsEqual(nextOwnProps, ownProps);\n    var stateChanged = !areStatesEqual(nextState, state);\n    state = nextState;\n    ownProps = nextOwnProps;\n    if (propsChanged && stateChanged) return handleNewPropsAndNewState();\n    if (propsChanged) return handleNewProps();\n    if (stateChanged) return handleNewState();\n    return mergedProps;\n  }\n\n  return function pureFinalPropsSelector(nextState, nextOwnProps) {\n    return hasRunAtLeastOnce ? handleSubsequentCalls(nextState, nextOwnProps) : handleFirstCall(nextState, nextOwnProps);\n  };\n} // TODO: Add more comments\n// If pure is true, the selector returned by selectorFactory will memoize its results,\n// allowing connectAdvanced's shouldComponentUpdate to return false if final\n// props have not changed. If false, the selector will always return a new\n// object and shouldComponentUpdate will always return true.\n\nexport default function finalPropsSelectorFactory(dispatch, _ref2) {\n  var initMapStateToProps = _ref2.initMapStateToProps,\n      initMapDispatchToProps = _ref2.initMapDispatchToProps,\n      initMergeProps = _ref2.initMergeProps,\n      options = _objectWithoutPropertiesLoose(_ref2, _excluded);\n\n  var mapStateToProps = initMapStateToProps(dispatch, options);\n  var mapDispatchToProps = initMapDispatchToProps(dispatch, options);\n  var mergeProps = initMergeProps(dispatch, options);\n\n  if (process.env.NODE_ENV !== 'production') {\n    verifySubselectors(mapStateToProps, mapDispatchToProps, mergeProps, options.displayName);\n  }\n\n  var selectorFactory = options.pure ? pureFinalPropsSelectorFactory : impureFinalPropsSelectorFactory;\n  return selectorFactory(mapStateToProps, mapDispatchToProps, mergeProps, dispatch, options);\n}","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nvar _excluded = [\"pure\", \"areStatesEqual\", \"areOwnPropsEqual\", \"areStatePropsEqual\", \"areMergedPropsEqual\"];\nimport connectAdvanced from '../components/connectAdvanced';\nimport shallowEqual from '../utils/shallowEqual';\nimport defaultMapDispatchToPropsFactories from './mapDispatchToProps';\nimport defaultMapStateToPropsFactories from './mapStateToProps';\nimport defaultMergePropsFactories from './mergeProps';\nimport defaultSelectorFactory from './selectorFactory';\n/*\r\n  connect is a facade over connectAdvanced. It turns its args into a compatible\r\n  selectorFactory, which has the signature:\r\n\r\n    (dispatch, options) => (nextState, nextOwnProps) => nextFinalProps\r\n  \r\n  connect passes its args to connectAdvanced as options, which will in turn pass them to\r\n  selectorFactory each time a Connect component instance is instantiated or hot reloaded.\r\n\r\n  selectorFactory returns a final props selector from its mapStateToProps,\r\n  mapStateToPropsFactories, mapDispatchToProps, mapDispatchToPropsFactories, mergeProps,\r\n  mergePropsFactories, and pure args.\r\n\r\n  The resulting final props selector is called by the Connect component instance whenever\r\n  it receives new props or store state.\r\n */\n\nfunction match(arg, factories, name) {\n  for (var i = factories.length - 1; i >= 0; i--) {\n    var result = factories[i](arg);\n    if (result) return result;\n  }\n\n  return function (dispatch, options) {\n    throw new Error(\"Invalid value of type \" + typeof arg + \" for \" + name + \" argument when connecting component \" + options.wrappedComponentName + \".\");\n  };\n}\n\nfunction strictEqual(a, b) {\n  return a === b;\n} // createConnect with default args builds the 'official' connect behavior. Calling it with\n// different options opens up some testing and extensibility scenarios\n\n\nexport function createConnect(_temp) {\n  var _ref = _temp === void 0 ? {} : _temp,\n      _ref$connectHOC = _ref.connectHOC,\n      connectHOC = _ref$connectHOC === void 0 ? connectAdvanced : _ref$connectHOC,\n      _ref$mapStateToPropsF = _ref.mapStateToPropsFactories,\n      mapStateToPropsFactories = _ref$mapStateToPropsF === void 0 ? defaultMapStateToPropsFactories : _ref$mapStateToPropsF,\n      _ref$mapDispatchToPro = _ref.mapDispatchToPropsFactories,\n      mapDispatchToPropsFactories = _ref$mapDispatchToPro === void 0 ? defaultMapDispatchToPropsFactories : _ref$mapDispatchToPro,\n      _ref$mergePropsFactor = _ref.mergePropsFactories,\n      mergePropsFactories = _ref$mergePropsFactor === void 0 ? defaultMergePropsFactories : _ref$mergePropsFactor,\n      _ref$selectorFactory = _ref.selectorFactory,\n      selectorFactory = _ref$selectorFactory === void 0 ? defaultSelectorFactory : _ref$selectorFactory;\n\n  return function connect(mapStateToProps, mapDispatchToProps, mergeProps, _ref2) {\n    if (_ref2 === void 0) {\n      _ref2 = {};\n    }\n\n    var _ref3 = _ref2,\n        _ref3$pure = _ref3.pure,\n        pure = _ref3$pure === void 0 ? true : _ref3$pure,\n        _ref3$areStatesEqual = _ref3.areStatesEqual,\n        areStatesEqual = _ref3$areStatesEqual === void 0 ? strictEqual : _ref3$areStatesEqual,\n        _ref3$areOwnPropsEqua = _ref3.areOwnPropsEqual,\n        areOwnPropsEqual = _ref3$areOwnPropsEqua === void 0 ? shallowEqual : _ref3$areOwnPropsEqua,\n        _ref3$areStatePropsEq = _ref3.areStatePropsEqual,\n        areStatePropsEqual = _ref3$areStatePropsEq === void 0 ? shallowEqual : _ref3$areStatePropsEq,\n        _ref3$areMergedPropsE = _ref3.areMergedPropsEqual,\n        areMergedPropsEqual = _ref3$areMergedPropsE === void 0 ? shallowEqual : _ref3$areMergedPropsE,\n        extraOptions = _objectWithoutPropertiesLoose(_ref3, _excluded);\n\n    var initMapStateToProps = match(mapStateToProps, mapStateToPropsFactories, 'mapStateToProps');\n    var initMapDispatchToProps = match(mapDispatchToProps, mapDispatchToPropsFactories, 'mapDispatchToProps');\n    var initMergeProps = match(mergeProps, mergePropsFactories, 'mergeProps');\n    return connectHOC(selectorFactory, _extends({\n      // used in error messages\n      methodName: 'connect',\n      // used to compute Connect's displayName from the wrapped component's displayName.\n      getDisplayName: function getDisplayName(name) {\n        return \"Connect(\" + name + \")\";\n      },\n      // if mapStateToProps is falsy, the Connect component doesn't subscribe to store state changes\n      shouldHandleStateChanges: Boolean(mapStateToProps),\n      // passed through to selectorFactory\n      initMapStateToProps: initMapStateToProps,\n      initMapDispatchToProps: initMapDispatchToProps,\n      initMergeProps: initMergeProps,\n      pure: pure,\n      areStatesEqual: areStatesEqual,\n      areOwnPropsEqual: areOwnPropsEqual,\n      areStatePropsEqual: areStatePropsEqual,\n      areMergedPropsEqual: areMergedPropsEqual\n    }, extraOptions));\n  };\n}\nexport default /*#__PURE__*/createConnect();","import { useContext } from 'react';\nimport { ReactReduxContext } from '../components/Context';\n/**\r\n * A hook to access the value of the `ReactReduxContext`. This is a low-level\r\n * hook that you should usually not need to call directly.\r\n *\r\n * @returns {any} the value of the `ReactReduxContext`\r\n *\r\n * @example\r\n *\r\n * import React from 'react'\r\n * import { useReduxContext } from 'react-redux'\r\n *\r\n * export const CounterComponent = ({ value }) => {\r\n *   const { store } = useReduxContext()\r\n *   return <div>{store.getState()}</div>\r\n * }\r\n */\n\nexport function useReduxContext() {\n  var contextValue = useContext(ReactReduxContext);\n\n  if (process.env.NODE_ENV !== 'production' && !contextValue) {\n    throw new Error('could not find react-redux context value; please ensure the component is wrapped in a <Provider>');\n  }\n\n  return contextValue;\n}","import { useContext } from 'react';\nimport { ReactReduxContext } from '../components/Context';\nimport { useReduxContext as useDefaultReduxContext } from './useReduxContext';\n/**\r\n * Hook factory, which creates a `useStore` hook bound to a given context.\r\n *\r\n * @param {React.Context} [context=ReactReduxContext] Context passed to your `<Provider>`.\r\n * @returns {Function} A `useStore` hook bound to the specified context.\r\n */\n\nexport function createStoreHook(context) {\n  if (context === void 0) {\n    context = ReactReduxContext;\n  }\n\n  var useReduxContext = context === ReactReduxContext ? useDefaultReduxContext : function () {\n    return useContext(context);\n  };\n  return function useStore() {\n    var _useReduxContext = useReduxContext(),\n        store = _useReduxContext.store;\n\n    return store;\n  };\n}\n/**\r\n * A hook to access the redux store.\r\n *\r\n * @returns {any} the redux store\r\n *\r\n * @example\r\n *\r\n * import React from 'react'\r\n * import { useStore } from 'react-redux'\r\n *\r\n * export const ExampleComponent = () => {\r\n *   const store = useStore()\r\n *   return <div>{store.getState()}</div>\r\n * }\r\n */\n\nexport var useStore = /*#__PURE__*/createStoreHook();","import { ReactReduxContext } from '../components/Context';\nimport { useStore as useDefaultStore, createStoreHook } from './useStore';\n/**\r\n * Hook factory, which creates a `useDispatch` hook bound to a given context.\r\n *\r\n * @param {React.Context} [context=ReactReduxContext] Context passed to your `<Provider>`.\r\n * @returns {Function} A `useDispatch` hook bound to the specified context.\r\n */\n\nexport function createDispatchHook(context) {\n  if (context === void 0) {\n    context = ReactReduxContext;\n  }\n\n  var useStore = context === ReactReduxContext ? useDefaultStore : createStoreHook(context);\n  return function useDispatch() {\n    var store = useStore();\n    return store.dispatch;\n  };\n}\n/**\r\n * A hook to access the redux `dispatch` function.\r\n *\r\n * @returns {any|function} redux store's `dispatch` function\r\n *\r\n * @example\r\n *\r\n * import React, { useCallback } from 'react'\r\n * import { useDispatch } from 'react-redux'\r\n *\r\n * export const CounterComponent = ({ value }) => {\r\n *   const dispatch = useDispatch()\r\n *   const increaseCounter = useCallback(() => dispatch({ type: 'increase-counter' }), [])\r\n *   return (\r\n *     <div>\r\n *       <span>{value}</span>\r\n *       <button onClick={increaseCounter}>Increase counter</button>\r\n *     </div>\r\n *   )\r\n * }\r\n */\n\nexport var useDispatch = /*#__PURE__*/createDispatchHook();","import { useReducer, useRef, useMemo, useContext, useDebugValue } from 'react';\nimport { useReduxContext as useDefaultReduxContext } from './useReduxContext';\nimport { createSubscription } from '../utils/Subscription';\nimport { useIsomorphicLayoutEffect } from '../utils/useIsomorphicLayoutEffect';\nimport { ReactReduxContext } from '../components/Context';\n\nvar refEquality = function refEquality(a, b) {\n  return a === b;\n};\n\nfunction useSelectorWithStoreAndSubscription(selector, equalityFn, store, contextSub) {\n  var _useReducer = useReducer(function (s) {\n    return s + 1;\n  }, 0),\n      forceRender = _useReducer[1];\n\n  var subscription = useMemo(function () {\n    return createSubscription(store, contextSub);\n  }, [store, contextSub]);\n  var latestSubscriptionCallbackError = useRef();\n  var latestSelector = useRef();\n  var latestStoreState = useRef();\n  var latestSelectedState = useRef();\n  var storeState = store.getState();\n  var selectedState;\n\n  try {\n    if (selector !== latestSelector.current || storeState !== latestStoreState.current || latestSubscriptionCallbackError.current) {\n      var newSelectedState = selector(storeState); // ensure latest selected state is reused so that a custom equality function can result in identical references\n\n      if (latestSelectedState.current === undefined || !equalityFn(newSelectedState, latestSelectedState.current)) {\n        selectedState = newSelectedState;\n      } else {\n        selectedState = latestSelectedState.current;\n      }\n    } else {\n      selectedState = latestSelectedState.current;\n    }\n  } catch (err) {\n    if (latestSubscriptionCallbackError.current) {\n      err.message += \"\\nThe error may be correlated with this previous error:\\n\" + latestSubscriptionCallbackError.current.stack + \"\\n\\n\";\n    }\n\n    throw err;\n  }\n\n  useIsomorphicLayoutEffect(function () {\n    latestSelector.current = selector;\n    latestStoreState.current = storeState;\n    latestSelectedState.current = selectedState;\n    latestSubscriptionCallbackError.current = undefined;\n  });\n  useIsomorphicLayoutEffect(function () {\n    function checkForUpdates() {\n      try {\n        var newStoreState = store.getState(); // Avoid calling selector multiple times if the store's state has not changed\n\n        if (newStoreState === latestStoreState.current) {\n          return;\n        }\n\n        var _newSelectedState = latestSelector.current(newStoreState);\n\n        if (equalityFn(_newSelectedState, latestSelectedState.current)) {\n          return;\n        }\n\n        latestSelectedState.current = _newSelectedState;\n        latestStoreState.current = newStoreState;\n      } catch (err) {\n        // we ignore all errors here, since when the component\n        // is re-rendered, the selectors are called again, and\n        // will throw again, if neither props nor store state\n        // changed\n        latestSubscriptionCallbackError.current = err;\n      }\n\n      forceRender();\n    }\n\n    subscription.onStateChange = checkForUpdates;\n    subscription.trySubscribe();\n    checkForUpdates();\n    return function () {\n      return subscription.tryUnsubscribe();\n    };\n  }, [store, subscription]);\n  return selectedState;\n}\n/**\r\n * Hook factory, which creates a `useSelector` hook bound to a given context.\r\n *\r\n * @param {React.Context} [context=ReactReduxContext] Context passed to your `<Provider>`.\r\n * @returns {Function} A `useSelector` hook bound to the specified context.\r\n */\n\n\nexport function createSelectorHook(context) {\n  if (context === void 0) {\n    context = ReactReduxContext;\n  }\n\n  var useReduxContext = context === ReactReduxContext ? useDefaultReduxContext : function () {\n    return useContext(context);\n  };\n  return function useSelector(selector, equalityFn) {\n    if (equalityFn === void 0) {\n      equalityFn = refEquality;\n    }\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (!selector) {\n        throw new Error(\"You must pass a selector to useSelector\");\n      }\n\n      if (typeof selector !== 'function') {\n        throw new Error(\"You must pass a function as a selector to useSelector\");\n      }\n\n      if (typeof equalityFn !== 'function') {\n        throw new Error(\"You must pass a function as an equality function to useSelector\");\n      }\n    }\n\n    var _useReduxContext = useReduxContext(),\n        store = _useReduxContext.store,\n        contextSub = _useReduxContext.subscription;\n\n    var selectedState = useSelectorWithStoreAndSubscription(selector, equalityFn, store, contextSub);\n    useDebugValue(selectedState);\n    return selectedState;\n  };\n}\n/**\r\n * A hook to access the redux store's state. This hook takes a selector function\r\n * as an argument. The selector is called with the store state.\r\n *\r\n * This hook takes an optional equality comparison function as the second parameter\r\n * that allows you to customize the way the selected state is compared to determine\r\n * whether the component needs to be re-rendered.\r\n *\r\n * @param {Function} selector the selector function\r\n * @param {Function=} equalityFn the function that will be used to determine equality\r\n *\r\n * @returns {any} the selected state\r\n *\r\n * @example\r\n *\r\n * import React from 'react'\r\n * import { useSelector } from 'react-redux'\r\n *\r\n * export const CounterComponent = () => {\r\n *   const counter = useSelector(state => state.counter)\r\n *   return <div>{counter}</div>\r\n * }\r\n */\n\nexport var useSelector = /*#__PURE__*/createSelectorHook();","export * from './exports';\nimport { unstable_batchedUpdates as batch } from './utils/reactBatchedUpdates';\nimport { setBatch } from './utils/batch'; // Enable batched updates in our subscriptions for use\n// with standard React renderers (ReactDOM, React Native)\n\nsetBatch(batch);\nexport { batch };","var safeIsNaN = Number.isNaN ||\n    function ponyfill(value) {\n        return typeof value === 'number' && value !== value;\n    };\nfunction isEqual(first, second) {\n    if (first === second) {\n        return true;\n    }\n    if (safeIsNaN(first) && safeIsNaN(second)) {\n        return true;\n    }\n    return false;\n}\nfunction areInputsEqual(newInputs, lastInputs) {\n    if (newInputs.length !== lastInputs.length) {\n        return false;\n    }\n    for (var i = 0; i < newInputs.length; i++) {\n        if (!isEqual(newInputs[i], lastInputs[i])) {\n            return false;\n        }\n    }\n    return true;\n}\n\nfunction memoizeOne(resultFn, isEqual) {\n    if (isEqual === void 0) { isEqual = areInputsEqual; }\n    var lastThis;\n    var lastArgs = [];\n    var lastResult;\n    var calledOnce = false;\n    function memoized() {\n        var newArgs = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            newArgs[_i] = arguments[_i];\n        }\n        if (calledOnce && lastThis === this && isEqual(newArgs, lastArgs)) {\n            return lastResult;\n        }\n        lastResult = resultFn.apply(this, newArgs);\n        calledOnce = true;\n        lastThis = this;\n        lastArgs = newArgs;\n        return lastResult;\n    }\n    return memoized;\n}\n\nexport default memoizeOne;\n","import React, { useLayoutEffect, useEffect, useRef, useState, useContext } from 'react';\nimport _inheritsLoose from '@babel/runtime/helpers/esm/inheritsLoose';\nimport _extends from '@babel/runtime/helpers/esm/extends';\nimport { createStore as createStore$1, applyMiddleware, compose, bindActionCreators } from 'redux';\nimport { Provider, connect } from 'react-redux';\nimport { useMemo, useCallback } from 'use-memo-one';\nimport { getRect, expand, offset, withScroll, getBox, createBox, calculateBox } from 'css-box-model';\nimport memoizeOne from 'memoize-one';\nimport rafSchd from 'raf-schd';\nimport ReactDOM from 'react-dom';\n\nvar isProduction = process.env.NODE_ENV === 'production';\nvar spacesAndTabs = /[ \\t]{2,}/g;\nvar lineStartWithSpaces = /^[ \\t]*/gm;\n\nvar clean = function clean(value) {\n  return value.replace(spacesAndTabs, ' ').replace(lineStartWithSpaces, '').trim();\n};\n\nvar getDevMessage = function getDevMessage(message) {\n  return clean(\"\\n  %creact-beautiful-dnd\\n\\n  %c\" + clean(message) + \"\\n\\n  %c\\uD83D\\uDC77\\u200D This is a development only message. It will be removed in production builds.\\n\");\n};\n\nvar getFormattedMessage = function getFormattedMessage(message) {\n  return [getDevMessage(message), 'color: #00C584; font-size: 1.2em; font-weight: bold;', 'line-height: 1.5', 'color: #723874;'];\n};\nvar isDisabledFlag = '__react-beautiful-dnd-disable-dev-warnings';\nfunction log(type, message) {\n  var _console;\n\n  if (isProduction) {\n    return;\n  }\n\n  if (typeof window !== 'undefined' && window[isDisabledFlag]) {\n    return;\n  }\n\n  (_console = console)[type].apply(_console, getFormattedMessage(message));\n}\nvar warning = log.bind(null, 'warn');\nvar error = log.bind(null, 'error');\n\nfunction noop() {}\n\nfunction getOptions(shared, fromBinding) {\n  return _extends({}, shared, {}, fromBinding);\n}\n\nfunction bindEvents(el, bindings, sharedOptions) {\n  var unbindings = bindings.map(function (binding) {\n    var options = getOptions(sharedOptions, binding.options);\n    el.addEventListener(binding.eventName, binding.fn, options);\n    return function unbind() {\n      el.removeEventListener(binding.eventName, binding.fn, options);\n    };\n  });\n  return function unbindAll() {\n    unbindings.forEach(function (unbind) {\n      unbind();\n    });\n  };\n}\n\nvar isProduction$1 = process.env.NODE_ENV === 'production';\nvar prefix = 'Invariant failed';\nfunction RbdInvariant(message) {\n  this.message = message;\n}\n\nRbdInvariant.prototype.toString = function toString() {\n  return this.message;\n};\n\nfunction invariant(condition, message) {\n  if (condition) {\n    return;\n  }\n\n  if (isProduction$1) {\n    throw new RbdInvariant(prefix);\n  } else {\n    throw new RbdInvariant(prefix + \": \" + (message || ''));\n  }\n}\n\nvar ErrorBoundary = function (_React$Component) {\n  _inheritsLoose(ErrorBoundary, _React$Component);\n\n  function ErrorBoundary() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _React$Component.call.apply(_React$Component, [this].concat(args)) || this;\n    _this.callbacks = null;\n    _this.unbind = noop;\n\n    _this.onWindowError = function (event) {\n      var callbacks = _this.getCallbacks();\n\n      if (callbacks.isDragging()) {\n        callbacks.tryAbort();\n        process.env.NODE_ENV !== \"production\" ? warning(\"\\n        An error was caught by our window 'error' event listener while a drag was occurring.\\n        The active drag has been aborted.\\n      \") : void 0;\n      }\n\n      var err = event.error;\n\n      if (err instanceof RbdInvariant) {\n        event.preventDefault();\n\n        if (process.env.NODE_ENV !== 'production') {\n          error(err.message);\n        }\n      }\n    };\n\n    _this.getCallbacks = function () {\n      if (!_this.callbacks) {\n        throw new Error('Unable to find AppCallbacks in <ErrorBoundary/>');\n      }\n\n      return _this.callbacks;\n    };\n\n    _this.setCallbacks = function (callbacks) {\n      _this.callbacks = callbacks;\n    };\n\n    return _this;\n  }\n\n  var _proto = ErrorBoundary.prototype;\n\n  _proto.componentDidMount = function componentDidMount() {\n    this.unbind = bindEvents(window, [{\n      eventName: 'error',\n      fn: this.onWindowError\n    }]);\n  };\n\n  _proto.componentDidCatch = function componentDidCatch(err) {\n    if (err instanceof RbdInvariant) {\n      if (process.env.NODE_ENV !== 'production') {\n        error(err.message);\n      }\n\n      this.setState({});\n      return;\n    }\n\n    throw err;\n  };\n\n  _proto.componentWillUnmount = function componentWillUnmount() {\n    this.unbind();\n  };\n\n  _proto.render = function render() {\n    return this.props.children(this.setCallbacks);\n  };\n\n  return ErrorBoundary;\n}(React.Component);\n\nvar dragHandleUsageInstructions = \"\\n  Press space bar to start a drag.\\n  When dragging you can use the arrow keys to move the item around and escape to cancel.\\n  Some screen readers may require you to be in focus mode or to use your pass through key\\n\";\n\nvar position = function position(index) {\n  return index + 1;\n};\n\nvar onDragStart = function onDragStart(start) {\n  return \"\\n  You have lifted an item in position \" + position(start.source.index) + \"\\n\";\n};\n\nvar withLocation = function withLocation(source, destination) {\n  var isInHomeList = source.droppableId === destination.droppableId;\n  var startPosition = position(source.index);\n  var endPosition = position(destination.index);\n\n  if (isInHomeList) {\n    return \"\\n      You have moved the item from position \" + startPosition + \"\\n      to position \" + endPosition + \"\\n    \";\n  }\n\n  return \"\\n    You have moved the item from position \" + startPosition + \"\\n    in list \" + source.droppableId + \"\\n    to list \" + destination.droppableId + \"\\n    in position \" + endPosition + \"\\n  \";\n};\n\nvar withCombine = function withCombine(id, source, combine) {\n  var inHomeList = source.droppableId === combine.droppableId;\n\n  if (inHomeList) {\n    return \"\\n      The item \" + id + \"\\n      has been combined with \" + combine.draggableId;\n  }\n\n  return \"\\n      The item \" + id + \"\\n      in list \" + source.droppableId + \"\\n      has been combined with \" + combine.draggableId + \"\\n      in list \" + combine.droppableId + \"\\n    \";\n};\n\nvar onDragUpdate = function onDragUpdate(update) {\n  var location = update.destination;\n\n  if (location) {\n    return withLocation(update.source, location);\n  }\n\n  var combine = update.combine;\n\n  if (combine) {\n    return withCombine(update.draggableId, update.source, combine);\n  }\n\n  return 'You are over an area that cannot be dropped on';\n};\n\nvar returnedToStart = function returnedToStart(source) {\n  return \"\\n  The item has returned to its starting position\\n  of \" + position(source.index) + \"\\n\";\n};\n\nvar onDragEnd = function onDragEnd(result) {\n  if (result.reason === 'CANCEL') {\n    return \"\\n      Movement cancelled.\\n      \" + returnedToStart(result.source) + \"\\n    \";\n  }\n\n  var location = result.destination;\n  var combine = result.combine;\n\n  if (location) {\n    return \"\\n      You have dropped the item.\\n      \" + withLocation(result.source, location) + \"\\n    \";\n  }\n\n  if (combine) {\n    return \"\\n      You have dropped the item.\\n      \" + withCombine(result.draggableId, result.source, combine) + \"\\n    \";\n  }\n\n  return \"\\n    The item has been dropped while not over a drop area.\\n    \" + returnedToStart(result.source) + \"\\n  \";\n};\n\nvar preset = {\n  dragHandleUsageInstructions: dragHandleUsageInstructions,\n  onDragStart: onDragStart,\n  onDragUpdate: onDragUpdate,\n  onDragEnd: onDragEnd\n};\n\nvar origin = {\n  x: 0,\n  y: 0\n};\nvar add = function add(point1, point2) {\n  return {\n    x: point1.x + point2.x,\n    y: point1.y + point2.y\n  };\n};\nvar subtract = function subtract(point1, point2) {\n  return {\n    x: point1.x - point2.x,\n    y: point1.y - point2.y\n  };\n};\nvar isEqual = function isEqual(point1, point2) {\n  return point1.x === point2.x && point1.y === point2.y;\n};\nvar negate = function negate(point) {\n  return {\n    x: point.x !== 0 ? -point.x : 0,\n    y: point.y !== 0 ? -point.y : 0\n  };\n};\nvar patch = function patch(line, value, otherValue) {\n  var _ref;\n\n  if (otherValue === void 0) {\n    otherValue = 0;\n  }\n\n  return _ref = {}, _ref[line] = value, _ref[line === 'x' ? 'y' : 'x'] = otherValue, _ref;\n};\nvar distance = function distance(point1, point2) {\n  return Math.sqrt(Math.pow(point2.x - point1.x, 2) + Math.pow(point2.y - point1.y, 2));\n};\nvar closest = function closest(target, points) {\n  return Math.min.apply(Math, points.map(function (point) {\n    return distance(target, point);\n  }));\n};\nvar apply = function apply(fn) {\n  return function (point) {\n    return {\n      x: fn(point.x),\n      y: fn(point.y)\n    };\n  };\n};\n\nvar executeClip = (function (frame, subject) {\n  var result = getRect({\n    top: Math.max(subject.top, frame.top),\n    right: Math.min(subject.right, frame.right),\n    bottom: Math.min(subject.bottom, frame.bottom),\n    left: Math.max(subject.left, frame.left)\n  });\n\n  if (result.width <= 0 || result.height <= 0) {\n    return null;\n  }\n\n  return result;\n});\n\nvar offsetByPosition = function offsetByPosition(spacing, point) {\n  return {\n    top: spacing.top + point.y,\n    left: spacing.left + point.x,\n    bottom: spacing.bottom + point.y,\n    right: spacing.right + point.x\n  };\n};\nvar getCorners = function getCorners(spacing) {\n  return [{\n    x: spacing.left,\n    y: spacing.top\n  }, {\n    x: spacing.right,\n    y: spacing.top\n  }, {\n    x: spacing.left,\n    y: spacing.bottom\n  }, {\n    x: spacing.right,\n    y: spacing.bottom\n  }];\n};\nvar noSpacing = {\n  top: 0,\n  right: 0,\n  bottom: 0,\n  left: 0\n};\n\nvar scroll = function scroll(target, frame) {\n  if (!frame) {\n    return target;\n  }\n\n  return offsetByPosition(target, frame.scroll.diff.displacement);\n};\n\nvar increase = function increase(target, axis, withPlaceholder) {\n  if (withPlaceholder && withPlaceholder.increasedBy) {\n    var _extends2;\n\n    return _extends({}, target, (_extends2 = {}, _extends2[axis.end] = target[axis.end] + withPlaceholder.increasedBy[axis.line], _extends2));\n  }\n\n  return target;\n};\n\nvar clip = function clip(target, frame) {\n  if (frame && frame.shouldClipSubject) {\n    return executeClip(frame.pageMarginBox, target);\n  }\n\n  return getRect(target);\n};\n\nvar getSubject = (function (_ref) {\n  var page = _ref.page,\n      withPlaceholder = _ref.withPlaceholder,\n      axis = _ref.axis,\n      frame = _ref.frame;\n  var scrolled = scroll(page.marginBox, frame);\n  var increased = increase(scrolled, axis, withPlaceholder);\n  var clipped = clip(increased, frame);\n  return {\n    page: page,\n    withPlaceholder: withPlaceholder,\n    active: clipped\n  };\n});\n\nvar scrollDroppable = (function (droppable, newScroll) {\n  !droppable.frame ? process.env.NODE_ENV !== \"production\" ? invariant(false) : invariant(false) : void 0;\n  var scrollable = droppable.frame;\n  var scrollDiff = subtract(newScroll, scrollable.scroll.initial);\n  var scrollDisplacement = negate(scrollDiff);\n\n  var frame = _extends({}, scrollable, {\n    scroll: {\n      initial: scrollable.scroll.initial,\n      current: newScroll,\n      diff: {\n        value: scrollDiff,\n        displacement: scrollDisplacement\n      },\n      max: scrollable.scroll.max\n    }\n  });\n\n  var subject = getSubject({\n    page: droppable.subject.page,\n    withPlaceholder: droppable.subject.withPlaceholder,\n    axis: droppable.axis,\n    frame: frame\n  });\n\n  var result = _extends({}, droppable, {\n    frame: frame,\n    subject: subject\n  });\n\n  return result;\n});\n\nfunction isInteger(value) {\n  if (Number.isInteger) {\n    return Number.isInteger(value);\n  }\n\n  return typeof value === 'number' && isFinite(value) && Math.floor(value) === value;\n}\nfunction values(map) {\n  if (Object.values) {\n    return Object.values(map);\n  }\n\n  return Object.keys(map).map(function (key) {\n    return map[key];\n  });\n}\nfunction findIndex(list, predicate) {\n  if (list.findIndex) {\n    return list.findIndex(predicate);\n  }\n\n  for (var i = 0; i < list.length; i++) {\n    if (predicate(list[i])) {\n      return i;\n    }\n  }\n\n  return -1;\n}\nfunction find(list, predicate) {\n  if (list.find) {\n    return list.find(predicate);\n  }\n\n  var index = findIndex(list, predicate);\n\n  if (index !== -1) {\n    return list[index];\n  }\n\n  return undefined;\n}\nfunction toArray(list) {\n  return Array.prototype.slice.call(list);\n}\n\nvar toDroppableMap = memoizeOne(function (droppables) {\n  return droppables.reduce(function (previous, current) {\n    previous[current.descriptor.id] = current;\n    return previous;\n  }, {});\n});\nvar toDraggableMap = memoizeOne(function (draggables) {\n  return draggables.reduce(function (previous, current) {\n    previous[current.descriptor.id] = current;\n    return previous;\n  }, {});\n});\nvar toDroppableList = memoizeOne(function (droppables) {\n  return values(droppables);\n});\nvar toDraggableList = memoizeOne(function (draggables) {\n  return values(draggables);\n});\n\nvar getDraggablesInsideDroppable = memoizeOne(function (droppableId, draggables) {\n  var result = toDraggableList(draggables).filter(function (draggable) {\n    return droppableId === draggable.descriptor.droppableId;\n  }).sort(function (a, b) {\n    return a.descriptor.index - b.descriptor.index;\n  });\n  return result;\n});\n\nfunction tryGetDestination(impact) {\n  if (impact.at && impact.at.type === 'REORDER') {\n    return impact.at.destination;\n  }\n\n  return null;\n}\nfunction tryGetCombine(impact) {\n  if (impact.at && impact.at.type === 'COMBINE') {\n    return impact.at.combine;\n  }\n\n  return null;\n}\n\nvar removeDraggableFromList = memoizeOne(function (remove, list) {\n  return list.filter(function (item) {\n    return item.descriptor.id !== remove.descriptor.id;\n  });\n});\n\nvar moveToNextCombine = (function (_ref) {\n  var isMovingForward = _ref.isMovingForward,\n      draggable = _ref.draggable,\n      destination = _ref.destination,\n      insideDestination = _ref.insideDestination,\n      previousImpact = _ref.previousImpact;\n\n  if (!destination.isCombineEnabled) {\n    return null;\n  }\n\n  var location = tryGetDestination(previousImpact);\n\n  if (!location) {\n    return null;\n  }\n\n  function getImpact(target) {\n    var at = {\n      type: 'COMBINE',\n      combine: {\n        draggableId: target,\n        droppableId: destination.descriptor.id\n      }\n    };\n    return _extends({}, previousImpact, {\n      at: at\n    });\n  }\n\n  var all = previousImpact.displaced.all;\n  var closestId = all.length ? all[0] : null;\n\n  if (isMovingForward) {\n    return closestId ? getImpact(closestId) : null;\n  }\n\n  var withoutDraggable = removeDraggableFromList(draggable, insideDestination);\n\n  if (!closestId) {\n    if (!withoutDraggable.length) {\n      return null;\n    }\n\n    var last = withoutDraggable[withoutDraggable.length - 1];\n    return getImpact(last.descriptor.id);\n  }\n\n  var indexOfClosest = findIndex(withoutDraggable, function (d) {\n    return d.descriptor.id === closestId;\n  });\n  !(indexOfClosest !== -1) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Could not find displaced item in set') : invariant(false) : void 0;\n  var proposedIndex = indexOfClosest - 1;\n\n  if (proposedIndex < 0) {\n    return null;\n  }\n\n  var before = withoutDraggable[proposedIndex];\n  return getImpact(before.descriptor.id);\n});\n\nvar isHomeOf = (function (draggable, destination) {\n  return draggable.descriptor.droppableId === destination.descriptor.id;\n});\n\nvar noDisplacedBy = {\n  point: origin,\n  value: 0\n};\nvar emptyGroups = {\n  invisible: {},\n  visible: {},\n  all: []\n};\nvar noImpact = {\n  displaced: emptyGroups,\n  displacedBy: noDisplacedBy,\n  at: null\n};\n\nvar isWithin = (function (lowerBound, upperBound) {\n  return function (value) {\n    return lowerBound <= value && value <= upperBound;\n  };\n});\n\nvar isPartiallyVisibleThroughFrame = (function (frame) {\n  var isWithinVertical = isWithin(frame.top, frame.bottom);\n  var isWithinHorizontal = isWithin(frame.left, frame.right);\n  return function (subject) {\n    var isContained = isWithinVertical(subject.top) && isWithinVertical(subject.bottom) && isWithinHorizontal(subject.left) && isWithinHorizontal(subject.right);\n\n    if (isContained) {\n      return true;\n    }\n\n    var isPartiallyVisibleVertically = isWithinVertical(subject.top) || isWithinVertical(subject.bottom);\n    var isPartiallyVisibleHorizontally = isWithinHorizontal(subject.left) || isWithinHorizontal(subject.right);\n    var isPartiallyContained = isPartiallyVisibleVertically && isPartiallyVisibleHorizontally;\n\n    if (isPartiallyContained) {\n      return true;\n    }\n\n    var isBiggerVertically = subject.top < frame.top && subject.bottom > frame.bottom;\n    var isBiggerHorizontally = subject.left < frame.left && subject.right > frame.right;\n    var isTargetBiggerThanFrame = isBiggerVertically && isBiggerHorizontally;\n\n    if (isTargetBiggerThanFrame) {\n      return true;\n    }\n\n    var isTargetBiggerOnOneAxis = isBiggerVertically && isPartiallyVisibleHorizontally || isBiggerHorizontally && isPartiallyVisibleVertically;\n    return isTargetBiggerOnOneAxis;\n  };\n});\n\nvar isTotallyVisibleThroughFrame = (function (frame) {\n  var isWithinVertical = isWithin(frame.top, frame.bottom);\n  var isWithinHorizontal = isWithin(frame.left, frame.right);\n  return function (subject) {\n    var isContained = isWithinVertical(subject.top) && isWithinVertical(subject.bottom) && isWithinHorizontal(subject.left) && isWithinHorizontal(subject.right);\n    return isContained;\n  };\n});\n\nvar vertical = {\n  direction: 'vertical',\n  line: 'y',\n  crossAxisLine: 'x',\n  start: 'top',\n  end: 'bottom',\n  size: 'height',\n  crossAxisStart: 'left',\n  crossAxisEnd: 'right',\n  crossAxisSize: 'width'\n};\nvar horizontal = {\n  direction: 'horizontal',\n  line: 'x',\n  crossAxisLine: 'y',\n  start: 'left',\n  end: 'right',\n  size: 'width',\n  crossAxisStart: 'top',\n  crossAxisEnd: 'bottom',\n  crossAxisSize: 'height'\n};\n\nvar isTotallyVisibleThroughFrameOnAxis = (function (axis) {\n  return function (frame) {\n    var isWithinVertical = isWithin(frame.top, frame.bottom);\n    var isWithinHorizontal = isWithin(frame.left, frame.right);\n    return function (subject) {\n      if (axis === vertical) {\n        return isWithinVertical(subject.top) && isWithinVertical(subject.bottom);\n      }\n\n      return isWithinHorizontal(subject.left) && isWithinHorizontal(subject.right);\n    };\n  };\n});\n\nvar getDroppableDisplaced = function getDroppableDisplaced(target, destination) {\n  var displacement = destination.frame ? destination.frame.scroll.diff.displacement : origin;\n  return offsetByPosition(target, displacement);\n};\n\nvar isVisibleInDroppable = function isVisibleInDroppable(target, destination, isVisibleThroughFrameFn) {\n  if (!destination.subject.active) {\n    return false;\n  }\n\n  return isVisibleThroughFrameFn(destination.subject.active)(target);\n};\n\nvar isVisibleInViewport = function isVisibleInViewport(target, viewport, isVisibleThroughFrameFn) {\n  return isVisibleThroughFrameFn(viewport)(target);\n};\n\nvar isVisible = function isVisible(_ref) {\n  var toBeDisplaced = _ref.target,\n      destination = _ref.destination,\n      viewport = _ref.viewport,\n      withDroppableDisplacement = _ref.withDroppableDisplacement,\n      isVisibleThroughFrameFn = _ref.isVisibleThroughFrameFn;\n  var displacedTarget = withDroppableDisplacement ? getDroppableDisplaced(toBeDisplaced, destination) : toBeDisplaced;\n  return isVisibleInDroppable(displacedTarget, destination, isVisibleThroughFrameFn) && isVisibleInViewport(displacedTarget, viewport, isVisibleThroughFrameFn);\n};\n\nvar isPartiallyVisible = function isPartiallyVisible(args) {\n  return isVisible(_extends({}, args, {\n    isVisibleThroughFrameFn: isPartiallyVisibleThroughFrame\n  }));\n};\nvar isTotallyVisible = function isTotallyVisible(args) {\n  return isVisible(_extends({}, args, {\n    isVisibleThroughFrameFn: isTotallyVisibleThroughFrame\n  }));\n};\nvar isTotallyVisibleOnAxis = function isTotallyVisibleOnAxis(args) {\n  return isVisible(_extends({}, args, {\n    isVisibleThroughFrameFn: isTotallyVisibleThroughFrameOnAxis(args.destination.axis)\n  }));\n};\n\nvar getShouldAnimate = function getShouldAnimate(id, last, forceShouldAnimate) {\n  if (typeof forceShouldAnimate === 'boolean') {\n    return forceShouldAnimate;\n  }\n\n  if (!last) {\n    return true;\n  }\n\n  var invisible = last.invisible,\n      visible = last.visible;\n\n  if (invisible[id]) {\n    return false;\n  }\n\n  var previous = visible[id];\n  return previous ? previous.shouldAnimate : true;\n};\n\nfunction getTarget(draggable, displacedBy) {\n  var marginBox = draggable.page.marginBox;\n  var expandBy = {\n    top: displacedBy.point.y,\n    right: 0,\n    bottom: 0,\n    left: displacedBy.point.x\n  };\n  return getRect(expand(marginBox, expandBy));\n}\n\nfunction getDisplacementGroups(_ref) {\n  var afterDragging = _ref.afterDragging,\n      destination = _ref.destination,\n      displacedBy = _ref.displacedBy,\n      viewport = _ref.viewport,\n      forceShouldAnimate = _ref.forceShouldAnimate,\n      last = _ref.last;\n  return afterDragging.reduce(function process(groups, draggable) {\n    var target = getTarget(draggable, displacedBy);\n    var id = draggable.descriptor.id;\n    groups.all.push(id);\n    var isVisible = isPartiallyVisible({\n      target: target,\n      destination: destination,\n      viewport: viewport,\n      withDroppableDisplacement: true\n    });\n\n    if (!isVisible) {\n      groups.invisible[draggable.descriptor.id] = true;\n      return groups;\n    }\n\n    var shouldAnimate = getShouldAnimate(id, last, forceShouldAnimate);\n    var displacement = {\n      draggableId: id,\n      shouldAnimate: shouldAnimate\n    };\n    groups.visible[id] = displacement;\n    return groups;\n  }, {\n    all: [],\n    visible: {},\n    invisible: {}\n  });\n}\n\nfunction getIndexOfLastItem(draggables, options) {\n  if (!draggables.length) {\n    return 0;\n  }\n\n  var indexOfLastItem = draggables[draggables.length - 1].descriptor.index;\n  return options.inHomeList ? indexOfLastItem : indexOfLastItem + 1;\n}\n\nfunction goAtEnd(_ref) {\n  var insideDestination = _ref.insideDestination,\n      inHomeList = _ref.inHomeList,\n      displacedBy = _ref.displacedBy,\n      destination = _ref.destination;\n  var newIndex = getIndexOfLastItem(insideDestination, {\n    inHomeList: inHomeList\n  });\n  return {\n    displaced: emptyGroups,\n    displacedBy: displacedBy,\n    at: {\n      type: 'REORDER',\n      destination: {\n        droppableId: destination.descriptor.id,\n        index: newIndex\n      }\n    }\n  };\n}\n\nfunction calculateReorderImpact(_ref2) {\n  var draggable = _ref2.draggable,\n      insideDestination = _ref2.insideDestination,\n      destination = _ref2.destination,\n      viewport = _ref2.viewport,\n      displacedBy = _ref2.displacedBy,\n      last = _ref2.last,\n      index = _ref2.index,\n      forceShouldAnimate = _ref2.forceShouldAnimate;\n  var inHomeList = isHomeOf(draggable, destination);\n\n  if (index == null) {\n    return goAtEnd({\n      insideDestination: insideDestination,\n      inHomeList: inHomeList,\n      displacedBy: displacedBy,\n      destination: destination\n    });\n  }\n\n  var match = find(insideDestination, function (item) {\n    return item.descriptor.index === index;\n  });\n\n  if (!match) {\n    return goAtEnd({\n      insideDestination: insideDestination,\n      inHomeList: inHomeList,\n      displacedBy: displacedBy,\n      destination: destination\n    });\n  }\n\n  var withoutDragging = removeDraggableFromList(draggable, insideDestination);\n  var sliceFrom = insideDestination.indexOf(match);\n  var impacted = withoutDragging.slice(sliceFrom);\n  var displaced = getDisplacementGroups({\n    afterDragging: impacted,\n    destination: destination,\n    displacedBy: displacedBy,\n    last: last,\n    viewport: viewport.frame,\n    forceShouldAnimate: forceShouldAnimate\n  });\n  return {\n    displaced: displaced,\n    displacedBy: displacedBy,\n    at: {\n      type: 'REORDER',\n      destination: {\n        droppableId: destination.descriptor.id,\n        index: index\n      }\n    }\n  };\n}\n\nfunction didStartAfterCritical(draggableId, afterCritical) {\n  return Boolean(afterCritical.effected[draggableId]);\n}\n\nvar fromCombine = (function (_ref) {\n  var isMovingForward = _ref.isMovingForward,\n      destination = _ref.destination,\n      draggables = _ref.draggables,\n      combine = _ref.combine,\n      afterCritical = _ref.afterCritical;\n\n  if (!destination.isCombineEnabled) {\n    return null;\n  }\n\n  var combineId = combine.draggableId;\n  var combineWith = draggables[combineId];\n  var combineWithIndex = combineWith.descriptor.index;\n  var didCombineWithStartAfterCritical = didStartAfterCritical(combineId, afterCritical);\n\n  if (didCombineWithStartAfterCritical) {\n    if (isMovingForward) {\n      return combineWithIndex;\n    }\n\n    return combineWithIndex - 1;\n  }\n\n  if (isMovingForward) {\n    return combineWithIndex + 1;\n  }\n\n  return combineWithIndex;\n});\n\nvar fromReorder = (function (_ref) {\n  var isMovingForward = _ref.isMovingForward,\n      isInHomeList = _ref.isInHomeList,\n      insideDestination = _ref.insideDestination,\n      location = _ref.location;\n\n  if (!insideDestination.length) {\n    return null;\n  }\n\n  var currentIndex = location.index;\n  var proposedIndex = isMovingForward ? currentIndex + 1 : currentIndex - 1;\n  var firstIndex = insideDestination[0].descriptor.index;\n  var lastIndex = insideDestination[insideDestination.length - 1].descriptor.index;\n  var upperBound = isInHomeList ? lastIndex : lastIndex + 1;\n\n  if (proposedIndex < firstIndex) {\n    return null;\n  }\n\n  if (proposedIndex > upperBound) {\n    return null;\n  }\n\n  return proposedIndex;\n});\n\nvar moveToNextIndex = (function (_ref) {\n  var isMovingForward = _ref.isMovingForward,\n      isInHomeList = _ref.isInHomeList,\n      draggable = _ref.draggable,\n      draggables = _ref.draggables,\n      destination = _ref.destination,\n      insideDestination = _ref.insideDestination,\n      previousImpact = _ref.previousImpact,\n      viewport = _ref.viewport,\n      afterCritical = _ref.afterCritical;\n  var wasAt = previousImpact.at;\n  !wasAt ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot move in direction without previous impact location') : invariant(false) : void 0;\n\n  if (wasAt.type === 'REORDER') {\n    var _newIndex = fromReorder({\n      isMovingForward: isMovingForward,\n      isInHomeList: isInHomeList,\n      location: wasAt.destination,\n      insideDestination: insideDestination\n    });\n\n    if (_newIndex == null) {\n      return null;\n    }\n\n    return calculateReorderImpact({\n      draggable: draggable,\n      insideDestination: insideDestination,\n      destination: destination,\n      viewport: viewport,\n      last: previousImpact.displaced,\n      displacedBy: previousImpact.displacedBy,\n      index: _newIndex\n    });\n  }\n\n  var newIndex = fromCombine({\n    isMovingForward: isMovingForward,\n    destination: destination,\n    displaced: previousImpact.displaced,\n    draggables: draggables,\n    combine: wasAt.combine,\n    afterCritical: afterCritical\n  });\n\n  if (newIndex == null) {\n    return null;\n  }\n\n  return calculateReorderImpact({\n    draggable: draggable,\n    insideDestination: insideDestination,\n    destination: destination,\n    viewport: viewport,\n    last: previousImpact.displaced,\n    displacedBy: previousImpact.displacedBy,\n    index: newIndex\n  });\n});\n\nvar getCombinedItemDisplacement = (function (_ref) {\n  var displaced = _ref.displaced,\n      afterCritical = _ref.afterCritical,\n      combineWith = _ref.combineWith,\n      displacedBy = _ref.displacedBy;\n  var isDisplaced = Boolean(displaced.visible[combineWith] || displaced.invisible[combineWith]);\n\n  if (didStartAfterCritical(combineWith, afterCritical)) {\n    return isDisplaced ? origin : negate(displacedBy.point);\n  }\n\n  return isDisplaced ? displacedBy.point : origin;\n});\n\nvar whenCombining = (function (_ref) {\n  var afterCritical = _ref.afterCritical,\n      impact = _ref.impact,\n      draggables = _ref.draggables;\n  var combine = tryGetCombine(impact);\n  !combine ? process.env.NODE_ENV !== \"production\" ? invariant(false) : invariant(false) : void 0;\n  var combineWith = combine.draggableId;\n  var center = draggables[combineWith].page.borderBox.center;\n  var displaceBy = getCombinedItemDisplacement({\n    displaced: impact.displaced,\n    afterCritical: afterCritical,\n    combineWith: combineWith,\n    displacedBy: impact.displacedBy\n  });\n  return add(center, displaceBy);\n});\n\nvar distanceFromStartToBorderBoxCenter = function distanceFromStartToBorderBoxCenter(axis, box) {\n  return box.margin[axis.start] + box.borderBox[axis.size] / 2;\n};\n\nvar distanceFromEndToBorderBoxCenter = function distanceFromEndToBorderBoxCenter(axis, box) {\n  return box.margin[axis.end] + box.borderBox[axis.size] / 2;\n};\n\nvar getCrossAxisBorderBoxCenter = function getCrossAxisBorderBoxCenter(axis, target, isMoving) {\n  return target[axis.crossAxisStart] + isMoving.margin[axis.crossAxisStart] + isMoving.borderBox[axis.crossAxisSize] / 2;\n};\n\nvar goAfter = function goAfter(_ref) {\n  var axis = _ref.axis,\n      moveRelativeTo = _ref.moveRelativeTo,\n      isMoving = _ref.isMoving;\n  return patch(axis.line, moveRelativeTo.marginBox[axis.end] + distanceFromStartToBorderBoxCenter(axis, isMoving), getCrossAxisBorderBoxCenter(axis, moveRelativeTo.marginBox, isMoving));\n};\nvar goBefore = function goBefore(_ref2) {\n  var axis = _ref2.axis,\n      moveRelativeTo = _ref2.moveRelativeTo,\n      isMoving = _ref2.isMoving;\n  return patch(axis.line, moveRelativeTo.marginBox[axis.start] - distanceFromEndToBorderBoxCenter(axis, isMoving), getCrossAxisBorderBoxCenter(axis, moveRelativeTo.marginBox, isMoving));\n};\nvar goIntoStart = function goIntoStart(_ref3) {\n  var axis = _ref3.axis,\n      moveInto = _ref3.moveInto,\n      isMoving = _ref3.isMoving;\n  return patch(axis.line, moveInto.contentBox[axis.start] + distanceFromStartToBorderBoxCenter(axis, isMoving), getCrossAxisBorderBoxCenter(axis, moveInto.contentBox, isMoving));\n};\n\nvar whenReordering = (function (_ref) {\n  var impact = _ref.impact,\n      draggable = _ref.draggable,\n      draggables = _ref.draggables,\n      droppable = _ref.droppable,\n      afterCritical = _ref.afterCritical;\n  var insideDestination = getDraggablesInsideDroppable(droppable.descriptor.id, draggables);\n  var draggablePage = draggable.page;\n  var axis = droppable.axis;\n\n  if (!insideDestination.length) {\n    return goIntoStart({\n      axis: axis,\n      moveInto: droppable.page,\n      isMoving: draggablePage\n    });\n  }\n\n  var displaced = impact.displaced,\n      displacedBy = impact.displacedBy;\n  var closestAfter = displaced.all[0];\n\n  if (closestAfter) {\n    var closest = draggables[closestAfter];\n\n    if (didStartAfterCritical(closestAfter, afterCritical)) {\n      return goBefore({\n        axis: axis,\n        moveRelativeTo: closest.page,\n        isMoving: draggablePage\n      });\n    }\n\n    var withDisplacement = offset(closest.page, displacedBy.point);\n    return goBefore({\n      axis: axis,\n      moveRelativeTo: withDisplacement,\n      isMoving: draggablePage\n    });\n  }\n\n  var last = insideDestination[insideDestination.length - 1];\n\n  if (last.descriptor.id === draggable.descriptor.id) {\n    return draggablePage.borderBox.center;\n  }\n\n  if (didStartAfterCritical(last.descriptor.id, afterCritical)) {\n    var page = offset(last.page, negate(afterCritical.displacedBy.point));\n    return goAfter({\n      axis: axis,\n      moveRelativeTo: page,\n      isMoving: draggablePage\n    });\n  }\n\n  return goAfter({\n    axis: axis,\n    moveRelativeTo: last.page,\n    isMoving: draggablePage\n  });\n});\n\nvar withDroppableDisplacement = (function (droppable, point) {\n  var frame = droppable.frame;\n\n  if (!frame) {\n    return point;\n  }\n\n  return add(point, frame.scroll.diff.displacement);\n});\n\nvar getResultWithoutDroppableDisplacement = function getResultWithoutDroppableDisplacement(_ref) {\n  var impact = _ref.impact,\n      draggable = _ref.draggable,\n      droppable = _ref.droppable,\n      draggables = _ref.draggables,\n      afterCritical = _ref.afterCritical;\n  var original = draggable.page.borderBox.center;\n  var at = impact.at;\n\n  if (!droppable) {\n    return original;\n  }\n\n  if (!at) {\n    return original;\n  }\n\n  if (at.type === 'REORDER') {\n    return whenReordering({\n      impact: impact,\n      draggable: draggable,\n      draggables: draggables,\n      droppable: droppable,\n      afterCritical: afterCritical\n    });\n  }\n\n  return whenCombining({\n    impact: impact,\n    draggables: draggables,\n    afterCritical: afterCritical\n  });\n};\n\nvar getPageBorderBoxCenterFromImpact = (function (args) {\n  var withoutDisplacement = getResultWithoutDroppableDisplacement(args);\n  var droppable = args.droppable;\n  var withDisplacement = droppable ? withDroppableDisplacement(droppable, withoutDisplacement) : withoutDisplacement;\n  return withDisplacement;\n});\n\nvar scrollViewport = (function (viewport, newScroll) {\n  var diff = subtract(newScroll, viewport.scroll.initial);\n  var displacement = negate(diff);\n  var frame = getRect({\n    top: newScroll.y,\n    bottom: newScroll.y + viewport.frame.height,\n    left: newScroll.x,\n    right: newScroll.x + viewport.frame.width\n  });\n  var updated = {\n    frame: frame,\n    scroll: {\n      initial: viewport.scroll.initial,\n      max: viewport.scroll.max,\n      current: newScroll,\n      diff: {\n        value: diff,\n        displacement: displacement\n      }\n    }\n  };\n  return updated;\n});\n\nfunction getDraggables(ids, draggables) {\n  return ids.map(function (id) {\n    return draggables[id];\n  });\n}\n\nfunction tryGetVisible(id, groups) {\n  for (var i = 0; i < groups.length; i++) {\n    var displacement = groups[i].visible[id];\n\n    if (displacement) {\n      return displacement;\n    }\n  }\n\n  return null;\n}\n\nvar speculativelyIncrease = (function (_ref) {\n  var impact = _ref.impact,\n      viewport = _ref.viewport,\n      destination = _ref.destination,\n      draggables = _ref.draggables,\n      maxScrollChange = _ref.maxScrollChange;\n  var scrolledViewport = scrollViewport(viewport, add(viewport.scroll.current, maxScrollChange));\n  var scrolledDroppable = destination.frame ? scrollDroppable(destination, add(destination.frame.scroll.current, maxScrollChange)) : destination;\n  var last = impact.displaced;\n  var withViewportScroll = getDisplacementGroups({\n    afterDragging: getDraggables(last.all, draggables),\n    destination: destination,\n    displacedBy: impact.displacedBy,\n    viewport: scrolledViewport.frame,\n    last: last,\n    forceShouldAnimate: false\n  });\n  var withDroppableScroll = getDisplacementGroups({\n    afterDragging: getDraggables(last.all, draggables),\n    destination: scrolledDroppable,\n    displacedBy: impact.displacedBy,\n    viewport: viewport.frame,\n    last: last,\n    forceShouldAnimate: false\n  });\n  var invisible = {};\n  var visible = {};\n  var groups = [last, withViewportScroll, withDroppableScroll];\n  last.all.forEach(function (id) {\n    var displacement = tryGetVisible(id, groups);\n\n    if (displacement) {\n      visible[id] = displacement;\n      return;\n    }\n\n    invisible[id] = true;\n  });\n\n  var newImpact = _extends({}, impact, {\n    displaced: {\n      all: last.all,\n      invisible: invisible,\n      visible: visible\n    }\n  });\n\n  return newImpact;\n});\n\nvar withViewportDisplacement = (function (viewport, point) {\n  return add(viewport.scroll.diff.displacement, point);\n});\n\nvar getClientFromPageBorderBoxCenter = (function (_ref) {\n  var pageBorderBoxCenter = _ref.pageBorderBoxCenter,\n      draggable = _ref.draggable,\n      viewport = _ref.viewport;\n  var withoutPageScrollChange = withViewportDisplacement(viewport, pageBorderBoxCenter);\n  var offset = subtract(withoutPageScrollChange, draggable.page.borderBox.center);\n  return add(draggable.client.borderBox.center, offset);\n});\n\nvar isTotallyVisibleInNewLocation = (function (_ref) {\n  var draggable = _ref.draggable,\n      destination = _ref.destination,\n      newPageBorderBoxCenter = _ref.newPageBorderBoxCenter,\n      viewport = _ref.viewport,\n      withDroppableDisplacement = _ref.withDroppableDisplacement,\n      _ref$onlyOnMainAxis = _ref.onlyOnMainAxis,\n      onlyOnMainAxis = _ref$onlyOnMainAxis === void 0 ? false : _ref$onlyOnMainAxis;\n  var changeNeeded = subtract(newPageBorderBoxCenter, draggable.page.borderBox.center);\n  var shifted = offsetByPosition(draggable.page.borderBox, changeNeeded);\n  var args = {\n    target: shifted,\n    destination: destination,\n    withDroppableDisplacement: withDroppableDisplacement,\n    viewport: viewport\n  };\n  return onlyOnMainAxis ? isTotallyVisibleOnAxis(args) : isTotallyVisible(args);\n});\n\nvar moveToNextPlace = (function (_ref) {\n  var isMovingForward = _ref.isMovingForward,\n      draggable = _ref.draggable,\n      destination = _ref.destination,\n      draggables = _ref.draggables,\n      previousImpact = _ref.previousImpact,\n      viewport = _ref.viewport,\n      previousPageBorderBoxCenter = _ref.previousPageBorderBoxCenter,\n      previousClientSelection = _ref.previousClientSelection,\n      afterCritical = _ref.afterCritical;\n\n  if (!destination.isEnabled) {\n    return null;\n  }\n\n  var insideDestination = getDraggablesInsideDroppable(destination.descriptor.id, draggables);\n  var isInHomeList = isHomeOf(draggable, destination);\n  var impact = moveToNextCombine({\n    isMovingForward: isMovingForward,\n    draggable: draggable,\n    destination: destination,\n    insideDestination: insideDestination,\n    previousImpact: previousImpact\n  }) || moveToNextIndex({\n    isMovingForward: isMovingForward,\n    isInHomeList: isInHomeList,\n    draggable: draggable,\n    draggables: draggables,\n    destination: destination,\n    insideDestination: insideDestination,\n    previousImpact: previousImpact,\n    viewport: viewport,\n    afterCritical: afterCritical\n  });\n\n  if (!impact) {\n    return null;\n  }\n\n  var pageBorderBoxCenter = getPageBorderBoxCenterFromImpact({\n    impact: impact,\n    draggable: draggable,\n    droppable: destination,\n    draggables: draggables,\n    afterCritical: afterCritical\n  });\n  var isVisibleInNewLocation = isTotallyVisibleInNewLocation({\n    draggable: draggable,\n    destination: destination,\n    newPageBorderBoxCenter: pageBorderBoxCenter,\n    viewport: viewport.frame,\n    withDroppableDisplacement: false,\n    onlyOnMainAxis: true\n  });\n\n  if (isVisibleInNewLocation) {\n    var clientSelection = getClientFromPageBorderBoxCenter({\n      pageBorderBoxCenter: pageBorderBoxCenter,\n      draggable: draggable,\n      viewport: viewport\n    });\n    return {\n      clientSelection: clientSelection,\n      impact: impact,\n      scrollJumpRequest: null\n    };\n  }\n\n  var distance = subtract(pageBorderBoxCenter, previousPageBorderBoxCenter);\n  var cautious = speculativelyIncrease({\n    impact: impact,\n    viewport: viewport,\n    destination: destination,\n    draggables: draggables,\n    maxScrollChange: distance\n  });\n  return {\n    clientSelection: previousClientSelection,\n    impact: cautious,\n    scrollJumpRequest: distance\n  };\n});\n\nvar getKnownActive = function getKnownActive(droppable) {\n  var rect = droppable.subject.active;\n  !rect ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot get clipped area from droppable') : invariant(false) : void 0;\n  return rect;\n};\n\nvar getBestCrossAxisDroppable = (function (_ref) {\n  var isMovingForward = _ref.isMovingForward,\n      pageBorderBoxCenter = _ref.pageBorderBoxCenter,\n      source = _ref.source,\n      droppables = _ref.droppables,\n      viewport = _ref.viewport;\n  var active = source.subject.active;\n\n  if (!active) {\n    return null;\n  }\n\n  var axis = source.axis;\n  var isBetweenSourceClipped = isWithin(active[axis.start], active[axis.end]);\n  var candidates = toDroppableList(droppables).filter(function (droppable) {\n    return droppable !== source;\n  }).filter(function (droppable) {\n    return droppable.isEnabled;\n  }).filter(function (droppable) {\n    return Boolean(droppable.subject.active);\n  }).filter(function (droppable) {\n    return isPartiallyVisibleThroughFrame(viewport.frame)(getKnownActive(droppable));\n  }).filter(function (droppable) {\n    var activeOfTarget = getKnownActive(droppable);\n\n    if (isMovingForward) {\n      return active[axis.crossAxisEnd] < activeOfTarget[axis.crossAxisEnd];\n    }\n\n    return activeOfTarget[axis.crossAxisStart] < active[axis.crossAxisStart];\n  }).filter(function (droppable) {\n    var activeOfTarget = getKnownActive(droppable);\n    var isBetweenDestinationClipped = isWithin(activeOfTarget[axis.start], activeOfTarget[axis.end]);\n    return isBetweenSourceClipped(activeOfTarget[axis.start]) || isBetweenSourceClipped(activeOfTarget[axis.end]) || isBetweenDestinationClipped(active[axis.start]) || isBetweenDestinationClipped(active[axis.end]);\n  }).sort(function (a, b) {\n    var first = getKnownActive(a)[axis.crossAxisStart];\n    var second = getKnownActive(b)[axis.crossAxisStart];\n\n    if (isMovingForward) {\n      return first - second;\n    }\n\n    return second - first;\n  }).filter(function (droppable, index, array) {\n    return getKnownActive(droppable)[axis.crossAxisStart] === getKnownActive(array[0])[axis.crossAxisStart];\n  });\n\n  if (!candidates.length) {\n    return null;\n  }\n\n  if (candidates.length === 1) {\n    return candidates[0];\n  }\n\n  var contains = candidates.filter(function (droppable) {\n    var isWithinDroppable = isWithin(getKnownActive(droppable)[axis.start], getKnownActive(droppable)[axis.end]);\n    return isWithinDroppable(pageBorderBoxCenter[axis.line]);\n  });\n\n  if (contains.length === 1) {\n    return contains[0];\n  }\n\n  if (contains.length > 1) {\n    return contains.sort(function (a, b) {\n      return getKnownActive(a)[axis.start] - getKnownActive(b)[axis.start];\n    })[0];\n  }\n\n  return candidates.sort(function (a, b) {\n    var first = closest(pageBorderBoxCenter, getCorners(getKnownActive(a)));\n    var second = closest(pageBorderBoxCenter, getCorners(getKnownActive(b)));\n\n    if (first !== second) {\n      return first - second;\n    }\n\n    return getKnownActive(a)[axis.start] - getKnownActive(b)[axis.start];\n  })[0];\n});\n\nvar getCurrentPageBorderBoxCenter = function getCurrentPageBorderBoxCenter(draggable, afterCritical) {\n  var original = draggable.page.borderBox.center;\n  return didStartAfterCritical(draggable.descriptor.id, afterCritical) ? subtract(original, afterCritical.displacedBy.point) : original;\n};\nvar getCurrentPageBorderBox = function getCurrentPageBorderBox(draggable, afterCritical) {\n  var original = draggable.page.borderBox;\n  return didStartAfterCritical(draggable.descriptor.id, afterCritical) ? offsetByPosition(original, negate(afterCritical.displacedBy.point)) : original;\n};\n\nvar getClosestDraggable = (function (_ref) {\n  var pageBorderBoxCenter = _ref.pageBorderBoxCenter,\n      viewport = _ref.viewport,\n      destination = _ref.destination,\n      insideDestination = _ref.insideDestination,\n      afterCritical = _ref.afterCritical;\n  var sorted = insideDestination.filter(function (draggable) {\n    return isTotallyVisible({\n      target: getCurrentPageBorderBox(draggable, afterCritical),\n      destination: destination,\n      viewport: viewport.frame,\n      withDroppableDisplacement: true\n    });\n  }).sort(function (a, b) {\n    var distanceToA = distance(pageBorderBoxCenter, withDroppableDisplacement(destination, getCurrentPageBorderBoxCenter(a, afterCritical)));\n    var distanceToB = distance(pageBorderBoxCenter, withDroppableDisplacement(destination, getCurrentPageBorderBoxCenter(b, afterCritical)));\n\n    if (distanceToA < distanceToB) {\n      return -1;\n    }\n\n    if (distanceToB < distanceToA) {\n      return 1;\n    }\n\n    return a.descriptor.index - b.descriptor.index;\n  });\n  return sorted[0] || null;\n});\n\nvar getDisplacedBy = memoizeOne(function getDisplacedBy(axis, displaceBy) {\n  var displacement = displaceBy[axis.line];\n  return {\n    value: displacement,\n    point: patch(axis.line, displacement)\n  };\n});\n\nvar getRequiredGrowthForPlaceholder = function getRequiredGrowthForPlaceholder(droppable, placeholderSize, draggables) {\n  var axis = droppable.axis;\n\n  if (droppable.descriptor.mode === 'virtual') {\n    return patch(axis.line, placeholderSize[axis.line]);\n  }\n\n  var availableSpace = droppable.subject.page.contentBox[axis.size];\n  var insideDroppable = getDraggablesInsideDroppable(droppable.descriptor.id, draggables);\n  var spaceUsed = insideDroppable.reduce(function (sum, dimension) {\n    return sum + dimension.client.marginBox[axis.size];\n  }, 0);\n  var requiredSpace = spaceUsed + placeholderSize[axis.line];\n  var needsToGrowBy = requiredSpace - availableSpace;\n\n  if (needsToGrowBy <= 0) {\n    return null;\n  }\n\n  return patch(axis.line, needsToGrowBy);\n};\n\nvar withMaxScroll = function withMaxScroll(frame, max) {\n  return _extends({}, frame, {\n    scroll: _extends({}, frame.scroll, {\n      max: max\n    })\n  });\n};\n\nvar addPlaceholder = function addPlaceholder(droppable, draggable, draggables) {\n  var frame = droppable.frame;\n  !!isHomeOf(draggable, droppable) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Should not add placeholder space to home list') : invariant(false) : void 0;\n  !!droppable.subject.withPlaceholder ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot add placeholder size to a subject when it already has one') : invariant(false) : void 0;\n  var placeholderSize = getDisplacedBy(droppable.axis, draggable.displaceBy).point;\n  var requiredGrowth = getRequiredGrowthForPlaceholder(droppable, placeholderSize, draggables);\n  var added = {\n    placeholderSize: placeholderSize,\n    increasedBy: requiredGrowth,\n    oldFrameMaxScroll: droppable.frame ? droppable.frame.scroll.max : null\n  };\n\n  if (!frame) {\n    var _subject = getSubject({\n      page: droppable.subject.page,\n      withPlaceholder: added,\n      axis: droppable.axis,\n      frame: droppable.frame\n    });\n\n    return _extends({}, droppable, {\n      subject: _subject\n    });\n  }\n\n  var maxScroll = requiredGrowth ? add(frame.scroll.max, requiredGrowth) : frame.scroll.max;\n  var newFrame = withMaxScroll(frame, maxScroll);\n  var subject = getSubject({\n    page: droppable.subject.page,\n    withPlaceholder: added,\n    axis: droppable.axis,\n    frame: newFrame\n  });\n  return _extends({}, droppable, {\n    subject: subject,\n    frame: newFrame\n  });\n};\nvar removePlaceholder = function removePlaceholder(droppable) {\n  var added = droppable.subject.withPlaceholder;\n  !added ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot remove placeholder form subject when there was none') : invariant(false) : void 0;\n  var frame = droppable.frame;\n\n  if (!frame) {\n    var _subject2 = getSubject({\n      page: droppable.subject.page,\n      axis: droppable.axis,\n      frame: null,\n      withPlaceholder: null\n    });\n\n    return _extends({}, droppable, {\n      subject: _subject2\n    });\n  }\n\n  var oldMaxScroll = added.oldFrameMaxScroll;\n  !oldMaxScroll ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Expected droppable with frame to have old max frame scroll when removing placeholder') : invariant(false) : void 0;\n  var newFrame = withMaxScroll(frame, oldMaxScroll);\n  var subject = getSubject({\n    page: droppable.subject.page,\n    axis: droppable.axis,\n    frame: newFrame,\n    withPlaceholder: null\n  });\n  return _extends({}, droppable, {\n    subject: subject,\n    frame: newFrame\n  });\n};\n\nvar moveToNewDroppable = (function (_ref) {\n  var previousPageBorderBoxCenter = _ref.previousPageBorderBoxCenter,\n      moveRelativeTo = _ref.moveRelativeTo,\n      insideDestination = _ref.insideDestination,\n      draggable = _ref.draggable,\n      draggables = _ref.draggables,\n      destination = _ref.destination,\n      viewport = _ref.viewport,\n      afterCritical = _ref.afterCritical;\n\n  if (!moveRelativeTo) {\n    if (insideDestination.length) {\n      return null;\n    }\n\n    var proposed = {\n      displaced: emptyGroups,\n      displacedBy: noDisplacedBy,\n      at: {\n        type: 'REORDER',\n        destination: {\n          droppableId: destination.descriptor.id,\n          index: 0\n        }\n      }\n    };\n    var proposedPageBorderBoxCenter = getPageBorderBoxCenterFromImpact({\n      impact: proposed,\n      draggable: draggable,\n      droppable: destination,\n      draggables: draggables,\n      afterCritical: afterCritical\n    });\n    var withPlaceholder = isHomeOf(draggable, destination) ? destination : addPlaceholder(destination, draggable, draggables);\n    var isVisibleInNewLocation = isTotallyVisibleInNewLocation({\n      draggable: draggable,\n      destination: withPlaceholder,\n      newPageBorderBoxCenter: proposedPageBorderBoxCenter,\n      viewport: viewport.frame,\n      withDroppableDisplacement: false,\n      onlyOnMainAxis: true\n    });\n    return isVisibleInNewLocation ? proposed : null;\n  }\n\n  var isGoingBeforeTarget = Boolean(previousPageBorderBoxCenter[destination.axis.line] <= moveRelativeTo.page.borderBox.center[destination.axis.line]);\n\n  var proposedIndex = function () {\n    var relativeTo = moveRelativeTo.descriptor.index;\n\n    if (moveRelativeTo.descriptor.id === draggable.descriptor.id) {\n      return relativeTo;\n    }\n\n    if (isGoingBeforeTarget) {\n      return relativeTo;\n    }\n\n    return relativeTo + 1;\n  }();\n\n  var displacedBy = getDisplacedBy(destination.axis, draggable.displaceBy);\n  return calculateReorderImpact({\n    draggable: draggable,\n    insideDestination: insideDestination,\n    destination: destination,\n    viewport: viewport,\n    displacedBy: displacedBy,\n    last: emptyGroups,\n    index: proposedIndex\n  });\n});\n\nvar moveCrossAxis = (function (_ref) {\n  var isMovingForward = _ref.isMovingForward,\n      previousPageBorderBoxCenter = _ref.previousPageBorderBoxCenter,\n      draggable = _ref.draggable,\n      isOver = _ref.isOver,\n      draggables = _ref.draggables,\n      droppables = _ref.droppables,\n      viewport = _ref.viewport,\n      afterCritical = _ref.afterCritical;\n  var destination = getBestCrossAxisDroppable({\n    isMovingForward: isMovingForward,\n    pageBorderBoxCenter: previousPageBorderBoxCenter,\n    source: isOver,\n    droppables: droppables,\n    viewport: viewport\n  });\n\n  if (!destination) {\n    return null;\n  }\n\n  var insideDestination = getDraggablesInsideDroppable(destination.descriptor.id, draggables);\n  var moveRelativeTo = getClosestDraggable({\n    pageBorderBoxCenter: previousPageBorderBoxCenter,\n    viewport: viewport,\n    destination: destination,\n    insideDestination: insideDestination,\n    afterCritical: afterCritical\n  });\n  var impact = moveToNewDroppable({\n    previousPageBorderBoxCenter: previousPageBorderBoxCenter,\n    destination: destination,\n    draggable: draggable,\n    draggables: draggables,\n    moveRelativeTo: moveRelativeTo,\n    insideDestination: insideDestination,\n    viewport: viewport,\n    afterCritical: afterCritical\n  });\n\n  if (!impact) {\n    return null;\n  }\n\n  var pageBorderBoxCenter = getPageBorderBoxCenterFromImpact({\n    impact: impact,\n    draggable: draggable,\n    droppable: destination,\n    draggables: draggables,\n    afterCritical: afterCritical\n  });\n  var clientSelection = getClientFromPageBorderBoxCenter({\n    pageBorderBoxCenter: pageBorderBoxCenter,\n    draggable: draggable,\n    viewport: viewport\n  });\n  return {\n    clientSelection: clientSelection,\n    impact: impact,\n    scrollJumpRequest: null\n  };\n});\n\nvar whatIsDraggedOver = (function (impact) {\n  var at = impact.at;\n\n  if (!at) {\n    return null;\n  }\n\n  if (at.type === 'REORDER') {\n    return at.destination.droppableId;\n  }\n\n  return at.combine.droppableId;\n});\n\nvar getDroppableOver = function getDroppableOver(impact, droppables) {\n  var id = whatIsDraggedOver(impact);\n  return id ? droppables[id] : null;\n};\n\nvar moveInDirection = (function (_ref) {\n  var state = _ref.state,\n      type = _ref.type;\n  var isActuallyOver = getDroppableOver(state.impact, state.dimensions.droppables);\n  var isMainAxisMovementAllowed = Boolean(isActuallyOver);\n  var home = state.dimensions.droppables[state.critical.droppable.id];\n  var isOver = isActuallyOver || home;\n  var direction = isOver.axis.direction;\n  var isMovingOnMainAxis = direction === 'vertical' && (type === 'MOVE_UP' || type === 'MOVE_DOWN') || direction === 'horizontal' && (type === 'MOVE_LEFT' || type === 'MOVE_RIGHT');\n\n  if (isMovingOnMainAxis && !isMainAxisMovementAllowed) {\n    return null;\n  }\n\n  var isMovingForward = type === 'MOVE_DOWN' || type === 'MOVE_RIGHT';\n  var draggable = state.dimensions.draggables[state.critical.draggable.id];\n  var previousPageBorderBoxCenter = state.current.page.borderBoxCenter;\n  var _state$dimensions = state.dimensions,\n      draggables = _state$dimensions.draggables,\n      droppables = _state$dimensions.droppables;\n  return isMovingOnMainAxis ? moveToNextPlace({\n    isMovingForward: isMovingForward,\n    previousPageBorderBoxCenter: previousPageBorderBoxCenter,\n    draggable: draggable,\n    destination: isOver,\n    draggables: draggables,\n    viewport: state.viewport,\n    previousClientSelection: state.current.client.selection,\n    previousImpact: state.impact,\n    afterCritical: state.afterCritical\n  }) : moveCrossAxis({\n    isMovingForward: isMovingForward,\n    previousPageBorderBoxCenter: previousPageBorderBoxCenter,\n    draggable: draggable,\n    isOver: isOver,\n    draggables: draggables,\n    droppables: droppables,\n    viewport: state.viewport,\n    afterCritical: state.afterCritical\n  });\n});\n\nfunction isMovementAllowed(state) {\n  return state.phase === 'DRAGGING' || state.phase === 'COLLECTING';\n}\n\nfunction isPositionInFrame(frame) {\n  var isWithinVertical = isWithin(frame.top, frame.bottom);\n  var isWithinHorizontal = isWithin(frame.left, frame.right);\n  return function run(point) {\n    return isWithinVertical(point.y) && isWithinHorizontal(point.x);\n  };\n}\n\nfunction getHasOverlap(first, second) {\n  return first.left < second.right && first.right > second.left && first.top < second.bottom && first.bottom > second.top;\n}\n\nfunction getFurthestAway(_ref) {\n  var pageBorderBox = _ref.pageBorderBox,\n      draggable = _ref.draggable,\n      candidates = _ref.candidates;\n  var startCenter = draggable.page.borderBox.center;\n  var sorted = candidates.map(function (candidate) {\n    var axis = candidate.axis;\n    var target = patch(candidate.axis.line, pageBorderBox.center[axis.line], candidate.page.borderBox.center[axis.crossAxisLine]);\n    return {\n      id: candidate.descriptor.id,\n      distance: distance(startCenter, target)\n    };\n  }).sort(function (a, b) {\n    return b.distance - a.distance;\n  });\n  return sorted[0] ? sorted[0].id : null;\n}\n\nfunction getDroppableOver$1(_ref2) {\n  var pageBorderBox = _ref2.pageBorderBox,\n      draggable = _ref2.draggable,\n      droppables = _ref2.droppables;\n  var candidates = toDroppableList(droppables).filter(function (item) {\n    if (!item.isEnabled) {\n      return false;\n    }\n\n    var active = item.subject.active;\n\n    if (!active) {\n      return false;\n    }\n\n    if (!getHasOverlap(pageBorderBox, active)) {\n      return false;\n    }\n\n    if (isPositionInFrame(active)(pageBorderBox.center)) {\n      return true;\n    }\n\n    var axis = item.axis;\n    var childCenter = active.center[axis.crossAxisLine];\n    var crossAxisStart = pageBorderBox[axis.crossAxisStart];\n    var crossAxisEnd = pageBorderBox[axis.crossAxisEnd];\n    var isContained = isWithin(active[axis.crossAxisStart], active[axis.crossAxisEnd]);\n    var isStartContained = isContained(crossAxisStart);\n    var isEndContained = isContained(crossAxisEnd);\n\n    if (!isStartContained && !isEndContained) {\n      return true;\n    }\n\n    if (isStartContained) {\n      return crossAxisStart < childCenter;\n    }\n\n    return crossAxisEnd > childCenter;\n  });\n\n  if (!candidates.length) {\n    return null;\n  }\n\n  if (candidates.length === 1) {\n    return candidates[0].descriptor.id;\n  }\n\n  return getFurthestAway({\n    pageBorderBox: pageBorderBox,\n    draggable: draggable,\n    candidates: candidates\n  });\n}\n\nvar offsetRectByPosition = function offsetRectByPosition(rect, point) {\n  return getRect(offsetByPosition(rect, point));\n};\n\nvar withDroppableScroll = (function (droppable, area) {\n  var frame = droppable.frame;\n\n  if (!frame) {\n    return area;\n  }\n\n  return offsetRectByPosition(area, frame.scroll.diff.value);\n});\n\nfunction getIsDisplaced(_ref) {\n  var displaced = _ref.displaced,\n      id = _ref.id;\n  return Boolean(displaced.visible[id] || displaced.invisible[id]);\n}\n\nfunction atIndex(_ref) {\n  var draggable = _ref.draggable,\n      closest = _ref.closest,\n      inHomeList = _ref.inHomeList;\n\n  if (!closest) {\n    return null;\n  }\n\n  if (!inHomeList) {\n    return closest.descriptor.index;\n  }\n\n  if (closest.descriptor.index > draggable.descriptor.index) {\n    return closest.descriptor.index - 1;\n  }\n\n  return closest.descriptor.index;\n}\n\nvar getReorderImpact = (function (_ref2) {\n  var targetRect = _ref2.pageBorderBoxWithDroppableScroll,\n      draggable = _ref2.draggable,\n      destination = _ref2.destination,\n      insideDestination = _ref2.insideDestination,\n      last = _ref2.last,\n      viewport = _ref2.viewport,\n      afterCritical = _ref2.afterCritical;\n  var axis = destination.axis;\n  var displacedBy = getDisplacedBy(destination.axis, draggable.displaceBy);\n  var displacement = displacedBy.value;\n  var targetStart = targetRect[axis.start];\n  var targetEnd = targetRect[axis.end];\n  var withoutDragging = removeDraggableFromList(draggable, insideDestination);\n  var closest = find(withoutDragging, function (child) {\n    var id = child.descriptor.id;\n    var childCenter = child.page.borderBox.center[axis.line];\n    var didStartAfterCritical$1 = didStartAfterCritical(id, afterCritical);\n    var isDisplaced = getIsDisplaced({\n      displaced: last,\n      id: id\n    });\n\n    if (didStartAfterCritical$1) {\n      if (isDisplaced) {\n        return targetEnd <= childCenter;\n      }\n\n      return targetStart < childCenter - displacement;\n    }\n\n    if (isDisplaced) {\n      return targetEnd <= childCenter + displacement;\n    }\n\n    return targetStart < childCenter;\n  });\n  var newIndex = atIndex({\n    draggable: draggable,\n    closest: closest,\n    inHomeList: isHomeOf(draggable, destination)\n  });\n  return calculateReorderImpact({\n    draggable: draggable,\n    insideDestination: insideDestination,\n    destination: destination,\n    viewport: viewport,\n    last: last,\n    displacedBy: displacedBy,\n    index: newIndex\n  });\n});\n\nvar combineThresholdDivisor = 4;\nvar getCombineImpact = (function (_ref) {\n  var draggable = _ref.draggable,\n      targetRect = _ref.pageBorderBoxWithDroppableScroll,\n      previousImpact = _ref.previousImpact,\n      destination = _ref.destination,\n      insideDestination = _ref.insideDestination,\n      afterCritical = _ref.afterCritical;\n\n  if (!destination.isCombineEnabled) {\n    return null;\n  }\n\n  var axis = destination.axis;\n  var displacedBy = getDisplacedBy(destination.axis, draggable.displaceBy);\n  var displacement = displacedBy.value;\n  var targetStart = targetRect[axis.start];\n  var targetEnd = targetRect[axis.end];\n  var withoutDragging = removeDraggableFromList(draggable, insideDestination);\n  var combineWith = find(withoutDragging, function (child) {\n    var id = child.descriptor.id;\n    var childRect = child.page.borderBox;\n    var childSize = childRect[axis.size];\n    var threshold = childSize / combineThresholdDivisor;\n    var didStartAfterCritical$1 = didStartAfterCritical(id, afterCritical);\n    var isDisplaced = getIsDisplaced({\n      displaced: previousImpact.displaced,\n      id: id\n    });\n\n    if (didStartAfterCritical$1) {\n      if (isDisplaced) {\n        return targetEnd > childRect[axis.start] + threshold && targetEnd < childRect[axis.end] - threshold;\n      }\n\n      return targetStart > childRect[axis.start] - displacement + threshold && targetStart < childRect[axis.end] - displacement - threshold;\n    }\n\n    if (isDisplaced) {\n      return targetEnd > childRect[axis.start] + displacement + threshold && targetEnd < childRect[axis.end] + displacement - threshold;\n    }\n\n    return targetStart > childRect[axis.start] + threshold && targetStart < childRect[axis.end] - threshold;\n  });\n\n  if (!combineWith) {\n    return null;\n  }\n\n  var impact = {\n    displacedBy: displacedBy,\n    displaced: previousImpact.displaced,\n    at: {\n      type: 'COMBINE',\n      combine: {\n        draggableId: combineWith.descriptor.id,\n        droppableId: destination.descriptor.id\n      }\n    }\n  };\n  return impact;\n});\n\nvar getDragImpact = (function (_ref) {\n  var pageOffset = _ref.pageOffset,\n      draggable = _ref.draggable,\n      draggables = _ref.draggables,\n      droppables = _ref.droppables,\n      previousImpact = _ref.previousImpact,\n      viewport = _ref.viewport,\n      afterCritical = _ref.afterCritical;\n  var pageBorderBox = offsetRectByPosition(draggable.page.borderBox, pageOffset);\n  var destinationId = getDroppableOver$1({\n    pageBorderBox: pageBorderBox,\n    draggable: draggable,\n    droppables: droppables\n  });\n\n  if (!destinationId) {\n    return noImpact;\n  }\n\n  var destination = droppables[destinationId];\n  var insideDestination = getDraggablesInsideDroppable(destination.descriptor.id, draggables);\n  var pageBorderBoxWithDroppableScroll = withDroppableScroll(destination, pageBorderBox);\n  return getCombineImpact({\n    pageBorderBoxWithDroppableScroll: pageBorderBoxWithDroppableScroll,\n    draggable: draggable,\n    previousImpact: previousImpact,\n    destination: destination,\n    insideDestination: insideDestination,\n    afterCritical: afterCritical\n  }) || getReorderImpact({\n    pageBorderBoxWithDroppableScroll: pageBorderBoxWithDroppableScroll,\n    draggable: draggable,\n    destination: destination,\n    insideDestination: insideDestination,\n    last: previousImpact.displaced,\n    viewport: viewport,\n    afterCritical: afterCritical\n  });\n});\n\nvar patchDroppableMap = (function (droppables, updated) {\n  var _extends2;\n\n  return _extends({}, droppables, (_extends2 = {}, _extends2[updated.descriptor.id] = updated, _extends2));\n});\n\nvar clearUnusedPlaceholder = function clearUnusedPlaceholder(_ref) {\n  var previousImpact = _ref.previousImpact,\n      impact = _ref.impact,\n      droppables = _ref.droppables;\n  var last = whatIsDraggedOver(previousImpact);\n  var now = whatIsDraggedOver(impact);\n\n  if (!last) {\n    return droppables;\n  }\n\n  if (last === now) {\n    return droppables;\n  }\n\n  var lastDroppable = droppables[last];\n\n  if (!lastDroppable.subject.withPlaceholder) {\n    return droppables;\n  }\n\n  var updated = removePlaceholder(lastDroppable);\n  return patchDroppableMap(droppables, updated);\n};\n\nvar recomputePlaceholders = (function (_ref2) {\n  var draggable = _ref2.draggable,\n      draggables = _ref2.draggables,\n      droppables = _ref2.droppables,\n      previousImpact = _ref2.previousImpact,\n      impact = _ref2.impact;\n  var cleaned = clearUnusedPlaceholder({\n    previousImpact: previousImpact,\n    impact: impact,\n    droppables: droppables\n  });\n  var isOver = whatIsDraggedOver(impact);\n\n  if (!isOver) {\n    return cleaned;\n  }\n\n  var droppable = droppables[isOver];\n\n  if (isHomeOf(draggable, droppable)) {\n    return cleaned;\n  }\n\n  if (droppable.subject.withPlaceholder) {\n    return cleaned;\n  }\n\n  var patched = addPlaceholder(droppable, draggable, draggables);\n  return patchDroppableMap(cleaned, patched);\n});\n\nvar update = (function (_ref) {\n  var state = _ref.state,\n      forcedClientSelection = _ref.clientSelection,\n      forcedDimensions = _ref.dimensions,\n      forcedViewport = _ref.viewport,\n      forcedImpact = _ref.impact,\n      scrollJumpRequest = _ref.scrollJumpRequest;\n  var viewport = forcedViewport || state.viewport;\n  var dimensions = forcedDimensions || state.dimensions;\n  var clientSelection = forcedClientSelection || state.current.client.selection;\n  var offset = subtract(clientSelection, state.initial.client.selection);\n  var client = {\n    offset: offset,\n    selection: clientSelection,\n    borderBoxCenter: add(state.initial.client.borderBoxCenter, offset)\n  };\n  var page = {\n    selection: add(client.selection, viewport.scroll.current),\n    borderBoxCenter: add(client.borderBoxCenter, viewport.scroll.current),\n    offset: add(client.offset, viewport.scroll.diff.value)\n  };\n  var current = {\n    client: client,\n    page: page\n  };\n\n  if (state.phase === 'COLLECTING') {\n    return _extends({\n      phase: 'COLLECTING'\n    }, state, {\n      dimensions: dimensions,\n      viewport: viewport,\n      current: current\n    });\n  }\n\n  var draggable = dimensions.draggables[state.critical.draggable.id];\n  var newImpact = forcedImpact || getDragImpact({\n    pageOffset: page.offset,\n    draggable: draggable,\n    draggables: dimensions.draggables,\n    droppables: dimensions.droppables,\n    previousImpact: state.impact,\n    viewport: viewport,\n    afterCritical: state.afterCritical\n  });\n  var withUpdatedPlaceholders = recomputePlaceholders({\n    draggable: draggable,\n    impact: newImpact,\n    previousImpact: state.impact,\n    draggables: dimensions.draggables,\n    droppables: dimensions.droppables\n  });\n\n  var result = _extends({}, state, {\n    current: current,\n    dimensions: {\n      draggables: dimensions.draggables,\n      droppables: withUpdatedPlaceholders\n    },\n    impact: newImpact,\n    viewport: viewport,\n    scrollJumpRequest: scrollJumpRequest || null,\n    forceShouldAnimate: scrollJumpRequest ? false : null\n  });\n\n  return result;\n});\n\nfunction getDraggables$1(ids, draggables) {\n  return ids.map(function (id) {\n    return draggables[id];\n  });\n}\n\nvar recompute = (function (_ref) {\n  var impact = _ref.impact,\n      viewport = _ref.viewport,\n      draggables = _ref.draggables,\n      destination = _ref.destination,\n      forceShouldAnimate = _ref.forceShouldAnimate;\n  var last = impact.displaced;\n  var afterDragging = getDraggables$1(last.all, draggables);\n  var displaced = getDisplacementGroups({\n    afterDragging: afterDragging,\n    destination: destination,\n    displacedBy: impact.displacedBy,\n    viewport: viewport.frame,\n    forceShouldAnimate: forceShouldAnimate,\n    last: last\n  });\n  return _extends({}, impact, {\n    displaced: displaced\n  });\n});\n\nvar getClientBorderBoxCenter = (function (_ref) {\n  var impact = _ref.impact,\n      draggable = _ref.draggable,\n      droppable = _ref.droppable,\n      draggables = _ref.draggables,\n      viewport = _ref.viewport,\n      afterCritical = _ref.afterCritical;\n  var pageBorderBoxCenter = getPageBorderBoxCenterFromImpact({\n    impact: impact,\n    draggable: draggable,\n    draggables: draggables,\n    droppable: droppable,\n    afterCritical: afterCritical\n  });\n  return getClientFromPageBorderBoxCenter({\n    pageBorderBoxCenter: pageBorderBoxCenter,\n    draggable: draggable,\n    viewport: viewport\n  });\n});\n\nvar refreshSnap = (function (_ref) {\n  var state = _ref.state,\n      forcedDimensions = _ref.dimensions,\n      forcedViewport = _ref.viewport;\n  !(state.movementMode === 'SNAP') ? process.env.NODE_ENV !== \"production\" ? invariant(false) : invariant(false) : void 0;\n  var needsVisibilityCheck = state.impact;\n  var viewport = forcedViewport || state.viewport;\n  var dimensions = forcedDimensions || state.dimensions;\n  var draggables = dimensions.draggables,\n      droppables = dimensions.droppables;\n  var draggable = draggables[state.critical.draggable.id];\n  var isOver = whatIsDraggedOver(needsVisibilityCheck);\n  !isOver ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Must be over a destination in SNAP movement mode') : invariant(false) : void 0;\n  var destination = droppables[isOver];\n  var impact = recompute({\n    impact: needsVisibilityCheck,\n    viewport: viewport,\n    destination: destination,\n    draggables: draggables\n  });\n  var clientSelection = getClientBorderBoxCenter({\n    impact: impact,\n    draggable: draggable,\n    droppable: destination,\n    draggables: draggables,\n    viewport: viewport,\n    afterCritical: state.afterCritical\n  });\n  return update({\n    impact: impact,\n    clientSelection: clientSelection,\n    state: state,\n    dimensions: dimensions,\n    viewport: viewport\n  });\n});\n\nvar getHomeLocation = (function (descriptor) {\n  return {\n    index: descriptor.index,\n    droppableId: descriptor.droppableId\n  };\n});\n\nvar getLiftEffect = (function (_ref) {\n  var draggable = _ref.draggable,\n      home = _ref.home,\n      draggables = _ref.draggables,\n      viewport = _ref.viewport;\n  var displacedBy = getDisplacedBy(home.axis, draggable.displaceBy);\n  var insideHome = getDraggablesInsideDroppable(home.descriptor.id, draggables);\n  var rawIndex = insideHome.indexOf(draggable);\n  !(rawIndex !== -1) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Expected draggable to be inside home list') : invariant(false) : void 0;\n  var afterDragging = insideHome.slice(rawIndex + 1);\n  var effected = afterDragging.reduce(function (previous, item) {\n    previous[item.descriptor.id] = true;\n    return previous;\n  }, {});\n  var afterCritical = {\n    inVirtualList: home.descriptor.mode === 'virtual',\n    displacedBy: displacedBy,\n    effected: effected\n  };\n  var displaced = getDisplacementGroups({\n    afterDragging: afterDragging,\n    destination: home,\n    displacedBy: displacedBy,\n    last: null,\n    viewport: viewport.frame,\n    forceShouldAnimate: false\n  });\n  var impact = {\n    displaced: displaced,\n    displacedBy: displacedBy,\n    at: {\n      type: 'REORDER',\n      destination: getHomeLocation(draggable.descriptor)\n    }\n  };\n  return {\n    impact: impact,\n    afterCritical: afterCritical\n  };\n});\n\nvar patchDimensionMap = (function (dimensions, updated) {\n  return {\n    draggables: dimensions.draggables,\n    droppables: patchDroppableMap(dimensions.droppables, updated)\n  };\n});\n\nvar start = function start(key) {\n  if (process.env.NODE_ENV !== 'production') {\n    {\n      return;\n    }\n  }\n};\nvar finish = function finish(key) {\n  if (process.env.NODE_ENV !== 'production') {\n    {\n      return;\n    }\n  }\n};\n\nvar offsetDraggable = (function (_ref) {\n  var draggable = _ref.draggable,\n      offset$1 = _ref.offset,\n      initialWindowScroll = _ref.initialWindowScroll;\n  var client = offset(draggable.client, offset$1);\n  var page = withScroll(client, initialWindowScroll);\n\n  var moved = _extends({}, draggable, {\n    placeholder: _extends({}, draggable.placeholder, {\n      client: client\n    }),\n    client: client,\n    page: page\n  });\n\n  return moved;\n});\n\nvar getFrame = (function (droppable) {\n  var frame = droppable.frame;\n  !frame ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Expected Droppable to have a frame') : invariant(false) : void 0;\n  return frame;\n});\n\nvar adjustAdditionsForScrollChanges = (function (_ref) {\n  var additions = _ref.additions,\n      updatedDroppables = _ref.updatedDroppables,\n      viewport = _ref.viewport;\n  var windowScrollChange = viewport.scroll.diff.value;\n  return additions.map(function (draggable) {\n    var droppableId = draggable.descriptor.droppableId;\n    var modified = updatedDroppables[droppableId];\n    var frame = getFrame(modified);\n    var droppableScrollChange = frame.scroll.diff.value;\n    var totalChange = add(windowScrollChange, droppableScrollChange);\n    var moved = offsetDraggable({\n      draggable: draggable,\n      offset: totalChange,\n      initialWindowScroll: viewport.scroll.initial\n    });\n    return moved;\n  });\n});\n\nvar publishWhileDraggingInVirtual = (function (_ref) {\n  var state = _ref.state,\n      published = _ref.published;\n  start();\n  var withScrollChange = published.modified.map(function (update) {\n    var existing = state.dimensions.droppables[update.droppableId];\n    var scrolled = scrollDroppable(existing, update.scroll);\n    return scrolled;\n  });\n\n  var droppables = _extends({}, state.dimensions.droppables, {}, toDroppableMap(withScrollChange));\n\n  var updatedAdditions = toDraggableMap(adjustAdditionsForScrollChanges({\n    additions: published.additions,\n    updatedDroppables: droppables,\n    viewport: state.viewport\n  }));\n\n  var draggables = _extends({}, state.dimensions.draggables, {}, updatedAdditions);\n\n  published.removals.forEach(function (id) {\n    delete draggables[id];\n  });\n  var dimensions = {\n    droppables: droppables,\n    draggables: draggables\n  };\n  var wasOverId = whatIsDraggedOver(state.impact);\n  var wasOver = wasOverId ? dimensions.droppables[wasOverId] : null;\n  var draggable = dimensions.draggables[state.critical.draggable.id];\n  var home = dimensions.droppables[state.critical.droppable.id];\n\n  var _getLiftEffect = getLiftEffect({\n    draggable: draggable,\n    home: home,\n    draggables: draggables,\n    viewport: state.viewport\n  }),\n      onLiftImpact = _getLiftEffect.impact,\n      afterCritical = _getLiftEffect.afterCritical;\n\n  var previousImpact = wasOver && wasOver.isCombineEnabled ? state.impact : onLiftImpact;\n  var impact = getDragImpact({\n    pageOffset: state.current.page.offset,\n    draggable: dimensions.draggables[state.critical.draggable.id],\n    draggables: dimensions.draggables,\n    droppables: dimensions.droppables,\n    previousImpact: previousImpact,\n    viewport: state.viewport,\n    afterCritical: afterCritical\n  });\n  finish();\n\n  var draggingState = _extends({\n    phase: 'DRAGGING'\n  }, state, {\n    phase: 'DRAGGING',\n    impact: impact,\n    onLiftImpact: onLiftImpact,\n    dimensions: dimensions,\n    afterCritical: afterCritical,\n    forceShouldAnimate: false\n  });\n\n  if (state.phase === 'COLLECTING') {\n    return draggingState;\n  }\n\n  var dropPending = _extends({\n    phase: 'DROP_PENDING'\n  }, draggingState, {\n    phase: 'DROP_PENDING',\n    reason: state.reason,\n    isWaiting: false\n  });\n\n  return dropPending;\n});\n\nvar isSnapping = function isSnapping(state) {\n  return state.movementMode === 'SNAP';\n};\n\nvar postDroppableChange = function postDroppableChange(state, updated, isEnabledChanging) {\n  var dimensions = patchDimensionMap(state.dimensions, updated);\n\n  if (!isSnapping(state) || isEnabledChanging) {\n    return update({\n      state: state,\n      dimensions: dimensions\n    });\n  }\n\n  return refreshSnap({\n    state: state,\n    dimensions: dimensions\n  });\n};\n\nfunction removeScrollJumpRequest(state) {\n  if (state.isDragging && state.movementMode === 'SNAP') {\n    return _extends({\n      phase: 'DRAGGING'\n    }, state, {\n      scrollJumpRequest: null\n    });\n  }\n\n  return state;\n}\n\nvar idle = {\n  phase: 'IDLE',\n  completed: null,\n  shouldFlush: false\n};\nvar reducer = (function (state, action) {\n  if (state === void 0) {\n    state = idle;\n  }\n\n  if (action.type === 'FLUSH') {\n    return _extends({}, idle, {\n      shouldFlush: true\n    });\n  }\n\n  if (action.type === 'INITIAL_PUBLISH') {\n    !(state.phase === 'IDLE') ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'INITIAL_PUBLISH must come after a IDLE phase') : invariant(false) : void 0;\n    var _action$payload = action.payload,\n        critical = _action$payload.critical,\n        clientSelection = _action$payload.clientSelection,\n        viewport = _action$payload.viewport,\n        dimensions = _action$payload.dimensions,\n        movementMode = _action$payload.movementMode;\n    var draggable = dimensions.draggables[critical.draggable.id];\n    var home = dimensions.droppables[critical.droppable.id];\n    var client = {\n      selection: clientSelection,\n      borderBoxCenter: draggable.client.borderBox.center,\n      offset: origin\n    };\n    var initial = {\n      client: client,\n      page: {\n        selection: add(client.selection, viewport.scroll.initial),\n        borderBoxCenter: add(client.selection, viewport.scroll.initial),\n        offset: add(client.selection, viewport.scroll.diff.value)\n      }\n    };\n    var isWindowScrollAllowed = toDroppableList(dimensions.droppables).every(function (item) {\n      return !item.isFixedOnPage;\n    });\n\n    var _getLiftEffect = getLiftEffect({\n      draggable: draggable,\n      home: home,\n      draggables: dimensions.draggables,\n      viewport: viewport\n    }),\n        impact = _getLiftEffect.impact,\n        afterCritical = _getLiftEffect.afterCritical;\n\n    var result = {\n      phase: 'DRAGGING',\n      isDragging: true,\n      critical: critical,\n      movementMode: movementMode,\n      dimensions: dimensions,\n      initial: initial,\n      current: initial,\n      isWindowScrollAllowed: isWindowScrollAllowed,\n      impact: impact,\n      afterCritical: afterCritical,\n      onLiftImpact: impact,\n      viewport: viewport,\n      scrollJumpRequest: null,\n      forceShouldAnimate: null\n    };\n    return result;\n  }\n\n  if (action.type === 'COLLECTION_STARTING') {\n    if (state.phase === 'COLLECTING' || state.phase === 'DROP_PENDING') {\n      return state;\n    }\n\n    !(state.phase === 'DRAGGING') ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"Collection cannot start from phase \" + state.phase) : invariant(false) : void 0;\n\n    var _result = _extends({\n      phase: 'COLLECTING'\n    }, state, {\n      phase: 'COLLECTING'\n    });\n\n    return _result;\n  }\n\n  if (action.type === 'PUBLISH_WHILE_DRAGGING') {\n    !(state.phase === 'COLLECTING' || state.phase === 'DROP_PENDING') ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"Unexpected \" + action.type + \" received in phase \" + state.phase) : invariant(false) : void 0;\n    return publishWhileDraggingInVirtual({\n      state: state,\n      published: action.payload\n    });\n  }\n\n  if (action.type === 'MOVE') {\n    if (state.phase === 'DROP_PENDING') {\n      return state;\n    }\n\n    !isMovementAllowed(state) ? process.env.NODE_ENV !== \"production\" ? invariant(false, action.type + \" not permitted in phase \" + state.phase) : invariant(false) : void 0;\n    var _clientSelection = action.payload.client;\n\n    if (isEqual(_clientSelection, state.current.client.selection)) {\n      return state;\n    }\n\n    return update({\n      state: state,\n      clientSelection: _clientSelection,\n      impact: isSnapping(state) ? state.impact : null\n    });\n  }\n\n  if (action.type === 'UPDATE_DROPPABLE_SCROLL') {\n    if (state.phase === 'DROP_PENDING') {\n      return removeScrollJumpRequest(state);\n    }\n\n    if (state.phase === 'COLLECTING') {\n      return removeScrollJumpRequest(state);\n    }\n\n    !isMovementAllowed(state) ? process.env.NODE_ENV !== \"production\" ? invariant(false, action.type + \" not permitted in phase \" + state.phase) : invariant(false) : void 0;\n    var _action$payload2 = action.payload,\n        id = _action$payload2.id,\n        newScroll = _action$payload2.newScroll;\n    var target = state.dimensions.droppables[id];\n\n    if (!target) {\n      return state;\n    }\n\n    var scrolled = scrollDroppable(target, newScroll);\n    return postDroppableChange(state, scrolled, false);\n  }\n\n  if (action.type === 'UPDATE_DROPPABLE_IS_ENABLED') {\n    if (state.phase === 'DROP_PENDING') {\n      return state;\n    }\n\n    !isMovementAllowed(state) ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"Attempting to move in an unsupported phase \" + state.phase) : invariant(false) : void 0;\n    var _action$payload3 = action.payload,\n        _id = _action$payload3.id,\n        isEnabled = _action$payload3.isEnabled;\n    var _target = state.dimensions.droppables[_id];\n    !_target ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"Cannot find Droppable[id: \" + _id + \"] to toggle its enabled state\") : invariant(false) : void 0;\n    !(_target.isEnabled !== isEnabled) ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"Trying to set droppable isEnabled to \" + String(isEnabled) + \"\\n      but it is already \" + String(_target.isEnabled)) : invariant(false) : void 0;\n\n    var updated = _extends({}, _target, {\n      isEnabled: isEnabled\n    });\n\n    return postDroppableChange(state, updated, true);\n  }\n\n  if (action.type === 'UPDATE_DROPPABLE_IS_COMBINE_ENABLED') {\n    if (state.phase === 'DROP_PENDING') {\n      return state;\n    }\n\n    !isMovementAllowed(state) ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"Attempting to move in an unsupported phase \" + state.phase) : invariant(false) : void 0;\n    var _action$payload4 = action.payload,\n        _id2 = _action$payload4.id,\n        isCombineEnabled = _action$payload4.isCombineEnabled;\n    var _target2 = state.dimensions.droppables[_id2];\n    !_target2 ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"Cannot find Droppable[id: \" + _id2 + \"] to toggle its isCombineEnabled state\") : invariant(false) : void 0;\n    !(_target2.isCombineEnabled !== isCombineEnabled) ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"Trying to set droppable isCombineEnabled to \" + String(isCombineEnabled) + \"\\n      but it is already \" + String(_target2.isCombineEnabled)) : invariant(false) : void 0;\n\n    var _updated = _extends({}, _target2, {\n      isCombineEnabled: isCombineEnabled\n    });\n\n    return postDroppableChange(state, _updated, true);\n  }\n\n  if (action.type === 'MOVE_BY_WINDOW_SCROLL') {\n    if (state.phase === 'DROP_PENDING' || state.phase === 'DROP_ANIMATING') {\n      return state;\n    }\n\n    !isMovementAllowed(state) ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"Cannot move by window in phase \" + state.phase) : invariant(false) : void 0;\n    !state.isWindowScrollAllowed ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Window scrolling is currently not supported for fixed lists') : invariant(false) : void 0;\n    var _newScroll = action.payload.newScroll;\n\n    if (isEqual(state.viewport.scroll.current, _newScroll)) {\n      return removeScrollJumpRequest(state);\n    }\n\n    var _viewport = scrollViewport(state.viewport, _newScroll);\n\n    if (isSnapping(state)) {\n      return refreshSnap({\n        state: state,\n        viewport: _viewport\n      });\n    }\n\n    return update({\n      state: state,\n      viewport: _viewport\n    });\n  }\n\n  if (action.type === 'UPDATE_VIEWPORT_MAX_SCROLL') {\n    if (!isMovementAllowed(state)) {\n      return state;\n    }\n\n    var maxScroll = action.payload.maxScroll;\n\n    if (isEqual(maxScroll, state.viewport.scroll.max)) {\n      return state;\n    }\n\n    var withMaxScroll = _extends({}, state.viewport, {\n      scroll: _extends({}, state.viewport.scroll, {\n        max: maxScroll\n      })\n    });\n\n    return _extends({\n      phase: 'DRAGGING'\n    }, state, {\n      viewport: withMaxScroll\n    });\n  }\n\n  if (action.type === 'MOVE_UP' || action.type === 'MOVE_DOWN' || action.type === 'MOVE_LEFT' || action.type === 'MOVE_RIGHT') {\n    if (state.phase === 'COLLECTING' || state.phase === 'DROP_PENDING') {\n      return state;\n    }\n\n    !(state.phase === 'DRAGGING') ? process.env.NODE_ENV !== \"production\" ? invariant(false, action.type + \" received while not in DRAGGING phase\") : invariant(false) : void 0;\n\n    var _result2 = moveInDirection({\n      state: state,\n      type: action.type\n    });\n\n    if (!_result2) {\n      return state;\n    }\n\n    return update({\n      state: state,\n      impact: _result2.impact,\n      clientSelection: _result2.clientSelection,\n      scrollJumpRequest: _result2.scrollJumpRequest\n    });\n  }\n\n  if (action.type === 'DROP_PENDING') {\n    var reason = action.payload.reason;\n    !(state.phase === 'COLLECTING') ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Can only move into the DROP_PENDING phase from the COLLECTING phase') : invariant(false) : void 0;\n\n    var newState = _extends({\n      phase: 'DROP_PENDING'\n    }, state, {\n      phase: 'DROP_PENDING',\n      isWaiting: true,\n      reason: reason\n    });\n\n    return newState;\n  }\n\n  if (action.type === 'DROP_ANIMATE') {\n    var _action$payload5 = action.payload,\n        completed = _action$payload5.completed,\n        dropDuration = _action$payload5.dropDuration,\n        newHomeClientOffset = _action$payload5.newHomeClientOffset;\n    !(state.phase === 'DRAGGING' || state.phase === 'DROP_PENDING') ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"Cannot animate drop from phase \" + state.phase) : invariant(false) : void 0;\n    var _result3 = {\n      phase: 'DROP_ANIMATING',\n      completed: completed,\n      dropDuration: dropDuration,\n      newHomeClientOffset: newHomeClientOffset,\n      dimensions: state.dimensions\n    };\n    return _result3;\n  }\n\n  if (action.type === 'DROP_COMPLETE') {\n    var _completed = action.payload.completed;\n    return {\n      phase: 'IDLE',\n      completed: _completed,\n      shouldFlush: false\n    };\n  }\n\n  return state;\n});\n\nvar beforeInitialCapture = function beforeInitialCapture(args) {\n  return {\n    type: 'BEFORE_INITIAL_CAPTURE',\n    payload: args\n  };\n};\nvar lift = function lift(args) {\n  return {\n    type: 'LIFT',\n    payload: args\n  };\n};\nvar initialPublish = function initialPublish(args) {\n  return {\n    type: 'INITIAL_PUBLISH',\n    payload: args\n  };\n};\nvar publishWhileDragging = function publishWhileDragging(args) {\n  return {\n    type: 'PUBLISH_WHILE_DRAGGING',\n    payload: args\n  };\n};\nvar collectionStarting = function collectionStarting() {\n  return {\n    type: 'COLLECTION_STARTING',\n    payload: null\n  };\n};\nvar updateDroppableScroll = function updateDroppableScroll(args) {\n  return {\n    type: 'UPDATE_DROPPABLE_SCROLL',\n    payload: args\n  };\n};\nvar updateDroppableIsEnabled = function updateDroppableIsEnabled(args) {\n  return {\n    type: 'UPDATE_DROPPABLE_IS_ENABLED',\n    payload: args\n  };\n};\nvar updateDroppableIsCombineEnabled = function updateDroppableIsCombineEnabled(args) {\n  return {\n    type: 'UPDATE_DROPPABLE_IS_COMBINE_ENABLED',\n    payload: args\n  };\n};\nvar move = function move(args) {\n  return {\n    type: 'MOVE',\n    payload: args\n  };\n};\nvar moveByWindowScroll = function moveByWindowScroll(args) {\n  return {\n    type: 'MOVE_BY_WINDOW_SCROLL',\n    payload: args\n  };\n};\nvar updateViewportMaxScroll = function updateViewportMaxScroll(args) {\n  return {\n    type: 'UPDATE_VIEWPORT_MAX_SCROLL',\n    payload: args\n  };\n};\nvar moveUp = function moveUp() {\n  return {\n    type: 'MOVE_UP',\n    payload: null\n  };\n};\nvar moveDown = function moveDown() {\n  return {\n    type: 'MOVE_DOWN',\n    payload: null\n  };\n};\nvar moveRight = function moveRight() {\n  return {\n    type: 'MOVE_RIGHT',\n    payload: null\n  };\n};\nvar moveLeft = function moveLeft() {\n  return {\n    type: 'MOVE_LEFT',\n    payload: null\n  };\n};\nvar flush = function flush() {\n  return {\n    type: 'FLUSH',\n    payload: null\n  };\n};\nvar animateDrop = function animateDrop(args) {\n  return {\n    type: 'DROP_ANIMATE',\n    payload: args\n  };\n};\nvar completeDrop = function completeDrop(args) {\n  return {\n    type: 'DROP_COMPLETE',\n    payload: args\n  };\n};\nvar drop = function drop(args) {\n  return {\n    type: 'DROP',\n    payload: args\n  };\n};\nvar dropPending = function dropPending(args) {\n  return {\n    type: 'DROP_PENDING',\n    payload: args\n  };\n};\nvar dropAnimationFinished = function dropAnimationFinished() {\n  return {\n    type: 'DROP_ANIMATION_FINISHED',\n    payload: null\n  };\n};\n\nfunction checkIndexes(insideDestination) {\n  if (insideDestination.length <= 1) {\n    return;\n  }\n\n  var indexes = insideDestination.map(function (d) {\n    return d.descriptor.index;\n  });\n  var errors = {};\n\n  for (var i = 1; i < indexes.length; i++) {\n    var current = indexes[i];\n    var previous = indexes[i - 1];\n\n    if (current !== previous + 1) {\n      errors[current] = true;\n    }\n  }\n\n  if (!Object.keys(errors).length) {\n    return;\n  }\n\n  var formatted = indexes.map(function (index) {\n    var hasError = Boolean(errors[index]);\n    return hasError ? \"[\\uD83D\\uDD25\" + index + \"]\" : \"\" + index;\n  }).join(', ');\n  process.env.NODE_ENV !== \"production\" ? warning(\"\\n    Detected non-consecutive <Draggable /> indexes.\\n\\n    (This can cause unexpected bugs)\\n\\n    \" + formatted + \"\\n  \") : void 0;\n}\n\nfunction validateDimensions(critical, dimensions) {\n  if (process.env.NODE_ENV !== 'production') {\n    var insideDestination = getDraggablesInsideDroppable(critical.droppable.id, dimensions.draggables);\n    checkIndexes(insideDestination);\n  }\n}\n\nvar lift$1 = (function (marshal) {\n  return function (_ref) {\n    var getState = _ref.getState,\n        dispatch = _ref.dispatch;\n    return function (next) {\n      return function (action) {\n        if (action.type !== 'LIFT') {\n          next(action);\n          return;\n        }\n\n        var _action$payload = action.payload,\n            id = _action$payload.id,\n            clientSelection = _action$payload.clientSelection,\n            movementMode = _action$payload.movementMode;\n        var initial = getState();\n\n        if (initial.phase === 'DROP_ANIMATING') {\n          dispatch(completeDrop({\n            completed: initial.completed\n          }));\n        }\n\n        !(getState().phase === 'IDLE') ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Unexpected phase to start a drag') : invariant(false) : void 0;\n        dispatch(flush());\n        dispatch(beforeInitialCapture({\n          draggableId: id,\n          movementMode: movementMode\n        }));\n        var scrollOptions = {\n          shouldPublishImmediately: movementMode === 'SNAP'\n        };\n        var request = {\n          draggableId: id,\n          scrollOptions: scrollOptions\n        };\n\n        var _marshal$startPublish = marshal.startPublishing(request),\n            critical = _marshal$startPublish.critical,\n            dimensions = _marshal$startPublish.dimensions,\n            viewport = _marshal$startPublish.viewport;\n\n        validateDimensions(critical, dimensions);\n        dispatch(initialPublish({\n          critical: critical,\n          dimensions: dimensions,\n          clientSelection: clientSelection,\n          movementMode: movementMode,\n          viewport: viewport\n        }));\n      };\n    };\n  };\n});\n\nvar style = (function (marshal) {\n  return function () {\n    return function (next) {\n      return function (action) {\n        if (action.type === 'INITIAL_PUBLISH') {\n          marshal.dragging();\n        }\n\n        if (action.type === 'DROP_ANIMATE') {\n          marshal.dropping(action.payload.completed.result.reason);\n        }\n\n        if (action.type === 'FLUSH' || action.type === 'DROP_COMPLETE') {\n          marshal.resting();\n        }\n\n        next(action);\n      };\n    };\n  };\n});\n\nvar curves = {\n  outOfTheWay: 'cubic-bezier(0.2, 0, 0, 1)',\n  drop: 'cubic-bezier(.2,1,.1,1)'\n};\nvar combine = {\n  opacity: {\n    drop: 0,\n    combining: 0.7\n  },\n  scale: {\n    drop: 0.75\n  }\n};\nvar timings = {\n  outOfTheWay: 0.2,\n  minDropTime: 0.33,\n  maxDropTime: 0.55\n};\nvar outOfTheWayTiming = timings.outOfTheWay + \"s \" + curves.outOfTheWay;\nvar transitions = {\n  fluid: \"opacity \" + outOfTheWayTiming,\n  snap: \"transform \" + outOfTheWayTiming + \", opacity \" + outOfTheWayTiming,\n  drop: function drop(duration) {\n    var timing = duration + \"s \" + curves.drop;\n    return \"transform \" + timing + \", opacity \" + timing;\n  },\n  outOfTheWay: \"transform \" + outOfTheWayTiming,\n  placeholder: \"height \" + outOfTheWayTiming + \", width \" + outOfTheWayTiming + \", margin \" + outOfTheWayTiming\n};\n\nvar moveTo = function moveTo(offset) {\n  return isEqual(offset, origin) ? null : \"translate(\" + offset.x + \"px, \" + offset.y + \"px)\";\n};\n\nvar transforms = {\n  moveTo: moveTo,\n  drop: function drop(offset, isCombining) {\n    var translate = moveTo(offset);\n\n    if (!translate) {\n      return null;\n    }\n\n    if (!isCombining) {\n      return translate;\n    }\n\n    return translate + \" scale(\" + combine.scale.drop + \")\";\n  }\n};\n\nvar minDropTime = timings.minDropTime,\n    maxDropTime = timings.maxDropTime;\nvar dropTimeRange = maxDropTime - minDropTime;\nvar maxDropTimeAtDistance = 1500;\nvar cancelDropModifier = 0.6;\nvar getDropDuration = (function (_ref) {\n  var current = _ref.current,\n      destination = _ref.destination,\n      reason = _ref.reason;\n  var distance$1 = distance(current, destination);\n\n  if (distance$1 <= 0) {\n    return minDropTime;\n  }\n\n  if (distance$1 >= maxDropTimeAtDistance) {\n    return maxDropTime;\n  }\n\n  var percentage = distance$1 / maxDropTimeAtDistance;\n  var duration = minDropTime + dropTimeRange * percentage;\n  var withDuration = reason === 'CANCEL' ? duration * cancelDropModifier : duration;\n  return Number(withDuration.toFixed(2));\n});\n\nvar getNewHomeClientOffset = (function (_ref) {\n  var impact = _ref.impact,\n      draggable = _ref.draggable,\n      dimensions = _ref.dimensions,\n      viewport = _ref.viewport,\n      afterCritical = _ref.afterCritical;\n  var draggables = dimensions.draggables,\n      droppables = dimensions.droppables;\n  var droppableId = whatIsDraggedOver(impact);\n  var destination = droppableId ? droppables[droppableId] : null;\n  var home = droppables[draggable.descriptor.droppableId];\n  var newClientCenter = getClientBorderBoxCenter({\n    impact: impact,\n    draggable: draggable,\n    draggables: draggables,\n    afterCritical: afterCritical,\n    droppable: destination || home,\n    viewport: viewport\n  });\n  var offset = subtract(newClientCenter, draggable.client.borderBox.center);\n  return offset;\n});\n\nvar getDropImpact = (function (_ref) {\n  var draggables = _ref.draggables,\n      reason = _ref.reason,\n      lastImpact = _ref.lastImpact,\n      home = _ref.home,\n      viewport = _ref.viewport,\n      onLiftImpact = _ref.onLiftImpact;\n\n  if (!lastImpact.at || reason !== 'DROP') {\n    var recomputedHomeImpact = recompute({\n      draggables: draggables,\n      impact: onLiftImpact,\n      destination: home,\n      viewport: viewport,\n      forceShouldAnimate: true\n    });\n    return {\n      impact: recomputedHomeImpact,\n      didDropInsideDroppable: false\n    };\n  }\n\n  if (lastImpact.at.type === 'REORDER') {\n    return {\n      impact: lastImpact,\n      didDropInsideDroppable: true\n    };\n  }\n\n  var withoutMovement = _extends({}, lastImpact, {\n    displaced: emptyGroups\n  });\n\n  return {\n    impact: withoutMovement,\n    didDropInsideDroppable: true\n  };\n});\n\nvar drop$1 = (function (_ref) {\n  var getState = _ref.getState,\n      dispatch = _ref.dispatch;\n  return function (next) {\n    return function (action) {\n      if (action.type !== 'DROP') {\n        next(action);\n        return;\n      }\n\n      var state = getState();\n      var reason = action.payload.reason;\n\n      if (state.phase === 'COLLECTING') {\n        dispatch(dropPending({\n          reason: reason\n        }));\n        return;\n      }\n\n      if (state.phase === 'IDLE') {\n        return;\n      }\n\n      var isWaitingForDrop = state.phase === 'DROP_PENDING' && state.isWaiting;\n      !!isWaitingForDrop ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'A DROP action occurred while DROP_PENDING and still waiting') : invariant(false) : void 0;\n      !(state.phase === 'DRAGGING' || state.phase === 'DROP_PENDING') ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"Cannot drop in phase: \" + state.phase) : invariant(false) : void 0;\n      var critical = state.critical;\n      var dimensions = state.dimensions;\n      var draggable = dimensions.draggables[state.critical.draggable.id];\n\n      var _getDropImpact = getDropImpact({\n        reason: reason,\n        lastImpact: state.impact,\n        afterCritical: state.afterCritical,\n        onLiftImpact: state.onLiftImpact,\n        home: state.dimensions.droppables[state.critical.droppable.id],\n        viewport: state.viewport,\n        draggables: state.dimensions.draggables\n      }),\n          impact = _getDropImpact.impact,\n          didDropInsideDroppable = _getDropImpact.didDropInsideDroppable;\n\n      var destination = didDropInsideDroppable ? tryGetDestination(impact) : null;\n      var combine = didDropInsideDroppable ? tryGetCombine(impact) : null;\n      var source = {\n        index: critical.draggable.index,\n        droppableId: critical.droppable.id\n      };\n      var result = {\n        draggableId: draggable.descriptor.id,\n        type: draggable.descriptor.type,\n        source: source,\n        reason: reason,\n        mode: state.movementMode,\n        destination: destination,\n        combine: combine\n      };\n      var newHomeClientOffset = getNewHomeClientOffset({\n        impact: impact,\n        draggable: draggable,\n        dimensions: dimensions,\n        viewport: state.viewport,\n        afterCritical: state.afterCritical\n      });\n      var completed = {\n        critical: state.critical,\n        afterCritical: state.afterCritical,\n        result: result,\n        impact: impact\n      };\n      var isAnimationRequired = !isEqual(state.current.client.offset, newHomeClientOffset) || Boolean(result.combine);\n\n      if (!isAnimationRequired) {\n        dispatch(completeDrop({\n          completed: completed\n        }));\n        return;\n      }\n\n      var dropDuration = getDropDuration({\n        current: state.current.client.offset,\n        destination: newHomeClientOffset,\n        reason: reason\n      });\n      var args = {\n        newHomeClientOffset: newHomeClientOffset,\n        dropDuration: dropDuration,\n        completed: completed\n      };\n      dispatch(animateDrop(args));\n    };\n  };\n});\n\nvar getWindowScroll = (function () {\n  return {\n    x: window.pageXOffset,\n    y: window.pageYOffset\n  };\n});\n\nfunction getWindowScrollBinding(update) {\n  return {\n    eventName: 'scroll',\n    options: {\n      passive: true,\n      capture: false\n    },\n    fn: function fn(event) {\n      if (event.target !== window && event.target !== window.document) {\n        return;\n      }\n\n      update();\n    }\n  };\n}\n\nfunction getScrollListener(_ref) {\n  var onWindowScroll = _ref.onWindowScroll;\n\n  function updateScroll() {\n    onWindowScroll(getWindowScroll());\n  }\n\n  var scheduled = rafSchd(updateScroll);\n  var binding = getWindowScrollBinding(scheduled);\n  var unbind = noop;\n\n  function isActive() {\n    return unbind !== noop;\n  }\n\n  function start() {\n    !!isActive() ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot start scroll listener when already active') : invariant(false) : void 0;\n    unbind = bindEvents(window, [binding]);\n  }\n\n  function stop() {\n    !isActive() ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot stop scroll listener when not active') : invariant(false) : void 0;\n    scheduled.cancel();\n    unbind();\n    unbind = noop;\n  }\n\n  return {\n    start: start,\n    stop: stop,\n    isActive: isActive\n  };\n}\n\nvar shouldEnd = function shouldEnd(action) {\n  return action.type === 'DROP_COMPLETE' || action.type === 'DROP_ANIMATE' || action.type === 'FLUSH';\n};\n\nvar scrollListener = (function (store) {\n  var listener = getScrollListener({\n    onWindowScroll: function onWindowScroll(newScroll) {\n      store.dispatch(moveByWindowScroll({\n        newScroll: newScroll\n      }));\n    }\n  });\n  return function (next) {\n    return function (action) {\n      if (!listener.isActive() && action.type === 'INITIAL_PUBLISH') {\n        listener.start();\n      }\n\n      if (listener.isActive() && shouldEnd(action)) {\n        listener.stop();\n      }\n\n      next(action);\n    };\n  };\n});\n\nvar getExpiringAnnounce = (function (announce) {\n  var wasCalled = false;\n  var isExpired = false;\n  var timeoutId = setTimeout(function () {\n    isExpired = true;\n  });\n\n  var result = function result(message) {\n    if (wasCalled) {\n      process.env.NODE_ENV !== \"production\" ? warning('Announcement already made. Not making a second announcement') : void 0;\n      return;\n    }\n\n    if (isExpired) {\n      process.env.NODE_ENV !== \"production\" ? warning(\"\\n        Announcements cannot be made asynchronously.\\n        Default message has already been announced.\\n      \") : void 0;\n      return;\n    }\n\n    wasCalled = true;\n    announce(message);\n    clearTimeout(timeoutId);\n  };\n\n  result.wasCalled = function () {\n    return wasCalled;\n  };\n\n  return result;\n});\n\nvar getAsyncMarshal = (function () {\n  var entries = [];\n\n  var execute = function execute(timerId) {\n    var index = findIndex(entries, function (item) {\n      return item.timerId === timerId;\n    });\n    !(index !== -1) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Could not find timer') : invariant(false) : void 0;\n\n    var _entries$splice = entries.splice(index, 1),\n        entry = _entries$splice[0];\n\n    entry.callback();\n  };\n\n  var add = function add(fn) {\n    var timerId = setTimeout(function () {\n      return execute(timerId);\n    });\n    var entry = {\n      timerId: timerId,\n      callback: fn\n    };\n    entries.push(entry);\n  };\n\n  var flush = function flush() {\n    if (!entries.length) {\n      return;\n    }\n\n    var shallow = [].concat(entries);\n    entries.length = 0;\n    shallow.forEach(function (entry) {\n      clearTimeout(entry.timerId);\n      entry.callback();\n    });\n  };\n\n  return {\n    add: add,\n    flush: flush\n  };\n});\n\nvar areLocationsEqual = function areLocationsEqual(first, second) {\n  if (first == null && second == null) {\n    return true;\n  }\n\n  if (first == null || second == null) {\n    return false;\n  }\n\n  return first.droppableId === second.droppableId && first.index === second.index;\n};\nvar isCombineEqual = function isCombineEqual(first, second) {\n  if (first == null && second == null) {\n    return true;\n  }\n\n  if (first == null || second == null) {\n    return false;\n  }\n\n  return first.draggableId === second.draggableId && first.droppableId === second.droppableId;\n};\nvar isCriticalEqual = function isCriticalEqual(first, second) {\n  if (first === second) {\n    return true;\n  }\n\n  var isDraggableEqual = first.draggable.id === second.draggable.id && first.draggable.droppableId === second.draggable.droppableId && first.draggable.type === second.draggable.type && first.draggable.index === second.draggable.index;\n  var isDroppableEqual = first.droppable.id === second.droppable.id && first.droppable.type === second.droppable.type;\n  return isDraggableEqual && isDroppableEqual;\n};\n\nvar withTimings = function withTimings(key, fn) {\n  start();\n  fn();\n  finish();\n};\n\nvar getDragStart = function getDragStart(critical, mode) {\n  return {\n    draggableId: critical.draggable.id,\n    type: critical.droppable.type,\n    source: {\n      droppableId: critical.droppable.id,\n      index: critical.draggable.index\n    },\n    mode: mode\n  };\n};\n\nvar execute = function execute(responder, data, announce, getDefaultMessage) {\n  if (!responder) {\n    announce(getDefaultMessage(data));\n    return;\n  }\n\n  var willExpire = getExpiringAnnounce(announce);\n  var provided = {\n    announce: willExpire\n  };\n  responder(data, provided);\n\n  if (!willExpire.wasCalled()) {\n    announce(getDefaultMessage(data));\n  }\n};\n\nvar getPublisher = (function (getResponders, announce) {\n  var asyncMarshal = getAsyncMarshal();\n  var dragging = null;\n\n  var beforeCapture = function beforeCapture(draggableId, mode) {\n    !!dragging ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot fire onBeforeCapture as a drag start has already been published') : invariant(false) : void 0;\n    withTimings('onBeforeCapture', function () {\n      var fn = getResponders().onBeforeCapture;\n\n      if (fn) {\n        var before = {\n          draggableId: draggableId,\n          mode: mode\n        };\n        fn(before);\n      }\n    });\n  };\n\n  var beforeStart = function beforeStart(critical, mode) {\n    !!dragging ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot fire onBeforeDragStart as a drag start has already been published') : invariant(false) : void 0;\n    withTimings('onBeforeDragStart', function () {\n      var fn = getResponders().onBeforeDragStart;\n\n      if (fn) {\n        fn(getDragStart(critical, mode));\n      }\n    });\n  };\n\n  var start = function start(critical, mode) {\n    !!dragging ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot fire onBeforeDragStart as a drag start has already been published') : invariant(false) : void 0;\n    var data = getDragStart(critical, mode);\n    dragging = {\n      mode: mode,\n      lastCritical: critical,\n      lastLocation: data.source,\n      lastCombine: null\n    };\n    asyncMarshal.add(function () {\n      withTimings('onDragStart', function () {\n        return execute(getResponders().onDragStart, data, announce, preset.onDragStart);\n      });\n    });\n  };\n\n  var update = function update(critical, impact) {\n    var location = tryGetDestination(impact);\n    var combine = tryGetCombine(impact);\n    !dragging ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot fire onDragMove when onDragStart has not been called') : invariant(false) : void 0;\n    var hasCriticalChanged = !isCriticalEqual(critical, dragging.lastCritical);\n\n    if (hasCriticalChanged) {\n      dragging.lastCritical = critical;\n    }\n\n    var hasLocationChanged = !areLocationsEqual(dragging.lastLocation, location);\n\n    if (hasLocationChanged) {\n      dragging.lastLocation = location;\n    }\n\n    var hasGroupingChanged = !isCombineEqual(dragging.lastCombine, combine);\n\n    if (hasGroupingChanged) {\n      dragging.lastCombine = combine;\n    }\n\n    if (!hasCriticalChanged && !hasLocationChanged && !hasGroupingChanged) {\n      return;\n    }\n\n    var data = _extends({}, getDragStart(critical, dragging.mode), {\n      combine: combine,\n      destination: location\n    });\n\n    asyncMarshal.add(function () {\n      withTimings('onDragUpdate', function () {\n        return execute(getResponders().onDragUpdate, data, announce, preset.onDragUpdate);\n      });\n    });\n  };\n\n  var flush = function flush() {\n    !dragging ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Can only flush responders while dragging') : invariant(false) : void 0;\n    asyncMarshal.flush();\n  };\n\n  var drop = function drop(result) {\n    !dragging ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot fire onDragEnd when there is no matching onDragStart') : invariant(false) : void 0;\n    dragging = null;\n    withTimings('onDragEnd', function () {\n      return execute(getResponders().onDragEnd, result, announce, preset.onDragEnd);\n    });\n  };\n\n  var abort = function abort() {\n    if (!dragging) {\n      return;\n    }\n\n    var result = _extends({}, getDragStart(dragging.lastCritical, dragging.mode), {\n      combine: null,\n      destination: null,\n      reason: 'CANCEL'\n    });\n\n    drop(result);\n  };\n\n  return {\n    beforeCapture: beforeCapture,\n    beforeStart: beforeStart,\n    start: start,\n    update: update,\n    flush: flush,\n    drop: drop,\n    abort: abort\n  };\n});\n\nvar responders = (function (getResponders, announce) {\n  var publisher = getPublisher(getResponders, announce);\n  return function (store) {\n    return function (next) {\n      return function (action) {\n        if (action.type === 'BEFORE_INITIAL_CAPTURE') {\n          publisher.beforeCapture(action.payload.draggableId, action.payload.movementMode);\n          return;\n        }\n\n        if (action.type === 'INITIAL_PUBLISH') {\n          var critical = action.payload.critical;\n          publisher.beforeStart(critical, action.payload.movementMode);\n          next(action);\n          publisher.start(critical, action.payload.movementMode);\n          return;\n        }\n\n        if (action.type === 'DROP_COMPLETE') {\n          var result = action.payload.completed.result;\n          publisher.flush();\n          next(action);\n          publisher.drop(result);\n          return;\n        }\n\n        next(action);\n\n        if (action.type === 'FLUSH') {\n          publisher.abort();\n          return;\n        }\n\n        var state = store.getState();\n\n        if (state.phase === 'DRAGGING') {\n          publisher.update(state.critical, state.impact);\n        }\n      };\n    };\n  };\n});\n\nvar dropAnimationFinish = (function (store) {\n  return function (next) {\n    return function (action) {\n      if (action.type !== 'DROP_ANIMATION_FINISHED') {\n        next(action);\n        return;\n      }\n\n      var state = store.getState();\n      !(state.phase === 'DROP_ANIMATING') ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot finish a drop animating when no drop is occurring') : invariant(false) : void 0;\n      store.dispatch(completeDrop({\n        completed: state.completed\n      }));\n    };\n  };\n});\n\nvar dropAnimationFlushOnScroll = (function (store) {\n  var unbind = null;\n  var frameId = null;\n\n  function clear() {\n    if (frameId) {\n      cancelAnimationFrame(frameId);\n      frameId = null;\n    }\n\n    if (unbind) {\n      unbind();\n      unbind = null;\n    }\n  }\n\n  return function (next) {\n    return function (action) {\n      if (action.type === 'FLUSH' || action.type === 'DROP_COMPLETE' || action.type === 'DROP_ANIMATION_FINISHED') {\n        clear();\n      }\n\n      next(action);\n\n      if (action.type !== 'DROP_ANIMATE') {\n        return;\n      }\n\n      var binding = {\n        eventName: 'scroll',\n        options: {\n          capture: true,\n          passive: false,\n          once: true\n        },\n        fn: function flushDropAnimation() {\n          var state = store.getState();\n\n          if (state.phase === 'DROP_ANIMATING') {\n            store.dispatch(dropAnimationFinished());\n          }\n        }\n      };\n      frameId = requestAnimationFrame(function () {\n        frameId = null;\n        unbind = bindEvents(window, [binding]);\n      });\n    };\n  };\n});\n\nvar dimensionMarshalStopper = (function (marshal) {\n  return function () {\n    return function (next) {\n      return function (action) {\n        if (action.type === 'DROP_COMPLETE' || action.type === 'FLUSH' || action.type === 'DROP_ANIMATE') {\n          marshal.stopPublishing();\n        }\n\n        next(action);\n      };\n    };\n  };\n});\n\nvar focus = (function (marshal) {\n  var isWatching = false;\n  return function () {\n    return function (next) {\n      return function (action) {\n        if (action.type === 'INITIAL_PUBLISH') {\n          isWatching = true;\n          marshal.tryRecordFocus(action.payload.critical.draggable.id);\n          next(action);\n          marshal.tryRestoreFocusRecorded();\n          return;\n        }\n\n        next(action);\n\n        if (!isWatching) {\n          return;\n        }\n\n        if (action.type === 'FLUSH') {\n          isWatching = false;\n          marshal.tryRestoreFocusRecorded();\n          return;\n        }\n\n        if (action.type === 'DROP_COMPLETE') {\n          isWatching = false;\n          var result = action.payload.completed.result;\n\n          if (result.combine) {\n            marshal.tryShiftRecord(result.draggableId, result.combine.draggableId);\n          }\n\n          marshal.tryRestoreFocusRecorded();\n        }\n      };\n    };\n  };\n});\n\nvar shouldStop = function shouldStop(action) {\n  return action.type === 'DROP_COMPLETE' || action.type === 'DROP_ANIMATE' || action.type === 'FLUSH';\n};\n\nvar autoScroll = (function (autoScroller) {\n  return function (store) {\n    return function (next) {\n      return function (action) {\n        if (shouldStop(action)) {\n          autoScroller.stop();\n          next(action);\n          return;\n        }\n\n        if (action.type === 'INITIAL_PUBLISH') {\n          next(action);\n          var state = store.getState();\n          !(state.phase === 'DRAGGING') ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Expected phase to be DRAGGING after INITIAL_PUBLISH') : invariant(false) : void 0;\n          autoScroller.start(state);\n          return;\n        }\n\n        next(action);\n        autoScroller.scroll(store.getState());\n      };\n    };\n  };\n});\n\nvar pendingDrop = (function (store) {\n  return function (next) {\n    return function (action) {\n      next(action);\n\n      if (action.type !== 'PUBLISH_WHILE_DRAGGING') {\n        return;\n      }\n\n      var postActionState = store.getState();\n\n      if (postActionState.phase !== 'DROP_PENDING') {\n        return;\n      }\n\n      if (postActionState.isWaiting) {\n        return;\n      }\n\n      store.dispatch(drop({\n        reason: postActionState.reason\n      }));\n    };\n  };\n});\n\nvar composeEnhancers = process.env.NODE_ENV !== 'production' && typeof window !== 'undefined' && window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ ? window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({\n  name: 'react-beautiful-dnd'\n}) : compose;\nvar createStore = (function (_ref) {\n  var dimensionMarshal = _ref.dimensionMarshal,\n      focusMarshal = _ref.focusMarshal,\n      styleMarshal = _ref.styleMarshal,\n      getResponders = _ref.getResponders,\n      announce = _ref.announce,\n      autoScroller = _ref.autoScroller;\n  return createStore$1(reducer, composeEnhancers(applyMiddleware(style(styleMarshal), dimensionMarshalStopper(dimensionMarshal), lift$1(dimensionMarshal), drop$1, dropAnimationFinish, dropAnimationFlushOnScroll, pendingDrop, autoScroll(autoScroller), scrollListener, focus(focusMarshal), responders(getResponders, announce))));\n});\n\nvar clean$1 = function clean() {\n  return {\n    additions: {},\n    removals: {},\n    modified: {}\n  };\n};\nfunction createPublisher(_ref) {\n  var registry = _ref.registry,\n      callbacks = _ref.callbacks;\n  var staging = clean$1();\n  var frameId = null;\n\n  var collect = function collect() {\n    if (frameId) {\n      return;\n    }\n\n    callbacks.collectionStarting();\n    frameId = requestAnimationFrame(function () {\n      frameId = null;\n      start();\n      var _staging = staging,\n          additions = _staging.additions,\n          removals = _staging.removals,\n          modified = _staging.modified;\n      var added = Object.keys(additions).map(function (id) {\n        return registry.draggable.getById(id).getDimension(origin);\n      }).sort(function (a, b) {\n        return a.descriptor.index - b.descriptor.index;\n      });\n      var updated = Object.keys(modified).map(function (id) {\n        var entry = registry.droppable.getById(id);\n        var scroll = entry.callbacks.getScrollWhileDragging();\n        return {\n          droppableId: id,\n          scroll: scroll\n        };\n      });\n      var result = {\n        additions: added,\n        removals: Object.keys(removals),\n        modified: updated\n      };\n      staging = clean$1();\n      finish();\n      callbacks.publish(result);\n    });\n  };\n\n  var add = function add(entry) {\n    var id = entry.descriptor.id;\n    staging.additions[id] = entry;\n    staging.modified[entry.descriptor.droppableId] = true;\n\n    if (staging.removals[id]) {\n      delete staging.removals[id];\n    }\n\n    collect();\n  };\n\n  var remove = function remove(entry) {\n    var descriptor = entry.descriptor;\n    staging.removals[descriptor.id] = true;\n    staging.modified[descriptor.droppableId] = true;\n\n    if (staging.additions[descriptor.id]) {\n      delete staging.additions[descriptor.id];\n    }\n\n    collect();\n  };\n\n  var stop = function stop() {\n    if (!frameId) {\n      return;\n    }\n\n    cancelAnimationFrame(frameId);\n    frameId = null;\n    staging = clean$1();\n  };\n\n  return {\n    add: add,\n    remove: remove,\n    stop: stop\n  };\n}\n\nvar getMaxScroll = (function (_ref) {\n  var scrollHeight = _ref.scrollHeight,\n      scrollWidth = _ref.scrollWidth,\n      height = _ref.height,\n      width = _ref.width;\n  var maxScroll = subtract({\n    x: scrollWidth,\n    y: scrollHeight\n  }, {\n    x: width,\n    y: height\n  });\n  var adjustedMaxScroll = {\n    x: Math.max(0, maxScroll.x),\n    y: Math.max(0, maxScroll.y)\n  };\n  return adjustedMaxScroll;\n});\n\nvar getDocumentElement = (function () {\n  var doc = document.documentElement;\n  !doc ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot find document.documentElement') : invariant(false) : void 0;\n  return doc;\n});\n\nvar getMaxWindowScroll = (function () {\n  var doc = getDocumentElement();\n  var maxScroll = getMaxScroll({\n    scrollHeight: doc.scrollHeight,\n    scrollWidth: doc.scrollWidth,\n    width: doc.clientWidth,\n    height: doc.clientHeight\n  });\n  return maxScroll;\n});\n\nvar getViewport = (function () {\n  var scroll = getWindowScroll();\n  var maxScroll = getMaxWindowScroll();\n  var top = scroll.y;\n  var left = scroll.x;\n  var doc = getDocumentElement();\n  var width = doc.clientWidth;\n  var height = doc.clientHeight;\n  var right = left + width;\n  var bottom = top + height;\n  var frame = getRect({\n    top: top,\n    left: left,\n    right: right,\n    bottom: bottom\n  });\n  var viewport = {\n    frame: frame,\n    scroll: {\n      initial: scroll,\n      current: scroll,\n      max: maxScroll,\n      diff: {\n        value: origin,\n        displacement: origin\n      }\n    }\n  };\n  return viewport;\n});\n\nvar getInitialPublish = (function (_ref) {\n  var critical = _ref.critical,\n      scrollOptions = _ref.scrollOptions,\n      registry = _ref.registry;\n  start();\n  var viewport = getViewport();\n  var windowScroll = viewport.scroll.current;\n  var home = critical.droppable;\n  var droppables = registry.droppable.getAllByType(home.type).map(function (entry) {\n    return entry.callbacks.getDimensionAndWatchScroll(windowScroll, scrollOptions);\n  });\n  var draggables = registry.draggable.getAllByType(critical.draggable.type).map(function (entry) {\n    return entry.getDimension(windowScroll);\n  });\n  var dimensions = {\n    draggables: toDraggableMap(draggables),\n    droppables: toDroppableMap(droppables)\n  };\n  finish();\n  var result = {\n    dimensions: dimensions,\n    critical: critical,\n    viewport: viewport\n  };\n  return result;\n});\n\nfunction shouldPublishUpdate(registry, dragging, entry) {\n  if (entry.descriptor.id === dragging.id) {\n    return false;\n  }\n\n  if (entry.descriptor.type !== dragging.type) {\n    return false;\n  }\n\n  var home = registry.droppable.getById(entry.descriptor.droppableId);\n\n  if (home.descriptor.mode !== 'virtual') {\n    process.env.NODE_ENV !== \"production\" ? warning(\"\\n      You are attempting to add or remove a Draggable [id: \" + entry.descriptor.id + \"]\\n      while a drag is occurring. This is only supported for virtual lists.\\n\\n      See https://github.com/atlassian/react-beautiful-dnd/blob/master/docs/patterns/virtual-lists.md\\n    \") : void 0;\n    return false;\n  }\n\n  return true;\n}\n\nvar createDimensionMarshal = (function (registry, callbacks) {\n  var collection = null;\n  var publisher = createPublisher({\n    callbacks: {\n      publish: callbacks.publishWhileDragging,\n      collectionStarting: callbacks.collectionStarting\n    },\n    registry: registry\n  });\n\n  var updateDroppableIsEnabled = function updateDroppableIsEnabled(id, isEnabled) {\n    !registry.droppable.exists(id) ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"Cannot update is enabled flag of Droppable \" + id + \" as it is not registered\") : invariant(false) : void 0;\n\n    if (!collection) {\n      return;\n    }\n\n    callbacks.updateDroppableIsEnabled({\n      id: id,\n      isEnabled: isEnabled\n    });\n  };\n\n  var updateDroppableIsCombineEnabled = function updateDroppableIsCombineEnabled(id, isCombineEnabled) {\n    if (!collection) {\n      return;\n    }\n\n    !registry.droppable.exists(id) ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"Cannot update isCombineEnabled flag of Droppable \" + id + \" as it is not registered\") : invariant(false) : void 0;\n    callbacks.updateDroppableIsCombineEnabled({\n      id: id,\n      isCombineEnabled: isCombineEnabled\n    });\n  };\n\n  var updateDroppableScroll = function updateDroppableScroll(id, newScroll) {\n    if (!collection) {\n      return;\n    }\n\n    !registry.droppable.exists(id) ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"Cannot update the scroll on Droppable \" + id + \" as it is not registered\") : invariant(false) : void 0;\n    callbacks.updateDroppableScroll({\n      id: id,\n      newScroll: newScroll\n    });\n  };\n\n  var scrollDroppable = function scrollDroppable(id, change) {\n    if (!collection) {\n      return;\n    }\n\n    registry.droppable.getById(id).callbacks.scroll(change);\n  };\n\n  var stopPublishing = function stopPublishing() {\n    if (!collection) {\n      return;\n    }\n\n    publisher.stop();\n    var home = collection.critical.droppable;\n    registry.droppable.getAllByType(home.type).forEach(function (entry) {\n      return entry.callbacks.dragStopped();\n    });\n    collection.unsubscribe();\n    collection = null;\n  };\n\n  var subscriber = function subscriber(event) {\n    !collection ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Should only be subscribed when a collection is occurring') : invariant(false) : void 0;\n    var dragging = collection.critical.draggable;\n\n    if (event.type === 'ADDITION') {\n      if (shouldPublishUpdate(registry, dragging, event.value)) {\n        publisher.add(event.value);\n      }\n    }\n\n    if (event.type === 'REMOVAL') {\n      if (shouldPublishUpdate(registry, dragging, event.value)) {\n        publisher.remove(event.value);\n      }\n    }\n  };\n\n  var startPublishing = function startPublishing(request) {\n    !!collection ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot start capturing critical dimensions as there is already a collection') : invariant(false) : void 0;\n    var entry = registry.draggable.getById(request.draggableId);\n    var home = registry.droppable.getById(entry.descriptor.droppableId);\n    var critical = {\n      draggable: entry.descriptor,\n      droppable: home.descriptor\n    };\n    var unsubscribe = registry.subscribe(subscriber);\n    collection = {\n      critical: critical,\n      unsubscribe: unsubscribe\n    };\n    return getInitialPublish({\n      critical: critical,\n      registry: registry,\n      scrollOptions: request.scrollOptions\n    });\n  };\n\n  var marshal = {\n    updateDroppableIsEnabled: updateDroppableIsEnabled,\n    updateDroppableIsCombineEnabled: updateDroppableIsCombineEnabled,\n    scrollDroppable: scrollDroppable,\n    updateDroppableScroll: updateDroppableScroll,\n    startPublishing: startPublishing,\n    stopPublishing: stopPublishing\n  };\n  return marshal;\n});\n\nvar canStartDrag = (function (state, id) {\n  if (state.phase === 'IDLE') {\n    return true;\n  }\n\n  if (state.phase !== 'DROP_ANIMATING') {\n    return false;\n  }\n\n  if (state.completed.result.draggableId === id) {\n    return false;\n  }\n\n  return state.completed.result.reason === 'DROP';\n});\n\nvar scrollWindow = (function (change) {\n  window.scrollBy(change.x, change.y);\n});\n\nvar getScrollableDroppables = memoizeOne(function (droppables) {\n  return toDroppableList(droppables).filter(function (droppable) {\n    if (!droppable.isEnabled) {\n      return false;\n    }\n\n    if (!droppable.frame) {\n      return false;\n    }\n\n    return true;\n  });\n});\n\nvar getScrollableDroppableOver = function getScrollableDroppableOver(target, droppables) {\n  var maybe = find(getScrollableDroppables(droppables), function (droppable) {\n    !droppable.frame ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Invalid result') : invariant(false) : void 0;\n    return isPositionInFrame(droppable.frame.pageMarginBox)(target);\n  });\n  return maybe;\n};\n\nvar getBestScrollableDroppable = (function (_ref) {\n  var center = _ref.center,\n      destination = _ref.destination,\n      droppables = _ref.droppables;\n\n  if (destination) {\n    var _dimension = droppables[destination];\n\n    if (!_dimension.frame) {\n      return null;\n    }\n\n    return _dimension;\n  }\n\n  var dimension = getScrollableDroppableOver(center, droppables);\n  return dimension;\n});\n\nvar config = {\n  startFromPercentage: 0.25,\n  maxScrollAtPercentage: 0.05,\n  maxPixelScroll: 28,\n  ease: function ease(percentage) {\n    return Math.pow(percentage, 2);\n  },\n  durationDampening: {\n    stopDampeningAt: 1200,\n    accelerateAt: 360\n  }\n};\n\nvar getDistanceThresholds = (function (container, axis) {\n  var startScrollingFrom = container[axis.size] * config.startFromPercentage;\n  var maxScrollValueAt = container[axis.size] * config.maxScrollAtPercentage;\n  var thresholds = {\n    startScrollingFrom: startScrollingFrom,\n    maxScrollValueAt: maxScrollValueAt\n  };\n  return thresholds;\n});\n\nvar getPercentage = (function (_ref) {\n  var startOfRange = _ref.startOfRange,\n      endOfRange = _ref.endOfRange,\n      current = _ref.current;\n  var range = endOfRange - startOfRange;\n\n  if (range === 0) {\n    process.env.NODE_ENV !== \"production\" ? warning(\"\\n      Detected distance range of 0 in the fluid auto scroller\\n      This is unexpected and would cause a divide by 0 issue.\\n      Not allowing an auto scroll\\n    \") : void 0;\n    return 0;\n  }\n\n  var currentInRange = current - startOfRange;\n  var percentage = currentInRange / range;\n  return percentage;\n});\n\nvar minScroll = 1;\n\nvar getValueFromDistance = (function (distanceToEdge, thresholds) {\n  if (distanceToEdge > thresholds.startScrollingFrom) {\n    return 0;\n  }\n\n  if (distanceToEdge <= thresholds.maxScrollValueAt) {\n    return config.maxPixelScroll;\n  }\n\n  if (distanceToEdge === thresholds.startScrollingFrom) {\n    return minScroll;\n  }\n\n  var percentageFromMaxScrollValueAt = getPercentage({\n    startOfRange: thresholds.maxScrollValueAt,\n    endOfRange: thresholds.startScrollingFrom,\n    current: distanceToEdge\n  });\n  var percentageFromStartScrollingFrom = 1 - percentageFromMaxScrollValueAt;\n  var scroll = config.maxPixelScroll * config.ease(percentageFromStartScrollingFrom);\n  return Math.ceil(scroll);\n});\n\nvar accelerateAt = config.durationDampening.accelerateAt;\nvar stopAt = config.durationDampening.stopDampeningAt;\nvar dampenValueByTime = (function (proposedScroll, dragStartTime) {\n  var startOfRange = dragStartTime;\n  var endOfRange = stopAt;\n  var now = Date.now();\n  var runTime = now - startOfRange;\n\n  if (runTime >= stopAt) {\n    return proposedScroll;\n  }\n\n  if (runTime < accelerateAt) {\n    return minScroll;\n  }\n\n  var betweenAccelerateAtAndStopAtPercentage = getPercentage({\n    startOfRange: accelerateAt,\n    endOfRange: endOfRange,\n    current: runTime\n  });\n  var scroll = proposedScroll * config.ease(betweenAccelerateAtAndStopAtPercentage);\n  return Math.ceil(scroll);\n});\n\nvar getValue = (function (_ref) {\n  var distanceToEdge = _ref.distanceToEdge,\n      thresholds = _ref.thresholds,\n      dragStartTime = _ref.dragStartTime,\n      shouldUseTimeDampening = _ref.shouldUseTimeDampening;\n  var scroll = getValueFromDistance(distanceToEdge, thresholds);\n\n  if (scroll === 0) {\n    return 0;\n  }\n\n  if (!shouldUseTimeDampening) {\n    return scroll;\n  }\n\n  return Math.max(dampenValueByTime(scroll, dragStartTime), minScroll);\n});\n\nvar getScrollOnAxis = (function (_ref) {\n  var container = _ref.container,\n      distanceToEdges = _ref.distanceToEdges,\n      dragStartTime = _ref.dragStartTime,\n      axis = _ref.axis,\n      shouldUseTimeDampening = _ref.shouldUseTimeDampening;\n  var thresholds = getDistanceThresholds(container, axis);\n  var isCloserToEnd = distanceToEdges[axis.end] < distanceToEdges[axis.start];\n\n  if (isCloserToEnd) {\n    return getValue({\n      distanceToEdge: distanceToEdges[axis.end],\n      thresholds: thresholds,\n      dragStartTime: dragStartTime,\n      shouldUseTimeDampening: shouldUseTimeDampening\n    });\n  }\n\n  return -1 * getValue({\n    distanceToEdge: distanceToEdges[axis.start],\n    thresholds: thresholds,\n    dragStartTime: dragStartTime,\n    shouldUseTimeDampening: shouldUseTimeDampening\n  });\n});\n\nvar adjustForSizeLimits = (function (_ref) {\n  var container = _ref.container,\n      subject = _ref.subject,\n      proposedScroll = _ref.proposedScroll;\n  var isTooBigVertically = subject.height > container.height;\n  var isTooBigHorizontally = subject.width > container.width;\n\n  if (!isTooBigHorizontally && !isTooBigVertically) {\n    return proposedScroll;\n  }\n\n  if (isTooBigHorizontally && isTooBigVertically) {\n    return null;\n  }\n\n  return {\n    x: isTooBigHorizontally ? 0 : proposedScroll.x,\n    y: isTooBigVertically ? 0 : proposedScroll.y\n  };\n});\n\nvar clean$2 = apply(function (value) {\n  return value === 0 ? 0 : value;\n});\nvar getScroll = (function (_ref) {\n  var dragStartTime = _ref.dragStartTime,\n      container = _ref.container,\n      subject = _ref.subject,\n      center = _ref.center,\n      shouldUseTimeDampening = _ref.shouldUseTimeDampening;\n  var distanceToEdges = {\n    top: center.y - container.top,\n    right: container.right - center.x,\n    bottom: container.bottom - center.y,\n    left: center.x - container.left\n  };\n  var y = getScrollOnAxis({\n    container: container,\n    distanceToEdges: distanceToEdges,\n    dragStartTime: dragStartTime,\n    axis: vertical,\n    shouldUseTimeDampening: shouldUseTimeDampening\n  });\n  var x = getScrollOnAxis({\n    container: container,\n    distanceToEdges: distanceToEdges,\n    dragStartTime: dragStartTime,\n    axis: horizontal,\n    shouldUseTimeDampening: shouldUseTimeDampening\n  });\n  var required = clean$2({\n    x: x,\n    y: y\n  });\n\n  if (isEqual(required, origin)) {\n    return null;\n  }\n\n  var limited = adjustForSizeLimits({\n    container: container,\n    subject: subject,\n    proposedScroll: required\n  });\n\n  if (!limited) {\n    return null;\n  }\n\n  return isEqual(limited, origin) ? null : limited;\n});\n\nvar smallestSigned = apply(function (value) {\n  if (value === 0) {\n    return 0;\n  }\n\n  return value > 0 ? 1 : -1;\n});\nvar getOverlap = function () {\n  var getRemainder = function getRemainder(target, max) {\n    if (target < 0) {\n      return target;\n    }\n\n    if (target > max) {\n      return target - max;\n    }\n\n    return 0;\n  };\n\n  return function (_ref) {\n    var current = _ref.current,\n        max = _ref.max,\n        change = _ref.change;\n    var targetScroll = add(current, change);\n    var overlap = {\n      x: getRemainder(targetScroll.x, max.x),\n      y: getRemainder(targetScroll.y, max.y)\n    };\n\n    if (isEqual(overlap, origin)) {\n      return null;\n    }\n\n    return overlap;\n  };\n}();\nvar canPartiallyScroll = function canPartiallyScroll(_ref2) {\n  var rawMax = _ref2.max,\n      current = _ref2.current,\n      change = _ref2.change;\n  var max = {\n    x: Math.max(current.x, rawMax.x),\n    y: Math.max(current.y, rawMax.y)\n  };\n  var smallestChange = smallestSigned(change);\n  var overlap = getOverlap({\n    max: max,\n    current: current,\n    change: smallestChange\n  });\n\n  if (!overlap) {\n    return true;\n  }\n\n  if (smallestChange.x !== 0 && overlap.x === 0) {\n    return true;\n  }\n\n  if (smallestChange.y !== 0 && overlap.y === 0) {\n    return true;\n  }\n\n  return false;\n};\nvar canScrollWindow = function canScrollWindow(viewport, change) {\n  return canPartiallyScroll({\n    current: viewport.scroll.current,\n    max: viewport.scroll.max,\n    change: change\n  });\n};\nvar getWindowOverlap = function getWindowOverlap(viewport, change) {\n  if (!canScrollWindow(viewport, change)) {\n    return null;\n  }\n\n  var max = viewport.scroll.max;\n  var current = viewport.scroll.current;\n  return getOverlap({\n    current: current,\n    max: max,\n    change: change\n  });\n};\nvar canScrollDroppable = function canScrollDroppable(droppable, change) {\n  var frame = droppable.frame;\n\n  if (!frame) {\n    return false;\n  }\n\n  return canPartiallyScroll({\n    current: frame.scroll.current,\n    max: frame.scroll.max,\n    change: change\n  });\n};\nvar getDroppableOverlap = function getDroppableOverlap(droppable, change) {\n  var frame = droppable.frame;\n\n  if (!frame) {\n    return null;\n  }\n\n  if (!canScrollDroppable(droppable, change)) {\n    return null;\n  }\n\n  return getOverlap({\n    current: frame.scroll.current,\n    max: frame.scroll.max,\n    change: change\n  });\n};\n\nvar getWindowScrollChange = (function (_ref) {\n  var viewport = _ref.viewport,\n      subject = _ref.subject,\n      center = _ref.center,\n      dragStartTime = _ref.dragStartTime,\n      shouldUseTimeDampening = _ref.shouldUseTimeDampening;\n  var scroll = getScroll({\n    dragStartTime: dragStartTime,\n    container: viewport.frame,\n    subject: subject,\n    center: center,\n    shouldUseTimeDampening: shouldUseTimeDampening\n  });\n  return scroll && canScrollWindow(viewport, scroll) ? scroll : null;\n});\n\nvar getDroppableScrollChange = (function (_ref) {\n  var droppable = _ref.droppable,\n      subject = _ref.subject,\n      center = _ref.center,\n      dragStartTime = _ref.dragStartTime,\n      shouldUseTimeDampening = _ref.shouldUseTimeDampening;\n  var frame = droppable.frame;\n\n  if (!frame) {\n    return null;\n  }\n\n  var scroll = getScroll({\n    dragStartTime: dragStartTime,\n    container: frame.pageMarginBox,\n    subject: subject,\n    center: center,\n    shouldUseTimeDampening: shouldUseTimeDampening\n  });\n  return scroll && canScrollDroppable(droppable, scroll) ? scroll : null;\n});\n\nvar scroll$1 = (function (_ref) {\n  var state = _ref.state,\n      dragStartTime = _ref.dragStartTime,\n      shouldUseTimeDampening = _ref.shouldUseTimeDampening,\n      scrollWindow = _ref.scrollWindow,\n      scrollDroppable = _ref.scrollDroppable;\n  var center = state.current.page.borderBoxCenter;\n  var draggable = state.dimensions.draggables[state.critical.draggable.id];\n  var subject = draggable.page.marginBox;\n\n  if (state.isWindowScrollAllowed) {\n    var viewport = state.viewport;\n\n    var _change = getWindowScrollChange({\n      dragStartTime: dragStartTime,\n      viewport: viewport,\n      subject: subject,\n      center: center,\n      shouldUseTimeDampening: shouldUseTimeDampening\n    });\n\n    if (_change) {\n      scrollWindow(_change);\n      return;\n    }\n  }\n\n  var droppable = getBestScrollableDroppable({\n    center: center,\n    destination: whatIsDraggedOver(state.impact),\n    droppables: state.dimensions.droppables\n  });\n\n  if (!droppable) {\n    return;\n  }\n\n  var change = getDroppableScrollChange({\n    dragStartTime: dragStartTime,\n    droppable: droppable,\n    subject: subject,\n    center: center,\n    shouldUseTimeDampening: shouldUseTimeDampening\n  });\n\n  if (change) {\n    scrollDroppable(droppable.descriptor.id, change);\n  }\n});\n\nvar createFluidScroller = (function (_ref) {\n  var scrollWindow = _ref.scrollWindow,\n      scrollDroppable = _ref.scrollDroppable;\n  var scheduleWindowScroll = rafSchd(scrollWindow);\n  var scheduleDroppableScroll = rafSchd(scrollDroppable);\n  var dragging = null;\n\n  var tryScroll = function tryScroll(state) {\n    !dragging ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot fluid scroll if not dragging') : invariant(false) : void 0;\n    var _dragging = dragging,\n        shouldUseTimeDampening = _dragging.shouldUseTimeDampening,\n        dragStartTime = _dragging.dragStartTime;\n    scroll$1({\n      state: state,\n      scrollWindow: scheduleWindowScroll,\n      scrollDroppable: scheduleDroppableScroll,\n      dragStartTime: dragStartTime,\n      shouldUseTimeDampening: shouldUseTimeDampening\n    });\n  };\n\n  var start$1 = function start$1(state) {\n    start();\n    !!dragging ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot start auto scrolling when already started') : invariant(false) : void 0;\n    var dragStartTime = Date.now();\n    var wasScrollNeeded = false;\n\n    var fakeScrollCallback = function fakeScrollCallback() {\n      wasScrollNeeded = true;\n    };\n\n    scroll$1({\n      state: state,\n      dragStartTime: 0,\n      shouldUseTimeDampening: false,\n      scrollWindow: fakeScrollCallback,\n      scrollDroppable: fakeScrollCallback\n    });\n    dragging = {\n      dragStartTime: dragStartTime,\n      shouldUseTimeDampening: wasScrollNeeded\n    };\n    finish();\n\n    if (wasScrollNeeded) {\n      tryScroll(state);\n    }\n  };\n\n  var stop = function stop() {\n    if (!dragging) {\n      return;\n    }\n\n    scheduleWindowScroll.cancel();\n    scheduleDroppableScroll.cancel();\n    dragging = null;\n  };\n\n  return {\n    start: start$1,\n    stop: stop,\n    scroll: tryScroll\n  };\n});\n\nvar createJumpScroller = (function (_ref) {\n  var move = _ref.move,\n      scrollDroppable = _ref.scrollDroppable,\n      scrollWindow = _ref.scrollWindow;\n\n  var moveByOffset = function moveByOffset(state, offset) {\n    var client = add(state.current.client.selection, offset);\n    move({\n      client: client\n    });\n  };\n\n  var scrollDroppableAsMuchAsItCan = function scrollDroppableAsMuchAsItCan(droppable, change) {\n    if (!canScrollDroppable(droppable, change)) {\n      return change;\n    }\n\n    var overlap = getDroppableOverlap(droppable, change);\n\n    if (!overlap) {\n      scrollDroppable(droppable.descriptor.id, change);\n      return null;\n    }\n\n    var whatTheDroppableCanScroll = subtract(change, overlap);\n    scrollDroppable(droppable.descriptor.id, whatTheDroppableCanScroll);\n    var remainder = subtract(change, whatTheDroppableCanScroll);\n    return remainder;\n  };\n\n  var scrollWindowAsMuchAsItCan = function scrollWindowAsMuchAsItCan(isWindowScrollAllowed, viewport, change) {\n    if (!isWindowScrollAllowed) {\n      return change;\n    }\n\n    if (!canScrollWindow(viewport, change)) {\n      return change;\n    }\n\n    var overlap = getWindowOverlap(viewport, change);\n\n    if (!overlap) {\n      scrollWindow(change);\n      return null;\n    }\n\n    var whatTheWindowCanScroll = subtract(change, overlap);\n    scrollWindow(whatTheWindowCanScroll);\n    var remainder = subtract(change, whatTheWindowCanScroll);\n    return remainder;\n  };\n\n  var jumpScroller = function jumpScroller(state) {\n    var request = state.scrollJumpRequest;\n\n    if (!request) {\n      return;\n    }\n\n    var destination = whatIsDraggedOver(state.impact);\n    !destination ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot perform a jump scroll when there is no destination') : invariant(false) : void 0;\n    var droppableRemainder = scrollDroppableAsMuchAsItCan(state.dimensions.droppables[destination], request);\n\n    if (!droppableRemainder) {\n      return;\n    }\n\n    var viewport = state.viewport;\n    var windowRemainder = scrollWindowAsMuchAsItCan(state.isWindowScrollAllowed, viewport, droppableRemainder);\n\n    if (!windowRemainder) {\n      return;\n    }\n\n    moveByOffset(state, windowRemainder);\n  };\n\n  return jumpScroller;\n});\n\nvar createAutoScroller = (function (_ref) {\n  var scrollDroppable = _ref.scrollDroppable,\n      scrollWindow = _ref.scrollWindow,\n      move = _ref.move;\n  var fluidScroller = createFluidScroller({\n    scrollWindow: scrollWindow,\n    scrollDroppable: scrollDroppable\n  });\n  var jumpScroll = createJumpScroller({\n    move: move,\n    scrollWindow: scrollWindow,\n    scrollDroppable: scrollDroppable\n  });\n\n  var scroll = function scroll(state) {\n    if (state.phase !== 'DRAGGING') {\n      return;\n    }\n\n    if (state.movementMode === 'FLUID') {\n      fluidScroller.scroll(state);\n      return;\n    }\n\n    if (!state.scrollJumpRequest) {\n      return;\n    }\n\n    jumpScroll(state);\n  };\n\n  var scroller = {\n    scroll: scroll,\n    start: fluidScroller.start,\n    stop: fluidScroller.stop\n  };\n  return scroller;\n});\n\nvar prefix$1 = 'data-rbd';\nvar dragHandle = function () {\n  var base = prefix$1 + \"-drag-handle\";\n  return {\n    base: base,\n    draggableId: base + \"-draggable-id\",\n    contextId: base + \"-context-id\"\n  };\n}();\nvar draggable = function () {\n  var base = prefix$1 + \"-draggable\";\n  return {\n    base: base,\n    contextId: base + \"-context-id\",\n    id: base + \"-id\"\n  };\n}();\nvar droppable = function () {\n  var base = prefix$1 + \"-droppable\";\n  return {\n    base: base,\n    contextId: base + \"-context-id\",\n    id: base + \"-id\"\n  };\n}();\nvar scrollContainer = {\n  contextId: prefix$1 + \"-scroll-container-context-id\"\n};\n\nvar makeGetSelector = function makeGetSelector(context) {\n  return function (attribute) {\n    return \"[\" + attribute + \"=\\\"\" + context + \"\\\"]\";\n  };\n};\n\nvar getStyles = function getStyles(rules, property) {\n  return rules.map(function (rule) {\n    var value = rule.styles[property];\n\n    if (!value) {\n      return '';\n    }\n\n    return rule.selector + \" { \" + value + \" }\";\n  }).join(' ');\n};\n\nvar noPointerEvents = 'pointer-events: none;';\nvar getStyles$1 = (function (contextId) {\n  var getSelector = makeGetSelector(contextId);\n\n  var dragHandle$1 = function () {\n    var grabCursor = \"\\n      cursor: -webkit-grab;\\n      cursor: grab;\\n    \";\n    return {\n      selector: getSelector(dragHandle.contextId),\n      styles: {\n        always: \"\\n          -webkit-touch-callout: none;\\n          -webkit-tap-highlight-color: rgba(0,0,0,0);\\n          touch-action: manipulation;\\n        \",\n        resting: grabCursor,\n        dragging: noPointerEvents,\n        dropAnimating: grabCursor\n      }\n    };\n  }();\n\n  var draggable$1 = function () {\n    var transition = \"\\n      transition: \" + transitions.outOfTheWay + \";\\n    \";\n    return {\n      selector: getSelector(draggable.contextId),\n      styles: {\n        dragging: transition,\n        dropAnimating: transition,\n        userCancel: transition\n      }\n    };\n  }();\n\n  var droppable$1 = {\n    selector: getSelector(droppable.contextId),\n    styles: {\n      always: \"overflow-anchor: none;\"\n    }\n  };\n  var body = {\n    selector: 'body',\n    styles: {\n      dragging: \"\\n        cursor: grabbing;\\n        cursor: -webkit-grabbing;\\n        user-select: none;\\n        -webkit-user-select: none;\\n        -moz-user-select: none;\\n        -ms-user-select: none;\\n        overflow-anchor: none;\\n      \"\n    }\n  };\n  var rules = [draggable$1, dragHandle$1, droppable$1, body];\n  return {\n    always: getStyles(rules, 'always'),\n    resting: getStyles(rules, 'resting'),\n    dragging: getStyles(rules, 'dragging'),\n    dropAnimating: getStyles(rules, 'dropAnimating'),\n    userCancel: getStyles(rules, 'userCancel')\n  };\n});\n\nvar useIsomorphicLayoutEffect = typeof window !== 'undefined' && typeof window.document !== 'undefined' && typeof window.document.createElement !== 'undefined' ? useLayoutEffect : useEffect;\n\nvar getHead = function getHead() {\n  var head = document.querySelector('head');\n  !head ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot find the head to append a style to') : invariant(false) : void 0;\n  return head;\n};\n\nvar createStyleEl = function createStyleEl(nonce) {\n  var el = document.createElement('style');\n\n  if (nonce) {\n    el.setAttribute('nonce', nonce);\n  }\n\n  el.type = 'text/css';\n  return el;\n};\n\nfunction useStyleMarshal(contextId, nonce) {\n  var styles = useMemo(function () {\n    return getStyles$1(contextId);\n  }, [contextId]);\n  var alwaysRef = useRef(null);\n  var dynamicRef = useRef(null);\n  var setDynamicStyle = useCallback(memoizeOne(function (proposed) {\n    var el = dynamicRef.current;\n    !el ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot set dynamic style element if it is not set') : invariant(false) : void 0;\n    el.textContent = proposed;\n  }), []);\n  var setAlwaysStyle = useCallback(function (proposed) {\n    var el = alwaysRef.current;\n    !el ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot set dynamic style element if it is not set') : invariant(false) : void 0;\n    el.textContent = proposed;\n  }, []);\n  useIsomorphicLayoutEffect(function () {\n    !(!alwaysRef.current && !dynamicRef.current) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'style elements already mounted') : invariant(false) : void 0;\n    var always = createStyleEl(nonce);\n    var dynamic = createStyleEl(nonce);\n    alwaysRef.current = always;\n    dynamicRef.current = dynamic;\n    always.setAttribute(prefix$1 + \"-always\", contextId);\n    dynamic.setAttribute(prefix$1 + \"-dynamic\", contextId);\n    getHead().appendChild(always);\n    getHead().appendChild(dynamic);\n    setAlwaysStyle(styles.always);\n    setDynamicStyle(styles.resting);\n    return function () {\n      var remove = function remove(ref) {\n        var current = ref.current;\n        !current ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot unmount ref as it is not set') : invariant(false) : void 0;\n        getHead().removeChild(current);\n        ref.current = null;\n      };\n\n      remove(alwaysRef);\n      remove(dynamicRef);\n    };\n  }, [nonce, setAlwaysStyle, setDynamicStyle, styles.always, styles.resting, contextId]);\n  var dragging = useCallback(function () {\n    return setDynamicStyle(styles.dragging);\n  }, [setDynamicStyle, styles.dragging]);\n  var dropping = useCallback(function (reason) {\n    if (reason === 'DROP') {\n      setDynamicStyle(styles.dropAnimating);\n      return;\n    }\n\n    setDynamicStyle(styles.userCancel);\n  }, [setDynamicStyle, styles.dropAnimating, styles.userCancel]);\n  var resting = useCallback(function () {\n    if (!dynamicRef.current) {\n      return;\n    }\n\n    setDynamicStyle(styles.resting);\n  }, [setDynamicStyle, styles.resting]);\n  var marshal = useMemo(function () {\n    return {\n      dragging: dragging,\n      dropping: dropping,\n      resting: resting\n    };\n  }, [dragging, dropping, resting]);\n  return marshal;\n}\n\nvar getWindowFromEl = (function (el) {\n  return el && el.ownerDocument ? el.ownerDocument.defaultView : window;\n});\n\nfunction isHtmlElement(el) {\n  return el instanceof getWindowFromEl(el).HTMLElement;\n}\n\nfunction findDragHandle(contextId, draggableId) {\n  var selector = \"[\" + dragHandle.contextId + \"=\\\"\" + contextId + \"\\\"]\";\n  var possible = toArray(document.querySelectorAll(selector));\n\n  if (!possible.length) {\n    process.env.NODE_ENV !== \"production\" ? warning(\"Unable to find any drag handles in the context \\\"\" + contextId + \"\\\"\") : void 0;\n    return null;\n  }\n\n  var handle = find(possible, function (el) {\n    return el.getAttribute(dragHandle.draggableId) === draggableId;\n  });\n\n  if (!handle) {\n    process.env.NODE_ENV !== \"production\" ? warning(\"Unable to find drag handle with id \\\"\" + draggableId + \"\\\" as no handle with a matching id was found\") : void 0;\n    return null;\n  }\n\n  if (!isHtmlElement(handle)) {\n    process.env.NODE_ENV !== \"production\" ? warning('drag handle needs to be a HTMLElement') : void 0;\n    return null;\n  }\n\n  return handle;\n}\n\nfunction useFocusMarshal(contextId) {\n  var entriesRef = useRef({});\n  var recordRef = useRef(null);\n  var restoreFocusFrameRef = useRef(null);\n  var isMountedRef = useRef(false);\n  var register = useCallback(function register(id, focus) {\n    var entry = {\n      id: id,\n      focus: focus\n    };\n    entriesRef.current[id] = entry;\n    return function unregister() {\n      var entries = entriesRef.current;\n      var current = entries[id];\n\n      if (current !== entry) {\n        delete entries[id];\n      }\n    };\n  }, []);\n  var tryGiveFocus = useCallback(function tryGiveFocus(tryGiveFocusTo) {\n    var handle = findDragHandle(contextId, tryGiveFocusTo);\n\n    if (handle && handle !== document.activeElement) {\n      handle.focus();\n    }\n  }, [contextId]);\n  var tryShiftRecord = useCallback(function tryShiftRecord(previous, redirectTo) {\n    if (recordRef.current === previous) {\n      recordRef.current = redirectTo;\n    }\n  }, []);\n  var tryRestoreFocusRecorded = useCallback(function tryRestoreFocusRecorded() {\n    if (restoreFocusFrameRef.current) {\n      return;\n    }\n\n    if (!isMountedRef.current) {\n      return;\n    }\n\n    restoreFocusFrameRef.current = requestAnimationFrame(function () {\n      restoreFocusFrameRef.current = null;\n      var record = recordRef.current;\n\n      if (record) {\n        tryGiveFocus(record);\n      }\n    });\n  }, [tryGiveFocus]);\n  var tryRecordFocus = useCallback(function tryRecordFocus(id) {\n    recordRef.current = null;\n    var focused = document.activeElement;\n\n    if (!focused) {\n      return;\n    }\n\n    if (focused.getAttribute(dragHandle.draggableId) !== id) {\n      return;\n    }\n\n    recordRef.current = id;\n  }, []);\n  useIsomorphicLayoutEffect(function () {\n    isMountedRef.current = true;\n    return function clearFrameOnUnmount() {\n      isMountedRef.current = false;\n      var frameId = restoreFocusFrameRef.current;\n\n      if (frameId) {\n        cancelAnimationFrame(frameId);\n      }\n    };\n  }, []);\n  var marshal = useMemo(function () {\n    return {\n      register: register,\n      tryRecordFocus: tryRecordFocus,\n      tryRestoreFocusRecorded: tryRestoreFocusRecorded,\n      tryShiftRecord: tryShiftRecord\n    };\n  }, [register, tryRecordFocus, tryRestoreFocusRecorded, tryShiftRecord]);\n  return marshal;\n}\n\nfunction createRegistry() {\n  var entries = {\n    draggables: {},\n    droppables: {}\n  };\n  var subscribers = [];\n\n  function subscribe(cb) {\n    subscribers.push(cb);\n    return function unsubscribe() {\n      var index = subscribers.indexOf(cb);\n\n      if (index === -1) {\n        return;\n      }\n\n      subscribers.splice(index, 1);\n    };\n  }\n\n  function notify(event) {\n    if (subscribers.length) {\n      subscribers.forEach(function (cb) {\n        return cb(event);\n      });\n    }\n  }\n\n  function findDraggableById(id) {\n    return entries.draggables[id] || null;\n  }\n\n  function getDraggableById(id) {\n    var entry = findDraggableById(id);\n    !entry ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"Cannot find draggable entry with id [\" + id + \"]\") : invariant(false) : void 0;\n    return entry;\n  }\n\n  var draggableAPI = {\n    register: function register(entry) {\n      entries.draggables[entry.descriptor.id] = entry;\n      notify({\n        type: 'ADDITION',\n        value: entry\n      });\n    },\n    update: function update(entry, last) {\n      var current = entries.draggables[last.descriptor.id];\n\n      if (!current) {\n        return;\n      }\n\n      if (current.uniqueId !== entry.uniqueId) {\n        return;\n      }\n\n      delete entries.draggables[last.descriptor.id];\n      entries.draggables[entry.descriptor.id] = entry;\n    },\n    unregister: function unregister(entry) {\n      var draggableId = entry.descriptor.id;\n      var current = findDraggableById(draggableId);\n\n      if (!current) {\n        return;\n      }\n\n      if (entry.uniqueId !== current.uniqueId) {\n        return;\n      }\n\n      delete entries.draggables[draggableId];\n      notify({\n        type: 'REMOVAL',\n        value: entry\n      });\n    },\n    getById: getDraggableById,\n    findById: findDraggableById,\n    exists: function exists(id) {\n      return Boolean(findDraggableById(id));\n    },\n    getAllByType: function getAllByType(type) {\n      return values(entries.draggables).filter(function (entry) {\n        return entry.descriptor.type === type;\n      });\n    }\n  };\n\n  function findDroppableById(id) {\n    return entries.droppables[id] || null;\n  }\n\n  function getDroppableById(id) {\n    var entry = findDroppableById(id);\n    !entry ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"Cannot find droppable entry with id [\" + id + \"]\") : invariant(false) : void 0;\n    return entry;\n  }\n\n  var droppableAPI = {\n    register: function register(entry) {\n      entries.droppables[entry.descriptor.id] = entry;\n    },\n    unregister: function unregister(entry) {\n      var current = findDroppableById(entry.descriptor.id);\n\n      if (!current) {\n        return;\n      }\n\n      if (entry.uniqueId !== current.uniqueId) {\n        return;\n      }\n\n      delete entries.droppables[entry.descriptor.id];\n    },\n    getById: getDroppableById,\n    findById: findDroppableById,\n    exists: function exists(id) {\n      return Boolean(findDroppableById(id));\n    },\n    getAllByType: function getAllByType(type) {\n      return values(entries.droppables).filter(function (entry) {\n        return entry.descriptor.type === type;\n      });\n    }\n  };\n\n  function clean() {\n    entries.draggables = {};\n    entries.droppables = {};\n    subscribers.length = 0;\n  }\n\n  return {\n    draggable: draggableAPI,\n    droppable: droppableAPI,\n    subscribe: subscribe,\n    clean: clean\n  };\n}\n\nfunction useRegistry() {\n  var registry = useMemo(createRegistry, []);\n  useEffect(function () {\n    return function unmount() {\n      requestAnimationFrame(registry.clean);\n    };\n  }, [registry]);\n  return registry;\n}\n\nvar StoreContext = React.createContext(null);\n\nvar getBodyElement = (function () {\n  var body = document.body;\n  !body ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot find document.body') : invariant(false) : void 0;\n  return body;\n});\n\nvar visuallyHidden = {\n  position: 'absolute',\n  width: '1px',\n  height: '1px',\n  margin: '-1px',\n  border: '0',\n  padding: '0',\n  overflow: 'hidden',\n  clip: 'rect(0 0 0 0)',\n  'clip-path': 'inset(100%)'\n};\n\nvar getId = function getId(contextId) {\n  return \"rbd-announcement-\" + contextId;\n};\nfunction useAnnouncer(contextId) {\n  var id = useMemo(function () {\n    return getId(contextId);\n  }, [contextId]);\n  var ref = useRef(null);\n  useEffect(function setup() {\n    var el = document.createElement('div');\n    ref.current = el;\n    el.id = id;\n    el.setAttribute('aria-live', 'assertive');\n    el.setAttribute('aria-atomic', 'true');\n\n    _extends(el.style, visuallyHidden);\n\n    getBodyElement().appendChild(el);\n    return function cleanup() {\n      setTimeout(function remove() {\n        var body = getBodyElement();\n\n        if (body.contains(el)) {\n          body.removeChild(el);\n        }\n\n        if (el === ref.current) {\n          ref.current = null;\n        }\n      });\n    };\n  }, [id]);\n  var announce = useCallback(function (message) {\n    var el = ref.current;\n\n    if (el) {\n      el.textContent = message;\n      return;\n    }\n\n    process.env.NODE_ENV !== \"production\" ? warning(\"\\n      A screen reader message was trying to be announced but it was unable to do so.\\n      This can occur if you unmount your <DragDropContext /> in your onDragEnd.\\n      Consider calling provided.announce() before the unmount so that the instruction will\\n      not be lost for users relying on a screen reader.\\n\\n      Message not passed to screen reader:\\n\\n      \\\"\" + message + \"\\\"\\n    \") : void 0;\n  }, []);\n  return announce;\n}\n\nvar count = 0;\nvar defaults = {\n  separator: '::'\n};\nfunction reset() {\n  count = 0;\n}\nfunction useUniqueId(prefix, options) {\n  if (options === void 0) {\n    options = defaults;\n  }\n\n  return useMemo(function () {\n    return \"\" + prefix + options.separator + count++;\n  }, [options.separator, prefix]);\n}\n\nfunction getElementId(_ref) {\n  var contextId = _ref.contextId,\n      uniqueId = _ref.uniqueId;\n  return \"rbd-hidden-text-\" + contextId + \"-\" + uniqueId;\n}\nfunction useHiddenTextElement(_ref2) {\n  var contextId = _ref2.contextId,\n      text = _ref2.text;\n  var uniqueId = useUniqueId('hidden-text', {\n    separator: '-'\n  });\n  var id = useMemo(function () {\n    return getElementId({\n      contextId: contextId,\n      uniqueId: uniqueId\n    });\n  }, [uniqueId, contextId]);\n  useEffect(function mount() {\n    var el = document.createElement('div');\n    el.id = id;\n    el.textContent = text;\n    el.style.display = 'none';\n    getBodyElement().appendChild(el);\n    return function unmount() {\n      var body = getBodyElement();\n\n      if (body.contains(el)) {\n        body.removeChild(el);\n      }\n    };\n  }, [id, text]);\n  return id;\n}\n\nvar AppContext = React.createContext(null);\n\nvar peerDependencies = {\n\treact: \"^16.8.5 || ^17.0.0 || ^18.0.0\",\n\t\"react-dom\": \"^16.8.5 || ^17.0.0 || ^18.0.0\"\n};\n\nvar semver = /(\\d+)\\.(\\d+)\\.(\\d+)/;\n\nvar getVersion = function getVersion(value) {\n  var result = semver.exec(value);\n  !(result != null) ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"Unable to parse React version \" + value) : invariant(false) : void 0;\n  var major = Number(result[1]);\n  var minor = Number(result[2]);\n  var patch = Number(result[3]);\n  return {\n    major: major,\n    minor: minor,\n    patch: patch,\n    raw: value\n  };\n};\n\nvar isSatisfied = function isSatisfied(expected, actual) {\n  if (actual.major > expected.major) {\n    return true;\n  }\n\n  if (actual.major < expected.major) {\n    return false;\n  }\n\n  if (actual.minor > expected.minor) {\n    return true;\n  }\n\n  if (actual.minor < expected.minor) {\n    return false;\n  }\n\n  return actual.patch >= expected.patch;\n};\n\nvar checkReactVersion = (function (peerDepValue, actualValue) {\n  var peerDep = getVersion(peerDepValue);\n  var actual = getVersion(actualValue);\n\n  if (isSatisfied(peerDep, actual)) {\n    return;\n  }\n\n  process.env.NODE_ENV !== \"production\" ? warning(\"\\n    React version: [\" + actual.raw + \"]\\n    does not satisfy expected peer dependency version: [\" + peerDep.raw + \"]\\n\\n    This can result in run time bugs, and even fatal crashes\\n  \") : void 0;\n});\n\nvar suffix = \"\\n  We expect a html5 doctype: <!doctype html>\\n  This is to ensure consistent browser layout and measurement\\n\\n  More information: https://github.com/atlassian/react-beautiful-dnd/blob/master/docs/guides/doctype.md\\n\";\nvar checkDoctype = (function (doc) {\n  var doctype = doc.doctype;\n\n  if (!doctype) {\n    process.env.NODE_ENV !== \"production\" ? warning(\"\\n      No <!doctype html> found.\\n\\n      \" + suffix + \"\\n    \") : void 0;\n    return;\n  }\n\n  if (doctype.name.toLowerCase() !== 'html') {\n    process.env.NODE_ENV !== \"production\" ? warning(\"\\n      Unexpected <!doctype> found: (\" + doctype.name + \")\\n\\n      \" + suffix + \"\\n    \") : void 0;\n  }\n\n  if (doctype.publicId !== '') {\n    process.env.NODE_ENV !== \"production\" ? warning(\"\\n      Unexpected <!doctype> publicId found: (\" + doctype.publicId + \")\\n      A html5 doctype does not have a publicId\\n\\n      \" + suffix + \"\\n    \") : void 0;\n  }\n});\n\nfunction useDev(useHook) {\n  if (process.env.NODE_ENV !== 'production') {\n    useHook();\n  }\n}\n\nfunction useDevSetupWarning(fn, inputs) {\n  useDev(function () {\n    useEffect(function () {\n      try {\n        fn();\n      } catch (e) {\n        error(\"\\n          A setup problem was encountered.\\n\\n          > \" + e.message + \"\\n        \");\n      }\n    }, inputs);\n  });\n}\n\nfunction useStartupValidation() {\n  useDevSetupWarning(function () {\n    checkReactVersion(peerDependencies.react, React.version);\n    checkDoctype(document);\n  }, []);\n}\n\nfunction usePrevious(current) {\n  var ref = useRef(current);\n  useEffect(function () {\n    ref.current = current;\n  });\n  return ref;\n}\n\nfunction create() {\n  var lock = null;\n\n  function isClaimed() {\n    return Boolean(lock);\n  }\n\n  function isActive(value) {\n    return value === lock;\n  }\n\n  function claim(abandon) {\n    !!lock ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot claim lock as it is already claimed') : invariant(false) : void 0;\n    var newLock = {\n      abandon: abandon\n    };\n    lock = newLock;\n    return newLock;\n  }\n\n  function release() {\n    !lock ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot release lock when there is no lock') : invariant(false) : void 0;\n    lock = null;\n  }\n\n  function tryAbandon() {\n    if (lock) {\n      lock.abandon();\n      release();\n    }\n  }\n\n  return {\n    isClaimed: isClaimed,\n    isActive: isActive,\n    claim: claim,\n    release: release,\n    tryAbandon: tryAbandon\n  };\n}\n\nvar tab = 9;\nvar enter = 13;\nvar escape = 27;\nvar space = 32;\nvar pageUp = 33;\nvar pageDown = 34;\nvar end = 35;\nvar home = 36;\nvar arrowLeft = 37;\nvar arrowUp = 38;\nvar arrowRight = 39;\nvar arrowDown = 40;\n\nvar _preventedKeys;\nvar preventedKeys = (_preventedKeys = {}, _preventedKeys[enter] = true, _preventedKeys[tab] = true, _preventedKeys);\nvar preventStandardKeyEvents = (function (event) {\n  if (preventedKeys[event.keyCode]) {\n    event.preventDefault();\n  }\n});\n\nvar supportedEventName = function () {\n  var base = 'visibilitychange';\n\n  if (typeof document === 'undefined') {\n    return base;\n  }\n\n  var candidates = [base, \"ms\" + base, \"webkit\" + base, \"moz\" + base, \"o\" + base];\n  var supported = find(candidates, function (eventName) {\n    return \"on\" + eventName in document;\n  });\n  return supported || base;\n}();\n\nvar primaryButton = 0;\nvar sloppyClickThreshold = 5;\n\nfunction isSloppyClickThresholdExceeded(original, current) {\n  return Math.abs(current.x - original.x) >= sloppyClickThreshold || Math.abs(current.y - original.y) >= sloppyClickThreshold;\n}\n\nvar idle$1 = {\n  type: 'IDLE'\n};\n\nfunction getCaptureBindings(_ref) {\n  var cancel = _ref.cancel,\n      completed = _ref.completed,\n      getPhase = _ref.getPhase,\n      setPhase = _ref.setPhase;\n  return [{\n    eventName: 'mousemove',\n    fn: function fn(event) {\n      var button = event.button,\n          clientX = event.clientX,\n          clientY = event.clientY;\n\n      if (button !== primaryButton) {\n        return;\n      }\n\n      var point = {\n        x: clientX,\n        y: clientY\n      };\n      var phase = getPhase();\n\n      if (phase.type === 'DRAGGING') {\n        event.preventDefault();\n        phase.actions.move(point);\n        return;\n      }\n\n      !(phase.type === 'PENDING') ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot be IDLE') : invariant(false) : void 0;\n      var pending = phase.point;\n\n      if (!isSloppyClickThresholdExceeded(pending, point)) {\n        return;\n      }\n\n      event.preventDefault();\n      var actions = phase.actions.fluidLift(point);\n      setPhase({\n        type: 'DRAGGING',\n        actions: actions\n      });\n    }\n  }, {\n    eventName: 'mouseup',\n    fn: function fn(event) {\n      var phase = getPhase();\n\n      if (phase.type !== 'DRAGGING') {\n        cancel();\n        return;\n      }\n\n      event.preventDefault();\n      phase.actions.drop({\n        shouldBlockNextClick: true\n      });\n      completed();\n    }\n  }, {\n    eventName: 'mousedown',\n    fn: function fn(event) {\n      if (getPhase().type === 'DRAGGING') {\n        event.preventDefault();\n      }\n\n      cancel();\n    }\n  }, {\n    eventName: 'keydown',\n    fn: function fn(event) {\n      var phase = getPhase();\n\n      if (phase.type === 'PENDING') {\n        cancel();\n        return;\n      }\n\n      if (event.keyCode === escape) {\n        event.preventDefault();\n        cancel();\n        return;\n      }\n\n      preventStandardKeyEvents(event);\n    }\n  }, {\n    eventName: 'resize',\n    fn: cancel\n  }, {\n    eventName: 'scroll',\n    options: {\n      passive: true,\n      capture: false\n    },\n    fn: function fn() {\n      if (getPhase().type === 'PENDING') {\n        cancel();\n      }\n    }\n  }, {\n    eventName: 'webkitmouseforcedown',\n    fn: function fn(event) {\n      var phase = getPhase();\n      !(phase.type !== 'IDLE') ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Unexpected phase') : invariant(false) : void 0;\n\n      if (phase.actions.shouldRespectForcePress()) {\n        cancel();\n        return;\n      }\n\n      event.preventDefault();\n    }\n  }, {\n    eventName: supportedEventName,\n    fn: cancel\n  }];\n}\n\nfunction useMouseSensor(api) {\n  var phaseRef = useRef(idle$1);\n  var unbindEventsRef = useRef(noop);\n  var startCaptureBinding = useMemo(function () {\n    return {\n      eventName: 'mousedown',\n      fn: function onMouseDown(event) {\n        if (event.defaultPrevented) {\n          return;\n        }\n\n        if (event.button !== primaryButton) {\n          return;\n        }\n\n        if (event.ctrlKey || event.metaKey || event.shiftKey || event.altKey) {\n          return;\n        }\n\n        var draggableId = api.findClosestDraggableId(event);\n\n        if (!draggableId) {\n          return;\n        }\n\n        var actions = api.tryGetLock(draggableId, stop, {\n          sourceEvent: event\n        });\n\n        if (!actions) {\n          return;\n        }\n\n        event.preventDefault();\n        var point = {\n          x: event.clientX,\n          y: event.clientY\n        };\n        unbindEventsRef.current();\n        startPendingDrag(actions, point);\n      }\n    };\n  }, [api]);\n  var preventForcePressBinding = useMemo(function () {\n    return {\n      eventName: 'webkitmouseforcewillbegin',\n      fn: function fn(event) {\n        if (event.defaultPrevented) {\n          return;\n        }\n\n        var id = api.findClosestDraggableId(event);\n\n        if (!id) {\n          return;\n        }\n\n        var options = api.findOptionsForDraggable(id);\n\n        if (!options) {\n          return;\n        }\n\n        if (options.shouldRespectForcePress) {\n          return;\n        }\n\n        if (!api.canGetLock(id)) {\n          return;\n        }\n\n        event.preventDefault();\n      }\n    };\n  }, [api]);\n  var listenForCapture = useCallback(function listenForCapture() {\n    var options = {\n      passive: false,\n      capture: true\n    };\n    unbindEventsRef.current = bindEvents(window, [preventForcePressBinding, startCaptureBinding], options);\n  }, [preventForcePressBinding, startCaptureBinding]);\n  var stop = useCallback(function () {\n    var current = phaseRef.current;\n\n    if (current.type === 'IDLE') {\n      return;\n    }\n\n    phaseRef.current = idle$1;\n    unbindEventsRef.current();\n    listenForCapture();\n  }, [listenForCapture]);\n  var cancel = useCallback(function () {\n    var phase = phaseRef.current;\n    stop();\n\n    if (phase.type === 'DRAGGING') {\n      phase.actions.cancel({\n        shouldBlockNextClick: true\n      });\n    }\n\n    if (phase.type === 'PENDING') {\n      phase.actions.abort();\n    }\n  }, [stop]);\n  var bindCapturingEvents = useCallback(function bindCapturingEvents() {\n    var options = {\n      capture: true,\n      passive: false\n    };\n    var bindings = getCaptureBindings({\n      cancel: cancel,\n      completed: stop,\n      getPhase: function getPhase() {\n        return phaseRef.current;\n      },\n      setPhase: function setPhase(phase) {\n        phaseRef.current = phase;\n      }\n    });\n    unbindEventsRef.current = bindEvents(window, bindings, options);\n  }, [cancel, stop]);\n  var startPendingDrag = useCallback(function startPendingDrag(actions, point) {\n    !(phaseRef.current.type === 'IDLE') ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Expected to move from IDLE to PENDING drag') : invariant(false) : void 0;\n    phaseRef.current = {\n      type: 'PENDING',\n      point: point,\n      actions: actions\n    };\n    bindCapturingEvents();\n  }, [bindCapturingEvents]);\n  useIsomorphicLayoutEffect(function mount() {\n    listenForCapture();\n    return function unmount() {\n      unbindEventsRef.current();\n    };\n  }, [listenForCapture]);\n}\n\nvar _scrollJumpKeys;\n\nfunction noop$1() {}\n\nvar scrollJumpKeys = (_scrollJumpKeys = {}, _scrollJumpKeys[pageDown] = true, _scrollJumpKeys[pageUp] = true, _scrollJumpKeys[home] = true, _scrollJumpKeys[end] = true, _scrollJumpKeys);\n\nfunction getDraggingBindings(actions, stop) {\n  function cancel() {\n    stop();\n    actions.cancel();\n  }\n\n  function drop() {\n    stop();\n    actions.drop();\n  }\n\n  return [{\n    eventName: 'keydown',\n    fn: function fn(event) {\n      if (event.keyCode === escape) {\n        event.preventDefault();\n        cancel();\n        return;\n      }\n\n      if (event.keyCode === space) {\n        event.preventDefault();\n        drop();\n        return;\n      }\n\n      if (event.keyCode === arrowDown) {\n        event.preventDefault();\n        actions.moveDown();\n        return;\n      }\n\n      if (event.keyCode === arrowUp) {\n        event.preventDefault();\n        actions.moveUp();\n        return;\n      }\n\n      if (event.keyCode === arrowRight) {\n        event.preventDefault();\n        actions.moveRight();\n        return;\n      }\n\n      if (event.keyCode === arrowLeft) {\n        event.preventDefault();\n        actions.moveLeft();\n        return;\n      }\n\n      if (scrollJumpKeys[event.keyCode]) {\n        event.preventDefault();\n        return;\n      }\n\n      preventStandardKeyEvents(event);\n    }\n  }, {\n    eventName: 'mousedown',\n    fn: cancel\n  }, {\n    eventName: 'mouseup',\n    fn: cancel\n  }, {\n    eventName: 'click',\n    fn: cancel\n  }, {\n    eventName: 'touchstart',\n    fn: cancel\n  }, {\n    eventName: 'resize',\n    fn: cancel\n  }, {\n    eventName: 'wheel',\n    fn: cancel,\n    options: {\n      passive: true\n    }\n  }, {\n    eventName: supportedEventName,\n    fn: cancel\n  }];\n}\n\nfunction useKeyboardSensor(api) {\n  var unbindEventsRef = useRef(noop$1);\n  var startCaptureBinding = useMemo(function () {\n    return {\n      eventName: 'keydown',\n      fn: function onKeyDown(event) {\n        if (event.defaultPrevented) {\n          return;\n        }\n\n        if (event.keyCode !== space) {\n          return;\n        }\n\n        var draggableId = api.findClosestDraggableId(event);\n\n        if (!draggableId) {\n          return;\n        }\n\n        var preDrag = api.tryGetLock(draggableId, stop, {\n          sourceEvent: event\n        });\n\n        if (!preDrag) {\n          return;\n        }\n\n        event.preventDefault();\n        var isCapturing = true;\n        var actions = preDrag.snapLift();\n        unbindEventsRef.current();\n\n        function stop() {\n          !isCapturing ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot stop capturing a keyboard drag when not capturing') : invariant(false) : void 0;\n          isCapturing = false;\n          unbindEventsRef.current();\n          listenForCapture();\n        }\n\n        unbindEventsRef.current = bindEvents(window, getDraggingBindings(actions, stop), {\n          capture: true,\n          passive: false\n        });\n      }\n    };\n  }, [api]);\n  var listenForCapture = useCallback(function tryStartCapture() {\n    var options = {\n      passive: false,\n      capture: true\n    };\n    unbindEventsRef.current = bindEvents(window, [startCaptureBinding], options);\n  }, [startCaptureBinding]);\n  useIsomorphicLayoutEffect(function mount() {\n    listenForCapture();\n    return function unmount() {\n      unbindEventsRef.current();\n    };\n  }, [listenForCapture]);\n}\n\nvar idle$2 = {\n  type: 'IDLE'\n};\nvar timeForLongPress = 120;\nvar forcePressThreshold = 0.15;\n\nfunction getWindowBindings(_ref) {\n  var cancel = _ref.cancel,\n      getPhase = _ref.getPhase;\n  return [{\n    eventName: 'orientationchange',\n    fn: cancel\n  }, {\n    eventName: 'resize',\n    fn: cancel\n  }, {\n    eventName: 'contextmenu',\n    fn: function fn(event) {\n      event.preventDefault();\n    }\n  }, {\n    eventName: 'keydown',\n    fn: function fn(event) {\n      if (getPhase().type !== 'DRAGGING') {\n        cancel();\n        return;\n      }\n\n      if (event.keyCode === escape) {\n        event.preventDefault();\n      }\n\n      cancel();\n    }\n  }, {\n    eventName: supportedEventName,\n    fn: cancel\n  }];\n}\n\nfunction getHandleBindings(_ref2) {\n  var cancel = _ref2.cancel,\n      completed = _ref2.completed,\n      getPhase = _ref2.getPhase;\n  return [{\n    eventName: 'touchmove',\n    options: {\n      capture: false\n    },\n    fn: function fn(event) {\n      var phase = getPhase();\n\n      if (phase.type !== 'DRAGGING') {\n        cancel();\n        return;\n      }\n\n      phase.hasMoved = true;\n      var _event$touches$ = event.touches[0],\n          clientX = _event$touches$.clientX,\n          clientY = _event$touches$.clientY;\n      var point = {\n        x: clientX,\n        y: clientY\n      };\n      event.preventDefault();\n      phase.actions.move(point);\n    }\n  }, {\n    eventName: 'touchend',\n    fn: function fn(event) {\n      var phase = getPhase();\n\n      if (phase.type !== 'DRAGGING') {\n        cancel();\n        return;\n      }\n\n      event.preventDefault();\n      phase.actions.drop({\n        shouldBlockNextClick: true\n      });\n      completed();\n    }\n  }, {\n    eventName: 'touchcancel',\n    fn: function fn(event) {\n      if (getPhase().type !== 'DRAGGING') {\n        cancel();\n        return;\n      }\n\n      event.preventDefault();\n      cancel();\n    }\n  }, {\n    eventName: 'touchforcechange',\n    fn: function fn(event) {\n      var phase = getPhase();\n      !(phase.type !== 'IDLE') ? process.env.NODE_ENV !== \"production\" ? invariant(false) : invariant(false) : void 0;\n      var touch = event.touches[0];\n\n      if (!touch) {\n        return;\n      }\n\n      var isForcePress = touch.force >= forcePressThreshold;\n\n      if (!isForcePress) {\n        return;\n      }\n\n      var shouldRespect = phase.actions.shouldRespectForcePress();\n\n      if (phase.type === 'PENDING') {\n        if (shouldRespect) {\n          cancel();\n        }\n\n        return;\n      }\n\n      if (shouldRespect) {\n        if (phase.hasMoved) {\n          event.preventDefault();\n          return;\n        }\n\n        cancel();\n        return;\n      }\n\n      event.preventDefault();\n    }\n  }, {\n    eventName: supportedEventName,\n    fn: cancel\n  }];\n}\n\nfunction useTouchSensor(api) {\n  var phaseRef = useRef(idle$2);\n  var unbindEventsRef = useRef(noop);\n  var getPhase = useCallback(function getPhase() {\n    return phaseRef.current;\n  }, []);\n  var setPhase = useCallback(function setPhase(phase) {\n    phaseRef.current = phase;\n  }, []);\n  var startCaptureBinding = useMemo(function () {\n    return {\n      eventName: 'touchstart',\n      fn: function onTouchStart(event) {\n        if (event.defaultPrevented) {\n          return;\n        }\n\n        var draggableId = api.findClosestDraggableId(event);\n\n        if (!draggableId) {\n          return;\n        }\n\n        var actions = api.tryGetLock(draggableId, stop, {\n          sourceEvent: event\n        });\n\n        if (!actions) {\n          return;\n        }\n\n        var touch = event.touches[0];\n        var clientX = touch.clientX,\n            clientY = touch.clientY;\n        var point = {\n          x: clientX,\n          y: clientY\n        };\n        unbindEventsRef.current();\n        startPendingDrag(actions, point);\n      }\n    };\n  }, [api]);\n  var listenForCapture = useCallback(function listenForCapture() {\n    var options = {\n      capture: true,\n      passive: false\n    };\n    unbindEventsRef.current = bindEvents(window, [startCaptureBinding], options);\n  }, [startCaptureBinding]);\n  var stop = useCallback(function () {\n    var current = phaseRef.current;\n\n    if (current.type === 'IDLE') {\n      return;\n    }\n\n    if (current.type === 'PENDING') {\n      clearTimeout(current.longPressTimerId);\n    }\n\n    setPhase(idle$2);\n    unbindEventsRef.current();\n    listenForCapture();\n  }, [listenForCapture, setPhase]);\n  var cancel = useCallback(function () {\n    var phase = phaseRef.current;\n    stop();\n\n    if (phase.type === 'DRAGGING') {\n      phase.actions.cancel({\n        shouldBlockNextClick: true\n      });\n    }\n\n    if (phase.type === 'PENDING') {\n      phase.actions.abort();\n    }\n  }, [stop]);\n  var bindCapturingEvents = useCallback(function bindCapturingEvents() {\n    var options = {\n      capture: true,\n      passive: false\n    };\n    var args = {\n      cancel: cancel,\n      completed: stop,\n      getPhase: getPhase\n    };\n    var unbindTarget = bindEvents(window, getHandleBindings(args), options);\n    var unbindWindow = bindEvents(window, getWindowBindings(args), options);\n\n    unbindEventsRef.current = function unbindAll() {\n      unbindTarget();\n      unbindWindow();\n    };\n  }, [cancel, getPhase, stop]);\n  var startDragging = useCallback(function startDragging() {\n    var phase = getPhase();\n    !(phase.type === 'PENDING') ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"Cannot start dragging from phase \" + phase.type) : invariant(false) : void 0;\n    var actions = phase.actions.fluidLift(phase.point);\n    setPhase({\n      type: 'DRAGGING',\n      actions: actions,\n      hasMoved: false\n    });\n  }, [getPhase, setPhase]);\n  var startPendingDrag = useCallback(function startPendingDrag(actions, point) {\n    !(getPhase().type === 'IDLE') ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Expected to move from IDLE to PENDING drag') : invariant(false) : void 0;\n    var longPressTimerId = setTimeout(startDragging, timeForLongPress);\n    setPhase({\n      type: 'PENDING',\n      point: point,\n      actions: actions,\n      longPressTimerId: longPressTimerId\n    });\n    bindCapturingEvents();\n  }, [bindCapturingEvents, getPhase, setPhase, startDragging]);\n  useIsomorphicLayoutEffect(function mount() {\n    listenForCapture();\n    return function unmount() {\n      unbindEventsRef.current();\n      var phase = getPhase();\n\n      if (phase.type === 'PENDING') {\n        clearTimeout(phase.longPressTimerId);\n        setPhase(idle$2);\n      }\n    };\n  }, [getPhase, listenForCapture, setPhase]);\n  useIsomorphicLayoutEffect(function webkitHack() {\n    var unbind = bindEvents(window, [{\n      eventName: 'touchmove',\n      fn: function fn() {},\n      options: {\n        capture: false,\n        passive: false\n      }\n    }]);\n    return unbind;\n  }, []);\n}\n\nfunction useValidateSensorHooks(sensorHooks) {\n  useDev(function () {\n    var previousRef = usePrevious(sensorHooks);\n    useDevSetupWarning(function () {\n      !(previousRef.current.length === sensorHooks.length) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot change the amount of sensor hooks after mounting') : invariant(false) : void 0;\n    });\n  });\n}\n\nvar interactiveTagNames = {\n  input: true,\n  button: true,\n  textarea: true,\n  select: true,\n  option: true,\n  optgroup: true,\n  video: true,\n  audio: true\n};\n\nfunction isAnInteractiveElement(parent, current) {\n  if (current == null) {\n    return false;\n  }\n\n  var hasAnInteractiveTag = Boolean(interactiveTagNames[current.tagName.toLowerCase()]);\n\n  if (hasAnInteractiveTag) {\n    return true;\n  }\n\n  var attribute = current.getAttribute('contenteditable');\n\n  if (attribute === 'true' || attribute === '') {\n    return true;\n  }\n\n  if (current === parent) {\n    return false;\n  }\n\n  return isAnInteractiveElement(parent, current.parentElement);\n}\n\nfunction isEventInInteractiveElement(draggable, event) {\n  var target = event.target;\n\n  if (!isHtmlElement(target)) {\n    return false;\n  }\n\n  return isAnInteractiveElement(draggable, target);\n}\n\nvar getBorderBoxCenterPosition = (function (el) {\n  return getRect(el.getBoundingClientRect()).center;\n});\n\nfunction isElement(el) {\n  return el instanceof getWindowFromEl(el).Element;\n}\n\nvar supportedMatchesName = function () {\n  var base = 'matches';\n\n  if (typeof document === 'undefined') {\n    return base;\n  }\n\n  var candidates = [base, 'msMatchesSelector', 'webkitMatchesSelector'];\n  var value = find(candidates, function (name) {\n    return name in Element.prototype;\n  });\n  return value || base;\n}();\n\nfunction closestPonyfill(el, selector) {\n  if (el == null) {\n    return null;\n  }\n\n  if (el[supportedMatchesName](selector)) {\n    return el;\n  }\n\n  return closestPonyfill(el.parentElement, selector);\n}\n\nfunction closest$1(el, selector) {\n  if (el.closest) {\n    return el.closest(selector);\n  }\n\n  return closestPonyfill(el, selector);\n}\n\nfunction getSelector(contextId) {\n  return \"[\" + dragHandle.contextId + \"=\\\"\" + contextId + \"\\\"]\";\n}\n\nfunction findClosestDragHandleFromEvent(contextId, event) {\n  var target = event.target;\n\n  if (!isElement(target)) {\n    process.env.NODE_ENV !== \"production\" ? warning('event.target must be a Element') : void 0;\n    return null;\n  }\n\n  var selector = getSelector(contextId);\n  var handle = closest$1(target, selector);\n\n  if (!handle) {\n    return null;\n  }\n\n  if (!isHtmlElement(handle)) {\n    process.env.NODE_ENV !== \"production\" ? warning('drag handle must be a HTMLElement') : void 0;\n    return null;\n  }\n\n  return handle;\n}\n\nfunction tryGetClosestDraggableIdFromEvent(contextId, event) {\n  var handle = findClosestDragHandleFromEvent(contextId, event);\n\n  if (!handle) {\n    return null;\n  }\n\n  return handle.getAttribute(dragHandle.draggableId);\n}\n\nfunction findDraggable(contextId, draggableId) {\n  var selector = \"[\" + draggable.contextId + \"=\\\"\" + contextId + \"\\\"]\";\n  var possible = toArray(document.querySelectorAll(selector));\n  var draggable$1 = find(possible, function (el) {\n    return el.getAttribute(draggable.id) === draggableId;\n  });\n\n  if (!draggable$1) {\n    return null;\n  }\n\n  if (!isHtmlElement(draggable$1)) {\n    process.env.NODE_ENV !== \"production\" ? warning('Draggable element is not a HTMLElement') : void 0;\n    return null;\n  }\n\n  return draggable$1;\n}\n\nfunction preventDefault(event) {\n  event.preventDefault();\n}\n\nfunction _isActive(_ref) {\n  var expected = _ref.expected,\n      phase = _ref.phase,\n      isLockActive = _ref.isLockActive,\n      shouldWarn = _ref.shouldWarn;\n\n  if (!isLockActive()) {\n    if (shouldWarn) {\n      process.env.NODE_ENV !== \"production\" ? warning(\"\\n        Cannot perform action.\\n        The sensor no longer has an action lock.\\n\\n        Tips:\\n\\n        - Throw away your action handlers when forceStop() is called\\n        - Check actions.isActive() if you really need to\\n      \") : void 0;\n    }\n\n    return false;\n  }\n\n  if (expected !== phase) {\n    if (shouldWarn) {\n      process.env.NODE_ENV !== \"production\" ? warning(\"\\n        Cannot perform action.\\n        The actions you used belong to an outdated phase\\n\\n        Current phase: \" + expected + \"\\n        You called an action from outdated phase: \" + phase + \"\\n\\n        Tips:\\n\\n        - Do not use preDragActions actions after calling preDragActions.lift()\\n      \") : void 0;\n    }\n\n    return false;\n  }\n\n  return true;\n}\n\nfunction canStart(_ref2) {\n  var lockAPI = _ref2.lockAPI,\n      store = _ref2.store,\n      registry = _ref2.registry,\n      draggableId = _ref2.draggableId;\n\n  if (lockAPI.isClaimed()) {\n    return false;\n  }\n\n  var entry = registry.draggable.findById(draggableId);\n\n  if (!entry) {\n    process.env.NODE_ENV !== \"production\" ? warning(\"Unable to find draggable with id: \" + draggableId) : void 0;\n    return false;\n  }\n\n  if (!entry.options.isEnabled) {\n    return false;\n  }\n\n  if (!canStartDrag(store.getState(), draggableId)) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction tryStart(_ref3) {\n  var lockAPI = _ref3.lockAPI,\n      contextId = _ref3.contextId,\n      store = _ref3.store,\n      registry = _ref3.registry,\n      draggableId = _ref3.draggableId,\n      forceSensorStop = _ref3.forceSensorStop,\n      sourceEvent = _ref3.sourceEvent;\n  var shouldStart = canStart({\n    lockAPI: lockAPI,\n    store: store,\n    registry: registry,\n    draggableId: draggableId\n  });\n\n  if (!shouldStart) {\n    return null;\n  }\n\n  var entry = registry.draggable.getById(draggableId);\n  var el = findDraggable(contextId, entry.descriptor.id);\n\n  if (!el) {\n    process.env.NODE_ENV !== \"production\" ? warning(\"Unable to find draggable element with id: \" + draggableId) : void 0;\n    return null;\n  }\n\n  if (sourceEvent && !entry.options.canDragInteractiveElements && isEventInInteractiveElement(el, sourceEvent)) {\n    return null;\n  }\n\n  var lock = lockAPI.claim(forceSensorStop || noop);\n  var phase = 'PRE_DRAG';\n\n  function getShouldRespectForcePress() {\n    return entry.options.shouldRespectForcePress;\n  }\n\n  function isLockActive() {\n    return lockAPI.isActive(lock);\n  }\n\n  function tryDispatch(expected, getAction) {\n    if (_isActive({\n      expected: expected,\n      phase: phase,\n      isLockActive: isLockActive,\n      shouldWarn: true\n    })) {\n      store.dispatch(getAction());\n    }\n  }\n\n  var tryDispatchWhenDragging = tryDispatch.bind(null, 'DRAGGING');\n\n  function lift$1(args) {\n    function completed() {\n      lockAPI.release();\n      phase = 'COMPLETED';\n    }\n\n    if (phase !== 'PRE_DRAG') {\n      completed();\n      !(phase === 'PRE_DRAG') ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"Cannot lift in phase \" + phase) : invariant(false) : void 0;\n    }\n\n    store.dispatch(lift(args.liftActionArgs));\n    phase = 'DRAGGING';\n\n    function finish(reason, options) {\n      if (options === void 0) {\n        options = {\n          shouldBlockNextClick: false\n        };\n      }\n\n      args.cleanup();\n\n      if (options.shouldBlockNextClick) {\n        var unbind = bindEvents(window, [{\n          eventName: 'click',\n          fn: preventDefault,\n          options: {\n            once: true,\n            passive: false,\n            capture: true\n          }\n        }]);\n        setTimeout(unbind);\n      }\n\n      completed();\n      store.dispatch(drop({\n        reason: reason\n      }));\n    }\n\n    return _extends({\n      isActive: function isActive() {\n        return _isActive({\n          expected: 'DRAGGING',\n          phase: phase,\n          isLockActive: isLockActive,\n          shouldWarn: false\n        });\n      },\n      shouldRespectForcePress: getShouldRespectForcePress,\n      drop: function drop(options) {\n        return finish('DROP', options);\n      },\n      cancel: function cancel(options) {\n        return finish('CANCEL', options);\n      }\n    }, args.actions);\n  }\n\n  function fluidLift(clientSelection) {\n    var move$1 = rafSchd(function (client) {\n      tryDispatchWhenDragging(function () {\n        return move({\n          client: client\n        });\n      });\n    });\n    var api = lift$1({\n      liftActionArgs: {\n        id: draggableId,\n        clientSelection: clientSelection,\n        movementMode: 'FLUID'\n      },\n      cleanup: function cleanup() {\n        return move$1.cancel();\n      },\n      actions: {\n        move: move$1\n      }\n    });\n    return _extends({}, api, {\n      move: move$1\n    });\n  }\n\n  function snapLift() {\n    var actions = {\n      moveUp: function moveUp$1() {\n        return tryDispatchWhenDragging(moveUp);\n      },\n      moveRight: function moveRight$1() {\n        return tryDispatchWhenDragging(moveRight);\n      },\n      moveDown: function moveDown$1() {\n        return tryDispatchWhenDragging(moveDown);\n      },\n      moveLeft: function moveLeft$1() {\n        return tryDispatchWhenDragging(moveLeft);\n      }\n    };\n    return lift$1({\n      liftActionArgs: {\n        id: draggableId,\n        clientSelection: getBorderBoxCenterPosition(el),\n        movementMode: 'SNAP'\n      },\n      cleanup: noop,\n      actions: actions\n    });\n  }\n\n  function abortPreDrag() {\n    var shouldRelease = _isActive({\n      expected: 'PRE_DRAG',\n      phase: phase,\n      isLockActive: isLockActive,\n      shouldWarn: true\n    });\n\n    if (shouldRelease) {\n      lockAPI.release();\n    }\n  }\n\n  var preDrag = {\n    isActive: function isActive() {\n      return _isActive({\n        expected: 'PRE_DRAG',\n        phase: phase,\n        isLockActive: isLockActive,\n        shouldWarn: false\n      });\n    },\n    shouldRespectForcePress: getShouldRespectForcePress,\n    fluidLift: fluidLift,\n    snapLift: snapLift,\n    abort: abortPreDrag\n  };\n  return preDrag;\n}\n\nvar defaultSensors = [useMouseSensor, useKeyboardSensor, useTouchSensor];\nfunction useSensorMarshal(_ref4) {\n  var contextId = _ref4.contextId,\n      store = _ref4.store,\n      registry = _ref4.registry,\n      customSensors = _ref4.customSensors,\n      enableDefaultSensors = _ref4.enableDefaultSensors;\n  var useSensors = [].concat(enableDefaultSensors ? defaultSensors : [], customSensors || []);\n  var lockAPI = useState(function () {\n    return create();\n  })[0];\n  var tryAbandonLock = useCallback(function tryAbandonLock(previous, current) {\n    if (previous.isDragging && !current.isDragging) {\n      lockAPI.tryAbandon();\n    }\n  }, [lockAPI]);\n  useIsomorphicLayoutEffect(function listenToStore() {\n    var previous = store.getState();\n    var unsubscribe = store.subscribe(function () {\n      var current = store.getState();\n      tryAbandonLock(previous, current);\n      previous = current;\n    });\n    return unsubscribe;\n  }, [lockAPI, store, tryAbandonLock]);\n  useIsomorphicLayoutEffect(function () {\n    return lockAPI.tryAbandon;\n  }, [lockAPI.tryAbandon]);\n  var canGetLock = useCallback(function (draggableId) {\n    return canStart({\n      lockAPI: lockAPI,\n      registry: registry,\n      store: store,\n      draggableId: draggableId\n    });\n  }, [lockAPI, registry, store]);\n  var tryGetLock = useCallback(function (draggableId, forceStop, options) {\n    return tryStart({\n      lockAPI: lockAPI,\n      registry: registry,\n      contextId: contextId,\n      store: store,\n      draggableId: draggableId,\n      forceSensorStop: forceStop,\n      sourceEvent: options && options.sourceEvent ? options.sourceEvent : null\n    });\n  }, [contextId, lockAPI, registry, store]);\n  var findClosestDraggableId = useCallback(function (event) {\n    return tryGetClosestDraggableIdFromEvent(contextId, event);\n  }, [contextId]);\n  var findOptionsForDraggable = useCallback(function (id) {\n    var entry = registry.draggable.findById(id);\n    return entry ? entry.options : null;\n  }, [registry.draggable]);\n  var tryReleaseLock = useCallback(function tryReleaseLock() {\n    if (!lockAPI.isClaimed()) {\n      return;\n    }\n\n    lockAPI.tryAbandon();\n\n    if (store.getState().phase !== 'IDLE') {\n      store.dispatch(flush());\n    }\n  }, [lockAPI, store]);\n  var isLockClaimed = useCallback(lockAPI.isClaimed, [lockAPI]);\n  var api = useMemo(function () {\n    return {\n      canGetLock: canGetLock,\n      tryGetLock: tryGetLock,\n      findClosestDraggableId: findClosestDraggableId,\n      findOptionsForDraggable: findOptionsForDraggable,\n      tryReleaseLock: tryReleaseLock,\n      isLockClaimed: isLockClaimed\n    };\n  }, [canGetLock, tryGetLock, findClosestDraggableId, findOptionsForDraggable, tryReleaseLock, isLockClaimed]);\n  useValidateSensorHooks(useSensors);\n\n  for (var i = 0; i < useSensors.length; i++) {\n    useSensors[i](api);\n  }\n}\n\nvar createResponders = function createResponders(props) {\n  return {\n    onBeforeCapture: props.onBeforeCapture,\n    onBeforeDragStart: props.onBeforeDragStart,\n    onDragStart: props.onDragStart,\n    onDragEnd: props.onDragEnd,\n    onDragUpdate: props.onDragUpdate\n  };\n};\n\nfunction getStore(lazyRef) {\n  !lazyRef.current ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Could not find store from lazy ref') : invariant(false) : void 0;\n  return lazyRef.current;\n}\n\nfunction App(props) {\n  var contextId = props.contextId,\n      setCallbacks = props.setCallbacks,\n      sensors = props.sensors,\n      nonce = props.nonce,\n      dragHandleUsageInstructions = props.dragHandleUsageInstructions;\n  var lazyStoreRef = useRef(null);\n  useStartupValidation();\n  var lastPropsRef = usePrevious(props);\n  var getResponders = useCallback(function () {\n    return createResponders(lastPropsRef.current);\n  }, [lastPropsRef]);\n  var announce = useAnnouncer(contextId);\n  var dragHandleUsageInstructionsId = useHiddenTextElement({\n    contextId: contextId,\n    text: dragHandleUsageInstructions\n  });\n  var styleMarshal = useStyleMarshal(contextId, nonce);\n  var lazyDispatch = useCallback(function (action) {\n    getStore(lazyStoreRef).dispatch(action);\n  }, []);\n  var marshalCallbacks = useMemo(function () {\n    return bindActionCreators({\n      publishWhileDragging: publishWhileDragging,\n      updateDroppableScroll: updateDroppableScroll,\n      updateDroppableIsEnabled: updateDroppableIsEnabled,\n      updateDroppableIsCombineEnabled: updateDroppableIsCombineEnabled,\n      collectionStarting: collectionStarting\n    }, lazyDispatch);\n  }, [lazyDispatch]);\n  var registry = useRegistry();\n  var dimensionMarshal = useMemo(function () {\n    return createDimensionMarshal(registry, marshalCallbacks);\n  }, [registry, marshalCallbacks]);\n  var autoScroller = useMemo(function () {\n    return createAutoScroller(_extends({\n      scrollWindow: scrollWindow,\n      scrollDroppable: dimensionMarshal.scrollDroppable\n    }, bindActionCreators({\n      move: move\n    }, lazyDispatch)));\n  }, [dimensionMarshal.scrollDroppable, lazyDispatch]);\n  var focusMarshal = useFocusMarshal(contextId);\n  var store = useMemo(function () {\n    return createStore({\n      announce: announce,\n      autoScroller: autoScroller,\n      dimensionMarshal: dimensionMarshal,\n      focusMarshal: focusMarshal,\n      getResponders: getResponders,\n      styleMarshal: styleMarshal\n    });\n  }, [announce, autoScroller, dimensionMarshal, focusMarshal, getResponders, styleMarshal]);\n\n  if (process.env.NODE_ENV !== 'production') {\n    if (lazyStoreRef.current && lazyStoreRef.current !== store) {\n      process.env.NODE_ENV !== \"production\" ? warning('unexpected store change') : void 0;\n    }\n  }\n\n  lazyStoreRef.current = store;\n  var tryResetStore = useCallback(function () {\n    var current = getStore(lazyStoreRef);\n    var state = current.getState();\n\n    if (state.phase !== 'IDLE') {\n      current.dispatch(flush());\n    }\n  }, []);\n  var isDragging = useCallback(function () {\n    var state = getStore(lazyStoreRef).getState();\n    return state.isDragging || state.phase === 'DROP_ANIMATING';\n  }, []);\n  var appCallbacks = useMemo(function () {\n    return {\n      isDragging: isDragging,\n      tryAbort: tryResetStore\n    };\n  }, [isDragging, tryResetStore]);\n  setCallbacks(appCallbacks);\n  var getCanLift = useCallback(function (id) {\n    return canStartDrag(getStore(lazyStoreRef).getState(), id);\n  }, []);\n  var getIsMovementAllowed = useCallback(function () {\n    return isMovementAllowed(getStore(lazyStoreRef).getState());\n  }, []);\n  var appContext = useMemo(function () {\n    return {\n      marshal: dimensionMarshal,\n      focus: focusMarshal,\n      contextId: contextId,\n      canLift: getCanLift,\n      isMovementAllowed: getIsMovementAllowed,\n      dragHandleUsageInstructionsId: dragHandleUsageInstructionsId,\n      registry: registry\n    };\n  }, [contextId, dimensionMarshal, dragHandleUsageInstructionsId, focusMarshal, getCanLift, getIsMovementAllowed, registry]);\n  useSensorMarshal({\n    contextId: contextId,\n    store: store,\n    registry: registry,\n    customSensors: sensors,\n    enableDefaultSensors: props.enableDefaultSensors !== false\n  });\n  useEffect(function () {\n    return tryResetStore;\n  }, [tryResetStore]);\n  return React.createElement(AppContext.Provider, {\n    value: appContext\n  }, React.createElement(Provider, {\n    context: StoreContext,\n    store: store\n  }, props.children));\n}\n\nvar count$1 = 0;\nfunction reset$1() {\n  count$1 = 0;\n}\nfunction useInstanceCount() {\n  return useMemo(function () {\n    return \"\" + count$1++;\n  }, []);\n}\n\nfunction resetServerContext() {\n  reset$1();\n  reset();\n}\nfunction DragDropContext(props) {\n  var contextId = useInstanceCount();\n  var dragHandleUsageInstructions = props.dragHandleUsageInstructions || preset.dragHandleUsageInstructions;\n  return React.createElement(ErrorBoundary, null, function (setCallbacks) {\n    return React.createElement(App, {\n      nonce: props.nonce,\n      contextId: contextId,\n      setCallbacks: setCallbacks,\n      dragHandleUsageInstructions: dragHandleUsageInstructions,\n      enableDefaultSensors: props.enableDefaultSensors,\n      sensors: props.sensors,\n      onBeforeCapture: props.onBeforeCapture,\n      onBeforeDragStart: props.onBeforeDragStart,\n      onDragStart: props.onDragStart,\n      onDragUpdate: props.onDragUpdate,\n      onDragEnd: props.onDragEnd\n    }, props.children);\n  });\n}\n\nvar isEqual$1 = function isEqual(base) {\n  return function (value) {\n    return base === value;\n  };\n};\n\nvar isScroll = isEqual$1('scroll');\nvar isAuto = isEqual$1('auto');\nvar isVisible$1 = isEqual$1('visible');\n\nvar isEither = function isEither(overflow, fn) {\n  return fn(overflow.overflowX) || fn(overflow.overflowY);\n};\n\nvar isBoth = function isBoth(overflow, fn) {\n  return fn(overflow.overflowX) && fn(overflow.overflowY);\n};\n\nvar isElementScrollable = function isElementScrollable(el) {\n  var style = window.getComputedStyle(el);\n  var overflow = {\n    overflowX: style.overflowX,\n    overflowY: style.overflowY\n  };\n  return isEither(overflow, isScroll) || isEither(overflow, isAuto);\n};\n\nvar isBodyScrollable = function isBodyScrollable() {\n  if (process.env.NODE_ENV === 'production') {\n    return false;\n  }\n\n  var body = getBodyElement();\n  var html = document.documentElement;\n  !html ? process.env.NODE_ENV !== \"production\" ? invariant(false) : invariant(false) : void 0;\n\n  if (!isElementScrollable(body)) {\n    return false;\n  }\n\n  var htmlStyle = window.getComputedStyle(html);\n  var htmlOverflow = {\n    overflowX: htmlStyle.overflowX,\n    overflowY: htmlStyle.overflowY\n  };\n\n  if (isBoth(htmlOverflow, isVisible$1)) {\n    return false;\n  }\n\n  process.env.NODE_ENV !== \"production\" ? warning(\"\\n    We have detected that your <body> element might be a scroll container.\\n    We have found no reliable way of detecting whether the <body> element is a scroll container.\\n    Under most circumstances a <body> scroll bar will be on the <html> element (document.documentElement)\\n\\n    Because we cannot determine if the <body> is a scroll container, and generally it is not one,\\n    we will be treating the <body> as *not* a scroll container\\n\\n    More information: https://github.com/atlassian/react-beautiful-dnd/blob/master/docs/guides/how-we-detect-scroll-containers.md\\n  \") : void 0;\n  return false;\n};\n\nvar getClosestScrollable = function getClosestScrollable(el) {\n  if (el == null) {\n    return null;\n  }\n\n  if (el === document.body) {\n    return isBodyScrollable() ? el : null;\n  }\n\n  if (el === document.documentElement) {\n    return null;\n  }\n\n  if (!isElementScrollable(el)) {\n    return getClosestScrollable(el.parentElement);\n  }\n\n  return el;\n};\n\nvar checkForNestedScrollContainers = (function (scrollable) {\n  if (!scrollable) {\n    return;\n  }\n\n  var anotherScrollParent = getClosestScrollable(scrollable.parentElement);\n\n  if (!anotherScrollParent) {\n    return;\n  }\n\n  process.env.NODE_ENV !== \"production\" ? warning(\"\\n    Droppable: unsupported nested scroll container detected.\\n    A Droppable can only have one scroll parent (which can be itself)\\n    Nested scroll containers are currently not supported.\\n\\n    We hope to support nested scroll containers soon: https://github.com/atlassian/react-beautiful-dnd/issues/131\\n  \") : void 0;\n});\n\nvar getScroll$1 = (function (el) {\n  return {\n    x: el.scrollLeft,\n    y: el.scrollTop\n  };\n});\n\nvar getIsFixed = function getIsFixed(el) {\n  if (!el) {\n    return false;\n  }\n\n  var style = window.getComputedStyle(el);\n\n  if (style.position === 'fixed') {\n    return true;\n  }\n\n  return getIsFixed(el.parentElement);\n};\n\nvar getEnv = (function (start) {\n  var closestScrollable = getClosestScrollable(start);\n  var isFixedOnPage = getIsFixed(start);\n  return {\n    closestScrollable: closestScrollable,\n    isFixedOnPage: isFixedOnPage\n  };\n});\n\nvar getDroppableDimension = (function (_ref) {\n  var descriptor = _ref.descriptor,\n      isEnabled = _ref.isEnabled,\n      isCombineEnabled = _ref.isCombineEnabled,\n      isFixedOnPage = _ref.isFixedOnPage,\n      direction = _ref.direction,\n      client = _ref.client,\n      page = _ref.page,\n      closest = _ref.closest;\n\n  var frame = function () {\n    if (!closest) {\n      return null;\n    }\n\n    var scrollSize = closest.scrollSize,\n        frameClient = closest.client;\n    var maxScroll = getMaxScroll({\n      scrollHeight: scrollSize.scrollHeight,\n      scrollWidth: scrollSize.scrollWidth,\n      height: frameClient.paddingBox.height,\n      width: frameClient.paddingBox.width\n    });\n    return {\n      pageMarginBox: closest.page.marginBox,\n      frameClient: frameClient,\n      scrollSize: scrollSize,\n      shouldClipSubject: closest.shouldClipSubject,\n      scroll: {\n        initial: closest.scroll,\n        current: closest.scroll,\n        max: maxScroll,\n        diff: {\n          value: origin,\n          displacement: origin\n        }\n      }\n    };\n  }();\n\n  var axis = direction === 'vertical' ? vertical : horizontal;\n  var subject = getSubject({\n    page: page,\n    withPlaceholder: null,\n    axis: axis,\n    frame: frame\n  });\n  var dimension = {\n    descriptor: descriptor,\n    isCombineEnabled: isCombineEnabled,\n    isFixedOnPage: isFixedOnPage,\n    axis: axis,\n    isEnabled: isEnabled,\n    client: client,\n    page: page,\n    frame: frame,\n    subject: subject\n  };\n  return dimension;\n});\n\nvar getClient = function getClient(targetRef, closestScrollable) {\n  var base = getBox(targetRef);\n\n  if (!closestScrollable) {\n    return base;\n  }\n\n  if (targetRef !== closestScrollable) {\n    return base;\n  }\n\n  var top = base.paddingBox.top - closestScrollable.scrollTop;\n  var left = base.paddingBox.left - closestScrollable.scrollLeft;\n  var bottom = top + closestScrollable.scrollHeight;\n  var right = left + closestScrollable.scrollWidth;\n  var paddingBox = {\n    top: top,\n    right: right,\n    bottom: bottom,\n    left: left\n  };\n  var borderBox = expand(paddingBox, base.border);\n  var client = createBox({\n    borderBox: borderBox,\n    margin: base.margin,\n    border: base.border,\n    padding: base.padding\n  });\n  return client;\n};\n\nvar getDimension = (function (_ref) {\n  var ref = _ref.ref,\n      descriptor = _ref.descriptor,\n      env = _ref.env,\n      windowScroll = _ref.windowScroll,\n      direction = _ref.direction,\n      isDropDisabled = _ref.isDropDisabled,\n      isCombineEnabled = _ref.isCombineEnabled,\n      shouldClipSubject = _ref.shouldClipSubject;\n  var closestScrollable = env.closestScrollable;\n  var client = getClient(ref, closestScrollable);\n  var page = withScroll(client, windowScroll);\n\n  var closest = function () {\n    if (!closestScrollable) {\n      return null;\n    }\n\n    var frameClient = getBox(closestScrollable);\n    var scrollSize = {\n      scrollHeight: closestScrollable.scrollHeight,\n      scrollWidth: closestScrollable.scrollWidth\n    };\n    return {\n      client: frameClient,\n      page: withScroll(frameClient, windowScroll),\n      scroll: getScroll$1(closestScrollable),\n      scrollSize: scrollSize,\n      shouldClipSubject: shouldClipSubject\n    };\n  }();\n\n  var dimension = getDroppableDimension({\n    descriptor: descriptor,\n    isEnabled: !isDropDisabled,\n    isCombineEnabled: isCombineEnabled,\n    isFixedOnPage: env.isFixedOnPage,\n    direction: direction,\n    client: client,\n    page: page,\n    closest: closest\n  });\n  return dimension;\n});\n\nvar immediate = {\n  passive: false\n};\nvar delayed = {\n  passive: true\n};\nvar getListenerOptions = (function (options) {\n  return options.shouldPublishImmediately ? immediate : delayed;\n});\n\nfunction useRequiredContext(Context) {\n  var result = useContext(Context);\n  !result ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Could not find required context') : invariant(false) : void 0;\n  return result;\n}\n\nvar getClosestScrollableFromDrag = function getClosestScrollableFromDrag(dragging) {\n  return dragging && dragging.env.closestScrollable || null;\n};\n\nfunction useDroppablePublisher(args) {\n  var whileDraggingRef = useRef(null);\n  var appContext = useRequiredContext(AppContext);\n  var uniqueId = useUniqueId('droppable');\n  var registry = appContext.registry,\n      marshal = appContext.marshal;\n  var previousRef = usePrevious(args);\n  var descriptor = useMemo(function () {\n    return {\n      id: args.droppableId,\n      type: args.type,\n      mode: args.mode\n    };\n  }, [args.droppableId, args.mode, args.type]);\n  var publishedDescriptorRef = useRef(descriptor);\n  var memoizedUpdateScroll = useMemo(function () {\n    return memoizeOne(function (x, y) {\n      !whileDraggingRef.current ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Can only update scroll when dragging') : invariant(false) : void 0;\n      var scroll = {\n        x: x,\n        y: y\n      };\n      marshal.updateDroppableScroll(descriptor.id, scroll);\n    });\n  }, [descriptor.id, marshal]);\n  var getClosestScroll = useCallback(function () {\n    var dragging = whileDraggingRef.current;\n\n    if (!dragging || !dragging.env.closestScrollable) {\n      return origin;\n    }\n\n    return getScroll$1(dragging.env.closestScrollable);\n  }, []);\n  var updateScroll = useCallback(function () {\n    var scroll = getClosestScroll();\n    memoizedUpdateScroll(scroll.x, scroll.y);\n  }, [getClosestScroll, memoizedUpdateScroll]);\n  var scheduleScrollUpdate = useMemo(function () {\n    return rafSchd(updateScroll);\n  }, [updateScroll]);\n  var onClosestScroll = useCallback(function () {\n    var dragging = whileDraggingRef.current;\n    var closest = getClosestScrollableFromDrag(dragging);\n    !(dragging && closest) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Could not find scroll options while scrolling') : invariant(false) : void 0;\n    var options = dragging.scrollOptions;\n\n    if (options.shouldPublishImmediately) {\n      updateScroll();\n      return;\n    }\n\n    scheduleScrollUpdate();\n  }, [scheduleScrollUpdate, updateScroll]);\n  var getDimensionAndWatchScroll = useCallback(function (windowScroll, options) {\n    !!whileDraggingRef.current ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot collect a droppable while a drag is occurring') : invariant(false) : void 0;\n    var previous = previousRef.current;\n    var ref = previous.getDroppableRef();\n    !ref ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot collect without a droppable ref') : invariant(false) : void 0;\n    var env = getEnv(ref);\n    var dragging = {\n      ref: ref,\n      descriptor: descriptor,\n      env: env,\n      scrollOptions: options\n    };\n    whileDraggingRef.current = dragging;\n    var dimension = getDimension({\n      ref: ref,\n      descriptor: descriptor,\n      env: env,\n      windowScroll: windowScroll,\n      direction: previous.direction,\n      isDropDisabled: previous.isDropDisabled,\n      isCombineEnabled: previous.isCombineEnabled,\n      shouldClipSubject: !previous.ignoreContainerClipping\n    });\n    var scrollable = env.closestScrollable;\n\n    if (scrollable) {\n      scrollable.setAttribute(scrollContainer.contextId, appContext.contextId);\n      scrollable.addEventListener('scroll', onClosestScroll, getListenerOptions(dragging.scrollOptions));\n\n      if (process.env.NODE_ENV !== 'production') {\n        checkForNestedScrollContainers(scrollable);\n      }\n    }\n\n    return dimension;\n  }, [appContext.contextId, descriptor, onClosestScroll, previousRef]);\n  var getScrollWhileDragging = useCallback(function () {\n    var dragging = whileDraggingRef.current;\n    var closest = getClosestScrollableFromDrag(dragging);\n    !(dragging && closest) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Can only recollect Droppable client for Droppables that have a scroll container') : invariant(false) : void 0;\n    return getScroll$1(closest);\n  }, []);\n  var dragStopped = useCallback(function () {\n    var dragging = whileDraggingRef.current;\n    !dragging ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot stop drag when no active drag') : invariant(false) : void 0;\n    var closest = getClosestScrollableFromDrag(dragging);\n    whileDraggingRef.current = null;\n\n    if (!closest) {\n      return;\n    }\n\n    scheduleScrollUpdate.cancel();\n    closest.removeAttribute(scrollContainer.contextId);\n    closest.removeEventListener('scroll', onClosestScroll, getListenerOptions(dragging.scrollOptions));\n  }, [onClosestScroll, scheduleScrollUpdate]);\n  var scroll = useCallback(function (change) {\n    var dragging = whileDraggingRef.current;\n    !dragging ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot scroll when there is no drag') : invariant(false) : void 0;\n    var closest = getClosestScrollableFromDrag(dragging);\n    !closest ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot scroll a droppable with no closest scrollable') : invariant(false) : void 0;\n    closest.scrollTop += change.y;\n    closest.scrollLeft += change.x;\n  }, []);\n  var callbacks = useMemo(function () {\n    return {\n      getDimensionAndWatchScroll: getDimensionAndWatchScroll,\n      getScrollWhileDragging: getScrollWhileDragging,\n      dragStopped: dragStopped,\n      scroll: scroll\n    };\n  }, [dragStopped, getDimensionAndWatchScroll, getScrollWhileDragging, scroll]);\n  var entry = useMemo(function () {\n    return {\n      uniqueId: uniqueId,\n      descriptor: descriptor,\n      callbacks: callbacks\n    };\n  }, [callbacks, descriptor, uniqueId]);\n  useIsomorphicLayoutEffect(function () {\n    publishedDescriptorRef.current = entry.descriptor;\n    registry.droppable.register(entry);\n    return function () {\n      if (whileDraggingRef.current) {\n        process.env.NODE_ENV !== \"production\" ? warning('Unsupported: changing the droppableId or type of a Droppable during a drag') : void 0;\n        dragStopped();\n      }\n\n      registry.droppable.unregister(entry);\n    };\n  }, [callbacks, descriptor, dragStopped, entry, marshal, registry.droppable]);\n  useIsomorphicLayoutEffect(function () {\n    if (!whileDraggingRef.current) {\n      return;\n    }\n\n    marshal.updateDroppableIsEnabled(publishedDescriptorRef.current.id, !args.isDropDisabled);\n  }, [args.isDropDisabled, marshal]);\n  useIsomorphicLayoutEffect(function () {\n    if (!whileDraggingRef.current) {\n      return;\n    }\n\n    marshal.updateDroppableIsCombineEnabled(publishedDescriptorRef.current.id, args.isCombineEnabled);\n  }, [args.isCombineEnabled, marshal]);\n}\n\nfunction noop$2() {}\n\nvar empty = {\n  width: 0,\n  height: 0,\n  margin: noSpacing\n};\n\nvar getSize = function getSize(_ref) {\n  var isAnimatingOpenOnMount = _ref.isAnimatingOpenOnMount,\n      placeholder = _ref.placeholder,\n      animate = _ref.animate;\n\n  if (isAnimatingOpenOnMount) {\n    return empty;\n  }\n\n  if (animate === 'close') {\n    return empty;\n  }\n\n  return {\n    height: placeholder.client.borderBox.height,\n    width: placeholder.client.borderBox.width,\n    margin: placeholder.client.margin\n  };\n};\n\nvar getStyle = function getStyle(_ref2) {\n  var isAnimatingOpenOnMount = _ref2.isAnimatingOpenOnMount,\n      placeholder = _ref2.placeholder,\n      animate = _ref2.animate;\n  var size = getSize({\n    isAnimatingOpenOnMount: isAnimatingOpenOnMount,\n    placeholder: placeholder,\n    animate: animate\n  });\n  return {\n    display: placeholder.display,\n    boxSizing: 'border-box',\n    width: size.width,\n    height: size.height,\n    marginTop: size.margin.top,\n    marginRight: size.margin.right,\n    marginBottom: size.margin.bottom,\n    marginLeft: size.margin.left,\n    flexShrink: '0',\n    flexGrow: '0',\n    pointerEvents: 'none',\n    transition: animate !== 'none' ? transitions.placeholder : null\n  };\n};\n\nfunction Placeholder(props) {\n  var animateOpenTimerRef = useRef(null);\n  var tryClearAnimateOpenTimer = useCallback(function () {\n    if (!animateOpenTimerRef.current) {\n      return;\n    }\n\n    clearTimeout(animateOpenTimerRef.current);\n    animateOpenTimerRef.current = null;\n  }, []);\n  var animate = props.animate,\n      onTransitionEnd = props.onTransitionEnd,\n      onClose = props.onClose,\n      contextId = props.contextId;\n\n  var _useState = useState(props.animate === 'open'),\n      isAnimatingOpenOnMount = _useState[0],\n      setIsAnimatingOpenOnMount = _useState[1];\n\n  useEffect(function () {\n    if (!isAnimatingOpenOnMount) {\n      return noop$2;\n    }\n\n    if (animate !== 'open') {\n      tryClearAnimateOpenTimer();\n      setIsAnimatingOpenOnMount(false);\n      return noop$2;\n    }\n\n    if (animateOpenTimerRef.current) {\n      return noop$2;\n    }\n\n    animateOpenTimerRef.current = setTimeout(function () {\n      animateOpenTimerRef.current = null;\n      setIsAnimatingOpenOnMount(false);\n    });\n    return tryClearAnimateOpenTimer;\n  }, [animate, isAnimatingOpenOnMount, tryClearAnimateOpenTimer]);\n  var onSizeChangeEnd = useCallback(function (event) {\n    if (event.propertyName !== 'height') {\n      return;\n    }\n\n    onTransitionEnd();\n\n    if (animate === 'close') {\n      onClose();\n    }\n  }, [animate, onClose, onTransitionEnd]);\n  var style = getStyle({\n    isAnimatingOpenOnMount: isAnimatingOpenOnMount,\n    animate: props.animate,\n    placeholder: props.placeholder\n  });\n  return React.createElement(props.placeholder.tagName, {\n    style: style,\n    'data-rbd-placeholder-context-id': contextId,\n    onTransitionEnd: onSizeChangeEnd,\n    ref: props.innerRef\n  });\n}\n\nvar Placeholder$1 = React.memo(Placeholder);\n\nvar DroppableContext = React.createContext(null);\n\nfunction checkIsValidInnerRef(el) {\n  !(el && isHtmlElement(el)) ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"\\n    provided.innerRef has not been provided with a HTMLElement.\\n\\n    You can find a guide on using the innerRef callback functions at:\\n    https://github.com/atlassian/react-beautiful-dnd/blob/master/docs/guides/using-inner-ref.md\\n  \") : invariant(false) : void 0;\n}\n\nfunction isBoolean(value) {\n  return typeof value === 'boolean';\n}\n\nfunction runChecks(args, checks) {\n  checks.forEach(function (check) {\n    return check(args);\n  });\n}\n\nvar shared = [function required(_ref) {\n  var props = _ref.props;\n  !props.droppableId ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'A Droppable requires a droppableId prop') : invariant(false) : void 0;\n  !(typeof props.droppableId === 'string') ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"A Droppable requires a [string] droppableId. Provided: [\" + typeof props.droppableId + \"]\") : invariant(false) : void 0;\n}, function _boolean(_ref2) {\n  var props = _ref2.props;\n  !isBoolean(props.isDropDisabled) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'isDropDisabled must be a boolean') : invariant(false) : void 0;\n  !isBoolean(props.isCombineEnabled) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'isCombineEnabled must be a boolean') : invariant(false) : void 0;\n  !isBoolean(props.ignoreContainerClipping) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'ignoreContainerClipping must be a boolean') : invariant(false) : void 0;\n}, function ref(_ref3) {\n  var getDroppableRef = _ref3.getDroppableRef;\n  checkIsValidInnerRef(getDroppableRef());\n}];\nvar standard = [function placeholder(_ref4) {\n  var props = _ref4.props,\n      getPlaceholderRef = _ref4.getPlaceholderRef;\n\n  if (!props.placeholder) {\n    return;\n  }\n\n  var ref = getPlaceholderRef();\n\n  if (ref) {\n    return;\n  }\n\n  process.env.NODE_ENV !== \"production\" ? warning(\"\\n      Droppable setup issue [droppableId: \\\"\" + props.droppableId + \"\\\"]:\\n      DroppableProvided > placeholder could not be found.\\n\\n      Please be sure to add the {provided.placeholder} React Node as a child of your Droppable.\\n      More information: https://github.com/atlassian/react-beautiful-dnd/blob/master/docs/api/droppable.md\\n    \") : void 0;\n}];\nvar virtual = [function hasClone(_ref5) {\n  var props = _ref5.props;\n  !props.renderClone ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Must provide a clone render function (renderClone) for virtual lists') : invariant(false) : void 0;\n}, function hasNoPlaceholder(_ref6) {\n  var getPlaceholderRef = _ref6.getPlaceholderRef;\n  !!getPlaceholderRef() ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Expected virtual list to not have a placeholder') : invariant(false) : void 0;\n}];\nfunction useValidation(args) {\n  useDevSetupWarning(function () {\n    runChecks(args, shared);\n\n    if (args.props.mode === 'standard') {\n      runChecks(args, standard);\n    }\n\n    if (args.props.mode === 'virtual') {\n      runChecks(args, virtual);\n    }\n  });\n}\n\nvar AnimateInOut = function (_React$PureComponent) {\n  _inheritsLoose(AnimateInOut, _React$PureComponent);\n\n  function AnimateInOut() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _React$PureComponent.call.apply(_React$PureComponent, [this].concat(args)) || this;\n    _this.state = {\n      isVisible: Boolean(_this.props.on),\n      data: _this.props.on,\n      animate: _this.props.shouldAnimate && _this.props.on ? 'open' : 'none'\n    };\n\n    _this.onClose = function () {\n      if (_this.state.animate !== 'close') {\n        return;\n      }\n\n      _this.setState({\n        isVisible: false\n      });\n    };\n\n    return _this;\n  }\n\n  AnimateInOut.getDerivedStateFromProps = function getDerivedStateFromProps(props, state) {\n    if (!props.shouldAnimate) {\n      return {\n        isVisible: Boolean(props.on),\n        data: props.on,\n        animate: 'none'\n      };\n    }\n\n    if (props.on) {\n      return {\n        isVisible: true,\n        data: props.on,\n        animate: 'open'\n      };\n    }\n\n    if (state.isVisible) {\n      return {\n        isVisible: true,\n        data: state.data,\n        animate: 'close'\n      };\n    }\n\n    return {\n      isVisible: false,\n      animate: 'close',\n      data: null\n    };\n  };\n\n  var _proto = AnimateInOut.prototype;\n\n  _proto.render = function render() {\n    if (!this.state.isVisible) {\n      return null;\n    }\n\n    var provided = {\n      onClose: this.onClose,\n      data: this.state.data,\n      animate: this.state.animate\n    };\n    return this.props.children(provided);\n  };\n\n  return AnimateInOut;\n}(React.PureComponent);\n\nvar zIndexOptions = {\n  dragging: 5000,\n  dropAnimating: 4500\n};\n\nvar getDraggingTransition = function getDraggingTransition(shouldAnimateDragMovement, dropping) {\n  if (dropping) {\n    return transitions.drop(dropping.duration);\n  }\n\n  if (shouldAnimateDragMovement) {\n    return transitions.snap;\n  }\n\n  return transitions.fluid;\n};\n\nvar getDraggingOpacity = function getDraggingOpacity(isCombining, isDropAnimating) {\n  if (!isCombining) {\n    return null;\n  }\n\n  return isDropAnimating ? combine.opacity.drop : combine.opacity.combining;\n};\n\nvar getShouldDraggingAnimate = function getShouldDraggingAnimate(dragging) {\n  if (dragging.forceShouldAnimate != null) {\n    return dragging.forceShouldAnimate;\n  }\n\n  return dragging.mode === 'SNAP';\n};\n\nfunction getDraggingStyle(dragging) {\n  var dimension = dragging.dimension;\n  var box = dimension.client;\n  var offset = dragging.offset,\n      combineWith = dragging.combineWith,\n      dropping = dragging.dropping;\n  var isCombining = Boolean(combineWith);\n  var shouldAnimate = getShouldDraggingAnimate(dragging);\n  var isDropAnimating = Boolean(dropping);\n  var transform = isDropAnimating ? transforms.drop(offset, isCombining) : transforms.moveTo(offset);\n  var style = {\n    position: 'fixed',\n    top: box.marginBox.top,\n    left: box.marginBox.left,\n    boxSizing: 'border-box',\n    width: box.borderBox.width,\n    height: box.borderBox.height,\n    transition: getDraggingTransition(shouldAnimate, dropping),\n    transform: transform,\n    opacity: getDraggingOpacity(isCombining, isDropAnimating),\n    zIndex: isDropAnimating ? zIndexOptions.dropAnimating : zIndexOptions.dragging,\n    pointerEvents: 'none'\n  };\n  return style;\n}\n\nfunction getSecondaryStyle(secondary) {\n  return {\n    transform: transforms.moveTo(secondary.offset),\n    transition: secondary.shouldAnimateDisplacement ? null : 'none'\n  };\n}\n\nfunction getStyle$1(mapped) {\n  return mapped.type === 'DRAGGING' ? getDraggingStyle(mapped) : getSecondaryStyle(mapped);\n}\n\nfunction getDimension$1(descriptor, el, windowScroll) {\n  if (windowScroll === void 0) {\n    windowScroll = origin;\n  }\n\n  var computedStyles = window.getComputedStyle(el);\n  var borderBox = el.getBoundingClientRect();\n  var client = calculateBox(borderBox, computedStyles);\n  var page = withScroll(client, windowScroll);\n  var placeholder = {\n    client: client,\n    tagName: el.tagName.toLowerCase(),\n    display: computedStyles.display\n  };\n  var displaceBy = {\n    x: client.marginBox.width,\n    y: client.marginBox.height\n  };\n  var dimension = {\n    descriptor: descriptor,\n    placeholder: placeholder,\n    displaceBy: displaceBy,\n    client: client,\n    page: page\n  };\n  return dimension;\n}\n\nfunction useDraggablePublisher(args) {\n  var uniqueId = useUniqueId('draggable');\n  var descriptor = args.descriptor,\n      registry = args.registry,\n      getDraggableRef = args.getDraggableRef,\n      canDragInteractiveElements = args.canDragInteractiveElements,\n      shouldRespectForcePress = args.shouldRespectForcePress,\n      isEnabled = args.isEnabled;\n  var options = useMemo(function () {\n    return {\n      canDragInteractiveElements: canDragInteractiveElements,\n      shouldRespectForcePress: shouldRespectForcePress,\n      isEnabled: isEnabled\n    };\n  }, [canDragInteractiveElements, isEnabled, shouldRespectForcePress]);\n  var getDimension = useCallback(function (windowScroll) {\n    var el = getDraggableRef();\n    !el ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Cannot get dimension when no ref is set') : invariant(false) : void 0;\n    return getDimension$1(descriptor, el, windowScroll);\n  }, [descriptor, getDraggableRef]);\n  var entry = useMemo(function () {\n    return {\n      uniqueId: uniqueId,\n      descriptor: descriptor,\n      options: options,\n      getDimension: getDimension\n    };\n  }, [descriptor, getDimension, options, uniqueId]);\n  var publishedRef = useRef(entry);\n  var isFirstPublishRef = useRef(true);\n  useIsomorphicLayoutEffect(function () {\n    registry.draggable.register(publishedRef.current);\n    return function () {\n      return registry.draggable.unregister(publishedRef.current);\n    };\n  }, [registry.draggable]);\n  useIsomorphicLayoutEffect(function () {\n    if (isFirstPublishRef.current) {\n      isFirstPublishRef.current = false;\n      return;\n    }\n\n    var last = publishedRef.current;\n    publishedRef.current = entry;\n    registry.draggable.update(entry, last);\n  }, [entry, registry.draggable]);\n}\n\nfunction useValidation$1(props, contextId, getRef) {\n  useDevSetupWarning(function () {\n    function prefix(id) {\n      return \"Draggable[id: \" + id + \"]: \";\n    }\n\n    var id = props.draggableId;\n    !id ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Draggable requires a draggableId') : invariant(false) : void 0;\n    !(typeof id === 'string') ? process.env.NODE_ENV !== \"production\" ? invariant(false, \"Draggable requires a [string] draggableId.\\n      Provided: [type: \" + typeof id + \"] (value: \" + id + \")\") : invariant(false) : void 0;\n    !isInteger(props.index) ? process.env.NODE_ENV !== \"production\" ? invariant(false, prefix(id) + \" requires an integer index prop\") : invariant(false) : void 0;\n\n    if (props.mapped.type === 'DRAGGING') {\n      return;\n    }\n\n    checkIsValidInnerRef(getRef());\n\n    if (props.isEnabled) {\n      !findDragHandle(contextId, id) ? process.env.NODE_ENV !== \"production\" ? invariant(false, prefix(id) + \" Unable to find drag handle\") : invariant(false) : void 0;\n    }\n  });\n}\nfunction useClonePropValidation(isClone) {\n  useDev(function () {\n    var initialRef = useRef(isClone);\n    useDevSetupWarning(function () {\n      !(isClone === initialRef.current) ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Draggable isClone prop value changed during component life') : invariant(false) : void 0;\n    }, [isClone]);\n  });\n}\n\nfunction preventHtml5Dnd(event) {\n  event.preventDefault();\n}\n\nfunction Draggable(props) {\n  var ref = useRef(null);\n  var setRef = useCallback(function (el) {\n    ref.current = el;\n  }, []);\n  var getRef = useCallback(function () {\n    return ref.current;\n  }, []);\n\n  var _useRequiredContext = useRequiredContext(AppContext),\n      contextId = _useRequiredContext.contextId,\n      dragHandleUsageInstructionsId = _useRequiredContext.dragHandleUsageInstructionsId,\n      registry = _useRequiredContext.registry;\n\n  var _useRequiredContext2 = useRequiredContext(DroppableContext),\n      type = _useRequiredContext2.type,\n      droppableId = _useRequiredContext2.droppableId;\n\n  var descriptor = useMemo(function () {\n    return {\n      id: props.draggableId,\n      index: props.index,\n      type: type,\n      droppableId: droppableId\n    };\n  }, [props.draggableId, props.index, type, droppableId]);\n  var children = props.children,\n      draggableId = props.draggableId,\n      isEnabled = props.isEnabled,\n      shouldRespectForcePress = props.shouldRespectForcePress,\n      canDragInteractiveElements = props.canDragInteractiveElements,\n      isClone = props.isClone,\n      mapped = props.mapped,\n      dropAnimationFinishedAction = props.dropAnimationFinished;\n  useValidation$1(props, contextId, getRef);\n  useClonePropValidation(isClone);\n\n  if (!isClone) {\n    var forPublisher = useMemo(function () {\n      return {\n        descriptor: descriptor,\n        registry: registry,\n        getDraggableRef: getRef,\n        canDragInteractiveElements: canDragInteractiveElements,\n        shouldRespectForcePress: shouldRespectForcePress,\n        isEnabled: isEnabled\n      };\n    }, [descriptor, registry, getRef, canDragInteractiveElements, shouldRespectForcePress, isEnabled]);\n    useDraggablePublisher(forPublisher);\n  }\n\n  var dragHandleProps = useMemo(function () {\n    return isEnabled ? {\n      tabIndex: 0,\n      role: 'button',\n      'aria-describedby': dragHandleUsageInstructionsId,\n      'data-rbd-drag-handle-draggable-id': draggableId,\n      'data-rbd-drag-handle-context-id': contextId,\n      draggable: false,\n      onDragStart: preventHtml5Dnd\n    } : null;\n  }, [contextId, dragHandleUsageInstructionsId, draggableId, isEnabled]);\n  var onMoveEnd = useCallback(function (event) {\n    if (mapped.type !== 'DRAGGING') {\n      return;\n    }\n\n    if (!mapped.dropping) {\n      return;\n    }\n\n    if (event.propertyName !== 'transform') {\n      return;\n    }\n\n    dropAnimationFinishedAction();\n  }, [dropAnimationFinishedAction, mapped]);\n  var provided = useMemo(function () {\n    var style = getStyle$1(mapped);\n    var onTransitionEnd = mapped.type === 'DRAGGING' && mapped.dropping ? onMoveEnd : null;\n    var result = {\n      innerRef: setRef,\n      draggableProps: {\n        'data-rbd-draggable-context-id': contextId,\n        'data-rbd-draggable-id': draggableId,\n        style: style,\n        onTransitionEnd: onTransitionEnd\n      },\n      dragHandleProps: dragHandleProps\n    };\n    return result;\n  }, [contextId, dragHandleProps, draggableId, mapped, onMoveEnd, setRef]);\n  var rubric = useMemo(function () {\n    return {\n      draggableId: descriptor.id,\n      type: descriptor.type,\n      source: {\n        index: descriptor.index,\n        droppableId: descriptor.droppableId\n      }\n    };\n  }, [descriptor.droppableId, descriptor.id, descriptor.index, descriptor.type]);\n  return children(provided, mapped.snapshot, rubric);\n}\n\nvar isStrictEqual = (function (a, b) {\n  return a === b;\n});\n\nvar whatIsDraggedOverFromResult = (function (result) {\n  var combine = result.combine,\n      destination = result.destination;\n\n  if (destination) {\n    return destination.droppableId;\n  }\n\n  if (combine) {\n    return combine.droppableId;\n  }\n\n  return null;\n});\n\nvar getCombineWithFromResult = function getCombineWithFromResult(result) {\n  return result.combine ? result.combine.draggableId : null;\n};\n\nvar getCombineWithFromImpact = function getCombineWithFromImpact(impact) {\n  return impact.at && impact.at.type === 'COMBINE' ? impact.at.combine.draggableId : null;\n};\n\nfunction getDraggableSelector() {\n  var memoizedOffset = memoizeOne(function (x, y) {\n    return {\n      x: x,\n      y: y\n    };\n  });\n  var getMemoizedSnapshot = memoizeOne(function (mode, isClone, draggingOver, combineWith, dropping) {\n    return {\n      isDragging: true,\n      isClone: isClone,\n      isDropAnimating: Boolean(dropping),\n      dropAnimation: dropping,\n      mode: mode,\n      draggingOver: draggingOver,\n      combineWith: combineWith,\n      combineTargetFor: null\n    };\n  });\n  var getMemoizedProps = memoizeOne(function (offset, mode, dimension, isClone, draggingOver, combineWith, forceShouldAnimate) {\n    return {\n      mapped: {\n        type: 'DRAGGING',\n        dropping: null,\n        draggingOver: draggingOver,\n        combineWith: combineWith,\n        mode: mode,\n        offset: offset,\n        dimension: dimension,\n        forceShouldAnimate: forceShouldAnimate,\n        snapshot: getMemoizedSnapshot(mode, isClone, draggingOver, combineWith, null)\n      }\n    };\n  });\n\n  var selector = function selector(state, ownProps) {\n    if (state.isDragging) {\n      if (state.critical.draggable.id !== ownProps.draggableId) {\n        return null;\n      }\n\n      var offset = state.current.client.offset;\n      var dimension = state.dimensions.draggables[ownProps.draggableId];\n      var draggingOver = whatIsDraggedOver(state.impact);\n      var combineWith = getCombineWithFromImpact(state.impact);\n      var forceShouldAnimate = state.forceShouldAnimate;\n      return getMemoizedProps(memoizedOffset(offset.x, offset.y), state.movementMode, dimension, ownProps.isClone, draggingOver, combineWith, forceShouldAnimate);\n    }\n\n    if (state.phase === 'DROP_ANIMATING') {\n      var completed = state.completed;\n\n      if (completed.result.draggableId !== ownProps.draggableId) {\n        return null;\n      }\n\n      var isClone = ownProps.isClone;\n      var _dimension = state.dimensions.draggables[ownProps.draggableId];\n      var result = completed.result;\n      var mode = result.mode;\n\n      var _draggingOver = whatIsDraggedOverFromResult(result);\n\n      var _combineWith = getCombineWithFromResult(result);\n\n      var duration = state.dropDuration;\n      var dropping = {\n        duration: duration,\n        curve: curves.drop,\n        moveTo: state.newHomeClientOffset,\n        opacity: _combineWith ? combine.opacity.drop : null,\n        scale: _combineWith ? combine.scale.drop : null\n      };\n      return {\n        mapped: {\n          type: 'DRAGGING',\n          offset: state.newHomeClientOffset,\n          dimension: _dimension,\n          dropping: dropping,\n          draggingOver: _draggingOver,\n          combineWith: _combineWith,\n          mode: mode,\n          forceShouldAnimate: null,\n          snapshot: getMemoizedSnapshot(mode, isClone, _draggingOver, _combineWith, dropping)\n        }\n      };\n    }\n\n    return null;\n  };\n\n  return selector;\n}\n\nfunction getSecondarySnapshot(combineTargetFor) {\n  return {\n    isDragging: false,\n    isDropAnimating: false,\n    isClone: false,\n    dropAnimation: null,\n    mode: null,\n    draggingOver: null,\n    combineTargetFor: combineTargetFor,\n    combineWith: null\n  };\n}\n\nvar atRest = {\n  mapped: {\n    type: 'SECONDARY',\n    offset: origin,\n    combineTargetFor: null,\n    shouldAnimateDisplacement: true,\n    snapshot: getSecondarySnapshot(null)\n  }\n};\n\nfunction getSecondarySelector() {\n  var memoizedOffset = memoizeOne(function (x, y) {\n    return {\n      x: x,\n      y: y\n    };\n  });\n  var getMemoizedSnapshot = memoizeOne(getSecondarySnapshot);\n  var getMemoizedProps = memoizeOne(function (offset, combineTargetFor, shouldAnimateDisplacement) {\n    if (combineTargetFor === void 0) {\n      combineTargetFor = null;\n    }\n\n    return {\n      mapped: {\n        type: 'SECONDARY',\n        offset: offset,\n        combineTargetFor: combineTargetFor,\n        shouldAnimateDisplacement: shouldAnimateDisplacement,\n        snapshot: getMemoizedSnapshot(combineTargetFor)\n      }\n    };\n  });\n\n  var getFallback = function getFallback(combineTargetFor) {\n    return combineTargetFor ? getMemoizedProps(origin, combineTargetFor, true) : null;\n  };\n\n  var getProps = function getProps(ownId, draggingId, impact, afterCritical) {\n    var visualDisplacement = impact.displaced.visible[ownId];\n    var isAfterCriticalInVirtualList = Boolean(afterCritical.inVirtualList && afterCritical.effected[ownId]);\n    var combine = tryGetCombine(impact);\n    var combineTargetFor = combine && combine.draggableId === ownId ? draggingId : null;\n\n    if (!visualDisplacement) {\n      if (!isAfterCriticalInVirtualList) {\n        return getFallback(combineTargetFor);\n      }\n\n      if (impact.displaced.invisible[ownId]) {\n        return null;\n      }\n\n      var change = negate(afterCritical.displacedBy.point);\n\n      var _offset = memoizedOffset(change.x, change.y);\n\n      return getMemoizedProps(_offset, combineTargetFor, true);\n    }\n\n    if (isAfterCriticalInVirtualList) {\n      return getFallback(combineTargetFor);\n    }\n\n    var displaceBy = impact.displacedBy.point;\n    var offset = memoizedOffset(displaceBy.x, displaceBy.y);\n    return getMemoizedProps(offset, combineTargetFor, visualDisplacement.shouldAnimate);\n  };\n\n  var selector = function selector(state, ownProps) {\n    if (state.isDragging) {\n      if (state.critical.draggable.id === ownProps.draggableId) {\n        return null;\n      }\n\n      return getProps(ownProps.draggableId, state.critical.draggable.id, state.impact, state.afterCritical);\n    }\n\n    if (state.phase === 'DROP_ANIMATING') {\n      var completed = state.completed;\n\n      if (completed.result.draggableId === ownProps.draggableId) {\n        return null;\n      }\n\n      return getProps(ownProps.draggableId, completed.result.draggableId, completed.impact, completed.afterCritical);\n    }\n\n    return null;\n  };\n\n  return selector;\n}\n\nvar makeMapStateToProps = function makeMapStateToProps() {\n  var draggingSelector = getDraggableSelector();\n  var secondarySelector = getSecondarySelector();\n\n  var selector = function selector(state, ownProps) {\n    return draggingSelector(state, ownProps) || secondarySelector(state, ownProps) || atRest;\n  };\n\n  return selector;\n};\nvar mapDispatchToProps = {\n  dropAnimationFinished: dropAnimationFinished\n};\nvar ConnectedDraggable = connect(makeMapStateToProps, mapDispatchToProps, null, {\n  context: StoreContext,\n  pure: true,\n  areStatePropsEqual: isStrictEqual\n})(Draggable);\n\nfunction PrivateDraggable(props) {\n  var droppableContext = useRequiredContext(DroppableContext);\n  var isUsingCloneFor = droppableContext.isUsingCloneFor;\n\n  if (isUsingCloneFor === props.draggableId && !props.isClone) {\n    return null;\n  }\n\n  return React.createElement(ConnectedDraggable, props);\n}\nfunction PublicDraggable(props) {\n  var isEnabled = typeof props.isDragDisabled === 'boolean' ? !props.isDragDisabled : true;\n  var canDragInteractiveElements = Boolean(props.disableInteractiveElementBlocking);\n  var shouldRespectForcePress = Boolean(props.shouldRespectForcePress);\n  return React.createElement(PrivateDraggable, _extends({}, props, {\n    isClone: false,\n    isEnabled: isEnabled,\n    canDragInteractiveElements: canDragInteractiveElements,\n    shouldRespectForcePress: shouldRespectForcePress\n  }));\n}\n\nfunction Droppable(props) {\n  var appContext = useContext(AppContext);\n  !appContext ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'Could not find app context') : invariant(false) : void 0;\n  var contextId = appContext.contextId,\n      isMovementAllowed = appContext.isMovementAllowed;\n  var droppableRef = useRef(null);\n  var placeholderRef = useRef(null);\n  var children = props.children,\n      droppableId = props.droppableId,\n      type = props.type,\n      mode = props.mode,\n      direction = props.direction,\n      ignoreContainerClipping = props.ignoreContainerClipping,\n      isDropDisabled = props.isDropDisabled,\n      isCombineEnabled = props.isCombineEnabled,\n      snapshot = props.snapshot,\n      useClone = props.useClone,\n      updateViewportMaxScroll = props.updateViewportMaxScroll,\n      getContainerForClone = props.getContainerForClone;\n  var getDroppableRef = useCallback(function () {\n    return droppableRef.current;\n  }, []);\n  var setDroppableRef = useCallback(function (value) {\n    droppableRef.current = value;\n  }, []);\n  var getPlaceholderRef = useCallback(function () {\n    return placeholderRef.current;\n  }, []);\n  var setPlaceholderRef = useCallback(function (value) {\n    placeholderRef.current = value;\n  }, []);\n  useValidation({\n    props: props,\n    getDroppableRef: getDroppableRef,\n    getPlaceholderRef: getPlaceholderRef\n  });\n  var onPlaceholderTransitionEnd = useCallback(function () {\n    if (isMovementAllowed()) {\n      updateViewportMaxScroll({\n        maxScroll: getMaxWindowScroll()\n      });\n    }\n  }, [isMovementAllowed, updateViewportMaxScroll]);\n  useDroppablePublisher({\n    droppableId: droppableId,\n    type: type,\n    mode: mode,\n    direction: direction,\n    isDropDisabled: isDropDisabled,\n    isCombineEnabled: isCombineEnabled,\n    ignoreContainerClipping: ignoreContainerClipping,\n    getDroppableRef: getDroppableRef\n  });\n  var placeholder = React.createElement(AnimateInOut, {\n    on: props.placeholder,\n    shouldAnimate: props.shouldAnimatePlaceholder\n  }, function (_ref) {\n    var onClose = _ref.onClose,\n        data = _ref.data,\n        animate = _ref.animate;\n    return React.createElement(Placeholder$1, {\n      placeholder: data,\n      onClose: onClose,\n      innerRef: setPlaceholderRef,\n      animate: animate,\n      contextId: contextId,\n      onTransitionEnd: onPlaceholderTransitionEnd\n    });\n  });\n  var provided = useMemo(function () {\n    return {\n      innerRef: setDroppableRef,\n      placeholder: placeholder,\n      droppableProps: {\n        'data-rbd-droppable-id': droppableId,\n        'data-rbd-droppable-context-id': contextId\n      }\n    };\n  }, [contextId, droppableId, placeholder, setDroppableRef]);\n  var isUsingCloneFor = useClone ? useClone.dragging.draggableId : null;\n  var droppableContext = useMemo(function () {\n    return {\n      droppableId: droppableId,\n      type: type,\n      isUsingCloneFor: isUsingCloneFor\n    };\n  }, [droppableId, isUsingCloneFor, type]);\n\n  function getClone() {\n    if (!useClone) {\n      return null;\n    }\n\n    var dragging = useClone.dragging,\n        render = useClone.render;\n    var node = React.createElement(PrivateDraggable, {\n      draggableId: dragging.draggableId,\n      index: dragging.source.index,\n      isClone: true,\n      isEnabled: true,\n      shouldRespectForcePress: false,\n      canDragInteractiveElements: true\n    }, function (draggableProvided, draggableSnapshot) {\n      return render(draggableProvided, draggableSnapshot, dragging);\n    });\n    return ReactDOM.createPortal(node, getContainerForClone());\n  }\n\n  return React.createElement(DroppableContext.Provider, {\n    value: droppableContext\n  }, children(provided, snapshot), getClone());\n}\n\nvar isMatchingType = function isMatchingType(type, critical) {\n  return type === critical.droppable.type;\n};\n\nvar getDraggable = function getDraggable(critical, dimensions) {\n  return dimensions.draggables[critical.draggable.id];\n};\n\nvar makeMapStateToProps$1 = function makeMapStateToProps() {\n  var idleWithAnimation = {\n    placeholder: null,\n    shouldAnimatePlaceholder: true,\n    snapshot: {\n      isDraggingOver: false,\n      draggingOverWith: null,\n      draggingFromThisWith: null,\n      isUsingPlaceholder: false\n    },\n    useClone: null\n  };\n\n  var idleWithoutAnimation = _extends({}, idleWithAnimation, {\n    shouldAnimatePlaceholder: false\n  });\n\n  var getDraggableRubric = memoizeOne(function (descriptor) {\n    return {\n      draggableId: descriptor.id,\n      type: descriptor.type,\n      source: {\n        index: descriptor.index,\n        droppableId: descriptor.droppableId\n      }\n    };\n  });\n  var getMapProps = memoizeOne(function (id, isEnabled, isDraggingOverForConsumer, isDraggingOverForImpact, dragging, renderClone) {\n    var draggableId = dragging.descriptor.id;\n    var isHome = dragging.descriptor.droppableId === id;\n\n    if (isHome) {\n      var useClone = renderClone ? {\n        render: renderClone,\n        dragging: getDraggableRubric(dragging.descriptor)\n      } : null;\n      var _snapshot = {\n        isDraggingOver: isDraggingOverForConsumer,\n        draggingOverWith: isDraggingOverForConsumer ? draggableId : null,\n        draggingFromThisWith: draggableId,\n        isUsingPlaceholder: true\n      };\n      return {\n        placeholder: dragging.placeholder,\n        shouldAnimatePlaceholder: false,\n        snapshot: _snapshot,\n        useClone: useClone\n      };\n    }\n\n    if (!isEnabled) {\n      return idleWithoutAnimation;\n    }\n\n    if (!isDraggingOverForImpact) {\n      return idleWithAnimation;\n    }\n\n    var snapshot = {\n      isDraggingOver: isDraggingOverForConsumer,\n      draggingOverWith: draggableId,\n      draggingFromThisWith: null,\n      isUsingPlaceholder: true\n    };\n    return {\n      placeholder: dragging.placeholder,\n      shouldAnimatePlaceholder: true,\n      snapshot: snapshot,\n      useClone: null\n    };\n  });\n\n  var selector = function selector(state, ownProps) {\n    var id = ownProps.droppableId;\n    var type = ownProps.type;\n    var isEnabled = !ownProps.isDropDisabled;\n    var renderClone = ownProps.renderClone;\n\n    if (state.isDragging) {\n      var critical = state.critical;\n\n      if (!isMatchingType(type, critical)) {\n        return idleWithoutAnimation;\n      }\n\n      var dragging = getDraggable(critical, state.dimensions);\n      var isDraggingOver = whatIsDraggedOver(state.impact) === id;\n      return getMapProps(id, isEnabled, isDraggingOver, isDraggingOver, dragging, renderClone);\n    }\n\n    if (state.phase === 'DROP_ANIMATING') {\n      var completed = state.completed;\n\n      if (!isMatchingType(type, completed.critical)) {\n        return idleWithoutAnimation;\n      }\n\n      var _dragging = getDraggable(completed.critical, state.dimensions);\n\n      return getMapProps(id, isEnabled, whatIsDraggedOverFromResult(completed.result) === id, whatIsDraggedOver(completed.impact) === id, _dragging, renderClone);\n    }\n\n    if (state.phase === 'IDLE' && state.completed && !state.shouldFlush) {\n      var _completed = state.completed;\n\n      if (!isMatchingType(type, _completed.critical)) {\n        return idleWithoutAnimation;\n      }\n\n      var wasOver = whatIsDraggedOver(_completed.impact) === id;\n      var wasCombining = Boolean(_completed.impact.at && _completed.impact.at.type === 'COMBINE');\n      var isHome = _completed.critical.droppable.id === id;\n\n      if (wasOver) {\n        return wasCombining ? idleWithAnimation : idleWithoutAnimation;\n      }\n\n      if (isHome) {\n        return idleWithAnimation;\n      }\n\n      return idleWithoutAnimation;\n    }\n\n    return idleWithoutAnimation;\n  };\n\n  return selector;\n};\nvar mapDispatchToProps$1 = {\n  updateViewportMaxScroll: updateViewportMaxScroll\n};\n\nfunction getBody() {\n  !document.body ? process.env.NODE_ENV !== \"production\" ? invariant(false, 'document.body is not ready') : invariant(false) : void 0;\n  return document.body;\n}\n\nvar defaultProps = {\n  mode: 'standard',\n  type: 'DEFAULT',\n  direction: 'vertical',\n  isDropDisabled: false,\n  isCombineEnabled: false,\n  ignoreContainerClipping: false,\n  renderClone: null,\n  getContainerForClone: getBody\n};\nvar ConnectedDroppable = connect(makeMapStateToProps$1, mapDispatchToProps$1, null, {\n  context: StoreContext,\n  pure: true,\n  areStatePropsEqual: isStrictEqual\n})(Droppable);\nConnectedDroppable.defaultProps = defaultProps;\n\nexport { DragDropContext, PublicDraggable as Draggable, ConnectedDroppable as Droppable, resetServerContext, useKeyboardSensor, useMouseSensor, useTouchSensor };\n","export default function getWindow(node) {\n  if (node == null) {\n    return window;\n  }\n\n  if (node.toString() !== '[object Window]') {\n    var ownerDocument = node.ownerDocument;\n    return ownerDocument ? ownerDocument.defaultView || window : window;\n  }\n\n  return node;\n}","import getWindow from \"./getWindow.js\";\n\nfunction isElement(node) {\n  var OwnElement = getWindow(node).Element;\n  return node instanceof OwnElement || node instanceof Element;\n}\n\nfunction isHTMLElement(node) {\n  var OwnElement = getWindow(node).HTMLElement;\n  return node instanceof OwnElement || node instanceof HTMLElement;\n}\n\nfunction isShadowRoot(node) {\n  // IE 11 has no ShadowRoot\n  if (typeof ShadowRoot === 'undefined') {\n    return false;\n  }\n\n  var OwnElement = getWindow(node).ShadowRoot;\n  return node instanceof OwnElement || node instanceof ShadowRoot;\n}\n\nexport { isElement, isHTMLElement, isShadowRoot };","export var max = Math.max;\nexport var min = Math.min;\nexport var round = Math.round;","export default function getUAString() {\n  var uaData = navigator.userAgentData;\n\n  if (uaData != null && uaData.brands && Array.isArray(uaData.brands)) {\n    return uaData.brands.map(function (item) {\n      return item.brand + \"/\" + item.version;\n    }).join(' ');\n  }\n\n  return navigator.userAgent;\n}","import getUAString from \"../utils/userAgent.js\";\nexport default function isLayoutViewport() {\n  return !/^((?!chrome|android).)*safari/i.test(getUAString());\n}","import { isElement, isHTMLElement } from \"./instanceOf.js\";\nimport { round } from \"../utils/math.js\";\nimport getWindow from \"./getWindow.js\";\nimport isLayoutViewport from \"./isLayoutViewport.js\";\nexport default function getBoundingClientRect(element, includeScale, isFixedStrategy) {\n  if (includeScale === void 0) {\n    includeScale = false;\n  }\n\n  if (isFixedStrategy === void 0) {\n    isFixedStrategy = false;\n  }\n\n  var clientRect = element.getBoundingClientRect();\n  var scaleX = 1;\n  var scaleY = 1;\n\n  if (includeScale && isHTMLElement(element)) {\n    scaleX = element.offsetWidth > 0 ? round(clientRect.width) / element.offsetWidth || 1 : 1;\n    scaleY = element.offsetHeight > 0 ? round(clientRect.height) / element.offsetHeight || 1 : 1;\n  }\n\n  var _ref = isElement(element) ? getWindow(element) : window,\n      visualViewport = _ref.visualViewport;\n\n  var addVisualOffsets = !isLayoutViewport() && isFixedStrategy;\n  var x = (clientRect.left + (addVisualOffsets && visualViewport ? visualViewport.offsetLeft : 0)) / scaleX;\n  var y = (clientRect.top + (addVisualOffsets && visualViewport ? visualViewport.offsetTop : 0)) / scaleY;\n  var width = clientRect.width / scaleX;\n  var height = clientRect.height / scaleY;\n  return {\n    width: width,\n    height: height,\n    top: y,\n    right: x + width,\n    bottom: y + height,\n    left: x,\n    x: x,\n    y: y\n  };\n}","import getWindow from \"./getWindow.js\";\nexport default function getWindowScroll(node) {\n  var win = getWindow(node);\n  var scrollLeft = win.pageXOffset;\n  var scrollTop = win.pageYOffset;\n  return {\n    scrollLeft: scrollLeft,\n    scrollTop: scrollTop\n  };\n}","export default function getHTMLElementScroll(element) {\n  return {\n    scrollLeft: element.scrollLeft,\n    scrollTop: element.scrollTop\n  };\n}","import getWindowScroll from \"./getWindowScroll.js\";\nimport getWindow from \"./getWindow.js\";\nimport { isHTMLElement } from \"./instanceOf.js\";\nimport getHTMLElementScroll from \"./getHTMLElementScroll.js\";\nexport default function getNodeScroll(node) {\n  if (node === getWindow(node) || !isHTMLElement(node)) {\n    return getWindowScroll(node);\n  } else {\n    return getHTMLElementScroll(node);\n  }\n}","export default function getNodeName(element) {\n  return element ? (element.nodeName || '').toLowerCase() : null;\n}","import { isElement } from \"./instanceOf.js\";\nexport default function getDocumentElement(element) {\n  // $FlowFixMe[incompatible-return]: assume body is always available\n  return ((isElement(element) ? element.ownerDocument : // $FlowFixMe[prop-missing]\n  element.document) || window.document).documentElement;\n}","import getBoundingClientRect from \"./getBoundingClientRect.js\";\nimport getDocumentElement from \"./getDocumentElement.js\";\nimport getWindowScroll from \"./getWindowScroll.js\";\nexport default function getWindowScrollBarX(element) {\n  // If <html> has a CSS width greater than the viewport, then this will be\n  // incorrect for RTL.\n  // Popper 1 is broken in this case and never had a bug report so let's assume\n  // it's not an issue. I don't think anyone ever specifies width on <html>\n  // anyway.\n  // Browsers where the left scrollbar doesn't cause an issue report `0` for\n  // this (e.g. Edge 2019, IE11, Safari)\n  return getBoundingClientRect(getDocumentElement(element)).left + getWindowScroll(element).scrollLeft;\n}","import getWindow from \"./getWindow.js\";\nexport default function getComputedStyle(element) {\n  return getWindow(element).getComputedStyle(element);\n}","import getComputedStyle from \"./getComputedStyle.js\";\nexport default function isScrollParent(element) {\n  // Firefox wants us to check `-x` and `-y` variations as well\n  var _getComputedStyle = getComputedStyle(element),\n      overflow = _getComputedStyle.overflow,\n      overflowX = _getComputedStyle.overflowX,\n      overflowY = _getComputedStyle.overflowY;\n\n  return /auto|scroll|overlay|hidden/.test(overflow + overflowY + overflowX);\n}","import getBoundingClientRect from \"./getBoundingClientRect.js\";\nimport getNodeScroll from \"./getNodeScroll.js\";\nimport getNodeName from \"./getNodeName.js\";\nimport { isHTMLElement } from \"./instanceOf.js\";\nimport getWindowScrollBarX from \"./getWindowScrollBarX.js\";\nimport getDocumentElement from \"./getDocumentElement.js\";\nimport isScrollParent from \"./isScrollParent.js\";\nimport { round } from \"../utils/math.js\";\n\nfunction isElementScaled(element) {\n  var rect = element.getBoundingClientRect();\n  var scaleX = round(rect.width) / element.offsetWidth || 1;\n  var scaleY = round(rect.height) / element.offsetHeight || 1;\n  return scaleX !== 1 || scaleY !== 1;\n} // Returns the composite rect of an element relative to its offsetParent.\n// Composite means it takes into account transforms as well as layout.\n\n\nexport default function getCompositeRect(elementOrVirtualElement, offsetParent, isFixed) {\n  if (isFixed === void 0) {\n    isFixed = false;\n  }\n\n  var isOffsetParentAnElement = isHTMLElement(offsetParent);\n  var offsetParentIsScaled = isHTMLElement(offsetParent) && isElementScaled(offsetParent);\n  var documentElement = getDocumentElement(offsetParent);\n  var rect = getBoundingClientRect(elementOrVirtualElement, offsetParentIsScaled, isFixed);\n  var scroll = {\n    scrollLeft: 0,\n    scrollTop: 0\n  };\n  var offsets = {\n    x: 0,\n    y: 0\n  };\n\n  if (isOffsetParentAnElement || !isOffsetParentAnElement && !isFixed) {\n    if (getNodeName(offsetParent) !== 'body' || // https://github.com/popperjs/popper-core/issues/1078\n    isScrollParent(documentElement)) {\n      scroll = getNodeScroll(offsetParent);\n    }\n\n    if (isHTMLElement(offsetParent)) {\n      offsets = getBoundingClientRect(offsetParent, true);\n      offsets.x += offsetParent.clientLeft;\n      offsets.y += offsetParent.clientTop;\n    } else if (documentElement) {\n      offsets.x = getWindowScrollBarX(documentElement);\n    }\n  }\n\n  return {\n    x: rect.left + scroll.scrollLeft - offsets.x,\n    y: rect.top + scroll.scrollTop - offsets.y,\n    width: rect.width,\n    height: rect.height\n  };\n}","import getBoundingClientRect from \"./getBoundingClientRect.js\"; // Returns the layout rect of an element relative to its offsetParent. Layout\n// means it doesn't take into account transforms.\n\nexport default function getLayoutRect(element) {\n  var clientRect = getBoundingClientRect(element); // Use the clientRect sizes if it's not been transformed.\n  // Fixes https://github.com/popperjs/popper-core/issues/1223\n\n  var width = element.offsetWidth;\n  var height = element.offsetHeight;\n\n  if (Math.abs(clientRect.width - width) <= 1) {\n    width = clientRect.width;\n  }\n\n  if (Math.abs(clientRect.height - height) <= 1) {\n    height = clientRect.height;\n  }\n\n  return {\n    x: element.offsetLeft,\n    y: element.offsetTop,\n    width: width,\n    height: height\n  };\n}","import getNodeName from \"./getNodeName.js\";\nimport getDocumentElement from \"./getDocumentElement.js\";\nimport { isShadowRoot } from \"./instanceOf.js\";\nexport default function getParentNode(element) {\n  if (getNodeName(element) === 'html') {\n    return element;\n  }\n\n  return (// this is a quicker (but less type safe) way to save quite some bytes from the bundle\n    // $FlowFixMe[incompatible-return]\n    // $FlowFixMe[prop-missing]\n    element.assignedSlot || // step into the shadow DOM of the parent of a slotted node\n    element.parentNode || ( // DOM Element detected\n    isShadowRoot(element) ? element.host : null) || // ShadowRoot detected\n    // $FlowFixMe[incompatible-call]: HTMLElement is a Node\n    getDocumentElement(element) // fallback\n\n  );\n}","import getParentNode from \"./getParentNode.js\";\nimport isScrollParent from \"./isScrollParent.js\";\nimport getNodeName from \"./getNodeName.js\";\nimport { isHTMLElement } from \"./instanceOf.js\";\nexport default function getScrollParent(node) {\n  if (['html', 'body', '#document'].indexOf(getNodeName(node)) >= 0) {\n    // $FlowFixMe[incompatible-return]: assume body is always available\n    return node.ownerDocument.body;\n  }\n\n  if (isHTMLElement(node) && isScrollParent(node)) {\n    return node;\n  }\n\n  return getScrollParent(getParentNode(node));\n}","import getScrollParent from \"./getScrollParent.js\";\nimport getParentNode from \"./getParentNode.js\";\nimport getWindow from \"./getWindow.js\";\nimport isScrollParent from \"./isScrollParent.js\";\n/*\ngiven a DOM element, return the list of all scroll parents, up the list of ancesors\nuntil we get to the top window object. This list is what we attach scroll listeners\nto, because if any of these parent elements scroll, we'll need to re-calculate the\nreference element's position.\n*/\n\nexport default function listScrollParents(element, list) {\n  var _element$ownerDocumen;\n\n  if (list === void 0) {\n    list = [];\n  }\n\n  var scrollParent = getScrollParent(element);\n  var isBody = scrollParent === ((_element$ownerDocumen = element.ownerDocument) == null ? void 0 : _element$ownerDocumen.body);\n  var win = getWindow(scrollParent);\n  var target = isBody ? [win].concat(win.visualViewport || [], isScrollParent(scrollParent) ? scrollParent : []) : scrollParent;\n  var updatedList = list.concat(target);\n  return isBody ? updatedList : // $FlowFixMe[incompatible-call]: isBody tells us target will be an HTMLElement here\n  updatedList.concat(listScrollParents(getParentNode(target)));\n}","import getNodeName from \"./getNodeName.js\";\nexport default function isTableElement(element) {\n  return ['table', 'td', 'th'].indexOf(getNodeName(element)) >= 0;\n}","import getWindow from \"./getWindow.js\";\nimport getNodeName from \"./getNodeName.js\";\nimport getComputedStyle from \"./getComputedStyle.js\";\nimport { isHTMLElement, isShadowRoot } from \"./instanceOf.js\";\nimport isTableElement from \"./isTableElement.js\";\nimport getParentNode from \"./getParentNode.js\";\nimport getUAString from \"../utils/userAgent.js\";\n\nfunction getTrueOffsetParent(element) {\n  if (!isHTMLElement(element) || // https://github.com/popperjs/popper-core/issues/837\n  getComputedStyle(element).position === 'fixed') {\n    return null;\n  }\n\n  return element.offsetParent;\n} // `.offsetParent` reports `null` for fixed elements, while absolute elements\n// return the containing block\n\n\nfunction getContainingBlock(element) {\n  var isFirefox = /firefox/i.test(getUAString());\n  var isIE = /Trident/i.test(getUAString());\n\n  if (isIE && isHTMLElement(element)) {\n    // In IE 9, 10 and 11 fixed elements containing block is always established by the viewport\n    var elementCss = getComputedStyle(element);\n\n    if (elementCss.position === 'fixed') {\n      return null;\n    }\n  }\n\n  var currentNode = getParentNode(element);\n\n  if (isShadowRoot(currentNode)) {\n    currentNode = currentNode.host;\n  }\n\n  while (isHTMLElement(currentNode) && ['html', 'body'].indexOf(getNodeName(currentNode)) < 0) {\n    var css = getComputedStyle(currentNode); // This is non-exhaustive but covers the most common CSS properties that\n    // create a containing block.\n    // https://developer.mozilla.org/en-US/docs/Web/CSS/Containing_block#identifying_the_containing_block\n\n    if (css.transform !== 'none' || css.perspective !== 'none' || css.contain === 'paint' || ['transform', 'perspective'].indexOf(css.willChange) !== -1 || isFirefox && css.willChange === 'filter' || isFirefox && css.filter && css.filter !== 'none') {\n      return currentNode;\n    } else {\n      currentNode = currentNode.parentNode;\n    }\n  }\n\n  return null;\n} // Gets the closest ancestor positioned element. Handles some edge cases,\n// such as table ancestors and cross browser bugs.\n\n\nexport default function getOffsetParent(element) {\n  var window = getWindow(element);\n  var offsetParent = getTrueOffsetParent(element);\n\n  while (offsetParent && isTableElement(offsetParent) && getComputedStyle(offsetParent).position === 'static') {\n    offsetParent = getTrueOffsetParent(offsetParent);\n  }\n\n  if (offsetParent && (getNodeName(offsetParent) === 'html' || getNodeName(offsetParent) === 'body' && getComputedStyle(offsetParent).position === 'static')) {\n    return window;\n  }\n\n  return offsetParent || getContainingBlock(element) || window;\n}","export var top = 'top';\nexport var bottom = 'bottom';\nexport var right = 'right';\nexport var left = 'left';\nexport var auto = 'auto';\nexport var basePlacements = [top, bottom, right, left];\nexport var start = 'start';\nexport var end = 'end';\nexport var clippingParents = 'clippingParents';\nexport var viewport = 'viewport';\nexport var popper = 'popper';\nexport var reference = 'reference';\nexport var variationPlacements = /*#__PURE__*/basePlacements.reduce(function (acc, placement) {\n  return acc.concat([placement + \"-\" + start, placement + \"-\" + end]);\n}, []);\nexport var placements = /*#__PURE__*/[].concat(basePlacements, [auto]).reduce(function (acc, placement) {\n  return acc.concat([placement, placement + \"-\" + start, placement + \"-\" + end]);\n}, []); // modifiers that need to read the DOM\n\nexport var beforeRead = 'beforeRead';\nexport var read = 'read';\nexport var afterRead = 'afterRead'; // pure-logic modifiers\n\nexport var beforeMain = 'beforeMain';\nexport var main = 'main';\nexport var afterMain = 'afterMain'; // modifier with the purpose to write to the DOM (or write into a framework state)\n\nexport var beforeWrite = 'beforeWrite';\nexport var write = 'write';\nexport var afterWrite = 'afterWrite';\nexport var modifierPhases = [beforeRead, read, afterRead, beforeMain, main, afterMain, beforeWrite, write, afterWrite];","import { modifierPhases } from \"../enums.js\"; // source: https://stackoverflow.com/questions/49875255\n\nfunction order(modifiers) {\n  var map = new Map();\n  var visited = new Set();\n  var result = [];\n  modifiers.forEach(function (modifier) {\n    map.set(modifier.name, modifier);\n  }); // On visiting object, check for its dependencies and visit them recursively\n\n  function sort(modifier) {\n    visited.add(modifier.name);\n    var requires = [].concat(modifier.requires || [], modifier.requiresIfExists || []);\n    requires.forEach(function (dep) {\n      if (!visited.has(dep)) {\n        var depModifier = map.get(dep);\n\n        if (depModifier) {\n          sort(depModifier);\n        }\n      }\n    });\n    result.push(modifier);\n  }\n\n  modifiers.forEach(function (modifier) {\n    if (!visited.has(modifier.name)) {\n      // check for visited object\n      sort(modifier);\n    }\n  });\n  return result;\n}\n\nexport default function orderModifiers(modifiers) {\n  // order based on dependencies\n  var orderedModifiers = order(modifiers); // order based on phase\n\n  return modifierPhases.reduce(function (acc, phase) {\n    return acc.concat(orderedModifiers.filter(function (modifier) {\n      return modifier.phase === phase;\n    }));\n  }, []);\n}","export default function debounce(fn) {\n  var pending;\n  return function () {\n    if (!pending) {\n      pending = new Promise(function (resolve) {\n        Promise.resolve().then(function () {\n          pending = undefined;\n          resolve(fn());\n        });\n      });\n    }\n\n    return pending;\n  };\n}","export default function mergeByName(modifiers) {\n  var merged = modifiers.reduce(function (merged, current) {\n    var existing = merged[current.name];\n    merged[current.name] = existing ? Object.assign({}, existing, current, {\n      options: Object.assign({}, existing.options, current.options),\n      data: Object.assign({}, existing.data, current.data)\n    }) : current;\n    return merged;\n  }, {}); // IE11 does not support Object.values\n\n  return Object.keys(merged).map(function (key) {\n    return merged[key];\n  });\n}","import getCompositeRect from \"./dom-utils/getCompositeRect.js\";\nimport getLayoutRect from \"./dom-utils/getLayoutRect.js\";\nimport listScrollParents from \"./dom-utils/listScrollParents.js\";\nimport getOffsetParent from \"./dom-utils/getOffsetParent.js\";\nimport orderModifiers from \"./utils/orderModifiers.js\";\nimport debounce from \"./utils/debounce.js\";\nimport mergeByName from \"./utils/mergeByName.js\";\nimport detectOverflow from \"./utils/detectOverflow.js\";\nimport { isElement } from \"./dom-utils/instanceOf.js\";\nvar DEFAULT_OPTIONS = {\n  placement: 'bottom',\n  modifiers: [],\n  strategy: 'absolute'\n};\n\nfunction areValidElements() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  return !args.some(function (element) {\n    return !(element && typeof element.getBoundingClientRect === 'function');\n  });\n}\n\nexport function popperGenerator(generatorOptions) {\n  if (generatorOptions === void 0) {\n    generatorOptions = {};\n  }\n\n  var _generatorOptions = generatorOptions,\n      _generatorOptions$def = _generatorOptions.defaultModifiers,\n      defaultModifiers = _generatorOptions$def === void 0 ? [] : _generatorOptions$def,\n      _generatorOptions$def2 = _generatorOptions.defaultOptions,\n      defaultOptions = _generatorOptions$def2 === void 0 ? DEFAULT_OPTIONS : _generatorOptions$def2;\n  return function createPopper(reference, popper, options) {\n    if (options === void 0) {\n      options = defaultOptions;\n    }\n\n    var state = {\n      placement: 'bottom',\n      orderedModifiers: [],\n      options: Object.assign({}, DEFAULT_OPTIONS, defaultOptions),\n      modifiersData: {},\n      elements: {\n        reference: reference,\n        popper: popper\n      },\n      attributes: {},\n      styles: {}\n    };\n    var effectCleanupFns = [];\n    var isDestroyed = false;\n    var instance = {\n      state: state,\n      setOptions: function setOptions(setOptionsAction) {\n        var options = typeof setOptionsAction === 'function' ? setOptionsAction(state.options) : setOptionsAction;\n        cleanupModifierEffects();\n        state.options = Object.assign({}, defaultOptions, state.options, options);\n        state.scrollParents = {\n          reference: isElement(reference) ? listScrollParents(reference) : reference.contextElement ? listScrollParents(reference.contextElement) : [],\n          popper: listScrollParents(popper)\n        }; // Orders the modifiers based on their dependencies and `phase`\n        // properties\n\n        var orderedModifiers = orderModifiers(mergeByName([].concat(defaultModifiers, state.options.modifiers))); // Strip out disabled modifiers\n\n        state.orderedModifiers = orderedModifiers.filter(function (m) {\n          return m.enabled;\n        });\n        runModifierEffects();\n        return instance.update();\n      },\n      // Sync update  it will always be executed, even if not necessary. This\n      // is useful for low frequency updates where sync behavior simplifies the\n      // logic.\n      // For high frequency updates (e.g. `resize` and `scroll` events), always\n      // prefer the async Popper#update method\n      forceUpdate: function forceUpdate() {\n        if (isDestroyed) {\n          return;\n        }\n\n        var _state$elements = state.elements,\n            reference = _state$elements.reference,\n            popper = _state$elements.popper; // Don't proceed if `reference` or `popper` are not valid elements\n        // anymore\n\n        if (!areValidElements(reference, popper)) {\n          return;\n        } // Store the reference and popper rects to be read by modifiers\n\n\n        state.rects = {\n          reference: getCompositeRect(reference, getOffsetParent(popper), state.options.strategy === 'fixed'),\n          popper: getLayoutRect(popper)\n        }; // Modifiers have the ability to reset the current update cycle. The\n        // most common use case for this is the `flip` modifier changing the\n        // placement, which then needs to re-run all the modifiers, because the\n        // logic was previously ran for the previous placement and is therefore\n        // stale/incorrect\n\n        state.reset = false;\n        state.placement = state.options.placement; // On each update cycle, the `modifiersData` property for each modifier\n        // is filled with the initial data specified by the modifier. This means\n        // it doesn't persist and is fresh on each update.\n        // To ensure persistent data, use `${name}#persistent`\n\n        state.orderedModifiers.forEach(function (modifier) {\n          return state.modifiersData[modifier.name] = Object.assign({}, modifier.data);\n        });\n\n        for (var index = 0; index < state.orderedModifiers.length; index++) {\n          if (state.reset === true) {\n            state.reset = false;\n            index = -1;\n            continue;\n          }\n\n          var _state$orderedModifie = state.orderedModifiers[index],\n              fn = _state$orderedModifie.fn,\n              _state$orderedModifie2 = _state$orderedModifie.options,\n              _options = _state$orderedModifie2 === void 0 ? {} : _state$orderedModifie2,\n              name = _state$orderedModifie.name;\n\n          if (typeof fn === 'function') {\n            state = fn({\n              state: state,\n              options: _options,\n              name: name,\n              instance: instance\n            }) || state;\n          }\n        }\n      },\n      // Async and optimistically optimized update  it will not be executed if\n      // not necessary (debounced to run at most once-per-tick)\n      update: debounce(function () {\n        return new Promise(function (resolve) {\n          instance.forceUpdate();\n          resolve(state);\n        });\n      }),\n      destroy: function destroy() {\n        cleanupModifierEffects();\n        isDestroyed = true;\n      }\n    };\n\n    if (!areValidElements(reference, popper)) {\n      return instance;\n    }\n\n    instance.setOptions(options).then(function (state) {\n      if (!isDestroyed && options.onFirstUpdate) {\n        options.onFirstUpdate(state);\n      }\n    }); // Modifiers have the ability to execute arbitrary code before the first\n    // update cycle runs. They will be executed in the same order as the update\n    // cycle. This is useful when a modifier adds some persistent data that\n    // other modifiers need to use, but the modifier is run after the dependent\n    // one.\n\n    function runModifierEffects() {\n      state.orderedModifiers.forEach(function (_ref) {\n        var name = _ref.name,\n            _ref$options = _ref.options,\n            options = _ref$options === void 0 ? {} : _ref$options,\n            effect = _ref.effect;\n\n        if (typeof effect === 'function') {\n          var cleanupFn = effect({\n            state: state,\n            name: name,\n            instance: instance,\n            options: options\n          });\n\n          var noopFn = function noopFn() {};\n\n          effectCleanupFns.push(cleanupFn || noopFn);\n        }\n      });\n    }\n\n    function cleanupModifierEffects() {\n      effectCleanupFns.forEach(function (fn) {\n        return fn();\n      });\n      effectCleanupFns = [];\n    }\n\n    return instance;\n  };\n}\nexport var createPopper = /*#__PURE__*/popperGenerator(); // eslint-disable-next-line import/no-unused-modules\n\nexport { detectOverflow };","import getWindow from \"../dom-utils/getWindow.js\"; // eslint-disable-next-line import/no-unused-modules\n\nvar passive = {\n  passive: true\n};\n\nfunction effect(_ref) {\n  var state = _ref.state,\n      instance = _ref.instance,\n      options = _ref.options;\n  var _options$scroll = options.scroll,\n      scroll = _options$scroll === void 0 ? true : _options$scroll,\n      _options$resize = options.resize,\n      resize = _options$resize === void 0 ? true : _options$resize;\n  var window = getWindow(state.elements.popper);\n  var scrollParents = [].concat(state.scrollParents.reference, state.scrollParents.popper);\n\n  if (scroll) {\n    scrollParents.forEach(function (scrollParent) {\n      scrollParent.addEventListener('scroll', instance.update, passive);\n    });\n  }\n\n  if (resize) {\n    window.addEventListener('resize', instance.update, passive);\n  }\n\n  return function () {\n    if (scroll) {\n      scrollParents.forEach(function (scrollParent) {\n        scrollParent.removeEventListener('scroll', instance.update, passive);\n      });\n    }\n\n    if (resize) {\n      window.removeEventListener('resize', instance.update, passive);\n    }\n  };\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'eventListeners',\n  enabled: true,\n  phase: 'write',\n  fn: function fn() {},\n  effect: effect,\n  data: {}\n};","import { auto } from \"../enums.js\";\nexport default function getBasePlacement(placement) {\n  return placement.split('-')[0];\n}","export default function getVariation(placement) {\n  return placement.split('-')[1];\n}","export default function getMainAxisFromPlacement(placement) {\n  return ['top', 'bottom'].indexOf(placement) >= 0 ? 'x' : 'y';\n}","import getBasePlacement from \"./getBasePlacement.js\";\nimport getVariation from \"./getVariation.js\";\nimport getMainAxisFromPlacement from \"./getMainAxisFromPlacement.js\";\nimport { top, right, bottom, left, start, end } from \"../enums.js\";\nexport default function computeOffsets(_ref) {\n  var reference = _ref.reference,\n      element = _ref.element,\n      placement = _ref.placement;\n  var basePlacement = placement ? getBasePlacement(placement) : null;\n  var variation = placement ? getVariation(placement) : null;\n  var commonX = reference.x + reference.width / 2 - element.width / 2;\n  var commonY = reference.y + reference.height / 2 - element.height / 2;\n  var offsets;\n\n  switch (basePlacement) {\n    case top:\n      offsets = {\n        x: commonX,\n        y: reference.y - element.height\n      };\n      break;\n\n    case bottom:\n      offsets = {\n        x: commonX,\n        y: reference.y + reference.height\n      };\n      break;\n\n    case right:\n      offsets = {\n        x: reference.x + reference.width,\n        y: commonY\n      };\n      break;\n\n    case left:\n      offsets = {\n        x: reference.x - element.width,\n        y: commonY\n      };\n      break;\n\n    default:\n      offsets = {\n        x: reference.x,\n        y: reference.y\n      };\n  }\n\n  var mainAxis = basePlacement ? getMainAxisFromPlacement(basePlacement) : null;\n\n  if (mainAxis != null) {\n    var len = mainAxis === 'y' ? 'height' : 'width';\n\n    switch (variation) {\n      case start:\n        offsets[mainAxis] = offsets[mainAxis] - (reference[len] / 2 - element[len] / 2);\n        break;\n\n      case end:\n        offsets[mainAxis] = offsets[mainAxis] + (reference[len] / 2 - element[len] / 2);\n        break;\n\n      default:\n    }\n  }\n\n  return offsets;\n}","import computeOffsets from \"../utils/computeOffsets.js\";\n\nfunction popperOffsets(_ref) {\n  var state = _ref.state,\n      name = _ref.name;\n  // Offsets are the actual position the popper needs to have to be\n  // properly positioned near its reference element\n  // This is the most basic placement, and will be adjusted by\n  // the modifiers in the next step\n  state.modifiersData[name] = computeOffsets({\n    reference: state.rects.reference,\n    element: state.rects.popper,\n    strategy: 'absolute',\n    placement: state.placement\n  });\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'popperOffsets',\n  enabled: true,\n  phase: 'read',\n  fn: popperOffsets,\n  data: {}\n};","import { top, left, right, bottom, end } from \"../enums.js\";\nimport getOffsetParent from \"../dom-utils/getOffsetParent.js\";\nimport getWindow from \"../dom-utils/getWindow.js\";\nimport getDocumentElement from \"../dom-utils/getDocumentElement.js\";\nimport getComputedStyle from \"../dom-utils/getComputedStyle.js\";\nimport getBasePlacement from \"../utils/getBasePlacement.js\";\nimport getVariation from \"../utils/getVariation.js\";\nimport { round } from \"../utils/math.js\"; // eslint-disable-next-line import/no-unused-modules\n\nvar unsetSides = {\n  top: 'auto',\n  right: 'auto',\n  bottom: 'auto',\n  left: 'auto'\n}; // Round the offsets to the nearest suitable subpixel based on the DPR.\n// Zooming can change the DPR, but it seems to report a value that will\n// cleanly divide the values into the appropriate subpixels.\n\nfunction roundOffsetsByDPR(_ref, win) {\n  var x = _ref.x,\n      y = _ref.y;\n  var dpr = win.devicePixelRatio || 1;\n  return {\n    x: round(x * dpr) / dpr || 0,\n    y: round(y * dpr) / dpr || 0\n  };\n}\n\nexport function mapToStyles(_ref2) {\n  var _Object$assign2;\n\n  var popper = _ref2.popper,\n      popperRect = _ref2.popperRect,\n      placement = _ref2.placement,\n      variation = _ref2.variation,\n      offsets = _ref2.offsets,\n      position = _ref2.position,\n      gpuAcceleration = _ref2.gpuAcceleration,\n      adaptive = _ref2.adaptive,\n      roundOffsets = _ref2.roundOffsets,\n      isFixed = _ref2.isFixed;\n  var _offsets$x = offsets.x,\n      x = _offsets$x === void 0 ? 0 : _offsets$x,\n      _offsets$y = offsets.y,\n      y = _offsets$y === void 0 ? 0 : _offsets$y;\n\n  var _ref3 = typeof roundOffsets === 'function' ? roundOffsets({\n    x: x,\n    y: y\n  }) : {\n    x: x,\n    y: y\n  };\n\n  x = _ref3.x;\n  y = _ref3.y;\n  var hasX = offsets.hasOwnProperty('x');\n  var hasY = offsets.hasOwnProperty('y');\n  var sideX = left;\n  var sideY = top;\n  var win = window;\n\n  if (adaptive) {\n    var offsetParent = getOffsetParent(popper);\n    var heightProp = 'clientHeight';\n    var widthProp = 'clientWidth';\n\n    if (offsetParent === getWindow(popper)) {\n      offsetParent = getDocumentElement(popper);\n\n      if (getComputedStyle(offsetParent).position !== 'static' && position === 'absolute') {\n        heightProp = 'scrollHeight';\n        widthProp = 'scrollWidth';\n      }\n    } // $FlowFixMe[incompatible-cast]: force type refinement, we compare offsetParent with window above, but Flow doesn't detect it\n\n\n    offsetParent = offsetParent;\n\n    if (placement === top || (placement === left || placement === right) && variation === end) {\n      sideY = bottom;\n      var offsetY = isFixed && offsetParent === win && win.visualViewport ? win.visualViewport.height : // $FlowFixMe[prop-missing]\n      offsetParent[heightProp];\n      y -= offsetY - popperRect.height;\n      y *= gpuAcceleration ? 1 : -1;\n    }\n\n    if (placement === left || (placement === top || placement === bottom) && variation === end) {\n      sideX = right;\n      var offsetX = isFixed && offsetParent === win && win.visualViewport ? win.visualViewport.width : // $FlowFixMe[prop-missing]\n      offsetParent[widthProp];\n      x -= offsetX - popperRect.width;\n      x *= gpuAcceleration ? 1 : -1;\n    }\n  }\n\n  var commonStyles = Object.assign({\n    position: position\n  }, adaptive && unsetSides);\n\n  var _ref4 = roundOffsets === true ? roundOffsetsByDPR({\n    x: x,\n    y: y\n  }, getWindow(popper)) : {\n    x: x,\n    y: y\n  };\n\n  x = _ref4.x;\n  y = _ref4.y;\n\n  if (gpuAcceleration) {\n    var _Object$assign;\n\n    return Object.assign({}, commonStyles, (_Object$assign = {}, _Object$assign[sideY] = hasY ? '0' : '', _Object$assign[sideX] = hasX ? '0' : '', _Object$assign.transform = (win.devicePixelRatio || 1) <= 1 ? \"translate(\" + x + \"px, \" + y + \"px)\" : \"translate3d(\" + x + \"px, \" + y + \"px, 0)\", _Object$assign));\n  }\n\n  return Object.assign({}, commonStyles, (_Object$assign2 = {}, _Object$assign2[sideY] = hasY ? y + \"px\" : '', _Object$assign2[sideX] = hasX ? x + \"px\" : '', _Object$assign2.transform = '', _Object$assign2));\n}\n\nfunction computeStyles(_ref5) {\n  var state = _ref5.state,\n      options = _ref5.options;\n  var _options$gpuAccelerat = options.gpuAcceleration,\n      gpuAcceleration = _options$gpuAccelerat === void 0 ? true : _options$gpuAccelerat,\n      _options$adaptive = options.adaptive,\n      adaptive = _options$adaptive === void 0 ? true : _options$adaptive,\n      _options$roundOffsets = options.roundOffsets,\n      roundOffsets = _options$roundOffsets === void 0 ? true : _options$roundOffsets;\n  var commonStyles = {\n    placement: getBasePlacement(state.placement),\n    variation: getVariation(state.placement),\n    popper: state.elements.popper,\n    popperRect: state.rects.popper,\n    gpuAcceleration: gpuAcceleration,\n    isFixed: state.options.strategy === 'fixed'\n  };\n\n  if (state.modifiersData.popperOffsets != null) {\n    state.styles.popper = Object.assign({}, state.styles.popper, mapToStyles(Object.assign({}, commonStyles, {\n      offsets: state.modifiersData.popperOffsets,\n      position: state.options.strategy,\n      adaptive: adaptive,\n      roundOffsets: roundOffsets\n    })));\n  }\n\n  if (state.modifiersData.arrow != null) {\n    state.styles.arrow = Object.assign({}, state.styles.arrow, mapToStyles(Object.assign({}, commonStyles, {\n      offsets: state.modifiersData.arrow,\n      position: 'absolute',\n      adaptive: false,\n      roundOffsets: roundOffsets\n    })));\n  }\n\n  state.attributes.popper = Object.assign({}, state.attributes.popper, {\n    'data-popper-placement': state.placement\n  });\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'computeStyles',\n  enabled: true,\n  phase: 'beforeWrite',\n  fn: computeStyles,\n  data: {}\n};","import getNodeName from \"../dom-utils/getNodeName.js\";\nimport { isHTMLElement } from \"../dom-utils/instanceOf.js\"; // This modifier takes the styles prepared by the `computeStyles` modifier\n// and applies them to the HTMLElements such as popper and arrow\n\nfunction applyStyles(_ref) {\n  var state = _ref.state;\n  Object.keys(state.elements).forEach(function (name) {\n    var style = state.styles[name] || {};\n    var attributes = state.attributes[name] || {};\n    var element = state.elements[name]; // arrow is optional + virtual elements\n\n    if (!isHTMLElement(element) || !getNodeName(element)) {\n      return;\n    } // Flow doesn't support to extend this property, but it's the most\n    // effective way to apply styles to an HTMLElement\n    // $FlowFixMe[cannot-write]\n\n\n    Object.assign(element.style, style);\n    Object.keys(attributes).forEach(function (name) {\n      var value = attributes[name];\n\n      if (value === false) {\n        element.removeAttribute(name);\n      } else {\n        element.setAttribute(name, value === true ? '' : value);\n      }\n    });\n  });\n}\n\nfunction effect(_ref2) {\n  var state = _ref2.state;\n  var initialStyles = {\n    popper: {\n      position: state.options.strategy,\n      left: '0',\n      top: '0',\n      margin: '0'\n    },\n    arrow: {\n      position: 'absolute'\n    },\n    reference: {}\n  };\n  Object.assign(state.elements.popper.style, initialStyles.popper);\n  state.styles = initialStyles;\n\n  if (state.elements.arrow) {\n    Object.assign(state.elements.arrow.style, initialStyles.arrow);\n  }\n\n  return function () {\n    Object.keys(state.elements).forEach(function (name) {\n      var element = state.elements[name];\n      var attributes = state.attributes[name] || {};\n      var styleProperties = Object.keys(state.styles.hasOwnProperty(name) ? state.styles[name] : initialStyles[name]); // Set all values to an empty string to unset them\n\n      var style = styleProperties.reduce(function (style, property) {\n        style[property] = '';\n        return style;\n      }, {}); // arrow is optional + virtual elements\n\n      if (!isHTMLElement(element) || !getNodeName(element)) {\n        return;\n      }\n\n      Object.assign(element.style, style);\n      Object.keys(attributes).forEach(function (attribute) {\n        element.removeAttribute(attribute);\n      });\n    });\n  };\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'applyStyles',\n  enabled: true,\n  phase: 'write',\n  fn: applyStyles,\n  effect: effect,\n  requires: ['computeStyles']\n};","import getBasePlacement from \"../utils/getBasePlacement.js\";\nimport { top, left, right, placements } from \"../enums.js\"; // eslint-disable-next-line import/no-unused-modules\n\nexport function distanceAndSkiddingToXY(placement, rects, offset) {\n  var basePlacement = getBasePlacement(placement);\n  var invertDistance = [left, top].indexOf(basePlacement) >= 0 ? -1 : 1;\n\n  var _ref = typeof offset === 'function' ? offset(Object.assign({}, rects, {\n    placement: placement\n  })) : offset,\n      skidding = _ref[0],\n      distance = _ref[1];\n\n  skidding = skidding || 0;\n  distance = (distance || 0) * invertDistance;\n  return [left, right].indexOf(basePlacement) >= 0 ? {\n    x: distance,\n    y: skidding\n  } : {\n    x: skidding,\n    y: distance\n  };\n}\n\nfunction offset(_ref2) {\n  var state = _ref2.state,\n      options = _ref2.options,\n      name = _ref2.name;\n  var _options$offset = options.offset,\n      offset = _options$offset === void 0 ? [0, 0] : _options$offset;\n  var data = placements.reduce(function (acc, placement) {\n    acc[placement] = distanceAndSkiddingToXY(placement, state.rects, offset);\n    return acc;\n  }, {});\n  var _data$state$placement = data[state.placement],\n      x = _data$state$placement.x,\n      y = _data$state$placement.y;\n\n  if (state.modifiersData.popperOffsets != null) {\n    state.modifiersData.popperOffsets.x += x;\n    state.modifiersData.popperOffsets.y += y;\n  }\n\n  state.modifiersData[name] = data;\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'offset',\n  enabled: true,\n  phase: 'main',\n  requires: ['popperOffsets'],\n  fn: offset\n};","var hash = {\n  left: 'right',\n  right: 'left',\n  bottom: 'top',\n  top: 'bottom'\n};\nexport default function getOppositePlacement(placement) {\n  return placement.replace(/left|right|bottom|top/g, function (matched) {\n    return hash[matched];\n  });\n}","var hash = {\n  start: 'end',\n  end: 'start'\n};\nexport default function getOppositeVariationPlacement(placement) {\n  return placement.replace(/start|end/g, function (matched) {\n    return hash[matched];\n  });\n}","import getWindow from \"./getWindow.js\";\nimport getDocumentElement from \"./getDocumentElement.js\";\nimport getWindowScrollBarX from \"./getWindowScrollBarX.js\";\nimport isLayoutViewport from \"./isLayoutViewport.js\";\nexport default function getViewportRect(element, strategy) {\n  var win = getWindow(element);\n  var html = getDocumentElement(element);\n  var visualViewport = win.visualViewport;\n  var width = html.clientWidth;\n  var height = html.clientHeight;\n  var x = 0;\n  var y = 0;\n\n  if (visualViewport) {\n    width = visualViewport.width;\n    height = visualViewport.height;\n    var layoutViewport = isLayoutViewport();\n\n    if (layoutViewport || !layoutViewport && strategy === 'fixed') {\n      x = visualViewport.offsetLeft;\n      y = visualViewport.offsetTop;\n    }\n  }\n\n  return {\n    width: width,\n    height: height,\n    x: x + getWindowScrollBarX(element),\n    y: y\n  };\n}","import getDocumentElement from \"./getDocumentElement.js\";\nimport getComputedStyle from \"./getComputedStyle.js\";\nimport getWindowScrollBarX from \"./getWindowScrollBarX.js\";\nimport getWindowScroll from \"./getWindowScroll.js\";\nimport { max } from \"../utils/math.js\"; // Gets the entire size of the scrollable document area, even extending outside\n// of the `<html>` and `<body>` rect bounds if horizontally scrollable\n\nexport default function getDocumentRect(element) {\n  var _element$ownerDocumen;\n\n  var html = getDocumentElement(element);\n  var winScroll = getWindowScroll(element);\n  var body = (_element$ownerDocumen = element.ownerDocument) == null ? void 0 : _element$ownerDocumen.body;\n  var width = max(html.scrollWidth, html.clientWidth, body ? body.scrollWidth : 0, body ? body.clientWidth : 0);\n  var height = max(html.scrollHeight, html.clientHeight, body ? body.scrollHeight : 0, body ? body.clientHeight : 0);\n  var x = -winScroll.scrollLeft + getWindowScrollBarX(element);\n  var y = -winScroll.scrollTop;\n\n  if (getComputedStyle(body || html).direction === 'rtl') {\n    x += max(html.clientWidth, body ? body.clientWidth : 0) - width;\n  }\n\n  return {\n    width: width,\n    height: height,\n    x: x,\n    y: y\n  };\n}","import { isShadowRoot } from \"./instanceOf.js\";\nexport default function contains(parent, child) {\n  var rootNode = child.getRootNode && child.getRootNode(); // First, attempt with faster native method\n\n  if (parent.contains(child)) {\n    return true;\n  } // then fallback to custom implementation with Shadow DOM support\n  else if (rootNode && isShadowRoot(rootNode)) {\n      var next = child;\n\n      do {\n        if (next && parent.isSameNode(next)) {\n          return true;\n        } // $FlowFixMe[prop-missing]: need a better way to handle this...\n\n\n        next = next.parentNode || next.host;\n      } while (next);\n    } // Give up, the result is false\n\n\n  return false;\n}","export default function rectToClientRect(rect) {\n  return Object.assign({}, rect, {\n    left: rect.x,\n    top: rect.y,\n    right: rect.x + rect.width,\n    bottom: rect.y + rect.height\n  });\n}","import { viewport } from \"../enums.js\";\nimport getViewportRect from \"./getViewportRect.js\";\nimport getDocumentRect from \"./getDocumentRect.js\";\nimport listScrollParents from \"./listScrollParents.js\";\nimport getOffsetParent from \"./getOffsetParent.js\";\nimport getDocumentElement from \"./getDocumentElement.js\";\nimport getComputedStyle from \"./getComputedStyle.js\";\nimport { isElement, isHTMLElement } from \"./instanceOf.js\";\nimport getBoundingClientRect from \"./getBoundingClientRect.js\";\nimport getParentNode from \"./getParentNode.js\";\nimport contains from \"./contains.js\";\nimport getNodeName from \"./getNodeName.js\";\nimport rectToClientRect from \"../utils/rectToClientRect.js\";\nimport { max, min } from \"../utils/math.js\";\n\nfunction getInnerBoundingClientRect(element, strategy) {\n  var rect = getBoundingClientRect(element, false, strategy === 'fixed');\n  rect.top = rect.top + element.clientTop;\n  rect.left = rect.left + element.clientLeft;\n  rect.bottom = rect.top + element.clientHeight;\n  rect.right = rect.left + element.clientWidth;\n  rect.width = element.clientWidth;\n  rect.height = element.clientHeight;\n  rect.x = rect.left;\n  rect.y = rect.top;\n  return rect;\n}\n\nfunction getClientRectFromMixedType(element, clippingParent, strategy) {\n  return clippingParent === viewport ? rectToClientRect(getViewportRect(element, strategy)) : isElement(clippingParent) ? getInnerBoundingClientRect(clippingParent, strategy) : rectToClientRect(getDocumentRect(getDocumentElement(element)));\n} // A \"clipping parent\" is an overflowable container with the characteristic of\n// clipping (or hiding) overflowing elements with a position different from\n// `initial`\n\n\nfunction getClippingParents(element) {\n  var clippingParents = listScrollParents(getParentNode(element));\n  var canEscapeClipping = ['absolute', 'fixed'].indexOf(getComputedStyle(element).position) >= 0;\n  var clipperElement = canEscapeClipping && isHTMLElement(element) ? getOffsetParent(element) : element;\n\n  if (!isElement(clipperElement)) {\n    return [];\n  } // $FlowFixMe[incompatible-return]: https://github.com/facebook/flow/issues/1414\n\n\n  return clippingParents.filter(function (clippingParent) {\n    return isElement(clippingParent) && contains(clippingParent, clipperElement) && getNodeName(clippingParent) !== 'body';\n  });\n} // Gets the maximum area that the element is visible in due to any number of\n// clipping parents\n\n\nexport default function getClippingRect(element, boundary, rootBoundary, strategy) {\n  var mainClippingParents = boundary === 'clippingParents' ? getClippingParents(element) : [].concat(boundary);\n  var clippingParents = [].concat(mainClippingParents, [rootBoundary]);\n  var firstClippingParent = clippingParents[0];\n  var clippingRect = clippingParents.reduce(function (accRect, clippingParent) {\n    var rect = getClientRectFromMixedType(element, clippingParent, strategy);\n    accRect.top = max(rect.top, accRect.top);\n    accRect.right = min(rect.right, accRect.right);\n    accRect.bottom = min(rect.bottom, accRect.bottom);\n    accRect.left = max(rect.left, accRect.left);\n    return accRect;\n  }, getClientRectFromMixedType(element, firstClippingParent, strategy));\n  clippingRect.width = clippingRect.right - clippingRect.left;\n  clippingRect.height = clippingRect.bottom - clippingRect.top;\n  clippingRect.x = clippingRect.left;\n  clippingRect.y = clippingRect.top;\n  return clippingRect;\n}","export default function getFreshSideObject() {\n  return {\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0\n  };\n}","import getFreshSideObject from \"./getFreshSideObject.js\";\nexport default function mergePaddingObject(paddingObject) {\n  return Object.assign({}, getFreshSideObject(), paddingObject);\n}","export default function expandToHashMap(value, keys) {\n  return keys.reduce(function (hashMap, key) {\n    hashMap[key] = value;\n    return hashMap;\n  }, {});\n}","import getClippingRect from \"../dom-utils/getClippingRect.js\";\nimport getDocumentElement from \"../dom-utils/getDocumentElement.js\";\nimport getBoundingClientRect from \"../dom-utils/getBoundingClientRect.js\";\nimport computeOffsets from \"./computeOffsets.js\";\nimport rectToClientRect from \"./rectToClientRect.js\";\nimport { clippingParents, reference, popper, bottom, top, right, basePlacements, viewport } from \"../enums.js\";\nimport { isElement } from \"../dom-utils/instanceOf.js\";\nimport mergePaddingObject from \"./mergePaddingObject.js\";\nimport expandToHashMap from \"./expandToHashMap.js\"; // eslint-disable-next-line import/no-unused-modules\n\nexport default function detectOverflow(state, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var _options = options,\n      _options$placement = _options.placement,\n      placement = _options$placement === void 0 ? state.placement : _options$placement,\n      _options$strategy = _options.strategy,\n      strategy = _options$strategy === void 0 ? state.strategy : _options$strategy,\n      _options$boundary = _options.boundary,\n      boundary = _options$boundary === void 0 ? clippingParents : _options$boundary,\n      _options$rootBoundary = _options.rootBoundary,\n      rootBoundary = _options$rootBoundary === void 0 ? viewport : _options$rootBoundary,\n      _options$elementConte = _options.elementContext,\n      elementContext = _options$elementConte === void 0 ? popper : _options$elementConte,\n      _options$altBoundary = _options.altBoundary,\n      altBoundary = _options$altBoundary === void 0 ? false : _options$altBoundary,\n      _options$padding = _options.padding,\n      padding = _options$padding === void 0 ? 0 : _options$padding;\n  var paddingObject = mergePaddingObject(typeof padding !== 'number' ? padding : expandToHashMap(padding, basePlacements));\n  var altContext = elementContext === popper ? reference : popper;\n  var popperRect = state.rects.popper;\n  var element = state.elements[altBoundary ? altContext : elementContext];\n  var clippingClientRect = getClippingRect(isElement(element) ? element : element.contextElement || getDocumentElement(state.elements.popper), boundary, rootBoundary, strategy);\n  var referenceClientRect = getBoundingClientRect(state.elements.reference);\n  var popperOffsets = computeOffsets({\n    reference: referenceClientRect,\n    element: popperRect,\n    strategy: 'absolute',\n    placement: placement\n  });\n  var popperClientRect = rectToClientRect(Object.assign({}, popperRect, popperOffsets));\n  var elementClientRect = elementContext === popper ? popperClientRect : referenceClientRect; // positive = overflowing the clipping rect\n  // 0 or negative = within the clipping rect\n\n  var overflowOffsets = {\n    top: clippingClientRect.top - elementClientRect.top + paddingObject.top,\n    bottom: elementClientRect.bottom - clippingClientRect.bottom + paddingObject.bottom,\n    left: clippingClientRect.left - elementClientRect.left + paddingObject.left,\n    right: elementClientRect.right - clippingClientRect.right + paddingObject.right\n  };\n  var offsetData = state.modifiersData.offset; // Offsets can be applied only to the popper element\n\n  if (elementContext === popper && offsetData) {\n    var offset = offsetData[placement];\n    Object.keys(overflowOffsets).forEach(function (key) {\n      var multiply = [right, bottom].indexOf(key) >= 0 ? 1 : -1;\n      var axis = [top, bottom].indexOf(key) >= 0 ? 'y' : 'x';\n      overflowOffsets[key] += offset[axis] * multiply;\n    });\n  }\n\n  return overflowOffsets;\n}","import getVariation from \"./getVariation.js\";\nimport { variationPlacements, basePlacements, placements as allPlacements } from \"../enums.js\";\nimport detectOverflow from \"./detectOverflow.js\";\nimport getBasePlacement from \"./getBasePlacement.js\";\nexport default function computeAutoPlacement(state, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var _options = options,\n      placement = _options.placement,\n      boundary = _options.boundary,\n      rootBoundary = _options.rootBoundary,\n      padding = _options.padding,\n      flipVariations = _options.flipVariations,\n      _options$allowedAutoP = _options.allowedAutoPlacements,\n      allowedAutoPlacements = _options$allowedAutoP === void 0 ? allPlacements : _options$allowedAutoP;\n  var variation = getVariation(placement);\n  var placements = variation ? flipVariations ? variationPlacements : variationPlacements.filter(function (placement) {\n    return getVariation(placement) === variation;\n  }) : basePlacements;\n  var allowedPlacements = placements.filter(function (placement) {\n    return allowedAutoPlacements.indexOf(placement) >= 0;\n  });\n\n  if (allowedPlacements.length === 0) {\n    allowedPlacements = placements;\n  } // $FlowFixMe[incompatible-type]: Flow seems to have problems with two array unions...\n\n\n  var overflows = allowedPlacements.reduce(function (acc, placement) {\n    acc[placement] = detectOverflow(state, {\n      placement: placement,\n      boundary: boundary,\n      rootBoundary: rootBoundary,\n      padding: padding\n    })[getBasePlacement(placement)];\n    return acc;\n  }, {});\n  return Object.keys(overflows).sort(function (a, b) {\n    return overflows[a] - overflows[b];\n  });\n}","import getOppositePlacement from \"../utils/getOppositePlacement.js\";\nimport getBasePlacement from \"../utils/getBasePlacement.js\";\nimport getOppositeVariationPlacement from \"../utils/getOppositeVariationPlacement.js\";\nimport detectOverflow from \"../utils/detectOverflow.js\";\nimport computeAutoPlacement from \"../utils/computeAutoPlacement.js\";\nimport { bottom, top, start, right, left, auto } from \"../enums.js\";\nimport getVariation from \"../utils/getVariation.js\"; // eslint-disable-next-line import/no-unused-modules\n\nfunction getExpandedFallbackPlacements(placement) {\n  if (getBasePlacement(placement) === auto) {\n    return [];\n  }\n\n  var oppositePlacement = getOppositePlacement(placement);\n  return [getOppositeVariationPlacement(placement), oppositePlacement, getOppositeVariationPlacement(oppositePlacement)];\n}\n\nfunction flip(_ref) {\n  var state = _ref.state,\n      options = _ref.options,\n      name = _ref.name;\n\n  if (state.modifiersData[name]._skip) {\n    return;\n  }\n\n  var _options$mainAxis = options.mainAxis,\n      checkMainAxis = _options$mainAxis === void 0 ? true : _options$mainAxis,\n      _options$altAxis = options.altAxis,\n      checkAltAxis = _options$altAxis === void 0 ? true : _options$altAxis,\n      specifiedFallbackPlacements = options.fallbackPlacements,\n      padding = options.padding,\n      boundary = options.boundary,\n      rootBoundary = options.rootBoundary,\n      altBoundary = options.altBoundary,\n      _options$flipVariatio = options.flipVariations,\n      flipVariations = _options$flipVariatio === void 0 ? true : _options$flipVariatio,\n      allowedAutoPlacements = options.allowedAutoPlacements;\n  var preferredPlacement = state.options.placement;\n  var basePlacement = getBasePlacement(preferredPlacement);\n  var isBasePlacement = basePlacement === preferredPlacement;\n  var fallbackPlacements = specifiedFallbackPlacements || (isBasePlacement || !flipVariations ? [getOppositePlacement(preferredPlacement)] : getExpandedFallbackPlacements(preferredPlacement));\n  var placements = [preferredPlacement].concat(fallbackPlacements).reduce(function (acc, placement) {\n    return acc.concat(getBasePlacement(placement) === auto ? computeAutoPlacement(state, {\n      placement: placement,\n      boundary: boundary,\n      rootBoundary: rootBoundary,\n      padding: padding,\n      flipVariations: flipVariations,\n      allowedAutoPlacements: allowedAutoPlacements\n    }) : placement);\n  }, []);\n  var referenceRect = state.rects.reference;\n  var popperRect = state.rects.popper;\n  var checksMap = new Map();\n  var makeFallbackChecks = true;\n  var firstFittingPlacement = placements[0];\n\n  for (var i = 0; i < placements.length; i++) {\n    var placement = placements[i];\n\n    var _basePlacement = getBasePlacement(placement);\n\n    var isStartVariation = getVariation(placement) === start;\n    var isVertical = [top, bottom].indexOf(_basePlacement) >= 0;\n    var len = isVertical ? 'width' : 'height';\n    var overflow = detectOverflow(state, {\n      placement: placement,\n      boundary: boundary,\n      rootBoundary: rootBoundary,\n      altBoundary: altBoundary,\n      padding: padding\n    });\n    var mainVariationSide = isVertical ? isStartVariation ? right : left : isStartVariation ? bottom : top;\n\n    if (referenceRect[len] > popperRect[len]) {\n      mainVariationSide = getOppositePlacement(mainVariationSide);\n    }\n\n    var altVariationSide = getOppositePlacement(mainVariationSide);\n    var checks = [];\n\n    if (checkMainAxis) {\n      checks.push(overflow[_basePlacement] <= 0);\n    }\n\n    if (checkAltAxis) {\n      checks.push(overflow[mainVariationSide] <= 0, overflow[altVariationSide] <= 0);\n    }\n\n    if (checks.every(function (check) {\n      return check;\n    })) {\n      firstFittingPlacement = placement;\n      makeFallbackChecks = false;\n      break;\n    }\n\n    checksMap.set(placement, checks);\n  }\n\n  if (makeFallbackChecks) {\n    // `2` may be desired in some cases  research later\n    var numberOfChecks = flipVariations ? 3 : 1;\n\n    var _loop = function _loop(_i) {\n      var fittingPlacement = placements.find(function (placement) {\n        var checks = checksMap.get(placement);\n\n        if (checks) {\n          return checks.slice(0, _i).every(function (check) {\n            return check;\n          });\n        }\n      });\n\n      if (fittingPlacement) {\n        firstFittingPlacement = fittingPlacement;\n        return \"break\";\n      }\n    };\n\n    for (var _i = numberOfChecks; _i > 0; _i--) {\n      var _ret = _loop(_i);\n\n      if (_ret === \"break\") break;\n    }\n  }\n\n  if (state.placement !== firstFittingPlacement) {\n    state.modifiersData[name]._skip = true;\n    state.placement = firstFittingPlacement;\n    state.reset = true;\n  }\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'flip',\n  enabled: true,\n  phase: 'main',\n  fn: flip,\n  requiresIfExists: ['offset'],\n  data: {\n    _skip: false\n  }\n};","export default function getAltAxis(axis) {\n  return axis === 'x' ? 'y' : 'x';\n}","import { max as mathMax, min as mathMin } from \"./math.js\";\nexport function within(min, value, max) {\n  return mathMax(min, mathMin(value, max));\n}\nexport function withinMaxClamp(min, value, max) {\n  var v = within(min, value, max);\n  return v > max ? max : v;\n}","import { top, left, right, bottom, start } from \"../enums.js\";\nimport getBasePlacement from \"../utils/getBasePlacement.js\";\nimport getMainAxisFromPlacement from \"../utils/getMainAxisFromPlacement.js\";\nimport getAltAxis from \"../utils/getAltAxis.js\";\nimport { within, withinMaxClamp } from \"../utils/within.js\";\nimport getLayoutRect from \"../dom-utils/getLayoutRect.js\";\nimport getOffsetParent from \"../dom-utils/getOffsetParent.js\";\nimport detectOverflow from \"../utils/detectOverflow.js\";\nimport getVariation from \"../utils/getVariation.js\";\nimport getFreshSideObject from \"../utils/getFreshSideObject.js\";\nimport { min as mathMin, max as mathMax } from \"../utils/math.js\";\n\nfunction preventOverflow(_ref) {\n  var state = _ref.state,\n      options = _ref.options,\n      name = _ref.name;\n  var _options$mainAxis = options.mainAxis,\n      checkMainAxis = _options$mainAxis === void 0 ? true : _options$mainAxis,\n      _options$altAxis = options.altAxis,\n      checkAltAxis = _options$altAxis === void 0 ? false : _options$altAxis,\n      boundary = options.boundary,\n      rootBoundary = options.rootBoundary,\n      altBoundary = options.altBoundary,\n      padding = options.padding,\n      _options$tether = options.tether,\n      tether = _options$tether === void 0 ? true : _options$tether,\n      _options$tetherOffset = options.tetherOffset,\n      tetherOffset = _options$tetherOffset === void 0 ? 0 : _options$tetherOffset;\n  var overflow = detectOverflow(state, {\n    boundary: boundary,\n    rootBoundary: rootBoundary,\n    padding: padding,\n    altBoundary: altBoundary\n  });\n  var basePlacement = getBasePlacement(state.placement);\n  var variation = getVariation(state.placement);\n  var isBasePlacement = !variation;\n  var mainAxis = getMainAxisFromPlacement(basePlacement);\n  var altAxis = getAltAxis(mainAxis);\n  var popperOffsets = state.modifiersData.popperOffsets;\n  var referenceRect = state.rects.reference;\n  var popperRect = state.rects.popper;\n  var tetherOffsetValue = typeof tetherOffset === 'function' ? tetherOffset(Object.assign({}, state.rects, {\n    placement: state.placement\n  })) : tetherOffset;\n  var normalizedTetherOffsetValue = typeof tetherOffsetValue === 'number' ? {\n    mainAxis: tetherOffsetValue,\n    altAxis: tetherOffsetValue\n  } : Object.assign({\n    mainAxis: 0,\n    altAxis: 0\n  }, tetherOffsetValue);\n  var offsetModifierState = state.modifiersData.offset ? state.modifiersData.offset[state.placement] : null;\n  var data = {\n    x: 0,\n    y: 0\n  };\n\n  if (!popperOffsets) {\n    return;\n  }\n\n  if (checkMainAxis) {\n    var _offsetModifierState$;\n\n    var mainSide = mainAxis === 'y' ? top : left;\n    var altSide = mainAxis === 'y' ? bottom : right;\n    var len = mainAxis === 'y' ? 'height' : 'width';\n    var offset = popperOffsets[mainAxis];\n    var min = offset + overflow[mainSide];\n    var max = offset - overflow[altSide];\n    var additive = tether ? -popperRect[len] / 2 : 0;\n    var minLen = variation === start ? referenceRect[len] : popperRect[len];\n    var maxLen = variation === start ? -popperRect[len] : -referenceRect[len]; // We need to include the arrow in the calculation so the arrow doesn't go\n    // outside the reference bounds\n\n    var arrowElement = state.elements.arrow;\n    var arrowRect = tether && arrowElement ? getLayoutRect(arrowElement) : {\n      width: 0,\n      height: 0\n    };\n    var arrowPaddingObject = state.modifiersData['arrow#persistent'] ? state.modifiersData['arrow#persistent'].padding : getFreshSideObject();\n    var arrowPaddingMin = arrowPaddingObject[mainSide];\n    var arrowPaddingMax = arrowPaddingObject[altSide]; // If the reference length is smaller than the arrow length, we don't want\n    // to include its full size in the calculation. If the reference is small\n    // and near the edge of a boundary, the popper can overflow even if the\n    // reference is not overflowing as well (e.g. virtual elements with no\n    // width or height)\n\n    var arrowLen = within(0, referenceRect[len], arrowRect[len]);\n    var minOffset = isBasePlacement ? referenceRect[len] / 2 - additive - arrowLen - arrowPaddingMin - normalizedTetherOffsetValue.mainAxis : minLen - arrowLen - arrowPaddingMin - normalizedTetherOffsetValue.mainAxis;\n    var maxOffset = isBasePlacement ? -referenceRect[len] / 2 + additive + arrowLen + arrowPaddingMax + normalizedTetherOffsetValue.mainAxis : maxLen + arrowLen + arrowPaddingMax + normalizedTetherOffsetValue.mainAxis;\n    var arrowOffsetParent = state.elements.arrow && getOffsetParent(state.elements.arrow);\n    var clientOffset = arrowOffsetParent ? mainAxis === 'y' ? arrowOffsetParent.clientTop || 0 : arrowOffsetParent.clientLeft || 0 : 0;\n    var offsetModifierValue = (_offsetModifierState$ = offsetModifierState == null ? void 0 : offsetModifierState[mainAxis]) != null ? _offsetModifierState$ : 0;\n    var tetherMin = offset + minOffset - offsetModifierValue - clientOffset;\n    var tetherMax = offset + maxOffset - offsetModifierValue;\n    var preventedOffset = within(tether ? mathMin(min, tetherMin) : min, offset, tether ? mathMax(max, tetherMax) : max);\n    popperOffsets[mainAxis] = preventedOffset;\n    data[mainAxis] = preventedOffset - offset;\n  }\n\n  if (checkAltAxis) {\n    var _offsetModifierState$2;\n\n    var _mainSide = mainAxis === 'x' ? top : left;\n\n    var _altSide = mainAxis === 'x' ? bottom : right;\n\n    var _offset = popperOffsets[altAxis];\n\n    var _len = altAxis === 'y' ? 'height' : 'width';\n\n    var _min = _offset + overflow[_mainSide];\n\n    var _max = _offset - overflow[_altSide];\n\n    var isOriginSide = [top, left].indexOf(basePlacement) !== -1;\n\n    var _offsetModifierValue = (_offsetModifierState$2 = offsetModifierState == null ? void 0 : offsetModifierState[altAxis]) != null ? _offsetModifierState$2 : 0;\n\n    var _tetherMin = isOriginSide ? _min : _offset - referenceRect[_len] - popperRect[_len] - _offsetModifierValue + normalizedTetherOffsetValue.altAxis;\n\n    var _tetherMax = isOriginSide ? _offset + referenceRect[_len] + popperRect[_len] - _offsetModifierValue - normalizedTetherOffsetValue.altAxis : _max;\n\n    var _preventedOffset = tether && isOriginSide ? withinMaxClamp(_tetherMin, _offset, _tetherMax) : within(tether ? _tetherMin : _min, _offset, tether ? _tetherMax : _max);\n\n    popperOffsets[altAxis] = _preventedOffset;\n    data[altAxis] = _preventedOffset - _offset;\n  }\n\n  state.modifiersData[name] = data;\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'preventOverflow',\n  enabled: true,\n  phase: 'main',\n  fn: preventOverflow,\n  requiresIfExists: ['offset']\n};","import getBasePlacement from \"../utils/getBasePlacement.js\";\nimport getLayoutRect from \"../dom-utils/getLayoutRect.js\";\nimport contains from \"../dom-utils/contains.js\";\nimport getOffsetParent from \"../dom-utils/getOffsetParent.js\";\nimport getMainAxisFromPlacement from \"../utils/getMainAxisFromPlacement.js\";\nimport { within } from \"../utils/within.js\";\nimport mergePaddingObject from \"../utils/mergePaddingObject.js\";\nimport expandToHashMap from \"../utils/expandToHashMap.js\";\nimport { left, right, basePlacements, top, bottom } from \"../enums.js\"; // eslint-disable-next-line import/no-unused-modules\n\nvar toPaddingObject = function toPaddingObject(padding, state) {\n  padding = typeof padding === 'function' ? padding(Object.assign({}, state.rects, {\n    placement: state.placement\n  })) : padding;\n  return mergePaddingObject(typeof padding !== 'number' ? padding : expandToHashMap(padding, basePlacements));\n};\n\nfunction arrow(_ref) {\n  var _state$modifiersData$;\n\n  var state = _ref.state,\n      name = _ref.name,\n      options = _ref.options;\n  var arrowElement = state.elements.arrow;\n  var popperOffsets = state.modifiersData.popperOffsets;\n  var basePlacement = getBasePlacement(state.placement);\n  var axis = getMainAxisFromPlacement(basePlacement);\n  var isVertical = [left, right].indexOf(basePlacement) >= 0;\n  var len = isVertical ? 'height' : 'width';\n\n  if (!arrowElement || !popperOffsets) {\n    return;\n  }\n\n  var paddingObject = toPaddingObject(options.padding, state);\n  var arrowRect = getLayoutRect(arrowElement);\n  var minProp = axis === 'y' ? top : left;\n  var maxProp = axis === 'y' ? bottom : right;\n  var endDiff = state.rects.reference[len] + state.rects.reference[axis] - popperOffsets[axis] - state.rects.popper[len];\n  var startDiff = popperOffsets[axis] - state.rects.reference[axis];\n  var arrowOffsetParent = getOffsetParent(arrowElement);\n  var clientSize = arrowOffsetParent ? axis === 'y' ? arrowOffsetParent.clientHeight || 0 : arrowOffsetParent.clientWidth || 0 : 0;\n  var centerToReference = endDiff / 2 - startDiff / 2; // Make sure the arrow doesn't overflow the popper if the center point is\n  // outside of the popper bounds\n\n  var min = paddingObject[minProp];\n  var max = clientSize - arrowRect[len] - paddingObject[maxProp];\n  var center = clientSize / 2 - arrowRect[len] / 2 + centerToReference;\n  var offset = within(min, center, max); // Prevents breaking syntax highlighting...\n\n  var axisProp = axis;\n  state.modifiersData[name] = (_state$modifiersData$ = {}, _state$modifiersData$[axisProp] = offset, _state$modifiersData$.centerOffset = offset - center, _state$modifiersData$);\n}\n\nfunction effect(_ref2) {\n  var state = _ref2.state,\n      options = _ref2.options;\n  var _options$element = options.element,\n      arrowElement = _options$element === void 0 ? '[data-popper-arrow]' : _options$element;\n\n  if (arrowElement == null) {\n    return;\n  } // CSS selector\n\n\n  if (typeof arrowElement === 'string') {\n    arrowElement = state.elements.popper.querySelector(arrowElement);\n\n    if (!arrowElement) {\n      return;\n    }\n  }\n\n  if (!contains(state.elements.popper, arrowElement)) {\n    return;\n  }\n\n  state.elements.arrow = arrowElement;\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'arrow',\n  enabled: true,\n  phase: 'main',\n  fn: arrow,\n  effect: effect,\n  requires: ['popperOffsets'],\n  requiresIfExists: ['preventOverflow']\n};","import { top, bottom, left, right } from \"../enums.js\";\nimport detectOverflow from \"../utils/detectOverflow.js\";\n\nfunction getSideOffsets(overflow, rect, preventedOffsets) {\n  if (preventedOffsets === void 0) {\n    preventedOffsets = {\n      x: 0,\n      y: 0\n    };\n  }\n\n  return {\n    top: overflow.top - rect.height - preventedOffsets.y,\n    right: overflow.right - rect.width + preventedOffsets.x,\n    bottom: overflow.bottom - rect.height + preventedOffsets.y,\n    left: overflow.left - rect.width - preventedOffsets.x\n  };\n}\n\nfunction isAnySideFullyClipped(overflow) {\n  return [top, right, bottom, left].some(function (side) {\n    return overflow[side] >= 0;\n  });\n}\n\nfunction hide(_ref) {\n  var state = _ref.state,\n      name = _ref.name;\n  var referenceRect = state.rects.reference;\n  var popperRect = state.rects.popper;\n  var preventedOffsets = state.modifiersData.preventOverflow;\n  var referenceOverflow = detectOverflow(state, {\n    elementContext: 'reference'\n  });\n  var popperAltOverflow = detectOverflow(state, {\n    altBoundary: true\n  });\n  var referenceClippingOffsets = getSideOffsets(referenceOverflow, referenceRect);\n  var popperEscapeOffsets = getSideOffsets(popperAltOverflow, popperRect, preventedOffsets);\n  var isReferenceHidden = isAnySideFullyClipped(referenceClippingOffsets);\n  var hasPopperEscaped = isAnySideFullyClipped(popperEscapeOffsets);\n  state.modifiersData[name] = {\n    referenceClippingOffsets: referenceClippingOffsets,\n    popperEscapeOffsets: popperEscapeOffsets,\n    isReferenceHidden: isReferenceHidden,\n    hasPopperEscaped: hasPopperEscaped\n  };\n  state.attributes.popper = Object.assign({}, state.attributes.popper, {\n    'data-popper-reference-hidden': isReferenceHidden,\n    'data-popper-escaped': hasPopperEscaped\n  });\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'hide',\n  enabled: true,\n  phase: 'main',\n  requiresIfExists: ['preventOverflow'],\n  fn: hide\n};","import { popperGenerator, detectOverflow } from \"./createPopper.js\";\nimport eventListeners from \"./modifiers/eventListeners.js\";\nimport popperOffsets from \"./modifiers/popperOffsets.js\";\nimport computeStyles from \"./modifiers/computeStyles.js\";\nimport applyStyles from \"./modifiers/applyStyles.js\";\nimport offset from \"./modifiers/offset.js\";\nimport flip from \"./modifiers/flip.js\";\nimport preventOverflow from \"./modifiers/preventOverflow.js\";\nimport arrow from \"./modifiers/arrow.js\";\nimport hide from \"./modifiers/hide.js\";\nvar defaultModifiers = [eventListeners, popperOffsets, computeStyles, applyStyles, offset, flip, preventOverflow, arrow, hide];\nvar createPopper = /*#__PURE__*/popperGenerator({\n  defaultModifiers: defaultModifiers\n}); // eslint-disable-next-line import/no-unused-modules\n\nexport { createPopper, popperGenerator, defaultModifiers, detectOverflow }; // eslint-disable-next-line import/no-unused-modules\n\nexport { createPopper as createPopperLite } from \"./popper-lite.js\"; // eslint-disable-next-line import/no-unused-modules\n\nexport * from \"./modifiers/index.js\";","import * as React from 'react';\n\n/**\n * Takes an argument and if it's an array, returns the first item in the array,\n * otherwise returns the argument. Used for Preact compatibility.\n */\nexport var unwrapArray = function unwrapArray(arg) {\n  return Array.isArray(arg) ? arg[0] : arg;\n};\n/**\n * Takes a maybe-undefined function and arbitrary args and invokes the function\n * only if it is defined.\n */\n\nexport var safeInvoke = function safeInvoke(fn) {\n  if (typeof fn === 'function') {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    return fn.apply(void 0, args);\n  }\n};\n/**\n * Sets a ref using either a ref callback or a ref object\n */\n\nexport var setRef = function setRef(ref, node) {\n  // if its a function call it\n  if (typeof ref === 'function') {\n    return safeInvoke(ref, node);\n  } // otherwise we should treat it as a ref object\n  else if (ref != null) {\n      ref.current = node;\n    }\n};\n/**\n * Simple ponyfill for Object.fromEntries\n */\n\nexport var fromEntries = function fromEntries(entries) {\n  return entries.reduce(function (acc, _ref) {\n    var key = _ref[0],\n        value = _ref[1];\n    acc[key] = value;\n    return acc;\n  }, {});\n};\n/**\n * Small wrapper around `useLayoutEffect` to get rid of the warning on SSR envs\n */\n\nexport var useIsomorphicLayoutEffect = typeof window !== 'undefined' && window.document && window.document.createElement ? React.useLayoutEffect : React.useEffect;","import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport { createPopper as defaultCreatePopper } from '@popperjs/core';\nimport isEqual from 'react-fast-compare';\nimport { fromEntries, useIsomorphicLayoutEffect } from './utils';\nvar EMPTY_MODIFIERS = [];\nexport var usePopper = function usePopper(referenceElement, popperElement, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var prevOptions = React.useRef(null);\n  var optionsWithDefaults = {\n    onFirstUpdate: options.onFirstUpdate,\n    placement: options.placement || 'bottom',\n    strategy: options.strategy || 'absolute',\n    modifiers: options.modifiers || EMPTY_MODIFIERS\n  };\n\n  var _React$useState = React.useState({\n    styles: {\n      popper: {\n        position: optionsWithDefaults.strategy,\n        left: '0',\n        top: '0'\n      },\n      arrow: {\n        position: 'absolute'\n      }\n    },\n    attributes: {}\n  }),\n      state = _React$useState[0],\n      setState = _React$useState[1];\n\n  var updateStateModifier = React.useMemo(function () {\n    return {\n      name: 'updateState',\n      enabled: true,\n      phase: 'write',\n      fn: function fn(_ref) {\n        var state = _ref.state;\n        var elements = Object.keys(state.elements);\n        ReactDOM.flushSync(function () {\n          setState({\n            styles: fromEntries(elements.map(function (element) {\n              return [element, state.styles[element] || {}];\n            })),\n            attributes: fromEntries(elements.map(function (element) {\n              return [element, state.attributes[element]];\n            }))\n          });\n        });\n      },\n      requires: ['computeStyles']\n    };\n  }, []);\n  var popperOptions = React.useMemo(function () {\n    var newOptions = {\n      onFirstUpdate: optionsWithDefaults.onFirstUpdate,\n      placement: optionsWithDefaults.placement,\n      strategy: optionsWithDefaults.strategy,\n      modifiers: [].concat(optionsWithDefaults.modifiers, [updateStateModifier, {\n        name: 'applyStyles',\n        enabled: false\n      }])\n    };\n\n    if (isEqual(prevOptions.current, newOptions)) {\n      return prevOptions.current || newOptions;\n    } else {\n      prevOptions.current = newOptions;\n      return newOptions;\n    }\n  }, [optionsWithDefaults.onFirstUpdate, optionsWithDefaults.placement, optionsWithDefaults.strategy, optionsWithDefaults.modifiers, updateStateModifier]);\n  var popperInstanceRef = React.useRef();\n  useIsomorphicLayoutEffect(function () {\n    if (popperInstanceRef.current) {\n      popperInstanceRef.current.setOptions(popperOptions);\n    }\n  }, [popperOptions]);\n  useIsomorphicLayoutEffect(function () {\n    if (referenceElement == null || popperElement == null) {\n      return;\n    }\n\n    var createPopper = options.createPopper || defaultCreatePopper;\n    var popperInstance = createPopper(referenceElement, popperElement, popperOptions);\n    popperInstanceRef.current = popperInstance;\n    return function () {\n      popperInstance.destroy();\n      popperInstanceRef.current = null;\n    };\n  }, [referenceElement, popperElement, options.createPopper]);\n  return {\n    state: popperInstanceRef.current ? popperInstanceRef.current.state : null,\n    styles: state.styles,\n    attributes: state.attributes,\n    update: popperInstanceRef.current ? popperInstanceRef.current.update : null,\n    forceUpdate: popperInstanceRef.current ? popperInstanceRef.current.forceUpdate : null\n  };\n};","import _objectWithoutPropertiesLoose from '@babel/runtime/helpers/esm/objectWithoutPropertiesLoose';\nimport _extends from '@babel/runtime/helpers/esm/extends';\nimport * as React from 'react';\nimport { usePopper } from 'react-popper';\n\nfunction useGetLatest(val) {\n  var ref = React.useRef(val);\n  ref.current = val;\n  return React.useCallback(function () {\n    return ref.current;\n  }, []);\n}\n\nvar noop = function noop() {// do nothing\n};\n\nfunction useControlledState(_ref) {\n  var initial = _ref.initial,\n      value = _ref.value,\n      _ref$onChange = _ref.onChange,\n      onChange = _ref$onChange === void 0 ? noop : _ref$onChange;\n\n  if (initial === undefined && value === undefined) {\n    throw new TypeError('Either \"value\" or \"initial\" variable must be set. Now both are undefined');\n  }\n\n  var _React$useState = React.useState(initial),\n      state = _React$useState[0],\n      setState = _React$useState[1];\n\n  var getLatest = useGetLatest(state);\n  var set = React.useCallback(function (updater) {\n    var state = getLatest();\n    var updatedState = typeof updater === 'function' ? updater(state) : updater;\n    if (typeof updatedState.persist === 'function') updatedState.persist();\n    setState(updatedState);\n    if (typeof onChange === 'function') onChange(updatedState);\n  }, [getLatest, onChange]);\n  var isControlled = value !== undefined;\n  return [isControlled ? value : state, isControlled ? onChange : set];\n}\nfunction generateBoundingClientRect(x, y) {\n  if (x === void 0) {\n    x = 0;\n  }\n\n  if (y === void 0) {\n    y = 0;\n  }\n\n  return function () {\n    return {\n      width: 0,\n      height: 0,\n      top: y,\n      right: x,\n      bottom: y,\n      left: x,\n      x: 0,\n      y: 0,\n      toJSON: function toJSON() {\n        return null;\n      }\n    };\n  };\n}\n\nvar _excluded = [\"styles\", \"attributes\"];\nvar virtualElement = {\n  getBoundingClientRect: generateBoundingClientRect()\n};\nvar defaultConfig = {\n  closeOnOutsideClick: true,\n  closeOnTriggerHidden: false,\n  defaultVisible: false,\n  delayHide: 0,\n  delayShow: 0,\n  followCursor: false,\n  interactive: false,\n  mutationObserverOptions: {\n    attributes: true,\n    childList: true,\n    subtree: true\n  },\n  offset: [0, 6],\n  trigger: 'hover'\n};\nfunction usePopperTooltip(config, popperOptions) {\n  var _popperProps$state, _popperProps$state$mo, _popperProps$state$mo2;\n\n  if (config === void 0) {\n    config = {};\n  }\n\n  if (popperOptions === void 0) {\n    popperOptions = {};\n  }\n\n  // Merging options with default options.\n  // Keys with undefined values are replaced with the default ones if any.\n  // Keys with other values pass through.\n  var finalConfig = Object.keys(defaultConfig).reduce(function (config, key) {\n    var _extends2;\n\n    return _extends({}, config, (_extends2 = {}, _extends2[key] = config[key] !== undefined ? config[key] : defaultConfig[key], _extends2));\n  }, config);\n  var defaultModifiers = React.useMemo(function () {\n    return [{\n      name: 'offset',\n      options: {\n        offset: finalConfig.offset\n      }\n    }];\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  Array.isArray(finalConfig.offset) ? finalConfig.offset : []);\n\n  var finalPopperOptions = _extends({}, popperOptions, {\n    placement: popperOptions.placement || finalConfig.placement,\n    modifiers: popperOptions.modifiers || defaultModifiers\n  });\n\n  var _React$useState = React.useState(null),\n      triggerRef = _React$useState[0],\n      setTriggerRef = _React$useState[1];\n\n  var _React$useState2 = React.useState(null),\n      tooltipRef = _React$useState2[0],\n      setTooltipRef = _React$useState2[1];\n\n  var _useControlledState = useControlledState({\n    initial: finalConfig.defaultVisible,\n    value: finalConfig.visible,\n    onChange: finalConfig.onVisibleChange\n  }),\n      visible = _useControlledState[0],\n      setVisible = _useControlledState[1];\n\n  var timer = React.useRef();\n  React.useEffect(function () {\n    return function () {\n      return clearTimeout(timer.current);\n    };\n  }, []);\n\n  var _usePopper = usePopper(finalConfig.followCursor ? virtualElement : triggerRef, tooltipRef, finalPopperOptions),\n      styles = _usePopper.styles,\n      attributes = _usePopper.attributes,\n      popperProps = _objectWithoutPropertiesLoose(_usePopper, _excluded);\n\n  var update = popperProps.update;\n  var getLatest = useGetLatest({\n    visible: visible,\n    triggerRef: triggerRef,\n    tooltipRef: tooltipRef,\n    finalConfig: finalConfig\n  });\n  var isTriggeredBy = React.useCallback(function (trigger) {\n    return Array.isArray(finalConfig.trigger) ? finalConfig.trigger.includes(trigger) : finalConfig.trigger === trigger;\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  Array.isArray(finalConfig.trigger) ? finalConfig.trigger : [finalConfig.trigger]);\n  var hideTooltip = React.useCallback(function () {\n    clearTimeout(timer.current);\n    timer.current = window.setTimeout(function () {\n      return setVisible(false);\n    }, finalConfig.delayHide);\n  }, [finalConfig.delayHide, setVisible]);\n  var showTooltip = React.useCallback(function () {\n    clearTimeout(timer.current);\n    timer.current = window.setTimeout(function () {\n      return setVisible(true);\n    }, finalConfig.delayShow);\n  }, [finalConfig.delayShow, setVisible]);\n  var toggleTooltip = React.useCallback(function () {\n    if (getLatest().visible) {\n      hideTooltip();\n    } else {\n      showTooltip();\n    }\n  }, [getLatest, hideTooltip, showTooltip]); // Handle click outside\n\n  React.useEffect(function () {\n    if (!getLatest().finalConfig.closeOnOutsideClick) return;\n\n    var handleClickOutside = function handleClickOutside(event) {\n      var _event$composedPath;\n\n      var _getLatest = getLatest(),\n          tooltipRef = _getLatest.tooltipRef,\n          triggerRef = _getLatest.triggerRef;\n\n      var target = (event.composedPath == null ? void 0 : (_event$composedPath = event.composedPath()) == null ? void 0 : _event$composedPath[0]) || event.target;\n\n      if (target instanceof Node) {\n        if (tooltipRef != null && triggerRef != null && !tooltipRef.contains(target) && !triggerRef.contains(target)) {\n          hideTooltip();\n        }\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return function () {\n      return document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [getLatest, hideTooltip]); // Trigger: click\n\n  React.useEffect(function () {\n    if (triggerRef == null || !isTriggeredBy('click')) return;\n    triggerRef.addEventListener('click', toggleTooltip);\n    return function () {\n      return triggerRef.removeEventListener('click', toggleTooltip);\n    };\n  }, [triggerRef, isTriggeredBy, toggleTooltip]); // Trigger: double-click\n\n  React.useEffect(function () {\n    if (triggerRef == null || !isTriggeredBy('double-click')) return;\n    triggerRef.addEventListener('dblclick', toggleTooltip);\n    return function () {\n      return triggerRef.removeEventListener('dblclick', toggleTooltip);\n    };\n  }, [triggerRef, isTriggeredBy, toggleTooltip]); // Trigger: right-click\n\n  React.useEffect(function () {\n    if (triggerRef == null || !isTriggeredBy('right-click')) return;\n\n    var preventDefaultAndToggle = function preventDefaultAndToggle(event) {\n      // Don't show the context menu\n      event.preventDefault();\n      toggleTooltip();\n    };\n\n    triggerRef.addEventListener('contextmenu', preventDefaultAndToggle);\n    return function () {\n      return triggerRef.removeEventListener('contextmenu', preventDefaultAndToggle);\n    };\n  }, [triggerRef, isTriggeredBy, toggleTooltip]); // Trigger: focus\n\n  React.useEffect(function () {\n    if (triggerRef == null || !isTriggeredBy('focus')) return;\n    triggerRef.addEventListener('focus', showTooltip);\n    triggerRef.addEventListener('blur', hideTooltip);\n    return function () {\n      triggerRef.removeEventListener('focus', showTooltip);\n      triggerRef.removeEventListener('blur', hideTooltip);\n    };\n  }, [triggerRef, isTriggeredBy, showTooltip, hideTooltip]); // Trigger: hover on trigger\n\n  React.useEffect(function () {\n    if (triggerRef == null || !isTriggeredBy('hover')) return;\n    triggerRef.addEventListener('mouseenter', showTooltip);\n    triggerRef.addEventListener('mouseleave', hideTooltip);\n    return function () {\n      triggerRef.removeEventListener('mouseenter', showTooltip);\n      triggerRef.removeEventListener('mouseleave', hideTooltip);\n    };\n  }, [triggerRef, isTriggeredBy, showTooltip, hideTooltip]); // Trigger: hover on tooltip, keep it open if hovered\n\n  React.useEffect(function () {\n    if (tooltipRef == null || !isTriggeredBy('hover') || !getLatest().finalConfig.interactive) return;\n    tooltipRef.addEventListener('mouseenter', showTooltip);\n    tooltipRef.addEventListener('mouseleave', hideTooltip);\n    return function () {\n      tooltipRef.removeEventListener('mouseenter', showTooltip);\n      tooltipRef.removeEventListener('mouseleave', hideTooltip);\n    };\n  }, [tooltipRef, isTriggeredBy, showTooltip, hideTooltip, getLatest]); // Handle closing tooltip if trigger hidden\n\n  var isReferenceHidden = popperProps == null ? void 0 : (_popperProps$state = popperProps.state) == null ? void 0 : (_popperProps$state$mo = _popperProps$state.modifiersData) == null ? void 0 : (_popperProps$state$mo2 = _popperProps$state$mo.hide) == null ? void 0 : _popperProps$state$mo2.isReferenceHidden;\n  React.useEffect(function () {\n    if (finalConfig.closeOnTriggerHidden && isReferenceHidden) hideTooltip();\n  }, [finalConfig.closeOnTriggerHidden, hideTooltip, isReferenceHidden]); // Handle follow cursor\n\n  React.useEffect(function () {\n    if (!finalConfig.followCursor || triggerRef == null) return;\n\n    function setMousePosition(_ref) {\n      var clientX = _ref.clientX,\n          clientY = _ref.clientY;\n      virtualElement.getBoundingClientRect = generateBoundingClientRect(clientX, clientY);\n      update == null ? void 0 : update();\n    }\n\n    triggerRef.addEventListener('mousemove', setMousePosition);\n    return function () {\n      return triggerRef.removeEventListener('mousemove', setMousePosition);\n    };\n  }, [finalConfig.followCursor, triggerRef, update]); // Handle tooltip DOM mutation changes (aka mutation observer)\n\n  React.useEffect(function () {\n    if (tooltipRef == null || update == null || finalConfig.mutationObserverOptions == null) return;\n    var observer = new MutationObserver(update);\n    observer.observe(tooltipRef, finalConfig.mutationObserverOptions);\n    return function () {\n      return observer.disconnect();\n    };\n  }, [finalConfig.mutationObserverOptions, tooltipRef, update]); // Tooltip props getter\n\n  var getTooltipProps = function getTooltipProps(args) {\n    if (args === void 0) {\n      args = {};\n    }\n\n    return _extends({}, args, {\n      style: _extends({}, args.style, styles.popper)\n    }, attributes.popper, {\n      'data-popper-interactive': finalConfig.interactive\n    });\n  }; // Arrow props getter\n\n\n  var getArrowProps = function getArrowProps(args) {\n    if (args === void 0) {\n      args = {};\n    }\n\n    return _extends({}, args, attributes.arrow, {\n      style: _extends({}, args.style, styles.arrow),\n      'data-popper-arrow': true\n    });\n  };\n\n  return _extends({\n    getArrowProps: getArrowProps,\n    getTooltipProps: getTooltipProps,\n    setTooltipRef: setTooltipRef,\n    setTriggerRef: setTriggerRef,\n    tooltipRef: tooltipRef,\n    triggerRef: triggerRef,\n    visible: visible\n  }, popperProps);\n}\n\nexport { usePopperTooltip };\n//# sourceMappingURL=react-popper-tooltip.js.map\n","import { css } from '@emotion/css';\nimport React, { useState } from 'react';\nimport { usePopperTooltip } from 'react-popper-tooltip';\nimport { renderMarkdown } from '@grafana/data';\nimport { useStyles2, Button, Portal } from '@grafana/ui';\nimport { FlexItem } from '../../QueryEditor/FlexItem.js';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nconst OperationInfoButton = React.memo(({ definition, operation, innerQueryPlaceholder }) => {\n  const styles = useStyles2(getStyles);\n  const [show, setShow] = useState(false);\n  const { getTooltipProps, setTooltipRef, setTriggerRef, visible } = usePopperTooltip({\n    placement: \"top\",\n    visible: show,\n    offset: [0, 16],\n    onVisibleChange: setShow,\n    interactive: true,\n    trigger: [\"click\"]\n  });\n  return /* @__PURE__ */ React.createElement(React.Fragment, null, /* @__PURE__ */ React.createElement(\n    Button,\n    {\n      title: \"Click to show description\",\n      ref: setTriggerRef,\n      icon: \"info-circle\",\n      size: \"sm\",\n      variant: \"secondary\",\n      fill: \"text\"\n    }\n  ), visible && /* @__PURE__ */ React.createElement(Portal, null, /* @__PURE__ */ React.createElement(\"div\", __spreadProps(__spreadValues({ ref: setTooltipRef }, getTooltipProps()), { className: styles.docBox }), /* @__PURE__ */ React.createElement(\"div\", { className: styles.docBoxHeader }, /* @__PURE__ */ React.createElement(\"span\", null, definition.renderer(operation, definition, innerQueryPlaceholder)), /* @__PURE__ */ React.createElement(FlexItem, { grow: 1 }), /* @__PURE__ */ React.createElement(\n    Button,\n    {\n      icon: \"times\",\n      onClick: () => setShow(false),\n      fill: \"text\",\n      variant: \"secondary\",\n      title: \"Remove operation\"\n    }\n  )), /* @__PURE__ */ React.createElement(\n    \"div\",\n    {\n      className: styles.docBoxBody,\n      dangerouslySetInnerHTML: { __html: getOperationDocs(definition, operation) }\n    }\n  ))));\n});\nOperationInfoButton.displayName = \"OperationDocs\";\nconst getStyles = (theme) => {\n  return {\n    docBox: css({\n      overflow: \"hidden\",\n      background: theme.colors.background.primary,\n      border: `1px solid ${theme.colors.border.strong}`,\n      boxShadow: theme.shadows.z3,\n      maxWidth: \"600px\",\n      padding: theme.spacing(1),\n      borderRadius: theme.shape.radius.default,\n      zIndex: theme.zIndex.tooltip\n    }),\n    docBoxHeader: css({\n      fontSize: theme.typography.h5.fontSize,\n      fontFamily: theme.typography.fontFamilyMonospace,\n      paddingBottom: theme.spacing(1),\n      display: \"flex\",\n      alignItems: \"center\"\n    }),\n    docBoxBody: css({\n      // The markdown paragraph has a marginBottom this removes it\n      marginBottom: theme.spacing(-1),\n      color: theme.colors.text.secondary\n    }),\n    signature: css({\n      fontSize: theme.typography.bodySmall.fontSize,\n      fontFamily: theme.typography.fontFamilyMonospace\n    }),\n    dropdown: css({\n      opacity: 0,\n      color: theme.colors.text.secondary\n    })\n  };\n};\nfunction getOperationDocs(def, op) {\n  var _a;\n  return renderMarkdown(def.explainHandler ? def.explainHandler(op, def) : (_a = def.documentation) != null ? _a : \"no docs\");\n}\n\nexport { OperationInfoButton };\n//# sourceMappingURL=OperationInfoButton.js.map\n","import { css } from '@emotion/css';\nimport React, { useState } from 'react';\nimport { useStyles2, Button, Select } from '@grafana/ui';\nimport { OperationInfoButton } from './OperationInfoButton.js';\nimport { FlexItem } from '../../QueryEditor/FlexItem.js';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nconst OperationHeader = React.memo(\n  ({ operation, definition, index, onChange, onRemove, queryModeller, dragHandleProps }) => {\n    var _a;\n    const styles = useStyles2(getStyles);\n    const [state, setState] = useState({});\n    const onToggleSwitcher = () => {\n      if (state.isOpen) {\n        setState(__spreadProps(__spreadValues({}, state), { isOpen: false }));\n      } else {\n        const alternatives = queryModeller.getAlternativeOperations(definition.alternativesKey).map((alt) => ({ label: alt.name, value: alt }));\n        setState({ isOpen: true, alternatives });\n      }\n    };\n    return /* @__PURE__ */ React.createElement(\"div\", { className: styles.header }, !state.isOpen && /* @__PURE__ */ React.createElement(React.Fragment, null, /* @__PURE__ */ React.createElement(\"div\", __spreadValues({}, dragHandleProps), (_a = definition.name) != null ? _a : definition.id), /* @__PURE__ */ React.createElement(FlexItem, { grow: 1 }), /* @__PURE__ */ React.createElement(\"div\", { className: `${styles.operationHeaderButtons} operation-header-show-on-hover` }, /* @__PURE__ */ React.createElement(\n      Button,\n      {\n        icon: \"angle-down\",\n        size: \"sm\",\n        onClick: onToggleSwitcher,\n        fill: \"text\",\n        variant: \"secondary\",\n        title: \"Click to view alternative operations\"\n      }\n    ), /* @__PURE__ */ React.createElement(OperationInfoButton, { definition, operation, innerQueryPlaceholder: queryModeller.innerQueryPlaceholder }), /* @__PURE__ */ React.createElement(\n      Button,\n      {\n        icon: \"times\",\n        size: \"sm\",\n        onClick: () => onRemove(index),\n        fill: \"text\",\n        variant: \"secondary\",\n        title: \"Remove operation\"\n      }\n    ))), state.isOpen && /* @__PURE__ */ React.createElement(\"div\", { className: styles.selectWrapper }, /* @__PURE__ */ React.createElement(\n      Select,\n      {\n        autoFocus: true,\n        openMenuOnFocus: true,\n        placeholder: \"Replace with\",\n        options: state.alternatives,\n        isOpen: true,\n        onCloseMenu: onToggleSwitcher,\n        onChange: (value) => {\n          if (value.value) {\n            const newDef = queryModeller.getOperationDefinition(value.value.id);\n            const newParams = [...newDef.defaultParams];\n            for (let i = 0; i < Math.min(operation.params.length, newParams.length); i++) {\n              if (newDef.params[i].type === definition.params[i].type) {\n                newParams[i] = operation.params[i];\n              }\n            }\n            const changedOp = __spreadProps(__spreadValues({}, operation), { params: newParams, id: value.value.id });\n            onChange(index, definition.changeTypeHandler ? definition.changeTypeHandler(changedOp, newDef) : changedOp);\n          }\n        }\n      }\n    )));\n  }\n);\nOperationHeader.displayName = \"OperationHeader\";\nconst getStyles = (theme) => {\n  return {\n    header: css({\n      borderBottom: `1px solid ${theme.colors.border.medium}`,\n      padding: theme.spacing(0.5, 0.5, 0.5, 1),\n      display: \"flex\",\n      alignItems: \"center\"\n    }),\n    operationHeaderButtons: css({\n      opacity: 1\n    }),\n    selectWrapper: css({\n      paddingRight: theme.spacing(2)\n    })\n  };\n};\n\nexport { OperationHeader };\n//# sourceMappingURL=OperationHeader.js.map\n","import { css } from '@emotion/css';\nimport React from 'react';\nimport { toOption } from '@grafana/data';\nimport { AutoSizeInput, Checkbox, useStyles2, Button, Select } from '@grafana/ui';\nimport { Stack } from '../../QueryEditor/Stack.js';\n\nfunction getOperationParamEditor(paramDef) {\n  if (paramDef.editor) {\n    return paramDef.editor;\n  }\n  if (paramDef.options) {\n    return SelectInputParamEditor;\n  }\n  switch (paramDef.type) {\n    case \"boolean\":\n      return BoolInputParamEditor;\n    case \"number\":\n    case \"string\":\n    default:\n      return SimpleInputParamEditor;\n  }\n}\nfunction SimpleInputParamEditor(props) {\n  var _a;\n  return /* @__PURE__ */ React.createElement(\n    AutoSizeInput,\n    {\n      id: getOperationParamId(props.operationId, props.index),\n      defaultValue: (_a = props.value) == null ? void 0 : _a.toString(),\n      minWidth: props.paramDef.minWidth,\n      placeholder: props.paramDef.placeholder,\n      title: props.paramDef.description,\n      maxWidth: (props.paramDef.minWidth || 20) * 3,\n      onCommitChange: (evt) => {\n        props.onChange(props.index, evt.currentTarget.value);\n        if (props.paramDef.runQueryOnEnter && evt.type === \"keydown\") {\n          props.onRunQuery();\n        }\n      }\n    }\n  );\n}\nfunction BoolInputParamEditor(props) {\n  return /* @__PURE__ */ React.createElement(\n    Checkbox,\n    {\n      id: getOperationParamId(props.operationId, props.index),\n      value: Boolean(props.value),\n      onChange: (evt) => props.onChange(props.index, evt.currentTarget.checked)\n    }\n  );\n}\nfunction SelectInputParamEditor({\n  paramDef,\n  value,\n  index,\n  operationId,\n  onChange\n}) {\n  var _a, _b;\n  const styles = useStyles2(getStyles);\n  let selectOptions = paramDef.options;\n  if (!((_a = selectOptions[0]) == null ? void 0 : _a.label)) {\n    selectOptions = paramDef.options.map((option) => ({\n      label: option.toString(),\n      value: option\n    }));\n  }\n  let valueOption = (_b = selectOptions.find((x) => x.value === value)) != null ? _b : toOption(value);\n  if (!value && paramDef.optional) {\n    return /* @__PURE__ */ React.createElement(\"div\", { className: styles.optionalParam }, /* @__PURE__ */ React.createElement(\n      Button,\n      {\n        size: \"sm\",\n        variant: \"secondary\",\n        title: `Add ${paramDef.name}`,\n        icon: \"plus\",\n        onClick: () => onChange(index, selectOptions[0].value)\n      },\n      paramDef.name\n    ));\n  }\n  return /* @__PURE__ */ React.createElement(Stack, { gap: 0.5, direction: \"row\", alignItems: \"center\" }, /* @__PURE__ */ React.createElement(\n    Select,\n    {\n      id: getOperationParamId(operationId, index),\n      value: valueOption,\n      options: selectOptions,\n      placeholder: paramDef.placeholder,\n      allowCustomValue: true,\n      onChange: (value2) => onChange(index, value2.value),\n      width: paramDef.minWidth || \"auto\"\n    }\n  ), paramDef.optional && /* @__PURE__ */ React.createElement(\n    Button,\n    {\n      \"data-testid\": `operations.${index}.remove-param`,\n      size: \"sm\",\n      fill: \"text\",\n      icon: \"times\",\n      variant: \"secondary\",\n      title: `Remove ${paramDef.name}`,\n      onClick: () => onChange(index, \"\")\n    }\n  ));\n}\nconst getStyles = (theme) => {\n  return {\n    optionalParam: css({\n      marginTop: theme.spacing(1)\n    })\n  };\n};\nfunction getOperationParamId(operationId, paramIndex) {\n  return `operations.${operationId}.param.${paramIndex}`;\n}\n\nexport { getOperationParamEditor, getOperationParamId };\n//# sourceMappingURL=OperationParamEditor.js.map\n","import React, { useRef, useState, useEffect } from 'react';\nimport { useTheme2, Tooltip, Icon, Button } from '@grafana/ui';\nimport { cx, css } from '@emotion/css';\nimport { OperationHeader } from './OperationHeader.js';\nimport { getOperationParamEditor, getOperationParamId } from './OperationParamEditor.js';\nimport { Stack } from '../../QueryEditor/Stack.js';\nimport { v4 } from 'uuid';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nfunction OperationEditorBody({\n  provided,\n  flash,\n  isConflicting,\n  highlight,\n  index,\n  queryModeller,\n  onChange,\n  onRemove,\n  operation,\n  definition,\n  query,\n  timeRange,\n  onRunQuery,\n  datasource\n}) {\n  const theme = useTheme2();\n  const styles = getStyles(theme, isConflicting);\n  const shouldFlash = useFlash(flash);\n  const { current: id } = useRef(v4());\n  const onParamValueChanged = (paramIdx, value) => {\n    const update = __spreadProps(__spreadValues({}, operation), { params: [...operation.params] });\n    update.params[paramIdx] = value;\n    callParamChangedThenOnChange(definition, update, index, paramIdx, onChange);\n  };\n  const onAddRestParam = () => {\n    const update = __spreadProps(__spreadValues({}, operation), { params: [...operation.params, \"\"] });\n    callParamChangedThenOnChange(definition, update, index, operation.params.length, onChange);\n  };\n  const onRemoveRestParam = (paramIdx) => {\n    const update = __spreadProps(__spreadValues({}, operation), {\n      params: [...operation.params.slice(0, paramIdx), ...operation.params.slice(paramIdx + 1)]\n    });\n    callParamChangedThenOnChange(definition, update, index, paramIdx, onChange);\n  };\n  let restParam;\n  if (definition.params.length > 0) {\n    const lastParamDef = definition.params[definition.params.length - 1];\n    if (lastParamDef.restParam) {\n      restParam = renderAddRestParamButton(lastParamDef, onAddRestParam, index, operation.params.length, styles);\n    }\n  }\n  return /* @__PURE__ */ React.createElement(\n    \"div\",\n    __spreadProps(__spreadValues({\n      className: cx(styles.card, (shouldFlash || highlight) && styles.cardHighlight, isConflicting && styles.cardError),\n      ref: provided.innerRef\n    }, provided.draggableProps), {\n      \"data-testid\": `operations.${index}.wrapper`\n    }),\n    /* @__PURE__ */ React.createElement(\n      OperationHeader,\n      {\n        operation,\n        dragHandleProps: provided.dragHandleProps,\n        definition,\n        index,\n        onChange,\n        onRemove,\n        queryModeller\n      }\n    ),\n    /* @__PURE__ */ React.createElement(\"div\", { className: styles.body }, operation.params.map((param, paramIndex) => {\n      const paramDef = definition.params[Math.min(definition.params.length - 1, paramIndex)];\n      const Editor = getOperationParamEditor(paramDef);\n      return /* @__PURE__ */ React.createElement(\"div\", { className: styles.paramRow, key: `${paramIndex}-1` }, !paramDef.hideName && /* @__PURE__ */ React.createElement(\"div\", { className: styles.paramName }, /* @__PURE__ */ React.createElement(\"label\", { htmlFor: getOperationParamId(id, paramIndex) }, paramDef.name), paramDef.description && /* @__PURE__ */ React.createElement(Tooltip, { placement: \"top\", content: paramDef.description, theme: \"info\" }, /* @__PURE__ */ React.createElement(Icon, { name: \"info-circle\", size: \"sm\", className: styles.infoIcon }))), /* @__PURE__ */ React.createElement(\"div\", { className: styles.paramValue }, /* @__PURE__ */ React.createElement(Stack, { gap: 0.5, direction: \"row\", alignItems: \"center\", wrap: false }, /* @__PURE__ */ React.createElement(\n        Editor,\n        {\n          index: paramIndex,\n          paramDef,\n          value: operation.params[paramIndex],\n          operation,\n          operationId: id,\n          onChange: onParamValueChanged,\n          onRunQuery,\n          query,\n          datasource,\n          timeRange,\n          queryModeller\n        }\n      ), paramDef.restParam && (operation.params.length > definition.params.length || paramDef.optional) && /* @__PURE__ */ React.createElement(\n        Button,\n        {\n          \"data-testid\": `operations.${index}.remove-rest-param`,\n          size: \"sm\",\n          fill: \"text\",\n          icon: \"times\",\n          variant: \"secondary\",\n          title: `Remove ${paramDef.name}`,\n          onClick: () => onRemoveRestParam(paramIndex)\n        }\n      ))));\n    })),\n    restParam,\n    index < query.operations.length - 1 && /* @__PURE__ */ React.createElement(\"div\", { className: styles.arrow }, /* @__PURE__ */ React.createElement(\"div\", { className: styles.arrowLine }), /* @__PURE__ */ React.createElement(\"div\", { className: styles.arrowArrow }))\n  );\n}\nconst getStyles = (theme, isConflicting) => {\n  return {\n    cardWrapper: css({\n      alignItems: \"stretch\"\n    }),\n    error: css({\n      marginBottom: theme.spacing(1)\n    }),\n    card: css({\n      background: theme.colors.background.primary,\n      border: `1px solid ${theme.colors.border.medium}`,\n      cursor: \"grab\",\n      borderRadius: theme.shape.radius.default,\n      position: \"relative\",\n      transition: \"all 0.5s ease-in 0s\",\n      height: isConflicting ? \"auto\" : \"100%\"\n    }),\n    cardError: css({\n      boxShadow: `0px 0px 4px 0px ${theme.colors.warning.main}`,\n      border: `1px solid ${theme.colors.warning.main}`\n    }),\n    cardHighlight: css({\n      boxShadow: `0px 0px 4px 0px ${theme.colors.primary.border}`,\n      border: `1px solid ${theme.colors.primary.border}`\n    }),\n    infoIcon: css({\n      marginLeft: theme.spacing(0.5),\n      color: theme.colors.text.secondary,\n      \":hover\": {\n        color: theme.colors.text.primary\n      }\n    }),\n    body: css({\n      margin: theme.spacing(1, 1, 0.5, 1),\n      display: \"table\"\n    }),\n    paramRow: css({\n      label: \"paramRow\",\n      display: \"table-row\",\n      verticalAlign: \"middle\"\n    }),\n    paramName: css({\n      display: \"table-cell\",\n      padding: theme.spacing(0, 1, 0, 0),\n      fontSize: theme.typography.bodySmall.fontSize,\n      fontWeight: theme.typography.fontWeightMedium,\n      verticalAlign: \"middle\",\n      height: \"32px\"\n    }),\n    paramValue: css({\n      label: \"paramValue\",\n      display: \"table-cell\",\n      verticalAlign: \"middle\"\n    }),\n    restParam: css({\n      padding: theme.spacing(0, 1, 1, 1)\n    }),\n    arrow: css({\n      position: \"absolute\",\n      top: \"0\",\n      right: \"-18px\",\n      display: \"flex\"\n    }),\n    arrowLine: css({\n      height: \"2px\",\n      width: \"8px\",\n      backgroundColor: theme.colors.border.strong,\n      position: \"relative\",\n      top: \"14px\"\n    }),\n    arrowArrow: css({\n      width: 0,\n      height: 0,\n      borderTop: `5px solid transparent`,\n      borderBottom: `5px solid transparent`,\n      borderLeft: `7px solid ${theme.colors.border.strong}`,\n      position: \"relative\",\n      top: \"10px\"\n    })\n  };\n};\nfunction useFlash(flash) {\n  const [keepFlash, setKeepFlash] = useState(true);\n  useEffect(() => {\n    let t;\n    if (flash) {\n      t = setTimeout(() => {\n        setKeepFlash(false);\n      }, 1e3);\n    } else {\n      setKeepFlash(true);\n    }\n    return () => clearTimeout(t);\n  }, [flash]);\n  return keepFlash && flash;\n}\nfunction callParamChangedThenOnChange(def, operation, operationIndex, paramIndex, onChange) {\n  if (def.paramChangedHandler) {\n    onChange(operationIndex, def.paramChangedHandler(paramIndex, operation, def));\n  } else {\n    onChange(operationIndex, operation);\n  }\n}\nfunction renderAddRestParamButton(paramDef, onAddRestParam, operationIndex, paramIndex, styles) {\n  return /* @__PURE__ */ React.createElement(\"div\", { className: styles.restParam, key: `${paramIndex}-2` }, /* @__PURE__ */ React.createElement(\n    Button,\n    {\n      size: \"sm\",\n      icon: \"plus\",\n      title: `Add ${paramDef.name}`.trimEnd(),\n      variant: \"secondary\",\n      onClick: onAddRestParam,\n      \"data-testid\": `operations.${operationIndex}.add-rest-param`\n    },\n    paramDef.name\n  ));\n}\n\nexport { OperationEditorBody };\n//# sourceMappingURL=OperationEditorBody.js.map\n","import { cx, css } from '@emotion/css';\nimport React from 'react';\nimport { Draggable } from 'react-beautiful-dnd';\nimport { useTheme2, InlineField } from '@grafana/ui';\nimport { OperationEditorBody } from './OperationEditorBody.js';\n\nfunction OperationEditor({\n  operation,\n  index,\n  onRemove,\n  onChange,\n  onRunQuery,\n  queryModeller,\n  query,\n  datasource,\n  flash,\n  highlight,\n  timeRange,\n  isConflictingOperation\n}) {\n  const def = queryModeller.getOperationDefinition(operation.id);\n  const theme = useTheme2();\n  const isConflicting = isConflictingOperation ? isConflictingOperation(operation, query.operations) : false;\n  const styles = getStyles(theme);\n  if (!def) {\n    return /* @__PURE__ */ React.createElement(\"span\", null, \"Operation \", operation.id, \" not found\");\n  }\n  const isInvalid = (isDragging) => {\n    if (isDragging) {\n      return void 0;\n    }\n    return isConflicting ? true : void 0;\n  };\n  return /* @__PURE__ */ React.createElement(Draggable, { draggableId: `operation-${index}`, index }, (provided, snapshot) => /* @__PURE__ */ React.createElement(\n    InlineField,\n    {\n      error: \"You have conflicting label filters\",\n      invalid: isInvalid(snapshot.isDragging),\n      className: cx(styles.error, styles.cardWrapper)\n    },\n    /* @__PURE__ */ React.createElement(\n      OperationEditorBody,\n      {\n        provided,\n        flash,\n        highlight,\n        isConflicting,\n        index,\n        operation,\n        definition: def,\n        onChange,\n        onRemove,\n        queryModeller,\n        query,\n        timeRange,\n        onRunQuery,\n        datasource\n      }\n    )\n  ));\n}\nconst getStyles = (theme, isConflicting) => {\n  return {\n    cardWrapper: css({\n      alignItems: \"stretch\"\n    }),\n    error: css({\n      marginBottom: theme.spacing(1)\n    })\n  };\n};\n\nexport { OperationEditor };\n//# sourceMappingURL=OperationEditor.js.map\n","import { css } from '@emotion/css';\nimport React, { useState } from 'react';\nimport { DragDropContext, Droppable } from 'react-beautiful-dnd';\nimport { useMountedState, usePrevious } from 'react-use';\nimport { useStyles2, Cascader, Button } from '@grafana/ui';\nimport { OperationEditor } from './OperationEditor.js';\nimport { Stack } from '../../QueryEditor/Stack.js';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nfunction OperationList({\n  query,\n  datasource,\n  queryModeller,\n  onChange,\n  onRunQuery,\n  highlightedOp,\n  timeRange,\n  isConflictingOperation\n}) {\n  const styles = useStyles2(getStyles);\n  const { operations } = query;\n  const opsToHighlight = useOperationsHighlight(operations);\n  const [cascaderOpen, setCascaderOpen] = useState(false);\n  const onOperationChange = (index, update) => {\n    const updatedList = [...operations];\n    updatedList.splice(index, 1, update);\n    onChange(__spreadProps(__spreadValues({}, query), { operations: updatedList }));\n  };\n  const onRemove = (index) => {\n    const updatedList = [...operations.slice(0, index), ...operations.slice(index + 1)];\n    onChange(__spreadProps(__spreadValues({}, query), { operations: updatedList }));\n  };\n  const addOptions = queryModeller.getCategories().map((category) => {\n    return {\n      value: category,\n      label: category,\n      items: queryModeller.getOperationsForCategory(category).map((operation) => ({\n        value: operation.id,\n        label: operation.name,\n        isLeaf: true\n      }))\n    };\n  });\n  const onAddOperation = (value) => {\n    const operationDef = queryModeller.getOperationDefinition(value);\n    if (!operationDef) {\n      return;\n    }\n    onChange(operationDef.addOperationHandler(operationDef, query, queryModeller));\n    setCascaderOpen(false);\n  };\n  const onDragEnd = (result) => {\n    if (!result.destination) {\n      return;\n    }\n    const updatedList = [...operations];\n    const element = updatedList[result.source.index];\n    updatedList.splice(result.source.index, 1);\n    updatedList.splice(result.destination.index, 0, element);\n    onChange(__spreadProps(__spreadValues({}, query), { operations: updatedList }));\n  };\n  const onCascaderBlur = () => {\n    setCascaderOpen(false);\n  };\n  return /* @__PURE__ */ React.createElement(Stack, { gap: 1, direction: \"column\" }, /* @__PURE__ */ React.createElement(Stack, { gap: 1 }, operations.length > 0 && /* @__PURE__ */ React.createElement(DragDropContext, { onDragEnd }, /* @__PURE__ */ React.createElement(Droppable, { droppableId: \"sortable-field-mappings\", direction: \"horizontal\" }, (provided) => /* @__PURE__ */ React.createElement(\"div\", __spreadValues({ className: styles.operationList, ref: provided.innerRef }, provided.droppableProps), operations.map((op, index) => {\n    return /* @__PURE__ */ React.createElement(\n      OperationEditor,\n      {\n        key: op.id + JSON.stringify(op.params) + index,\n        queryModeller,\n        index,\n        operation: op,\n        query,\n        datasource,\n        onChange: onOperationChange,\n        onRemove,\n        onRunQuery,\n        flash: opsToHighlight[index],\n        highlight: highlightedOp === op,\n        timeRange,\n        isConflictingOperation\n      }\n    );\n  }), provided.placeholder))), /* @__PURE__ */ React.createElement(\"div\", { className: styles.addButton }, cascaderOpen ? /* @__PURE__ */ React.createElement(\n    Cascader,\n    {\n      options: addOptions,\n      onSelect: onAddOperation,\n      onBlur: onCascaderBlur,\n      autoFocus: true,\n      alwaysOpen: true,\n      hideActiveLevelLabel: true,\n      placeholder: \"Search\"\n    }\n  ) : /* @__PURE__ */ React.createElement(Button, { icon: \"plus\", variant: \"secondary\", onClick: () => setCascaderOpen(true), title: \"Add operation\" }, \"Operations\"))));\n}\nfunction useOperationsHighlight(operations) {\n  const isMounted = useMountedState();\n  const prevOperations = usePrevious(operations);\n  if (!isMounted()) {\n    return operations.map(() => false);\n  }\n  if (!prevOperations) {\n    return operations.map(() => true);\n  }\n  let newOps = [];\n  if (prevOperations.length - 1 === operations.length && operations.every((op) => prevOperations.includes(op))) {\n    return operations.map(() => false);\n  }\n  if (prevOperations.length + 1 === operations.length && prevOperations.every((op) => operations.includes(op))) {\n    const newOp = operations.find((op) => !prevOperations.includes(op));\n    newOps = operations.map((op) => {\n      return op === newOp;\n    });\n  } else {\n    newOps = operations.map((op, index) => {\n      var _a;\n      return !isSameOp(op.id, (_a = prevOperations[index]) == null ? void 0 : _a.id);\n    });\n  }\n  return newOps;\n}\nfunction isSameOp(op1, op2) {\n  return op1 === op2 || `__${op1}_by` === op2 || op1 === `__${op2}_by`;\n}\nconst getStyles = (theme) => {\n  return {\n    heading: css({\n      label: \"heading\",\n      fontSize: 12,\n      fontWeight: theme.typography.fontWeightMedium,\n      marginBottom: 0\n    }),\n    operationList: css({\n      label: \"operationList\",\n      display: \"flex\",\n      flexWrap: \"wrap\",\n      gap: theme.spacing(2)\n    }),\n    addButton: css({\n      label: \"addButton\",\n      width: 126,\n      paddingBottom: theme.spacing(1)\n    })\n  };\n};\n\nexport { OperationList };\n//# sourceMappingURL=OperationList.js.map\n","import { css } from '@emotion/css';\nimport React, { useState, useEffect } from 'react';\nimport { reportInteraction } from '@grafana/runtime';\nimport { useStyles2, Tooltip, Button } from '@grafana/ui';\n\nconst QueryBuilderHints = ({\n  datasource,\n  query: visualQuery,\n  onChange,\n  data,\n  queryModeller,\n  buildVisualQueryFromString,\n  buildDataQueryFromQueryString,\n  buildQueryStringFromDataQuery\n}) => {\n  const [hints, setHints] = useState([]);\n  const styles = useStyles2(getStyles);\n  useEffect(() => {\n    var _a;\n    const dataQuery = buildDataQueryFromQueryString(queryModeller.renderQuery(visualQuery));\n    const hints2 = (_a = datasource.getQueryHints) == null ? void 0 : _a.call(datasource, dataQuery, (data == null ? void 0 : data.series) || []).filter((hint) => {\n      var _a2;\n      return (_a2 = hint.fix) == null ? void 0 : _a2.action;\n    });\n    setHints(hints2 != null ? hints2 : []);\n  }, [datasource, visualQuery, data, queryModeller, buildDataQueryFromQueryString]);\n  return /* @__PURE__ */ React.createElement(React.Fragment, null, hints.length > 0 && /* @__PURE__ */ React.createElement(\"div\", { className: styles.container }, hints.map((hint) => {\n    var _a, _b, _c, _d;\n    return /* @__PURE__ */ React.createElement(Tooltip, { content: `${hint.label} ${(_a = hint.fix) == null ? void 0 : _a.label}`, key: hint.type }, /* @__PURE__ */ React.createElement(\n      Button,\n      {\n        onClick: () => {\n          var _a2, _b2, _c2;\n          reportInteraction(\"grafana_query_builder_hints_clicked\", {\n            hint: hint.type,\n            datasourceType: datasource.type\n          });\n          if ((_a2 = hint == null ? void 0 : hint.fix) == null ? void 0 : _a2.action) {\n            const dataQuery = buildDataQueryFromQueryString(queryModeller.renderQuery(visualQuery));\n            const newQuery = (_b2 = datasource.modifyQuery) == null ? void 0 : _b2.call(datasource, dataQuery, hint.fix.action);\n            if (newQuery) {\n              const newVisualQuery = buildVisualQueryFromString((_c2 = buildQueryStringFromDataQuery(newQuery)) != null ? _c2 : \"\");\n              return onChange(newVisualQuery.query);\n            }\n          }\n        },\n        fill: \"outline\",\n        size: \"sm\",\n        className: styles.hint\n      },\n      \"hint: \",\n      ((_b = hint.fix) == null ? void 0 : _b.title) || ((_d = (_c = hint.fix) == null ? void 0 : _c.action) == null ? void 0 : _d.type.toLowerCase().replace(\"_\", \" \"))\n    ));\n  })));\n};\nQueryBuilderHints.displayName = \"QueryBuilderHints\";\nconst getStyles = (theme) => {\n  return {\n    container: css`\n      display: flex;\n      align-items: start;\n    `,\n    hint: css`\n      margin-right: ${theme.spacing(1)};\n    `\n  };\n};\n\nexport { QueryBuilderHints };\n//# sourceMappingURL=QueryBuilderHints.js.map\n","import React from 'react';\nimport { OperationExplainedBox } from './OperationExplainedBox.js';\nimport { RawQuery } from './RawQuery.js';\n\nfunction OperationListExplained({\n  query,\n  queryModeller,\n  stepNumber,\n  language,\n  onMouseEnter,\n  onMouseLeave\n}) {\n  return /* @__PURE__ */ React.createElement(React.Fragment, null, query.operations.map((op, index) => {\n    var _a;\n    const def = queryModeller.getOperationDefinition(op.id);\n    if (!def) {\n      return `Operation ${op.id} not found`;\n    }\n    const title = def.renderer(op, def, queryModeller.innerQueryPlaceholder);\n    const body = def.explainHandler ? def.explainHandler(op, def) : (_a = def.documentation) != null ? _a : \"no docs\";\n    return /* @__PURE__ */ React.createElement(\n      \"div\",\n      {\n        key: index,\n        onMouseEnter: () => onMouseEnter == null ? void 0 : onMouseEnter(op, index),\n        onMouseLeave: () => onMouseLeave == null ? void 0 : onMouseLeave(op, index)\n      },\n      /* @__PURE__ */ React.createElement(\n        OperationExplainedBox,\n        {\n          stepNumber: index + stepNumber,\n          title: /* @__PURE__ */ React.createElement(RawQuery, { query: title, language }),\n          markdown: body\n        }\n      )\n    );\n  }));\n}\n\nexport { OperationListExplained };\n//# sourceMappingURL=OperationListExplained.js.map\n","import { memo } from 'react';\n\nimport { OperationExplainedBox, OperationListExplained, RawQuery } from '@grafana/experimental';\nimport { Stack } from '@grafana/ui';\n\nimport { lokiGrammar } from '../../syntax';\nimport { lokiQueryModeller } from '../LokiQueryModeller';\nimport { buildVisualQueryFromString } from '../parsing';\nimport { LokiVisualQuery } from '../types';\n\nexport const EXPLAIN_LABEL_FILTER_CONTENT = 'Fetch all log lines matching label filters.';\n\nexport interface Props {\n  query: string;\n}\n\nexport const LokiQueryBuilderExplained = memo<Props>(({ query }) => {\n  const visQuery = buildVisualQueryFromString(query || '').query;\n  const lang = { grammar: lokiGrammar, name: 'lokiql' };\n\n  return (\n    <Stack gap={0} direction=\"column\">\n      <OperationExplainedBox\n        stepNumber={1}\n        title={<RawQuery query={`${lokiQueryModeller.renderLabels(visQuery.labels)}`} language={lang} />}\n      >\n        {EXPLAIN_LABEL_FILTER_CONTENT}\n      </OperationExplainedBox>\n      <OperationListExplained<LokiVisualQuery>\n        stepNumber={2}\n        queryModeller={lokiQueryModeller}\n        query={visQuery}\n        language={lang}\n      />\n    </Stack>\n  );\n});\n\nLokiQueryBuilderExplained.displayName = 'LokiQueryBuilderExplained';\n","import { css } from '@emotion/css';\nimport { memo } from 'react';\n\nimport { GrafanaTheme2, toOption } from '@grafana/data';\nimport { EditorRows, FlexItem } from '@grafana/experimental';\nimport { AutoSizeInput, IconButton, Select, useStyles2 } from '@grafana/ui';\n\nimport { LokiDatasource } from '../../datasource';\nimport { binaryScalarDefs } from '../binaryScalarOperations';\nimport { LokiVisualQueryBinary } from '../types';\n\nimport { LokiQueryBuilder } from './LokiQueryBuilder';\n\nexport interface Props {\n  nestedQuery: LokiVisualQueryBinary;\n  datasource: LokiDatasource;\n  index: number;\n  showExplain: boolean;\n  onChange: (index: number, update: LokiVisualQueryBinary) => void;\n  onRemove: (index: number) => void;\n  onRunQuery: () => void;\n}\n\nexport const NestedQuery = memo<Props>(\n  ({ nestedQuery, index, datasource, onChange, onRemove, onRunQuery, showExplain }) => {\n    const styles = useStyles2(getStyles);\n\n    return (\n      <div className={styles.card}>\n        <div className={styles.header}>\n          <div className={styles.name}>Operator</div>\n          <Select\n            aria-label=\"Select operator\"\n            width=\"auto\"\n            options={operators}\n            value={toOption(nestedQuery.operator)}\n            onChange={(value) => {\n              onChange(index, {\n                ...nestedQuery,\n                operator: value.value!,\n              });\n            }}\n          />\n          <div className={styles.name}>Vector matches</div>\n          <div className={styles.vectorMatchWrapper}>\n            <Select<LokiVisualQueryBinary['vectorMatchesType']>\n              width=\"auto\"\n              value={nestedQuery.vectorMatchesType || 'on'}\n              allowCustomValue\n              options={[\n                { value: 'on', label: 'on' },\n                { value: 'ignoring', label: 'ignoring' },\n              ]}\n              onChange={(val) => {\n                onChange(index, {\n                  ...nestedQuery,\n                  vectorMatchesType: val.value,\n                });\n              }}\n            />\n            <AutoSizeInput\n              className={styles.vectorMatchInput}\n              minWidth={20}\n              defaultValue={nestedQuery.vectorMatches}\n              onCommitChange={(evt) => {\n                onChange(index, {\n                  ...nestedQuery,\n                  vectorMatches: evt.currentTarget.value,\n                  vectorMatchesType: nestedQuery.vectorMatchesType || 'on',\n                });\n              }}\n            />\n          </div>\n          <FlexItem grow={1} />\n          <IconButton name=\"times\" size=\"sm\" onClick={() => onRemove(index)} tooltip=\"Remove nested query\" />\n        </div>\n        <div className={styles.body}>\n          <EditorRows>\n            <LokiQueryBuilder\n              showExplain={showExplain}\n              query={nestedQuery.query}\n              datasource={datasource}\n              onRunQuery={onRunQuery}\n              onChange={(update) => {\n                onChange(index, { ...nestedQuery, query: update });\n              }}\n            />\n          </EditorRows>\n        </div>\n      </div>\n    );\n  }\n);\n\nconst operators = binaryScalarDefs.map((def) => ({ label: def.sign, value: def.sign }));\n\nNestedQuery.displayName = 'NestedQuery';\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    card: css({\n      label: 'card',\n      display: 'flex',\n      flexDirection: 'column',\n      gap: theme.spacing(0.5),\n    }),\n    header: css({\n      label: 'header',\n      padding: theme.spacing(0.5, 0.5, 0.5, 1),\n      gap: theme.spacing(1),\n      display: 'flex',\n      alignItems: 'center',\n    }),\n    name: css({\n      label: 'name',\n      whiteSpace: 'nowrap',\n    }),\n    body: css({\n      label: 'body',\n      paddingLeft: theme.spacing(2),\n    }),\n    vectorMatchInput: css({\n      label: 'vectorMatchInput',\n      marginLeft: -1,\n    }),\n    vectorMatchWrapper: css({\n      label: 'vectorMatchWrapper',\n      display: 'flex',\n    }),\n  };\n};\n","import { Stack } from '@grafana/ui';\n\nimport { LokiDatasource } from '../../datasource';\nimport { LokiVisualQuery, LokiVisualQueryBinary } from '../types';\n\nimport { NestedQuery } from './NestedQuery';\n\nexport interface Props {\n  query: LokiVisualQuery;\n  datasource: LokiDatasource;\n  showExplain: boolean;\n  onChange: (query: LokiVisualQuery) => void;\n  onRunQuery: () => void;\n}\n\nexport function NestedQueryList({ query, datasource, onChange, onRunQuery, showExplain }: Props) {\n  const nestedQueries = query.binaryQueries ?? [];\n\n  const onNestedQueryUpdate = (index: number, update: LokiVisualQueryBinary) => {\n    const updatedList = [...nestedQueries];\n    updatedList.splice(index, 1, update);\n    onChange({ ...query, binaryQueries: updatedList });\n  };\n\n  const onRemove = (index: number) => {\n    const updatedList = [...nestedQueries.slice(0, index), ...nestedQueries.slice(index + 1)];\n    onChange({ ...query, binaryQueries: updatedList });\n  };\n\n  return (\n    <Stack direction=\"column\" gap={1}>\n      {nestedQueries.map((nestedQuery, index) => (\n        <NestedQuery\n          key={index.toString()}\n          nestedQuery={nestedQuery}\n          index={index}\n          onChange={onNestedQueryUpdate}\n          datasource={datasource}\n          onRemove={onRemove}\n          onRunQuery={onRunQuery}\n          showExplain={showExplain}\n        />\n      ))}\n    </Stack>\n  );\n}\n","import { isEqual } from 'lodash';\nimport { memo, useEffect, useMemo, useState } from 'react';\nimport { usePrevious } from 'react-use';\n\nimport { DataSourceApi, getDefaultTimeRange, LoadingState, PanelData, SelectableValue, TimeRange } from '@grafana/data';\nimport {\n  EditorRow,\n  LabelFilters,\n  OperationExplainedBox,\n  OperationList,\n  OperationListExplained,\n  OperationsEditorRow,\n  QueryBuilderHints,\n  RawQuery,\n  QueryBuilderLabelFilter,\n  QueryBuilderOperation,\n} from '@grafana/experimental';\nimport { config } from '@grafana/runtime';\n\nimport { testIds } from '../../components/LokiQueryEditor';\nimport { LokiDatasource } from '../../datasource';\nimport { escapeLabelValueInSelector } from '../../languageUtils';\nimport logqlGrammar from '../../syntax';\nimport { LokiQuery } from '../../types';\nimport { lokiQueryModeller } from '../LokiQueryModeller';\nimport { isConflictingFilter } from '../operationUtils';\nimport { buildVisualQueryFromString } from '../parsing';\nimport { LokiOperationId, LokiVisualQuery } from '../types';\n\nimport { EXPLAIN_LABEL_FILTER_CONTENT } from './LokiQueryBuilderExplained';\nimport { NestedQueryList } from './NestedQueryList';\n\nexport const TIME_SPAN_TO_TRIGGER_SAMPLES = 5 * 60 * 1000;\nexport interface Props {\n  query: LokiVisualQuery;\n  datasource: LokiDatasource;\n  showExplain: boolean;\n  timeRange?: TimeRange;\n  onChange: (update: LokiVisualQuery) => void;\n  onRunQuery: () => void;\n}\nexport const LokiQueryBuilder = memo<Props>(({ datasource, query, onChange, onRunQuery, showExplain, timeRange }) => {\n  const [sampleData, setSampleData] = useState<PanelData>();\n  const [highlightedOp, setHighlightedOp] = useState<QueryBuilderOperation | undefined>(undefined);\n  const prevQuery = usePrevious(query);\n  const prevTimeRange = usePrevious(timeRange);\n\n  const onChangeLabels = (labels: QueryBuilderLabelFilter[]) => {\n    onChange({ ...query, labels });\n  };\n\n  const withTemplateVariableOptions = async (optionsPromise: Promise<string[]>): Promise<SelectableValue[]> => {\n    const options = await optionsPromise;\n    return [...datasource.getVariables(), ...options].map((value) => ({ label: value, value }));\n  };\n\n  const onGetLabelNames = async (forLabel: Partial<QueryBuilderLabelFilter>): Promise<string[]> => {\n    const labelsToConsider = query.labels.filter((x) => x !== forLabel);\n\n    const hasEqualityOperation = labelsToConsider.find(\n      (filter) => filter.op === '=' || (filter.op === '=~' && new RegExp(filter.value).test('') === false)\n    );\n    if (labelsToConsider.length === 0 || !hasEqualityOperation) {\n      return await datasource.languageProvider.fetchLabels({ timeRange });\n    }\n\n    const streamSelector = lokiQueryModeller.renderLabels(labelsToConsider);\n    const possibleLabelNames = await datasource.languageProvider.fetchLabels({\n      streamSelector,\n      timeRange,\n    });\n    const labelsNamesToConsider = labelsToConsider.map((l) => l.label);\n\n    // Filter out label names that are already selected\n    return possibleLabelNames.filter((label) => !labelsNamesToConsider.includes(label)).sort();\n  };\n\n  const onGetLabelValues = async (forLabel: Partial<QueryBuilderLabelFilter>) => {\n    if (!forLabel.label) {\n      return [];\n    }\n\n    let values;\n    const labelsToConsider = query.labels.filter((x) => x !== forLabel);\n    // If we have no equality/regex operation with .*, we can't fetch series as it will throw an error, so we fetch label values\n    const hasEqualityOperation = labelsToConsider.find(\n      (filter) => filter.op === '=' || (filter.op === '=~' && new RegExp(filter.value).test('') === false)\n    );\n    if (labelsToConsider.length === 0 || !hasEqualityOperation) {\n      values = await datasource.languageProvider.fetchLabelValues(forLabel.label, { timeRange });\n    } else {\n      const streamSelector = lokiQueryModeller.renderLabels(labelsToConsider);\n      values = await datasource.languageProvider.fetchLabelValues(forLabel.label, {\n        streamSelector,\n        timeRange,\n      });\n    }\n\n    return values ? values.map((v) => escapeLabelValueInSelector(v, forLabel.op)) : []; // Escape values in return\n  };\n\n  const labelFilterRequired: boolean = useMemo(() => {\n    const { labels, operations: op } = query;\n    if (!labels.length && op.length) {\n      // Filter is required when operations are present (empty line contains operation is exception)\n      if (op.length === 1 && op[0].id === LokiOperationId.LineContains && op[0].params[0] === '') {\n        return false;\n      }\n      return true;\n    }\n    return false;\n  }, [query]);\n\n  useEffect(() => {\n    const onGetSampleData = async () => {\n      const lokiQuery = { expr: lokiQueryModeller.renderQuery(query), refId: 'data-samples' };\n      const range = timeRange ?? getDefaultTimeRange();\n      const series = await datasource.getDataSamples(lokiQuery, range);\n      const sampleData = { series, state: LoadingState.Done, timeRange: range };\n      setSampleData(sampleData);\n    };\n\n    const updateBasedOnChangedTimeRange =\n      prevTimeRange &&\n      timeRange &&\n      (Math.abs(timeRange.to.valueOf() - prevTimeRange.to.valueOf()) > TIME_SPAN_TO_TRIGGER_SAMPLES ||\n        Math.abs(timeRange.from.valueOf() - prevTimeRange.from.valueOf()) > TIME_SPAN_TO_TRIGGER_SAMPLES);\n    const updateBasedOnChangedQuery = !isEqual(prevQuery, query);\n    if (config.featureToggles.lokiQueryHints && (updateBasedOnChangedTimeRange || updateBasedOnChangedQuery)) {\n      onGetSampleData().catch(console.error);\n    }\n  }, [datasource, query, timeRange, prevQuery, prevTimeRange]);\n\n  const lang = { grammar: logqlGrammar, name: 'logql' };\n  return (\n    <div data-testid={testIds.editor}>\n      <EditorRow>\n        <LabelFilters\n          onGetLabelNames={(forLabel: Partial<QueryBuilderLabelFilter>) =>\n            withTemplateVariableOptions(onGetLabelNames(forLabel))\n          }\n          onGetLabelValues={(forLabel: Partial<QueryBuilderLabelFilter>) =>\n            withTemplateVariableOptions(onGetLabelValues(forLabel))\n          }\n          labelsFilters={query.labels}\n          onChange={onChangeLabels}\n          labelFilterRequired={labelFilterRequired}\n        />\n      </EditorRow>\n      {showExplain && (\n        <OperationExplainedBox\n          stepNumber={1}\n          title={<RawQuery query={`${lokiQueryModeller.renderLabels(query.labels)}`} language={lang} />}\n        >\n          {EXPLAIN_LABEL_FILTER_CONTENT}\n        </OperationExplainedBox>\n      )}\n      <OperationsEditorRow>\n        <OperationList\n          queryModeller={lokiQueryModeller}\n          query={query}\n          onChange={onChange}\n          onRunQuery={onRunQuery}\n          datasource={datasource as DataSourceApi}\n          highlightedOp={highlightedOp}\n          isConflictingOperation={(operation: QueryBuilderOperation, otherOperations: QueryBuilderOperation[]) =>\n            operation.id === LokiOperationId.LabelFilter && isConflictingFilter(operation, otherOperations)\n          }\n        />\n        <QueryBuilderHints<LokiVisualQuery, LokiQuery>\n          datasource={datasource}\n          query={query}\n          onChange={onChange}\n          data={sampleData}\n          queryModeller={lokiQueryModeller}\n          buildVisualQueryFromString={buildVisualQueryFromString}\n          buildDataQueryFromQueryString={(queryString) => ({ expr: queryString, refId: 'hints' })}\n          buildQueryStringFromDataQuery={(query) => query.expr}\n        />\n      </OperationsEditorRow>\n      {showExplain && (\n        <OperationListExplained<LokiVisualQuery>\n          stepNumber={2}\n          queryModeller={lokiQueryModeller}\n          query={query}\n          language={lang}\n          onMouseEnter={(op) => {\n            setHighlightedOp(op);\n          }}\n          onMouseLeave={() => {\n            setHighlightedOp(undefined);\n          }}\n        />\n      )}\n      {query.binaryQueries && query.binaryQueries.length > 0 && (\n        <NestedQueryList\n          query={query}\n          datasource={datasource}\n          onChange={onChange}\n          onRunQuery={onRunQuery}\n          showExplain={showExplain}\n        />\n      )}\n    </div>\n  );\n});\n\nLokiQueryBuilder.displayName = 'LokiQueryBuilder';\n","import { EditorRow, EditorFieldGroup, RawQuery } from '@grafana/experimental';\n\nimport { lokiGrammar } from '../../syntax';\n\nexport interface Props {\n  query: string;\n}\n\nexport function QueryPreview({ query }: Props) {\n  return (\n    <EditorRow>\n      <EditorFieldGroup>\n        <RawQuery query={query} language={{ grammar: lokiGrammar, name: 'lokiql' }} />\n      </EditorFieldGroup>\n    </EditorRow>\n  );\n}\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { useEffect, useReducer } from 'react';\n\nimport { TimeRange } from '@grafana/data';\n\nimport { testIds } from '../../components/LokiQueryEditor';\nimport { LokiDatasource } from '../../datasource';\nimport { LokiQuery } from '../../types';\nimport { lokiQueryModeller } from '../LokiQueryModeller';\nimport { buildVisualQueryFromString } from '../parsing';\nimport { LokiVisualQuery } from '../types';\n\nimport { LokiQueryBuilder } from './LokiQueryBuilder';\nimport { QueryPreview } from './QueryPreview';\n\nexport interface Props {\n  query: LokiQuery;\n  datasource: LokiDatasource;\n  onChange: (update: LokiQuery) => void;\n  onRunQuery: () => void;\n  showExplain: boolean;\n  timeRange?: TimeRange;\n}\n\nexport interface State {\n  visQuery?: LokiVisualQuery;\n  expr: string;\n}\n\n/**\n * This component is here just to contain the translation logic between string query and the visual query builder model.\n */\nexport function LokiQueryBuilderContainer(props: Props) {\n  const { query, onChange, onRunQuery, datasource, showExplain, timeRange } = props;\n  const [state, dispatch] = useReducer(stateSlice.reducer, {\n    expr: query.expr,\n    // Use initial visual query only if query.expr is empty string\n    visQuery:\n      query.expr === ''\n        ? {\n            labels: [],\n            operations: [{ id: '__line_contains', params: [''] }],\n          }\n        : undefined,\n  });\n\n  // Only rebuild visual query if expr changes from outside\n  useEffect(() => {\n    dispatch(exprChanged(query.expr));\n  }, [query.expr]);\n\n  const onVisQueryChange = (visQuery: LokiVisualQuery) => {\n    const expr = lokiQueryModeller.renderQuery(visQuery);\n    dispatch(visualQueryChange({ visQuery, expr }));\n    onChange({ ...props.query, expr: expr });\n  };\n\n  if (!state.visQuery) {\n    return null;\n  }\n\n  return (\n    <>\n      <LokiQueryBuilder\n        query={state.visQuery}\n        datasource={datasource}\n        onChange={onVisQueryChange}\n        onRunQuery={onRunQuery}\n        showExplain={showExplain}\n        data-testid={testIds.editor}\n        timeRange={timeRange}\n      />\n      {query.expr !== '' && <QueryPreview query={query.expr} />}\n    </>\n  );\n}\n\nconst initialState: State = { expr: '' };\n\nconst stateSlice = createSlice({\n  name: 'loki-builder-container',\n  initialState,\n  reducers: {\n    visualQueryChange: (state, action: PayloadAction<{ visQuery: LokiVisualQuery; expr: string }>) => {\n      state.expr = action.payload.expr;\n      state.visQuery = action.payload.visQuery;\n    },\n    exprChanged: (state, action: PayloadAction<string>) => {\n      if (!state.visQuery || state.expr !== action.payload) {\n        state.expr = action.payload;\n        const parseResult = buildVisualQueryFromString(action.payload);\n        state.visQuery = parseResult.query;\n      }\n    },\n  },\n});\n\nconst { visualQueryChange, exprChanged } = stateSlice.actions;\n","import { css } from '@emotion/css';\nimport React from 'react';\nimport { useToggle } from 'react-use';\nimport { getValueFormat } from '@grafana/data';\nimport { config } from '@grafana/runtime';\nimport { useStyles2, Collapse, Tooltip, Icon } from '@grafana/ui';\nimport { Stack } from '../../QueryEditor/Stack.js';\n\nfunction QueryOptionGroup({ title, children, collapsedInfo, queryStats }) {\n  const [isOpen, toggleOpen] = useToggle(false);\n  const styles = useStyles2(getStyles);\n  return /* @__PURE__ */ React.createElement(\"div\", { className: styles.wrapper }, /* @__PURE__ */ React.createElement(\n    Collapse,\n    {\n      className: styles.collapse,\n      collapsible: true,\n      isOpen,\n      onToggle: toggleOpen,\n      label: /* @__PURE__ */ React.createElement(Stack, { gap: 0 }, /* @__PURE__ */ React.createElement(\"h6\", { className: styles.title }, title), !isOpen && /* @__PURE__ */ React.createElement(\"div\", { className: styles.description }, collapsedInfo.map((x, i) => /* @__PURE__ */ React.createElement(\"span\", { key: i }, x))))\n    },\n    /* @__PURE__ */ React.createElement(\"div\", { className: styles.body }, children)\n  ), queryStats && config.featureToggles.lokiQuerySplitting && /* @__PURE__ */ React.createElement(Tooltip, { content: \"Note: the query will be split into multiple parts and executed in sequence. Query limits will only apply each individual part.\" }, /* @__PURE__ */ React.createElement(Icon, { tabIndex: 0, name: \"info-circle\", className: styles.tooltip, size: \"sm\" })), queryStats && /* @__PURE__ */ React.createElement(\"p\", { className: styles.stats }, generateQueryStats(queryStats)));\n}\nconst getStyles = (theme) => {\n  return {\n    collapse: css({\n      backgroundColor: \"unset\",\n      border: \"unset\",\n      marginBottom: 0,\n      [\"> button\"]: {\n        padding: theme.spacing(0, 1)\n      }\n    }),\n    wrapper: css({\n      width: \"100%\",\n      display: \"flex\",\n      justifyContent: \"space-between\",\n      alignItems: \"baseline\"\n    }),\n    title: css({\n      flexGrow: 1,\n      overflow: \"hidden\",\n      fontSize: theme.typography.bodySmall.fontSize,\n      fontWeight: theme.typography.fontWeightMedium,\n      margin: 0\n    }),\n    description: css({\n      color: theme.colors.text.secondary,\n      fontSize: theme.typography.bodySmall.fontSize,\n      fontWeight: theme.typography.bodySmall.fontWeight,\n      paddingLeft: theme.spacing(2),\n      gap: theme.spacing(2),\n      display: \"flex\"\n    }),\n    body: css({\n      display: \"flex\",\n      gap: theme.spacing(2),\n      flexWrap: \"wrap\"\n    }),\n    stats: css({\n      margin: \"0px\",\n      color: theme.colors.text.secondary,\n      fontSize: theme.typography.bodySmall.fontSize\n    }),\n    tooltip: css({\n      marginRight: theme.spacing(0.25)\n    })\n  };\n};\nconst generateQueryStats = (queryStats) => {\n  if (queryStats.message) {\n    return queryStats.message;\n  }\n  return `This query will process approximately ${convertUnits(queryStats)}.`;\n};\nconst convertUnits = (queryStats) => {\n  const { text, suffix } = getValueFormat(\"bytes\")(queryStats.bytes, 1);\n  return text + suffix;\n};\n\nexport { QueryOptionGroup };\n//# sourceMappingURL=QueryOptionGroup.js.map\n","import { trim } from 'lodash';\nimport { useMemo, useState } from 'react';\nimport * as React from 'react';\n\nimport { CoreApp, isValidDuration, isValidGrafanaDuration, SelectableValue } from '@grafana/data';\nimport { EditorField, EditorRow, QueryOptionGroup } from '@grafana/experimental';\nimport { config, reportInteraction } from '@grafana/runtime';\nimport { Alert, AutoSizeInput, RadioButtonGroup, Select } from '@grafana/ui';\n\nimport { preprocessMaxLines, queryTypeOptions, RESOLUTION_OPTIONS } from '../../components/LokiOptionFields';\nimport { getLokiQueryType, isLogsQuery } from '../../queryUtils';\nimport { LokiQuery, LokiQueryType, QueryStats } from '../../types';\n\nexport interface Props {\n  query: LokiQuery;\n  onChange: (update: LokiQuery) => void;\n  onRunQuery: () => void;\n  maxLines: number;\n  app?: CoreApp;\n  queryStats: QueryStats | null;\n}\n\nexport const LokiQueryBuilderOptions = React.memo<Props>(\n  ({ app, query, onChange, onRunQuery, maxLines, queryStats }) => {\n    const [splitDurationValid, setSplitDurationValid] = useState(true);\n\n    const onQueryTypeChange = (value: LokiQueryType) => {\n      onChange({ ...query, queryType: value });\n      onRunQuery();\n    };\n\n    const onResolutionChange = (option: SelectableValue<number>) => {\n      reportInteraction('grafana_loki_resolution_clicked', {\n        app,\n        resolution: option.value,\n      });\n      onChange({ ...query, resolution: option.value });\n      onRunQuery();\n    };\n\n    const onChunkRangeChange = (evt: React.FormEvent<HTMLInputElement>) => {\n      const value = evt.currentTarget.value;\n      if (!isValidDuration(value)) {\n        setSplitDurationValid(false);\n        return;\n      }\n      setSplitDurationValid(true);\n      onChange({ ...query, splitDuration: value });\n      onRunQuery();\n    };\n\n    const onLegendFormatChanged = (evt: React.FormEvent<HTMLInputElement>) => {\n      onChange({ ...query, legendFormat: evt.currentTarget.value });\n      onRunQuery();\n    };\n\n    function onMaxLinesChange(e: React.SyntheticEvent<HTMLInputElement>) {\n      const newMaxLines = preprocessMaxLines(e.currentTarget.value);\n      if (query.maxLines !== newMaxLines) {\n        onChange({ ...query, maxLines: newMaxLines });\n        onRunQuery();\n      }\n    }\n\n    function onStepChange(e: React.SyntheticEvent<HTMLInputElement>) {\n      onChange({ ...query, step: trim(e.currentTarget.value) });\n      onRunQuery();\n    }\n\n    let queryType = getLokiQueryType(query);\n    const isLogQuery = isLogsQuery(query.expr);\n    const filteredQueryTypeOptions = isLogQuery\n      ? queryTypeOptions.filter((o) => o.value !== LokiQueryType.Instant)\n      : queryTypeOptions;\n\n    // if the state's queryType is still Instant, trigger a change to range for log queries\n    if (isLogQuery && queryType === LokiQueryType.Instant) {\n      onChange({ ...query, queryType: LokiQueryType.Range });\n      queryType = LokiQueryType.Range;\n    }\n\n    const isValidStep = useMemo(() => {\n      if (!query.step || isValidGrafanaDuration(query.step) || !isNaN(Number(query.step))) {\n        return true;\n      }\n      return false;\n    }, [query.step]);\n\n    return (\n      <EditorRow>\n        <QueryOptionGroup\n          title=\"Options\"\n          collapsedInfo={getCollapsedInfo(query, queryType, maxLines, isLogQuery, isValidStep)}\n          queryStats={queryStats}\n        >\n          <EditorField\n            label=\"Legend\"\n            tooltip=\"Series name override or template. Ex. {{hostname}} will be replaced with label value for hostname.\"\n          >\n            <AutoSizeInput\n              placeholder=\"{{label}}\"\n              type=\"string\"\n              minWidth={14}\n              defaultValue={query.legendFormat}\n              onCommitChange={onLegendFormatChanged}\n            />\n          </EditorField>\n          {filteredQueryTypeOptions.length > 1 && (\n            <EditorField label=\"Type\">\n              <RadioButtonGroup options={filteredQueryTypeOptions} value={queryType} onChange={onQueryTypeChange} />\n            </EditorField>\n          )}\n          {isLogQuery && (\n            <EditorField label=\"Line limit\" tooltip=\"Upper limit for number of log lines returned by query.\">\n              <AutoSizeInput\n                className=\"width-4\"\n                placeholder={maxLines.toString()}\n                type=\"number\"\n                min={0}\n                defaultValue={query.maxLines?.toString() ?? ''}\n                onCommitChange={onMaxLinesChange}\n              />\n            </EditorField>\n          )}\n          {!isLogQuery && (\n            <>\n              <EditorField\n                label=\"Step\"\n                tooltip=\"Use the step parameter when making metric queries to Loki. If not filled, Grafana's calculated interval will be used. Example valid values: 1s, 5m, 10h, 1d.\"\n                invalid={!isValidStep}\n                error={'Invalid step. Example valid values: 1s, 5m, 10h, 1d.'}\n              >\n                <AutoSizeInput\n                  className=\"width-6\"\n                  placeholder={'auto'}\n                  type=\"string\"\n                  defaultValue={query.step ?? ''}\n                  onCommitChange={onStepChange}\n                />\n              </EditorField>\n              {query.resolution !== undefined && query.resolution > 1 && (\n                <>\n                  <EditorField\n                    label=\"Resolution\"\n                    tooltip=\"Changes the step parameter of Loki metrics range queries. With a resolution of 1/1, each pixel corresponds to one data point. 1/10 retrieves one data point per 10 pixels. Lower resolutions perform better.\"\n                  >\n                    <Select\n                      isSearchable={false}\n                      onChange={onResolutionChange}\n                      options={RESOLUTION_OPTIONS}\n                      value={query.resolution || 1}\n                      aria-label=\"Select resolution\"\n                    />\n                  </EditorField>\n                  <Alert\n                    severity=\"warning\"\n                    title=\"The 'Resolution' is deprecated. Use 'Step' editor instead to change step parameter.\"\n                  />\n                </>\n              )}\n            </>\n          )}\n          {config.featureToggles.lokiQuerySplittingConfig && config.featureToggles.lokiQuerySplitting && (\n            <EditorField\n              label=\"Split Duration\"\n              tooltip=\"Defines the duration of a single query when query splitting is enabled.\"\n            >\n              <AutoSizeInput\n                minWidth={14}\n                type=\"string\"\n                min={0}\n                defaultValue={query.splitDuration ?? '1d'}\n                onCommitChange={onChunkRangeChange}\n                invalid={!splitDurationValid}\n              />\n            </EditorField>\n          )}\n        </QueryOptionGroup>\n      </EditorRow>\n    );\n  }\n);\n\nfunction getCollapsedInfo(\n  query: LokiQuery,\n  queryType: LokiQueryType,\n  maxLines: number,\n  isLogQuery: boolean,\n  isValidStep: boolean\n): string[] {\n  const queryTypeLabel = queryTypeOptions.find((x) => x.value === queryType);\n  const resolutionLabel = RESOLUTION_OPTIONS.find((x) => x.value === (query.resolution ?? 1));\n\n  const items: string[] = [];\n\n  if (query.legendFormat) {\n    items.push(`Legend: ${query.legendFormat}`);\n  }\n\n  items.push(`Type: ${queryTypeLabel?.label}`);\n\n  if (isLogQuery) {\n    items.push(`Line limit: ${query.maxLines ?? maxLines}`);\n  }\n\n  if (!isLogQuery) {\n    if (query.step) {\n      items.push(`Step: ${isValidStep ? query.step : 'Invalid value'}`);\n    }\n\n    if (query.resolution) {\n      items.push(`Resolution: ${resolutionLabel?.label}`);\n    }\n  }\n\n  return items;\n}\n\nLokiQueryBuilderOptions.displayName = 'LokiQueryBuilderOptions';\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { useStyles2 } from '@grafana/ui';\n\nimport { testIds } from '../../components/LokiQueryEditor';\nimport { LokiQueryField } from '../../components/LokiQueryField';\nimport { LokiQueryEditorProps } from '../../components/types';\n\nimport { LokiQueryBuilderExplained } from './LokiQueryBuilderExplained';\n\ntype Props = LokiQueryEditorProps & {\n  showExplain: boolean;\n};\n\nexport function LokiQueryCodeEditor({\n  query,\n  datasource,\n  range,\n  onRunQuery,\n  onChange,\n  data,\n  app,\n  showExplain,\n  history,\n}: Props) {\n  const styles = useStyles2(getStyles);\n\n  return (\n    <div className={styles.wrapper}>\n      <LokiQueryField\n        datasource={datasource}\n        query={query}\n        range={range}\n        onRunQuery={onRunQuery}\n        onChange={onChange}\n        history={history}\n        data={data}\n        app={app}\n        data-testid={testIds.editor}\n      />\n      {showExplain && <LokiQueryBuilderExplained query={query.expr} />}\n    </div>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    wrapper: css`\n      max-width: 100%;\n      .gf-form {\n        margin-bottom: 0.5;\n      }\n    `,\n    buttonGroup: css`\n      border: 1px solid ${theme.colors.border.medium};\n      border-top: none;\n      padding: ${theme.spacing(0.5, 0.5, 0.5, 0.5)};\n      margin-bottom: ${theme.spacing(0.5)};\n      display: flex;\n      flex-grow: 1;\n      justify-content: end;\n      font-size: ${theme.typography.bodySmall.fontSize};\n    `,\n    hint: css`\n      color: ${theme.colors.text.disabled};\n      white-space: nowrap;\n      cursor: help;\n    `,\n  };\n};\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { RawQuery } from '@grafana/experimental';\nimport { Button, Card, useStyles2 } from '@grafana/ui';\n\nimport logqlGrammar from '../../syntax';\nimport { lokiQueryModeller } from '../LokiQueryModeller';\nimport { LokiQueryPattern } from '../types';\n\ntype Props = {\n  pattern: LokiQueryPattern;\n  hasNewQueryOption: boolean;\n  hasPreviousQuery: boolean;\n  selectedPatternName: string | null;\n  setSelectedPatternName: (name: string | null) => void;\n  onPatternSelect: (pattern: LokiQueryPattern, selectAsNewQuery?: boolean) => void;\n};\n\nexport const QueryPattern = (props: Props) => {\n  const { pattern, onPatternSelect, hasNewQueryOption, hasPreviousQuery, selectedPatternName, setSelectedPatternName } =\n    props;\n\n  const styles = useStyles2(getStyles);\n  const lang = { grammar: logqlGrammar, name: 'logql' };\n\n  return (\n    <Card className={styles.card}>\n      <Card.Heading>{pattern.name}</Card.Heading>\n      <div className={styles.rawQueryContainer}>\n        <RawQuery\n          query={lokiQueryModeller.renderQuery({ labels: [], operations: pattern.operations })}\n          language={lang}\n          className={styles.rawQuery}\n        />\n      </div>\n      <Card.Actions>\n        {selectedPatternName !== pattern.name ? (\n          <Button\n            size=\"sm\"\n            onClick={() => {\n              if (hasPreviousQuery) {\n                // If user has previous query, we need to confirm that they want to replace it\n                setSelectedPatternName(pattern.name);\n              } else {\n                onPatternSelect(pattern);\n              }\n            }}\n          >\n            Use this query\n          </Button>\n        ) : (\n          <>\n            <div className={styles.spacing}>\n              {`If you would like to use this query, ${\n                hasNewQueryOption\n                  ? 'you can either replace your current query or create a new query'\n                  : 'your current query will be replaced'\n              }.`}\n            </div>\n            <Button size=\"sm\" fill=\"outline\" onClick={() => setSelectedPatternName(null)}>\n              Back\n            </Button>\n            <Button\n              size=\"sm\"\n              onClick={() => {\n                onPatternSelect(pattern);\n              }}\n            >\n              Apply to query\n            </Button>\n            {hasNewQueryOption && (\n              <Button\n                size=\"sm\"\n                onClick={() => {\n                  onPatternSelect(pattern, true);\n                }}\n              >\n                Create new query\n              </Button>\n            )}\n          </>\n        )}\n      </Card.Actions>\n    </Card>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    card: css`\n      width: 49.5%;\n      display: flex;\n      flex-direction: column;\n    `,\n    rawQueryContainer: css`\n      flex-grow: 1;\n    `,\n    rawQuery: css`\n      background-color: ${theme.colors.background.primary};\n      padding: ${theme.spacing(1)};\n      margin-top: ${theme.spacing(1)};\n    `,\n    spacing: css`\n      margin-bottom: ${theme.spacing(1)};\n    `,\n  };\n};\n","import { css } from '@emotion/css';\nimport { capitalize } from 'lodash';\nimport { useMemo, useState } from 'react';\n\nimport { CoreApp, GrafanaTheme2, getNextRefId } from '@grafana/data';\nimport { reportInteraction } from '@grafana/runtime';\nimport { DataQuery } from '@grafana/schema';\nimport { Button, Collapse, Modal, useStyles2 } from '@grafana/ui';\n\nimport { LokiQuery } from '../../types';\nimport { lokiQueryModeller } from '../LokiQueryModeller';\nimport { operationDefinitions } from '../operations';\nimport { buildVisualQueryFromString } from '../parsing';\nimport { LokiOperationId, LokiQueryPattern, LokiQueryPatternType, LokiVisualQueryOperationCategory } from '../types';\n\nimport { QueryPattern } from './QueryPattern';\n\ntype Props = {\n  isOpen: boolean;\n  query: LokiQuery;\n  queries: DataQuery[] | undefined;\n  app?: CoreApp;\n  onClose: () => void;\n  onChange: (query: LokiQuery) => void;\n  onAddQuery?: (query: LokiQuery) => void;\n};\n\nconst keepOperationCategories: string[] = [\n  LokiVisualQueryOperationCategory.Formats,\n  LokiVisualQueryOperationCategory.LineFilters,\n  LokiVisualQueryOperationCategory.LabelFilters,\n];\nconst excludeOperationIds: string[] = [LokiOperationId.Unwrap];\nconst keepOperations = operationDefinitions\n  .filter(\n    (operation) =>\n      operation.category &&\n      keepOperationCategories.includes(operation.category) &&\n      !excludeOperationIds.includes(operation.id)\n  )\n  .map((operation) => operation.id);\n\nexport const QueryPatternsModal = (props: Props) => {\n  const { isOpen, onClose, onChange, onAddQuery, query, queries, app } = props;\n  const [openTabs, setOpenTabs] = useState<string[]>([]);\n  const [selectedPatternName, setSelectedPatternName] = useState<string | null>(null);\n\n  const styles = useStyles2(getStyles);\n  const hasNewQueryOption = !!onAddQuery;\n  const hasPreviousQuery = useMemo(\n    () => buildVisualQueryFromString(query.expr).query.operations.length > 0,\n    [query.expr]\n  );\n\n  const onPatternSelect = (pattern: LokiQueryPattern, selectAsNewQuery = false) => {\n    const visualQuery = buildVisualQueryFromString(selectAsNewQuery ? '' : query.expr);\n    reportInteraction('grafana_loki_query_patterns_selected', {\n      version: 'v2',\n      app: app ?? '',\n      editorMode: query.editorMode,\n      selectedPattern: pattern.name,\n      preSelectedOperationsCount: visualQuery.query.operations.length,\n      preSelectedLabelsCount: visualQuery.query.labels.length,\n      createNewQuery: hasNewQueryOption && selectAsNewQuery,\n    });\n\n    // Filter operations in the original query except those we configured to keep\n    visualQuery.query.operations = visualQuery.query.operations.filter((op) => keepOperations.includes(op.id));\n    // Filter operations in the pattern that are present in the original query\n    const patternOperations = pattern.operations.filter(\n      (patternOp) => visualQuery.query.operations.findIndex((op) => op.id === patternOp.id) < 0\n    );\n    visualQuery.query.operations = [...visualQuery.query.operations, ...patternOperations];\n\n    if (hasNewQueryOption && selectAsNewQuery) {\n      onAddQuery({\n        ...query,\n        refId: getNextRefId(queries ?? [query]),\n        expr: lokiQueryModeller.renderQuery(visualQuery.query),\n      });\n    } else {\n      onChange({\n        ...query,\n        expr: lokiQueryModeller.renderQuery(visualQuery.query),\n      });\n    }\n    setSelectedPatternName(null);\n    onClose();\n  };\n\n  return (\n    <Modal isOpen={isOpen} title=\"Kick start your query\" onDismiss={onClose} className={styles.modal}>\n      <div className={styles.spacing}>\n        Kick start your query by selecting one of these queries. You can then continue to complete your query.\n      </div>\n      {Object.values(LokiQueryPatternType).map((patternType) => {\n        return (\n          <Collapse\n            key={patternType}\n            label={`${capitalize(patternType)} query starters`}\n            isOpen={openTabs.includes(patternType)}\n            collapsible={true}\n            onToggle={() =>\n              setOpenTabs((tabs) =>\n                // close tab if it's already open, otherwise open it\n                tabs.includes(patternType) ? tabs.filter((t) => t !== patternType) : [...tabs, patternType]\n              )\n            }\n          >\n            <div className={styles.cardsContainer}>\n              {lokiQueryModeller\n                .getQueryPatterns()\n                .filter((pattern) => pattern.type === patternType)\n                .map((pattern) => (\n                  <QueryPattern\n                    key={pattern.name}\n                    pattern={pattern}\n                    hasNewQueryOption={hasNewQueryOption}\n                    hasPreviousQuery={hasPreviousQuery}\n                    onPatternSelect={onPatternSelect}\n                    selectedPatternName={selectedPatternName}\n                    setSelectedPatternName={setSelectedPatternName}\n                  />\n                ))}\n            </div>\n          </Collapse>\n        );\n      })}\n      <Button variant=\"secondary\" onClick={onClose}>\n        Close\n      </Button>\n    </Modal>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    cardsContainer: css`\n      display: flex;\n      flex-direction: row;\n      flex-wrap: wrap;\n      justify-content: space-between;\n    `,\n    spacing: css`\n      margin-bottom: ${theme.spacing(1)};\n    `,\n    modal: css`\n      width: 85vw;\n      ${theme.breakpoints.down('md')} {\n        width: 100%;\n      }\n    `,\n  };\n};\n","import { QueryEditorMode } from '@grafana/experimental';\n\nimport { LokiQuery, LokiQueryType } from '../types';\n\nconst queryEditorModeDefaultLocalStorageKey = 'LokiQueryEditorModeDefault';\n\nexport function changeEditorMode(query: LokiQuery, editorMode: QueryEditorMode, onChange: (query: LokiQuery) => void) {\n  // If empty query store new mode as default\n  if (query.expr === '') {\n    window.localStorage.setItem(queryEditorModeDefaultLocalStorageKey, editorMode);\n  }\n\n  onChange({ ...query, editorMode });\n}\n\nexport function getDefaultEditorMode(expr: string) {\n  // If we already have an expression default to code view\n  if (expr != null && expr !== '') {\n    return QueryEditorMode.Code;\n  }\n\n  const value: string | null = window.localStorage.getItem(queryEditorModeDefaultLocalStorageKey);\n  switch (value) {\n    case 'code':\n      return QueryEditorMode.Code;\n\n    case 'builder':\n    default:\n      return QueryEditorMode.Builder;\n  }\n}\n\n/**\n * Returns query with defaults, and boolean true/false depending on change was required\n */\nexport function getQueryWithDefaults(query: LokiQuery): LokiQuery {\n  // If no expr (ie new query) then default to builder\n  let result = query;\n\n  if (!query.editorMode) {\n    result = { ...query, editorMode: getDefaultEditorMode(query.expr) };\n  }\n\n  if (query.expr == null) {\n    result = { ...result, expr: '' };\n  }\n\n  if (query.queryType == null) {\n    // Default to range query\n    result = { ...result, queryType: LokiQueryType.Range };\n  }\n\n  return result;\n}\n","import { DateTime, isDateTime, TimeRange } from '@grafana/data';\n\nimport { LokiQueryType } from '../types';\n\n/**\n * This function compares two time values. If the first is absolute, it compares them using `DateTime.isSame`.\n *\n * @param {(DateTime | string)} time1\n * @param {(DateTime | string | undefined)} time2\n */\nfunction compareTime(time1: DateTime | string | undefined, time2: DateTime | string | undefined) {\n  if (!time1 || !time2) {\n    return false;\n  }\n\n  const isAbsolute = isDateTime(time1);\n\n  if (isAbsolute) {\n    return time1.isSame(time2);\n  }\n\n  return time1 === time2;\n}\n\nexport function shouldUpdateStats(\n  query: string,\n  prevQuery: string | undefined,\n  timeRange: TimeRange | undefined,\n  prevTimeRange: TimeRange | undefined,\n  queryType: LokiQueryType | undefined,\n  prevQueryType: LokiQueryType | undefined\n): boolean {\n  if (prevQuery === undefined || query.trim() !== prevQuery.trim() || queryType !== prevQueryType) {\n    return true;\n  }\n\n  if (\n    compareTime(timeRange?.raw.from, prevTimeRange?.raw.from) &&\n    compareTime(timeRange?.raw.to, prevTimeRange?.raw.to)\n  ) {\n    return false;\n  }\n\n  return true;\n}\n","import { isEqual } from 'lodash';\nimport { memo, SyntheticEvent, useCallback, useEffect, useId, useState } from 'react';\nimport { usePrevious } from 'react-use';\n\nimport { CoreApp, LoadingState } from '@grafana/data';\nimport { selectors } from '@grafana/e2e-selectors';\nimport {\n  EditorHeader,\n  EditorRows,\n  FlexItem,\n  QueryEditorModeToggle,\n  QueryHeaderSwitch,\n  QueryEditorMode,\n} from '@grafana/experimental';\nimport { config, reportInteraction } from '@grafana/runtime';\nimport { Button, ConfirmModal, Space, Stack } from '@grafana/ui';\n\nimport { LabelBrowserModal } from '../querybuilder/components/LabelBrowserModal';\nimport { LokiQueryBuilderContainer } from '../querybuilder/components/LokiQueryBuilderContainer';\nimport { LokiQueryBuilderOptions } from '../querybuilder/components/LokiQueryBuilderOptions';\nimport { LokiQueryCodeEditor } from '../querybuilder/components/LokiQueryCodeEditor';\nimport { QueryPatternsModal } from '../querybuilder/components/QueryPatternsModal';\nimport { buildVisualQueryFromString } from '../querybuilder/parsing';\nimport { changeEditorMode, getQueryWithDefaults } from '../querybuilder/state';\nimport { LokiQuery, QueryStats } from '../types';\n\nimport { shouldUpdateStats } from './stats';\nimport { LokiQueryEditorProps } from './types';\n\nexport const testIds = {\n  editor: 'loki-editor',\n};\n\nexport const lokiQueryEditorExplainKey = 'LokiQueryEditorExplainDefault';\n\nexport const LokiQueryEditor = memo<LokiQueryEditorProps>((props) => {\n  const id = useId();\n  const { onChange, onRunQuery, onAddQuery, data, app, queries, datasource, range: timeRange } = props;\n  const [parseModalOpen, setParseModalOpen] = useState(false);\n  const [queryPatternsModalOpen, setQueryPatternsModalOpen] = useState(false);\n  const [dataIsStale, setDataIsStale] = useState(false);\n  const [labelBrowserVisible, setLabelBrowserVisible] = useState(false);\n  const [queryStats, setQueryStats] = useState<QueryStats | null>(null);\n  const [explain, setExplain] = useState(window.localStorage.getItem(lokiQueryEditorExplainKey) === 'true');\n\n  const predefinedOperations = datasource.predefinedOperations;\n  const previousTimeRange = usePrevious(timeRange);\n\n  const query = getQueryWithDefaults(props.query);\n  if (config.featureToggles.lokiPredefinedOperations && !query.expr && predefinedOperations) {\n    query.expr = `{} ${predefinedOperations}`;\n  }\n  const previousQueryExpr = usePrevious(query.expr);\n  const previousQueryType = usePrevious(query.queryType);\n\n  // This should be filled in from the defaults by now.\n  const editorMode = query.editorMode!;\n\n  const onExplainChange = (event: SyntheticEvent<HTMLInputElement>) => {\n    window.localStorage.setItem(lokiQueryEditorExplainKey, event.currentTarget.checked ? 'true' : 'false');\n    setExplain(event.currentTarget.checked);\n  };\n\n  const onEditorModeChange = useCallback(\n    (newEditorMode: QueryEditorMode) => {\n      reportInteraction('grafana_loki_editor_mode_clicked', {\n        newEditor: newEditorMode,\n        previousEditor: query.editorMode ?? '',\n        newQuery: !query.expr,\n        app: app ?? '',\n      });\n\n      if (newEditorMode === QueryEditorMode.Builder) {\n        const result = buildVisualQueryFromString(query.expr || '');\n        // If there are errors, give user a chance to decide if they want to go to builder as that can lose some data.\n        if (result.errors.length) {\n          setParseModalOpen(true);\n          return;\n        }\n      }\n      changeEditorMode(query, newEditorMode, onChange);\n    },\n    [onChange, query, app]\n  );\n\n  useEffect(() => {\n    setDataIsStale(false);\n  }, [data]);\n\n  const onChangeInternal = (query: LokiQuery) => {\n    if (!isEqual(query, props.query)) {\n      setDataIsStale(true);\n    }\n    onChange(query);\n  };\n\n  const onClickLabelBrowserButton = () => {\n    reportInteraction('grafana_loki_label_browser_opened', {\n      app: app,\n    });\n\n    setLabelBrowserVisible((visible) => !visible);\n  };\n\n  useEffect(() => {\n    const shouldUpdate = shouldUpdateStats(\n      query.expr,\n      previousQueryExpr,\n      timeRange,\n      previousTimeRange,\n      query.queryType,\n      previousQueryType\n    );\n    if (shouldUpdate && timeRange) {\n      const makeAsyncRequest = async () => {\n        // overwriting the refId that is later used to cancel inflight queries with the same ID.\n        const stats = await datasource.getStats({ ...query, refId: `${id}_${query.refId}` }, timeRange);\n        setQueryStats(stats);\n      };\n      makeAsyncRequest();\n    }\n  }, [datasource, timeRange, previousTimeRange, query, previousQueryExpr, previousQueryType, setQueryStats, id]);\n\n  return (\n    <>\n      <ConfirmModal\n        isOpen={parseModalOpen}\n        title=\"Query parsing\"\n        body=\"There were errors while trying to parse the query. Continuing to visual builder may lose some parts of the query.\"\n        confirmText=\"Continue\"\n        onConfirm={() => {\n          onChange({ ...query, editorMode: QueryEditorMode.Builder });\n          setParseModalOpen(false);\n        }}\n        onDismiss={() => setParseModalOpen(false)}\n      />\n      <QueryPatternsModal\n        isOpen={queryPatternsModalOpen}\n        onClose={() => setQueryPatternsModalOpen(false)}\n        query={query}\n        queries={queries}\n        app={app}\n        onChange={onChange}\n        onAddQuery={onAddQuery}\n      />\n      <LabelBrowserModal\n        isOpen={labelBrowserVisible}\n        datasource={datasource}\n        query={query}\n        app={app}\n        onClose={() => setLabelBrowserVisible(false)}\n        onChange={onChangeInternal}\n        onRunQuery={onRunQuery}\n        timeRange={timeRange}\n      />\n      <EditorHeader>\n        <Stack gap={1}>\n          <Button\n            data-testid={selectors.components.QueryBuilder.queryPatterns}\n            variant=\"secondary\"\n            size=\"sm\"\n            onClick={() => {\n              setQueryPatternsModalOpen((prevValue) => !prevValue);\n\n              const visualQuery = buildVisualQueryFromString(query.expr || '');\n              reportInteraction('grafana_loki_query_patterns_opened', {\n                version: 'v2',\n                app: app ?? '',\n                editorMode: query.editorMode,\n                preSelectedOperationsCount: visualQuery.query.operations.length,\n                preSelectedLabelsCount: visualQuery.query.labels.length,\n              });\n            }}\n          >\n            Kick start your query\n          </Button>\n          <Button variant=\"secondary\" size=\"sm\" onClick={onClickLabelBrowserButton} data-testid=\"label-browser-button\">\n            Label browser\n          </Button>\n        </Stack>\n        <QueryHeaderSwitch label=\"Explain query\" value={explain} onChange={onExplainChange} />\n        <FlexItem grow={1} />\n        {app !== CoreApp.Explore && app !== CoreApp.Correlations && (\n          <Button\n            variant={dataIsStale ? 'primary' : 'secondary'}\n            size=\"sm\"\n            onClick={onRunQuery}\n            icon={data?.state === LoadingState.Loading ? 'spinner' : undefined}\n            disabled={data?.state === LoadingState.Loading}\n          >\n            {queries && queries.length > 1 ? `Run queries` : `Run query`}\n          </Button>\n        )}\n        <QueryEditorModeToggle mode={editorMode!} onChange={onEditorModeChange} />\n      </EditorHeader>\n      <Space v={0.5} />\n      <EditorRows>\n        {editorMode === QueryEditorMode.Code && (\n          <LokiQueryCodeEditor {...props} query={query} onChange={onChangeInternal} showExplain={explain} />\n        )}\n        {editorMode === QueryEditorMode.Builder && (\n          <LokiQueryBuilderContainer\n            datasource={props.datasource}\n            query={query}\n            onChange={onChangeInternal}\n            onRunQuery={props.onRunQuery}\n            showExplain={explain}\n            timeRange={timeRange}\n          />\n        )}\n        <LokiQueryBuilderOptions\n          query={query}\n          onChange={onChange}\n          onRunQuery={onRunQuery}\n          app={app}\n          maxLines={datasource.maxLines}\n          queryStats={queryStats}\n        />\n      </EditorRows>\n    </>\n  );\n});\n\nLokiQueryEditor.displayName = 'LokiQueryEditor';\n","import { LokiQueryField } from './LokiQueryField';\nimport { LokiQueryEditorProps } from './types';\n\nexport function LokiQueryEditorForAlerting(props: LokiQueryEditorProps) {\n  const { query, data, datasource, onChange, onRunQuery, history } = props;\n\n  return (\n    <LokiQueryField\n      datasource={datasource}\n      query={query}\n      onChange={onChange}\n      onRunQuery={onRunQuery}\n      history={history}\n      data={data}\n      placeholder=\"Enter a Loki query\"\n      data-testid={testIds.editor}\n    />\n  );\n}\n\nexport const testIds = {\n  editor: 'loki-editor-cloud-alerting',\n};\n","import { memo } from 'react';\n\nimport { CoreApp } from '@grafana/data';\n\nimport { LokiQueryEditor } from './LokiQueryEditor';\nimport { LokiQueryEditorForAlerting } from './LokiQueryEditorForAlerting';\nimport { LokiQueryEditorProps } from './types';\n\nexport function LokiQueryEditorByApp(props: LokiQueryEditorProps) {\n  const { app } = props;\n\n  switch (app) {\n    case CoreApp.CloudAlerting:\n      return <LokiQueryEditorForAlerting {...props} />;\n    default:\n      return <LokiQueryEditor {...props} />;\n  }\n}\n\nexport default memo(LokiQueryEditorByApp);\n\nexport const testIds = {\n  editor: 'loki-editor',\n};\n","import { DataSourcePluginOptionsEditorProps } from '@grafana/data';\nimport { ConfigDescriptionLink, ConfigSubSection } from '@grafana/experimental';\nimport { InlineField, InlineSwitch } from '@grafana/ui';\n\nexport function AlertingSettings({\n  options,\n  onOptionsChange,\n}: Pick<DataSourcePluginOptionsEditorProps, 'options' | 'onOptionsChange'>) {\n  return (\n    <ConfigSubSection\n      title=\"Alerting\"\n      description={\n        <ConfigDescriptionLink\n          description=\"Manage alert rules for the Loki data source.\"\n          suffix=\"loki/configure-loki-data-source/#alerting\"\n          feature=\"alerting\"\n        />\n      }\n    >\n      <InlineField\n        labelWidth={29}\n        label=\"Manage alert rules in Alerting UI\"\n        disabled={options.readOnly}\n        tooltip=\"Manage alert rules for this data source. To manage other alerting resources, add an Alertmanager data source.\"\n      >\n        <InlineSwitch\n          value={options.jsonData.manageAlerts !== false}\n          onChange={(event) =>\n            onOptionsChange({\n              ...options,\n              jsonData: { ...options.jsonData, manageAlerts: event!.currentTarget.checked },\n            })\n          }\n        />\n      </InlineField>\n    </ConfigSubSection>\n  );\n}\n","import { ReactNode, useState } from 'react';\n\nimport { getTemplateSrv } from '@grafana/runtime';\nimport { InlineField, TextArea } from '@grafana/ui';\n\nimport { DerivedFieldConfig } from '../types';\n\ntype Props = {\n  derivedFields?: DerivedFieldConfig[];\n  className?: string;\n};\nexport const DebugSection = (props: Props) => {\n  const { derivedFields, className } = props;\n  const [debugText, setDebugText] = useState('');\n\n  let debugFields: DebugField[] = [];\n  if (debugText && derivedFields) {\n    debugFields = makeDebugFields(derivedFields, debugText);\n  }\n\n  return (\n    <div className={className}>\n      <InlineField label=\"Debug log message\" labelWidth={24} grow>\n        <TextArea\n          type=\"text\"\n          aria-label=\"Loki query\"\n          placeholder=\"Paste an example log line here to test the regular expressions of your derived fields\"\n          value={debugText}\n          onChange={(event) => setDebugText(event.currentTarget.value)}\n        />\n      </InlineField>\n      {!!debugFields.length && <DebugFields fields={debugFields} />}\n    </div>\n  );\n};\n\ntype DebugFieldItemProps = {\n  fields: DebugField[];\n};\nconst DebugFields = ({ fields }: DebugFieldItemProps) => {\n  return (\n    <table className={'filter-table'}>\n      <thead>\n        <tr>\n          <th>Name</th>\n          <th>Value</th>\n          <th>Url</th>\n        </tr>\n      </thead>\n      <tbody>\n        {fields.map((field) => {\n          let value: ReactNode = field.value;\n          if (field.error && field.error instanceof Error) {\n            value = field.error.message;\n          } else if (field.href) {\n            value = <a href={field.href}>{value}</a>;\n          }\n          return (\n            <tr key={`${field.name}=${field.value}`}>\n              <td>{field.name}</td>\n              <td>{value}</td>\n              <td>{field.href ? <a href={field.href}>{field.href}</a> : ''}</td>\n            </tr>\n          );\n        })}\n      </tbody>\n    </table>\n  );\n};\n\ntype DebugField = {\n  name: string;\n  error?: unknown;\n  value?: string;\n  href?: string;\n};\n\nfunction makeDebugFields(derivedFields: DerivedFieldConfig[], debugText: string): DebugField[] {\n  return derivedFields\n    .filter((field) => field.name && field.matcherRegex)\n    .map((field) => {\n      try {\n        const testMatch = debugText.match(field.matcherRegex);\n        let href;\n        const value = testMatch && testMatch[1];\n\n        if (value) {\n          href = getTemplateSrv().replace(field.url, {\n            __value: {\n              value: {\n                raw: value,\n              },\n              text: 'Raw value',\n            },\n          });\n        }\n        const debugFiled: DebugField = {\n          name: field.name,\n          value: value || '<no match>',\n          href,\n        };\n        return debugFiled;\n      } catch (error) {\n        return {\n          name: field.name,\n          error,\n        };\n      }\n    });\n}\n","import { css } from '@emotion/css';\nimport { ChangeEvent, useEffect, useState } from 'react';\nimport * as React from 'react';\nimport { usePrevious } from 'react-use';\n\nimport { GrafanaTheme2, DataSourceInstanceSettings, VariableSuggestion } from '@grafana/data';\nimport { DataSourcePicker } from '@grafana/runtime';\nimport { Button, DataLinkInput, Field, Icon, Input, Label, Tooltip, useStyles2, Select, Switch } from '@grafana/ui';\n\nimport { DerivedFieldConfig } from '../types';\n\ntype MatcherType = 'label' | 'regex';\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  row: css`\n    display: flex;\n    align-items: baseline;\n  `,\n  nameField: css`\n    flex: 2;\n    margin-right: ${theme.spacing(0.5)};\n  `,\n  regexField: css`\n    flex: 3;\n    margin-right: ${theme.spacing(0.5)};\n  `,\n  urlField: css`\n    flex: 1;\n    margin-right: ${theme.spacing(0.5)};\n  `,\n  urlDisplayLabelField: css`\n    flex: 1;\n  `,\n  internalLink: css`\n    margin-right: ${theme.spacing(1)};\n  `,\n  dataSource: css``,\n  nameMatcherField: css({\n    width: theme.spacing(20),\n    marginRight: theme.spacing(0.5),\n  }),\n});\n\ntype Props = {\n  value: DerivedFieldConfig;\n  onChange: (value: DerivedFieldConfig) => void;\n  onDelete: () => void;\n  suggestions: VariableSuggestion[];\n  className?: string;\n  validateName: (name: string) => boolean;\n};\nexport const DerivedField = (props: Props) => {\n  const { value, onChange, onDelete, suggestions, className, validateName } = props;\n  const styles = useStyles2(getStyles);\n  const [showInternalLink, setShowInternalLink] = useState(!!value.datasourceUid);\n  const previousUid = usePrevious(value.datasourceUid);\n  const [fieldType, setFieldType] = useState<MatcherType>(value.matcherType ?? 'regex');\n\n  // Force internal link visibility change if uid changed outside of this component.\n  useEffect(() => {\n    if (!previousUid && value.datasourceUid && !showInternalLink) {\n      setShowInternalLink(true);\n    }\n    if (previousUid && !value.datasourceUid && showInternalLink) {\n      setShowInternalLink(false);\n    }\n  }, [previousUid, value.datasourceUid, showInternalLink]);\n\n  const handleChange = (field: keyof typeof value) => (event: React.ChangeEvent<HTMLInputElement>) => {\n    onChange({\n      ...value,\n      [field]: event.currentTarget.value,\n    });\n  };\n\n  const invalidName = !validateName(value.name);\n\n  return (\n    <div className={className} data-testid=\"derived-field\">\n      <div className=\"gf-form\">\n        <Field className={styles.nameField} label=\"Name\" invalid={invalidName} error=\"The name is already in use\">\n          <Input value={value.name} onChange={handleChange('name')} placeholder=\"Field name\" invalid={invalidName} />\n        </Field>\n        <Field\n          className={styles.nameMatcherField}\n          label={\n            <TooltipLabel\n              label=\"Type\"\n              content=\"Derived fields can be created from labels or by applying a regular expression to the log message.\"\n            />\n          }\n        >\n          <Select\n            options={[\n              { label: 'Regex in log line', value: 'regex' },\n              { label: 'Label', value: 'label' },\n            ]}\n            value={fieldType}\n            onChange={(type) => {\n              // make sure this is a valid MatcherType\n              if (type.value === 'label' || type.value === 'regex') {\n                setFieldType(type.value);\n                onChange({\n                  ...value,\n                  matcherType: type.value,\n                });\n              }\n            }}\n          />\n        </Field>\n        <Field\n          className={styles.regexField}\n          label={\n            <>\n              {fieldType === 'regex' && (\n                <TooltipLabel\n                  label=\"Regex\"\n                  content=\"Use to parse and capture some part of the log message. You can use the captured groups in the template.\"\n                />\n              )}\n\n              {fieldType === 'label' && <TooltipLabel label=\"Label\" content=\"Use to derive the field from a label.\" />}\n            </>\n          }\n        >\n          <Input value={value.matcherRegex} onChange={handleChange('matcherRegex')} />\n        </Field>\n        <Field label=\"\">\n          <Button\n            variant=\"destructive\"\n            title=\"Remove field\"\n            icon=\"times\"\n            onClick={(event) => {\n              event.preventDefault();\n              onDelete();\n            }}\n          />\n        </Field>\n      </div>\n\n      <div className=\"gf-form\">\n        <Field label={showInternalLink ? 'Query' : 'URL'} className={styles.urlField}>\n          <DataLinkInput\n            placeholder={showInternalLink ? '${__value.raw}' : 'http://example.com/${__value.raw}'}\n            value={value.url || ''}\n            onChange={(newValue) =>\n              onChange({\n                ...value,\n                url: newValue,\n              })\n            }\n            suggestions={suggestions}\n          />\n        </Field>\n        <Field\n          className={styles.urlDisplayLabelField}\n          label={\n            <TooltipLabel\n              label=\"URL Label\"\n              content=\"Use to override the button label when this derived field is found in a log.\"\n            />\n          }\n        >\n          <Input value={value.urlDisplayLabel} onChange={handleChange('urlDisplayLabel')} />\n        </Field>\n      </div>\n\n      <div className=\"gf-form\">\n        <Field label=\"Internal link\" className={styles.internalLink}>\n          <Switch\n            value={showInternalLink}\n            onChange={(e: ChangeEvent<HTMLInputElement>) => {\n              const { checked } = e.currentTarget;\n              if (!checked) {\n                onChange({\n                  ...value,\n                  datasourceUid: undefined,\n                });\n              }\n              setShowInternalLink(checked);\n            }}\n          />\n        </Field>\n\n        {showInternalLink && (\n          <Field label=\"\" className={styles.dataSource}>\n            <DataSourcePicker\n              tracing={true}\n              onChange={(ds: DataSourceInstanceSettings) =>\n                onChange({\n                  ...value,\n                  datasourceUid: ds.uid,\n                })\n              }\n              current={value.datasourceUid}\n              noDefault\n            />\n          </Field>\n        )}\n      </div>\n    </div>\n  );\n};\n\nconst TooltipLabel = ({ content, label }: { content: string; label: string }) => (\n  <Label>\n    {label}\n    <Tooltip placement=\"top\" content={content} theme=\"info\">\n      <Icon tabIndex={0} name=\"info-circle\" size=\"sm\" style={{ marginLeft: '10px' }} />\n    </Tooltip>\n  </Label>\n);\n","import { css } from '@emotion/css';\nimport { useCallback, useState } from 'react';\n\nimport { GrafanaTheme2, VariableOrigin, DataLinkBuiltInVars } from '@grafana/data';\nimport { ConfigDescriptionLink, ConfigSubSection } from '@grafana/experimental';\nimport { Button, useTheme2 } from '@grafana/ui';\n\nimport { DerivedFieldConfig } from '../types';\n\nimport { DebugSection } from './DebugSection';\nimport { DerivedField } from './DerivedField';\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  addButton: css`\n    margin-right: 10px;\n  `,\n  derivedField: css`\n    margin-bottom: ${theme.spacing(1)};\n  `,\n  container: css`\n    margin-bottom: ${theme.spacing(4)};\n  `,\n  debugSection: css`\n    margin-top: ${theme.spacing(4)};\n  `,\n});\n\ntype Props = {\n  fields?: DerivedFieldConfig[];\n  onChange: (value: DerivedFieldConfig[]) => void;\n};\n\nexport const DerivedFields = ({ fields = [], onChange }: Props) => {\n  const theme = useTheme2();\n  const styles = getStyles(theme);\n\n  const [showDebug, setShowDebug] = useState(false);\n\n  const validateName = useCallback(\n    (name: string) => {\n      return fields.filter((field) => field.name && field.name === name).length <= 1;\n    },\n    [fields]\n  );\n\n  return (\n    <ConfigSubSection\n      title=\"Derived fields\"\n      description={\n        <ConfigDescriptionLink\n          description=\"Derived fields can be used to extract new fields from a log message and create a link from its value.\"\n          suffix=\"loki/configure-loki-data-source/#derived-fields\"\n          feature=\"derived fields\"\n        />\n      }\n    >\n      <div className={styles.container}>\n        {fields.map((field, index) => {\n          return (\n            <DerivedField\n              className={styles.derivedField}\n              key={index}\n              value={field}\n              onChange={(newField) => {\n                const newDerivedFields = [...fields];\n                newDerivedFields.splice(index, 1, newField);\n                onChange(newDerivedFields);\n              }}\n              onDelete={() => {\n                const newDerivedFields = [...fields];\n                newDerivedFields.splice(index, 1);\n                onChange(newDerivedFields);\n              }}\n              validateName={validateName}\n              suggestions={[\n                {\n                  value: DataLinkBuiltInVars.valueRaw,\n                  label: 'Raw value',\n                  documentation: 'Exact string captured by the regular expression',\n                  origin: VariableOrigin.Value,\n                },\n              ]}\n            />\n          );\n        })}\n        <div>\n          <Button\n            variant=\"secondary\"\n            className={styles.addButton}\n            icon=\"plus\"\n            onClick={(event) => {\n              event.preventDefault();\n              const emptyConfig: DerivedFieldConfig = {\n                name: '',\n                matcherRegex: '',\n                urlDisplayLabel: '',\n                url: '',\n                matcherType: 'regex',\n              };\n              const newDerivedFields = [...fields, emptyConfig];\n              onChange(newDerivedFields);\n            }}\n          >\n            Add\n          </Button>\n\n          {fields.length > 0 && (\n            <Button variant=\"secondary\" type=\"button\" onClick={() => setShowDebug(!showDebug)}>\n              {showDebug ? 'Hide example log message' : 'Show example log message'}\n            </Button>\n          )}\n        </div>\n\n        {showDebug && (\n          <div className={styles.debugSection}>\n            <DebugSection\n              className={css`\n                margin-bottom: 10px;\n              `}\n              derivedFields={fields}\n            />\n          </div>\n        )}\n      </div>\n    </ConfigSubSection>\n  );\n};\n","import * as React from 'react';\n\nimport { ConfigDescriptionLink, ConfigSubSection } from '@grafana/experimental';\nimport { config } from '@grafana/runtime';\nimport { Badge, InlineField, InlineFieldRow, Input } from '@grafana/ui';\n\ntype Props = {\n  maxLines: string;\n  onMaxLinedChange: (value: string) => void;\n  predefinedOperations: string;\n  onPredefinedOperationsChange: (value: string) => void;\n};\n\nexport const QuerySettings = (props: Props) => {\n  const { maxLines, onMaxLinedChange, predefinedOperations, onPredefinedOperationsChange } = props;\n  return (\n    <ConfigSubSection\n      title=\"Queries\"\n      description={\n        <ConfigDescriptionLink\n          description=\"Additional options to customize your querying experience.\"\n          suffix=\"loki/configure-loki-data-source/#queries\"\n          feature=\"query settings\"\n        />\n      }\n    >\n      <InlineField\n        label=\"Maximum lines\"\n        htmlFor=\"loki_config_maxLines\"\n        labelWidth={22}\n        tooltip={\n          <>\n            Loki queries must contain a limit of the maximum number of lines returned (default: 1000). Increase this\n            limit to have a bigger result set for ad-hoc analysis. Decrease this limit if your browser becomes sluggish\n            when displaying the log results.\n          </>\n        }\n      >\n        <Input\n          type=\"number\"\n          id=\"loki_config_maxLines\"\n          value={maxLines}\n          onChange={(event: React.FormEvent<HTMLInputElement>) => onMaxLinedChange(event.currentTarget.value)}\n          width={16}\n          placeholder=\"1000\"\n          spellCheck={false}\n        />\n      </InlineField>\n\n      {config.featureToggles.lokiPredefinedOperations && (\n        <InlineFieldRow>\n          <InlineField\n            label=\"Predefined operations\"\n            htmlFor=\"loki_config_predefinedOperations\"\n            labelWidth={22}\n            tooltip={\n              <>\n                {\n                  'Predefined operations are used as an initial state for your queries. They are useful, if you want to unpack, parse or format all log lines. Currently we support only log operations starting with |. For example: | unpack | line_format \"{{.message}}\".'\n                }\n              </>\n            }\n          >\n            <Input\n              type=\"string\"\n              id=\"loki_config_predefinedOperations\"\n              value={predefinedOperations}\n              onChange={(event: React.FormEvent<HTMLInputElement>) =>\n                onPredefinedOperationsChange(event.currentTarget.value)\n              }\n              width={40}\n              placeholder=\"| unpack | line_format\"\n              spellCheck={false}\n            />\n          </InlineField>\n          <InlineField>\n            <Badge\n              text=\"Experimental\"\n              color=\"orange\"\n              icon=\"exclamation-triangle\"\n              tooltip=\"Predefined operations is an experimental feature that may change in the future.\"\n            />\n          </InlineField>\n        </InlineFieldRow>\n      )}\n    </ConfigSubSection>\n  );\n};\n","import { useCallback } from 'react';\n\nimport { DataSourcePluginOptionsEditorProps, DataSourceSettings } from '@grafana/data';\nimport {\n  ConfigSection,\n  DataSourceDescription,\n  ConnectionSettings,\n  Auth,\n  convertLegacyAuthProps,\n  AdvancedHttpSettings,\n} from '@grafana/experimental';\nimport { config, reportInteraction } from '@grafana/runtime';\nimport { Divider, SecureSocksProxySettings, Stack } from '@grafana/ui';\n\nimport { LokiOptions } from '../types';\n\nimport { AlertingSettings } from './AlertingSettings';\nimport { DerivedFields } from './DerivedFields';\nimport { QuerySettings } from './QuerySettings';\n\nexport type Props = DataSourcePluginOptionsEditorProps<LokiOptions>;\n\nconst makeJsonUpdater =\n  <T extends any>(field: keyof LokiOptions) =>\n  (options: DataSourceSettings<LokiOptions>, value: T): DataSourceSettings<LokiOptions> => {\n    return {\n      ...options,\n      jsonData: {\n        ...options.jsonData,\n        [field]: value,\n      },\n    };\n  };\n\nconst setMaxLines = makeJsonUpdater('maxLines');\nconst setPredefinedOperations = makeJsonUpdater('predefinedOperations');\nconst setDerivedFields = makeJsonUpdater('derivedFields');\n\nexport const ConfigEditor = (props: Props) => {\n  const { options, onOptionsChange } = props;\n\n  const updatePredefinedOperations = useCallback(\n    (value: string) => {\n      reportInteraction('grafana_loki_predefined_operations_changed', { value });\n      onOptionsChange(setPredefinedOperations(options, value));\n    },\n    [options, onOptionsChange]\n  );\n\n  return (\n    <>\n      <DataSourceDescription\n        dataSourceName=\"Loki\"\n        docsLink=\"https://grafana.com/docs/grafana/latest/datasources/loki/configure-loki-data-source/\"\n        hasRequiredFields={false}\n      />\n      <Divider spacing={4} />\n      <ConnectionSettings config={options} onChange={onOptionsChange} urlPlaceholder=\"http://localhost:3100\" />\n      <Divider spacing={4} />\n      <Auth\n        {...convertLegacyAuthProps({\n          config: options,\n          onChange: onOptionsChange,\n        })}\n      />\n      <Divider spacing={4} />\n      <ConfigSection\n        title=\"Additional settings\"\n        description=\"Additional settings are optional settings that can be configured for more control over your data source.\"\n        isCollapsible={true}\n        isInitiallyOpen\n      >\n        <Stack gap={5} direction=\"column\">\n          <AdvancedHttpSettings config={options} onChange={onOptionsChange} />\n          {config.secureSocksDSProxyEnabled && (\n            <SecureSocksProxySettings options={options} onOptionsChange={onOptionsChange} />\n          )}\n          <AlertingSettings options={options} onOptionsChange={onOptionsChange} />\n          <QuerySettings\n            maxLines={options.jsonData.maxLines || ''}\n            onMaxLinedChange={(value) => onOptionsChange(setMaxLines(options, value))}\n            predefinedOperations={options.jsonData.predefinedOperations || ''}\n            onPredefinedOperationsChange={updatePredefinedOperations}\n          />\n          <DerivedFields\n            fields={options.jsonData.derivedFields}\n            onChange={(value) => onOptionsChange(setDerivedFields(options, value))}\n          />\n        </Stack>\n      </ConfigSection>\n    </>\n  );\n};\n","import { DashboardLoadedEvent, DataSourcePlugin } from '@grafana/data';\nimport { getAppEvents } from '@grafana/runtime';\n\nimport LokiCheatSheet from './components/LokiCheatSheet';\nimport LokiQueryEditorByApp from './components/LokiQueryEditorByApp';\nimport { ConfigEditor } from './configuration/ConfigEditor';\nimport { LokiDatasource } from './datasource';\nimport { onDashboardLoadedHandler } from './tracking';\nimport { LokiQuery } from './types';\n\nexport const plugin = new DataSourcePlugin(LokiDatasource)\n  .setQueryEditor(LokiQueryEditorByApp)\n  .setConfigEditor(ConfigEditor)\n  .setQueryEditorHelp(LokiCheatSheet);\n\n// Subscribe to on dashboard loaded event so that we can track plugin adoption\ngetAppEvents().subscribe<DashboardLoadedEvent<LokiQuery>>(DashboardLoadedEvent, onDashboardLoadedHandler);\n","import { SyntaxNode } from '@lezer/common';\nimport { escapeRegExp } from 'lodash';\n\nimport {\n  parser,\n  LineFilter,\n  PipeExact,\n  PipeMatch,\n  Filter,\n  String,\n  LabelFormatExpr,\n  Selector,\n  PipelineExpr,\n  LabelParser,\n  JsonExpressionParser,\n  LabelFilter,\n  MetricExpr,\n  Matcher,\n  Identifier,\n  Range,\n  Logfmt,\n  Json,\n  OrFilter,\n  FilterOp,\n} from '@grafana/lezer-logql';\nimport { DataQuery } from '@grafana/schema';\n\nimport { getStreamSelectorPositions, NodePosition } from './modifyQuery';\nimport { ErrorId } from './querybuilder/parsingUtils';\nimport { LokiQuery, LokiQueryType } from './types';\n\n/**\n * Returns search terms from a LogQL query.\n * E.g., `{} |= foo |=bar != baz` returns `['foo', 'bar']`.\n */\nexport function getHighlighterExpressionsFromQuery(input = ''): string[] {\n  const results = [];\n\n  const filters = getNodesFromQuery(input, [LineFilter]);\n\n  for (const filter of filters) {\n    const pipeExact = filter.getChild(Filter)?.getChild(PipeExact);\n    const pipeMatch = filter.getChild(Filter)?.getChild(PipeMatch);\n    const strings = getStringsFromLineFilter(filter);\n\n    if ((!pipeExact && !pipeMatch) || !strings.length) {\n      continue;\n    }\n\n    for (const string of strings) {\n      const filterTerm = input.substring(string.from, string.to).trim();\n      const backtickedTerm = filterTerm[0] === '`';\n      const unwrappedFilterTerm = filterTerm.substring(1, filterTerm.length - 1);\n\n      if (!unwrappedFilterTerm) {\n        continue;\n      }\n\n      let resultTerm = '';\n\n      // Only filter expressions with |~ operator are treated as regular expressions\n      if (pipeMatch) {\n        // When using backticks, Loki doesn't require to escape special characters and we can just push regular expression to highlights array\n        // When using quotes, we have extra backslash escaping and we need to replace \\\\ with \\\n        resultTerm = backtickedTerm ? unwrappedFilterTerm : unwrappedFilterTerm.replace(/\\\\\\\\/g, '\\\\');\n      } else {\n        // We need to escape this string so it is not matched as regular expression\n        resultTerm = escapeRegExp(unwrappedFilterTerm);\n      }\n\n      if (resultTerm) {\n        results.push(resultTerm);\n      }\n    }\n  }\n  return results;\n}\n\nexport function getStringsFromLineFilter(filter: SyntaxNode): SyntaxNode[] {\n  const nodes: SyntaxNode[] = [];\n  let node: SyntaxNode | null = filter;\n  do {\n    const string = node.getChild(String);\n    if (string && !node.getChild(FilterOp)) {\n      nodes.push(string);\n    }\n    node = node.getChild(OrFilter);\n  } while (node != null);\n\n  return nodes;\n}\n\nexport function getNormalizedLokiQuery(query: LokiQuery): LokiQuery {\n  let queryType = getLokiQueryType(query);\n  // instant and range are deprecated, we want to remove them\n  const { instant, range, ...rest } = query;\n\n  // if `query.expr` is not parsable this might throw an error\n  try {\n    if (isLogsQuery(query.expr) && queryType === LokiQueryType.Instant) {\n      queryType = LokiQueryType.Range;\n    }\n  } catch (e) {}\n  return { ...rest, queryType };\n}\n\nexport function getLokiQueryType(query: LokiQuery): LokiQueryType {\n  // we are migrating from `.instant` and `.range` to `.queryType`\n  // this function returns the correct query type\n  const { queryType } = query;\n  const hasValidQueryType =\n    queryType === LokiQueryType.Range || queryType === LokiQueryType.Instant || queryType === LokiQueryType.Stream;\n\n  // if queryType exists, it is respected\n  if (hasValidQueryType) {\n    return queryType;\n  }\n\n  // if no queryType, and instant===true, it's instant\n  if (query.instant === true) {\n    return LokiQueryType.Instant;\n  }\n\n  // otherwise it is range\n  return LokiQueryType.Range;\n}\n\nconst tagsToObscure = ['String', 'Identifier', 'LineComment', 'Number'];\nconst partsToKeep = ['__error__', '__interval', '__interval_ms', '__auto'];\nexport function obfuscate(query: string): string {\n  let obfuscatedQuery: string = query;\n  const tree = parser.parse(query);\n  tree.iterate({\n    enter: ({ name, from, to }): false | void => {\n      const queryPart = query.substring(from, to);\n      if (tagsToObscure.includes(name) && !partsToKeep.includes(queryPart)) {\n        obfuscatedQuery = obfuscatedQuery.replace(queryPart, name);\n      }\n    },\n  });\n  return obfuscatedQuery;\n}\n\nexport function parseToNodeNamesArray(query: string): string[] {\n  const queryParts: string[] = [];\n  const tree = parser.parse(query);\n  tree.iterate({\n    enter: ({ name }): false | void => {\n      queryParts.push(name);\n    },\n  });\n  return queryParts;\n}\n\nexport function isQueryWithNode(query: string, nodeType: number): boolean {\n  let isQueryWithNode = false;\n  const tree = parser.parse(query);\n  tree.iterate({\n    enter: ({ type }): false | void => {\n      if (type.id === nodeType) {\n        isQueryWithNode = true;\n        return false;\n      }\n    },\n  });\n  return isQueryWithNode;\n}\n\nexport function getNodesFromQuery(query: string, nodeTypes?: number[]): SyntaxNode[] {\n  const nodes: SyntaxNode[] = [];\n  const tree = parser.parse(query);\n  tree.iterate({\n    enter: (node): false | void => {\n      if (nodeTypes === undefined || nodeTypes.includes(node.type.id)) {\n        nodes.push(node.node);\n      }\n    },\n  });\n  return nodes;\n}\n\nexport function getNodePositionsFromQuery(query: string, nodeTypes?: number[]): NodePosition[] {\n  const positions: NodePosition[] = [];\n  const tree = parser.parse(query);\n  tree.iterate({\n    enter: (node): false | void => {\n      if (nodeTypes === undefined || nodeTypes.includes(node.type.id)) {\n        positions.push(NodePosition.fromNode(node.node));\n      }\n    },\n  });\n  return positions;\n}\n\nexport function getNodeFromQuery(query: string, nodeType: number): SyntaxNode | undefined {\n  const nodes = getNodesFromQuery(query, [nodeType]);\n  return nodes.length > 0 ? nodes[0] : undefined;\n}\n\n/**\n * Parses the query and looks for error nodes. If there is at least one, it returns true.\n * Grafana variables are considered errors, so if you need to validate a query\n * with variables you should interpolate it first.\n */\nexport function isQueryWithError(query: string): boolean {\n  return isQueryWithNode(query, ErrorId);\n}\n\nexport function isLogsQuery(query: string): boolean {\n  // As a safeguard we are checking for a length of 2, because at least the query should be `{}`\n  return query.trim().length > 2 && !isQueryWithNode(query, MetricExpr);\n}\n\nexport function isQueryWithParser(query: string): { queryWithParser: boolean; parserCount: number } {\n  const nodes = getNodesFromQuery(query, [LabelParser, JsonExpressionParser, Logfmt]);\n  const parserCount = nodes.length;\n  return { queryWithParser: parserCount > 0, parserCount };\n}\n\nexport function getParserFromQuery(query: string): string | undefined {\n  const parsers = getNodesFromQuery(query, [LabelParser, Json, Logfmt]);\n  return parsers.length > 0 ? query.substring(parsers[0].from, parsers[0].to).trim() : undefined;\n}\n\nexport function isQueryPipelineErrorFiltering(query: string): boolean {\n  const labels = getNodesFromQuery(query, [LabelFilter]);\n  for (const node of labels) {\n    const label = node.getChild(Matcher)?.getChild(Identifier);\n    if (label) {\n      const labelName = query.substring(label.from, label.to);\n      if (labelName === '__error__') {\n        return true;\n      }\n    }\n  }\n  return false;\n}\n\nexport function isQueryWithLabelFormat(query: string): boolean {\n  return isQueryWithNode(query, LabelFormatExpr);\n}\n\nexport function getLogQueryFromMetricsQuery(query: string): string {\n  if (isLogsQuery(query)) {\n    return query;\n  }\n\n  // Log query in metrics query composes of Selector & PipelineExpr\n  const selectorNode = getNodeFromQuery(query, Selector);\n  if (!selectorNode) {\n    return '';\n  }\n  const selector = query.substring(selectorNode.from, selectorNode.to);\n\n  const pipelineExprNode = getNodeFromQuery(query, PipelineExpr);\n  const pipelineExpr = pipelineExprNode ? query.substring(pipelineExprNode.from, pipelineExprNode.to) : '';\n\n  return `${selector} ${pipelineExpr}`.trim();\n}\n\nexport function getLogQueryFromMetricsQueryAtPosition(query: string, position: number): string {\n  if (isLogsQuery(query)) {\n    return query;\n  }\n\n  const metricQuery = getNodesFromQuery(query, [MetricExpr])\n    .reverse() // So we don't get the root metric node\n    .find((node) => node.from <= position && node.to >= position);\n  if (!metricQuery) {\n    return '';\n  }\n  return getLogQueryFromMetricsQuery(query.substring(metricQuery.from, metricQuery.to));\n}\n\nexport function isQueryWithLabelFilter(query: string): boolean {\n  return isQueryWithNode(query, LabelFilter);\n}\n\nexport function isQueryWithLineFilter(query: string): boolean {\n  return isQueryWithNode(query, LineFilter);\n}\n\nexport function isQueryWithRangeVariable(query: string): boolean {\n  const rangeNodes = getNodesFromQuery(query, [Range]);\n  for (const node of rangeNodes) {\n    if (query.substring(node.from, node.to).match(/\\[\\$__range(_s|_ms)?/)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport function getStreamSelectorsFromQuery(query: string): string[] {\n  const labelMatcherPositions = getStreamSelectorPositions(query);\n\n  const labelMatchers = labelMatcherPositions.map((labelMatcher) => {\n    return query.slice(labelMatcher.from, labelMatcher.to);\n  });\n\n  return labelMatchers;\n}\n\nexport function requestSupportsSplitting(allQueries: LokiQuery[]) {\n  const queries = allQueries\n    .filter((query) => !query.hide)\n    .filter((query) => !query.refId.includes('do-not-chunk'))\n    .filter((query) => query.expr);\n\n  return queries.length > 0;\n}\n\nexport const isLokiQuery = (query: DataQuery): query is LokiQuery => {\n  if (!query) {\n    return false;\n  }\n\n  return 'expr' in query && query.expr !== undefined;\n};\n\nexport const getLokiQueryFromDataQuery = (query?: DataQuery): LokiQuery | undefined => {\n  if (!query || !isLokiQuery(query)) {\n    return undefined;\n  }\n\n  return query;\n};\n","import { Registry } from '@grafana/data';\nimport { BINARY_OPERATIONS_KEY } from './types.js';\n\nclass QueryModellerBase {\n  constructor(operationDefinitions, innerQueryPlaceholder) {\n    this.categories = [];\n    this.operationsRegistry = new Registry(() => operationDefinitions);\n    this.innerQueryPlaceholder = innerQueryPlaceholder || \"<query>\";\n  }\n  setOperationCategories(categories) {\n    this.categories = categories;\n  }\n  getOperationsForCategory(category) {\n    return this.operationsRegistry.list().filter((op) => op.category === category && !op.hideFromList);\n  }\n  getAlternativeOperations(key) {\n    return this.operationsRegistry.list().filter((op) => op.alternativesKey && op.alternativesKey === key);\n  }\n  getCategories() {\n    return this.categories;\n  }\n  getOperationDefinition(id) {\n    return this.operationsRegistry.getIfExists(id);\n  }\n  hasBinaryOp(query) {\n    return query.operations.find((op) => {\n      const def = this.getOperationDefinition(op.id);\n      return (def == null ? void 0 : def.category) === BINARY_OPERATIONS_KEY;\n    }) !== void 0;\n  }\n}\n\nexport { QueryModellerBase };\n//# sourceMappingURL=QueryModellerBase.js.map\n","import {\n  QueryModellerBase,\n  QueryBuilderLabelFilter,\n  VisualQuery,\n  QueryBuilderOperation,\n  VisualQueryBinary,\n} from '@grafana/experimental';\n\nimport { operationDefinitions } from './operations';\nimport { LokiOperationId, LokiQueryPattern, LokiQueryPatternType, LokiVisualQueryOperationCategory } from './types';\n\nexport class LokiQueryModeller extends QueryModellerBase {\n  constructor() {\n    super(operationDefinitions, '<expr>');\n\n    this.setOperationCategories([\n      LokiVisualQueryOperationCategory.Aggregations,\n      LokiVisualQueryOperationCategory.RangeFunctions,\n      LokiVisualQueryOperationCategory.Formats,\n      LokiVisualQueryOperationCategory.BinaryOps,\n      LokiVisualQueryOperationCategory.LabelFilters,\n      LokiVisualQueryOperationCategory.LineFilters,\n    ]);\n  }\n\n  renderOperations(queryString: string, operations: QueryBuilderOperation[]): string {\n    for (const operation of operations) {\n      const def = this.operationsRegistry.getIfExists(operation.id);\n      if (!def) {\n        console.error(`Could not find operation ${operation.id} in the registry`);\n        continue;\n      }\n      queryString = def.renderer(operation, def, queryString);\n    }\n    return queryString;\n  }\n\n  renderBinaryQueries(queryString: string, binaryQueries?: Array<VisualQueryBinary<VisualQuery>>) {\n    if (binaryQueries) {\n      for (const binQuery of binaryQueries) {\n        queryString = `${this.renderBinaryQuery(queryString, binQuery)}`;\n      }\n    }\n    return queryString;\n  }\n\n  private renderBinaryQuery(leftOperand: string, binaryQuery: VisualQueryBinary<VisualQuery>) {\n    let result = leftOperand + ` ${binaryQuery.operator} `;\n\n    if (binaryQuery.vectorMatches) {\n      result += `${binaryQuery.vectorMatchesType}(${binaryQuery.vectorMatches}) `;\n    }\n\n    return result + this.renderQuery(binaryQuery.query, true);\n  }\n\n  renderLabels(labels: QueryBuilderLabelFilter[]): string {\n    if (labels.length === 0) {\n      return '{}';\n    }\n\n    let expr = '{';\n    for (const filter of labels) {\n      if (expr !== '{') {\n        expr += ', ';\n      }\n\n      expr += `${filter.label}${filter.op}\"${filter.value}\"`;\n    }\n\n    return expr + `}`;\n  }\n\n  renderQuery(query: VisualQuery, nested?: boolean): string {\n    let queryString = this.renderLabels(query.labels);\n    queryString = this.renderOperations(queryString, query.operations);\n\n    if (!nested && this.hasBinaryOp(query) && Boolean(query.binaryQueries?.length)) {\n      queryString = `(${queryString})`;\n    }\n\n    queryString = this.renderBinaryQueries(queryString, query.binaryQueries);\n\n    return queryString;\n  }\n\n  getQueryPatterns(): LokiQueryPattern[] {\n    return [\n      {\n        name: 'Parse log lines with logfmt parser',\n        type: LokiQueryPatternType.Log,\n        // {} | logfmt | __error__=``\n        operations: [\n          { id: LokiOperationId.Logfmt, params: [] },\n          { id: LokiOperationId.LabelFilterNoErrors, params: [] },\n        ],\n      },\n      {\n        name: 'Parse log lines with JSON parser',\n        type: LokiQueryPatternType.Log,\n        // {} | json | __error__=``\n        operations: [\n          { id: LokiOperationId.Json, params: [] },\n          { id: LokiOperationId.LabelFilterNoErrors, params: [] },\n        ],\n      },\n      {\n        name: 'Filter log line and parse with logfmt parser',\n        type: LokiQueryPatternType.Log,\n        // {} |= `` | logfmt | __error__=``\n        operations: [\n          { id: LokiOperationId.LineContains, params: [''] },\n          { id: LokiOperationId.Logfmt, params: [] },\n          { id: LokiOperationId.LabelFilterNoErrors, params: [] },\n        ],\n      },\n      {\n        name: 'Filter log lines and parse with json parser',\n        type: LokiQueryPatternType.Log,\n        // {} |= `` | json | __error__=``\n        operations: [\n          { id: LokiOperationId.LineContains, params: [''] },\n          { id: LokiOperationId.Json, params: [] },\n          { id: LokiOperationId.LabelFilterNoErrors, params: [] },\n        ],\n      },\n      {\n        name: 'Parse log line with logfmt parser and use label filter',\n        type: LokiQueryPatternType.Log,\n        // {} |= `` | logfmt | __error__=`` | label=`value`\n        operations: [\n          { id: LokiOperationId.LineContains, params: [''] },\n          { id: LokiOperationId.Logfmt, params: [] },\n          { id: LokiOperationId.LabelFilterNoErrors, params: [] },\n          { id: LokiOperationId.LabelFilter, params: ['label', '=', 'value'] },\n        ],\n      },\n      {\n        name: 'Parse log lines with nested json',\n        type: LokiQueryPatternType.Log,\n        // {} |= `` | json | line_format `{{ .message}}` | json\n        operations: [\n          { id: LokiOperationId.LineContains, params: [''] },\n          { id: LokiOperationId.Json, params: [] },\n          { id: LokiOperationId.LabelFilterNoErrors, params: [] },\n          { id: LokiOperationId.LineFormat, params: ['{{.message}}'] },\n          { id: LokiOperationId.Json, params: [] },\n          { id: LokiOperationId.LabelFilterNoErrors, params: [] },\n        ],\n      },\n      {\n        name: 'Reformat log lines',\n        type: LokiQueryPatternType.Log,\n        // {} |= `` | logfmt | line_format `{{.message}}`\n        operations: [\n          { id: LokiOperationId.LineContains, params: [''] },\n          { id: LokiOperationId.Logfmt, params: [] },\n          { id: LokiOperationId.LabelFilterNoErrors, params: [] },\n          { id: LokiOperationId.LineFormat, params: ['{{.message}}'] },\n        ],\n      },\n      {\n        name: 'Rename lvl label to level',\n        type: LokiQueryPatternType.Log,\n        // {} |= `` | logfmt | label_format level=lvl\n        operations: [\n          { id: LokiOperationId.LineContains, params: [''] },\n          { id: LokiOperationId.Logfmt, params: [] },\n          { id: LokiOperationId.LabelFilterNoErrors, params: [] },\n          { id: LokiOperationId.LabelFormat, params: ['lvl', 'level'] },\n        ],\n      },\n      {\n        name: 'Query on value inside a log line',\n        type: LokiQueryPatternType.Metric,\n        // sum(sum_over_time({ | logfmt | __error__=`` | unwrap | __error__=`` [$__auto]))\n        operations: [\n          { id: LokiOperationId.LineContains, params: [''] },\n          { id: LokiOperationId.Logfmt, params: [] },\n          { id: LokiOperationId.LabelFilterNoErrors, params: [] },\n          { id: LokiOperationId.Unwrap, params: [''] },\n          { id: LokiOperationId.LabelFilterNoErrors, params: [] },\n          { id: LokiOperationId.SumOverTime, params: ['$__auto'] },\n          { id: LokiOperationId.Sum, params: [] },\n        ],\n      },\n      {\n        name: 'Total requests per label of streams',\n        type: LokiQueryPatternType.Metric,\n        // sum by() (count_over_time({}[$__auto)\n        operations: [\n          { id: LokiOperationId.LineContains, params: [''] },\n          { id: LokiOperationId.CountOverTime, params: ['$__auto'] },\n          { id: LokiOperationId.Sum, params: [] },\n        ],\n      },\n      {\n        name: 'Total requests per parsed label or label of streams',\n        type: LokiQueryPatternType.Metric,\n        // sum by() (count_over_time({}| logfmt | __error__=`` [$__auto))\n        operations: [\n          { id: LokiOperationId.LineContains, params: [''] },\n          { id: LokiOperationId.Logfmt, params: [] },\n          { id: LokiOperationId.LabelFilterNoErrors, params: [] },\n          { id: LokiOperationId.CountOverTime, params: ['$__auto'] },\n          { id: LokiOperationId.Sum, params: [] },\n        ],\n      },\n      {\n        name: 'Bytes used by a log stream',\n        type: LokiQueryPatternType.Metric,\n        // bytes_over_time({}[$__auto])\n        operations: [\n          { id: LokiOperationId.LineContains, params: [''] },\n          { id: LokiOperationId.BytesOverTime, params: ['$__auto'] },\n        ],\n      },\n      {\n        name: 'Count of log lines per stream',\n        type: LokiQueryPatternType.Metric,\n        // count_over_time({}[$__auto])\n        operations: [\n          { id: LokiOperationId.LineContains, params: [''] },\n          { id: LokiOperationId.CountOverTime, params: ['$__auto'] },\n        ],\n      },\n      {\n        name: 'Top N results by label or parsed label',\n        type: LokiQueryPatternType.Metric,\n        // topk(10, sum by () (count_over_time({} | logfmt | __error__=`` [$__auto])))\n        operations: [\n          { id: LokiOperationId.Logfmt, params: [] },\n          { id: LokiOperationId.LabelFilterNoErrors, params: [] },\n          { id: LokiOperationId.CountOverTime, params: ['$__auto'] },\n          { id: LokiOperationId.Sum, params: [] },\n          { id: LokiOperationId.TopK, params: [10] },\n        ],\n      },\n      {\n        name: 'Extracted quantile',\n        type: LokiQueryPatternType.Metric,\n        // quantile_over_time(0.5,{} | logfmt | unwrap latency[$__auto]) by ()\n        operations: [\n          { id: LokiOperationId.Logfmt, params: [] },\n          { id: LokiOperationId.LabelFilterNoErrors, params: [] },\n          { id: LokiOperationId.Unwrap, params: ['latency'] },\n          { id: LokiOperationId.LabelFilterNoErrors, params: [] },\n          { id: LokiOperationId.QuantileOverTime, params: ['$__auto', 0.5] },\n          { id: LokiOperationId.Sum, params: [] },\n        ],\n      },\n    ];\n  }\n}\n\nexport const lokiQueryModeller = new LokiQueryModeller();\n","import {\n  QueryBuilderOperation,\n  QueryBuilderOperationDefinition,\n  QueryBuilderOperationParamDef,\n} from '@grafana/experimental';\n\nimport { defaultAddOperationHandler } from './operationUtils';\nimport { LokiOperationId, LokiVisualQueryOperationCategory } from './types';\n\nexport const binaryScalarDefs = [\n  {\n    id: LokiOperationId.Addition,\n    name: 'Add scalar',\n    sign: '+',\n  },\n  {\n    id: LokiOperationId.Subtraction,\n    name: 'Subtract scalar',\n    sign: '-',\n  },\n  {\n    id: LokiOperationId.MultiplyBy,\n    name: 'Multiply by scalar',\n    sign: '*',\n  },\n  {\n    id: LokiOperationId.DivideBy,\n    name: 'Divide by scalar',\n    sign: '/',\n  },\n  {\n    id: LokiOperationId.Modulo,\n    name: 'Modulo by scalar',\n    sign: '%',\n  },\n  {\n    id: LokiOperationId.Exponent,\n    name: 'Exponent',\n    sign: '^',\n  },\n  {\n    id: LokiOperationId.EqualTo,\n    name: 'Equal to',\n    sign: '==',\n    comparison: true,\n  },\n  {\n    id: LokiOperationId.NotEqualTo,\n    name: 'Not equal to',\n    sign: '!=',\n    comparison: true,\n  },\n  {\n    id: LokiOperationId.GreaterThan,\n    name: 'Greater than',\n    sign: '>',\n    comparison: true,\n  },\n  {\n    id: LokiOperationId.LessThan,\n    name: 'Less than',\n    sign: '<',\n    comparison: true,\n  },\n  {\n    id: LokiOperationId.GreaterOrEqual,\n    name: 'Greater or equal to',\n    sign: '>=',\n    comparison: true,\n  },\n  {\n    id: LokiOperationId.LessOrEqual,\n    name: 'Less or equal to',\n    sign: '<=',\n    comparison: true,\n  },\n];\n\n// Not sure about this one. It could also be a more generic 'Simple math operation' where user specifies\n// both the operator and the operand in a single input\nexport const binaryScalarOperations: QueryBuilderOperationDefinition[] = binaryScalarDefs.map((opDef) => {\n  const params: QueryBuilderOperationParamDef[] = [{ name: 'Value', type: 'number' }];\n  let defaultParams: [number] | [number, boolean] = [2];\n  if (opDef.comparison) {\n    params.push({\n      name: 'Bool',\n      type: 'boolean',\n      description: 'If checked comparison will return 0 or 1 for the value rather than filtering.',\n    });\n    defaultParams = [2, false];\n  }\n\n  return {\n    id: opDef.id,\n    name: opDef.name,\n    params,\n    defaultParams,\n    alternativesKey: 'binary scalar operations',\n    category: LokiVisualQueryOperationCategory.BinaryOps,\n    renderer: getSimpleBinaryRenderer(opDef.sign),\n    addOperationHandler: defaultAddOperationHandler,\n  };\n});\n\nfunction getSimpleBinaryRenderer(operator: string) {\n  return function binaryRenderer(\n    model: QueryBuilderOperation,\n    def: QueryBuilderOperationDefinition,\n    innerExpr: string\n  ) {\n    let param = model.params[0];\n    let bool = '';\n    if (model.params.length === 2) {\n      bool = model.params[1] ? ' bool' : '';\n    }\n\n    return `${innerExpr} ${operator}${bool} ${param}`;\n  };\n}\n","import { useState } from 'react';\n\nimport { DataSourceApi, SelectableValue } from '@grafana/data';\nimport {\n  QueryBuilderLabelFilter,\n  QueryBuilderOperationParamEditorProps,\n  QueryBuilderOperationParamValue,\n  VisualQuery,\n  VisualQueryModeller,\n} from '@grafana/experimental';\nimport { Select } from '@grafana/ui';\n\nimport { getOperationParamId } from '../operationUtils';\n\nexport const LabelParamEditor = ({\n  onChange,\n  index,\n  operationId,\n  value,\n  query,\n  datasource,\n  queryModeller,\n}: QueryBuilderOperationParamEditorProps) => {\n  const [state, setState] = useState<{\n    options?: SelectableValue[];\n    isLoading?: boolean;\n  }>({});\n\n  return (\n    <Select<QueryBuilderOperationParamValue | undefined>\n      inputId={getOperationParamId(operationId, index)}\n      autoFocus={value === ''}\n      openMenuOnFocus\n      onOpenMenu={async () => {\n        setState({ isLoading: true });\n        const options = await loadGroupByLabels(query, datasource, queryModeller);\n        setState({ options, isLoading: undefined });\n      }}\n      isLoading={state.isLoading}\n      allowCustomValue\n      noOptionsMessage=\"No labels found\"\n      loadingMessage=\"Loading labels\"\n      options={state.options}\n      value={toOption(value)}\n      onChange={(value) => onChange(index, value.value!)}\n    />\n  );\n};\n\nasync function loadGroupByLabels(\n  query: VisualQuery,\n  datasource: DataSourceApi,\n  queryModeller: VisualQueryModeller\n): Promise<SelectableValue[]> {\n  let labels: QueryBuilderLabelFilter[] = query.labels;\n\n  const queryString = queryModeller.renderLabels(labels);\n  const result: string[] = await datasource.languageProvider.fetchLabels({ streamSelector: queryString });\n\n  return result.map((x) => ({\n    label: x,\n    value: x,\n  }));\n}\n\nconst toOption = (\n  value: QueryBuilderOperationParamValue | undefined\n): SelectableValue<QueryBuilderOperationParamValue | undefined> => ({ label: value?.toString(), value });\n","import { capitalize } from 'lodash';\nimport pluralize from 'pluralize';\n\nimport {\n  QueryBuilderOperation,\n  QueryBuilderOperationDefinition,\n  QueryBuilderOperationParamDef,\n  QueryBuilderOperationParamValue,\n  VisualQuery,\n  VisualQueryModeller,\n} from '@grafana/experimental';\n\nimport { escapeLabelValueInExactSelector } from '../languageUtils';\nimport { FUNCTIONS } from '../syntax';\n\nimport { LabelParamEditor } from './components/LabelParamEditor';\nimport { LokiOperationId, LokiOperationOrder, LokiVisualQuery, LokiVisualQueryOperationCategory } from './types';\n\nexport function createRangeOperation(\n  name: string,\n  isRangeOperationWithGrouping?: boolean\n): QueryBuilderOperationDefinition {\n  const params = [getRangeVectorParamDef()];\n  const defaultParams = ['$__auto'];\n  let paramChangedHandler = undefined;\n\n  if (name === LokiOperationId.QuantileOverTime) {\n    defaultParams.push('0.95');\n    params.push({\n      name: 'Quantile',\n      type: 'number',\n    });\n  }\n\n  if (isRangeOperationWithGrouping) {\n    params.push({\n      name: 'By label',\n      type: 'string',\n      restParam: true,\n      optional: true,\n    });\n\n    paramChangedHandler = getOnLabelAddedHandler(`__${name}_by`);\n  }\n\n  return {\n    id: name,\n    name: getLokiOperationDisplayName(name),\n    params: params,\n    defaultParams,\n    alternativesKey: 'range function',\n    category: LokiVisualQueryOperationCategory.RangeFunctions,\n    orderRank: LokiOperationOrder.RangeVectorFunction,\n    renderer: operationWithRangeVectorRenderer,\n    addOperationHandler: addLokiOperation,\n    paramChangedHandler,\n    explainHandler: (op, def) => {\n      let opDocs = FUNCTIONS.find((x) => x.insertText === op.id)?.documentation ?? '';\n\n      if (op.params[0] === '$__auto') {\n        return `${opDocs} \\`$__auto\\` is a variable that will be replaced with the [value of step](https://grafana.com/docs/grafana/next/datasources/loki/query-editor/#options) for range queries and with the value of the selected time range (calculated to - from) for instant queries.`;\n      } else {\n        return `${opDocs} The [range vector](https://grafana.com/docs/loki/latest/logql/metric_queries/#range-vector-aggregation) is set to \\`${op.params[0]}\\`.`;\n      }\n    },\n  };\n}\n\nexport function createRangeOperationWithGrouping(name: string): QueryBuilderOperationDefinition[] {\n  const rangeOperation = createRangeOperation(name, true);\n  // Copy range operation params without the last param\n  const params = rangeOperation.params.slice(0, -1);\n  const operations: QueryBuilderOperationDefinition[] = [\n    rangeOperation,\n    {\n      id: `__${name}_by`,\n      name: `${getLokiOperationDisplayName(name)} by`,\n      params: [\n        ...params,\n        {\n          name: 'Label',\n          type: 'string',\n          restParam: true,\n          optional: true,\n          editor: LabelParamEditor,\n        },\n      ],\n      defaultParams: [...rangeOperation.defaultParams, ''],\n      alternativesKey: 'range function with grouping',\n      category: LokiVisualQueryOperationCategory.RangeFunctions,\n      renderer: getRangeAggregationWithGroupingRenderer(name, 'by'),\n      paramChangedHandler: getLastLabelRemovedHandler(name),\n      explainHandler: getAggregationExplainer(name, 'by'),\n      addOperationHandler: addLokiOperation,\n      hideFromList: true,\n    },\n    {\n      id: `__${name}_without`,\n      name: `${getLokiOperationDisplayName(name)} without`,\n      params: [\n        ...params,\n        {\n          name: 'Label',\n          type: 'string',\n          restParam: true,\n          optional: true,\n          editor: LabelParamEditor,\n        },\n      ],\n      defaultParams: [...rangeOperation.defaultParams, ''],\n      alternativesKey: 'range function with grouping',\n      category: LokiVisualQueryOperationCategory.RangeFunctions,\n      renderer: getRangeAggregationWithGroupingRenderer(name, 'without'),\n      paramChangedHandler: getLastLabelRemovedHandler(name),\n      explainHandler: getAggregationExplainer(name, 'without'),\n      addOperationHandler: addLokiOperation,\n      hideFromList: true,\n    },\n  ];\n\n  return operations;\n}\n\nexport function getRangeAggregationWithGroupingRenderer(aggregation: string, grouping: 'by' | 'without') {\n  return function aggregationRenderer(\n    model: QueryBuilderOperation,\n    def: QueryBuilderOperationDefinition,\n    innerExpr: string\n  ) {\n    const restParamIndex = def.params.findIndex((param) => param.restParam);\n    const params = model.params.slice(0, restParamIndex);\n    const restParams = model.params.slice(restParamIndex);\n\n    if (params.length === 2 && aggregation === LokiOperationId.QuantileOverTime) {\n      return `${aggregation}(${params[1]}, ${innerExpr} [${params[0]}]) ${grouping} (${restParams.join(', ')})`;\n    }\n\n    return `${aggregation}(${innerExpr} [${params[0]}]) ${grouping} (${restParams.join(', ')})`;\n  };\n}\n\nfunction operationWithRangeVectorRenderer(\n  model: QueryBuilderOperation,\n  def: QueryBuilderOperationDefinition,\n  innerExpr: string\n) {\n  const params = model.params ?? [];\n  const rangeVector = params[0] ?? '$__auto';\n  // QuantileOverTime is only range vector with more than one param\n  if (params.length === 2 && model.id === LokiOperationId.QuantileOverTime) {\n    const quantile = params[1];\n    return `${model.id}(${quantile}, ${innerExpr} [${rangeVector}])`;\n  }\n\n  return `${model.id}(${innerExpr} [${params[0] ?? '$__auto'}])`;\n}\n\nexport function labelFilterRenderer(\n  model: QueryBuilderOperation,\n  def: QueryBuilderOperationDefinition,\n  innerExpr: string\n) {\n  const integerOperators = ['<', '<=', '>', '>='];\n\n  if (integerOperators.includes(String(model.params[1]))) {\n    return `${innerExpr} | ${model.params[0]} ${model.params[1]} ${model.params[2]}`;\n  }\n\n  return `${innerExpr} | ${model.params[0]} ${model.params[1]} \\`${model.params[2]}\\``;\n}\n\nexport function isConflictingFilter(\n  operation: QueryBuilderOperation,\n  queryOperations: QueryBuilderOperation[]\n): boolean {\n  if (!operation) {\n    return false;\n  }\n  const operationIsNegative = operation.params[1].toString().startsWith('!');\n\n  const candidates = queryOperations.filter(\n    (queryOperation) =>\n      queryOperation.id === LokiOperationId.LabelFilter &&\n      queryOperation.params[0] === operation.params[0] &&\n      queryOperation.params[2] === operation.params[2]\n  );\n\n  const conflict = candidates.some((candidate) => {\n    if (operationIsNegative && candidate.params[1].toString().startsWith('!') === false) {\n      return true;\n    }\n    if (operationIsNegative === false && candidate.params[1].toString().startsWith('!')) {\n      return true;\n    }\n    return false;\n  });\n\n  return conflict;\n}\n\nexport function pipelineRenderer(\n  model: QueryBuilderOperation,\n  def: QueryBuilderOperationDefinition,\n  innerExpr: string\n) {\n  switch (model.id) {\n    case LokiOperationId.Logfmt:\n      const [strict = false, keepEmpty = false, ...labels] = model.params;\n      return `${innerExpr} | logfmt${strict ? ' --strict' : ''}${keepEmpty ? ' --keep-empty' : ''} ${labels\n        .filter((label) => label)\n        .join(', ')}`.trim();\n    case LokiOperationId.Json:\n      return `${innerExpr} | json ${model.params.filter((param) => param).join(', ')}`.trim();\n    case LokiOperationId.Drop:\n      return `${innerExpr} | drop ${model.params.filter((param) => param).join(', ')}`.trim();\n    case LokiOperationId.Keep:\n      return `${innerExpr} | keep ${model.params.filter((param) => param).join(', ')}`.trim();\n    default:\n      return `${innerExpr} | ${model.id}`;\n  }\n}\n\nfunction isRangeVectorFunction(def: QueryBuilderOperationDefinition) {\n  return def.category === LokiVisualQueryOperationCategory.RangeFunctions;\n}\n\nfunction getIndexOfOrLast(\n  operations: QueryBuilderOperation[],\n  queryModeller: VisualQueryModeller,\n  condition: (def: QueryBuilderOperationDefinition) => boolean\n) {\n  const index = operations.findIndex((x) => {\n    const opDef = queryModeller.getOperationDefinition(x.id);\n    if (!opDef) {\n      return false;\n    }\n    return condition(opDef);\n  });\n\n  return index === -1 ? operations.length : index;\n}\n\nexport function addLokiOperation(\n  def: QueryBuilderOperationDefinition,\n  query: LokiVisualQuery,\n  modeller: VisualQueryModeller\n): LokiVisualQuery {\n  const newOperation: QueryBuilderOperation = {\n    id: def.id,\n    params: def.defaultParams,\n  };\n\n  const operations = [...query.operations];\n\n  const existingRangeVectorFunction = operations.find((x) => {\n    const opDef = modeller.getOperationDefinition(x.id);\n    if (!opDef) {\n      return false;\n    }\n    return isRangeVectorFunction(opDef);\n  });\n\n  switch (def.category) {\n    case LokiVisualQueryOperationCategory.Aggregations:\n    case LokiVisualQueryOperationCategory.Functions:\n      // If we are adding a function but we have not range vector function yet add one\n      if (!existingRangeVectorFunction) {\n        const placeToInsert = getIndexOfOrLast(\n          operations,\n          modeller,\n          (def) => def.category === LokiVisualQueryOperationCategory.Functions\n        );\n        operations.splice(placeToInsert, 0, { id: LokiOperationId.Rate, params: ['$__auto'] });\n      }\n      operations.push(newOperation);\n      break;\n    case LokiVisualQueryOperationCategory.RangeFunctions:\n      // If adding a range function and range function is already added replace it\n      if (existingRangeVectorFunction) {\n        const index = operations.indexOf(existingRangeVectorFunction);\n        operations[index] = newOperation;\n        break;\n      }\n\n    // Add range functions after any formats, line filters and label filters\n    default:\n      const placeToInsert = getIndexOfOrLast(\n        operations,\n        modeller,\n        (x) => (def.orderRank ?? 100) < (x.orderRank ?? 100)\n      );\n      operations.splice(placeToInsert, 0, newOperation);\n      break;\n  }\n\n  return {\n    ...query,\n    operations,\n  };\n}\n\nexport function addNestedQueryHandler(def: QueryBuilderOperationDefinition, query: LokiVisualQuery): LokiVisualQuery {\n  return {\n    ...query,\n    binaryQueries: [\n      ...(query.binaryQueries ?? []),\n      {\n        operator: '/',\n        query,\n      },\n    ],\n  };\n}\n\nexport function getLineFilterRenderer(operation: string, caseInsensitive?: boolean) {\n  return function lineFilterRenderer(\n    model: QueryBuilderOperation,\n    def: QueryBuilderOperationDefinition,\n    innerExpr: string\n  ) {\n    const hasBackticks = model.params.some((param) => typeof param === 'string' && param.includes('`'));\n    const delimiter = hasBackticks ? '\"' : '`';\n    let params;\n    if (hasBackticks) {\n      params = model.params.map((param) =>\n        typeof param === 'string' ? escapeLabelValueInExactSelector(param) : param\n      );\n    } else {\n      params = model.params;\n    }\n    if (caseInsensitive) {\n      return `${innerExpr} ${operation} ${delimiter}(?i)${params.join(`${delimiter} or ${delimiter}(?i)`)}${delimiter}`;\n    }\n    return `${innerExpr} ${operation} ${delimiter}${params.join(`${delimiter} or ${delimiter}`)}${delimiter}`;\n  };\n}\nfunction getRangeVectorParamDef(): QueryBuilderOperationParamDef {\n  return {\n    name: 'Range',\n    type: 'string',\n    options: ['$__auto', '1m', '5m', '10m', '1h', '24h'],\n  };\n}\n\nexport function getOperationParamId(operationId: string, paramIndex: number) {\n  return `operations.${operationId}.param.${paramIndex}`;\n}\n\nexport function getOnLabelAddedHandler(changeToOperationId: string) {\n  return function onParamChanged(index: number, op: QueryBuilderOperation, def: QueryBuilderOperationDefinition) {\n    // Check if we actually have the label param. As it's optional the aggregation can have one less, which is the\n    // case of just simple aggregation without label. When user adds the label it now has the same number of params\n    // as its definition, and now we can change it to its `_by` variant.\n    if (op.params.length === def.params.length) {\n      return {\n        ...op,\n        id: changeToOperationId,\n      };\n    }\n    return op;\n  };\n}\n\n/**\n * Very simple poc implementation, needs to be modified to support all aggregation operators\n */\nexport function getAggregationExplainer(aggregationName: string, mode: 'by' | 'without' | '') {\n  return function aggregationExplainer(model: QueryBuilderOperation) {\n    const labels = model.params.map((label) => `\\`${label}\\``).join(' and ');\n    const labelWord = pluralize('label', model.params.length);\n\n    switch (mode) {\n      case 'by':\n        return `Calculates ${aggregationName} over dimensions while preserving ${labelWord} ${labels}.`;\n      case 'without':\n        return `Calculates ${aggregationName} over the dimensions ${labels}. All other labels are preserved.`;\n      default:\n        return `Calculates ${aggregationName} over the dimensions.`;\n    }\n  };\n}\n\n/**\n * This function will transform operations without labels to their plan aggregation operation\n */\nexport function getLastLabelRemovedHandler(changeToOperationId: string) {\n  return function onParamChanged(index: number, op: QueryBuilderOperation, def: QueryBuilderOperationDefinition) {\n    // If definition has more params then is defined there are no optional rest params anymore.\n    // We then transform this operation into a different one\n    if (op.params.length < def.params.length) {\n      return {\n        ...op,\n        id: changeToOperationId,\n      };\n    }\n\n    return op;\n  };\n}\n\nexport function getLokiOperationDisplayName(funcName: string) {\n  return capitalize(funcName.replace(/_/g, ' '));\n}\n\nexport function defaultAddOperationHandler<T extends VisualQuery>(def: QueryBuilderOperationDefinition, query: T) {\n  const newOperation: QueryBuilderOperation = {\n    id: def.id,\n    params: def.defaultParams,\n  };\n\n  return {\n    ...query,\n    operations: [...query.operations, newOperation],\n  };\n}\n\nexport function createAggregationOperation(\n  name: string,\n  overrides: Partial<QueryBuilderOperationDefinition> = {}\n): QueryBuilderOperationDefinition[] {\n  const operations: QueryBuilderOperationDefinition[] = [\n    {\n      id: name,\n      name: getLokiOperationDisplayName(name),\n      params: [\n        {\n          name: 'By label',\n          type: 'string',\n          restParam: true,\n          optional: true,\n        },\n      ],\n      defaultParams: [],\n      alternativesKey: 'plain aggregations',\n      category: LokiVisualQueryOperationCategory.Aggregations,\n      renderer: functionRendererLeft,\n      paramChangedHandler: getOnLabelAddedHandler(`__${name}_by`),\n      explainHandler: getAggregationExplainer(name, ''),\n      addOperationHandler: defaultAddOperationHandler,\n      ...overrides,\n    },\n    {\n      id: `__${name}_by`,\n      name: `${getLokiOperationDisplayName(name)} by`,\n      params: [\n        {\n          name: 'Label',\n          type: 'string',\n          restParam: true,\n          optional: true,\n          editor: LabelParamEditor,\n        },\n      ],\n      defaultParams: [''],\n      alternativesKey: 'aggregations by',\n      category: LokiVisualQueryOperationCategory.Aggregations,\n      renderer: getAggregationByRenderer(name),\n      paramChangedHandler: getLastLabelRemovedHandler(name),\n      explainHandler: getAggregationExplainer(name, 'by'),\n      addOperationHandler: defaultAddOperationHandler,\n      hideFromList: true,\n      ...overrides,\n    },\n    {\n      id: `__${name}_without`,\n      name: `${getLokiOperationDisplayName(name)} without`,\n      params: [\n        {\n          name: 'Label',\n          type: 'string',\n          restParam: true,\n          optional: true,\n          editor: LabelParamEditor,\n        },\n      ],\n      defaultParams: [''],\n      alternativesKey: 'aggregations by',\n      category: LokiVisualQueryOperationCategory.Aggregations,\n      renderer: getAggregationWithoutRenderer(name),\n      paramChangedHandler: getLastLabelRemovedHandler(name),\n      explainHandler: getAggregationExplainer(name, 'without'),\n      addOperationHandler: defaultAddOperationHandler,\n      hideFromList: true,\n      ...overrides,\n    },\n  ];\n\n  return operations;\n}\n\nfunction getAggregationWithoutRenderer(aggregation: string) {\n  return function aggregationRenderer(\n    model: QueryBuilderOperation,\n    def: QueryBuilderOperationDefinition,\n    innerExpr: string\n  ) {\n    return `${aggregation} without(${model.params.join(', ')}) (${innerExpr})`;\n  };\n}\n\nexport function functionRendererLeft(\n  model: QueryBuilderOperation,\n  def: QueryBuilderOperationDefinition,\n  innerExpr: string\n) {\n  const params = renderParams(model, def, innerExpr);\n  const str = model.id + '(';\n\n  if (innerExpr) {\n    params.push(innerExpr);\n  }\n\n  return str + params.join(', ') + ')';\n}\n\nfunction renderParams(model: QueryBuilderOperation, def: QueryBuilderOperationDefinition, innerExpr: string) {\n  return (model.params ?? []).map((value, index) => {\n    const paramDef = def.params[index];\n    if (paramDef.type === 'string') {\n      return '\"' + value + '\"';\n    }\n\n    return value;\n  });\n}\n\nfunction getAggregationByRenderer(aggregation: string) {\n  return function aggregationRenderer(\n    model: QueryBuilderOperation,\n    def: QueryBuilderOperationDefinition,\n    innerExpr: string\n  ) {\n    return `${aggregation} by(${model.params.join(', ')}) (${innerExpr})`;\n  };\n}\n\nexport function createAggregationOperationWithParam(\n  name: string,\n  paramsDef: { params: QueryBuilderOperationParamDef[]; defaultParams: QueryBuilderOperationParamValue[] },\n  overrides: Partial<QueryBuilderOperationDefinition> = {}\n): QueryBuilderOperationDefinition[] {\n  const operations = createAggregationOperation(name, overrides);\n  operations[0].params.unshift(...paramsDef.params);\n  operations[1].params.unshift(...paramsDef.params);\n  operations[2].params.unshift(...paramsDef.params);\n  operations[0].defaultParams = paramsDef.defaultParams;\n  operations[1].defaultParams = [...paramsDef.defaultParams, ''];\n  operations[2].defaultParams = [...paramsDef.defaultParams, ''];\n  operations[1].renderer = getAggregationByRendererWithParameter(name);\n  operations[2].renderer = getAggregationByRendererWithParameter(name);\n  return operations;\n}\n\nfunction getAggregationByRendererWithParameter(aggregation: string) {\n  return function aggregationRenderer(\n    model: QueryBuilderOperation,\n    def: QueryBuilderOperationDefinition,\n    innerExpr: string\n  ) {\n    const restParamIndex = def.params.findIndex((param) => param.restParam);\n    const params = model.params.slice(0, restParamIndex);\n    const restParams = model.params.slice(restParamIndex);\n\n    return `${aggregation} by(${restParams.join(', ')}) (${params\n      .map((param, idx) => (def.params[idx].type === 'string' ? `\\\"${param}\\\"` : param))\n      .join(', ')}, ${innerExpr})`;\n  };\n}\n","import { useState } from 'react';\n\nimport { SelectableValue, getDefaultTimeRange, toOption } from '@grafana/data';\nimport { QueryBuilderOperationParamEditorProps, VisualQueryModeller } from '@grafana/experimental';\nimport { config } from '@grafana/runtime';\nimport { Select } from '@grafana/ui';\n\nimport { placeHolderScopedVars } from '../../components/monaco-query-field/monaco-completion-provider/validation';\nimport { LokiDatasource } from '../../datasource';\nimport { getLogQueryFromMetricsQuery, isQueryWithError } from '../../queryUtils';\nimport { extractUnwrapLabelKeysFromDataFrame } from '../../responseUtils';\nimport { getOperationParamId } from '../operationUtils';\nimport { LokiVisualQuery } from '../types';\n\nexport function UnwrapParamEditor({\n  onChange,\n  index,\n  operationId,\n  value,\n  query,\n  datasource,\n  timeRange,\n  queryModeller,\n}: QueryBuilderOperationParamEditorProps) {\n  const [state, setState] = useState<{\n    options?: Array<SelectableValue<string>>;\n    isLoading?: boolean;\n  }>({});\n\n  return (\n    <Select\n      inputId={getOperationParamId(operationId, index)}\n      onOpenMenu={async () => {\n        // This check is always true, we do it to make typescript happy\n        if (datasource instanceof LokiDatasource && config.featureToggles.lokiQueryHints) {\n          setState({ isLoading: true });\n          const options = await loadUnwrapOptions(query, datasource, queryModeller, timeRange);\n          setState({ options, isLoading: undefined });\n        }\n      }}\n      isLoading={state.isLoading}\n      allowCustomValue\n      noOptionsMessage=\"No labels found\"\n      loadingMessage=\"Loading labels\"\n      options={state.options}\n      value={value ? toOption(value.toString()) : null}\n      onChange={(value) => {\n        if (value.value) {\n          onChange(index, value.value);\n        }\n      }}\n    />\n  );\n}\n\nasync function loadUnwrapOptions(\n  query: LokiVisualQuery,\n  datasource: LokiDatasource,\n  queryModeller: VisualQueryModeller,\n  timeRange = getDefaultTimeRange()\n): Promise<Array<SelectableValue<string>>> {\n  const queryExpr = queryModeller.renderQuery(query);\n  const logExpr = getLogQueryFromMetricsQuery(queryExpr);\n  if (isQueryWithError(datasource.interpolateString(logExpr, placeHolderScopedVars))) {\n    return [];\n  }\n\n  const samples = await datasource.getDataSamples({ expr: logExpr, refId: 'unwrap_samples' }, timeRange);\n  const unwrapLabels = extractUnwrapLabelKeysFromDataFrame(samples[0]);\n\n  const labelOptions = unwrapLabels.map((label) => ({\n    label,\n    value: label,\n  }));\n\n  return labelOptions;\n}\n","import { QueryBuilderOperationDefinition, QueryBuilderOperationParamValue } from '@grafana/experimental';\n\nimport { binaryScalarOperations } from './binaryScalarOperations';\nimport { UnwrapParamEditor } from './components/UnwrapParamEditor';\nimport {\n  addLokiOperation,\n  addNestedQueryHandler,\n  createAggregationOperation,\n  createAggregationOperationWithParam,\n  createRangeOperation,\n  createRangeOperationWithGrouping,\n  getLineFilterRenderer,\n  labelFilterRenderer,\n  pipelineRenderer,\n} from './operationUtils';\nimport { LokiOperationId, LokiOperationOrder, lokiOperators, LokiVisualQueryOperationCategory } from './types';\n\nfunction getOperationDefinitions(): QueryBuilderOperationDefinition[] {\n  const aggregations = [\n    LokiOperationId.Sum,\n    LokiOperationId.Min,\n    LokiOperationId.Max,\n    LokiOperationId.Avg,\n    LokiOperationId.Stddev,\n    LokiOperationId.Stdvar,\n    LokiOperationId.Count,\n  ].flatMap((opId) =>\n    createAggregationOperation(opId, {\n      addOperationHandler: addLokiOperation,\n      orderRank: LokiOperationOrder.Last,\n    })\n  );\n\n  const aggregationsWithParam = [LokiOperationId.TopK, LokiOperationId.BottomK].flatMap((opId) => {\n    return createAggregationOperationWithParam(\n      opId,\n      {\n        params: [{ name: 'K-value', type: 'number' }],\n        defaultParams: [5],\n      },\n      {\n        addOperationHandler: addLokiOperation,\n        orderRank: LokiOperationOrder.Last,\n      }\n    );\n  });\n\n  const rangeOperations = [\n    createRangeOperation(LokiOperationId.Rate),\n    createRangeOperation(LokiOperationId.RateCounter),\n    createRangeOperation(LokiOperationId.CountOverTime),\n    createRangeOperation(LokiOperationId.SumOverTime),\n    createRangeOperation(LokiOperationId.BytesRate),\n    createRangeOperation(LokiOperationId.BytesOverTime),\n    createRangeOperation(LokiOperationId.AbsentOverTime),\n  ];\n\n  const rangeOperationsWithGrouping = [\n    ...createRangeOperationWithGrouping(LokiOperationId.AvgOverTime),\n    ...createRangeOperationWithGrouping(LokiOperationId.MaxOverTime),\n    ...createRangeOperationWithGrouping(LokiOperationId.MinOverTime),\n    ...createRangeOperationWithGrouping(LokiOperationId.FirstOverTime),\n    ...createRangeOperationWithGrouping(LokiOperationId.LastOverTime),\n    ...createRangeOperationWithGrouping(LokiOperationId.StdvarOverTime),\n    ...createRangeOperationWithGrouping(LokiOperationId.StddevOverTime),\n    ...createRangeOperationWithGrouping(LokiOperationId.QuantileOverTime),\n  ];\n\n  const list: QueryBuilderOperationDefinition[] = [\n    ...aggregations,\n    ...aggregationsWithParam,\n    ...rangeOperations,\n    ...rangeOperationsWithGrouping,\n    {\n      id: LokiOperationId.Json,\n      name: 'Json',\n      params: [\n        {\n          name: 'Expression',\n          type: 'string',\n          restParam: true,\n          optional: true,\n          minWidth: 18,\n          placeholder: 'server=\"servers[0]\"',\n          description:\n            'Using expressions with your json parser will extract only the specified json fields to labels. You can specify one or more expressions in this way. All expressions must be quoted.',\n        },\n      ],\n      defaultParams: [],\n      alternativesKey: 'format',\n      category: LokiVisualQueryOperationCategory.Formats,\n      orderRank: LokiOperationOrder.Parsers,\n      renderer: pipelineRenderer,\n      addOperationHandler: addLokiOperation,\n      explainHandler: () =>\n        `This will extract keys and values from a [json](https://grafana.com/docs/loki/latest/logql/log_queries/#json) formatted log line as labels. The extracted labels can be used in label filter expressions and used as values for a range aggregation via the unwrap operation.`,\n    },\n    {\n      id: LokiOperationId.Logfmt,\n      name: 'Logfmt',\n      params: [\n        {\n          name: 'Strict',\n          type: 'boolean',\n          optional: true,\n          description:\n            'With strict parsing enabled, the logfmt parser immediately stops scanning the log line and returns early with an error when it encounters any poorly formatted key/value pair.',\n        },\n        {\n          name: 'Keep empty',\n          type: 'boolean',\n          optional: true,\n          description:\n            'The logfmt parser retains standalone keys (keys without a value) as labels with its value set to empty string. ',\n        },\n        {\n          name: 'Expression',\n          type: 'string',\n          optional: true,\n          restParam: true,\n          minWidth: 18,\n          placeholder: 'field_name',\n          description:\n            'Using expressions with your logfmt parser will extract and rename (if provided) only the specified fields to labels. You can specify one or more expressions in this way.',\n        },\n      ],\n      defaultParams: [false, false],\n      alternativesKey: 'format',\n      category: LokiVisualQueryOperationCategory.Formats,\n      orderRank: LokiOperationOrder.Parsers,\n      renderer: pipelineRenderer,\n      addOperationHandler: addLokiOperation,\n      explainHandler: () =>\n        `This will extract all keys and values from a [logfmt](https://grafana.com/docs/loki/latest/logql/log_queries/#logfmt) formatted log line as labels. The extracted labels can be used in label filter expressions and used as values for a range aggregation via the unwrap operation.`,\n    },\n    {\n      id: LokiOperationId.Regexp,\n      name: 'Regexp',\n      params: [\n        {\n          name: 'String',\n          type: 'string',\n          hideName: true,\n          placeholder: '<re>',\n          description: 'The regexp expression that matches the structure of a log line.',\n          minWidth: 20,\n        },\n      ],\n      defaultParams: [''],\n      alternativesKey: 'format',\n      category: LokiVisualQueryOperationCategory.Formats,\n      orderRank: LokiOperationOrder.Parsers,\n      renderer: (model, def, innerExpr) => `${innerExpr} | regexp \\`${model.params[0]}\\``,\n      addOperationHandler: addLokiOperation,\n      explainHandler: () =>\n        `The [regexp parser](https://grafana.com/docs/loki/latest/logql/log_queries/#regular-expression) takes a single parameter | regexp \"<re>\" which is the regular expression using the Golang RE2 syntax. The regular expression must contain a least one named sub-match (e.g (?P<name>re)), each sub-match will extract a different label. The expression matches the structure of a log line. The extracted labels can be used in label filter expressions and used as values for a range aggregation via the unwrap operation.`,\n    },\n    {\n      id: LokiOperationId.Pattern,\n      name: 'Pattern',\n      params: [\n        {\n          name: 'String',\n          type: 'string',\n          hideName: true,\n          placeholder: '<pattern-expression>',\n          description: 'The expression that matches the structure of a log line.',\n          minWidth: 20,\n        },\n      ],\n      defaultParams: [''],\n      alternativesKey: 'format',\n      category: LokiVisualQueryOperationCategory.Formats,\n      orderRank: LokiOperationOrder.Parsers,\n      renderer: (model, def, innerExpr) => `${innerExpr} | pattern \\`${model.params[0]}\\``,\n      addOperationHandler: addLokiOperation,\n      explainHandler: () =>\n        `The [pattern parser](https://grafana.com/docs/loki/latest/logql/log_queries/#pattern) allows the explicit extraction of fields from log lines by defining a pattern expression (| pattern \\`<pattern-expression>\\`). The expression matches the structure of a log line. The extracted labels can be used in label filter expressions and used as values for a range aggregation via the unwrap operation.`,\n    },\n    {\n      id: LokiOperationId.Unpack,\n      name: 'Unpack',\n      params: [],\n      defaultParams: [],\n      alternativesKey: 'format',\n      category: LokiVisualQueryOperationCategory.Formats,\n      orderRank: LokiOperationOrder.Parsers,\n      renderer: pipelineRenderer,\n      addOperationHandler: addLokiOperation,\n      explainHandler: () =>\n        `This will extract all keys and values from a JSON log line, [unpacking](https://grafana.com/docs/loki/latest/logql/log_queries/#unpack) all embedded labels in the pack stage. The extracted labels can be used in label filter expressions and used as values for a range aggregation via the unwrap operation.`,\n    },\n    {\n      id: LokiOperationId.LineFormat,\n      name: 'Line format',\n      params: [\n        {\n          name: 'String',\n          type: 'string',\n          hideName: true,\n          placeholder: '{{.status_code}}',\n          description: 'A line template that can refer to stream labels and extracted labels.',\n          minWidth: 20,\n        },\n      ],\n      defaultParams: [''],\n      alternativesKey: 'format',\n      category: LokiVisualQueryOperationCategory.Formats,\n      orderRank: LokiOperationOrder.PipeOperations,\n      renderer: (model, def, innerExpr) => `${innerExpr} | line_format \\`${model.params[0]}\\``,\n      addOperationHandler: addLokiOperation,\n      explainHandler: () =>\n        `This will replace log line using a specified template. The template can refer to stream labels and extracted labels.\n\nExample: \\`{{.status_code}} - {{.message}}\\`\n\n[Read the docs](https://grafana.com/docs/loki/latest/logql/log_queries/#line-format-expression) for more.\n        `,\n    },\n    {\n      id: LokiOperationId.LabelFormat,\n      name: 'Label format',\n      params: [\n        { name: 'Label', type: 'string' },\n        { name: 'Rename to', type: 'string' },\n      ],\n      defaultParams: ['', ''],\n      alternativesKey: 'format',\n      category: LokiVisualQueryOperationCategory.Formats,\n      orderRank: LokiOperationOrder.PipeOperations,\n      renderer: (model, def, innerExpr) => `${innerExpr} | label_format ${model.params[1]}=${model.params[0]}`,\n      addOperationHandler: addLokiOperation,\n      explainHandler: () =>\n        `This will change name of label to desired new label. In the example below, label \"error_level\" will be renamed to \"level\".\n\nExample: \\`\\`error_level=\\`level\\` \\`\\`\n\n[Read the docs](https://grafana.com/docs/loki/latest/logql/log_queries/#labels-format-expression) for more.\n        `,\n    },\n\n    {\n      id: LokiOperationId.LineContains,\n      name: 'Line contains',\n      params: [\n        {\n          name: '',\n          type: 'string',\n          hideName: true,\n          restParam: true,\n          placeholder: 'Text to find',\n          description: 'Find log lines that contains this text',\n          minWidth: 20,\n          runQueryOnEnter: true,\n        },\n      ],\n      defaultParams: [''],\n      alternativesKey: 'line filter',\n      category: LokiVisualQueryOperationCategory.LineFilters,\n      orderRank: LokiOperationOrder.LineFilters,\n      renderer: getLineFilterRenderer('|='),\n      addOperationHandler: addLokiOperation,\n      explainHandler: (op) => `Return log lines that contain string \\`${op.params?.join('`, or `')}\\`.`,\n    },\n    {\n      id: LokiOperationId.LineContainsNot,\n      name: 'Line does not contain',\n      params: [\n        {\n          name: '',\n          type: 'string',\n          hideName: true,\n          restParam: true,\n          placeholder: 'Text to exclude',\n          description: 'Find log lines that does not contain this text',\n          minWidth: 26,\n          runQueryOnEnter: true,\n        },\n      ],\n      defaultParams: [''],\n      alternativesKey: 'line filter',\n      category: LokiVisualQueryOperationCategory.LineFilters,\n      orderRank: LokiOperationOrder.LineFilters,\n      renderer: getLineFilterRenderer('!='),\n      addOperationHandler: addLokiOperation,\n      explainHandler: (op) => `Return log lines that does not contain string \\`${op.params?.join('`, or `')}\\`.`,\n    },\n    {\n      id: LokiOperationId.LineContainsCaseInsensitive,\n      name: 'Line contains case insensitive',\n      params: [\n        {\n          name: '',\n          type: 'string',\n          hideName: true,\n          restParam: true,\n          placeholder: 'Text to find',\n          description: 'Find log lines that contains this text',\n          minWidth: 33,\n          runQueryOnEnter: true,\n        },\n      ],\n      defaultParams: [''],\n      alternativesKey: 'line filter',\n      category: LokiVisualQueryOperationCategory.LineFilters,\n      orderRank: LokiOperationOrder.LineFilters,\n      renderer: getLineFilterRenderer('|~', true),\n      addOperationHandler: addLokiOperation,\n      explainHandler: (op) => `Return log lines that match regex \\`(?i)${op.params?.join('`, or `(?i)')}\\`.`,\n    },\n    {\n      id: LokiOperationId.LineContainsNotCaseInsensitive,\n      name: 'Line does not contain case insensitive',\n      params: [\n        {\n          name: '',\n          type: 'string',\n          hideName: true,\n          restParam: true,\n          placeholder: 'Text to exclude',\n          description: 'Find log lines that does not contain this text',\n          minWidth: 40,\n          runQueryOnEnter: true,\n        },\n      ],\n      defaultParams: [''],\n      alternativesKey: 'line filter',\n      category: LokiVisualQueryOperationCategory.LineFilters,\n      orderRank: LokiOperationOrder.LineFilters,\n      renderer: getLineFilterRenderer('!~', true),\n      addOperationHandler: addLokiOperation,\n      explainHandler: (op) => `Return log lines that does not match regex \\`(?i)${op.params?.join('`, or `(?i)')}\\`.`,\n    },\n    {\n      id: LokiOperationId.LineMatchesRegex,\n      name: 'Line contains regex match',\n      params: [\n        {\n          name: '',\n          type: 'string',\n          hideName: true,\n          restParam: true,\n          placeholder: 'Pattern to match',\n          description: 'Find log lines that match this regex pattern',\n          minWidth: 30,\n          runQueryOnEnter: true,\n        },\n      ],\n      defaultParams: [''],\n      alternativesKey: 'line filter',\n      category: LokiVisualQueryOperationCategory.LineFilters,\n      orderRank: LokiOperationOrder.LineFilters,\n      renderer: getLineFilterRenderer('|~'),\n      addOperationHandler: addLokiOperation,\n      explainHandler: (op) => `Return log lines that match a \\`RE2\\` regex pattern. \\`${op.params?.join('`, or `')}\\`.`,\n    },\n    {\n      id: LokiOperationId.LineMatchesRegexNot,\n      name: 'Line does not match regex',\n      params: [\n        {\n          name: '',\n          type: 'string',\n          hideName: true,\n          restParam: true,\n          placeholder: 'Pattern to exclude',\n          description: 'Find log lines that does not match this regex pattern',\n          minWidth: 30,\n          runQueryOnEnter: true,\n        },\n      ],\n      defaultParams: [''],\n      alternativesKey: 'line filter',\n      category: LokiVisualQueryOperationCategory.LineFilters,\n      orderRank: LokiOperationOrder.LineFilters,\n      renderer: getLineFilterRenderer('!~'),\n      addOperationHandler: addLokiOperation,\n      explainHandler: (op) =>\n        `Return log lines that doesn't match a \\`RE2\\` regex pattern. \\`${op.params?.join('`, or `')}\\`.`,\n    },\n    {\n      id: LokiOperationId.LineFilterIpMatches,\n      name: 'IP line filter expression',\n      params: [\n        {\n          name: 'Operator',\n          type: 'string',\n          minWidth: 16,\n          options: [lokiOperators.contains, lokiOperators.doesNotContain],\n        },\n        {\n          name: 'Pattern',\n          type: 'string',\n          placeholder: '<pattern>',\n          minWidth: 16,\n          runQueryOnEnter: true,\n        },\n      ],\n      defaultParams: ['|=', ''],\n      alternativesKey: 'line filter',\n      category: LokiVisualQueryOperationCategory.LineFilters,\n      orderRank: LokiOperationOrder.LineFilters,\n      renderer: (op, def, innerExpr) => `${innerExpr} ${op.params[0]} ip(\\`${op.params[1]}\\`)`,\n      addOperationHandler: addLokiOperation,\n      explainHandler: (op) => `Return log lines using IP matching of \\`${op.params[1]}\\``,\n    },\n    {\n      id: LokiOperationId.LabelFilter,\n      name: 'Label filter expression',\n      params: [\n        { name: 'Label', type: 'string', minWidth: 14 },\n        {\n          name: 'Operator',\n          type: 'string',\n          minWidth: 14,\n          options: [\n            lokiOperators.equals,\n            lokiOperators.doesNotEqual,\n            lokiOperators.matchesRegex,\n            lokiOperators.doesNotMatchRegex,\n            lokiOperators.greaterThan,\n            lokiOperators.lessThan,\n            lokiOperators.greaterThanOrEqual,\n            lokiOperators.lessThanOrEqual,\n          ],\n        },\n        { name: 'Value', type: 'string', minWidth: 14 },\n      ],\n      defaultParams: ['', '=', ''],\n      alternativesKey: 'label filter',\n      category: LokiVisualQueryOperationCategory.LabelFilters,\n      orderRank: LokiOperationOrder.PipeOperations,\n      renderer: labelFilterRenderer,\n      addOperationHandler: addLokiOperation,\n      explainHandler: () => `Label expression filter allows filtering using original and extracted labels.`,\n    },\n    {\n      id: LokiOperationId.LabelFilterIpMatches,\n      name: 'IP label filter expression',\n      params: [\n        { name: 'Label', type: 'string', minWidth: 14 },\n        {\n          name: 'Operator',\n          type: 'string',\n          minWidth: 14,\n          options: [lokiOperators.equals, lokiOperators.doesNotEqual],\n        },\n        { name: 'Value', type: 'string', minWidth: 14 },\n      ],\n      defaultParams: ['', '=', ''],\n      alternativesKey: 'label filter',\n      category: LokiVisualQueryOperationCategory.LabelFilters,\n      orderRank: LokiOperationOrder.PipeOperations,\n      renderer: (model, def, innerExpr) =>\n        `${innerExpr} | ${model.params[0]} ${model.params[1]} ip(\\`${model.params[2]}\\`)`,\n      addOperationHandler: addLokiOperation,\n      explainHandler: (op) => `Return log lines using IP matching of \\`${op.params[2]}\\` for \\`${op.params[0]}\\` label`,\n    },\n    {\n      id: LokiOperationId.LabelFilterNoErrors,\n      name: 'No pipeline errors',\n      params: [],\n      defaultParams: [],\n      alternativesKey: 'label filter',\n      category: LokiVisualQueryOperationCategory.LabelFilters,\n      orderRank: LokiOperationOrder.NoErrors,\n      renderer: (model, def, innerExpr) => `${innerExpr} | __error__=\\`\\``,\n      addOperationHandler: addLokiOperation,\n      explainHandler: () => `Filter out all formatting and parsing errors.`,\n    },\n    {\n      id: LokiOperationId.Unwrap,\n      name: 'Unwrap',\n      params: [\n        {\n          name: 'Identifier',\n          type: 'string',\n          hideName: true,\n          minWidth: 16,\n          placeholder: 'Label key',\n          editor: UnwrapParamEditor,\n        },\n        {\n          name: 'Conversion function',\n          hideName: true,\n          type: 'string',\n          options: ['duration', 'duration_seconds', 'bytes'],\n          optional: true,\n        },\n      ],\n      defaultParams: ['', ''],\n      alternativesKey: 'format',\n      category: LokiVisualQueryOperationCategory.Formats,\n      orderRank: LokiOperationOrder.Unwrap,\n      renderer: (op, def, innerExpr) =>\n        `${innerExpr} | unwrap ${op.params[1] ? `${op.params[1]}(${op.params[0]})` : op.params[0]}`,\n      addOperationHandler: addLokiOperation,\n      explainHandler: (op) => {\n        let label = String(op.params[0]).length > 0 ? op.params[0] : '<label>';\n        return `Use the extracted label \\`${label}\\` as sample values instead of log lines for the subsequent range aggregation.${\n          op.params[1]\n            ? ` Conversion function \\`${op.params[1]}\\` wrapping \\`${label}\\` will attempt to convert this label from a specific format (e.g. 3k, 500ms).`\n            : ''\n        }`;\n      },\n    },\n    {\n      id: LokiOperationId.Decolorize,\n      name: 'Decolorize',\n      params: [],\n      defaultParams: [],\n      alternativesKey: 'format',\n      category: LokiVisualQueryOperationCategory.Formats,\n      orderRank: LokiOperationOrder.PipeOperations,\n      renderer: (op, def, innerExpr) => `${innerExpr} | decolorize`,\n      addOperationHandler: addLokiOperation,\n      explainHandler: () => `This will remove ANSI color codes from log lines.`,\n    },\n    {\n      id: LokiOperationId.Drop,\n      name: 'Drop',\n      params: [\n        // As drop can support both labels (e.g. job) and expressions (e.g. job=\"grafana\"), we\n        // use input and not LabelParamEditor.\n        {\n          name: 'Label',\n          type: 'string',\n          restParam: true,\n          optional: true,\n          minWidth: 18,\n          placeholder: 'job=\"grafana\"',\n          description: 'Specify labels or expressions to drop.',\n        },\n      ],\n      defaultParams: [''],\n      alternativesKey: 'format',\n      category: LokiVisualQueryOperationCategory.Formats,\n      orderRank: LokiOperationOrder.PipeOperations,\n      renderer: pipelineRenderer,\n      addOperationHandler: addLokiOperation,\n      explainHandler: () => 'The drop expression will drop the given labels in the pipeline.',\n    },\n    {\n      id: LokiOperationId.Keep,\n      name: 'Keep',\n      params: [\n        // As keep can support both labels (e.g. job) and expressions (e.g. job=\"grafana\"), we\n        // use input and not LabelParamEditor.\n        {\n          name: 'Label',\n          type: 'string',\n          restParam: true,\n          optional: true,\n          minWidth: 18,\n          placeholder: 'job=\"grafana\"',\n          description: 'Specify labels or expressions to keep.',\n        },\n      ],\n      defaultParams: [''],\n      alternativesKey: 'format',\n      category: LokiVisualQueryOperationCategory.Formats,\n      orderRank: LokiOperationOrder.PipeOperations,\n      renderer: pipelineRenderer,\n      addOperationHandler: addLokiOperation,\n      explainHandler: () =>\n        'The keep expression will keep only the specified labels in the pipeline and drop all the other labels.',\n    },\n    ...binaryScalarOperations,\n    {\n      id: LokiOperationId.NestedQuery,\n      name: 'Binary operation with query',\n      params: [],\n      defaultParams: [],\n      category: LokiVisualQueryOperationCategory.BinaryOps,\n      renderer: (model, def, innerExpr) => innerExpr,\n      addOperationHandler: addNestedQueryHandler,\n    },\n  ];\n\n  return list;\n}\n\n// Keeping a local copy as an optimization measure.\nexport const operationDefinitions = getOperationDefinitions();\n\n/**\n * Given an operator, return the corresponding explain.\n * For usage within the Query Editor.\n */\nexport function explainOperator(id: LokiOperationId | string): string {\n  const definition = operationDefinitions.find((operation) => operation.id === id);\n\n  const explain = definition?.explainHandler?.({ id: '', params: ['<value>'] }) || '';\n\n  // Strip markdown links\n  return explain.replace(/\\[(.*)\\]\\(.*\\)/g, '$1');\n}\n\nexport function getDefinitionById(id: string): QueryBuilderOperationDefinition | undefined {\n  return operationDefinitions.find((x) => x.id === id);\n}\n\nexport function checkParamsAreValid(\n  def: QueryBuilderOperationDefinition,\n  params: QueryBuilderOperationParamValue[]\n): boolean {\n  // For now we only check if the operation has all the required params.\n  if (params.length < def.params.filter((param) => !param.optional).length) {\n    return false;\n  }\n\n  return true;\n}\n","import { SyntaxNode } from '@lezer/common';\n\nimport { QueryBuilderLabelFilter, QueryBuilderOperation, QueryBuilderOperationParamValue } from '@grafana/experimental';\nimport {\n  And,\n  BinOpExpr,\n  Bool,\n  By,\n  ConvOp,\n  Decolorize,\n  DropLabel,\n  DropLabels,\n  DropLabelsExpr,\n  Filter,\n  FilterOp,\n  Grouping,\n  GroupingLabelList,\n  GroupingLabels,\n  Identifier,\n  Ip,\n  IpLabelFilter,\n  Json,\n  JsonExpressionParser,\n  KeepLabel,\n  KeepLabels,\n  KeepLabelsExpr,\n  LabelExtractionExpression,\n  LabelFilter,\n  LabelFormatMatcher,\n  LabelParser,\n  LineFilter,\n  LineFormatExpr,\n  LogfmtExpressionParser,\n  LogfmtParser,\n  LogRangeExpr,\n  Matcher,\n  MetricExpr,\n  Number as NumberLezer,\n  On,\n  Or,\n  parser,\n  ParserFlag,\n  Range,\n  RangeAggregationExpr,\n  RangeOp,\n  String,\n  UnitFilter,\n  Unwrap,\n  UnwrapExpr,\n  VectorAggregationExpr,\n  VectorOp,\n  Without,\n  BinOpModifier,\n  OnOrIgnoringModifier,\n  OrFilter,\n} from '@grafana/lezer-logql';\n\nimport { binaryScalarDefs } from './binaryScalarOperations';\nimport { checkParamsAreValid, getDefinitionById } from './operations';\nimport {\n  ErrorId,\n  getAllByType,\n  getLeftMostChild,\n  getString,\n  makeBinOp,\n  makeError,\n  replaceVariables,\n} from './parsingUtils';\nimport { LokiOperationId, LokiVisualQuery, LokiVisualQueryBinary } from './types';\n\ninterface Context {\n  query: LokiVisualQuery;\n  errors: ParsingError[];\n}\n\ninterface ParsingError {\n  text: string;\n  from?: number;\n  to?: number;\n  parentType?: string;\n}\n\ninterface GetOperationResult {\n  operation?: QueryBuilderOperation;\n  error?: string;\n}\n\nexport function buildVisualQueryFromString(expr: string): Context {\n  const replacedExpr = replaceVariables(expr);\n  const tree = parser.parse(replacedExpr);\n  const node = tree.topNode;\n\n  // This will be modified in the handleExpression\n  const visQuery: LokiVisualQuery = {\n    labels: [],\n    operations: [],\n  };\n\n  const context: Context = {\n    query: visQuery,\n    errors: [],\n  };\n\n  try {\n    handleExpression(replacedExpr, node, context);\n  } catch (err) {\n    // Not ideal to log it here, but otherwise we would lose the stack trace.\n    console.error(err);\n    if (err instanceof Error) {\n      context.errors.push({\n        text: err.message,\n      });\n    }\n  }\n\n  // If we have empty query, we want to reset errors\n  if (isEmptyQuery(context.query)) {\n    context.errors = [];\n  }\n  return context;\n}\n\nexport function handleExpression(expr: string, node: SyntaxNode, context: Context) {\n  const visQuery = context.query;\n  switch (node.type.id) {\n    case Matcher: {\n      visQuery.labels.push(getLabel(expr, node));\n      const err = node.getChild(ErrorId);\n      if (err) {\n        context.errors.push(makeError(expr, err));\n      }\n      break;\n    }\n\n    case LineFilter: {\n      const { operation, error } = getLineFilter(expr, node);\n      if (operation) {\n        visQuery.operations.push(operation);\n      }\n      // Show error for query patterns not supported in visual query builder\n      if (error) {\n        context.errors.push(createNotSupportedError(expr, node, error));\n      }\n      break;\n    }\n\n    case LabelParser: {\n      visQuery.operations.push(getLabelParser(expr, node));\n      break;\n    }\n\n    case LabelFilter: {\n      const { operation, error } = getLabelFilter(expr, node);\n      if (operation) {\n        visQuery.operations.push(operation);\n      }\n      // Show error for query patterns not supported in visual query builder\n      if (error) {\n        context.errors.push(createNotSupportedError(expr, node, error));\n      }\n      break;\n    }\n    case JsonExpressionParser: {\n      visQuery.operations.push(getJsonExpressionParser(expr, node));\n      break;\n    }\n\n    case LogfmtParser:\n    case LogfmtExpressionParser: {\n      const { operation, error } = getLogfmtParser(expr, node);\n      if (operation) {\n        visQuery.operations.push(operation);\n      }\n      if (error) {\n        context.errors.push(createNotSupportedError(expr, node, error));\n      }\n      break;\n    }\n\n    case LineFormatExpr: {\n      visQuery.operations.push(getLineFormat(expr, node));\n      break;\n    }\n\n    case LabelFormatMatcher: {\n      visQuery.operations.push(getLabelFormat(expr, node));\n      break;\n    }\n\n    case UnwrapExpr: {\n      const { operation, error } = handleUnwrapExpr(expr, node, context);\n      if (operation) {\n        visQuery.operations.push(operation);\n      }\n      // Show error for query patterns not supported in visual query builder\n      if (error) {\n        context.errors.push(createNotSupportedError(expr, node, error));\n      }\n\n      break;\n    }\n\n    case Decolorize: {\n      visQuery.operations.push(getDecolorize());\n      break;\n    }\n\n    case RangeAggregationExpr: {\n      visQuery.operations.push(handleRangeAggregation(expr, node, context));\n      break;\n    }\n\n    case VectorAggregationExpr: {\n      visQuery.operations.push(handleVectorAggregation(expr, node, context));\n      break;\n    }\n\n    case BinOpExpr: {\n      handleBinary(expr, node, context);\n      break;\n    }\n\n    case ErrorId: {\n      if (isIntervalVariableError(node)) {\n        break;\n      }\n      context.errors.push(makeError(expr, node));\n      break;\n    }\n\n    case DropLabelsExpr: {\n      visQuery.operations.push(handleDropFilter(expr, node, context));\n      break;\n    }\n\n    case KeepLabelsExpr: {\n      visQuery.operations.push(handleKeepFilter(expr, node, context));\n      break;\n    }\n\n    default: {\n      // Any other nodes we just ignore and go to its children. This should be fine as there are lots of wrapper\n      // nodes that can be skipped.\n      // TODO: there are probably cases where we will just skip nodes we don't support and we should be able to\n      //  detect those and report back.\n      let child = node.firstChild;\n      while (child) {\n        handleExpression(expr, child, context);\n        child = child.nextSibling;\n      }\n    }\n  }\n}\n\nfunction getLabel(expr: string, node: SyntaxNode): QueryBuilderLabelFilter {\n  const labelNode = node.getChild(Identifier);\n  const label = getString(expr, labelNode);\n  const op = getString(expr, labelNode?.nextSibling);\n  let value = getString(expr, node.getChild(String));\n  // `value` is wrapped in double quotes, so we need to remove them. As a value can contain double quotes, we can't use RegEx here.\n  value = value.substring(1, value.length - 1);\n\n  return {\n    label,\n    op,\n    value,\n  };\n}\n\nfunction getLineFilter(expr: string, node: SyntaxNode): GetOperationResult {\n  const filter = getString(expr, node.getChild(Filter));\n  const filterExpr = handleQuotes(getString(expr, node.getChild(String)));\n  const ipLineFilter = node.getChild(FilterOp)?.getChild(Ip);\n  if (ipLineFilter) {\n    return {\n      operation: {\n        id: LokiOperationId.LineFilterIpMatches,\n        params: [filter, filterExpr],\n      },\n    };\n  }\n\n  const params = [filterExpr];\n  let orFilter = node.getChild(OrFilter);\n  while (orFilter) {\n    params.push(handleQuotes(getString(expr, orFilter.getChild(String))));\n    orFilter = orFilter.getChild(OrFilter);\n  }\n\n  const mapFilter: Record<string, LokiOperationId> = {\n    '|=': LokiOperationId.LineContains,\n    '!=': LokiOperationId.LineContainsNot,\n    '|~': LokiOperationId.LineMatchesRegex,\n    '!~': LokiOperationId.LineMatchesRegexNot,\n  };\n\n  return {\n    operation: {\n      id: mapFilter[filter],\n      params,\n    },\n  };\n}\n\nfunction getLabelParser(expr: string, node: SyntaxNode): QueryBuilderOperation {\n  const parserNode = node.firstChild;\n  const parser = getString(expr, parserNode);\n\n  const string = handleQuotes(getString(expr, node.getChild(String)));\n  let params: QueryBuilderOperationParamValue[] = !!string ? [string] : [];\n  const opDef = getDefinitionById(parser);\n  if (opDef && !checkParamsAreValid(opDef, params)) {\n    params = opDef?.defaultParams || [];\n  }\n\n  return {\n    id: parser,\n    params,\n  };\n}\n\nfunction getJsonExpressionParser(expr: string, node: SyntaxNode): QueryBuilderOperation {\n  const parserNode = node.getChild(Json);\n  const parser = getString(expr, parserNode);\n\n  const params = [...getAllByType(expr, node, LabelExtractionExpression)];\n  return {\n    id: parser,\n    params,\n  };\n}\n\nfunction getLogfmtParser(expr: string, node: SyntaxNode): GetOperationResult {\n  const flags: string[] = [];\n  const labels: string[] = [];\n  let error: string | undefined = undefined;\n\n  const offset = node.from;\n  node.toTree().iterate({\n    enter: (subNode) => {\n      if (subNode.type.id === ParserFlag) {\n        flags.push(expr.substring(subNode.from + offset, subNode.to + offset));\n      } else if (subNode.type.id === LabelExtractionExpression) {\n        labels.push(expr.substring(subNode.from + offset, subNode.to + offset));\n      } else if (subNode.type.id === ErrorId) {\n        error = `Unexpected string \"${expr.substring(subNode.from + offset, subNode.to + offset)}\"`;\n      }\n    },\n  });\n\n  const operation = {\n    id: LokiOperationId.Logfmt,\n    params: [flags.includes('--strict'), flags.includes('--keep-empty'), ...labels],\n  };\n\n  return {\n    operation,\n    error,\n  };\n}\n\nfunction getLabelFilter(expr: string, node: SyntaxNode): GetOperationResult {\n  // Check for nodes not supported in visual builder and return error\n  if (node.getChild(Or) || node.getChild(And) || node.getChild('Comma')) {\n    return {\n      error: 'Label filter with comma, \"and\", \"or\" not supported in query builder',\n    };\n  }\n  if (node.firstChild!.type.id === IpLabelFilter) {\n    const ipLabelFilter = node.firstChild;\n    const label = ipLabelFilter?.getChild(Identifier);\n    const op = label?.nextSibling;\n    const value = ipLabelFilter?.getChild(String);\n    const valueString = handleQuotes(getString(expr, value));\n\n    return {\n      operation: {\n        id: LokiOperationId.LabelFilterIpMatches,\n        params: [getString(expr, label), getString(expr, op), valueString],\n      },\n    };\n  }\n\n  const id = LokiOperationId.LabelFilter;\n  if (node.firstChild!.type.id === UnitFilter) {\n    const filter = node.firstChild!.firstChild;\n    const label = filter!.firstChild;\n    const op = label!.nextSibling;\n    const value = op!.nextSibling;\n    const valueString = handleQuotes(getString(expr, value));\n\n    return {\n      operation: {\n        id,\n        params: [getString(expr, label), getString(expr, op), valueString],\n      },\n    };\n  }\n  // In this case it is Matcher or NumberFilter\n  const filter = node.firstChild;\n  const label = filter!.firstChild;\n  const op = label!.nextSibling;\n  const value = op!.nextSibling;\n  const params = [getString(expr, label), getString(expr, op), handleQuotes(getString(expr, value))];\n\n  // Special case of pipe filtering - no errors\n  if (params.join('') === `__error__=`) {\n    return {\n      operation: {\n        id: LokiOperationId.LabelFilterNoErrors,\n        params: [],\n      },\n    };\n  }\n\n  return {\n    operation: {\n      id,\n      params,\n    },\n  };\n}\n\nfunction getLineFormat(expr: string, node: SyntaxNode): QueryBuilderOperation {\n  const id = LokiOperationId.LineFormat;\n  const string = handleQuotes(getString(expr, node.getChild(String)));\n\n  return {\n    id,\n    params: [string],\n  };\n}\n\nfunction getLabelFormat(expr: string, node: SyntaxNode): QueryBuilderOperation {\n  const id = LokiOperationId.LabelFormat;\n  const renameTo = node.getChild(Identifier);\n  const op = renameTo!.nextSibling;\n  const originalLabel = op!.nextSibling;\n\n  return {\n    id,\n    params: [getString(expr, originalLabel), handleQuotes(getString(expr, renameTo))],\n  };\n}\n\nfunction getDecolorize(): QueryBuilderOperation {\n  const id = LokiOperationId.Decolorize;\n\n  return {\n    id,\n    params: [],\n  };\n}\n\nfunction handleUnwrapExpr(expr: string, node: SyntaxNode, context: Context): GetOperationResult {\n  const unwrapExprChild = node.getChild(UnwrapExpr);\n  const labelFilterChild = node.getChild(LabelFilter);\n  const unwrapChild = node.getChild(Unwrap);\n\n  if (unwrapExprChild) {\n    handleExpression(expr, unwrapExprChild, context);\n  }\n\n  if (labelFilterChild) {\n    handleExpression(expr, labelFilterChild, context);\n  }\n\n  if (unwrapChild) {\n    if (unwrapChild.nextSibling?.type.id === ConvOp) {\n      const convOp = unwrapChild.nextSibling;\n      const identifier = convOp.nextSibling;\n      return {\n        operation: {\n          id: LokiOperationId.Unwrap,\n          params: [getString(expr, identifier), getString(expr, convOp)],\n        },\n      };\n    }\n\n    return {\n      operation: {\n        id: LokiOperationId.Unwrap,\n        params: [getString(expr, unwrapChild?.nextSibling), ''],\n      },\n    };\n  }\n\n  return {};\n}\n\nfunction handleRangeAggregation(expr: string, node: SyntaxNode, context: Context) {\n  const nameNode = node.getChild(RangeOp);\n  const funcName = getString(expr, nameNode);\n  const number = node.getChild(NumberLezer);\n  const logExpr = node.getChild(LogRangeExpr);\n  const params = number !== null && number !== undefined ? [getString(expr, number)] : [];\n  const range = logExpr?.getChild(Range);\n  const rangeValue = range ? getString(expr, range) : null;\n  const grouping = node.getChild(Grouping);\n\n  if (rangeValue) {\n    params.unshift(rangeValue.substring(1, rangeValue.length - 1));\n  }\n\n  if (grouping) {\n    params.push(...getAllByType(expr, grouping, Identifier));\n  }\n\n  const op = {\n    id: funcName,\n    params,\n  };\n\n  if (logExpr) {\n    handleExpression(expr, logExpr, context);\n  }\n\n  return op;\n}\n\nfunction handleVectorAggregation(expr: string, node: SyntaxNode, context: Context) {\n  const nameNode = node.getChild(VectorOp);\n  let funcName = getString(expr, nameNode);\n\n  const grouping = node.getChild(Grouping);\n  const params = [];\n\n  const numberNode = node.getChild(NumberLezer);\n\n  if (numberNode) {\n    params.push(Number(getString(expr, numberNode)));\n  }\n\n  if (grouping) {\n    const byModifier = grouping.getChild(By);\n    if (byModifier && funcName) {\n      funcName = `__${funcName}_by`;\n    }\n\n    const withoutModifier = grouping.getChild(Without);\n    if (withoutModifier) {\n      funcName = `__${funcName}_without`;\n    }\n\n    params.push(...getAllByType(expr, grouping, Identifier));\n  }\n\n  const metricExpr = node.getChild(MetricExpr);\n  const op: QueryBuilderOperation = { id: funcName, params };\n\n  if (metricExpr) {\n    // A vector aggregation expression with a child of metric expression with a child of binary expression is ambiguous after being parsed into a visual query\n    if (metricExpr.firstChild?.type.id === BinOpExpr) {\n      context.errors.push({\n        text: 'Query parsing is ambiguous.',\n        from: metricExpr.firstChild.from,\n        to: metricExpr.firstChild?.to,\n      });\n    }\n\n    handleExpression(expr, metricExpr, context);\n  }\n\n  return op;\n}\n\nconst operatorToOpName = binaryScalarDefs.reduce<Record<string, { id: string; comparison?: boolean }>>((acc, def) => {\n  acc[def.sign] = {\n    id: def.id,\n    comparison: def.comparison,\n  };\n  return acc;\n}, {});\n\n/**\n * Right now binary expressions can be represented in 2 way in visual query. As additional operation in case it is\n * just operation with scalar or it creates a binaryQuery when it's 2 queries.\n * @param expr\n * @param node\n * @param context\n */\nfunction handleBinary(expr: string, node: SyntaxNode, context: Context) {\n  const visQuery = context.query;\n  const left = node.firstChild!;\n  const op = getString(expr, left.nextSibling);\n  const binModifier = getBinaryModifier(expr, node.getChild(BinOpModifier));\n\n  const right = node.lastChild!;\n\n  const opDef = operatorToOpName[op];\n\n  const leftNumber = getLastChildWithSelector(left, 'MetricExpr.LiteralExpr.Number');\n  const rightNumber = getLastChildWithSelector(right, 'MetricExpr.LiteralExpr.Number');\n\n  const rightBinary = right.getChild(BinOpExpr);\n\n  if (leftNumber) {\n    // TODO: this should be already handled in case parent is binary expression as it has to be added to parent\n    //  if query starts with a number that isn't handled now.\n  } else {\n    // If this is binary we don't really know if there is a query or just chained scalars. So\n    // we have to traverse a bit deeper to know\n    handleExpression(expr, left, context);\n  }\n\n  if (rightNumber) {\n    visQuery.operations.push(makeBinOp(opDef, expr, right, !!binModifier?.isBool));\n  } else if (rightBinary) {\n    // Due to the way binary ops are parsed we can get a binary operation on the right that starts with a number which\n    // is a factor for a current binary operation. So we have to add it as an operation now.\n    const leftMostChild = getLeftMostChild(right);\n    if (leftMostChild?.type.id === NumberLezer) {\n      visQuery.operations.push(makeBinOp(opDef, expr, leftMostChild, !!binModifier?.isBool));\n    }\n\n    // If we added the first number literal as operation here we still can continue and handle the rest as the first\n    // number will be just skipped.\n    handleExpression(expr, right, context);\n  } else {\n    visQuery.binaryQueries = visQuery.binaryQueries || [];\n    const binQuery: LokiVisualQueryBinary = {\n      operator: op,\n      query: {\n        labels: [],\n        operations: [],\n      },\n    };\n    if (binModifier?.isMatcher) {\n      binQuery.vectorMatchesType = binModifier.matchType;\n      binQuery.vectorMatches = binModifier.matches;\n    }\n    visQuery.binaryQueries.push(binQuery);\n    handleExpression(expr, right, {\n      query: binQuery.query,\n      errors: context.errors,\n    });\n  }\n}\n\nfunction getBinaryModifier(\n  expr: string,\n  node: SyntaxNode | null\n):\n  | { isBool: true; isMatcher: false }\n  | { isBool: boolean; isMatcher: true; matches: string; matchType: 'ignoring' | 'on' }\n  | undefined {\n  if (!node) {\n    return undefined;\n  }\n  const matcher = node.getChild(OnOrIgnoringModifier);\n  const boolMatcher = node.getChild(Bool);\n\n  if (!matcher && boolMatcher) {\n    return { isBool: true, isMatcher: false };\n  } else {\n    if (!matcher) {\n      // Not sure what this could be, maybe should be an error.\n      return undefined;\n    }\n    const labels = getString(expr, matcher.getChild(GroupingLabels)?.getChild(GroupingLabelList));\n    return {\n      isMatcher: true,\n      isBool: !!boolMatcher,\n      matches: labels,\n      matchType: matcher.getChild(On) ? 'on' : 'ignoring',\n    };\n  }\n}\n\nfunction isIntervalVariableError(node: SyntaxNode) {\n  return node?.parent?.type.id === Range;\n}\n\nexport function handleQuotes(string: string) {\n  if (string[0] === `\"` && string[string.length - 1] === `\"`) {\n    return string\n      .substring(1, string.length - 1)\n      .replace(/\\\\\"/g, '\"')\n      .replace(/\\\\\\\\/g, '\\\\');\n  }\n  return string.replace(/`/g, '');\n}\n\n/**\n * Simple helper to traverse the syntax tree. Instead of node.getChild('foo')?.getChild('bar')?.getChild('baz') you\n * can write getChildWithSelector(node, 'foo.bar.baz')\n * @param node\n * @param selector\n */\nfunction getLastChildWithSelector(node: SyntaxNode, selector: string) {\n  let child: SyntaxNode | null = node;\n  const children = selector.split('.');\n  for (const s of children) {\n    child = child.getChild(s);\n    if (!child) {\n      return null;\n    }\n  }\n  return child;\n}\n\n/**\n * Helper function to enrich error text with information that visual query builder doesn't support that logQL\n * @param expr\n * @param node\n * @param error\n */\nfunction createNotSupportedError(expr: string, node: SyntaxNode, error: string) {\n  const err = makeError(expr, node);\n  err.text = `${error}: ${err.text}`;\n  return err;\n}\n\nfunction isEmptyQuery(query: LokiVisualQuery) {\n  if (query.labels.length === 0 && query.operations.length === 0) {\n    return true;\n  }\n  return false;\n}\n\nfunction handleDropFilter(expr: string, node: SyntaxNode, context: Context): QueryBuilderOperation {\n  const labels: string[] = [];\n  let exploringNode = node.getChild(DropLabels);\n  while (exploringNode) {\n    const label = getString(expr, exploringNode.getChild(DropLabel));\n    if (label) {\n      labels.push(label);\n    }\n    exploringNode = exploringNode?.getChild(DropLabels);\n  }\n  labels.reverse();\n  return {\n    id: LokiOperationId.Drop,\n    params: labels,\n  };\n}\n\nfunction handleKeepFilter(expr: string, node: SyntaxNode, context: Context): QueryBuilderOperation {\n  const labels: string[] = [];\n  let exploringNode = node.getChild(KeepLabels);\n  while (exploringNode) {\n    const label = getString(expr, exploringNode.getChild(KeepLabel));\n    if (label) {\n      labels.push(label);\n    }\n    exploringNode = exploringNode?.getChild(KeepLabels);\n  }\n  labels.reverse();\n  return {\n    id: LokiOperationId.Keep,\n    params: labels,\n  };\n}\n","import { SyntaxNode, TreeCursor } from '@lezer/common';\n\nimport { QueryBuilderOperation, QueryBuilderOperationParamValue } from '@grafana/experimental';\n\n// Although 0 isn't explicitly provided in the @grafana/lezer-logql library as the error node ID, it does appear to be the ID of error nodes within lezer.\nexport const ErrorId = 0;\n\nexport function getLeftMostChild(cur: SyntaxNode): SyntaxNode {\n  return cur.firstChild ? getLeftMostChild(cur.firstChild) : cur;\n}\n\nexport function makeError(expr: string, node: SyntaxNode) {\n  return {\n    text: getString(expr, node),\n    // TODO: this are positions in the string with the replaced variables. Means it cannot be used to show exact\n    //  placement of the error for the user. We need some translation table to positions before the variable\n    //  replace.\n    from: node.from,\n    to: node.to,\n    parentType: node.parent?.name,\n  };\n}\n\n// Taken from template_srv, but copied so to not mess with the regex.index which is manipulated in the service\n/*\n * This regex matches 3 types of variable reference with an optional format specifier\n * \\$(\\w+)                          $var1\n * \\[\\[([\\s\\S]+?)(?::(\\w+))?\\]\\]    [[var2]] or [[var2:fmt2]]\n * \\${(\\w+)(?::(\\w+))?}             ${var3} or ${var3:fmt3}\n */\nexport const variableRegex = /\\$(\\w+)|\\[\\[([\\s\\S]+?)(?::(\\w+))?\\]\\]|\\${(\\w+)(?:\\.([^:^\\}]+))?(?::([^\\}]+))?}/g;\n\n/**\n * As variables with $ are creating parsing errors, we first replace them with magic string that is parsable and at\n * the same time we can get the variable and its format back from it.\n * @param expr\n */\nexport function replaceVariables(expr: string) {\n  return expr.replace(variableRegex, (match, var1, var2, fmt2, var3, fieldPath, fmt3) => {\n    const fmt = fmt2 || fmt3;\n    let variable = var1;\n    let varType = '0';\n\n    if (var2) {\n      variable = var2;\n      varType = '1';\n    }\n\n    if (var3) {\n      variable = var3;\n      varType = '2';\n    }\n\n    return `__V_${varType}__` + variable + '__V__' + (fmt ? '__F__' + fmt + '__F__' : '');\n  });\n}\n\nconst varTypeFunc = [\n  (v: string, f?: string) => `\\$${v}`,\n  (v: string, f?: string) => `[[${v}${f ? `:${f}` : ''}]]`,\n  (v: string, f?: string) => `\\$\\{${v}${f ? `:${f}` : ''}\\}`,\n];\n\n/**\n * Get back the text with variables in their original format.\n * @param expr\n */\nexport function returnVariables(expr: string) {\n  return expr.replace(/__V_(\\d)__(.+?)__V__(?:__F__(\\w+)__F__)?/g, (match, type, v, f) => {\n    return varTypeFunc[parseInt(type, 10)](v, f);\n  });\n}\n\n/**\n * Get the actual string of the expression. That is not stored in the tree so we have to get the indexes from the node\n * and then based on that get it from the expression.\n * @param expr\n * @param node\n */\nexport function getString(expr: string, node: SyntaxNode | TreeCursor | null | undefined) {\n  if (!node) {\n    return '';\n  }\n  return returnVariables(expr.substring(node.from, node.to));\n}\n\n/**\n * Create simple scalar binary op object.\n * @param opDef - definition of the op to be created\n * @param expr\n * @param numberNode - the node for the scalar\n * @param hasBool - whether operation has a bool modifier. Is used only for ops for which it makes sense.\n */\nexport function makeBinOp(\n  opDef: { id: string; comparison?: boolean },\n  expr: string,\n  numberNode: SyntaxNode,\n  hasBool: boolean\n): QueryBuilderOperation {\n  const params: QueryBuilderOperationParamValue[] = [parseFloat(getString(expr, numberNode))];\n  if (opDef.comparison) {\n    params.push(hasBool);\n  }\n  return {\n    id: opDef.id,\n    params,\n  };\n}\n\n/**\n * Get all nodes with type in the tree. This traverses the tree so it is safe only when you know there shouldn't be\n * too much nesting but you just want to skip some of the wrappers. For example getting function args this way would\n * not be safe is it would also find arguments of nested functions.\n * @param expr\n * @param cur\n * @param type - can be string or number, some data-sources (loki) haven't migrated over to using numeric constants defined in the lezer parsing library (e.g. lezer-promql).\n * @todo Remove string type definition when all data-sources have migrated to numeric constants\n */\nexport function getAllByType(expr: string, cur: SyntaxNode, type: number | string): string[] {\n  if (cur.type.id === type || cur.name === type) {\n    return [getString(expr, cur)];\n  }\n  const values: string[] = [];\n  let pos = 0;\n  let child = cur.childAfter(pos);\n  while (child) {\n    values.push(...getAllByType(expr, child, type));\n    pos = child.to;\n    child = cur.childAfter(pos);\n  }\n  return values;\n}\n\n/**\n * There aren't any spaces in the metric names, so let's introduce a wildcard into the regex for each space to better facilitate a fuzzy search\n */\nexport const regexifyLabelValuesQueryString = (query: string) => {\n  const queryArray = query.split(' ');\n  return queryArray.map((query) => `${query}.*`).join('');\n};\n","import {\n  VisualQueryBinary,\n  QueryBuilderLabelFilter,\n  QueryBuilderOperation,\n  BINARY_OPERATIONS_KEY,\n} from '@grafana/experimental';\n\n/**\n * Visual query model\n */\nexport interface LokiVisualQuery {\n  labels: QueryBuilderLabelFilter[];\n  operations: QueryBuilderOperation[];\n  binaryQueries?: LokiVisualQueryBinary[];\n}\n\nexport type LokiVisualQueryBinary = VisualQueryBinary<LokiVisualQuery>;\nexport enum LokiQueryPatternType {\n  Log = 'log',\n  Metric = 'metric',\n}\n\nexport interface LokiQueryPattern {\n  name: string;\n  operations: QueryBuilderOperation[];\n  type: LokiQueryPatternType;\n}\n\nexport enum LokiVisualQueryOperationCategory {\n  Aggregations = 'Aggregations',\n  RangeFunctions = 'Range functions',\n  Functions = 'Functions',\n  Formats = 'Formats',\n  LineFilters = 'Line filters',\n  LabelFilters = 'Label filters',\n  BinaryOps = BINARY_OPERATIONS_KEY,\n}\n\nexport enum LokiOperationId {\n  Json = 'json',\n  Logfmt = 'logfmt',\n  Regexp = 'regexp',\n  Pattern = 'pattern',\n  Unpack = 'unpack',\n  LineFormat = 'line_format',\n  LabelFormat = 'label_format',\n  Decolorize = 'decolorize',\n  Drop = 'drop',\n  Keep = 'keep',\n  Rate = 'rate',\n  RateCounter = 'rate_counter',\n  CountOverTime = 'count_over_time',\n  SumOverTime = 'sum_over_time',\n  AvgOverTime = 'avg_over_time',\n  MaxOverTime = 'max_over_time',\n  MinOverTime = 'min_over_time',\n  FirstOverTime = 'first_over_time',\n  LastOverTime = 'last_over_time',\n  StdvarOverTime = 'stdvar_over_time',\n  StddevOverTime = 'stddev_over_time',\n  QuantileOverTime = 'quantile_over_time',\n  BytesRate = 'bytes_rate',\n  BytesOverTime = 'bytes_over_time',\n  AbsentOverTime = 'absent_over_time',\n  Sum = 'sum',\n  Avg = 'avg',\n  Min = 'min',\n  Max = 'max',\n  Stddev = 'stddev',\n  Stdvar = 'stdvar',\n  Count = 'count',\n  TopK = 'topk',\n  BottomK = 'bottomk',\n  LineContains = '__line_contains',\n  LineContainsNot = '__line_contains_not',\n  LineContainsCaseInsensitive = '__line_contains_case_insensitive',\n  LineContainsNotCaseInsensitive = '__line_contains_not_case_insensitive',\n  LineMatchesRegex = '__line_matches_regex',\n  LineMatchesRegexNot = '__line_matches_regex_not',\n  LineFilterIpMatches = '__line_filter_ip_matches',\n  LabelFilter = '__label_filter',\n  LabelFilterNoErrors = '__label_filter_no_errors',\n  LabelFilterIpMatches = '__label_filter_ip_marches',\n  Unwrap = 'unwrap',\n  SumBy = '__sum_by',\n  SumWithout = '__sum_without',\n  // Binary ops\n  Addition = '__addition',\n  Subtraction = '__subtraction',\n  MultiplyBy = '__multiply_by',\n  DivideBy = '__divide_by',\n  Modulo = '__modulo',\n  Exponent = '__exponent',\n  NestedQuery = '__nested_query',\n  EqualTo = '__equal_to',\n  NotEqualTo = '__not_equal_to',\n  GreaterThan = '__greater_than',\n  LessThan = '__less_than',\n  GreaterOrEqual = '__greater_or_equal',\n  LessOrEqual = '__less_or_equal',\n}\n\nexport enum LokiOperationOrder {\n  LineFilters = 1,\n  Parsers = 2,\n  PipeOperations = 3,\n  // Unwrap is a special case, as it is usually the last operation, so the order is after pipeOperations\n  Unwrap = 4,\n  NoErrors = 5,\n  RangeVectorFunction = 5,\n  Last = 6,\n}\n\nexport const lokiOperators = {\n  equals: { label: '=', value: '=', description: 'Equals', isMultiValue: false },\n  doesNotEqual: { label: '!=', value: '!=', description: 'Does not equal', isMultiValue: false },\n  matchesRegex: { label: '=~', value: '=~', description: 'Matches regex', isMultiValue: true },\n  doesNotMatchRegex: { label: '!~', value: '!~', description: 'Does not match regex', isMultiValue: true },\n  greaterThan: { label: '>', value: '>', description: 'Greater than', isMultiValue: false },\n  greaterThanOrEqual: { label: '>=', value: '>=', description: 'Greater than or equal to', isMultiValue: false },\n  lessThan: { label: '<', value: '<', description: 'Less than', isMultiValue: false },\n  lessThanOrEqual: { label: '<=', value: '<=', description: 'Less than or equal to', isMultiValue: false },\n  contains: { label: '|=', value: '|=', description: 'Contains', isMultiValue: false },\n  doesNotContain: { label: '!=', value: '!=', description: 'Does not contain', isMultiValue: false },\n};\n","export function isLogLineJSON(line: string): boolean {\n  let parsed;\n  try {\n    parsed = JSON.parse(line);\n  } catch (error) {}\n  // The JSON parser should only be used for log lines that are valid serialized JSON objects.\n  return typeof parsed === 'object';\n}\n\n// This matches:\n// first a label from start of the string or first white space, then any word chars until \"=\"\n// second either an empty quotes, or anything that starts with quote and ends with unescaped quote,\n// or any non whitespace chars that do not start with quote\nconst LOGFMT_REGEXP = /(?:^|\\s)([\\w\\(\\)\\[\\]\\{\\}]+)=(\"\"|(?:\".*?[^\\\\]\"|[^\"\\s]\\S*))/;\n\nexport function isLogLineLogfmt(line: string): boolean {\n  return LOGFMT_REGEXP.test(line);\n}\n\nexport function isLogLinePacked(line: string): boolean {\n  let parsed;\n  try {\n    parsed = JSON.parse(line);\n    return parsed.hasOwnProperty('_entry');\n  } catch (error) {\n    return false;\n  }\n}\n","import { DataFrame, FieldType, isValidGoDuration, Labels } from '@grafana/data';\n\nimport { isBytesString, processLabels } from './languageUtils';\nimport { isLogLineJSON, isLogLineLogfmt, isLogLinePacked } from './lineParser';\nimport { LabelType } from './types';\n\nexport function dataFrameHasLokiError(frame: DataFrame): boolean {\n  const labelSets: Labels[] = frame.fields.find((f) => f.name === 'labels')?.values ?? [];\n  return labelSets.some((labels) => labels.__error__ !== undefined);\n}\n\nexport function dataFrameHasLevelLabel(frame: DataFrame): boolean {\n  const labelSets: Labels[] = frame.fields.find((f) => f.name === 'labels')?.values ?? [];\n  return labelSets.some((labels) => labels.level !== undefined);\n}\n\nexport function extractLogParserFromDataFrame(frame: DataFrame): {\n  hasLogfmt: boolean;\n  hasJSON: boolean;\n  hasPack: boolean;\n} {\n  const lineField = frame.fields.find((field) => field.type === FieldType.string);\n  if (lineField == null) {\n    return { hasJSON: false, hasLogfmt: false, hasPack: false };\n  }\n\n  const logLines: string[] = lineField.values;\n\n  let hasJSON = false;\n  let hasLogfmt = false;\n  let hasPack = false;\n\n  logLines.forEach((line) => {\n    if (isLogLineJSON(line)) {\n      hasJSON = true;\n\n      hasPack = isLogLinePacked(line);\n    }\n    if (isLogLineLogfmt(line)) {\n      hasLogfmt = true;\n    }\n  });\n\n  return { hasLogfmt, hasJSON, hasPack };\n}\n\nexport function extractLabelKeysFromDataFrame(frame: DataFrame, type: LabelType = LabelType.Indexed): string[] {\n  const labelsArray: Array<{ [key: string]: string }> | undefined =\n    frame?.fields?.find((field) => field.name === 'labels')?.values ?? [];\n  const labelTypeArray: Array<{ [key: string]: string }> | undefined =\n    frame?.fields?.find((field) => field.name === 'labelTypes')?.values ?? [];\n\n  if (!labelsArray?.length) {\n    return [];\n  }\n\n  // if there are no label types and type is LabelType.Indexed return all label keys\n  if (!labelTypeArray?.length) {\n    if (type === LabelType.Indexed) {\n      const { keys: labelKeys } = processLabels(labelsArray);\n      return labelKeys;\n    }\n    return [];\n  }\n\n  // If we have label types, we can return only label keys that match type\n  let labelsSet = new Set<string>();\n  for (let i = 0; i < labelsArray.length; i++) {\n    const labels = labelsArray[i];\n    const labelsType = labelTypeArray[i];\n\n    const allLabelKeys = Object.keys(labels).filter((key) => labelsType[key] === type);\n    labelsSet = new Set([...labelsSet, ...allLabelKeys]);\n  }\n\n  return Array.from(labelsSet);\n}\n\nexport function extractUnwrapLabelKeysFromDataFrame(frame: DataFrame): string[] {\n  const labelsArray: Array<{ [key: string]: string }> | undefined =\n    frame?.fields?.find((field) => field.name === 'labels')?.values ?? [];\n\n  if (!labelsArray?.length) {\n    return [];\n  }\n\n  // We do this only for first label object, because we want to consider only labels that are present in all log lines\n  // possibleUnwrapLabels are labels with 1. number value OR 2. value that is valid go duration OR 3. bytes string value\n  const possibleUnwrapLabels = Object.keys(labelsArray[0]).filter((key) => {\n    const value = labelsArray[0][key];\n    if (!value) {\n      return false;\n    }\n    return !isNaN(Number(value)) || isValidGoDuration(value) || isBytesString(value);\n  });\n\n  // Add only labels that are present in every line to unwrapLabels\n  return possibleUnwrapLabels.filter((label) => labelsArray.every((obj) => obj[label]));\n}\n\nexport function extractHasErrorLabelFromDataFrame(frame: DataFrame): boolean {\n  const labelField = frame.fields.find((field) => field.name === 'labels' && field.type === FieldType.other);\n  if (labelField == null) {\n    return false;\n  }\n\n  const labels: Array<{ [key: string]: string }> = labelField.values;\n  return labels.some((label) => label['__error__']);\n}\n\nexport function extractLevelLikeLabelFromDataFrame(frame: DataFrame): string | null {\n  const labelField = frame.fields.find((field) => field.name === 'labels' && field.type === FieldType.other);\n  if (labelField == null) {\n    return null;\n  }\n\n  // Depending on number of labels, this can be pretty heavy operation.\n  // Let's just look at first 2 lines If needed, we can introduce more later.\n  const labelsArray: Array<{ [key: string]: string }> = labelField.values.slice(0, 2);\n  let levelLikeLabel: string | null = null;\n\n  // Find first level-like label\n  for (let labels of labelsArray) {\n    const label = Object.keys(labels).find((label) => label === 'lvl' || label.includes('level'));\n    if (label) {\n      levelLikeLabel = label;\n      break;\n    }\n  }\n  return levelLikeLabel;\n}\n","import { CoreApp, DashboardLoadedEvent, DataQueryRequest, DataQueryResponse } from '@grafana/data';\nimport { QueryEditorMode } from '@grafana/experimental';\nimport { reportInteraction, config } from '@grafana/runtime';\n\nimport {\n  REF_ID_STARTER_ANNOTATION,\n  REF_ID_DATA_SAMPLES,\n  REF_ID_STARTER_LOG_ROW_CONTEXT,\n  REF_ID_STARTER_LOG_VOLUME,\n  REF_ID_STARTER_LOG_SAMPLE,\n} from './datasource';\nimport pluginJson from './plugin.json';\nimport { getNormalizedLokiQuery, isLogsQuery, obfuscate } from './queryUtils';\nimport { variableRegex } from './querybuilder/parsingUtils';\nimport { LokiGroupedRequest, LokiQuery, LokiQueryType } from './types';\n\ntype LokiOnDashboardLoadedTrackingEvent = {\n  grafana_version?: string;\n  dashboard_id?: string;\n  org_id?: number;\n\n  /* The number of Loki queries present in the dashboard*/\n  queries_count: number;\n\n  /* The number of Loki logs queries present in the dashboard*/\n  logs_queries_count: number;\n\n  /* The number of Loki metric queries present in the dashboard*/\n  metric_queries_count: number;\n\n  /* The number of Loki instant queries present in the dashboard*/\n  instant_queries_count: number;\n\n  /* The number of Loki range queries present in the dashboard*/\n  range_queries_count: number;\n\n  /* The number of Loki queries created in builder mode present in the dashboard*/\n  builder_mode_queries_count: number;\n\n  /* The number of Loki queries created in code mode present in the dashboard*/\n  code_mode_queries_count: number;\n\n  /* The number of Loki queries with used template variables present in the dashboard*/\n  queries_with_template_variables_count: number;\n\n  /* The number of Loki queries with changed resolution present in the dashboard*/\n  queries_with_changed_resolution_count: number;\n\n  /* The number of Loki queries with changed line limit present in the dashboard*/\n  queries_with_changed_line_limit_count: number;\n\n  /* The number of Loki queries with changed legend present in the dashboard*/\n  queries_with_changed_legend_count: number;\n};\n\nexport type LokiTrackingSettings = {\n  predefinedOperations?: string;\n};\n\nexport const onDashboardLoadedHandler = ({\n  payload: { dashboardId, orgId, grafanaVersion, queries },\n}: DashboardLoadedEvent<LokiQuery>) => {\n  try {\n    // We only want to track visible Loki queries\n    const lokiQueries = queries[pluginJson.id]\n      ?.filter((query) => !query.hide)\n      ?.map((query) => getNormalizedLokiQuery(query));\n\n    if (!lokiQueries?.length) {\n      return;\n    }\n\n    const logsQueries = lokiQueries.filter((query) => isLogsQuery(query.expr));\n    const metricQueries = lokiQueries.filter((query) => !isLogsQuery(query.expr));\n    const instantQueries = lokiQueries.filter((query) => query.queryType === LokiQueryType.Instant);\n    const rangeQueries = lokiQueries.filter((query) => query.queryType === LokiQueryType.Range);\n    const builderModeQueries = lokiQueries.filter((query) => query.editorMode === QueryEditorMode.Builder);\n    const codeModeQueries = lokiQueries.filter((query) => query.editorMode === QueryEditorMode.Code);\n    const queriesWithTemplateVariables = lokiQueries.filter(isQueryWithTemplateVariables);\n    const queriesWithChangedResolution = lokiQueries.filter(isQueryWithChangedResolution);\n    const queriesWithChangedLineLimit = lokiQueries.filter(isQueryWithChangedLineLimit);\n    const queriesWithChangedLegend = lokiQueries.filter(isQueryWithChangedLegend);\n\n    const event: LokiOnDashboardLoadedTrackingEvent = {\n      grafana_version: grafanaVersion,\n      dashboard_id: dashboardId,\n      org_id: orgId,\n      queries_count: lokiQueries.length,\n      logs_queries_count: logsQueries.length,\n      metric_queries_count: metricQueries.length,\n      instant_queries_count: instantQueries.length,\n      range_queries_count: rangeQueries.length,\n      builder_mode_queries_count: builderModeQueries.length,\n      code_mode_queries_count: codeModeQueries.length,\n      queries_with_template_variables_count: queriesWithTemplateVariables.length,\n      queries_with_changed_resolution_count: queriesWithChangedResolution.length,\n      queries_with_changed_line_limit_count: queriesWithChangedLineLimit.length,\n      queries_with_changed_legend_count: queriesWithChangedLegend.length,\n    };\n\n    reportInteraction('grafana_loki_dashboard_loaded', event);\n  } catch (error) {\n    console.error('error in loki tracking handler', error);\n  }\n};\n\nconst isQueryWithTemplateVariables = (query: LokiQuery): boolean => {\n  return variableRegex.test(query.expr);\n};\n\nconst isQueryWithChangedResolution = (query: LokiQuery): boolean => {\n  if (!query.resolution) {\n    return false;\n  }\n  // 1 is the default resolution\n  return query.resolution !== 1;\n};\n\nconst isQueryWithChangedLineLimit = (query: LokiQuery): boolean => {\n  return query.maxLines !== null && query.maxLines !== undefined;\n};\n\nconst isQueryWithChangedLegend = (query: LokiQuery): boolean => {\n  if (!query.legendFormat) {\n    return false;\n  }\n  return query.legendFormat !== '';\n};\n\nconst shouldNotReportBasedOnRefId = (refId: string): boolean => {\n  const starters = [\n    REF_ID_STARTER_ANNOTATION,\n    REF_ID_STARTER_LOG_ROW_CONTEXT,\n    REF_ID_STARTER_LOG_VOLUME,\n    REF_ID_STARTER_LOG_SAMPLE,\n    REF_ID_DATA_SAMPLES,\n  ];\n\n  if (starters.some((starter) => refId.startsWith(starter))) {\n    return true;\n  }\n  return false;\n};\n\nconst calculateTotalBytes = (response: DataQueryResponse): number => {\n  let totalBytes = 0;\n  for (const frame of response.data) {\n    const byteKey = frame.meta?.custom?.lokiQueryStatKey;\n    if (byteKey) {\n      totalBytes +=\n        frame.meta?.stats?.find((stat: { displayName: string }) => stat.displayName === byteKey)?.value ?? 0;\n    }\n  }\n  return totalBytes;\n};\n\nexport function trackQuery(\n  response: DataQueryResponse,\n  request: DataQueryRequest<LokiQuery>,\n  startTime: Date,\n  trackingSettings: LokiTrackingSettings = {},\n  extraPayload: Record<string, unknown> = {}\n): void {\n  // We only want to track usage for these specific apps\n  const { app, targets: queries } = request;\n\n  if (app !== CoreApp.Explore) {\n    return;\n  }\n\n  let totalBytes = calculateTotalBytes(response);\n\n  for (const query of queries) {\n    if (shouldNotReportBasedOnRefId(query.refId)) {\n      return;\n    }\n\n    reportInteraction('grafana_explore_loki_query_executed', {\n      grafana_version: config.buildInfo.version,\n      editor_mode: query.editorMode,\n      has_data: response.data.some((frame) => frame.length > 0),\n      has_error: response.error !== undefined,\n      legend: query.legendFormat,\n      line_limit: query.maxLines,\n      obfuscated_query: obfuscate(query.expr),\n      query_type: isLogsQuery(query.expr) ? 'logs' : 'metric',\n      query_vector_type: query.queryType,\n      resolution: query.resolution,\n      simultaneously_executed_query_count: queries.filter((query) => !query.hide).length,\n      simultaneously_hidden_query_count: queries.filter((query) => query.hide).length,\n      time_range_from: request?.range?.from?.toISOString(),\n      time_range_to: request?.range?.to?.toISOString(),\n      time_taken: Date.now() - startTime.getTime(),\n      bytes_processed: totalBytes,\n      is_split: false,\n      predefined_operations_applied: trackingSettings.predefinedOperations\n        ? query.expr.includes(trackingSettings.predefinedOperations)\n        : 'n/a',\n      ...extraPayload,\n    });\n  }\n}\n\nexport function trackGroupedQueries(\n  response: DataQueryResponse,\n  groupedRequests: LokiGroupedRequest[],\n  originalRequest: DataQueryRequest<LokiQuery>,\n  startTime: Date,\n  trackingSettings: LokiTrackingSettings = {}\n): void {\n  const splittingPayload = {\n    split_query_group_count: groupedRequests.length,\n    split_query_largest_partition_size: Math.max(...groupedRequests.map(({ partition }) => partition.length)),\n    split_query_total_request_count: groupedRequests.reduce((total, { partition }) => total + partition.length, 0),\n    is_split: true,\n    simultaneously_executed_query_count: originalRequest.targets.filter((query) => !query.hide).length,\n    simultaneously_hidden_query_count: originalRequest.targets.filter((query) => query.hide).length,\n  };\n\n  for (const group of groupedRequests) {\n    const split_query_partition_size = group.partition.length;\n    trackQuery(response, group.request, startTime, trackingSettings, {\n      ...splittingPayload,\n      split_query_partition_size,\n    });\n  }\n}\n","/** @license React v17.0.2\n * react-is.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var b=60103,c=60106,d=60107,e=60108,f=60114,g=60109,h=60110,k=60112,l=60113,m=60120,n=60115,p=60116,q=60121,r=60122,u=60117,v=60129,w=60131;\nif(\"function\"===typeof Symbol&&Symbol.for){var x=Symbol.for;b=x(\"react.element\");c=x(\"react.portal\");d=x(\"react.fragment\");e=x(\"react.strict_mode\");f=x(\"react.profiler\");g=x(\"react.provider\");h=x(\"react.context\");k=x(\"react.forward_ref\");l=x(\"react.suspense\");m=x(\"react.suspense_list\");n=x(\"react.memo\");p=x(\"react.lazy\");q=x(\"react.block\");r=x(\"react.server.block\");u=x(\"react.fundamental\");v=x(\"react.debug_trace_mode\");w=x(\"react.legacy_hidden\")}\nfunction y(a){if(\"object\"===typeof a&&null!==a){var t=a.$$typeof;switch(t){case b:switch(a=a.type,a){case d:case f:case e:case l:case m:return a;default:switch(a=a&&a.$$typeof,a){case h:case k:case p:case n:case g:return a;default:return t}}case c:return t}}}var z=g,A=b,B=k,C=d,D=p,E=n,F=c,G=f,H=e,I=l;exports.ContextConsumer=h;exports.ContextProvider=z;exports.Element=A;exports.ForwardRef=B;exports.Fragment=C;exports.Lazy=D;exports.Memo=E;exports.Portal=F;exports.Profiler=G;exports.StrictMode=H;\nexports.Suspense=I;exports.isAsyncMode=function(){return!1};exports.isConcurrentMode=function(){return!1};exports.isContextConsumer=function(a){return y(a)===h};exports.isContextProvider=function(a){return y(a)===g};exports.isElement=function(a){return\"object\"===typeof a&&null!==a&&a.$$typeof===b};exports.isForwardRef=function(a){return y(a)===k};exports.isFragment=function(a){return y(a)===d};exports.isLazy=function(a){return y(a)===p};exports.isMemo=function(a){return y(a)===n};\nexports.isPortal=function(a){return y(a)===c};exports.isProfiler=function(a){return y(a)===f};exports.isStrictMode=function(a){return y(a)===e};exports.isSuspense=function(a){return y(a)===l};exports.isValidElementType=function(a){return\"string\"===typeof a||\"function\"===typeof a||a===d||a===f||a===v||a===e||a===l||a===m||a===w||\"object\"===typeof a&&null!==a&&(a.$$typeof===p||a.$$typeof===n||a.$$typeof===g||a.$$typeof===h||a.$$typeof===k||a.$$typeof===u||a.$$typeof===q||a[0]===r)?!0:!1};\nexports.typeOf=y;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-is.production.min.js');\n} else {\n  module.exports = require('./cjs/react-is.development.js');\n}\n","/* global Map:readonly, Set:readonly, ArrayBuffer:readonly */\n\nvar hasElementType = typeof Element !== 'undefined';\nvar hasMap = typeof Map === 'function';\nvar hasSet = typeof Set === 'function';\nvar hasArrayBuffer = typeof ArrayBuffer === 'function' && !!ArrayBuffer.isView;\n\n// Note: We **don't** need `envHasBigInt64Array` in fde es6/index.js\n\nfunction equal(a, b) {\n  // START: fast-deep-equal es6/index.js 3.1.1\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    if (a.constructor !== b.constructor) return false;\n\n    var length, i, keys;\n    if (Array.isArray(a)) {\n      length = a.length;\n      if (length != b.length) return false;\n      for (i = length; i-- !== 0;)\n        if (!equal(a[i], b[i])) return false;\n      return true;\n    }\n\n    // START: Modifications:\n    // 1. Extra `has<Type> &&` helpers in initial condition allow es6 code\n    //    to co-exist with es5.\n    // 2. Replace `for of` with es5 compliant iteration using `for`.\n    //    Basically, take:\n    //\n    //    ```js\n    //    for (i of a.entries())\n    //      if (!b.has(i[0])) return false;\n    //    ```\n    //\n    //    ... and convert to:\n    //\n    //    ```js\n    //    it = a.entries();\n    //    while (!(i = it.next()).done)\n    //      if (!b.has(i.value[0])) return false;\n    //    ```\n    //\n    //    **Note**: `i` access switches to `i.value`.\n    var it;\n    if (hasMap && (a instanceof Map) && (b instanceof Map)) {\n      if (a.size !== b.size) return false;\n      it = a.entries();\n      while (!(i = it.next()).done)\n        if (!b.has(i.value[0])) return false;\n      it = a.entries();\n      while (!(i = it.next()).done)\n        if (!equal(i.value[1], b.get(i.value[0]))) return false;\n      return true;\n    }\n\n    if (hasSet && (a instanceof Set) && (b instanceof Set)) {\n      if (a.size !== b.size) return false;\n      it = a.entries();\n      while (!(i = it.next()).done)\n        if (!b.has(i.value[0])) return false;\n      return true;\n    }\n    // END: Modifications\n\n    if (hasArrayBuffer && ArrayBuffer.isView(a) && ArrayBuffer.isView(b)) {\n      length = a.length;\n      if (length != b.length) return false;\n      for (i = length; i-- !== 0;)\n        if (a[i] !== b[i]) return false;\n      return true;\n    }\n\n    if (a.constructor === RegExp) return a.source === b.source && a.flags === b.flags;\n    if (a.valueOf !== Object.prototype.valueOf) return a.valueOf() === b.valueOf();\n    if (a.toString !== Object.prototype.toString) return a.toString() === b.toString();\n\n    keys = Object.keys(a);\n    length = keys.length;\n    if (length !== Object.keys(b).length) return false;\n\n    for (i = length; i-- !== 0;)\n      if (!Object.prototype.hasOwnProperty.call(b, keys[i])) return false;\n    // END: fast-deep-equal\n\n    // START: react-fast-compare\n    // custom handling for DOM elements\n    if (hasElementType && a instanceof Element) return false;\n\n    // custom handling for React/Preact\n    for (i = length; i-- !== 0;) {\n      if ((keys[i] === '_owner' || keys[i] === '__v' || keys[i] === '__o') && a.$$typeof) {\n        // React-specific: avoid traversing React elements' _owner\n        // Preact-specific: avoid traversing Preact elements' __v and __o\n        //    __v = $_original / $_vnode\n        //    __o = $_owner\n        // These properties contain circular references and are not needed when\n        // comparing the actual elements (and not their owners)\n        // .$$typeof and ._store on just reasonable markers of elements\n\n        continue;\n      }\n\n      // all other properties should be traversed as usual\n      if (!equal(a[keys[i]], b[keys[i]])) return false;\n    }\n    // END: react-fast-compare\n\n    // START: fast-deep-equal\n    return true;\n  }\n\n  return a !== a && b !== b;\n}\n// end fast-deep-equal\n\nmodule.exports = function isEqual(a, b) {\n  try {\n    return equal(a, b);\n  } catch (error) {\n    if (((error.message || '').match(/stack|recursion/i))) {\n      // warn on circular references, don't crash\n      // browsers give this different errors name and messages:\n      // chrome/safari: \"RangeError\", \"Maximum call stack size exceeded\"\n      // firefox: \"InternalError\", too much recursion\"\n      // edge: \"Error\", \"Out of stack space\"\n      console.warn('react-fast-compare cannot handle circular refs');\n      return false;\n    }\n    // some other error. we should definitely know about these\n    throw error;\n  }\n};\n","export default /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;","import REGEX from './regex.js';\n\nfunction validate(uuid) {\n  return typeof uuid === 'string' && REGEX.test(uuid);\n}\n\nexport default validate;","import { LRParser } from '@lezer/lr';\n\n// This file was generated by lezer-generator. You probably shouldn't edit it.\nconst Json$1 = 1,\n  Logfmt$1 = 2,\n  Unpack$1 = 3,\n  Pattern$1 = 4,\n  Regexp$1 = 5,\n  Unwrap$1 = 6,\n  LabelFormat$1 = 7,\n  LineFormat$1 = 8,\n  LabelReplace$1 = 9,\n  Vector$1 = 10,\n  Offset$1 = 11,\n  Bool$1 = 12,\n  On$1 = 13,\n  Ignoring$1 = 14,\n  GroupLeft$1 = 15,\n  GroupRight$1 = 16,\n  Decolorize$1 = 17,\n  Drop$1 = 18,\n  Keep$1 = 19,\n  By$1 = 20,\n  Without$1 = 21,\n  And$1 = 22,\n  Or$1 = 23,\n  Unless$1 = 24,\n  Sum$1 = 25,\n  Avg$1 = 26,\n  Count$1 = 27,\n  Max$1 = 28,\n  Min$1 = 29,\n  Stddev$1 = 30,\n  Stdvar$1 = 31,\n  Bottomk$1 = 32,\n  Topk$1 = 33,\n  Sort$1 = 34,\n  Sort_Desc$1 = 35;\n\nconst keywordTokens = {\n  json: Json$1,\n  logfmt: Logfmt$1,\n  unpack: Unpack$1,\n  pattern: Pattern$1,\n  regexp: Regexp$1,\n  label_format: LabelFormat$1,\n  line_format: LineFormat$1,\n  label_replace: LabelReplace$1,\n  vector: Vector$1,\n  offset: Offset$1,\n  bool: Bool$1,\n  on: On$1,\n  ignoring: Ignoring$1,\n  group_left: GroupLeft$1,\n  group_right: GroupRight$1,\n  unwrap: Unwrap$1,\n  decolorize: Decolorize$1,\n  drop: Drop$1,\n  keep: Keep$1,\n};\n\nconst specializeIdentifier = (value) => {\n  return keywordTokens[value.toLowerCase()] || -1;\n};\n\nconst contextualKeywordTokens = {\n  by: By$1,\n  without: Without$1,\n  and: And$1,\n  or: Or$1,\n  unless: Unless$1,\n  sum: Sum$1,\n  avg: Avg$1,\n  count: Count$1,\n  max: Max$1,\n  min: Min$1,\n  stddev: Stddev$1,\n  stdvar: Stdvar$1,\n  bottomk: Bottomk$1,\n  topk: Topk$1,\n  sort: Sort$1,\n  sort_desc: Sort_Desc$1,\n};\n\nconst extendIdentifier = (value) => {\n  return contextualKeywordTokens[value.toLowerCase()] || -1;\n};\n\n// This file was generated by lezer-generator. You probably shouldn't edit it.\nconst spec_Identifier = {__proto__:null,ip:295, count_over_time:301, rate:303, rate_counter:305, bytes_over_time:307, bytes_rate:309, avg_over_time:311, sum_over_time:313, min_over_time:315, max_over_time:317, stddev_over_time:319, stdvar_over_time:321, quantile_over_time:323, first_over_time:325, last_over_time:327, absent_over_time:329, bytes:335, duration:337, duration_seconds:339};\nconst parser = LRParser.deserialize({\n  version: 14,\n  states: \"EtOYQPOOO#cQPO'#DUOOQO'#ER'#ERO#hQPO'#ERO$}QPO'#DTOYQPO'#DTOOQO'#Ed'#EdO%[QPO'#EcOOQO'#FP'#FPO%aQPO'#FOQ%lQPOOO&mQPO'#F]O&rQPO'#F^OOQO'#Eb'#EbOOQO'#DS'#DSOOQO'#Ee'#EeOOQO'#Ef'#EfOOQO'#Eg'#EgOOQO'#Eh'#EhOOQO'#Ei'#EiOOQO'#Ej'#EjOOQO'#Ek'#EkOOQO'#El'#ElOOQO'#Em'#EmOOQO'#En'#EnOOQO'#Eo'#EoOOQO'#Ep'#EpOOQO'#Eq'#EqOOQO'#Er'#ErOOQO'#Es'#EsO&wQPO'#DWOOQO'#DV'#DVO'VQPO,59pOOQO,5:m,5:mOOQO'#Dc'#DcO'_QPO'#DbO'gQPO'#DaO)lQPO'#D`O*{QPO'#D`OOQO'#D_'#D_O+sQPO,59oO-}QPO,59oO.UQPO,5:|O.]QPO,5:}O.hQPO'#E|O0sQPO,5;jO0zQPO,5;jO1PQPO,5;lO1PQPO,5;lO1PQPO,5;lO1PQPO,5;lO1PQPO,5;lO1PQPO,5;lOYQPO,5;wO3cQPO,5;xO3hQPO,59rO#cQPO,59qOOQO1G/[1G/[OOQO'#Dh'#DhO3mQPO,59|O5^QPO,59|OOQO'#Di'#DiO5cQPO,59{OOQO,59{,59{O5kQPO'#DWO6YQPO'#DlO8PQPO'#DoO9sQPO'#DoOOQO'#Do'#DoOOQO'#Dv'#DvOOQO'#Dt'#DtO+kQPO'#DtO9xQPO,59zO;iQPO'#EVO;nQPO'#EWOOQO'#EZ'#EZO;sQPO'#E[O;xQPO'#E_OOQO,59z,59zOOQO,59y,59yOOQO1G/Z1G/ZOOQO1G0h1G0hO;}QPO'#EtO.`QPO'#EtO<XQPO1G0iO<^QPO1G0iO<cQPO,5;hO=oQPO1G1UO=vQPO1G1UO=}QPO1G1UO>UQPO'#FSO@dQPO'#FRO@nQPO'#FROYQPO1G1WOYQPO1G1WOYQPO1G1WOYQPO1G1WOYQPO1G1WOYQPO1G1WO@xQPO1G1cOAPQPO1G1dOOQO1G/^1G/^OOQO1G/]1G/]O5cQPO1G/hOAUQPO1G/hOAZQPO'#DjOBzQPO'#DjOOQO1G/g1G/gOCbQPO,59rOCPQPO,5:cOOQO'#Dm'#DmOClQPO,5:WOEcQPO'#DrOOQO'#Dq'#DqOGVQPO,5:_OHvQPO,5:[OOQO,5:Z,5:ZOJgQPO,5:`O+kQPO,5:`O+kQPO,5:`OOQO,5:q,5:qOJuQPO'#EYOOQO'#EX'#EXOJzQPO,5:rOLkQPO'#E^OOQO'#E^'#E^OOQO'#E]'#E]ONbQPO,5:vO!!RQPO'#EaOOQO'#Ea'#EaOOQO'#E`'#E`O!#xQPO,5:yO!%iQPO'#D`O;}QPO,5;`O!%pQPO'#EuO!%uQPO,5;`O!%}QPO,5;`O!&[QPO,5;`O!&iQPO,5;`O!&nQPO7+&TO.`QPO7+&TOOQO'#E}'#E}O!(OQPO1G1SOOQO1G1S1G1SOYQPO7+&pO!(WQPO7+&pO!)hQPO7+&pO!)oQPO7+&pO!)vQQO'#FTOOQO,5;n,5;nO!,UQPO,5;mO!,]QPO,5;mO!-nQPO7+&rO!-uQPO7+&rOOQO7+&r7+&rO!.SQPO7+&rO!.ZQPO7+&rO!/`QPO7+&rO!/pQPO7+&}OOQO7+'O7+'OOOQO7+%S7+%SO!/uQPO7+%SO5cQPO,5:UO!/zQPO,5:UO!0PQPO1G/{OOQO1G/}1G/}OOQO1G0U1G0UOOQO1G0W1G0WOOQO,5:X,5:XO!0UQPO1G/yO!1uQPO,5:^O!1zQPO,5:]OOQO1G/z1G/zO!2PQPO1G/zO!3pQPO,5:tO;nQPO,5:sO;sQPO,5:wO;xQPO,5:zO!3xQPO,5;cO!%uQPO1G0zO!4WQPO1G0zO!4`QPO,5;aO+kQPO,5;cO!4eQPO1G0zO!4oQPO'#EvO!4tQPO1G0zO!4eQPO1G0zO!4|QPO1G0zO!5ZQPO1G0zO!%xQPO1G0zOOQO1G0z1G0zOOQO<<Io<<IoO!5fQPO<<IoO!5kQPO,5;iOOQO7+&n7+&nO!5pQPO<<J[OOQO<<J[<<J[OYQPO<<J[OOQO'#FV'#FVO!5wQPO,5;oOOQO'#FU'#FUOOQO,5;o,5;oOOQO1G1X1G1XO!6PQPO1G1XO!8YQPO<<JiOOQO<<Hn<<HnOOQO1G/p1G/pO!8_QPO1G/pO!8dQPO7+%gOOQO1G/x1G/xOOQO1G/w1G/wOOQO1G0`1G0`OOQO1G0_1G0_OOQO1G0c1G0cOOQO1G0f1G0fOOQO'#Ex'#ExOOQO1G0}1G0}O!8iQPO1G0}OOQO'#Ey'#EyOOQO'#Ez'#EzOOQO'#E{'#E{OOQO7+&f7+&fOOQO1G0{1G0{O!8nQPO1G0}O!9SQPO7+&fOOQO,5;b,5;bO!9[QPO7+&fO!%xQPO7+&fO!9fQPO7+&fO!9qQPOAN?ZOOQO1G1T1G1TO!;RQPOAN?vO!<cQPOAN?vO!<jQQO1G1ZOOQO1G1Z1G1ZOOQO7+&s7+&sO!<rQPOAN@TOOQO7+%[7+%[O!<wQPO<<IRO!<|QPO7+&iO!=RQPO<<JQO!=ZQPO<<JQO!=cQPO'#EwO!=hQPO<<JQOOQOG24uG24uOOQOG25bG25bOOQO1G1[1G1[OOQO7+&u7+&uO!=pQPOG25oOOQOAN>mAN>mO!=uQPO<<JTOOQOAN?lAN?lO!=zQPOAN?lO!>SQPOLD+ZOOQOAN?oAN?oOOQO,5:r,5:rO!>XQPO!$'NuO!>^QPO!)9DaO!>cQPO!.K9{OOQO!4//g!4//gO;nQPO'#EWO!>hQPO'#D`O!?`QPO,59oO!@fQPO'#DTOYQPO1G1WOYQPO1G1WOYQPO1G1WOYQPO1G1WOYQPO1G1WOYQPO1G1WO1PQPO,5;lO1PQPO,5;lO1PQPO,5;lO1PQPO,5;lO1PQPO,5;lO1PQPO,5;lO!AqQPO7+&rO!AxQPO7+&rO!BVQPO7+&rO!C_QPO7+&rO!CfQPO7+&rO!B^QPO'#FQ\",\n  stateData: \"!Cs~O$TOStOS~OXZOY[OiWOjWOkWOlWOmWOnWOoWOpWOqWOrWOsWO!vQO!wRO!xRO$UPO$YTO$[_O$]`O$^aO$_bO$`cO$adO$beO$cfO$dgO$ehO$fiO$gjO$hkO$ilO$jmO~O{nO~O!vqO~O!OrO!QrO!WrO!XrO!YrO!ZrOfwXgwXhwX!lwX!nwX!owX!pwX!qwX!wwX!xwX#{wX#|wX#}wX$OwX~O!_vO$RwX$ZwX~P#mO$Y{O~Od|Oe|O$Y}O~Of!QOg!POh!QO!O!UO!l!UO!n!UO!o!UO!p!UO!q!UO!w!RO!x!RO#{!SO#|!SO#}!SO$O!TO~O$Y!VO~O$Y!WO~O|!XO!O!XO!P!XO!Q!XO~O$V!YO$W!ZO~O}!]O$X!_O~Og!`Of!TXh!TX!O!TX!Q!TX!W!TX!X!TX!Y!TX!Z!TX!_!TX!l!TX!n!TX!o!TX!p!TX!q!TX!w!TX!x!TX#{!TX#|!TX#}!TX$O!TX$R!TX$Z!TX$k!TX$V!TX~O!OrO!QrO!WrO!XrO!YrO!ZrO~Of!SXg!SXh!SX!_!SX!l!SX!n!SX!o!SX!p!SX!q!SX!w!SX!x!SX#{!SX#|!SX#}!SX$O!SX$R!SX$Z!SX$k!SX$V!SX~P)WOP!dOQ!cOR!fOS!eOT!eOV!lOW!kOa!mOb!nOc!oO{!bO$Y!iO~O!_vOfwagwahwa!lwa!nwa!owa!pwa!qwa!wwa!xwa#{wa#|wa#}wa$Owa$Rwa$Zwa~P)WOfvXgvXhvX!OvX!lvX!nvX!ovX!pvX!qvX!wvX!xvX#{vX#|vX#}vX$OvX~O$Z!rO~P,|O$Z!sO~P,|O!v!wO$UPO$Y!uO~O$Y!xO~OXZOY[OiWOjWOkWOlWOmWOnWOoWOpWOqWOrWOsWO!wRO!xRO$UPO$YTO$[_O$]`O$^aO$_bO$`cO$adO$beO$cfO$dgO$ehO$fiO$gjO$hkO$ilO$jmO~O!v!yO~P.mO$Y!{O~O[#OO]!|O^!|OX#uPY#uPi#uPj#uPk#uPl#uPm#uPn#uPo#uPp#uPq#uPr#uPs#uP!v#uP!w#uP!x#uP$U#uP$Y#uP$[#uP$]#uP$^#uP$_#uP$`#uP$a#uP$b#uP$c#uP$d#uP$e#uP$f#uP$g#uP$h#uP$i#uP$j#uP~O!v#WO~O}#XO~Og#ZOf!Uah!Ua!O!Ua!Q!Ua!W!Ua!X!Ua!Y!Ua!Z!Ua!_!Ua!l!Ua!n!Ua!o!Ua!p!Ua!q!Ua!w!Ua!x!Ua#{!Ua#|!Ua#}!Ua$O!Ua$R!Ua$Z!Ua$k!Ua$V!Ua~O$Y#[O~O}#]O$X!_O~O|#`O!O#`O!P!XO!Q!XO!l#aO!n#aO!o#aO!p#aO!q#aO~O{#dO!b#bOf!`Xg!`Xh!`X!O!`X!Q!`X!W!`X!X!`X!Y!`X!Z!`X!_!`X!l!`X!n!`X!o!`X!p!`X!q!`X!w!`X!x!`X#{!`X#|!`X#}!`X$O!`X$R!`X$Z!`X$k!`X$V!`X~O{#dOf!cXg!cXh!cX!O!cX!Q!cX!W!cX!X!cX!Y!cX!Z!cX!_!cX!l!cX!n!cX!o!cX!p!cX!q!cX!w!cX!x!cX#{!cX#|!cX#}!cX$O!cX$R!cX$Z!cX$k!cX$V!cX~O}#hO~Of#jOg#kO$V#jOh!Sa!O!Sa!Q!Sa!W!Sa!X!Sa!Y!Sa!Z!Sa!_!Sa!l!Sa!n!Sa!o!Sa!p!Sa!q!Sa!w!Sa!x!Sa#{!Sa#|!Sa#}!Sa$O!Sa$R!Sa$Z!Sa$k!Sa~O}#lO~O{#mO~O{#pO~O{#tO~O!_#xO$k#zO~P)WO$Z$PO~O$V$QO~O{$RO$Z$TO~Of!uXg!uXh!uX!O!uX!l!uX!n!uX!o!uX!p!uX!q!uX!w!uX!x!uX#{!uX#|!uX#}!uX$O!uX$Z!uX~O$V$UO~P<kO$Z$VO~P,|O!v$WO~P.mO$Y$YO~OX#uXY#uXi#uXj#uXk#uXl#uXm#uXn#uXo#uXp#uXq#uXr#uXs#uX!v#uX!w#uX!x#uX$U#uX$Y#uX$[#uX$]#uX$^#uX$_#uX$`#uX$a#uX$b#uX$c#uX$d#uX$e#uX$f#uX$g#uX$h#uX$i#uX$j#uX~O_$[O`$[O~P>ZO]!|O^!|O~P>ZO$V$dO~P,|O$Z$eO~O}$gO~Og$hOf!^Xh!^X!O!^X!Q!^X!W!^X!X!^X!Y!^X!Z!^X!_!^X!l!^X!n!^X!o!^X!p!^X!q!^X!w!^X!x!^X#{!^X#|!^X#}!^X$O!^X$R!^X$Z!^X$k!^X$V!^X~O$Y$iO~O!m$kO!s$lO!vQO!wRO!xRO~O}#XO$X!_O~PCPO{#dO!b$nOf!`ag!`ah!`a!O!`a!Q!`a!W!`a!X!`a!Y!`a!Z!`a!_!`a!l!`a!n!`a!o!`a!p!`a!q!`a!w!`a!x!`a#{!`a#|!`a#}!`a$O!`a$R!`a$Z!`a$k!`a$V!`a~O|$pOf!fXg!fXh!fX!O!fX!Q!fX!W!fX!X!fX!Y!fX!Z!fX!_!fX!l!fX!n!fX!o!fX!p!fX!q!fX!w!fX!x!fX#{!fX#|!fX#}!fX$O!fX$R!fX$V!fX$Z!fX$k!fX~O$V$qOf!gag!gah!ga!O!ga!Q!ga!W!ga!X!ga!Y!ga!Z!ga!_!ga!l!ga!n!ga!o!ga!p!ga!q!ga!w!ga!x!ga#{!ga#|!ga#}!ga$O!ga$R!ga$Z!ga$k!ga~O$V$qOf!dag!dah!da!O!da!Q!da!W!da!X!da!Y!da!Z!da!_!da!l!da!n!da!o!da!p!da!q!da!w!da!x!da#{!da#|!da#}!da$O!da$R!da$Z!da$k!da~Of#jOg#kO$V#jO$Z$rO~O|$tO~O$V$uOf!zag!zah!za!O!za!Q!za!W!za!X!za!Y!za!Z!za!_!za!l!za!n!za!o!za!p!za!q!za!w!za!x!za#{!za#|!za#}!za$O!za$R!za$Z!za$k!za~O|!XO!O!XO!P!XO!Q!XOf#QXg#QXh#QX!W#QX!X#QX!Y#QX!Z#QX!_#QX!l#QX!n#QX!o#QX!p#QX!q#QX!w#QX!x#QX#{#QX#|#QX#}#QX$O#QX$R#QX$V#QX$Z#QX$k#QX~O$V$vOf#Oag#Oah#Oa!O#Oa!Q#Oa!W#Oa!X#Oa!Y#Oa!Z#Oa!_#Oa!l#Oa!n#Oa!o#Oa!p#Oa!q#Oa!w#Oa!x#Oa#{#Oa#|#Oa#}#Oa$O#Oa$R#Oa$Z#Oa$k#Oa~O|!XO!O!XO!P!XO!Q!XOf#TXg#TXh#TX!W#TX!X#TX!Y#TX!Z#TX!_#TX!l#TX!n#TX!o#TX!p#TX!q#TX!w#TX!x#TX#{#TX#|#TX#}#TX$O#TX$R#TX$V#TX$Z#TX$k#TX~O$V$wOf#Rag#Rah#Ra!O#Ra!Q#Ra!W#Ra!X#Ra!Y#Ra!Z#Ra!_#Ra!l#Ra!n#Ra!o#Ra!p#Ra!q#Ra!w#Ra!x#Ra#{#Ra#|#Ra#}#Ra$O#Ra$R#Ra$Z#Ra$k#Ra~OU$xO~P*{O!m${O~O!_$|O$k#zO~OZ%OO!_#xO$Z#ha~P)WO!_#xO$Z%TO$k#zO~P)WO$Z%UO~Od|Oe|Of#Vqg#Vqh#Vq!O#Vq!l#Vq!n#Vq!o#Vq!p#Vq!q#Vq!w#Vq!x#Vq#{#Vq#|#Vq#}#Vq$O#Vq$R#Vq$Z#Vq$V#Vq~O$V%XO$Z%YO~Od|Oe|Of#rqg#rqh#rq!O#rq!l#rq!n#rq!o#rq!p#rq!q#rq!w#rq!x#rq#{#rq#|#rq#}#rq$O#rq$R#rq$Z#rq$V#rq~O$V%]O~P<kO$Z%[O~P,|O#z%^O$Z%aO~OX#uaY#uai#uaj#uak#ual#uam#uan#uao#uap#uaq#uar#uas#ua!v#ua!w#ua!x#ua$U#ua$[#ua$]#ua$^#ua$_#ua$`#ua$a#ua$b#ua$c#ua$d#ua$e#ua$f#ua$g#ua$h#ua$i#ua$j#ua~O$Y$YO~P!*OO_%cO`%cO$Y#ua~P!*OOf!QOh!QO!O!UO!l!UO!n!UO!o!UO!p!UO!q!UO!w!RO!x!RO#{#tq#|#tq#}#tq$O#tq$R#tq$Z#tq~Og#tq~P!,jOf#tqg#tqh#tq~P!,pOg!PO~P!,jO$R#tq$Z#tq~P%lOf#tqg#tqh#tq!O#tq!l#tq!n#tq!o#tq!p#tq!q#tq#{#tq#|#tq#}#tq$O#tq~O!w!RO!x!RO$R#tq$Z#tq~P!.eO}%dO~O$Z%eO~O}%gO~O$Y%hO~O$V$qOf!gig!gih!gi!O!gi!Q!gi!W!gi!X!gi!Y!gi!Z!gi!_!gi!l!gi!n!gi!o!gi!p!gi!q!gi!w!gi!x!gi#{!gi#|!gi#}!gi$O!gi$R!gi$Z!gi$k!gi~O}%iO~O{#dO~Of#jO$V#jOg!hih!hi!O!hi!Q!hi!W!hi!X!hi!Y!hi!Z!hi!_!hi!l!hi!n!hi!o!hi!p!hi!q!hi!w!hi!x!hi#{!hi#|!hi#}!hi$O!hi$R!hi$Z!hi$k!hi~O{%kO}%kO~O{%pO$m%rO$n%sO$o%tO~OZ%OO$Z#hi~O$l%vO~O!_#xO$Z#hi~P)WO!m%yO~O!_$|O$Z#hi~O!_#xO$Z%{O$k#zO~P)WO!_$|O$Z%{O$k#zO~O$Z%}O~O{&OO~O$Z&PO~P,|O$V&RO$Z&SO~O$Y$YOX#uiY#uii#uij#uik#uil#uim#uin#uio#uip#uiq#uir#uis#ui!v#ui!w#ui!x#ui$U#ui$[#ui$]#ui$^#ui$_#ui$`#ui$a#ui$b#ui$c#ui$d#ui$e#ui$f#ui$g#ui$h#ui$i#ui$j#ui~O$V&UO~O$Z&VO~O}&WO~O$Y&XO~Of#jOg#kO$V#jO!_#ki$k#ki$Z#ki~O!_$|O$Z#hq~O!_#xO$Z#hq~P)WOZ%OO!_&[O$Z#hq~Od|Oe|Of#V!Rg#V!Rh#V!R!O#V!R!l#V!R!n#V!R!o#V!R!p#V!R!q#V!R!w#V!R!x#V!R#{#V!R#|#V!R#}#V!R$O#V!R$R#V!R$Z#V!R$V#V!R~Od|Oe|Of#r!Rg#r!Rh#r!R!O#r!R!l#r!R!n#r!R!o#r!R!p#r!R!q#r!R!w#r!R!x#r!R#{#r!R#|#r!R#}#r!R$O#r!R$R#r!R$Z#r!R$V#r!R~O$Z&_O~P,|O#z%^O$Z&aO~O}&bO~O$Z&cO~O{&dO~O!_$|O$Z#hy~OZ%OO$Z#hy~OU$xO~O!_&[O$Z#hy~O$V&gO~O$Z&hO~O!_$|O$Z#h!R~O}&jO~O$V&kO~O}&lO~O$Z&mO~OP!dOQ!cOR!fOS!eOT!eOV&nOW!kOa!mOb!nOc!oO{!bO$Y!iO~O!_&oOfwagwahwa!lwa!nwa!owa!pwa!qwa!wwa!xwa#{wa#|wa#}wa$Owa$Vwa~P)WO!_&oO$VwX~P#mOf&yOh&yO!O&}O!l&}O!n&}O!o&}O!p&}O!q&}O!w&zO!x&zO#{#tq#|#tq#}#tq$O#tq$V#tq~Og#tq~P!@pOf#tqg#tqh#tq~P!@vOg&xO~P!@pOf&yOg&xOh&yO!O&}O!l&}O!n&}O!o&}O!p&}O!q&}O!w&zO!x&zO#{&{O#|&{O#}&{O$O&|O~O$V#tq~P!B^O!w&zO!x&zO$V#tq~P!.eO\",\n  goto: \"1l$RPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP$S%R%j&Y&]PPPPPP&t'W'h'v(XPPPP(h(p(yP)S)XP)S)S)[)e)S)m*O*O*XPPPPPP*XP*O*bPPP)S)S*{+R)S)S+Y+])S+c+f+l,_,t-Z-Z-Z-Z-Z-Z-Z-Z-Z-Z-Z-Z-Z-Z-Z-p-y.^.j/S/V/V/V/Y/i,_/l,_0R0w1Y1c1fPPPPP,_,_[YOT}!{$U%]Q$^#PQ$_#QS$`#R&tQ$a#SQ$b#TQ$c#UQ'O&rQ'P&sQ'Q&uQ'R&vQ'S&wR'T!Vt^O}!V!{#P#Q#R#S#T#U$U%]&r&s&t&u&v&wRyTjSOT}!V!{#P#Q#R#S#T#U$U%]S!t{$QQ#}!u]&q&r&s&t&u&v&wRpPQoP^!hv!i#j#k#x$|&oQ#Y!YS#q!n$vT#u!o$wQxSQ#y!tQ$}#|Q%R#}Q%z%QR&p&q[wS!t#|#}%Q&q]!qx#y$}%R%z&piuSx!t#y#|#}$}%Q%R%z&p&qhtSx!t#y#|#}$}%Q%R%z&p&qR!auksSux!t#y#|#}$}%Q%R%z&p&qQ!^sV#^!`#Z$hW![s!`#Z$hR$j#`Q#_!`Q$f#ZR%f$hV!pv#x&oR#c!cQ#f!cQ#g!dR$o#cU#e!c!d#cR%j$qU!jv#x&oQ#i!iQ$r#jQ$s#kR%w$|_!hv!i#j#k#x$|&o_!gv!i#j#k#x$|&ov]OT}!V!{#P#Q#R#S#T#U$U%]&r&s&t&u&v&wT$m#`#aQ#o!lR&i&nS#n!l&nR%l$uR#s!nQ#r!nR%m$vR#w!oQ#v!oR%n$wj^O#P#Q#R#S#T#U&r&s&t&u&v&wQzTQ!z}Q#V!VQ$X!{Q%Z$UR&Q%]w]OT}!V!{#P#Q#R#S#T#U$U%]&r&s&t&u&v&wwVOT}!V!{#P#Q#R#S#T#U$U%]&r&s&t&u&v&wwUOT}!V!{#P#Q#R#S#T#U$U%]&r&s&t&u&v&wQ!v{Q$O!uR%W$QS#|!t#}W$z#y#{%R%SQ%u$yQ%|%TR&Z%{Q%Q#|Q%u$zQ&]%|R&e&ZQ#{!tS$y#y%RQ%P#|Q%S#}S%x$}%QS&Y%z%|R&f&]R%q$xR%o$xQ!OXQ%V$PQ%[$VQ&^%}R&_&PR$S!xwXOT}!V!{#P#Q#R#S#T#U$U%]&r&s&t&u&v&wQ#P!PQ#Q!QQ#R!RQ#S!SQ#T!TQ#U!UQ&r&xQ&s&yQ&t&zQ&u&{Q&v&|R&w&}h!}!P!Q!R!S!T!U&x&y&z&{&|&}R$]#OQ$Z!|Q%b$[R&T%cR%_$YQ%`$YR&`&R\",\n  nodeNames: \" Json Logfmt Unpack Pattern Regexp Unwrap LabelFormat LineFormat LabelReplace Vector Offset Bool On Ignoring GroupLeft GroupRight Decolorize Drop Keep By Without And Or Unless Sum Avg Count Max Min Stddev Stdvar Bottomk Topk Sort Sort_Desc LineComment LogQL Expr LogExpr Selector Matchers Matcher Identifier Eq String Neq Re Nre PipelineExpr PipelineStage LineFilters LineFilter Filter PipeExact PipeMatch PipePattern Npa FilterOp Ip OrFilter Pipe LogfmtParser LogfmtParserFlags ParserFlag LabelParser JsonExpressionParser LabelExtractionExpressionList LabelExtractionExpression LogfmtExpressionParser LabelFilter IpLabelFilter UnitFilter DurationFilter Gtr Duration Gte Lss Lte Eql BytesFilter Bytes NumberFilter LiteralExpr Number Add Sub LineFormatExpr LabelFormatExpr LabelsFormat LabelFormatMatcher DecolorizeExpr DropLabelsExpr DropLabels DropLabel KeepLabelsExpr KeepLabels KeepLabel MetricExpr RangeAggregationExpr RangeOp CountOverTime Rate RateCounter BytesOverTime BytesRate AvgOverTime SumOverTime MinOverTime MaxOverTime StddevOverTime StdvarOverTime QuantileOverTime FirstOverTime LastOverTime AbsentOverTime LogRangeExpr Range OffsetExpr UnwrapExpr ConvOp BytesConv DurationConv DurationSecondsConv Grouping Labels VectorAggregationExpr VectorOp BinOpExpr BinOpModifier OnOrIgnoringModifier GroupingLabels GroupingLabelList GroupingLabel LabelName Mul Div Mod Pow LabelReplaceExpr VectorExpr\",\n  maxTerm: 169,\n  skippedNodes: [0,36],\n  repeatNodeCount: 0,\n  tokenData: \"5r~RvX^#ipq#iqr$^rs$yst%kuv%vxy%{yz&Qz{&V{|&[|}&a}!O&f!O!P(t!P!Q)t!Q!R)y!R![+a![!]2a!^!_2u!_!`3S!`!a3i!c!}3v!}#O4^#P#Q4c#Q#R4h#R#S3v#S#T4m#T#o3v#o#p4y#p#q5O#q#r5m#y#z#i$f$g#i#BY#BZ#i$IS$I_#i$I|$JO#i$JT$JU#i$KV$KW#i&FU&FV#i~#nY$T~X^#ipq#i#y#z#i$f$g#i#BY#BZ#i$IS$I_#i$I|$JO#i$JT$JU#i$KV$KW#i&FU&FV#i~$aR!_!`$j!`!a$o#r#s$t~$oO!O~~$tO!Z~~$yO!Q~~$|UOY$yZr$yrs%`s#O$y#O#P%e#P~$y~%eO}~~%hPO~$y~%pQt~OY%kZ~%k~%{O#}~~&QO$Y~~&VO$Z~~&[O#{~~&aO!w~~&fO$V~~&kP!x~}!O&n~&qQ#_#`&w#g#h(U~&zP#X#Y&}~'QP#X#Y'T~'WP#d#e'Z~'^P}!O'a~'dP#X#Y'g~'jP#a#b'm~'pP#d#e's~'vP#h#i'y~'|P#m#n(P~(UO!b~~(XP#h#i([~(_P#f#g(b~(eP#]#^(h~(kP#V#W(n~(qP#h#i(P~(wP!Q![(z~)PR!v~!Q![(z!g!h)Y#X#Y)Y~)]R{|)f}!O)f!Q![)l~)iP!Q![)l~)qP!v~!Q![)l~)yO#|~~*Oe!v~!O!P(z!Q![+a!g!h,t!i!j-c!m!n-c!o!p-c!r!s-c!v!w-c#U#V-W#W#X-l#X#Y/n#Z#[0Q#[#].T#_#`0Q#a#b0Z#d#e0Q#g#h/]#h#i0Q#k#l0l#l#m1u#m#n1W~+fd!v~!O!P(z!Q![+a!g!h,t!i!j-c!m!n-c!o!p-c!r!s-c!v!w-c#U#V-W#W#X-l#X#Y/n#Z#[0Q#[#].T#_#`0Q#a#b0Z#d#e0Q#g#h/]#h#i0Q#k#l0l#m#n1W~,wT{|)f}!O)f!Q![)l!d!e-W#]#^-]~-]O!s~~-`P#U#V-W~-fQ!d!e-W#]#^-]~-qP!m~!Q![-t~-wS!Q![-t#[#].T#a#b.i#g#h/]~.YP!m~!Q![.]~.`R!Q![.]#a#b.i#g#h/]~.nQ!m~!Q![.t#g#h/W~.wR!Q![.t#a#b/Q#g#h/]~/TP#g#h/W~/]O!m~~/bP!m~!Q![/e~/hQ!Q![/e#a#b/Q~/qT{|)f}!O)f!Q![)l#U#V-W#]#^-]~0TQ#U#V-W#]#^-]~0`S!m~!Q![.t#U#V-W#]#^-]#g#h/W~0qP!m~!Q![0t~0wT!Q![0t#W#X-l#[#].T#a#b.i#g#h/]~1]P!m~!Q![1`~1cU!Q![1`#W#X-l#[#].T#a#b.i#g#h/]#k#l0l~1xR!Q![2R!c!i2R#T#Z2R~2WR!v~!Q![2R!c!i2R#T#Z2RP2fT{P!Q![2a![!]2a!c!}2a#R#S2a#T#o2a~2zP!o~!_!`2}~3SO!p~~3XQ|~!_!`3_#r#s3d~3dO!q~~3iO!P~~3nP!l~!_!`3q~3vO!n~R3}T{P#zQ!Q![3v![!]2a!c!}3v#R#S3v#T#o3v~4cO$k~~4hO$l~~4mO$O~~4pRO#S4m#S#T%`#T~4m~5OO$U~~5TR!_~!_!`5^!`!a5c#r#s5h~5cO!W~~5hO!Y~~5mO!X~~5rO$W~\",\n  tokenizers: [0, 1],\n  topRules: {\"LogQL\":[0,37]},\n  specialized: [{term: 43, get: (value, stack) => (specializeIdentifier(value) << 1)},{term: 43, get: (value, stack) => (extendIdentifier(value) << 1) | 1},{term: 43, get: value => spec_Identifier[value] || -1}],\n  tokenPrec: 0\n});\n// This file was generated by lezer-generator. You probably shouldn't edit it.\nconst Json = 1,\n  Logfmt = 2,\n  Unpack = 3,\n  Pattern = 4,\n  Regexp = 5,\n  Unwrap = 6,\n  LabelFormat = 7,\n  LineFormat = 8,\n  LabelReplace = 9,\n  Vector = 10,\n  Offset = 11,\n  Bool = 12,\n  On = 13,\n  Ignoring = 14,\n  GroupLeft = 15,\n  GroupRight = 16,\n  Decolorize = 17,\n  Drop = 18,\n  Keep = 19,\n  By = 20,\n  Without = 21,\n  And = 22,\n  Or = 23,\n  Unless = 24,\n  Sum = 25,\n  Avg = 26,\n  Count = 27,\n  Max = 28,\n  Min = 29,\n  Stddev = 30,\n  Stdvar = 31,\n  Bottomk = 32,\n  Topk = 33,\n  Sort = 34,\n  Sort_Desc = 35,\n  LineComment = 36,\n  LogQL = 37,\n  Expr = 38,\n  LogExpr = 39,\n  Selector = 40,\n  Matchers = 41,\n  Matcher = 42,\n  Identifier = 43,\n  Eq = 44,\n  String = 45,\n  Neq = 46,\n  Re = 47,\n  Nre = 48,\n  PipelineExpr = 49,\n  PipelineStage = 50,\n  LineFilters = 51,\n  LineFilter = 52,\n  Filter = 53,\n  PipeExact = 54,\n  PipeMatch = 55,\n  PipePattern = 56,\n  Npa = 57,\n  FilterOp = 58,\n  Ip = 59,\n  OrFilter = 60,\n  Pipe = 61,\n  LogfmtParser = 62,\n  LogfmtParserFlags = 63,\n  ParserFlag = 64,\n  LabelParser = 65,\n  JsonExpressionParser = 66,\n  LabelExtractionExpressionList = 67,\n  LabelExtractionExpression = 68,\n  LogfmtExpressionParser = 69,\n  LabelFilter = 70,\n  IpLabelFilter = 71,\n  UnitFilter = 72,\n  DurationFilter = 73,\n  Gtr = 74,\n  Duration = 75,\n  Gte = 76,\n  Lss = 77,\n  Lte = 78,\n  Eql = 79,\n  BytesFilter = 80,\n  Bytes = 81,\n  NumberFilter = 82,\n  LiteralExpr = 83,\n  Number = 84,\n  Add = 85,\n  Sub = 86,\n  LineFormatExpr = 87,\n  LabelFormatExpr = 88,\n  LabelsFormat = 89,\n  LabelFormatMatcher = 90,\n  DecolorizeExpr = 91,\n  DropLabelsExpr = 92,\n  DropLabels = 93,\n  DropLabel = 94,\n  KeepLabelsExpr = 95,\n  KeepLabels = 96,\n  KeepLabel = 97,\n  MetricExpr = 98,\n  RangeAggregationExpr = 99,\n  RangeOp = 100,\n  CountOverTime = 101,\n  Rate = 102,\n  RateCounter = 103,\n  BytesOverTime = 104,\n  BytesRate = 105,\n  AvgOverTime = 106,\n  SumOverTime = 107,\n  MinOverTime = 108,\n  MaxOverTime = 109,\n  StddevOverTime = 110,\n  StdvarOverTime = 111,\n  QuantileOverTime = 112,\n  FirstOverTime = 113,\n  LastOverTime = 114,\n  AbsentOverTime = 115,\n  LogRangeExpr = 116,\n  Range = 117,\n  OffsetExpr = 118,\n  UnwrapExpr = 119,\n  ConvOp = 120,\n  BytesConv = 121,\n  DurationConv = 122,\n  DurationSecondsConv = 123,\n  Grouping = 124,\n  Labels = 125,\n  VectorAggregationExpr = 126,\n  VectorOp = 127,\n  BinOpExpr = 128,\n  BinOpModifier = 129,\n  OnOrIgnoringModifier = 130,\n  GroupingLabels = 131,\n  GroupingLabelList = 132,\n  GroupingLabel = 133,\n  LabelName = 134,\n  Mul = 135,\n  Div = 136,\n  Mod = 137,\n  Pow = 138,\n  LabelReplaceExpr = 139,\n  VectorExpr = 140;\n\nexport { AbsentOverTime, Add, And, Avg, AvgOverTime, BinOpExpr, BinOpModifier, Bool, Bottomk, By, Bytes, BytesConv, BytesFilter, BytesOverTime, BytesRate, ConvOp, Count, CountOverTime, Decolorize, DecolorizeExpr, Div, Drop, DropLabel, DropLabels, DropLabelsExpr, Duration, DurationConv, DurationFilter, DurationSecondsConv, Eq, Eql, Expr, Filter, FilterOp, FirstOverTime, GroupLeft, GroupRight, Grouping, GroupingLabel, GroupingLabelList, GroupingLabels, Gte, Gtr, Identifier, Ignoring, Ip, IpLabelFilter, Json, JsonExpressionParser, Keep, KeepLabel, KeepLabels, KeepLabelsExpr, LabelExtractionExpression, LabelExtractionExpressionList, LabelFilter, LabelFormat, LabelFormatExpr, LabelFormatMatcher, LabelName, LabelParser, LabelReplace, LabelReplaceExpr, Labels, LabelsFormat, LastOverTime, LineComment, LineFilter, LineFilters, LineFormat, LineFormatExpr, LiteralExpr, LogExpr, LogQL, LogRangeExpr, Logfmt, LogfmtExpressionParser, LogfmtParser, LogfmtParserFlags, Lss, Lte, Matcher, Matchers, Max, MaxOverTime, MetricExpr, Min, MinOverTime, Mod, Mul, Neq, Npa, Nre, Number, NumberFilter, Offset, OffsetExpr, On, OnOrIgnoringModifier, Or, OrFilter, ParserFlag, Pattern, Pipe, PipeExact, PipeMatch, PipePattern, PipelineExpr, PipelineStage, Pow, QuantileOverTime, Range, RangeAggregationExpr, RangeOp, Rate, RateCounter, Re, Regexp, Selector, Sort, Sort_Desc, Stddev, StddevOverTime, Stdvar, StdvarOverTime, String, Sub, Sum, SumOverTime, Topk, UnitFilter, Unless, Unpack, Unwrap, UnwrapExpr, Vector, VectorAggregationExpr, VectorExpr, VectorOp, Without, parser };\n"],"names":["ConfigDescriptionLink","props","description","suffix","feature","text","styles","getStyles","theme","EditorHeader","children","FlexItem","grow","shrink","RawQuery","query","language","className","highlighted","QueryEditorMode","QueryEditorMode2","BINARY_OPERATIONS_KEY","queryTypeOptions","RESOLUTION_OPTIONS","value","LokiOptionFields","lineLimitValue","resolution","onRunQuery","runOnBlur","onChange","queryType","onChangeQueryLimit","nextQuery","preprocessMaxLines","onQueryTypeChange","instant","range","rest","onMaxLinesChange","e","onReturnKeyDown","onResolutionChange","option","type","maxLines","Field","MonacoQueryFieldLazy","MonacoQueryFieldWrapper","lastRunValueRef","handleRunQuery","handleBlur","LokiQueryField","override","prevProps","languageProvider","ExtraFieldElement","datasource","history","placeholder","validateQuery","interpolatedQuery","queryLines","parser","interpolatedErrors","parseQuery","parseErrors","queryErrors","interpolatedError","queryError","parseError","findErrorBoundary","isErrorBoundary","nodeRef","node","isEmptyString","errorNode","error","startPos","endPos","line","boundary","placeHolderScopedVars","perf","warned","PROCESS","emitWarning","msg","code","fn","AC","AS","_","warnACPolyfill","reason","printACPolyfillWarning","shouldWarn","TYPE","isPosInt","n","getUintArray","max","ZeroArray","size","Stack","#constructing","HeapCls","s","LRUCache","#max","#maxSize","#dispose","#disposeAfter","#fetchMethod","#size","#calculatedSize","#keyMap","#keyList","#valList","#next","#prev","#head","#tail","#free","#disposed","#sizes","#starts","#ttls","#hasDispose","#hasFetchMethod","#hasDisposeAfter","c","p","#isBackgroundFetch","k","index","options","context","#backgroundFetch","#moveToTail","#indexes","#rindexes","#isStale","ttl","ttlResolution","ttlAutopurge","updateAgeOnGet","updateAgeOnHas","allowStale","dispose","disposeAfter","noDisposeOnSet","noUpdateTTL","maxSize","maxEntrySize","sizeCalculation","fetchMethod","noDeleteOnFetchRejection","noDeleteOnStaleGet","allowStaleOnFetchRejection","allowStaleOnFetchAbort","ignoreFetchAbort","UintArray","#initializeSizeTracking","#initializeTTLTracking","key","ttls","starts","#setItemTTL","start","t","#updateItemAge","#statusTTL","status","cachedNow","getNow","age","sizes","#removeItemSize","#requireSize","v","#addItemSize","#evict","_i","_s","_st","_k","_v","i","#isValidIndex","getOptions","thisp","deleted","entry","remain","arr","setOptions","oldVal","oldValue","dt","task","val","free","head","hasOptions","peekOptions","ac","signal","fetchOpts","cb","updateCache","aborted","ignoreAbort","fetchFail","bf","eb","er","allowStaleAborted","noDelete","pcall","res","rej","fmp","b","fetchOptions","forceRefresh","stale","isStale","staleVal","fetching","#connect","pi","ni","NS_IN_MS","EMPTY_SELECTOR","LokiLanguageProvider","initialValues","url","params","timeRange","streamSelector","interpolatedMatch","end","cacheKey","data","values","match","labelBasedQuery","labelMatchers","label","labels","param","nanoseconds","labelName","streamParam","rangeParams","paramCacheKey","labelValues","empty","config","series","DEFAULT_MAX_LINES_SAMPLE","hasLogfmt","hasJSON","hasPack","DEFAULT_WEBSOCKET_CONFIG","WEBSOCKETSUBJECT_INVALID_ERROR_OBJECT","WebSocketSubject","_super","urlConfigOrSource","destination","_this","Observable","Subject","ReplaySubject","operator","sock","subMsg","unsubMsg","messageFilter","self","observer","err","subscription","x","_a","WebSocketCtor","protocol","binaryType","socket","Subscription","evt","_socket","openObserver","queue","Subscriber","serializer","closingObserver","closeObserver","deserializer","subscriber","source","webSocket","parse","uuid","validate","stringToBytes","str","bytes","DNS","URL","v35","name","version","hashfunc","generateUUID","namespace","buf","offset","_namespace","f","y","z","ROTL","sha1","K","H","l","N","M","j","W","a","d","T","UUID_NAMESPACE","appendResponseToBufferedData","response","streams","tsField","lineField","idField","usedUids","stream","allLabelsString","ts","createUid","labelsString","refId","id","newCount","LiveStreams","target","retryInterval","CircularDataFrame","map","retryWhen","attempts","mergeMap","retryAttempt","timer","throwError","finalize","IS_LOKI_LOG_CONTEXT_UI_OPEN","LokiContextUi","row","logContextProvider","updateFilter","onClose","origQuery","runContextQuery","contextFilters","setContextFilters","showPreservedFiltersAppliedNotification","setShowPreservedFiltersAppliedNotification","initialized","setInitialized","loading","setLoading","isOpen","setIsOpen","includePipelineOperations","setIncludePipelineOperations","SHOULD_INCLUDE_PIPELINE_OPERATIONS","timerHandle","previousInitialized","previousContextFilters","isInitialState","filter","enabled","nonIndexed","preservedLabels","LOKI_LOG_CONTEXT_PRESERVED_LABELS","useAsync","initContextFilters","realLabels","realLabelsEnabled","parsedLabels","parsedLabelsEnabled","contextFilterToSelectFilter","contextFilter","showNonIndexedLabels","queryExpr","Alert","Tooltip","Button","Collapse","Icon","Spinner","Label","keys","actionMeta","InlineFieldRow","InlineField","RenderUserContentAsHTML","SortDirection","makeIndex","field","dir","fieldValues","nanos","isAsc","valA","valB","nanoA","nanoB","sortDataFrameByTime","frame","fields","timeField","sorted","vals","idx","LogContextProvider","cacheFilters","direction","processResults","result","processedFrames","app","lastValueFrom","makeRequest","REF_ID_STARTER_LOG_ROW_CONTEXT","catchError","switchMap","of","expr","hasParser","nonIndexedLabels","parsedLabel","currentExpr","newExpr","origExpr","allNodePositions","pipelineStagePositions","position","otherNodePositions","pipelineStagePosition","preservedFiltersApplied","rowLabels","allLabels","labelType","preservedLabelsString","arePreservedLabelsUsed","newContextFilters","limit","filters","contextTimeBuffer","queryDirection","FieldCache","tsValue","timestamp","preparedExpression","labelNamesRegex","labelValuesRegex","migrateVariableQuery","rawQuery","queryBase","variableOptions","LokiVariableQueryEditor","setType","setLabel","labelOptions","setLabelOptions","setStream","previousType","usePrevious","variableQuery","labelNames","newType","onLabelChange","newLabel","onStreamChange","Select","Input","LokiVariableSupport","scopedVars","request","from","getDerivedFields","dataFrame","derivedFieldConfigs","derivedFieldsGrouped","newFields","fieldFromDerivedFieldConfig","labelFields","intersectingKey","logMatch","dataSourceSrv","dataLinks","acc","derivedFieldConfig","dsSettings","makeTableFrames","instantMetricFrames","framesWithRefId","framesByRefId","frames","makeTableFrame","tableTimeField","tableValueField","allLabelNames","valueField","timeArray","valueArray","isMetricFrame","setFrameMeta","meta","oldMeta","newMeta","processStreamFrame","custom","newFrame","derivedFields","processStreamsFrames","queryMap","processMetricInstantFrames","processMetricRangeFrames","groupFrames","streamsFrames","metricInstantFrames","metricRangeFrames","improveError","message","transformBackendResult","queries","dataFrames","LokiAnnotationsQueryEditor","annotation","onAnnotationChange","onChangeQuery","queryWithRefId","EditorRow","EditorField","event","getQueryHints","hints","queryWithParser","parserCount","hasPipelineErrorFiltering","hasLevel","levelLikeLabel","splitTimeRange","startTime","endTime","idealRangeDuration","chunkEndTime","chunkStartTime","step","alignedDuration","alignedStartTime","partitionTimeRange","isLogsQuery","originalTimeRange","stepMs","duration","to","adjustTargetsFromResponseState","targets","targetFrame","updatedMaxLines","runSplitGroupedQueries","requests","responseKey","mergedResponse","totalRequests","partition","longestPartition","shouldStop","subquerySubsciption","runNextRequest","requestN","requestGroup","done","nextRequest","nextRequestN","nextRequestGroup","getNextRequestPointers","group","subRequest","partialResponse","combineResponses","updateLoadingFrame","LOADING_FRAME_NAME","loadingFrame","querySupportsSplitting","runSplitQuery","nonSplittingQueries","normalQueries","logQueries","metricQueries","oneDayMs","rangePartitionedLogQueries","rangePartitionedMetricQueries","chunkRangeMs","resolutionPartition","stepMsPartition","calculateStep","q","tap","intervalMs","interval_regex","newStep","safeStep","getLiveStreamKey","msgUint8","hashBuffer","doLokiChannelStream","ds","maxDelta","maxLength","updateFrame","StreamingDataFrame","defer","convertToWebSocketUrl","backend","DEFAULT_MAX_LINES","LOKI_ENDPOINT","REF_ID_DATA_SAMPLES","REF_ID_STARTER_ANNOTATION","REF_ID_STARTER_LOG_VOLUME","REF_ID_STARTER_LOG_SAMPLE","REF_ID_STARTER_STATS","requestId","hideFromInspector","intervalInfo","LokiDatasource","DataSourceWithBackend","instanceSettings","templateSrv","maxDataPoints","liveTarget","settingsData","logsVolumeOption","logsSampleOption","normalizedQuery","isQuerySuitable","dropErrorExpression","logsVolumeRequest","logsSampleRequest","fixedRequest","streamQueries","streamRequest","merge","logsQueries","subQueries","baseUrl","adhocFilters","expandedQueries","abstractQueries","existingKeys","abstractQuery","labelMatcher","statsForAll","durations","interpolatedVariableQuery","lokiLogsQuery","variable","lokiRegularEscape","lokiSpecialRegexEscape","lodash","expression","action","parserPositions","labelFilterPositions","lastPosition","tagKeys","titleFormat","textFormat","annotations","splitKeys","DataFrameView","maybeDuplicatedTags","tags","__auto","__interval","__interval_ms","__range","__range_s","__range_ms","variables","exprWithAdHoc","string","defaults","roundMsToMin","milliseconds","roundSecToMin","seconds","shouldRefreshLabels","prevRange","sameMinuteFrom","sameMinuteTo","RE2_METACHARACTERS","escapeLokiRegexp","escapeLabelValueInExactSelector","labelValue","unescapeLabelValue","escapeLabelValueInRegexSelector","escapeLabelValueInSelector","selector","isRegexSelector","isBytesString","BYTES_KEYWORDS","regex","getLabelTypeFromFrame","labelKey","typeField","mapOpToAbstractOp","mapAbstractOperatorsToOp","abstractQueryToExpr","processLabels","valueSet","limitSuggestions","SUGGESTIONS_LIMIT","items","NodePosition","queryHasFilter","getMatchersWithFilter","removeLabelFromQuery","matchers","matcher","removeLabelFilter","removeSelector","pipelineStage","prefix","matchVisQuery","tree","labelNode","opNode","valueNode","addLabelToQuery","streamSelectorPositions","getStreamSelectorPositions","getParserPositions","getLabelFilterPositions","hasStreamSelectorMatchers","getMatcherInStreamPositions","labelFormatPositions","getIdentifierInStreamPositions","everyStreamSelectorHasMatcher","streamSelectorPosition","matcherPosition","toLabelFilter","lastPositionsPerExpression","getLastPositionPerExpression","addFilterAsLabelFilter","addFilterToStreamSelector","positions","subExpressions","findLeaves","subPositions","subExpression","findLastPosition","addParserToQuery","lineFilterPositions","getLineFiltersPositions","addParser","addNoPipelineErrorToQuery","addLabelFormatToQuery","labelFormat","logQueryPositions","getLogQueryPositions","addLabelFormat","removeCommentsFromQuery","lineCommentPositions","getLineCommentPositions","newQuery","prev","lineCommentPosition","parserNodeTypes","logPartsPositions","pipeline","unwrap","vectorSelectorPositions","isLast","labelExists","newLabels","positionsToAddAfter","labelFilter","queryPartPositions","addLineFilter","streamSelectorEnd","current","nodes","getAllPositionsInNodeByType","pos","child","DEFAULT_EXAMPLES","PREFERRED_LABELS","EXAMPLES_LIMIT","LOGQL_EXAMPLES","UnthemedLokiCheatSheet","provider","preferredLabel","userExamples","onClickExample","onClick","hasUserExamples","example","item","__defProp","__defProps","__getOwnPropDescs","__getOwnPropSymbols","__hasOwnProp","__propIsEnum","__defNormalProp","obj","__spreadValues","prop","__spreadProps","__objRest","exclude","QueryHeaderSwitch","_b","inputProps","dashedLabel","switchIdRef","Switch","editorModes","QueryEditorModeToggle","mode","RadioButtonGroup","MAX_LABEL_COUNT","MAX_VALUE_COUNT","MAX_AUTO_SELECT","buildSelector","selectedLabels","selectedValues","facetLabels","possibleLabels","lastFacetted","possibleValues","existingValues","UnthemedLokiLabelBrowser","state","selected","nextValue","updatedFields","autoSelect","lastUsedLabels","rawLabels","rawValues","searchTerm","validationStatus","LoadingPlaceholder","searchResults","fuzzyMatchResult","fuzzy","style","LokiLabelBrowser","LabelBrowserModal","labelsLoaded","setLabelsLoaded","hasLogLabels","setHasLogLabels","LAST_USED_LABELS_KEY","changeQuery","reportInteractionAndClose","Modal","LocalStorageValueProvider","onLastUsedLabelsSave","onLastUsedLabelsDelete","CONFLICTING_LABEL_FILTER_ERROR_MESSAGE","LabelFilterItem","defaultOp","onDelete","onGetLabelNames","onGetLabelValues","invalidLabel","invalidValue","multiValueSeparator","setState","labelNamesMenuOpen","setLabelNamesMenuOpen","labelValuesMenuOpen","setLabelValuesMenuOpen","isMultiSelect","_a2","operators","op","getSelectOptionsFromString","item2","selectedOptions","isConflicting","isConflictingLabelFilter","v4","InputGroup","selectors","change","changes","change2","AccessoryButton","operationIsNegative","candidate","MISSING_LABEL_FILTER_ERROR_MESSAGE","LabelFilters","labelsFilters","labelFilterRequired","setItems","onLabelsChange","newItems","hasLabelFilter","EditorFieldGroup","EditorList","onChangeItem","OperationExplainedBox","title","stepNumber","markdown","defaultNoopBatch","callback","batch","setBatch","newBatch","getBatch","createListenerCollection","first","last","listener","listeners","isSubscribed","nullListeners","store","parentSub","unsubscribe","addNestedSub","trySubscribe","notifyNestedSubs","handleChangeWrapper","tryUnsubscribe","Provider","_ref","contextValue","previousState","Context","_excluded","_excluded2","EMPTY_ARRAY","NO_SUBSCRIPTION_ARRAY","stringifyComponent","Comp","storeStateUpdatesReducer","updateCount","useIsomorphicLayoutEffectWithArgs","effectFunc","effectArgs","dependencies","captureWrapperProps","lastWrapperProps","lastChildProps","renderIsScheduled","wrapperProps","actualChildProps","childPropsFromStoreUpdate","subscribeUpdates","shouldHandleStateChanges","childPropsSelector","forceComponentUpdateDispatch","didUnsubscribe","lastThrownError","checkForUpdates","latestStoreState","newChildProps","unsubscribeWrapper","initStateUpdates","connectAdvanced","selectorFactory","_ref2","_ref2$getDisplayName","getDisplayName","_ref2$methodName","methodName","_ref2$renderCountProp","renderCountProp","_ref2$shouldHandleSta","_ref2$storeKey","storeKey","_ref2$withRef","withRef","_ref2$forwardRef","forwardRef","_ref2$context","connectOptions","WrappedComponent","wrappedComponentName","displayName","selectorFactoryOptions","pure","createChildSelector","usePureOnlyMemo","ConnectFunction","_useMemo","reactReduxForwardedRef","propsContext","ContextToUse","didStoreComeFromProps","didStoreComeFromContext","_useMemo2","overriddenContextValue","_useReducer","_useReducer$","previousStateUpdateResult","renderedWrappedComponent","renderedChild","Connect","forwarded","ref","is","shallowEqual","objA","objB","keysA","keysB","bindActionCreators","actionCreators","dispatch","boundActionCreators","_loop","actionCreator","wrapMapToPropsConstant","getConstant","constant","constantSelector","getDependsOnOwnProps","mapToProps","wrapMapToPropsFunc","proxy","stateOrDispatch","ownProps","whenMapDispatchToPropsIsFunction","mapDispatchToProps","whenMapDispatchToPropsIsMissing","whenMapDispatchToPropsIsObject","whenMapStateToPropsIsFunction","mapStateToProps","whenMapStateToPropsIsMissing","defaultMergeProps","stateProps","dispatchProps","wrapMergePropsFunc","mergeProps","areMergedPropsEqual","hasRunOnce","mergedProps","nextMergedProps","whenMergePropsIsFunction","whenMergePropsIsOmitted","impureFinalPropsSelectorFactory","pureFinalPropsSelectorFactory","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","hasRunAtLeastOnce","handleFirstCall","firstState","firstOwnProps","handleNewPropsAndNewState","handleNewProps","handleNewState","nextStateProps","statePropsChanged","handleSubsequentCalls","nextState","nextOwnProps","propsChanged","stateChanged","finalPropsSelectorFactory","initMapStateToProps","initMapDispatchToProps","initMergeProps","arg","factories","strictEqual","createConnect","_temp","_ref$connectHOC","connectHOC","_ref$mapStateToPropsF","mapStateToPropsFactories","_ref$mapDispatchToPro","mapDispatchToPropsFactories","_ref$mergePropsFactor","mergePropsFactories","_ref$selectorFactory","_ref3","_ref3$pure","_ref3$areStatesEqual","_ref3$areOwnPropsEqua","_ref3$areStatePropsEq","_ref3$areMergedPropsE","extraOptions","useReduxContext","_useReduxContext","useStore","createDispatchHook","useDispatch","refEquality","useSelectorWithStoreAndSubscription","equalityFn","contextSub","forceRender","latestSubscriptionCallbackError","latestSelector","latestSelectedState","storeState","selectedState","newSelectedState","newStoreState","_newSelectedState","createSelectorHook","useSelector","safeIsNaN","isEqual","second","areInputsEqual","newInputs","lastInputs","memoizeOne","resultFn","lastThis","lastArgs","lastResult","calledOnce","memoized","newArgs","isProduction","spacesAndTabs","lineStartWithSpaces","clean","getDevMessage","getFormattedMessage","isDisabledFlag","log","_console","warning","noop","shared","fromBinding","bindEvents","el","bindings","sharedOptions","unbindings","binding","unbind","isProduction$1","RbdInvariant","invariant","condition","ErrorBoundary","_React$Component","_len","args","_key","callbacks","_proto","dragHandleUsageInstructions","onDragStart","withLocation","isInHomeList","startPosition","endPosition","withCombine","combine","inHomeList","onDragUpdate","update","location","returnedToStart","onDragEnd","preset","origin","add","point1","point2","subtract","negate","point","patch","otherValue","distance","closest","points","apply","executeClip","subject","offsetByPosition","spacing","getCorners","noSpacing","increase","axis","withPlaceholder","_extends2","clip","getSubject","page","scrolled","increased","clipped","scrollDroppable","droppable","newScroll","scrollable","scrollDiff","scrollDisplacement","isInteger","findIndex","list","predicate","find","toArray","toDroppableMap","droppables","previous","toDraggableMap","draggables","toDroppableList","toDraggableList","getDraggablesInsideDroppable","droppableId","draggable","tryGetDestination","impact","tryGetCombine","removeDraggableFromList","remove","moveToNextCombine","isMovingForward","insideDestination","previousImpact","getImpact","at","all","closestId","withoutDraggable","indexOfClosest","proposedIndex","before","isHomeOf","noDisplacedBy","emptyGroups","noImpact","isWithin","lowerBound","upperBound","isPartiallyVisibleThroughFrame","isWithinVertical","isWithinHorizontal","isContained","isPartiallyVisibleVertically","isPartiallyVisibleHorizontally","isPartiallyContained","isBiggerVertically","isBiggerHorizontally","isTargetBiggerThanFrame","isTargetBiggerOnOneAxis","isTotallyVisibleThroughFrame","vertical","horizontal","isTotallyVisibleThroughFrameOnAxis","getDroppableDisplaced","displacement","isVisibleInDroppable","isVisibleThroughFrameFn","isVisibleInViewport","viewport","isVisible","toBeDisplaced","withDroppableDisplacement","displacedTarget","isPartiallyVisible","isTotallyVisible","isTotallyVisibleOnAxis","getShouldAnimate","forceShouldAnimate","invisible","visible","getTarget","displacedBy","marginBox","expandBy","getDisplacementGroups","afterDragging","groups","shouldAnimate","getIndexOfLastItem","indexOfLastItem","goAtEnd","newIndex","calculateReorderImpact","withoutDragging","sliceFrom","impacted","displaced","didStartAfterCritical","draggableId","afterCritical","fromCombine","combineId","combineWith","combineWithIndex","didCombineWithStartAfterCritical","fromReorder","currentIndex","firstIndex","lastIndex","moveToNextIndex","wasAt","_newIndex","getCombinedItemDisplacement","isDisplaced","whenCombining","center","displaceBy","distanceFromStartToBorderBoxCenter","box","distanceFromEndToBorderBoxCenter","getCrossAxisBorderBoxCenter","isMoving","goAfter","moveRelativeTo","goBefore","goIntoStart","moveInto","whenReordering","draggablePage","closestAfter","withDisplacement","getResultWithoutDroppableDisplacement","original","getPageBorderBoxCenterFromImpact","withoutDisplacement","scrollViewport","diff","updated","getDraggables","ids","tryGetVisible","speculativelyIncrease","maxScrollChange","scrolledViewport","scrolledDroppable","withViewportScroll","withDroppableScroll","newImpact","withViewportDisplacement","getClientFromPageBorderBoxCenter","pageBorderBoxCenter","withoutPageScrollChange","isTotallyVisibleInNewLocation","newPageBorderBoxCenter","_ref$onlyOnMainAxis","onlyOnMainAxis","changeNeeded","shifted","moveToNextPlace","previousPageBorderBoxCenter","previousClientSelection","isVisibleInNewLocation","clientSelection","cautious","getKnownActive","rect","getBestCrossAxisDroppable","active","isBetweenSourceClipped","candidates","activeOfTarget","isBetweenDestinationClipped","array","contains","isWithinDroppable","getCurrentPageBorderBoxCenter","getCurrentPageBorderBox","getClosestDraggable","distanceToA","distanceToB","getDisplacedBy","getRequiredGrowthForPlaceholder","placeholderSize","availableSpace","insideDroppable","spaceUsed","sum","dimension","requiredSpace","needsToGrowBy","withMaxScroll","addPlaceholder","requiredGrowth","added","_subject","maxScroll","removePlaceholder","_subject2","oldMaxScroll","moveToNewDroppable","proposed","proposedPageBorderBoxCenter","isGoingBeforeTarget","relativeTo","moveCrossAxis","isOver","whatIsDraggedOver","getDroppableOver","moveInDirection","isActuallyOver","isMainAxisMovementAllowed","home","isMovingOnMainAxis","_state$dimensions","isMovementAllowed","isPositionInFrame","getHasOverlap","getFurthestAway","pageBorderBox","startCenter","getDroppableOver$1","childCenter","crossAxisStart","crossAxisEnd","isStartContained","isEndContained","offsetRectByPosition","area","getIsDisplaced","atIndex","getReorderImpact","targetRect","targetStart","targetEnd","didStartAfterCritical$1","combineThresholdDivisor","getCombineImpact","childRect","childSize","threshold","getDragImpact","pageOffset","destinationId","pageBorderBoxWithDroppableScroll","patchDroppableMap","clearUnusedPlaceholder","now","lastDroppable","recomputePlaceholders","cleaned","patched","forcedClientSelection","forcedDimensions","forcedViewport","forcedImpact","scrollJumpRequest","dimensions","client","withUpdatedPlaceholders","getDraggables$1","recompute","getClientBorderBoxCenter","refreshSnap","needsVisibilityCheck","getHomeLocation","descriptor","getLiftEffect","insideHome","rawIndex","effected","patchDimensionMap","finish","offsetDraggable","offset$1","initialWindowScroll","moved","getFrame","adjustAdditionsForScrollChanges","additions","updatedDroppables","windowScrollChange","modified","droppableScrollChange","totalChange","publishWhileDraggingInVirtual","published","withScrollChange","existing","updatedAdditions","wasOverId","wasOver","_getLiftEffect","onLiftImpact","draggingState","dropPending","isSnapping","postDroppableChange","isEnabledChanging","removeScrollJumpRequest","idle","reducer","_action$payload","critical","movementMode","initial","isWindowScrollAllowed","_result","_clientSelection","_action$payload2","_action$payload3","_id","isEnabled","_target","_action$payload4","_id2","isCombineEnabled","_target2","_updated","_newScroll","_viewport","_result2","newState","_action$payload5","completed","dropDuration","newHomeClientOffset","_result3","_completed","beforeInitialCapture","lift","initialPublish","publishWhileDragging","collectionStarting","updateDroppableScroll","updateDroppableIsEnabled","updateDroppableIsCombineEnabled","move","moveByWindowScroll","updateViewportMaxScroll","moveUp","moveDown","moveRight","moveLeft","flush","animateDrop","completeDrop","drop","dropAnimationFinished","checkIndexes","indexes","errors","formatted","hasError","validateDimensions","lift$1","marshal","getState","next","scrollOptions","_marshal$startPublish","curves","timings","outOfTheWayTiming","transitions","timing","moveTo","transforms","isCombining","translate","minDropTime","maxDropTime","dropTimeRange","maxDropTimeAtDistance","cancelDropModifier","getDropDuration","distance$1","percentage","withDuration","getNewHomeClientOffset","newClientCenter","getDropImpact","lastImpact","recomputedHomeImpact","withoutMovement","drop$1","isWaitingForDrop","_getDropImpact","didDropInsideDroppable","isAnimationRequired","getWindowScroll","getWindowScrollBinding","getScrollListener","onWindowScroll","updateScroll","scheduled","isActive","stop","shouldEnd","scrollListener","getExpiringAnnounce","announce","wasCalled","isExpired","timeoutId","getAsyncMarshal","entries","execute","timerId","_entries$splice","shallow","areLocationsEqual","isCombineEqual","isCriticalEqual","isDraggableEqual","isDroppableEqual","withTimings","getDragStart","responder","getDefaultMessage","willExpire","provided","getPublisher","getResponders","asyncMarshal","dragging","beforeCapture","beforeStart","hasCriticalChanged","hasLocationChanged","hasGroupingChanged","abort","responders","publisher","dropAnimationFinish","dropAnimationFlushOnScroll","frameId","clear","dimensionMarshalStopper","isWatching","autoScroll","autoScroller","pendingDrop","postActionState","composeEnhancers","createStore","dimensionMarshal","focusMarshal","styleMarshal","clean$1","createPublisher","registry","staging","collect","_staging","removals","scroll","getMaxScroll","scrollHeight","scrollWidth","height","width","adjustedMaxScroll","getDocumentElement","doc","getMaxWindowScroll","getViewport","top","left","right","bottom","getInitialPublish","windowScroll","shouldPublishUpdate","createDimensionMarshal","collection","stopPublishing","startPublishing","canStartDrag","scrollWindow","getScrollableDroppables","getScrollableDroppableOver","maybe","getBestScrollableDroppable","_dimension","getDistanceThresholds","container","startScrollingFrom","maxScrollValueAt","thresholds","getPercentage","startOfRange","endOfRange","currentInRange","minScroll","getValueFromDistance","distanceToEdge","percentageFromMaxScrollValueAt","percentageFromStartScrollingFrom","accelerateAt","stopAt","dampenValueByTime","proposedScroll","dragStartTime","runTime","betweenAccelerateAtAndStopAtPercentage","getValue","shouldUseTimeDampening","getScrollOnAxis","distanceToEdges","isCloserToEnd","adjustForSizeLimits","isTooBigVertically","isTooBigHorizontally","clean$2","getScroll","required","limited","smallestSigned","getOverlap","getRemainder","targetScroll","overlap","canPartiallyScroll","rawMax","smallestChange","canScrollWindow","getWindowOverlap","canScrollDroppable","getDroppableOverlap","getWindowScrollChange","getDroppableScrollChange","scroll$1","_change","createFluidScroller","scheduleWindowScroll","scheduleDroppableScroll","tryScroll","_dragging","start$1","wasScrollNeeded","fakeScrollCallback","createJumpScroller","moveByOffset","scrollDroppableAsMuchAsItCan","whatTheDroppableCanScroll","remainder","scrollWindowAsMuchAsItCan","whatTheWindowCanScroll","jumpScroller","droppableRemainder","windowRemainder","createAutoScroller","fluidScroller","jumpScroll","scroller","prefix$1","dragHandle","base","scrollContainer","makeGetSelector","attribute","rules","property","rule","noPointerEvents","getStyles$1","contextId","getSelector","dragHandle$1","grabCursor","draggable$1","transition","droppable$1","body","getHead","createStyleEl","nonce","useStyleMarshal","alwaysRef","dynamicRef","setDynamicStyle","setAlwaysStyle","always","dynamic","dropping","resting","getWindowFromEl","isHtmlElement","findDragHandle","possible","handle","useFocusMarshal","entriesRef","recordRef","restoreFocusFrameRef","isMountedRef","register","focus","tryGiveFocus","tryGiveFocusTo","tryShiftRecord","redirectTo","tryRestoreFocusRecorded","record","tryRecordFocus","focused","createRegistry","subscribers","subscribe","notify","findDraggableById","getDraggableById","draggableAPI","findDroppableById","getDroppableById","droppableAPI","useRegistry","StoreContext","getBodyElement","visuallyHidden","getId","useAnnouncer","count","useUniqueId","getElementId","uniqueId","useHiddenTextElement","AppContext","peerDependencies","semver","getVersion","major","minor","isSatisfied","expected","actual","checkReactVersion","peerDepValue","actualValue","peerDep","checkDoctype","doctype","useDev","useHook","useDevSetupWarning","inputs","useStartupValidation","create","lock","isClaimed","claim","abandon","newLock","release","tryAbandon","tab","enter","space","pageUp","pageDown","arrowLeft","arrowUp","arrowRight","arrowDown","_preventedKeys","preventedKeys","preventStandardKeyEvents","supportedEventName","supported","eventName","primaryButton","sloppyClickThreshold","isSloppyClickThresholdExceeded","idle$1","getCaptureBindings","cancel","getPhase","setPhase","button","clientX","clientY","phase","pending","actions","useMouseSensor","api","phaseRef","unbindEventsRef","startCaptureBinding","startPendingDrag","preventForcePressBinding","listenForCapture","bindCapturingEvents","_scrollJumpKeys","noop$1","scrollJumpKeys","getDraggingBindings","useKeyboardSensor","preDrag","isCapturing","idle$2","timeForLongPress","forcePressThreshold","getWindowBindings","getHandleBindings","_event$touches$","touch","isForcePress","shouldRespect","useTouchSensor","unbindTarget","unbindWindow","startDragging","longPressTimerId","useValidateSensorHooks","sensorHooks","interactiveTagNames","isAnInteractiveElement","parent","hasAnInteractiveTag","isEventInInteractiveElement","getBorderBoxCenterPosition","isElement","supportedMatchesName","closestPonyfill","closest$1","findClosestDragHandleFromEvent","tryGetClosestDraggableIdFromEvent","findDraggable","preventDefault","_isActive","isLockActive","canStart","lockAPI","tryStart","forceSensorStop","sourceEvent","shouldStart","getShouldRespectForcePress","tryDispatch","getAction","tryDispatchWhenDragging","fluidLift","move$1","snapLift","abortPreDrag","shouldRelease","defaultSensors","useSensorMarshal","_ref4","customSensors","enableDefaultSensors","useSensors","tryAbandonLock","canGetLock","tryGetLock","forceStop","findClosestDraggableId","findOptionsForDraggable","tryReleaseLock","isLockClaimed","createResponders","getStore","lazyRef","App","setCallbacks","sensors","lazyStoreRef","lastPropsRef","dragHandleUsageInstructionsId","lazyDispatch","marshalCallbacks","tryResetStore","isDragging","appCallbacks","getCanLift","getIsMovementAllowed","appContext","count$1","reset$1","useInstanceCount","resetServerContext","DragDropContext","isEqual$1","isScroll","isAuto","isVisible$1","isEither","overflow","isBoth","isElementScrollable","isBodyScrollable","html","htmlStyle","htmlOverflow","getClosestScrollable","checkForNestedScrollContainers","anotherScrollParent","getScroll$1","getIsFixed","getEnv","closestScrollable","isFixedOnPage","getDroppableDimension","scrollSize","frameClient","getClient","targetRef","paddingBox","borderBox","getDimension","env","isDropDisabled","shouldClipSubject","immediate","delayed","getListenerOptions","useRequiredContext","getClosestScrollableFromDrag","useDroppablePublisher","whileDraggingRef","previousRef","publishedDescriptorRef","memoizedUpdateScroll","getClosestScroll","scheduleScrollUpdate","onClosestScroll","getDimensionAndWatchScroll","getScrollWhileDragging","dragStopped","noop$2","getSize","isAnimatingOpenOnMount","animate","getStyle","Placeholder","animateOpenTimerRef","tryClearAnimateOpenTimer","onTransitionEnd","_useState","setIsAnimatingOpenOnMount","onSizeChangeEnd","Placeholder$1","DroppableContext","checkIsValidInnerRef","isBoolean","runChecks","checks","check","getDroppableRef","standard","getPlaceholderRef","virtual","_ref5","_ref6","useValidation","AnimateInOut","_React$PureComponent","zIndexOptions","getDraggingTransition","shouldAnimateDragMovement","getDraggingOpacity","isDropAnimating","getShouldDraggingAnimate","getDraggingStyle","transform","getSecondaryStyle","secondary","getStyle$1","mapped","getDimension$1","computedStyles","useDraggablePublisher","getDraggableRef","canDragInteractiveElements","shouldRespectForcePress","publishedRef","isFirstPublishRef","useValidation$1","getRef","useClonePropValidation","isClone","preventHtml5Dnd","Draggable","setRef","_useRequiredContext","_useRequiredContext2","dropAnimationFinishedAction","forPublisher","dragHandleProps","onMoveEnd","rubric","isStrictEqual","whatIsDraggedOverFromResult","getCombineWithFromResult","getCombineWithFromImpact","getDraggableSelector","memoizedOffset","getMemoizedSnapshot","draggingOver","getMemoizedProps","_draggingOver","_combineWith","getSecondarySnapshot","combineTargetFor","atRest","getSecondarySelector","shouldAnimateDisplacement","getFallback","getProps","ownId","draggingId","visualDisplacement","isAfterCriticalInVirtualList","_offset","makeMapStateToProps","draggingSelector","secondarySelector","ConnectedDraggable","connect","PrivateDraggable","droppableContext","isUsingCloneFor","PublicDraggable","Droppable","droppableRef","placeholderRef","ignoreContainerClipping","snapshot","useClone","getContainerForClone","setDroppableRef","setPlaceholderRef","onPlaceholderTransitionEnd","getClone","render","draggableProvided","draggableSnapshot","isMatchingType","getDraggable","makeMapStateToProps$1","idleWithAnimation","idleWithoutAnimation","getDraggableRubric","getMapProps","isDraggingOverForConsumer","isDraggingOverForImpact","renderClone","isHome","_snapshot","isDraggingOver","wasCombining","mapDispatchToProps$1","getBody","defaultProps","ConnectedDroppable","getWindow","ownerDocument","OwnElement","isHTMLElement","isShadowRoot","round","getUAString","uaData","isLayoutViewport","getBoundingClientRect","element","includeScale","isFixedStrategy","clientRect","scaleX","scaleY","visualViewport","addVisualOffsets","win","scrollLeft","scrollTop","getHTMLElementScroll","getNodeScroll","getNodeName","getWindowScrollBarX","getComputedStyle","isScrollParent","_getComputedStyle","overflowX","overflowY","isElementScaled","getCompositeRect","elementOrVirtualElement","offsetParent","isFixed","isOffsetParentAnElement","offsetParentIsScaled","documentElement","offsets","getLayoutRect","getParentNode","getScrollParent","listScrollParents","_element$ownerDocumen","scrollParent","isBody","updatedList","isTableElement","getTrueOffsetParent","getContainingBlock","isFirefox","isIE","elementCss","currentNode","css","getOffsetParent","window","auto","basePlacements","clippingParents","popper","reference","variationPlacements","placement","beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite","modifierPhases","order","modifiers","visited","modifier","sort","requires","dep","depModifier","orderModifiers","orderedModifiers","debounce","resolve","mergeByName","merged","DEFAULT_OPTIONS","areValidElements","popperGenerator","generatorOptions","_generatorOptions","_generatorOptions$def","defaultModifiers","_generatorOptions$def2","defaultOptions","effectCleanupFns","isDestroyed","instance","setOptionsAction","cleanupModifierEffects","m","runModifierEffects","_state$elements","_state$orderedModifie","_state$orderedModifie2","_options","_ref$options","effect","cleanupFn","noopFn","createPopper","passive","_options$scroll","_options$resize","resize","scrollParents","getBasePlacement","getVariation","getMainAxisFromPlacement","computeOffsets","basePlacement","variation","commonX","commonY","mainAxis","len","popperOffsets","unsetSides","roundOffsetsByDPR","dpr","mapToStyles","_Object$assign2","popperRect","gpuAcceleration","adaptive","roundOffsets","_offsets$x","_offsets$y","hasX","hasY","sideX","sideY","heightProp","widthProp","offsetY","offsetX","commonStyles","_Object$assign","computeStyles","_options$gpuAccelerat","_options$adaptive","_options$roundOffsets","applyStyles","attributes","initialStyles","styleProperties","distanceAndSkiddingToXY","rects","invertDistance","skidding","_options$offset","_data$state$placement","hash","getOppositePlacement","matched","getOppositeVariationPlacement","getViewportRect","strategy","layoutViewport","getDocumentRect","winScroll","rootNode","rectToClientRect","getInnerBoundingClientRect","getClientRectFromMixedType","clippingParent","getClippingParents","canEscapeClipping","clipperElement","getClippingRect","rootBoundary","mainClippingParents","firstClippingParent","clippingRect","accRect","getFreshSideObject","mergePaddingObject","paddingObject","expandToHashMap","hashMap","detectOverflow","_options$placement","_options$strategy","_options$boundary","_options$rootBoundary","_options$elementConte","elementContext","_options$altBoundary","altBoundary","_options$padding","padding","altContext","clippingClientRect","referenceClientRect","popperClientRect","elementClientRect","overflowOffsets","offsetData","multiply","computeAutoPlacement","flipVariations","_options$allowedAutoP","allowedAutoPlacements","placements","allowedPlacements","overflows","getExpandedFallbackPlacements","oppositePlacement","flip","_options$mainAxis","checkMainAxis","_options$altAxis","checkAltAxis","specifiedFallbackPlacements","_options$flipVariatio","preferredPlacement","isBasePlacement","fallbackPlacements","referenceRect","checksMap","makeFallbackChecks","firstFittingPlacement","_basePlacement","isStartVariation","isVertical","mainVariationSide","altVariationSide","numberOfChecks","fittingPlacement","_ret","getAltAxis","within","min","withinMaxClamp","preventOverflow","_options$tether","tether","_options$tetherOffset","tetherOffset","altAxis","tetherOffsetValue","normalizedTetherOffsetValue","offsetModifierState","_offsetModifierState$","mainSide","altSide","additive","minLen","maxLen","arrowElement","arrowRect","arrowPaddingObject","arrowPaddingMin","arrowPaddingMax","arrowLen","minOffset","maxOffset","arrowOffsetParent","clientOffset","offsetModifierValue","tetherMin","tetherMax","preventedOffset","_offsetModifierState$2","_mainSide","_altSide","_min","_max","isOriginSide","_offsetModifierValue","_tetherMin","_tetherMax","_preventedOffset","toPaddingObject","arrow","_state$modifiersData$","minProp","maxProp","endDiff","startDiff","clientSize","centerToReference","axisProp","_options$element","getSideOffsets","preventedOffsets","isAnySideFullyClipped","side","hide","referenceOverflow","popperAltOverflow","referenceClippingOffsets","popperEscapeOffsets","isReferenceHidden","hasPopperEscaped","eventListeners","unwrapArray","safeInvoke","fromEntries","EMPTY_MODIFIERS","usePopper","referenceElement","popperElement","prevOptions","optionsWithDefaults","_React$useState","updateStateModifier","elements","popperOptions","newOptions","popperInstanceRef","popperInstance","useGetLatest","useControlledState","_ref$onChange","getLatest","set","updater","updatedState","isControlled","generateBoundingClientRect","virtualElement","defaultConfig","usePopperTooltip","_popperProps$state","_popperProps$state$mo","_popperProps$state$mo2","finalConfig","finalPopperOptions","triggerRef","setTriggerRef","_React$useState2","tooltipRef","setTooltipRef","_useControlledState","setVisible","_usePopper","popperProps","isTriggeredBy","trigger","hideTooltip","showTooltip","toggleTooltip","handleClickOutside","_event$composedPath","_getLatest","preventDefaultAndToggle","setMousePosition","getTooltipProps","getArrowProps","OperationInfoButton","definition","operation","innerQueryPlaceholder","show","setShow","Portal","getOperationDocs","def","OperationHeader","onRemove","queryModeller","onToggleSwitcher","alternatives","alt","newDef","newParams","changedOp","getOperationParamEditor","paramDef","SelectInputParamEditor","BoolInputParamEditor","SimpleInputParamEditor","AutoSizeInput","getOperationParamId","Checkbox","operationId","selectOptions","valueOption","value2","paramIndex","OperationEditorBody","flash","highlight","shouldFlash","useFlash","onParamValueChanged","paramIdx","callParamChangedThenOnChange","onAddRestParam","onRemoveRestParam","restParam","lastParamDef","renderAddRestParamButton","Editor","keepFlash","setKeepFlash","operationIndex","OperationEditor","isConflictingOperation","isInvalid","OperationList","highlightedOp","operations","opsToHighlight","useOperationsHighlight","cascaderOpen","setCascaderOpen","onOperationChange","addOptions","category","onAddOperation","operationDef","onCascaderBlur","Cascader","isMounted","useMountedState","prevOperations","newOps","newOp","isSameOp","op1","op2","QueryBuilderHints","visualQuery","buildVisualQueryFromString","buildDataQueryFromQueryString","buildQueryStringFromDataQuery","setHints","dataQuery","hints2","hint","_c","_d","_b2","_c2","newVisualQuery","OperationListExplained","onMouseEnter","onMouseLeave","EXPLAIN_LABEL_FILTER_CONTENT","LokiQueryBuilderExplained","visQuery","lang","NestedQuery","nestedQuery","showExplain","IconButton","EditorRows","LokiQueryBuilder","NestedQueryList","nestedQueries","onNestedQueryUpdate","TIME_SPAN_TO_TRIGGER_SAMPLES","sampleData","setSampleData","setHighlightedOp","prevQuery","prevTimeRange","onChangeLabels","withTemplateVariableOptions","optionsPromise","forLabel","labelsToConsider","hasEqualityOperation","possibleLabelNames","labelsNamesToConsider","onGetSampleData","lokiQuery","updateBasedOnChangedTimeRange","updateBasedOnChangedQuery","testIds","OperationsEditorRow","otherOperations","queryString","QueryPreview","LokiQueryBuilderContainer","stateSlice","exprChanged","onVisQueryChange","visualQueryChange","initialState","parseResult","QueryOptionGroup","collapsedInfo","queryStats","toggleOpen","useToggle","generateQueryStats","convertUnits","LokiQueryBuilderOptions","splitDurationValid","setSplitDurationValid","onChunkRangeChange","onLegendFormatChanged","newMaxLines","onStepChange","isLogQuery","filteredQueryTypeOptions","o","isValidStep","getCollapsedInfo","queryTypeLabel","resolutionLabel","LokiQueryCodeEditor","QueryPattern","pattern","onPatternSelect","hasNewQueryOption","hasPreviousQuery","selectedPatternName","setSelectedPatternName","Card","keepOperationCategories","excludeOperationIds","keepOperations","QueryPatternsModal","onAddQuery","openTabs","setOpenTabs","selectAsNewQuery","patternOperations","patternOp","patternType","tabs","queryEditorModeDefaultLocalStorageKey","changeEditorMode","editorMode","getDefaultEditorMode","getQueryWithDefaults","compareTime","time1","time2","shouldUpdateStats","prevQueryType","lokiQueryEditorExplainKey","LokiQueryEditor","parseModalOpen","setParseModalOpen","queryPatternsModalOpen","setQueryPatternsModalOpen","dataIsStale","setDataIsStale","labelBrowserVisible","setLabelBrowserVisible","setQueryStats","explain","setExplain","predefinedOperations","previousTimeRange","previousQueryExpr","previousQueryType","onExplainChange","onEditorModeChange","newEditorMode","onChangeInternal","onClickLabelBrowserButton","stats","ConfirmModal","prevValue","Space","LokiQueryEditorForAlerting","LokiQueryEditorByApp","AlertingSettings","onOptionsChange","ConfigSubSection","DebugSection","debugText","setDebugText","debugFields","makeDebugFields","TextArea","DebugFields","testMatch","href","DerivedField","suggestions","validateName","showInternalLink","setShowInternalLink","previousUid","fieldType","setFieldType","handleChange","invalidName","TooltipLabel","DataLinkInput","newValue","checked","DataSourcePicker","content","DerivedFields","showDebug","setShowDebug","newField","newDerivedFields","emptyConfig","QuerySettings","onMaxLinedChange","onPredefinedOperationsChange","Badge","makeJsonUpdater","setMaxLines","setPredefinedOperations","setDerivedFields","ConfigEditor","updatePredefinedOperations","DataSourceDescription","Divider","ConnectionSettings","Auth","ConfigSection","AdvancedHttpSettings","SecureSocksProxySettings","LokiCheatSheet","getHighlighterExpressionsFromQuery","input","results","getNodesFromQuery","pipeExact","pipeMatch","strings","getStringsFromLineFilter","filterTerm","backtickedTerm","unwrappedFilterTerm","resultTerm","getNormalizedLokiQuery","getLokiQueryType","tagsToObscure","partsToKeep","obfuscate","obfuscatedQuery","queryPart","parseToNodeNamesArray","queryParts","isQueryWithNode","nodeType","nodeTypes","getNodePositionsFromQuery","getNodeFromQuery","isQueryWithError","isQueryWithParser","getParserFromQuery","parsers","isQueryPipelineErrorFiltering","isQueryWithLabelFormat","getLogQueryFromMetricsQuery","selectorNode","pipelineExprNode","pipelineExpr","getLogQueryFromMetricsQueryAtPosition","metricQuery","isQueryWithLabelFilter","isQueryWithLineFilter","isQueryWithRangeVariable","rangeNodes","getStreamSelectorsFromQuery","requestSupportsSplitting","allQueries","isLokiQuery","getLokiQueryFromDataQuery","QueryModellerBase","operationDefinitions","Registry","categories","LokiQueryModeller","binaryQueries","binQuery","leftOperand","binaryQuery","nested","lokiQueryModeller","binaryScalarDefs","binaryScalarOperations","opDef","defaultParams","getSimpleBinaryRenderer","model","innerExpr","bool","LabelParamEditor","loadGroupByLabels","toOption","createRangeOperation","isRangeOperationWithGrouping","getRangeVectorParamDef","paramChangedHandler","getOnLabelAddedHandler","getLokiOperationDisplayName","operationWithRangeVectorRenderer","addLokiOperation","opDocs","createRangeOperationWithGrouping","rangeOperation","getRangeAggregationWithGroupingRenderer","getLastLabelRemovedHandler","getAggregationExplainer","aggregation","grouping","restParamIndex","restParams","rangeVector","quantile","labelFilterRenderer","isConflictingFilter","queryOperations","queryOperation","pipelineRenderer","strict","keepEmpty","isRangeVectorFunction","getIndexOfOrLast","modeller","newOperation","existingRangeVectorFunction","placeToInsert","addNestedQueryHandler","getLineFilterRenderer","caseInsensitive","hasBackticks","delimiter","changeToOperationId","aggregationName","labelWord","funcName","defaultAddOperationHandler","createAggregationOperation","overrides","functionRendererLeft","getAggregationByRenderer","getAggregationWithoutRenderer","renderParams","createAggregationOperationWithParam","paramsDef","getAggregationByRendererWithParameter","UnwrapParamEditor","loadUnwrapOptions","logExpr","samples","getOperationDefinitions","aggregations","opId","aggregationsWithParam","rangeOperations","rangeOperationsWithGrouping","explainOperator","getDefinitionById","checkParamsAreValid","replacedExpr","handleExpression","isEmptyQuery","getLabel","getLineFilter","createNotSupportedError","getLabelParser","getLabelFilter","getJsonExpressionParser","getLogfmtParser","getLineFormat","getLabelFormat","handleUnwrapExpr","getDecolorize","handleRangeAggregation","handleVectorAggregation","handleBinary","isIntervalVariableError","handleDropFilter","handleKeepFilter","filterExpr","handleQuotes","orFilter","parserNode","flags","subNode","ipLabelFilter","valueString","renameTo","originalLabel","unwrapExprChild","labelFilterChild","unwrapChild","convOp","identifier","nameNode","number","rangeValue","numberNode","metricExpr","operatorToOpName","binModifier","getBinaryModifier","leftNumber","getLastChildWithSelector","rightNumber","rightBinary","leftMostChild","boolMatcher","exploringNode","ErrorId","getLeftMostChild","cur","makeError","getString","variableRegex","replaceVariables","var1","var2","fmt2","var3","fieldPath","fmt3","fmt","varType","varTypeFunc","returnVariables","makeBinOp","hasBool","getAllByType","regexifyLabelValuesQueryString","LokiQueryPatternType","LokiVisualQueryOperationCategory","LokiOperationId","LokiOperationOrder","lokiOperators","isLogLineJSON","parsed","LOGFMT_REGEXP","isLogLineLogfmt","isLogLinePacked","dataFrameHasLokiError","dataFrameHasLevelLabel","extractLogParserFromDataFrame","logLines","extractLabelKeysFromDataFrame","labelsArray","labelTypeArray","labelKeys","labelsSet","labelsType","allLabelKeys","extractUnwrapLabelKeysFromDataFrame","extractHasErrorLabelFromDataFrame","labelField","extractLevelLikeLabelFromDataFrame","onDashboardLoadedHandler","dashboardId","orgId","grafanaVersion","lokiQueries","instantQueries","rangeQueries","builderModeQueries","codeModeQueries","queriesWithTemplateVariables","isQueryWithTemplateVariables","queriesWithChangedResolution","isQueryWithChangedResolution","queriesWithChangedLineLimit","isQueryWithChangedLineLimit","queriesWithChangedLegend","isQueryWithChangedLegend","shouldNotReportBasedOnRefId","starter","calculateTotalBytes","totalBytes","byteKey","stat","trackQuery","trackingSettings","extraPayload","trackGroupedQueries","groupedRequests","originalRequest","splittingPayload","total","split_query_partition_size","g","h","r","u","w","A","B","C","D","E","F","G","I","exports","module","hasElementType","hasMap","hasSet","hasArrayBuffer","equal","length","it","Json$1","Logfmt$1","Unpack$1","Pattern$1","Regexp$1","Unwrap$1","LabelFormat$1","LineFormat$1","LabelReplace$1","Vector$1","Offset$1","Bool$1","On$1","Ignoring$1","GroupLeft$1","GroupRight$1","Decolorize$1","Drop$1","Keep$1","By$1","Without$1","And$1","Or$1","Unless$1","Sum$1","Avg$1","Count$1","Max$1","Min$1","Stddev$1","Stdvar$1","Bottomk$1","Topk$1","Sort$1","Sort_Desc$1","keywordTokens","specializeIdentifier","contextualKeywordTokens","extendIdentifier","spec_Identifier","stack","Json","Logfmt","Unpack","Pattern","Regexp","Unwrap","LabelFormat","LineFormat","LabelReplace","Vector","Offset","Bool","On","Ignoring","GroupLeft","GroupRight","Decolorize","Drop","Keep","By","Without","And","Or","Unless","Sum","Avg","Count","Max","Min","Stddev","Stdvar","Bottomk","Topk","Sort","Sort_Desc","LineComment","LogQL","Expr","LogExpr","Selector","Matchers","Matcher","Identifier","Eq","String","Neq","Re","Nre","PipelineExpr","PipelineStage","LineFilters","LineFilter","Filter","PipeExact","PipeMatch","PipePattern","Npa","FilterOp","Ip","OrFilter","Pipe","LogfmtParser","LogfmtParserFlags","ParserFlag","LabelParser","JsonExpressionParser","LabelExtractionExpressionList","LabelExtractionExpression","LogfmtExpressionParser","LabelFilter","IpLabelFilter","UnitFilter","DurationFilter","Gtr","Duration","Gte","Lss","Lte","Eql","BytesFilter","Bytes","NumberFilter","LiteralExpr","Number","Add","Sub","LineFormatExpr","LabelFormatExpr","LabelsFormat","LabelFormatMatcher","DecolorizeExpr","DropLabelsExpr","DropLabels","DropLabel","KeepLabelsExpr","KeepLabels","KeepLabel","MetricExpr","RangeAggregationExpr","RangeOp","CountOverTime","Rate","RateCounter","BytesOverTime","BytesRate","AvgOverTime","SumOverTime","MinOverTime","MaxOverTime","StddevOverTime","StdvarOverTime","QuantileOverTime","FirstOverTime","LastOverTime","AbsentOverTime","LogRangeExpr","Range","OffsetExpr","UnwrapExpr","ConvOp","BytesConv","DurationConv","DurationSecondsConv","Grouping","Labels","VectorAggregationExpr","VectorOp","BinOpExpr","BinOpModifier","OnOrIgnoringModifier","GroupingLabels","GroupingLabelList","GroupingLabel","LabelName","Mul","Div","Mod","Pow","LabelReplaceExpr","VectorExpr"],"sourceRoot":""}