(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[4669],{29020:(we,ge,h)=>{"use strict";h.d(ge,{I:()=>q});var V=h(96540),E=h(47433),P=Object.defineProperty,$=Object.defineProperties,H=Object.getOwnPropertyDescriptors,C=Object.getOwnPropertySymbols,T=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable,w=(X,le,z)=>le in X?P(X,le,{enumerable:!0,configurable:!0,writable:!0,value:z}):X[le]=z,U=(X,le)=>{for(var z in le||(le={}))T.call(le,z)&&w(X,z,le[z]);if(C)for(var z of C(le))I.call(le,z)&&w(X,z,le[z]);return X},Y=(X,le)=>$(X,H(le)),Z=(X,le)=>{var z={};for(var he in X)T.call(X,he)&&le.indexOf(he)<0&&(z[he]=X[he]);if(X!=null&&C)for(var he of C(X))le.indexOf(he)<0&&I.call(X,he)&&(z[he]=X[he]);return z};const q=X=>{var le=X,{children:z}=le,he=Z(le,["children"]);return V.createElement(E.x,Y(U({},he),{kind:"sub-section"}),z)}},47433:(we,ge,h)=>{"use strict";h.d(ge,{x:()=>X});var V=h(96540),E=h(32196),P=h(40845),$=h(29158),H=Object.defineProperty,C=Object.defineProperties,T=Object.getOwnPropertyDescriptors,I=Object.getOwnPropertySymbols,w=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable,Y=(le,z,he)=>z in le?H(le,z,{enumerable:!0,configurable:!0,writable:!0,value:he}):le[z]=he,Z=(le,z)=>{for(var he in z||(z={}))w.call(z,he)&&Y(le,he,z[he]);if(I)for(var he of I(z))U.call(z,he)&&Y(le,he,z[he]);return le},q=(le,z)=>C(le,T(z));const X=({children:le,title:z,description:he,isCollapsible:_e=!1,isInitiallyOpen:Ke=!0,kind:xe="section",className:Ee})=>{const{colors:me,typography:He,spacing:Ne}=(0,P.$j)(),[Qe,lr]=(0,V.useState)(_e?Ke:!0),ke=Qe?"angle-up":"angle-down",ze=xe==="sub-section",sr=`${Qe?"Collapse":"Expand"} section ${z}`,jr={header:(0,E.css)({display:"flex",justifyContent:"space-between",alignItems:"center"}),title:(0,E.css)({margin:0}),subtitle:(0,E.css)({margin:0,fontWeight:He.fontWeightRegular}),descriptionText:(0,E.css)(q(Z({marginTop:Ne(ze?.25:.5),marginBottom:0},He.bodySmall),{color:me.text.secondary})),content:(0,E.css)({marginTop:Ne(2)})};return V.createElement("div",{className:Ee},V.createElement("div",{className:jr.header},xe==="section"?V.createElement("h3",{className:jr.title},z):V.createElement("h6",{className:jr.subtitle},z),_e&&V.createElement($.K,{name:ke,onClick:()=>lr(!Qe),type:"button",size:"xl","aria-label":sr})),he&&V.createElement("p",{className:jr.descriptionText},he),Qe&&V.createElement("div",{className:jr.content},le))}},6191:(we,ge,h)=>{"use strict";h.d(ge,{X:()=>$});var V=h(32196),E=h(96540),P=h(40845);const $=({children:C})=>{const T=(0,P.of)(H);return E.createElement("div",{className:T.root},C)},H=C=>({root:(0,V.css)({display:"flex",flexWrap:"wrap",alignItems:"center",gap:C.spacing(3),minHeight:C.spacing(4)})})},31347:(we,ge,h)=>{"use strict";h.d(ge,{Z:()=>E});var V=h(96540);const E=({grow:P,shrink:$})=>V.createElement("div",{style:{display:"block",flexGrow:P,flexShrink:$}})},22354:(we,ge,h)=>{"use strict";h.d(ge,{W:()=>z});var V=h(32196),E=h(96540),P=h(40845),$=h(90182),H=h(4603),C=Object.defineProperty,T=Object.defineProperties,I=Object.getOwnPropertyDescriptors,w=Object.getOwnPropertySymbols,U=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable,Z=(xe,Ee,me)=>Ee in xe?C(xe,Ee,{enumerable:!0,configurable:!0,writable:!0,value:me}):xe[Ee]=me,q=(xe,Ee)=>{for(var me in Ee||(Ee={}))U.call(Ee,me)&&Z(xe,me,Ee[me]);if(w)for(var me of w(Ee))Y.call(Ee,me)&&Z(xe,me,Ee[me]);return xe},X=(xe,Ee)=>T(xe,I(Ee)),le=(xe,Ee)=>{var me={};for(var He in xe)U.call(xe,He)&&Ee.indexOf(He)<0&&(me[He]=xe[He]);if(xe!=null&&w)for(var He of w(xe))Ee.indexOf(He)<0&&Y.call(xe,He)&&(me[He]=xe[He]);return me};function z(xe){var Ee=xe,{label:me}=Ee,He=le(Ee,["label"]);const Ne=(0,P.of)(Ke),[Qe]=(0,E.useState)(()=>Math.random().toString(16).slice(2)),lr={SelectContainer:he,ValueContainer:_e,SingleValue:_e};return E.createElement("div",{className:Ne.root},me&&E.createElement("label",{className:Ne.label,htmlFor:Qe},me,":","\xA0"),E.createElement($.l6,X(q({openMenuOnFocus:!0,inputId:Qe},He),{components:lr})))}const he=xe=>{const{children:Ee}=xe,me=(0,P.of)(Ke);return E.createElement(H.K,X(q({},xe),{className:(0,V.cx)(xe.className,me.container)}),Ee)},_e=xe=>{const{className:Ee,children:me}=xe,He=(0,P.of)(Ke);return E.createElement("div",{className:(0,V.cx)(Ee,He.valueContainer)},me)},Ke=xe=>({root:(0,V.css)({display:"flex",fontSize:12,alignItems:"center"}),label:(0,V.css)({color:xe.colors.text.secondary,whiteSpace:"nowrap"}),container:(0,V.css)({background:"none",borderColor:"transparent"}),valueContainer:(0,V.css)({display:"flex",alignItems:"center",flex:"initial",color:xe.colors.text.secondary,fontSize:12})})},1779:(we,ge,h)=>{var V=h(48287).Buffer,E=function(){"use strict";function P(q,X){return X!=null&&q instanceof X}var $;try{$=Map}catch{$=function(){}}var H;try{H=Set}catch{H=function(){}}var C;try{C=Promise}catch{C=function(){}}function T(q,X,le,z,he){typeof X=="object"&&(le=X.depth,z=X.prototype,he=X.includeNonEnumerable,X=X.circular);var _e=[],Ke=[],xe=typeof V<"u";typeof X>"u"&&(X=!0),typeof le>"u"&&(le=1/0);function Ee(me,He){if(me===null)return null;if(He===0)return me;var Ne,Qe;if(typeof me!="object")return me;if(P(me,$))Ne=new $;else if(P(me,H))Ne=new H;else if(P(me,C))Ne=new C(function(tt,ye){me.then(function(ie){tt(Ee(ie,He-1))},function(ie){ye(Ee(ie,He-1))})});else if(T.__isArray(me))Ne=[];else if(T.__isRegExp(me))Ne=new RegExp(me.source,Z(me)),me.lastIndex&&(Ne.lastIndex=me.lastIndex);else if(T.__isDate(me))Ne=new Date(me.getTime());else{if(xe&&V.isBuffer(me))return V.allocUnsafe?Ne=V.allocUnsafe(me.length):Ne=new V(me.length),me.copy(Ne),Ne;P(me,Error)?Ne=Object.create(me):typeof z>"u"?(Qe=Object.getPrototypeOf(me),Ne=Object.create(Qe)):(Ne=Object.create(z),Qe=z)}if(X){var lr=_e.indexOf(me);if(lr!=-1)return Ke[lr];_e.push(me),Ke.push(Ne)}P(me,$)&&me.forEach(function(tt,ye){var ie=Ee(ye,He-1),pe=Ee(tt,He-1);Ne.set(ie,pe)}),P(me,H)&&me.forEach(function(tt){var ye=Ee(tt,He-1);Ne.add(ye)});for(var ke in me){var ze;Qe&&(ze=Object.getOwnPropertyDescriptor(Qe,ke)),!(ze&&ze.set==null)&&(Ne[ke]=Ee(me[ke],He-1))}if(Object.getOwnPropertySymbols)for(var sr=Object.getOwnPropertySymbols(me),ke=0;ke<sr.length;ke++){var jr=sr[ke],Yr=Object.getOwnPropertyDescriptor(me,jr);Yr&&!Yr.enumerable&&!he||(Ne[jr]=Ee(me[jr],He-1),Yr.enumerable||Object.defineProperty(Ne,jr,{enumerable:!1}))}if(he)for(var yt=Object.getOwnPropertyNames(me),ke=0;ke<yt.length;ke++){var pr=yt[ke],Yr=Object.getOwnPropertyDescriptor(me,pr);Yr&&Yr.enumerable||(Ne[pr]=Ee(me[pr],He-1),Object.defineProperty(Ne,pr,{enumerable:!1}))}return Ne}return Ee(q,le)}T.clonePrototype=function(X){if(X===null)return null;var le=function(){};return le.prototype=X,new le};function I(q){return Object.prototype.toString.call(q)}T.__objToStr=I;function w(q){return typeof q=="object"&&I(q)==="[object Date]"}T.__isDate=w;function U(q){return typeof q=="object"&&I(q)==="[object Array]"}T.__isArray=U;function Y(q){return typeof q=="object"&&I(q)==="[object RegExp]"}T.__isRegExp=Y;function Z(q){var X="";return q.global&&(X+="g"),q.ignoreCase&&(X+="i"),q.multiline&&(X+="m"),X}return T.__getRegExpFlags=Z,T}();we.exports&&(we.exports=E)},84669:(we,ge,h)=>{"use strict";h.d(ge,{jN:()=>tb,gv:()=>me,oK:()=>XO,e_:()=>op,To:()=>Zt,oF:()=>oa,se:()=>ZO.s,YW:()=>xt,nj:()=>ob});var V={};h.r(V),h.d(V,{applyToJS:()=>Ro,cleanJSX:()=>Po,deepEqual:()=>Ma,deepFreeze:()=>iu,escapeRegExp:()=>nu,getFirstDefined:()=>su,getLogger:()=>lu,getOpCardinality:()=>kr,isDirtyJSX:()=>_a,isImmutable:()=>_n,isJSX:()=>xo,isJsonCompatible:()=>uu,isJsonLogic:()=>ct,logger:()=>hn,mergeArraysSmart:()=>ou,mergeCustomizerNoArrays:()=>va,opDefKeysToOmit:()=>Mn,shallowEqual:()=>pa,sleep:()=>au,toImmutableList:()=>Mr,uuid:()=>cr,widgetDefKeysToOmit:()=>An});var E={};h.r(E),h.d(E,{getItemInListValues:()=>ma,getListValue:()=>Ba,getTitleInListValues:()=>pu,getValueInListValues:()=>Cp,listValuesToArray:()=>fu,makeCustomListValue:()=>Vo,mapListValues:()=>Do,searchListValue:()=>Tp,toListValue:()=>on});var P={};h.r(P),h.d(P,{_fixImmutableValue:()=>$o,expandTreePath:()=>Ce,expandTreeSubpath:()=>No,fixEmptyGroupsInTree:()=>Wa,fixPathsInTree:()=>Dt,getFlatTree:()=>ko,getItemByPath:()=>Gn,getLightTree:()=>gu,getSwitchValues:()=>mu,getTotalReordableNodesCountInTree:()=>Ep,getTotalRulesCountInTree:()=>Mo,getTreeBadFields:()=>ti,hasChildren:()=>Go,immutableToJs:()=>Ro,isEmptyTree:()=>_o,isImmutable:()=>_n,jsToImmutable:()=>ha,removeIsLockedInTree:()=>vu,toImmutableList:()=>Mr});var $={};h.r($),h.d($,{SqlString:()=>yn,mongoEmptyValue:()=>ju,spelEscape:()=>Un,spelFixList:()=>Ru,spelFormatConcat:()=>Wp,spelImportConcat:()=>Kp,sqlEmptyValue:()=>wu,stringifyForDisplay:()=>Pu});var H={};h.r(H),h.d(H,{_loadFromJsonLogic:()=>Cu,_loadFromSpel:()=>qu,checkTree:()=>ni,getTree:()=>Ap,isImmutableTree:()=>hu,isJsonLogic:()=>ct,isTree:()=>yu,isValidTree:()=>ri,jsToImmutable:()=>ha,loadFromJsonLogic:()=>Rp,loadFromSpel:()=>tv,loadTree:()=>Uo});var C={};h.r(C),h.d(C,{createListFromArray:()=>hv,defaultConjunction:()=>Ht,defaultGroupConjunction:()=>Ha,defaultGroupProperties:()=>On,defaultItemProperties:()=>nl,defaultOperatorOptions:()=>Oa,defaultRoot:()=>mv,defaultRule:()=>al,defaultRuleProperties:()=>Kt,emptyProperties:()=>yv,getDefaultField:()=>rl,getDefaultFieldSrc:()=>Qo,getDefaultOperator:()=>Yo,getDefaultSubField:()=>tl});var T={};h.r(T),h.d(T,{_validateTree:()=>ba,checkTree:()=>ni,getNewValueForFieldOp:()=>wn,getTreeBadFields:()=>ti,isValidTree:()=>ri,sanitizeTree:()=>ql,translateValidation:()=>Nt,validateAndFixTree:()=>Ql,validateRange:()=>ai,validateTree:()=>Jl,validateValue:()=>Kn});var I={};h.r(I),h.d(I,{completeFuncValue:()=>es,getCompatibleArgsOnFuncChange:()=>as,setArgValue:()=>ii,setArgValueSrc:()=>ns,setFunc:()=>rs,setFuncDefaultArg:()=>Ja});var w={};h.r(w),h.d(w,{calculateValueType:()=>is,completeValue:()=>Rn,filterValueSourcesForField:()=>jn,formatFieldName:()=>ln,getFieldPartsConfigs:()=>us,getFieldPathLabels:()=>Sa,getFirstOperator:()=>ui,getFuncPathLabels:()=>Dv,getOperatorsForField:()=>Qa,getOperatorsForType:()=>os,getValueLabel:()=>Nv,getValueSourcesForFieldOp:()=>ls,getWidgetForFieldOp:()=>Ar,getWidgetsForFieldOp:()=>kv,isEmptyGroupChildren:()=>ci,isEmptyItem:()=>si,isEmptyRuleGroupExtPropertiesAndChildren:()=>ss,isEmptyRuleProperties:()=>di,selectTypes:()=>qa,whatRulePropertiesAreCompleted:()=>fi});var U={};h.r(U),h.d(U,{_widgetDefKeysToOmit:()=>ug,applyJsonLogic:()=>Bv,cleanJSX:()=>Po,compileConfig:()=>Ss,compressConfig:()=>Os,configKeys:()=>Xa,decompressConfig:()=>bs,extendConfig:()=>kt,getFieldConfig:()=>je,getFieldParts:()=>Pr,getFieldPath:()=>Oi,getFieldPathParts:()=>lg,getFieldRawConfig:()=>Mt,getFieldSrc:()=>js,getFieldWidgetConfig:()=>at,getFirstField:()=>Rs,getFuncArgConfig:()=>yi,getFuncConfig:()=>_r,getFuncSignature:()=>hi,getOperatorConfig:()=>dr,isDirtyJSX:()=>_a,isFieldDescendantOfField:()=>ws,isJSX:()=>xo,iterateFields:()=>Ls,iterateFuncs:()=>qn,normalizeField:()=>eo});var Y={};h.r(Y),h.d(Y,{_mongodbFormat:()=>Hs,_spelFormat:()=>ku,_sqlFormat:()=>Ys,elasticSearchFormat:()=>ac,jsonLogicFormat:()=>pg,mongodbFormat:()=>Og,queryBuilderFormat:()=>sg,queryString:()=>sl,spelFormat:()=>Jp,sqlFormat:()=>Eg});var Z={};h.r(Z),h.d(Z,{fixListValuesGroupOrder:()=>qg,getListValue:()=>Ba,listValueToOption:()=>Jg,mergeListValues:()=>Kg,optionToListValue:()=>Hg,optionsToListValues:()=>zg,simulateAsyncFetch:()=>Wg});var q={};h.r(q),h.d(q,{Autocomplete:()=>Z,ConfigUtils:()=>U,DefaultUtils:()=>C,ExportUtils:()=>$,FuncUtils:()=>I,ListUtils:()=>E,OtherUtils:()=>V,RuleUtils:()=>w,TreeUtils:()=>P,Validation:()=>T,checkTree:()=>ni,clone:()=>wt(),compressConfig:()=>Os,decompressConfig:()=>bs,getSwitchValues:()=>mu,i18n:()=>Lv,isValidTree:()=>ri,moment:()=>$n(),sanitizeTree:()=>ql,uuid:()=>cr,validateAndFixTree:()=>Ql,validateTree:()=>Jl});var X={};h.r(X),h.d(X,{LINEAR_REGRESSION:()=>em,LOWER:()=>Xg,NOW:()=>Qg,RELATIVE_DATETIME:()=>Yg,UPPER:()=>Zg});var le={};h.r(le),h.d(le,{addCaseGroup:()=>Gm,addDefaultCaseGroup:()=>_m,addGroup:()=>$m,addRule:()=>km,moveItem:()=>Bm,removeGroup:()=>Um,removeRule:()=>Mm,setTree:()=>Nm});var z={};h.r(z),h.d(z,{setConjunction:()=>Wm,setLock:()=>Hm,setNot:()=>Km});var he={};h.r(he),h.d(he,{setField:()=>zm,setFieldSrc:()=>Jm,setFuncValue:()=>Xm,setOperator:()=>qm,setOperatorOption:()=>Zm,setValue:()=>Qm,setValueSrc:()=>Ym});var _e={};h.r(_e),h.d(_e,{bindActionCreators:()=>ad,isUsingLegacyReactDomRender:()=>nd,liteShouldComponentUpdate:()=>ki,pureShouldComponentUpdate:()=>Zn,useOnPropsChanged:()=>et});var Ke={};h.r(Ke),h.d(Ke,{FuncWidget:()=>Hi,ValueFieldWidget:()=>Uf,VanillaBooleanWidget:()=>eO,VanillaButton:()=>gO,VanillaButtonGroup:()=>hO,VanillaConjs:()=>pO,VanillaDateTimeWidget:()=>oO,VanillaDateWidget:()=>nO,VanillaFieldSelect:()=>fO,VanillaIcon:()=>mO,VanillaMultiSelectWidget:()=>uO,VanillaNumberWidget:()=>cO,VanillaProvider:()=>SO,VanillaSelectWidget:()=>sO,VanillaSliderWidget:()=>dO,VanillaSwitch:()=>OO,VanillaTextAreaWidget:()=>tO,VanillaTextWidget:()=>rO,VanillaTimeWidget:()=>aO,VanillaValueSources:()=>yO,vanillaConfirm:()=>bO});var xe={};h.r(xe),h.d(xe,{ProximityOperator:()=>Yi});var Ee=h(50877),me=(n=>(n.Timeseries="time_series",n.Table="table",n))(me||{});const He=[{label:"Time series",value:"time_series"},{label:"Table",value:"table"}],Ne=n=>({label:n,value:n}),Qe=Ee.z??Ne;var lr=h(13288),ke=h(75505),ze=h(81160),sr=h(41987),jr=h(92053),Yr=h(43127),yt=h(78368),pr=h(98765),tt=h(26657),ye=h(72574),ie=h(14110),pe=h(17172),Ie=h(47773),De=h(2543);class oe{transformMetricFindResponse(e){const t=[],r=e.fields.find(o=>o.name==="__text"),a=e.fields.find(o=>o.name==="__value");if(r&&a)for(let o=0;o<r.values.length;o++)t.push({text:""+r.values[o],value:""+a.values[o]});else for(const o of e.fields)for(const u of o.values)t.push({text:u});return(0,De.uniqBy)(t,"text")}}var D=h(74848),F=h(96540),Xe=h(16817),lt=h(68402),Wr=(n=>(n.String="string",n))(Wr||{}),yr=(n=>(n.Property="property",n.Operator="operator",n.Or="or",n.And="and",n.GroupBy="groupBy",n.Function="function",n.FunctionParameter="functionParameter",n))(yr||{});function oa(n){return`SELECT ${n.map(t=>{let r="";return t.name&&t.alias?r+=`${t.name}(${t.parameters?.map(a=>`${a.name}`)}) AS ${t.alias}`:t.name?r+=`${t.name}(${t.parameters?.map(a=>`${a.name}`)})`:t.alias?r+=`${t.parameters?.map(a=>`${a.name}`)} AS ${t.alias}`:r+=`${t.parameters?.map(a=>`${a.name}`)}`,r}).join(", ")} `}const xt=n=>{if(!n)return!1;const e=n.some(r=>r.parameters?.length||r.parameters?.some(a=>a.name)),t=n.some(r=>r.name);return e||t};function ia(n){return{type:yr.GroupBy,property:{type:Wr.String,name:n}}}function ua(n){return{type:yr.Property,property:{type:Wr.String,name:n}}}function pn(n){return{type:yr.Function,name:n,parameters:[]}}function Zt(n){let e=n?.editorMode||pr.lX.Builder;return n?.editorMode===void 0&&n?.rawSql!==void 0&&(e=pr.lX.Code),{...n,refId:n?.refId||"A",format:n?.format!==void 0?n.format:me.Table,rawSql:n?.rawSql||"",editorMode:e,sql:n?.sql??{columns:[pn()],groupBy:[ia()],limit:50}}}var la=h(73287),Kr=h(13544),bo=h(6191),So=h(22354),Xr=h(31347),en=h(9e4),Ot=h(81580),vn=h(15292),It=h(55852),rn=h(56034),sa=h(94354),zr=h(32196),gn=h(40845),ca=h(37390),tn=h(14578);function Fo({isOpen:n,onCancel:e,onDiscard:t,onCopy:r}){const a=(0,F.useRef)(null),o=(0,gn.of)(wa);return(0,F.useEffect)(()=>{n&&a.current?.focus()},[n]),(0,D.jsxs)(ca.a,{title:(0,D.jsxs)("div",{className:"modal-header-title",children:[(0,D.jsx)(tn.I,{name:"exclamation-triangle",size:"lg"}),(0,D.jsx)("span",{className:o.titleText,children:"Warning"})]}),onDismiss:e,isOpen:n,children:[(0,D.jsx)("p",{children:"Builder mode does not display changes made in code. The query builder will display the last changes you made in builder mode."}),(0,D.jsx)("p",{children:"Do you want to copy your code to the clipboard?"}),(0,D.jsxs)(ca.a.ButtonRow,{children:[(0,D.jsx)(It.$n,{type:"button",variant:"secondary",onClick:e,fill:"outline",children:"Cancel"}),(0,D.jsx)(It.$n,{variant:"destructive",type:"button",onClick:t,ref:a,children:"Discard code and switch"}),(0,D.jsx)(It.$n,{variant:"primary",onClick:r,children:"Copy code and switch"})]})]})}const wa=n=>({titleText:(0,zr.css)({paddingLeft:n.spacing(2)})});var pt=h(90182),nn=h(32264);const Cn=()=>!!nn.$.featureToggles.sqlDatasourceDatabaseSelection,ru=({dataset:n,db:e,dialect:t,onChange:r,inputId:a,preconfiguredDataset:o})=>{const u=!!o||t==="postgres",i=(0,Xe.A)(async()=>Cn()&&u?(r(Qe(o)),[Qe(o)]):(n&&r(Qe(n)),(await e.datasets()).map(Qe)),[]);return(0,F.useEffect)(()=>{Cn()||(n?i.value&&i.value.find(l=>l.value===n)===void 0&&i.value.length>0&&r(i.value[0]):i.value&&i.value[0]&&r(i.value[0]))},[i.value,r,n]),(0,D.jsx)(pt.l6,{"aria-label":"Dataset selector",inputId:a,value:n,options:i.value,onChange:r,disabled:i.loading,isLoading:i.loading,menuShouldPortal:!0})},Co=({db:n,dataset:e,table:t,className:r,onChange:a,inputId:o})=>{const u=(0,Xe.A)(async()=>e?(await n.tables(e)).map(Ee.z):[],[e]);return(0,D.jsx)(pt.l6,{className:r,disabled:u.loading,"aria-label":"Table selector",inputId:o,"data-testid":Kr.Tp.components.SQLQueryEditor.headerTableSelector,value:t,options:u.value,onChange:a,isLoading:u.loading,menuShouldPortal:!0,placeholder:u.loading?"Loading tables":"Select table"})},To=[{label:"Builder",value:pr.lX.Builder},{label:"Code",value:pr.lX.Code}];function Eo({db:n,dialect:e,isQueryRunnable:t,onChange:r,onQueryRowChange:a,onRunQuery:o,preconfiguredDataset:u,query:i,queryRowFilter:l}){const{editorMode:s}=i,[c,d]=(0,la.A)(),[f,p]=(0,F.useState)(!1),v=n.toRawSql,g=(0,F.useId)(),m=(0,F.useCallback)(L=>{if(L===pr.lX.Code&&(0,ie.rR)("grafana_sql_editor_mode_changed",{datasource:i.datasource?.type,selectedEditorMode:pr.lX.Code}),s===pr.lX.Code){p(!0);return}r({...i,editorMode:L})},[s,r,i]),O=L=>{const S={...i,format:L.value!==void 0?L.value:me.Table};(0,ie.rR)("grafana_sql_format_changed",{datasource:i.datasource?.type,selectedFormat:S.format}),r(S)},y=L=>{if(L.value===i.dataset)return;const S={...i,dataset:L.value,table:void 0,sql:void 0,rawSql:""};r(S)},b=L=>{if(L.value===i.table)return;const S={...i,table:L.value,sql:void 0,rawSql:""};r(S)},A=()=>!(e==="influx"||!Cn()&&e==="postgres");return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)(bo.X,{children:[(0,D.jsx)(So.W,{label:"Format",value:i.format,placeholder:"Select format",menuShouldPortal:!0,onChange:O,options:He}),s===pr.lX.Builder&&(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(vn.K,{id:`sql-filter-${g}`,label:"Filter","data-testid":Kr.Tp.components.SQLQueryEditor.headerFilterSwitch,transparent:!0,showLabel:!0,value:l.filter,onChange:L=>{L.target instanceof HTMLInputElement&&((0,ie.rR)("grafana_sql_filter_toggled",{datasource:i.datasource?.type,displayed:L.target.checked}),a({...l,filter:L.target.checked}))}}),(0,D.jsx)(vn.K,{id:`sql-group-${g}`,label:"Group","data-testid":Kr.Tp.components.SQLQueryEditor.headerGroupSwitch,transparent:!0,showLabel:!0,value:l.group,onChange:L=>{L.target instanceof HTMLInputElement&&((0,ie.rR)("grafana_sql_group_toggled",{datasource:i.datasource?.type,displayed:L.target.checked}),a({...l,group:L.target.checked}))}}),(0,D.jsx)(vn.K,{id:`sql-order-${g}`,label:"Order","data-testid":Kr.Tp.components.SQLQueryEditor.headerOrderSwitch,transparent:!0,showLabel:!0,value:l.order,onChange:L=>{L.target instanceof HTMLInputElement&&((0,ie.rR)("grafana_sql_order_toggled",{datasource:i.datasource?.type,displayed:L.target.checked}),a({...l,order:L.target.checked}))}}),(0,D.jsx)(vn.K,{id:`sql-preview-${g}`,label:"Preview","data-testid":Kr.Tp.components.SQLQueryEditor.headerPreviewSwitch,transparent:!0,showLabel:!0,value:l.preview,onChange:L=>{L.target instanceof HTMLInputElement&&((0,ie.rR)("grafana_sql_preview_toggled",{datasource:i.datasource?.type,displayed:L.target.checked}),a({...l,preview:L.target.checked}))}})]}),(0,D.jsx)(Xr.Z,{grow:1}),t?(0,D.jsx)(It.$n,{icon:"play",variant:"primary",size:"sm",onClick:()=>o(),children:"Run query"}):(0,D.jsx)(rn.m,{theme:"error",content:(0,D.jsxs)(D.Fragment,{children:["Your query is invalid. Check below for details. ",(0,D.jsx)("br",{}),"However, you can still run this query."]}),placement:"top",children:(0,D.jsx)(It.$n,{icon:"exclamation-triangle",variant:"secondary",size:"sm",onClick:()=>o(),children:"Run query"})}),(0,D.jsx)(sa.z,{options:To,size:"sm",value:s,onChange:m}),(0,D.jsx)(Fo,{isOpen:f,onCopy:()=>{(0,ie.rR)("grafana_sql_editor_mode_changed",{datasource:i.datasource?.type,selectedEditorMode:pr.lX.Builder,type:"copy"}),p(!1),d(i.rawSql),r({...i,rawSql:v(i),editorMode:pr.lX.Builder})},onDiscard:()=>{(0,ie.rR)("grafana_sql_editor_mode_changed",{datasource:i.datasource?.type,selectedEditorMode:pr.lX.Builder,type:"discard"}),p(!1),r({...i,rawSql:v(i),editorMode:pr.lX.Builder})},onCancel:()=>{(0,ie.rR)("grafana_sql_editor_mode_changed",{datasource:i.datasource?.type,selectedEditorMode:pr.lX.Builder,type:"cancel"}),p(!1)}})]}),s===pr.lX.Builder&&(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(lt.$,{v:.5}),(0,D.jsxs)(en.U,{children:[A()&&(0,D.jsx)(Ot.c,{label:"Dataset",width:25,children:(0,D.jsx)(ru,{db:n,inputId:`sql-dataset-${g}`,dataset:i.dataset,dialect:e,preconfiguredDataset:u,onChange:y})}),(0,D.jsx)(Ot.c,{label:"Table",width:25,children:(0,D.jsx)(Co,{db:n,inputId:`sql-tableselect-${g}`,dataset:i.dataset||u,table:i.table,onChange:b})})]})]})]})}var ja=h(49185),Ra=h(70713),Pa=h(6867);function xa({children:n,onChange:e,query:t,width:r,height:a,editorLanguageDefinition:o}){const u=(0,F.useRef)(t);(0,F.useEffect)(()=>{u.current=t},[t]);const i=(0,F.useCallback)((l,s)=>{const c={...u.current,rawQuery:!0,rawSql:l};e(c,s)},[e]);return(0,D.jsx)(Pa.Y,{width:r,height:a,query:t.rawSql,onChange:i,language:o,children:n})}var Ia=h(66864),da=h(29158),Ao=h(41053),Va=h(75198),Da=h(83195),Sr=h(62930);function Lt({db:n,query:e,onValidate:t,range:r}){const[a,o]=(0,F.useState)(),u=(0,gn.$j)(),i=(0,F.useMemo)(()=>(0,Da.j_)("bytes"),[]),l=(0,F.useMemo)(()=>({error:(0,zr.css)({color:u.colors.error.text,fontSize:u.typography.bodySmall.fontSize,fontFamily:u.typography.fontFamilyMonospace}),valid:(0,zr.css)({color:u.colors.success.text}),info:(0,zr.css)({color:u.colors.text.secondary})}),[u]),[s,c]=(0,Ao.A)(async f=>f.rawSql?.trim()===""?null:await n.validateQuery(f,r),[n]),[,]=(0,Va.A)(async()=>{const f=await c(e);return f&&o(f),null},1e3,[e,c]);if((0,F.useEffect)(()=>{a?.isError&&t(!1),a?.isValid&&t(!0)},[a,t]),!s.value&&!s.loading)return null;const d=s.value?.error?Lo(s.value.error):"";return(0,D.jsxs)(D.Fragment,{children:[s.loading&&(0,D.jsxs)("div",{className:l.info,children:[(0,D.jsx)(Sr.y,{inline:!0,size:"xs"})," Validating query..."]}),!s.loading&&s.value&&(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(D.Fragment,{children:s.value.isValid&&s.value.statistics&&(0,D.jsxs)("div",{className:l.valid,children:[(0,D.jsx)(tn.I,{name:"check"})," This query will process"," ",(0,D.jsx)("strong",{children:(0,Da.cN)(i(s.value.statistics.TotalBytesProcessed))})," ","when run."]})}),(0,D.jsx)(D.Fragment,{children:s.value.isError&&(0,D.jsx)("div",{className:l.error,children:d})})]})]})}function Lo(n){const e=n.split(":");return e.length>2?e.slice(2).join(":"):n}function Na({showTools:n,onFormatCode:e,onExpand:t,isExpanded:r,...a}){const o=(0,gn.$j)(),[u,i]=(0,F.useState)(),l=(0,F.useMemo)(()=>({container:(0,zr.css)({border:`1px solid ${o.colors.border.medium}`,borderTop:"none",padding:o.spacing(.5,.5,.5,.5),display:"flex",flexGrow:1,justifyContent:"space-between",fontSize:o.typography.bodySmall.fontSize}),error:(0,zr.css)({color:o.colors.error.text,fontSize:o.typography.bodySmall.fontSize,fontFamily:o.typography.fontFamilyMonospace}),valid:(0,zr.css)({color:o.colors.success.text}),info:(0,zr.css)({color:o.colors.text.secondary}),hint:(0,zr.css)({color:o.colors.text.disabled,whiteSpace:"nowrap",cursor:"help"})}),[o]);let s={};return!n&&u===void 0&&(s={height:0,padding:0,visibility:"hidden"}),(0,D.jsxs)("div",{className:l.container,style:s,children:[(0,D.jsx)("div",{children:a.onValidate&&(0,D.jsx)(Lt,{...a,onValidate:c=>{i(c),a.onValidate(c)}})}),n&&(0,D.jsx)("div",{children:(0,D.jsxs)(Ia.Gy,{spacing:"sm",children:[e&&(0,D.jsx)(da.K,{onClick:()=>{(0,ie.rR)("grafana_sql_query_formatted",{datasource:a.query.datasource?.type}),e()},name:"brackets-curly",size:"xs",tooltip:"Format query"}),t&&(0,D.jsx)(da.K,{onClick:()=>{(0,ie.rR)("grafana_sql_editor_expand",{datasource:a.query.datasource?.type,expanded:!r}),t(!r)},name:r?"angle-up":"angle-down",size:"xs",tooltip:r?"Collapse editor":"Expand editor"}),(0,D.jsx)(rn.m,{content:"Hit CTRL/CMD+Return to run query",children:(0,D.jsx)(tn.I,{className:l.hint,name:"keyboard"})})]})})]})}function wo({db:n,query:e,onChange:t,onRunQuery:r,onValidate:a,queryToValidate:o,range:u}){const i=(0,gn.$j)(),l=(0,gn.of)(xr),[s,c]=(0,F.useState)(!1),[d,f]=(0,ja.A)(),[p,v]=(0,ja.A)(),g=(0,F.useMemo)(()=>n.getEditorLanguageDefinition(),[n]),m=(b,A)=>(0,D.jsx)(xa,{editorLanguageDefinition:g,query:e,width:b,height:A?A-f.height:void 0,onChange:t,children:({formatQuery:L})=>(0,D.jsx)("div",{ref:d,children:(0,D.jsx)(Na,{db:n,query:o,onValidate:a,onFormatCode:L,showTools:!0,range:u,onExpand:c,isExpanded:s})})}),O=(b=!1)=>b?(0,D.jsx)(Ra.Ay,{children:({width:A,height:L})=>m(A,L)}):(0,D.jsx)("div",{ref:p,children:m()}),y=()=>(0,D.jsx)("div",{style:{width:v.width,height:v.height,background:i.colors.background.primary,display:"flex",alignItems:"center",justifyContent:"center"},children:"Editing in expanded code editor"});return(0,D.jsxs)(D.Fragment,{children:[s?y():O(),s&&(0,D.jsx)(ca.a,{title:`Query ${e.refId}`,closeOnBackdropClick:!1,closeOnEscape:!1,className:l.modal,contentClassName:l.modalContent,isOpen:s,onDismiss:()=>{(0,ie.rR)("grafana_sql_editor_expand",{datasource:e.datasource?.type,expanded:!1}),c(!1)},children:O(!0)})]})}function xr(n){return{modal:(0,zr.css)({width:"95vw",height:"95vh"}),modalContent:(0,zr.css)({height:"100%",paddingTop:0})}}var Ir=h(71087),vt=h(11807);function Vt({query:n,onQueryChange:e,db:t}){return{onSqlChange:(0,F.useCallback)(a=>{const o=t.toRawSql,u=o({sql:a,dataset:n.dataset,table:n.table,refId:n.refId}),i={...n,sql:a,rawSql:u};e(i)},[t,e,n])}}var Tn=h(85269),ka=h(81392),mn=h(3721);function Or({sql:n,columns:e,onSqlChange:t}){const r=(0,F.useCallback)(a=>{const o=a.map(i=>ia(i.property?.name)),u={...n,groupBy:o};t(u)},[t,n]);return(0,D.jsx)(Tn.o,{items:n.groupBy,onChange:r,renderItem:Tr({options:e})})}function Tr({options:n}){return function(t,r,a){return(0,D.jsxs)(ka.M,{children:[(0,D.jsx)(pt.l6,{value:t.property?.name?(0,Ee.z)(t.property.name):null,"aria-label":"Group by",options:n,menuShouldPortal:!0,onChange:({value:o})=>o&&r(ia(o))}),(0,D.jsx)(mn.Z,{title:"Remove group by column",icon:"times",variant:"secondary",onClick:a})]})}}function Zr({fields:n,query:e,onQueryChange:t,db:r}){const{onSqlChange:a}=Vt({query:e,onQueryChange:t,db:r});return(0,D.jsx)(Or,{columns:n,sql:e.sql,onSqlChange:a})}var En=h(10354);const kn=[{description:"Sort by ascending",value:"ASC",icon:"sort-amount-up"},{description:"Sort by descending",value:"DESC",icon:"sort-amount-down"}];function jo({sql:n,onSqlChange:e,columns:t,showOffset:r}){const a=(0,F.useCallback)(l=>{const s={...n,orderByDirection:l};e(s)},[e,n]),o=(0,F.useCallback)(l=>{const s={...n,limit:Number.parseInt(l.currentTarget.value,10)};e(s)},[e,n]),u=(0,F.useCallback)(l=>{const s={...n,offset:Number.parseInt(l.currentTarget.value,10)};e(s)},[e,n]),i=(0,F.useCallback)(l=>{const s={...n,orderBy:ua(l?.value)};l===null&&(s.orderByDirection=void 0),e(s)},[e,n]);return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(Ot.c,{label:"Order by",width:25,children:(0,D.jsxs)(ka.M,{children:[(0,D.jsx)(pt.l6,{"aria-label":"Order by",options:t,value:n.orderBy?.property.name?(0,Ee.z)(n.orderBy.property.name):null,isClearable:!0,menuShouldPortal:!0,onChange:i}),(0,D.jsx)(lt.$,{h:1.5}),(0,D.jsx)(sa.z,{options:kn,disabled:!n?.orderBy?.property.name,value:n.orderByDirection,onChange:a})]})}),(0,D.jsx)(Ot.c,{label:"Limit",optional:!0,width:25,children:(0,D.jsx)(En.p,{type:"number",min:0,id:(0,De.uniqueId)("limit-"),value:n.limit||"",onChange:o})}),r&&(0,D.jsx)(Ot.c,{label:"Offset",optional:!0,width:25,children:(0,D.jsx)(En.p,{type:"number",id:(0,De.uniqueId)("offset-"),value:n.offset||"",onChange:u})})]})}function fa({fields:n,query:e,onQueryChange:t,db:r}){const{onSqlChange:a}=Vt({query:e,onQueryChange:t,db:r});let o=[];return n&&(o=[{value:"",label:"Selected columns",options:e.sql?.columns?.map((i,l)=>{const s=i.name?`${i.name}(${i.parameters?.map(c=>c.name)})`:i.parameters?.map(c=>c.name);return{value:s,label:`${l+1} - ${s}`}}),expanded:!0},...n]),(0,D.jsx)(jo,{sql:e.sql,onSqlChange:a,columns:o})}const Ge=["AVG","COUNT","MAX","MIN","SUM"],gt=["$__time","$__timeEpoch","$__timeFilter","$__timeFrom","$__timeTo","$__timeGroup","$__timeGroupAlias","$__unixEpochFilter","$__unixEpochNanoFilter","$__unixEpochNanoFrom","$__unixEpochNanoTo","$__unixEpochGroup","$__unixEpochGroupAlias"];var _=h(46819);const ee={label:"*",value:"*"};function Se({sql:n,format:e,columns:t,onSqlChange:r,functions:a}){const o=(0,gn.of)(We),u=[ee,...t||[]],i=[];e===me.Timeseries&&(i.push({label:"time",value:"time"}),i.push({label:"value",value:"value"}));const l=(0,F.useCallback)((p,v)=>g=>{let m={...p};p.parameters?.length?m.parameters=p.parameters.map(y=>y.type===yr.FunctionParameter?{...y,name:g.value}:y):m.parameters=[{type:yr.FunctionParameter,name:g.value}];const O={...n,columns:n.columns?.map((y,b)=>b===v?m:y)};r(O)},[r,n]),s=(0,F.useCallback)((p,v)=>g=>{const m={...p,name:g?.value},O={...n,columns:n.columns?.map((y,b)=>b===v?m:y)};r(O)},[r,n]),c=(0,F.useCallback)((p,v)=>g=>{let m={...p};g!==null?m={...p,alias:`"${g?.value?.trim()}"`}:delete m.alias;const O={...n,columns:n.columns?.map((y,b)=>b===v?m:y)};r(O)},[r,n]),d=(0,F.useCallback)(p=>()=>{const v=[...n.columns];v.splice(p,1);const g={...n,columns:v};r(g)},[r,n]),f=(0,F.useCallback)(()=>{const p={...n,columns:[...n.columns,pn()]};r(p)},[r,n]);return(0,D.jsxs)(_.B,{gap:2,wrap:!0,direction:"column",children:[n.columns?.map((p,v)=>(0,D.jsx)("div",{children:(0,D.jsxs)(_.B,{gap:2,alignItems:"end",children:[(0,D.jsx)(Ot.c,{label:"Column",width:25,children:(0,D.jsx)(pt.l6,{value:st(p),"data-testid":Kr.Tp.components.SQLQueryEditor.selectColumn,options:u,inputId:`select-column-${v}-${(0,De.uniqueId)()}`,menuShouldPortal:!0,allowCustomValue:!0,onChange:l(p,v)})}),(0,D.jsx)(Ot.c,{label:"Aggregation",optional:!0,width:25,children:(0,D.jsx)(pt.l6,{value:p.name?(0,Ee.z)(p.name):null,inputId:`select-aggregation-${v}-${(0,De.uniqueId)()}`,"data-testid":Kr.Tp.components.SQLQueryEditor.selectAggregation,isClearable:!0,menuShouldPortal:!0,allowCustomValue:!0,options:a,onChange:s(p,v)})}),(0,D.jsx)(Ot.c,{label:"Alias",optional:!0,width:15,children:(0,D.jsx)(pt.l6,{value:p.alias?(0,Ee.z)(p.alias):null,inputId:`select-alias-${v}-${(0,De.uniqueId)()}`,"data-testid":Kr.Tp.components.SQLQueryEditor.selectAlias,options:i,onChange:c(p,v),isClearable:!0,menuShouldPortal:!0,allowCustomValue:!0})}),(0,D.jsx)(It.$n,{title:"Remove column",type:"button",icon:"trash-alt",variant:"secondary",size:"md",onClick:d(v)})]})},v)),(0,D.jsx)(It.$n,{type:"button",onClick:f,variant:"secondary",title:"Add column",size:"md",icon:"plus",className:o.addButton})]})}const We=()=>({addButton:(0,zr.css)({alignSelf:"flex-start"})});function st({parameters:n}){const e=n?.find(t=>t.type===yr.FunctionParameter);return e?.name?(0,Ee.z)(e.name):null}function nt({fields:n,query:e,onQueryChange:t,db:r}){const{onSqlChange:a}=Vt({query:e,onQueryChange:t,db:r}),o=[...Ge,...r.functions?.()||[]].map(Ee.z);return(0,D.jsx)(Se,{columns:n,sql:e.sql,format:e.format,functions:o,onSqlChange:a})}var cp=h(24705),vr=h(23029),gr=h(92901),br=h(56822),Ae=h(53954),mr=h(85501),te=h(64467),Fe=h(60436),Le=h(5544),Fr=h(82284),be=h(49568),dp=h(90179),Cr=h.n(dp),fp=0;const cr=function(){var n=(new Date().getTime().toString(16)+"FF").substr(0,11),e="ssssssss-xxxx-4xxx-yxxx-x".replace(/[xys]/g,function(t){var r=t==="s"?Math.floor(Math.random()*16):fp++&15,a=t==="x"?r:r&3|8;return a.toString(16)});return e+n};var tu=function(e){return(0,Fr.A)(e)=="object"&&e!==null&&!Array.isArray(e)},An=["formatValue","mongoFormatValue","sqlFormatValue","jsonLogic","elasticSearchFormatValue","spelFormatValue","spelImportFuncs","spelImportValue"],Mn=["formatOp","mongoFormatOp","sqlFormatOp","jsonLogic","spelFormatOp"],kr=function(e){var t;return(t=e?.cardinality)!==null&&t!==void 0?t:1},Ma=function(e,t){return e===t?!0:be.Map.isMap(e)?e.equals(t):JSON.stringify(e)==JSON.stringify(t)},pa=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return e===t?!0:Array.isArray(e)?pp(e,t,r):be.Map.isMap(e)?e.equals(t):(0,Fr.A)(e)=="object"?vp(e,t,r):e===t};function pp(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(n===e)return!0;if(!n||!e)return!1;var r=n.length;if(e.length!==r)return!1;for(var a=0;a<r;a++){var o=t?pa(n[a],e[a],t):n[a]===e[a];if(!o)return!1}return!0}function vp(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(n===e)return!0;if(!n||!e)return!1;var r=Object.keys(n),a=Object.keys(e),o=r.length;if(a.length!==o)return!1;for(var u=0;u<o;u++){var i=r[u],l=t?pa(n[i],e[i],t):n[i]===e[i];if(!l)return!1}return!0}var _n=function(e){return(0,Fr.A)(e)==="object"&&e!==null&&typeof e.toJS=="function"};function Mr(n){return _n(n)?n:new be.default.List(n)}function Ro(n){return _n(n)?n.toJS():n}var nu=function(e){return e.replace(/[.*+?^${}()|[\]\\/]/g,"\\$&")},va=function(e,t,r,a,o,u){if(Array.isArray(e))return t},Po=function n(e){var t=["$$typeof","_owner","_store","ref","key"],r=function(i){return typeof i=="string"?i:typeof i=="function"?i.name:i};if(e instanceof Array)return e.map(function(u,i){return n(u)});if((0,Fr.A)(e)==="object"&&e!==null&&_a(e)){var a,o=Cr()(e,t);return o.type&&(o.type=r(o.type)),o!=null&&(a=o.props)!==null&&a!==void 0&&a.children&&(o.props.children=n(o.props.children)),o}return e},_a=function(e){return(0,Fr.A)(e)==="object"&&e!==null&&!Array.isArray(e)&&Object.keys(e).includes("type")&&Object.keys(e).includes("props")&&Object.keys(e).includes("key")&&Object.keys(e).includes("ref")&&Object.keys(e).includes("$$typeof")},xo=function(e){return(0,Fr.A)(e)==="object"&&e!==null&&!Array.isArray(e)&&typeof e.type=="string"&&Object.keys(e).includes("props")},ct=function(e){var t=(0,Fr.A)(e)==="object"&&e!==null&&!Array.isArray(e)&&Object.keys(e).length===1;return t};function au(n){return new Promise(function(e){setTimeout(e,n)})}function ou(n,e){return n||(n=[]),e||(e=[]),e.map(function(t){return[t,n.indexOf(t)]}).map(function(t,r,a){var o=(0,Le.A)(t,2),u=o[0],i=o[1];if(i==-1){var l=a.slice(r+1),s=a.slice(0,r),c=s.reverse().find(function(f){var p=(0,Le.A)(f,2),v=p[0],g=p[1];return g!=-1}),d=l.find(function(f){var p=(0,Le.A)(f,2),v=p[0],g=p[1];return g!=-1});return d?[u,"before",d[0]]:c?[u,"after",c[0]]:[u,"append",null]}else return null}).filter(function(t){return t!==null}).reduce(function(t,r){var a=(0,Le.A)(r,3),o=a[0],u=a[1],i=a[2],l=t.indexOf(i);return t.indexOf(o)==-1&&(l>-1?t.splice(l+(u=="after"?1:0),0,o):t.splice(u=="append"?1/0:0,0,o)),t},n.slice())}var iu=function n(e){(0,Fr.A)(e)==="object"&&e!==null&&(Object.keys(e).forEach(function(t){n(e[t])}),Object.freeze(e))},uu=function n(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];if(tu(e)){if(e.var)return r[e.var]=t,!0;if(!tu(t))return!1;for(var o in e){var u=e[o],i=t[o];if(!n(u,i,r,[].concat((0,Fe.A)(a),[o])))return!1}return!0}else if(Array.isArray(e)){if(!Array.isArray(t))return!1;for(var l=0;l<e.length;l++){var s=e[l],c=t[l];if(!n(s,c,r,[].concat((0,Fe.A)(a),[l])))return!1}return!0}else return e===t},gp=function(){return typeof process<"u"&&process.env&&!1},lu=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=e??gp();return t?console:{error:function(){},log:function(){},warn:function(){},debug:function(){},info:function(){}}},su=function(){for(var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t,r=0;r<e.length;r++){var a=e[r];if(a!==void 0){t=a;break}}return t},hn=lu(),mp=h(54756),an=h.n(mp),hp=h(55364),ga=h.n(hp),yp=h(44383),Bt=h.n(yp),Op=h(6924),Ga=h.n(Op),bp=h(68090),$a=h.n(bp);function Sp(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Fp(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function Fp(n,e){if(n){if(typeof n=="string")return cu(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return cu(n,e)}}function cu(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function du(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Ua(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?du(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):du(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Io=function(e){return(0,Fr.A)(e)=="object"&&e!==null&&!Array.isArray(e)},on=function(e,t){if(!(e==null||e==""))return Io(e)?Ua(Ua({},e),{},{title:e.title||e.value}):{value:e,title:t!==void 0?t:""+e}},Vo=function(e){var t=on(e);return Io(t)?Ua(Ua({},on(e)),{},{isCustom:!0}):t},fu=function(e){if(Array.isArray(e))return e.map(function(o){return on(o)});if(!Io(e))return e;var t=[];for(var r in e){var a=e[r];t.push(on(r,a))}return t},ma=function(e,t){if(Array.isArray(e)){var r=e.map(function(a){return on(a)});return r.find(function(a){return""+a.value==""+t})}else return e[t]!==void 0?on(t,e[t]):void 0},pu=function(e,t){if(e==null)return t;var r=ma(e,t);return r!==void 0?r.title:t},Cp=function(e,t){if(e==null)return t;var r=ma(e,t);return r!==void 0?r.value:t},Do=function(e,t){var r=[];if(Array.isArray(e)){var a=Sp(e),o;try{for(a.s();!(o=a.n()).done;){var u=o.value,i=t(on(u));i!=null&&r.push(i)}}catch(c){a.e(c)}finally{a.f()}}else for(var l in e){var s=t(on(l,e[l]));s!=null&&r.push(s)}return r},Tp=function(e,t){return Do(t,function(r){return"".concat(r.value).indexOf(e)!=-1||r.title.indexOf(e)!=-1?r:null}).filter(function(r){return r!==null}).shift()},Ba=function(e,t){return Do(t,function(r){return""+r.value==""+e?r:null}).filter(function(r){return r!==null}).shift()},Ce=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return e.interpose("children1").withMutations(function(o){return o.skip(1),o.push.apply(o,r),o})},No=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return e.interpose("children1").withMutations(function(o){return o.push.apply(o,r),o})},Gn=function(e,t){var r=new be.default.OrderedMap((0,te.A)({},e.get("id"),e)),a=e;return t.forEach(function(o){var u;a=r.get(o),r=(u=a)===null||u===void 0?void 0:u.get("children1")}),a},vu=function(e){var t=e;function r(a,o){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=o.push(a.get("id")),l=a.getIn(["properties","isLocked"]);u&&l&&(t=t.deleteIn(Ce(i,"properties","isLocked")));var s=a.get("children1");s&&s.map(function(c,d){r(c,i,l||u)})}return r(e,new be.default.List),t},Dt=function(e){var t=e;function r(a,o,u,i){if(a){var l=a.get("path"),s=a.get("id"),c=s||i||cr(),d=o.push(c);(!l||!l.equals(d))&&(t=t.setIn(Ce(d,"path"),d)),s||(t=t.setIn(Ce(d,"id"),c));var f=a.get("children1");f&&(f.constructor.name==="Map"&&(t=t.setIn(Ce(d,"children1"),new be.default.OrderedMap(f))),f.map(function(p,v){r(p,d,u+1,v)}))}}return r(e,new be.default.List,0),t},Wa=function(e){var t=e;function r(a,o,u,i){if(!a)return!1;var l=a.get("id")||i,s=o.push(l),c=a.get("children1");if(c){var d=c.map(function(f,p){return r(f,s,u+1,p)}).reduce(function(f,p){return f&&p},!0);if((c.size==0||d)&&u>0)return t=t.deleteIn(Ce(s)),!0}return!1}return r(e,new be.default.List,0),t},ko=function(e){var t=[],r={},a=[],o=0,u=0,i=0,l=0,s={};function c(g,m,O,y,b,A,L,S){var R=g===e,N=g.get("type"),M=g.get("collapsed"),x=g.get("id"),W=g.get("children1"),B=g.getIn(["properties","isLocked"]),k=W?W.map(function(Be,ar){return ar}).valueSeq().toArray():null,Q=N==="rule_group",K=N==="rule",J=N==="group",G=N==="case_group",re=!b&&(!W||Q),ue=k?.length>0,de=m.length?m[m.length-1]:null,fe=G?x:L;G&&(a.push(x),u=0,i=0,l=0,s={});var ae=fe?a.indexOf(fe):null,ne=t.length,ve=o,ce;R||(ce={},ce.caseNo=ae,ce.globalNoByType=s[N]||0,ce.indexPath=[].concat((0,Fe.A)(m.slice(1).map(function(Be){return r[Be].childNo})),[S]),K?ce.globalLeafNo=u:J&&(ce.globalGroupNo=l)),t.push(x),r[x]={node:g,index:ne,id:x,type:N,parent:de,parentType:de?r[de].type:null,children:k,childNo:S,caseId:fe,caseNo:ae,path:m.concat(x),lev:A,isLeaf:!W,isAtomicRule:re,isLocked:B||y,top:O?null:ve,isDefaultCase:G?!W:void 0,atomicRulesCountInCase:G?0:void 0,position:ce,collapsed:M,_top:ne,leaf:!W};var se=0,Te=0;O||(o+=1,se+=1,ue&&!M&&!Q&&(Te+=1),!R&&!G&&(J&&l++,re&&i++,K&&u++,s[N]=(s[N]||0)+1)),L&&re&&r[L].atomicRulesCountInCase++;var Oe=0,Re=0;if(ue){var Ve=0;W.map(function(Be,ar){if(Be){c(Be,m.concat(x),O||M,y||B,b||Q,A+1,fe,Ve);var nr=r[ar];Oe=Math.max(Oe,nr.depth||0),Re+=nr.height,Ve++}})}se+=Re,Te+=Oe;var Ue=t.length,Ye=Ue-ne,qe=O?null:ve+se;Object.assign(r[x],{depth:W?Te:void 0,_height:Ye,height:se,bottom:qe})}c(e,[],!1,!1,!1,0,null,null);for(var d=0;d<t.length;d++){var f=d>0?t[d-1]:null,p=d<t.length-1?t[d+1]:null,v=r[t[d]];v.prev=f,v.next=p}return{flat:t,items:r,cases:a}},Ep=function(e){if(!e)return-1;var t=0;function r(a,o,u){var i,l,s;typeof a.get=="function"?(i=a.get("id"),l=a.get("children1"),s=a.get("type")):(i=a.id,l=a.children1,s=a.type);var c=s=="rule_group";t++,l&&!c&&l.map(function(d,f){d&&r(d,o.concat(i),u+1)})}return r(e,[],0),t-1},Mo=function(e){if(!e)return-1;var t=0;function r(a,o,u){var i,l,s;typeof a.get=="function"?(i=a.get("id"),l=a.get("children1"),s=a.get("type")):(i=a.id,l=a.children1,s=a.type),s=="rule"||s=="rule_group"?t++:l&&l.map(function(c,d){c&&r(c,o.concat(i),u+1)})}return r(e,[],0),t},gu=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=e;function o(u,i){t&&u.path&&delete u.path,t&&!r&&i&&delete u.id;var l=u.properties;l&&l.operatorOptions==null&&delete l.operatorOptions;var s=u.children1;if(s){for(var c in s)s[c]&&o(s[c],c);r&&(u.children1=Object.values(s))}}return o(e,null),a},mu=function(e){var t=[],r=e.get("children1");return r&&r.map(function(a){var o=a.getIn(["properties","value"]),u;o&&o.size==1?(u=o.get(0),Array.isArray(u)&&u.length==0&&(u=null)):u=null,t=[].concat((0,Fe.A)(t),[u])}),t},_o=function(e){return!e.get("children1")||e.get("children1").size==0},Go=function(e,t){return e.getIn(Ce(t,"children1")).size>0},$o=function(e){if(e!=null&&e.toJS){var t,r=e==null||(t=e.toJS)===null||t===void 0?void 0:t.call(e);return r!=null&&r.func?e.toOrderedMap():r}else return e},Ap=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(e){var a=e;return a=a.toJS(),a=gu(a,t,r),a}},Uo=function(e){if(hu(e))return e;if(yu(e))return Dt(ha(e));if(typeof e=="string"&&e.startsWith('["~#iM"'))throw new Error("You are trying to load query in obsolete serialization format (Immutable string) which is not supported in versions starting from 2.1.17");if(typeof e=="string")return Dt(ha(JSON.parse(e)));throw new Error("Can't load tree!")},hu=function(e){return be.Map.isMap(e)},yu=function(e){return(0,Fr.A)(e)=="object"&&(e.type=="group"||e.type=="switch_group")};function ha(n){var e=(0,be.fromJS)(n,function(t,r,a){var o=a&&a.length>3&&a[a.length-1]==="value"&&a[a.length-3]==="args",u=a&&a.length>3&&a[a.length-1]==="value"&&a[a.length-2]==="properties",i;if(t=="properties"){i=r.toOrderedMap();for(var l=0;l<2;l++){var s,c,d;((s=i.get("value"))===null||s===void 0||(c=(d=s).get)===null||c===void 0?void 0:c.call(d,l))===null&&(i=i.setIn(["value",l],void 0))}}else o?i=$o(r):(a?u:t=="value")&&be.default.Iterable.isIndexed(r)?i=r.map($o).toList():t=="asyncListValues"?i=r.toJS():t=="children1"&&be.default.Iterable.isIndexed(r)?i=new be.default.OrderedMap(r.map(function(f){return[f?.get("id")||cr(),f]})):i=be.default.Iterable.isIndexed(r)?r.toList():r.toOrderedMap();return i});return e}var Ou=h(87695),Lp=h(95093),$n=h.n(Lp);function bu(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=wp(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function wp(n,e){if(n){if(typeof n=="string")return Su(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Su(n,e)}}function Su(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Fu(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Ln(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Fu(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Fu(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var jp=function(e){return Array.from(new Set(e))},sb=function(e){return e.reduce(function(t,r){var a=_slicedToArray(r,2),o=a[0],u=a[1];return Ln(Ln({},t),{},_defineProperty({},o,u))},{})},Bo=function(e){return{errors:[],settings:e?.settings}},Rp=function(e,t){return Cu(e,t,!1)},Cu=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=Bo();a.settings={allowUnknownFields:!1,returnErrors:r};var o=kt(t,void 0,!1),u=Pp(o),i=e?Ka(e,u,o,"rule",a):void 0;i&&i.type!="group"&&(i=Wo(i,o));var l=i?Uo(i):void 0;return r?[l,a.errors]:(a.errors.length&&console.warn("Errors while importing from JsonLogic:",a.errors),l)},Pp=function(e){var t={};for(var r in e.operators){var a=e.operators[r];if(typeof a.jsonLogic=="string"){var o=(a._jsonLogicIsRevArgs?"#":"")+a.jsonLogic+"/"+kr(a);t[o]||(t[o]=[]),t[o].push(r)}else if(typeof a.jsonLogic2=="string"){var u=a.jsonLogic2+"/"+kr(a);t[u]||(t[u]=[]),t[u].push(r)}}var i={};for(var l in e.conjunctions){var s=e.conjunctions[l],c=s.jsonLogicConj||l.toLowerCase();i[c]=l}var d={},f=bu(qn(e)),p;try{for(f.s();!(p=f.n()).done;){var v=(0,Le.A)(p.value,2),g=v[0],m=v[1],O=void 0;m.jsonLogicIsMethod?O="#"+m.jsonLogic:typeof m.jsonLogic=="string"&&(O=m.jsonLogic),O&&(d[O]||(d[O]=[]),d[O].push(g))}}catch(L){f.e(L)}finally{f.f()}var y=e.settings.jsonLogic,b=y.groupVarKey,A=y.altVarKey;return{operators:t,conjunctions:i,funcs:d,varKeys:["var",b,A]}},Ka=function n(e,t,r,a,o){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1,i=arguments.length>6?arguments[6]:void 0,l=arguments.length>7?arguments[7]:void 0,s=arguments.length>8&&arguments[8]!==void 0?arguments[8]:null,c=arguments.length>9&&arguments[9]!==void 0?arguments[9]:!1,d,f;ct(e)&&(d=Object.keys(e)[0],f=e[d],Array.isArray(f)||(f=[f]));var p,v=o.errors.length,g=r.settings.jsonLogic.lockedOp,m=d=="!"&&f.length==1&&f[0]&&ct(f[0])&&t.varKeys.includes(Object.keys(f[0])[0]),O=d=="!"&&!m,y=g&&d==g;y?p=n(f[0],t,r,a,o,u,i,l,s,!0):O?p=n(f[0],t,r,a,o,!u,i,l,s):a=="val"?p=Tu(d,f,t,r,u,o,s)||Eu(d,f,t,r,u,i,o,s)||xp(e,i,l,r,o):a=="rule"&&(p=Au(d,f,t,r,u,o,s,!1)||Mp(d,f,t,r,u,o,s));var b=o.errors.length;return d!="!"&&p===void 0&&b==v&&o.errors.push("Can't parse logic ".concat(JSON.stringify(e))),y&&(p.properties.isLocked=!0),p},xp=function(e,t,r,a,o){var u;if(e===void 0&&(e=t?.defaultValue),e!==void 0){var i=a.widgets[r||t?.mainWidget],l=t?.type;if(l&&!i){o.errors.push("No widget for type ".concat(l));return}if(ct(e)){o.errors.push("Unexpected logic in value: ".concat(JSON.stringify(e)));return}if(l=="time"&&typeof e=="number"){var s=Math.floor(e/60/60)%24,c=Math.floor(e/60)%60,d=e%60,f=i.valueFormat;if(f){var p=new Date(e);p.setMilliseconds(0),p.setHours(s),p.setMinutes(c),p.setSeconds(d),e=$n()(p).format(f)}else e="".concat(s,":").concat(c,":").concat(d)}if(["date","datetime"].includes(l)&&e&&!(e instanceof Date))try{var v=new Date(e);v instanceof Date&&v.toISOString()===e&&(e=v)}catch{o.errors.push("Can't convert value ".concat(e," as Date")),e=void 0}if(e instanceof Date&&t){var g=i.valueFormat;g&&(e=$n()(e).format(g))}var m;if(e&&t!==null&&t!==void 0&&(u=t.fieldSettings)!==null&&u!==void 0&&u.asyncFetch){var O=Array.isArray(e)?e:[e];m=O}return{valueSrc:"value",value:e,valueType:i?.type,asyncListValues:m}}},Tu=function(e,t,r,a,o,u){var i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;if(r.varKeys.includes(e)&&typeof t[0]=="string"){var l,s=eo(a,t[0],i),c=je(a,s);if(!c&&!((l=u.settings)!==null&&l!==void 0&&l.allowUnknownFields)){u.errors.push("No config for field ".concat(s));return}return{valueSrc:"field",value:s,valueType:c?.type}}},Ip=function(e,t,r,a,o){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,l=arguments.length>7?arguments[7]:void 0,s=arguments.length>8&&arguments[8]!==void 0?arguments[8]:null,c=Object.keys(t)[0],d=Object.values(t)[0],f=function(J,G){return Vp(J,G,a,o,u,l,s)||Dp(J,G,a,o,u,i,l,s)},p=l.errors.length,v,g,m,O,y=f(c,d);if(y&&(v=y.field,g=y.fieldSrc),e&&(O=!0,m=r[0],r=[]),c=="reduce"&&Array.isArray(d)&&d.length==3){var b=d,A=(0,Le.A)(b,3),L=A[0],S=A[1],R=A[2];if(ct(L)&&R==0&&ct(S)&&Array.isArray(S["+"])&&S["+"][0]==1&&ct(S["+"][1])&&S["+"][1].var=="accumulator")if(c=Object.keys(L)[0],d=Object.values(L)[0],c=="filter"){var N=d,M=(0,Le.A)(N,2),x=M[0],W=M[1];if(ct(x)){c=Object.keys(x)[0],d=Object.values(x)[0];var B=f(c,d);B&&(v=B.field,g=B.fieldSrc,m=W,O=!0)}}else{var k=f(c,d);k&&(v=k.field,g=k.fieldSrc,O=!0)}}var Q=l.errors.length;if(!v&&Q==p&&l.errors.push("Unknown LHS ".concat(JSON.stringify(t))),!!v)return{field:v,fieldSrc:g,having:m,isGroup:O,args:r}},Vp=function(e,t,r,a,o,u){var i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Array.isArray(t)||(t=[t]);var l=Tu(e,t,r,a,o,u,i);if(l)return{fieldSrc:"field",field:l.value}},Dp=function(e,t,r,a,o){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,i=arguments.length>6?arguments[6]:void 0,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null,s=Eu(e,t,r,a,o,u,i,l);if(s)return{fieldSrc:"func",field:s.value}},Eu=function(e,t,r,a,o){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,i=arguments.length>6?arguments[6]:void 0,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null;if(e){var s,c,d,f=e=="method";if(f){var p,v,g=(0,Ou.A)(t);p=g[0],s=g[1],v=g.slice(2),c=[p].concat((0,Fe.A)(v))}else s=e,c=t;var m=(f?"#":"")+s,O=u?.type||u?.returnType,y=(r.funcs[m]||[]).filter(function(G){return u?_r(a,G).returnType==O:!0});if(y.length)d=y[0];else{var b=(0,te.A)({},e,t),A=bu(qn(a)),L;try{for(A.s();!(L=A.n()).done;){var S=(0,Le.A)(L.value,2),R=S[0],N=S[1];if(N.jsonLogicImport&&(!O||N.returnType==O)){var M=void 0;try{M=N.jsonLogicImport(b)}catch{}M&&(d=R,c=M)}}}catch(G){A.e(G)}finally{A.f()}}if(d&&d){var x=_r(a,d),W=Object.keys(x.args||{}),B=c.reduce(function(G,re,ue){var de=W[ue],fe=x.args[de],ae;return fe&&(ae=Ka(re,r,a,"val",i,!1,fe,null,l)),ae!==void 0?Ln(Ln({},G),{},(0,te.A)({},de,ae)):G},{});for(var k in x.args){var Q=x.args[k],K=B[k];if(K===void 0){if(K=Q?.defaultValue,K!==void 0){var J;K={value:K,valueSrc:(J=K)!==null&&J!==void 0&&J.func?"func":"value",valueType:Q.type}}if(K===void 0){if(!(Q!=null&&Q.isOptional)){i.errors.push("No value for arg ".concat(k," of func ").concat(d));return}}else B[k]=K}}return{valueSrc:"func",value:{func:d,args:B},valueType:x.returnType}}}},Au=function(e,t,r,a,o,u){var i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,s=r.conjunctions[e],c=a.settings.fieldSeparator;if(s){var d="group",f=t.map(function(b){return Ka(b,r,a,"rule",u,!1,null,null,i)}).filter(function(b){return b!==void 0}).reduce(function(b,A){return Ln(Ln({},b),{},(0,te.A)({},A.id,A))},{}),p=Object.values(f).map(function(b){var A,L;return(b==null||(A=b.properties)===null||A===void 0?void 0:A.fieldSrc)=="field"&&(b==null||(L=b.properties)===null||L===void 0?void 0:L.field)}).filter(function(b){var A;return b==null||(A=b.includes)===null||A===void 0?void 0:A.call(b,c)}),v=Object.fromEntries(jp(p).map(function(b){var A=b.split(c),L=Object.fromEntries(A.slice(0,-1).map(function(S,R,N){return[].concat((0,Fe.A)(N.slice(0,R)),[S])}).map(function(S){return[S.join(c),je(a,S)]}).filter(function(S){var R=(0,Le.A)(S,2),N=R[0],M=R[1];return M?.type=="!group"}));return[b,Object.keys(L)]})),g={conjunction:s,not:o},m=cr(),O={},y={};return Object.entries(f).map(function(b){var A=(0,Le.A)(b,2),L=A[0],S=A[1];if(S?.type=="group"||S?.type=="rule_group")O[L]=S;else{var R,N=S==null||(R=S.properties)===null||R===void 0?void 0:R.field,M=v[N]||[],x=M[M.length-1];if(!x)S&&(O[L]=S);else{var W=O,B=Pr(i,a),k=Pr(x,a),Q=pa(B,k.slice(0,B.length));Q||(B=[]);var K=x.split(c).slice(B.length).map(function(J,G,re){return[].concat((0,Fe.A)(B),(0,Fe.A)(re.slice(0,G)),[J]).join(c)}).map(function(J){return{f:J,fc:je(a,J)||{}}}).filter(function(J){var G=J.fc;return G.type!="!struct"});K.map(function(J,G){var re=J.f,ue=J.fc,de=y[re];de||(de=cr(),y[re]=de,W[de]={type:"rule_group",id:de,children1:{},properties:{conjunction:s,not:!1,field:re,fieldSrc:"field",mode:ue.mode}}),W=W[de].children1}),W[L]=S}}}),{type:d,id:m,children1:O,properties:g}}},Np=function(e,t,r,a,o){if(e)return{type:"rule_group",id:cr(),children1:(0,te.A)({},e.id,e),properties:{conjunction:o||Ha(a,r),not:!1,field:t}}},Wo=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return{type:"group",id:cr(),children1:(0,te.A)({},e.id,e),properties:{conjunction:Ht(t),not:r}}},kp=function(e,t,r,a,o,u,i){var l=Bo(i),s=Lu(e,t,r,a,o,u,!1,l);if(s||(s=Lu(e,t,r,a,o,u,!0,Bo(i))),!s){i.errors.push(l.errors.join("; ")||"Unknown op ".concat(e,"/").concat(t));return}return s},Lu=function(e,t,r,a,o,u,i,l){var s,c,d=(e=="all"||e=="some")&&ct(r[1])&&Object.keys(r[1])[0]=="in"&&((s=r[1].in[0])===null||s===void 0?void 0:s.var)==="",f=!d&&u.settings.groupOperators.includes(e),p=["==","!="],v=f?0:t-1;f?v=0:p.includes(e)&&v==1&&r[1]===null&&(t=1,v=0,r=[r[0]]);var g=e+"/"+v,m=o.operators[(i?"#":"")+g];if(m){var O,y=[],b=["<","<=",">",">="];if(b.includes(e)&&t==3)O=r[1],y=[r[0],r[2]];else if(i)O=r[1],y=[r[0]];else{var A=r,L=(0,Ou.A)(A);O=L[0],y=L.slice(1)}if(!ct(O)){l.errors.push("Incorrect operands for ".concat(e,": ").concat(JSON.stringify(r)));return}var S=Ip(f,O,y,o,u,null,null,l,a);if(S){var R=S.field,N=S.fieldSrc,M=S.having,x=S.isGroup,W=S.args,B=je(u,R);if(!B&&!((c=l.settings)!==null&&c!==void 0&&c.allowUnknownFields)){l.errors.push("No config for LHS ".concat(R));return}var k=m[0];if(m.length>1&&B&&B.operators){if(m=m.filter(function(Q){return B.operators.includes(Q)}),m.length==0){l.errors.push("No corresponding ops for LHS ".concat(R));return}k=m[0]}return{field:R,fieldSrc:N,fieldConfig:B,opKey:k,args:W,having:M}}}},Mp=function n(e,t,r,a,o,u){var i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;if(e){var l=t.length;if((e=="all"||e=="some")&&ct(t[1])){var s,c=Object.keys(t[1])[0],d=((s=t[1][c][0])===null||s===void 0?void 0:s.var)==="";c=="in"&&d&&(t=[t[0],t[1][c][1]],e=e+"-"+c)}var f=kp(e,l,t,i,r,a,u);if(f){var p=f.field,v=f.fieldSrc,g=f.fieldConfig,m=f.opKey,O=f.args,y=f.having,b=a.operators[m],A=g?.showNot!==void 0?g.showNot:a.settings.showNot,L=!0,S,R,N=!1;if(g?.type=="!group"&&y){S=Object.keys(y)[0],R=y[S],Array.isArray(R)||(R=[R]);var M=S=="!"&&R.length==1&&R[0]&&ct(R[0])&&r.varKeys.includes(Object.keys(R[0])[0]);S=="!"&&!M&&(N=!0,y=y["!"],S=Object.keys(y)[0],R=y[S],Array.isArray(R)||(R=[R]))}o&&L&&b.reversedOp&&(o=!1,m=b.reversedOp,b=a.operators[m]);var x=Ar(a,p,m,null),W=O.map(function(G){return Ka(G,r,a,"val",u,!1,g,x,i)});if(!W.filter(function(G){return G===void 0}).length){var B,k=g?.type;if((k==="!group"||k==="!struct")&&(k=null),g?.type=="!group"&&y){if(r.conjunctions[S]!==void 0)B=Au(S,R,r,a,N,u,p,!0),N=!1;else{var Q=n(S,R,r,a,N,u,p);N=!1,B=Np(Q,p,g,a,r.conjunctions.and)}if(!B)return;B.type="rule_group",Object.assign(B.properties,{field:p,mode:g.mode,operator:m}),g.mode=="array"&&Object.assign(B.properties,{value:W.map(function(G){return G.value}),valueSrc:W.map(function(G){return G.valueSrc}),valueType:W.map(function(G){return G.valueType})}),o&&(B=Wo(B,a,o))}else if(g?.type=="!group"&&!y)B={type:"rule_group",id:cr(),children1:{},properties:{conjunction:Ha(a,g),not:o,mode:g.mode,field:p,operator:m}},g.mode=="array"&&Object.assign(B.properties,{value:W.map(function(G){return G.value}),valueSrc:W.map(function(G){return G.valueSrc}),valueType:W.map(function(G){return G.valueType})});else{var K=W.map(function(G){return G.asyncListValues}).filter(function(G){return G!=null}),J=K.length?K[0]:void 0;B={type:"rule",id:cr(),properties:Ln({field:p,fieldSrc:v,operator:m,value:W.map(function(G){return G.value}),valueSrc:W.map(function(G){return G.valueSrc}),valueType:W.map(function(G){return G.valueType})},J?{asyncListValues:J}:{})},o&&(B=Wo(B,a,o))}return B}}}},_p=h(21450),Gp=h(61526),$p=h.n(Gp),yn=$p();yn.trim=function(n){return n.charAt(0)=="'"?n.substring(1,n.length-1):n},yn.escapeLike=function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=yn.escape(n);return r=yn.trim(r),r=r.replace(/[%_]/g,"\\$&"),r=(e?"%":"")+r+(t?"%":""),r="'"+r+"'",r};var wu=function(e){var t="''",r=e?.type;return r=="date"?t="'0000-00-00'":r=="datetime"?t="'0000-00-00 00:00'":r=="time"?t="'00:00'":r=="number"&&(t="0"),t},ju=function(e){var t="",r=e?.type;return r=="number"&&(t=0),t},Up=function(e){return"'"+e.replace(/'/g,"''")+"'"},Bp=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r,a,o=["int","float"];e.map(function(l){if(l!=null){if(typeof l=="string")a="String";else if(typeof l=="number")a=Number.isInteger(l)?"int":"float";else throw new Error("spelEscape: Can't use value ".concat(l," in array"));if(!r)r=a;else if(r!=a)if(o.includes(r)&&o.includes(a))r="float";else throw new Error("spelEscape: Can't use different types in array: found ".concat(r," and ").concat(a))}}),r||(r="String");var u;r=="float"?u=e.map(function(l){return Un(l,!0)}):u=e.map(function(l){return Un(l)});var i;return t?i="new ".concat(r,"[]{").concat(u.join(", "),"}"):i="{".concat(u.join(", "),"}"),i},Ru=function(e){return"".concat(e,".?[true]")},Un=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(e==null)return"null";switch((0,Fr.A)(e)){case"boolean":return e?"true":"false";case"number":return!Number.isFinite(e)||isNaN(e)?void 0:e+(!Number.isInteger(e)||t?"f":"");case"object":if(Array.isArray(e))return Bp(e,r);throw new Error("spelEscape: Object is not supported");default:return Up(e)}},Wp=function(e){return e&&Array.isArray(e)&&e.length?e.map(function(t){if(t.type=="const")return Un(t.value);if(t.type=="property")return""+t.value;if(t.type=="variable")return"#"+t.value}).filter(function(t){return t!=null}).join(" + "):"null"},Kp=function(e){if(e==null)return[void 0,[]];var t=[],r=e.valueType=="case_value"?e.value:[e],a=r.map(function(o){if(o.valueSrc=="value")return o.value===null?void 0:{type:"const",value:o.value};if(o.valueSrc=="field")return{type:o.isVariable?"variable":"property",value:o.value};t.push("Unsupported valueSrc ".concat(o.valueSrc," in concatenation"))}).filter(function(o){return o!=null});return[a,t]},Pu=function(e){return e==null?"NULL":e.toString()};function xu(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Hp(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function Hp(n,e){if(n){if(typeof n=="string")return Iu(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Iu(n,e)}}function Iu(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Vu(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Du(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Vu(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Vu(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Nu="${0}.compareTo(${1})",zp={datetime:!0,time:!0,date:!0},Jp=function(e,t){return ku(e,t,!1)},ku=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a={errors:[]},o=kt(t,void 0,!1),u=Mu(e,o,a,null);return r?[u,a.errors]:(a.errors.length&&console.warn("Errors while exporting to SpEL:",a.errors),u)},Mu=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(e){var o=e.get("type");if(o==="group"||o==="rule_group")return Gu(e,t,r,a);if(o==="rule")return Yp(e,t,r,a);if(o=="switch_group")return qp(e,t,r,a);if(o=="case_group")return _u(e,t,r,a)}},_u=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=e.get("type");if(o!="case_group"){r.errors.push("Unexpected child of type ".concat(o," inside switch"));return}var u=e.get("properties")||new be.Map,i=Ko(t,u,r,null,a,"!case_value"),l=(0,Le.A)(i,3),s=l[0],c=l[1],d=l[2],f=Gu(e,t,r,a);return[f,s]},qp=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=e.get("properties")||new be.Map,u=e.get("children1");if(u){var i=u.map(function(m){return _u(m,t,r,null)}).filter(function(m){return typeof m<"u"}).valueSeq().toArray();if(i.length){if(i.length==1&&!i[0][0])return i[0][1];for(var l=[],s=0;s<i.length;s++)s!=i.length-1&&!i[s][0]?r.errors.push("No condition for case ".concat(s)):(l.push(i[s]),s==i.length-1&&i[s][0]&&l.push([void 0,null]));for(var c="",d="",f=0;f<l.length;f++){var p=(0,Le.A)(l[f],2),v=p[0],g=p[1];g==null&&(g="null"),v==null&&(v="true"),f!=l.length-1?(c+="(".concat(v," ? ").concat(g," : "),d+=")"):c+="".concat(g)}return c+d}}},Gu=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=e.get("type"),u=e.get("properties")||new be.Map,i=u.get("mode"),l=e.get("children1")||new be.List,s=u.get("field"),c=u.get("conjunction");c||(c=Ht(t));var d=t.conjunctions[c],f=u.get("not"),p=o==="rule_group",v=p&&i!="struct",g=v?s:a,m=je(t,g)||{},O=m.isSpelArray,y=t.settings.fieldSeparator,b=u.get("operator");!b&&(!i||i=="some")&&(b="some");var A=Uu(t,b,s),L=A!=b,S=b&&dr(t,A,s)||null,R=p&&(!A||S.cardinality==0),N=Ko(t,u,r,A,a,null),M=(0,Le.A)(N,3),x=M[0],W=M[1],B=M[2],k=l.map(function(ne){return Mu(ne,t,r,g)}).filter(function(ne){return typeof ne<"u"});if(v&&!R){if(x==null)return}else if(!k.size)return;var Q=p,K=k.size?d.spelFormatConj(k,c,f,Q):null,J;if(v){var G=zo(r,t,s,a),re=y||".",ue=re+(O?"length":"size()"),de="".concat(G).concat(ue),fe=K?"".concat(G,".?[").concat(K,"]").concat(ue):de,ae=R?de:x;J=$u(r,t,u,fe,ae,A,W,B,L)}else J=K;return J},Qp=function(e,t,r){var a=t.spelOp;if(a){var o=a.includes("${0}"),u=zp[r],i=a,l,s=kr(t);return u?l=function(d,f,p,v,g,m,O,y){var b=Nu.replace(/\${(\w+)}/g,function(A,L){return L==0?d:s>1?p[L-1]:p});return"".concat(b," ").concat(i," 0")}:o?l=function(d,f,p,v,g,m,O,y){return a.replace(/\${(\w+)}/g,function(b,A){return A==0?d:s>1?p[A-1]:p})}:s==0?l=function(d,f,p,v,g,m,O,y){return"".concat(d," ").concat(i)}:s==1&&(l=function(d,f,p,v,g,m,O,y){return"".concat(d," ").concat(i," ").concat(p)}),l}},$u=function(e,t,r,a,o,u,i,l){var s=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,c=r.get("field"),d=dr(t,u,c)||{},f=je(t,c)||{},p=r.get("operatorOptions"),v=d.spelFormatOp||Qp(u,d,l);if(!v){e.errors.push("Operator ".concat(u," is not supported"));return}var g=[a,u,o,i,l,Cr()(d,Mn),p,f],m;return m=v.call.apply(v,[t.ctx].concat(g)),s&&(m=t.settings.spelFormatReverse(m)),m===void 0&&e.errors.push("Operator ".concat(u," is not supported for value source ").concat(i)),m},Uu=function(e,t,r){if(t){var a=dr(e,t,r)||{},o=a.reversedOp,u=dr(e,o,r)||{},i=!1,l=a.spelOp||a.spelFormatOp,s=u.spelOp||u.spelFormatOp;if(!(!l&&!s)){if(!l&&s){i=!0;var c=[o,t];t=c[0],o=c[1];var d=[u,a];a=d[0],u=d[1]}return t}}},Yp=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=e.get("properties")||new be.Map,u=o.get("field"),i=o.get("fieldSrc"),l=o.get("operator");if(!(u==null||l==null)){var s=Uu(t,l,u);if(!s){r.errors.push("Operator ".concat(l," is not supported"));return}var c=s!=l,d=Ko(t,o,r,s,a,null),f=(0,Le.A)(d,3),p=f[0],v=f[1],g=f[2];if(p!==void 0){var m=Xp(r,t,u,i,a);if(m!==void 0){var O=$u(r,t,o,m,p,s,v,g,c);return O}}}},Xp=function(e,t,r,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;return a==="func"?Bu(e,t,r,o):zo(e,t,r,o)},Ko=function(e,t,r,a,o){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,i=t.get("field"),l=t.get("valueSrc"),s=t.get("valueType");(u=="!case_value"||s&&s.get(0)=="case_value")&&(i="!case_value");var c=je(e,i)||{},d=dr(e,a,i)||{},f=kr(d),p=t.get("value"),v=t.get("asyncListValues"),g=[],m=[],O;if(p!=null){var y=p.map(function(A,L){var S=l?l.get(L):null,R=s?s.get(L):null,N=Rn(A,S,e),M=Ar(e,i,a,S),x=Cr()(at(e,i,a,M,S),["factory"]),W=Ho(r,e,N,S,R,x,c,a,d,o,v);return W!==void 0&&(g.push(S),m.push(R)),W}),b=y.filter(function(A){return A===void 0}).size>0;y.size<f||b||(O=f>1?y.toArray():f==1?y.first():null)}return[O,g.length>1?g:g[0],m.length>1?m:m[0]]},Ho=function(e,t,r,a,o,u,i,l,s){var c=arguments.length>9&&arguments[9]!==void 0?arguments[9]:null,d=arguments.length>10?arguments[10]:void 0;if(r!==void 0){var f;if(a==="field")f=zo(e,t,r,c);else if(a==="func")f=Bu(e,t,r,c);else if(typeof u.spelFormatValue=="function"){var p=u.spelFormatValue,v=[r,Du(Du({},Bt()(i,["fieldSettings","listValues"])),{},{asyncListValues:d}),Cr()(u,An)];if(l&&(v.push(l),v.push(s)),a=="field"){var g=je(t,r)||{};v.push(g)}f=p.call.apply(p,[t.ctx].concat(v))}else f=Un(r);return f}},zo=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(r){var o=t.settings.fieldSeparator,u=je(t,r)||{},i=Pr(r,t),l=us(r,t,a),s=t.settings.formatSpelField,c=ln(r,t,e,a),d=l.map(function(p){var v=(0,Le.A)(p,3),g=v[0],m=v[1],O=v[2],y;O&&(O.type=="!struct"||O.type=="!group"&&O.mode=="struct"?y=m.isSpelMap?"map":"class":O.type=="!group"?y=m.isSpelItemMap?"[map]":"[class]":y="class");var b=m?.isSpelVariable;return{key:g,parent:y,isSpelVariable:b,fieldSeparator:o}}),f=s.call(t.ctx,c,a,i,d,u,t);return f}},Bu=function(e,t,r){var a,o,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=(a=r.get)===null||a===void 0?void 0:a.call(r,"func"),l=(o=r.get)===null||o===void 0?void 0:o.call(r,"args"),s=_r(t,i);if(!s){e.errors.push("Func ".concat(i," is not defined in config"));return}var c={},d=[],f=[];for(var p in s.args){var v,g,m=s.args[p],O=je(t,m),y=m.defaultValue,b=m.isOptional,A=y!=null&&y.func?"func":"value",L=l?l.get(p):void 0,S=L?L.get("value"):void 0,R=L?L.get("valueSrc"):void 0;R!=="func"&&(v=S)!==null&&v!==void 0&&v.toJS&&(S=S.toJS());var N=L?L.get("asyncListValues"):void 0,M=(g=m.spelEscapeForFormat)!==null&&g!==void 0?g:!0,x=null,W=Ar(t,m,x,R),B=Cr()(at(t,m,x,W,R),["factory"]),k=Ho(e,t,S,R,m.type,B,O,null,null,u,N);if(S!=null&&k===void 0){R!="func"&&e.errors.push("Can't format value of arg ".concat(p," for func ").concat(i));return}var Q=void 0;if(k===void 0&&!b&&y!=null){var K=Ar(t,m,x,A),J=Cr()(at(t,m,x,K,A),["factory"]);if(Q=Ho(e,t,y,A,m.type,J,O,null,null,u,N),Q===void 0){A!="func"&&e.errors.push("Can't format default value of arg ".concat(p," for func ").concat(i));return}}var G=k??Q;if(G!==void 0){var re;if(d.length){var ue=xu(d),de;try{for(ue.s();!(de=ue.n()).done;){var fe=de.value;c[fe]=void 0}}catch(Re){ue.e(Re)}finally{ue.f()}d=[]}c[p]=M?G:(re=S)!==null&&re!==void 0?re:y}else b||f.push(p),d.push(p)}if(!f.length){var ae;if(typeof s.spelFormatFunc=="function"){var ne=s.spelFormatFunc,ve=[c];ae=ne.call.apply(ne,[t.ctx].concat(ve))}else if(s.spelFunc){ae=s.spelFunc.replace(/\${(\w+)}/g,function(Re,Ve){var Ue;return(Ue=c[Ve])!==null&&Ue!==void 0?Ue:Re});var ce=Object.keys(s.args||{}).reverse().filter(function(Re){return!!s.args[Re].isOptional}),se=xu(ce),Te;try{for(se.s();!(Te=se.n()).done;){var Oe=Te.value;if(c[Oe]!=null)break;ae=ae.replace(new RegExp("(, )?\\${"+Oe+"}","g"),"")}}catch(Re){se.e(Re)}finally{se.f()}ae=ae.replace(/\${(\w+)}/g,"null")}else e.errors.push("Func ".concat(i," is not supported"));return ae}};function Wt(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Zp(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function Zp(n,e){if(n){if(typeof n=="string")return Wu(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Wu(n,e)}}function Wu(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Ku(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function tr(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ku(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Ku(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Hu={number:"number",string:"text",boolean:"boolean",null:"null"},zu={String:"text"},ev="multiselect",rv=function(e){return["length"].includes(e)},Ju=function(e){return(0,Fr.A)(e)=="object"&&e!==null&&!Array.isArray(e)},tv=function(e,t){return qu(e,t,!0)},qu=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a={errors:[]},o=kt(t,void 0,!1),u=ov(o),i,l,s=void 0;try{var c=_p.SpelExpressionEvaluator.compile(e);i=c._compiledExpression}catch(f){a.errors.push(f)}i&&(l=nv(i,a),hn.debug("convertedObj:",l,a),s=Jo(l,u,o,a),s&&s.type!="group"&&s.type!="switch_group"&&(s=ya(s,o,l.not)),hn.debug("jsTree:",s));var d=s?Uo(s):void 0;return r?[d,a.errors]:(a.errors.length&&console.warn("Errors while importing from SpEL:",a.errors),d)},nv=function n(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,a=e.getType(),o=e.getChildren().map(function(k){return n(k,t,e)});if((a=="op-or"||a=="op-and")&&(o=o.reduce(function(k,Q){var K=Q.type==a&&!Q.not,J=K?Q.children:[Q];return[].concat((0,Fe.A)(k),(0,Fe.A)(J))},[])),a=="op-not")return o.length!=1&&t.errors.push("Operator NOT should have 1 child, but got ".concat(o.length,"}")),tr(tr({},o[0]),{},{not:!o[0].not});if(a=="compound"){o=o.filter(function(k){var Q=k.type=="selection"&&k.children.length==1&&k.children[0].type=="boolean"&&k.children[0].val==!0;return!Q});var u=o.find(function(k){return k.type=="selection"});u&&u.children.length!=1&&t.errors.push("Selection should have 1 child, but got ".concat(u.children.length));var i=u?u.children[0]:null,l=o[o.length-1],s=l.type=="method"&&l.val.methodName=="size"||l.type=="!func"&&l.methodName=="size",c=l.type=="property"&&l.val=="length",d=o.filter(function(k){return k!==u&&k!==l}),f={type:"compound",children:d},p=(s||c)&&Qu(d)!=null;if(p)return{type:"!aggr",filter:i,source:f};if(o=o.filter(function(k){var Q=k.type=="variable"&&k.val=="this",K=k.type=="variable"&&k.val=="root";return!(Q||K)}),o=o.map(function(k){return k.type=="indexer"&&k.children.length==1?{type:"indexer",val:k.children[0].val,itype:k.children[0].type}:k}),l.type=="!func"){var v={},g=v;do{var m,O;Object.assign(g,l),o=o.filter(function(k){return k!==l}),l=o[o.length-1],((O=l)===null||O===void 0?void 0:O.type)=="!func"?(g.obj={},g=g.obj):o.length>1?g.obj={type:"compound",children:o}:g.obj=l}while(((m=l)===null||m===void 0?void 0:m.type)=="!func");return v}}var y;try{e.getRaw?y=e.getRaw():e.getValue.length==0&&(y=e.getValue())}catch(k){hn.error("[spel2js] Error in getValue()",k)}if(a=="ternary"&&(y=av(o)),(0,Fr.A)(y)==="object"&&y!==null&&(y.methodName||y.functionName)&&(y.args=y.args.map(function(k){return n(k,t,e)})),a=="list"&&(y=y.map(function(k){return n(k,t,e)}),!r&&y.length==1))return y[0];if(a=="constructorref"){var b=o.find(function(k){return k.type=="qualifiedidentifier"}),A=b?.val;if(!A){t.errors.push("Can't find qualifiedidentifier in constructorref children: ".concat(JSON.stringify(o)));return}var L=o.filter(function(k){return k.type!="qualifiedidentifier"});return{type:"!new",cls:A,args:L}}if(a=="typeref"){var S=o.find(function(k){return k.type=="qualifiedidentifier"}),R=S?.val;if(!R){t.errors.push("Can't find qualifiedidentifier in typeref children: ".concat(JSON.stringify(o)));return}var N=o.filter(function(k){return k.type!="qualifiedidentifier"});return{type:"!type",cls:R}}if(a=="function"||a=="method"){var M=y,x=M.functionName,W=M.methodName,B=M.args;return{type:"!func",methodName:x||W,isVar:a=="function",args:B}}return{type:a,children:o,val:y}},av=function(e){var t=[];function r(a){var o=(0,Le.A)(a,3),u=o[0],i=o[1],l=o[2];t.push([u,i]),l?.type=="ternary"?r(l.children):t.push([void 0,l])}return r(e),t},ov=function(e){var t={},r=function(K){var J=e.operators[K];if(J.spelOps)J.spelOps.forEach(function(re){var ue=re;t[ue]||(t[ue]=[]),t[ue].push(K)});else if(J.spelOp){var G=J.spelOp;t[G]||(t[G]=[]),t[G].push(K)}else hn.log("[spel] No spelOp for operator ".concat(K))};for(var a in e.operators)r(a);var o={};for(var u in e.conjunctions){var i=e.conjunctions[u],l=i.spelConj||u.toLowerCase();o[l]=u}var s={},c=Wt(qn(e)),d;try{var f=function(){var K=(0,Le.A)(d.value,2),J=K[0],G=K[1],re=[],ue=G.spelFunc;if(typeof ue=="string"){var de=Object.keys(G.args||{}).reverse().filter(function(se){return!!G.args[se].isOptional||G.args[se].defaultValue!=null}),fe=ue.replace(/\${(\w+)}/g,function(se,Te){return"?"}),ae=de.reduce(function(se,Te){return[].concat((0,Fe.A)(se),[[Te].concat((0,Fe.A)(se[se.length-1]||[]))])},[]).map(function(se){return ue.replace(/(?:, )?\${(\w+)}/g,function(Te,Oe){return se.includes(Oe)?"":Te}).replace(/\${(\w+)}/g,function(Te,Oe){return"?"})});re=[fe].concat((0,Fe.A)(ae))}var ne=Wt(re),ve;try{for(ne.s();!(ve=ne.n()).done;){var ce=ve.value;s[ce]||(s[ce]=[]),s[ce].push(J)}}catch(se){ne.e(se)}finally{ne.f()}};for(c.s();!(d=c.n()).done;)f()}catch(Q){c.e(Q)}finally{c.f()}var p={};for(var v in e.widgets){var g=e.widgets[v],m=g.spelImportFuncs,O=g.type;if(m){var y=Wt(m),b;try{for(y.s();!(b=y.n()).done;){var A=b.value;if(typeof A=="string"){var L=A.replace(/\${(\w+)}/g,function(Q,K){return"?"}),S=(0,Fe.A)(A.matchAll(/\${(\w+)}/g)).map(function(Q){var K=(0,Le.A)(Q,2),J=K[0],G=K[1];return G});p[L]||(p[L]=[]),p[L].push({w:v,argsOrder:S})}}}catch(Q){y.e(Q)}finally{y.f()}}}var R={};for(var N in e.operators){var M=e.operators[N],x=M.spelOp;if(x!=null&&x.includes("${0}")){var W=x.replace(/\${(\w+)}/g,function(Q,K){return"?"}),B=(0,Fe.A)(x.matchAll(/\${(\w+)}/g)).map(function(Q){var K=(0,Le.A)(Q,2),J=K[0],G=K[1];return G});R[W]||(R[W]=[]),R[W].push({op:N,argsOrder:B})}}var k=Nu.replace(/\${(\w+)}/g,function(Q,K){return"?"});return R[k]=[{op:"!compare",argsOrder:["0","1"]}],{operators:t,conjunctions:o,funcs:s,valueFuncs:p,opFuncs:R}},Jo=function n(e,t,r,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(e){var u,i=!0;if(e.type.indexOf("op-")===0||e.type==="matches")u=iv(e,t,r,a,o);else if(e.type=="!aggr"){var l,s=n(e.source,t,r,a,tr(tr({},e),{},{_groupField:o?._groupField})),c=n(e.filter,t,r,a,tr(tr({},e),{},{_groupField:s?.value}));((l=c)===null||l===void 0?void 0:l.type)=="rule"&&(c=ya(c,r,e.filter.not)),u={groupFilter:c,groupFieldValue:s},o||(u=void 0,a.errors.push("Unexpected !aggr in root"),i=!1)}else if(e.type=="ternary"){var d={};e.val.forEach(function(p){var v=(0,Le.A)(p,2),g=v[0],m=v[1],O=Xu(g,m,t,r,a,e);O&&(d[O.id]=O)}),u={type:"switch_group",id:cr(),children1:d,properties:{}}}if(!u&&i&&(u=Bn(e,t,r,a,o)),u&&!u.type&&!o){var f=Yu(e,t,r,a);f?u=f:(u=void 0,a.errors.push("Can't convert rule of type ".concat(e.type,", it looks like var/literal")))}return u}},iv=function n(e,t,r,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,u,i=e.type.startsWith("op-")?e.type.slice(3):e.type,l=(i=="minus"||i=="plus")&&e.children.length==1;if(l)return e.isUnary=!0,n(e.children[0],t,r,a,e);var s=i=="and"&&e.children.length==2&&e.children[0].type=="op-ge"&&e.children[1].type=="op-le",c=i=="or"&&e.children.length==2&&e.children[0].type=="op-lt"&&e.children[1].type=="op-gt",d=s||c;if(d){var f=(0,Le.A)(e.children[0].children,2),p=f[0],v=f[1],g=(0,Le.A)(e.children[1].children,2),m=g[0],O=g[1],y=pv(p,m,e,t,r,a,o);if(y){var b=v.val,A=O.val,L={type:"op-between",children:[p,v,O],not:c};return n(L,t,r,a,o)}}var S=t.operators[i];i=="eq"&&e.children[1].type=="null"?S=["is_null"]:i=="ne"&&e.children[1].type=="null"?S=["is_not_null"]:i=="le"&&e.children[1].type=="string"&&e.children[1].val==""?S=["is_empty"]:i=="gt"&&e.children[1].type=="string"&&e.children[1].val==""?S=["is_not_empty"]:i=="between"&&(S=["between"]);var R=function(){var Re,Ve=e.children.map(function(Ue){return Jo(Ue,t,r,a,tr(tr({},e),{},{_groupField:o?._groupField}))});return Ve.length>=2&&((Re=Ve)===null||Re===void 0||(Re=Re[0])===null||Re===void 0?void 0:Re.type)=="!compare"&&(Ve=Ve[0].children),Ve};if(i=="and"||i=="or"){var N={},M=R();M.forEach(function(Oe){if(Oe){var Re=cr();Oe.id=Re,Oe.type!=null?N[Re]=Oe:a.errors.push("Bad item in AND/OR: ".concat(JSON.stringify(Oe)))}}),u={type:"group",id:cr(),children1:N,properties:{conjunction:t.conjunctions[i],not:e.not}}}else if(S){var x,W,B=R(),k=B[0],Q=B.slice(1),K=k==null||(x=k.groupFieldValue)===null||x===void 0?void 0:x.value,J=(W=Q)===null||W===void 0?void 0:W[0],G=S[0];if(S.length>1){var re,ue,de=((re=B[0])===null||re===void 0?void 0:re.valueType)||((ue=B[1])===null||ue===void 0?void 0:ue.valueType),fe=k?.value,ae=S.map(function(Oe){return{op:Oe,widget:Ar(r,fe,Oe)}});if(hn.warn("[spel] Spel operator ".concat(i," can be mapped to ").concat(S,"."),"widgets:",ae,"vals:",B,"valueType=",de),i=="eq"||i=="ne"){var ne=ae.find(function(Oe){var Re=Oe.op,Ve=Oe.widget;return Ve&&Ve!="field"});ne&&(G=ne.op)}}k!=null&&k.groupFieldValue&&(J&&J.groupFieldValue&&J.groupFieldValue.valueSrc=="field"&&J.groupFieldValue.value==K?(G="all",Q=[]):G=="equal"&&J.valueSrc=="value"&&J.valueType=="number"&&J.value==0?(G="none",Q=[]):G=="greater"&&J.valueSrc=="value"&&J.valueType=="number"&&J.value==0&&(G="some",Q=[]));var ve=!0,ce=!1;if(e.not&&ve){var se=r.operators[G];se.reversedOp?(G=se.reversedOp,e.not=!1):ce=!0}if(k)if(k.groupFieldValue)k.groupFieldValue.valueSrc!="field"&&a.errors.push("Expected group field ".concat(JSON.stringify(k))),u=fv(k,G,Q,r,a);else{k.valueSrc!="field"&&k.valueSrc!="func"&&a.errors.push("Expected field/func at LHS, but got ".concat(JSON.stringify(k)));var Te=k.value;u=qo(r,a,Te,G,Q)}ce&&(u.type!=="group"?u=ya(u,r,e.not):u.properties.not=!u.properties.not)}else o||(u=Yu(e,t,r,a));return u},Qu=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=!1,o=e.map(function(u){if(u.type=="variable"||u.type=="property"||u.type=="indexer"&&u.itype=="string")return u.val;var i,l;a=!0,r&&(t==null||(i=t.errors)===null||i===void 0||(l=i.push)===null||l===void 0||l.call(i,"Unexpected item in field path compound: ".concat(JSON.stringify(u))))});return a?void 0:o},Bn=function n(e,t,r,a,o){if(e!=null){var u=r.settings.fieldSeparator;if(e.type=="variable"||e.type=="property"){var i=eo(r,e.val,o?._groupField),l=je(r,i),s=e.type=="variable";return{valueSrc:"field",valueType:l?.type,isVariable:s,value:i}}else if(e.type=="compound"){var c=Qu(e.children,a);if(c){var d,f=eo(r,c.join(u),o?._groupField),p=je(r,f),v=((d=e.children)===null||d===void 0||(d=d[0])===null||d===void 0?void 0:d.type)=="variable";return{valueSrc:"field",valueType:p?.type,isVariable:v,value:f}}}else if(Hu[e.type]){var g=e.val,m=Hu[e.type];return o!=null&&o.isUnary&&(g=-g),{valueSrc:"value",valueType:m,value:g}}else if(e.type=="!new"&&zu[e.cls.at(-1)]){var O=e.args.map(function(x){return n(x,t,r,a,e)}),y=O?.[0],b=zu[e.cls.at(-1)];return tr(tr({},y),{},{valueType:b})}else if(e.type=="list"){var A,L=e.val.map(function(x){return n(x,t,r,a,e)}),S=L.length?(A=L[0])===null||A===void 0?void 0:A.valueType:null,R=L.map(function(x){return x?.value}),N=ev;return{valueSrc:"value",valueType:N,value:R}}else if(e.type=="op-plus"&&o?.type=="ternary")return Zu(e,t,r,a);var M=sv(e,t,r,a,o);if(M!==void 0)return M;a.errors.push("Can't convert arg of type ".concat(e.type))}},uv=function(e){var t=[{s:"",params:[],objs:[]}];return lv(e,t),t.map(function(r){var a=r.s,o=r.params;return{s:a,params:o}}).reverse().filter(function(r){var a=r.s;return a!==""&&a!=="?"})},lv=function n(e,t){var r=[],a="",o=e.type,u=e.methodName,i=e.val,l=e.obj,s=e.args,c=e.isVar,d=e.cls,f=e.children,p=f?.[f.length-1],v=t[t.length-1];if(o==="!func"){for(var g=l;g;){var m,O=n(tr(tr({},g),{},{obj:null}),[{}]),y=(0,Le.A)(O,2),b=y[0],A=y[1];if(b!=="?"){var L={s:v.s,params:(0,Fe.A)(v.params),objs:(0,Fe.A)(v.objs)};v.objs.unshift("?"),v.params.unshift(g),t.push(L),v=t[t.length-1]}v.objs.unshift(b),(m=v.params).unshift.apply(m,(0,Fe.A)(A)),g=g.type==="!func"?g.obj:null}var S=Wt(t),R;try{for(S.s();!(R=S.n()).done;){var N,M=R.value;r=[].concat((0,Fe.A)(M?.params||[]),(0,Fe.A)(s||[])),a="",M!=null&&(N=M.objs)!==null&&N!==void 0&&N.length&&(a+=M.objs.join(".")+"."),a+=(c?"#":"")+u,a+="("+(s||[]).map(function(x){return"?"}).join(", ")+")",M.s=a,M.params=r}}catch(x){S.e(x)}finally{S.f()}}else o==="!new"?(r=s||[],a="new ".concat(d.join("."),"(").concat(r.map(function(x){return"?"}).join(", "),")")):o==="!type"?a="T(".concat(d.join("."),")"):o==="compound"&&p.type==="property"&&rv(p.val)?a=f.map(function(x){var W;if(x===p)return x.val;var B=n(tr(tr({},x),{},{obj:null}),[{}]),k=(0,Le.A)(B,2),Q=k[0],K=k[1];return(W=r).push.apply(W,(0,Fe.A)(K)),Q}).join("."):(r=[e],a="?");return v&&(v.s=a,v.params=r),[a,r]},sv=function(e,t,r,a,o){var u,i=function(J){return Bn(J,t,r,a,tr(tr({},e),{},{_groupField:o?._groupField}))},l=uv(e),s=l==null||(u=l[0])===null||u===void 0?void 0:u.s;l.length&&hn.debug("Signatures for ",e,":",s,l);var c=cv(e,t,r,a,o,l,i);if(c!==void 0)return c;var d=dv(e,t,r,a,o,l,i);if(d!==void 0)return d;var f,p,v,g=Wt(l),m;try{var O=function(){var J=m.value,G=J.s,re=J.params,ue=t.funcs[G];if(ue){f=ue[0],p=_r(r,f);var de=p,fe=de.spelFunc,ae=re.map(i),ne=(0,Fe.A)(fe.matchAll(/\${(\w+)}/g)).map(function(ve){var ce=(0,Le.A)(ve,2),se=ce[0],Te=ce[1];return Te});return v=Object.fromEntries(ne.map(function(ve,ce){return[ve,ae[ce]]})),1}};for(g.s();!(m=g.n()).done&&!O(););}catch(K){g.e(K)}finally{g.f()}if(!f){var y=Wt(qn(r)),b;try{for(y.s();!(b=y.n()).done;){var A=(0,Le.A)(b.value,2),L=A[0],S=A[1];if(S.spelImport){var R=void 0;try{R=S.spelImport(e)}catch{}if(R){f=L,p=_r(r,f),v={};for(var N in R)v[N]=i(R[N])}}}}catch(K){y.e(K)}finally{y.f()}}if(f){var M={};for(var x in p.args){var W=p.args[x],B=v[x];if(B===void 0)if(B=W?.defaultValue,B===void 0){if(!(W!=null&&W.isOptional)){a.errors.push("No value for arg ".concat(x," of func ").concat(f));return}}else{var k;B={value:B,valueSrc:(k=B)!==null&&k!==void 0&&k.func?"func":"value",valueType:W.type}}B&&(M[x]=B)}return{valueSrc:"func",value:{func:f,args:M},valueType:p.returnType}}var Q=e.methodName;Q&&a.errors.push("Signature ".concat(s," - failed to convert"))},cv=function(e,t,r,a,o,u,i){var l,s,c,d=[];for(var f in r.widgets){var p=r.widgets[f],v=p.spelImportFuncs;if(v)for(var g=0;g<v.length;g++){var m=v[g];if(Ju(m)){var O={};if(uu(m,e,O)){for(var y in O)O[y]=i(O[y]);d.push({s:"widgets.".concat(f,".spelImportFuncs[").concat(g,"]"),w:f,argsObj:O})}}}}var b=Wt(u),A;try{for(b.s();!(A=b.n()).done;){var L=A.value,S=L.s,R=L.params,N=t.valueFuncs[S]||[],M=Wt(N),x;try{var W=function(){var se=x.value,Te=se.w,Oe=se.argsOrder,Re=R.map(i),Ve=Object.fromEntries(Oe.map(function(Ue,Ye){return[Ue,Re[Ye]]}));d.push({s:S,w:Te,argsObj:Ve})};for(M.s();!(x=M.n()).done;)W()}catch(ce){M.e(ce)}finally{M.f()}}}catch(ce){b.e(ce)}finally{b.f()}for(var B=0,k=d;B<k.length;B++){var Q=k[B],K=Q.s,J=Q.w,G=Q.argsObj,re=r.widgets[J],ue=re.spelImportValue,de=re.type;c=J,s=K,l=[];for(var fe in G)["value"].includes(G[fe].valueSrc)||l.push("".concat(fe," has unsupported value src ").concat(G[fe].valueSrc));var ae=G.v.value;if(ue&&!l.length){var ne=ue.call(r.ctx,G.v,re,G),ve=(0,Le.A)(ne,2);ae=ve[0],l=ve[1],l&&!Array.isArray(l)&&(l=[l])}if(!l.length)return{valueSrc:"value",valueType:de,value:ae}}c&&l.length&&a.errors.push("Signature ".concat(s," - looks like convertable to ").concat(c,", but: ").concat(l.join("; ")))},dv=function(e,t,r,a,o,u,i){var l,s,c,d=Wt(u),f;try{for(d.s();!(f=d.n()).done;){var p=f.value,v=p.s,g=p.params,m=t.opFuncs[v]||[],O=Wt(m),y;try{var b=function(){var S,R=y.value,N=R.op,M=R.argsOrder,x=g.map(i);if(s=N,N==="!compare"){if(o.type.startsWith("op-")&&o.children.length==2&&o.children[1].type=="number"&&o.children[1].val===0)return{v:{type:"!compare",children:x}};l.push("Result of compareTo() should be compared to 0")}c=v,l=[];var W=r.operators[s],B=W.spelOp,k=W.valueTypes,Q=Object.fromEntries(M.map(function(re,ue){return[re,x[ue]]})),K=Q[0],J=Object.keys(Q).filter(function(re){return parseInt(re)>0}).map(function(re){return Q[re]}),G=(S=x.filter(function(re){return!!re}).find(function(re){var ue=re.valueSrc;return ue==="value"}))===null||S===void 0?void 0:S.valueType;if(k&&G&&!k.includes(G)&&l.push("Op supports types ".concat(k,", but got ").concat(G)),!l.length)return{v:qo(r,a,K,s,J,e)}},A;for(O.s();!(y=O.n()).done;)if(A=b(),A)return A.v}catch(L){O.e(L)}finally{O.f()}}}catch(L){d.e(L)}finally{d.f()}s&&l.length&&a.errors.push("Signature ".concat(c," - looks like convertable to ").concat(s,", but: ").concat(l.join("; ")))},qo=function(e,t,r,a,o,u){var i;if(!o.filter(function(y){return y===void 0}).length){var l=(i=r)!==null&&i!==void 0&&i.func?"func":"field";Ju(r)&&r.valueSrc&&(l=r.valueSrc,r=r.value);var s=je(e,r);if(!s){t.errors.push("No config for field ".concat(r));return}var c=!0,d=!1;if(u!=null&&u.not&&c){var f=e.operators[a];f.reversedOp?(a=f.reversedOp,u.not=!1):d=!0}var p=Ar(e,r,a),v=e.widgets[p||s.mainWidget],g=o.map(function(y){return y.asyncListValues}).filter(function(y){return y!=null}),m=g.length?g[0]:void 0,O={type:"rule",id:cr(),properties:tr({field:r,fieldSrc:l,operator:a,value:o.map(function(y){return y.value}),valueSrc:o.map(function(y){return y.valueSrc}),valueType:o.map(function(y){return y.valueSrc=="value"&&(v?.type||s?.type)||y.valueType})},m?{asyncListValues:m}:{})};return d&&(O=ya(O,e,u?.not),u!=null&&u.not&&(u.not=!1)),O}},fv=function(e,t,r,a,o){var u=e.groupFilter,i=e.groupFieldValue;if(i.valueSrc!="field")throw"Bad groupFieldValue: ".concat(JSON.stringify(i));var l=i.value,s=qo(a,o,l,t,r);if(s){var c=je(a,l),d=c?.mode,f;return u?.type==="group"?f=tr(tr({},u||{}),{},{type:"rule_group",properties:tr(tr(tr({},s.properties),u?.properties||{}),{},{mode:d})}):u?f=tr(tr({},s||{}),{},{type:"rule_group",children1:[u],properties:tr(tr({},s.properties),{},{mode:d})}):f=tr(tr({},s||{}),{},{type:"rule_group",properties:tr(tr({},s.properties),{},{mode:d})}),f.id||(f.id=cr()),f}},pv=function(e,t,r,a,o,u){var i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;if(e.type==t.type)if(e.type=="!aggr"){var l=[e.source,t.source].map(function(m){return Bn(m,a,o,u,tr(tr({},r),{},{_groupField:i?._groupField}))}),s=(0,Le.A)(l,2),c=s[0],d=s[1];return c.value==d.value}else{var f=[e,t].map(function(m){return Bn(m,a,o,u,tr(tr({},r),{},{_groupField:i?._groupField}))}),p=(0,Le.A)(f,2),v=p[0],g=p[1];return v.value==g.value}return!1},Yu=function(e,t,r,a){var o={},u=null,i=Xu(u,e,t,r,a);i&&(o[i.id]=i);var l={type:"switch_group",id:cr(),children1:o,properties:{}};return l},Xu=function(e,t,r,a,o){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,i=vv(a,o,r,t,u),l;return e?(l=Jo(e,r,a,o,u),l&&l.type?(l.type!="group"&&(l=ya(l,a)),l.type="case_group"):(o.errors.push("Unexpected case: ".concat(JSON.stringify(l))),l=void 0)):l={id:cr(),type:"case_group",properties:{}},l&&(l.properties=tr(tr({},l.properties),i)),l},Zu=function(e,t,r,a){var o=[];function u(i){i.map(function(l){if(l.type=="op-plus")u(l.children);else{var s=Bn(l,t,r,a,e);s?o.push(s):a.errors.push("Can't convert ".concat(l.type," in concatenation"))}})}return u(e.children),{valueSrc:"value",valueType:"case_value",value:o}},vv=function(e,t,r,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,u={},i;a?.type=="op-plus"?i=Zu(a,r,e,t):i=Bn(a,r,e,t,o);var l=e.widgets.case_value,s=l?.spelImportValue;if(s){var c=s(i),d=(0,Le.A)(c,2),f=d[0],p=d[1];p.map(function(v){return t.errors.push(v)}),f&&(u={value:[f],valueSrc:["value"],valueType:["case_value"]})}else t.errors.push("No fucntion to import case value");return u},cb=function(e,t,r,a,o){if(e)return{type:"rule_group",id:uuid(),children1:_defineProperty({},e.id,e),properties:{conjunction:o||defaultGroupConjunction(a,r),not:!1,field:t}}},ya=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return{type:"group",id:cr(),children1:(0,te.A)({},e.id,e),properties:{conjunction:Ht(t),not:r||!1}}};function el(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function gv(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?el(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):el(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var rl=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,a=e.settings.defaultField,o=(r?tl(e,r):a)||t&&Rs(e,r)||null;return o!=null&&typeof o!="string"&&!_n(o)&&(o=ha(o)),o},tl=function(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!r)return null;var a=(e==null||(t=e.settings)===null||t===void 0?void 0:t.fieldSeparator)||".",o=je(e,r),u=o?.defaultField;return u&&(u=[].concat((0,Fe.A)(Pr(r)),[u]).join(a)),u},Qo=function(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return r&&((t=e.settings.fieldSources)===null||t===void 0?void 0:t[0])||"field"},Yo=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=e.settings.defaultOperator,o=je(e,t),u=o?.operators||[];a&&!u.includes(a)&&(a=null);var i=o?.defaultOperator;i&&!u.includes(i)&&(i=null),!i&&r&&(i=ui(e,t));var l=o?._origDefaultOperator,s=l&&i||a||i;return s},Oa=function(e,t,r){var a=t?dr(e,t,r):null;return a&&a.options?new be.default.Map(a.options&&a.options.defaults||{}):null},Kt=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,u=null,i=null,l=null,s=e.settings.showErrorMessage;if(r){var c,d,f;l=r==null||(c=r.properties)===null||c===void 0?void 0:c.fieldSrc,u=r==null||(d=r.properties)===null||d===void 0?void 0:d.field,i=r==null||(f=r.properties)===null||f===void 0?void 0:f.operator}else a?(u=rl(e,o,t),u?l=_n(u)?"func":"field":l=Qo(e),i=Yo(e,u,!0)):l=Qo(e);var p=new be.default.Map({fieldSrc:l,field:u,operator:i,value:new be.default.List,valueSrc:new be.default.List,operatorOptions:Oa(e,i,u)});if(s&&(p=p.set("valueError",new be.default.List)),u&&i){var v=!1,g=wn(e,e,p,u,i,"operator",v),m=g.newValue,O=g.newValueSrc,y=g.newValueType,b=g.newValueError,A=g.newFieldError;p=p.set("value",m).set("valueSrc",O).set("valueType",y),s&&(p=p.set("valueError",b).set("fieldError",A))}return p},Ha=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;t=je(e,t);var r=t&&t.conjunctions||Object.keys(e.conjunctions);return r.length==1?r[0]:e.settings.defaultGroupConjunction||e.settings.defaultConjunction||r[0]},Ht=function(e){return e.settings.defaultConjunction||Object.keys(e.conjunctions)[0]},On=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return new be.default.Map({conjunction:Ha(e,t),not:!1})},nl=function(e,t){var r;return t&&t.type=="group"?On(e,t==null||(r=t.properties)===null||r===void 0?void 0:r.field):Kt(e,null,t)},al=function(e,t){return(0,te.A)({},e,new be.default.Map({type:"rule",id:e,properties:Kt(t)}))},mv=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return new be.default.Map({type:"group",id:cr(),children1:new be.default.OrderedMap(t?gv({},al(cr(),e)):{}),properties:On(e)})},hv=function(e){return new be.default.List(e)},yv=function(){return new be.default.Map};function ol(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Ov(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function Ov(n,e){if(n){if(typeof n=="string")return il(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return il(n,e)}}function il(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function ul(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function ll(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ul(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ul(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var sl=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o={errors:[],settings:{isForDisplay:r,isDebugMode:a}},u=kt(t,void 0,!1),i=cl(e,u,o,null);return o.errors.length&&console.warn("Errors while exporting to string:",o.errors),i},cl=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(e){var o=e.get("type"),u=e.get("children1");if(o==="group"||o==="rule_group")return bv(e,t,r,a);if(o==="rule")return dl(e,t,r,a)}},bv=function(e,t,r){var a,o,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=r.settings,l=i.isForDisplay,s=i.isDebugMode,c=e.get("type"),d=e.get("properties")||new be.Map,f=d.get("mode"),p=e.get("children1")||new be.List,v=c==="rule_group",g=v&&f=="array"?d.get("field"):null,m=c==="rule_group"?d.get("operator"):null,O=m?(a=(o=t.operators[m])===null||o===void 0?void 0:o.cardinality)!==null&&a!==void 0?a:1:void 0,y=v&&f==="array"&&O>=1,b=d.get("not"),A=p.map(function(k){return cl(k,t,r,g)}).filter(function(k){return typeof k<"u"});if(!(!y&&!A.size&&!s)){var L=d.get("conjunction");L||(L=Ht(t));var S=t.conjunctions[L],R=A.size?S.formatConj(A,L,b,l):null,N;if(g){var M=dl(e,t,r,u,!0);if(M){var x,W=M.pop(),B=[R].concat((0,Fe.A)(M));N=(x=t.settings).formatAggr.apply(x,(0,Fe.A)(B)),W&&(N=t.settings.formatReverse(N,null,null,null,null,l))}}else N=R;return s&&N==null&&(N="?"),N}},Sv=function(e,t,r,a,o){var u=r.settings,i=u.isForDisplay,l=u.isDebugMode,s=t.get("field"),c=t.get("valueSrc"),d=t.get("valueType"),f=je(e,s)||{},p=a||t.get("operator"),v=dr(e,p,s)||{},g=kr(v),m=t.get("value"),O=t.get("asyncListValues"),y=[],b=[],A,L;if(m!=null){L=m.map(function(N,M){var x=c?c.get(M):null,W=d?d.get(M):null,B=l?N:Rn(N,x,e),k=Ar(e,s,p,x),Q=Cr()(at(e,s,p,k,x),["factory"]),K=Xo(e,r,B,x,W,Q,f,p,v,o,O);return K!==void 0&&(y.push(x),b.push(W)),K});var S=L.filter(function(N){return N===void 0}).size>0,R=!S&&L.size===g;R&&(A=g==1?L.first():L)}return l&&!A&&(A=g>1?new be.List(Array.from({length:g}).map(function(N,M){var x,W;return(x=(W=L)===null||W===void 0?void 0:W.get(M))!==null&&x!==void 0?x:"?"})):"?"),[A,y.length>1?y:y[0],b.length>1?b:b[0]]},Fv=function(e,t,r){var a=r.settings.isDebugMode,o=t?.labelForFormat||e,u=kr(t),i;return u==0?i=function(s,c,d,f,p,v,g,m){return"".concat(s," ").concat(o)}:u==1?i=function(s,c,d,f,p,v,g,m){return a&&c==="?"&&d==="?"?s&&s!=="?"?"".concat(s," ?"):"?":"".concat(s," ").concat(o," ").concat(d)}:u==2&&(i=function(s,c,d,f,p,v,g,m){var O,y,b=d==null||(O=d.first)===null||O===void 0?void 0:O.call(d),A=d==null||(y=d.get)===null||y===void 0?void 0:y.call(d,1);return"".concat(s," ").concat(o," ").concat(b," AND ").concat(A)}),i},dl=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,u=r.settings,i=u.isForDisplay,l=u.isDebugMode,s=e.get("properties")||new be.Map,c=s.get("field"),d=s.get("fieldSrc"),f=s.get("operator"),p=s.get("operatorOptions");if(!((c==null||f==null)&&!l)){var v=je(t,c)||{},g=dr(t,f,c)||{},m=g.reversedOp,O=dr(t,m,c)||{},y=!1,b=g.formatOp;if(!b&&m&&(b=O.formatOp,b)){y=!0;var A=[m,f];f=A[0],m=A[1];var L=[O,g];g=L[0],O=L[1]}if(l&&!f&&(f="?"),b||(b=Fv(f,g,r)),!!b){var S=d==="func"?pl(t,r,c,a):fl(t,r,c,a);if(S!=null){var R=Sv(t,s,r,f,a),N=(0,Le.A)(R,3),M=N[0],x=N[1],W=N[2];if(M!==void 0){var B=[S,f,M,x,W,Cr()(g,Mn),p,i,v,y];if(o)return B;var k,Q=(k=b).call.apply(k,[t.ctx].concat(B));return y&&(Q=t.settings.formatReverse(Q,f,m,g,O,i)),Q}}}}},Xo=function(e,t,r,a,o,u,i,l,s){var c=arguments.length>9&&arguments[9]!==void 0?arguments[9]:null,d=arguments.length>10?arguments[10]:void 0,f=t.settings,p=f.isForDisplay,v=f.isDebugMode;if(r===void 0)return v?u?.jsType==="array"?[]:"?":void 0;var g;if(a=="field")g=fl(e,t,r,c);else if(a=="func")g=pl(e,t,r,c);else if(typeof u.formatValue=="function"){var m=u.formatValue,O=[r,ll(ll({},Bt()(i,["fieldSettings","listValues"])),{},{asyncListValues:d}),Cr()(u,An),p];if(l&&(O.push(l),O.push(s)),a=="field"){var y=je(e,r)||{};O.push(y)}g=m.call.apply(m,[e.ctx].concat(O))}else g=r;return g},fl=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,u=t.settings,i=u.isForDisplay,l=u.isDebugMode,s=e.settings,c=s.fieldSeparator,d=s.fieldSeparatorDisplay,f=null;if(r){var p=je(e,r)||{},v=Pr(r,e),g=Sa(r,e,o?a:null),m=g?g.join(d):null,O=p.label2||m,y=e.settings.formatField,b=ln(r,e,t,o?a:null,{useTableName:!0});f=y(b,v,O,p,e,i)}else l&&(f="?");return f},pl=function(e,t,r){var a,o,u,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,l=t.settings,s=l.isForDisplay,c=l.isDebugMode,d=r==null||(a=r.get)===null||a===void 0?void 0:a.call(r,"func");if(!d)return c?"?()":void 0;var f=(o=r.get)===null||o===void 0?void 0:o.call(r,"args"),p=_r(e,d);if(!p&&!c){t.errors.push("Func ".concat(d," is not defined in config"));return}var v=Pr(d,e),g=v[v.length-1],m=s&&p?.label||g,O={},y=[],b=[],A={},L=p?Object.keys(p.args||{}):(f==null||(u=f.keySeq)===null||u===void 0?void 0:u.call(f).toArray())||[],S=ol(L),R;try{for(S.s();!(R=S.n()).done;){var N,M=R.value,x=p?.args[M],W=je(e,x),B=x||{},k=B.defaultValue,Q=B.isOptional,K=k!=null&&k.func?"func":"value",J=s&&x?.label||M,G=f?f.get(M):void 0,re=G?G.get("value"):void 0,ue=G?G.get("valueSrc"):void 0;ue!=="func"&&(N=re)!==null&&N!==void 0&&N.toJS&&(re=re.toJS());var de=G?G.get("asyncListValues"):void 0,fe=Xo(e,t,re,ue,x?.type,W,x,null,null,i,de);re!=null&&fe===void 0&&ue!="func"&&t.errors.push("Can't format value of arg ".concat(M," for func ").concat(d));var ae=void 0;if(fe===void 0&&!Q&&k!=null&&(ae=Xo(e,t,k,K,x?.type,W,x,null,null,i,de),ae===void 0)){K!="func"&&t.errors.push("Can't format default value of arg ".concat(M," for func ").concat(d));return}var ne=fe??ae;if(ne!==void 0){if(y.length){var ve=ol(M),ce;try{for(ve.s();!(ce=ve.n()).done;){var se=(0,Le.A)(ce.value,2),Te=se[0],Oe=se[1];O[Te]=void 0}}catch(qe){ve.e(qe)}finally{ve.f()}y=[]}O[M]=ne,A[J]=ne}else Q||b.push(M),y.push([M,J])}}catch(qe){S.e(qe)}finally{S.f()}if(!(b.length&&!c)){var Re=null;if(typeof p?.formatFunc=="function"){var Ve=p.formatFunc,Ue=[O,s];Re=Ve.call.apply(Ve,[e.ctx].concat(Ue))}else{var Ye=Object.entries(s?A:O).map(function(qe){var Be=(0,Le.A)(qe,2),ar=Be[0],nr=Be[1];return s?"".concat(ar,": ").concat(nr):"".concat(nr)}).join(", ");Re="".concat(m,"(").concat(Ye,")")}return Re}},vl="EMPTY_GROUP",gl="EMPTY_RULE_GROUP",ml="EMPTY_QUERY",hl="EMPTY_CASE",yl="NO_CONFIG_FOR_FIELD",Ol="NO_CONFIG_FOR_OPERATOR",Cv="FIXED_OPERATOR",bl="NO_CONFIG_FOR_FUNCTION",Sl="INVALID_VALUE",Fl="INVALID_FUNC_ARG_VALUE",Cl="UNSUPPORTED_FIELD_TYPE",Tl="UNSUPPORTED_OPERATOR_FOR_FIELD",El="INVALID_VALUE_SRC",Zo="INCOMPLETE_RULE",Al="INCOMPLETE_LHS",Ll="INCOMPLETE_RHS",ei="BAD_MULTISELECT_VALUES",wl="BAD_SELECT_VALUE",jl="INCORRECT_VALUE_TYPE",Rl="INCORRECT_VALUE_JS_TYPE",Pl="VALUE_LENGTH_CONSTRAINT_FAIL",xl="VALUE_MIN_CONSTRAINT_FAIL",Il="VALUE_MAX_CONSTRAINT_FAIL",Vl="NO_CONFIG_FOR_FIELD_VALUE",Dl="CANT_COMPARE_FIELD_WITH_ITSELF",Nl="CANT_COMPARE_FIELD_WITH_FIELD",kl="INCORRECT_FIELD_TYPE",Ml="UNSUPPORTED_FUNCTION_FOR_FIELD",_l="REQUIRED_FUNCTION_ARG",Gl="INCORRECT_FUNCTION_RETURN_TYPE",$l="INVALID_RANGE",un="ITEM_POSITION",Ul="ITEM_POSITION_ROOT",Bl="ITEM_POSITION_WITH_INDEX_PATH",Wl="ITEM_POSITION_IN_CASE",Tv=h(72635),Wn,Ev=(Wn={},(0,te.A)((0,te.A)((0,te.A)((0,te.A)((0,te.A)((0,te.A)((0,te.A)((0,te.A)((0,te.A)((0,te.A)(Wn,vl,"Empty group"),gl,"No conditions for group field {{field}}"),ml,"Empty query"),hl,"Empty case"),yl,"No config for field {{field}}"),Cv,"Fixed operator {{from}} to {{to}} for field {{field}}"),Ol,"No config for operator {{operator}}"),bl,"No config for function {{funcKey}}"),Sl,"Invalid value"),Fl,"Invalid value of arg {{argName}} for func {{funcName}}: {{argValidationError}}"),(0,te.A)((0,te.A)((0,te.A)((0,te.A)((0,te.A)((0,te.A)((0,te.A)((0,te.A)((0,te.A)((0,te.A)(Wn,Cl,"Type of field {{field}} is not supported"),Tl,"Operator {{operator}} is not supported for field {{field}}"),Zo,"Incomplete rule"),Al,"Incomplete LHS"),Ll,"Incomplete RHS"),El,"Invalid value src {{valueSrcs, list}}"),ei+"_one","Value {{badValues, list}} is not in the list of allowed values"),ei+"_other","Values {{badValues, list}} are not in the list of allowed values"),wl,"Value {{value}} is not in the list of allowed values"),jl,"Value should have type {{wType}}, but got value of type {{valueType}}"),(0,te.A)((0,te.A)((0,te.A)((0,te.A)((0,te.A)((0,te.A)((0,te.A)((0,te.A)((0,te.A)((0,te.A)(Wn,Rl,"Value should have JS type {{jsType}}, but got value of type {{valueTypeof}}"),Pl,"Value {{value}} should have max length {{fieldSettings.maxLength}} but got {{length}}"),xl,"Value {{value}} should be from {{fieldSettings.min}} to {{fieldSettings.max}}"),Il,"Value {{value}} should be from {{fieldSettings.min}} to {{fieldSettings.max}}"),Vl,"No config for field {{field}}"),Dl,"Can't compare field {{field}} with itself"),Nl,"Can't compare field {{leftField}} with {{rightField}}"),kl,"Field {{field}} is of type {{type}}, but expected {{expected}}"),Ml,"Unsupported function {{funcKey}} for field {{field}}"),_l,"Value of arg {{argName}} for func {{funcName}} is required"),(0,te.A)((0,te.A)((0,te.A)((0,te.A)((0,te.A)((0,te.A)((0,te.A)((0,te.A)((0,te.A)((0,te.A)(Wn,Gl,"Function {{funcKey}} should return value of type {{returnType}}, but got {{valueType}}"),$l,"Invalid range"),Ul,"Root"),un+"__rule","Leaf #{{globalLeafNo}}"),un+"__group","Group #{{globalGroupNo}}"),un+"__rule_group","Rule-group #{{globalNoByType}}"),un+"__case_group","Case #{{globalNoByType}}"),un+"__rule__deleted","Deleted leaf #{{globalLeafNo}}"),un+"__group__deleted","Deleted group #{{globalGroupNo}}"),un+"__rule_group__deleted","Deleted rule-group #{{globalNoByType}}"),(0,te.A)((0,te.A)((0,te.A)(Wn,un+"__case_group__deleted","Deleted case #{{globalNoByType}}"),Wl,"{{str}} in case #{{caseNo}}"),Bl,"{{str}} (index path: {{indexPath, list}})")),Kl="raqbvalidation",Av="".concat(Kl,":"),za=Tv.default.createInstance();za.init({fallbackLng:"en"}),za.addResources("en",Kl,Ev);var Nt=function n(e,t){return e!=null&&e.str?e.str:e!=null&&e.key?n(e.key,e.args):t===null?e:za.t(e.includes(":")?e:Av+e,t)};const Lv=za;function Hl(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Er(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Hl(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Hl(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var zl=function(e){return(0,Fr.A)(e)==="object"&&e!==null&&Array.isArray(e)?"array":(0,Fr.A)(e)},wv=function(e,t){return zl(e)===t||t==="number"&&!isNaN(e)},ri=function(e,t){return ti(e,t).length===0},ti=function(e,t){var r=t.settings.showErrorMessage,a=[];function o(u,i,l){var s,c,d=u.get("id"),f=u.get("children1"),p=u.getIn(["properties","valueError"]),v=u.getIn(["properties","fieldError"]),g=u.getIn(["properties","field"]),m=(s=g==null||(c=g.get)===null||c===void 0?void 0:c.call(g,"func"))!==null&&s!==void 0?s:g,O=p?.size>0&&p.filter(function(b){return b!=null}).size>0,y=O||!!v;y&&r&&a.push(m),f&&f.map(function(b,A){b&&o(b,i.concat(d),l+1)})}return e&&o(e,[],0),Array.from(new Set(a))},ni=function(e,t){var r=kt(t,void 0,!0),a={removeEmptyGroups:t.settings.removeEmptyGroupsOnLoad,removeIncompleteRules:t.settings.removeIncompleteRulesOnLoad,removeEmptyRules:t.settings.removeEmptyRulesOnLoad,forceFix:!1},o=ba(e,null,r,r,a),u=o.fixedTree,i=o.allErrors,l=o.isSanitized;return l&&i.length&&console.warn("Tree check errors: ",i),u},Jl=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=kt(t,void 0,!0),o=Er(Er({},r),{},{removeEmptyGroups:!1,removeEmptyRules:!1,removeIncompleteRules:!1,forceFix:!1}),u=ba(e,null,a,a,o),i=u.allErrors;return i},ql=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=kt(t,void 0,!0),o=Er({removeEmptyGroups:!0,removeEmptyRules:!0,removeIncompleteRules:!0,forceFix:!1},r),u=ba(e,null,a,a,o),i=u.fixedTree,l=u.fixedErrors,s=u.nonFixedErrors,c=u.allErrors;return{fixedTree:i,fixedErrors:l,nonFixedErrors:s,allErrors:c}},Ql=function(e,t,r,a,o,u,i){o===void 0&&(o=r.settings.removeEmptyGroupsOnLoad),u===void 0&&(u=r.settings.removeEmptyRulesOnLoad),i===void 0&&(i=r.settings.removeIncompleteRulesOnLoad);var l={removeEmptyGroups:o,removeEmptyRules:u,removeIncompleteRules:i,forceFix:!1},s=ba(e,t,r,a,l),c=s.fixedTree,d=s.allErrors,f=s.fixedErrors,p=s.nonFixedErrors,v=s.isSanitized;return v&&f.length&&console.warn("Fixed tree errors: ",f),c=Dt(c),c},ba=function(e,t,r,a,o){if(!e)return{fixedTree:e,allErrors:[],fixedErrors:[],nonFixedErrors:[],isSanitized:!1};var u=o||{},i=u.removeEmptyGroups,l=u.removeEmptyRules,s=u.removeIncompleteRules,c=u.forceFix,d=u.translateErrors,f=d===void 0?!0:d,p=u.includeStringifiedItems,v=p===void 0?!0:p,g=u.stringifyFixedItems,m=g===void 0?!1:g,O=u.stringifyItemsUserFriendly,y=O===void 0?!0:O,b=u.includeItemsPositions,A=b===void 0?!0:b,L={config:r,oldConfig:a,removeEmptyGroups:i,removeEmptyRules:l,removeIncompleteRules:s,forceFix:c},S={errors:{}},R=Xl(e,[],null,S,L),N=S.sanitized,M=[],x,W;A&&(x=ko(R).items);for(var B in S.errors){var k=S.errors[B],Q=k.path,K=k.errors;f&&(K=K.map(function(rr){return Er(Er({},rr),{},{str:Nt(rr)})}));var J={path:Q,errors:K};if(v){var G=Gn(m?R:e,Q),re=Q.length===1;if(!re&&G.get("type")!=="group"){var ue=!0,de=y,fe=sl(G,r,de,ue);J.itemStr=fe}}if(A){var ae=x[B],ne=!ae;if(ne&&(W||(W=ko(e).items),ae=W[B]),ae){var ve=Er(Er({},ae.position),{},{index:ae.index,type:ae.type,isDeleted:ne});J.itemPosition=ve;var ce=ae.index?un+"__"+ae.type+(ne?"__deleted":""):Ul,se=Er({},ve);if(y){for(var Te,Oe=0,Re=["caseNo","globalLeafNo","globalGroupNo","globalNoByType"];Oe<Re.length;Oe++){var Ve=Re[Oe];se[Ve]!=null&&(se[Ve]=se[Ve]+1)}se.indexPath=(Te=ve.indexPath)===null||Te===void 0?void 0:Te.map(function(rr){return rr+1})}J.itemPositionStr=Nt(ce,se),ae.index&&(ae.caseId&&ae.type!=="case_group"&&(J.itemPositionStr=Nt(Wl,Er(Er({},se),{},{str:J.itemPositionStr}))),J.itemPositionStr=Nt(Bl,Er(Er({},se),{},{str:J.itemPositionStr})))}}M.push(J)}for(var Ue=[],Ye=[],qe=0,Be=M;qe<Be.length;qe++){var ar=Be[qe],nr=ar.errors.filter(function(rr){return!!rr.fixed}),Lr=ar.errors.filter(function(rr){return!rr.fixed&&rr.key!=="EMPTY_QUERY"});nr.length&&Ue.push(Er(Er({},ar),{},{errors:nr})),Lr.length&&Ye.push(Er(Er({},ar),{},{errors:Lr}))}return{fixedTree:R,allErrors:M,fixedErrors:Ue,nonFixedErrors:Ye,isSanitized:N}};function bn(n,e,t,r){var a=e.get("id");n.errors[a]||(n.errors[a]={path:[].concat((0,Fe.A)(t),[a]),errors:[]}),n.errors[a].errors.push(r)}function Yl(n,e){var t=e.get("id");n.errors[t]&&n.errors[t].errors.map(function(r){r.fixed=!0})}function Xl(n,e,t,r,a){var o=n?.get("type");return o==="group"||o==="rule_group"||o=="case_group"||o=="switch_group"?jv(n,e,t,r,a):o==="rule"?Zl(n,e,t,r,a):n}function jv(n,e,t,r,a){var o,u,i,l,s,c,d=a.removeEmptyGroups,f=a.removeIncompleteRules,p=a.forceFix,v=a.config,g=v.settings.showErrorMessage,m=!g||p,O=n.get("id"),y=n.get("children1"),b=!e.length,A=y,L=n.get("type"),S=n.get("properties"),R=S?.get("field"),N=S?.get("mode"),M=S==null||(o=S.get)===null||o===void 0?void 0:o.call(S,"operator"),x=L==="rule_group"&&N==="array",W=L==="case_group",B=W&&y==null,k=M?(u=(i=v.operators[M])===null||i===void 0?void 0:i.cardinality)!==null&&u!==void 0?u:1:void 0,Q=W?!B:x?k==0:!0;!O&&t&&(O=t,n=n.set("id",O),r.sanitized=!0),x&&(n=Zl(n,e,t,r,a));var K={errors:{}};y=(l=y)===null||l===void 0?void 0:l.map(function(de,fe){return Xl(de,e.concat(O),fe,K,a)});var J=(s=y)===null||s===void 0?void 0:s.filter(function(de){return de!=null});d&&(y=J);var G=K.sanitized||A?.size!=((c=y)===null||c===void 0?void 0:c.size),re=!(J!=null&&J.size),ue=d&&!b;return x&&R&&(ue=f),re&&Q&&(bn(r,n,e,{key:b?ml:W?hl:x?gl:vl,args:{field:R},fixed:ue}),ue&&(Yl(r,n),n=void 0)),G&&(r.sanitized=!0),G&&n&&(n=n.set("children1",y)),r.errors=Er(Er({},r.errors),K?.errors||{}),n}function Zl(n,e,t,r,a){var o=a.removeIncompleteRules,u=a.removeEmptyRules,i=a.forceFix,l=a.config,s=a.oldConfig,c=l.settings.showErrorMessage,d=!c||i,f=n,p=n.get("id"),v=n.get("properties");if(!v){var g={key:Zo,args:{},fixed:o||u};bn(r,n,e,g);return}var m=v.get("field")||null,O=v.get("fieldSrc")||null,y=v.get("operator")||null,b=v.get("operatorOptions"),A=v.get("valueSrc"),L=v.get("value"),S=v.get("valueError"),R=v.get("fieldError"),N=function(){var Ye,qe;return{field:((Ye=m)===null||Ye===void 0||(qe=Ye.toJS)===null||qe===void 0?void 0:qe.call(Ye))||m,fieldSrc:O,operator:y,operatorOptions:b?b.toJS():{},valueSrc:A?A.toJS():null,value:L?L.toJS():null,valueError:S?S.toJS():null,fieldError:R||null}},M=N();!p&&t&&(p=t,n=n.set("id",p),r.sanitized=!0);var x=m?je(l,m):null;m&&!x&&(bn(r,n,e,{key:yl,args:{field:m},side:"lhs",fixed:o||u}),m=null),m==null&&(v=["operator","operatorOptions","valueSrc","value","valueError","fieldError","field"].reduce(function(Ue,Ye){return Ue.delete(Ye)},v),y=null),O||(O=js(m),v=v.set("fieldSrc",O)),(y==="range_between"||y==="range_not_between")&&(y=y==="range_between"?"between":"not_between",v=v.set("operator",y));var W=y?dr(l,y,m):null;y&&!W&&(bn(r,n,e,{key:Ol,args:{operator:y},side:"op",fixed:o||u}),y=null);var B=m?Qa(l,m):[];m&&(B!=null&&B.length?y&&B.indexOf(y)==-1&&(y==="is_empty"||y==="is_not_empty"?(y=y==="is_empty"?"is_null":"is_not_null",v=v.set("operator",y)):(bn(r,n,e,{key:Tl,args:{operator:y,field:m},side:"lhs",fixed:o||u}),y=null)):(bn(r,n,e,{key:Cl,args:{field:m},side:"lhs",fixed:o||u}),y=null)),y==null&&(v=["operatorOptions","valueSrc","value","valueError"].reduce(function(Ue,Ye){return Ue.delete(Ye)},v)),b=v.get("operatorOptions"),!y||b&&!W.options?(b=null,v=v.delete("operatorOptions")):y&&!b&&W.options&&(b=Oa(l,y,m),v=v.set("operatorOptions",b)),A=v.get("valueSrc"),L=v.get("value");var k=!0,Q=wn(l,s,v,m,y,null,d,k),K=Q.newValue,J=Q.newValueSrc,G=Q.newValueError,re=Q.validationErrors,ue=Q.newFieldError,de=Q.fixedField;L=K,A=J,S=G,R=ue,m=de,v=v.set("field",m),v=v.set("value",L),v=v.set("valueSrc",A),c?v=v.set("valueError",S).set("fieldError",R):v=v.delete("valueError").delete("fieldError");var fe=N(),ae=!Ma(M,fe),ne=fi(v.toObject(),l),ve=ne.score>=3;if(ae&&(r.sanitized=!0,n=n.set("properties",v)),re?.map(function(Ue){return bn(r,n,e,Ue)}),!ve){var ce=ne.score?o:u,se={key:Zo,args:{}};if(!ne.parts.field)se.key=Al,se.side="lhs";else if(!ne.parts.value){var Te,Oe,Re,Ve;se.key=Ll,se.side="rhs",(Te=fe.valueSrc)!==null&&Te!==void 0&&Te[0]&&((Oe=fe.valueSrc)===null||Oe===void 0?void 0:Oe[0])!=((Re=M.valueSrc)===null||Re===void 0?void 0:Re[0])&&((Ve=fe.value)===null||Ve===void 0?void 0:Ve[0])!=null&&(se.key=El,se.args={valueSrcs:fe.valueSrc})}se.fixed=ce,bn(r,n,e,se),ce&&(Yl(r,n),n=void 0)}return n}var Kn=function(e,t,r,a,o,u,i,l){var s=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,c=arguments.length>9&&arguments[9]!==void 0?arguments[9]:!1,d=arguments.length>10&&arguments[10]!==void 0?arguments[10]:!1,f=[],p=o;if(o!=null){var v,g,m,O;if(i==="field"){var y=xv(t,r,o,i,u,l,e,a,s,c),b=(0,Le.A)(y,2);p=b[0],f=b[1]}else if(i==="func"){var A=Iv(t,r,o,i,u,l,e,a,s,c,d),L=(0,Le.A)(A,2);p=L[0],f=L[1]}else if(i==="value"||!i){var S=Pv(r,o,i,u,l,e,a,s,c),R=(0,Le.A)(S,2);p=R[0],f=R[1]}var N=!((v=f)!==null&&v!==void 0&&v.find(function(ve){return!ve.fixed})),M=!!r&&!["field","func"].includes(i)&&(!((g=f)!==null&&g!==void 0&&g.length)||N);if(M){var x=Ar(e,r,a,i),W=a?dr(e,a,r):null,B=Cr()(at(e,r,a,x,i),["factory"]),k=i==="field"?je(e,o):null,Q=B,K=B.validateValue;if(typeof K=="function"){var J=[p,Q,a,W];i==="field"&&J.push(k);var G=K.call.apply(K,[e.ctx].concat(J));if((0,Fr.A)(G)==="object"&&G!==null&&!Array.isArray(G)){var re,ue;(re=G.error)!==null&&re!==void 0&&re.key?ue=Er({},G.error):ue={key:G.error,args:null},G.fixedValue!==void 0&&s&&(ue.fixed=!0,ue.fixedFrom=p,ue.fixedTo=G.fixedValue,p=G.fixedValue),f.push(ue)}else typeof G=="boolean"?G==!1&&f.push({key:Sl,args:{}}):typeof G=="string"&&f.push({key:G,args:null})}}if(N=!((m=f)!==null&&m!==void 0&&m.find(function(ve){return!ve.fixed})),(O=f)!==null&&O!==void 0&&O.length&&!N&&s){var de=je(e,r),fe=de?.fieldSettings,ae=fe?.defaultValue;if(ae!==void 0){var ne=f[f.length-1];ne.fixed=!0,ne.fixedFrom=p,ne.fixedTo=ae,p=ae,f.map(function(ve){ve.fixed=!0})}}}return[p,f]},Rv=function(e,t,r,a,o){var u=be.default.List.isList(e)?e.toJS():e instanceof Array?(0,Fe.A)(e):void 0,i=e,l=[];if(u){var s=u.reduce(function(m,O){var y=(0,Le.A)(m,2),b=y[0],A=y[1],L=ma(t,O);return L==null?[b,[].concat((0,Fe.A)(A),[O])]:[[].concat((0,Fe.A)(b),[L.value]),A]},[[],[]]),c=(0,Le.A)(s,2),d=c[0],f=c[1],p=f.length>0;if(r=r||o===!0,i=r&&p?d:e,f.length){var v=r&&p;l.push({key:ei,args:{badValues:f,count:f.length},fixed:v,fixedFrom:v?u:void 0,fixedTo:v?i:void 0})}return[i,l]}else{var g=ma(t,e);return g==null?(i=r?null:e,l.push({key:wl,args:{value:e},fixed:r,fixedFrom:r?e:void 0,fixedTo:r?i:void 0})):i=g.value,[i,l]}},Pv=function(e,t,r,a,o,u){var i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,s=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,c=[],d=t;if(e){var f=je(u,e),p=Ar(u,e,i,r),v=u.widgets[p],g=v?.type,m=v?.jsType,O=f?.fieldSettings,y=O?.treeValues||O?.listValues,b=!!(O!=null&&O.asyncFetch),A=y||b;if(a&&g&&a!=g)return c.push({key:jl,args:{wType:g,valueType:a}}),[t,c];if(m&&!wv(t,m)&&!A)return c.push({key:Rl,args:{jsType:m,valueTypeof:zl(t)}}),[t,c];if(O){var L=o||y;if(L&&!O.allowCustomValues){var S=Rv(t,L,l,s,u.settings.removeInvalidMultiSelectValuesOnLoad),R=(0,Le.A)(S,2);d=R[0],c=R[1]}O.maxLength>0&&t!=null&&String(t).length>O.maxLength&&(d=l?String(t).substring(0,O.maxLength):t,c.push({key:Pl,args:{value:t,length:String(t).length,fieldSettings:O},fixed:l,fixedFrom:l?t:void 0,fixedTo:l?d:void 0})),O.min!=null&&t<O.min&&(d=l?O.min:t,c.push({key:xl,args:{value:t,fieldSettings:O},fixed:l,fixedFrom:l?t:void 0,fixedTo:l?d:void 0})),O.max!=null&&t>O.max&&(d=l?O.max:t,c.push({key:Il,args:{value:t,fieldSettings:O},fixed:l,fixedFrom:l?t:void 0,fixedTo:l?d:void 0}))}}return[d,c]},xv=function(e,t,r,a,o,u,i){var l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null,s=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,c=arguments.length>9&&arguments[9]!==void 0?arguments[9]:!1,d=[],f=i.settings,p=f.fieldSeparator,v=f.canCompareFieldWithField,g=(0,Fr.A)(t)=="object"&&t?._isFuncArg,m=Array.isArray(e)?e.join(p):e,O=je(i,e),y=Array.isArray(r)?r.join(p):r,b=je(i,r);if(!b)return d.push({key:Vl,args:{field:y}}),[r,d];if(e&&y===m&&!g)return d.push({key:Dl,args:{field:m}}),[r,d];if(o&&o!=b.type)return d.push({key:kl,args:{field:y,type:b.type,expected:o}}),[r,d];if(e&&!g&&v){var A=v(m,O,y,b,l);if(!A)return d.push({key:Nl,args:{leftField:m,rightField:y}}),[r,d]}return[r]},Iv=function(e,t,r,a,o,u,i){var l,s,c=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null,d=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,f=arguments.length>9&&arguments[9]!==void 0?arguments[9]:!1,p=arguments.length>10&&arguments[10]!==void 0?arguments[10]:!1,v=r,g=[];if(!r)return[r];var m=(l=r.get)===null||l===void 0?void 0:l.call(r,"func");if(!m)return[r];var O=je(i,t);if(O!=null&&O.funcs&&!O.funcs.includes(m))return g.push({key:Ml,args:{funcKey:m,field:t}}),[r,g];var y=_r(i,m);if(!y)return g.push({key:bl,args:{funcKey:m}}),[r,g];var b=(s=y.label)!==null&&s!==void 0?s:m;if(o&&y.returnType!=o)return g.push({key:Gl,args:{funcKey:m,funcName:b,returnType:y.returnType,valueType:o}}),[r,g];d=d||p;for(var A in y.args){var L,S=y.args[A],R=v.get("args"),N=R?R.get(A):void 0,M=je(i,S),x=(L=M?.label)!==null&&L!==void 0?L:A,W=N?N.get("value"):void 0,B=N?N.get("valueSrc"):void 0;if(W!==void 0){var k=Kn(i,e,M,c,W,S.type,B,u,d,f,p),Q=(0,Le.A)(k,2),K=Q[0],J=Q[1],G=!(J!=null&&J.length),re=d&&K!==W,ue=d&&!G&&!re&&(f||p);if(re&&(v=v.setIn(["args",A,"value"],K)),ue&&(v=v.deleteIn(["args",A]),v=Ja(i,v,y,A)),!G){var de,fe,ae=(de=(fe=J.find(function(Oe){return!Oe.fixed&&!Oe.ignore}))!==null&&fe!==void 0?fe:J.find(function(Oe){return!Oe.fixed}))!==null&&de!==void 0?de:J[0],ne=re||ue,ve=J.filter(function(Oe){return!Oe.ignore}).length===0;if(ae){var ce=Nt(ae);g.push({key:Fl,args:{funcKey:m,funcName:b,argKey:A,argName:x,argValidationError:ce,argErrors:J},ignore:ve,fixed:ne,fixedFrom:ne?W:void 0,fixedTo:ne?re?K:S.defaultValue:void 0})}}}else if(!S.isOptional&&(f||p)){var se=d&&S.defaultValue!==void 0&&(f||p),Te=f;Te&&g.push({key:_l,args:{funcKey:m,funcName:b,argKey:A,argName:x},fixed:se,fixedTo:se?S.defaultValue:void 0,ignore:!se}),se&&(v=v.deleteIn(["args",A]),v=Ja(i,v,y,A))}}return[v,g]},ai=function(e,t,r,a,o){var u=dr(e,r,t),i=r?kr(u):null,l=o.toJS?o.toJS():o,s=a.toJS?a.toJS():a,c=l.filter(function(O){return O=="value"||O==null}).length==i,d;if(u!=null&&u.validateValues&&c){var f=l[0],p=Ar(e,t,r,f),v=at(e,t,r,p,f),g=v!=null&&v.toJS?s.map(function(O){var y=v.toJS.call(e.ctx,O,v);return y instanceof Date&&(y=y.getTime()),y}):s,m=u.validateValues(g);typeof m=="boolean"&&m==!1&&(d={key:$l,args:{jsValues:g,values:s}})}return d},wn=function(e){var t,r,a,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,u=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,l=arguments.length>4?arguments[4]:void 0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,c=arguments.length>6&&arguments[6]!==void 0?arguments[6]:!1,d=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,f=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1;o||(o=e);var p=e.settings,v=p.keepInputOnChangeFieldSrc,g=p.convertableWidgets,m=p.clearValueOnChangeField,O=p.clearValueOnChangeOp,y=u.get("field"),b=u.get("fieldType"),A=u.get("fieldSrc"),L=u.get("operator"),S=u.get("value"),R=u.get("valueSrc",new be.default.List),N=u.get("valueType",new be.default.List),M=u.get("asyncListValues"),x=dr(o,L),W=dr(e,l,i),B=L?kr(x):null,k=l?kr(W):null,Q=je(o,y),K=je(e,i),J=!y&&b&&v,G=Q?.type||b,re=K?.type||!i&&J&&G,ue=Q?.listValuesType,de=K?.listValuesType,fe=(y==null||(t=y.get)===null||t===void 0?void 0:t.call(y,"func"))||y,ae=((r=i)===null||r===void 0||(a=r.get)===null||a===void 0?void 0:a.call(r,"func"))||i,ne=ae!=fe,ve=[],ce=(y||J)&&L&&l&&S!=null;(!(G&&re&&G==re)||s==="field"&&ne&&m||s==="operator"&&O)&&(ce=!1),ne&&qa.includes(re)&&(de&&de===ue||(ce=!1));var se;if(A==="func"&&i){var Te=Kn(e,null,null,l,i,re,A,M,c,d,f),Oe=(0,Le.A)(Te,2),Re=Oe[0],Ve=Oe[1],Ue=!(Ve!=null&&Ve.length),Ye=Re!==i,qe=!Ue&&Ye&&!Ve.find(function(Qr){return!Qr.fixed}),Be=c&&!Ue&&!qe&&!!s&&i!==y,ar=!1;if(ar?i=null:Be?i=y:Ye&&(i=Re),!Ue){var nr=!Ue&&!qe&&!ar&&!Be,Lr=Ve.find(function(Qr){return!Qr.fixed&&!Qr.ignore});nr&&Lr&&(se=Nt(Lr)),Ve.map(function(Qr){return ve.push(Er(Er({side:"lhs"},Qr),{},{fixed:Qr.fixed||Be||ar}))})}}for(var rr=0;rr<k;rr++){var dt=R.get(rr)||null,_t=Ar(o,y,L,dt),St=Ar(e,i,l,dt),Ft=dt==="value"?_t:Ar(o,y,L,"value"),ht=dt==="value"?St:Ar(e,i,l,"value"),Gt=ht==Ft||(g[Ft]||[]).includes(ht)||!Ft&&J;Gt||(ce=!1)}L!=l&&[L,l].includes("proximity")&&(ce=!1);var $t=R.first(),ot=at(e,i,l,null,$t),Jr=ls(e,i,l,null);!i&&J&&(Jr=Object.keys(e.settings.valueSourcesInfo));var cn=Jr[0],dn;k==1&&ot&&ot.type!==void 0?dn=ot.type:k==1&&K&&K.type!==void 0&&(dn=K.type==="!group"?"number":K.type);var it=ce&&s==="operator"&&B===1&&k===2,Vr=[],er=[],rt=[],qr=Array.from({length:k},function(){return null});if(ce)for(var qt=function(ur){var ut=S.get(ur),ft=N.get(ur)||null,Fn=R.get(ur)||null;it&&ur===1&&(ut=Vr[0]!==void 0?Vr[0]:S.get(0),Vr[ur]=ut,ft=N.get(0)||null,Fn=R.get(0)||null);var yo=Fn?Jr.find(function(Pt){return Pt==Fn})!==void 0:!0,up=Kn(e,i,i,l,ut,ft,Fn,M,c,d,f),Br=(0,Le.A)(up,2),At=Br[0],Hr=Br[1],La=!(Hr!=null&&Hr.length),Oo=At!==ut,ib=!La&&Oo&&!(Hr!=null&&Hr.find(function(Pt){return!Pt.fixed})),ub=!(Hr!=null&&Hr.find(function(Pt){return!Pt.fixed&&!Pt.ignore})),lp=!yo||c&&!La&&!ib&&(!ub||ne);La||Hr?.map(function(Pt){return ve.push(Er(Er({side:"rhs",delta:ur},Pt),{},{fixed:Pt.fixed||lp}))}),lp&&(Vr[ur]=null,ur===0&&delete Vr[1]);var lb=!La&&!Oo,sp=Hr?.find(function(Pt){return!Pt.fixed&&!Pt.ignore});lb&&sp&&(qr[ur]=Nt(sp)),Oo&&(Vr[ur]=At),it&&ur===0&&!La&&!Oo&&(it=!1),it&&ur===0&&["func","field"].includes(Fn)&&(it=!1)},Ct=0;Ct<k;Ct++)qt(Ct);if(!ce){for(var Nn=0;Nn<k;Nn++)if(k===1){var Rt,wr=su([K?.defaultValue,K==null||(Rt=K.fieldSettings)===null||Rt===void 0?void 0:Rt.defaultValue,ot?.defaultValue]);Vr[Nn]=wr,wr!=null&&wr.func&&(er[Nn]="func")}}for(var Pe=0;Pe<k;Pe++){var Me=ce&&R.get(Pe)||null,Ze=ce&&N.get(Pe)||null;if(ce&&it&&Pe===1){var or,Dr;Me=(or=er[Pe])!==null&&or!==void 0?or:R.get(0),Ze=(Dr=rt[Pe])!==null&&Dr!==void 0?Dr:N.get(0),er[Pe]=Me,rt[Pe]=Ze}var Nr=Jr.includes(Me);Nr||(er[Pe]=cn),Ze||(rt[Pe]=dn)}var hr=new be.default.List(Array.from({length:k},function(Qr,ur){return Vr[ur]!==void 0?Vr[ur]:ce?S.get(ur):void 0})),Tt=new be.default.List(Array.from({length:k},function(Qr,ur){var ut;return(ut=er[ur])!==null&&ut!==void 0?ut:ce&&R.get(ur)||null})),Ur=new be.default.List(Array.from({length:k},function(Qr,ur){var ut;return(ut=rt[ur])!==null&&ut!==void 0?ut:ce&&N.get(ur)||null})),Qt=ai(e,i,l,hr,Tt);if(Qt){var Yt=Nt(Qt),Et=c&&k>=2,fn=hr;Et&&(Vr[1]=hr.get(0),hr=hr.set(1,Vr[1]),qr[1]=qr[0]);var Xt=!Et;Xt&&qr.push(Yt),ve.push(Er(Er({side:"rhs",delta:-1},Qt),{},{fixed:Et,fixedFrom:Et?[fn.get(0),fn.get(1)]:void 0,fixedTo:Et?[hr.get(0),hr.get(1)]:void 0}))}var Ut=new be.default.List(qr);return{canReuseValue:ce,newValue:hr,newValueSrc:Tt,newValueType:Ur,operatorCardinality:k,fixedField:i,newValueError:Ut,newFieldError:se,validationErrors:ve}},oi=function(e){return(0,Fr.A)(e)=="object"&&e!==null&&!Array.isArray(e)},es=function(e,t){if(e){var r=e.get("func"),a=r&&_r(t,r);if(a){var o=e,u=!1;for(var i in a.args){var l=a.args[i],s=l.valueSources,c=l.isOptional,d=l.defaultValue,f=jn(t,s,l),p=o.get("args"),v=f.length==1?f[0]:void 0,g=p?p.get(i):void 0,m=g?g.get("value"):void 0,O=(g?g.get("valueSrc"):void 0)||v;if(m!==void 0){var y=Rn(m,O,t);if(y===void 0||(y!==m&&(o=o.setIn(["args",i,"value"],y)),u))return}else if(d!==void 0&&!oi(d))o=o.setIn(["args",i,"value"],ts(l)),o=o.setIn(["args",i,"valueSrc"],"value");else if(c)u=!0;else return}return o}}},rs=function(e,t,r,a){var o=r.settings.fieldSeparator;e=e||new be.default.Map,Array.isArray(t)&&(t=t.join(o));var u=e.get("func"),i=e.get("args");e=e.set("func",t);var l=t&&_r(r,t),s=t&&hi(r,t),c=u&&hi(r,u),d=as(c,s,i,r,a);if(d.length){var f=Object.keys(s.args),p=f.filter(function(v){return!d.includes(v)});e=p.reduce(function(v,g){return v.deleteIn(["args",g])},e)}else e=e.set("args",new be.default.Map);return e=Vv(r,e,l),e},Vv=function(e,t,r){if(r)for(var a in r.args)t=Ja(e,t,r,a);return t},Ja=function(e,t,r,a){var o=r.args[a],u=o.valueSources,i=o.defaultValue,l=jn(e,u,o),s=l.length?l[0]:void 0,c=i?oi(i)&&i.func?"func":"value":void 0,d=c||s,f=t.getIn(["args",a]);return f||(i!==void 0&&(t=t.setIn(["args",a,"value"],ts(o))),d&&(t=t.setIn(["args",a,"valueSrc"],d))),t},ts=function(e){var t=e.defaultValue;return oi(t)&&!be.default.Map.isMap(t)&&t.func?be.default.fromJS(t,function(r,a){return be.default.Iterable.isIndexed(a)?a.toList():a.toOrderedMap()}):t},ii=function(e,t,r,a,o){if(e&&e.get("func")){e=e.setIn(["args",t,"value"],r);var u=e.getIn(["args",t,"valueSrc"]),i=a.valueSources,l=jn(o,i,a),s=l.length==1?l[0]:void 0;!s&&l.includes("value")&&(s="value"),!u&&s&&(e=e.setIn(["args",t,"valueSrc"],s))}return e},ns=function(e,t,r,a,o){return e&&e.get("func")&&(e=e.setIn(["args",t],new be.default.Map({valueSrc:r}))),e},as=function(e,t,r,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(e?.returnType!=t?.returnType)return[];var u=!1,i=Object.keys(t.args),l=i.filter(function(s,c){var d=t.args[s],f=e.args[s],p=Object.keys(e.args).indexOf(s);if(!f&&(d.defaultValue!==void 0||d.isOptional))return!0;if(u&&c!==p||f?.type!=d.type||qa.includes(d.type)&&(!f.listValuesType||f.listValuesType!==d.listValuesType))return!1;if(r){var v,g=r.get(s),m=g?.get("value"),O=g?.get("valueSrc");if(O&&d.valueSources&&!d.valueSources.includes(O))return!1;var y=null,b=null,A=d,L=null,S=!0,R=Kn(a,y,A,b,m,A.type,O,L,o,S),N=(0,Le.A)(R,2),M=N[0],x=N[1];if(x!=null&&(v=x.filter(function(W){return!W.fixed}))!==null&&v!==void 0&&v.length)return!1}return!0});return l},qa=["select","multiselect","treeselect","treemultiselect"],os=function(e,t){var r;return((r=e.types[t])===null||r===void 0?void 0:r.operators)||null},Qa=function(e,t){var r=je(e,t),a=r?r.operators:[];return a},ui=function(e,t){var r,a=Qa(e,t);return(r=a?.[0])!==null&&r!==void 0?r:null},is=function(e,t,r){var a=null;if(e){if(t==="field"){var o=je(r,e);o&&(a=o.type)}else if(t==="func"){var u=e.get("func");if(u){var i=_r(r,u);i&&(a=i.returnType||i.type)}}}return a},Dv=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Sa(e,t,r,"funcs","subfields")},Sa=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"fields",o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"subfields";if(!e)return null;var u=t.settings.fieldSeparator,i=Pr(e,t),l=Pr(r,t),s=i.slice(l.length).map(function(c,d,f){return f.slice(0,d+1)}).map(function(c){return[].concat((0,Fe.A)(l),(0,Fe.A)(c)).join(u)}).map(function(c){var d=Mt(t,c,a,o);return d&&d.label||$a()(c.split(u))}).filter(function(c){return c!=null});return s},us=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!e)return null;var a=r&&Mt(t,r)||null,o=t.settings.fieldSeparator,u=Pr(e,t),i=ws(e,r,t),l=i?Pr(r,t):[];return u.slice(l.length).map(function(s,c,d){return d.slice(0,c+1)}).map(function(s){return{part:[].concat((0,Fe.A)(l),(0,Fe.A)(s)).join(o),key:s[s.length-1]}}).map(function(s){var c=s.part,d=s.key,f=Mt(t,c);return{key:d,cnf:f}}).map(function(s,c,d){var f=s.key,p=s.cnf,v=c>0?d[c-1].cnf:a;return[f,p,v]})},Nv=function(e,t,r,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1,i=t&&(0,Fr.A)(t)=="object"&&!!t.func&&!!t.arg,l=e.settings.showLabels,s=je(e,t),c=at(e,t,r,null,o)||{},d=dr(e,r,t)||{},f=u?1:d.cardinality,p=null;if(f>1){var v=c.valueLabels||d.valueLabels;v&&(p=v[a]),p&&(0,Fr.A)(p)!="object"&&(p={label:p,placeholder:p}),p||(p={label:e.settings.valueLabel+" "+(a+1),placeholder:e.settings.valuePlaceholder+" "+(a+1)})}else{var g=c.valueLabel,m=c.valuePlaceholder;i&&(g||(g=s.label||t.arg),!m&&!l&&(m=s.label||t.arg)),p={label:g||e.settings.valueLabel,placeholder:m||e.settings.valuePlaceholder}}return p};function li(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,a=[],o=[];if(!e)return{widgets:a,valueSrcs:o};var u=(0,Fr.A)(e)==="object"&&(!!e.func&&!!e.arg||e._isFuncArg),i=je(n,e),l=t?n.operators[t]:null;if(i!=null&&i.widgets){var s=function(){var p=i.widgets[c];if(!n.widgets[c])return 1;var v=n.widgets[c].valueSrc||"value",g=!0;if(c=="field"&&(g=g&&jn(n,["field"],i).length>0),c=="func"&&(g=g&&jn(n,["func"],i).length>0),r=="value"&&!p.operators&&!u&&e!="!case_value"&&(g=!1),p.operators&&t&&(g=g&&p.operators.indexOf(t)!=-1),r&&r!=v&&r!="const"&&(g=!1),l&&l.cardinality==0&&v!="value"&&(g=!1),g){var m,O;a.push(c);var y=((m=i.valueSources)===null||m===void 0?void 0:m.indexOf(v))!=-1;(l==null||(O=l.valueSources)===null||O===void 0?void 0:O.indexOf(v))==-1&&(y=!1),y&&!o.find(function(b){return b==v})&&o.push(v)}};for(var c in i.widgets)s()}var d=function(p){var v=0;return i.preferWidgets?i.preferWidgets.includes(p)&&(v+=10-i.preferWidgets.indexOf(p)):p==i.mainWidget&&(v+=100),p=="field"&&(v-=1),p=="func"&&(v-=2),v};return a.sort(function(f,p){return d(p)-d(f)}),{widgets:a,valueSrcs:o}}var kv=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=li(e,t,r,a),u=o.widgets;return u},jn=function(e,t,r){var a;if(!r)return t;var o=(a=r.type)!==null&&a!==void 0?a:r.returnType;return t||(t=Object.keys(e.settings.valueSourcesInfo)),t.filter(function(u){var i=!0;if(u=="field"&&e.__fieldsCntByType){var l=r._isFuncArg?0:1;i=i&&e.__fieldsCntByType[o]>l}return u=="func"&&(e.__funcsCntByType&&(i=i&&!!e.__funcsCntByType[o]),r.funcs&&(i=i&&r.funcs.length>0)),i})},ls=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=li(e,t,r,null),u=o.valueSrcs,i=jn(e,u,a);return i},Ar=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=li(e,t,r,a),u=o.widgets,i=null;return u.length&&(i=u[0]),i},ln=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};if(e){var u=je(t,e)||{},i=t.settings.fieldSeparator,l=Pr(e,t),s=Array.isArray(e)?e.join(i):e;if(o!=null&&o.useTableName&&u.tableName){var c=(0,Fe.A)(l);c[0]=u.tableName,s=c.join(i)}if(u.fieldName&&(s=u.fieldName),a){var d=je(t,a)||{},f=a;s.indexOf(f+i)==0?s=s.slice((f+i).length):u.fieldName||r.errors.push("Can't cut group ".concat(f," from field ").concat(s))}return s}},si=function(e,t){var r=e.get("type"),a=e.getIn(["properties","mode"]);return r=="rule_group"&&a=="array"?Mv(e,t):r=="group"||r=="rule_group"?_v(e,t):Gv(e,t)},Mv=function(e,t){var r=e.get("children1"),a=e.get("properties");return ss(a.toObject(),r,t)},ss=function(e,t,r){var a,o,u=e.operator,i=(a=(o=r.operators[u])===null||o===void 0?void 0:o.cardinality)!==null&&a!==void 0?a:1,l=i==0,s={group:!di(e,r),children:!ci(t,r)},c=s.group&&(l?s.children:!0);return!c},_v=function(e,t){var r=e.get("children1");return ci(r,t)},ci=function(e,t){var r=e?.size>0&&e.filter(function(a){return!si(a,t)}).size>0;return!r},Gv=function(e,t){var r=e.get("properties");return di(r?.toObject()||{},t)},di=function(e,t){var r=!0,a=3,o=fi(e,t,r),u=o.score>=a;return!u},fi=function(e,t){var r,a,o,u=e.field,i=e.fieldSrc,l=e.fieldType,s=e.operator,c=e.value,d=e.valueSrc,f=e.valueType,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,v=(r=(a=t.operators[s])===null||a===void 0?void 0:a.cardinality)!==null&&r!==void 0?r:1,g=d!=null&&d.get?d.toJS():d,m={parts:{},score:0};if(m.parts.field=p?u!=null:Ya(u,i,t),m.parts.operator=!!s,m.parts.value=(c==null||(o=c.filter(function(y,b){return Ya(y,g?.[b],t,p)}))===null||o===void 0?void 0:o.size)>=(p?Math.min(v,1):v),m.score=Object.keys(m.parts).filter(function(y){return!!m.parts[y]}).length,p&&m.score<3){var O=!0;!m.parts.value&&i==="func"&&Ya(u,i,t,!1,O)&&m.score++,m.parts.field||c?.map(function(y,b){g?.[b]==="func"&&Ya(y,g?.[b],t,!1,O)&&m.score++})}return m},Ya=function n(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;if(!a&&t=="func"&&e){var u,i=(u=e.get)===null||u===void 0?void 0:u.call(e,"func"),l=_r(r,i);if(l){var s=e.get("args");for(var c in l.args){var d=l.args[c],f=s?s.get(c):void 0,p=f?f.get("value"):void 0,v=f?f.get("valueSrc"):void 0;if(p==null&&d?.defaultValue===void 0&&!(d!=null&&d.isOptional)||p!=null&&!n(p,v,r,o?a:!0))return!1}return!0}}return e!=null},Rn=function(e,t,r){return t=="func"?es(e,r):e},$v=h(1779),wt=h.n($v),Uv=h(18678),pi=h.n(Uv);function cs(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function ds(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?cs(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):cs(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Bv(n,e){return pi().apply(n,e)}function Wv(n,e){return pi().add_operation(n,e)}var fs={CALL:function(e,t){for(var r=arguments.length,a=new Array(r>2?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];return e.call.apply(e,[t].concat(a))},JSX:function(e,t){return{type:e,props:t}},mergeObjects:function(e,t){return ds(ds({},e),t)},fromEntries:function(e){return Object.fromEntries(e)},strlen:function(e){return e?.length||0},regexTest:function(e,t,r){return e?.match(new RegExp(t,r))!=null},now:function(){return new Date},date_add:function(e,t,r){return $n()(e).add(t,r).toDate()},toLowerCase:function(e){return e.toLowerCase()},toUpperCase:function(e){return e.toUpperCase()}};function Kv(){for(var n in fs)Wv(n,fs[n])}function Hv(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=zv(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function zv(n,e){if(n){if(typeof n=="string")return ps(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ps(n,e)}}function ps(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function vs(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function bt(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?vs(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):vs(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}Kv();function gs(n,e,t){var r;try{r=pi().apply(n,e)}catch(a){throw a.message="".concat(t.join(".")," :: ").concat(a.message),a}return r}function ms(n,e,t,r){var a;try{a=e.call.apply(e,[n].concat((0,Fe.A)(t)))}catch(o){throw o.message="".concat(r.join(".")," :: ").concat(o.message),o}return a}var Xa=["conjunctions","fields","types","operators","widgets","settings","funcs","ctx"],Hn={asyncFetch:{type:"f",args:["search","offset"]},labelYes:{type:"r"},labelNo:{type:"r"},marks:{type:"r",isArr:!0},validateValue:{type:"f",args:["val","fieldSettings","op","opDef","rightFieldDef"]}},vi=bt(bt({},Hn),{},{factory:{type:"rf"},formatValue:{type:"f",args:["val","fieldDef","wgtDef","isForDisplay","op","opDef","rightFieldDef"]},sqlFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef","rightFieldDef"]},spelFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef","rightFieldDef"]},spelImportValue:{type:"f",args:["val","wgtDef","args"]},mongoFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef"]},elasticSearchFormatValue:{type:"f",args:["queryType","val","op","field","config"]},jsonLogic:{type:"f",args:["val","fieldDef","wgtDef","op","opDef"]},validateValue:{type:"f",args:["val","fieldSettings","op","opDef","rightFieldDef"]},toJS:{type:"f",args:["val"]}}),hs={options:{factory:{type:"rf"}},formatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","isForDisplay","fieldDef"]},mongoFormatOp:{type:"f",args:["field","op","vals","useExpr","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},sqlFormatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},spelFormatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},jsonLogic:{type:"f",ignore:"string",args:["field","op","vals","opDef","operatorOptions","fieldDef"]},elasticSearchQueryType:{type:"f",ignore:"string",args:["valueType"]},textSeparators:{type:"r",isArr:!0}},Jv={formatConj:{type:"f",args:["children","conj","not","isForDisplay"]},sqlFormatConj:{type:"f",args:["children","conj","not"]},spelFormatConj:{type:"f",args:["children","conj","not","omitBrackets"]}},ys={widgetProps:vi,opProps:hs},qv={renderBrackets:{type:"r",isArr:!0},renderSeps:{type:"r",isArr:!0},jsonLogic:{type:"f",ignore:"string",args:["formattedArgs"]},jsonLogicImport:{type:"f",args:["val"]},spelImport:{type:"f",args:["spel"]},formatFunc:{type:"f",args:["formattedArgs","isForDisplay"]},sqlFormatFunc:{type:"f",args:["formattedArgs"]},mongoFormatFunc:{type:"f",args:["formattedArgs"]},spelFormatFunc:{type:"f",args:["formattedArgs"]}},Qv={locale:{mui:{type:"f",args:[],invokeWith:[],ignore:"jl"}},canCompareFieldWithField:{type:"f",args:["leftField","leftFieldConfig","rightField","rightFieldConfig","op"]},formatReverse:{type:"f",args:["q","op","reversedOp","operatorDefinition","revOperatorDefinition","isForDisplay"]},sqlFormatReverse:{type:"f",args:["q"]},spelFormatReverse:{type:"f",args:["q"]},formatField:{type:"f",args:["field","parts","label2","fieldDefinition","config","isForDisplay"]},formatSpelField:{type:"f",args:["field","parentField","parts","partsExt","fieldDefinition","config"]},formatAggr:{type:"f",args:["whereStr","aggrField","operator","value","valueSrc","valueType","opDef","operatorOptions","isForDisplay","aggrFieldDef"]},normalizeListValues:{type:"f",args:["listValues","type","fieldSettings"]},renderConfirm:{type:"f",args:["props"]},useConfirm:{type:"f",args:[]},renderField:{type:"rf"},renderOperator:{type:"rf"},renderFunc:{type:"rf"},renderConjs:{type:"rf"},renderButton:{type:"rf"},renderIcon:{type:"rf"},renderButtonGroup:{type:"rf"},renderValueSources:{type:"rf"},renderFieldSources:{type:"rf"},renderProvider:{type:"rf"},renderSwitch:{type:"rf"},renderSwitchPrefix:{type:"r"},renderItem:{type:"rf"},renderBeforeWidget:{type:"rf"},renderAfterWidget:{type:"rf"},renderBeforeActions:{type:"rf"},renderAfterActions:{type:"rf"},renderRuleError:{type:"rf"}},Yv={fields:{x:{fieldSettings:Hn,widgets:{x:ys},mainWidgetProps:vi}},widgets:{x:vi},conjunctions:{x:Jv},operators:{x:hs},types:{x:{widgets:{x:ys}}},funcs:{x:bt(bt(bt({},qv),Hn),{},{fieldSettings:Hn,args:{x:bt(bt({},Hn),{},{fieldSettings:Hn})}})},settings:Qv},zn=function(e){return(0,Fr.A)(e)=="object"&&e!==null&&!Array.isArray(e)},Os=function(e,t){if(e.__fieldNames)throw new Error("Don't apply `compressConfig()` to extended config");var r=Bt()(e,Xa);delete r.ctx;for(var a=function s(c,d,f,p){if(zn(c)){if(_a(c)&&(c=Po(c)),f[0]==="funcs"&&!d){var v=f[f.length-1];d=Mt({funcs:p.BasicFuncs},v,"funcs","subfields")||void 0,d&&(c.$$key=v)}if(d!==void 0&&zn(d))for(var g in d)Object.prototype.hasOwnProperty.call(d,g)&&(!Object.keys(c).includes(g)||c[g]===void 0&&d[g]!==void 0?c[g]="$$deleted":(c[g]=s(c[g],d[g],[].concat((0,Fe.A)(f),[g]),p),c[g]===void 0&&delete c[g]));for(var m in c)if(Object.prototype.hasOwnProperty.call(c,m)){if(!d||!Object.keys(d).includes(m)){var O;c[m]=s(c[m],(O=d)===null||O===void 0?void 0:O[m],[].concat((0,Fe.A)(f),[m]),p)}c[m]===void 0&&delete c[m]}Object.keys(c).length===0&&(c=void 0)}else Array.isArray(c)&&c.forEach(function(y,b){c[b]=s(c[b],void 0,[].concat((0,Fe.A)(f),[b]),p)});if(!(d!==void 0&&pa(c,d,!0))){if(typeof c=="function")throw new Error("compressConfig: function at ".concat(f.join(".")," should be converted to JsonLogic"));return c}},o=0,u=Xa;o<u.length;o++){var i=u[o];if(i!=="ctx")if(i==="fields")r[i]=wt()(r[i]),a(r[i],{},[i]);else if(i==="funcs"){r[i]=wt()(r[i]||{});for(var l in r[i])a(r[i][l],null,[i,l],{BasicFuncs:X})}else r[i]=wt()(r[i]),a(r[i],t[i],[i])}return r},bs=function(e,t,r){if(!e.settings.useConfigCompress)throw new Error("Please enable `useConfigCompress` in config settings to use decompressConfig()");for(var a={},o=function c(d,f,p){if(zn(f)){zn(d)||(d={});for(var v in f)Object.prototype.hasOwnProperty.call(f,v)&&(f[v]==="$$deleted"?delete d[v]:d[v]=c(d[v],f[v],[].concat((0,Fe.A)(p),[v])))}else Array.isArray(f)?d=wt()(f):d=f;return d},u=function c(d,f,p){var v=!1;if(zn(d)&&Object.prototype.hasOwnProperty.call(d,"$$key")&&d.$$key){var g=Mt({funcs:p.BasicFuncs},d.$$key,"funcs","subfields");if(g)delete d.$$key,d=o(wt()(g),d,f),v=!0;else throw new Error("decompressConfig: basic function not found by key ".concat(d.$$key," at ").concat(f.join(".")))}if(!v){if(zn(d))for(var m in d)Object.prototype.hasOwnProperty.call(d,m)&&(d[m]=c(d[m],[].concat((0,Fe.A)(f),[m]),p));else if(Array.isArray(d)){var O=Hv(d),y;try{for(O.s();!(y=O.n()).done;){var b=y.value;d[b]=c(d[b],[].concat((0,Fe.A)(f),[b]),p)}}catch(A){O.e(A)}finally{O.f()}}}return d},i=0,l=Xa;i<l.length;i++){var s=l[i];s==="ctx"?a[s]=ga()({},t.ctx||{},r||{}):s==="funcs"?(a[s]=wt()(e[s]||{}),u(a[s],[s],{BasicFuncs:X})):s==="fields"?a[s]=wt()(e[s]||{}):(a[s]=wt()(t[s]||{}),o(a[s],e[s]||{},[s]))}return a},Ss=function(e){if(e.__compliled)return e;e=wt()(e);var t={ctx:e.ctx},r=[];return Za(e,e,t,Yv,r),Object.defineProperty(e,"__compliled",{enumerable:!1,writable:!1,value:!0}),e};function Za(n,e,t,r,a){var o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:[];if(e){var u=!o.length;for(var i in r){var l=r[i],s=i==="x"?o:[].concat((0,Fe.A)(o),[i]);if(l.type==="r"){var c=e,d=c[i];if(l.isArr)for(var f in d){var p=Jn(d[f],t,[].concat((0,Fe.A)(s),[f]));p!==d[f]&&(a.push("Compiled ".concat(s.join("."),"[").concat(f,"]")),d[f]=p)}else{var v=Jn(d,t,s,void 0);v!==d&&(a.push("Compiled R ".concat(s.join("."))),c[i]=v)}}else if(l.type==="rf"){var g=e,m=g[i],O=Xv(m,t,s,l.ignore);O!==m&&(a.push("Compiled JL-RF ".concat(s.join("."))),g[i]=O)}else if(l.type==="f"){var y=e,b=y[i],A=Zv(b,t,s,l.args,l.ignore);if(l.invokeWith&&A&&typeof A=="function"){var L;A=(L=A).call.apply(L,[null].concat((0,Fe.A)(l.invokeWith)))}A!==b&&(a.push("Compiled JL-F ".concat(s.join("."))),y[i]=A)}else if(i==="x")for(var S in e){s=[].concat((0,Fe.A)(o),[S]);var R=e[S];Za(n,R,t,l,a,s),R.subfields&&Za(n,R.subfields,t,r,a,s)}else{var N=e[i];Za(n,N,t,l,a,s)}}}}function Xv(n,e,t){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:void 0;return ct(n)?function(a,o){o=o||e?.ctx;var u={props:a,ctx:o},i=gs(n,u,t);typeof i=="string"&&(i={type:i,props:a});var l=Jn(i,{ctx:o},t);return l}:typeof n=="string"?function(a,o){o=o||e?.ctx;var u=n.split(".").reduce(function(s,c){return s?.[c]},o);if(u)return ms(this,u,[a,o],t);var i={type:n,props:a},l=Jn(i,{ctx:o},t);return l}:n}function Zv(n,e,t,r){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;return ct(n)&&a!=="jl"?function(){for(var o=arguments.length,u=new Array(o),i=0;i<o;i++)u[i]=arguments[i];var l=this||e?.ctx,s=(r||[]).reduce(function(d,f,p){return bt(bt({},d),{},(0,te.A)({},f,u[p]))},{args:u,ctx:l}),c=gs(n,s,t);return c}.bind(e?.ctx):typeof n=="string"&&a!=="string"?function(){var o=this||e?.ctx,u=n.split(".").reduce(function(c,d){return c?.[d]},o);if(u){for(var i=arguments.length,l=new Array(i),s=0;s<i;s++)l[s]=arguments[s];return ms(this,u,l,t)}else throw new Error("".concat(t.join(".")," :: Function ").concat(n," is not found in ctx"))}.bind(e?.ctx):n}function eg(n,e){var t;return(e==null||(t=e.components)===null||t===void 0?void 0:t[n])||e.W[n]||e.O[n]}function Jn(n,e,t){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:void 0;if(xo(n)){var a,o=n.type,u=n.props;if(typeof o!="string")throw new Error("renderReactElement for ".concat(t.join("."),": type should be string"));var i=eg(o,e.ctx)||o.toLowerCase(),l;r!==void 0&&(u=bt(bt({},u),{},{key:r})),(a=u)!==null&&a!==void 0&&a.children&&(l=Jn(u.children,e,t),u=bt(bt({},u),{},{children:l}));var s=e.ctx.RCE(i,u);return s}else if(n instanceof Array)return n.map(function(c,d){return Jn(c,e,t,""+d)});return n}var Fs={formatField:function(e,t,r,a,o,u){return u?r:e},fieldSources:["field"],keepInputOnChangeFieldSrc:!0,fieldItemKeysForSearch:["label","path","altLabel","grouplabel"],listKeysForSearch:["title","value"],valueSourcesInfo:{value:{}},fieldSeparator:".",fieldSeparatorDisplay:".",canReorder:!0,canRegroup:!0,canDeleteLocked:!1,canLeaveEmptyGroup:!0,shouldCreateEmptyGroup:!1,canShortMongoQuery:!0,removeEmptyGroupsOnLoad:!0,removeEmptyRulesOnLoad:!0,removeIncompleteRulesOnLoad:!1,removeInvalidMultiSelectValuesOnLoad:!0,optimizeRenderWithInternals:!1,showErrorMessage:!1,setOpOnChangeField:["keep","default"],groupOperators:["some","all","none"],defaultGroupConjunction:"AND",locale:{moment:"en"},valueLabel:"Value",valuePlaceholder:"Value",fieldLabel:"Field",operatorLabel:"Operator",funcLabel:"Function",fieldPlaceholder:"Select field",funcPlaceholder:"Select function",operatorPlaceholder:"Select operator",lockLabel:"Lock",lockedLabel:"Locked",deleteLabel:"Delete",addGroupLabel:"Add group",addCaseLabel:"Add condition",addDefaultCaseLabel:"Add default condition",defaultCaseLabel:"Default:",addRuleLabel:"Add rule",addSubRuleLabel:"Add sub rule",delGroupLabel:"Delete",notLabel:"Not",fieldSourcesPopupTitle:"Select source",valueSourcesPopupTitle:"Select value source",removeRuleConfirmOptions:null,removeGroupConfirmOptions:null};function Cs(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=rg(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function rg(n,e){if(n){if(typeof n=="string")return Ts(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ts(n,e)}}function Ts(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}var kt=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(e.__configId)return e;r&&e.settings.useConfigCompress?e.__compliled?e=wt()(e):e=Ss(e):e=wt()(e),e.settings=Ga()({},Fs,e.settings,va),e.__fieldsCntByType={},e.__funcsCntByType={},e.__fieldNames={},tg(e.types,e),Es(e.fields,e),As(e.funcs,e);var a=e.settings.locale.moment;return a&&$n().locale(a),Object.defineProperty(e,"__configId",{enumerable:!1,writable:!1,value:t||cr()}),iu(e),e};function tg(n,e){for(var t in n){var r=n[t];ng(t,r,e)}}function ng(n,e,t){var r=null,a=null;e.mainWidget=e.mainWidget||Object.keys(e.widgets).filter(function(d){return d!="field"&&d!="func"})[0];for(var o in e.widgets){var u=e.widgets[o];if(u.operators){var i=u.operators;e.excludeOperators&&(i=i.filter(function(d){return!e.excludeOperators.includes(d)})),r=ou(r,i)}u.defaultOperator&&(a=u.defaultOperator),o==e.mainWidget&&(u=ga()({},{widgetProps:e.mainWidgetProps||{}},u)),e.widgets[o]=u}e.valueSources||(e.valueSources=Object.keys(t.settings.valueSourcesInfo));var l=Cs(e.valueSources),s;try{for(l.s();!(s=l.n()).done;){var c=s.value;c!="value"&&!e.widgets[c]&&(e.widgets[c]={})}}catch(d){l.e(d)}finally{l.f()}!e.operators&&r&&(e.operators=Array.from(new Set(r))),!e.defaultOperator&&a&&(e.defaultOperator=a)}function Es(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];for(var r in n)gi(n[r],e,[].concat((0,Fe.A)(t),[r])),n[r].subfields&&Es(n[r].subfields,e,[].concat((0,Fe.A)(t),[r]))}function As(n,e){var t,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(n){var a=(e==null||(t=e.settings)===null||t===void 0?void 0:t.fieldSeparator)||".";for(var o in n){var u=[].concat((0,Fe.A)(r),[o]).join(a),i=n[o];if(i.returnType&&(e.__funcsCntByType[i.returnType]||(e.__funcsCntByType[i.returnType]=0),e.__funcsCntByType[i.returnType]++),gi(i,e,null,!1),i.args){for(var l in i.args)gi(i.args[l],e,null,!0);var s=Object.keys(i.args),c=!0,d=Cs(s.reverse()),f;try{for(d.s();!(f=d.n()).done;){var p=f.value,v=i.args[p];!c&&v.isOptional&&(hn.info("Arg ".concat(p," for func ").concat(u," can't be optional")),delete v.isOptional),v.isOptional||(c=!1)}}catch(g){d.e(g)}finally{d.f()}}i.subfields&&As(i.subfields,e,[].concat((0,Fe.A)(r),[o]))}}}function gi(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=null,o=null,u=e.types[n.type||n.returnType],i=!!n.returnType,l=n.excludeOperators||[];if(n.type!="!struct"&&n.type!="!group"){var s=["listValues","treeValues","allowCustomValues","validateValue"];n.fieldSettings||(n.fieldSettings={});for(var c=0,d=s;c<d.length;c++){var f=d[c];n[f]&&(n.fieldSettings[f]=n[f],delete n[f])}if(n.fieldSettings.listValues&&e.settings.normalizeListValues&&(n.fieldSettings.listValues=e.settings.normalizeListValues.call(e.ctx,n.fieldSettings.listValues,n.type,n.fieldSettings)),n.fieldSettings.treeValues&&e.settings.normalizeListValues&&(n.fieldSettings.treeValues=e.settings.normalizeListValues.call(e.ctx,n.fieldSettings.treeValues,n.type,n.fieldSettings)),!u){n.disabled=!0;return}if(!r&&!i&&(e.__fieldsCntByType[n.type]||(e.__fieldsCntByType[n.type]=0),e.__fieldsCntByType[n.type]++),r&&(n._isFuncArg=!0),!i){n.mainWidget=n.mainWidget||u.mainWidget,n.valueSources=n.valueSources||u.valueSources;var p=u.excludeOperators||[];n.widgets||(n.widgets={});var v=function(){var A=n.widgets[g]||{},L=u.widgets[g]||{};if(!r){var S=[].concat((0,Fe.A)(l),(0,Fe.A)(p)),R=n.preferWidgets&&(g=="field"||n.preferWidgets.includes(g))||S.length>0;if(A.operators){var N=A.operators.filter(function(x){return!S.includes(x)});a=[].concat((0,Fe.A)(a||[]),(0,Fe.A)(N))}else if(R&&L.operators){var M=L.operators.filter(function(x){return!S.includes(x)});a=[].concat((0,Fe.A)(a||[]),(0,Fe.A)(M))}A.defaultOperator&&(o=A.defaultOperator)}g==n.mainWidget&&(A=ga()({},{widgetProps:n.mainWidgetProps||{}},A)),n.widgets[g]=A};for(var g in u.widgets)v()}r||(!n.operators&&a&&(n.operators=Array.from(new Set(a))),n._origDefaultOperator=n.defaultOperator,!n.defaultOperator&&o&&(n.defaultOperator=o))}var m=ag(e,t),O=m.fieldName,y=m.inGroup;O&&(n.fieldName=O,e.__fieldNames[O]||(e.__fieldNames[O]=[]),e.__fieldNames[O].push({fullPath:t,inGroup:y}))}function ag(n,e){if(!e)return{};var t=n.settings.fieldSeparator,r=(0,Fe.A)(e).reduce(function(i,l,s,c){var d=i.computedPath,f=i.computed,p=i.inGroup,v=[].concat((0,Fe.A)(c.slice(0,s)),[l]),g=Mt(n,v);return g?.type==="!group"&&s<c.length-1?(p=v.join(t),d=[]):g!=null&&g.fieldName?(f=!0,d=[g.fieldName]):d=[].concat((0,Fe.A)(d),[l]),{computedPath:d,computed:f,inGroup:p}},{computedPath:[],computed:!1,inGroup:void 0}),a=r.computedPath,o=r.computed,u=r.inGroup;return o?{fieldName:a.join(t),inGroup:u}:{}}var og=an().mark(qn),ig=an().mark(Ls),ug=An;function qn(n){return an().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(mi(n,n.funcs||{},[]),"t0",1);case 1:case"end":return t.stop()}},og)}function Ls(n){return an().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(mi(n,n.fields||{},[]),"t0",1);case 1:case"end":return t.stop()}},ig)}function mi(n,e,t){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"subfields";return an().mark(function a(o){var u,i,l;return an().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:u=(n==null||(o=n.settings)===null||o===void 0?void 0:o.fieldSeparator)||".",c.t0=an().keys(e);case 2:if((c.t1=c.t0()).done){c.next=13;break}if(i=c.t1.value,l=e[i],!l[r]){c.next=9;break}return c.delegateYield(mi(n,l[r],[].concat((0,Fe.A)(t),[i]),r),"t2",7);case 7:c.next=11;break;case 9:return c.next=11,[[].concat((0,Fe.A)(t),[i]).join(u),l];case 11:c.next=2;break;case 13:case"end":return c.stop()}},a)})()}var Mt=function(e,t){var r,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"fields",o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"subfields";if(!t)return null;if(t=="!case_value")return{type:"case_value",mainWidget:"case_value",widgets:{case_value:e.widgets.case_value}};var u=(e==null||(r=e.settings)===null||r===void 0?void 0:r.fieldSeparator)||".",i=Pr(t,e),l=e[a];if(!l)return null;for(var s=l,c=null,d=[],f=0;f<i.length;f++){var p=i[f];d.push(p);var v=d.join(u);c=s[v],f<i.length-1&&(c&&c[o]?(s=c[o],d=[]):c=null)}return c},eo=function(e,t){var r,a,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,u=e.settings.fieldSeparator,i=[o].concat((0,Fe.A)(t.split(u))).filter(function(c){return c!=null}),l=t,s=(r=e.__fieldNames[l])===null||r===void 0||(a=r.find)===null||a===void 0||(a=a.call(r,function(c){var d=c.inGroup;return d?o?.startsWith(d):!0}))===null||a===void 0?void 0:a.fullPath;return(s||i).join(u)},hi=function(e,t){if(!t)return null;var r=Mt(e,t,"funcs","subfields");if(!r)return null;var a=r.returnType,o=r.args,u=Object.fromEntries(Object.entries(o||{}).map(function(l){var s=(0,Le.A)(l,2),c=s[0],d=s[1],f=Bt()(d,["type","valueSources","defaultValue","fieldSettings","isOptional"]);return[c,f]})),i={returnType:a,args:u};return i},_r=function(e,t){if(!t)return null;var r=Mt(e,t,"funcs","subfields");if(!r)return null;var a=e.types[r.returnType]||{},o=Ga()({},a,r,va);return o.type=r.returnType||r.type,o},yi=function(e,t,r){var a=_r(e,t);if(!a)return null;var o=a.args&&a.args[r]||null;if(!o)return null;var u=e.types[o.type]||{},i=Ga()({},u,o||{},va);return i},ws=function(e,t){var r,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!t)return!1;var o=(a==null||(r=a.settings)===null||r===void 0?void 0:r.fieldSeparator)||".",u=Oi(e,a),i=Oi(t,a);return u.startsWith(i+o)},Oi=function(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof e=="string")return e;var a=(r==null||(t=r.settings)===null||t===void 0?void 0:t.fieldSeparator)||".";return Pr(e,r).join(a)},Pr=function(e){var t,r,a,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!e)return[];if(Array.isArray(e))return e;var u=(o==null||(t=o.settings)===null||t===void 0?void 0:t.fieldSeparator)||".";if(e!=null&&e.func)return Array.isArray(e.func)?e.func:e.func.split(u);if(e!=null&&(r=e.get)!==null&&r!==void 0&&r.call(e,"func")){var i;return e==null||(i=e.get)===null||i===void 0?void 0:i.call(e,"func").split(u)}return(e==null||(a=e.split)===null||a===void 0?void 0:a.call(e,u))||[]},lg=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!e)return null;var a=t.settings.fieldSeparator,o=Pr(e,t);return r?o:o.map(function(u,i,l){return l.slice(0,i+1)}).map(function(u){return u.join(a)})},js=function(e){var t;if(!e)return null;if((0,Fr.A)(e)=="object"){if(!e.func&&e.type)return"field";if(e.func)return e.func&&e.arg?null:"func"}return e!=null&&(t=e.get)!==null&&t!==void 0&&t.call(e,"func")?e!=null&&e.get("arg")?null:"func":"field"},je=function(e,t){var r;if(!t)return null;if((0,Fr.A)(t)=="object"){if(!t.func&&t.type)return t;if(t.func)return t.func&&t.arg?yi(e,t.func,t.arg):_r(e,t.func)}if(t!=null&&(r=t.get)!==null&&r!==void 0&&r.call(t,"func"))return t!=null&&t.get("arg")?yi(e,t.get("func"),t.get("arg")):_r(e,t.get("func"));var a=Mt(e,t);if(!a)return null;var o=e.types[a.type]||{},u=Ga()({},o,a||{},va);return u},dr=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!t)return null;var a=e.operators[t];if(r){var o=je(e,r),u=Ar(e,r,t,null),i=e.widgets[u]||{},l=(o&&o.widgets?o.widgets[u]:{})||{},s=(i.opProps||{})[t],c=(l.opProps||{})[t],d=ga()({},a,s,c);return d}else return a},at=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(!t||!(r||a)&&o!=="const"&&t!=="!case_value")return null;var u=je(e,t);a||(a=Ar(e,t,r,o));var i=e.widgets[a]||{},l=(u&&u.widgets?u.widgets[a]:{})||{},s=l.widgetProps||{},c=(o==="value"||!o)&&u?.fieldSettings||{},d=ga()({},i,s,c);return d},Rs=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=e.settings.fieldSeparator,a=Pr(t,e),o=t?Mt(e,t):e,u=o,i=null,l=[];do{var s,c=u===e?e.fields:(s=u)===null||s===void 0?void 0:s.subfields;if(!c||!Object.keys(c).length){u=i=null;break}i=Object.keys(c)[0],l.push(i),u=c[i]}while(u.type=="!struct"||u.type=="!group");return(a||[]).concat(l).join(r)};function Ps(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function xs(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ps(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Ps(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var sg=function(e,t){var r={usedFields:[]},a=Is(e,t,r);if(a)return xs(xs({},a),r)},Is=function(e,t,r){if(e){var a=e.get("type"),o=e.get("children1");if((a==="group"||a==="rule_group")&&o&&o.size)return cg(e,t,r);if(a==="rule")return dg(e,t,r)}},cg=function(e,t,r){var a=e.get("properties")||new be.Map,o=e.get("children1"),u=e.get("id"),i=o.map(function(d){return Is(d,t,r)}).filter(function(d){return typeof d<"u"});if(i.size){var l=a.get("conjunction");l||(l=Ht(t));var s=a.get("not"),c={id:u,rules:i.toList(),condition:l.toUpperCase(),not:s};return c}},dg=function(e,t,r){var a,o=e.get("properties")||new be.Map,u=e.get("id"),i=o.get("operator"),l=o.get("operatorOptions"),s=o.get("field"),c=o.get("value"),d=o.get("valueSrc"),f=o.get("valueType"),p=c.filter(function(x){return x===void 0}).size>0;if(!(s==null||i==null||p)){var v=je(t,s)||{},g=dr(t,i,s)||{},m=v.type||"undefined",O=kr(g),y=t.types[v.type]||{},b=ln(s,t,r);if(!(c.size<O)){r.usedFields.indexOf(s)==-1&&r.usedFields.push(s),c=c.toArray(),d=d.toArray(),f=((a=f)===null||a===void 0?void 0:a.toArray())||[];for(var A=[],L=0;L<c.length;L++){var S={type:f[L],value:c[L]};if(A.push(S),d[L]=="field"){var R=c[L];r.usedFields.indexOf(R)==-1&&r.usedFields.push(R)}}var N=l?l.toJS():null;N&&!Object.keys(N).length&&(N=null);var M={id:u,fieldName:b,type:m,input:y.mainWidget,operator:i};return N&&(M.operatorOptions=N),M.values=A,M}}};function Vs(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Ds(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Vs(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Vs(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Ns(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=fg(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function fg(n,e){if(n){if(typeof n=="string")return ks(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ks(n,e)}}function ks(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}var pg=function(e,t){var r={usedFields:[],errors:[]},a=kt(t,void 0,!1),o=Ms(e,a,r,!0),u=r.errors,i=r.usedFields,l=a.settings.fieldSeparator,s={},c=Ns(i),d;try{for(c.s();!(d=c.n()).done;)for(var f=d.value,p=Pr(f,t),v=je(a,f)||{},g=s,m=0;m<p.length;m++){var O=p[m],y=je(a,p.slice(0,m+1))||{};m!=p.length-1?y.type=="!group"&&y.mode!="struct"?(g[O]||(g[O]=[{}]),g=g[O][0]):(g[O]||(g[O]={}),g=g[O]):g[O]||(g[O]=null)}}catch(b){c.e(b)}finally{c.f()}return{errors:u,logic:o,data:s}},Ms=function(e,t,r,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(e){var u=e.get("type"),i=e.get("properties")||new be.Map,l=i.get("isLocked"),s=t.settings.jsonLogic.lockedOp,c;return u==="group"||u==="rule_group"?c=vg(e,t,r,a,o):u==="rule"&&(c=gg(e,t,r,o)),l&&c&&s&&(c=(0,te.A)({},s,c)),c}},vg=function(e,t,r,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,u=e.get("type"),i=e.get("properties")||new be.Map,l=i.get("mode"),s=e.get("children1")||new be.List,c=i.get("field"),d=i.get("conjunction");d||(d=Ht(t));var f=t.conjunctions[d],p=f.jsonLogicConj||d.toLowerCase(),v=i.get("not"),g=u==="rule_group"&&!a,m=g&&l!="struct"?c:o,O=i.get("operator"),y=O&&dr(t,O,c)||null,b=_s(t,i,r,O,o),A=g&&(!O||y.cardinality==0),L=s.map(function(W){return Ms(W,t,r,!1,m)}).filter(function(W){return typeof W<"u"});if(g&&l!="struct"&&!A){if(b==null)return}else if(!L.size)return;var S={};if(L.size==1&&!a?S=L.first():S[p]=L.toList().toJS(),v&&(S={"!":S}),g&&l!="struct"){var R=Si(r,t,c,o);if(A){var N=O||"some";S=(0,te.A)({},N,[R,S])}else{var M=L.size?{filter:[R,S]}:R,x={reduce:[M,{"+":[1,{var:"accumulator"}]},0]};S=$s(t,i,x,b,O)}}return S},gg=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=e.get("properties")||new be.Map,u=o.get("field"),i=o.get("fieldSrc"),l=o.get("operator"),s=o.get("operatorOptions");if(s=s?s.toJS():null,s&&!Object.keys(s).length&&(s=null),!(u==null||l==null)){var c=je(t,u)||{},d=dr(t,l,u)||{},f=d.reversedOp,p=dr(t,f,u)||{},v=!1;if(!d.jsonLogic&&!p.jsonLogic){r.errors.push("Operator ".concat(l," is not supported"));return}if(!d.jsonLogic&&p.jsonLogic){v=!0;var g=[f,l];l=g[0],f=g[1];var m=[p,d];d=m[0],p=m[1]}var O=_s(t,o,r,l,a);if(O!==void 0){var y=i==="func"?Gs(r,t,u,a):Si(r,t,u,a);if(y!==void 0)return $s(t,o,y,O,l,s,c,v)}}},_s=function(e,t,r,a,o){var u=t.get("field"),i=t.get("valueSrc"),l=t.get("valueType"),s=je(e,u)||{},c=dr(e,a,u)||{},d=kr(c),f=t.get("value"),p=t.get("asyncListValues");if(f!=null){var v=[],g=[],m=r.usedFields,O=f.map(function(b,A){var L=i?i.get(A):null,S=l?l.get(A):null,R=Rn(b,L,e),N=Ar(e,u,a,L),M=Cr()(at(e,u,a,N,L),["factory"]),x=bi(r,e,R,L,S,M,s,a,c,o,p);return x!==void 0&&(v.push(L),g.push(S)),x}),y=O.filter(function(b){return b===void 0}).size>0;if(O.size<d||y){r.usedFields=m;return}return d>1?O.toArray():d==1?O.first():null}},bi=function(e,t,r,a,o,u,i,l,s){var c=arguments.length>9&&arguments[9]!==void 0?arguments[9]:null,d=arguments.length>10?arguments[10]:void 0;if(r!==void 0){var f;if(a=="field")f=Si(e,t,r,c);else if(a=="func")f=Gs(e,t,r,c);else if(typeof u.jsonLogic=="function"){var p=u.jsonLogic,v=[r,Ds(Ds({},Bt()(i,["fieldSettings","listValues"])),{},{asyncListValues:d}),Cr()(u,An)];l&&(v.push(l),v.push(s)),f=p.call.apply(p,[t.ctx].concat(v))}else f=r;return f}},Gs=function(e,t,r){var a,o,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=(a=r.get)===null||a===void 0?void 0:a.call(r,"func"),l=(o=r.get)===null||o===void 0?void 0:o.call(r,"args"),s=_r(t,i),c=Pr(i,t),d=c[c.length-1];if(!s){e.errors.push("Func ".concat(i," is not defined in config"));return}if(!(s!=null&&s.jsonLogic)){e.errors.push("Func ".concat(i," is not supported"));return}var f={},p=[],v=[];for(var g in s.args){var m,O=s.args[g],y=je(t,O),b=O.defaultValue,A=O.isOptional,L=b!=null&&b.func?"func":"value",S=l?l.get(g):void 0,R=S?S.get("value"):void 0,N=S?S.get("valueSrc"):void 0;N!=="func"&&(m=R)!==null&&m!==void 0&&m.toJS&&(R=R.toJS());var M=null,x=Ar(t,O,M,N),W=Cr()(at(t,O,M,x,N),["factory"]),B=bi(e,t,R,N,O.type,W,y,null,null,u);if(R!=null&&B===void 0){N!="func"&&e.errors.push("Can't format value of arg ".concat(g," for func ").concat(i));return}var k=void 0;if(B===void 0&&!A&&b!=null){var Q=Ar(t,O,M,L),K=Cr()(at(t,O,M,Q,L),["factory"]);if(k=bi(e,t,b,L,O.type,K,y,null,null,u),k===void 0){L!="func"&&e.errors.push("Can't format default value of arg ".concat(g," for func ").concat(i));return}}var J=B??k;if(J!==void 0){if(p.length){var G=Ns(p),re;try{for(G.s();!(re=G.n()).done;){var ue=re.value;f[ue]=void 0}}catch(Oe){G.e(Oe)}finally{G.f()}p=[]}f[g]=J}else A||v.push(g),p.push(g)}if(!v.length){var de=Object.values(f),fe;if(typeof s.jsonLogic=="function"){var ae=s.jsonLogic,ne=[f];fe=ae.call.apply(ae,[t.ctx].concat(ne))}else{var ve=s.jsonLogic||d,ce=!!s.jsonLogicIsMethod;if(ce){var se=de[0],Te=de.slice(1);Te.length?fe={method:[se,ve,Te]}:fe={method:[se,ve]}}else fe=(0,te.A)({},ve,de)}return fe}},Si=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=t.settings,u=o.fieldSeparator,i=o.jsonLogic,l;if(r){Array.isArray(r)&&(r=r.join(u));var s=je(t,r)||{},c=ln(r,t,e,a),d=s.jsonLogicVar||(s.type=="!group"?i.groupVarKey:"var");l=(0,te.A)({},d,c),e.usedFields.indexOf(r)==-1&&e.usedFields.push(r)}return l},mg=function(e,t,r,a){var o,u=e,i=kr(t),l=(o=t._jsonLogicIsRevArgs)!==null&&o!==void 0?o:!1;typeof t.jsonLogic=="string"&&(u=t.jsonLogic);var s=["<","<=",">",">="],c=["==","!="],d=function(p,v,g,m,O){return i==0&&c.includes(u)?(0,te.A)({},u,[r,null]):i==0?(0,te.A)({},u,r):i==1&&l?(0,te.A)({},u,[a,r]):i==1?(0,te.A)({},u,[r,a]):i==2&&s.includes(u)?(0,te.A)({},u,[a[0],r,a[1]]):(0,te.A)({},u,[r].concat((0,Fe.A)(a)))};return d},$s=function(e,t,r,a,o){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,s=t.get("field"),c=dr(e,o,s)||{},d=typeof c.jsonLogic=="function"?c.jsonLogic:mg(o,c,r,a),f=[r,o,a,Cr()(c,Mn),u,i],p=d.call.apply(d,[e.ctx].concat(f));return l&&(p={"!":p}),p};function hg(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=yg(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function yg(n,e){if(n){if(typeof n=="string")return Us(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Us(n,e)}}function Us(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Bs(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Ws(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Bs(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Bs(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Ks=function(e){return(0,Fr.A)(e)=="object"&&e!==null&&!Array.isArray(e)},Og=function(e,t){return Hs(e,t,!1)},Hs=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a={errors:[]},o=kt(t,void 0,!1),u=Fi([],e,o,a);return r?[u,a.errors]:(a.errors.length&&console.warn("Errors while exporting to MongoDb:",a.errors),u)},Fi=function(e,t,r,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:void 0,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:void 0;if(t){var s=t.get("type");if(s==="group"||s==="rule_group")return bg(e,t,r,a,o,u,i,l);if(s==="rule")return Sg(e,t,r,a,o,u,i,l)}},bg=function(e,t,r,a){var o,u,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:void 0,c=arguments.length>7&&arguments[7]!==void 0?arguments[7]:void 0,d=t.get("type"),f=t.get("properties")||new be.Map,p=t.get("children1")||new be.List,v=r.settings,g=v.canShortMongoQuery,m=v.fieldSeparator,O=m,y=e.filter(function(ne){return ne.get("type")=="rule_group"}).length>0,b=e.filter(function(ne){return ne.get("type")=="rule_group"}).map(function(ne){return ne.get("properties").get("field")}).slice(-1).pop(),A=y&&b,L=d==="rule_group"?f.get("field"):null,S=d==="rule_group"?f.get("operator"):null,R=S?(o=(u=r.operators[S])===null||u===void 0?void 0:u.cardinality)!==null&&o!==void 0?o:1:void 0,N=ln(L,r,a,A),M=je(r,L)||{},x=M.mode,W=L&&x==="array"&&R>=1,B=i?!f.get("not"):f.get("not"),k=p.map(function(ne){return Fi([].concat((0,Fe.A)(e),[t]),ne,r,a,B,x!="array",x=="array"?function(ve){return"$$el".concat(O).concat(ve)}:void 0)}).filter(function(ne){return typeof ne<"u"});if(!(!W&&!k.size)){var Q=f.get("conjunction");Q||(Q=Ht(r));var K=r.conjunctions[Q],J=K.reversedConj;if(B&&J&&(Q=J,K=r.conjunctions[Q]),!!K){var G=K.mongoConj,re;if(k.size==1)re=k.first();else if(k.size>1){var ue=k.toList().toJS(),de=g&&G=="$and";de&&(re=ue.reduce(function(ne,ve){if(ne){for(var ce in ve){if(ce[0]=="$"){ne=void 0;break}if(ne[ce]==null)ne[ce]=ve[ce];else{var se=ne[ce],Te=ve[ce];Ks(se)||(se={$eq:se}),Ks(Te)||(Te={$eq:Te});var Oe=Object.keys(se)[0],Re=Object.keys(Te)[0];if(Oe==Re){ne=void 0;break}ne[ce]=Object.assign({},se,Te)}}return ne}},{})),re||(re=(0,te.A)({},G,ue))}if(L)if(x=="array"){var fe={$size:{$ifNull:["$"+N,[]]}},ae=re?{$size:{$ifNull:[{$filter:{input:"$"+N,as:"el",cond:re}},[]]}}:fe;re=Fi(e,t.set("type","rule"),r,a,!1,!1,function(ne){return ae},fe),re={$expr:re}}else re=(0,te.A)({},N,{$elemMatch:re});return re}}},Sg=function(e,t,r,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:void 0,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:void 0,s=t.get("properties")||new be.Map,c=e.filter(function(se){return se.get("type")=="rule_group"}).length>0,d=e.filter(function(se){return se.get("type")=="rule_group"}).map(function(se){return se.get("properties").get("field")}).slice(-1).pop(),f=c&&d,p=s.get("operator"),v=s.get("operatorOptions"),g=s.get("field"),m=s.get("fieldSrc"),O=s.get("value"),y=s.get("valueSrc"),b=s.get("valueType"),A=s.get("asyncListValues");if(!(g==null||p==null||O===void 0)){var L=je(r,g)||{},S=dr(r,p,g)||{},R=S.reversedOp,N=dr(r,R,g)||{},M=kr(S),x=o;if(x&&R){var W=[R,p];p=W[0],R=W[1];var B=[N,S];S=B[0],N=B[1],x=!1}var k,Q=!1;if(m=="func"){var K=zs(a,r,g,f),J=(0,Le.A)(K,2);k=J[0],Q=J[1]}else k=ln(g,r,a,f),i&&(Q=!0,k=i(k));if(k!=null){var G=[],re=[],ue;if(O!=null){var de=O.map(function(se,Te){var Oe=y?y.get(Te):null,Re=b?b.get(Te):null,Ve=Rn(se,Oe,r),Ue=Ar(r,g,p,Oe),Ye=Cr()(at(r,g,p,Ue,Oe),["factory"]),qe=Ci(a,r,Ve,Oe,Re,Ye,L,f,p,S,A),Be=(0,Le.A)(qe,2),ar=Be[0],nr=Be[1];return ar!==void 0&&(Q=Q||nr,G.push(Oe),re.push(Re)),ar}),fe=de.filter(function(se){return se===void 0}).size>0;if(de.size<M||fe)return;ue=M>1?de.toArray():M==1?de.first():null}var ae=Q&&u,ne=S.mongoFormatOp;if(!ne){a.errors.push("Operator ".concat(p," is not supported"));return}var ve=[k,p,l!==void 0&&ue==null?l:ue,Q,G.length>1?G:G[0],re.length>1?re:re[0],Cr()(S,Mn),v,L],ce=ne.call.apply(ne,[r.ctx].concat(ve));return ae&&(ce={$expr:ce}),x&&(ce={$not:ce}),ce}}},Ci=function(e,t,r,a,o,u,i,l,s,c,d){if(r===void 0)return[void 0,!1];var f,p=!1;if(a=="field"){var v=Fg(e,t,r,l),g=(0,Le.A)(v,2);f=g[0],p=g[1]}else if(a=="func"){var m=zs(e,t,r,l),O=(0,Le.A)(m,2);f=O[0],p=O[1]}else if(typeof u.mongoFormatValue=="function"){var y=u.mongoFormatValue,b=[r,Ws(Ws({},Bt()(i,["fieldSettings","listValues"])),{},{asyncListValues:d}),Cr()(u,An)];s&&(b.push(s),b.push(c)),f=y.call.apply(y,[t.ctx].concat(b))}else f=r;return[f,p]},Fg=function(e,t,r,a){var o=t.settings.fieldSeparator,u,i=!0;if(r){var l=je(t,r)||{},s=Pr(r,t),c=Sa(r,t),d=c?c.join(o):null,f=t.settings.formatField,p=ln(r,t,e,a),v=f(p,s,d,l,t,!1);u="$"+v}return[u,i]},zs=function(e,t,r,a){var o,u,i=!0,l,s=(o=r.get)===null||o===void 0?void 0:o.call(r,"func"),c=(u=r.get)===null||u===void 0?void 0:u.call(r,"args"),d=_r(t,s);if(!d)return e.errors.push("Func ".concat(s," is not defined in config")),[void 0,!1];var f=Pr(s,t),p=f[f.length-1],v=d.mongoFunc||p,g=d.mongoArgsAsObject,m={},O=0,y=void 0,b=[],A=[];for(var L in d.args){var S;O++;var R=d.args[L],N=je(t,R),M=R.defaultValue,x=R.isOptional,W=M!=null&&M.func?"func":"value",B=c?c.get(L):void 0,k=B?B.get("value"):void 0,Q=B?B.get("valueSrc"):void 0;Q!=="func"&&(S=k)!==null&&S!==void 0&&S.toJS&&(k=k.toJS());var K=B?B.get("asyncListValues"):void 0,J=null,G=Ar(t,R,J,Q),re=Cr()(at(t,R,J,G,Q),["factory"]),ue=Ci(e,t,k,Q,R.type,re,N,a,null,null,K),de=(0,Le.A)(ue,2),fe=de[0],ae=de[1];if(k!=null&&fe===void 0)return Q!="func"&&e.errors.push("Can't format value of arg ".concat(L," for func ").concat(s)),[void 0,!1];var ne=void 0;if(fe===void 0&&!x&&M!=null){var ve=Ar(t,R,J,W),ce=Cr()(at(t,R,J,ve,W),["factory"]),se=void 0,Te=Ci(e,t,M,W,R.type,ce,N,a,null,null,K),Oe=(0,Le.A)(Te,2);if(ne=Oe[0],se=Oe[1],ne===void 0)return W!="func"&&e.errors.push("Can't format default value of arg ".concat(L," for func ").concat(s)),[void 0,!1]}var Re=fe??ne;if(Re!==void 0){if(b.length){var Ve=hg(b),Ue;try{for(Ve.s();!(Ue=Ve.n()).done;){var Ye=Ue.value;m[Ye]=void 0}}catch(ar){Ve.e(ar)}finally{Ve.f()}b=[]}m[L]=Re,y=Re}else x||A.push(L),b.push(L)}if(A.length)return[void 0,!1];if(typeof d.mongoFormatFunc=="function"){var qe=d.mongoFormatFunc,Be=[m];l=qe.call.apply(qe,[t.ctx].concat(Be))}else{if(d.mongoFormatFunc===null)return e.errors.push("Functon ".concat(v," is not supported")),[void 0,!1];g?l=(0,te.A)({},v,m):O==1&&y!==void 0?l=(0,te.A)({},v,y):l=(0,te.A)({},v,Object.values(m))}return[l,i]};function Cg(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Tg(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function Tg(n,e){if(n){if(typeof n=="string")return Js(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Js(n,e)}}function Js(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function qs(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Qs(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?qs(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):qs(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Eg=function(e,t){return Ys(e,t,!1)},Ys=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a={errors:[]},o=kt(t,void 0,!1),u=Xs(e,o,a);return r?[u,a.errors]:(a.errors.length&&console.warn("Errors while exporting to SQL:",a.errors),u)},Xs=function(e,t,r){if(e){var a=e.get("type"),o=e.get("children1");if(a==="group"||a==="rule_group")return Ag(e,t,r);if(a==="rule")return wg(e,t,r)}},Ag=function(e,t,r){var a=e.get("type"),o=e.get("properties")||new be.Map,u=e.get("children1")||new be.List,i=a==="rule_group",l=i?o.get("field"):null,s=je(t,l)||{},c=s.mode;c=="array"&&r.errors.push("Aggregation is not supported for ".concat(l));var d=o.get("not"),f=!1,p=u.map(function(m){return Xs(m,t,r)}).filter(function(m){return typeof m<"u"});if(!(!f&&!p.size)){var v=o.get("conjunction");v||(v=Ht(t));var g=t.conjunctions[v];return g.sqlFormatConj(p,v,d)}},Lg=function(e,t){var r=t.sqlOp||e,a=kr(t),o;return a==0?o=function(i,l,s,c,d,f,p,v){return"".concat(i," ").concat(r)}:a==1?o=function(i,l,s,c,d,f,p,v){return"".concat(i," ").concat(r," ").concat(s)}:a==2&&(o=function(i,l,s,c,d,f,p,v){var g,m,O=s==null||(g=s.first)===null||g===void 0?void 0:g.call(s),y=s==null||(m=s.get)===null||m===void 0?void 0:m.call(s,1);return"".concat(i," ").concat(r," ").concat(O," AND ").concat(y)}),o},wg=function(e,t,r){var a=e.get("properties")||new be.Map,o=a.get("field"),u=a.get("fieldSrc"),i=a.get("operator"),l=a.get("operatorOptions"),s=a.get("valueSrc"),c=a.get("valueType"),d=a.get("value"),f=a.get("asyncListValues");if(!(o==null||i==null)){var p=je(t,o)||{},v=dr(t,i,o)||{},g=v.reversedOp,m=dr(t,g,o)||{},O=kr(v),y=!1,b=v.sqlOp||v.sqlFormatOp,A=m.sqlOp||m.sqlFormatOp;if(!b&&!A){r.errors.push("Operator ".concat(i," is not supported"));return}if(!b&&A){y=!0;var L=[g,i];i=L[0],g=L[1];var S=[m,v];v=S[0],m=S[1]}var R=[],N=[],M;if(d!=null){var x=d.map(function(J,G){var re=s?s.get(G):null,ue=c?c.get(G):null,de=Rn(J,re,t),fe=Ar(t,o,i,re),ae=Cr()(at(t,o,i,fe,re),["factory"]),ne=Ti(r,t,de,re,ue,ae,p,i,v,f);return ne!==void 0&&(R.push(re),N.push(ue)),ne}),W=x.filter(function(J){return J===void 0}).size>0;if(W||x.size<O)return;M=O==1?x.first():x}var B=v.sqlFormatOp||Lg(i,v);if(!B){r.errors.push("Operator ".concat(i," is not supported"));return}var k=u=="func"?ec(r,t,o):Zs(r,t,o);if(k!=null){var Q=[k,i,M,R.length>1?R:R[0],N.length>1?N:N[0],Cr()(v,Mn),l,p],K;if(K=B.call.apply(B,[t.ctx].concat(Q)),y&&(K=t.settings.sqlFormatReverse(K)),K===void 0){r.errors.push("Operator ".concat(i," is not supported for value source ").concat(R.join(", ")));return}return K}}},Ti=function(e,t,r,a,o,u,i,l,s,c){if(r!==void 0){var d;if(a=="field")d=Zs(e,t,r);else if(a=="func")d=ec(e,t,r);else if(typeof u.sqlFormatValue=="function"){var f=u.sqlFormatValue,p=[r,Qs(Qs({},Bt()(i,["fieldSettings","listValues"])),{},{asyncListValues:c}),Cr()(u,An)];if(l&&(p.push(l),p.push(s)),a=="field"){var v=je(t,r)||{};p.push(v)}d=f.call.apply(f,[t.ctx].concat(p))}else Array.isArray(r)?d=r.map(function(g){return yn.escape(g)}):d=yn.escape(r);return d}},Zs=function(e,t,r){if(r){var a=t.settings.fieldSeparator,o=je(t,r)||{},u=Pr(r,t),i=Sa(r,t),l=i?i.join(a):null,s=t.settings.formatField,c=ln(r,t,e,null,{useTableName:!0}),d=s(c,u,l,o,t);return d}},ec=function(e,t,r){var a,o,u=(a=r.get)===null||a===void 0?void 0:a.call(r,"func"),i=(o=r.get)===null||o===void 0?void 0:o.call(r,"args"),l=_r(t,u);if(!l){e.errors.push("Func ".concat(u," is not defined in config"));return}var s=Pr(u,t),c=s[s.length-1],d=l.sqlFunc||c,f={},p=[],v=[];for(var g in l.args){var m,O=l.args[g],y=je(t,O),b=O.defaultValue,A=O.isOptional,L=b!=null&&b.func?"func":"value",S=i?i.get(g):void 0,R=S?S.get("value"):void 0,N=S?S.get("valueSrc"):void 0;N!=="func"&&(m=R)!==null&&m!==void 0&&m.toJS&&(R=R.toJS());var M=S?S.get("asyncListValues"):void 0,x=Ti(e,t,R,N,O.type,y,O,null,null,M);if(R!=null&&x===void 0){N!="func"&&e.errors.push("Can't format value of arg ".concat(g," for func ").concat(u));return}var W=void 0;if(x===void 0&&!A&&b!=null&&(W=Ti(e,t,b,L,O.type,y,O,null,null,M),W===void 0)){L!="func"&&e.errors.push("Can't format default value of arg ".concat(g," for func ").concat(u));return}var B=x??W;if(B!==void 0){if(p.length){var k=Cg(g),Q;try{for(k.s();!(Q=k.n()).done;){var K=Q.value;f[K]=void 0}}catch(de){k.e(de)}finally{k.f()}p=[]}f[g]=B}else A||v.push(g),p.push(g)}if(!v.length){var J;if(typeof l.sqlFormatFunc=="function"){var G=l.sqlFormatFunc,re=[f];J=G.call.apply(G,[t.ctx].concat(re))}else{var ue=Object.entries(f).map(function(de){var fe=(0,Le.A)(de,2),ae=fe[0],ne=fe[1];return ne}).join(", ");J="".concat(d,"(").concat(ue,")")}return J}};function rc(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function tc(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?rc(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):rc(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function jg(n){if(n==null)return null;var e=n.split(",").map(Number);return{top_left:{lat:e[0],lon:e[1]},bottom_right:{lat:e[2],lon:e[3]}}}function Rg(n,e){if(n.length>1)return{gte:"".concat(n[0]),lte:"".concat(n[1])};var t=n[0];switch(e){case"on_date":case"not_on_date":case"equal":case"select_equals":case"not_equal":return{gte:"".concat(t,"||/d"),lte:"".concat(t,"||+1d")};case"less_or_equal":return{lte:"".concat(t)};case"greater_or_equal":return{gte:"".concat(t)};case"less":return{lt:"".concat(t)};case"greater":return{gt:"".concat(t)};default:return}}function Pg(n){return{value:"*"+n+"*"}}function xg(n,e){switch(n){case"AND":return e?"must_not":"must";case"OR":return e?"should_not":"should";case"NOT":return e?"must":"must_not";default:return}}function Ig(n){return{value:n}}function Vg(n,e){return n}function Dg(n,e,t,r,a,o){var u=Vg(r,a);switch(n){case"filter":return{script:a.operators[t].elasticSearchScript(r,e)};case"exists":return{field:r};case"match":return(0,te.A)({},u,e[0]);case"term":return o===kg?(0,te.A)({},r,{value:e[0]}):(0,te.A)({},r,e[0]);case"geo_bounding_box":return(0,te.A)({},r,jg(e[0]));case"range":return(0,te.A)({},r,Rg(e,t));case"wildcard":return(0,te.A)({},r,Pg(e[0]));case"regexp":return(0,te.A)({},r,Ig(e[0]));default:return}}function nc(n,e,t,r,a,o){if(!(!n||!t||e==null)){var u=t,i=r.operators[u];if(i){var l=i,s=l.elasticSearchQueryType,c=!1;if(!s&&i.reversedOp){c=!0,u=i.reversedOp,i=r.operators[u];var d=i;s=d.elasticSearchQueryType}var f=Ar(r,n,u,a),p=r.widgets[f];if(p){var v=p.elasticSearchFormatValue,g;if(typeof s=="function"?g=s(f):g=s,!!g){var m;return typeof v=="function"?m=v(g,e,u,n,r):m=Dg(g,e,u,n,r,o),c?{bool:{must_not:(0,te.A)({},g,tc({},m))}}:(0,te.A)({},g,tc({},m))}}}}}function Ng(n,e,t,r,a,o){if(!(!n||!n.size)){var u=n.valueSeq().toArray(),i=xg(e,t),l=u.map(function(c){return r(c,a,o)}).filter(function(c){return c!==void 0});if(l.length){var s=l.flat(1/0);return{bool:(0,te.A)({},i,s)}}}}var kg="ES_7_SYNTAX",Mg="ES_6_SYNTAX";function ac(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Mg;if(n){var r=n.get("type"),a=n.get("properties")||new Map;if(r==="rule"&&a.get("field")){var o,u,i,l=a.get("operator"),s=a.get("field"),c=a.get("fieldSrc"),d=(o=a.get("value"))===null||o===void 0?void 0:o.toJS(),f=(u=a.get("valueType"))===null||u===void 0?void 0:u.get(0),p=(i=a.get("valueSrc"))===null||i===void 0?void 0:i.get(0);return p==="func"||c=="func"?void 0:d&&Array.isArray(d[0])?d[0].map(function(O){return nc(s,[O],l,e,p,t)}):nc(s,d,l,e,p,t)}if(r==="group"||r==="rule_group"){var v=a.get("not"),g=a.get("conjunction");g||(g=Ht(e));var m=n.get("children1");return Ng(m,g,v,ac,e,t)}}}var Qn=h(80045);function oc(n,e,t,r,a,o,u){try{var i=n[o](u),l=i.value}catch(s){return void t(s)}i.done?e(l):Promise.resolve(l).then(r,a)}function _g(n){return function(){var e=this,t=arguments;return new Promise(function(r,a){var o=n.apply(e,t);function u(l){oc(o,r,a,u,i,"next",l)}function i(l){oc(o,r,a,u,i,"throw",l)}u(void 0)})}}var Gg=["title","value","disabled","groupTitle","grouplabel","renderTitle","children","label","isCustom","isHidden"];function $g(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Ug(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function Ug(n,e){if(n){if(typeof n=="string")return ic(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ic(n,e)}}function ic(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function uc(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Sn(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?uc(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):uc(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Bg=function(e,t){if(e.findLastIndex)return e.findLastIndex(t);var r=(0,Fe.A)(e).reverse().findIndex(t);return r==-1?-1:e.length-1-r},Wg=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e3;return function(){var a=_g(an().mark(function o(u,i,l){var s,c,d,f,p,v,g,m;return an().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(s=l?.pageSize!=null?l.pageSize:t,c=fu(e).filter(function(b){var A=b.title,L=b.value;return u==null?!0:A.toUpperCase().indexOf(u.toUpperCase())!=-1||"".concat(L).toUpperCase().indexOf(u.toUpperCase())!=-1}),d=s?Math.ceil(c.length/s):0,f=i||0,p=s?Math.ceil(f/s):null,v=s?c.slice(f,f+s):c,g=s?f+v.length:null,m=s?g<c.length:!1,!r){y.next=11;break}return y.next=11,au(r);case 11:return y.abrupt("return",{values:v,hasMore:m});case 12:case"end":return y.stop()}},o)}));return function(o,u,i){return a.apply(this,arguments)}}()},Kg=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!t)return e;var o=e||[],u=t.filter(function(l){return o.find(function(s){return""+s.value==""+l.value})==null}).map(function(l){return a?Sn(Sn({},l),{},{isHidden:!0}):l}),i=r?[].concat((0,Fe.A)(u),(0,Fe.A)(o)):[].concat((0,Fe.A)(o),(0,Fe.A)(u));return i},Hg=function(e,t,r){var a,o=e==null||e==""?void 0:(a=e?.value)!==null&&a!==void 0?a:e,u=Ba(o,t),i=r&&!u?Vo(o):void 0,l=u||i,s=l?[l]:void 0;return[o,s]},zg=function(e,t,r){var a=e.map(function(u,i){var l,s=u==null||u==""?void 0:(l=u?.value)!==null&&l!==void 0?l:u,c=Ba(s,t),d=r&&!c?Vo(s):void 0,f=c||d;return f}).filter(function(u){return u!=null}),o=a.map(function(u){var i;return(i=u?.value)!==null&&i!==void 0?i:u});return o.length||(o=void 0),[o,a]},Jg=function(e){if(e==null)return null;var t=e.title,r=e.value,a=e.disabled,o=e.groupTitle,u=e.grouplabel,i=e.renderTitle,l=e.children,s=e.label,c=e.isCustom,d=e.isHidden,f=(0,Qn.A)(e,Gg),p={value:r,title:t||s||l};return a&&(p.disabled=a),c&&(p.isCustom=c),d&&(p.isHidden=d),(o||u)&&(p.groupTitle=o||u),i&&(p.renderTitle=i),p=Sn(Sn({},p),f),p},qg=function(e){var t=[],r=[],a=$g(e),o;try{var u=function(){var l=o.value,s=Bg(t,function(c){var d,f;return((d=c.groupTitle)!==null&&d!==void 0?d:"")==((f=l.groupTitle)!==null&&f!==void 0?f:"")});l.groupTitle!=null&&!r.includes(l.groupTitle)&&(r.push(l.groupTitle),r.length===1&&(t=t.map(function(c){return Sn(Sn({},c),{},{groupTitle:""})}))),l.groupTitle==null&&r.length&&(l=Sn(Sn({},l),{},{groupTitle:""})),s!=-1?t.splice(s+1,0,l):t.push(l)};for(a.s();!(o=a.n()).done;)u()}catch(i){a.e(i)}finally{a.f()}return t},Qg={label:"Now",returnType:"datetime",jsonLogic:"now",jsonLogicCustomOps:{now:{}},spelFunc:"T(java.time.LocalDateTime).now()",sqlFormatFunc:function(){return"NOW()"},mongoFormatFunc:function(){return new Date},formatFunc:function(){return"NOW"}},Yg={label:"Relative",returnType:"datetime",renderBrackets:["",""],renderSeps:["","",""],spelFormatFunc:function(e){var t=e.date,r=e.op,a=e.val,o=e.dim,u=o.charAt(0).toUpperCase()+o.slice(1)+"s",i=r+u;return"".concat(t,".").concat(i,"(").concat(a,")")},spelImport:function(e){var t,r,a,o,u,i=(t=e.methodName)===null||t===void 0?void 0:t.match(/^(minus|plus)(\w+)s$/);if(i&&(u=i[2].toLowerCase(),a=i[1],["minus","plus"].includes(a)&&["day","week","month","year"].includes(u)))return a={type:"string",val:a},u={type:"string",val:u},o=e.args[0],r=e.obj,{date:r,op:a,val:o,dim:u}},jsonLogic:function(e){var t=e.date,r=e.op,a=e.val,o=e.dim;return{date_add:[t,a*(r=="minus"?-1:1),o]}},jsonLogicImport:function(e){var t=e.date_add[0],r=Math.abs(e.date_add[1]),a=e.date_add[1]>=0?"plus":"minus",o=e.date_add[2];return[t,a,r,o]},jsonLogicCustomOps:{date_add:{}},sqlFormatFunc:function(e){var t=e.date,r=e.op,a=e.val,o=e.dim;return"DATE_ADD(".concat(t,", INTERVAL ").concat(parseInt(a)*(r=="minus"?-1:1)," ").concat(o.replace(/^'|'$/g,""),")")},mongoFormatFunc:null,formatFunc:function(e){var t=e.date,r=e.op,a=e.val,o=e.dim;return a?"".concat(t," ").concat(r=="minus"?"-":"+"," ").concat(a," ").concat(o):t},args:{date:{label:"Date",type:"datetime",defaultValue:{func:"NOW",args:[]},valueSources:["func","field","value"],spelEscapeForFormat:!0},op:{label:"Op",type:"select",defaultValue:"plus",valueSources:["value"],mainWidgetProps:{customProps:{showSearch:!1}},fieldSettings:{listValues:{plus:"+",minus:"-"}},spelEscapeForFormat:!1},val:{label:"Value",type:"number",fieldSettings:{min:0},defaultValue:0,valueSources:["value"],spelEscapeForFormat:!1},dim:{label:"Dimension",type:"select",defaultValue:"day",valueSources:["value"],mainWidgetProps:{customProps:{showSearch:!1}},fieldSettings:{listValues:{day:"day",week:"week",month:"month",year:"year"}},spelEscapeForFormat:!1}}},Xg={label:"Lowercase",mongoFunc:"$toLower",jsonLogic:"toLowerCase",spelFunc:"${str}.toLowerCase()",jsonLogicCustomOps:{toLowerCase:{}},returnType:"text",args:{str:{label:"String",type:"text",valueSources:["value","field","func"]}}},Zg={label:"Uppercase",mongoFunc:"$toUpper",jsonLogic:"toUpperCase",spelFunc:"${str}.toUpperCase()",jsonLogicCustomOps:{toUpperCase:{}},returnType:"text",args:{str:{label:"String",type:"text",valueSources:["value","field","func"]}}},em={label:"Linear regression",returnType:"number",formatFunc:function(e,t){var r=e.coef,a=e.bias,o=e.val;return"(".concat(r," * ").concat(o," + ").concat(a,")")},sqlFormatFunc:function(e){var t=e.coef,r=e.bias,a=e.val;return"(".concat(t," * ").concat(a," + ").concat(r,")")},spelFormatFunc:function(e){var t=e.coef,r=e.bias,a=e.val;return"(".concat(t," * ").concat(a," + ").concat(r,")")},spelImport:function(e){var t,r,a,o;if(e.type==="op-plus"){var u=(0,Le.A)(e.children,2);if(o=u[0],a=u[1],o.type==="op-multiply"){var i=(0,Le.A)(o.children,2);return t=i[0],r=i[1],{coef:t,val:r,bias:a}}}},mongoFormatFunc:function(e){var t=e.coef,r=e.bias,a=e.val;return{$sum:[{$multiply:[t,a]},r]}},jsonLogic:function(e){var t=e.coef,r=e.bias,a=e.val;return{"+":[{"*":[t,a]},r]}},jsonLogicImport:function(e){var t=e["+"][0]["*"][0],r=e["+"][0]["*"][1],a=e["+"][1];return[t,r,a]},renderBrackets:["",""],renderSeps:[" * "," + "],args:{coef:{label:"Coef",type:"number",defaultValue:1,valueSources:["value"]},val:{label:"Value",type:"number",valueSources:["value","field"]},bias:{label:"Bias",type:"number",defaultValue:0,valueSources:["value"]}}},rm=function(e,t,r,a,o,u,i,l,s,c,d,f){var p=typeof a=="string"&&!a.startsWith("$")?"$"+a:a,v=t(u,f);if(v!==void 0)return r?!i&&(!e||e=="$eq")?(0,te.A)({},a,{$ne:v}):i?{$not:(0,te.A)({},e,[p,v])}:(0,te.A)({},a,{$not:(0,te.A)({},e,v)}):!i&&(!e||e=="$eq")?(0,te.A)({},a,v):i?(0,te.A)({},e,[p,v]):(0,te.A)({},a,(0,te.A)({},e,v))},tm=function(e,t,r,a,o,u,i,l,s,c,d){var f=typeof r=="string"&&!r.startsWith("$")?"$"+r:r;return t?u?{$not:{$and:[(0,te.A)({},e[0],[f,o[0]]),(0,te.A)({},e[1],[f,o[1]])]}}:(0,te.A)({},r,{$not:(0,te.A)((0,te.A)({},e[0],o[0]),e[1],o[1])}):u?{$and:[(0,te.A)({},e[0],[f,o[0]]),(0,te.A)({},e[1],[f,o[1]])]}:(0,te.A)({},r,(0,te.A)((0,te.A)({},e[0],o[0]),e[1],o[1]))},nm={utils:{SqlString:yn,moment:$n(),mongoFormatOp1:rm,mongoFormatOp2:tm,mongoEmptyValue:ju,escapeRegExp:nu,sqlEmptyValue:wu,stringifyForDisplay:Pu,getTitleInListValues:pu,spelEscape:Un,spelFixList:Ru}};const am=nm;function om(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=im(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function im(n,e){if(n){if(typeof n=="string")return lc(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return lc(n,e)}}function lc(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function sc(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function ir(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?sc(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):sc(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var um={AND:{label:"And",mongoConj:"$and",jsonLogicConj:"and",sqlConj:"AND",spelConj:"and",spelConjs:["and","&&"],reversedConj:"OR",formatConj:function(e,t,r,a){return e.size>1?(r?"NOT ":"")+"("+e.join(" "+(a?"AND":"&&")+" ")+")":(r?"NOT (":"")+e.first()+(r?")":"")},sqlFormatConj:function(e,t,r){return e.size>1?(r?"NOT ":"")+"("+e.join(" AND ")+")":(r?"NOT (":"")+e.first()+(r?")":"")},spelFormatConj:function(e,t,r,a){return r&&(a=!1),e.size>1?(r?"!":"")+(a?"":"(")+e.join(" && ")+(a?"":")"):(r?"!(":"")+e.first()+(r?")":"")}},OR:{label:"Or",mongoConj:"$or",jsonLogicConj:"or",sqlConj:"OR",spelConj:"or",spelConjs:["or","||"],reversedConj:"AND",formatConj:function(e,t,r,a){return e.size>1?(r?"NOT ":"")+"("+e.join(" "+(a?"OR":"||")+" ")+")":(r?"NOT (":"")+e.first()+(r?")":"")},sqlFormatConj:function(e,t,r){return e.size>1?(r?"NOT ":"")+"("+e.join(" OR ")+")":(r?"NOT (":"")+e.first()+(r?")":"")},spelFormatConj:function(e,t,r,a){return r&&(a=!1),e.size>1?(r?"!":"")+(a?"":"(")+e.join(" || ")+(a?"":")"):(r?"!(":"")+e.first()+(r?")":"")}}},lm={equal:{label:"==",labelForFormat:"==",sqlOp:"=",spelOp:"==",spelOps:["==","eq"],reversedOp:"not_equal",formatOp:function(e,t,r,a,o,u,i,l,s){var c=l?"=":u.label;return o=="boolean"&&l?r=="No"?"NOT ".concat(e):"".concat(e):"".concat(e," ").concat(c," ").concat(r)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(o){return o},!1].concat(r))},jsonLogic:"==",elasticSearchQueryType:"term"},not_equal:{isNotOp:!0,label:"!=",labelForFormat:"!=",sqlOp:"<>",spelOp:"!=",spelOps:["!=","ne"],reversedOp:"equal",formatOp:function(e,t,r,a,o,u,i,l,s){return o=="boolean"&&l?r=="No"?"".concat(e):"NOT ".concat(e):"".concat(e," ").concat(u.label," ").concat(r)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(o){return o},!1].concat(r))},jsonLogic:"!="},less:{label:"<",labelForFormat:"<",sqlOp:"<",spelOp:"<",spelOps:["<","lt"],reversedOp:"greater_or_equal",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$lt",function(o){return o},!1].concat(r))},jsonLogic:"<",elasticSearchQueryType:"range"},less_or_equal:{label:"<=",labelForFormat:"<=",sqlOp:"<=",spelOp:"<=",spelOps:["<=","le"],reversedOp:"greater",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$lte",function(o){return o},!1].concat(r))},jsonLogic:"<=",elasticSearchQueryType:"range"},greater:{label:">",labelForFormat:">",sqlOp:">",spelOp:">",spelOps:[">","gt"],reversedOp:"less_or_equal",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$gt",function(o){return o},!1].concat(r))},jsonLogic:">",elasticSearchQueryType:"range"},greater_or_equal:{label:">=",labelForFormat:">=",sqlOp:">=",spelOp:">=",spelOps:[">=","ge"],reversedOp:"less",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$gte",function(o){return o},!1].concat(r))},jsonLogic:">=",elasticSearchQueryType:"range"},like:{label:"Contains",labelForFormat:"Contains",reversedOp:"not_like",sqlOp:"LIKE",spelOp:"${0}.contains(${1})",valueTypes:["text"],mongoFormatOp:function(){for(var e,t=this,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(u){return typeof u=="string"?t.utils.escapeRegExp(u):void 0},!1].concat(a))},jsonLogic:"in",_jsonLogicIsRevArgs:!0,valueSources:["value"],elasticSearchQueryType:"regexp"},not_like:{isNotOp:!0,label:"Not contains",reversedOp:"like",labelForFormat:"Not Contains",sqlOp:"NOT LIKE",mongoFormatOp:function(){for(var e,t=this,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(u){return typeof u=="string"?t.utils.escapeRegExp(u):void 0},!0].concat(a))},valueSources:["value"]},starts_with:{label:"Starts with",labelForFormat:"Starts with",sqlOp:"LIKE",spelOp:"${0}.startsWith(${1})",mongoFormatOp:function(){for(var e,t=this,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(u){return typeof u=="string"?"^"+t.utils.escapeRegExp(u):void 0},!1].concat(a))},jsonLogic:void 0,valueSources:["value"]},ends_with:{label:"Ends with",labelForFormat:"Ends with",sqlOp:"LIKE",spelOp:"${0}.endsWith(${1})",mongoFormatOp:function(){for(var e,t=this,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(u){return typeof u=="string"?t.utils.escapeRegExp(u)+"$":void 0},!1].concat(a))},jsonLogic:void 0,valueSources:["value"]},between:{label:"Between",labelForFormat:"BETWEEN",sqlOp:"BETWEEN",cardinality:2,formatOp:function(e,t,r,a,o,u,i,l){var s=r.first(),c=r.get(1);return l?"".concat(e," BETWEEN ").concat(s," AND ").concat(c):"".concat(e," >= ").concat(s," && ").concat(e," <= ").concat(c)},spelFormatOp:function(e,t,r,a,o,u,i,l){var s=r[0],c=r[1];return"".concat(e," >= ").concat(s," && ").concat(e," <= ").concat(c)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp2.apply(e,[["$gte","$lte"],!1].concat(r))},valueLabels:["Value from","Value to"],textSeparators:[null,"and"],reversedOp:"not_between",jsonLogic:"<=",validateValues:function(e){return e[0]!=null&&e[1]!=null?e[0]<=e[1]:null},elasticSearchQueryType:function(e){return e==="time"?"filter":"range"}},not_between:{isNotOp:!0,label:"Not between",labelForFormat:"NOT BETWEEN",sqlOp:"NOT BETWEEN",cardinality:2,formatOp:function(e,t,r,a,o,u,i,l){var s=r.first(),c=r.get(1);return l?"".concat(e," NOT BETWEEN ").concat(s," AND ").concat(c):"(".concat(e," < ").concat(s," || ").concat(e," > ").concat(c,")")},spelFormatOp:function(e,t,r,a,o,u,i,l){var s=r[0],c=r[1];return"(".concat(e," < ").concat(s," || ").concat(e," > ").concat(c,")")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp2.apply(e,[["$gte","$lte"],!0].concat(r))},valueLabels:["Value from","Value to"],textSeparators:[null,"and"],reversedOp:"between",validateValues:function(e){return e[0]!=null&&e[1]!=null?e[0]<=e[1]:null}},is_empty:{label:"Is empty",labelForFormat:"IS EMPTY",cardinality:0,reversedOp:"is_not_empty",formatOp:function(e,t,r,a,o,u,i,l){return l?"".concat(e," IS EMPTY"):"!".concat(e)},sqlFormatOp:function(e,t,r,a,o,u,i,l){var s=this.utils.sqlEmptyValue(l);return"COALESCE(".concat(e,", ").concat(s,") = ").concat(s)},spelFormatOp:function(e,t,r,a,o,u,i,l){return"".concat(e," <= ''")},mongoFormatOp:function(){for(var e,t=this,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(u,i){return[t.utils.mongoEmptyValue(i),null]},!1].concat(a))},jsonLogic:"!"},is_not_empty:{isNotOp:!0,label:"Is not empty",labelForFormat:"IS NOT EMPTY",cardinality:0,reversedOp:"is_empty",formatOp:function(e,t,r,a,o,u,i,l){return l?"".concat(e," IS NOT EMPTY"):"!!".concat(e)},sqlFormatOp:function(e,t,r,a,o,u,i,l){var s=this.utils.sqlEmptyValue(l);return"COALESCE(".concat(e,", ").concat(s,") <> ").concat(s)},spelFormatOp:function(e,t,r,a,o,u,i,l){return"".concat(e," > ''")},mongoFormatOp:function(){for(var e,t=this,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$nin",function(u,i){return[t.utils.mongoEmptyValue(i),null]},!1].concat(a))},jsonLogic:"!!",elasticSearchQueryType:"exists"},is_null:{label:"Is null",labelForFormat:"IS NULL",sqlOp:"IS NULL",cardinality:0,reversedOp:"is_not_null",formatOp:function(e,t,r,a,o,u,i,l){return l?"".concat(e," IS NULL"):"!".concat(e)},spelFormatOp:function(e,t,r,a,o,u,i,l){return"".concat(e," == null")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(o){return null},!1].concat(r))},jsonLogic:"=="},is_not_null:{label:"Is not null",labelForFormat:"IS NOT NULL",sqlOp:"IS NOT NULL",cardinality:0,reversedOp:"is_null",formatOp:function(e,t,r,a,o,u,i,l){return l?"".concat(e," IS NOT NULL"):"!!".concat(e)},spelFormatOp:function(e,t,r,a,o,u,i,l){return"".concat(e," != null")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(o){return null},!1].concat(r))},jsonLogic:"!=",elasticSearchQueryType:"exists"},select_equals:{label:"==",labelForFormat:"==",sqlOp:"=",formatOp:function(e,t,r,a,o,u,i,l){var s=l?"=":"==";return"".concat(e," ").concat(s," ").concat(r)},spelOp:"==",spelOps:["==","eq"],mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(o){return o},!1].concat(r))},reversedOp:"select_not_equals",jsonLogic:"==",elasticSearchQueryType:"term"},select_not_equals:{isNotOp:!0,label:"!=",labelForFormat:"!=",sqlOp:"<>",formatOp:function(e,t,r,a,o,u,i,l){return"".concat(e," != ").concat(r)},spelOp:"!=",spelOps:["!=","ne"],mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(o){return o},!1].concat(r))},reversedOp:"select_equals",jsonLogic:"!="},select_any_in:{label:"Any in",labelForFormat:"IN",sqlOp:"IN",formatOp:function(e,t,r,a,o,u,i,l){return a=="value"?"".concat(e," IN (").concat(r.join(", "),")"):"".concat(e," IN (").concat(r,")")},sqlFormatOp:function(e,t,r,a,o,u,i,l){if(a=="value")return"".concat(e," IN (").concat(r.join(", "),")")},valueTypes:["multiselect"],spelOp:"${1}.contains(${0})",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(o){return o},!1].concat(r))},reversedOp:"select_not_any_in",jsonLogic:"in",elasticSearchQueryType:"term"},select_not_any_in:{isNotOp:!0,label:"Not in",labelForFormat:"NOT IN",sqlOp:"NOT IN",formatOp:function(e,t,r,a,o,u,i,l){return a=="value"?"".concat(e," NOT IN (").concat(r.join(", "),")"):"".concat(e," NOT IN (").concat(r,")")},sqlFormatOp:function(e,t,r,a,o,u,i,l){if(a=="value")return"".concat(e," NOT IN (").concat(r.join(", "),")")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$nin",function(o){return o},!1].concat(r))},reversedOp:"select_any_in"},multiselect_contains:{label:"Contains",labelForFormat:"CONTAINS",formatOp:function(e,t,r,a,o,u,i,l){return a=="value"?"".concat(e," CONTAINS [").concat(r.join(", "),"]"):"".concat(e," CONTAINS ").concat(r)},reversedOp:"multiselect_not_contains",jsonLogic2:"some-in",jsonLogic:function(e,t,r){return{some:[e,{in:[{var:""},r]}]}},spelOp:"T(CollectionUtils).containsAny(${0}, ${1})",elasticSearchQueryType:"term",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(o){return o},!1].concat(r))}},multiselect_not_contains:{isNotOp:!0,label:"Not contains",labelForFormat:"NOT CONTAINS",formatOp:function(e,t,r,a,o,u,i,l){return a=="value"?"".concat(e," NOT CONTAINS [").concat(r.join(", "),"]"):"".concat(e," NOT CONTAINS ").concat(r)},reversedOp:"multiselect_contains"},multiselect_equals:{label:"Equals",labelForFormat:"==",sqlOp:"=",formatOp:function(e,t,r,a,o,u,i,l){var s=l?"=":"==";return a=="value"?"".concat(e," ").concat(s," [").concat(r.join(", "),"]"):"".concat(e," ").concat(s," ").concat(r)},sqlFormatOp:function(e,t,r,a,o,u,i,l){var s=this;if(a=="value")return"".concat(e," = '").concat(r.map(function(c){return s.utils.SqlString.trim(c)}).join(","),"'")},spelOp:"${0}.equals(${1})",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(o){return o},!1].concat(r))},reversedOp:"multiselect_not_equals",jsonLogic2:"all-in",jsonLogic:function(e,t,r){return{all:[e,{in:[{var:""},r]}]}},elasticSearchQueryType:"term"},multiselect_not_equals:{isNotOp:!0,label:"Not equals",labelForFormat:"!=",sqlOp:"<>",formatOp:function(e,t,r,a,o,u,i,l){return a=="value"?"".concat(e," != [").concat(r.join(", "),"]"):"".concat(e," != ").concat(r)},sqlFormatOp:function(e,t,r,a,o,u,i,l){var s=this;if(a=="value")return"".concat(e," != '").concat(r.map(function(c){return s.utils.SqlString.trim(c)}).join(","),"'")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(o){return o},!1].concat(r))},reversedOp:"multiselect_equals"},proximity:{label:"Proximity search",cardinality:2,valueLabels:[{label:"Word 1",placeholder:"Enter first word"},{label:"Word 2",placeholder:"Enter second word"}],textSeparators:[],formatOp:function(e,t,r,a,o,u,i,l){var s=r.first(),c=r.get(1),d=i.get("proximity");return"".concat(e," ").concat(s," NEAR/").concat(d," ").concat(c)},sqlFormatOp:function(e,t,r,a,o,u,i,l){var s=r.first(),c=r.get(1),d=this.utils.SqlString.trim(s),f=this.utils.SqlString.trim(c),p=i.get("proximity");return"CONTAINS(".concat(e,", 'NEAR((").concat(d,", ").concat(f,"), ").concat(p,")')")},mongoFormatOp:void 0,jsonLogic:void 0,options:{optionLabel:"Near",optionTextBefore:"Near",optionPlaceholder:"Select words between",minProximity:2,maxProximity:10,defaults:{proximity:2}}},some:{label:"Some",labelForFormat:"SOME",cardinality:0,jsonLogic:"some",spelFormatOp:function(e){return"".concat(e," > 0")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$gt",function(o){return 0},!1].concat(r))}},all:{label:"All",labelForFormat:"ALL",cardinality:0,jsonLogic:"all",spelFormatOp:function(e,t,r){return"".concat(e," == ").concat(r)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(o){return o},!1].concat(r))}},none:{label:"None",labelForFormat:"NONE",cardinality:0,jsonLogic:"none",spelFormatOp:function(e){return"".concat(e," == 0")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(o){return 0},!1].concat(r))}}},sm={text:{type:"text",jsType:"string",valueSrc:"value",valueLabel:"String",valuePlaceholder:"Enter string",formatValue:function(e,t,r,a){return a?this.utils.stringifyForDisplay(e):JSON.stringify(e)},spelFormatValue:function(e,t,r,a,o){return this.utils.spelEscape(e)},sqlFormatValue:function(e,t,r,a,o){return o.sqlOp=="LIKE"||o.sqlOp=="NOT LIKE"?this.utils.SqlString.escapeLike(e,a!="starts_with",a!="ends_with"):this.utils.SqlString.escape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},textarea:{type:"text",jsType:"string",valueSrc:"value",valueLabel:"Text",valuePlaceholder:"Enter text",formatValue:function(e,t,r,a){return a?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,a,o){return o.sqlOp=="LIKE"||o.sqlOp=="NOT LIKE"?this.utils.SqlString.escapeLike(e,a!="starts_with",a!="ends_with"):this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e},fullWidth:!0},number:{type:"number",jsType:"number",valueSrc:"value",valueLabel:"Number",valuePlaceholder:"Enter number",valueLabels:[{label:"Number from",placeholder:"Enter number from"},{label:"Number to",placeholder:"Enter number to"}],formatValue:function(e,t,r,a){return a?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,a,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e,t,r){var a=r.step&&!Number.isInteger(r.step);return this.utils.spelEscape(e,a)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},slider:{type:"number",jsType:"number",valueSrc:"value",valueLabel:"Number",valuePlaceholder:"Enter number or move slider",formatValue:function(e,t,r,a){return a?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,a,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},select:{type:"select",jsType:"string",valueSrc:"value",valueLabel:"Value",valuePlaceholder:"Select value",formatValue:function(e,t,r,a){var o=this.utils.getTitleInListValues(t.fieldSettings.listValues||t.asyncListValues,e);return a?this.utils.stringifyForDisplay(o):JSON.stringify(e)},sqlFormatValue:function(e,t,r,a,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},multiselect:{type:"multiselect",jsType:"array",valueSrc:"value",valueLabel:"Values",valuePlaceholder:"Select values",formatValue:function(e,t,r,a){var o=this,u=e.map(function(i){return o.utils.getTitleInListValues(t.fieldSettings.listValues||t.asyncListValues,i)});return a?u.map(this.utils.stringifyForDisplay):e.map(JSON.stringify)},sqlFormatValue:function(e,t,r,a,o){var u=this;return e.map(function(i){return u.utils.SqlString.escape(i)})},spelFormatValue:function(e,t,r,a,o){var u=o&&o.spelOp&&o.spelOp.startsWith("${1}"),i=this.utils.spelEscape(e);return u&&(i=this.utils.spelFixList(i)),i},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},date:{type:"date",jsType:"string",valueSrc:"value",dateFormat:"DD.MM.YYYY",valueFormat:"YYYY-MM-DD",valueLabel:"Date",valuePlaceholder:"Enter date",valueLabels:[{label:"Date from",placeholder:"Enter date from"},{label:"Date to",placeholder:"Enter date to"}],formatValue:function(e,t,r,a){var o=this.utils.moment(e,r.valueFormat);return a?o.format(r.dateFormat):JSON.stringify(e)},sqlFormatValue:function(e,t,r,a,o){var u=this.utils.moment(e,r.valueFormat);return this.utils.SqlString.escape(u.format("YYYY-MM-DD"))},spelFormatValue:function(e,t,r,a,o){var u=this.utils.moment(e,r.valueFormat),i=u.format("YYYY-MM-DD"),l="yyyy-MM-dd";return"T(java.time.LocalDate).parse('".concat(i,"', T(java.time.format.DateTimeFormatter).ofPattern('").concat(l,"'))")},spelImportFuncs:[{obj:{cls:["java","time","LocalDate"]},methodName:"parse",args:[{var:"v"},{obj:{cls:["java","time","format","DateTimeFormatter"]},methodName:"ofPattern",args:[{var:"fmt"}]}]}],spelImportValue:function(e,t,r){var a,o,u,i;if(!t)return[void 0,"No widget def to get value format"];if(r!=null&&(a=r.fmt)!==null&&a!==void 0&&(a=a.value)!==null&&a!==void 0&&(o=a.includes)!==null&&o!==void 0&&o.call(a," ")||(u=r.fmt)!==null&&u!==void 0&&(u=u.value)!==null&&u!==void 0&&(i=u.toLowerCase)!==null&&i!==void 0&&i.call(u).includes("hh:mm"))return[void 0,"Invalid date format ".concat(JSON.stringify(r.fmt))];var l=this.utils.moment(e.value,this.utils.moment.ISO_8601);return l.isValid()?[l.format(t?.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,t,r){return this.utils.moment(e,r.valueFormat).toDate()},toJS:function(e,t){var r=this.utils.moment(e,t.valueFormat);return r.isValid()?r.toDate():void 0},mongoFormatValue:function(e,t,r){var a=this.utils.moment(e,r.valueFormat);return a.isValid()?a.toDate():void 0}},time:{type:"time",jsType:"string",valueSrc:"value",timeFormat:"HH:mm",valueFormat:"HH:mm:ss",use12Hours:!1,valueLabel:"Time",valuePlaceholder:"Enter time",valueLabels:[{label:"Time from",placeholder:"Enter time from"},{label:"Time to",placeholder:"Enter time to"}],formatValue:function(e,t,r,a){var o=this.utils.moment(e,r.valueFormat);return a?o.format(r.timeFormat):JSON.stringify(e)},sqlFormatValue:function(e,t,r,a,o){var u=this.utils.moment(e,r.valueFormat);return this.utils.SqlString.escape(u.format("HH:mm:ss"))},spelFormatValue:function(e,t,r,a,o){var u=this.utils.moment(e,r.valueFormat),i="HH:mm:ss",l=u.format("HH:mm:ss");return"T(java.time.LocalTime).parse('".concat(l,"')")},spelImportFuncs:["T(java.time.LocalTime).parse(${v})"],spelImportValue:function(e,t,r){var a,o,u;if(!t)return[void 0,"No widget def to get value format"];if(r!=null&&r.fmt&&(!((a=r.fmt)!==null&&a!==void 0&&(a=a.value)!==null&&a!==void 0&&(o=a.toLowerCase)!==null&&o!==void 0&&o.call(a).includes("hh:mm"))||(u=r.fmt)!==null&&u!==void 0&&(u=u.value)!==null&&u!==void 0&&u.includes(" ")))return[void 0,"Invalid time format ".concat(JSON.stringify(r.fmt))];var i=this.utils.moment(e.value,"HH:mm:ss");return i.isValid()?[i.format(t?.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,t,r){var a=this.utils.moment(e,r.valueFormat);return a.get("hour")*60*60+a.get("minute")*60+a.get("second")},toJS:function(e,t){var r=this.utils.moment(e,t.valueFormat);return r.isValid()?r.get("hour")*60*60+r.get("minute")*60+r.get("second"):void 0},mongoFormatValue:function(e,t,r){var a=this.utils.moment(e,r.valueFormat);return a.get("hour")*60*60+a.get("minute")*60+a.get("second")},elasticSearchFormatValue:function(e,t,r,a){return{script:{script:{source:"doc[".concat(a,"][0].getHour() >== params.min && doc[").concat(a,"][0].getHour() <== params.max"),params:{min:t[0],max:t[1]}}}}}},datetime:{type:"datetime",jsType:"string",valueSrc:"value",timeFormat:"HH:mm",dateFormat:"DD.MM.YYYY",valueFormat:"YYYY-MM-DD HH:mm:ss",use12Hours:!1,valueLabel:"Datetime",valuePlaceholder:"Enter datetime",valueLabels:[{label:"Datetime from",placeholder:"Enter datetime from"},{label:"Datetime to",placeholder:"Enter datetime to"}],formatValue:function(e,t,r,a){var o=this.utils.moment(e,r.valueFormat);return a?o.format(r.dateFormat+" "+r.timeFormat):JSON.stringify(e)},sqlFormatValue:function(e,t,r,a,o){var u=this.utils.moment(e,r.valueFormat);return this.utils.SqlString.escape(u.toDate())},spelFormatValue:function(e,t,r,a,o){var u=this.utils.moment(e,r.valueFormat),i=u.format("YYYY-MM-DD HH:mm:ss"),l="yyyy-MM-dd HH:mm:ss";return"T(java.time.LocalDateTime).parse('".concat(i,"', T(java.time.format.DateTimeFormatter).ofPattern('").concat(l,"'))")},spelImportFuncs:[{obj:{cls:["java","time","LocalDateTime"]},methodName:"parse",args:[{var:"v"},{obj:{cls:["java","time","format","DateTimeFormatter"]},methodName:"ofPattern",args:[{var:"fmt"}]}]}],spelImportValue:function(e,t,r){var a,o;if(!t)return[void 0,"No widget def to get value format"];if(!(r!=null&&(a=r.fmt)!==null&&a!==void 0&&(a=a.value)!==null&&a!==void 0&&(o=a.includes)!==null&&o!==void 0&&o.call(a," ")))return[void 0,"Invalid datetime format ".concat(JSON.stringify(r.fmt))];var u=this.utils.moment(e.value,this.utils.moment.ISO_8601);return u.isValid()?[u.format(t?.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,t,r){return this.utils.moment(e,r.valueFormat).toDate()},toJS:function(e,t){var r=this.utils.moment(e,t.valueFormat);return r.isValid()?r.toDate():void 0},mongoFormatValue:function(e,t,r){var a=this.utils.moment(e,r.valueFormat);return a.isValid()?a.toDate():void 0}},boolean:{type:"boolean",jsType:"boolean",valueSrc:"value",labelYes:"Yes",labelNo:"No",formatValue:function(e,t,r,a){return a?e?"Yes":"No":JSON.stringify(!!e)},sqlFormatValue:function(e,t,r,a,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e,t,r,a,o){return this.utils.spelEscape(e)},defaultValue:!1,toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},field:{valueSrc:"field",formatValue:function(e,t,r,a,o,u,i){return a&&i.label||e},sqlFormatValue:function(e,t,r,a,o,u){return e},spelFormatValue:function(e,t,r,a,o){return e},valueLabel:"Field to compare",valuePlaceholder:"Select field to compare"},func:{valueSrc:"func",valueLabel:"Function",valuePlaceholder:"Select function"},case_value:{valueSrc:"value",type:"case_value",spelFormatValue:function(e){return this.utils.spelEscape(e===""?null:e)},spelImportValue:function(e){return[e.value,[]]}}},cm={text:{defaultOperator:"equal",mainWidget:"text",widgets:{text:{operators:["equal","not_equal","like","not_like","starts_with","ends_with","proximity","is_empty","is_not_empty","is_null","is_not_null"],widgetProps:{},opProps:{}},textarea:{operators:["equal","not_equal","like","not_like","starts_with","ends_with","is_empty","is_not_empty","is_null","is_not_null"],widgetProps:{},opProps:{}},field:{operators:["equal","not_equal","proximity"]}}},number:{defaultOperator:"equal",mainWidget:"number",widgets:{number:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]},slider:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","is_null","is_not_null"]}}},date:{defaultOperator:"equal",widgets:{date:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},time:{defaultOperator:"equal",widgets:{time:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},datetime:{defaultOperator:"equal",widgets:{datetime:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},select:{mainWidget:"select",defaultOperator:"select_equals",widgets:{select:{operators:["select_equals","select_not_equals","is_null","is_not_null"]},multiselect:{operators:["select_any_in","select_not_any_in","is_null","is_not_null"]}}},multiselect:{defaultOperator:"multiselect_equals",widgets:{multiselect:{operators:["multiselect_contains","multiselect_not_contains","multiselect_equals","multiselect_not_equals","is_null","is_not_null"]}}},boolean:{defaultOperator:"equal",widgets:{boolean:{operators:["equal","not_equal","is_null","is_not_null"],widgetProps:{}},field:{operators:["equal","not_equal"]}}},"!group":{defaultOperator:"some",mainWidget:"number",widgets:{number:{widgetProps:{min:0},operators:["some","all","none","equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between"],opProps:{equal:{label:"Count =="},not_equal:{label:"Count !="},less:{label:"Count <"},less_or_equal:{label:"Count <="},greater:{label:"Count >"},greater_or_equal:{label:"Count >="},between:{label:"Count between"},not_between:{label:"Count not between"}}}}},case_value:{mainWidget:"case_value",widgets:{case_value:{}}}},dm=ir(ir({},Fs),{},{convertableWidgets:{number:["slider","rangeslider"],slider:["number","rangeslider"],rangeslider:["number","slider"],text:["textarea"],textarea:["text"]},formatSpelField:function(e,t,r,a,o,u){var i=this,l=a.map(function(s,c){var d=s.key,f=s.parent,p=s.fieldSeparator;return c==0?f=="[map]"?"#this[".concat(i.utils.spelEscape(d),"]"):(f=="[class]",d):f=="map"||f=="[map]"?"[".concat(i.utils.spelEscape(d),"]"):(f=="class"||f=="[class]","".concat(p).concat(d))}).join("");return o.fieldName&&(l=e),o.isSpelVariable&&(l="#"+l),l},sqlFormatReverse:function(e){if(e!=null)return"NOT("+e+")"},spelFormatReverse:function(e){if(e!=null)return"!("+e+")"},formatReverse:function(e,t,r,a,o,u){if(e!=null)return u?"NOT ("+e+")":"!("+e+")"},formatAggr:function(e,t,r,a,o,u,i,l,s,c){var d=i.labelForFormat,f=i.cardinality;if(f==0){var p=e?" HAVE ".concat(e):"";return"".concat(d," OF ").concat(t).concat(p)}else if(f==null||f==1){var v=e?" WHERE ".concat(e):"";return"COUNT OF ".concat(t).concat(v," ").concat(d," ").concat(a)}else if(f==2){var g=e?" WHERE ".concat(e):"",m=a.first(),O=a.get(1);return"COUNT OF ".concat(t).concat(g," ").concat(d," ").concat(m," AND ").concat(O)}},jsonLogic:{groupVarKey:"var",altVarKey:"var",lockedOp:"locked"},canCompareFieldWithField:function(e,t,r,a){return!0},valueSourcesInfo:{value:{label:"Value"},field:{label:"Field",widget:"field"},func:{label:"Function",widget:"func"}}}),cc=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a={rangeslider:vm,treeselect:gm,treemultiselect:mm,rangeable__date:pm("date","date")},o=om(t),u;try{for(o.s();!(u=o.n()).done;){var i=u.value,l=a[i];if(l)e=l(e,r);else throw new Error("Can't ".concat(r?"add":"remove"," mixin ").concat(i))}}catch(s){o.e(s)}finally{o.f()}return e},dc=function(e,t){return cc(e,t,!0)},fm=function(e,t){return cc(e,t,!1)},pm=function(e,t){return function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=r.types;return o=ir(ir({},o),{},(0,te.A)({},e,ir(ir({},o[e]),{},{widgets:ir({},o[e].widgets)}))),a?o[e].widgets[t]=ir({opProps:{between:{isSpecialRange:!0,textSeparators:[null,null]},not_between:{isSpecialRange:!0,textSeparators:[null,null]}}},o[e].widgets[t]):delete o[e].widgets[t],ir(ir({},r),{},{types:o})}},vm=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=e.widgets,a=e.types;return r=ir({},r),t?r.rangeslider=ir({type:"number",jsType:"number",valueSrc:"value",valueLabel:"Range",valuePlaceholder:"Select range",valueLabels:[{label:"Number from",placeholder:"Enter number from"},{label:"Number to",placeholder:"Enter number to"}],formatValue:function(u,i,l,s){return s?this.utils.stringifyForDisplay(u):JSON.stringify(u)},sqlFormatValue:function(u,i,l,s,c){return this.utils.SqlString.escape(u)},spelFormatValue:function(u){return this.utils.spelEscape(u)},singleWidget:"slider",toJS:function(u,i){return u}},r.rangeslider):delete r.rangeslider,a=ir(ir({},a),{},{number:ir(ir({},a.number),{},{widgets:ir({},a.number.widgets)})}),t?a.number.widgets.rangeslider=ir({opProps:{between:{isSpecialRange:!0},not_between:{isSpecialRange:!0}},operators:["between","not_between","is_null","is_not_null"]},a.number.widgets.rangeslider):delete a.number.widgets.rangeslider,ir(ir({},e),{},{widgets:r,types:a})},gm=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=e.widgets,a=e.types;return r=ir({},r),t?r.treeselect=ir({type:"treeselect",jsType:"string",valueSrc:"value",valueLabel:"Value",valuePlaceholder:"Select value",formatValue:function(u,i,l,s){var c=i.fieldSettings.treeValues||i.fieldSettings.listValues||i.asyncListValues,d=this.utils.getTitleInListValues(c,u);return s?this.utils.stringifyForDisplay(d):JSON.stringify(u)},sqlFormatValue:function(u,i,l,s,c){return this.utils.SqlString.escape(u)},spelFormatValue:function(u){return this.utils.spelEscape(u)},toJS:function(u,i){return u}},r.treeselect):delete r.treeselect,a=ir({},a),t?a.treeselect=ir({mainWidget:"treeselect",defaultOperator:"select_equals",widgets:{treeselect:{operators:["select_equals","select_not_equals"]},treemultiselect:{operators:["select_any_in","select_not_any_in"]}}},a.treeselect):delete a.treeselect,ir(ir({},e),{},{widgets:r,types:a})},mm=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=e.widgets,a=e.types;return r=ir({},r),t?r.treemultiselect=ir({type:"treemultiselect",jsType:"array",valueSrc:"value",valueLabel:"Values",valuePlaceholder:"Select values",formatValue:function(u,i,l,s){var c=this,d=i.fieldSettings.treeValues||i.fieldSettings.listValues||i.asyncListValues,f=u.map(function(p){return c.utils.getTitleInListValues(d,p)});return s?f.map(this.utils.stringifyForDisplay):u.map(JSON.stringify)},sqlFormatValue:function(u,i,l,s,c){var d=this;return u.map(function(f){return d.utils.SqlString.escape(f)})},spelFormatValue:function(u){return this.utils.spelEscape(u)},toJS:function(u,i){return u}},r.treemultiselect):delete r.treemultiselect,a=ir({},a),t?a.treemultiselect=ir({defaultOperator:"multiselect_equals",widgets:{treemultiselect:{operators:["multiselect_equals","multiselect_not_equals"]}}},a.treemultiselect):delete a.treemultiselect,ir(ir({},e),{},{widgets:r,types:a})},hm={addMixins:dc,removeMixins:fm},Ei={conjunctions:um,operators:lm,widgets:sm,types:cm,settings:dm,ctx:am};Ei=dc(Ei,["rangeslider","treeselect","treemultiselect"]);const Rr=Ei;var fc="ADD_GROUP",Ai="ADD_CASE_GROUP",pc="REMOVE_GROUP",vc="SET_CONJUNCTION",gc="SET_NOT",mc="ADD_RULE",hc="REMOVE_RULE",yc="SET_FIELD",Oc="SET_FIELD_SRC",bc="SET_OPERATOR",Sc="SET_VALUE",Fc="SET_VALUE_SRC",Cc="SET_FUNC_VALUE",Tc="SET_OPERATOR_OPTION",Ec="SET_LOCK",Li="SET_TREE",Ac="MOVE_ITEM",Lc="after",wc="before",wi="append",ji="prepend",jc="SET_DRAG_PROGRESS",Rc="SET_DRAG_START",Pc="SET_DRAG_END",ym=h(73916),ro=h.n(ym);function Ri(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Om(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function Om(n,e){if(n){if(typeof n=="string")return xc(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return xc(n,e)}}function xc(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Ic(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function zt(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ic(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Ic(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Vc=function(e,t,r,a,o,u){var i,l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,s=arguments.length>7&&arguments[7]!==void 0?arguments[7]:{},c=(o==null||(i=o.get)===null||i===void 0?void 0:i.call(o,"id"))||a,d=u.settings.shouldCreateEmptyGroup,f=t.push(c),p=!d,v=!!(s!=null&&s.isDefaultCase),g=e;return e=Pn(e,t,r,c,On(u).merge((0,be.fromJS)(o)||{}),u,l),e!==g&&(!l&&!v&&(e=e.setIn(Ce(f,"children1"),new be.default.OrderedMap),p&&(e=Pn(e,f,"rule",cr(),Kt(u),u))),e=Dt(e)),e},bm=function(e,t,r){e=Pi(e,t);var a=r.settings.canLeaveEmptyGroup,o=t.slice(0,-1),u=!Go(e,o);if(u&&!a&&(e=Wa(e),_o(e)&&!a)){var i=!1,l=!1;e=Pn(e,new be.default.List,"rule",cr(),Kt(r,void 0,void 0,i,l),r)}return e=Dt(e),e},Sm=function(e,t,r){e=Pi(e,t);var a=r.settings.canLeaveEmptyGroup,o=t.pop(),u=e.getIn(Ce(o)),i=u.getIn(["properties","field"]),l=u.getIn(["properties","operator"]),s=u.getIn(["properties","value",0]),c=i?je(r,i):null,d=l?dr(r,l,i):null,f=i&&l&&d.cardinality!=0,p=u.get("type")=="rule_group",v=!Go(e,o),g=p?f&&c.initialEmptyWhere:a;if(v&&!g&&(p&&(e=e.deleteIn(Ce(o))),e=Wa(e),_o(e)&&!a)){var m=!1,O=!1;e=Pn(e,new be.default.List,"rule",cr(),Kt(r,void 0,void 0,m,O),r)}return e=Dt(e),e},Fm=function(e,t,r){return e.setIn(Ce(t,"properties","not"),r)},Cm=function(e,t,r){return vu(e.setIn(Ce(t,"properties","isLocked"),r))},Tm=function(e,t,r){return e.setIn(Ce(t,"properties","conjunction"),r)},Em=function n(e,t,r){r&&Array.isArray(r)&&(t.children1=new be.default.OrderedMap(r.reduce(function(a,o){var u,i=(u=o.id)!==null&&u!==void 0?u:cr(),l=zt(zt({},o),{},{properties:nl(e,o).merge((0,be.fromJS)(o.properties)||{}),id:i});return n(e,l,l.children1),zt(zt({},a),{},(0,te.A)({},i,new be.default.Map(l)))},{})))},Pn=function(e,t,r,a,o,u){var i,l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,s=(o==null||(i=o.get)===null||i===void 0?void 0:i.call(o,"id"))||a;if(r=="switch_group")throw new Error("Can't add switch_group programmatically");var c=u.settings,d=c.maxNumberOfCases,f=c.maxNumberOfRules,p=c.maxNesting,v=e.get("type"),g=v=="switch_group",m=e.getIn(Ce(t)),O=g?e.getIn(Ce(t.take(2))):null,y=Ce(t,"children1"),b=e.getIn(y),A=!!b&&b.size,L=A?b.size:null,S,R;r=="case_group"?(S=L,R=d):r=="group"?(S=t.size,R=p):m?.get("type")=="rule_group"||(S=Mo(g?O:e),R=f);var N=R&&S?S<R:!0,M={type:r,id:s,properties:o};Em(u,M,l);var x=r=="case_group"&&A&&b.last().get("children1")==null;if(N){var W=new be.default.OrderedMap((0,te.A)({},s,new be.default.Map(M)));if(!A)e=e.setIn(y,W);else if(x){var B=b.last(),k=new be.default.OrderedMap((0,te.A)((0,te.A)({},s,new be.default.Map(M)),B.get("id"),B));e=e.deleteIn(Ce(y,"children1",B.get("id"))),e=e.mergeIn(y,k)}else e=e.mergeIn(y,W);e=Dt(e)}return e},Pi=function(e,t){return e=e.deleteIn(Ce(t)),e=Dt(e),e},Am=function(e,t,r,a,o){var u=Gn(e,t),i=t.pop(),l=t.size>1?Gn(e,i):null,s=l?l.get("children1"):null,c=Gn(e,r),d=a==wi||a==ji?r:r.pop(),f=a==wi||a==ji?c:r.size>1?Gn(e,d):null,p=f?f.get("children1"):null;if(!l||!f||!u)return e;var v=l.get("id")==f.get("id"),g=d.size<i.size&&Ma(d.toArray(),i.toArray().slice(0,d.size)),m=d.size>i.size&&Ma(i.toArray(),d.toArray().slice(0,i.size)),O=null,y=null;g?O=be.default.List(i.toArray().slice(d.size)):m&&(y=be.default.List(d.toArray().slice(i.size)));var b=p,A=s;return m||(A=A.delete(u.get("id"))),v?b=A:g&&(b=b.updateIn(No(O,"children1"),function(L){return A})),a==wc||a==Lc?b=be.default.OrderedMap().withMutations(function(L){var S=Ri(b.entries()),R;try{for(S.s();!(R=S.n()).done;){var N=(0,Le.A)(R.value,2),M=N[0],x=N[1];M==c.get("id")&&a==wc&&L.set(u.get("id"),u),L.set(M,x),M==c.get("id")&&a==Lc&&L.set(u.get("id"),u)}}catch(W){S.e(W)}finally{S.f()}}):a==wi?b=b.merge(be.default.OrderedMap((0,te.A)({},u.get("id"),u))):a==ji&&(b=be.default.OrderedMap((0,te.A)({},u.get("id"),u)).merge(b)),m&&(A=A.updateIn(No(y,"children1"),function(L){return b}),A=A.delete(u.get("id"))),!v&&!g&&(e=e.updateIn(Ce(i,"children1"),function(L){return A})),m||(e=e.updateIn(Ce(d,"children1"),function(L){return b})),e=Dt(e),e},Lm=function(e,t,r,a){var o=a.settings.keepInputOnChangeFieldSrc,u=e.getIn(Ce(t)),i=u.get("type"),l=u.get("properties"),s=l?.get("field"),c=l?.get("fieldType"),d=je(a,s),f=d?.type||c;(!f||f==="!group"||f==="!struct")&&(f=null);var p=!qa.includes(f),v=o&&!si(u,a)&&p;return v?(e=e.setIn(Ce(t,"properties","field"),null),e=e.deleteIn(Ce(t,"properties","fieldError")),e=e.setIn(Ce(t,"properties","fieldType"),f)):e=e.setIn(Ce(t,"properties"),Kt(a,null,null,!1)),e=e.setIn(Ce(t,"properties","fieldSrc"),r),e},wm=function(e,t,r,a,o,u,i,l,s){var c=arguments.length>9&&arguments[9]!==void 0?arguments[9]:{},d=e.settings.showErrorMessage,f=a===-1,p=t.getIn(Ce(r,"properties")),v=p.get("field"),g=p.get("value"),m=f?v:g.getIn([a]),O=[],y=m,b=Ri(o||[]),A;try{for(b.s();!(A=b.n()).done;){var L=(0,Le.A)(A.value,2),S=L[0],R=L[1];if(O.push([S,R,y]),S!==y.get("func")){var N=O.map(function(ve){var ce=(0,Le.A)(ve,2),se=ce[0],Te=ce[1];return"".concat(se,"(").concat(Te,")")}).join("/")||"root";throw new Error("In ".concat(f?"LHS":"RHS"," for path ").concat(N," expected func key ").concat(S," but got ").concat(parent.get("func")))}y=y.getIn(["args",R,"value"])}}catch(ve){b.e(ve)}finally{b.f()}if(u){var W=y.get("func"),B=_r(e,W),k=B.args,Q=k[u];l==="!valueSrc"?y=ns(y,u,i,Q,e):y=ii(y,u,i,Q,e)}else{var M=i,x=!0;y=rs(y,M,e,x),c.canDropArgs=!0}for(var K=y;O.length;){var J=O.pop(),G=(0,Le.A)(J,3),re=G[0],ue=G[1],de=G[2],fe=_r(e,re),ae=fe.args,ne=ae[ue];K=ii(de,ue,K,ne,e)}return f?Dc(t,r,K,e,s,c):Nc(t,r,a,K,void 0,e,s,c)},Dc=function(e,t,r,a,o){var u,i,l,s,c,d,f=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},p=f.__isInternal,v=f.isEndValue,g=f.canDropArgs,m;if(!r)return{tree:Pi(e,t),isInternalValueChange:m};var O=a.settings,y=O.fieldSeparator,b=O.setOpOnChangeField,A=O.showErrorMessage;Array.isArray(r)&&(r=r.join(y));var L=e.getIn(Ce(t,"type")),S=e.getIn(Ce(t,"properties")),R=L=="rule_group",N=S?.get("fieldSrc"),M=S?.get("fieldError"),x=je(a,r);if(!x)return console.warn("No config for LHS ".concat(r)),{tree:e,isInternalValueChange:m};var W=x.type;(W==="!group"||W==="!struct")&&(W=null);var B=S?.get("operator"),k=S?.get("operatorOptions"),Q=S?.get("field"),K=S==null||(u=S.get("valueError"))===null||u===void 0||(i=u.join)===null||i===void 0?void 0:i.call(u,"|"),J=x.type=="!group",G=J&&x.mode=="array",re=R!=J,ue=x&&((l=x.operators)===null||l===void 0?void 0:l.indexOf(B))!==-1?B:null,de=N==="func"&&(Q==null||(s=Q.get)===null||s===void 0?void 0:s.call(Q,"func"))===((c=r)===null||c===void 0||(d=c.get)===null||d===void 0?void 0:d.call(c,"func")),fe=de&&!!ue,ae=null,ne=N==="func"?os(a,W):Qa(a,r);if(ne&&ne.length==1)ae=ne[0];else if(fe)ae=ue;else if(ne&&ne.length>1){var ve=Ri(b),ce;try{for(ve.s();!(ce=ve.n()).done;){var se=ce.value;if(se=="keep"&&!re?ae=ue:se=="default"?ae=Yo(a,r,!1):se=="first"&&(ae=ui(a,r)),ae)break}}catch(ar){ve.e(ar)}finally{ve.f()}}if(!J&&!x.operators)return console.warn("Type ".concat(x.type," is not supported")),{tree:e,isInternalValueChange:m};R&&!J&&(e=e.setIn(Ce(t,"type"),"rule"),e=e.deleteIn(Ce(t,"children1")),e=e.setIn(Ce(t,"properties"),new be.default.OrderedMap)),S||(e=e.setIn(Ce(t,"properties"),new be.default.OrderedMap));var Te=!A;if(J){e=e.setIn(Ce(t,"type"),"rule_group");var Oe=wn(a,a,S,r,ae,"field",Te,v,g),Re=Oe.canReuseValue,Ve=Oe.newValue,Ue=Oe.newValueSrc,Ye=Oe.newValueType,qe=Oe.operatorCardinality,Be=On(a,x).merge({field:r,fieldSrc:"field",mode:x.mode});G&&(Be=Be.merge({operator:ae,value:Ve,valueSrc:Ue,valueType:Ye})),e=e.setIn(Ce(t,"children1"),new be.default.OrderedMap),e=e.setIn(Ce(t,"properties"),Be),x.initialEmptyWhere&&qe==1||(e=Pn(e,t,"rule",cr(),Kt(a,r),a)),e=Dt(e)}else e=e.updateIn(Ce(t,"properties"),function(ar){return ar.withMutations(function(nr){var Lr,rr=wn(a,a,nr,r,ae,"field",Te,v,g),dt=rr.canReuseValue,_t=rr.newValue,St=rr.newValueSrc,Ft=rr.newValueType,ht=rr.newValueError,Gt=rr.newFieldError,$t=rr.fixedField,ot=ht==null||(Lr=ht.join)===null||Lr===void 0?void 0:Lr.call(ht,"|"),Jr=r,cn=$t!==r;cn&&(Jr=$t);var dn=A?M!=Gt:!!M!=!!Gt,it=A?K!=ot:!!K!=!!ot,Vr=dn||it;m=!!p&&!Vr&&!cn,(A||p&&Vr)&&(nr=nr.set("fieldError",Gt),nr=nr.set("valueError",ht));var er=dt?k:Oa(a,ae,Jr);return nr=nr.set("field",Jr).delete("fieldType").set("fieldSrc",N).set("operator",ae).set("operatorOptions",er).set("value",_t).set("valueSrc",St).set("valueType",Ft),dt||(nr=nr.delete("asyncListValues")),nr})});return{tree:e,isInternalValueChange:m}},jm=function(e,t,r,a){var o=a.settings.showErrorMessage,u=e.getIn(Ce(t,"properties")),i=e.getIn(Ce(t,"children1")),l=u.get("field"),s=u.get("fieldSrc"),c=je(a,l),d=c?.type=="!group",f=dr(a,r,l),p=f?kr(f):null,v=!0;return e=e.updateIn(Ce(t,"properties"),function(g){return g.withMutations(function(m){var O=m.get("field"),y=m.get("operatorOptions"),b=m.get("value",new be.default.List),A=m.get("valueSrc",new be.default.List),L=m.get("operator"),S=wn(a,a,m,O,r,"operator",v),R=S.canReuseValue,N=S.newValue,M=S.newValueSrc,x=S.newValueType,W=S.newValueError;o&&(m=m.set("valueError",W));var B=R?y:Oa(a,r,O);return R||(m=m.delete("asyncListValues")),m.set("operator",r).set("operatorOptions",B).set("value",N).set("valueSrc",M).set("valueType",x)})}),d&&p==0&&i.size==0&&(e=Pn(e,t,"rule",cr(),Kt(a,l),a)),e},Nc=function(e,t,r,a,o,u,i){var l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:{},s=l.__isInternal,c=l.canDropArgs,d=l.isEndValue,f=u.settings,p=f.fieldSeparator,v=f.showErrorMessage,g,m=e.getIn(Ce(t,"properties","valueSrc",r+""))||null;m==="field"&&Array.isArray(a)&&(a=a.join(p));var O=e.getIn(Ce(t,"properties","field"))||null,y=e.getIn(Ce(t,"properties","operator"))||null,b=dr(u,y,O),A=y?kr(b):null,L=o||is(a,m,u),S=!v,R=Kn(u,O,O,y,a,L,m,i,S,d,c),N=(0,Le.A)(R,2),M=N[0],x=N[1],W=x?.find(function(Oe){return!Oe.fixed&&!Oe.ignore}),B=W?Nt(W):null,k=M!==a;k&&(a=M),e=kc(e,t,u,A);var Q=Array.from({length:A},function(Oe,Re){return Re==r?a:e.getIn(Ce(t,"properties","value",Re+""))||null}),K=Array.from({length:A},function(Oe,Re){return e.getIn(Ce(t,"properties","valueSrc",Re+""))||null}),J=ai(u,O,y,Q,K),G=J?Nt(J):null,re=!B&&!G,ue=e.getIn(Ce(t,"properties","value",r)),de=e.getIn(Ce(t,"properties","valueError",r)),fe=e.getIn(Ce(t,"properties","valueError",A)),ae=v?de!=B:!!de!=!!B,ne=v?fe!=G:!!fe!=!!G,ve=ae||ne,ce=!!ue!=!!a,se=v?!0:re||k;if(g=!!s&&!ce&&!ve&&!k,se&&(e=e.deleteIn(Ce(t,"properties","asyncListValues")),typeof a>"u"?(e=e.setIn(Ce(t,"properties","value",r),void 0),e=e.setIn(Ce(t,"properties","valueType",r),null)):(i&&(e=e.setIn(Ce(t,"properties","asyncListValues"),i)),e=e.setIn(Ce(t,"properties","value",r),a),e=e.setIn(Ce(t,"properties","valueType",r),L))),v||s&&ve){var Te=e.getIn(Ce(t,"properties","valueError"));Te||(e=e.setIn(Ce(t,"properties","valueError"),new be.default.List(new Array(A)))),e=e.setIn(Ce(t,"properties","valueError",r),B),A>=2&&(e=e.setIn(Ce(t,"properties","valueError",A),G))}return{tree:e,isInternalValueChange:g}},Rm=function(e,t,r,a,o){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},i=o.settings.showErrorMessage,l=e.getIn(Ce(t,"properties","field"))||null,s=e.getIn(Ce(t,"properties","operator"))||null,c=dr(o,s,l),d=s?kr(c):null;if(e=kc(e,t,o,d),e=e.setIn(Ce(t,"properties","value",r+""),void 0),e=e.setIn(Ce(t,"properties","valueType",r+""),null),e=e.deleteIn(Ce(t,"properties","asyncListValues")),i&&(e=e.setIn(Ce(t,"properties","valueError",r),null),c.validateValues&&(e=e.setIn(Ce(t,"properties","valueError",d),null))),typeof a>"u"?e=e.setIn(Ce(t,"properties","valueSrc",r+""),null):e=e.setIn(Ce(t,"properties","valueSrc",r+""),a),a){var f=e.getIn(Ce(t,"properties")),p=!0,v=wn(o,o,f,l,s,"valueSrc",p),g=v.canReuseValue,m=v.newValue,O=v.newValueSrc,y=v.newValueType,b=v.newValueError;!g&&O.get(r)==a&&(e=e.setIn(Ce(t,"properties","value",r+""),m.get(r)),e=e.setIn(Ce(t,"properties","valueType",r+""),y.get(r)))}return e},Pm=function(e,t,r,a){return e.setIn(Ce(t,"properties","operatorOptions",r),a)},xm=function(e,t){var r=t.settings.canLeaveEmptyGroup;return r||(e=Wa(e)),e},kc=function(e,t,r,a){if(!a){var o=e.getIn(Ce(t,"properties","field"))||null,u=e.getIn(Ce(t,"properties","operator"))||null,i=dr(r,u,o);a=u?kr(i):null}for(var l=0,s=["value","valueType","valueError","valueSrc"];l<s.length;l++){var c=s[l];e.getIn(Ce(t,"properties",c))||(e=e.setIn(Ce(t,"properties",c),new be.default.List(a?Array.from({length:a}):[])))}return e},Im=function(e,t){var r=e.getIn(Ce(t,"properties","field"))||null;return r},Mc={dragging:{id:null,x:null,y:null,w:null,h:null},mousePos:{},dragStart:{id:null}},Vm=function(e,t){if(!e||!e.type)return null;var r=["config","asyncListValues"],a=[Li,Rc,jc,Pc],o=ro()(Cr()(e,r),Ro),u=e.path&&Im(t.tree,e.path)||e.field;if(u){var i;(i=u)!==null&&i!==void 0&&i.toJS&&(u=u.toJS()),o.affectedField=u}return(a.includes(e.type)||e.type.indexOf("@@redux")==0)&&(o=null),o};const Dm=function(n,e,t,r,a){var o=e,u=zt({tree:o},Mc);return function(){var i,l,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:u,c=arguments.length>1?arguments[1]:void 0,d=(i=(l=a?.())!==null&&l!==void 0?l:c.config)!==null&&i!==void 0?i:n,f={__isInternalValueChange:void 0,__lastAction:void 0},p={},v=Vm(c,s);switch(c?.type){case Li:{var g=t(d,c.tree);p.tree=g;break}case Ai:{p.tree=Vc(s.tree,c.path,"case_group",c.id,c.properties,d,c.children,c.meta);break}case fc:{p.tree=Vc(s.tree,c.path,"group",c.id,c.properties,d,c.children,c.meta);break}case pc:{p.tree=bm(s.tree,c.path,d);break}case mc:{p.tree=Pn(s.tree,c.path,c.ruleType,c.id,c.properties,d,c.children);break}case hc:{p.tree=Sm(s.tree,c.path,d);break}case vc:{p.tree=Tm(s.tree,c.path,c.conjunction);break}case gc:{p.tree=Fm(s.tree,c.path,c.not);break}case yc:{var m=d.settings.optimizeRenderWithInternals,O=Dc(s.tree,c.path,c.field,d,c.asyncListValues,c._meta),y=O.tree,b=O.isInternalValueChange;p.__isInternalValueChange=m&&b,p.tree=y;break}case Oc:{p.tree=Lm(s.tree,c.path,c.srcKey,d);break}case Ec:{p.tree=Cm(s.tree,c.path,c.lock);break}case bc:{p.tree=jm(s.tree,c.path,c.operator,d);break}case Sc:{var A=d.settings.optimizeRenderWithInternals,L=Nc(s.tree,c.path,c.delta,c.value,c.valueType,d,c.asyncListValues,c._meta),S=L.tree,R=L.isInternalValueChange;p.__isInternalValueChange=A&&R,p.tree=S;break}case Cc:{var N=d.settings.optimizeRenderWithInternals,M=wm(d,s.tree,c.path,c.delta,c.parentFuncs,c.argKey,c.value,c.valueType,c.asyncListValues,c._meta),x=M.tree,W=M.isInternalValueChange;p.__isInternalValueChange=N&&W,p.tree=x;break}case Fc:{p.tree=Rm(s.tree,c.path,c.delta,c.srcKey,d,c._meta);break}case Tc:{p.tree=Pm(s.tree,c.path,c.name,c.value);break}case Ac:{p.tree=Am(s.tree,c.fromPath,c.toPath,c.placement,d);break}case Rc:{p.dragStart=c.dragStart,p.dragging=c.dragging,p.mousePos=c.mousePos;break}case jc:{p.mousePos=c.mousePos,p.dragging=c.dragging;break}case Pc:{p.tree=xm(s.tree,d),p=zt(zt({},p),Mc);break}default:break}return v&&(p.__lastAction=v),r&&p.tree&&s.tree&&r(s.tree),zt(zt(zt({},s),f),p)}};var Nm=function(e,t){return{type:Li,tree:t,config:e}},km=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"rule",o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null;return{type:mc,ruleType:a,children:o,path:Mr(t),id:cr(),properties:Kt(e,u).merge((0,be.fromJS)(r)||{}),config:e}},Mm=function(e,t){return{type:hc,path:Mr(t),config:e}},_m=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;return{type:Ai,path:Mr(t),children:a,id:cr(),properties:On(e).merge((0,be.fromJS)(r)||{}),config:e,meta:{isDefaultCase:!0}}},Gm=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;return{type:Ai,path:Mr(t),children:a,id:cr(),properties:On(e).merge((0,be.fromJS)(r)||{}),config:e}},$m=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;return{type:fc,path:Mr(t),children:a,id:cr(),properties:On(e).merge((0,be.fromJS)(r)||{}),config:e}},Um=function(e,t){return{type:pc,path:Mr(t),config:e}},Bm=function(e,t,r,a){return{type:Ac,fromPath:Mr(t),toPath:Mr(r),placement:a,config:e}},Wm=function(e,t,r){return{type:vc,path:Mr(t),conjunction:r}},Km=function(e,t,r){return{type:gc,path:Mr(t),not:r}},Hm=function(e,t,r){return{type:Ec,path:Mr(t),lock:r}},zm=function(e,t,r,a,o){return{type:yc,path:Mr(t),field:r,config:e,asyncListValues:a,_meta:o}},Jm=function(e,t,r){return{type:Oc,path:Mr(t),srcKey:r,config:e}},qm=function(e,t,r){return{type:bc,path:Mr(t),operator:r,config:e}},Qm=function(e,t,r,a,o,u,i){return{type:Sc,path:Mr(t),delta:r,value:a,valueType:o,asyncListValues:u,config:e,_meta:i}},Ym=function(e,t,r,a,o){return{type:Fc,path:Mr(t),delta:r,srcKey:a,config:e,_meta:o}},Xm=function(e,t,r,a,o,u,i,l,s){return{type:Cc,path:Mr(t),delta:r,parentFuncs:a,argKey:o,value:u,valueType:i,asyncListValues:l,config:e,_meta:s}},Zm=function(e,t,r,a){return{type:Tc,path:Mr(t),name:r,value:a,config:e}};function _c(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function xi(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?_c(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):_c(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Je=xi(xi(xi({},q),{},{Export:Y,Import:H,ConfigMixins:hm},Y),H),eh=h(5556),j=h.n(eh);const rh=Dm,Fa=F.createContext();var th=h(14644),nh=h(19888),ah=h(69242),oh=h(40961);function ih(n){n()}let Gc=ih;const uh=n=>Gc=n,lh=()=>Gc,$c=Symbol.for("react-redux-context"),Uc=typeof globalThis<"u"?globalThis:{};function sh(){var n;if(!F.createContext)return{};const e=(n=Uc[$c])!=null?n:Uc[$c]=new Map;let t=e.get(F.createContext);return t||(t=F.createContext(null),e.set(F.createContext,t)),t}const Bc=sh(),db=null;function fb(n=ReactReduxContext){return function(){return useContext(n)}}const pb=null;let Wc=null;const ch=n=>{Wc=n},dh=(n,e)=>n===e;function vb(n=ReactReduxContext){const e=n===ReactReduxContext?useDefaultReduxContext:createReduxContextHook(n);return function(r,a={}){const{equalityFn:o=dh,stabilityCheck:u=void 0,noopCheck:i=void 0}=typeof a=="function"?{equalityFn:a}:a,{store:l,subscription:s,getServerState:c,stabilityCheck:d,noopCheck:f}=e(),p=useRef(!0),v=useCallback({[r.name](m){return r(m)}}[r.name],[r,d,u]),g=Wc(s.addNestedSub,l.getState,c||l.getState,v,o);return useDebugValue(g),g}}const gb=null;var fr=h(58168),Kc=h(98587),fh=h(4146),Hc=h.n(fh),ph=h(44363);const vh=["initMapStateToProps","initMapDispatchToProps","initMergeProps"];function gh(n,e,t,r,{areStatesEqual:a,areOwnPropsEqual:o,areStatePropsEqual:u}){let i=!1,l,s,c,d,f;function p(y,b){return l=y,s=b,c=n(l,s),d=e(r,s),f=t(c,d,s),i=!0,f}function v(){return c=n(l,s),e.dependsOnOwnProps&&(d=e(r,s)),f=t(c,d,s),f}function g(){return n.dependsOnOwnProps&&(c=n(l,s)),e.dependsOnOwnProps&&(d=e(r,s)),f=t(c,d,s),f}function m(){const y=n(l,s),b=!u(y,c);return c=y,b&&(f=t(c,d,s)),f}function O(y,b){const A=!o(b,s),L=!a(y,l,b,s);return l=y,s=b,A&&L?v():A?g():L?m():f}return function(b,A){return i?O(b,A):p(b,A)}}function mh(n,e){let{initMapStateToProps:t,initMapDispatchToProps:r,initMergeProps:a}=e,o=(0,Kc.A)(e,vh);const u=t(n,o),i=r(n,o),l=a(n,o);return gh(u,i,l,n,o)}function hh(n,e){const t={};for(const r in n){const a=n[r];typeof a=="function"&&(t[r]=(...o)=>e(a(...o)))}return t}function Ii(n){return function(t){const r=n(t);function a(){return r}return a.dependsOnOwnProps=!1,a}}function zc(n){return n.dependsOnOwnProps?!!n.dependsOnOwnProps:n.length!==1}function Jc(n,e){return function(r,{displayName:a}){const o=function(i,l){return o.dependsOnOwnProps?o.mapToProps(i,l):o.mapToProps(i,void 0)};return o.dependsOnOwnProps=!0,o.mapToProps=function(i,l){o.mapToProps=n,o.dependsOnOwnProps=zc(n);let s=o(i,l);return typeof s=="function"&&(o.mapToProps=s,o.dependsOnOwnProps=zc(s),s=o(i,l)),s},o}}function Vi(n,e){return(t,r)=>{throw new Error(`Invalid value of type ${typeof n} for ${e} argument when connecting component ${r.wrappedComponentName}.`)}}function yh(n){return n&&typeof n=="object"?Ii(e=>hh(n,e)):n?typeof n=="function"?Jc(n,"mapDispatchToProps"):Vi(n,"mapDispatchToProps"):Ii(e=>({dispatch:e}))}function Oh(n){return n?typeof n=="function"?Jc(n,"mapStateToProps"):Vi(n,"mapStateToProps"):Ii(()=>({}))}function bh(n,e,t){return(0,fr.A)({},t,n,e)}function Sh(n){return function(t,{displayName:r,areMergedPropsEqual:a}){let o=!1,u;return function(l,s,c){const d=n(l,s,c);return o?a(d,u)||(u=d):(o=!0,u=d),u}}}function Fh(n){return n?typeof n=="function"?Sh(n):Vi(n,"mergeProps"):()=>bh}function Ch(){const n=lh();let e=null,t=null;return{clear(){e=null,t=null},notify(){n(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){let r=[],a=e;for(;a;)r.push(a),a=a.next;return r},subscribe(r){let a=!0,o=t={callback:r,next:null,prev:t};return o.prev?o.prev.next=o:e=o,function(){!a||e===null||(a=!1,o.next?o.next.prev=o.prev:t=o.prev,o.prev?o.prev.next=o.next:e=o.next)}}}}const qc={notify(){},get:()=>[]};function Qc(n,e){let t,r=qc,a=0,o=!1;function u(g){c();const m=r.subscribe(g);let O=!1;return()=>{O||(O=!0,m(),d())}}function i(){r.notify()}function l(){v.onStateChange&&v.onStateChange()}function s(){return o}function c(){a++,t||(t=e?e.addNestedSub(l):n.subscribe(l),r=Ch())}function d(){a--,t&&a===0&&(t(),t=void 0,r.clear(),r=qc)}function f(){o||(o=!0,c())}function p(){o&&(o=!1,d())}const v={addNestedSub:u,notifyNestedSubs:i,handleChangeWrapper:l,isSubscribed:s,trySubscribe:f,tryUnsubscribe:p,getListeners:()=>r};return v}const to=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?F.useLayoutEffect:F.useEffect;function Yc(n,e){return n===e?n!==0||e!==0||1/n===1/e:n!==n&&e!==e}function Di(n,e){if(Yc(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;const t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(let a=0;a<t.length;a++)if(!Object.prototype.hasOwnProperty.call(e,t[a])||!Yc(n[t[a]],e[t[a]]))return!1;return!0}const Th=()=>{throw new Error("uSES not initialized!")},Eh=["reactReduxForwardedRef"];let Xc=Th;const Ah=n=>{Xc=n},Lh=null,wh=[null,null],hb=n=>{try{return JSON.stringify(n)}catch{return String(n)}};function jh(n,e,t){to(()=>n(...e),t)}function Rh(n,e,t,r,a,o){n.current=r,t.current=!1,a.current&&(a.current=null,o())}function Ph(n,e,t,r,a,o,u,i,l,s,c){if(!n)return()=>{};let d=!1,f=null;const p=()=>{if(d||!i.current)return;const g=e.getState();let m,O;try{m=r(g,a.current)}catch(y){O=y,f=y}O||(f=null),m===o.current?u.current||s():(o.current=m,l.current=m,u.current=!0,c())};return t.onStateChange=p,t.trySubscribe(),p(),()=>{if(d=!0,t.tryUnsubscribe(),t.onStateChange=null,f)throw f}}const yb=()=>Lh;function xh(n,e){return n===e}let Ob=!1;function Ih(n,e,t,{pure:r,areStatesEqual:a=xh,areOwnPropsEqual:o=Di,areStatePropsEqual:u=Di,areMergedPropsEqual:i=Di,forwardRef:l=!1,context:s=Bc}={}){const c=s,d=Oh(n),f=yh(e),p=Fh(t),v=!!n;return m=>{const O=m.displayName||m.name||"Component",y=`Connect(${O})`,b={shouldHandleStateChanges:v,displayName:y,wrappedComponentName:O,WrappedComponent:m,initMapStateToProps:d,initMapDispatchToProps:f,initMergeProps:p,areStatesEqual:a,areStatePropsEqual:u,areOwnPropsEqual:o,areMergedPropsEqual:i};function A(R){const[N,M,x]=F.useMemo(()=>{const{reactReduxForwardedRef:qe}=R,Be=(0,Kc.A)(R,Eh);return[R.context,qe,Be]},[R]),W=F.useMemo(()=>N&&N.Consumer&&(0,ph.isContextConsumer)(F.createElement(N.Consumer,null))?N:c,[N,c]),B=F.useContext(W),k=!!R.store&&!!R.store.getState&&!!R.store.dispatch,Q=!!B&&!!B.store,K=k?R.store:B.store,J=Q?B.getServerState:K.getState,G=F.useMemo(()=>mh(K.dispatch,b),[K]),[re,ue]=F.useMemo(()=>{if(!v)return wh;const qe=Qc(K,k?void 0:B.subscription),Be=qe.notifyNestedSubs.bind(qe);return[qe,Be]},[K,k,B]),de=F.useMemo(()=>k?B:(0,fr.A)({},B,{subscription:re}),[k,B,re]),fe=F.useRef(),ae=F.useRef(x),ne=F.useRef(),ve=F.useRef(!1),ce=F.useRef(!1),se=F.useRef(!1),Te=F.useRef();to(()=>(se.current=!0,()=>{se.current=!1}),[]);const Oe=F.useMemo(()=>()=>ne.current&&x===ae.current?ne.current:G(K.getState(),x),[K,x]),Re=F.useMemo(()=>Be=>re?Ph(v,K,re,G,ae,fe,ve,se,ne,ue,Be):()=>{},[re]);jh(Rh,[ae,fe,ve,x,ne,ue]);let Ve;try{Ve=Xc(Re,Oe,J?()=>G(J(),x):Oe)}catch(qe){throw Te.current&&(qe.message+=`
The error may be correlated with this previous error:
${Te.current.stack}

`),qe}to(()=>{Te.current=void 0,ne.current=void 0,fe.current=Ve});const Ue=F.useMemo(()=>F.createElement(m,(0,fr.A)({},Ve,{ref:M})),[M,m,Ve]);return F.useMemo(()=>v?F.createElement(W.Provider,{value:de},Ue):Ue,[W,Ue,de])}const S=F.memo(A);if(S.WrappedComponent=m,S.displayName=A.displayName=y,l){const N=F.forwardRef(function(x,W){return F.createElement(S,(0,fr.A)({},x,{reactReduxForwardedRef:W}))});return N.displayName=y,N.WrappedComponent=m,Hc()(N,m)}return Hc()(S,m)}}const no=Ih;function Vh({store:n,context:e,children:t,serverState:r,stabilityCheck:a="once",noopCheck:o="once"}){const u=F.useMemo(()=>{const s=Qc(n);return{store:n,subscription:s,getServerState:r?()=>r:void 0,stabilityCheck:a,noopCheck:o}},[n,r,a,o]),i=F.useMemo(()=>n.getState(),[n]);to(()=>{const{subscription:s}=u;return s.onStateChange=s.notifyNestedSubs,s.trySubscribe(),i!==n.getState()&&s.notifyNestedSubs(),()=>{s.tryUnsubscribe(),s.onStateChange=void 0}},[u,i]);const l=e||Bc;return F.createElement(l.Provider,{value:u},t)}const Dh=Vh;function bb(n=ReactReduxContext){const e=n===ReactReduxContext?useDefaultReduxContext:createReduxContextHook(n);return function(){const{store:r}=e();return r}}const Sb=null;function Fb(n=ReactReduxContext){const e=n===ReactReduxContext?useDefaultStore:createStoreHook(n);return function(){return e().dispatch}}const Cb=null;ch(ah.useSyncExternalStoreWithSelector),Ah(nh.useSyncExternalStore),uh(oh.unstable_batchedUpdates);var Tb="ADD_GROUP",Eb="ADD_CASE_GROUP",Ab="REMOVE_GROUP",Lb="SET_CONJUNCTION",wb="SET_NOT",jb="ADD_RULE",Rb="REMOVE_RULE",Pb="SET_FIELD",xb="SET_FIELD_SRC",Ib="SET_OPERATOR",Vb="SET_VALUE",Db="SET_VALUE_SRC",Nb="SET_OPERATOR_OPTION",kb="SET_LOCK",Mb="SET_TREE",_b="MOVE_ITEM",ao="after",oo="before",xn="append",Yn="prepend",Nh="SET_DRAG_PROGRESS",kh="SET_DRAG_START",Mh="SET_DRAG_END",_h=function(e,t){return{type:Nh,mousePos:e,dragging:t}},Gh=function(e,t,r){return{type:kh,dragStart:e,dragging:t,mousePos:r}},$h=function(){return{type:Mh}},Zc=le,Uh=z,Bh=he;function Ni(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Wh(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function Wh(n,e){if(n){if(typeof n=="string")return ed(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ed(n,e)}}function ed(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}var rd=Je.ConfigUtils,Kh=rd.extendConfig,Xn=rd.configKeys,Hh=function(e){return Bt()(e,Xn)},zh=function(){var e=new Map,t=2,r=0,a=function(s){var c=Kh(s,++r);return e.size+1>t&&e.delete(e.keys().next().value),e.set(s,c),c},o=function(s){var c=Ni(e.keys()),d;try{var f=function(){var g=d.value,m=e.get(g),O=Xn.map(function(y){return m[y]===s[y]}).filter(function(y){return!y}).length===0;if(O)return{v:g}},p;for(c.s();!(d=c.n()).done;)if(p=f(),p)return p.v}catch(v){c.e(v)}finally{c.f()}return s},u=function(s){var c=Ni(e.keys()),d;try{var f=function(){var b=d.value,A=Xn.filter(function(S){return b[S]===s[S]}),L=A.length===Xn.length;if(L)return{v:e.get(b)}},p;for(c.s();!(d=c.n()).done;)if(p=f(),p)return p.v}catch(y){c.e(y)}finally{c.f()}var v=Ni(e.values()),g;try{var m=function(){var b=g.value,A=Xn.filter(function(S){return b[S]===s[S]}),L=A.length===Xn.length;if(L)return{v:b}},O;for(v.s();!(g=v.n()).done;)if(O=m(),O)return O.v}catch(y){v.e(y)}finally{v.f()}return null},i=function(s){return u(s)||a(s)};return{getExtended:function(s){return i(Hh(s))},getBasic:o}},Jh=function(e){var t;return(t=e?.cardinality)!==null&&t!==void 0?t:1},io=function(e,t,r){if(!t||!e||e.length<=t)return e;var a=e.substr(0,t-1);return(r?a.substr(0,a.lastIndexOf(" ")):a)+"..."},In=function(e,t){return e===t?!0:e?.equals(t)},Vn=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return e===t?!0:Array.isArray(e)?qh(e,t,r):e&&typeof e.equals=="function"?e.equals(t):(0,Fr.A)(e)==="object"?Qh(e,t,r):e===t};function qh(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(n===e)return!0;if(!n||!e)return!1;var r=n.length;if(e.length!==r)return!1;for(var a=0;a<r;a++){var o=t?Vn(n[a],e[a],t):n[a]===e[a];if(!o)return!1}return!0}function Qh(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(n===e)return!0;if(!n||!e)return!1;var r=Object.keys(n),a=Object.keys(e),o=r.length;if(a.length!==o)return!1;for(var u=0;u<o;u++){var i=r[u],l=t?Vn(n[i],e[i],t):n[i]===e[i];if(!l)return!1}return!0}var Yh=function(){return typeof process<"u"&&process.env&&!1},Xh=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=e??Yh();return t?console:{error:function(){},log:function(){},warn:function(){},debug:function(){},info:function(){}}},Zh=Xh(),td=Je.Validation.validateAndFixTree,ey=function(){var e,t,r;return function(a,o){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;return o?(a.__configId===r&&(In(o,e)||In(o,t))||(r=a.__configId,e=o,i===!1?t=td(o,null,a,u||a,!1,!1,!1):t=td(o,null,a,u||a)),t):null}},ry=function(e){if(e._reactRootContainer)return"root";if(Object.getOwnPropertyNames(e).filter(function(t){return t.startsWith("__reactContainer")}).length>0)return"container"},ty=function n(e){if(e){var t=ry(e);return t!==void 0?t:n(e.parentNode)}},nd=function(e){return ty(e)==="root"},ki=function(e,t){return function(r,a){var o=e.props,u=e.state,i=r!=o||a!=u;if(i&&u==a&&o!=r){var l=[];for(var s in r){var c=r[s]!=o[s];c&&(t[s]=="ignore"?c=!1:t[s]=="shallow_deep"?c=!Vn(r[s],o[s],!0):t[s]=="shallow"?c=!Vn(r[s],o[s]):typeof t[s]=="function"&&(c=t[s](r[s],o[s],a))),c&&l.push(s)}l.length||(i=!1)}return i}},Zn=function(e){return function(t,r){return!Vn(e.props,t)||!Vn(e.state,r)}},ny=function(){var e=F.version.split(".").map(parseInt.bind(null,10));return e[0]==16&&e[1]<3||e[0]<16},et=function(e){if(e.shouldComponentUpdate||(e.shouldComponentUpdate=Zn(e)),ny())e.componentWillReceiveProps=function(a){e.onPropsChanged(a)};else{var t=e.shouldComponentUpdate,r=function(o,u){var i=!Vn(e.props,o);i&&e.onPropsChanged(o);var l=t.call(e,o,u);return l};e.shouldComponentUpdate=r.bind(e)}},ad=function(e,t,r){return ro()(e,function(a){return function(){for(var o=arguments.length,u=new Array(o),i=0;i<o;i++)u[i]=arguments[i];return r(a.apply(void 0,[t].concat(u)))}})};function od(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Mi(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?od(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):od(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function ay(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,id()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function id(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(id=function(){return!!n})()}var ud=function(n){function e(t){var r;(0,vr.A)(this,e),r=ay(this,e,[t]),r.shouldComponentUpdate=ki(r,{tree:function(u){return!(u===r.oldValidatedTree&&r.oldValidatedTree===r.validatedTree)}}),et(r),r._updateActions(t),r.validatedTree=t.getMemoizedTree(t.config,t.tree,void 0,t.sanitizeTree),r.oldValidatedTree=r.validatedTree;var a=t.getBasicConfig(t.config);return t.onInit&&t.onInit(r.validatedTree,a,void 0,r.actions),r}return(0,mr.A)(e,n),(0,gr.A)(e,[{key:"_updateActions",value:function(r){var a=r.config,o=r.dispatch;this.actions=ad(Mi(Mi(Mi({},Zc),Uh),Bh),a,o)}},{key:"onPropsChanged",value:function(r){var a=r.onChange,o=this.props.config,u=r.tree,i=this.props.tree,l=r.config;this.oldValidatedTree=this.validatedTree,this.validatedTree=u,o!==l&&(this._updateActions(r),this.validatedTree=r.getMemoizedTree(l,u,o));var s=!In(this.validatedTree,this.oldValidatedTree);if(s){var c=r.getBasicConfig(l);a&&a(this.validatedTree,c,r.__lastAction,this.actions)}}},{key:"render",value:function(){var r=this.props,a=r.config,o=r.renderBuilder,u=r.dispatch,i=r.__isInternalValueChange,l={tree:this.validatedTree,actions:this.actions,config:a,dispatch:u,__isInternalValueChange:i};return o(l)}}])}(F.Component);ud.propTypes={config:j().object.isRequired,onChange:j().func,onInit:j().func,renderBuilder:j().func,tree:j().any};var ld=no(function(n){return{tree:n.tree,__isInternalValueChange:n.__isInternalValueChange,__lastAction:n.__lastAction}},null,null,{context:Fa})(ud);ld.displayName="ConnectedQuery";const oy=ld;function iy(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,sd()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function sd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(sd=function(){return!!n})()}var cd=Je.DefaultUtils.defaultRoot,dd=function(n){function e(t,r){var a;(0,vr.A)(this,e),a=iy(this,e,[t,r]),a.setLastTree=function(O){a.prevTree&&(a.prevprevTree=a.prevTree),a.prevTree=O},a.getConfig=function(){return a.config},a.shouldComponentUpdate=ki(a,{value:function(y,b,A){return!1}}),et(a);var o=zh(),u=o.getExtended,i=o.getBasic;a.getMemoizedConfig=u,a.getBasicConfig=i,a.getMemoizedTree=ey();var l=a.getMemoizedConfig(t),s=l.settings.shouldCreateEmptyGroup,c=!s,d=cd(l,c),f=!!t.value,p=t.value||d,v=a.getMemoizedTree(l,p,void 0,f),g=rh(l,v,a.getMemoizedTree,a.setLastTree,a.getConfig),m=(0,th.createStore)(g);return a.config=l,a.state={store:m},a.QueryWrapper=function(O){return l.settings.renderProvider(O,l.ctx)},a}return(0,mr.A)(e,n),(0,gr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,o=this.config,u=this.getMemoizedConfig(r),i=o!==u,l=this.state.store.getState().tree,s=!In(r.value,this.props.value)&&!In(r.value,l),c=s?r.value||cd(r):l,d=s&&!In(r.value,this.prevTree)&&!In(r.value,this.prevprevTree);if(this.sanitizeTree=d||i,i&&(a.settings.renderProvider!==r.settings.renderProvider&&(this.QueryWrapper=function(p){return u.settings.renderProvider(p,u.ctx)}),this.config=u),s||i){var f=this.getMemoizedTree(u,c,o,this.sanitizeTree);this.state.store.dispatch(Zc.setTree(u,f))}}},{key:"render",value:function(){var r=this.props,a=r.renderBuilder,o=r.get_children,u=r.onChange,i=r.onInit,l=this.state.store,s=this.config,c=this.QueryWrapper;return F.createElement(c,{config:s},F.createElement(Dh,{store:l,context:Fa},F.createElement(oy,{config:s,getMemoizedTree:this.getMemoizedTree,getBasicConfig:this.getBasicConfig,sanitizeTree:this.sanitizeTree,onChange:u,onInit:i,renderBuilder:a||o})))}}])}(F.Component);dd.propTypes={conjunctions:j().object.isRequired,fields:j().object.isRequired,types:j().object.isRequired,operators:j().object.isRequired,widgets:j().object.isRequired,settings:j().object.isRequired,ctx:j().object.isRequired,onChange:j().func,onInit:j().func,renderBuilder:j().func,value:j().any};var uy=h(46942),jt=h.n(uy);function ly(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,fd()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function fd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fd=function(){return!!n})()}var sy=Je.ConfigUtils.getFieldConfig,cy=function(e){var t;return t=function(r){function a(o){var u;return(0,vr.A)(this,a),u=ly(this,a,[o]),u.dummyFn=function(){},u.removeSelf=function(){u.props.actions.removeRule(u.props.path)},u.setLock=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;u.props.actions.setLock(u.props.path,i)},u.setField=function(i,l,s){u.props.actions.setField(u.props.path,i,l,s)},u.setFieldSrc=function(i){u.props.actions.setFieldSrc(u.props.path,i)},u.setOperator=function(i){u.props.actions.setOperator(u.props.path,i)},u.setOperatorOption=function(i,l){u.props.actions.setOperatorOption(u.props.path,i,l)},u.setValue=function(i,l,s,c,d){u.props.actions.setValue(u.props.path,i,l,s,c,d)},u.setValueSrc=function(i,l,s){u.props.actions.setValueSrc(u.props.path,i,l,s)},u.setFuncValue=function(i,l,s,c,d,f,p){u.props.actions.setFuncValue(u.props.path,i,l,s,c,d,f,p)},u.pureShouldComponentUpdate=Zn(u),u.dummyFn.isDummyFn=!0,u}return(0,mr.A)(a,r),(0,gr.A)(a,[{key:"shouldComponentUpdate",value:function(u,i){var l=this.props,s=this.state,c=this.pureShouldComponentUpdate(u,i);if(c&&s==i&&l!=u){var d=u.dragging.id||l.dragging.id,f=d==u.id,p=[];for(var v in u){var g=u[v]!=l[v];v=="dragging"&&!f&&(g=!1),g&&p.push(v)}p.length||(c=!1)}return c}},{key:"render",value:function(){var u=this.props.dragging.id==this.props.id,i=sy(this.props.config,this.props.field),l=this.props.fieldType||i?.type||null,s=this.props.config.settings.showErrorMessage,c=i&&i.type=="!struct",d=!u&&this.props.isDraggingTempo,f=this.props,p=f.valueError,v=f.fieldError,g=[v].concat((0,Fe.A)(p?.toArray()||[])).filter(function(O){return!!O}).shift()||null,m=g!=null&&s;return F.createElement("div",{className:jt()("group-or-rule-container","rule-container",m?"rule-with-error":null),"data-id":this.props.id},[u?F.createElement(e,{key:"dragging",id:this.props.id,groupId:this.props.groupId,isDraggingMe:!0,isDraggingTempo:!0,dragging:this.props.dragging,setField:this.dummyFn,setFieldSrc:this.dummyFn,setFuncValue:this.dummyFn,setOperator:this.dummyFn,setOperatorOption:this.dummyFn,setLock:this.dummyFn,removeSelf:this.dummyFn,setValue:this.dummyFn,setValueSrc:this.dummyFn,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:l,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,value:this.props.value||null,valueSrc:this.props.valueSrc||null,valueType:this.props.valueType||null,valueError:this.props.valueError||null,fieldError:this.props.fieldError||null,operatorOptions:this.props.operatorOptions,config:this.props.config,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,asyncListValues:this.props.asyncListValues,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt}):null,F.createElement(e,{key:this.props.id,id:this.props.id,groupId:this.props.groupId,isDraggingMe:u,isDraggingTempo:d,onDragStart:this.props.onDragStart,setLock:d?this.dummyFn:this.setLock,removeSelf:d?this.dummyFn:this.removeSelf,setField:d?this.dummyFn:this.setField,setFieldSrc:d?this.dummyFn:this.setFieldSrc,setFuncValue:d?this.dummyFn:this.setFuncValue,setOperator:d?this.dummyFn:this.setOperator,setOperatorOption:d?this.dummyFn:this.setOperatorOption,setValue:d?this.dummyFn:this.setValue,setValueSrc:d?this.dummyFn:this.setValueSrc,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:l,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,value:this.props.value||null,valueSrc:this.props.valueSrc||null,valueType:this.props.valueType||null,valueError:this.props.valueError||null,fieldError:this.props.fieldError||null,operatorOptions:this.props.operatorOptions,config:this.props.config,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,asyncListValues:this.props.asyncListValues,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt})])}}])}(F.Component),t.propTypes={id:j().string.isRequired,groupId:j().string,config:j().object.isRequired,path:j().any.isRequired,operator:j().string,field:j().any,fieldSrc:j().string,fieldType:j().string,actions:j().object.isRequired,onDragStart:j().func,value:j().any,valueSrc:j().any,asyncListValues:j().array,valueError:j().any,fieldError:j().string,operatorOptions:j().object,reordableNodesCnt:j().number,parentField:j().string,isLocked:j().bool,isTrueLocked:j().bool,dragging:j().object,isDraggingTempo:j().bool},t};const dy=function(n){var e=no(function(t){return{dragging:t.dragging}},null,null,{context:Fa})(cy(n));return e.displayName="ConnectedRuleContainer",e};function fy(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,pd()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function pd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pd=function(){return!!n})()}var vd=Je.clone,py=Je.TreeUtils.getFlatTree,_i=!1,vy=function(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return t=function(a){function o(u){var i;return(0,vr.A)(this,o),i=fy(this,o,[u]),i._getEventTarget=function(l,s){return l&&l.__mocked_window||document.body||window},i.onDragStart=function(l,s,c){var d=s.closest(".query-builder");i._isUsingLegacyReactDomRender===void 0&&(i._isUsingLegacyReactDomRender=nd(d)),document.body.classList.add("qb-dragging"),d.classList.add("qb-dragging");var f=d.closest(".query-builder-container")||d;f=i._getScrollParent(f)||document.body;var p=f.scrollTop,v=i._getDraggableNodeEl(d),g=i._getPlaceholderNodeEl(d),m=d.querySelectorAll(".group--children"),O=m.length?m[0]:null,y;O&&(y=window.getComputedStyle(O,null).getPropertyValue("padding-left"),y=parseInt(y));var b={id:l,x:s.offsetLeft,y:s.offsetTop,w:s.offsetWidth,h:s.offsetHeight,itemInfo:i.tree.items[l],paddingLeft:y},A={id:l,x:s.offsetLeft,y:s.offsetTop,scrollTop:p,clientX:c.clientX,clientY:c.clientY,itemInfo:vd(i.tree.items[l]),treeEl:d,treeElContainer:f},L={clientX:c.clientX,clientY:c.clientY},S=i._getEventTarget(c,A);i.eventTarget=S,S.addEventListener("mousemove",i.onDrag),S.addEventListener("mouseup",i.onDragEnd),i.props.setDragStart(A,b,L)},i.onDrag=function(l){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,c=Object.assign({},i.props.dragging),d=i.props.dragStart,f=c.paddingLeft,p=d.treeElContainer,v=p.scrollTop;if(c.itemInfo=i.tree.items[c.id],!!c.itemInfo){var g={clientX:l.clientX,clientY:l.clientY},m={clientX:d.clientX,clientY:d.clientY};if(l.__mock_dom){var O=d.treeEl,y=i._getDraggableNodeEl(O),b=i._getPlaceholderNodeEl(O);l.__mock_dom({treeEl:O,dragEl:y,plhEl:b})}if(!d.plX){var A=d.treeEl,L=i._getPlaceholderNodeEl(A);L&&(d.plX=L.getBoundingClientRect().left+window.scrollX,d.plY=L.getBoundingClientRect().top+window.scrollY)}var S=d.x,R=d.y,N=d.clientX,M=d.clientY,x=d.scrollTop,W={x:S+(l.clientX-N),y:R+(l.clientY-M)+(v-x)};c.x=W.x,c.y=W.y,c.paddingLeft=f,c.mousePos=g,c.startMousePos=m,i.props.setDragProgress(g,c);var B=s?i.handleDrag(c,l,r):!1;B||l.preventDefault&&l.preventDefault()}},i.onDragEnd=function(){var l=i.props.dragStart.treeEl;i.props.setDragEnd(),l.classList.remove("qb-dragging"),document.body.classList.remove("qb-dragging"),i._cacheEls={};var s=i.eventTarget||i._getEventTarget();s.removeEventListener("mousemove",i.onDrag),s.removeEventListener("mouseup",i.onDragEnd)},i.pureShouldComponentUpdate=Zn(i),et(i),i.onPropsChanged(u),i}return(0,mr.A)(o,a),(0,gr.A)(o,[{key:"onPropsChanged",value:function(i){this.tree=py(i.tree)}},{key:"shouldComponentUpdate",value:function(i,l){var s=this.props,c=this.state,d=this.pureShouldComponentUpdate(i,l);if(d&&c==l&&s!=i){var f=[];for(var p in i){var v=i[p]!=s[p];v&&p!="dragging"&&p!="mousePos"&&f.push(p)}f.length||(d=!1)}return d}},{key:"componentDidUpdate",value:function(i,l){var s=this.props.dragging,c=this.props.dragStart;if(_i=!1,c&&c.id&&(s.itemInfo=this.tree.items[s.id],s.itemInfo&&(s.itemInfo.index!=c.itemInfo.index||s.itemInfo.parent!=c.itemInfo.parent))){var d=c.treeEl,f=c.treeElContainer,p=this._getPlaceholderNodeEl(d,!0);if(p){var v=p.getBoundingClientRect().left+window.scrollX,g=p.getBoundingClientRect().top+window.scrollY,m=c.plX,O=c.plY,y=f.scrollTop;c.plX=v,c.plY=g,c.itemInfo=vd(s.itemInfo),c.y=p.offsetTop,c.x=p.offsetLeft,c.clientY+=g-O,c.clientX+=v-m,f!=document.body&&(c.scrollTop=y),this.onDrag(this.props.mousePos,!1)}}}},{key:"_getNodeElById",value:function(i,l){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(l==null)return null;this._cacheEls||(this._cacheEls={});var c=this._cacheEls[l];return c&&document.contains(c)&&!s||(c=i.querySelector('.group-or-rule-container[data-id="'+l+'"]'),this._cacheEls[l]=c),c}},{key:"_getDraggableNodeEl",value:function(i){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this._cacheEls||(this._cacheEls={});var s=this._cacheEls.draggable;if(s&&document.contains(s)&&!l)return s;var c=i.getElementsByClassName("qb-draggable");return s=c.length?c[0]:null,this._cacheEls.draggable=s,s}},{key:"_getPlaceholderNodeEl",value:function(i){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this._cacheEls||(this._cacheEls={});var s=this._cacheEls.placeholder;if(s&&document.contains(s)&&!l)return s;var c=i.getElementsByClassName("qb-placeholder");return s=c.length?c[0]:null,this._cacheEls.placeholder=s,s}},{key:"_isScrollable",value:function(i){var l=window.getComputedStyle(i)["overflow-y"];return(l==="scroll"||l==="auto")&&i.scrollHeight>i.offsetHeight}},{key:"_getScrollParent",value:function(i){return i==null?null:i===document.body||this._isScrollable(i)?i:this._getScrollParent(i.parentNode)}},{key:"handleDrag",value:function(i,l,s){var c=this,d=!0,f=i.itemInfo,p=i.paddingLeft,v=null,g=this.props.dragStart.treeEl,m=i.id,O=this._getDraggableNodeEl(g),y=this._getPlaceholderNodeEl(g),b,A,L,S;if(O&&y){if(b=O.getBoundingClientRect(),A=y.getBoundingClientRect(),!A.width)return;var R={hrz:0,vrt:0};b.top<A.top?R.vrt=-1:b.bottom>A.bottom&&(R.vrt=1),b.left>A.left?R.hrz=1:b.left<A.left&&(R.hrz=-1),S=g.getBoundingClientRect();var N={x:S.left+(S.right-S.left)/2,y:R.vrt>=0?b.bottom:b.top},M;if(l.__mocked_hov_container)M=l.__mocked_hov_container;else{var x=document.elementFromPoint(N.x,N.y-1);if(M=x?x.closest(".group-or-rule-container"):null,!M&&x&&x.classList.contains("query-builder-container")){var W,B=x==null||(W=x.firstChild)===null||W===void 0?void 0:W.firstChild;B&&B.classList.contains("group-or-rule-container")&&(M=B)}}if(!M)Zh.log("out of tree bounds!");else{var k=M.classList.contains("group-container"),Q=M.getAttribute("data-id"),K=M,J=!1,G=!1;if(K){L=K.getBoundingClientRect();var re=L.bottom-L.top,ue=this.tree.items[Q];if(!ue)throw new Error("There is an issue with rendering. If you use Next.js, please check getServerSideProps() method.");var de=null,fe=null,ae=null,ne=null;if(R.vrt==0)ae=f,fe=y,fe&&(de=fe.getBoundingClientRect());else if(k){if(R.vrt>0){var ve=M.getElementsByClassName("group--header"),ce=ve.length?ve[0]:null;if(ce){var se=ce.getBoundingClientRect(),Te=se.bottom-se.top,Oe=b.bottom-se.top>Te*3/4;Oe&&ue.top>i.itemInfo.top&&(ae=ue,de=se,fe=ce,G=!0)}}else if(R.vrt<0&&ue.lev>=f.lev){var Re=L.bottom-b.top>=2;Re&&ue.top<i.itemInfo.top&&(ae=ue,de=L,fe=K,J=!0)}if(!G&&!J||d){var Ve=R.vrt<0?L.bottom-b.top>re-5:b.bottom-L.top>re-5;Ve&&(!G&&!J&&(ae=ue,de=L,fe=K),d&&(ne=ue))}}else{var Ue=R.vrt<0?L.bottom-b.top>re/2:b.bottom-L.top>re/2;Ue&&(ae=ue,de=L,fe=K)}var Ye=ae&&ae.id==m;if(de){var qe=b.left-S.left,Be=de.left-S.left,ar=Be/p,nr=Math.max(0,Math.round(qe/p)),Lr=[],rr=[];if(!Ye){if(k&&(J?Lr.push([xn,ae,ae.lev+1]):G&&Lr.push([Yn,ae,ae.lev+1]),d&&ne)){var dt=ne.lev==0,_t=ne.type=="case_group"&&f.type!="case_group",St=ne.prev&&this.tree.items[ne.prev].caseId,Ft=ne.next&&this.tree.items[ne.next].caseId;f.caseId==St&&(St=null),f.caseId==Ft&&(Ft=null);var ht=St&&this.tree.items[St],Gt=Ft&&this.tree.items[Ft];R.vrt>0?dt?rr.push([xn,ne,ne.lev+1]):_t&&Gt?rr.push([Yn,Gt,Gt.lev+1]):rr.push([ao,ne,ne.lev]):R.vrt<0&&(dt?rr.push([Yn,ne,ne.lev+1]):_t&&ht?rr.push([xn,ht,ht.lev+1]):rr.push([oo,ne,ne.lev]))}!J&&!G&&(R.vrt<0?Lr.push([oo,ae,ae.lev]):R.vrt>0&&Lr.push([ao,ae,ae.lev]))}var $t=function(rt){var qr=rt[1],qt=f.caseId?c.tree.items[f.caseId]:null,Ct=qr.caseId?c.tree.items[qr.caseId]:null;return[].concat((0,Fe.A)(rt),[qt,Ct])};Lr=Lr.map($t),rr=rr.map($t),Lr=Lr.filter(function(er){var rt=er[0],qr=er[1];if((rt==oo||rt==ao)&&qr.parent==null||qr.collapsed&&(rt==xn||rt==Yn))return!1;var qt=qr.id==f.id;if(!qt){for(var Ct=qr;Ct.parent;)if(Ct=c.tree.items[Ct.parent],Ct.id==f.id){qt=!0;break}}return!qt}).map(function(er){var rt=er[0],qr=er[1],qt=er[2],Ct=er[3],Nn=er[4],Rt=null;return rt==xn||rt==Yn?Rt=qr:Rt=c.tree.items[qr.parent],Rt&&Rt.parent==null&&(Rt=null),er[5]=Rt,er});var ot=null,Jr=Lr.filter(function(er){return c.canMove(f,er[1],er[0],er[3],er[4],er[5],s)});d&&Jr.length==0&&rr.length>0&&(Jr=rr.filter(function(er){return c.canMove(f,er[1],er[0],er[3],er[4],er[5],s)}));var cn=Jr.map(function(er){return er[2]}),dn=f.lev,it=cn.concat(dn),Vr=null;it.indexOf(nr)!=-1?Vr=nr:nr>Math.max.apply(Math,(0,Fe.A)(it))?Vr=Math.max.apply(Math,(0,Fe.A)(it)):nr<Math.min.apply(Math,(0,Fe.A)(it))&&(Vr=Math.min.apply(Math,(0,Fe.A)(it))),ot=Jr.find(function(er){return er[2]==Vr}),!Ye&&!ot&&Jr.length&&(ot=Jr[0]),v=ot}}}}return v?(this.move(f,v[1],v[0],v[3]),!0):!1}},{key:"canMove",value:function(i,l,s,c,d,f,p){if(!i||!l||i.id===l.id)return!1;var v=this.props.config.settings,g=v.canRegroup,m=v.canRegroupCases,O=v.maxNesting,y=v.maxNumberOfRules,b=v.canLeaveEmptyCase,A=f?f.lev+1:l.lev,L=A+(i.depth||0),S=s==oo||s==ao,R=s==Yn||s==xn,N=S&&l.lev==1||R&&l.lev==0,M=i.parent!=l.parent,x=R||M,W=i.type=="case_group"&&!N||i.parentType=="rule_group"||l.type=="rule_group"||l.parentType=="rule_group"||i.type!="case_group"&&l.type=="case_group"&&S||i.type!="case_group"&&l.type=="switch_group"||!m&&i.caseId!=l.caseId,B=l.isLocked||i.isLocked||f&&f.isLocked;if(O&&L>O||x&&(!g||W||B))return!1;if(i.type!="case_group"&&i.caseId!=l.caseId){var k=c?c._height==2:!1,Q=d?d.atomicRulesCountInCase+1:0;if(y&&Q>y||k&&!b)return!1}if(i.type=="case_group"&&(i.isDefaultCase||l.isDefaultCase||l.type=="switch_group"&&s==xn))return!1;var K=!0;return p&&(K=p(i.node.toJS(),l.node.toJS(),s,f?f.node.toJS():null)),K}},{key:"move",value:function(i,l,s,c){this._isUsingLegacyReactDomRender||(_i=!0),this.props.actions.moveItem(i.path,l.path,s)}},{key:"render",value:function(){return F.createElement(e,(0,fr.A)({},this.props,{onDragStart:this.onDragStart}))}}])}(F.Component),t.propTypes={tree:j().any.isRequired,actions:j().object.isRequired},t};const gy=function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=no(function(r){return{dragging:r.dragging,dragStart:r.dragStart,mousePos:r.mousePos}},{setDragStart:Gh,setDragProgress:_h,setDragEnd:$h},null,{context:Fa})(vy(n,e));return t.displayName="ConnectedSortableContainer",t};var my=["isDraggingTempo","isDraggingMe","dragging"];function hy(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,gd()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function gd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(gd=function(){return!!n})()}const ea=function(n){return function(e){var t;return t=function(r){function a(o){var u;return(0,vr.A)(this,a),u=hy(this,a,[o]),u.handleDraggerMouseDown=function(i){var l=u.props.id,s=u.wrapper.current;u.props.onDragStart&&u.props.onDragStart(l,s,i)},u.wrapper=F.createRef(),u}return(0,mr.A)(a,r),(0,gr.A)(a,[{key:"render",value:function(){var u=this.props,i=u.isDraggingTempo,l=u.isDraggingMe,s=u.dragging,c=(0,Qn.A)(u,my),d=c.isTrueLocked,f={};l&&i&&(_i||(f={top:s.y,left:s.x,width:s.w}));var p=jt()(n,"group-or-rule",l&&i?"qb-draggable":null,l&&!i?"qb-placeholder":null,d?"locked":null);return F.createElement("div",{className:p,style:f,ref:this.wrapper,"data-id":this.props.id},F.createElement(e,(0,fr.A)({handleDraggerMouseDown:this.handleDraggerMouseDown,isDraggingMe:l,isDraggingTempo:i},c)))}}])}(F.PureComponent),t.propTypes={isDraggingTempo:j().bool,isDraggingMe:j().bool,onDragStart:j().func,dragging:j().object,isLocked:j().bool,isTrueLocked:j().bool},t}};var yy=h(95950),ra=h.n(yy),Oy=h(71086),by=h.n(Oy);function md(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Sy(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?md(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):md(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Fy(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,hd()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function hd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(hd=function(){return!!n})()}var yd=Je.ConfigUtils,Cy=yd.getFieldConfig,Ty=yd.getOperatorConfig,Od=function(n){function e(t){var r;return(0,vr.A)(this,e),r=Fy(this,e,[t]),et(r),r.onPropsChanged(t),r}return(0,mr.A)(e,n),(0,gr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,o=["config","selectedField","selectedFieldSrc","selectedFieldType","selectedOperator"],u=!this.meta||o.map(function(i){return r[i]!==a[i]}).filter(function(i){return i}).length>0;u&&(this.meta=this.getMeta(r))}},{key:"getMeta",value:function(r){var a,o=r.config,u=r.selectedField,i=r.selectedFieldType,l=r.selectedOperator,s=Cy(o,u),c=(0,Fe.A)(s?.operators||((a=o.types[i])===null||a===void 0?void 0:a.operators)||[]);!u&&!c.includes(l)&&c.push(l);var d=ro()(by()(o.operators,function(b,A){return c?.indexOf(A)!==-1}),function(b,A){return Ty(o,A,u)}),f=this.buildOptions(o,d,c),p=d[l]||{},v=this.props.config.settings.operatorPlaceholder,g=l,m=g?[g]:null,O=m,y=p.label;return{placeholder:v,items:f,selectedKey:g,selectedKeys:m,selectedPath:O,selectedLabel:y,selectedOpts:p,fieldConfig:s}}},{key:"buildOptions",value:function(r,a,o){return!a||!o?null:ra()(a).sort(function(u,i){return o.indexOf(u)-o.indexOf(i)}).map(function(u){var i=a[u],l=i.label;return{key:u,path:u,label:l}})}},{key:"render",value:function(){var r=this.props,a=r.config,o=r.customProps,u=r.setOperator,i=r.readonly,l=r.id,s=r.groupId,c=a.settings.renderOperator,d=Sy({id:l,groupId:s,config:a,customProps:o,readonly:i,setField:u},this.meta);return d.items?c(d,a.ctx):null}}])}(F.Component);Od.propTypes={id:j().string,groupId:j().string,config:j().object.isRequired,selectedField:j().any,selectedFieldType:j().string,selectedFieldSrc:j().string,selectedOperator:j().string,readonly:j().bool,setOperator:j().func.isRequired};var Ey=["children"],Gr=function(e){var t=e.children,r=(0,Qn.A)(e,Ey);return F.createElement("div",r,t)},mt=function(){},bd=function(){return F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"gray",width:"18px",height:"18px"},F.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),F.createElement("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}))},ta=function(e){return function(t){var r=t.config.settings.useConfirm,a=r?r.call(t.config.ctx,t.config.ctx):null;return F.createElement(e,(0,fr.A)({},t,{confirmFn:a}))}};function Ay(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,Sd()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function Sd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Sd=function(){return!!n})()}var Fd=function(n){function e(){return(0,vr.A)(this,e),Ay(this,e,arguments)}return(0,mr.A)(e,n),(0,gr.A)(e,[{key:"render",value:function(){var r=this.props,a=r.config,o=r.selectedField,u=r.selectedFieldSrc,i=r.selectedFieldType,l=r.selectedOperator,s=r.setOperator,c=r.selectedFieldParts,d=r.showOperator,f=r.showOperatorLabel,p=r.selectedFieldWidgetConfig,v=r.readonly,g=r.id,m=r.groupId,O=d&&F.createElement(Gr,{key:"operators-for-"+(c||[]).join("_"),className:"rule--operator"},a.settings.showLabels&&F.createElement("label",{className:"rule--label"},a.settings.operatorLabel),F.createElement(Od,{key:"operator",config:a,selectedField:o,selectedFieldSrc:u,selectedFieldType:i,selectedOperator:l,setOperator:s,readonly:v,id:g,groupId:m})),y=f&&F.createElement(Gr,{key:"operators-for-"+(c||[]).join("_"),className:"rule--operator"},F.createElement("div",{className:"rule--operator-wrapper"},a.settings.showLabels?F.createElement("label",{className:"rule--label"},"\xA0"):null,F.createElement("div",{className:"rule--operator-text-wrapper"},F.createElement("span",{className:"rule--operator-text"},p.operatorInlineLabel))));return[O,y]}}])}(F.PureComponent);function Cd(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Ly(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Cd(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Cd(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function wy(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,Td()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function Td(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Td=function(){return!!n})()}var Ed=Je.RuleUtils.getFieldPathLabels,Gi=Je.ConfigUtils,Ad=Gi.getFieldConfig,Ld=Gi.getFieldParts,wd=Gi.getFieldPathParts,jd=function(n){function e(t){var r;return(0,vr.A)(this,e),r=wy(this,e,[t]),r.setField=function(a,o){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=r.props.id;if(!u.widgetId){var l=[i,"L",-1].join(":");u.widgetId=l}r.props.setField(a,o,u)},et(r),r.onPropsChanged(t),r}return(0,mr.A)(e,n),(0,gr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,o=["selectedField","selectedFieldSrc","selectedFieldType","config","parentField"],u=!this.meta||o.map(function(i){return r[i]!==a[i]}).filter(function(i){return i}).length>0;u&&(this.meta=this.getMeta(r))}},{key:"getMeta",value:function(r){var a=r.selectedField,o=r.selectedFieldType,u=r.config,i=r.parentField,l=a,s=u.settings,c=s.maxLabelsLength,d=s.fieldSeparatorDisplay,f=s.fieldPlaceholder,p=s.fieldSeparator,v=!!a,g=v?null:io(f,c),m=v?Ad(u,l):null,O=m||{},y=wd(l,u),b=wd(l,u,!0),A=this.getFieldLabel(m,l,u),L=Ed(l,u),S=L?L.join(d):null;(S==A||i)&&(S=null);var R=O.label2,N=Ld(i,u),M=i?Ad(u,i):null,x=i?M&&M.subfields:u.fields,W=!v&&o,B=this.buildOptions(N,u,x,W,N),k=W?"Please select field":null;return l&&(0,Fr.A)(l)==="object"&&(l=void 0),{placeholder:g,items:B,parentField:i,selectedKey:l,selectedKeys:y,selectedPath:b,selectedLabel:A,selectedOpts:O,selectedAltLabel:R,selectedFullLabel:S,errorText:k}}},{key:"getFieldLabel",value:function(r,a,o){if(!a)return null;var u=o.settings.maxLabelsLength,i=Ld(a,o),l=r?.label||$a()(i);return l=io(l,u),l}},{key:"buildOptions",value:function(r,a,o){var u=this,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:void 0,l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null;if(!o)return null;var c=a.settings,d=c.fieldSeparator,f=c.fieldSeparatorDisplay,p=l!=null&&l.length?l.join(d)+d:"",v=function g(m){return Object.keys(m||{}).reduce(function(O,y){var b=m[y];return b.type==="!struct"?O+g(b.subfields):O+(b.type===i?1:0)},0)};return ra()(o).map(function(g){var m=[].concat((0,Fe.A)(l??[]),[g]),O=o[g],y=u.getFieldLabel(O,m,a),b=Ed(m,a),A=b.join(f);(A==y||r!=null&&r.length)&&(A=null);var L=O.label2,S=O.tooltip,R=O.disabled;if(!O.hideForSelect)if(O.type=="!struct"){var N=u.buildOptions(r,a,O.subfields,i,m,{label:y,tooltip:S}),M=v(O.subfields)>0;return{disabled:R,key:g,path:p+g,label:y,fullLabel:A,altLabel:L,tooltip:S,items:N,matchesType:M}}else{var x=i!==void 0?O.type===i:void 0;return{disabled:R,key:g,path:p+g,label:y,fullLabel:A,altLabel:L,tooltip:S,grouplabel:s?.label,group:s,matchesType:x}}}).filter(function(g){return!!g})}},{key:"render",value:function(){var r=this.props,a=r.config,o=r.customProps,u=r.setFieldSrc,i=r.readonly,l=r.id,s=r.groupId,c=a.settings.renderField,d=Ly({id:l,groupId:s,config:a,customProps:o,readonly:i,setField:this.setField,setFieldSrc:u},this.meta);return c(d,a.ctx)}}])}(F.Component);jd.propTypes={id:j().string,groupId:j().string,config:j().object.isRequired,selectedField:j().any,selectedFieldSrc:j().string,selectedFieldType:j().string,parentField:j().string,customProps:j().object,readonly:j().bool,setField:j().func.isRequired,setFieldSrc:j().func};function Rd(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function jy(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Rd(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Rd(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Ry(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,Pd()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function Pd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Pd=function(){return!!n})()}var Py=Je.clone,uo=Je.ConfigUtils,xy=uo.getFieldConfig,xd=uo.getFuncConfig,Iy=uo.getFieldParts,Id=uo.getFieldPathParts,Vd=Je.RuleUtils,Dd=Vd.getFuncPathLabels,Vy=Vd.getWidgetForFieldOp,Dy=Je.OtherUtils.shallowEqual,Nd=function(n){function e(t){var r;return(0,vr.A)(this,e),r=Ry(this,e,[t]),et(r),r.onPropsChanged(t),r}return(0,mr.A)(e,n),(0,gr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,o=["config","field","fieldType","fieldSrc","operator","isFuncArg","isLHS","parentFuncs"],u=["config","field","fieldType","fieldSrc","value","isLHS"],i=!this.items||o.map(function(s){return s==="parentFuncs"?!Dy(r[s],a[s],!0):r[s]!==a[s]}).filter(function(s){return s}).length>0,l=!this.meta||u.map(function(s){return r[s]!==a[s]}).filter(function(s){return s}).length>0;l&&(this.meta=this.getMeta(r)),i&&(this.items=this.getItems(r,this.meta))}},{key:"getItems",value:function(r,a){var o=r.config,u=r.field,i=r.fieldType,l=r.isLHS,s=r.operator,c=r.parentFuncs,d=r.fieldDefinition,f=r.isFuncArg,p=a.lookingForFieldType,v=o.settings.canUseFuncForField,g=this.filterFuncs(o,o.funcs,u,i,l,s,v,c,f,d),m=this.buildOptions(o,g,p);return m}},{key:"getMeta",value:function(r){var a=r.config,o=r._field,u=r.fieldType,i=r.value,l=r.isLHS,s=r.isFuncArg,c=a.settings,d=c.funcPlaceholder,f=c.fieldSeparatorDisplay,p=i,v=!!i,g=v?null:d,m=v?xd(a,p):null,O=m||{},y=Id(p,a),b=Id(p,a,!0),A=this.getFuncLabel(m,p,a),L=Dd(p,a),S=L?L.join(f):null;S==A&&(S=null);var R=l&&!s,N=R&&!v&&u,M=N?"Please select function":null;return{placeholder:g,selectedKey:p,selectedKeys:y,selectedPath:b,selectedLabel:A,selectedOpts:O,selectedFullLabel:S,errorText:M,lookingForFieldType:N}}},{key:"filterFuncs",value:function(r,a,o,u,i,l,s,c,d,f){a=Py(a);var p=r.settings.fieldSeparator,v=xy(r,o),g=!1,m,O=v,y=Vy(r,o,l,"value"),b=y&&r.widgets[y];d?(O=f,m=f?.type):g&&b?m=b.type:v?m=v.type:i||(m=u);function A(L,S){for(var R in L){var N=L[R].subfields,M=(S||[]).concat(R),x=M.join(p),W=xd(r,x);if(W.type=="!struct")A(N,M)==0&&delete L[R];else{var B,k=!m||W.returnType==m;(B=O)!==null&&B!==void 0&&B.funcs&&(k=k&&O.funcs.includes(x)),s&&(k=k&&s(o,v,x,W,l)),!W.allowSelfNesting&&c&&c.map(function(Q){var K=(0,Le.A)(Q,2),J=K[0],G=K[1];return J}).includes(x)&&(k=!1),k||delete L[R]}}return ra()(L).length}return A(a,[]),a}},{key:"buildOptions",value:function(r,a){var o=this,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(!a)return null;var s=r.settings,c=s.fieldSeparator,d=s.fieldSeparatorDisplay,f=i!=null&&i.length?i.join(c)+c:"",p=function v(g){return Object.keys(g||{}).reduce(function(m,O){var y=g[O];return y.type==="!struct"?m+v(y.subfields):m+(y.type===u?1:0)},0)};return ra()(a).map(function(v){var g=[].concat((0,Fe.A)(i??[]),[v]),m=a[v],O=o.getFuncLabel(m,g,r),y=Dd(g,r),b=y.join(d);b==O&&(b=null);var A=m.tooltip;if(m.type=="!struct"){var L=o.buildOptions(r,m.subfields,u,g,{label:O,tooltip:A}),S=p(m.subfields)>0;return{key:v,path:f+v,label:O,fullLabel:b,tooltip:A,items:L,matchesType:S}}else{var R=u!==void 0?m.returnType===u:void 0;return{key:v,path:f+v,label:O,fullLabel:b,tooltip:A,grouplabel:l?.label,group:l,matchesType:R}}})}},{key:"getFuncLabel",value:function(r,a,o){if(!a)return null;var u=o.settings.maxLabelsLength,i=Iy(a,o),l=r?.label||$a()(i);return l=io(l,u),l}},{key:"render",value:function(){var r=this.props,a=r.config,o=r.customProps,u=r.setValue,i=r.readonly,l=r.id,s=r.groupId,c=a.settings.renderFunc,d=jy({config:a,customProps:o,readonly:i,setField:u,items:this.items,id:l,groupId:s},this.meta);return c(d,a.ctx)}}])}(F.Component);Nd.propTypes={id:j().string,groupId:j().string,config:j().object.isRequired,field:j().any,fieldType:j().string,fieldSrc:j().string,operator:j().string,customProps:j().object,value:j().string,setValue:j().func.isRequired,readonly:j().bool,parentFuncs:j().array,fieldDefinition:j().object,isFuncArg:j().bool,isLHS:j().bool};var Ny=h(23181),$i=h.n(Ny),ky=["factory"];function kd(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Ui(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?kd(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):kd(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Md=Je.ListUtils.getTitleInListValues,My=Je.ConfigUtils._widgetDefKeysToOmit,_y=Je.TreeUtils._fixImmutableValue;const Gy=function(n){var e=n.delta,t=n.isFuncArg,r=n.valueSrc,a=n.value,o=n.valueError,u=n.fieldError,i=n.asyncListValues,l=n.isSpecialRange,s=n.fieldDefinition,c=n.widget,d=n.widgetDefinition,f=n.widgetValueLabel,p=n.valueLabels,v=n.textSeparators,g=n.setValueHandler,m=n.setFuncValue,O=n.config,y=n.field,b=n.fieldSrc,A=n.fieldType,L=n.isLHS,S=n.operator,R=n.readonly,N=n.parentField,M=n.parentFuncs,x=n.id,W=n.groupId,B=n.widgetId,k=d.factory,Q=(0,Qn.A)(d,ky),K=t&&s.valueSources&&s.valueSources.length==1&&s.valueSources[0]=="const",J=s.defaultValue;if(!k)return"?";var G=a?a.map(function(ce){return _y(ce)}):void 0,re=l?[G?.get(0),G?.get(1)]:G?G.get(e):void 0,ue=o?.get&&(l?[o.get(0),o.get(1),o.get(2)]:o.get(e))||null,de=L?u:ue;l&&re[0]===void 0&&re[1]===void 0&&(re=void 0);var fe=s||{},ae=fe.fieldSettings,ne=Cr()(Ui(Ui(Ui({},Q),ae),{},{config:O,field:y,fieldSrc:b,fieldType:A,isLHS:L,parentField:N,parentFuncs:M,fieldDefinition:s,operator:S,delta:e,isSpecialRange:l,isFuncArg:t,value:re,valueError:ue,fieldError:u,errorMessage:de,label:f.label,placeholder:f.placeholder,placeholders:p?p.placeholder:null,textSeparators:v,setValue:g,setFuncValue:m,readonly:R,asyncListValues:i,id:x,groupId:W,widgetId:B}),[].concat((0,Fe.A)(My),["toJS"]));if(c=="field",K&&J){var ve=ae?.treeValues||ae?.listValues;return typeof J=="boolean"?J?ne.labelYes||"YES":ne.labelNo||"NO":ve?Array.isArray(J)?J.map(function(ce){return Md(ve,ce)||ce}).join(", "):Md(ve,J)||J:""+J}return k(ne,O.ctx)};function $y(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,_d()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function _d(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_d=function(){return!!n})()}var Bi=Je.ConfigUtils,Uy=Bi.getFieldConfig,By=Bi.getOperatorConfig,Gd=Bi.getFieldWidgetConfig,Wi=Je.RuleUtils,Wy=Wi.getValueSourcesForFieldOp,$d=Wi.getWidgetForFieldOp,lo=Wi.getValueLabel,Ud=Je.DefaultUtils.createListFromArray,Ky=Je.OtherUtils.shallowEqual,Hy={cardinality:1},Ca=function(n){function e(t){var r;return(0,vr.A)(this,e),r=$y(this,e,[t]),r._setValue=function(a,o,u,i,l,s){var c=arguments.length>6&&arguments[6]!==void 0?arguments[6]:{};if(c.widgetId||(c.widgetId=i),a&&Array.isArray(l)){var d=[r.props.value.get(0),r.props.value.get(1)];d[0]!=l[0]&&r.props.setValue(0,l[0],u,s,c),d[1]!=l[1]&&r.props.setValue(1,l[1],u,s,c)}else r.props.setValue(o,l,u,s,c)},r._setValueSrc=function(a,o,u){var i={widgetId:o};r.props.setValueSrc(a,u,i)},r.renderWidget=function(a,o,u){var i=u.config,l=u.isFuncArg,s=u.leftField,c=u.operator,d=u.value,f=u.valueError,p=u.fieldError,v=u.readonly,g=u.parentField,m=u.parentFuncs,O=u.id,y=u.groupId,b=u.fieldSrc,A=u.fieldType,L=u.isLHS,S=u.setFuncValue,R=i.settings,N=o.widgets,M=o.iValues,x=o.aField,W=o.valueSources,B=l?M:d,k=l?s:x,Q=N[a],K=Q.valueSrc,J=Q.valueLabel,G=Q.widgetId,re=W.length>1&&!v,ue=R.showLabels?F.createElement("label",{className:"rule--label"},J.label):null;return F.createElement("div",{key:"widget-"+k+"-"+a,className:jt()(K=="func"?"widget--func":"widget--widget",re?"widget--has-valuerscs":"widget--has-no-valuerscs")},K=="func"?null:ue,F.createElement(Gy,(0,fr.A)({id:O,groupId:y,widgetId:G,valueSrc:K,delta:a,value:B,valueError:f,fieldError:p,isFuncArg:l,isLHS:L},Bt()(o,["isSpecialRange","fieldDefinition","asyncListValues"]),Bt()(N[a],["widget","widgetDefinition","widgetValueLabel","valueLabels","textSeparators","setValueHandler"]),{setFuncValue:S,config:i,field:k,fieldSrc:b,fieldType:A,parentField:g,parentFuncs:m,operator:c,readonly:v})))},r.renderValueSources=function(a,o,u){var i=u.config,l=u.isFuncArg,s=u.leftField,c=u.operator,d=u.readonly,f=i.settings,p=o.valueSources,v=o.widgets,g=o.aField,m=l?s:g,O=v[a],y=O.valueSrc,b=O.setValueSrcHandler,A=f.valueSourcesInfo,L=f.renderValueSources,S=p.map(function(M){return[M,{label:A[M].label}]}),R=function(x){return L(x,i.ctx)},N=f.showLabels?F.createElement("label",{className:"rule--label"},"\xA0"):null;return p.length>1&&!d&&F.createElement("div",{key:"valuesrc-"+m+"-"+a,className:"widget--valuesrc"},N,F.createElement(R,{key:"valuesrc-"+a,delta:a,valueSources:S,valueSrc:y,config:i,field:m,operator:c,setValueSrc:b,readonly:d,title:f.valueSourcesPopupTitle}))},r.renderSep=function(a,o,u){var i=u.config,l=o.widgets,s=i.settings,c=l[a].sepText,d=s.showLabels?F.createElement("label",{className:"rule--label"},"\xA0"):null;return c&&F.createElement("div",{key:"widget-separators-"+a,className:jt()("widget--sep",a==0&&"widget--sep-first")},d,F.createElement("span",null,c))},r.renderWidgetDelta=function(a){var o=r.renderSep(a,r.meta,r.props),u=r.renderValueSources(a,r.meta,r.props),i=r.renderWidget(a,r.meta,r.props);return[o,u,i]},et(r),r.onPropsChanged(t),r}return(0,mr.A)(e,n),(0,gr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,o=["config","id","parentFuncs","field","fieldSrc","fieldType","fieldFunc","fieldArg","leftField","operator","valueSrc","asyncListValues","isLHS","isFuncArg","isForRuleGroup","isCaseValue"],u=!this.meta||o.map(function(i){return i==="parentFuncs"?!Ky(r[i],a[i],!0):i==="isFuncArg"?r[i]!==a[i]||r.isFuncArg&&r.value!==a.value:r[i]!==a[i]}).filter(function(i){return i}).length>0;u&&(this.meta=this.getMeta(r))}},{key:"getMeta",value:function(r){var a,o,u=this,i=r.config,l=r.field,s=r.fieldSrc,c=r.fieldType,d=r.fieldFunc,f=r.fieldArg,p=r.operator,v=r.valueSrc,g=r.value,m=r.isForRuleGroup,O=r.isCaseValue,y=r.isFuncArg,b=r.leftField,A=r.asyncListValues,L=r.parentFuncs,S=r.isLHS,R=r.id,N=y?{func:d,arg:f}:l,M=!l&&c,x=v,W=g;(y||m||O)&&(x=Ud([v]),W=Ud([g]));var B=Uy(i,N);!B&&M&&(B=i.types[c]);var k=$d(i,N,p);if(!k&&M){var Q;k=(Q=i.types[c])===null||Q===void 0?void 0:Q.mainWidget}var K=y?Hy:By(i,p,N);if((B==null||K==null)&&!O)return null;var J=K?.isSpecialRange,G=J&&(((a=x)===null||a===void 0?void 0:a.get(0))=="field"||((o=x)===null||o===void 0?void 0:o.get(1))=="field"),re=J&&!G,ue=re?1:Jh(K);if(ue===0)return null;var de=Wy(i,N,p,B);N||(de=Object.keys(i.settings.valueSourcesInfo));var fe=$i()(0,ue).map(function(ae){var ne,ve,ce=((ne=x)===null||ne===void 0?void 0:ne.get(ae))||null,se=$d(i,N,p,ce),Te=Gd(i,N,p,se,ce);G&&(se=Te.singleWidget,Te=Gd(i,N,p,se,ce)),!Te&&M&&(se=["func","field"].includes(ce)?ce:k,Te=i.widgets[se]);var Oe=(ve=Te)===null||ve===void 0?void 0:ve.type,Re=lo(i,N,p,ae,ce,re),Ve=lo(i,N,p,ae,null,re),Ue=K!=null&&K.textSeparators?K?.textSeparators[ae]:null,Ye=null,qe=null;J&&(Ye=[lo(i,N,p,0),lo(i,N,p,1)],Ye={placeholder:[Ye[0].placeholder,Ye[1].placeholder],label:[Ye[0].label,Ye[1].label]},qe=K?.textSeparators);var Be=[R,S?"L":"R",S?-1:ae||0,(L||[]).map(function(rr){var dt=(0,Le.A)(rr,2),_t=dt[0],St=dt[1];return"".concat(_t,"(").concat(St,")")}).join("/")].join(":"),ar=Be+":VS",nr=u._setValueSrc.bind(u,ae,ar),Lr=u._setValue.bind(u,J,ae,Oe,Be);return{valueSrc:ce,valueLabel:Re,widget:se,sepText:Ue,widgetDefinition:Te,widgetValueLabel:Ve,valueLabels:Ye,textSeparators:qe,setValueSrcHandler:nr,setValueHandler:Lr,widgetId:Be}});return{defaultWidget:k,fieldDefinition:B,operatorDefinition:K,isSpecialRange:re,cardinality:ue,valueSources:de,widgets:fe,iValues:W,aField:N,asyncListValues:A}}},{key:"render",value:function(){if(!this.meta)return null;var r=this.meta,a=r.defaultWidget,o=r.cardinality;if(!a)return null;var u=a;return F.createElement(Gr,{className:"rule--widget rule--widget--".concat(u.toUpperCase()),key:"widget-col-"+u},$i()(0,o).map(this.renderWidgetDelta))}}])}(F.Component);Ca.propTypes={config:j().object.isRequired,value:j().any,valueSrc:j().any,valueError:j().any,fieldError:j().string,field:j().any,fieldSrc:j().string,fieldType:j().string,operator:j().string,readonly:j().bool,asyncListValues:j().array,id:j().string,groupId:j().string,setValue:j().func,setValueSrc:j().func,setFuncValue:j().func,isFuncArg:j().bool,fieldFunc:j().string,fieldArg:j().string,leftField:j().any,isForRuleGroup:j().bool,parentField:j().string,parentFuncs:j().array,isLHS:j().bool,isCaseValue:j().bool};function Bd(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,Wd()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function Wd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Wd=function(){return!!n})()}var zy=Je.ConfigUtils.getFuncConfig,Ki=Je.FuncUtils,Gb=Ki.setFunc,$b=Ki.setArgValue,Ub=Ki.setArgValueSrc,Kd=Je.OtherUtils.shallowEqual,Hi=function(n){function e(t){var r;return(0,vr.A)(this,e),r=Bd(this,e,[t]),r.setFunc=function(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u=r.props,i=u.isLHS,l=u.delta,s=u.parentFuncs,c=u.id;if(!o.widgetId){var d=[c,i?"L":"R",i?-1:l||0,(s||[]).map(function(f){var p=(0,Le.A)(f,2),v=p[0],g=p[1];return"".concat(v,"(").concat(g,")")}).join("/"),"F"].join(":");o.widgetId=d}r.props.setFuncValue(i?-1:l||0,s,null,a,"!func",void 0,o)},r.setArgValue=function(a,o,u,i,l){var s=r.props,c=s.config,d=s.delta,f=s.isLHS,p=s.parentFuncs;r.props.setFuncValue(f?-1:d||0,p,a,o,u,i,l)},r.setArgValueSrc=function(a,o,u){var i=r.props,l=i.config,s=i.delta,c=i.isLHS,d=i.parentFuncs;r.props.setFuncValue(c?-1:s||0,d,a,o,"!valueSrc",void 0,u)},r.renderFuncSelect=function(){var a,o,u=r.props,i=u.config,l=u.field,s=u.fieldType,c=u.fieldSrc,d=u.isLHS,f=u.operator,p=u.customProps,v=u.value,g=u.readonly,m=u.parentFuncs,O=u.id,y=u.groupId,b=u.isFuncArg,A=u.fieldDefinition,L=(a=v==null||(o=v.get)===null||o===void 0?void 0:o.call(v,"func"))!==null&&a!==void 0?a:null,S={value:L,setValue:r.setFunc,config:i,field:l,fieldType:s,fieldSrc:c,isLHS:d,operator:f,customProps:p,readonly:g,parentFuncs:m,isFuncArg:b,fieldDefinition:A,id:O,groupId:y},R=i.settings,N=R.showLabels,M=R.funcLabel,x=N?F.createElement("label",{className:"rule--label"},M):null;return F.createElement(Gr,{key:"func",className:"rule--func"},x,F.createElement(Nd,S))},r.renderArgLabel=function(a,o){var u=o.valueSources,i=o.type,l=o.showPrefix,s=o.label,c=r.props.config,d=u&&u.length==1&&u[0]=="const",f=!c.settings.showLabels&&(i=="boolean"||d)&&l;return f?F.createElement(Gr,{className:"rule--func--arg-label"},s||a):null},r.renderArgLabelSep=function(a,o){var u=o.valueSources,i=o.type,l=o.showPrefix,s=r.props.config,c=u&&u.length==1&&u[0]=="const",d=!s.settings.showLabels&&(i=="boolean"||c)&&l;return d?F.createElement(Gr,{className:"rule--func--arg-label-sep"},":"):null},r.renderArgVal=function(a,o,u){var i=r.props,l=i.config,s=i.field,c=i.fieldType,d=i.fieldSrc,f=i.isLHS,p=i.operator,v=i.value,g=i.readonly,m=i.parentFuncs,O=i.id,y=i.groupId,b=i.fieldError,A=i.valueError,L=i.setFuncValue,S=v?v.getIn(["args",o]):null,R=S?S.get("value"):void 0,N=u.valueSources.length==1?u.valueSources[0]:void 0,M=S?S.get("valueSrc")||N||"value":N,x={config:l,fieldFunc:a,fieldArg:o,leftField:s,fieldType:c,fieldSrc:d,fieldError:b,valueError:A,isLHS:f,operator:null,value:R,valueSrc:M,setValue:r.setArgValue,setValueSrc:r.setArgValueSrc,setFuncValue:L,funcKey:a,argKey:o,argDefinition:u,readonly:g,parentFuncs:m,id:O,groupId:y};return F.createElement(Gr,{className:"rule--func--arg-value"},F.createElement(Hd,x))},r.renderArgSep=function(a,o,u,i){var l=i.renderSeps;return u?F.createElement(Gr,{className:"rule--func--arg-sep"},l?l[u-1]:", "):null},r.renderBracketBefore=function(a){var o=a.renderBrackets;return F.createElement(Gr,{key:"before_args",className:"rule--func--bracket-before"},o?o[0]:"(")},r.renderBracketAfter=function(a){var o=a.renderBrackets;return F.createElement(Gr,{key:"after_args",className:"rule--func--bracket-after"},o?o[1]:")")},r.renderFuncArgs=function(){var a=r.meta,o=a.funcDefinition,u=a.funcKey;if(!u)return null;var i=o||{},l=i.args;return l?F.createElement(F.Fragment,null,r.renderBracketBefore(o),F.createElement(Gr,{key:"args-".concat(u),className:"rule--func--args rule--func--".concat(u,"--args")},Object.keys(l).map(function(s,c){return F.createElement(Gr,{key:"arg-".concat(s,"-").concat(c),className:"rule--func--arg rule--func--".concat(u,"--arg--").concat(s)},r.renderArgSep(s,l[s],c,o),r.renderArgLabel(s,l[s]),r.renderArgLabelSep(s,l[s]),r.renderArgVal(u,s,l[s]))})),r.renderBracketAfter(o)):null},et(r),r.onPropsChanged(t),r}return(0,mr.A)(e,n),(0,gr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,o=["config","field","operator","value","fieldSrc","fieldType","isLHS"],u=!this.meta||o.map(function(i){return i==="parentFuncs"?!Kd(r[i],a[i],!0):r[i]!==a[i]}).filter(function(i){return i}).length>0;u&&(this.meta=this.getMeta(r))}},{key:"getMeta",value:function(r){var a,o,u=r.config,i=r.field,l=r.operator,s=r.value,c=(a=s==null||(o=s.get)===null||o===void 0?void 0:o.call(s,"func"))!==null&&a!==void 0?a:null,d=c?zy(u,c):null;return{funcDefinition:d,funcKey:c}}},{key:"render",value:function(){var r=this.props.parentFuncs,a=r?r.map(function(u){var i=(0,Le.A)(u,2),l=i[0],s=i[1];return"".concat(l,"_").concat(s)}).join("-"):"root",o=r?.length||0;return F.createElement(Gr,{className:"rule--func--wrapper rule--func--wrapper--under-".concat(a," rule--func--wrapper--lev-").concat(o)},this.renderFuncSelect(),this.renderFuncArgs())}}])}(F.Component);Hi.propTypes={id:j().string,groupId:j().string,config:j().object.isRequired,field:j().any,fieldSrc:j().string,fieldType:j().string,fieldError:j().string,operator:j().string,customProps:j().object,value:j().object,setValue:j().func.isRequired,setFuncValue:j().func,readonly:j().bool,parentFuncs:j().array,fieldDefinition:j().object,isFuncArg:j().bool,isLHS:j().bool,valueError:j().string};var Hd=function(n){function e(t){var r;return(0,vr.A)(this,e),r=Bd(this,e,[t]),r.setValue=function(a,o,u,i,l){var s=r.props,c=s.setValue,d=s.argKey;c(d,o,u,i,l)},r.setValueSrc=function(a,o,u){var i=r.props,l=i.setValueSrc,s=i.argKey;l(s,o,u)},et(r),r.onPropsChanged(t),r}return(0,mr.A)(e,n),(0,gr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,o=["parentFuncs","funcKey","argKey"],u=!this.meta||o.map(function(i){return i==="parentFuncs"?!Kd(r[i],a[i],!0):r[i]!==a[i]}).filter(function(i){return i}).length>0;u&&(this.meta=this.getMeta(r))}},{key:"getMeta",value:function(r){var a=r.parentFuncs,o=r.funcKey,u=r.argKey,i=[].concat((0,Fe.A)(a||[]),[[o,u]]);return{parentFuncs:i}}},{key:"render",value:function(){var r=this.meta.parentFuncs;return F.createElement(Ca,(0,fr.A)({},this.props,{setValue:this.setValue,setValueSrc:this.setValueSrc,isFuncArg:!0,parentFuncs:r}))}}])}(F.Component);Hd.propTypes={funcKey:j().string.isRequired,argKey:j().string.isRequired,setValue:j().func.isRequired,setValueSrc:j().func.isRequired,readonly:j().bool,isLHS:j().bool,parentFuncs:j().array,id:j().string,groupId:j().string};function Jy(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,zd()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function zd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zd=function(){return!!n})()}var zi=function(n){function e(){var t;(0,vr.A)(this,e);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return t=Jy(this,e,[].concat(a)),t.renderField=function(){var u=t.props,i=u.config,l=u.classname,s=u.selectedField,c=u.selectedFieldSrc,d=u.selectedFieldType,f=u.setField,p=u.setFuncValue,v=u.parentField,g=u.readonly,m=u.id,O=u.groupId,y=u.fieldError,b=u.valueError,A=["func","field"];if(!A.includes(c))return"?";var L=c==="func"?F.createElement(Hi,{isLHS:!0,config:i,value:s,fieldSrc:c,fieldType:d,fieldError:y,valueError:b,parentField:v,setValue:f,setFuncValue:p,readonly:g,id:m,groupId:O,key:"field-func-"+m}):F.createElement(jd,{config:i,selectedField:s,selectedFieldSrc:c,selectedFieldType:d,parentField:v,setField:f,customProps:i.settings.customFieldSelectProps,readonly:g,id:m,groupId:O,key:"field-"+m}),S=c==="func"?i.settings.funcLabel:i.settings.fieldLabel,R=i.settings.showLabels&&c!=="func"&&F.createElement("label",{className:"rule--label"},S);return F.createElement("div",{key:c,className:l},R,L)},t.renderFieldSources=function(){var u=t.props,i=u.config,l=u.readonly,s=u.selectedFieldSrc,c=u.setFieldSrc,d=u.id,f=i.settings,p=f.fieldSources,v=f.valueSourcesInfo,g=f.renderValueSources,m=p.map(function(b){return[b,{label:v[b].label}]}),O=function(A){return g(A,i.ctx)},y=f.showLabels?F.createElement("label",{className:"rule--label"},"\xA0"):null;return p.length>1&&!l&&F.createElement("div",{key:"fieldsrc",className:"rule--fieldsrc"},y,F.createElement(O,{key:"fieldsrc-"+d,valueSources:m,valueSrc:s,config:i,setValueSrc:c,readonly:l,title:f.fieldSourcesPopupTitle}))},t}return(0,mr.A)(e,n),(0,gr.A)(e,[{key:"render",value:function(){var r=this.props,a=r.classname,o=r.canSelectFieldSource,u=o&&this.renderFieldSources(),i=this.renderField();return o?F.createElement(Gr,{className:"rule--field-wrapper"},u,i):i}}])}(F.PureComponent),qy=["factory"];function Qy(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,Jd()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function Jd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Jd=function(){return!!n})()}var Yy=Je.ConfigUtils.getOperatorConfig,qd=function(n){function e(){return(0,vr.A)(this,e),Qy(this,e,arguments)}return(0,mr.A)(e,n),(0,gr.A)(e,[{key:"render",value:function(){if(!this.props.selectedOperator)return null;var r=Yy(this.props.config,this.props.selectedOperator,this.props.selectedField);if(typeof r.options>"u")return null;var a=r.options,o=a.factory,u=(0,Qn.A)(a,qy),i=Object.assign({},u,{config:this.props.config,field:this.props.selectedField,fieldSrc:this.props.selectedFieldSrc,operator:this.props.selectedOperator,options:this.props.operatorOptions,setOption:this.props.setOperatorOption,readonly:this.props.readonly}),l=o(i,this.props.config.ctx),s=this.props.selectedOperator;return F.createElement("div",{className:"rule--operator rule--operator--".concat(s.toUpperCase())},l)}}])}(F.PureComponent);qd.propTypes={config:j().object.isRequired,operatorOptions:j().any.isRequired,selectedField:j().any,selectedFieldSrc:j().string,selectedOperator:j().string.isRequired,readonly:j().bool,setOperatorOption:j().func.isRequired};function Qd(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Yd(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Qd(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Qd(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Xy(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,Xd()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function Xd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Xd=function(){return!!n})()}var so=Je.ConfigUtils,Zy=so.getFieldConfig,e0=so.getOperatorConfig,r0=so.getFieldWidgetConfig,t0=so.getFieldParts,n0=Je.RuleUtils.isEmptyRuleProperties,Zd=function(n){function e(t){var r;return(0,vr.A)(this,e),r=Xy(this,e,[t]),et(r),r.removeSelf=r.removeSelf.bind(r),r.setLock=r.setLock.bind(r),r.onPropsChanged(t),r}return(0,mr.A)(e,n),(0,gr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,o=["selectedField","selectedFieldSrc","selectedFieldType","selectedOperator","config","reordableNodesCnt","isLocked"],u=!this.meta||o.map(function(i){return r[i]!==a[i]}).filter(function(i){return i}).length>0;u&&(this.meta=this.getMeta(r))}},{key:"getMeta",value:function(r){var a=r.selectedField,o=r.selectedFieldType,u=r.selectedOperator,i=r.config,l=r.reordableNodesCnt,s=r.isLocked,c=i.settings.keepInputOnChangeFieldSrc,d=t0(a,i),f=Zy(i,a),p=f&&f.type=="!struct",v=c&&o,g=!!a||v,m=g&&u,O=e0(i,u,a),y=O&&O.options!=null,b=r0(i,a,u,null,null)||{},A=b.hideOperator,L=i.settings.canReorder&&l>1&&!s,S=g&&!A,R=g&&A&&b.operatorInlineLabel,N=m&&!p,M=m&&y;return{selectedFieldParts:d,selectedFieldWidgetConfig:b,showDragIcon:L,showOperator:S,showOperatorLabel:R,showWidget:N,showOperatorOptions:M}}},{key:"setLock",value:function(r){this.props.setLock(r)}},{key:"removeSelf",value:function(){var r=this,a=this.props,o=a.confirmFn,u=a.config,i=u.settings,l=i.renderConfirm,s=i.removeRuleConfirmOptions,c=function(){r.props.removeSelf()};s&&!this.isEmptyCurrentRule()?l.call(u.ctx,Yd(Yd({},s),{},{onOk:c,onCancel:null,confirmFn:o}),u.ctx):c()}},{key:"_buildWidgetProps",value:function(r){var a=r.selectedField,o=r.selectedFieldSrc,u=r.selectedFieldType,i=r.selectedOperator,l=r.operatorOptions,s=r.value,c=r.valueType,d=r.valueSrc,f=r.asyncListValues,p=r.valueError,v=r.fieldError,g=r.parentField;return{field:a,fieldSrc:o,fieldType:u,operator:i,operatorOptions:l,value:s,valueType:c,valueSrc:d,asyncListValues:f,valueError:p,fieldError:v,parentField:g}}},{key:"isEmptyCurrentRule",value:function(){var r=this.props.config,a=this._buildWidgetProps(this.props);return n0(a,r)}},{key:"renderField",value:function(){var r=this.props,a=r.config,o=r.isLocked,u=r.parentField,i=r.groupId,l=r.id,s=r.selectedFieldSrc,c=r.selectedField,d=r.selectedFieldType,f=r.setField,p=r.setFuncValue,v=r.setFieldSrc,g=r.fieldError,m=a.settings.immutableFieldsMode;return F.createElement(zi,{key:"field",classname:jt()(s=="func"?"rule--field--func":"rule--field"),config:a,canSelectFieldSource:!u,selectedField:c,selectedFieldSrc:s,selectedFieldType:d,fieldError:g,setField:m?mt:f,setFuncValue:m?mt:p,setFieldSrc:m?mt:v,parentField:u,readonly:m||o,id:l,groupId:i})}},{key:"renderOperator",value:function(){var r=this.props,a=r.config,o=r.isLocked,u=this.meta,i=u.selectedFieldParts,l=u.selectedFieldWidgetConfig,s=u.showOperator,c=u.showOperatorLabel,d=a.settings.immutableOpsMode;return F.createElement(Fd,{key:"operator",config:a,selectedField:this.props.selectedField,selectedFieldSrc:this.props.selectedFieldSrc,selectedFieldType:this.props.selectedFieldType,selectedOperator:this.props.selectedOperator,setOperator:d?mt:this.props.setOperator,selectedFieldParts:i,showOperator:s,showOperatorLabel:c,selectedFieldWidgetConfig:l,readonly:d||o,id:this.props.id,groupId:this.props.groupId})}},{key:"renderWidget",value:function(){var r=this.props,a=r.config,o=r.isLocked,u=this.meta.showWidget,i=a.settings.immutableValuesMode;if(!u)return null;var l=F.createElement(Ca,(0,fr.A)({key:"values"},this._buildWidgetProps(this.props),{config:a,setValue:i?mt:this.props.setValue,setValueSrc:i?mt:this.props.setValueSrc,setFuncValue:i?mt:this.props.setFuncValue,readonly:i||o,id:this.props.id,groupId:this.props.groupId}));return F.createElement(Gr,{key:"widget-for-"+this.props.selectedOperator,className:"rule--value"},l)}},{key:"renderOperatorOptions",value:function(){var r=this.props.config,a=this.meta.showOperatorOptions,o=r.settings,u=o.immutableOpsMode,i=o.immutableValuesMode;if(!a)return null;var l=F.createElement(qd,{key:"operatorOptions",selectedField:this.props.selectedField,selectedOperator:this.props.selectedOperator,operatorOptions:this.props.operatorOptions,setOperatorOption:u?mt:this.props.setOperatorOption,config:r,readonly:i});return F.createElement(Gr,{key:"op-options-for-"+this.props.selectedOperator,className:"rule--operator-options"},l)}},{key:"renderBeforeWidget",value:function(){var r=this.props.config,a=r.settings.renderBeforeWidget;return a&&F.createElement(Gr,{key:"before-widget-for-"+this.props.selectedOperator,className:"rule--before-widget"},typeof a=="function"?a(this.props,r.ctx):a)}},{key:"renderAfterWidget",value:function(){var r=this.props.config,a=r.settings.renderAfterWidget;return a&&F.createElement(Gr,{key:"after-widget-for-"+this.props.selectedOperator,className:"rule--after-widget"},typeof a=="function"?a(this.props,r.ctx):a)}},{key:"renderError",value:function(){var r=this.props,a=r.config,o=r.valueError,u=r.fieldError,i=a.settings,l=i.renderRuleError,s=i.showErrorMessage,c=[u].concat((0,Fe.A)(o?.toArray()||[])).filter(function(d){return!!d}).shift()||null;return s&&c&&F.createElement("div",{className:"rule--error"},l?l({error:c},a.ctx):c)}},{key:"renderDrag",value:function(){var r=this.props.handleDraggerMouseDown,a=this.props.config,o=this.meta.showDragIcon,u=a.settings.renderIcon,i=function(c){return u?.(c,a.ctx)},l=F.createElement(i,{type:"drag"});return o&&F.createElement("div",{key:"rule-drag-icon",onMouseDown:r,className:"qb-drag-handler rule--drag-handler"},l)}},{key:"renderDel",value:function(){var r=this.props,a=r.config,o=r.isLocked,u=a.settings,i=u.deleteLabel,l=u.immutableGroupsMode,s=u.renderButton,c=u.renderIcon,d=u.canDeleteLocked,f=function(g){return c(g,a.ctx)},p=function(g){return s(g,a.ctx)};return!l&&(!o||o&&d)&&F.createElement(p,{type:"delRule",onClick:this.removeSelf,label:i,config:a,renderIcon:f})}},{key:"renderLock",value:function(){var r=this.props,a=r.config,o=r.isLocked,u=r.isTrueLocked,i=r.id,l=a.settings,s=l.lockLabel,c=l.lockedLabel,d=l.showLock,f=l.renderSwitch,p=function(g){return f(g,a.ctx)};return d&&!(o&&!u)&&F.createElement(p,{type:"lock",id:i,value:o,setValue:this.setLock,label:s,checkedLabel:c,hideLabel:!0,config:a})}},{key:"render",value:function(){var r=this.meta,a=r.showOperatorOptions,o=r.selectedFieldWidgetConfig,u=this.props,i=u.valueSrc,l=u.value,s=u.config,c=i?.first()=="value"&&!a&&l.size==1&&o.fullWidth,d=s.settings.renderButtonGroup,f=function(A){return d(A,s.ctx)},p=[this.renderField(),this.renderOperator(),this.renderBeforeWidget(),this.renderWidget(),this.renderAfterWidget(),this.renderOperatorOptions()],v=F.createElement("div",{key:"rule-body",className:jt()("rule--body",c&&"can--shrink--value")},p),g=this.renderError(),m=this.renderDrag(),O=this.renderLock(),y=this.renderDel();return F.createElement(F.Fragment,null,m,F.createElement("div",{className:"rule--body--wrapper"},v,g),F.createElement("div",{className:"rule--header"},F.createElement(f,{config:s},O,y)))}}])}(F.Component);Zd.propTypes={id:j().string.isRequired,groupId:j().string,selectedField:j().any,selectedFieldSrc:j().string,selectedFieldType:j().string,selectedOperator:j().string,operatorOptions:j().object,config:j().object.isRequired,value:j().any,valueSrc:j().any,valueType:j().any,asyncListValues:j().array,isDraggingMe:j().bool,isDraggingTempo:j().bool,parentField:j().string,valueError:j().any,fieldError:j().string,isLocked:j().bool,isTrueLocked:j().bool,handleDraggerMouseDown:j().func,setField:j().func,setFieldSrc:j().func,setOperator:j().func,setOperatorOption:j().func,setLock:j().func,removeSelf:j().func,setValue:j().func,setValueSrc:j().func,reordableNodesCnt:j().number,totalRulesCnt:j().number,parentReordableNodesCnt:j().number};const a0=dy(ea("rule")(ta(Zd)));var o0=h(22331),i0=h.n(o0);function u0(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,ef()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function ef(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ef=function(){return!!n})()}var l0=Je.DefaultUtils.defaultGroupConjunction,s0=function(e,t){var r;return r=function(a){function o(u){var i;return(0,vr.A)(this,o),i=u0(this,o,[u]),i._selectedConjunction=function(l){return l=l||i.props,l.conjunction||l0(l.config,l.field)},i.setConjunction=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;i.props.actions.setConjunction(i.props.path,l)},i.setNot=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;i.props.actions.setNot(i.props.path,l)},i.setLock=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;i.props.actions.setLock(i.props.path,l)},i.dummyFn=function(){},i.removeSelf=function(){i.props.actions.removeGroup(i.props.path)},i.addGroup=function(){i.props.actions.addGroup(i.props.path)},i.addCaseGroup=function(){i.props.actions.addCaseGroup(i.props.path)},i.addDefaultCaseGroup=function(){i.props.actions.addDefaultCaseGroup(i.props.path)},i.addRule=function(){var l=t=="rule_group"?i.props.field:null;i.props.actions.addRule(i.props.path,void 0,void 0,void 0,l)},i.setField=function(l,s,c){i.props.actions.setField(i.props.path,l,s,c)},i.setOperator=function(l){i.props.actions.setOperator(i.props.path,l)},i.setValue=function(l,s,c,d,f){i.props.actions.setValue(i.props.path,l,s,c,d,f)},i.setFuncValue=function(l,s,c,d,f,p,v){i.props.actions.setFuncValue(i.props.path,l,s,c,d,f,p,v)},i.pureShouldComponentUpdate=Zn(i),et(i),i.selectedConjunction=i._selectedConjunction(u),i.conjunctionOptions=i._getConjunctionOptions(u),i.dummyFn.isDummyFn=!0,i}return(0,mr.A)(o,a),(0,gr.A)(o,[{key:"shouldComponentUpdate",value:function(i,l){var s=this.props,c=this.state,d=this.pureShouldComponentUpdate(i,l);if(d&&c==l&&s!=i){var f=i.dragging.id||s.dragging.id,p=f==i.id,v=[];for(var g in i){var m=i[g]!=s[g];g=="dragging"&&!p&&(m=!1),m&&v.push(g)}v.length||(d=!1)}return d}},{key:"onPropsChanged",value:function(i){var l=i.config,s=i.id,c=i.conjunction,d=this.props.config,f=this.props.conjunction;(d!=l||f!=c)&&(this.selectedConjunction=this._selectedConjunction(i),this.conjunctionOptions=this._getConjunctionOptions(i))}},{key:"_getConjunctionOptions",value:function(i){var l=this;return ro()(i.config.conjunctions,function(s,c){return{id:"conjunction-".concat(i.id,"-").concat(c),name:"conjunction[".concat(i.id,"]"),key:c,label:s.label,checked:c===l._selectedConjunction(i)}})}},{key:"render",value:function(){var i=this.props.config.settings.showErrorMessage,l=this.props.dragging.id==this.props.id,s=this.props.path.size,c=this.props.config.settings.maxNesting,d=!l&&this.props.isDraggingTempo,f=this.props.fieldType||null,p=this.props.valueError,v=(0,Fe.A)(p?.toArray()||[]).filter(function(y){return!!y}).shift()||null,g=v!=null&&i,m=typeof c>"u"||s<c,O=s==1;return F.createElement("div",{className:jt()("group-or-rule-container","group-container",g?"group-with-error":null),"data-id":this.props.id},[l?F.createElement(e,{key:"dragging",id:this.props.id,groupId:this.props.groupId,isDraggingMe:!0,isDraggingTempo:!0,dragging:this.props.dragging,isRoot:O,allowFurtherNesting:m,conjunctionOptions:this.conjunctionOptions,not:this.props.not,selectedConjunction:this.selectedConjunction,setConjunction:this.dummyFn,setNot:this.dummyFn,setLock:this.dummyFn,removeSelf:this.dummyFn,addGroup:this.dummyFn,addCaseGroup:this.dummyFn,addDefaultCaseGroup:this.dummyFn,addRule:this.dummyFn,setField:this.dummyFn,setFuncValue:this.dummyFn,setOperator:this.dummyFn,setValue:this.dummyFn,value:this.props.value||null,valueError:this.props.valueError||null,config:this.props.config,children1:this.props.children1,actions:this.props.actions,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:f,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt}):null,F.createElement(e,{key:this.props.id,id:this.props.id,groupId:this.props.groupId,isDraggingMe:l,isDraggingTempo:d,onDragStart:this.props.onDragStart,isRoot:O,allowFurtherNesting:m,conjunctionOptions:this.conjunctionOptions,not:this.props.not,selectedConjunction:this.selectedConjunction,setConjunction:d?this.dummyFn:this.setConjunction,setNot:d?this.dummyFn:this.setNot,setLock:d?this.dummyFn:this.setLock,removeSelf:d?this.dummyFn:this.removeSelf,addGroup:d?this.dummyFn:this.addGroup,addCaseGroup:d?this.dummyFn:this.addCaseGroup,addDefaultCaseGroup:d?this.dummyFn:this.addDefaultCaseGroup,addRule:d?this.dummyFn:this.addRule,setField:d?this.dummyFn:this.setField,setFuncValue:d?this.dummyFn:this.setFuncValue,setOperator:d?this.dummyFn:this.setOperator,setValue:d?this.dummyFn:this.setValue,value:this.props.value||null,valueError:this.props.valueError||null,config:this.props.config,children1:this.props.children1,actions:this.props.actions,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:f,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt})])}}])}(F.Component),r.propTypes={config:j().object.isRequired,actions:j().object.isRequired,path:j().any.isRequired,id:j().string.isRequired,groupId:j().string,not:j().bool,conjunction:j().string,children1:j().any,onDragStart:j().func,reordableNodesCnt:j().number,field:j().any,fieldSrc:j().string,fieldType:j().string,parentField:j().string,valueError:j().any,isLocked:j().bool,isTrueLocked:j().bool,dragging:j().object,isDraggingTempo:j().bool},r};const Ta=function(n,e){var t=no(function(r){return{dragging:r.dragging}},null,null,{context:Fa})(s0(n,e));return t.displayName="ConnectedGroupContainer",t};function c0(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,rf()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function rf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(rf=function(){return!!n})()}var d0={topLeft:"group--actions--tl",topCenter:"group--actions--tc",topRight:"group--actions--tr",bottomLeft:"group--actions--bl",bottomCenter:"group--actions--bc",bottomRight:"group--actions--br"},f0="topRight",tf=function(n){function e(){return(0,vr.A)(this,e),c0(this,e,arguments)}return(0,mr.A)(e,n),(0,gr.A)(e,[{key:"render",value:function(){var r=this.props,a=r.config,o=r.addRule,u=r.addGroup,i=r.removeSelf,l=r.setLock,s=r.isLocked,c=r.isTrueLocked,d=r.id,f=r.canAddGroup,p=r.canAddRule,v=r.canDeleteGroup,g=a.settings,m=g.immutableGroupsMode,O=g.addRuleLabel,y=g.addGroupLabel,b=g.delGroupLabel,A=g.groupActionsPosition,L=g.renderButton,S=g.renderIcon,R=g.renderSwitch,N=g.renderButtonGroup,M=g.lockLabel,x=g.lockedLabel,W=g.showLock,B=g.canDeleteLocked,k=function(ne){return S(ne,a.ctx)},Q=function(ne){return L(ne,a.ctx)},K=function(ne){return R(ne,a.ctx)},J=function(ne){return N(ne,a.ctx)},G=d0[A||f0],re=W&&!(s&&!c)&&F.createElement(K,{type:"lock",id:d,value:s,setValue:l,label:M,checkedLabel:x,config:a}),ue=!m&&p&&!s&&F.createElement(Q,{type:"addRule",onClick:o,label:O,readonly:s,config:a,renderIcon:k}),de=!m&&f&&!s&&F.createElement(Q,{type:"addGroup",onClick:u,label:y,readonly:s,config:a,renderIcon:k}),fe=!m&&v&&(!s||s&&B)&&F.createElement(Q,{type:"delGroup",onClick:i,label:b,config:a,renderIcon:k});return F.createElement("div",{className:"group--actions ".concat(G)},F.createElement(J,{config:a},re,ue,de,fe))}}])}(F.PureComponent);function nf(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function af(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?nf(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):nf(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function p0(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,of()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function of(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(of=function(){return!!n})()}var v0=Je.RuleUtils.isEmptyGroupChildren,g0="topRight",Jt=function(n){function e(t){var r;return(0,vr.A)(this,e),r=p0(this,e,[t]),r.childrenClassName=function(){return""},r.renderBeforeActions=function(){var a=r.props.config.settings.renderBeforeActions;return a==null?null:typeof a=="function"?a(r.props,r.props.config.ctx):a},r.renderAfterActions=function(){var a=r.props.config.settings.renderAfterActions;return a==null?null:typeof a=="function"?a(r.props,r.props.config.ctx):a},r.removeSelf=r.removeSelf.bind(r),r.setLock=r.setLock.bind(r),r.renderItem=r.renderItem.bind(r),r}return(0,mr.A)(e,n),(0,gr.A)(e,[{key:"isGroupTopPosition",value:function(){return i0()(this.props.config.settings.groupActionsPosition||g0,"top")}},{key:"setLock",value:function(r){this.props.setLock(r)}},{key:"removeSelf",value:function(){var r=this,a=this.props,o=a.confirmFn,u=a.config,i=u.settings,l=i.renderConfirm,s=i.removeGroupConfirmOptions,c=function(){r.props.removeSelf()};s&&!this.isEmptyCurrentGroup()?l.call(u.ctx,af(af({},s),{},{onOk:c,onCancel:null,confirmFn:o}),u.ctx):c()}},{key:"isEmptyCurrentGroup",value:function(){var r=this.props,a=r.children1,o=r.config;return v0(a,o)}},{key:"render",value:function(){return F.createElement(F.Fragment,null,this.renderHeaderWrapper(),this.renderChildrenWrapper(),this.renderFooterWrapper())}},{key:"showNot",value:function(){var r=this.props.config;return r.settings.showNot}},{key:"showConjs",value:function(){var r=this.props,a=r.conjunctionOptions,o=r.children1,u=r.config,i=Object.keys(a).length;return i>1||this.showNot()}},{key:"isNoChildren",value:function(){var r=this.props.children1;return r?r.size==0:!0}},{key:"isOneChild",value:function(){var r=this.props.children1;return r?r.size<2:!0}},{key:"renderChildrenWrapper",value:function(){var r=this.props.children1;return r&&F.createElement("div",{key:"group-children",className:jt()("group--children",this.showConjs()?"":"hide--conjs",this.isOneChild()?"hide--line":"",this.isOneChild()?"one--child":"",this.childrenClassName())},this.renderChildren())}},{key:"renderHeaderWrapper",value:function(){var r=this.isGroupTopPosition();return F.createElement("div",{key:"group-header",className:jt()("group--header",this.isOneChild()?"one--child":"",this.showConjs()?"":"hide--conjs",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"")},this.renderHeader(),r&&this.renderBeforeActions(),r&&this.renderActions(),r&&this.renderAfterActions())}},{key:"renderFooterWrapper",value:function(){var r=this.isGroupTopPosition();return!r&&F.createElement("div",{key:"group-footer",className:"group--footer"},this.renderBeforeActions(),this.renderActions(),this.renderAfterActions())}},{key:"renderActions",value:function(){var r=this.props,a=r.config,o=r.addRule,u=r.addGroup,i=r.isLocked,l=r.isTrueLocked,s=r.id;return F.createElement(tf,{config:a,addRule:o,addGroup:u,canAddGroup:this.canAddGroup(),canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:i,isTrueLocked:l,id:s})}},{key:"canAddGroup",value:function(){return this.props.allowFurtherNesting}},{key:"canAddRule",value:function(){var r=this.props.config.settings.maxNumberOfRules,a=this.props.totalRulesCnt;return r?a<r:!0}},{key:"canDeleteGroup",value:function(){return!this.props.isRoot}},{key:"renderChildren",value:function(){var r=this.props.children1;return r?r.valueSeq().map(this.renderItem).toArray():null}},{key:"renderItem",value:function(r){if(r){var a=this.props,o=a.config,u=a.actions,i=a.onDragStart,l=a.isLocked,s=r.get("type")=="group"&&r.getIn(["properties","field"])!=null,c=s?"rule_group":r.get("type");return F.createElement(qi,(0,fr.A)({},this.extraPropsForItem(r),{key:r.get("id"),id:r.get("id"),groupId:a.id,path:r.get("path"),type:c,properties:r.get("properties"),config:o,actions:u,children1:r.get("children1"),reordableNodesCnt:this.reordableNodesCntForItem(r),totalRulesCnt:this.totalRulesCntForItem(r),parentReordableNodesCnt:this.reordableNodesCnt(),onDragStart:i,isDraggingTempo:this.props.isDraggingTempo,isParentLocked:l}))}}},{key:"extraPropsForItem",value:function(r){return{}}},{key:"reordableNodesCnt",value:function(){return this.props.isLocked?0:this.props.reordableNodesCnt}},{key:"totalRulesCntForItem",value:function(r){return this.props.totalRulesCnt}},{key:"reordableNodesCntForItem",value:function(r){return this.props.isLocked?0:this.reordableNodesCnt()}},{key:"showDragIcon",value:function(){var r=this.props,a=r.config,o=r.isRoot,u=r.isLocked,i=this.reordableNodesCnt();return a.settings.canReorder&&!o&&i>1&&!u}},{key:"renderDrag",value:function(){var r=this.props.handleDraggerMouseDown,a=this.props.config,o=a.settings.renderIcon,u=function(s){return o?.(s,a.ctx)},i=F.createElement(u,{type:"drag"});return this.showDragIcon()&&F.createElement("div",{key:"group-drag-icon",onMouseDown:r,className:"qb-drag-handler group--drag-handler"},i)}},{key:"conjunctionOptions",value:function(){var r=this.props.conjunctionOptions;return r}},{key:"renderConjs",value:function(){var r=this.props,a=r.config,o=r.children1,u=r.id,i=r.selectedConjunction,l=r.setConjunction,s=r.not,c=r.setNot,d=r.isLocked,f=a.settings,p=f.immutableGroupsMode,v=f.renderConjs,g=f.showNot,m=f.notLabel,O=this.conjunctionOptions();if(!this.showConjs()||!o||!o.size)return null;var y={disabled:this.isOneChild(),readonly:p||d,selectedConjunction:i,setConjunction:p?mt:l,conjunctionOptions:O,config:a,not:s||!1,id:u,setNot:p?mt:c,notLabel:m,showNot:this.showNot(),isLocked:d};return v(y,a.ctx)}},{key:"renderHeader",value:function(){return F.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}}])}(F.Component);Jt.propTypes={reordableNodesCnt:j().number,conjunctionOptions:j().object.isRequired,allowFurtherNesting:j().bool.isRequired,isRoot:j().bool.isRequired,not:j().bool,selectedConjunction:j().string,config:j().object.isRequired,id:j().string.isRequired,groupId:j().string,path:j().any,children1:j().any,isDraggingMe:j().bool,isDraggingTempo:j().bool,isLocked:j().bool,isTrueLocked:j().bool,handleDraggerMouseDown:j().func,onDragStart:j().func,addRule:j().func.isRequired,addGroup:j().func.isRequired,removeSelf:j().func.isRequired,setConjunction:j().func.isRequired,setNot:j().func.isRequired,setLock:j().func.isRequired,actions:j().object.isRequired};const m0=Ta(ea("group")(ta(Jt)),"group");function h0(n,e){for(;!{}.hasOwnProperty.call(n,e)&&(n=(0,Ae.A)(n))!==null;);return n}function sn(){return sn=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(n,e,t){var r=h0(n,e);if(r){var a=Object.getOwnPropertyDescriptor(r,e);return a.get?a.get.call(arguments.length<3?n:t):a.value}},sn.apply(null,arguments)}function y0(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,uf()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function uf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(uf=function(){return!!n})()}var O0=function(n){function e(){return(0,vr.A)(this,e),y0(this,e,arguments)}return(0,mr.A)(e,n),(0,gr.A)(e,[{key:"render",value:function(){var r=this.props,a=r.config,o=r.addRule,u=r.canAddRule,i=r.canDeleteGroup,l=r.removeSelf,s=r.setLock,c=r.isLocked,d=r.isTrueLocked,f=r.id,p=a.settings,v=p.immutableGroupsMode,g=p.addRuleLabel,m=p.delGroupLabel,O=p.renderButton,y=p.renderIcon,b=p.renderSwitch,A=p.renderButtonGroup,L=p.lockLabel,S=p.lockedLabel,R=p.showLock,N=p.canDeleteLocked,M=function(G){return y(G,a.ctx)},x=function(G){return O(G,a.ctx)},W=function(G){return b(G,a.ctx)},B=function(G){return A(G,a.ctx)},k=R&&!(c&&!d)&&F.createElement(W,{type:"lock",id:f,value:c,setValue:s,label:L,checkedLabel:S,hideLabel:!0,config:a}),Q=!v&&u&&!c&&F.createElement(x,{type:"addRuleGroup",onClick:o,label:g,readonly:c,config:a,renderIcon:M}),K=!v&&i&&(!c||c&&N)&&F.createElement(x,{type:"delRuleGroup",onClick:l,label:m,config:a,renderIcon:M});return F.createElement("div",{className:"group--actions"},F.createElement(B,{config:a},k,Q,K))}}])}(F.PureComponent);function lf(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function sf(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?lf(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):lf(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function b0(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,cf()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function cf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(cf=function(){return!!n})()}var df=function(n){function e(t){var r;return(0,vr.A)(this,e),r=b0(this,e,[t]),r.childrenClassName=function(){return"rule_group--children"},r.renderHeaderWrapper=function(){return null},r.renderFooterWrapper=function(){return null},r.renderConjs=function(){return null},r.canAddGroup=function(){return!1},r.canAddRule=function(){return!0},r.canDeleteGroup=function(){return!1},et(r),r.onPropsChanged(t),r}return(0,mr.A)(e,n),(0,gr.A)(e,[{key:"onPropsChanged",value:function(r){}},{key:"reordableNodesCntForItem",value:function(r){if(this.props.isLocked)return 0;var a=this.props.children1;return a?.size||0}},{key:"renderChildrenWrapper",value:function(){return F.createElement(F.Fragment,null,this.renderDrag(),this.renderField(),this.renderActions(),sn((0,Ae.A)(e.prototype),"renderChildrenWrapper",this).call(this))}},{key:"renderField",value:function(){var r=this.props,a=r.config,o=r.selectedField,u=r.selectedFieldSrc,i=r.selectedFieldType,l=r.setField,s=r.setFuncValue,c=r.setFieldSrc,d=r.parentField,f=r.id,p=r.groupId,v=r.isLocked,g=a.settings.immutableFieldsMode;return F.createElement(zi,{key:"field",classname:"group--field",config:a,canSelectFieldSource:!1,selectedField:o,selectedFieldSrc:u,selectedFieldType:i,setField:l,setFuncValue:s,setFieldSrc:c,parentField:d,readonly:g||v,id:f,groupId:p})}},{key:"renderActions",value:function(){var r=this.props,a=r.config,o=r.addRule,u=r.isLocked,i=r.isTrueLocked,l=r.id;return F.createElement(O0,{config:a,addRule:o,canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:u,isTrueLocked:i,id:l})}},{key:"extraPropsForItem",value:function(r){return{parentField:this.props.selectedField}}}])}(Jt);df.propTypes=sf(sf({},Jt.propTypes),{},{selectedField:j().any,selectedFieldSrc:j().string,parentField:j().string,setField:j().func,setFieldSrc:j().func});const S0=Ta(ea("group rule_group")(ta(df)),"rule_group");function F0(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,ff()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function ff(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ff=function(){return!!n})()}var C0=function(n){function e(){return(0,vr.A)(this,e),F0(this,e,arguments)}return(0,mr.A)(e,n),(0,gr.A)(e,[{key:"render",value:function(){var r=this.props,a=r.config,o=r.addRule,u=r.canAddRule,i=r.canDeleteGroup,l=r.removeSelf,s=r.setLock,c=r.isLocked,d=r.isTrueLocked,f=r.id,p=a.settings,v=p.immutableGroupsMode,g=p.addSubRuleLabel,m=p.delGroupLabel,O=p.renderButton,y=p.renderIcon,b=p.renderSwitch,A=p.renderButtonGroup,L=p.lockLabel,S=p.lockedLabel,R=p.showLock,N=p.canDeleteLocked,M=function(G){return y(G,a.ctx)},x=function(G){return O(G,a.ctx)},W=function(G){return b(G,a.ctx)},B=function(G){return A(G,a.ctx)},k=R&&!(c&&!d)&&F.createElement(W,{type:"lock",id:f,value:c,setValue:s,label:L,checkedLabel:S,config:a}),Q=!v&&u&&!c&&F.createElement(x,{type:"addRuleGroupExt",onClick:o,label:g,readonly:c,config:a,renderIcon:M}),K=!v&&i&&(!c||c&&N)&&F.createElement(x,{type:"delRuleGroup",onClick:l,label:m,config:a,renderIcon:M});return F.createElement("div",{className:"group--actions group--actions--tr"},F.createElement(B,{config:a},k,Q,K))}}])}(F.PureComponent);function pf(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function vf(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?pf(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):pf(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function T0(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=E0(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,u=!1,i;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return o=s.done,s},e:function(s){u=!0,i=s},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(u)throw i}}}}function E0(n,e){if(n){if(typeof n=="string")return gf(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return gf(n,e)}}function gf(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function A0(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,mf()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function mf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(mf=function(){return!!n})()}var hf=Je.ConfigUtils,yf=hf.getFieldConfig,L0=hf.getFieldWidgetConfig,w0=Je.RuleUtils.isEmptyRuleGroupExtPropertiesAndChildren,Of=function(n){function e(t){var r;return(0,vr.A)(this,e),r=A0(this,e,[t]),r.childrenClassName=function(){return"rule_group_ext--children"},r.renderFooterWrapper=function(){return null},r.canAddGroup=function(){return!1},r.canAddRule=function(){return!0},r.canDeleteGroup=function(){return!0},et(r),r.onPropsChanged(t),r}return(0,mr.A)(e,n),(0,gr.A)(e,[{key:"onPropsChanged",value:function(r){}},{key:"renderHeaderWrapper",value:function(){return F.createElement("div",{key:"group-header",className:jt()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag",this.showConjs()&&(!this.isOneChild()||this.showNot())?"with--conjs":"hide--conjs")},this.renderHeader(),this.renderGroupField(),this.renderActions())}},{key:"renderHeader",value:function(){return F.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"renderGroupField",value:function(){return F.createElement("div",{className:"group--field--count--rule"},this.renderField(),this.renderOperator(),this.renderWidget(),this.renderError())}},{key:"renderError",value:function(){var r=this.props,a=r.config,o=r.valueError,u=a.settings,i=u.renderRuleError,l=u.showErrorMessage,s=(0,Fe.A)(o?.toArray()||[]).filter(function(c){return!!c}).shift()||null;return l&&s&&F.createElement("div",{className:"rule_group--error"},i?i({error:s},a.ctx):s)}},{key:"showNot",value:function(){var r=this.props,a=r.config,o=r.selectedField,u=r.selectedOperator,i=yf(a,o)||{};return i.showNot!=null?i.showNot:a.settings.showNot}},{key:"conjunctionOptions",value:function(){var r=this.props,a=r.config,o=r.selectedField,u=r.selectedOperator,i=yf(a,o)||{},l=sn((0,Ae.A)(e.prototype),"conjunctionOptions",this).call(this);if(i.conjunctions){var s={},c=T0(i.conjunctions),d;try{for(c.s();!(d=c.n()).done;){var f=d.value,p=l[f];p&&(s[f]=p)}}catch(v){c.e(v)}finally{c.f()}l=s}return l}},{key:"renderField",value:function(){var r=this.props,a=r.config,o=r.selectedField,u=r.selectedFieldSrc,i=r.selectedFieldType,l=r.setField,s=r.setFieldSrc,c=r.setFuncValue,d=r.parentField,f=r.id,p=r.groupId,v=r.isLocked,g=a.settings.immutableFieldsMode;return F.createElement(zi,{key:"field",classname:"rule--field",config:a,canSelectFieldSource:!1,selectedField:o,selectedFieldSrc:u,selectedFieldType:i,setField:l,setFuncValue:c,setFieldSrc:s,parentField:d,readonly:g||v,id:f,groupId:p})}},{key:"renderOperator",value:function(){var r=this.props,a=r.config,o=r.selectedField,u=r.selectedFieldSrc,i=r.selectedOperator,l=r.setField,s=r.setOperator,c=r.isLocked,d=a.settings.immutableFieldsMode,f=L0(a,o,i)||{},p=f.hideOperator,v=o&&p&&f.operatorInlineLabel,g=o&&!p;return F.createElement(Fd,{key:"operator",classname:"group--operator",config:a,selectedField:o,selectedFieldSrc:u,selectedOperator:i,setOperator:s,selectedFieldPartsLabels:["group"],showOperator:g,showOperatorLabel:v,selectedFieldWidgetConfig:f,readonly:d||c,id:this.props.id,groupId:this.props.groupId})}},{key:"isEmptyCurrentGroup",value:function(){var r=this.props,a=r.children1,o=r.config,u=this._buildWidgetProps(this.props);return w0(u,a,o)}},{key:"_buildWidgetProps",value:function(r){var a=r.selectedField,o=r.selectedFieldSrc,u=r.selectedFieldType,i=r.selectedOperator,l=r.operatorOptions,s=r.value,c=r.valueType,d=r.valueSrc,f=r.asyncListValues,p=r.valueError,v=r.fieldError,g=r.parentField;return{field:a,fieldSrc:o,fieldType:u,operator:i,operatorOptions:l,value:s,valueType:c,valueSrc:["value"],valueError:p,fieldError:null,parentField:g}}},{key:"renderWidget",value:function(){var r=this.props,a=r.config,o=r.selectedField,u=r.selectedOperator,i=r.isLocked,l=a.settings.immutableValuesMode,s=o&&u,c=s;if(!c)return null;var d=F.createElement(Ca,(0,fr.A)({key:"values",isForRuleGroup:!0},this._buildWidgetProps(this.props),{config:a,setValue:l?mt:this.props.setValue,setValueSrc:mt,readonly:l||i,id:this.props.id,groupId:this.props.groupId}));return F.createElement(Gr,{key:"widget-for-"+this.props.selectedOperator,className:"rule--value"},d)}},{key:"renderActions",value:function(){var r=this.props,a=r.config,o=r.addRule,u=r.isLocked,i=r.isTrueLocked,l=r.id;return F.createElement(C0,{config:a,addRule:o,canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:u,isTrueLocked:i,id:l})}},{key:"reordableNodesCntForItem",value:function(r){if(this.props.isLocked)return 0;var a=this.props.children1;return a?.size||0}},{key:"extraPropsForItem",value:function(r){return{parentField:this.props.selectedField}}}])}(Jt);Of.propTypes=vf(vf({},Jt.propTypes),{},{selectedField:j().any,selectedFieldSrc:j().string,selectedOperator:j().string,value:j().any,parentField:j().string,setField:j().func,setFieldSrc:j().func,setOperator:j().func,setValue:j().func,valueError:j().any});const j0=Ta(ea("group rule_group_ext")(ta(Of)),"rule_group");function R0(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,bf()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function bf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bf=function(){return!!n})()}var P0={topLeft:"group--actions--tl",topCenter:"group--actions--tc",topRight:"group--actions--tr",bottomLeft:"group--actions--bl",bottomCenter:"group--actions--bc",bottomRight:"group--actions--br"},x0="topRight",I0=function(n){function e(){return(0,vr.A)(this,e),R0(this,e,arguments)}return(0,mr.A)(e,n),(0,gr.A)(e,[{key:"render",value:function(){var r=this.props,a=r.config,o=r.addCaseGroup,u=r.addDefaultCaseGroup,i=r.setLock,l=r.isLocked,s=r.isTrueLocked,c=r.id,d=r.canAddGroup,f=r.canAddDefault,p=a.settings,v=p.immutableGroupsMode,g=p.addCaseLabel,m=p.addDefaultCaseLabel,O=p.groupActionsPosition,y=p.renderButton,b=p.renderIcon,A=p.renderSwitch,L=p.renderButtonGroup,S=p.lockLabel,R=p.lockedLabel,N=p.showLock,M=function(re){return b(re,a.ctx)},x=function(re){return y(re,a.ctx)},W=function(re){return A(re,a.ctx)},B=function(re){return L(re,a.ctx)},k=P0[O||x0],Q=N&&!(l&&!s)&&F.createElement(W,{type:"lock",id:c,value:l,setValue:i,label:S,checkedLabel:R,config:a}),K=!v&&d&&!l&&F.createElement(x,{type:"addCaseGroup",onClick:o,label:g,readonly:l,config:a,renderIcon:M}),J=!v&&f&&!l&&F.createElement(x,{type:"addDefaultCaseGroup",onClick:u,label:m,readonly:l,config:a,renderIcon:M});return F.createElement("div",{className:"group--actions ".concat(k)},F.createElement(B,{config:a},Q,K,J))}}])}(F.PureComponent);function Sf(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function V0(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Sf(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Sf(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function D0(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,Ff()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function Ff(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ff=function(){return!!n})()}var Cf=Je.TreeUtils,N0=Cf.getTotalReordableNodesCountInTree,k0=Cf.getTotalRulesCountInTree,Tf=function(n){function e(t){var r;return(0,vr.A)(this,e),r=D0(this,e,[t]),r.childrenClassName=function(){return"switch_group--children"},r.renderFooterWrapper=function(){return null},r.hasDefaultCase=function(){var a;return((a=r.props.children1)===null||a===void 0?void 0:a.size)&&r.props.children1.filter(function(o){return o.get("children1")==null}).size>0},et(r),r.onPropsChanged(t),r}return(0,mr.A)(e,n),(0,gr.A)(e,[{key:"onPropsChanged",value:function(r){}},{key:"canAddGroup",value:function(){var r,a=this.props.config.settings.maxNumberOfCases,o=((r=this.props.children1)===null||r===void 0?void 0:r.size)||0;return a?o<a:!0}},{key:"canAddRule",value:function(){return!1}},{key:"reordableNodesCnt",value:function(){var r,a=((r=this.props.children1)===null||r===void 0?void 0:r.size)||0,o=a;return this.hasDefaultCase()&&o--,o}},{key:"totalRulesCntForItem",value:function(r){return k0(r)}},{key:"reordableNodesCntForItem",value:function(r){var a;if(this.props.isLocked)return 0;var o=this.props.config.settings,u=o.canLeaveEmptyCase,i=o.canRegroupCases,l=((a=this.props.children1)===null||a===void 0?void 0:a.size)||0,s=l;this.hasDefaultCase()&&s--;var c=N0(r),d=c;return d==1&&i&&u&&s>1&&(d=111),d}},{key:"renderHeaderWrapper",value:function(){return F.createElement("div",{key:"group-header",className:jt()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag")},this.renderHeader(),this.renderActions())}},{key:"renderHeader",value:function(){return F.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"renderConjs",value:function(){var r=this.props.config,a=r.settings.renderSwitchPrefix;return a||null}},{key:"showNot",value:function(){return!1}},{key:"renderActions",value:function(){var r=this.props,a=r.config,o=r.addCaseGroup,u=r.addDefaultCaseGroup,i=r.isLocked,l=r.isTrueLocked,s=r.id;return F.createElement(I0,{config:a,addCaseGroup:o,addDefaultCaseGroup:u,canAddDefault:!this.hasDefaultCase(),canAddGroup:this.canAddGroup(),setLock:this.setLock,isLocked:i,isTrueLocked:l,id:s})}}])}(Jt);Tf.propTypes=V0({},Jt.propTypes);const M0=Ta(ea("group switch_group")(ta(Tf)),"switch_group");function Ef(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Af(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ef(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Ef(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function _0(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,Lf()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function Lf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Lf=function(){return!!n})()}var wf=function(n){function e(t){var r;return(0,vr.A)(this,e),r=_0(this,e,[t]),r.childrenClassName=function(){return"case_group--children"},r.renderFooterWrapper=function(){return null},et(r),r.onPropsChanged(t),r}return(0,mr.A)(e,n),(0,gr.A)(e,[{key:"onPropsChanged",value:function(r){}},{key:"isDefaultCase",value:function(){return this.props.children1==null}},{key:"reordableNodesCnt",value:function(){return this.props.parentReordableNodesCnt}},{key:"reordableNodesCntForItem",value:function(r){return this.props.isLocked?0:this.props.reordableNodesCnt}},{key:"totalRulesCntForItem",value:function(r){return this.props.totalRulesCnt}},{key:"showDragIcon",value:function(){return this.isDefaultCase()?!1:sn((0,Ae.A)(e.prototype),"showDragIcon",this).call(this)}},{key:"renderHeaderWrapper",value:function(){return F.createElement("div",{key:"group-header",className:jt()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag",this.showConjs()&&(!this.isOneChild()||this.showNot())?"with--conjs":"hide--conjs")},this.renderHeaderLeft(),this.renderHeaderCenter(),this.renderActions())}},{key:"renderChildrenWrapper",value:function(){return this.isDefaultCase()?null:F.createElement("div",{className:"case_group--body"},this.renderCondition(),this.renderValue())}},{key:"renderHeaderLeft",value:function(){if(this.isDefaultCase()){var r=this.props.config.settings.defaultCaseLabel;return r||""}return F.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"renderCondition",value:function(){return this.isDefaultCase()?null:sn((0,Ae.A)(e.prototype),"renderChildrenWrapper",this).call(this)}},{key:"renderHeaderCenter",value:function(){return this.isDefaultCase()?this.renderValue():null}},{key:"canAddGroup",value:function(){return this.isDefaultCase()?!1:sn((0,Ae.A)(e.prototype),"canAddGroup",this).call(this)}},{key:"canAddRule",value:function(){return this.isDefaultCase()?!1:sn((0,Ae.A)(e.prototype),"canAddRule",this).call(this)}},{key:"renderValue",value:function(){var r=this.props,a=r.config,o=r.isLocked,u=r.value,i=r.setValue,l=r.id,s=a.settings.immutableValuesMode,c=F.createElement(Ca,{key:"values",isCaseValue:!0,field:"!case_value",operator:null,value:u,valueSrc:"value",valueError:null,fieldError:null,config:a,setValue:s?mt:i,setValueSrc:mt,readonly:s||o,id:l,groupId:null});return F.createElement(Gr,{className:"case_group--value"},c)}},{key:"renderActions",value:function(){var r=this.props,a=r.config,o=r.addGroup,u=r.addRule,i=r.isLocked,l=r.isTrueLocked,s=r.id;return F.createElement(tf,{config:a,addGroup:o,addRule:u,canAddRule:this.canAddRule(),canAddGroup:this.canAddGroup(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:i,isTrueLocked:l,id:s})}},{key:"isEmptyCurrentGroup",value:function(){var r=this.props.value,a=r&&r.size?r.get(0):null,o=a!=null&&(Array.isArray(a)?a.length>0:!0);return sn((0,Ae.A)(e.prototype),"isEmptyCurrentGroup",this).call(this)&&!o}}])}(Jt);wf.propTypes=Af(Af({},Jt.propTypes),{},{parentReordableNodesCnt:j().number,value:j().any,setValue:j().func});const G0=Ta(ea("group case_group")(ta(wf)),"case_group");var $0=["type"];function U0(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,jf()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function jf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(jf=function(){return!!n})()}function Rf(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Ji(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Rf(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Rf(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var B0=["rule","group","rule_group","switch_group","case_group"],na=function(e){var t,r=((t=e.properties)===null||t===void 0?void 0:t.toObject())||{},a=Ji({},r);return e.isParentLocked&&(a.isLocked=!0),r.isLocked&&(a.isTrueLocked=!0),a},W0={rule:function(e){return F.createElement(a0,(0,fr.A)({},na(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,config:e.config,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,parentField:e.parentField,parentReordableNodesCnt:e.parentReordableNodesCnt}))},group:function(e){return F.createElement(m0,(0,fr.A)({},na(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))},rule_group:function(e){return F.createElement(S0,(0,fr.A)({},na(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:e.parentField,parentReordableNodesCnt:e.parentReordableNodesCnt}))},rule_group_ext:function(e){return F.createElement(j0,(0,fr.A)({},na(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:e.parentField,parentReordableNodesCnt:e.parentReordableNodesCnt}))},switch_group:function(e){return F.createElement(M0,(0,fr.A)({},na(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))},case_group:function(e){return F.createElement(G0,(0,fr.A)({},na(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))}},qi=function(n){function e(){return(0,vr.A)(this,e),U0(this,e,arguments)}return(0,mr.A)(e,n),(0,gr.A)(e,[{key:"render",value:function(){var r,a=this.props,o=a.type,u=(0,Qn.A)(a,$0),i=(r=u.properties)===null||r===void 0?void 0:r.get("mode"),l=i=="array"?"_ext":"",s=u.config.settings.renderItem,c=W0[o+l];return s?s(Ji(Ji({},u),{},{type:o,itemComponent:c}),u.config.ctx):c?c(u):null}}])}(F.PureComponent);qi.propTypes={config:j().object.isRequired,id:j().string.isRequired,groupId:j().string,type:j().oneOf(B0).isRequired,path:j().any.isRequired,properties:j().any,children1:j().any,actions:j().object.isRequired,reordableNodesCnt:j().number,onDragStart:j().func,parentField:j().string,isDraggingTempo:j().bool,isParentLocked:j().bool};function K0(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,Pf()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function Pf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Pf=function(){return!!n})()}var xf=Je.TreeUtils,H0=xf.getTotalReordableNodesCountInTree,z0=xf.getTotalRulesCountInTree,If=Je.DefaultUtils,J0=If.createListFromArray,Vf=If.emptyProperties,Df=function(n){function e(t){var r;return(0,vr.A)(this,e),r=K0(this,e,[t]),r.pureShouldComponentUpdate=Zn(r),r._updPath(t),r}return(0,mr.A)(e,n),(0,gr.A)(e,[{key:"shouldComponentUpdate",value:function(r,a){var o=this.props,u=this.pureShouldComponentUpdate(r,a);if(u){var i=[];for(var l in r){var s=r[l]!==o[l];s&&l!="__isInternalValueChange"&&i.push(l)}i.length||(u=!1),i.length==1&&i[0]=="tree"&&r.__isInternalValueChange&&(u=!1)}return u}},{key:"_updPath",value:function(r){var a=r.tree.get("id");this.path=J0([a])}},{key:"render",value:function(){var r=this.props,a=r.tree,o=r.config,u=r.actions,i=r.onDragStart,l=a.get("type"),s=l=="switch_group",c=s?null:H0(a),d=s?null:z0(a),f=a.get("id");return F.createElement(qi,{key:f,id:f,path:this.path,type:l,properties:a.get("properties")||Vf(),config:o,actions:u,children1:a.get("children1")||Vf(),reordableNodesCnt:c,totalRulesCnt:d,parentReordableNodesCnt:0,onDragStart:i})}}])}(F.Component);Df.propTypes={tree:j().any.isRequired,config:j().object.isRequired,actions:j().object.isRequired,onDragStart:j().func};const q0=gy(Df);function Nf(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Q0(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Nf(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Nf(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Y0(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,kf()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function kf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kf=function(){return!!n})()}var X0=Je.clone,Qi=Je.ConfigUtils,Ea=Qi.getFieldConfig,Mf=Qi.getFieldParts,_f=Qi.getFieldPathParts,Gf=Je.RuleUtils,$f=Gf.getFieldPathLabels,Z0=Gf.getWidgetForFieldOp,Uf=function(n){function e(t){var r;return(0,vr.A)(this,e),r=Y0(this,e,[t]),et(r),r.onPropsChanged(t),r}return(0,mr.A)(e,n),(0,gr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,o=["config","field","fieldSrc","fieldType","operator","isFuncArg","parentField"],u=["config","field","fieldSrc","fieldType","operator","value","placeholder","isFuncArg","parentField"],i=!this.items||o.map(function(s){return r[s]!==a[s]}).filter(function(s){return s}).length>0,l=!this.meta||u.map(function(s){return r[s]!==a[s]}).filter(function(s){return s}).length>0;i&&(this.items=this.getItems(r)),l&&(this.meta=this.getMeta(r))}},{key:"getItems",value:function(r){var a=r.config,o=r.field,u=r.fieldType,i=r.operator,l=r.parentField,s=r.isFuncArg,c=r.fieldDefinition,d=a.settings.canCompareFieldWithField,f=a.settings.fieldSeparator,p=Mf(l,a),v=l?Ea(a,l):null,g=l?v?.subfields:a.fields,m=this.filterFields(a,g,o,l,p,i,d,s,c,u),O=this.buildOptions(p,a,m,p);return O}},{key:"getMeta",value:function(r){var a,o=r.config,u=r.field,i=r.fieldType,l=r.operator,s=r.value,c=r.placeholder,d=r.isFuncArg,f=r.parentField,p=o.settings,v=p.fieldPlaceholder,g=p.fieldSeparatorDisplay,m=s,O=!!s,y=u?Ea(o,u):{},b=y==null||(a=y.widgets)===null||a===void 0?void 0:a.field,A=b?.widgetProps||{},L=O?null:d&&c||A.valuePlaceholder||v,S=O?Ea(o,m):null,R=S||{},N=_f(m,o),M=_f(m,o,!0),x=this.getFieldLabel(S,m,o),W=$f(m,o),B=W?W.join(g):null;(B==x||f)&&(B=null);var k=R.label2;return{placeholder:L,selectedKey:m,selectedKeys:N,selectedPath:M,selectedLabel:x,selectedOpts:R,selectedAltLabel:k,selectedFullLabel:B}}},{key:"filterFields",value:function(r,a,o,u,i,l,s,c,d,f){a=X0(a);var p=r.settings.fieldSeparator,v=Ea(r,o),g=!1,m=Z0(r,o,l,"value"),O=r.widgets[m],y;c?y=d?.type:g&&O?y=O.type:v?y=v.type:y=f;function b(A,L){for(var S in A){var R=A[S].subfields,N=(L||[]).concat(S),M=N.join(p),x=Ea(r,M);if(!x)delete A[S];else if(x.type=="!struct"||x.type=="!group")b(R,N)==0&&delete A[S];else{var W=(!y||x.type==y)&&(c?!0:M!=o),B=s||r.settings.canCompareFieldWithField;B&&(W=W&&B(o,v,M,x,l)),W||delete A[S]}}return ra()(A).length}return b(a,i||[]),a}},{key:"buildOptions",value:function(r,a,o){var u=this,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(!o)return null;var s=a.settings,c=s.fieldSeparator,d=s.fieldSeparatorDisplay,f=i!=null&&i.length?i.join(c)+c:"";return ra()(o).map(function(p){var v=[].concat((0,Fe.A)(i??[]),[p]),g=o[p],m=u.getFieldLabel(g,v,a),O=$f(v,a),y=O.join(d);(y==m||r)&&(y=null);var b=g.label2,A=g.tooltip;if(!g.hideForCompare)return g.type=="!struct"||g.type=="!group"?{key:p,path:f+p,label:m,fullLabel:y,altLabel:b,tooltip:A,items:u.buildOptions(r,a,g.subfields,v,{label:m,tooltip:A})}:{key:p,path:f+p,label:m,fullLabel:y,altLabel:b,tooltip:A,grouplabel:l?.label,group:l}}).filter(function(p){return!!p})}},{key:"getFieldLabel",value:function(r,a,o){if(!a)return null;var u=o.settings.maxLabelsLength,i=Mf(a,o),l=r?.label||$a()(i);return l=io(l,u),l}},{key:"render",value:function(){var r=this.props,a=r.config,o=r.customProps,u=r.setValue,i=r.readonly,l=r.id,s=r.groupId,c=a.settings.renderField,d=Q0({isValueField:!0,config:a,customProps:o,setField:u,readonly:i,items:this.items,id:l,groupId:s},this.meta);return c(d,a.ctx)}}])}(F.Component);Uf.propTypes={id:j().string,groupId:j().string,setValue:j().func.isRequired,config:j().object.isRequired,field:j().any,fieldSrc:j().string,fieldType:j().string,value:j().string,operator:j().string,customProps:j().object,readonly:j().bool,parentField:j().string,fieldDefinition:j().object,isFuncArg:j().bool};const eO=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.labelYes,o=n.labelNo,u=n.readonly,i=n.widgetId,l=n.customProps,s=l===void 0?{}:l,c=s.radioYes||{},d=s.radioNo||{},f=function(g){return t(g.target.checked)},p=function(g){return t(g.target.value=="true")};return F.createElement(F.Fragment,null,F.createElement("input",(0,fr.A)({type:"radio",value:!0,checked:!!e,disabled:u,onChange:p},c))," ",a,F.createElement("input",(0,fr.A)({type:"radio",value:!1,checked:!e,disabled:u,onChange:p},d))," ",o)},rO=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.readonly,o=n.placeholder,u=n.maxLength,i=n.customProps,l=function(d){var f=d.target.value;f===""&&(f=void 0),t(f)},s=e||"";return F.createElement("input",(0,fr.A)({type:"text",value:s,placeholder:o,disabled:a,onChange:l,maxLength:u},i))},tO=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.readonly,o=n.placeholder,u=n.maxLength,i=n.maxRows,l=n.fullWidth,s=n.customProps,c=function(p){var v=p.target.value;v===""&&(v=void 0),t(v)},d=e||"";return F.createElement("textarea",(0,fr.A)({value:d,placeholder:o,disabled:a,onChange:c,maxLength:u,style:{width:l?"100%":void 0}},s))};var Bb=Je.moment;const nO=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.valueFormat,o=n.readonly,u=n.customProps,i=function(s){var c=s.target.value;c==""&&(c=void 0),t(c)};return F.createElement("input",(0,fr.A)({type:"date",value:e||"",disabled:o,onChange:i},u))},aO=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.valueFormat,o=n.use12Hours,u=n.readonly,i=n.customProps,l=function(c){var d=c.target.value;d==""&&(d=void 0),t(d)};return F.createElement("input",(0,fr.A)({type:"time",value:e||"",disabled:u,onChange:l},i))};var Bf=Je.moment;const oO=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.valueFormat,o=n.use12Hours,u=n.readonly,i=n.customProps,l=function(d){var f=d.target.value;f==""?f=void 0:f=Bf(new Date(f)).format(a),t(f)},s=e;return e?s=Bf(e).format("YYYY-MM-DDTHH:mm"):s="",F.createElement("input",(0,fr.A)({type:"datetime-local",value:s,disabled:u,onChange:l},i))};var iO=Je.ListUtils.mapListValues;const uO=function(n){var e=n.listValues,t=n.value,r=n.setValue,a=n.allowCustomValues,o=n.readonly,u=n.customProps,i=function(){return iO(e,function(d){var f=d.title,p=d.value;return F.createElement("option",{key:p,value:p},f)})},l=function(d){for(var f=[],p=d.options,v=0;v<p.length;v++){var g=p[v];g.selected&&f.push(g.value)}return f.length||(f=void 0),f},s=function(d){return r(l(d.target))};return F.createElement("select",(0,fr.A)({multiple:!0,onChange:s,value:t,disabled:o},Cr()(u,["showSearch","input","showCheckboxes"])),i())};var lO=Je.ListUtils.mapListValues;const sO=function(n){var e=n.listValues,t=n.value,r=n.setValue,a=n.allowCustomValues,o=n.readonly,u=n.customProps,i=function(){return lO(e,function(d){var f=d.title,p=d.value;return F.createElement("option",{key:p,value:p},f)})},l=function(d){return r(d.target.value)},s=t!=null;return F.createElement("select",(0,fr.A)({onChange:l,value:s?t:"",disabled:o},Cr()(u,["showSearch","input"])),!s&&F.createElement("option",{disabled:!0,value:""}),i())},cO=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.readonly,o=n.min,u=n.max,i=n.step,l=n.placeholder,s=n.customProps,c=function(p){var v=p.target.value;v===""||v===null?v=void 0:v=Number(v),t(v)},d=e??"";return F.createElement("input",(0,fr.A)({type:"number",value:d,placeholder:l,disabled:a,min:o,max:u,step:i,onChange:c},s))},dO=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.readonly,o=n.min,u=n.max,i=n.step,l=n.placeholder,s=n.customProps,c=s===void 0?{}:s,d=c.input||{},f=c.slider||c,p=function(m){var O=m.target.value;O===""||O===null?O=void 0:O=Number(O),t(O)},v=e??"";return F.createElement("div",{style:{display:"inline-flex"}},F.createElement("input",(0,fr.A)({key:"number",type:"number",value:v,placeholder:l,disabled:a,min:o,max:u,step:i,onChange:p},d)),F.createElement("input",(0,fr.A)({key:"range",type:"range",value:v,disabled:a,min:o,max:u,step:i,onChange:p},f)))},fO=function(n){var e=n.items,t=n.setField,r=n.selectedKey,a=n.readonly,o=n.errorText,u=function s(c){return c.map(function(d){var f=d.items,p=d.path,v=d.label,g=d.disabled,m=d.matchesType;if(f)return F.createElement("optgroup",{disabled:g,key:p,label:v},s(f));var O=m?{fontWeight:"bold"}:{};return F.createElement("option",{disabled:g,key:p,value:p,style:O},v)})},i=function(c){return t(c.target.value)},l=r!=null;return F.createElement("select",{onChange:i,value:l?r:"",disabled:a,style:{color:o?"red":null}},!l&&F.createElement("option",{disabled:!0,value:""}),u(e))},pO=function(n){var e=n.id,t=n.not,r=n.setNot,a=n.conjunctionOptions,o=n.setConjunction,u=n.disabled,i=n.readonly,l=n.config,s=n.showNot,c=n.notLabel,d=Object.keys(a).length,f=u,p=l.settings.forceShowConj,v=p||d>1&&!f,g=function(){return Object.keys(a).map(function(A){var L=a[A],S=L.id,R=L.name,N=L.label,M=L.checked,x=o.isDummyFn?"__dummy":"";return(i||u)&&!M?null:[F.createElement("input",{key:S+x,type:"radio",id:S+x,name:R+x,checked:M,disabled:i||u,value:A,onChange:O}),F.createElement("label",{key:S+x+"label",htmlFor:S+x},N)]})},m=function(){var A="not";return[F.createElement("input",{key:e+A,type:"checkbox",id:e+A,checked:t,disabled:i,onChange:y}),F.createElement("label",{key:e+A+"label",htmlFor:e+A},c||"NOT")]},O=function(A){return o(A.target.value)},y=function(A){return r(A.target.checked)};return[s&&m(),v&&g()]};var vO={addRuleGroup:"+",addRuleGroupExt:"+",delGroup:"x",delRuleGroup:"x",delRule:"x"};const gO=function(n){var e=n.type,t=n.label,r=n.onClick,a=n.readonly,o=t||vO[e];return F.createElement("button",{onClick:r,type:"button",disabled:a},o)},mO=function(n){var e=n.type,t={},r=t[e]||null;return!r&&e==="drag"&&(r=F.createElement(bd,null)),r},hO=function(n){var e=n.children,t=n.config;return F.createElement(F.Fragment,null,e)},yO=function(n){var e=n.config,t=n.valueSources,r=n.valueSrc,a=n.title,o=n.setValueSrc,u=n.readonly,i=function(c){return c.map(function(d){var f=(0,Le.A)(d,2),p=f[0],v=f[1];return F.createElement("option",{key:p,value:p},v.label)})},l=function(c){return o(c.target.value)};return F.createElement("select",{onChange:l,value:r||"",disabled:u},i(t))},OO=function(n){var e=n.value,t=n.setValue,r=n.label,a=n.id,o=n.config,u=n.type,i=function(c){return t(c.target.checked)},l=u;return[F.createElement("input",{key:a+l,type:"checkbox",id:a+l,checked:!!e,onChange:i}),F.createElement("label",{key:a+l+"label",htmlFor:a+l},r)]},bO=function(n){var e=n.onOk,t=n.okText,r=n.cancelText,a=n.title;confirm(a)&&e()};var SO=function(e){var t=e.config,r=e.children;return r};function FO(n,e,t){return e=(0,Ae.A)(e),(0,br.A)(n,Wf()?Reflect.construct(e,t||[],(0,Ae.A)(n).constructor):e.apply(n,t))}function Wf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Wf=function(){return!!n})()}var Yi=function(n){function e(){var t;(0,vr.A)(this,e);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return t=FO(this,e,[].concat(a)),t.handleChange=function(u){t.props.setOption("proximity",parseInt(u))},t}return(0,mr.A)(e,n),(0,gr.A)(e,[{key:"render",value:function(){var r=this.props,a=r.defaults,o=r.options,u=r.config,i=r.optionLabel,l=r.optionPlaceholder,s=r.customProps,c=r.minProximity,d=r.maxProximity,f=r.optionTextBefore,p=r.readonly,v=u.settings,g=u.widgets,m=u.ctx,O=a?a.proximity:void 0,y=v.showLabels,b=o.get("proximity",O),A=$i()(c,d+1).map(function(R){return{title:R,value:R}}),L=g.select.factory,S=function(N){return L(N,m)};return F.createElement("div",{className:"operator--PROXIMITY"},F.createElement("div",{className:"operator--options"},y&&F.createElement("label",{className:"rule--label"},i),!y&&f&&F.createElement("div",{className:"operator--options--sep"},F.createElement("span",null,f)),F.createElement(S,(0,fr.A)({config:u,value:b,listValues:A,setValue:this.handleChange,readonly:p,placeholder:l},s))),F.createElement("div",{className:"operator--widgets"},this.props.children))}}])}(F.PureComponent);Yi.propTypes={config:j().object.isRequired,setOption:j().func.isRequired,options:j().any.isRequired,minProximity:j().number,maxProximity:j().number,optionPlaceholder:j().string,optionTextBefore:j().string,optionLabel:j().string,customProps:j().object,readonly:j().bool},Yi.defaultProps={customProps:{},minProximity:2,maxProximity:10,optionPlaceholder:"Select words between",optionLabel:"Words between",optionTextBefore:null};function Kf(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function $e(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Kf(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Kf(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var CO=$e({},Rr.conjunctions),TO=$e($e({},Rr.operators),{},{proximity:$e($e({},Rr.operators.proximity),{},{options:$e($e({},Rr.operators.proximity.options),{},{factory:function(e,t){var r=t.RCE,a=t.O.ProximityOperator;return r(a,e)}})})}),EO={text:$e($e({},Rr.widgets.text),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaTextWidget;return r(a,e)}}),textarea:$e($e({},Rr.widgets.textarea),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaTextAreaWidget;return r(a,e)}}),number:$e($e({},Rr.widgets.number),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaNumberWidget;return r(a,e)}}),slider:$e($e({},Rr.widgets.slider),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaSliderWidget;return r(a,e)}}),select:$e($e({},Rr.widgets.select),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaSelectWidget;return r(a,e)}}),multiselect:$e($e({},Rr.widgets.multiselect),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaMultiSelectWidget;return r(a,e)}}),date:$e($e({},Rr.widgets.date),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaDateWidget;return r(a,e)}}),time:$e($e({},Rr.widgets.time),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaTimeWidget;return r(a,e)}}),datetime:$e($e({},Rr.widgets.datetime),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaDateTimeWidget;return r(a,e)}}),boolean:$e($e({},Rr.widgets.boolean),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaBooleanWidget;return r(a,e)}}),field:$e($e({},Rr.widgets.field),{},{factory:function(e,t){var r=t.RCE,a=t.W.ValueFieldWidget;return r(a,e)},customProps:{showSearch:!0}}),func:$e($e({},Rr.widgets.func),{},{factory:function(e,t){var r=t.RCE,a=t.W.FuncWidget;return r(a,e)},customProps:{}}),case_value:$e($e({},Rr.widgets.case_value),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaTextWidget;return r(a,e)}})},AO=$e($e({},Rr.types),{},{select:$e($e({},Rr.types.select),{},{widgets:$e($e({},Rr.types.select.widgets),{},{select:$e($e({},Rr.types.select.widgets.select),{},{widgetProps:{customProps:{showSearch:!0}}})})})}),LO=$e($e({},Rr.settings),{},{renderField:function(e,t){var r=t.RCE,a=t.W.VanillaFieldSelect;return r(a,e)},renderOperator:function(e,t){var r=t.RCE,a=t.W.VanillaFieldSelect;return r(a,e)},renderFunc:function(e,t){var r=t.RCE,a=t.W.VanillaFieldSelect;return r(a,e)},renderConjs:function(e,t){var r=t.RCE,a=t.W.VanillaConjs;return r(a,e)},renderSwitch:function(e,t){var r=t.RCE,a=t.W.VanillaSwitch;return r(a,e)},renderButton:function(e,t){var r=t.RCE,a=t.W.VanillaButton;return r(a,e)},renderIcon:function(e,t){var r=t.RCE,a=t.W.VanillaIcon;return r(a,e)},renderButtonGroup:function(e,t){var r=t.RCE,a=t.W.VanillaButtonGroup;return r(a,e)},renderProvider:function(e,t){var r=t.RCE,a=t.W.VanillaProvider;return r(a,e)},renderValueSources:function(e,t){var r=t.RCE,a=t.W.VanillaValueSources;return r(a,e)},renderFieldSources:function(e,t){var r=t.RCE,a=t.W.VanillaValueSources;return r(a,e)},renderConfirm:function(e,t){var r=t.W.vanillaConfirm;return r(e)},renderSwitchPrefix:"Conditions",customFieldSelectProps:{showSearch:!0},defaultSliderWidth:"200px",defaultSelectWidth:"200px",defaultSearchWidth:"100px",defaultMaxRows:5,renderSize:"small",maxLabelsLength:100,showLock:!1,showNot:!0,forceShowConj:!1,groupActionsPosition:"topRight"}),wO=$e($e({},Rr.ctx),{},{W:$e({},Ke),O:$e({},xe),RCE:function(e,t){return F.createElement(e,t)}}),Xi={conjunctions:CO,operators:TO,widgets:EO,types:AO,settings:LO,ctx:wO};Xi=Je.ConfigMixins.removeMixins(Xi,["rangeslider","treeselect","treemultiselect"]);const $r=Xi;var Wb=h(38221);function Hf(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function co(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Hf(Object(t),!0).forEach(function(r){_defineProperty(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Hf(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Aa=Je.Autocomplete,fo=Aa.mergeListValues,zf=Aa.listValueToOption,jO=Aa.optionToListValue,RO=Aa.optionsToListValues,PO=Aa.fixListValuesGroupOrder,aa=Je.ListUtils,xO=aa.mapListValues,po=aa.listValuesToArray,vo=aa.getListValue,IO=aa.makeCustomListValue,VO=aa.searchListValue,Kb=aa.getItemInListValues;function Jf(n){return new Promise(function(e){setTimeout(e,n)})}var Hb=function(e,t){var r=e.asyncFetch,a=e.useLoadMore,o=e.useAsyncSearch,u=e.forceAsyncSearch,i=e.asyncListValues,l=e.listValues,s=e.allowCustomValues,c=e.value,d=e.setValue,f=e.placeholder,p=e.config,v=t.debounceTimeout,g=t.multiple,m=t.uif,O=t.isFieldAutocomplete,y=["LOAD_MORE","LOADING_MORE"],b="Load more...",A="Loading more...",L=u?"Type to search":f,S=React.useState(!1),R=_slicedToArray(S,2),N=R[0],M=R[1],x=React.useState(void 0),W=_slicedToArray(x,2),B=W[0],k=W[1],Q=React.useState(0),K=_slicedToArray(Q,2),J=K[0],G=K[1],re=React.useState(!1),ue=_slicedToArray(re,2),de=ue[0],fe=ue[1],ae=React.useState(""),ne=_slicedToArray(ae,2),ve=ne[0],ce=ne[1],se=React.useState(void 0),Te=_slicedToArray(se,2),Oe=Te[0],Re=Te[1],Ve=React.useRef(0),Ue=React.useRef(0),Ye=React.useRef(!1),qe=React.useMemo(function(){return po(i)},[i]),Be=React.useMemo(function(){return r?i?fo(Oe,qe,!0):Oe:po(l)},[r,i,Oe,l]),ar=r?Oe:po(l);s&&ve&&!VO(ve,Oe)&&(ar=fo(ar,[IO(ve)],!0)),r&&!Oe&&i&&!ve&&!N&&m==="antd"&&(ar=Be),r&&!s&&i&&m==="mui"&&(ar=fo(ar,qe,!0,!0));var nr=J>0,Lr=N&&r&&Oe===void 0&&(u?ve:!0),rr=Lr&&nr,dt=!rr&&Be&&Be.length>0&&B&&B.hasMore&&(B.filter||"")===ve,_t=!nr&&dt,St=xO(ar,zf),Ft=c!=null,ht=!g&&Ft?vo(c,Be):null,Gt=function(){var wr=_asyncToGenerator(_regeneratorRuntime.mark(function Pe(){var Me,Ze,or,Dr,Nr,hr,Tt,Ur,Qt,Yt,Et,fn,Xt,Ut,Qr,ur=arguments;return _regeneratorRuntime.wrap(function(ft){for(;;)switch(ft.prev=ft.next){case 0:return Me=ur.length>0&&ur[0]!==void 0?ur[0]:null,Ze=ur.length>1&&ur[1]!==void 0?ur[1]:!1,!Ze&&B&&k(void 0),or=Ze&&Oe?Oe.length:0,Dr=Ze&&B||!a&&{pageSize:0},Nr=++Ve.current,ft.next=8,r.call(p?.ctx,Me,or,Dr);case 8:if(hr=ft.sent,Tt=Ve.current!=Nr,!(Tt||!Ue.current)){ft.next=12;break}return ft.abrupt("return",null);case 12:return Ur=hr!=null&&hr.values?hr:{values:hr},Qt=Ur.values,Yt=Ur.hasMore,Et=Ur.meta,fn=po(Qt),Ze?(Ut=fo(Oe,fn,!1),Xt=Ut.length>Oe.length):(Ut=fn,a&&(Xt=Ut.length>0)),Qr=Yt!=null||Et!=null||Xt!=null?co(co(co(co({},Xt!=null?{hasMore:Xt}:{}),Yt!=null?{hasMore:Yt}:{}),Et??{}),{},{filter:Me}):void 0,Qr&&k(Qr),ft.abrupt("return",Ut);case 18:case"end":return ft.stop()}},Pe)}));return function(){return wr.apply(this,arguments)}}(),$t=function(){var wr=_asyncToGenerator(_regeneratorRuntime.mark(function Pe(){var Me,Ze,or,Dr=arguments;return _regeneratorRuntime.wrap(function(hr){for(;;)switch(hr.prev=hr.next){case 0:return Me=Dr.length>0&&Dr[0]!==void 0?Dr[0]:null,Ze=Dr.length>1&&Dr[1]!==void 0?Dr[1]:!1,G(function(Tt){return Tt+1}),fe(Ze),hr.next=6,Gt(Me,Ze);case 6:if(or=hr.sent,Ue.current){hr.next=9;break}return hr.abrupt("return");case 9:or!=null&&Re(or),G(function(Tt){return Tt-1}),fe(!1);case 12:case"end":return hr.stop()}},Pe)}));return function(){return wr.apply(this,arguments)}}(),ot=React.useCallback(debounce($t,v),[]);React.useEffect(function(){return Ue.current++,Lr&&J==0&&Ve.current==0&&_asyncToGenerator(_regeneratorRuntime.mark(function wr(){return _regeneratorRuntime.wrap(function(Me){for(;;)switch(Me.prev=Me.next){case 0:return Me.next=2,$t();case 2:case"end":return Me.stop()}},wr)}))(),function(){Ue.current--}},[Lr]);var Jr=function(){M(!0)},cn=function(){var wr=_asyncToGenerator(_regeneratorRuntime.mark(function Pe(Me){var Ze,or;return _regeneratorRuntime.wrap(function(Nr){for(;;)switch(Nr.prev=Nr.next){case 0:if(Ze=Ye.current,Ze?(Ye.current=!1,g&&M(!1)):M(!1),!(m==="mui"&&!Ze)){Nr.next=6;break}return or="",Nr.next=6,er(null,or,"my-reset");case 6:case"end":return Nr.stop()}},Pe)}));return function(Me){return wr.apply(this,arguments)}}(),dn=function(Pe){Pe?Jr():cn()},it=function(Pe){var Me=Pe?.specialValue||Pe?.value;return y.includes(Me)},Vr=function(){var wr=_asyncToGenerator(_regeneratorRuntime.mark(function Pe(Me,Ze,or){var Dr,Nr,hr,Tt,Ur,Qt,Yt,Et,fn,Xt,Ut,Qr,ur,ut,ft,Fn,yo;return _regeneratorRuntime.wrap(function(Br){for(;;)switch(Br.prev=Br.next){case 0:if(Nr=g&&m==="mui"&&or==="clear",hr=!g&&m==="mui"&&or==="clear"&&Me?.type==="change",Tt=!g&&m==="mui"&&or==="clear"&&Me?.type!=="change",m==="mui"&&(or=Ze,g?Ze=or.map(function(At){var Hr;return(Hr=At?.value)!==null&&Hr!==void 0?Hr:At}):Ze=(Ur=(Qt=or)===null||Qt===void 0?void 0:Qt.value)!==null&&Ur!==void 0?Ur:or),Yt=g&&Array.isArray(or)&&or.map(function(At){return At?.specialValue}).find(function(At){return!!At})||((Dr=or)===null||Dr===void 0?void 0:Dr.specialValue),g&&Ze&&!Array.isArray(Ze)&&(Ze=[].concat(_toConsumableArray(c||[]),[Ze]),or=null),Et=Nr&&Ze.length===0&&ve&&N||hr,!Et){Br.next=9;break}return Br.abrupt("return");case 9:if(fn=g&&Ze.length&&Ze.length>(c||[]).length&&Ze[Ze.length-1]==ve&&!vo(ve,Oe),Yt!="LOAD_MORE"){Br.next=17;break}return ce(ve),Ye.current=!0,Br.next=15,$t(ve,!0);case 15:Br.next=37;break;case 17:if(Yt!="LOADING_MORE"){Br.next=21;break}Ye.current=!0,Br.next=37;break;case 21:if(!g){Br.next=31;break}if(Xt=RO(Ze,Be,s),Ut=_slicedToArray(Xt,2),Qr=Ut[0],ur=Ut[1],d(Qr,r?ur:void 0),!fn){Br.next=29;break}return Br.next=27,Jf(0);case 27:return Br.next=29,er(null,"","my-reset");case 29:Br.next=37;break;case 31:if(ut=jO(Ze,Be,s),ft=_slicedToArray(ut,2),Fn=ft[0],yo=ft[1],d(Fn,r?yo:void 0),!(Tt&&O)){Br.next=37;break}return Br.next=36,Jf(0);case 36:M(!1);case 37:case"end":return Br.stop()}},Pe)}));return function(Me,Ze,or){return wr.apply(this,arguments)}}(),er=function(){var wr=_asyncToGenerator(_regeneratorRuntime.mark(function Pe(Me,Ze,or){var Dr,Nr,hr;return _regeneratorRuntime.wrap(function(Ur){for(;;)switch(Ur.prev=Ur.next){case 0:if(Dr=m==="mui"&&or==="reset",Nr=Ze,!(Nr===b||Nr===A||Dr)){Ur.next=4;break}return Ur.abrupt("return");case 4:if(Ze==ve){Ur.next=13;break}if(ce(Nr),hr=o&&(u?!!Nr:!0),!hr){Ur.next=12;break}return Ur.next=10,ot(Nr);case 10:Ur.next=13;break;case 12:o&&u&&Re([]);case 13:case"end":return Ur.stop()}},Pe)}));return function(Me,Ze,or){return wr.apply(this,arguments)}}(),rt=function(Pe){var Me=_toConsumableArray(Pe);return a&&(_t?Me.push({specialValue:"LOAD_MORE",title:b}):de&&Me.push({specialValue:"LOADING_MORE",title:A,disabled:!0})),Me},qr=function(Pe,Me){if(Me==null)return null;var Ze=Me.value!=null?Me.value:Me;return Pe.value===Ze},qt=function(Pe){return Pe&&Pe.disabled},Ct=function(Pe){var Me;if(Pe!=null&&Pe.isCustom)return!0;var Ze=(Me=Pe?.value)!==null&&Me!==void 0?Me:Pe,or=vo(Ze,Be);return or?.isCustom||!1},Nn=function(Pe){if(Pe==null)return null;var Me=Pe.value!=null?Pe:zf(vo(Pe,Be));return!Me&&Pe.specialValue?Pe.title:!Me&&s||!Me?Pe:Me.title||Me.label||Me.value},Rt=m==="mui"?PO(St):St;return{options:Rt,listValues:Be,hasValue:Ft,selectedListValue:ht,open:N,onOpen:Jr,onClose:cn,onDropdownVisibleChange:dn,onChange:Vr,inputValue:ve,onInputChange:er,canShowLoadMore:_t,isInitialLoading:rr,isLoading:nr,isLoadingMore:de,isSpecialValue:it,extendOptions:rt,getOptionSelected:qr,getOptionDisabled:qt,getOptionIsCustom:Ct,getOptionLabel:Nn,aPlaceholder:L}};const zb=null;function qf(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Qf(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?qf(Object(t),!0).forEach(function(r){(0,te.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):qf(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}const Dn=Qf(Qf({},Je),{},{ReactUtils:_e,DragIcon:bd});var Yf=h(47232),DO=h(63383);const Zi={add:"Add",remove:"Remove"},Xf={id:Dn.uuid(),type:"group"},Zf="timeFilter",ep=[Zf],NO={...$r.widgets,text:{...$r.widgets.text,factory:function(e){return(0,D.jsx)(En.p,{value:e?.value||"",placeholder:e?.placeholder,onChange:t=>e?.setValue(t.currentTarget.value)})}},number:{...$r.widgets.number,factory:function(e){return(0,D.jsx)(En.p,{value:e?.value,placeholder:e?.placeholder,type:"number",onChange:t=>e?.setValue(Number.parseInt(t.currentTarget.value,10))})}},datetime:{...$r.widgets.datetime,factory:function(e){if(e?.operator==="macros")return(0,D.jsx)(pt.l6,{id:e.id,"aria-label":"Macros value selector",menuShouldPortal:!0,options:ep.map(Ee.z),value:e?.value,onChange:r=>e.setValue(r.value)});const t=(0,Yf.KQ)(e?.value).isValid()?(0,Yf.KQ)(e?.value).utc():void 0;return(0,D.jsx)(DO.K,{onChange:r=>{e?.setValue(r?.format($r.widgets.datetime.valueFormat))},date:t})},sqlFormatValue:(n,e,t,r,a,o)=>r==="macros"?ep.includes(n)?n:void 0:typeof $r.widgets.datetime.sqlFormatValue=="string"||typeof $r.widgets.datetime.sqlFormatValue=="object"?void 0:$r.widgets.datetime.sqlFormatValue?.call($r.ctx,n,e,t,r,a,o)||""}},kO={...$r.settings,canRegroup:!1,maxNesting:1,canReorder:!1,showNot:!1,addRuleLabel:Zi.add,deleteLabel:Zi.remove,renderConjs:function(e){return(0,D.jsx)(pt.l6,{id:e?.id,"aria-label":"Conjunction","data-testid":Kr.Tp.components.SQLQueryEditor.filterConjunction,menuShouldPortal:!0,options:e?.conjunctionOptions?Object.keys(e?.conjunctionOptions).map(Ee.z):void 0,value:e?.selectedConjunction,onChange:t=>e?.setConjunction(t.value)})},renderField:function(e){const t=e?.config?.fields||{};return(0,D.jsx)(pt.l6,{id:e?.id,width:25,"aria-label":"Field","data-testid":Kr.Tp.components.SQLQueryEditor.filterField,menuShouldPortal:!0,options:e?.items.map(r=>{const a=t[r.key].mainWidgetProps?.customProps?.icon;return{label:r.label,value:r.key,icon:a}}),value:e?.selectedKey,onChange:r=>{e?.setField(r.label)}})},renderButton:function(e){return(0,D.jsx)(It.$n,{type:"button",title:`${e?.label} filter`,onClick:e?.onClick,variant:"secondary",size:"md",icon:e?.label===Zi.add?"plus":"times"})},renderOperator:function(e){return(0,D.jsx)(pt.l6,{options:e?.items.map(t=>({label:t.label,value:t.key})),"aria-label":"Operator","data-testid":Kr.Tp.components.SQLQueryEditor.filterOperator,menuShouldPortal:!0,value:e?.selectedKey,onChange:t=>{e?.setField(t.value||"")}})}};var MO=(n=>(n.IN="select_any_in",n.NOT_IN="select_not_any_in",n.MACROS="macros",n))(MO||{});const _O=WO($r),rp=$r.types.text.widgets.text,GO=[...rp.operators||[],"select_any_in","select_not_any_in"],$O={...rp,operators:GO},UO={...$r.types,text:{...$r.types.text,widgets:{...$r.types.text.widgets,text:$O}},datetime:{...$r.types.datetime,widgets:{...$r.types.datetime.widgets,datetime:{...$r.types.datetime.widgets.datetime,operators:["macros",...$r.types.datetime.widgets.datetime.operators||[]]}}}},BO={...$r,widgets:NO,settings:kO,operators:_O,types:UO},tp=()=>"",np=n=>typeof n=="function";function WO(n){const{...e}=n.operators,t=()=>{const i=e.select_any_in.sqlFormatOp;return np(i)?i:tp},r=(i,l,s,c,d,f,p,v)=>t()(i,l,ap(s),c,d,f,p,v),a=()=>{const i=e.select_not_any_in.sqlFormatOp;return np(i)?i:tp},o=(i,l,s,c,d,f,p,v)=>a()(i,l,ap(s),c,d,f,p,v);return{...e,select_any_in:{...e.select_any_in,sqlFormatOp:r},select_not_any_in:{...e.select_not_any_in,sqlFormatOp:o},macros:{label:"Macros",sqlFormatOp:(i,l,s)=>s===Zf?`$__timeFilter(${i})`:s}}}function ap(n){return(0,De.isString)(n)?n.split(","):n}function KO({sql:n,config:e,onSqlChange:t}){const[r,a]=(0,F.useState)(),o=(0,F.useMemo)(()=>({...BO,...e}),[e]);(0,F.useEffect)(()=>{if(!r){const i=Dn.checkTree(Dn.loadTree(n.whereJsonTree??Xf),o);a(i)}},[o,n.whereJsonTree,r]),(0,F.useEffect)(()=>{n.whereJsonTree||a(Dn.checkTree(Dn.loadTree(Xf),o))},[o,n.whereJsonTree]);const u=(0,F.useCallback)((i,l)=>{a(i);const s={...n,whereJsonTree:Dn.getTree(i),whereString:Dn.sqlFormat(i,l)};t(s)},[t,n]);return r?(0,D.jsx)(dd,{...o,value:r,onChange:u,renderBuilder:i=>(0,D.jsx)(q0,{...i})}):null}function go(n){return`
    display: flex;
    gap: 8px;
    flex-direction: ${n};`}(0,zr.injectGlobal)`
  .group--header {
    ${go("row")}
  }

  .group-or-rule {
    ${go("column")}
    .rule {
      flex-direction: row;
    }
  }

  .rule--body {
    ${go("row")}
  }

  .group--children {
    ${go("column")}
  }

  .group--conjunctions:empty {
    display: none;
  }
`;function HO({query:n,fields:e,onQueryChange:t,db:r}){const a=(0,cp.A)(async()=>zO(e),[e]),{onSqlChange:o}=Vt({query:n,onQueryChange:t,db:r});return(0,D.jsx)(KO,{config:{fields:a.value||{}},sql:n.sql,onSqlChange:u=>{const i=(0,ye.w)().getVariables();JO(u,i),o(u)}},JSON.stringify(a.value))}function zO(n){const e={};for(const t of n)e[t.value]={type:t.raqbFieldType||"text",valueSources:["value"],mainWidgetProps:{customProps:{icon:t.icon}}};return e}function JO(n,e){const t=r=>"multi"in r&&r.multi&&(n.whereString?.includes(`\${${r.name}}`)||n.whereString?.includes(`$${r.name}`));e.some(r=>t(r))&&(n.whereString=n.whereString?.replaceAll("')",")"),n.whereString=n.whereString?.replaceAll("('","("))}const qO=({query:n,db:e,queryRowFilter:t,onChange:r,onValidate:a,range:o})=>{const u=(0,Xe.A)(async()=>await e.fields(n),[e,n.dataset,n.table]);return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)(Ir.D,{children:[(0,D.jsx)(en.U,{children:(0,D.jsx)(nt,{fields:u.value||[],query:n,onQueryChange:r,db:e})}),t.filter&&(0,D.jsx)(en.U,{children:(0,D.jsx)(Ot.c,{label:"Filter by column value",optional:!0,children:(0,D.jsx)(HO,{fields:u.value||[],query:n,onQueryChange:r,db:e})})}),t.group&&(0,D.jsx)(en.U,{children:(0,D.jsx)(Ot.c,{label:"Group by column",children:(0,D.jsx)(Zr,{fields:u.value||[],query:n,onQueryChange:r,db:e})})}),t.order&&(0,D.jsx)(en.U,{children:(0,D.jsx)(fa,{fields:u.value||[],query:n,onQueryChange:r,db:e})}),t.preview&&n.rawSql&&(0,D.jsx)(en.U,{children:(0,D.jsx)(vt.l,{rawSql:n.rawSql,datasourceType:n.datasource?.type})})]}),(0,D.jsx)(Na,{db:e,query:n,onValidate:a,range:o})]})};function op({datasource:n,query:e,onChange:t,onRunQuery:r,range:a,queryHeaderProps:o}){const[u,i]=(0,F.useState)(!0),l=n.getDB(),{preconfiguredDatabase:s}=n,c=o?.dialect??"other",{loading:d,error:f}=(0,Xe.A)(async()=>()=>{n.getDB(n.id).init!==void 0&&n.getDB(n.id).init()},[n]),p=Zt(e),[v,g]=(0,F.useState)({filter:!!p.sql?.whereString,group:!!p.sql?.groupBy?.[0]?.property.name,order:!!p.sql?.orderBy?.property.name,preview:!0}),[m,O]=(0,F.useState)(p);(0,F.useEffect)(()=>()=>{n.getDB(n.id).dispose!==void 0&&n.getDB(n.id).dispose()},[n]);const y=(0,F.useCallback)(L=>{QO(L)&&r&&r()},[r]),b=(L,S=!0)=>{O(L),t(L),xt(L.sql?.columns)&&L.sql?.columns.some(R=>R.name)&&!v.group&&g({...v,group:!0}),S&&y(L)},A=L=>{O(L),t(L)};return d||f?null:(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(Eo,{db:l,preconfiguredDataset:s,onChange:A,onRunQuery:r,onQueryRowChange:g,queryRowFilter:v,query:p,isQueryRunnable:u,dialect:c}),(0,D.jsx)(lt.$,{v:.5}),p.editorMode!==pr.lX.Code&&(0,D.jsx)(qO,{db:l,query:p,onChange:L=>b(L,!1),queryRowFilter:v,onValidate:i,range:a}),p.editorMode===pr.lX.Code&&(0,D.jsx)(wo,{db:l,query:p,queryToValidate:m,onChange:b,onRunQuery:r,onValidate:i,range:a})]})}const QO=n=>!!n.rawSql;function YO(n){const e=typeof n.rawQuery=="string"?n.rawQuery:null;if(!e)return n;const t=Zt({refId:"Annotation",...n.target??{},rawSql:e});return{...n,rawQuery:void 0,workspace:void 0,subscription:void 0,queryType:void 0,target:t}}class XO extends tt.iy{constructor(e,t=(0,ye.w)()){super(e),this.templateSrv=t,this.interpolateVariable=(a,o)=>typeof a=="string"?o.multi||o.includeAll?this.getQueryModel().quoteLiteral(a):String(a).replace(/'/g,"''"):typeof a=="number"?a:Array.isArray(a)?a.map(i=>this.getQueryModel().quoteLiteral(i)).join(","):a,this.name=e.name,this.responseParser=new oe,this.id=e.id;const r=e.jsonData||{};this.interval=r.timeInterval||"1m",this.db=this.getDB(),this.preconfiguredDatabase=r.database??"",this.annotations={prepareAnnotation:YO,QueryEditor:op}}getResponseParser(){return this.responseParser}interpolateVariablesInQueries(e,t){let r=e;return e&&e.length>0&&(r=e.map(a=>({...a,datasource:this.getRef(),rawSql:this.templateSrv.replace(a.rawSql,t,this.interpolateVariable),rawQuery:!0}))),r}filterQuery(e){return!e.hide}applyTemplateVariables(e,t){return{refId:e.refId,datasource:this.getRef(),rawSql:this.templateSrv.replace(e.rawSql,t,this.interpolateVariable),format:e.format}}query(e){if(Cn()){const t=this.checkForDatabaseIssue(e);if(t){const r=new Error(t);return(0,lr.$)(()=>r)}}return e.targets.forEach(t=>{e.app===sr.Jk.Dashboard||e.app===sr.Jk.PanelViewer||(0,ie.rR)("grafana_sql_query_executed",{datasource:t.datasource?.type,editorMode:t.editorMode,format:t.format,app:e.app})}),super.query(e)}checkForDatabaseIssue(e){if(this.type==="postgres"&&!this.preconfiguredDatabase)return`You do not currently have a default database configured for this data source. Postgres requires a default
             database with which to connect. Please configure one through the Data Sources Configuration page, or if you
             are using a provisioning file, update that configuration file with a default database.`;if(e.app!==sr.Jk.Explore&&this.preconfiguredDatabase){for(const t of e.targets)if(t.editorMode===pr.lX.Builder&&t.dataset!==this.preconfiguredDatabase)return`The configuration for this panel's data source has been modified. The previous database used in this panel's
                   saved query is no longer available. Please update the query to use the new database option.
                   Previous query parameters will be preserved until the query is updated.`}}async metricFindQuery(e,t){const r=t?.range;if(r==null)return[];let a="tempvar";t&&t.variable&&t.variable.name&&(a=t.variable.name);const o={...t?.scopedVars,...(0,jr.c)({query:e,wildcardChar:"%",options:t})},u=this.templateSrv.replace(e,o,this.interpolateVariable),i={refId:a,datasource:this.getRef(),rawSql:u,format:me.Table};let l;try{l=await this.runMetaQuery(i,r)}catch(s){throw console.error(s),new Error("error when executing the sql query")}return this.getResponseParser().transformMetricFindResponse(l)}async runSql(e,t){const r=(0,Yr.E2)(),a=await this.runMetaQuery({rawSql:e,format:me.Table,refId:t?.refId},r);return new yt.R(a)}runMetaQuery(e,t){const r=e.refId||"meta",a=[{...e,datasource:e.datasource||this.getRef(),refId:r}];return(0,ke.s)((0,pe.AI)().fetch({url:"/api/ds/query",method:"POST",headers:this.getRequestHeaders(),data:{from:t.from.valueOf().toString(),to:t.to.valueOf().toString(),queries:a},requestId:r}).pipe((0,ze.T)(o=>(0,Ie.bE)(o,a).data[0]??{fields:[]})))}targetContainsTemplate(e){let t=e.rawSql;return gt.forEach(r=>{t=t?.replace(r,"")||""}),this.templateSrv.containsTemplate(t)}}var ZO=h(94471),eb=h(29020),mo=h(88575),ho=h(60029),rb=h(76892);function eu({value:n,defaultValue:e,onChange:t,width:r}){const[a,o]=(0,F.useState)(!1);return(0,D.jsx)(En.p,{type:"number",placeholder:String(e),value:a?"":n,onChange:u=>{if(u.currentTarget.value?.trim()==="")o(!0),t(e);else{o(!1);const i=Number(u.currentTarget.value);Number.isNaN(i)||t(i)}},width:r})}const tb=n=>{const{onOptionsChange:e,options:t}=n,r=t.jsonData,a=r.maxIdleConnsAuto!==void 0?r.maxIdleConnsAuto:!1,o=c=>{const d={...t,jsonData:{...r,...c}};return e(d)},u=c=>d=>{o({[c]:d})},i=c=>{o(a&&c?{maxOpenConns:c,maxIdleConns:c}:{maxOpenConns:c})},l=()=>{let c,d;a?(d=r.maxOpenConns,c=r.maxIdleConns):r.maxOpenConns!==void 0&&(d=r.maxOpenConns,c=r.maxOpenConns),o({maxIdleConnsAuto:!a,maxIdleConns:c,maxOpenConns:d})},s=40;return(0,D.jsxs)(eb.I,{title:"Connection limits",children:[(0,D.jsx)(mo.D,{label:(0,D.jsx)(ho.J,{children:(0,D.jsxs)(_.B,{gap:.5,children:[(0,D.jsx)("span",{children:"Max open"}),(0,D.jsx)(rn.m,{content:(0,D.jsxs)("span",{children:["The maximum number of open connections to the database. If ",(0,D.jsx)("i",{children:"Max idle connections"})," is greater than 0 and the ",(0,D.jsx)("i",{children:"Max open connections"})," is less than ",(0,D.jsx)("i",{children:"Max idle connections"}),", then",(0,D.jsx)("i",{children:"Max idle connections"})," will be reduced to match the ",(0,D.jsx)("i",{children:"Max open connections"})," limit. If set to 0, there is no limit on the number of open connections."]}),children:(0,D.jsx)(tn.I,{name:"info-circle",size:"sm"})})]})}),children:(0,D.jsx)(eu,{value:r.maxOpenConns,defaultValue:nn.$.sqlConnectionLimits.maxOpenConns,onChange:c=>{i(c)},width:s})}),(0,D.jsx)(mo.D,{label:(0,D.jsx)(ho.J,{children:(0,D.jsxs)(_.B,{gap:.5,children:[(0,D.jsx)("span",{children:"Auto max idle"}),(0,D.jsx)(rn.m,{content:(0,D.jsxs)("span",{children:["If enabled, automatically set the number of ",(0,D.jsx)("i",{children:"Maximum idle connections"})," to the same value as",(0,D.jsx)("i",{children:" Max open connections"}),". If the number of maximum open connections is not set it will be set to the default (",nn.$.sqlConnectionLimits.maxIdleConns,")."]}),children:(0,D.jsx)(tn.I,{name:"info-circle",size:"sm"})})]})}),children:(0,D.jsx)(vn.d,{value:a,onChange:l})}),(0,D.jsx)(mo.D,{label:(0,D.jsx)(ho.J,{children:(0,D.jsxs)(_.B,{gap:.5,children:[(0,D.jsx)("span",{children:"Max idle"}),(0,D.jsx)(rn.m,{content:(0,D.jsxs)("span",{children:["The maximum number of connections in the idle connection pool.If ",(0,D.jsx)("i",{children:"Max open connections"})," is greater than 0 but less than the ",(0,D.jsx)("i",{children:"Max idle connections"}),", then the ",(0,D.jsx)("i",{children:"Max idle connections"})," ","will be reduced to match the ",(0,D.jsx)("i",{children:"Max open connections"})," limit. If set to 0, no idle connections are retained."]}),children:(0,D.jsx)(tn.I,{name:"info-circle",size:"sm"})})]})}),children:a?(0,D.jsx)(rb.c,{width:s,children:t.jsonData.maxIdleConns}):(0,D.jsx)(eu,{value:r.maxIdleConns,defaultValue:nn.$.sqlConnectionLimits.maxIdleConns,onChange:c=>{u("maxIdleConns")(c)},width:s})}),(0,D.jsx)(mo.D,{label:(0,D.jsx)(ho.J,{children:(0,D.jsxs)(_.B,{gap:.5,children:[(0,D.jsx)("span",{children:"Max lifetime"}),(0,D.jsx)(rn.m,{content:(0,D.jsx)("span",{children:"The maximum amount of time in seconds a connection may be reused. If set to 0, connections are reused forever."}),children:(0,D.jsx)(tn.I,{name:"info-circle",size:"sm"})})]})}),children:(0,D.jsx)(eu,{value:r.connMaxLifetime,defaultValue:nn.$.sqlConnectionLimits.connMaxLifetime,onChange:c=>{u("connMaxLifetime")(c)},width:s})})]})},Jb=()=>{const n=useStyles2(nb);return jsx("hr",{className:n.horizontalDivider})},nb=n=>({horizontalDivider:css({borderTop:`1px solid ${n.colors.border.weak}`,margin:n.spacing(2,0),width:"100%"})}),qb=n=>{const{editorProps:e,showCACert:t,showKeyPair:r=!0}=n,{secureJsonFields:a}=e.options;return jsxs(Fragment,{children:[r?jsx(Field,{label:jsx(Label,{children:jsxs(Stack,{gap:.5,children:[jsx("span",{children:"TLS/SSL Client Certificate"}),jsx(Tooltip,{content:jsx("span",{children:"To authenticate with an TLS/SSL client certificate, provide the client certificate here."}),children:jsx(Icon,{name:"info-circle",size:"sm"})})]})}),children:jsx(SecretTextArea,{placeholder:"-----BEGIN CERTIFICATE-----",cols:45,rows:7,isConfigured:a&&a.tlsClientCert,onChange:onUpdateDatasourceSecureJsonDataOption(e,"tlsClientCert"),onReset:()=>{updateDatasourcePluginResetOption(e,"tlsClientCert")}})}):null,t?jsx(Field,{label:jsx(Label,{children:jsxs(Stack,{gap:.5,children:[jsx("span",{children:"TLS/SSL Root Certificate"}),jsx(Tooltip,{content:jsx("span",{children:"If the selected TLS/SSL mode requires a server root certificate, provide it here."}),children:jsx(Icon,{name:"info-circle",size:"sm"})})]})}),children:jsx(SecretTextArea,{placeholder:"-----BEGIN CERTIFICATE-----",cols:45,rows:7,isConfigured:a&&a.tlsCACert,onChange:onUpdateDatasourceSecureJsonDataOption(e,"tlsCACert"),onReset:()=>{updateDatasourcePluginResetOption(e,"tlsCACert")}})}):null,r?jsx(Field,{label:jsx(Label,{children:jsxs(Stack,{gap:.5,children:[jsx("span",{children:"TLS/SSL Client Key"}),jsx(Tooltip,{content:jsx("span",{children:"To authenticate with a client TLS/SSL certificate, provide the key here."}),children:jsx(Icon,{name:"info-circle",size:"sm"})})]})}),children:jsx(SecretTextArea,{placeholder:"-----BEGIN RSA PRIVATE KEY-----",cols:45,rows:7,isConfigured:a&&a.tlsClientKey,onChange:onUpdateDatasourceSecureJsonDataOption(e,"tlsClientKey"),onReset:()=>{updateDatasourcePluginResetOption(e,"tlsClientKey")}})}):null]})};var ab=h(34867);const ip=(0,ab.DW)("features.plugins.sql");function ob({onOptionsChange:n,options:e}){(0,F.useEffect)(()=>{const t=e.jsonData;let r={...e},a=!1;if(e.database&&(ip.logDebug(`Migrating from options.database with value ${e.database} for ${e.name}`),r.database="",r.jsonData={...t,database:e.database},a=!0),t.maxOpenConns===void 0&&t.maxIdleConns===void 0&&t.maxIdleConnsAuto===void 0){const{maxOpenConns:o,maxIdleConns:u}=nn.$.sqlConnectionLimits;ip.logDebug(`Setting default max open connections to ${o} and setting max idle connection to ${u}`),r.jsonData={...r.jsonData,maxOpenConns:o,maxIdleConns:u,maxIdleConnsAuto:!0},a=!0}if(t.connMaxLifetime===void 0){const{connMaxLifetime:o}=nn.$.sqlConnectionLimits;r.jsonData={...r.jsonData,connMaxLifetime:o},a=!0}a&&n(r)},[n,e])}},18678:function(we,ge,h){var V,E;(function(P,$){V=$,E=typeof V=="function"?V.call(ge,h,ge,we):V,E!==void 0&&(we.exports=E)})(this,function(){"use strict";Array.isArray||(Array.isArray=function(C){return Object.prototype.toString.call(C)==="[object Array]"});function P(C){for(var T=[],I=0,w=C.length;I<w;I++)T.indexOf(C[I])===-1&&T.push(C[I]);return T}var $={},H={"==":function(C,T){return C==T},"===":function(C,T){return C===T},"!=":function(C,T){return C!=T},"!==":function(C,T){return C!==T},">":function(C,T){return C>T},">=":function(C,T){return C>=T},"<":function(C,T,I){return I===void 0?C<T:C<T&&T<I},"<=":function(C,T,I){return I===void 0?C<=T:C<=T&&T<=I},"!!":function(C){return $.truthy(C)},"!":function(C){return!$.truthy(C)},"%":function(C,T){return C%T},log:function(C){return console.log(C),C},in:function(C,T){return!T||typeof T.indexOf>"u"?!1:T.indexOf(C)!==-1},cat:function(){return Array.prototype.join.call(arguments,"")},substr:function(C,T,I){if(I<0){var w=String(C).substr(T);return w.substr(0,w.length+I)}return String(C).substr(T,I)},"+":function(){return Array.prototype.reduce.call(arguments,function(C,T){return parseFloat(C,10)+parseFloat(T,10)},0)},"*":function(){return Array.prototype.reduce.call(arguments,function(C,T){return parseFloat(C,10)*parseFloat(T,10)})},"-":function(C,T){return T===void 0?-C:C-T},"/":function(C,T){return C/T},min:function(){return Math.min.apply(this,arguments)},max:function(){return Math.max.apply(this,arguments)},merge:function(){return Array.prototype.reduce.call(arguments,function(C,T){return C.concat(T)},[])},var:function(C,T){var I=T===void 0?null:T,w=this;if(typeof C>"u"||C===""||C===null)return w;for(var U=String(C).split("."),Y=0;Y<U.length;Y++)if(w==null||(w=w[U[Y]],w===void 0))return I;return w},missing:function(){for(var C=[],T=Array.isArray(arguments[0])?arguments[0]:arguments,I=0;I<T.length;I++){var w=T[I],U=$.apply({var:w},this);(U===null||U==="")&&C.push(w)}return C},missing_some:function(C,T){var I=$.apply({missing:T},this);return T.length-I.length>=C?[]:I}};return $.is_logic=function(C){return typeof C=="object"&&C!==null&&!Array.isArray(C)&&Object.keys(C).length===1},$.truthy=function(C){return Array.isArray(C)&&C.length===0?!1:!!C},$.get_operator=function(C){return Object.keys(C)[0]},$.get_values=function(C){return C[$.get_operator(C)]},$.apply=function(C,T){if(Array.isArray(C))return C.map(function(he){return $.apply(he,T)});if(!$.is_logic(C))return C;var I=$.get_operator(C),w=C[I],U,Y,Z,q,X;if(Array.isArray(w)||(w=[w]),I==="if"||I=="?:"){for(U=0;U<w.length-1;U+=2)if($.truthy($.apply(w[U],T)))return $.apply(w[U+1],T);return w.length===U+1?$.apply(w[U],T):null}else if(I==="and"){for(U=0;U<w.length;U+=1)if(Y=$.apply(w[U],T),!$.truthy(Y))return Y;return Y}else if(I==="or"){for(U=0;U<w.length;U+=1)if(Y=$.apply(w[U],T),$.truthy(Y))return Y;return Y}else{if(I==="filter")return q=$.apply(w[0],T),Z=w[1],Array.isArray(q)?q.filter(function(he){return $.truthy($.apply(Z,he))}):[];if(I==="map")return q=$.apply(w[0],T),Z=w[1],Array.isArray(q)?q.map(function(he){return $.apply(Z,he)}):[];if(I==="reduce")return q=$.apply(w[0],T),Z=w[1],X=typeof w[2]<"u"?w[2]:null,Array.isArray(q)?q.reduce(function(he,_e){return $.apply(Z,{current:_e,accumulator:he})},X):X;if(I==="all"){if(q=$.apply(w[0],T),Z=w[1],!Array.isArray(q)||!q.length)return!1;for(U=0;U<q.length;U+=1)if(!$.truthy($.apply(Z,q[U])))return!1;return!0}else if(I==="none"){if(q=$.apply(w[0],T),Z=w[1],!Array.isArray(q)||!q.length)return!0;for(U=0;U<q.length;U+=1)if($.truthy($.apply(Z,q[U])))return!1;return!0}else if(I==="some"){if(q=$.apply(w[0],T),Z=w[1],!Array.isArray(q)||!q.length)return!1;for(U=0;U<q.length;U+=1)if($.truthy($.apply(Z,q[U])))return!0;return!1}}if(w=w.map(function(he){return $.apply(he,T)}),H.hasOwnProperty(I)&&typeof H[I]=="function")return H[I].apply(T,w);if(I.indexOf(".")>0){var le=String(I).split("."),z=H;for(U=0;U<le.length;U++){if(!z.hasOwnProperty(le[U]))throw new Error("Unrecognized operation "+I+" (failed at "+le.slice(0,U+1).join(".")+")");z=z[le[U]]}return z.apply(T,w)}throw new Error("Unrecognized operation "+I)},$.uses_data=function(C){var T=[];if($.is_logic(C)){var I=$.get_operator(C),w=C[I];Array.isArray(w)||(w=[w]),I==="var"?T.push(w[0]):w.forEach(function(U){T.push.apply(T,$.uses_data(U))})}return P(T)},$.add_operation=function(C,T){H[C]=T},$.rm_operation=function(C){delete H[C]},$.rule_like=function(C,T){if(T===C||T==="@")return!0;if(T==="number")return typeof C=="number";if(T==="string")return typeof C=="string";if(T==="array")return Array.isArray(C)&&!$.is_logic(C);if($.is_logic(T)){if($.is_logic(C)){var I=$.get_operator(T),w=$.get_operator(C);if(I==="@"||I===w)return $.rule_like($.get_values(C,!1),$.get_values(T,!1))}return!1}if(Array.isArray(T))if(Array.isArray(C)){if(T.length!==C.length)return!1;for(var U=0;U<T.length;U+=1)if(!$.rule_like(C[U],T[U]))return!1;return!0}else return!1;return!1},$})},87805:(we,ge,h)=>{var V=h(43360),E=h(75288);function P($,H,C){(C!==void 0&&!E($[H],C)||C===void 0&&!(H in $))&&V($,H,C)}we.exports=P},85250:(we,ge,h)=>{var V=h(37217),E=h(87805),P=h(86649),$=h(42824),H=h(23805),C=h(37241),T=h(14974);function I(w,U,Y,Z,q){w!==U&&P(U,function(X,le){if(q||(q=new V),H(X))$(w,U,le,Y,I,Z,q);else{var z=Z?Z(T(w,le),X,le+"",w,U,q):void 0;z===void 0&&(z=X),E(w,le,z)}},C)}we.exports=I},42824:(we,ge,h)=>{var V=h(87805),E=h(93290),P=h(71961),$=h(23007),H=h(35529),C=h(72428),T=h(56449),I=h(83693),w=h(3656),U=h(1882),Y=h(23805),Z=h(11331),q=h(37167),X=h(14974),le=h(69884);function z(he,_e,Ke,xe,Ee,me,He){var Ne=X(he,Ke),Qe=X(_e,Ke),lr=He.get(Qe);if(lr){V(he,Ke,lr);return}var ke=me?me(Ne,Qe,Ke+"",he,_e,He):void 0,ze=ke===void 0;if(ze){var sr=T(Qe),jr=!sr&&w(Qe),Yr=!sr&&!jr&&q(Qe);ke=Qe,sr||jr||Yr?T(Ne)?ke=Ne:I(Ne)?ke=$(Ne):jr?(ze=!1,ke=E(Qe,!0)):Yr?(ze=!1,ke=P(Qe,!0)):ke=[]:Z(Qe)||C(Qe)?(ke=Ne,C(Ne)?ke=le(Ne):(!Y(Ne)||U(Ne))&&(ke=H(Qe))):ze=!1}ze&&(He.set(Qe,ke),Ee(ke,Qe,xe,me,He),He.delete(Qe)),V(he,Ke,ke)}we.exports=z},69302:(we,ge,h)=>{var V=h(83488),E=h(56757),P=h(32865);function $(H,C){return P(E(H,C,V),H+"")}we.exports=$},20999:(we,ge,h)=>{var V=h(69302),E=h(36800);function P($){return V(function(H,C){var T=-1,I=C.length,w=I>1?C[I-1]:void 0,U=I>2?C[2]:void 0;for(w=$.length>3&&typeof w=="function"?(I--,w):void 0,U&&E(C[0],C[1],U)&&(w=I<3?void 0:w,I=1),H=Object(H);++T<I;){var Y=C[T];Y&&$(H,Y,T,w)}return H})}we.exports=P},14974:we=>{function ge(h,V){if(!(V==="constructor"&&typeof h[V]=="function")&&V!="__proto__")return h[V]}we.exports=ge},83693:(we,ge,h)=>{var V=h(64894),E=h(40346);function P($){return E($)&&V($)}we.exports=P},73916:(we,ge,h)=>{var V=h(43360),E=h(30641),P=h(15389);function $(H,C){var T={};return C=P(C,3),E(H,function(I,w,U){V(T,w,C(I,w,U))}),T}we.exports=$},55364:(we,ge,h)=>{var V=h(85250),E=h(20999),P=E(function($,H,C){V($,H,C)});we.exports=P},6924:(we,ge,h)=>{var V=h(85250),E=h(20999),P=E(function($,H,C,T){V($,H,C,T)});we.exports=P},71086:(we,ge,h)=>{var V=h(34932),E=h(15389),P=h(97420),$=h(83349);function H(C,T){if(C==null)return{};var I=V($(C),function(w){return[w]});return T=E(T),P(C,I,function(w,U){return T(w,U[0])})}we.exports=H},22331:(we,ge,h)=>{var V=h(87133),E=h(77556),P=h(61489),$=h(13222);function H(C,T,I){return C=$(C),I=I==null?0:V(P(I),0,C.length),T=E(T),C.slice(I,I+T.length)==T}we.exports=H},69884:(we,ge,h)=>{var V=h(21791),E=h(37241);function P($){return V($,E($))}we.exports=P},21450:function(we){(function(h,V){we.exports=V()})(this,function(){return function(ge){var h={};function V(E){if(h[E])return h[E].exports;var P=h[E]={i:E,l:!1,exports:{}};return ge[E].call(P.exports,P,P.exports,V),P.l=!0,P.exports}return V.m=ge,V.c=h,V.d=function(E,P,$){V.o(E,P)||Object.defineProperty(E,P,{configurable:!1,enumerable:!0,get:$})},V.n=function(E){var P=E&&E.__esModule?function(){return E.default}:function(){return E};return V.d(P,"a",P),P},V.o=function(E,P){return Object.prototype.hasOwnProperty.call(E,P)},V.p="",V(V.s=3)}([function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0});function E($,H){var C={},T=$||"Abstract",I=[],w=null,U;if(C._type=T,C.getType=function(){return T},C.setType=function(X){T=X},C.getChildren=function(){return I},C.addChild=function(X){if(X){if(!X.setParent)throw{name:"Error",message:"Trying to add a child which is not a node: "+JSON.stringify(X)};X.setParent(C),I.push(X)}},C.getParent=function(){return w},C.setParent=function(X){w=X},C.getContext=function(X){return U||X.activeContext.peek()},C.setContext=function(X){U=X},C.getStartPosition=function(){return H>>16},C.getEndPosition=function(){return H&65535},C.getValue=function(){throw{name:"MethodNotImplementedException",message:"SpelNode#getValue() must be overridden."}},C.toString=function(){var X="Kind: "+C.getType();X+=", Children: [";for(var le=0,z=C.getChildren().length;le<z;le+=1)X+="{"+C.getChildren()[le]+"}, ";return X+="]",X},H===0)throw{name:"Error",message:"Position cannot be 0"};for(var Y=arguments.length,Z=Array(Y>2?Y-2:0),q=2;q<Y;q++)Z[q-2]=arguments[q];return Z&&Z.forEach(function(X){C.addChild(X)}),C}var P=h.SpelNode={create:E}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.Stack=E;function E(P){this.elements=P||[]}E.prototype.push=function(P){return this.elements.push(P),P},E.prototype.pop=function(){return this.elements.pop()},E.prototype.peek=function(){return this.elements[this.elements.length-1]},E.prototype.empty=function(){return this.elements.length>0},E.prototype.search=function(P){return this.elements.length-this.elements.indexOf(P)}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var E={LITERAL_INT:1,LITERAL_LONG:2,LITERAL_HEXINT:3,LITERAL_HEXLONG:4,LITERAL_STRING:5,LITERAL_REAL:6,LITERAL_REAL_FLOAT:7,LPAREN:"(",RPAREN:")",COMMA:",",IDENTIFIER:0,COLON:":",HASH:"#",RSQUARE:"]",LSQUARE:"[",LCURLY:"{",RCURLY:"}",DOT:".",PLUS:"+",STAR:"*",MINUS:"-",SELECT_FIRST:"^[",SELECT_LAST:"$[",QMARK:"?",PROJECT:"![",DIV:"/",GE:">=",GT:">",LE:"<=",LT:"<",EQ:"==",NE:"!=",MOD:"%",NOT:"!",ASSIGN:"=",INSTANCEOF:"instanceof",MATCHES:"matches",BETWEEN:"between",SELECT:"?[",POWER:"^",ELVIS:"?:",SAFE_NAVI:"?.",BEAN_REF:"@",SYMBOLIC_OR:"||",SYMBOLIC_AND:"&&",INC:"++",DEC:"--"};function P(H){this.type=H,this.tokenChars=E[H],this._hasPayload=typeof E[H]!="string",typeof E[H]=="number"&&(this._ordinal=E[H])}for(var $ in E)E.hasOwnProperty($)&&(P[$]=new P($));P.prototype.toString=function(){return this.type+(this.tokenChars.length!==0?"("+this.tokenChars+")":"")},P.prototype.getLength=function(){return this.tokenChars.length},P.prototype.hasPayload=function(){return this._hasPayload},P.prototype.valueOf=function(H){for(var C in E)if(E.hasOwnProperty(C)&&E[C]===H)return P[C]},P.prototype.ordinal=function(){return this._ordinal},h.TokenKind=P},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.StandardContext=h.SpelExpressionEvaluator=void 0;var E=V(4),P=V(50);h.SpelExpressionEvaluator=E.SpelExpressionEvaluator,h.StandardContext=P.StandardContext},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.SpelExpressionEvaluator=void 0;var E=V(5),P=V(1),$={};function H(C,T,I){var w=new P.Stack,U;return T||(T={}),w.push(T),U={rootContext:T,activeContext:w,locals:I},C.getValue(U)}$.compile=function(C){var T=(0,E.SpelExpressionParser)().parse(C);return{eval:function(w,U){return H(T,w,U)},_compiledExpression:T}},$.eval=function(C,T,I){return $.compile(C).eval(T,I)},h.SpelExpressionEvaluator=$},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.SpelExpressionParser=void 0;var E=V(2),P=V(6),$=V(8),H=V(9),C=V(10),T=V(11),I=V(12),w=V(13),U=V(14),Y=V(15),Z=V(16),q=V(17),X=V(18),le=V(19),z=V(20),he=V(21),_e=V(22),Ke=V(23),xe=V(24),Ee=V(25),me=V(26),He=V(27),Ne=V(28),Qe=V(29),lr=V(30),ke=V(31),ze=V(32),sr=V(33),jr=V(34),Yr=V(35),yt=V(36),pr=V(37),tt=V(38),ye=V(39),ie=V(40),pe=V(41),Ie=V(42),De=V(43),oe=V(44),D=V(45),F=V(46),Xe=V(47),lt=V(48),Wr=V(49),yr=h.SpelExpressionParser=function(){var xt=new RegExp("[\\p{L}\\p{N}_$]+"),ia,ua=[],pn,Zt,la,Kr;function bo(_){ia=_}function So(_,ee){try{pn=_,Zt=P.Tokenizer.tokenize(_),la=Zt.length,Kr=0,ua=[];var Se=Xr();return mn()&&Zr(Tr().startPos,"MORE_INPUT",Or().toString()),Se}catch(We){throw We.message}}function Xr(){var _=en();if(mn()){var ee=Tr();if(ee.getKind()===E.TokenKind.ASSIGN){_===null&&(_=T.NullLiteral.create(gt(ee.startPos-1,ee.endPos-1))),Or();var Se=en();return X.Assign.create(Ge(ee),_,Se)}if(ee.getKind()===E.TokenKind.ELVIS){_===null&&(_=T.NullLiteral.create(gt(ee.startPos-1,ee.endPos-2))),Or();var We=Xr();return We===null&&(We=T.NullLiteral.create(gt(ee.startPos+1,ee.endPos+1))),tt.Elvis.create(Ge(ee),_,We)}if(ee.getKind()===E.TokenKind.QMARK){_===null&&(_=T.NullLiteral.create(gt(ee.startPos-1,ee.endPos-1))),Or();var st=Xr();xr(E.TokenKind.COLON);var nt=Xr();return pr.Ternary.create(Ge(ee),_,st,nt)}}return _}function en(){for(var _=Ot();Tn("or")||Ir(E.TokenKind.SYMBOLIC_OR);){var ee=Or(),Se=Ot();kn(ee,_,Se),_=Yr.OpOr.create(Ge(ee),_,Se)}return _}function Ot(){for(var _=vn();Tn("and")||Ir(E.TokenKind.SYMBOLIC_AND);){var ee=Or(),Se=vn();kn(ee,_,Se),_=jr.OpAnd.create(Ge(ee),_,Se)}return _}function vn(){var _=It(),ee=wo();if(ee!==null){var Se=Or(),We=It();kn(Se,_,We);var st=ee.kind;if(ee.isNumericRelationalOperator()){var nt=Ge(Se);return st===E.TokenKind.GT?_e.OpGT.create(nt,_,We):st===E.TokenKind.LT?xe.OpLT.create(nt,_,We):st===E.TokenKind.LE?Ke.OpLE.create(nt,_,We):st===E.TokenKind.GE?he.OpGE.create(nt,_,We):st===E.TokenKind.EQ?le.OpEQ.create(nt,_,We):z.OpNE.create(nt,_,We)}return st===E.TokenKind.INSTANCEOF?De.OpInstanceof.create(Ge(Se),_,We):st===E.TokenKind.MATCHES?yt.OpMatches.create(Ge(Se),_,We):oe.OpBetween.create(Ge(Se),_,We)}return _}function It(){for(var _=rn();Vt(E.TokenKind.PLUS,E.TokenKind.MINUS,E.TokenKind.INC);){var ee=Or(),Se=rn();fa(ee,Se),ee.getKind()===E.TokenKind.PLUS?_=Ee.OpPlus.create(Ge(ee),_,Se):ee.getKind()===E.TokenKind.MINUS&&(_=me.OpMinus.create(Ge(ee),_,Se))}return _}function rn(){for(var _=sa();Vt(E.TokenKind.STAR,E.TokenKind.DIV,E.TokenKind.MOD);){var ee=Or(),Se=sa();kn(ee,_,Se),ee.getKind()===E.TokenKind.STAR?_=He.OpMultiply.create(Ge(ee),_,Se):ee.getKind()===E.TokenKind.DIV?_=Ne.OpDivide.create(Ge(ee),_,Se):_=Qe.OpModulus.create(Ge(ee),_,Se)}return _}function sa(){var _=zr(),ee;if(Ir(E.TokenKind.POWER)){ee=Or();var Se=zr();return fa(ee,Se),lr.OpPower.create(Ge(ee),_,Se)}return _!==null&&Vt(E.TokenKind.INC,E.TokenKind.DEC)?(ee=Or(),ee.getKind()===E.TokenKind.INC?ke.OpInc.create(Ge(ee),!0,_):ze.OpDec.create(Ge(ee),!0,_)):_}function zr(){var _,ee;return Vt(E.TokenKind.PLUS,E.TokenKind.MINUS,E.TokenKind.NOT)?(_=Or(),ee=zr(),_.getKind()===E.TokenKind.NOT?sr.OpNot.create(Ge(_),ee):_.getKind()===E.TokenKind.PLUS?Ee.OpPlus.create(Ge(_),ee):me.OpMinus.create(Ge(_),ee)):Vt(E.TokenKind.INC,E.TokenKind.DEC)?(_=Or(),ee=zr(),_.getKind()===E.TokenKind.INC?ke.OpInc.create(Ge(_),!1,ee):ze.OpDec.create(Ge(_),!1,ee)):gn()}function gn(){var _=[],ee=Co();for(_.push(ee);ca();)_.push(Lt());return _.length===1?_[0]:Z.CompoundExpression.create(gt(ee.getStartPosition(),_[_.length-1].getEndPosition()),_)}function ca(){var _=null;return Vt(E.TokenKind.DOT,E.TokenKind.SAFE_NAVI)?_=Fo():_=tn(),_===null?!1:(Sr(_),!0)}function tn(){return Ir(E.TokenKind.LSQUARE)&&xa()?Lt():null}function Fo(){var _=Or(),ee=_.getKind()===E.TokenKind.SAFE_NAVI;return Va(ee)||wa()||Ra(ee)||Ia(ee)?Lt():(Tr()===null?Zr(_.startPos,"OOD"):Zr(_.startPos,"UNEXPECTED_DATA_AFTER_DOT",En(Tr())),null)}function wa(){if(!Ir(E.TokenKind.HASH))return!1;var _=Or(),ee=xr(E.TokenKind.IDENTIFIER),Se=pt();return Se===null?(Sr(Y.VariableReference.create(ee.data,gt(_.startPos,ee.endPos))),!0):(Sr(I.FunctionReference.create(ee.data,gt(_.startPos,ee.endPos),Se)),!0)}function pt(){if(!Ir(E.TokenKind.LPAREN))return null;var _=[];return Cn(_),xr(E.TokenKind.RPAREN),_}function nn(_){Ir(E.TokenKind.LPAREN)||Zr(Ge(Tr()),"MISSING_CONSTRUCTOR_ARGS"),Cn(_),xr(E.TokenKind.RPAREN)}function Cn(_){var ee=Tr().startPos,Se;do{Or();var We=Tr();We===null&&Zr(ee,"RUN_OUT_OF_ARGUMENTS"),We.getKind()!==E.TokenKind.RPAREN&&_.push(Xr()),Se=Tr()}while(Se!==null&&Se.kind===E.TokenKind.COMMA);Se===null&&Zr(ee,"RUN_OUT_OF_ARGUMENTS")}function ru(_){return _===null?pn.length:_.startPos}function Co(){return Lo()||Na()||Eo()||ja()||Da()||Va(!1)||wa()||To()||Ra(!1)||Ia(!1)||xa()||Pa()?Lt():null}function To(){if(Ir(E.TokenKind.BEAN_REF)){var _=Or(),ee=null,Se=null;Ir(E.TokenKind.IDENTIFIER)?(ee=xr(E.TokenKind.IDENTIFIER),Se=ee.data):Ir(E.TokenKind.LITERAL_STRING)?(ee=xr(E.TokenKind.LITERAL_STRING),Se=ee.stringValue(),Se=Se.substring(1,Se.length()-1)):Zr(_.startPos,"INVALID_BEAN_REFERENCE");var We=F.BeanReference.create(Ge(ee),Se);return Sr(We),!0}return!1}function Eo(){if(Ir(E.TokenKind.IDENTIFIER)){var _=Tr();if(_.stringValue()!=="T")return!1;var ee=Or();if(Ir(E.TokenKind.RSQUARE))return Sr(U.PropertyReference.create(ee.stringValue(),Ge(ee))),!0;xr(E.TokenKind.LPAREN);for(var Se=da(),We=0;vt(E.TokenKind.LSQUARE,!0);)xr(E.TokenKind.RSQUARE),We++;return xr(E.TokenKind.RPAREN),Sr(D.TypeReference.create(Ge(_),Se,We)),!0}return!1}function ja(){if(Ir(E.TokenKind.IDENTIFIER)){var _=Tr();return _.stringValue().toLowerCase()!=="null"?!1:(Or(),Sr(T.NullLiteral.create(Ge(_))),!0)}return!1}function Ra(_){var ee=Tr();if(!vt(E.TokenKind.PROJECT,!0))return!1;var Se=Xr();return xr(E.TokenKind.RSQUARE),Sr(Ie.Projection.create(_,Ge(ee),Se)),!0}function Pa(){var _=Tr(),ee=[];if(!vt(E.TokenKind.LCURLY,!0))return!1;var Se=null,We=Tr();if(vt(E.TokenKind.RCURLY,!0))Se=ye.InlineList.create(gt(_.startPos,We.endPos));else if(vt(E.TokenKind.COLON,!0))We=xr(E.TokenKind.RCURLY),Se=ie.InlineMap.create(gt(_.startPos,We.endPos));else{var st=Xr();if(Ir(E.TokenKind.RCURLY))ee.push(st),We=xr(E.TokenKind.RCURLY),Se=ye.InlineList.create(gt(_.startPos,We.endPos),ee);else if(vt(E.TokenKind.COMMA,!0)){ee.push(st);do ee.push(Xr());while(vt(E.TokenKind.COMMA,!0));We=xr(E.TokenKind.RCURLY),Se=ye.InlineList.create(Ge(_.startPos,We.endPos),ee)}else if(vt(E.TokenKind.COLON,!0)){var nt=[];for(nt.push(st),nt.push(Xr());vt(E.TokenKind.COMMA,!0);)nt.push(Xr()),xr(E.TokenKind.COLON),nt.push(Xr());We=xr(E.TokenKind.RCURLY),Se=ie.InlineMap.create(gt(_.startPos,We.endPos),nt)}else Zr(_.startPos,"OOD")}return Sr(Se),!0}function xa(){var _=Tr();if(!vt(E.TokenKind.LSQUARE,!0))return!1;var ee=Xr();return xr(E.TokenKind.RSQUARE),Sr(q.Indexer.create(Ge(_),ee)),!0}function Ia(_){var ee=Tr();if(!ka())return!1;Or();var Se=Xr();return Se===null&&Zr(Ge(ee),"MISSING_SELECTION_EXPRESSION"),xr(E.TokenKind.RSQUARE),ee.getKind()===E.TokenKind.SELECT_FIRST?Sr(pe.Selection.create(_,pe.Selection.FIRST,Ge(ee),Se)):ee.getKind()===E.TokenKind.SELECT_LAST?Sr(pe.Selection.create(_,pe.Selection.LAST,Ge(ee),Se)):Sr(pe.Selection.create(_,pe.Selection.ALL,Ge(ee),Se)),!0}function da(){for(var _=[],ee=Tr();Ao(ee);)Or(),ee.kind!==E.TokenKind.DOT&&_.push(Xe.Identifier.create(ee.stringValue(),Ge(ee))),ee=Tr();_.length||(ee===null&&Zr(pn.length(),"OOD"),Zr(ee.startPos,"NOT_EXPECTED_TOKEN","qualified ID",ee.getKind().toString().toLowerCase()));var Se=gt(_[0].getStartPosition(),_[_.length-1].getEndPosition());return lt.QualifiedIdentifier.create(Se,_)}function Ao(_){if(_===null||_.kind===E.TokenKind.LITERAL_STRING)return!1;if(_.kind===E.TokenKind.DOT||_.kind===E.TokenKind.IDENTIFIER)return!0;var ee=_.stringValue();return ee&&ee.length&&xt.test(ee)}function Va(_){if(Ir(E.TokenKind.IDENTIFIER)){var ee=Or(),Se=pt();return Se===null?(Sr(U.PropertyReference.create(_,ee.stringValue(),Ge(ee))),!0):(Sr(w.MethodReference.create(_,ee.stringValue(),Ge(ee),Se)),!0)}return!1}function Da(){if(Tn("new")){var _=Or();if(Ir(E.TokenKind.RSQUARE))return Sr(U.PropertyReference.create(_.stringValue(),Ge(_))),!0;var ee=da(),Se=[];if(Se.push(ee),Ir(E.TokenKind.LSQUARE)){for(var We=[];vt(E.TokenKind.LSQUARE,!0);)Ir(E.TokenKind.RSQUARE)?We.push(null):We.push(Xr()),xr(E.TokenKind.RSQUARE);Pa()&&Se.push(Lt()),Sr(Wr.ConstructorReference.create(Ge(_),We,Se))}else nn(Se),Sr(Wr.ConstructorReference.create(Ge(_),Se));return!0}return!1}function Sr(_){ua.push(_)}function Lt(){return ua.pop()}function Lo(){var _=Tr();if(_===null)return!1;if(_.getKind()===E.TokenKind.LITERAL_INT||_.getKind()===E.TokenKind.LITERAL_LONG)Sr(H.NumberLiteral.create(parseInt(_.stringValue(),10),Ge(_)));else if(_.getKind()===E.TokenKind.LITERAL_REAL||_.getKind()===E.TokenKind.LITERAL_REAL_FLOAT)Sr(H.NumberLiteral.create(parseFloat(_.stringValue()),Ge(_)));else if(_.getKind()===E.TokenKind.LITERAL_HEXINT||_.getKind()===E.TokenKind.LITERAL_HEXLONG)Sr(H.NumberLiteral.create(parseInt(_.stringValue(),16),Ge(_)));else if(Tn("true"))Sr($.BooleanLiteral.create(!0,Ge(_)));else if(Tn("false"))Sr($.BooleanLiteral.create(!1,Ge(_)));else if(_.getKind()===E.TokenKind.LITERAL_STRING)Sr(C.StringLiteral.create(_.stringValue(),Ge(_)));else return!1;return Or(),!0}function Na(){if(Ir(E.TokenKind.LPAREN)){Or();var _=Xr();return xr(E.TokenKind.RPAREN),Sr(_),!0}else return!1}function wo(){var _=Tr();if(_===null)return null;if(_.isNumericRelationalOperator())return _;if(_.isIdentifier()){var ee=_.stringValue();if(ee.toLowerCase()==="instanceof")return _.asInstanceOfToken();if(ee.toLowerCase()==="matches")return _.asMatchesToken();if(ee.toLowerCase()==="between")return _.asBetweenToken()}return null}function xr(_){var ee=Or();return ee===null&&Zr(pn.length,"OOD"),ee.getKind()!==_&&Zr(ee.startPos,"NOT_EXPECTED_TOKEN",_.toString().toLowerCase(),ee.getKind().toString().toLowerCase()),ee}function Ir(_){return vt(_,!1)}function vt(_,ee){if(!mn())return!1;var Se=Tr();return Se.getKind()===_?(ee&&Kr++,!0):_===E.TokenKind.IDENTIFIER&&Se.getKind().ordinal()>=E.TokenKind.DIV.ordinal()&&Se.getKind().ordinal()<=E.TokenKind.NOT.ordinal()&&Se.data!==null}function Vt(){if(!mn())return!1;for(var _=Tr(),ee=Array.prototype.slice.call(arguments),Se=0,We=ee.length;Se<We;Se+=1)if(_.getKind()===ee[Se])return!0;return!1}function Tn(_){if(!mn())return!1;var ee=Tr();return ee.getKind()===E.TokenKind.IDENTIFIER&&ee.stringValue().toLowerCase()===_.toLowerCase()}function ka(){if(!mn())return!1;var _=Tr();return _.getKind()===E.TokenKind.SELECT||_.getKind()===E.TokenKind.SELECT_FIRST||_.getKind()===E.TokenKind.SELECT_LAST}function mn(){return Kr<Zt.length}function Or(){return Kr>=la?null:Zt[Kr++]}function Tr(){return Kr>=la?null:Zt[Kr]}function Zr(_,ee,Se,We){throw Se&&(ee+=`
Expected: `+Se),We&&(ee+=`
Actual: `+We),{name:"InternalParseException",message:"Error occurred while attempting to parse expression '"+pn+"' at position "+_+". Message: "+ee}}function En(_){return _.getKind().hasPayload()?_.stringValue():_.getKind().toString().toLowerCase()}function kn(_,ee,Se){jo(_,ee),fa(_,Se)}function jo(_,ee){ee===null&&Zr(_.startPos,"LEFT_OPERAND_PROBLEM")}function fa(_,ee){ee===null&&Zr(_.startPos,"RIGHT_OPERAND_PROBLEM")}function Ge(_){return(_.startPos<<16)+_.endPos}function gt(_,ee){return(_<<16)+ee}return{setConfiguration:bo,parse:So}}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.Tokenizer=void 0;var E=V(7),P=V(2),$=["DIV","EQ","GE","GT","LE","LT","MOD","NE","NOT"],H=[],C=1,T=2,I=4;function w(){var Z;for(Z=48;Z<=57;Z+=1)H[Z]|=C|T;for(Z=65;Z<=70;Z+=1)H[Z]|=T;for(Z=97;Z<=102;Z+=1)H[Z]|=T;for(Z=65;Z<=90;Z+=1)H[Z]|=I;for(Z=97;Z<=122;Z+=1)H[Z]|=I}w();function U(Z){var q=Z,X=Z+"\0",le=X.length,z=0,he=[];function _e(){for(var oe;z<le;)if(oe=X[z],Ie(oe))me();else switch(oe){case"+":ke(P.TokenKind.INC)?sr(P.TokenKind.INC):ze(P.TokenKind.PLUS);break;case"_":me();break;case"-":ke(P.TokenKind.DEC)?sr(P.TokenKind.DEC):ze(P.TokenKind.MINUS);break;case":":ze(P.TokenKind.COLON);break;case".":ze(P.TokenKind.DOT);break;case",":ze(P.TokenKind.COMMA);break;case"*":ze(P.TokenKind.STAR);break;case"/":ze(P.TokenKind.DIV);break;case"%":ze(P.TokenKind.MOD);break;case"(":ze(P.TokenKind.LPAREN);break;case")":ze(P.TokenKind.RPAREN);break;case"[":ze(P.TokenKind.LSQUARE);break;case"#":ze(P.TokenKind.HASH);break;case"]":ze(P.TokenKind.RSQUARE);break;case"{":ze(P.TokenKind.LCURLY);break;case"}":ze(P.TokenKind.RCURLY);break;case"@":ze(P.TokenKind.BEAN_REF);break;case"^":ke(P.TokenKind.SELECT_FIRST)?sr(P.TokenKind.SELECT_FIRST):ze(P.TokenKind.POWER);break;case"!":ke(P.TokenKind.NE)?sr(P.TokenKind.NE):ke(P.TokenKind.PROJECT)?sr(P.TokenKind.PROJECT):ze(P.TokenKind.NOT);break;case"=":ke(P.TokenKind.EQ)?sr(P.TokenKind.EQ):ze(P.TokenKind.ASSIGN);break;case"&":if(!ke(P.TokenKind.SYMBOLIC_AND))throw{name:"SpelParseException",message:"Missing character '&' in expression ("+q+") at position "+z};sr(P.TokenKind.SYMBOLIC_AND);break;case"|":if(!ke(P.TokenKind.SYMBOLIC_OR))throw{name:"SpelParseException",message:"Missing character '|' in expression ("+q+") at position "+z};sr(P.TokenKind.SYMBOLIC_OR);break;case"?":ke(P.TokenKind.SELECT)?sr(P.TokenKind.SELECT):ke(P.TokenKind.ELVIS)?sr(P.TokenKind.ELVIS):ke(P.TokenKind.SAFE_NAVI)?sr(P.TokenKind.SAFE_NAVI):ze(P.TokenKind.QMARK);break;case"$":ke(P.TokenKind.SELECT_LAST)?sr(P.TokenKind.SELECT_LAST):me();break;case">":ke(P.TokenKind.GE)?sr(P.TokenKind.GE):ze(P.TokenKind.GT);break;case"<":ke(P.TokenKind.LE)?sr(P.TokenKind.LE):ze(P.TokenKind.LT);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":Ee(oe==="0");break;case" ":case"	":case"\r":case`
`:z+=1;break;case"'":Ke();break;case'"':xe();break;case"\0":z+=1;break;case"\\":throw{name:"SpelParseException",message:"Unexpected escape character in expression ("+q+") at position "+z};default:throw{name:"SpelParseException",message:"Cannot handle character '"+oe+"' in expression ("+q+") at position "+z}}}function Ke(){for(var oe=z,D=!1,F;!D;)if(z+=1,F=X[z],F==="'"&&(X[z+1]==="'"?z+=1:D=!0),F.charCodeAt(0)===0)throw{name:"SpelParseException",message:"Non-terminating quoted string in expression ("+q+") at position "+z};z+=1,he.push(new E.Token(P.TokenKind.LITERAL_STRING,lr(oe,z),oe,z))}function xe(){for(var oe=z,D=!1,F;!D;)if(z+=1,F=X[z],F==='"'&&(X[z+1]==='"'?z+=1:D=!0),F.charCodeAt(0)===0)throw{name:"SpelParseException",message:"Non-terminating double-quoted string in expression ("+q+") at position "+z};z+=1,he.push(new E.Token(P.TokenKind.LITERAL_STRING,lr(oe,z),oe,z))}function Ee(oe){var D=!1,F=z,Xe=X[z+1],lt=Xe==="x"||Xe==="X",Wr,yr,oa,xt;if(oe&&lt){z=z+1;do z+=1;while(De(X[z]));yt("L","l")?(Ne(lr(F+2,z),!0,F,z),z+=1):Ne(lr(F+2,z),!1,F,z);return}do z+=1;while(pe(X[z]));if(Xe=X[z],Xe==="."){D=!0,Wr=z;do z+=1;while(pe(X[z]));if(z===Wr+1){z=Wr,He(lr(F,z),!1,F,z);return}}if(yr=z,yt("L","l")){if(D)throw{name:"SpelParseException",message:"Real cannot be long in expression ("+q+") at position "+z};He(lr(F,yr),!0,F,yr),z+=1}else if(pr(X[z])){D=!0,z+=1,oa=X[z],ie(oa)&&(z+=1);do z+=1;while(pe(X[z]));xt=!1,tt(X[z])?(xt=!0,z+=1,yr=z):ye(X[z])&&(z+=1,yr=z),Qe(lr(F,z),xt,F,z)}else Xe=X[z],xt=!1,tt(Xe)?(D=!0,xt=!0,z+=1,yr=z):ye(Xe)&&(D=!0,z+=1,yr=z),D?Qe(lr(F,yr),xt,F,yr):He(lr(F,yr),!1,F,yr)}function me(){var oe=z,D,F,Xe;do z+=1;while(Yr(X[z]));if(D=lr(oe,z),(z-oe===2||z-oe===3)&&(F=D.toUpperCase(),Xe=$.indexOf(F),Xe>=0)){jr(P.TokenKind.valueOf(F),oe,D);return}he.push(new E.Token(P.TokenKind.IDENTIFIER,D.replace("\0",""),oe,z))}function He(oe,D,F,Xe){D?he.push(new E.Token(P.TokenKind.LITERAL_LONG,oe,F,Xe)):he.push(new E.Token(P.TokenKind.LITERAL_INT,oe,F,Xe))}function Ne(oe,D,F,Xe){if(oe.length===0)throw D?{name:"SpelParseException",message:"Not a long in expression ("+q+") at position "+z}:{name:"SpelParseException",message:"Not an int in expression ("+q+") at position "+z};D?he.push(new E.Token(P.TokenKind.LITERAL_HEXLONG,oe,F,Xe)):he.push(new E.Token(P.TokenKind.LITERAL_HEXINT,oe,F,Xe))}function Qe(oe,D,F,Xe){D?he.push(new E.Token(P.TokenKind.LITERAL_REAL_FLOAT,oe,F,Xe)):he.push(new E.Token(P.TokenKind.LITERAL_REAL,oe,F,Xe))}function lr(oe,D){return X.substring(oe,D)}function ke(oe){return oe.tokenChars.length===2&&X[z]===oe.tokenChars[0]?X[z+1]===oe.tokenChars[1]:!1}function ze(oe){he.push(new E.Token(oe,null,z,z+1)),z+=1}function sr(oe){he.push(new E.Token(oe,null,z,z+2)),z+=2}function jr(oe,D,F){he.push(new E.Token(oe,F,D,D+oe.getLength()))}function Yr(oe){return Ie(oe)||pe(oe)||oe==="_"||oe==="$"}function yt(oe,D){var F=X[z];return F===oe||F===D}function pr(oe){return oe==="e"||oe==="E"}function tt(oe){return oe==="f"||oe==="F"}function ye(oe){return oe==="d"||oe==="D"}function ie(oe){return oe==="+"||oe==="-"}function pe(oe){return oe.charCodeAt(0)>255?!1:(H[oe.charCodeAt(0)]&C)!==0}function Ie(oe){return oe.charCodeAt(0)>255?!1:(H[oe.charCodeAt(0)]&I)!==0}function De(oe){return oe.charCodeAt(0)>255?!1:(H[oe.charCodeAt(0)]&T)!==0}return _e(),he}var Y=h.Tokenizer={tokenize:U}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.Token=void 0;var E=V(2);function P($,H,C,T){this.kind=$,this.startPos=C,this.endPos=T,H&&(this.data=H)}P.prototype.getKind=function(){return this.kind},P.prototype.toString=function(){var $="[";return $+=this.kind.toString(),this.kind.hasPayload()&&($+=":"+this.data),$+="]",$+="("+this.startPos+","+this.endPos+")",$},P.prototype.isIdentifier=function(){return this.kind===E.TokenKind.IDENTIFIER},P.prototype.isNumericRelationalOperator=function(){return this.kind===E.TokenKind.GT||this.kind===E.TokenKind.GE||this.kind===E.TokenKind.LT||this.kind===E.TokenKind.LE||this.kind===E.TokenKind.EQ||this.kind===E.TokenKind.NE},P.prototype.stringValue=function(){return this.data},P.prototype.asInstanceOfToken=function(){return new P(E.TokenKind.INSTANCEOF,this.startPos,this.endPos)},P.prototype.asMatchesToken=function(){return new P(E.TokenKind.MATCHES,this.startPos,this.endPos)},P.prototype.asBetweenToken=function(){return new P(E.TokenKind.BETWEEN,this.startPos,this.endPos)},P.prototype.getStartPosition=function(){return this.startPos},P.prototype.getEndPosition=function(){return this.endPos},h.Token=P},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.BooleanLiteral=void 0;var E=V(0);function P(H,C){var T=E.SpelNode.create("boolean",C);return T.getValue=function(){return H},T.setValue=function(I){return H=I},T}var $=h.BooleanLiteral={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.NumberLiteral=void 0;var E=V(0);function P(H,C){var T=E.SpelNode.create("number",C);return T.getValue=function(){return H},T.setValue=function(I){return H=I},T}var $=h.NumberLiteral={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.StringLiteral=void 0;var E=V(0);function P(H,C){var T=E.SpelNode.create("string",C);function I(w){return(w[0]==="'"&&w[w.length-1]==="'"||w[0]==='"'&&w[w.length-1]==='"')&&(w=w.substring(1,w.length-1)),w.replace(/''/g,"'").replace(/""/g,'"')}return H=I(H),T.getValue=function(){return H},T.setValue=function(w){return H=w},T}var $=h.StringLiteral={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.NullLiteral=void 0;var E=V(0);function P(H,C){var T=E.SpelNode.create("null",C);return T.getValue=function(){return null},T}var $=h.NullLiteral={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.FunctionReference=void 0;var E=V(0),P=V(1);function $(C,T,I){var w=E.SpelNode.create("function",T);return w.getRaw=function(){return{functionName:C,args:I}},w.getValue=function(U){var Y=U.locals||{},Z=U.rootContext,q=[];if(I.forEach(function(X){var le=U.activeContext;U.activeContext=new P.Stack,U.activeContext.push(U.rootContext),q.push(X.getValue(U)),U.activeContext=le}),Y[C])return Y[C].apply(Z,q);throw{name:"FunctionDoesNotExistException",message:"Function '"+C+"' does not exist."}},w}var H=h.FunctionReference={create:$}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.MethodReference=void 0;var E=V(0),P=V(1);function $(C,T,I,w){var U=E.SpelNode.create("method",I);return U.getRaw=function(){return{methodName:T,args:w}},U.getValue=function(Y){var Z=Y.activeContext.peek(),q=[],X;if(!Z)throw{name:"ContextDoesNotExistException",message:"Attempting to look up property '"+T+"' for an undefined context."};function le(z){if(z==null){if(C)return null;throw{name:"NullPointerException",message:"Method "+T+" does not exist."}}return z}if(w.forEach(function(z){var he=Y.activeContext;Y.activeContext=new P.Stack,Y.activeContext.push(Y.rootContext),q.push(z.getValue(Y)),Y.activeContext=he}),T.substr(0,3)==="get"&&!Z[T])return le(Z[T.charAt(3).toLowerCase()+T.substring(4)]);if(T.substr(0,3)==="set"&&!Z[T])return Z[T.charAt(3).toLowerCase()+T.substring(4)]=q[0];if(Array.isArray(Z)){if(T==="size")return Z.length;if(T==="contains")return Z.includes(q[0])}return X=le(Z[T]),X?X.apply(Z,q):null},U}var H=h.MethodReference={create:$}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.PropertyReference=void 0;var E=V(0);function P(H,C,T){var I=E.SpelNode.create("property",T);return I.getRaw=function(){return C},I.getValue=function(w){var U=w.activeContext.peek();if(!U){if(H)return null;throw{name:"ContextDoesNotExistException",message:"Attempting to look up property '"+C+"' for an undefined context."}}if(U[C]===void 0||U[C]===null){if(H)return null;if(C==="size"&&Array.isArray(U))return U.length;throw{name:"NullPointerException",message:"Property '"+C+"' does not exist."}}return U[C]},I.setValue=function(w,U){var Y=U.activeContext.peek();if(!Y)throw{name:"ContextDoesNotExistException",message:"Attempting to assign property '"+C+"' for an undefined context."};return Y[C]=w},I.getName=function(){return C},I}var $=h.PropertyReference={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.VariableReference=void 0;var E=V(0);function P(H,C){var T=E.SpelNode.create("variable",C);return T.getRaw=function(){return H},T.getValue=function(I){var w=I.activeContext.peek(),U=I.locals;if(!w)throw{name:"ContextDoesNotExistException",message:"Attempting to look up variable '"+H+"' for an undefined context."};return H==="this"?w:H==="root"?I.rootContext:U[H]},T.setValue=function(I,w){var U=w.locals;return U[H]=I},T}var $=h.VariableReference={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.CompoundExpression=void 0;var E=V(0);function P(H,C){var T=E.SpelNode.create.apply(null,["compound",H].concat(C));function I(w){var U=T.getChildren().length,Y;for(Y=0;Y<U;Y+=1)T.getChildren()[Y].getType()==="indexer"?w.activeContext.push(w.activeContext.peek()[T.getChildren()[Y].getValue(w)]):w.activeContext.push(T.getChildren()[Y].getValue(w));return function(){for(Y=0;Y<U;Y+=1)w.activeContext.pop()}}return T.getValue=function(w){var U=w.activeContext.peek(),Y;if(!U)throw{name:"ContextDoesNotExistException",message:"Attempting to evaluate compound expression with an undefined context."};var Z=I(w);return Y=w.activeContext.peek(),Z(),Y},T.setValue=function(w,U){var Y=I(U),Z=T.getChildren().length;return U.activeContext.pop(),w=T.getChildren()[Z-1].setValue(w,U),U.activeContext.push(null),Y(),w},T}var $=h.CompoundExpression={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.Indexer=void 0;var E=V(0),P=V(1);function $(C,T){var I=E.SpelNode.create.apply(null,["indexer",C].concat(T));return I.getValue=function(w){var U=w.activeContext,Y,Z=I.getChildren().length,q,X;if(w.activeContext=new P.Stack,w.activeContext.push(w.rootContext),Y=w.activeContext.peek(),!Y)throw{name:"ContextDoesNotExistException",message:"Attempting to evaluate compound expression with an undefined context."};for(q=0;q<Z;q+=1)w.activeContext.push(I.getChildren()[q].getValue(w));for(X=w.activeContext.peek(),q=0;q<Z;q+=1)w.activeContext.pop();return w.activeContext=U,X},I}var H=h.Indexer={create:$}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.Assign=void 0;var E=V(0);function P(H,C,T){var I=E.SpelNode.create("assign",H,C,T);return I.getValue=function(w){var U=w.activeContext.peek();if(!U)throw{name:"ContextDoesNotExistException",message:"Attempting to assign property '"+C.getValue(w)+"' for an undefined context."};return C.setValue(T.getValue(w),w)},I}var $=h.Assign={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.OpEQ=void 0;var E=V(0);function P(H,C,T){var I=E.SpelNode.create("op-eq",H,C,T);return I.getValue=function(w){return C.getValue(w)===T.getValue(w)},I}var $=h.OpEQ={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.OpNE=void 0;var E=V(0);function P(H,C,T){var I=E.SpelNode.create("op-ne",H,C,T);return I.getValue=function(w){return C.getValue(w)!==T.getValue(w)},I}var $=h.OpNE={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.OpGE=void 0;var E=V(0);function P(H,C,T){var I=E.SpelNode.create("op-ge",H,C,T);return I.getValue=function(w){return C.getValue(w)>=T.getValue(w)},I}var $=h.OpGE={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.OpGT=void 0;var E=V(0);function P(H,C,T){var I=E.SpelNode.create("op-gt",H,C,T);return I.getValue=function(w){return C.getValue(w)>T.getValue(w)},I}var $=h.OpGT={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.OpLE=void 0;var E=V(0);function P(H,C,T){var I=E.SpelNode.create("op-le",H,C,T);return I.getValue=function(w){return C.getValue(w)<=T.getValue(w)},I}var $=h.OpLE={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.OpLT=void 0;var E=V(0);function P(H,C,T){var I=E.SpelNode.create("op-lt",H,C,T);return I.getValue=function(w){return C.getValue(w)<T.getValue(w)},I}var $=h.OpLT={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.OpPlus=void 0;var E=V(0);function P(H,C,T){var I=E.SpelNode.create("op-plus",H,C,T);return I.getValue=function(w){return T?C.getValue(w)+T.getValue(w):+C.getValue(w)},I}var $=h.OpPlus={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.OpMinus=void 0;var E=V(0);function P(H,C,T){var I=E.SpelNode.create("op-minus",H,C,T);return I.getValue=function(w){return T?C.getValue(w)-T.getValue(w):-C.getValue(w)},I}var $=h.OpMinus={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.OpMultiply=void 0;var E=V(0);function P(H,C,T){var I=E.SpelNode.create("op-multiply",H,C,T);return I.getValue=function(w){var U=C.getValue(w),Y=T.getValue(w);if(typeof U=="number"&&typeof Y=="number")return U*Y;if(typeof U=="string"&&typeof Y=="number"){for(var Z="",q=0;q<Y;q+=1)Z+=U;return Z}return null},I}var $=h.OpMultiply={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.OpDivide=void 0;var E=V(0);function P(H,C,T){var I=E.SpelNode.create("op-divide",H,C,T);return I.getValue=function(w){return C.getValue(w)/T.getValue(w)},I}var $=h.OpDivide={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.OpModulus=void 0;var E=V(0);function P(H,C,T){var I=E.SpelNode.create("op-modulus",H,C,T);return I.getValue=function(w){return C.getValue(w)%T.getValue(w)},I}var $=h.OpModulus={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.OpPower=void 0;var E=V(0);function P(H,C,T){var I=E.SpelNode.create("op-power",H,C,T);return I.getValue=function(w){return Math.pow(C.getValue(w),T.getValue(w))},I}var $=h.OpPower={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.OpInc=void 0;var E=V(0);function P(H,C,T){var I=E.SpelNode.create("op-inc",H,T);return I.getValue=function(w){var U=T.getValue(w);return T.setValue(U+1,w),C?U:U+1},I}var $=h.OpInc={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.OpDec=void 0;var E=V(0);function P(H,C,T){var I=E.SpelNode.create("op-dec",H,T);return I.getValue=function(w){var U=T.getValue(w);return T.setValue(U-1,w),C?U:U-1},I}var $=h.OpDec={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.OpNot=void 0;var E=V(0);function P(H,C){var T=E.SpelNode.create("op-not",H,C);return T.getValue=function(I){return!C.getValue(I)},T}var $=h.OpNot={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.OpAnd=void 0;var E=V(0);function P(H,C,T){var I=E.SpelNode.create("op-and",H,C,T);return I.getValue=function(w){return!!C.getValue(w)&&!!T.getValue(w)},I}var $=h.OpAnd={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.OpOr=void 0;var E=V(0);function P(H,C,T){var I=E.SpelNode.create("op-or",H,C,T);return I.getValue=function(w){return!!C.getValue(w)||!!T.getValue(w)},I}var $=h.OpOr={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.OpMatches=void 0;var E=V(0);function P(H,C,T){var I=E.SpelNode.create("matches",H,C,T);return I.getValue=function(w){var U=C.getValue(w),Y=T.getValue(w);try{var Z=new RegExp(Y);return!!Z.exec(U)}catch(q){throw{name:"EvaluationException",message:q.toString()}}},I}var $=h.OpMatches={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.Ternary=void 0;var E=V(0);function P(H,C,T,I){var w=E.SpelNode.create("ternary",H,C,T,I);return w.getValue=function(U){return C.getValue(U)?T.getValue(U):I.getValue(U)},w}var $=h.Ternary={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.Elvis=void 0;var E=V(0);function P(H,C,T){var I=E.SpelNode.create("elvis",H,C,T);return I.getValue=function(w){return C.getValue(w)!==null?C.getValue(w):T.getValue(w)},I}var $=h.Elvis={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.InlineList=void 0;var E=V(0);function P(H,C){var T=E.SpelNode.create("list",H),I=[].concat(C||[]);return T.getRaw=function(){return I},T.getValue=function(w){return I.map(function(U){return U.getValue(w)})},T}var $=h.InlineList={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.InlineMap=void 0;var E=V(0);function P(H,C){var T=E.SpelNode.create("map",H),I=[].concat(C||[]);return T.getValue=function(w){var U=!0,Y=null,Z={};return I.forEach(function(q){U?q.getType()==="property"?Y=q.getName():Y=q.getValue(w):Z[Y]=q.getValue(w),U=!U}),Z},T}var $=h.InlineMap={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.Selection=void 0;var E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w},P=V(0);function $(w,U,Y){var Z=!1;return Y.activeContext.push(w),Z=U.getValue(Y),Y.activeContext.pop(),Z}function H(w,U,Y,Z){var q=w.filter(function(X){return $(X,Y,Z)});switch(U){case"ALL":return q;case"FIRST":return q[0]||null;case"LAST":return q.length?q[q.length-1]:null}}function C(w,U,Y,Z){var q={},X,le,z=[],he={};for(le in w)w.hasOwnProperty(le)&&(X={key:le,value:w[le]},$(X,Y,Z)&&z.push(X));switch(U){case"ALL":return z.forEach(function(_e){q[_e.key]=_e.value}),q;case"FIRST":return z.length?(he[z[0].key]=z[0].value,he):null;case"LAST":return z.length?(he[z[z.length-1].key]=z[z.length-1].value,he):null}z.forEach(function(_e){q[_e.key]=_e.value})}function T(w,U,Y,Z){var q=P.SpelNode.create("selection",Y,Z);return q.getValue=function(X){var le=X.activeContext.peek();if(le){if(Array.isArray(le))return H(le,U,Z,X);if((typeof le>"u"?"undefined":E(le))==="object")return C(le,U,Z,X)}return null},q}var I=h.Selection={create:T,FIRST:"FIRST",LAST:"LAST",ALL:"ALL"}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.Projection=void 0;var E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(T){return typeof T}:function(T){return T&&typeof Symbol=="function"&&T.constructor===Symbol&&T!==Symbol.prototype?"symbol":typeof T},P=V(0);function $(T,I,w){return T.map(function(U){var Y;return w.activeContext.push(U),Y=I.getValue(w),w.activeContext.pop(),Y})}function H(T,I,w){var U=P.SpelNode.create("projection",I,w);return U.getValue=function(Y){var Z=Y.activeContext.peek(),q=[],X;if(Array.isArray(Z))return $(Z,w,Y);if((typeof Z>"u"?"undefined":E(Z))==="object"){for(X in Z)Z.hasOwnProperty(X)&&q.push(Z[X]);return $(q,w,Y)}return null},U}var C=h.Projection={create:H}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.OpInstanceof=void 0;var E=V(0);function P(H,C,T){var I=E.SpelNode.create("instanceof",H,C,T);return I.getValue=function(w){throw{name:"MethodNotImplementedException",message:"OpInstanceOf: Not implemented"}},I}var $=h.OpInstanceof={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.OpBetween=void 0;var E=V(0);function P(H,C,T){var I=E.SpelNode.create("between",H,C,T);return I.getValue=function(w){throw{name:"MethodNotImplementedException",message:"OpBetween: Not implemented"}},I}var $=h.OpBetween={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.TypeReference=void 0;var E=V(0);function P(H,I,T){var I=E.SpelNode.create("typeref",H,I);return I.getValue=function(w){throw{name:"MethodNotImplementedException",message:"TypeReference: Not implemented"}},I}var $=h.TypeReference={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.BeanReference=void 0;var E=V(0);function P(H,C){var T=E.SpelNode.create("beanref",H);return T.getValue=function(I){throw{name:"MethodNotImplementedException",message:"BeanReference: Not implemented"}},T}var $=h.BeanReference={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.Identifier=void 0;var E=V(0);function P(H,C){var T=E.SpelNode.create("identifier",C);return T.getRaw=function(){return H},T.getValue=function(I){throw{name:"MethodNotImplementedException",message:"Identifier: Not implemented"}},T}var $=h.Identifier={create:P}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.QualifiedIdentifier=void 0;var E=V(0);function P(C){if(Array.isArray(C)){for(var T=0,I=Array(C.length);T<C.length;T++)I[T]=C[T];return I}else return Array.from(C)}function $(C,T){var I=E.SpelNode.create.apply(E.SpelNode,["qualifiedidentifier",C].concat(P(T)));return I.getRaw=function(){return T.map(function(w){return w.getRaw()})},I.getValue=function(w){throw{name:"MethodNotImplementedException",message:"QualifiedIdentifier: Not implemented"}},I}var H=h.QualifiedIdentifier={create:$}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ConstructorReference=void 0;var E=V(0),P=V(1);function $(I){if(Array.isArray(I)){for(var w=0,U=Array(I.length);w<I.length;w++)U[w]=I[w];return U}else return Array.from(I)}function H(I){return Array.isArray(I)?I:Array.from(I)}function C(I,w,U){var Y=U!==void 0,Z;Y?Z=w.length&&w[0]&&w[0].getType()==="number"?w[0].getValue():null:(U=w,w=void 0);var q=U,X=H(q),le=X[0],z=X.slice(1),he=E.SpelNode.create.apply(E.SpelNode,["constructorref",I].concat($(U)));return he.getRaw=function(){return Z},he.getValue=function(_e){if(Y&&z.length<=1){var Ke=[];return z.forEach(function(xe){var Ee=_e.activeContext;_e.activeContext=new P.Stack,_e.activeContext.push(_e.rootContext),Ke.push(xe.getValue(_e)),_e.activeContext=Ee}),z.length===1?Ke[0]:Z?new Array(Z):[]}throw{name:"MethodNotImplementedException",message:"ConstructorReference: Not implemented"}},he}var T=h.ConstructorReference={create:C}},function(ge,h,V){"use strict";Object.defineProperty(h,"__esModule",{value:!0});function E($,H){var C={};return C.authentication=$||{},C.principal=H||{},C.hasRole=function(T){var I=!1;return!T||!C.authentication&&!Array.isArray(C.authentication.authorities)?!1:(C.authentication.authorities.forEach(function(w){w.authority.toLowerCase()===T.toLowerCase()&&(I=!0)}),I)},C.hasPermission=function(){var T=Array.prototype.slice.call(arguments);if(T.length===1)return C.hasRole(T[0])},C}var P=h.StandardContext={create:E}}])})},61526:(we,ge,h)=>{we.exports=h(88319)},88319:(we,ge,h)=>{var V=h(48287).Buffer,E=ge,P=/`/g,$=/\./g,H=/[\0\b\t\n\r\x1a\"\'\\]/g,C={"\0":"\\0","\b":"\\b","	":"\\t","\n":"\\n","\r":"\\r","":"\\Z",'"':'\\"',"'":"\\'","\\":"\\\\"};E.escapeId=function(Y,Z){if(Array.isArray(Y)){for(var q="",X=0;X<Y.length;X++)q+=(X===0?"":", ")+E.escapeId(Y[X],Z);return q}else return Z?"`"+String(Y).replace(P,"``")+"`":"`"+String(Y).replace(P,"``").replace($,"`.`")+"`"},E.escape=function(Y,Z,q){if(Y==null)return"NULL";switch(typeof Y){case"boolean":return Y?"true":"false";case"number":return Y+"";case"object":return Object.prototype.toString.call(Y)==="[object Date]"?E.dateToString(Y,q||"local"):Array.isArray(Y)?E.arrayToList(Y,q):V.isBuffer(Y)?E.bufferToString(Y):typeof Y.toSqlString=="function"?String(Y.toSqlString()):Z?T(Y.toString()):E.objectToValues(Y,q);default:return T(Y)}},E.arrayToList=function(Y,Z){for(var q="",X=0;X<Y.length;X++){var le=Y[X];Array.isArray(le)?q+=(X===0?"":", ")+"("+E.arrayToList(le,Z)+")":q+=(X===0?"":", ")+E.escape(le,!0,Z)}return q},E.format=function(Y,Z,q,X){if(Z==null)return Y;Array.isArray(Z)||(Z=[Z]);for(var le=0,z=/\?+/g,he="",_e=0,Ke;_e<Z.length&&(Ke=z.exec(Y));){var xe=Ke[0].length;if(!(xe>2)){var Ee=xe===2?E.escapeId(Z[_e]):E.escape(Z[_e],q,X);he+=Y.slice(le,Ke.index)+Ee,le=z.lastIndex,_e++}}return le===0?Y:le<Y.length?he+Y.slice(le):he},E.dateToString=function(Y,Z){var q=new Date(Y);if(isNaN(q.getTime()))return"NULL";var X,le,z,he,_e,Ke,xe;if(Z==="local")X=q.getFullYear(),le=q.getMonth()+1,z=q.getDate(),he=q.getHours(),_e=q.getMinutes(),Ke=q.getSeconds(),xe=q.getMilliseconds();else{var Ee=w(Z);Ee!==!1&&Ee!==0&&q.setTime(q.getTime()+Ee*6e4),X=q.getUTCFullYear(),le=q.getUTCMonth()+1,z=q.getUTCDate(),he=q.getUTCHours(),_e=q.getUTCMinutes(),Ke=q.getUTCSeconds(),xe=q.getUTCMilliseconds()}var me=I(X,4)+"-"+I(le,2)+"-"+I(z,2)+" "+I(he,2)+":"+I(_e,2)+":"+I(Ke,2)+"."+I(xe,3);return T(me)},E.bufferToString=function(Y){return"X"+T(Y.toString("hex"))},E.objectToValues=function(Y,Z){var q="";for(var X in Y){var le=Y[X];typeof le!="function"&&(q+=(q.length===0?"":", ")+E.escapeId(X)+" = "+E.escape(le,!0,Z))}return q},E.raw=function(Y){if(typeof Y!="string")throw new TypeError("argument sql must be a string");return{toSqlString:function(){return Y}}};function T(U){for(var Y=H.lastIndex=0,Z="",q;q=H.exec(U);)Z+=U.slice(Y,q.index)+C[q[0]],Y=H.lastIndex;return Y===0?"'"+U+"'":Y<U.length?"'"+Z+U.slice(Y)+"'":"'"+Z+"'"}function I(U,Y){for(U=U.toString();U.length<Y;)U="0"+U;return U}function w(U){if(U==="Z")return 0;var Y=U.match(/([\+\-\s])(\d\d):?(\d\d)?/);return Y?(Y[1]==="-"?-1:1)*(parseInt(Y[2],10)+(Y[3]?parseInt(Y[3],10):0)/60)*60:!1}},4633:(we,ge,h)=>{var V=h(73738).default;function E(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */we.exports=E=function(){return $},we.exports.__esModule=!0,we.exports.default=we.exports;var P,$={},H=Object.prototype,C=H.hasOwnProperty,T=Object.defineProperty||function(ye,ie,pe){ye[ie]=pe.value},I=typeof Symbol=="function"?Symbol:{},w=I.iterator||"@@iterator",U=I.asyncIterator||"@@asyncIterator",Y=I.toStringTag||"@@toStringTag";function Z(ye,ie,pe){return Object.defineProperty(ye,ie,{value:pe,enumerable:!0,configurable:!0,writable:!0}),ye[ie]}try{Z({},"")}catch{Z=function(pe,Ie,De){return pe[Ie]=De}}function q(ye,ie,pe,Ie){var De=ie&&ie.prototype instanceof xe?ie:xe,oe=Object.create(De.prototype),D=new pr(Ie||[]);return T(oe,"_invoke",{value:sr(ye,pe,D)}),oe}function X(ye,ie,pe){try{return{type:"normal",arg:ye.call(ie,pe)}}catch(Ie){return{type:"throw",arg:Ie}}}$.wrap=q;var le="suspendedStart",z="suspendedYield",he="executing",_e="completed",Ke={};function xe(){}function Ee(){}function me(){}var He={};Z(He,w,function(){return this});var Ne=Object.getPrototypeOf,Qe=Ne&&Ne(Ne(tt([])));Qe&&Qe!==H&&C.call(Qe,w)&&(He=Qe);var lr=me.prototype=xe.prototype=Object.create(He);function ke(ye){["next","throw","return"].forEach(function(ie){Z(ye,ie,function(pe){return this._invoke(ie,pe)})})}function ze(ye,ie){function pe(De,oe,D,F){var Xe=X(ye[De],ye,oe);if(Xe.type!=="throw"){var lt=Xe.arg,Wr=lt.value;return Wr&&V(Wr)=="object"&&C.call(Wr,"__await")?ie.resolve(Wr.__await).then(function(yr){pe("next",yr,D,F)},function(yr){pe("throw",yr,D,F)}):ie.resolve(Wr).then(function(yr){lt.value=yr,D(lt)},function(yr){return pe("throw",yr,D,F)})}F(Xe.arg)}var Ie;T(this,"_invoke",{value:function(oe,D){function F(){return new ie(function(Xe,lt){pe(oe,D,Xe,lt)})}return Ie=Ie?Ie.then(F,F):F()}})}function sr(ye,ie,pe){var Ie=le;return function(De,oe){if(Ie===he)throw Error("Generator is already running");if(Ie===_e){if(De==="throw")throw oe;return{value:P,done:!0}}for(pe.method=De,pe.arg=oe;;){var D=pe.delegate;if(D){var F=jr(D,pe);if(F){if(F===Ke)continue;return F}}if(pe.method==="next")pe.sent=pe._sent=pe.arg;else if(pe.method==="throw"){if(Ie===le)throw Ie=_e,pe.arg;pe.dispatchException(pe.arg)}else pe.method==="return"&&pe.abrupt("return",pe.arg);Ie=he;var Xe=X(ye,ie,pe);if(Xe.type==="normal"){if(Ie=pe.done?_e:z,Xe.arg===Ke)continue;return{value:Xe.arg,done:pe.done}}Xe.type==="throw"&&(Ie=_e,pe.method="throw",pe.arg=Xe.arg)}}}function jr(ye,ie){var pe=ie.method,Ie=ye.iterator[pe];if(Ie===P)return ie.delegate=null,pe==="throw"&&ye.iterator.return&&(ie.method="return",ie.arg=P,jr(ye,ie),ie.method==="throw")||pe!=="return"&&(ie.method="throw",ie.arg=new TypeError("The iterator does not provide a '"+pe+"' method")),Ke;var De=X(Ie,ye.iterator,ie.arg);if(De.type==="throw")return ie.method="throw",ie.arg=De.arg,ie.delegate=null,Ke;var oe=De.arg;return oe?oe.done?(ie[ye.resultName]=oe.value,ie.next=ye.nextLoc,ie.method!=="return"&&(ie.method="next",ie.arg=P),ie.delegate=null,Ke):oe:(ie.method="throw",ie.arg=new TypeError("iterator result is not an object"),ie.delegate=null,Ke)}function Yr(ye){var ie={tryLoc:ye[0]};1 in ye&&(ie.catchLoc=ye[1]),2 in ye&&(ie.finallyLoc=ye[2],ie.afterLoc=ye[3]),this.tryEntries.push(ie)}function yt(ye){var ie=ye.completion||{};ie.type="normal",delete ie.arg,ye.completion=ie}function pr(ye){this.tryEntries=[{tryLoc:"root"}],ye.forEach(Yr,this),this.reset(!0)}function tt(ye){if(ye||ye===""){var ie=ye[w];if(ie)return ie.call(ye);if(typeof ye.next=="function")return ye;if(!isNaN(ye.length)){var pe=-1,Ie=function De(){for(;++pe<ye.length;)if(C.call(ye,pe))return De.value=ye[pe],De.done=!1,De;return De.value=P,De.done=!0,De};return Ie.next=Ie}}throw new TypeError(V(ye)+" is not iterable")}return Ee.prototype=me,T(lr,"constructor",{value:me,configurable:!0}),T(me,"constructor",{value:Ee,configurable:!0}),Ee.displayName=Z(me,Y,"GeneratorFunction"),$.isGeneratorFunction=function(ye){var ie=typeof ye=="function"&&ye.constructor;return!!ie&&(ie===Ee||(ie.displayName||ie.name)==="GeneratorFunction")},$.mark=function(ye){return Object.setPrototypeOf?Object.setPrototypeOf(ye,me):(ye.__proto__=me,Z(ye,Y,"GeneratorFunction")),ye.prototype=Object.create(lr),ye},$.awrap=function(ye){return{__await:ye}},ke(ze.prototype),Z(ze.prototype,U,function(){return this}),$.AsyncIterator=ze,$.async=function(ye,ie,pe,Ie,De){De===void 0&&(De=Promise);var oe=new ze(q(ye,ie,pe,Ie),De);return $.isGeneratorFunction(ie)?oe:oe.next().then(function(D){return D.done?D.value:oe.next()})},ke(lr),Z(lr,Y,"Generator"),Z(lr,w,function(){return this}),Z(lr,"toString",function(){return"[object Generator]"}),$.keys=function(ye){var ie=Object(ye),pe=[];for(var Ie in ie)pe.push(Ie);return pe.reverse(),function De(){for(;pe.length;){var oe=pe.pop();if(oe in ie)return De.value=oe,De.done=!1,De}return De.done=!0,De}},$.values=tt,pr.prototype={constructor:pr,reset:function(ie){if(this.prev=0,this.next=0,this.sent=this._sent=P,this.done=!1,this.delegate=null,this.method="next",this.arg=P,this.tryEntries.forEach(yt),!ie)for(var pe in this)pe.charAt(0)==="t"&&C.call(this,pe)&&!isNaN(+pe.slice(1))&&(this[pe]=P)},stop:function(){this.done=!0;var ie=this.tryEntries[0].completion;if(ie.type==="throw")throw ie.arg;return this.rval},dispatchException:function(ie){if(this.done)throw ie;var pe=this;function Ie(lt,Wr){return D.type="throw",D.arg=ie,pe.next=lt,Wr&&(pe.method="next",pe.arg=P),!!Wr}for(var De=this.tryEntries.length-1;De>=0;--De){var oe=this.tryEntries[De],D=oe.completion;if(oe.tryLoc==="root")return Ie("end");if(oe.tryLoc<=this.prev){var F=C.call(oe,"catchLoc"),Xe=C.call(oe,"finallyLoc");if(F&&Xe){if(this.prev<oe.catchLoc)return Ie(oe.catchLoc,!0);if(this.prev<oe.finallyLoc)return Ie(oe.finallyLoc)}else if(F){if(this.prev<oe.catchLoc)return Ie(oe.catchLoc,!0)}else{if(!Xe)throw Error("try statement without catch or finally");if(this.prev<oe.finallyLoc)return Ie(oe.finallyLoc)}}}},abrupt:function(ie,pe){for(var Ie=this.tryEntries.length-1;Ie>=0;--Ie){var De=this.tryEntries[Ie];if(De.tryLoc<=this.prev&&C.call(De,"finallyLoc")&&this.prev<De.finallyLoc){var oe=De;break}}oe&&(ie==="break"||ie==="continue")&&oe.tryLoc<=pe&&pe<=oe.finallyLoc&&(oe=null);var D=oe?oe.completion:{};return D.type=ie,D.arg=pe,oe?(this.method="next",this.next=oe.finallyLoc,Ke):this.complete(D)},complete:function(ie,pe){if(ie.type==="throw")throw ie.arg;return ie.type==="break"||ie.type==="continue"?this.next=ie.arg:ie.type==="return"?(this.rval=this.arg=ie.arg,this.method="return",this.next="end"):ie.type==="normal"&&pe&&(this.next=pe),Ke},finish:function(ie){for(var pe=this.tryEntries.length-1;pe>=0;--pe){var Ie=this.tryEntries[pe];if(Ie.finallyLoc===ie)return this.complete(Ie.completion,Ie.afterLoc),yt(Ie),Ke}},catch:function(ie){for(var pe=this.tryEntries.length-1;pe>=0;--pe){var Ie=this.tryEntries[pe];if(Ie.tryLoc===ie){var De=Ie.completion;if(De.type==="throw"){var oe=De.arg;yt(Ie)}return oe}}throw Error("illegal catch attempt")},delegateYield:function(ie,pe,Ie){return this.delegate={iterator:tt(ie),resultName:pe,nextLoc:Ie},this.method==="next"&&(this.arg=P),Ke}},$}we.exports=E,we.exports.__esModule=!0,we.exports.default=we.exports},73738:we=>{function ge(h){"@babel/helpers - typeof";return we.exports=ge=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(V){return typeof V}:function(V){return V&&typeof Symbol=="function"&&V.constructor===Symbol&&V!==Symbol.prototype?"symbol":typeof V},we.exports.__esModule=!0,we.exports.default=we.exports,ge(h)}we.exports=ge,we.exports.__esModule=!0,we.exports.default=we.exports},54756:(we,ge,h)=>{var V=h(4633)();we.exports=V;try{regeneratorRuntime=V}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=V:Function("r","regeneratorRuntime = r")(V)}}}]);

//# sourceMappingURL=4669.74ff5f903fe4b9e229d7.js.map