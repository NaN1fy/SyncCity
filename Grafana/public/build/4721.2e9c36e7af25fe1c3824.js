(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[4721],{76287:(G,O,e)=>{"use strict";e.d(O,{p:()=>s});var t=e(74848),n=e(96540),i=e(94841);function s(r){const{children:f,instanceSettings:a}=r,c=(0,n.useMemo)(()=>({instanceSettings:a,meta:a.meta}),[a]);return(0,t.jsx)(i.o.Provider,{value:c,children:f})}},94841:(G,O,e)=>{"use strict";e.d(O,{o:()=>n});var t=e(96540);const n=(0,t.createContext)(void 0)},13834:(G,O,e)=>{"use strict";e.d(O,{a:()=>i});var t=e(74848),n=e(94841);function i(s){const{children:r,...f}=s;return(0,t.jsx)(n.o.Provider,{value:f,children:r})}},95187:(G,O,e)=>{"use strict";e.d(O,{S:()=>t});function t(n){return"instanceSettings"in n&&"meta"in n}},92470:(G,O,e)=>{"use strict";e.d(O,{Q:()=>i});var t=e(96540),n=e(94841);function i(){const s=(0,t.useContext)(n.o);if(!s)throw new Error("usePluginContext must be used within a PluginContextProvider");return s}},33948:(G,O,e)=>{"use strict";e.d(O,{I:()=>s,f:()=>i});var t=e(11261),n=e(14236);class i{constructor(c,o){return this.fields=[],this.length=0,s(c,o)}}function s(a,c){const o={fields:[],length:a.length};if(!a?.length)return o;if(c){if(!f(a))throw new Error("source is not an array of objects");for(const g of c)o.fields.push(r(g,a.map(l=>l&&l[g])));return o}if(a.find(g=>g)===null)return o;if(f(a)){const g=a.find(l=>l);o.fields=Object.keys(g||{}).map(l=>r(l,a.map(p=>p&&p[l])))}else o.fields.push(r(t.Bc,a));return o}function r(a,c){const o={name:a,config:{},values:c,type:t.PU.other};return o.type=(0,n.dF)(o)??t.PU.other,o}function f(a){const c=a.find(o=>o);return a.length>0&&typeof c=="object"}},33526:(G,O,e)=>{"use strict";e.d(O,{x:()=>i});var t=e(36120),n=e(37471);class i extends n.k{constructor(r){super(void 0,f=>new t.$({...r,buffer:f}))}}},89667:(G,O,e)=>{"use strict";e.d(O,{EL:()=>r,Nw:()=>c,or:()=>a,t:()=>s});var t=e(11261),n=e(14236);const i={Inf:1/0,NegInf:-1/0,Undef:void 0,NaN:NaN};function s(o,h){let g;for(g in o){const l=i[g];for(const p of o[g])p<h.length&&(h[p]=l)}}function r(o,h){for(let g=0;g<h.length;g++)h[g]=o[Number(h[g])]}function f(o,h){for(const g of h)if(g!=null)return(0,n.by)(o,g);return t.PU.other}function a(o){const{schema:h,data:g}=o;if(!h||!h.fields)throw new Error("JSON needs a fields definition");const l=g?g.values.reduce((m,y)=>Math.max(m,y.length),0):0,p=h.fields.map((m,y)=>{let d=g?g.values[y]:[],v=d.length,u=m.type;v!==l&&(d.length=l,d.fill(void 0,v));let D=g?.entities?.[y];D&&s(D,d);let P=g?.enums?.[y];P&&(r(P,d),u=t.PU.string);const x=g?.nanos?.[y],E={...m,type:u??f(m.name,d),config:m.config??{},values:d,entities:D??{}};return x!=null&&(E.nanos=x),E});return{...h,fields:p,length:l}}function c(o){const h={values:[]},g=[];let l=!1;const p={refId:o.refId,meta:o.meta,name:o.name,fields:o.fields.map(m=>{const{values:y,nanos:d,state:v,display:u,...D}=m;return"entities"in D&&delete D.entities,h.values.push(y),d!=null?(g.push(d),l=!0):g.push(null),D})};return l&&(h.nanos=g),{schema:p,data:h}}},78368:(G,O,e)=>{"use strict";e.d(O,{R:()=>n});var t=e(18008);class n extends t.F{constructor(s){super(),this.data=s,this.index=0;const r={},f={};for(let a=0;a<s.fields.length;a++){const c=s.fields[a];if(!c.name)continue;f[c.name]=c;const o=()=>c.values.get(this.index);r.hasOwnProperty(c.name)||Object.defineProperty(r,c.name,{enumerable:!0,get:o}),r.hasOwnProperty(a.toString())||Object.defineProperty(r,a,{enumerable:!1,get:o})}this.obj=r,this.fields=f}get dataFrame(){return this.data}get length(){return this.data.length}getFieldDisplayProcessor(s){if(!this.dataFrame||!this.dataFrame.fields)return;const r=this.dataFrame.fields[s];if(!(!r||!r.display))return r.display}get(s){return this.index=s,this.obj}toArray(){return new Array(this.data.length).fill(0).map((s,r)=>({...this.get(r)}))}}},85404:(G,O,e)=>{"use strict";e.d(O,{L:()=>i});var t=e(11261),n=e(14236);class i{constructor(r){this.fields=[],this.fieldByName={},this.fieldByType={},this.fields=r.fields.map((f,a)=>({...f,index:a}));for(let f=0;f<r.fields.length;f++){const a=r.fields[f];if(a.type===t.PU.other){const c=(0,n.dF)(a);c&&(a.type=c)}this.fieldByType[a.type]||(this.fieldByType[a.type]=[]),this.fieldByType[a.type].push({...a,index:f}),this.fieldByName[a.name]?console.warn("Duplicate field names in DataFrame: ",a.name):this.fieldByName[a.name]={...a,index:f}}}getFields(r){if(!r)return[...this.fields];const f=this.fieldByType[r];return f?[...f]:[]}hasFieldOfType(r){const f=this.fieldByType[r];return f&&f.length>0}getFirstFieldOfType(r,f=!1){return this.fieldByType[r]?.find(o=>f||!o.config.custom?.hidden)}hasFieldNamed(r){return!!this.fieldByName[r]}hasFieldWithNameAndType(r,f){return!!this.fieldByName[r]&&this.fieldByType[f].filter(a=>a.name===r).length>0}getFieldByName(r){return this.fieldByName[r]}getFieldsByLabel(r,f){return Object.values(this.fieldByName).filter(a=>a.labels&&a.labels[r]===f)}}},37471:(G,O,e)=>{"use strict";e.d(O,{p:()=>f,k:()=>a});var t=e(2543),n=e(11261),i=e(14236);function s(c,o){return o.type||(o.name==="time"||o.name==="Time"?o.type=n.PU.time:o.type=(0,i.HW)(c)),o.type===n.PU.number?h=>parseFloat(h):o.type===n.PU.boolean?h=>!(h[0]==="F"||h[0]==="f"||h[0]==="0"):h=>h}var r=e(18008);const f=void 0;class a extends r.F{constructor(o,h){if(super(),this.fields=[],this.first=[],this.parsers=void 0,this.creator=h||(g=>g??[]),o){const{name:g,refId:l,meta:p,fields:m}=o;if(g&&(this.name=g),l&&(this.refId=l),p&&(this.meta=p),m)for(const y of m)this.addField(y)}Object.defineProperty(this,"length",{enumerable:!0,get:()=>this.first.length})}get length(){return this.first.length}addFieldFor(o,h){return this.addField({name:h||"",type:(0,i.HW)(o)})}addField(o,h){let g;o.values&&(g=o.values);let l=o.type;!l&&(o.name==="time"||o.name==="Time")?l=n.PU.time:(!l&&g&&g.length&&(l=(0,i.HW)(g[0])),l||(l=n.PU.other));let p=o.name;p||(p=`Field ${this.fields.length+1}`);const m={...o,name:p,type:l,config:o.config||{},values:this.creator(g)};if(l===n.PU.other&&(l=(0,i.dF)(m),l&&(m.type=l)),this.fields.push(m),this.first=this.fields[0].values,h)for(;m.values.length<h;)m.values.push(f);else this.validate();return m}validate(){const o=this.fields.reduce((h,g)=>Math.max(h,g.values.length),0);for(const h of this.fields)for(;h.values.length!==o;)h.values.push(f)}setParser(o,h){return this.parsers||(this.parsers=new Map),this.parsers.set(o,h),h}parseValue(o,h){let g=this.parsers?.get(o);return g||(g=this.setParser(o,s(h,o))),g(h)}appendRow(o){for(let h=this.fields.length;h<o.length;h++)this.addField({name:`Field ${h+1}`,type:(0,i.HW)(o[h])});if(this.length<1)for(let h=0;h<this.fields.length;h++){const g=this.fields[h];(!g.type||g.type===n.PU.other)&&(g.type=(0,i.HW)(o[h]))}for(let h=0;h<this.fields.length;h++){const g=this.fields[h];let l=o[h];g.type!==n.PU.string&&(0,t.isString)(l)&&(l=this.parseValue(g,l)),g.values.push(l)}}push(...o){for(const h of o)this.add(h);return this.length}reverse(){for(const o of this.fields)o.values.reverse();return this}add(o){const h=o;for(const g of this.fields){let l=h[g.name];g.type!==n.PU.string&&(0,t.isString)(l)&&(l=this.parseValue(g,l)),l===void 0&&(l=f),g.values.push(l)}}set(o,h){if(o>this.length)throw new Error("Unable to set value beyond current length");const g=h||{};for(const l of this.fields)l.values[o]=g[l.name]}get(o){const h={};for(const g of this.fields)h[g.name]=g.values[o];return h}toJSON(){return(0,i.Kl)(this)}}},9631:(G,O,e)=>{"use strict";e.d(O,{Kh:()=>a,Ls:()=>p,k9:()=>h,m8:()=>g,wC:()=>y});var t=e(73060),n=e(11261),i=e(8249),s=e(43659),r=e(89667),f=e(14236),a=(P=>(P.Append="append",P.Replace="replace",P))(a||{});const c="__name__";var o=(P=>(P[P.wide=0]="wide",P[P.labels=1]="labels",P))(o||{});class h{constructor(x){this.options=x,this.meta={},this.fields=[],this.length=0,this.schemaFields=[],this.timeFieldIndex=-1,this.pushMode=0,this.labels=new Set,this.packetInfo={schemaChanged:!0,number:0,action:"replace",length:0},this.serialize=(E,C,M)=>{const S=C?Object.assign({},{...this.options,...C}):this.options,I=(0,f.By)(this,E),T=u(I.fields.map(R=>R.values??[]),typeof M?.maxLength=="number"?Math.min(M.maxLength,S.maxLength):S.maxLength,this.timeFieldIndex,S.maxDelta);I.fields=I.fields.map(R=>({...R,values:R.values?.slice(T)}));const b=I.fields[0]?.values?.length??0;return{...I,labels:this.labels,schemaFields:this.schemaFields,name:this.name,refId:this.refId,meta:this.meta,length:b,timeFieldIndex:this.timeFieldIndex,pushMode:this.pushMode,packetInfo:this.packetInfo,options:S}},this.initFromSerialized=E=>{this.name=E.name,this.refId=E.refId,this.meta=E.meta,this.length=E.length,this.labels=E.labels,this.schemaFields=E.schemaFields,this.timeFieldIndex=E.timeFieldIndex,this.pushMode=E.pushMode,this.packetInfo.length=E.packetInfo.length,this.packetInfo.number=E.packetInfo.number,this.packetInfo.action="replace",this.packetInfo.schemaChanged=!0,this.fields=E.fields.map(C=>({...C,type:C.type??n.PU.other,config:C.config??{},values:C.values??[]})),v(this.fields.map(C=>C.values),this.options.maxLength,this.timeFieldIndex,this.options.maxDelta)},this.needsResizing=({maxLength:E,maxDelta:C})=>{const M=E&&this.options.maxLength<E,S=C&&this.options.maxDelta<C,I=C&&this.options.maxDelta===1/0;return!!(M||S||I)},this.resize=({maxLength:E,maxDelta:C})=>{C&&(this.options.maxDelta===1/0?this.options.maxDelta=C:this.options.maxDelta=Math.max(C,this.options.maxDelta)),this.options.maxLength=Math.max(this.options.maxLength,E??0)},this.pushNewValues=E=>{if(!E?.length)return;this.packetInfo.action=this.options.action,this.packetInfo.number++,this.packetInfo.length=E[0].length,this.packetInfo.schemaChanged=!1,this.options.action==="append"?d(this.fields.map(M=>M.values),E,this.options.maxLength,this.timeFieldIndex,this.options.maxDelta):(E.forEach((M,S)=>{this.fields[S]&&(this.fields[S].values=M)}),v(this.fields.map(M=>M.values),this.options.maxLength,this.timeFieldIndex,this.options.maxDelta));const C=this.fields?.[0]?.values.length;C!==void 0&&(this.length=C)},this.resetStateCalculations=()=>{this.fields.forEach(E=>{E.state={...E.state??{},calcs:void 0,range:void 0}})},this.getMatchingFieldIndexes=E=>this.fields.map((C,M)=>E(C)?M:void 0).filter(C=>C!==void 0),this.getValuesFromLastPacket=()=>this.fields.map(E=>{const C=E.values;return C.slice(Math.max(C.length-this.packetInfo.length))}),this.hasAtLeastOnePacket=()=>!!this.packetInfo.length,this.getOptions=()=>this.options,Object.defineProperty(this,"length",{enumerable:!0}),Object.defineProperty(this,"fields",{enumerable:!0})}static{this.deserialize=x=>{const E=new h(x.options);return E.initFromSerialized(x),E}}static{this.empty=x=>new h(g(x))}static{this.fromDataFrameJSON=(x,E)=>{const C=new h(g(E));return C.push(x),C}}get alwaysReplace(){return this.options.action==="replace"}push(x){const{schema:E,data:C}=x;if(this.packetInfo.number++,this.packetInfo.length=0,this.packetInfo.schemaChanged=!1,E){this.pushMode=0,this.timeFieldIndex=E.fields.findIndex(T=>T.type===n.PU.time);const M=E.fields[0];this.timeFieldIndex===1&&M.type===n.PU.string&&(M.name==="labels"||M.name==="Labels")&&(this.pushMode=1,this.timeFieldIndex=0);const S=this.pushMode===1?E.fields.slice(1):E.fields;this.refId=E.refId,E.meta&&(this.meta={...E.meta});const{displayNameFormat:I}=this.options;if(D(this.schemaFields,S)){const T=S.length;this.fields.forEach((b,R)=>{const A=S[R%T];b.config=A.config??{},b.labels=A.labels}),I&&this.fields.forEach(b=>{const R={[c]:b.name,...b.labels};b.config.displayNameFromDS=(0,s.j)(I,R)})}else{this.packetInfo.schemaChanged=!0;const T=this.pushMode===0;this.fields=S.map(b=>{const R=b.config??{};if(I){const A={[c]:b.name,...b.labels};R.displayNameFromDS=(0,s.j)(I,A)}return{config:R,name:b.name,labels:b.labels,type:b.type??n.PU.other,values:T?this.fields.find(A=>A.name===b.name&&b.type===A.type)?.values??Array(this.length).fill(void 0):[]}})}this.schemaFields=S}if(C&&C.values.length&&C.values[0].length){let{values:M,entities:S}=C;if(S&&S.forEach((T,b)=>{T&&(0,r.t)(T,M[b])}),this.pushMode===1){const T=l(M);for(const A of T.keys())this.labels.has(A)||(this.packetInfo.schemaChanged=!0,this.addLabel(A));let b=Array(this.schemaFields.length).fill([]),R=[];this.labels.forEach(A=>{R.push(T.get(A)??b)}),M=(0,t.fj)(R)}if(M.length!==this.fields.length){if(this.fields.length)throw new Error(`push message mismatch.  Expected: ${this.fields.length}, received: ${M.length} (labels=${this.pushMode===1})`);this.fields=M.map((T,b)=>{let R=`Field ${b}`,A=(0,f.HW)(T[0]);return b===0&&A===n.PU.number&&T[0]>1600016688632&&(A=n.PU.time,R="Time"),{name:R,type:A,config:{},values:[]}})}let I=M;this.packetInfo.length=M[0].length,this.alwaysReplace||!this.length?this.packetInfo.action="replace":(this.packetInfo.action="append",I=this.fields.map(T=>T.values),d(I,M,this.options.maxLength,this.timeFieldIndex,this.options.maxDelta)),I.forEach((T,b)=>{const R=this.fields[b],{state:A}=R;R.values=T,A&&(A.calcs=void 0)}),this.length=I[0].length}return{...this.packetInfo}}addLabel(x){const{displayNameFormat:E}=this.options,C=this.labels.size,M=m(x);if(C===0)this.fields.forEach((S,I)=>{if(I>0&&(S.labels=M,E)){const T={[c]:S.name,...M};S.config.displayNameFromDS=(0,s.j)(E,T)}});else for(let S=1;S<this.schemaFields.length;S++){let I=this.schemaFields[S];const T=I.config??{};if(E){const b={[c]:I.name,...M};T.displayNameFromDS=(0,s.j)(E,b)}this.fields.push({...I,config:T,labels:M,values:Array(this.length).fill(void 0)})}this.labels.add(x)}}function g(P){return{maxLength:P?.maxLength??1e3,maxDelta:P?.maxDelta??1/0,action:P?.action??"append",displayNameFormat:P?.displayNameFormat}}function l(P){let x=new Set(P[0]),E=new Map;x.forEach(C=>{let M=Array(P.length-1).fill(null).map(()=>[]);E.set(C,M)});for(let C=0;C<P[0].length;C++){let M=E.get(P[0][C]);for(let S=1;S<P.length;S++)M[S-1].push(P[S][C])}return E}function p(P,x,E,C){let M;E=E||0,C=C||x.length-1;let S=C<=2147483647;for(;C-E>1;)M=S?E+C>>1:Math.floor((E+C)/2),x[M]<P?E=M:C=M;return P-x[E]<=x[C]-P?E:C}function m(P){if(!P.length)return{};if(P.charAt(0)==="{")return(0,i.Xy)(P);const x={};return P.split(",").forEach(E=>{const[C,M]=E.trim().split("=");x[C]=M}),x}function y(P){const x=P.packetInfo;return x?.action?x:void 0}function d(P,x,E=1/0,C=0,M=1/0){for(let S=0;S<P.length;S++)for(let I=0;I<x[S].length;I++)P[S].push(x[S][I]);return v(P,E,C,M)}function v(P,x=1/0,E=0,C=1/0){const M=u(P,x,E,C);if(M)for(let S=0;S<P.length;S++)P[S].splice(0,M);return M}function u(P,x=1/0,E=0,C=1/0){if(!P[0]?.length)return 0;const M=P[0].length;let S=0;if(M>x&&(S=M-x),C!==1/0&&E>=0){const I=P[E],T=I[S],b=I[M-1];b-T>C&&(S=p(b-C,I,S))}return S}function D(P,x){if(P?.length!==x.length)return!1;for(let E=0;E<P.length;E++){const C=P[E],M=x[E];if(C.name!==M.name||C.type!==M.type)return!1}return!0}},61443:(G,O,e)=>{"use strict";e.d(O,{Km:()=>r,P4:()=>i,WK:()=>s,g6:()=>n,r4:()=>t,xB:()=>f});const t=(a,c)=>({name:a,columns:c}),n=a=>a.columns,i=(a,c)=>a.columns[c],s=(a,c,o)=>a.columns[c].values[o],r=(a,c,o)=>a.columns.map(h=>h.values[o]),f=(a,c)=>a[c]},21423:(G,O,e)=>{"use strict";e.d(O,{J3:()=>s,ab:()=>f,bW:()=>i});var t=e(2543),n=e.n(t);function i(a,c,o){if(a===c)return!0;if(a?.fields?.length!==c?.fields?.length||a.name!==c.name)return!1;for(let h=0;h<a.fields.length;h++){const g=a.fields[h],l=c.fields[h];if(g.type!==l.type||g.name!==l.name)return!1;if(o)continue;if(g.labels&&l.labels&&!f(g.labels,l.labels))return!1;const p=g.config,m=l.config;if(Object.keys(p).length!==Object.keys(m).length)return!1;let y;for(y in p){if(!(y in m))return!1;if(y!=="interval"&&!(0,t.isEqual)(p[y],m[y]))return!1}}return!0}function s(a,c,o){if(a===c)return!0;if(a?.length!==c?.length)return!1;for(let h=0;h<a.length;h++)if(!o(a[h],c[h]))return!1;return!0}const r=(a,c)=>a===c;function f(a,c,o=r){if(a===c)return!0;if(Object.keys(a).length!==Object.keys(c).length)return!1;let h;for(h in a)if(!o(a[h],c[h]))return!1;return!0}},14236:(G,O,e)=>{"use strict";e.d(O,{Bt:()=>U,By:()=>R,EI:()=>w,ES:()=>S,HW:()=>v,KR:()=>A,Kl:()=>b,LI:()=>E,N$:()=>W,Vc:()=>C,XQ:()=>D,Yn:()=>T,by:()=>y,ci:()=>x,dF:()=>u,oE:()=>d,pH:()=>P,q7:()=>I,w3:()=>M});var t=e(2543),n=e.n(t),i=e(47232),s=e(48241),r=e(28240),f=e(39070),a=e(11261),c=e(33948),o=e(89667);function h(N){const B=N.columns.map(V=>{const{text:K,type:H,...X}=V,k=[];return{name:K?.length?K:V,config:X||{},values:k,type:H&&Object.values(a.PU).includes(H)?H:a.PU.other}});if(!(0,t.isArray)(N.rows))throw new Error(`Expected table rows to be array, got ${typeof N.rows}.`);for(const V of N.rows)for(let K=0;K<B.length;K++)B[K].values.push(V[K]);for(const V of B)if(V.type===a.PU.other){const K=u(V);K&&(V.type=K)}return{fields:B,refId:N.refId,meta:N.meta,name:N.name,length:N.rows.length}}function g(N){const B=[],V=[],K=N.datapoints||N.points;for(const X of K)V.push(X[0]),B.push(X[1]);const H=[{name:a.LE,type:a.PU.time,config:{},values:B},{name:a.Bc,type:a.PU.number,config:{unit:N.unit},values:V,labels:N.tags}];return N.title&&(H[1].config.displayNameFromDS=N.title),{name:N.target||N.name,refId:N.refId,meta:N.meta,fields:H,length:V.length}}function l(N){const B=[],V=[];for(let K=0;K<N.data.length;K++){const H=N.data[K];B.push(H[1]),V.push(H[0])}return{name:N.label,fields:[{name:N.label||a.Bc,type:a.PU.number,config:{},values:B},{name:a.LE,type:a.PU.time,config:{unit:"dateTimeAsIso"},values:V}],length:B.length}}function p(N){const B=[{name:N.target,type:a.PU.other,labels:N.tags,config:{unit:N.unit,filterable:N.filterable},values:[]}];for(const V of N.datapoints)B[0].values.push(V);return{name:N.target,refId:N.target,meta:{json:!0},fields:B,length:N.datapoints.length}}const m=/^\s*(-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?|NAN)\s*$/i;function y(N,B){return N&&(N=N.toLowerCase(),N==="date"||N==="time")?a.PU.time:v(B)}function d(N){return N instanceof Date||(0,i.Ar)(N)?a.PU.time:(0,t.isNumber)(N)?a.PU.number:(0,t.isString)(N)?a.PU.string:(0,t.isBoolean)(N)?a.PU.boolean:a.PU.other}function v(N){return N instanceof Date||(0,i.Ar)(N)?a.PU.time:(0,t.isNumber)(N)?a.PU.number:(0,t.isString)(N)?m.test(N)?a.PU.number:N==="true"||N==="TRUE"||N==="True"||N==="false"||N==="FALSE"||N==="False"?a.PU.boolean:a.PU.string:(0,t.isBoolean)(N)?a.PU.boolean:a.PU.other}function u(N){if(N.name){const B=N.name.toLowerCase();if(B==="date"||B==="time")return a.PU.time}for(let B=0;B<N.values.length;B++){const V=N.values[B];if(V!=null)return v(V)}}const D=(N,B=!1)=>{for(const V of N.fields)if(!V.type||V.type===a.PU.other||B)return{...N,fields:N.fields.map(K=>K.type&&K.type!==a.PU.other&&!B?K:{...K,type:u(K)||a.PU.other})};return N},P=N=>!!(N&&N.hasOwnProperty("columns")),x=N=>!!(N&&N.hasOwnProperty("fields")),E=N=>!!(x(N)&&N.hasOwnProperty("value"));function C(N){if("fields"in N)return"length"in N&&N.fields[0]?.values?.get?N:w(N);if(N.hasOwnProperty("type")&&N.type==="docs")return p(N);if(N.hasOwnProperty("datapoints")||N.hasOwnProperty("points"))return g(N);if(N.hasOwnProperty("data"))return N.hasOwnProperty("schema")?(0,o.or)(N):l(N);if(N.hasOwnProperty("columns"))return h(N);if(Array.isArray(N))return(0,c.I)(N);throw console.warn("Can not convert",N),new Error("Unsupported data format")}const M=N=>{const{fields:B}=N,V=N.length,K=[];if(B.length===2){const{timeField:H,timeIndex:X}=A(N);if(H){const Y=B[X===0?1:0],Z=B[X];for(let se=0;se<V;se++)K.push([Y.values[se],Z.values[se]]);return{alias:N.name,target:(0,r.Ct)(Y,N),datapoints:K,unit:B[0].config?B[0].config.unit:void 0,refId:N.refId,meta:N.meta}}}for(let H=0;H<V;H++){const X=[];for(let k=0;k<B.length;k++)X.push(B[k].values[H]);K.push(X)}return N.meta&&N.meta.json?{alias:B[0].name||N.name,target:B[0].name||N.name,datapoints:B[0].values,filterable:B[0].config?B[0].config.filterable:void 0,type:"docs"}:{columns:B.map(H=>{const{name:X,config:k}=H;if(k){const{...Y}=k;return Y.text=X,Y}return{text:X}}),type:"table",refId:N.refId,meta:N.meta,rows:K}};function S(N,B,V=!1){const K=N.fields[B];if(!K)return N;const H=[];for(let k=0;k<N.length;k++)H.push(k);const X=(0,s.i)(K,V);return H.sort(X),{...N,fields:N.fields.map(k=>{const Y={...k,values:k.values.map((se,j)=>k.values[H[j]])},{nanos:Z}=k;return Z!==void 0&&(Y.nanos=Z.map((se,j)=>Z[H[j]])),Y})}}function I(N){return{...N,fields:N.fields.map(B=>{const V=[...B.values];V.reverse();const K={...B,values:V},{nanos:H}=B;if(H!==void 0){const X=[...H];X.reverse(),K.nanos=X}return K})}}function T(N,B){const V=[];for(const K of N.fields)V.push(K.values[B]);return V}function b(N){return R(N)}function R(N,B){return{fields:(B?N.fields.filter(B):N.fields).map(H=>{let X=H.values;return{name:H.name,type:H.type,config:H.config,values:X,labels:H.labels}}),refId:N.refId,meta:N.meta,name:N.name}}const A=N=>{for(let B=0;B<N.fields.length;B++)if(N.fields[B].type===a.PU.time)return{timeField:N.fields[B],timeIndex:B};return{}};function L(N){const B=D(C(N));if(B.fields&&B.fields.length)for(const V of B.fields)V.state=null;return B}function U(N){return!N||!(0,t.isArray)(N)?[]:N.map(B=>L(B))}function W(N,B){const{series:V,annotations:K}=N;if(N.state===f.Gu.Loading&&V.length===0)return B||(B=N),{...B,state:f.Gu.Loading,request:N.request};const H=performance.now(),X=V.map(Z=>L(Z)),k=U(K),Y=performance.now();return{...N,series:X,annotations:k,timings:{dataProcessingTime:Y-H}}}function w(N){let B=0;const V=N.fields.map((K,H)=>{const{state:X,...k}=K;return k.name||(k.name=`Field ${H+1}`),k.config||(k.config={}),k.values?k.values.length>B&&(B=k.values.length):k.values=new Array(B),k.type||(k.type=u(k)??a.PU.other),k});return{...N,fields:V,length:B}}},19845:(G,O,e)=>{"use strict";e.d(O,{S1:()=>c,aH:()=>s,hF:()=>f,jq:()=>r,t9:()=>o,tP:()=>a,uY:()=>h});var t=e(11261),n=e(14236);const i=100;function s(g){if(g.fields.length<2)return!1;const l=g.fields.find(m=>m.type===t.PU.number);let p=!1;for(const m of g.fields)if(f(m)){p=!0;break}return p&&l!==void 0}function r(g){return!g.find(l=>!s(l))}function f(g){if(g.type!==t.PU.time)return!1;let l=null,p=g.values.length>i?i:g.values.length;for(let m=0;m<p;m++){const y=g.values[m];if(l===null||y!==null&&y>l)l=y;else return!1}return!0}function a(g){for(let l=0;l<g.length;l++){const p=(0,n.KR)(g[l]);if(p.timeField!==void 0&&p.timeIndex!==void 0)return!0}return!1}function c(g){return g.fields.some(l=>l.type===t.PU.time)}function o(g,l){if(g.meta?.uniqueRowIdFields!==void 0)return g.meta.uniqueRowIdFields.map(p=>g.fields[p].values[l]).join("-")}function h(g,l){if(l instanceof Array)for(let p=0;p<l.length;p++)g.fields[p].values.push(l[p]);else for(const p of g.fields)p.values.push(l[p.name]);try{g.length++}catch{}}},1933:(G,O,e)=>{"use strict";e.d(O,{G:()=>r,O:()=>f});var t=e(2543),n=e.n(t),i=e(43127);let s=()=>i.lE;const r=a=>{s=a??s},f=a=>a?.timeZone&&!(0,t.isEmpty)(a.timeZone)?a.timeZone:s()??i.lE},85858:(G,O,e)=>{"use strict";e.r(O),e.d(O,{isMathString:()=>r,isValid:()=>a,parse:()=>f,parseDateMath:()=>c,roundToFiscal:()=>o});var t=e(2543),n=e.n(t),i=e(47232);const s=["y","M","w","d","h","m","s","Q"];function r(h){return h?!!(typeof h=="string"&&(h.substring(0,3)==="now"||h.includes("||"))):!1}function f(h,g,l,p){if(h){if(typeof h!="string")return(0,i.Ar)(h)?h:(0,t.isDate)(h)?(0,i.KQ)(h):void 0;{let m,y="",d,v;return h.substring(0,3)==="now"?(m=(0,i.oZ)(l),y=h.substring(3)):(d=h.indexOf("||"),d===-1?(v=h,y=""):(v=h.substring(0,d),y=h.substring(d+2)),m=(0,i.KQ)(v,i.mt)),y.length?c(y,m,g,p):m}}}function a(h){const g=f(h);return g&&(0,i.Ar)(g)?g.isValid():!1}function c(h,g,l,p=0){const m=h.replace(/\s/g,""),y=(0,i.KQ)(g);let d=0;const v=m.length;for(;d<v;){const u=m.charAt(d++);let D,P,x,E=!1;if(u==="/")D=0;else if(u==="+")D=1;else if(u==="-")D=2;else return;if(isNaN(parseInt(m.charAt(d),10)))P=1;else if(m.length===2)P=parseInt(m.charAt(d),10);else{const M=d;for(;!isNaN(parseInt(m.charAt(d),10));)if(d++,d>10)return;P=parseInt(m.substring(M,d),10)}if(D===0&&P!==1)return;x=m.charAt(d++),x==="f"&&(x=m.charAt(d++),E=!0);const C=x;if((0,t.includes)(s,C))D===0?E?o(p,y,C,l):l?y.endOf(C):y.startOf(C):D===1?y.add(P,C):D===2&&y.subtract(P,C);else return}return y}function o(h,g,l,p){switch(l){case"y":return p?o(h,g,l,!1).add(11,"M").endOf("M"):g.subtract((g.month()-h+12)%12,"M").startOf("M"),g;case"Q":return p?o(h,g,l,!1).add(2,"M").endOf("M"):g.subtract((g.month()-h+12)%3,"M").startOf("M"),g;default:return}}},70416:(G,O,e)=>{"use strict";e.d(O,{E9:()=>f,Ri:()=>a,V3:()=>l,WT:()=>c,dU:()=>r,di:()=>h,pp:()=>g,vd:()=>o});var t=e(89369),n=e(68284),i=e(25579);const s={years:["y","Y","years"],months:["M","months"],weeks:["w","W","weeks"],days:["d","D","days"],hours:["h","H","hours"],minutes:["m","minutes"],seconds:["s","S","seconds"]};function r(m,y=!0){if((0,t.d)(m.start,m.end))return"";const d=(0,n.F)(m);return Object.entries(d).reduce((v,[u,D])=>D&&D!==0&&!(u==="seconds"&&!y&&v)?v+`${v!==""?" ":""}${D}${s[u][0]}`:v,"")}function f(m){return m.split(" ").reduce((y,d)=>{const v=d.match(/(\d+)(.+)/),u=v?.[1],D=v?.[2];if(!(u&&D))return y;const P=Object.entries(s).find(([E,C])=>C?.includes(v[2])),x=parseInt(u,10);return P?{...y,[P[0]]:x}:y},{})}function a(m,y){return(0,i.W)(m,y)}function c(m){const y=new Date;return a(y,m).getTime()-y.getTime()}function o(m){return!isNaN(Date.parse(m))}function h(m){for(const y of m.trim().split(" ")){const d=y.match(/(\d+)(.+)/);if(d===null||d.length!==3||!Object.entries(s).find(([u,D])=>D?.includes(d[2]))?.[0])return!1}return!0}function g(m){return p(m,["h","m","s","ms","us","\xB5s","ns"])}function l(m){return p(m,["y","M","w","d","h","m","s","ms","us","\xB5s","ns"])}function p(m,y){for(const d of m.trim().split(" ")){const v=d.match(/([0-9]*[.]?[0-9]+)(.+)/);if(v===null||v.length!==3||!y.includes(v[2]))return!1}return!0}},42994:(G,O,e)=>{"use strict";e.d(O,{JE:()=>i,Od:()=>s,WC:()=>r});const t="YYYY-MM-DD HH:mm:ss",n="YYYY-MM-DD HH:mm:ss.SSS";class i{constructor(){this.fullDate=t,this.fullDateMS=n,this.interval={millisecond:"HH:mm:ss.SSS",second:"HH:mm:ss",minute:"HH:mm",hour:"MM/DD HH:mm",day:"MM/DD",month:"YYYY-MM",year:"YYYY"}}update(c){this.fullDate=c.fullDate,this.interval=c.interval,c.useBrowserLocale&&this.useBrowserLocale()}useBrowserLocale(){this.fullDate=s({year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),this.fullDateMS=this.fullDate.replace("ss","ss.SSS"),this.interval.millisecond=s({hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1},null,this.interval.second).replace("ss","ss.SSS"),this.interval.second=s({hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1},null,this.interval.second),this.interval.minute=s({hour:"2-digit",minute:"2-digit",hour12:!1},null,this.interval.minute),this.interval.hour=s({month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1},null,this.interval.hour),this.interval.day=s({month:"2-digit",day:"2-digit",hour12:!1},null,this.interval.day),this.interval.month=s({year:"numeric",month:"2-digit",hour12:!1},null,this.interval.month)}getTimeFieldUnit(c){return`time:${c?this.fullDateMS:this.fullDate}`}}function s(a,c,o){if(f())return o??t;!c&&navigator&&(c=[...navigator.languages]);const h=new Intl.DateTimeFormat(c||void 0,a),g=h.formatToParts(new Date),p={year:"YYYY",month:"MM",day:"DD",hour:h.resolvedOptions().hour12?"hh":"HH",minute:"mm",second:"ss",weekday:"ddd",era:"N",dayPeriod:"A",timeZoneName:"Z"};return g.map(m=>p[m.type]||m.value).join("")}const r=new i,f=()=>!("DateTimeFormat"in Intl)||!("formatToParts"in Intl.DateTimeFormat.prototype)},72724:(G,O,e)=>{"use strict";e.d(O,{LE:()=>f,M7:()=>a,_Q:()=>o,fq:()=>c,jw:()=>h});var t=e(84743),n=e.n(t),i=e(1933),s=e(42994),r=e(47232);const f=(p,m)=>l(p,(0,i.O)(m)).format(g(m)),a=(p,m)=>l(p,(0,i.O)(m)).format(),c=(p,m)=>l(p,(0,i.O)(m)).fromNow(),o=(p,m)=>l(p,(0,i.O)(m)).format(`${s.WC.fullDate} z`),h=(p,m)=>l(p,(0,i.O)(m)).format("z"),g=p=>p?.defaultWithMS?p?.format??s.WC.fullDateMS:p?.format??s.WC.fullDate,l=(p,m)=>{const y=p,d=n().tz.zone(m);if(d&&d.name)return(0,r.AN)((0,r.yT)(y)).tz(d.name);switch(m){case"utc":return(0,r.AN)((0,r.yT)(y));default:return(0,r.AN)((0,r.yT)(y)).local()}}},47232:(G,O,e)=>{"use strict";e.d(O,{$D:()=>d,AN:()=>l,Ah:()=>h,Ar:()=>c,JK:()=>r,KQ:()=>g,XN:()=>f,mt:()=>i,oZ:()=>p,pp:()=>y,u8:()=>a,xQ:()=>m,xS:()=>s,yT:()=>o});var t=e(95093),n=e.n(t);const i=n().ISO_8601,s=v=>{n().locale(v)},r=()=>n().locale(),f=()=>n().localeData(),a=v=>v===null||typeof v=="string"||typeof v=="number"||v instanceof Date||Array.isArray(v)&&v.every(u=>typeof u=="string"||typeof u=="number")||c(v),c=v=>n().isMoment(v),o=(v,u)=>n().utc(v,u),h=(v,u)=>n().duration(v,u),g=(v,u)=>n()(v,u),l=v=>g(v),p=(v,u,D)=>{if(v&&v!=="browser"){let P;if(typeof u=="string"&&D?P=n().tz(u,D,v):P=n().tz(u,v),c(P))return P}return g(u,D)},m=v=>n().weekdays().findIndex(u=>u.toLowerCase()===v.toLowerCase()),y=v=>["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].findIndex(u=>u.toLowerCase()===v.toLowerCase()),d=v=>{const u="-weekStart",D=r().replace(u,""),P=v?y(v):-1;P!==-1?n().locale(D+u,{parentLocale:D,week:{dow:P}}):s(D)}},53531:(G,O,e)=>{"use strict";e.d(O,{b:()=>o});var t=e(2543),n=e.n(t),i=e(84743),s=e.n(i),r=e(1933),f=e(85858),a=e(42994),c=e(47232);const o=(l,p)=>(0,c.Ar)(l)?l:typeof l=="string"?h(l,p):g(l,p),h=(l,p)=>{if(l.indexOf("now")!==-1)return(0,f.isValid)(l)&&(0,f.parse)(l,p?.roundUp,p?.timeZone,p?.fiscalYearStartMonth)||(0,c.KQ)();const m=(0,r.O)(p),y=s().tz.zone(m),d=p?.format??a.WC.fullDate;if(y&&y.name)return(0,c.oZ)(y.name,l,d);switch((0,t.lowerCase)(m)){case"utc":return(0,c.yT)(l,d);default:return(0,c.KQ)(l,d)}},g=(l,p)=>{const m=l,y=(0,r.O)(p),d=s().tz.zone(y);if(d&&d.name)return(0,c.oZ)(d.name,m);switch((0,t.lowerCase)(y)){case"utc":return(0,c.yT)(m);default:return(0,c.KQ)(m)}}},65879:(G,O,e)=>{"use strict";e.r(O),e.d(O,{calculateInterval:()=>x,convertRawToRange:()=>y,describeInterval:()=>M,describeTextRange:()=>g,describeTimeRange:()=>l,describeTimeRangeAbbreviation:()=>m,intervalToMs:()=>I,intervalToSeconds:()=>S,isFiscal:()=>v,isRelativeTime:()=>d,isRelativeTimeRange:()=>u,isValidTimeSpan:()=>p,msRangeToTimeString:()=>P,relativeToTimeRange:()=>R,roundInterval:()=>T,secondsToHms:()=>D,timeRangeToRelative:()=>b});var t=e(2543),n=e.n(t),i=e(85858),s=e(72724),r=e(47232),f=e(53531);const a={s:{display:"second"},m:{display:"minute"},h:{display:"hour"},d:{display:"day"},w:{display:"week"},M:{display:"month"},y:{display:"year"}},c=[{from:"now/d",to:"now/d",display:"Today"},{from:"now/d",to:"now",display:"Today so far"},{from:"now/w",to:"now/w",display:"This week"},{from:"now/w",to:"now",display:"This week so far"},{from:"now/M",to:"now/M",display:"This month"},{from:"now/M",to:"now",display:"This month so far"},{from:"now/y",to:"now/y",display:"This year"},{from:"now/y",to:"now",display:"This year so far"},{from:"now-1d/d",to:"now-1d/d",display:"Yesterday"},{from:"now-2d/d",to:"now-2d/d",display:"Day before yesterday"},{from:"now-7d/d",to:"now-7d/d",display:"This day last week"},{from:"now-1w/w",to:"now-1w/w",display:"Previous week"},{from:"now-1M/M",to:"now-1M/M",display:"Previous month"},{from:"now-1Q/fQ",to:"now-1Q/fQ",display:"Previous fiscal quarter"},{from:"now-1y/y",to:"now-1y/y",display:"Previous year"},{from:"now-1y/fy",to:"now-1y/fy",display:"Previous fiscal year"},{from:"now-5m",to:"now",display:"Last 5 minutes"},{from:"now-15m",to:"now",display:"Last 15 minutes"},{from:"now-30m",to:"now",display:"Last 30 minutes"},{from:"now-1h",to:"now",display:"Last 1 hour"},{from:"now-3h",to:"now",display:"Last 3 hours"},{from:"now-6h",to:"now",display:"Last 6 hours"},{from:"now-12h",to:"now",display:"Last 12 hours"},{from:"now-24h",to:"now",display:"Last 24 hours"},{from:"now-2d",to:"now",display:"Last 2 days"},{from:"now-7d",to:"now",display:"Last 7 days"},{from:"now-30d",to:"now",display:"Last 30 days"},{from:"now-90d",to:"now",display:"Last 90 days"},{from:"now-6M",to:"now",display:"Last 6 months"},{from:"now-1y",to:"now",display:"Last 1 year"},{from:"now-2y",to:"now",display:"Last 2 years"},{from:"now-5y",to:"now",display:"Last 5 years"},{from:"now/fQ",to:"now",display:"This fiscal quarter so far"},{from:"now/fQ",to:"now/fQ",display:"This fiscal quarter"},{from:"now/fy",to:"now",display:"This fiscal year so far"},{from:"now/fy",to:"now/fy",display:"This fiscal year"}],o=[{from:"now",to:"now+1m",display:"Next minute"},{from:"now",to:"now+5m",display:"Next 5 minutes"},{from:"now",to:"now+15m",display:"Next 15 minutes"},{from:"now",to:"now+30m",display:"Next 30 minutes"},{from:"now",to:"now+1h",display:"Next hour"},{from:"now",to:"now+3h",display:"Next 3 hours"},{from:"now",to:"now+6h",display:"Next 6 hours"},{from:"now",to:"now+12h",display:"Next 12 hours"},{from:"now",to:"now+24h",display:"Next 24 hours"},{from:"now",to:"now+2d",display:"Next 2 days"},{from:"now",to:"now+7d",display:"Next 7 days"},{from:"now",to:"now+30d",display:"Next 30 days"},{from:"now",to:"now+90d",display:"Next 90 days"},{from:"now",to:"now+6M",display:"Next 6 months"},{from:"now",to:"now+1y",display:"Next year"},{from:"now",to:"now+2y",display:"Next 2 years"},{from:"now",to:"now+5y",display:"Next 5 years"}],h={};(0,t.each)(c,A=>{h[A.from+" to "+A.to]=A}),(0,t.each)(o,A=>{h[A.from+" to "+A.to]=A});function g(A){const L=A.indexOf("+")!==0;A.indexOf("now")===-1&&(A=(L?"now-":"now")+A);let U=h[A+" to now"];if(U)return U;L?U={from:A,to:"now",display:""}:U={from:"now",to:A,display:""};const W=/^now([-+])(\d+)(\w)/.exec(A);if(W){const w=W[3],N=parseInt(W[2],10),B=a[w];B&&(U.display=L?"Last ":"Next ",U.display+=N+" "+B.display,U.section=B.section,N>1&&(U.display+="s"))}else U.display=U.from+" to "+U.to,U.invalid=!0;return U}function l(A,L){const U=h[A.from.toString()+" to "+A.to.toString()];if(U)return U.display;const W={timeZone:L};if((0,r.Ar)(A.from)&&(0,r.Ar)(A.to))return(0,s.LE)(A.from,W)+" to "+(0,s.LE)(A.to,W);if((0,r.Ar)(A.from)){const w=i.parse(A.to,!0,"utc");return w?(0,s.LE)(A.from,W)+" to "+(0,s.fq)(w,W):""}if((0,r.Ar)(A.to)){const w=i.parse(A.from,!1,"utc");return w?(0,s.fq)(w,W)+" to "+(0,s.LE)(A.to,W):""}return A.to.toString()==="now"?g(A.from).display:A.from.toString()+" to "+A.to.toString()}const p=A=>A.indexOf("$")===0||A.indexOf("+$")===0?!0:g(A).invalid!==!0,m=(A,L)=>{if((0,r.Ar)(A.from))return(0,s.jw)(A.from,{timeZone:L});const U=i.parse(A.from,!0);return U?(0,s.jw)(U,{timeZone:L}):""},y=(A,L,U,W)=>{const w=(0,f.b)(A.from,{roundUp:!1,timeZone:L,fiscalYearStartMonth:U,format:W}),N=(0,f.b)(A.to,{roundUp:!0,timeZone:L,fiscalYearStartMonth:U,format:W});return i.isMathString(A.from)||i.isMathString(A.to)?{from:w,to:N,raw:A}:{from:w,to:N,raw:{from:w,to:N}}};function d(A){return typeof A=="string"?A.indexOf("now")>=0:!1}function v(A){return typeof A.raw.from=="string"&&A.raw.from.indexOf("f")>0?!0:typeof A.raw.to=="string"&&A.raw.to.indexOf("f")>0}function u(A){return d(A.from)||d(A.to)}function D(A){const L=Math.floor(A/31536e3);if(L)return L+"y";const U=Math.floor(A%31536e3/86400);if(U)return U+"d";const W=Math.floor(A%31536e3%86400/3600);if(W)return W+"h";const w=Math.floor(A%31536e3%86400%3600/60);if(w)return w+"m";const N=Math.floor(A%31536e3%86400%3600%60);if(N)return N+"s";const B=Math.floor(A*1e3);return B?B+"ms":"less than a millisecond"}function P(A){const L=Number((A/1e3).toFixed()),U=Math.floor(L/60/60),W=Math.floor(L/60)-U*60,w=Number((L%60).toFixed());let N=U?U+"h":"",B=W?W+"min":"",V=w?w+"sec":"";return N&&B?N=N+" ":N=N,(B||N)&&V?B=B+" ":B=B,N+B+V||"less than 1sec"}function x(A,L,U){let W=1;U&&(W=I(U));let w=T((A.to.valueOf()-A.from.valueOf())/L);return W>w&&(w=W),{intervalMs:w,interval:D(w/1e3)}}const E=/(-?\d+(?:\.\d+)?)(ms|[Mwdhmsy])/,C={y:31536e3,M:2592e3,w:604800,d:86400,h:3600,m:60,s:1,ms:.001};function M(A){if(Number(A))return{sec:C.s,type:"s",count:parseInt(A,10)};const L=A.match(E);if(!L)throw new Error(`Invalid interval string, has to be either unit-less or end with one of the following units: "${Object.keys(C).join(", ")}"`);const U=C[L[2]];if(U===void 0)throw new Error("describeInterval failed: invalid interval string");return{sec:U,type:L[2],count:parseInt(L[1],10)}}function S(A){const L=M(A);return L.sec*L.count}function I(A){const L=M(A);return L.sec*1e3*L.count}function T(A){switch(!0){case A<10:return 1;case A<15:return 10;case A<35:return 20;case A<75:return 50;case A<150:return 100;case A<350:return 200;case A<750:return 500;case A<1500:return 1e3;case A<3500:return 2e3;case A<7500:return 5e3;case A<12500:return 1e4;case A<17500:return 15e3;case A<25e3:return 2e4;case A<45e3:return 3e4;case A<9e4:return 6e4;case A<21e4:return 12e4;case A<45e4:return 3e5;case A<75e4:return 6e5;case A<105e4:return 9e5;case A<15e5:return 12e5;case A<27e5:return 18e5;case A<54e5:return 36e5;case A<9e6:return 72e5;case A<162e5:return 108e5;case A<324e5:return 216e5;case A<864e5:return 432e5;case A<6048e5:return 864e5;case A<18144e5:return 6048e5;case A<36288e5:return 2592e6;default:return 31536e6}}function b(A,L=(0,r.KQ)()){const U=L.unix()-A.from.unix(),W=L.unix()-A.to.unix();return{from:U,to:W}}function R(A,L=(0,r.KQ)()){const U=(0,r.KQ)(L).subtract(A.from,"s"),W=A.to===0?(0,r.KQ)(L):(0,r.KQ)(L).subtract(A.to,"s");return{from:U,to:W,raw:{from:U,to:W}}}},91410:(G,O,e)=>{"use strict";e.d(O,{HD:()=>c,P3:()=>h,QZ:()=>o,U3:()=>g,g$:()=>f,le:()=>a});var t=e(2543),n=e.n(t),i=e(84743),s=e.n(i),r=e(1933),f=(v=>(v.default="",v.localBrowserTime="browser",v.utc="utc",v))(f||{});const a=v=>{switch((0,r.O)({timeZone:v})){case"browser":return"Local browser time";case"utc":return"UTC";default:return v}},c=v=>s().tz.zone(v),o=(v,u)=>{const D=l(v,u);return D||m(v,u)},h=(0,t.memoize)((v=!1)=>{const u=[];return v===!0?u.push("","browser","utc"):v&&u.push(...v),s().tz.names().reduce((D,P)=>{const x=d[P];return!Array.isArray(x)||x.length===0||D.push(P),D},u)}),g=(0,t.memoize)((v=!1)=>{const D=h(v).reduce((P,x)=>{const E=x.indexOf("/");if(E===-1){const M="";return P[M]=P[M]??[],P[M].push(x),P}const C=x.slice(0,E);return P[C]=P[C]??[],P[C].push(x),P},{});return Object.keys(D).map(P=>({name:P,zones:D[P]}))}),l=(v,u)=>{switch(v){case"utc":return{name:"Coordinated Universal Time",ianaName:"UTC",zone:v,countries:[],abbreviation:"UTC, GMT",offsetInMins:0};case"":{const D=(0,r.O)(),x=D==="browser"||D==="utc"?l(D,u):m(D,u);return{countries:d[D]??[],abbreviation:"",offsetInMins:0,...x,ianaName:x?.ianaName??"",name:"Default",zone:v}}case"browser":{const D=s().tz.guess(!0),P=m(D,u);return{countries:d[D]??[],abbreviation:"Your local time",offsetInMins:new Date().getTimezoneOffset(),...P,name:"Browser Time",ianaName:P?.ianaName??"",zone:v}}default:return}},p=v=>/^(\+|\-).+/.test(v)?"":v,m=(v,u)=>{const D=s().tz.zone(v);if(D)return{name:v,ianaName:D.name,zone:v,countries:d[v]??[],abbreviation:p(D.abbr(u)),offsetInMins:D.utcOffset(u)}},y={AF:"Afghanistan",AX:"Aland Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua And Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BA:"Bosnia And Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo, Democratic Republic",CK:"Cook Islands",CR:"Costa Rica",CI:"Cote D'Ivoire",HR:"Croatia",CU:"Cuba",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island & Mcdonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran (Islamic Republic Of)",IQ:"Iraq",IE:"Ireland",IM:"Isle Of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KR:"Korea",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People's Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libyan Arab Jamahiriya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia (Federated States Of)",MD:"Moldova",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestine, State of",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"Reunion",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",BL:"Saint Barthelemy",SH:"Saint Helena",KN:"Saint Kitts And Nevis",LC:"Saint Lucia",MF:"Saint Martin",PM:"Saint Pierre And Miquelon",VC:"Saint Vincent And Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome And Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia And Sandwich Isl.",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard And Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad And Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks And Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UM:"United States Outlying Islands",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela",VN:"Viet Nam",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",WF:"Wallis And Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"},d=s().tz.countries().reduce((v,u)=>s().tz.zonesForCountry(u).reduce((P,x)=>{P[x]||(P[x]=[]);const E=y[u];return E&&P[x].push({code:u,name:E}),P},v),{})},18226:(G,O,e)=>{"use strict";e.d(O,{o:()=>s});var t=e(74486),n=e(88483),i=e(16126);class s{constructor(){this.subscribers=new Map,this.emitter=new t.A}publish(a){this.emitter.emit(a.type,a)}subscribe(a,c){return this.getStream(a).subscribe({next:c})}getStream(a){return new n.c(c=>{const o=h=>{c.next(h)};return this.emitter.on(a.type,o),this.subscribers.set(o,c),()=>{this.emitter.off(a.type,o),this.subscribers.delete(o)}})}newScopedBus(a,c){return new r([a],this,c)}emit(a,c){typeof a=="string"?this.emitter.emit(a,{type:a,payload:c}):this.emitter.emit(a.name,{type:a.name,payload:c})}on(a,c,o){if(c.wrapper=h=>{c(h.payload)},typeof a=="string"?this.emitter.on(a,c.wrapper):this.emitter.on(a.name,c.wrapper),o){const h=o.$on("$destroy",()=>{this.off(a,c),h()})}}off(a,c){if(typeof a=="string"){this.emitter.off(a,c.wrapper);return}this.emitter.off(a.name,c.wrapper)}removeAllListeners(){this.emitter.removeAllListeners();for(const[a,c]of this.subscribers)c.complete(),this.subscribers.delete(a)}}class r{constructor(a,c,o){this.path=a,this.eventBus=c,this.filterConfig=o??{onlyLocal:!1}}publish(a){a.origin||(a.origin=this),this.eventBus.publish(a)}filter(a){return this.filterConfig.onlyLocal?a.origin===this:!0}getStream(a){return this.eventBus.getStream(a).pipe((0,i.p)(this.filter.bind(this)))}subscribe(a,c){return this.getStream(a).subscribe({next:c})}removeAllListeners(){this.eventBus.removeAllListeners()}newScopedBus(a,c){return new r([...this.path,a],this,c)}}},69129:(G,O,e)=>{"use strict";e.d(O,{LL:()=>o,LO:()=>s,NI:()=>c,Tp:()=>h,We:()=>r,b_:()=>n,gc:()=>f,ql:()=>i,wE:()=>a});var t=e(65463);class n extends t.x{static{this.type="data-hover"}}class i extends t.a{static{this.type="data-hover-clear"}}class s extends t.x{static{this.type="data-select"}}class r extends t.x{static{this.type="annotation-event"}}class f extends t.x{static{this.type="dashboard-loaded"}}class a extends t.a{static{this.type="datasource-updated-successfully"}}class c extends t.a{static{this.type="datasource-test-succeeded"}}class o extends t.a{static{this.type="datasource-test-failed"}}class h extends t.x{static{this.type="set-panel-attention"}}},89550:(G,O,e)=>{"use strict";e.d(O,{R:()=>n});const t=new Set;function n(i){if(t.has(i))throw new Error(`There is already an event defined with type '${i}'`);return t.add(i),{name:i}}},65463:(G,O,e)=>{"use strict";e.d(O,{a:()=>t,x:()=>n});class t{constructor(){this.type=this.__proto__.constructor.type}setTags(s){return this.tags=new Set(s),this}}class n extends t{constructor(s){super(),this.payload=s}}},66670:(G,O,e)=>{"use strict";e.d(O,{K:()=>n});var t=e(83077);class n extends t.O{}},57875:(G,O,e)=>{"use strict";e.d(O,{H:()=>m,J:()=>l});var t=e(2543),n=e.n(t),i=e(14236),s=e(47232),r=e(53531),f=e(11261),a=e(28802),c=e(62398),o=e(83195),h=e(58563);const g={dateTimeAsIso:!0,dateTimeAsIsoNoDateIfToday:!0,dateTimeAsUS:!0,dateTimeAsUSNoDateIfToday:!0,dateTimeAsLocal:!0,dateTimeAsLocalNoDateIfToday:!0,dateTimeFromNow:!0};function l(d){if(!d||(0,t.isEmpty)(d)||!d.field)return p;const v=d.field,u=v.config??{},{palette:D}=d.theme.visualization;let P=u.unit,x=P&&(g[P]||P.startsWith("time:")),E=!1;if(v.type===f.PU.time&&!x){if(P="dateTimeAsSystem",x=!0,v.values&&v.values.length>1){let A=v.values[0],L=v.values[v.values.length-1];typeof A=="string"?(A=(0,r.b)(A).unix(),L=(0,r.b)(L).unix()):(A/=1e3,L/=1e3),E=Math.abs(L-A)<60}}else v.type===f.PU.boolean?(0,o.j9)(P)||(P="bool"):!P&&v.type===f.PU.string&&(P="string");const C=P?.startsWith("currency"),M=(0,o.j9)(P),S=v.type===f.PU.number,T=!x&&!C&&!M&&!(P==="locale")&&S&&u.decimals==null,b=(0,o.j_)(P||"none"),R=(0,h.jc)(v,d.theme);return(A,L)=>{const{mappings:U}=u,W=P==="string";x&&typeof A=="string"&&(A=(0,s.yT)(A).valueOf());let w=W?NaN:(0,a.t)(A),N,B,V,K,H,X;if(U&&U.length>0){const Y=(0,c.Zz)(U,A);Y&&(Y.text!=null&&(N=Y.text),Y.color!=null&&(K=d.theme.visualization.getColorByName(Y.color)),Y.icon!=null&&(H=Y.icon))}else if(v.type===f.PU.enum){if(A==null)return{text:"",numeric:NaN};const Y=+A;if(u&&u.type&&u.type.enum){const{text:Z,color:se}=u.type.enum;if(N=Z?Z[Y]:`${A}`,K=se?se[Y]:void 0,K==null){const j=D[Y%D.length];K=d.theme.visualization.getColorByName(j)}}}if(!Number.isNaN(w)){if(N==null&&!(0,t.isBoolean)(A)){let Y;T&&L!=null?(Y=b(w,L,null,d.timeZone,E),Y.text=+Y.text+""):Y=b(w,u.decimals,null,d.timeZone,E),N=Y.text,V=Y.suffix,B=Y.prefix}if(K==null){const Y=R(w);K=Y.color,X=Y.percent}}if(N==null&&(0,t.isArray)(A)&&(N=(0,t.join)(A,", ")),N==null&&(N=(0,t.toString)(A),N||(u.noValue?N=u.noValue:N="")),!K){const Y=R(-1/0);K=Y.color,X=Y.percent}const k={text:N,numeric:w,prefix:B,suffix:V,color:K};return H!=null&&(k.icon=H),X!=null&&(k.percent=X),k}}function p(d){return{text:(0,t.toString)(d),numeric:(0,a.t)(d)}}function m(){return d=>({text:(0,i.oE)(d)==="other"?`${JSON.stringify(d,y())}`:`${d}`,numeric:null})}const y=()=>{const d=new WeakSet;return(v,u)=>{if(typeof u=="object"&&u!==null){if(d.has(u))return;d.add(u)}return u}}},8066:(G,O,e)=>{"use strict";e.d(O,{Hs:()=>m,Qi:()=>p,lz:()=>y,uf:()=>g});var t=e(21197),n=e(55459),i=e.n(n),s=e(84140),r=e(23596),f=e(75059),a=e(24293),c=e(83077),o=e(58563),h=e(47737);const g=new c.O(()=>[{id:a.Y.Fixed,name:"Single color",description:"Set a specific color",getCalculator:d},{id:a.Y.Shades,name:"Shades of a color",description:"Select shades of a specific color",getCalculator:v},{id:a.Y.Thresholds,name:"From thresholds",isByValue:!0,description:"Derive colors from thresholds",getCalculator:(u,D)=>(P,x,E)=>{const C=E??h.QS;return D.visualization.getColorByName(C.color)}},new l({id:a.Y.PaletteClassic,name:"Classic palette",isContinuous:!1,isByValue:!1,getColors:u=>u.visualization.palette}),new l({id:a.Y.PaletteClassicByName,name:"Classic palette (by series name)",isContinuous:!1,isByValue:!1,useSeriesName:!0,getColors:u=>u.visualization.palette.filter(D=>(0,r.eM)(u.visualization.getColorByName(D),u.colors.background.primary)>=u.colors.contrastThreshold)}),new l({id:a.Y.ContinuousGrYlRd,name:"Green-Yellow-Red",isContinuous:!0,isByValue:!0,getColors:u=>["green","yellow","red"]}),new l({id:a.Y.ContinuousRdYlGr,name:"Red-Yellow-Green",isContinuous:!0,isByValue:!0,getColors:u=>["red","yellow","green"]}),new l({id:a.Y.ContinuousBlYlRd,name:"Blue-Yellow-Red",isContinuous:!0,isByValue:!0,getColors:u=>["dark-blue","super-light-yellow","dark-red"]}),new l({id:a.Y.ContinuousYlRd,name:"Yellow-Red",isContinuous:!0,isByValue:!0,getColors:u=>["super-light-yellow","dark-red"]}),new l({id:a.Y.ContinuousBlPu,name:"Blue-Purple",isContinuous:!0,isByValue:!0,getColors:u=>["blue","purple"]}),new l({id:a.Y.ContinuousYlBl,name:"Yellow-Blue",isContinuous:!0,isByValue:!0,getColors:u=>["super-light-yellow","dark-blue"]}),new l({id:a.Y.ContinuousBlues,name:"Blues",isContinuous:!0,isByValue:!0,getColors:u=>["panel-bg","dark-blue"]}),new l({id:a.Y.ContinuousReds,name:"Reds",isContinuous:!0,isByValue:!0,getColors:u=>["panel-bg","dark-red"]}),new l({id:a.Y.ContinuousGreens,name:"Greens",isContinuous:!0,isByValue:!0,getColors:u=>["panel-bg","dark-green"]}),new l({id:a.Y.ContinuousPurples,name:"Purples",isContinuous:!0,isByValue:!0,getColors:u=>["panel-bg","dark-purple"]})]);class l{constructor(D){this.id=D.id,this.name=D.name,this.description=D.description,this.getNamedColors=D.getColors,this.isContinuous=D.isContinuous,this.isByValue=D.isByValue,this.useSeriesName=D.useSeriesName}getColors(D){return this.getNamedColors?this.colorCache&&this.colorCacheTheme===D?this.colorCache:(this.colorCache=this.getNamedColors(D).map(D.visualization.getColorByName),this.colorCacheTheme=D,this.colorCache):[]}getInterpolator(){return this.interpolator||(this.interpolator=(0,t.Ik)(this.colorCache)),this.interpolator}getCalculator(D,P){const x=this.getColors(P);return this.isByValue?this.isContinuous?(E,C,M)=>this.getInterpolator()(C):(E,C,M)=>x[C*(x.length-1)]:this.useSeriesName?(E,C,M)=>x[Math.abs(i()(D.name))%x.length]:(E,C,M)=>{const S=D.state?.seriesIndex??0;return x[S%x.length]}}}function p(u){return g.get(u.config.color?.mode??a.Y.Thresholds)}function m(u){return g.get(u??a.Y.Thresholds)}function y(u,D){const P=p(u);if(!P.isByValue)return{color:P.getCalculator(u,D)(0,0),threshold:h.QS,percent:1};const x=(0,o.jc)(u,D),E=u.config.color?.seriesBy??"last",M=(0,f.Nw)({field:u,reducers:[E]})[E]??0;return x(M)}function d(u,D){return()=>D.visualization.getColorByName(u.config.color?.fixedColor??a.F)}function v(u,D){return()=>{const P=D.visualization.getColorByName(u.config.color?.fixedColor??a.F),x=[P],E=6,C=10,M=35,S=35;for(let T=1;T<E;T++)x.push((0,s.A)(P).spin(T/E*C).brighten(T/E*M).toHexString()),x.push((0,s.A)(P).spin(-(T/E)*C).darken(T/E*S).toHexString());const I=u.state?.seriesIndex??0;return x[I%x.length]}}},56323:(G,O,e)=>{"use strict";e.d(O,{PI:()=>v,Pm:()=>d,XS:()=>E,Zo:()=>S,a_:()=>y,eG:()=>x,k3:()=>g,k_:()=>m,nF:()=>p,py:()=>l});var t=e(2543),n=e.n(t),i=e(78368),s=e(14236),r=e(75059),f=e(85200),a=e(1173),c=e(11261),o=e(57875),h=e(28240);const g="__series.name",l="__field.displayName",p="__field.labels",m="__calc",y="__cell_",d=25,v=T=>{const{replaceVariables:b,reduceOptions:R,timeZone:A,theme:L}=T,U=R.calcs.length?R.calcs:[r.gy.last],W=[],w=(0,f.NS)(R.fields?{id:a.Ct.byRegexp,options:R.fields}:{id:a.Ct.numeric}),N=T.data??[],B=R.limit?R.limit:d;let V=!1;for(let K=0;K<N.length&&!V;K++){const H=N[K],{timeField:X}=(0,s.KR)(H),k=new i.R(H);for(let Y=0;Y<H.fields.length&&!V;Y++){const Z=H.fields[Y],se=Z.getLinks;if(!w(Z,H,N))continue;let j=Z.config;Z.state?.range&&(j={...j,...Z.state?.range});let q=Z.config.displayName??"";const ne=Z.display??(0,o.J)({field:Z,theme:T.theme,timeZone:A});if(R.values)for(let oe=0;oe<Z.values.length;oe++){Z.state=D(Z,W.length);const z=I(Z,oe),te=ne(Z.values[oe]),le=u(H,Z,oe,b,z),ie=P(le,T.fieldConfig,L);if(W.push({name:"",field:j,display:{...te,title:le,color:ie??te.color},view:k,colIndex:Y,rowIndex:oe,getLinks:se?()=>se({valueRowIndex:oe}):()=>[],hasLinks:x(Z)}),W.length>=B){V=!0;break}}else{const oe=(0,r.Nw)({field:Z,reducers:U});for(const z of U){const te=Z.state?.scopedVars??{};te[m]={value:z,text:z};const le=ne(oe[z]);q!==""?le.title=b(q,te):le.title=(0,h.Ct)(Z,H,N),le.percentChange=T.percentChange?(0,r.Nw)({field:Z,reducers:[r.gy.diffperc]}).diffperc:void 0;let ie;T.sparkline&&(ie={y:H.fields[Y],x:X},z===r.gy.last?ie.highlightIndex=ie.y.values.length-1:z===r.gy.first&&(ie.highlightIndex=0));const ae=H.length===1?0:void 0;W.push({name:z,field:j,display:le,sparkline:ie,view:k,colIndex:Y,getLinks:se?()=>se({calculatedValue:le,valueRowIndex:ae}):()=>[],hasLinks:x(Z)})}}}}return W.length===0&&W.push(C(T)),W};function u(T,b,R,A,L){const U=b.config.displayName;if(U)return U.indexOf(y)?A(S(U),L):A(U,L);let W=[],w=0;for(const N of T.fields)if(N!==b)if(N.type===c.PU.string){const B=N.values[R]??"",V=N.display?N.display(B).text:B;V.length>0&&W.push(V)}else N.type===c.PU.number&&w++;return(w||W.length===0)&&W.push((0,h.Ct)(b,T)),W.join(" ")}function D(T,b){return{...T.state,seriesIndex:b}}function P(T,b,R){for(const A of b.overrides)if(A.matcher.id==="byName"&&A.matcher.options===T){for(const L of A.properties)if(L.id==="color"&&L.value)return R.visualization.getColorByName(L.value.fixedColor)}return null}function x(T){return T.config?.links?.length?T.config.links.length>0:!1}function E(T){let b="",R="",A="",L="";for(let U=0;U<T.length;U++){const W=T[U].display;W.text&&W.text.length>R.length&&(R=W.text),W.title&&W.title.length>b.length&&(b=W.title),W.prefix&&W.prefix.length>A.length&&(A=W.prefix),W.suffix&&W.suffix.length>L.length&&(L=W.suffix)}return{text:R,title:b,suffix:L,prefix:A}}function C(T){const b="No data",{fieldConfig:R,timeZone:A}=T,{defaults:L}=R,W=(0,o.J)({field:{type:c.PU.other,config:L},theme:T.theme,timeZone:A})(null),w=M(W,b);return{name:b,field:{...L,max:L.max??0,min:L.min??0},display:{text:w,numeric:0,color:W.color},hasLinks:!1}}function M(T,b){return!T||(0,t.isEmpty)(T.text)?b:T.text}function S(T){return T.replace(/\${__cell_(\d+)(.*?)}|\[\[__cell_(\d+)(.*?)\]\]|\$__cell_(\d+)(\S*)/g,(b,R,A,L,U,W,w)=>`\${__data.fields[${R??L??W}]${A??U??w}}`)}function I(T,b){return T.state?.scopedVars?.__dataContext?{...T.state?.scopedVars,__dataContext:{value:{...T.state?.scopedVars?.__dataContext.value,rowIndex:b}}}:T.state?.scopedVars}},90708:(G,O,e)=>{"use strict";e.d(O,{BF:()=>S,K3:()=>b,_M:()=>T,nJ:()=>u,rJ:()=>R,we:()=>D});var t=e(2543),n=e.n(t),i=e(96540),s=e(80292),r=e(52622),f=e(21423),a=e(14236),c=e(23596),o=e(75059),h=e(85200),g=e(11261),l=e(24293),p=e(6709),m=e(71733),y=e(57875),d=e(58563),v=e(69550);function u(L){let U=null,W=null;const w=[o.gy.min,o.gy.max];for(const N of L)for(const B of N.fields)if(B.type===g.PU.number){const V=(0,o.Nw)({field:B,reducers:w}),K=V[o.gy.min],H=V[o.gy.max];(U===null||K<U)&&(U=K),(W===null||H>W)&&(W=H)}return{min:U,max:W,delta:(W??0)-(U??0)}}function D(L){if(!L.data)return[];const U=L.fieldConfig;if(!U)return L.data;const W=L.fieldConfigRegistry??v.G;let w=0,N;const B=[];if(U.overrides)for(const V of U.overrides){const K=h.sJ.get(V.matcher.id);K&&B.push({match:K.get(V.matcher.options),properties:V.properties})}return L.data.map((V,K)=>{const H={...V};H.fields=H.fields.map(X=>({...X,config:(0,t.cloneDeep)(X.config),state:{...X.state}}));for(const X of H.fields){const k=X.config;X.state.scopedVars={__dataContext:{value:{data:L.data,frame:H,frameIndex:K,field:X}}};const Y={field:X,data:L.data,dataFrameIndex:K,replaceVariables:L.replaceVariables,fieldConfigRegistry:W};C(k,U.defaults,Y);for(const q of B)if(q.match(X,H,L.data))for(const ne of q.properties)E(k,ne,Y);let Z=X.type;if(!Z||Z===g.PU.other){const q=(0,a.dF)(X);q&&(Z=q)}const{range:se,newGlobalRange:j}=P(k,X,N,L.data);if(N=j,X.state.seriesIndex=w,X.state.range=se,X.type=Z,X.type!==g.PU.time&&w++,X.display=(0,y.J)({field:X,theme:L.theme,timeZone:L.timeZone}),X.config.unit!=="dateTimeFromNow"&&(X.display=x(X.display,2500)),X.getLinks=T(H,X,X.state.scopedVars,Y.replaceVariables,L.timeZone,L.dataLinkPostProcessor),X.type===g.PU.nestedFrames)for(const q of X.values)for(let ne=0;ne<q.length;ne++)for(const oe of q[ne].fields)oe.display=(0,y.J)({field:oe,theme:L.theme,timeZone:L.timeZone}),oe.state={scopedVars:{__dataContext:{value:{data:q,frame:q[ne],frameIndex:ne,field:oe}}}},oe.getLinks=T(q[ne],oe,oe.state.scopedVars,Y.replaceVariables,L.timeZone,L.dataLinkPostProcessor)}return H})}function P(L,U,W,w){if(U.type!==g.PU.number||(0,t.isNumber)(L.min)&&(0,t.isNumber)(L.max))return{newGlobalRange:W};if(L.fieldMinMax){const K=(0,d.AP)(U),H=L.min??K.min,X=L.max??K.max;return{range:{min:H,max:X,delta:X-H},newGlobalRange:W}}const N=W??u(w),B=L.min??N.min,V=L.max??N.max;return{range:{min:B,max:V,delta:V-B},newGlobalRange:N}}function x(L,U=2500){const W=new Map;for(let w=-1;w<=15;w++)W.set(w,new Map);return(w,N)=>{let B=W.get(N??-1),V=B.get(w);return V||(B.size===U&&B.clear(),V=L(w,N),V.color&&(V.color=(0,c.ze)(V.color)),B.set(w,V)),V}}function E(L,U,W){const N=W.fieldConfigRegistry.getIfExists(U.id);if(!N)return;const B=N.process(U.value,W,N.settings);B==null?N.isCustom&&L.custom?(0,t.unset)(L.custom,N.path):(0,t.unset)(L,N.path):N.isCustom?(L.custom||(L.custom={}),(0,t.set)(L.custom,N.path,B)):(0,t.set)(L,N.path,B)}function C(L,U,W){L.links&&U.links&&(L.links=[...L.links,...U.links]);for(const w of W.fieldConfigRegistry.list())w.isCustom&&!L.custom&&(L.custom={}),M(w.isCustom?L.custom:L,w.isCustom?U.custom:U,w,W);S(L)}function M(L,U,W,w){const N=(0,t.get)(L,W.path);if(N==null){const B=w.fieldConfigRegistry.getIfExists(W.id);if(!B)return;if(B&&B.shouldApply(w.field)){const V=B.process((0,t.get)(U,B.path),w,B.settings);V!=null&&(0,t.set)(L,B.path,V)}}}function S(L){const{thresholds:U}=L;if(L.color?L.color.mode||delete L.color:U&&(L.color={mode:l.Y.Thresholds}),L.hasOwnProperty("min")&&L.hasOwnProperty("max")&&L.min>L.max){const W=L.max;L.max=L.min,L.min=W}}const I=L=>{const{link:U,linkModel:W,dataLinkScopedVars:w,field:N,replaceVariables:B}=L;return U.internal?(0,p.u)({link:U,internalLink:U.internal,scopedVars:w,field:N,range:U.internal.range,replaceVariables:B}):W},T=(L,U,W,w,N,B)=>V=>!U.config.links||U.config.links.length===0?[]:U.config.links.map(H=>{const X=A(L,U,W),k={...W,__dataContext:X},Y=(j,q,ne)=>w(j,{...k,...q},ne);V.valueRowIndex!==void 0&&!isNaN(V.valueRowIndex)?X.value.rowIndex=V.valueRowIndex:X.value.calculatedValue=V.calculatedValue;let Z,se=H.onClick||!H.onBuildUrl?H.url:H.onBuildUrl({origin:U,replaceVariables:Y});return se&&(se=m.I.assureBaseUrl(se.replace(/\n/g,"")),se=w(se,k,r.$m.UriEncode),se=m.I.processUrl(se)),H.onClick?Z={href:se,title:w(H.title||"",k),target:H.targetBlank?"_blank":void 0,onClick:(j,q)=>{H.onClick({origin:q??U,e:j,replaceVariables:Y})},origin:U}:Z={href:se,title:w(H.title||"",k),target:H.targetBlank?"_blank":void 0,origin:U},(B||I)({frame:L,field:U,dataLinkScopedVars:k,replaceVariables:w,config:V,link:H,linkModel:Z})}).filter(H=>!!H);function b(L){if(!L||L.length===0)return[];const U=[...L],W=(0,y.H)();for(let w=0;w<U.length;w++){const N={...U[w]},B=[...N.fields];for(let V=0;V<B.length;V++)B[V]={...B[V],display:W};U[w]={...N,fields:B}}return U}function R(L,U,W,w,N,B,V){const K=L?.fieldConfigRegistry,H=(0,i.useRef)(0),X=(0,s.A)(W?.series);return(0,i.useMemo)(()=>{if(!K||!U||!W)return;const k=W?.series;W.structureRev==null&&k&&X&&!(0,f.J3)(k,X,f.bW)&&H.current++;const Y={structureRev:H.current,...W,series:D({data:k,fieldConfig:U,fieldConfigRegistry:K,replaceVariables:B,theme:N,timeZone:w,dataLinkPostProcessor:V})};return W.annotations&&W.annotations.length>0&&(Y.annotations=D({data:W.annotations,fieldConfig:{defaults:{},overrides:[]},replaceVariables:B,theme:N,timeZone:w,dataLinkPostProcessor:V})),Y},[K,U,W,X,w,N,B,V])}function A(L,U,W){return W?.__dataContext?{value:{...W.__dataContext.value}}:{value:{frame:L,field:U,data:[L]}}}},28240:(G,O,e)=>{"use strict";e.d(O,{Ct:()=>a,Fm:()=>r,Ri:()=>s,fk:()=>o,j2:()=>f});var t=e(85200),n=e(11261),i=e(8249);function s(g,l){if(g.name)return g.name;const p=[];for(const m of g.fields)if(m.type!==n.PU.time){if(p.length>1)break;p.push(a(m,g))}return p.length===1?p[0]:l===void 0&&g.fields.length>0?g.fields.filter(m=>m.type!==n.PU.time).map(m=>a(m,g)).join(", "):g.refId?`Series (${g.refId})`:`Series (${l})`}function r(g){g.forEach(l=>{l.fields.forEach(p=>{a(p,l,g)})})}function f(g,l){g.forEach(p=>{p.fields.forEach(m=>{const y={legend:!1,tooltip:!1,viz:!1,...l.defaults.custom?.hideFrom},d=m.config.custom?.hideFrom;l.overrides.forEach(v=>{if("__systemRef"in v)return;if((0,t.NS)(v.matcher)(m,p,g))for(const D of v.properties)D.id==="custom.hideFrom"&&Object.assign(y,D.value)}),m.state={...m.state,hideFrom:{...d}},m.config.custom.hideFrom=y})})}function a(g,l,p){const m=g.state?.displayName,y=!!(p&&p.length>1);if(m&&y===g.state?.multipleFrames)return m;const d=c(g,l,p);return g.state=g.state||{},g.state.displayName=d,g.state.multipleFrames=y,d}function c(g,l,p){const m=g.config?.displayName&&g.config?.displayName.length,y=!!l?.meta?.timeCompare?.isTimeShiftQuery;let d=m?g.config.displayName:g.name;if(m)return y?`${d} (comparison)`:d;if(l&&g.config?.displayNameFromDS)return y?`${g.config.displayNameFromDS} (comparison)`:g.config.displayNameFromDS;if(g.type===n.PU.time&&!g.labels)return d??n.LE;let v=[],u=!1;if(p&&p.length>1){for(let x=1;x<p.length;x++)if(p[x].name!==p[x-1].name){u=!0;break}}let D=!1,P=!1;if(u&&l?.name&&(v.push(l.name),D=!0),g.name&&g.name!==n.Bc&&v.push(g.name),g.labels&&l){let x=h(p??[l]);if(x)g.labels[x]&&(v.push(g.labels[x]),P=!0);else{let E=(0,i.h6)(g.labels);E&&(v.push(E),P=!0)}}return l&&!D&&!P&&g.name===n.Bc&&l.name&&l.name.length>0&&(v.push(l.name),D=!0),v.length?d=v.join(" "):g.name?d=g.name:d=n.Bc,d===g.name&&(d=o(g,l)),y&&(d=`${d} (comparison)`),d}function o(g,l){let p=0,m=!1;if(l)for(let y=0;y<l.fields.length;y++){const d=l.fields[y];if(g===d){if(m=!0,p>0){p++;break}}else if(g.name===d.name&&(p++,m))break}return p?`${g.name} ${p}`:g.name}function h(g){let l=null;for(let p=0;p<g.length;p++){const m=g[p];for(const y of m.fields)if(y.labels){for(const d in y.labels)if(l===null)l=d;else if(d!==l)return null}}return l}},92461:(G,O,e)=>{"use strict";e.d(O,{F:()=>r});var t=e(2543),n=e.n(t),i=e(83195),s=e(57875);function r(f){return new Proxy({},{get:(a,c)=>{let o=f.frame.fields.find(p=>c===p.name);if(!o){const p=(0,t.toNumber)(c);o=f.frame.fields[p]}if(o||(o=f.frame.fields.find(p=>c===p.config.displayName)),o||(o=f.frame.fields.find(p=>p.labels?c===p.labels.name:!1)),!o)return;const h=o.display??(0,s.J)(),g=o.values[f.rowIndex],l=h(g);return l.toString=()=>(0,i.cN)(l),l}})}},27310:(G,O,e)=>{"use strict";e.d(O,{AM:()=>i,Ch:()=>s,FM:()=>h,N7:()=>c,OU:()=>a,X4:()=>g,hL:()=>f,hS:()=>t,lG:()=>o,m0:()=>n,xT:()=>r});const t=l=>l,n=(l,p,m)=>{if(l!=null)return parseFloat(l)},i=(l,p,m)=>(delete p.field?.state?.displayName,a(l,p,m)),s=(l,p,m)=>l,r=(l,p,m)=>l,f=(l,p,m)=>l,a=(l,p,m)=>l==null?l:m&&m.expandTemplateVars&&p.replaceVariables&&typeof l=="string"?p.replaceVariables(l,p.field.state.scopedVars):`${l}`,c=(l,p,m)=>l,o=(l,p,m)=>l,h=(l,p,m)=>l;var g=(l=>(l.IncludeAll="all",l.ExcludeBaseNames="exclude",l.OnlyBaseNames="only",l))(g||{})},58563:(G,O,e)=>{"use strict";e.d(O,{AP:()=>o,jc:()=>a,xg:()=>h});var t=e(2543),n=e.n(t),i=e(75059),s=e(11261),r=e(8066),f=e(47737);function a(g,l){if(g.type===s.PU.boolean)return c(g,l);const m=(0,r.Qi)(g).getCalculator(g,l),y=g.state?.range??o(g);return d=>{let v=0;d!==-1/0&&(v=(d-y.min)/y.delta,Number.isNaN(v)&&(v=0));const u=(0,f.k5)(g,d,v);return{percent:v,threshold:u,color:m(d,v,u)}}}function c(g,l){const p={color:l.visualization.getColorByName("green"),percent:1,threshold:void 0},m={color:l.visualization.getColorByName("red"),percent:0,threshold:void 0},y=(0,r.Qi)(g);if(y.isContinuous&&y.getColors){const d=y.getColors(l);p.color=d[d.length-1],m.color=d[0]}return d=>d?p:m}function o(g){if(g.type!==s.PU.number)return{min:0,max:100,delta:100};let l=g.config.min,p=g.config.max;if(!(0,t.isNumber)(l)||!(0,t.isNumber)(p))if(g.values&&g.values.length){const m=(0,i.Nw)({field:g,reducers:[i.gy.min,i.gy.max]});(0,t.isNumber)(l)||(l=m[i.gy.min]),(0,t.isNumber)(p)||(p=m[i.gy.max])}else l=0,p=100;return{min:l,max:p,delta:p-l}}function h(g,l){const{config:p}=g;let{min:m,max:y}=p;return(0,t.isNumber)(m)&&(0,t.isNumber)(y)?p:l||!g.state?.range?{...p,...o(g)}:{...p,...g.state.range}}},69550:(G,O,e)=>{"use strict";e.d(O,{D:()=>s,G:()=>i});var t=e(83077),n=e(66670);const i=new n.K,s=new t.O},47737:(G,O,e)=>{"use strict";e.d(O,{QS:()=>i,RU:()=>f,k5:()=>r,yQ:()=>s});var t=e(24293),n=e(50082);const i={value:0,color:t.F};function s(a,c){if(!c||c.length===0)return i;let o=c[0];for(const h of c)if(a>=h.value)o=h;else break;return o}function r(a,c,o){const{thresholds:h}=a.config;return h?.mode===n.O.Percentage?s(o*100,h?.steps):s(c,h?.steps)}function f(a){return a.sort((c,o)=>c.value-o.value)}},33459:(G,O,e)=>{"use strict";e.r(O),e.d(O,{AbstractLabelOperator:()=>En.D_,AlertState:()=>Ye.O,AnnotationChangeEvent:()=>x.We,AnnotationEventFieldSource:()=>Sn.V,AppEvents:()=>yt.r1,AppPlugin:()=>$t.hX,ArrayDataFrame:()=>o.f,ArrayVector:()=>Wn,BinaryOperationID:()=>me.k,BusEventBase:()=>D.a,BusEventWithPayload:()=>D.x,ByNamesMatcherMode:()=>Xe.PP,CSVHeaderStyle:()=>z.F7,CSVReader:()=>z.i8,CircularDataFrame:()=>Jn.x,CircularVector:()=>tn.$,CoreApp:()=>$t.Jk,CustomVariableSupport:()=>Dt.f5,DEFAULT_FIELD_DISPLAY_VALUES_LIMIT:()=>R.Pm,DEFAULT_SAML_NAME:()=>rt.En,DashboardCursorSync:()=>wn.y,DashboardLoadedEvent:()=>x.gc,DataFrameType:()=>Rt.m,DataFrameView:()=>n.R,DataHoverClearEvent:()=>x.ql,DataHoverEvent:()=>x.b_,DataLinkBuiltInVars:()=>V.c,DataLinkConfigOrigin:()=>On.x0,DataQueryErrorType:()=>gt.v2,DataSelectEvent:()=>x.LO,DataSourceApi:()=>gt.mA,DataSourcePlugin:()=>gt.tD,DataSourcePluginContextProvider:()=>zt.p,DataSourceTestFailed:()=>x.LL,DataSourceTestSucceeded:()=>x.NI,DataSourceUpdatedSuccessfully:()=>x.wE,DataSourceVariableSupport:()=>Dt.ZV,DataTopic:()=>p.QR,DataTransformerID:()=>Ne.F,DefaultTimeZone:()=>sn.lE,DocsId:()=>K.f,EventBusSrv:()=>P.o,ExploreMode:()=>gt.ZF,FALLBACK_COLOR:()=>un.F,FeatureState:()=>$t.Ay,FieldCache:()=>i.L,FieldColorModeId:()=>un.Y,FieldConfigEditorBuilder:()=>W.bk,FieldConfigOptionsRegistry:()=>C.K,FieldConfigProperty:()=>Et.uo,FieldMatcherID:()=>Re.Ct,FieldNamePickerBaseNameMode:()=>U.X4,FieldType:()=>Ot.PU,FrameGeometrySourceMode:()=>p.aG,FrameMatcherID:()=>Re.jR,GAUGE_DEFAULT_MAXIMUM:()=>rt.d1,GAUGE_DEFAULT_MINIMUM:()=>rt.tw,GrafanaPlugin:()=>ht.Ud,GrafanaThemeType:()=>an.I,ISO_8601:()=>Ee.mt,InternalTimeZones:()=>Ie.g$,LanguageProvider:()=>gt.Is,LayoutModes:()=>vt.R,LegacyGraphHoverClearEvent:()=>yt.Tq,LegacyGraphHoverEvent:()=>yt.kb,LegacyMappingType:()=>Y.An,LiveChannelConnectionState:()=>Nn.ZF,LiveChannelEventType:()=>Nn.o4,LiveChannelScope:()=>Nn.qD,LiveChannelType:()=>Nn.os,LoadingState:()=>jt.Gu,LocalStorageValueProvider:()=>je.b,LogLevel:()=>yn.$b,LogRowContextQueryDirection:()=>yn.ZF,LogsDedupDescription:()=>yn._C,LogsDedupStrategy:()=>p.fY,LogsMetaKind:()=>yn.tG,LogsSortOrder:()=>p.uH,LogsVolumeType:()=>yn.Aj,MISSING_VALUE:()=>s.p,MappingType:()=>Qt.d,MatcherID:()=>Re.cV,MutableDataFrame:()=>s.k,NodeGraphDataFrameFieldNames:()=>de.u,NullValueMode:()=>jt.UW,NumericLogLevel:()=>yn.s5,OneClickMode:()=>On.yd,OrgRole:()=>Ft.X,PageLayoutType:()=>ln.k,PanelEvents:()=>yt.ee,PanelOptionsEditorBuilder:()=>W.pv,PanelPlugin:()=>Pt.m,PluginContextProvider:()=>wt.a,PluginErrorCode:()=>ht.ZK,PluginExtensionPoints:()=>St.S,PluginExtensionTypes:()=>St.u,PluginIncludeType:()=>ht.ib,PluginSignatureStatus:()=>ht.Ac,PluginSignatureType:()=>ht.kv,PluginState:()=>ht.pn,PluginType:()=>ht.QE,ReducerID:()=>Se.gy,Registry:()=>q.O,SetPanelAttentionEvent:()=>x.Tp,SpecialValue:()=>It.N,SpecialValueMatch:()=>Qt.W,StandardVariableSupport:()=>Dt.J$,StreamingDataFrame:()=>c.k9,StreamingFrameAction:()=>c.Kh,SupplementaryQueryType:()=>yn.cF,SupportedTransformationType:()=>On.CC,SystemDateFormatsState:()=>Qe.JE,TIME_FORMAT:()=>sn.G$,TIME_SERIES_METRIC_FIELD_NAME:()=>Ot.aI,TIME_SERIES_TIME_FIELD_NAME:()=>Ot.LE,TIME_SERIES_VALUE_FIELD_NAME:()=>Ot.Bc,ThemeContext:()=>ye.D,ThresholdsMode:()=>Un.O,TransformationApplicabilityLevels:()=>It.M,TransformerCategory:()=>Ke.m,UnaryOperationID:()=>ee._,VAR_CALC:()=>R.k_,VAR_CELL_PREFIX:()=>R.a_,VAR_FIELD_LABELS:()=>R.nF,VAR_FIELD_NAME:()=>R.py,VAR_SERIES_NAME:()=>R.k3,ValueMatcherID:()=>Re.Js,VariableHide:()=>hn.zL,VariableOrigin:()=>On.$0,VariableRefresh:()=>hn.CO,VariableSort:()=>hn.ZG,VariableSuggestionsScope:()=>On.uP,VariableSupportBase:()=>Dt.xi,VariableSupportType:()=>Dt.Qz,VisualizationSuggestionScore:()=>lt.nQ,VisualizationSuggestionsBuilder:()=>lt.v2,VisualizationSuggestionsListAppender:()=>lt.NV,VizOrientation:()=>lt.wV,addDurationToDate:()=>ct.Ri,addRow:()=>a.uY,amendTable:()=>t.c,anySeriesWithTimeField:()=>a.tP,anyToNumber:()=>X.t,applyFieldOverrides:()=>S.we,applyNullInsertThreshold:()=>xt.M,applyRawFieldOverrides:()=>S.K3,arrayToDataFrame:()=>o.I,arrayUtils:()=>fe,availableIconsIndex:()=>Cn.az,binaryOperators:()=>me.b,booleanOverrideProcessor:()=>U.FM,booleanValueFormatter:()=>Pe.Qc,buildHistogram:()=>st.p3,cacheFieldDisplayNames:()=>T.Fm,classicColors:()=>ae,closestIdx:()=>c.Ls,colorManipulator:()=>he.MV,compareArrayValues:()=>g.J3,compareDataFrameStructures:()=>g.bW,containsSearchFilter:()=>Z.E,convertOldAngularValueMappings:()=>Y.bh,createDataFrame:()=>r.EI,createDimension:()=>f.r4,createFieldConfigRegistry:()=>Jt.O,createTheme:()=>ve.a,dataFrameFromJSON:()=>h.or,dataFrameToJSON:()=>h.Nw,dataLinksOverrideProcessor:()=>U.Ch,dateMath:()=>ge,dateTime:()=>Ee.KQ,dateTimeAsMoment:()=>Ee.AN,dateTimeForTimeZone:()=>Ee.oZ,dateTimeFormat:()=>at.LE,dateTimeFormatISO:()=>at.M7,dateTimeFormatTimeAgo:()=>at.fq,dateTimeFormatWithAbbrevation:()=>at._Q,dateTimeParse:()=>ft.b,decodeFieldValueEntities:()=>h.t,decodeFieldValueEnums:()=>h.EL,defaultCalcs:()=>Se.C6,deprecationWarning:()=>oe.l,displayNameOverrideProcessor:()=>U.AM,doStandardCalcs:()=>Se.H3,durationToMilliseconds:()=>ct.WT,ensureTimeField:()=>pt.ks,escapeRegex:()=>m.$f,escapeStringForRegex:()=>m.jD,eventFactory:()=>u.R,fieldColorModeRegistry:()=>E.uf,fieldMatchers:()=>Be.sJ,fieldReducers:()=>Se.AS,filterFieldConfigOverrides:()=>Vt.aW,findCommonLabels:()=>te.yO,findHighlightChunksInText:()=>y.Oq,findMatchesInText:()=>y.bs,findUniqueLabels:()=>te.s6,fixCellTemplateExpressions:()=>R.Zo,formatLabels:()=>te.h6,formattedValueToString:()=>Pe.cN,frameMatchers:()=>Be.RE,getActiveThreshold:()=>M.yQ,getAllValuesFromDimension:()=>f.Km,getBuiltInThemes:()=>be.k,getColumnFromDimension:()=>f.P4,getColumnsFromDimension:()=>f.g6,getDataFrameRow:()=>r.Yn,getDataSourceRef:()=>ne.p$,getDataSourceUID:()=>ne.Iz,getDefaultRelativeTimeRange:()=>sn.Cn,getDefaultTimeRange:()=>sn.E2,getDimensionByName:()=>f.xB,getDisplayProcessor:()=>A.J,getDisplayValueAlignmentFactors:()=>R.XS,getFieldColorMode:()=>E.Hs,getFieldColorModeForField:()=>E.Qi,getFieldConfigWithMinMax:()=>b.xg,getFieldDisplayName:()=>T.Ct,getFieldDisplayValues:()=>R.PI,getFieldDisplayValuesProxy:()=>I.F,getFieldMatcher:()=>Be.NS,getFieldSeriesColor:()=>E.lz,getFieldTypeFromValue:()=>r.oE,getFlotPairs:()=>w.R,getFlotPairsConstant:()=>w.r,getFrameDisplayName:()=>T.Ri,getFrameMatchers:()=>Be.Dq,getHistogramFields:()=>st.ix,getLinksSupplier:()=>S._M,getLocale:()=>Ee.JK,getLocaleData:()=>Ee.XN,getMinMaxAndDelta:()=>b.AP,getNextRefId:()=>l.M,getPanelOptionsWithDefaults:()=>Vt.F,getProcessedDataFrames:()=>r.Bt,getRawDisplayProcessor:()=>A.H,getRowUniqueId:()=>a.t9,getScaleCalculator:()=>b.jc,getSearchFilterScopedVar:()=>Z.c,getSeriesTimeStep:()=>re,getThemeById:()=>be.g,getTimeField:()=>r.KR,getTimeZone:()=>Ae.O,getTimeZoneGroups:()=>Ie.U3,getTimeZoneInfo:()=>Ie.QZ,getTimeZones:()=>Ie.P3,getUniqueFieldName:()=>T.fk,getValueFormat:()=>Pe.j_,getValueFormats:()=>Pe.Ke,getValueFormatterIndex:()=>Pe.uH,getValueFromDimension:()=>f.WK,getValueMatcher:()=>Be.kK,getWeekdayIndex:()=>Ee.xQ,getWeekdayIndexByEnglishName:()=>Ee.pp,getZone:()=>Ie.HD,guessDecimals:()=>le.E,guessFieldTypeForField:()=>r.dF,guessFieldTypeFromNameAndValue:()=>r.by,guessFieldTypeFromValue:()=>r.HW,guessFieldTypes:()=>r.XQ,hasLinks:()=>R.eG,hasLogsContextSupport:()=>yn.Ol,hasLogsContextUiSupport:()=>yn.wj,hasMsResolution:()=>ce,hasQueryExportSupport:()=>En.Ee,hasQueryImportSupport:()=>En.FL,hasQueryModificationSupport:()=>yn._0,hasSupplementaryQuerySupport:()=>yn.Nc,hasTimeField:()=>a.S1,hasToggleableQueryFiltersSupport:()=>yn.FP,histogramBucketSizes:()=>st.rW,histogramFieldInfo:()=>st.Rt,histogramFieldsToFrame:()=>st.cg,histogramFrameBucketMaxFieldName:()=>st.dA,histogramFrameBucketMinFieldName:()=>st.d$,histogramTransformer:()=>st.OA,identityOverrideProcessor:()=>U.hS,incrRound:()=>st.ZU,incrRoundDn:()=>st.rs,incrRoundUp:()=>st.Uh,intervalToAbbreviatedDurationString:()=>ct.dU,isBooleanUnit:()=>Pe.j9,isCustomFieldProp:()=>Vt.TQ,isDataFrame:()=>r.ci,isDataFrameWithValue:()=>r.LI,isDataSourcePluginContext:()=>Pn.S,isDataSourceRef:()=>ne.fN,isDateTime:()=>Ee.Ar,isDateTimeInput:()=>Ee.u8,isEmptyObject:()=>ie.R,isHistogramFrameBucketMaxFieldName:()=>st.H1,isHistogramFrameBucketMinFieldName:()=>st.NX,isIconName:()=>Cn.n6,isLikelyAscendingVector:()=>Je.g2,isLiveChannelJoinEvent:()=>Nn.Cz,isLiveChannelLeaveEvent:()=>Nn.jQ,isLiveChannelMessageEvent:()=>Nn.Z7,isLiveChannelStatusEvent:()=>Nn.ew,isObject:()=>jt.Gv,isReducerID:()=>Se.Em,isStandardFieldProp:()=>Vt.nx,isSystemOverride:()=>Et.Ow,isSystemOverrideWithRef:()=>Et.ZW,isTableData:()=>r.pH,isTimeSeriesField:()=>a.hF,isTimeSeriesFrame:()=>a.aH,isTimeSeriesFrames:()=>a.jq,isTruthy:()=>jt.zz,isUnsignedPluginSignature:()=>_n.x,isValidDate:()=>ct.vd,isValidDuration:()=>ct.di,isValidGoDuration:()=>ct.pp,isValidGrafanaDuration:()=>ct.V3,isValidLiveChannelAddress:()=>Nn.aj,localTimeFormat:()=>Qe.Od,locale:()=>Pe.Hg,locationUtil:()=>N.I,makeClassES5Compatible:()=>H.Y,makeTimeRange:()=>sn.HW,mapInternalLinkToExplore:()=>V.u,matchAllLabels:()=>te._p,matchPluginId:()=>j._,monacoLanguageRegistry:()=>$e.l,nullToValue:()=>ot.C,numberOverrideProcessor:()=>U.m0,objRemoveUndefined:()=>ie.w,onUpdateDatasourceJsonDataOption:()=>ne.PG,onUpdateDatasourceJsonDataOptionChecked:()=>ne.EX,onUpdateDatasourceJsonDataOptionSelect:()=>ne.BD,onUpdateDatasourceOption:()=>ne.zX,onUpdateDatasourceResetOption:()=>ne.yV,onUpdateDatasourceSecureJsonDataOption:()=>ne.mn,onUpdateDatasourceSecureJsonDataOptionSelect:()=>ne.wY,outerJoinDataFrames:()=>Je.Fd,parseDuration:()=>ct.E9,parseFlags:()=>y.bQ,parseLabels:()=>te.Xy,parseLiveChannelAddress:()=>Nn.DG,patchArrayVectorProrotypeMethods:()=>et.V,preProcessPanelData:()=>r.N$,preferredVisualizationTypes:()=>jt.Nx,rangeUtil:()=>xe,readCSV:()=>z.Jh,reduceField:()=>Se.Nw,renderLegendFormat:()=>se.j,renderMarkdown:()=>d.G,renderTextPanelMarkdown:()=>d.P,restoreCustomOverrideRules:()=>Vt.H9,reverseDataFrame:()=>r.q7,roundDecimals:()=>le.h,scaledUnits:()=>Pe.yP,scopeFilterOperatorMap:()=>nn.n,selectOverrideProcessor:()=>U.hL,serializeStateToUrlParam:()=>B.Pp,setLocale:()=>Ee.xS,setTimeZoneResolver:()=>Ae.G,setWeekStart:()=>Ee.$D,shallowCompare:()=>g.ab,simpleCountUnit:()=>Pe.UR,sortDataFrame:()=>r.ES,sortThresholds:()=>M.RU,standardEditorsRegistry:()=>L.D,standardFieldConfigEditorRegistry:()=>L.G,standardTransformers:()=>He.c,standardTransformersRegistry:()=>Ke.h,store:()=>Te.M,stringFormater:()=>Pe.cH,stringOverrideProcessor:()=>U.OU,stringStartsAsRegEx:()=>m.AP,stringToJsRegex:()=>m.dO,stringToMs:()=>m.dc,systemDateFormats:()=>Qe.WC,textUtil:()=>v.sQ,thresholdsOverrideProcessor:()=>U.N7,timeZoneAbbrevation:()=>at.jw,timeZoneFormatUserFriendly:()=>Ie.le,toCSV:()=>z._O,toDataFrame:()=>r.Vc,toDataFrameDTO:()=>r.Kl,toDuration:()=>Ee.Ah,toFilteredDataFrameDTO:()=>r.By,toFixed:()=>Pe.Mg,toFixedScaled:()=>Pe.gZ,toFixedUnit:()=>Pe.G8,toFloatOrUndefined:()=>m.$D,toIconName:()=>Cn.Uo,toIntegerOrUndefined:()=>m.vb,toLegacyResponseData:()=>r.w3,toLiveChannelId:()=>Nn.Qp,toNumberString:()=>m.kT,toOption:()=>De.z,toPascalCase:()=>m.MX,toURLRange:()=>B.sQ,toUtc:()=>Ee.yT,transformDataFrame:()=>We.m,trimTable:()=>t.F,unEscapeStringFromRegex:()=>m.xb,unaryOperators:()=>ee.j,unitOverrideProcessor:()=>U.lG,updateDatasourcePluginJsonDataOption:()=>ne.lO,updateDatasourcePluginOption:()=>ne.pN,updateDatasourcePluginResetOption:()=>ne.QP,updateDatasourcePluginSecureJsonDataOption:()=>ne.wp,urlUtil:()=>B.kM,useFieldOverrides:()=>S.rJ,usePluginContext:()=>on.Q,userHasAllPermissions:()=>Ls.Fj,userHasAnyPermission:()=>Ls.jW,userHasPermission:()=>Ls.ZU,userHasPermissionInMetadata:()=>Ls.T6,validateFieldConfig:()=>S.BF,valueMappingsOverrideProcessor:()=>U.xT,valueMatchers:()=>Be.hI,vectorator:()=>Mn.E,withLoadingIndicator:()=>k.k});var t=e(67414),n=e(78368),i=e(85404),s=e(37471),r=e(14236),f=e(61443),a=e(19845),c=e(9631),o=e(33948),h=e(89667),g=e(21423),l=e(77789),p=e(52622),m=e(54479),y=e(21),d=e(36663),v=e(80997),u=e(89550),D=e(65463),P=e(18226),x=e(69129),E=e(8066),C=e(66670),M=e(47737),S=e(90708),I=e(92461),T=e(28240),b=e(58563),R=e(56323),A=e(57875),L=e(69550),U=e(27310),W=e(60264),w=e(39306),N=e(71733),B=e(76885),V=e(6709),K=e(87885),H=e(92341),X=e(28802),k=e(72495),Y=e(62398),Z=e(92053),se=e(43659),j=e(80147),q=e(83077),ne=e(22391),oe=e(95344),z=e(72436),te=e(8249),le=e(97706),ie=e(92041);const ae=["#7EB26D","#EAB839","#6ED0E0","#EF843C","#E24D42","#1F78C1","#BA43A9","#705DA0","#508642","#CCA300","#447EBC","#C15C17","#890F02","#0A437C","#6D1F62","#584477","#B7DBAB","#F4D598","#70DBED","#F9BA8F","#F29191","#82B5D8","#E5A8E2","#AEA2E0","#629E51","#E5AC0E","#64B0C8","#E0752D","#BF1B00","#0A50A1","#962D82","#614D93","#9AC48A","#F2C96D","#65C5DB","#F9934E","#EA6460","#5195CE","#D683CE","#806EB7","#3F6833","#967302","#2F575E","#99440A","#58140C","#052B51","#511749","#3F2B5B","#E0F9D7","#FCEACA","#CFFAFF","#F9E2D2","#FCE2DE","#BADFF4","#F9D9F9","#DEDAF7"],re=fs=>{let ys,Xn,Ps=Number.MAX_VALUE;for(let Zs=0;Zs<fs.values.length;Zs++){const Ms=fs.values[Zs];if(ys!==void 0){const ks=Ms-ys;Xn===void 0&&(Ps=ks),ks<Ps&&(Ps=ks)}ys=Ms}return Ps},ce=fs=>{for(let ys=0;ys<fs.values.length;ys++){const Xn=fs.values[ys];if(Xn!=null){const Ps=Xn.toString();if(Ps.length===13&&Ps%1e3!==0)return!0}}return!1};var me=e(11710),ee=e(27618),de=e(25352),De=e(50877),fe=e(14588),Te=e(68941),je=e(7144),He=e(57934),Be=e(85200),Ne=e(18282),Re=e(1173),Se=e(75059),We=e(2514),Ke=e(97497),Xe=e(58972),Je=e(73060),st=e(77678),pt=e(50311),xt=e(46294),ot=e(39624),$e=e(96915),ve=e(75972),be=e(97594),he=e(23596),ye=e(60578),Pe=e(83195),ge=e(85858),xe=e(65879),Ae=e(1933),Ee=e(47232),Ie=e(91410),Qe=e(42994),at=e(72724),ft=e(53531),ct=e(70416),vt=e(19484),Pt=e(65158),Vt=e(581),Jt=e(28528),wt=e(13834),zt=e(76287),on=e(92470),Pn=e(95187),_n=e(51527),Cn=e(8887),Ye=e(43585),Dt=e(29505),yt=e(26272),Ft=e(62625),an=e(25137),un=e(24293),hn=e(12470),Un=e(50082),Nn=e(55004),St=e(74135),nn=e(37891),ht=e(43429),lt=e(47070),gt=e(40187),$t=e(41987),et=e(35853),Et=e(37055),It=e(81010),Qt=e(25019),sn=e(43127),ln=e(64388),yn=e(9557),Sn=e(8790),En=e(73372),wn=e(94624),On=e(91890),Rt=e(41260),Ot=e(11261),jt=e(39070),rt=e(58649),tn=e(36120),Mn=e(18008);const kn="ArrayVector is deprecated and will be removed in Grafana 11. Please use plain arrays for field.values.";let Yn=!1;class Wn extends Array{get buffer(){return this}set buffer(ys){this.length=0;const Xn=ys?.length;if(Xn){let Ps=65e3,Zs=Math.ceil(Xn/Ps);for(let Ms=0;Ms<Zs;Ms++)this.push.apply(this,ys.slice(Ms*Ps,(Ms+1)*Ps))}}constructor(ys){super(),this.buffer=ys??[],Yn||(console.warn(kn),Yn=!0)}toJSON(){return[...this]}}var Jn=e(33526),Ls=e(29263)},96915:(G,O,e)=>{"use strict";e.d(O,{l:()=>n});var t=e(83077);const n=new t.O},65158:(G,O,e)=>{"use strict";e.d(O,{m:()=>c});var t=e(2543),n=e.n(t),i=e(66670),s=e(43429),r=e(60264),f=e(95344),a=e(28528);class c extends s.Ud{constructor(h){super(),this._fieldConfigDefaults={defaults:{},overrides:[]},this._initConfigRegistry=()=>new i.K,this.dataSupport={annotations:!1,alertStates:!1},this.panel=h}get defaults(){let h=this._defaults||{};if(!this._defaults&&this.optionsSupplier){const g=new r.pv;this.optionsSupplier(g,{data:[]});for(const l of g.getItems())l.defaultValue!=null&&(0,t.set)(h,l.path,l.defaultValue)}return h}get fieldConfigDefaults(){const h=this._fieldConfigDefaults.defaults;h.custom={};for(const g of this.fieldConfigRegistry.list())g.defaultValue!==void 0&&(0,t.set)(h,g.id,g.defaultValue);return{defaults:{...h},overrides:this._fieldConfigDefaults.overrides}}setDefaults(h){return(0,f.l)("PanelPlugin","setDefaults","setPanelOptions"),this._defaults=h,this}get fieldConfigRegistry(){return this._fieldConfigRegistry||(this._fieldConfigRegistry=this._initConfigRegistry()),this._fieldConfigRegistry}setEditor(h){return(0,f.l)("PanelPlugin","setEditor","setPanelOptions"),this.editor=h,this}setNoPadding(){return this.noPadding=!0,this}setMigrationHandler(h){return this.onPanelMigration=h,this}setPanelChangeHandler(h){return this.onPanelTypeChanged=h,this}setPanelOptions(h){return this.optionsSupplier=h,this}getPanelOptionsSupplier(){return this.optionsSupplier??(()=>{})}setDataSupport(h){return this.dataSupport={...this.dataSupport,...h},this}useFieldConfig(h={}){return this._initConfigRegistry=()=>(0,a.O)(h,this.meta.name),this}setSuggestionsSupplier(h){return this.suggestionsSupplier=h,this}getSuggestionsSupplier(){return this.suggestionsSupplier}hasPluginId(h){return this.meta.id===h}}},581:(G,O,e)=>{"use strict";e.d(O,{F:()=>a,H9:()=>p,TQ:()=>m,aW:()=>o,nx:()=>y});var t=e(2543),n=e.n(t),i=e(8066),s=e(24293),r=e(37055),f=e(50082);function a({plugin:d,currentOptions:v,currentFieldConfig:u,isAfterPluginChange:D}){const P=(0,t.mergeWith)({},d.defaults,v||{},(C,M)=>{if((0,t.isArray)(M))return M}),x=c(u,d),E=g(d,x,D);return{options:P,fieldConfig:E}}function c(d,v){const u=v.fieldConfigDefaults,D={defaults:(0,t.mergeWith)({},u.defaults,d?d.defaults:{},(P,x)=>{if((0,t.isArray)(x))return x}),overrides:d?.overrides??[]};h(D.defaults,"",v.fieldConfigRegistry),D.defaults.thresholds&&l(D.defaults.thresholds),D.overrides=o(D.overrides,P=>v.fieldConfigRegistry.getIfExists(P.id)!==void 0);for(const P of D.overrides)for(const x of P.properties)x.id==="thresholds"&&l(x.value);return D}function o(d,v){return d.map(u=>{const D=u.properties.filter(v);return{...u,properties:D}})}function h(d,v,u){let D=!1;for(const[P,x]of Object.entries(d)){const E=`${v}${P}`,C=!!u.getIfExists(E);if(C){D=!0;continue}(0,t.isArray)(x)||!(0,t.isObject)(x)?C||(0,t.unset)(d,P):h(x,`${E}.`,u)||(0,t.unset)(d,P)}return D}function g(d,v,u){if(!u)return v;const D=d.fieldConfigRegistry.getIfExists(r.uo.Color);if(D&&D.settings){const P=D.settings,x=i.uf.getIfExists(v.defaults.color?.mode);if(!P.byValueSupport&&(!x||x.isByValue))return v.defaults.color={mode:s.Y.PaletteClassic},v;if(P.byValueSupport&&P.preferThresholdsMode&&x?.id!==s.Y.Fixed&&(!x||!x.isByValue))return v.defaults.color={mode:s.Y.Thresholds},v;if(P.bySeriesSupport&&x?.isByValue)return v.defaults.color={mode:s.Y.PaletteClassic},v}return v}function l(d){d.mode||(d.mode=f.O.Absolute),d.steps?d.steps.length&&(d.steps[0].value=-1/0):d.steps=[]}function p(d,v){const u={defaults:{...d.defaults,custom:v.defaults.custom},overrides:[...d.overrides]};for(const D of v.overrides)for(const P of D.properties)if(m(P)){const x=u.overrides.find(E=>(0,t.isEqual)(E.matcher,D.matcher));x?x!==D&&x.properties.push(P):u.overrides.push(D)}return u}function m(d){return d.id.startsWith("custom.")}function y(d){return!m(d)}},28528:(G,O,e)=>{"use strict";e.d(O,{O:()=>s});var t=e(66670),n=e(69550),i=e(60264);function s(f={},a){const c=new t.K,o=n.G.list(),h={};if(f.useCustomConfig){const g=new i.bk;f.useCustomConfig(g);for(const l of g.getRegistry().list())if(l.isCustom=!0,l.id="custom."+l.id,r(l,o)){const p=h[l.category[0]]??[];p.push(l),h[l.category[0]]=p}else c.register(l)}for(let g of o){const l=g.id;if(!(f.disableStandardOptions&&f.disableStandardOptions.indexOf(l)>-1)){if(f.standardOptions){const p=f.standardOptions[l]?.hideFromDefaults,m=f.standardOptions[l]?.defaultValue,y=f.standardOptions[l]?.settings;p&&(g={...g,hideFromDefaults:p}),m&&(g={...g,defaultValue:m}),y&&(g={...g,settings:g.settings?{...g.settings,...y}:y})}if(c.register(g),g.category&&h[g.category[0]])for(let p of h[g.category[0]])c.register(p)}}for(const g of c.list())if(g.path.indexOf("[")>0)throw new Error(`[${a}] Field config paths do not support arrays: ${g.id}`);return c}function r(f,a){return!!a.find(c=>f.category&&c.category&&f.category[0]===c.category[0])}},77789:(G,O,e)=>{"use strict";e.d(O,{M:()=>t});const t=i=>{for(let s=0;;s++){const r=n(s);if(!i.some(f=>f.refId===r))return r}};function n(i){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZ";return i<s.length?s[i]:n(Math.floor(i/s.length)-1)+s[i%s.length]}},29263:(G,O,e)=>{"use strict";e.d(O,{Fj:()=>i,T6:()=>n,ZU:()=>t,jW:()=>s});function t(r,f){return!!f.permissions?.[r]}function n(r,f){return!!f.accessControl?.[r]}function i(r,f){return r.every(a=>t(a,f))}function s(r,f){return r.some(a=>t(a,f))}},67414:(G,O,e)=>{"use strict";e.d(O,{F:()=>i,c:()=>n});var t=e(9631);function n(s,r){let[f]=s,[a]=r,c=f.length,o=f[0],h=f[c-1],g=a.length,l=a[0],p=a[g-1],m;if(c)if(g){if(l>h)m=s.map((y,d)=>s[d].concat(r[d]));else if(p<o)m=r.map((y,d)=>r[d].concat(s[d]));else if(l<=o&&p>=h)m=r;else if(l>o&&p<h){let y=(0,t.Ls)(l,f);y=f[y]<l?y+1:y;let d=(0,t.Ls)(p,f);d=f[d]>p?d-1:d,m=s.map((v,u)=>s[u].slice(0,y).concat(r[u]).concat(s[u].slice(d+1)))}else if(l>=o){let y=(0,t.Ls)(l,f);y=f[y]<l?y-1:y,m=s.map((d,v)=>s[v].slice(0,y).concat(r[v]))}else if(p>=o){let y=(0,t.Ls)(p,f);y=f[y]<p?y:y+1,m=r.map((d,v)=>r[v].concat(s[v].slice(y)))}}else m=s;else g?m=r:m=[[]];return m}function i(s,r,f){let[a,...c]=s,o,h;return a[0]<r&&(o=(0,t.Ls)(r,a),a[o]<r&&o++),a[a.length-1]>f&&(h=(0,t.Ls)(f,a),a[h]>f&&h--),(o!=null||h!=null)&&(a=a.slice(o??0,h),c=c.map(g=>g.slice(o??0,h))),[a,...c]}},36663:(G,O,e)=>{"use strict";e.d(O,{G:()=>f,P:()=>a});var t=e(60023),n=e(33836),i=e(80997);let s=!1;const r={pedantic:!1,gfm:!0,breaks:!1};function f(c,o){s||(t.xI.use((0,n.z)()),t.xI.setOptions({...r}),s=!0);let h;o?.breaks&&(h={...r,breaks:!0});const g=(0,t.xI)(c||"",h);if(typeof g!="string")throw new Error("Failed to process markdown synchronously.");return o?.noSanitize?g:(0,i.G$)(g)}function a(c,o){s||(t.xI.use((0,n.z)()),t.xI.setOptions({...r}),s=!0);const h=(0,t.xI)(c||"");if(typeof h!="string")throw new Error("Failed to process markdown synchronously.");return o?.noSanitize?h:(0,i.G$)(h)}},80997:(G,O,e)=>{"use strict";e.d(O,{G$:()=>g,Jf:()=>p,aj:()=>c,sQ:()=>d});var t=e(16750),n=e(42838),i=e.n(n),s=e(34005),r=e.n(s);const f=Object.keys(s.whiteList).reduce((v,u)=>(v[u]=s.whiteList[u]?.concat(["class","style"]),v),{}),a=new s.FilterXSS({whiteList:f,css:{whiteList:{...s.getDefaultCSSWhiteList(),"flex-direction":!0,"flex-wrap":!0,"flex-basis":!0,"flex-grow":!0,"flex-shrink":!0,"flex-flow":!0,gap:!0,order:!0,"justify-content":!0,"justify-items":!0,"justify-self":!0,"align-items":!0,"align-content":!0,"align-self":!0}}});function c(v){try{return i().sanitize(v,{USE_PROFILES:{html:!0},FORBID_TAGS:["form","input"]})}catch{return console.error("String could not be sanitized",v),y(v)}}function o(v){return i().sanitize(v,{RETURN_TRUSTED_TYPE:!0,ADD_ATTR:["xmlns:atom","version","property","content"],ADD_TAGS:["rss","meta","channel","title","link","description","atom:link","item","pubDate","guid"],PARSER_MEDIA_TYPE:"application/xhtml+xml"})}function h(v){return i().sanitize(v,{RETURN_TRUSTED_TYPE:!0})}function g(v){try{return a.process(v)}catch{return console.error("String could not be sanitized",v),"Text string could not be sanitized"}}function l(v){return i().sanitize(v,{USE_PROFILES:{svg:!0,svgFilters:!0}})}function p(v){return(0,t.J)(v)}function m(v){return/\u001b\[\d{1,2}m/.test(v)}function y(v){return String(v).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")}const d={escapeHtml:y,hasAnsiCodes:m,sanitize:c,sanitizeTextPanelContent:g,sanitizeUrl:p,sanitizeSVGContent:l,sanitizeTrustedTypes:h,sanitizeTrustedTypesRSS:o}},54479:(G,O,e)=>{"use strict";e.d(O,{$D:()=>m,$f:()=>d,AP:()=>o,MX:()=>y,dO:()=>h,dc:()=>g,jD:()=>a,kT:()=>l,vb:()=>p,xb:()=>c});var t=e(2543),n=e.n(t);const s="([\\"+["(","[","{","}","]",")","\\","|","*","+","-",".","?","<",">","#","&","^","$"].join("\\")+"])",r=new RegExp(s,"g"),f=new RegExp("(\\\\)"+s,"g");function a(v){return v&&v.replace(r,"\\$1")}function c(v){return v&&v.replace(f,"$2")}function o(v){return v?v[0]==="/":!1}function h(v){if(!o(v))return new RegExp(`^${v}$`);const u=v.match(new RegExp("^/(.*?)/(g?i?m?y?s?)$"));if(!u)throw new Error(`'${v}' is not a valid regular expression.`);return new RegExp(u[1],u[2])}function g(v){if(!v)return 0;const u=parseInt(v,10),D=v.slice(String(u).length),P=1e3,x=P*60,E=x*60,C=E*24;switch(D){case"s":return u*P;case"m":return u*x;case"h":return u*E;case"d":return u*C;default:if(!D)return isNaN(u)?0:u;throw new Error("Not supported unit: "+D)}}function l(v){return v!=null&&Number.isFinite(v)?v.toString():""}function p(v){if(!v)return;const u=parseInt(v,10);return isNaN(u)?void 0:u}function m(v){if(!v)return;const u=parseFloat(v);return isNaN(u)?void 0:u}function y(v){const u=(0,t.camelCase)(v);return u.charAt(0).toUpperCase()+u.substring(1)}function d(v){return v.replace(/[\\^$*+?.()|[\]{}\/]/g,"\\$&")}},21:(G,O,e)=>{"use strict";e.d(O,{Oq:()=>t,bQ:()=>f,bs:()=>i});function t({searchWords:a,textToHighlight:c}){const o=[];for(const h of a)typeof h=="string"&&o.push(...i(c,h));return o}const n=a=>a.replace(/[[{(][\w,.\/:;<=>?:*+]+$/,"");function i(a,c){if(!a||!c)return[];const o=[],{cleaned:h,flags:g}=f(n(c));let l;try{l=new RegExp(`(?:${h})`,g)}catch{return o}return a.replace(l,(p,...m)=>{if(p){const y=m[m.length-2];o.push({text:p,start:y,length:p.length,end:y+p.length})}return""}),o}const s="-",r=/\(\?([ims-]+)\)/g;function f(a){const c=new Set(["g"]);return{cleaned:a.replace(r,(h,g)=>{const l=g.startsWith(s);for(let p=0;p<g.length;++p){const m=g.charAt(p);l||g.charAt(p-1)===s?c.delete(m):m!==s&&c.add(m)}return""}),flags:Array.from(c).join("")}}},23596:(G,O,e)=>{"use strict";e.d(O,{MV:()=>v,X4:()=>m,a:()=>d,e$:()=>y,eM:()=>g,tL:()=>p,ze:()=>f});var t=e(84140);function n(u,D=0,P=1){return Math.min(Math.max(D,u),P)}function i(u){u=u.slice(1);const D=new RegExp(`.{1,${u.length>=6?2:1}}`,"g");let P=u.match(D);if(!P)return"";let x=Array.from(P);return x[0].length===1&&(x=x.map(E=>E+E)),x?`rgb${x.length===4?"a":""}(${x.map((E,C)=>C<3?parseInt(E,16):Math.round(parseInt(E,16)/255*1e3)/1e3).join(", ")})`:""}function s(u){const D=u.toString(16);return D.length===1?`0${D}`:D}function r(u){if(u.indexOf("#")===0)return u;const{values:D}=o(u);return`#${D.map(P=>s(P)).join("")}`}function f(u){if(u[0]==="#")return u;const D=(0,t.A)(u);return D.getAlpha()===1?D.toHexString():D.toHex8String()}function a(u){return u.startsWith("rgb")?u:(0,t.A)(u).toRgbString()}function c(u){const D=o(u),{values:P}=D,x=P[0],E=P[1]/100,C=P[2]/100,M=E*Math.min(C,1-C),S=(b,R=(b+x/30)%12)=>C-M*Math.max(Math.min(R-3,9-R,1),-1);let I="rgb";const T=[Math.round(S(0)*255),Math.round(S(8)*255),Math.round(S(4)*255)];return D.type==="hsla"&&(I+="a",T.push(P[3])),h({type:I,values:T})}function o(u){if(typeof u!="string")return u;if(u.charAt(0)==="#")return o(i(u));const D=u.indexOf("("),P=u.substring(0,D);if(["rgb","rgba","hsl","hsla","color"].indexOf(P)===-1)throw new Error(`Unsupported '${u}' color. The following formats are supported: #nnn, #nnnnnn, rgb(), rgba(), hsl(), hsla(), color()`);let x=u.substring(D+1,u.length-1),E;if(P==="color"){if(x=x.split(" "),E=x.shift(),x.length===4&&x[3].charAt(0)==="/"&&(x[3]=x[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(E)===-1)throw new Error(`Unsupported ${E} color space. The following color spaces are supported: srgb, display-p3, a98-rgb, prophoto-rgb, rec-2020.`)}else x=x.split(",");return x=x.map(C=>parseFloat(C)),{type:P,values:x,colorSpace:E}}function h(u){const{type:D,colorSpace:P}=u;let x=u.values;return D.indexOf("rgb")!==-1?x=x.map((E,C)=>C<3?parseInt(E,10):E):D.indexOf("hsl")!==-1&&(x[1]=`${x[1]}%`,x[2]=`${x[2]}%`),D.indexOf("color")!==-1?x=`${P} ${x.join(" ")}`:x=`${x.join(", ")}`,`${D}(${x})`}function g(u,D,P){const x=l(u),E=l(D,P);return(Math.max(x,E)+.05)/(Math.min(x,E)+.05)}function l(u,D){const P=o(u);let x=P.type==="hsl"?o(c(u)).values:P.values;if(D&&P.type==="rgba"){const C=o(D),M=x[3];x[0]=x[0]*M+C.values[0]*(1-M),x[1]=x[1]*M+C.values[1]*(1-M),x[2]=x[2]*M+C.values[2]*(1-M)}const E=x.map(C=>(P.type!=="color"&&(C/=255),C<=.03928?C/12.92:((C+.055)/1.055)**2.4));return Number((.2126*E[0]+.7152*E[1]+.0722*E[2]).toFixed(3))}function p(u,D=.15){return l(u)>.5?y(u,D):d(u,D)}function m(u,D){if(u==="")return"#000000";if(D=n(D),u[0]==="#"){if(u.length===9)u=u.substring(0,7);else if(u.length<=5){let x="#";for(let E=1;E<4;E++)x+=u[E]+u[E];u=x}return u+Math.round(D*255).toString(16).padStart(2,"0")}else{if(u[3]==="(")return u.replace(")",`, ${D})`);if(u[4]==="(")return u.substring(0,u.lastIndexOf(","))+`, ${D})`}const P=o(u);return P.type==="color"?P.values[3]=`/${D}`:P.values[3]=D,h(P)}function y(u,D){const P=o(u);if(D=n(D),P.type.indexOf("hsl")!==-1)P.values[2]*=1-D;else if(P.type.indexOf("rgb")!==-1||P.type.indexOf("color")!==-1)for(let x=0;x<3;x+=1)P.values[x]*=1-D;return h(P)}function d(u,D){const P=o(u);if(D=n(D),P.type.indexOf("hsl")!==-1)P.values[2]+=(100-P.values[2])*D;else if(P.type.indexOf("rgb")!==-1)for(let x=0;x<3;x+=1)P.values[x]+=(255-P.values[x])*D;else if(P.type.indexOf("color")!==-1)for(let x=0;x<3;x+=1)P.values[x]+=(1-P.values[x])*D;return h(P)}const v={clamp:n,hexToRgb:i,rgbToHex:r,asHexString:f,asRgbString:a,hslToRgb:c,decomposeColor:o,recomposeColor:h,getContrastRatio:g,getLuminance:l,emphasize:p,alpha:m,darken:y,lighten:d}},60578:(G,O,e)=>{"use strict";e.d(O,{D:()=>i});var t=e(96540),n=e(75972);const i=(0,t.createContext)((0,n.a)());i.displayName="ThemeContext"},75972:(G,O,e)=>{"use strict";e.d(O,{a:()=>W});function t(){const N=["xs","sm","md","lg","xl","xxl"],B="px",V={xs:0,sm:544,md:769,lg:992,xl:1200,xxl:1440};function K(X){return`@media (min-width:${typeof X=="number"?X:V[X]}${B})`}function H(X){return`@media (max-width:${(typeof X=="number"?X:V[X])-5/100}${B})`}return{values:V,up:K,down:H,keys:N,unit:B}}var n=e(2543),i=e(23596);const s={white:"#FFFFFF",black:"#000000",gray25:"#2c3235",gray15:"#22252b",gray10:"#181b1f",gray05:"#111217",darkLayer0:"#18181A",darkLayer1:"#212124",darkLayer2:"#2a2a2f",darkBorder1:"#34343B",darkBorder2:"#64646B",gray90:"#F4F5F5",gray100:"#F4F5F5",gray80:"#D0D1D3",lightBorder1:"#E4E7E7",primaryDarkMain:"#FF8A00",primaryDarkText:"#FFA033",secondaryDarkMain:"#163C70",secondaryDarkText:"#1E5299",blueDarkMain:"#3D71D9",blueDarkText:"#6E9FFF",redDarkMain:"#D10E5C",redDarkText:"#FF5286",greenDarkMain:"#1A7F4B",greenDarkText:"#6CCF8E",orangeDarkMain:"#FF9900",orangeDarkText:"#fbad37",primaryLightMain:"#FF8A00",primaryLightText:"#FFA033",secondaryLightMain:"#163C70",secondaryLightText:"#1E5299",blueLightMain:"#3871DC",blueLightText:"#1F62E0",redLightMain:"#E0226E",redLightText:"#CF0E5B",greenLightMain:"#1B855E",greenLightText:"#0A764E",orangeLightMain:"#FF9900",orangeLightText:"#B5510D"};class r{constructor(){this.mode="dark",this.whiteBase="204, 204, 220",this.border={weak:`rgba(${this.whiteBase}, 0.12)`,medium:`rgba(${this.whiteBase}, 0.20)`,strong:`rgba(${this.whiteBase}, 0.30)`},this.text={primary:`rgb(${this.whiteBase})`,secondary:`rgba(${this.whiteBase}, 0.65)`,disabled:`rgba(${this.whiteBase}, 0.6)`,link:s.blueDarkText,maxContrast:s.white},this.primary={main:s.primaryDarkMain,text:s.primaryDarkText,border:s.primaryDarkText},this.secondary={main:`rgba(${this.whiteBase}, 0.10)`,shade:`rgba(${this.whiteBase}, 0.14)`,transparent:`rgba(${this.whiteBase}, 0.08)`,text:this.text.primary,contrastText:`rgb(${this.whiteBase})`,border:`rgba(${this.whiteBase}, 0.08)`},this.info=this.primary,this.error={main:s.redDarkMain,text:s.redDarkText},this.success={main:s.greenDarkMain,text:s.greenDarkText},this.warning={main:s.orangeDarkMain,text:s.orangeDarkText},this.background={canvas:s.gray05,primary:s.gray10,secondary:s.gray15},this.action={hover:`rgba(${this.whiteBase}, 0.16)`,selected:`rgba(${this.whiteBase}, 0.12)`,selectedBorder:s.orangeDarkMain,focus:`rgba(${this.whiteBase}, 0.16)`,hoverOpacity:.08,disabledText:this.text.disabled,disabledBackground:`rgba(${this.whiteBase}, 0.04)`,disabledOpacity:.38},this.gradients={brandHorizontal:"linear-gradient(270deg, #FF8A00 0%, #FF8A00 100%)",brandVertical:"linear-gradient(0.01deg, #FF8A00 0.01%, #FF8A00 99.99%)"},this.contrastThreshold=3,this.hoverFactor=.03,this.tonalOffset=.15}}class f{constructor(){this.mode="light",this.blackBase="36, 41, 46",this.primary={main:s.primaryLightMain,border:s.primaryLightText,text:s.primaryLightText},this.text={primary:`rgba(${this.blackBase}, 1)`,secondary:`rgba(${this.blackBase}, 0.75)`,disabled:`rgba(${this.blackBase}, 0.64)`,link:this.primary.text,maxContrast:s.black},this.border={weak:`rgba(${this.blackBase}, 0.12)`,medium:`rgba(${this.blackBase}, 0.30)`,strong:`rgba(${this.blackBase}, 0.40)`},this.secondary={main:`rgba(${this.blackBase}, 0.08)`,shade:`rgba(${this.blackBase}, 0.15)`,transparent:`rgba(${this.blackBase}, 0.08)`,contrastText:`rgba(${this.blackBase},  1)`,text:this.text.primary,border:this.border.weak},this.info={main:s.blueLightMain,text:s.blueLightText},this.error={main:s.redLightMain,text:s.redLightText,border:s.redLightText},this.success={main:s.greenLightMain,text:s.greenLightText},this.warning={main:s.orangeLightMain,text:s.orangeLightText},this.background={canvas:s.gray90,primary:s.white,secondary:s.gray100},this.action={hover:`rgba(${this.blackBase}, 0.12)`,selected:`rgba(${this.blackBase}, 0.08)`,selectedBorder:s.orangeLightMain,hoverOpacity:.08,focus:`rgba(${this.blackBase}, 0.12)`,disabledBackground:`rgba(${this.blackBase}, 0.04)`,disabledText:this.text.disabled,disabledOpacity:.38},this.gradients={brandHorizontal:"linear-gradient(90deg, #FF8A00 0%, #FF8A00 100%)",brandVertical:"linear-gradient(0.01deg, #FF8A00 -31.2%, #FF8A00 113.07%)"},this.contrastThreshold=3,this.hoverFactor=.03,this.tonalOffset=.2}}function a(w){const N=new r,B=new f,V=(w.mode??"dark")==="dark"?N:B,{primary:K=V.primary,secondary:H=V.secondary,info:X=V.info,warning:k=V.warning,success:Y=V.success,error:Z=V.error,tonalOffset:se=V.tonalOffset,hoverFactor:j=V.hoverFactor,contrastThreshold:q=V.contrastThreshold,...ne}=w;function oe(te,le=q){return(0,i.eM)(N.text.maxContrast,te,V.background.primary)>=le?N.text.maxContrast:B.text.maxContrast}const z=({color:te,name:le})=>{if(te={...te,name:le},!te.main)throw new Error(`Missing main color for ${le}`);return te.text||(te.text=te.main),te.border||(te.border=te.text),te.shade||(te.shade=V.mode==="light"?(0,i.e$)(te.main,se):(0,i.a)(te.main,se)),te.transparent||(te.transparent=(0,i.X4)(te.main,.15)),te.contrastText||(te.contrastText=oe(te.main)),te.borderTransparent||(te.borderTransparent=(0,i.X4)(te.border,.25)),te};return(0,n.merge)({...V,primary:z({color:K,name:"primary"}),secondary:z({color:H,name:"secondary"}),info:z({color:X,name:"info"}),error:z({color:Z,name:"error"}),success:z({color:Y,name:"success"}),warning:z({color:k,name:"warning"}),getContrastText:oe,emphasize:(te,le)=>(0,i.tL)(te,le??j)},ne)}function c(w,N){const B={padding:1,headerHeight:4,background:w.background.primary,borderColor:w.border.weak,boxShadow:"none"},V={borderColor:w.border.medium,borderHover:w.border.strong,text:w.text.primary,background:w.mode==="dark"?w.background.canvas:w.background.primary};return{height:{sm:3,md:4,lg:6},input:V,panel:B,dropdown:{background:V.background},tooltip:{background:w.background.secondary,text:w.text.primary},dashboard:{background:w.background.canvas,padding:1},overlay:{background:w.mode==="dark"?"rgba(63, 62, 62, 0.45)":"rgba(208, 209, 211, 0.24)"},sidemenu:{width:57},menuTabs:{height:42},textHighlight:{text:w.warning.contrastText,background:w.warning.main},horizontalDrawer:{defaultHeight:400},table:{rowHoverBackground:w.action.hover,rowSelected:w.action.selected}}}function o(w){return w.mode==="dark"?{z1:"0px 1px 2px rgba(1, 4, 9, 0.75)",z2:"0px 4px 8px rgba(1, 4, 9, 0.75)",z3:"0px 8px 24px rgb(1, 4, 9)"}:{z1:"0px 1px 2px rgba(24, 26, 27, 0.2)",z2:"0px 4px 8px rgba(24, 26, 27, 0.2)",z3:"0px 13px 20px 1px rgba(24, 26, 27, 0.18)"}}function h(w){const N=w.borderRadius??2;return{radius:{default:"2px",pill:"9999px",circle:"100%"},borderRadius:K=>`${(K??1)*N}px`}}function g(w={}){const{gridSize:N=8}=w,B=K=>typeof K=="string"?K:K*N,V=(...K)=>(K.length===0&&(K[0]=1),K.map(H=>{const X=B(H);return typeof X=="number"?`${X}px`:X}).join(" "));return V.gridSize=N,V.x0="0px",V.x0_25="2px",V.x0_5="4px",V.x1="8px",V.x1_5="12px",V.x2="16px",V.x2_5="20px",V.x3="24px",V.x4="32px",V.x5="40px",V.x6="48px",V.x8="64px",V.x10="80px",V}const l={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},p={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function m(w=["all"],N={}){const{duration:B=p.standard,easing:V=l.easeInOut,delay:K=0}=N;return(Array.isArray(w)?w:[w]).map(H=>`${H} ${typeof B=="string"?B:v(B)} ${V} ${typeof K=="string"?K:v(K)}`).join(",")}function y(...w){return w.map(N=>`@media (prefers-reduced-motion: ${N})`).join(",")}function d(w){if(!w)return 0;const N=w/36;return Math.round((4+15*N**.25+N/5)*10)}function v(w){return`${Math.round(w)}ms`}function u(){return{create:m,duration:p,easing:l,getAutoHeightDuration:d,handleMotion:y}}const D='"Inter", "Helvetica", "Arial", sans-serif',P="'Roboto Mono', monospace";function x(w,N={}){const{fontFamily:B=D,fontFamilyMonospace:V=P,fontSize:K=14,fontWeightLight:H=300,fontWeightRegular:X=400,fontWeightMedium:k=500,fontWeightBold:Y=500,htmlFontSize:Z=14}=N,se=K/14,j=z=>`${z/Z*se}rem`,q=(z,te,le,ie,ae)=>{if(le%2!==0||te%2!==0)throw new Error("Font size and line height should be integer multiples of 2 to prevent issues with alignment");return{fontFamily:B,fontWeight:z,fontSize:j(te),lineHeight:le/te,...B===D?{letterSpacing:`${E(ie/te)}em`}:{},...ae}},ne={h1:q(X,28,32,-.25),h2:q(X,24,28,0),h3:q(X,22,24,0),h4:q(X,18,22,.25),h5:q(X,16,22,0),h6:q(k,14,22,.15),body:q(X,K,22,.15),bodySmall:q(X,12,18,.15),code:{...q(X,14,16,.15),fontFamily:V}};return{htmlFontSize:Z,pxToRem:j,fontFamily:B,fontFamilyMonospace:V,fontSize:K,fontWeightLight:H,fontWeightRegular:X,fontWeightMedium:k,fontWeightBold:Y,size:{base:"14px",xs:"10px",sm:"12px",md:"14px",lg:"18px"},...ne}}function E(w){return Math.round(w*1e5)/1e5}var C=e(25137);function M(w){const N={name:"Grafana Default",typography:{fontFamily:{sansSerif:w.typography.fontFamily,monospace:w.typography.fontFamilyMonospace},size:{base:`${w.typography.fontSize}px`,xs:w.typography.size.xs,sm:w.typography.size.sm,md:w.typography.size.md,lg:w.typography.size.lg},heading:{h1:w.typography.h1.fontSize,h2:w.typography.h2.fontSize,h3:w.typography.h3.fontSize,h4:w.typography.h4.fontSize,h5:w.typography.h5.fontSize,h6:w.typography.h6.fontSize},weight:{light:w.typography.fontWeightLight,regular:w.typography.fontWeightRegular,semibold:w.typography.fontWeightMedium,bold:w.typography.fontWeightBold},lineHeight:{xs:w.typography.bodySmall.lineHeight,sm:w.typography.bodySmall.lineHeight,md:w.typography.body.lineHeight,lg:w.typography.h2.lineHeight},link:{decoration:"none",hoverDecoration:"none"}},breakpoints:{xs:`${w.breakpoints.values.xs}px`,sm:`${w.breakpoints.values.sm}px`,md:`${w.breakpoints.values.md}px`,lg:`${w.breakpoints.values.lg}px`,xl:`${w.breakpoints.values.xl}px`,xxl:`${w.breakpoints.values.xxl}px`},spacing:{base:w.spacing.gridSize,insetSquishMd:w.spacing(.5,1),d:w.spacing(2),xxs:w.spacing(.25),xs:w.spacing(.5),sm:w.spacing(1),md:w.spacing(2),lg:w.spacing(3),xl:w.spacing(4),gutter:w.spacing(4),formSpacingBase:w.spacing.gridSize,formMargin:`${w.spacing.gridSize*4}px`,formFieldsetMargin:`${w.spacing.gridSize*2}px`,formInputHeight:w.spacing.gridSize*4,formButtonHeight:w.spacing.gridSize*4,formInputPaddingHorizontal:`${w.spacing.gridSize}px`,formInputAffixPaddingHorizontal:`${w.spacing.gridSize/2}px`,formInputMargin:`${w.spacing.gridSize*2}px`,formLabelPadding:"0 0 0 2px",formLabelMargin:`0 0 ${w.spacing.gridSize/2+"px"} 0`,formValidationMessagePadding:"4px 8px",formValidationMessageMargin:"4px 0 0 0",inlineFormMargin:"4px"},border:{radius:{sm:w.shape.borderRadius(1),md:w.shape.borderRadius(2),lg:w.shape.borderRadius(3)},width:{sm:"1px"}},height:{sm:w.spacing.gridSize*w.components.height.sm,md:w.spacing.gridSize*w.components.height.md,lg:w.spacing.gridSize*w.components.height.lg},panelPadding:w.components.panel.padding*w.spacing.gridSize,panelHeaderHeight:w.spacing.gridSize*w.components.panel.headerHeight,zIndex:w.zIndex},B={...S,black:"#000000",white:"#ffffff",dark1:"#141414",dark2:"#161719",dark3:"#1f1f20",dark4:"#212124",dark5:"#222426",dark6:"#262628",dark7:"#292a2d",dark8:"#2f2f32",dark9:"#343436",dark10:"#424345",gray1:"#555555",gray2:"#8e8e8e",gray3:"#b3b3b3",gray4:"#d8d9da",gray5:"#ececec",gray6:"#f4f5f8",gray7:"#fbfbfb",redBase:"#e02f44",redShade:"#c4162a",greenBase:"#299c46",greenShade:"#23843b",red:"#d44a3a",yellow:"#ecbb13",purple:"#9933cc",variable:"#32d1df",orange:"#eb7b18",orangeDark:"#ff780a"},V={bg1:w.colors.background.primary,bg2:w.colors.background.secondary,bg3:w.colors.action.hover,dashboardBg:w.colors.background.canvas,bgBlue1:w.colors.primary.main,bgBlue2:w.colors.primary.shade},K={border1:w.colors.border.weak,border2:w.colors.border.medium,border3:w.colors.border.strong},H={textStrong:w.colors.text.maxContrast,textHeading:w.colors.text.primary,text:w.colors.text.primary,textSemiWeak:w.colors.text.secondary,textWeak:w.colors.text.secondary,textFaint:w.colors.text.disabled,textBlue:w.colors.primary.text},X={formLabel:w.colors.text.primary,formDescription:w.colors.text.secondary,formInputBg:w.components.input.background,formInputBgDisabled:w.colors.action.disabledBackground,formInputBorder:w.components.input.borderColor,formInputBorderHover:w.components.input.borderHover,formInputBorderActive:w.colors.primary.border,formInputBorderInvalid:w.colors.error.border,formInputPlaceholderText:w.colors.text.disabled,formInputText:w.components.input.text,formInputDisabledText:w.colors.action.disabledText,formFocusOutline:w.colors.primary.main,formValidationMessageText:w.colors.error.contrastText,formValidationMessageBg:w.colors.error.main};return{...N,type:w.colors.mode==="dark"?C.I.Dark:C.I.Light,isDark:w.isDark,isLight:w.isLight,name:w.name,palette:{...B,brandPrimary:B.orange,brandSuccess:w.colors.success.main,brandWarning:w.colors.warning.main,brandDanger:w.colors.error.main,queryRed:w.colors.error.text,queryGreen:w.colors.success.text,queryPurple:"#fe85fc",queryOrange:B.orange,online:w.colors.success.main,warn:w.colors.success.main,critical:w.colors.success.main},colors:{...V,...K,...X,...H,bodyBg:w.colors.background.canvas,panelBg:w.components.panel.background,panelBorder:w.components.panel.borderColor,pageHeaderBg:w.colors.background.canvas,pageHeaderBorder:w.colors.background.canvas,dropdownBg:X.formInputBg,dropdownShadow:B.black,dropdownOptionHoverBg:V.bg2,link:w.colors.text.primary,linkDisabled:w.colors.text.disabled,linkHover:w.colors.text.maxContrast,linkExternal:w.colors.text.link},shadows:{listItem:"none"},visualization:w.visualization}}const S={gray98:"#f7f8fa",gray97:"#f1f5f9",gray95:"#e9edf2",gray90:"#dce1e6",gray85:"#c7d0d9",gray70:"#9fa7b3",gray60:"#7b8087",gray33:"#464c54",gray25:"#2c3235",gray15:"#202226",gray10:"#141619",gray05:"#0b0c0e",blue95:"#5794f2",blue85:"#33a2e5",blue80:"#3274d9",blue77:"#1f60c4",red88:"#e02f44"};var I=e(24293);function T(w){const N=w.mode==="light"?R():b(),B={};for(const H of N)for(const X of H.shades)if(B[X.name]=X.color,X.aliases)for(const k of X.aliases)B[k]=X.color;B.transparent=w.mode==="light"?"rgba(255, 255, 255, 0)":"rgba(0,0,0,0)",B["panel-bg"]=w.background.primary,B.text=w.text.primary;const V=H=>{if(!H)return I.F;const X=B[H];if(X)return X;if(H[0]==="#"||H.indexOf("rgb")>-1)return H;const k=L[H.toLowerCase()];return k?(B[H]=k,k):H},K=A();return{hues:N,palette:K,getColorByName:V}}function b(){return[{name:"red",shades:[{color:"#FFA6B0",name:"super-light-red"},{color:"#FF7383",name:"light-red"},{color:"#F2495C",name:"red",primary:!0},{color:"#E02F44",name:"semi-dark-red"},{color:"#C4162A",name:"dark-red"}]},{name:"orange",shades:[{color:"#FFCB7D",name:"super-light-orange",aliases:[]},{color:"#FFB357",name:"light-orange",aliases:[]},{color:"#FF9830",name:"orange",aliases:[],primary:!0},{color:"#FF780A",name:"semi-dark-orange",aliases:[]},{color:"#FA6400",name:"dark-orange",aliases:[]}]},{name:"yellow",shades:[{color:"#FFF899",name:"super-light-yellow",aliases:[]},{color:"#FFEE52",name:"light-yellow",aliases:[]},{color:"#FADE2A",name:"yellow",aliases:[],primary:!0},{color:"#F2CC0C",name:"semi-dark-yellow",aliases:[]},{color:"#E0B400",name:"dark-yellow",aliases:[]}]},{name:"green",shades:[{color:"#C8F2C2",name:"super-light-green",aliases:[]},{color:"#96D98D",name:"light-green",aliases:[]},{color:"#73BF69",name:"green",aliases:[],primary:!0},{color:"#56A64B",name:"semi-dark-green",aliases:[]},{color:"#37872D",name:"dark-green",aliases:[]}]},{name:"blue",shades:[{color:"#C0D8FF",name:"super-light-blue",aliases:[]},{color:"#8AB8FF",name:"light-blue",aliases:[]},{color:"#5794F2",name:"blue",aliases:[],primary:!0},{color:"#3274D9",name:"semi-dark-blue",aliases:[]},{color:"#1F60C4",name:"dark-blue",aliases:[]}]},{name:"purple",shades:[{color:"#DEB6F2",name:"super-light-purple",aliases:[]},{color:"#CA95E5",name:"light-purple",aliases:[]},{color:"#B877D9",name:"purple",aliases:[],primary:!0},{color:"#A352CC",name:"semi-dark-purple",aliases:[]},{color:"#8F3BB8",name:"dark-purple",aliases:[]}]}]}function R(){return[{name:"red",shades:[{color:"#FF7383",name:"super-light-red"},{color:"#F2495C",name:"light-red"},{color:"#E02F44",name:"red",primary:!0},{color:"#C4162A",name:"semi-dark-red"},{color:"#AD0317",name:"dark-red"}]},{name:"orange",shades:[{color:"#FFB357",name:"super-light-orange",aliases:[]},{color:"#FF9830",name:"light-orange",aliases:[]},{color:"#FF780A",name:"orange",aliases:[],primary:!0},{color:"#FA6400",name:"semi-dark-orange",aliases:[]},{color:"#E55400",name:"dark-orange",aliases:[]}]},{name:"yellow",shades:[{color:"#FFEE52",name:"super-light-yellow",aliases:[]},{color:"#FADE2A",name:"light-yellow",aliases:[]},{color:"#F2CC0C",name:"yellow",aliases:[],primary:!0},{color:"#E0B400",name:"semi-dark-yellow",aliases:[]},{color:"#CC9D00",name:"dark-yellow",aliases:[]}]},{name:"green",shades:[{color:"#96D98D",name:"super-light-green",aliases:[]},{color:"#73BF69",name:"light-green",aliases:[]},{color:"#56A64B",name:"green",aliases:[],primary:!0},{color:"#37872D",name:"semi-dark-green",aliases:[]},{color:"#19730E",name:"dark-green",aliases:[]}]},{name:"blue",shades:[{color:"#8AB8FF",name:"super-light-blue",aliases:[]},{color:"#5794F2",name:"light-blue",aliases:[]},{color:"#3274D9",name:"blue",aliases:[],primary:!0},{color:"#1F60C4",name:"semi-dark-blue",aliases:[]},{color:"#1250B0",name:"dark-blue",aliases:[]}]},{name:"purple",shades:[{color:"#CA95E5",name:"super-light-purple",aliases:[]},{color:"#B877D9",name:"light-purple",aliases:[]},{color:"#A352CC",name:"purple",aliases:[],primary:!0},{color:"#8F3BB8",name:"semi-dark-purple",aliases:[]},{color:"#7C2EA3",name:"dark-purple",aliases:[]}]}]}function A(){return["green","semi-dark-yellow","light-blue","semi-dark-orange","red","blue","purple","#705DA0","dark-green","yellow","#447EBC","#C15C17","#890F02","#0A437C","#6D1F62","#584477","#B7DBAB","#F4D598","#70DBED","#F9BA8F","#F29191","#82B5D8","#E5A8E2","#AEA2E0","#629E51","#E5AC0E","#64B0C8","#E0752D","#BF1B00","#0A50A1","#962D82","#614D93","#9AC48A","#F2C96D","#65C5DB","#F9934E","#EA6460","#5195CE","#D683CE","#806EB7","#3F6833","#967302","#2F575E","#99440A","#58140C","#052B51","#511749","#3F2B5B","#E0F9D7","#FCEACA","#CFFAFF","#F9E2D2","#FCE2DE","#BADFF4","#F9D9F9","#DEDAF7"]}const L={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},U={activePanel:999,navbarFixed:1e3,sidemenu:1020,dropdown:1030,typeahead:1030,tooltip:1040,modalBackdrop:1050,modal:1060,portal:1061};function W(w={}){const{colors:N={},spacing:B={},shape:V={},typography:K={}}=w,H=a(N),X=t(),k=g(B),Y=h(V),Z=x(H,K),se=o(H),j=u(),q=c(H,se),ne=T(H),oe={name:H.mode==="dark"?"Dark":"Light",isDark:H.mode==="dark",isLight:H.mode==="light",colors:H,breakpoints:X,spacing:k,shape:Y,components:q,typography:Z,shadows:se,transitions:j,visualization:ne,zIndex:{...U},flags:{}};return{...oe,v1:M(oe)}}},97594:(G,O,e)=>{"use strict";e.d(O,{g:()=>i,k:()=>s});var t=e(83077),n=e(75972);function i(o){return(r.getIfExists(o)??r.get("dark")).build()}function s(o){return r.list().filter(h=>o?!0:!h.isExtra)}const r=new t.O(()=>[{id:"system",name:"System preference",build:f},{id:"dark",name:"Dark",build:()=>(0,n.a)({colors:{mode:"dark"}})},{id:"light",name:"Light",build:()=>(0,n.a)({colors:{mode:"light"}})},{id:"blue-night",name:"Blue night",build:c,isExtra:!0},{id:"midnight",name:"Midnight",build:a,isExtra:!0}]);function f(){const h=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";return i(h)}function a(){const o="204, 204, 220";return(0,n.a)({name:"Midnight",colors:{mode:"dark",background:{canvas:"#000000",primary:"#000000",secondary:"#181818"},border:{weak:`rgba(${o}, 0.17)`,medium:`rgba(${o}, 0.25)`,strong:`rgba(${o}, 0.35)`}}})}function c(){return(0,n.a)({name:"Blue night",colors:{mode:"dark",background:{canvas:"#15161d",primary:"#15161d",secondary:"#1d1f2e"},border:{weak:"#2e304f",medium:"#2e304f",strong:"#2e304f"}}})}},75059:(G,O,e)=>{"use strict";e.d(O,{AS:()=>o,C6:()=>g,Em:()=>a,H3:()=>l,Nw:()=>c,gy:()=>f});var t=e(2543),n=e.n(t),i=e(39070),s=e(11261),r=e(83077),f=(x=>(x.sum="sum",x.max="max",x.min="min",x.logmin="logmin",x.mean="mean",x.variance="variance",x.stdDev="stdDev",x.last="last",x.first="first",x.count="count",x.range="range",x.diff="diff",x.diffperc="diffperc",x.delta="delta",x.step="step",x.firstNotNull="firstNotNull",x.lastNotNull="lastNotNull",x.changeCount="changeCount",x.distinctCount="distinctCount",x.allIsZero="allIsZero",x.allIsNull="allIsNull",x.allValues="allValues",x.uniqueValues="uniqueValues",x.p1="p1",x.p2="p2",x.p3="p3",x.p4="p4",x.p5="p5",x.p6="p6",x.p7="p7",x.p8="p8",x.p9="p9",x.p10="p10",x.p11="p11",x.p12="p12",x.p13="p13",x.p14="p14",x.p15="p15",x.p16="p16",x.p17="p17",x.p18="p18",x.p19="p19",x.p20="p20",x.p21="p21",x.p22="p22",x.p23="p23",x.p24="p24",x.p25="p25",x.p26="p26",x.p27="p27",x.p28="p28",x.p29="p29",x.p30="p30",x.p31="p31",x.p32="p32",x.p33="p33",x.p34="p34",x.p35="p35",x.p36="p36",x.p37="p37",x.p38="p38",x.p39="p39",x.p40="p40",x.p41="p41",x.p42="p42",x.p43="p43",x.p44="p44",x.p45="p45",x.p46="p46",x.p47="p47",x.p48="p48",x.p49="p49",x.p50="p50",x.p51="p51",x.p52="p52",x.p53="p53",x.p54="p54",x.p55="p55",x.p56="p56",x.p57="p57",x.p58="p58",x.p59="p59",x.p60="p60",x.p61="p61",x.p62="p62",x.p63="p63",x.p64="p64",x.p65="p65",x.p66="p66",x.p67="p67",x.p68="p68",x.p69="p69",x.p70="p70",x.p71="p71",x.p72="p72",x.p73="p73",x.p74="p74",x.p75="p75",x.p76="p76",x.p77="p77",x.p78="p78",x.p79="p79",x.p80="p80",x.p81="p81",x.p82="p82",x.p83="p83",x.p84="p84",x.p85="p85",x.p86="p86",x.p87="p87",x.p88="p88",x.p89="p89",x.p90="p90",x.p91="p91",x.p92="p92",x.p93="p93",x.p94="p94",x.p95="p95",x.p96="p96",x.p97="p97",x.p98="p98",x.p99="p99",x))(f||{});function a(x){return Object.keys(f).includes(x)}function c(x){const{field:E,reducers:C}=x;if(!E||!C||C.length<1)return{};if(E.state?.calcs){const A=[];for(const L of C)E.state.calcs.hasOwnProperty(L)||A.push(L);if(A.length<1)return{...E.state.calcs}}E.state||(E.state={});const M=o.list(C),S=E.values;if(S&&S.length<1){const A={...E.state.calcs};for(const L of M)A[L.id]=L.emptyInputResult!==null?L.emptyInputResult:null;return E.state.calcs=A}const{nullValueMode:I=i.UW.Ignore}=E.config,T=I===i.UW.Ignore,b=I===i.UW.AsZero;if(M.length===1&&M[0].reduce){const A=M[0].reduce(E,T,b);return E.state.calcs={...E.state.calcs,...A},A}let R=l(E,T,b);for(const A of M)!R.hasOwnProperty(A.id)&&A.reduce&&(R={...R,...A.reduce(E,T,b)});return E.state.calcs={...E.state.calcs,...R},R}const o=new r.O(()=>[{id:"lastNotNull",name:"Last *",description:"Last non-null value (also excludes NaNs)",standard:!0,aliasIds:["current"],reduce:d,preservesUnits:!0},{id:"last",name:"Last",description:"Last value",standard:!0,reduce:y,preservesUnits:!0},{id:"firstNotNull",name:"First *",description:"First non-null value (also excludes NaNs)",standard:!0,reduce:m,preservesUnits:!0},{id:"first",name:"First",description:"First Value",standard:!0,reduce:p,preservesUnits:!0},{id:"min",name:"Min",description:"Minimum Value",standard:!0,preservesUnits:!0},{id:"max",name:"Max",description:"Maximum Value",standard:!0,preservesUnits:!0},{id:"mean",name:"Mean",description:"Average Value",standard:!0,aliasIds:["avg"],preservesUnits:!0},{id:"variance",name:"Variance",description:"Variance of all values in a field",standard:!1,reduce:v,preservesUnits:!0},{id:"stdDev",name:"StdDev",description:"Standard deviation of all values in a field",standard:!1,reduce:v,preservesUnits:!0},{id:"sum",name:"Total",description:"The sum of all values",emptyInputResult:0,standard:!0,aliasIds:["total"],preservesUnits:!0},{id:"count",name:"Count",description:"Number of values in response",emptyInputResult:0,standard:!0,preservesUnits:!1},{id:"range",name:"Range",description:"Difference between minimum and maximum values",standard:!0,preservesUnits:!0},{id:"delta",name:"Delta",description:"Cumulative change in value",standard:!0,preservesUnits:!0},{id:"step",name:"Step",description:"Minimum interval between values",standard:!0,preservesUnits:!0},{id:"diff",name:"Difference",description:"Difference between first and last values",standard:!0,preservesUnits:!0},{id:"logmin",name:"Min (above zero)",description:"Used for log min scale",standard:!0,preservesUnits:!0},{id:"allIsZero",name:"All Zeros",description:"All values are zero",emptyInputResult:!1,standard:!0,preservesUnits:!0},{id:"allIsNull",name:"All Nulls",description:"All values are null",emptyInputResult:!0,standard:!0,preservesUnits:!1},{id:"changeCount",name:"Change Count",description:"Number of times the value changes",standard:!1,reduce:u,preservesUnits:!1},{id:"distinctCount",name:"Distinct Count",description:"Number of distinct values",standard:!1,reduce:D,preservesUnits:!1},{id:"diffperc",name:"Difference percent",description:"Percentage difference between first and last values",standard:!0,preservesUnits:!1},{id:"allValues",name:"All values",description:"Returns an array with all values",standard:!1,reduce:x=>({allValues:[...x.values]}),preservesUnits:!1},{id:"uniqueValues",name:"All unique values",description:"Returns an array with all unique values",standard:!1,reduce:x=>({uniqueValues:[...new Set(x.values)]}),preservesUnits:!1},...h()]),h=(x=[...Array.from({length:99},(E,C)=>C+1)])=>{const E=[],C=M=>M>3&&M<21?"th":M%10===1?"st":M%10===2?"nd":M%10===3?"rd":"th";return x.forEach(M=>{const S=M/100,I=`p${M}`,T=`${M}${C(M)} %`,b=`${M}${C(M)} percentile value`;E.push({id:I,name:T,description:b,standard:!1,reduce:(R,A,L)=>({[I]:P(R,S,A,L)}),preservesUnits:!0})}),E},g={sum:0,max:-Number.MAX_VALUE,min:Number.MAX_VALUE,logmin:Number.MAX_VALUE,mean:null,last:null,first:null,lastNotNull:null,firstNotNull:null,count:0,nonNullCount:0,allIsNull:!0,allIsZero:!0,range:null,diff:null,delta:0,step:Number.MAX_VALUE,diffperc:0,previousDeltaUp:!0};function l(x,E,C){const M={...g},S=x.values;if(!S)return M;const I=x.type===s.PU.number||x.type===s.PU.time;for(let T=0;T<S.length;T++){let b=S[T];if(T===0&&(M.first=b),M.last=b,b==null){if(E)continue;C&&(b=0)}if(M.count++,b!=null&&!Number.isNaN(b)){const R=M.firstNotNull===null;if(R&&(M.firstNotNull=b),I){if(M.sum+=b,M.allIsNull=!1,M.nonNullCount++,!R){const A=b-M.lastNotNull;M.step>A&&(M.step=A),M.lastNotNull>b?(M.previousDeltaUp=!1,T===S.length-1&&(M.delta+=b)):(M.previousDeltaUp?M.delta+=A:M.delta+=b,M.previousDeltaUp=!0)}b>M.max&&(M.max=b),b<M.min&&(M.min=b),b<M.logmin&&b>0&&(M.logmin=b)}b!==0&&(M.allIsZero=!1),M.lastNotNull=b}}return M.max===-Number.MAX_VALUE&&(M.max=null),M.min===Number.MAX_VALUE&&(M.min=null),M.step===Number.MAX_VALUE&&(M.step=null),M.nonNullCount>0&&(M.mean=M.sum/M.nonNullCount),M.allIsNull&&(M.allIsZero=!1),M.max!==null&&M.min!==null&&(M.range=M.max-M.min),(0,t.isNumber)(M.firstNotNull)&&(0,t.isNumber)(M.lastNotNull)&&(M.diff=M.lastNotNull-M.firstNotNull),(0,t.isNumber)(M.firstNotNull)&&(0,t.isNumber)(M.diff)&&(M.diffperc=M.diff/M.firstNotNull*100),M}function p(x,E,C){return{first:x.values[0]}}function m(x,E,C){const M=x.values;for(let S=0;S<M.length;S++){const I=M[S];if(I!=null&&!Number.isNaN(I))return{firstNotNull:I}}return{firstNotNull:null}}function y(x,E,C){const M=x.values;return{last:M[M.length-1]}}function d(x,E,C){const M=x.values;let S=M.length-1;for(;S>=0;){const I=M[S--];if(I!=null&&!Number.isNaN(I))return{lastNotNull:I}}return{lastNotNull:null}}function v(x,E,C){if(!(x.type===s.PU.number||x.type===s.PU.time))return{variance:0,stdDev:0};let M=0,S=0,I=0;const T=x.values;for(let b=0;b<T.length;b++){const R=T[b];if(R!=null){I++;let A=S;S+=(R-A)/I,M+=(R-A)*(R-S)}}if(I>0){const b=M/I;return{variance:b,stdDev:Math.sqrt(b)}}return{variance:0,stdDev:0}}function u(x,E,C){const M=x.values;let S=0,I=!0,T=null;for(let b=0;b<M.length;b++){let R=M[b];if(R===null){if(E)continue;C&&(R=0)}!I&&T!==R&&S++,I=!1,T=R}return{changeCount:S}}function D(x,E,C){const M=x.values,S=new Set;for(let I=0;I<M.length;I++){let T=M[I];if(T===null){if(E)continue;C&&(T=0)}S.add(T)}return{distinctCount:S.size}}function P(x,E,C,M){let S=x.values;C&&(S=S.filter(b=>b!==null)),M&&(S=S.map(b=>b===null?0:b));const I=S.slice().sort((b,R)=>b-R),T=Math.round((I.length-1)*E);return I[T]}},85200:(G,O,e)=>{"use strict";e.d(O,{Dq:()=>u,NS:()=>v,RE:()=>y,hI:()=>d,kK:()=>D,sJ:()=>m});var t=e(83077),n=e(7029),i=e(24814),s=e(58972),r=e(72693),f=e(8549),a=e(83855),c=e(60005),o=e(21262),h=e(70218),g=e(55008),l=e(16378),p=e(75754);const m=new t.O(()=>[...(0,r.nz)(),...(0,n._)(),...(0,s.P7)(),...(0,a.W)(),i.u]),y=new t.O(()=>[...(0,r.UM)(),...(0,s.Y7)(),...(0,f.i)()]),d=new t.O(()=>[...(0,o._)(),...(0,h.E)(),...(0,c.d)(),...(0,p.m)(),...(0,g.G)(),...(0,l.z)()]);function v(P){const x=m.get(P.id);if(!x)throw new Error("Unknown field matcher: "+P.id);return x.get(P.options)}function u(P){const x=y.get(P.id);if(!x)throw new Error("Unknown frame matcher: "+P.id);return x.get(P.options)}function D(P){const x=d.get(P.id);if(!x)throw new Error("Unknown value matcher: "+P.id);return x.get(P.options)}},58972:(G,O,e)=>{"use strict";e.d(O,{P7:()=>m,PP:()=>r,Y7:()=>y});var t=e(28240),n=e(54479),i=e(11261),s=e(1173),r=(d=>(d.exclude="exclude",d.include="include",d))(r||{});const f={id:s.Ct.byName,name:"Field Name",description:"match the field name",defaultOptions:"",get:d=>{const u=c(new Set([d]));return(D,P,x)=>d===D.name||d===(0,t.Ct)(D,P,x)||!!(u&&u(D,P,x))},getOptionsDisplayText:d=>`Field name: ${d}`},a={id:s.Ct.byNames,name:"Field Names",description:"match any of the given the field names",defaultOptions:{mode:"include",names:[]},get:d=>{const{names:v,mode:u="include"}=d,D=new Set(v??[]),P=c(D),x=(E,C,M)=>D.has(E.name)||D.has((0,t.Ct)(E,C,M))||!!(P&&P(E,C,M));return u==="exclude"?(E,C,M)=>!x(E,C,M):x},getOptionsDisplayText:d=>{const{names:v,mode:u}=d,D=(v??[]).join(", ");return u==="exclude"?`All except: ${D}`:`All of: ${D}`}};function c(d){let v;return window?.grafanaBootData?.settings?.featureToggles?.dataplaneFrontendFallback&&(d.has(i.Bc)?v=(D,P)=>!!D.labels&&D.labels?.__name__===D.name:(d.has("Time")||d.has("time"))&&(v=(D,P)=>P.meta?.typeVersion==null&&D.type===i.PU.time)),v}const o={id:s.Ct.byRegexp,name:"Field Name by Regexp",description:"match the field name by a given regexp pattern",defaultOptions:"/.*/",get:d=>{const v=l(d);return(u,D,P)=>{const x=(0,t.Ct)(u,D,P);return!!v&&v.test(x)}},getOptionsDisplayText:d=>`Field name by pattern: ${d}`},h={id:s.Ct.byFrameRefID,name:"Fields by frame refId",description:"match all fields returned in data frame with refId.",defaultOptions:"",get:d=>(v,u,D)=>u.refId===d,getOptionsDisplayText:d=>`Math all fields returned by query with reference ID: ${d}`},g={id:s.Ct.byRegexpOrNames,name:"Field Name by Regexp or Names",description:"match the field name by a given regexp pattern or given names",defaultOptions:{pattern:"/.*/",names:[]},get:d=>{const v=o.get(d?.pattern||""),u=a.get({mode:"include",names:d?.names??[]});return(D,P,x)=>u(D,P,x)||v(D,P,x)},getOptionsDisplayText:d=>{const v=d?.pattern??"",u=d?.names?.join(",")??"";return`Field name by pattern: ${v} or names: ${u}`}},l=d=>{if(d)try{return(0,n.dO)(d)}catch(v){console.error(v);return}},p={id:s.jR.byName,name:"Frame Name",description:"match the frame name",defaultOptions:"/.*/",get:d=>{const v=(0,n.dO)(d);return u=>v.test(u.name||"")},getOptionsDisplayText:d=>`Frame name: ${d}`};function m(){return[f,o,a,g,h]}function y(){return[p]}},72693:(G,O,e)=>{"use strict";e.d(O,{UM:()=>P,Yg:()=>h,nz:()=>D,zx:()=>p});var t=e(11261),n=e(85200),i=e(1173);const s={id:i.cV.anyMatch,name:"Any",description:"Any child matches (OR)",excludeFromPicker:!0,defaultOptions:[],get:x=>{const E=x.map(C=>(0,n.NS)(C));return(C,M,S)=>{for(const I of E)if(I(C,M,S))return!0;return!1}},getOptionsDisplayText:x=>{let E="";for(const C of x){E.length>0&&(E+=" OR ");const M=n.sJ.get(C.id);E+=M.getOptionsDisplayText?M.getOptionsDisplayText(C):M.name}return E}},r={id:i.cV.anyMatch,name:"Any",description:"Any child matches (OR)",excludeFromPicker:!0,defaultOptions:[],get:x=>{const E=x.map(C=>(0,n.Dq)(C));return C=>{for(const M of E)if(M(C))return!0;return!1}},getOptionsDisplayText:x=>{let E="";for(const C of x){E.length>0&&(E+=" OR ");const M=n.RE.get(C.id);E+=M.getOptionsDisplayText?M.getOptionsDisplayText(C):M.name}return E}},f={id:i.cV.allMatch,name:"All",description:"Everything matches (AND)",excludeFromPicker:!0,defaultOptions:[],get:x=>{const E=x.map(C=>(0,n.NS)(C));return(C,M,S)=>{for(const I of E)if(!I(C,M,S))return!1;return!0}},getOptionsDisplayText:x=>{let E="";for(const C of x){E.length>0&&(E+=" AND ");const M=n.sJ.get(C.id);E+=M.getOptionsDisplayText?M.getOptionsDisplayText(C):M.name}return E}},a={id:i.cV.allMatch,name:"All",description:"Everything matches (AND)",excludeFromPicker:!0,defaultOptions:[],get:x=>{const E=x.map(C=>(0,n.Dq)(C));return C=>{for(const M of E)if(!M(C))return!1;return!0}},getOptionsDisplayText:x=>{let E="";for(const C of x){E.length>0&&(E+=" AND ");const M=n.RE.get(C.id);E+=M.getOptionsDisplayText?M.getOptionsDisplayText(C):M.name}return E}},c={id:i.cV.invertMatch,name:"NOT",description:"Inverts other matchers",excludeFromPicker:!0,get:x=>{const E=(0,n.NS)(x);return(C,M,S)=>!E(C,M,S)},getOptionsDisplayText:x=>{const E=n.sJ.get(x.id);return"NOT "+(E.getOptionsDisplayText?E.getOptionsDisplayText(x.options):E.name)}},o={id:i.cV.invertMatch,name:"NOT",description:"Inverts other matchers",excludeFromPicker:!0,get:x=>{const E=(0,n.Dq)(x);return C=>!E(C)},getOptionsDisplayText:x=>{const E=n.RE.get(x.id);return"NOT "+(E.getOptionsDisplayText?E.getOptionsDisplayText(x.options):E.name)}},h=x=>!0,g=x=>!0,l=x=>!1,p=x=>x.type!==t.PU.time,m=x=>!1,y={id:i.cV.alwaysMatch,name:"All Fields",description:"Always Match",get:x=>h,getOptionsDisplayText:x=>"Always"},d={id:i.cV.alwaysMatch,name:"All Frames",description:"Always Match",get:x=>g,getOptionsDisplayText:x=>"Always"},v={id:i.cV.neverMatch,name:"No Fields",description:"Never Match",excludeFromPicker:!0,get:x=>l,getOptionsDisplayText:x=>"Never"},u={id:i.cV.neverMatch,name:"No Frames",description:"Never Match",get:x=>m,getOptionsDisplayText:x=>"Never"};function D(){return[s,f,c,y,v]}function P(){return[r,a,o,d,u]}},97497:(G,O,e)=>{"use strict";e.d(O,{h:()=>i,m:()=>n});var t=e(83077),n=(s=>(s.Combine="combine",s.CalculateNewFields="calculateNewFields",s.CreateNewVisualization="createNewVisualization",s.Filter="filter",s.PerformSpatialOperations="performSpatialOperations",s.Reformat="reformat",s.ReorderAndRename="reorderAndRename",s))(n||{});const i=new t.O},2514:(G,O,e)=>{"use strict";e.d(O,{m:()=>o});var t=e(62467),n=e(69862),i=e(81160),s=e(85200),r=e(97497);const f=(g,l)=>p=>{const m=r.h.get(g.id);if(!m)return p;const d={...m.transformation.defaultOptions??{},...g.options},v=g.filter?.options?(0,s.Dq)(g.filter):void 0;return p.pipe((0,n.Z)(u=>(0,t.of)(a(u,v)).pipe(m.transformation.operator(d,l),c(u,m,v))))};function a(g,l){return l?g.filter(p=>l(p)):g}const c=(g,l,p)=>m=>m.pipe((0,i.T)(y=>{if(y===g)return y;if(p){let d=0;const v=g.filter((u,D)=>{const P=!p(u);return P&&!d&&(d=D),P});v.length&&y.splice(d,0,...v)}return y}));function o(g,l,p){const m=(0,t.of)(l);if(!g.length)return m;const y=[],d=p??{interpolate:v=>v};for(let v=0;v<g.length;v++){const u=g[v];if(h(u))y.push(u(d));else{if(u.disabled)continue;y.push(f(u,d))}}return m.pipe.apply(m,y)}function h(g){return typeof g=="function"}},57934:(G,O,e)=>{"use strict";e.d(O,{c:()=>me});var t=e(66350),n=e(82150),i=e(50311),s=e(34125),r=e(64224),f=e(35602),a=e(1173),c=e(18282);const o={id:c.F.filterByRefId,name:"Filter data by query refId",description:"select a subset of results",defaultOptions:{},operator:(ee,de)=>De=>{const fe={};return ee.include&&(fe.include={id:a.jR.byRefId,options:ee.include}),ee.exclude&&(fe.exclude={id:a.jR.byRefId,options:ee.exclude}),De.pipe(r.I.operator(fe,de))}};var h=e(73376),g=e(15400),l=e(81160),p=e(28240),m=e(81010);const y={id:c.F.formatTime,name:"Format time",description:"Set the output format of a time field",defaultOptions:{timeField:"",outputFormat:"",useTimezone:!0},isApplicable:ee=>{for(const de of ee)for(const De of de.fields)if(De.type==="time")return m.M.Applicable;return m.M.NotApplicable},isApplicableDescription:"The Format time transformation requires a time field to work. No time field could be found.",operator:(ee,de)=>De=>De.pipe((0,l.T)(fe=>d(ee,fe,de)))},d=({timeField:ee,outputFormat:de,timezone:De},fe,Te)=>!Array.isArray(fe)||fe.length===0?fe:((0,p.Fm)(fe),de=Te?.interpolate(de)??de,fe.map(je=>({...je,fields:je.fields.map(He=>(He.state?.displayName===ee&&(He=(0,i.Xv)(He,de,{timeZone:De})),He))})));var v=e(25094),u=e(68133),D=e(11261),P=e(85200);const x="Time",E="Time",C="Value",M=m.N.Empty,S=window?.grafanaBootData?.settings?.featureToggles?.dataplaneFrontendFallback,I={id:c.F.groupingToMatrix,name:"Grouping to Matrix",description:"Groups series by field and return a matrix visualisation",defaultOptions:{columnField:x,rowField:E,valueField:C},isApplicable:ee=>{let de=0;for(const De of ee)de+=De.fields.length;return de>=3?m.M.Applicable:m.M.NotApplicable},isApplicableDescription:ee=>{let de=0;for(const De of ee)de+=De.fields.length;return`Grouping to matrix requiers at least 3 fields to work. Currently there are ${de} fields.`},operator:ee=>de=>de.pipe((0,l.T)(De=>{const fe=ee.columnField||x,Te=ee.rowField||E,je=ee.valueField||C,He=ee.emptyValue||M;if(De.length!==1)return De;const Be=De[0],Ne=b(Be,fe),Re=b(Be,Te),Se=b(Be,je),We=`${Te}\\${fe}`;if(!Ne||!Re||!Se)return De;const Ke=T(Ne.values),Xe=T(Re.values),Je={};for(let pt=0;pt<Se.values.length;pt++){const xt=Ne.values[pt],ot=Re.values[pt],$e=Se.values[pt];Je[xt]||(Je[xt]={}),Je[xt][ot]=$e}const st=[{name:We,values:Xe,type:D.PU.string,config:{}}];for(const pt of Ke){let xt=[];for(const ot of Xe){const $e=Je[pt][ot]??R(He);xt.push($e)}S&&typeof pt=="number"&&(Se.config={...Se.config,displayNameFromDS:void 0}),st.push({name:pt.toString(),values:xt,config:Se.config,type:Se.type})}return[{fields:st,length:Xe.length}]}))};function T(ee){const de=new Set;for(let De=0;De<ee.length;De++)de.add(ee[De]);return Array.from(de)}function b(ee,de){for(let De=0;De<ee.fields.length;De++){const fe=ee.fields[De];let Te;if(S?Te=P.sJ.get(a.Ct.byName).get(de)(fe,ee,[ee]):Te=de===(0,p.Ct)(fe),Te)return fe}return null}function R(ee){switch(ee){case m.N.False:return!1;case m.N.True:return!0;case m.N.Null:return null;case m.N.Empty:default:return""}}var A=e(77678),L=e(41511),U=e(6829),W=e(67641);const w=10,N={id:c.F.limit,name:"Limit",description:"Limit the number of items to the top N",defaultOptions:{limitField:w},operator:(ee,de)=>De=>De.pipe((0,l.T)(fe=>{let Te=w;return ee.limitField!==void 0&&(typeof ee.limitField=="string"?(0,W.w)()?Te=parseInt(de.interpolate(ee.limitField),10):Te=parseInt(ee.limitField,10):Te=ee.limitField),fe.map(je=>je.length>Te?{...je,fields:je.fields.map(He=>({...He,values:He.values.slice(0,Te)})),length:Te}:je)}))};var B=e(58140),V=e(64586),K=e(82280);const H={id:c.F.rename,name:"Rename fields by name",description:"Rename fields based on configuration given by user",defaultOptions:{renameByName:{}},operator:ee=>de=>de.pipe((0,l.T)(De=>{const fe=X(ee.renameByName);return!Array.isArray(De)||De.length===0?De:De.map(Te=>({...Te,fields:fe(Te)}))}))},X=ee=>de=>!ee||Object.keys(ee).length===0?de.fields:de.fields.map(De=>{const fe=(0,p.Ct)(De,de),Te=ee[fe];return typeof Te!="string"||Te.length===0?De:{...De,config:{...De.config,displayName:Te},state:{...De.state,displayName:Te}}}),k={id:c.F.organize,name:"Organize fields by name",description:"Order, filter and rename fields based on configuration given by user",defaultOptions:{excludeByName:{},indexByName:{},renameByName:{},includeByName:{}},isApplicable:ee=>ee.length>1?m.M.NotPossible:m.M.Applicable,operator:(ee,de)=>De=>De.pipe(f.D.operator({include:ee.includeByName?{names:Y(ee.includeByName)}:void 0,exclude:{names:Y(ee.excludeByName)}},de),K.x.operator(ee,de),H.operator(ee,de))},Y=ee=>ee?Object.keys(ee).filter(de=>ee[de]):[];var Z=e(21128),se=e(54479);const j={id:c.F.renameByRegex,name:"Rename fields by regex",description:"Rename fields based on regular expression by users.",defaultOptions:{regex:"(.*)",renamePattern:"$1"},operator:ee=>de=>de.pipe((0,l.T)(De=>!Array.isArray(De)||De.length===0?De:De.map(q(ee))))},q=ee=>de=>{const De=(0,se.dO)(ee.regex),fe=de.fields.map(Te=>{const je=(0,p.Ct)(Te,de);if(!De.test(je))return Te;const He=je.replace(De,ee.renamePattern);return{...Te,config:{...Te.config,displayName:He},state:{...Te.state,displayName:He}}});return{...de,fields:fe}};var ne=e(2543),oe=e(37471),z=e(14236),te=e(19845);const le={id:c.F.seriesToRows,name:"Series to rows",description:"Combines multiple series into a single serie and appends a column with metric name per value.",defaultOptions:{},operator:ee=>de=>de.pipe((0,l.T)(De=>{if(!Array.isArray(De)||De.length===0||(De=De.filter(Be=>Be.length>0),!(0,te.jq)(De)))return De;const fe={},Te=new Set,je=new oe.k,He={name:D.aI,values:[],config:{},type:D.PU.string};for(let Be=0;Be<De.length;Be++){const Ne=De[Be];for(let Re=0;Re<Ne.fields.length;Re++){const Se=Ne.fields[Re];if(Se.type===D.PU.time){fe[Be]=Re,Te.has(D.LE)||(je.addField(ie(Se,D.LE)),je.addField(He),Te.add(D.LE));continue}Te.has(D.Bc)||(je.addField(ie(Se,D.Bc)),Te.add(D.Bc))}}for(let Be=0;Be<De.length;Be++){const Ne=De[Be];for(let Re=0;Re<Ne.length;Re++){const Se=fe[Be],We=Se===0?1:0;je.add({[D.LE]:Ne.fields[Se].values[Re],[D.aI]:(0,p.Ri)(Ne),[D.Bc]:Ne.fields[We].values[Re]})}}return[(0,z.ES)(je,0,!0)]}))},ie=(ee,de)=>({...(0,ne.omit)(ee,["values","state","labels","config","name"]),name:de,values:[],config:{...(0,ne.omit)(ee.config,["displayName","displayNameFromDS"])}}),ae={id:c.F.sortBy,name:"Sort by",description:"Sort fields in a frame.",defaultOptions:{fields:{}},operator:(ee,de)=>De=>De.pipe((0,l.T)(fe=>!Array.isArray(fe)||fe.length===0||!ee?.sort?.length?fe:re(fe,ee.sort,de)))};function re(ee,de,De){return ee.map(fe=>{const Te=ce(fe,de,De);return Te.length&&Te[0].index!=null?(0,z.ES)(fe,Te[0].index,Te[0].desc):fe})}function ce(ee,de,De){return de.map(fe=>fe.index!=null?fe:(0,W.w)()?{...fe,index:ee.fields.findIndex(Te=>De.interpolate(fe.field)===(0,p.Ct)(Te,ee))}:{...fe,index:ee.fields.findIndex(Te=>fe.field===(0,p.Ct)(Te,ee))})}const me={noopTransformer:V.W,filterFieldsTransformer:r.z,filterFieldsByNameTransformer:f.D,filterFramesTransformer:r.I,filterFramesByRefIdTransformer:o,filterByValueTransformer:h.Sv,formatStringTransformer:g.yt,formatTimeTransformer:y,orderFieldsTransformer:K.x,organizeFieldsTransformer:k,reduceTransformer:Z.Wj,concatenateTransformer:n.vz,calculateFieldTransformer:t.SC,joinByFieldTransformer:L.L,seriesToColumnsTransformer:L.L,seriesToRowsTransformer:le,renameFieldsTransformer:H,labelsToFieldsTransformer:U.V,ensureColumnsTransformer:s.b,groupByTransformer:v.of,sortByTransformer:ae,mergeTransformer:B.o,renameByRegexTransformer:j,histogramTransformer:A.OA,convertFieldTypeTransformer:i.zM,groupingToMatrixTransformer:I,limitTransformer:N,groupToNestedTable:u._}},66350:(G,O,e)=>{"use strict";e.d(O,{Bp:()=>v,SC:()=>C,UY:()=>d,Uj:()=>P,ip:()=>u,sw:()=>w});var t=e(2543),n=e.n(t),i=e(81160),s=e(14236),r=e(28240),f=e(39070),a=e(11261),c=e(11710),o=e(27618),h=e(75059),g=e(85200),l=e(1173),p=e(34125),m=e(18282),y=e(64586),d=(N=>(N.ReduceRow="reduceRow",N.CumulativeFunctions="cumulativeFunctions",N.WindowFunctions="windowFunctions",N.BinaryOperation="binary",N.UnaryOperation="unary",N.Index="index",N))(d||{}),v=(N=>(N.Percentage="percentage",N.Fixed="fixed",N))(v||{}),u=(N=>(N.Trailing="trailing",N.Centered="centered",N))(u||{});const D={reducer:h.gy.sum},P={reducer:h.gy.mean,windowAlignment:"trailing",windowSizeMode:"percentage",windowSize:.1},x={left:"",operator:c.k.Add,right:""},E={operator:o._.Abs,fieldName:""},C={id:m.F.calculateField,name:"Add field from calculation",description:"Use the row values to calculate a new field",defaultOptions:{mode:"reduceRow",reduce:{reducer:h.gy.sum}},operator:(N,B)=>V=>{const K=N&&N.timeSeries!==!1?p.b.operator(null,B):y.W.operator({},B);return N.alias!=null&&(N.alias=B.interpolate(N.alias)),V.pipe(K,(0,i.T)(H=>{const X=N.mode??"reduceRow";let k;switch(X){case"reduceRow":k=A((0,t.defaults)(N.reduce,D),H);break;case"cumulativeFunctions":k=R((0,t.defaults)(N.cumulative,D),H);break;case"windowFunctions":k=M((0,t.defaults)(N.window,P),H);break;case"unary":k=W((0,t.defaults)(N.unary,E),H);break;case"binary":const Y={...N.binary,left:B.interpolate(N.binary?.left),right:B.interpolate(N.binary?.right)};k=U((0,t.defaults)(Y,x),H);break;case"index":return H.map(Z=>{const se=[...Array(Z.length).keys()];if(N.index?.asPercentile)for(let q=0;q<se.length;q++)se[q]=se[q]/se.length;const j={name:N.alias??"Row",type:a.PU.number,values:se,config:N.index?.asPercentile?{unit:"percentunit"}:{}};return{...Z,fields:N.replaceFields?[j]:[...Z.fields,j]}})}return k?H.map(Y=>{const Z=k(Y);if(!Z)return Y;const se={name:w(N),type:a.PU.number,config:{},values:Z};let j=[];if(N.replaceFields){const{timeField:q}=(0,s.KR)(Y);q&&N.timeSeries!==!1?j=[q,se]:j=[se]}else j=[...Y.fields,se];return{...Y,fields:j}}):H}))}};function M(N,B){if(N.windowSize<=0)throw new Error("Add field from calculation transformation - Window size must be larger than 0");let V=(0,g.NS)({id:l.Ct.numeric});return N.field&&(V=(0,g.NS)({id:l.Ct.byNames,options:{names:[N.field]}})),K=>{const H=Math.ceil(N.windowSize*(N.windowSizeMode==="percentage"?K.length:1));let X=null;for(const k of K.fields)if(V(k,K,B)){X=k;break}if(X){if(![h.gy.mean,h.gy.stdDev,h.gy.variance].includes(N.reducer))throw new Error(`Add field from calculation transformation - Unsupported reducer: ${N.reducer}`);return N.windowAlignment==="centered"?I(K,N.reducer,X,H):S(K,N.reducer,X,H)}}}function S(N,B,V,K){const H=[];let X=0,k=0;for(let Y=0;Y<N.length;Y++)if(B===h.gy.mean){const Z=V.values[Y];Z!=null&&(k++,X+=Z,Y>K-1&&(X-=V.values[Y-K],k--)),H.push(k===0?0:X/k)}else if(B===h.gy.variance){const Z=Math.max(0,Y-K+1),se=Y+1;H.push(T(V.values.slice(Z,se)))}else if(B===h.gy.stdDev){const Z=Math.max(0,Y-K+1),se=Y+1;H.push(b(V.values.slice(Z,se)))}return H}function I(N,B,V,K){const H=[];let X=0,k=0;const Y=Math.ceil(K/2)-1,Z=Math.floor(K/2);for(let se=0;se<N.length;se++){const j=se-Z,q=se+Y;if(B===h.gy.mean){if(se===0)for(let ne=0;ne<Y+1&&ne<V.values.length;ne++)V.values[ne]!=null&&(X+=V.values[ne],k++);else q<V.values.length&&V.values[q]!=null&&(X+=V.values[q],k++),j>0&&V.values[j-1]!=null&&(X-=V.values[j-1],k--);H.push(k===0?0:X/k)}else if(B===h.gy.variance){const ne=V.values.slice(Math.max(0,j),Math.min(q+1,V.values.length));H.push(T(ne))}else if(B===h.gy.stdDev){const ne=V.values.slice(Math.max(0,j),Math.min(q+1,V.values.length));H.push(b(ne))}}return H}function T(N){if(N.length<1)return 0;let B=0,V=0,K=0;for(let X=0;X<N.length;X++){const k=N[X];if(k!=null){K++;let Y=V;V+=(k-Y)/K,B+=(k-Y)*(k-V)}}return K===0?0:B/K}function b(N){return Math.sqrt(T(N))}function R(N,B){let V=(0,g.NS)({id:l.Ct.numeric});if(N.field&&(V=(0,g.NS)({id:l.Ct.byNames,options:{names:[N.field]}})),![h.gy.mean,h.gy.sum].includes(N.reducer))throw new Error(`Add field from calculation transformation - Unsupported reducer: ${N.reducer}`);return K=>{let H=null;for(const Y of K.fields)if(V(Y,K,B)){H=Y;break}if(!H)return;const X=[];let k=0;for(let Y=0;Y<K.length;Y++)k+=H.values[Y]??0,N.reducer===h.gy.sum?X.push(k):N.reducer===h.gy.mean&&X.push(k/(Y+1));return X}}function A(N,B){let V=(0,g.NS)({id:l.Ct.numeric});N.include&&N.include.length&&(V=(0,g.NS)({id:l.Ct.byNames,options:{names:N.include}}));const K=h.AS.get(N.reducer);if(!K)throw new Error(`Unknown reducer: ${N.reducer}`);const H=K.reduce??h.H3,X=N.nullValueMode===f.UW.Ignore,k=N.nullValueMode===f.UW.AsZero;return Y=>{const Z=[];for(const ne of Y.fields)V(ne,Y,B)&&Z.push(ne.values);const se=Z.length,j={name:"temp",values:new Array(se),type:a.PU.number,config:{}},q=[];for(let ne=0;ne<Y.length;ne++){for(let oe=0;oe<se;oe++)j.values[oe]=Z[oe][ne];q.push(H(j,X,k)[N.reducer])}return q}}function L(N,B,V){if(!B)return;for(const H of N.fields)if(B===(0,r.Ct)(H,N,V))return H.type===a.PU.boolean?H.values.map(X=>X?1:0):H.values;const K=parseFloat(B);if(!isNaN(K))return new Array(N.length).fill(K)}function U(N,B){const V=c.b.getIfExists(N.operator);return K=>{const H=L(K,N.left,B),X=L(K,N.right,B);if(!H||!X||!V)return;const k=new Array(H.length);for(let Y=0;Y<k.length;Y++)k[Y]=V.operation(H[Y],X[Y]);return k}}function W(N,B){const V=o.j.getIfExists(N.operator);return K=>{let H=[];for(const k of K.fields)N.fieldName===(0,r.Ct)(k,K,B)&&k.type===a.PU.number&&(H=k.values);if(!H.length||!V)return;const X=new Array(H.length);for(let k=0;k<X.length;k++)X[k]=V.operation(H[k]);return X}}function w(N){if(N.alias?.length)return N.alias;switch(N.mode){case"cumulativeFunctions":{const{cumulative:B}=N;return`cumulative ${B?.reducer??""}${B?.field?`(${B.field})`:""}`}case"windowFunctions":{const{window:B}=N;return`${B?.windowAlignment??""} moving ${B?.reducer??""}${B?.field?`(${B.field})`:""}`}case"unary":{const{unary:B}=N;return`${B?.operator??""}${B?.fieldName?`(${B.fieldName})`:""}`}case"binary":{const{binary:B}=N;return`${B?.left??""} ${B?.operator??""} ${B?.right??""}`.replace(/\$/g,"")}case"reduceRow":{const B=h.AS.getIfExists(N.reduce?.reducer);if(B)return B.name}break;case"index":return"Row"}return"math"}},82150:(G,O,e)=>{"use strict";e.d(O,{vz:()=>r,x1:()=>s});var t=e(81160),n=e(11261),i=e(18282),s=(a=>(a.Drop="drop",a.FieldName="field",a.Label="label",a))(s||{});const r={id:i.F.concatenate,name:"Concatenate fields",description:"Combine all fields into a single frame.  Values will be appended with undefined values if not the same length.",defaultOptions:{frameNameMode:"field",frameNameLabel:"frame"},operator:a=>c=>c.pipe((0,t.T)(o=>!Array.isArray(o)||o.length<2?o:[f(o,a)]))};function f(a,c){let o=!0,h=a[0].length;const g=c.frameNameLabel??"frame";let l=[];for(const p of a){h!==p.length&&(o=!1,h=Math.max(h,p.length));for(const m of p.fields){const y={...m};y.state=void 0,p.name&&(c.frameNameMode==="drop"||(c.frameNameMode==="label"?(y.labels={...m.labels},y.labels[g]=p.name):!y.name||y.name===n.Bc?y.name=p.name:y.name=`${p.name} \xB7 ${m.name}`)),l.push(y)}}return o||(l=l.map(p=>{if(p.values.length===h)return p;const m=p.values.slice();return m.length=h,{...p,values:m}})),{fields:l,length:h}}},50311:(G,O,e)=>{"use strict";e.d(O,{Xv:()=>m,ks:()=>d,s7:()=>o,zM:()=>a});var t=e(81160),n=e(53531),i=e(11261),s=e(85200),r=e(1173),f=e(18282);const a={id:f.F.convertFieldType,name:"Convert field type",description:"Convert a field to a specified field type.",defaultOptions:{fields:{},conversions:[{targetField:void 0,destinationType:void 0,dateFormat:void 0,timezone:void 0}]},operator:(u,D)=>P=>P.pipe((0,t.T)(x=>a.transformer(u,D)(x))),transformer:u=>D=>!Array.isArray(D)||D.length===0?D:c(u,D)??[]};function c(u,D){if(!u.conversions.length)return D;const P=D.map(x=>({...x}));for(const x of u.conversions){if(!x.targetField)continue;const E=s.sJ.get(r.Ct.byName).get(x.targetField);for(const C of P)C.fields=C.fields.map(M=>E(M,C,P)?o(M,x):M)}return P}function o(u,D){switch(D.destinationType){case i.PU.time:return d(u,D.dateFormat);case i.PU.number:return l(u);case i.PU.string:return m(u,D.dateFormat,{timeZone:D.timezone},D.joinWith);case i.PU.boolean:return p(u);case i.PU.enum:return v(u,D.enumConfig);case i.PU.other:return y(u);default:return u}}const h=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d{3,})?(?:Z|[-+]\d{2}:?\d{2})$/;function g(u,D){let P=D?{format:D}:void 0;const x=u.values.slice();let E=x.find(M=>M!=null),C=typeof E=="string"&&h.test(E);for(let M=0;M<x.length;M++)if(x[M]){let S=C?Date.parse(x[M]):(0,n.b)(x[M],P).valueOf();x[M]=Number.isFinite(S)?S:null}else x[M]=null;return{...u,type:i.PU.time,values:x}}function l(u){const D=u.values.slice(),P=D.some(x=>typeof x=="string");for(let x=0;x<D.length;x++){let E=D[x];P&&E!=null&&typeof E=="string"&&(E=E.replace(/,/g,""));const C=+E;D[x]=Number.isFinite(C)?C:null}return{...u,type:i.PU.number,values:D}}function p(u){const D=u.values.slice();for(let P=0;P<D.length;P++)D[P]=!!D[P];return{...u,type:i.PU.boolean,values:D}}function m(u,D,P,x){let E=u.values;switch(u.type){case i.PU.time:E=E.map(C=>(0,n.b)(C,P).format(D));break;case i.PU.other:E=E.map(C=>x?.length&&Array.isArray(C)?C.join(x):JSON.stringify(C));break;default:E=E.map(C=>`${C}`)}return{...u,type:i.PU.string,values:E}}function y(u){const D=u.values.slice();for(let P=0;P<D.length;P++)try{D[P]=JSON.parse(D[P])}catch{D[P]=null}return{...u,type:i.PU.other,values:D}}function d(u,D){const P=typeof u.values[0]=="number";return u.type===i.PU.time&&P?u:P?{...u,type:i.PU.time}:g(u,D)}function v(u,D){const P={...D},x=u.values.slice(),E=new Map;if(P.text&&P.text.length>0)for(let C=0;C<P.text.length;C++)E.set(P.text[C],C);else return u;for(let C=0;C<x.length;C++){const M=x[C];x[C]=E.get(M)}return{...u,config:{...u.config,type:{enum:P}},type:i.PU.enum,values:x}}},34125:(G,O,e)=>{"use strict";e.d(O,{b:()=>r});var t=e(81160),n=e(14236),i=e(18282),s=e(41511);const r={id:i.F.ensureColumns,name:"Ensure Columns Transformer",description:"Will check if current data frames is series or columns. If in series it will convert to columns.",operator:(a,c)=>o=>o.pipe((0,t.T)(h=>r.transformer(a,c)(h))),transformer:(a,c)=>o=>{const h=f(o);return o.length>1&&h?s.L.transformer({byField:h},c)(o):o}};function f(a){let c;for(const o of a){const{timeField:h}=(0,n.KR)(o);if(!h)return;if(!c)c=h.name;else if(c!==h.name)return}return c}},64224:(G,O,e)=>{"use strict";e.d(O,{I:()=>f,z:()=>r});var t=e(81160),n=e(85200),i=e(18282),s=e(64586);const r={id:i.F.filterFields,name:"Filter Fields",description:"select a subset of fields",defaultOptions:{},operator:(a,c)=>o=>!a.include&&!a.exclude?o.pipe(s.W.operator({},c)):(typeof a.include?.options=="string"?a.include.options=c.interpolate(a.include?.options):typeof a.include?.options?.pattern=="string"&&(a.include.options.pattern=c.interpolate(a.include?.options.pattern)),typeof a.exclude?.options=="string"?a.exclude.options=c.interpolate(a.exclude?.options):typeof a.exclude?.options?.pattern=="string"&&(a.exclude.options.pattern=c.interpolate(a.exclude?.options.pattern)),o.pipe((0,t.T)(h=>{const g=a.include?(0,n.NS)(a.include):null,l=a.exclude?(0,n.NS)(a.exclude):null,p=[];for(const m of h){const y=[];for(let v=0;v<m.fields.length;v++){const u=m.fields[v];if(l){if(l(u,m,h))continue;g||y.push(u)}g&&g(u,m,h)&&y.push(u)}if(!y.length)continue;const d={...m,fields:y};p.push(d)}return p})))},f={id:i.F.filterFrames,name:"Filter Frames",description:"select a subset of frames",defaultOptions:{},operator:(a,c)=>o=>!a.include&&!a.exclude?o.pipe(s.W.operator({},c)):o.pipe((0,t.T)(h=>{const g=a.include?(0,n.Dq)(a.include):null,l=a.exclude?(0,n.Dq)(a.exclude):null,p=[];for(const m of h){if(l){if(l(m))continue;g||p.push(m)}g&&g(m)&&p.push(m)}return p}))}},35602:(G,O,e)=>{"use strict";e.d(O,{D:()=>s,R:()=>r});var t=e(1173),n=e(64224),i=e(18282);const s={id:i.F.filterFieldsByName,name:"Filter fields by name",description:"select a subset of fields",defaultOptions:{},operator:(f,a)=>c=>c.pipe(n.z.operator({include:r(a,f.include,f.byVariable),exclude:r(a,f.exclude,f.byVariable)},a))},r=(f,a,c)=>{if(!a)return;const{names:o,pattern:h,variable:g}=a;if(c&&g){const l=f.interpolate(g);if(/\{.*\}/.test(l)){const p=l.slice(1).slice(0,-1).split(",");return{id:t.Ct.byNames,options:{names:p}}}return{id:t.Ct.byNames,options:{names:l.split(",")}}}if(!((!Array.isArray(o)||o.length===0)&&!h))return h?!Array.isArray(o)||o.length===0?{id:t.Ct.byRegexp,options:h}:{id:t.Ct.byRegexpOrNames,options:a}:{id:t.Ct.byNames,options:{names:o}}}},73376:(G,O,e)=>{"use strict";e.d(O,{Sm:()=>o,Sv:()=>h,j4:()=>c});var t=e(81160),n=e(28240),i=e(85200),s=e(1173),r=e(18282),f=e(64586),a=e(67641),c=(p=>(p.exclude="exclude",p.include="include",p))(c||{}),o=(p=>(p.all="all",p.any="any",p))(o||{});const h={id:r.F.filterByValue,name:"Filter data by values",description:"select a subset of results based on values",defaultOptions:{filters:[],type:"include",match:"any"},operator:(p,m)=>y=>{const d=p.filters,v=p.match==="all",u=p.type==="include";if(!Array.isArray(d)||d.length===0)return y.pipe(f.W.operator({},m));const D=[];return(0,a.w)()&&D.push(...d.map(P=>{if(P.config.id===s.Js.between){let x=P.config.options.from,E=P.config.options.to;return typeof P.config.options.from=="string"&&(x=m.interpolate(x)),typeof P.config.options.to=="string"&&(E=m.interpolate(E)),{...P,config:{...P.config,options:{...P.config.options,to:E,from:x}}}}else{if(P.config.id===s.Js.regex)return P;if(P.config.options.value){let x=P.config.options.value;return typeof P.config.options.value=="string"&&(x=m.interpolate(x)),{...P,config:{...P.config,options:{...P.config.options,value:x}}}}}return P})),y.pipe((0,t.T)(P=>{if(P.length===0)return P;const x=[];for(const E of P){const C=new Set,M=l(E,P);let S;(0,a.w)()?S=g(D,M):S=g(d,M);for(let b=0;b<E.length;b++){if(C.has(b))continue;let R=!0;for(const A of S){const L=A(b,E,P);if(!v&&L){R=!0;break}if(v&&!L){R=!1;break}R=L}R&&C.add(b)}const I=[],T=u?C.size:P[0].length-C.size;for(const b of E.fields){const R=[];for(let A=0;A<E.length;A++){if(u&&C.has(A)){R.push(b.values[A]);continue}if(!u&&!C.has(A)){R.push(b.values[A]);continue}}I.push({...b,values:R,state:{}})}x.push({...E,fields:I,length:T})}return x}))}},g=(p,m)=>{const y=()=>!1;return p.map(d=>{const v=m[d.fieldName]??-1;if(v<0)return console.warn(`[FilterByValue] Could not find index for field name: ${d.fieldName}`),y;const u=(0,i.kK)(d.config);return(D,P,x)=>u(D,P.fields[v],P,x)})},l=(p,m)=>{const y={};return p.fields.forEach((d,v)=>{const u=(0,n.Ct)(d,p,m);y[u]=v}),y}},15400:(G,O,e)=>{"use strict";e.d(O,{gs:()=>a,yt:()=>h});var t=e(81160),n=e(11261),i=e(81010),s=e(85200),r=e(1173),f=e(18282),a=(l=>(l.UpperCase="Upper Case",l.LowerCase="Lower Case",l.SentenceCase="Sentence Case",l.TitleCase="Title Case",l.PascalCase="Pascal Case",l.CamelCase="Camel Case",l.SnakeCase="Snake Case",l.KebabCase="Kebab Case",l.Trim="Trim",l.Substring="Substring",l))(a||{});const c=l=>{const p=l.split(" ");for(let m=0;m<p.length;m++)p[m]=p[m].charAt(0).toUpperCase()+p[m].slice(1).toLowerCase();return p},o=l=>p=>p.values.map(m=>{switch(l.outputFormat){case"Upper Case":return m.toUpperCase();case"Lower Case":return m.toLowerCase();case"Sentence Case":return m.charAt(0).toUpperCase()+m.slice(1);case"Title Case":return c(m).join(" ");case"Pascal Case":return c(m).join("");case"Camel Case":return m=c(m).join(""),m.charAt(0).toLowerCase()+m.slice(1);case"Snake Case":return m.toLowerCase().split(" ").join("_");case"Kebab Case":return m.toLowerCase().split(" ").join("-");case"Trim":return m.trim();case"Substring":return m.substring(l.substringStart,l.substringEnd)}}),h={id:f.F.formatString,name:"Format string",description:"Manipulate string fields formatting",defaultOptions:{stringField:"",outputFormat:"Upper Case"},isApplicable:l=>{for(const p of l)for(const m of p.fields)if(m.type==="string")return i.M.Applicable;return i.M.NotApplicable},operator:l=>p=>p.pipe((0,t.T)(m=>{if(m.length===0)return m;const y=s.sJ.get(r.Ct.byName).get(l.stringField),d=o(l),v=g(y,d);return m.map(u=>({...u,fields:v(u,m)}))}))},g=(l,p)=>(m,y)=>m.fields.map(d=>{if(l(d,m,y)){const v=p(d);return{...d,type:n.PU.string,values:v}}return d})},25094:(G,O,e)=>{"use strict";e.d(O,{Ce:()=>d,R3:()=>h,Y2:()=>y,of:()=>g});var t=e(81160),n=e(14236),i=e(28240),s=e(11261),r=e(81010),f=e(75059),a=e(18282),c=e(67641);const o=2;var h=(v=>(v.aggregate="aggregate",v.groupBy="groupby",v))(h||{});const g={id:a.F.groupBy,name:"Group by",description:"Group the data by a field values then process calculations for each group.",defaultOptions:{fields:{}},isApplicable:v=>(0,c.f)(v)>=o?r.M.Applicable:r.M.NotApplicable,isApplicableDescription:v=>{const u=(0,c.f)(v);return`The Group by transformation requires a series with at least ${o} fields to work. The maximum number of fields found on a series is ${u}`},operator:v=>u=>u.pipe((0,t.T)(D=>{if(!Object.keys(v.fields).find(E=>v.fields[E].operation==="groupby"))return D;const x=[];for(const E of D){const C=E.fields.filter(I=>l(I,v));if(C.length===0)continue;const M=y(E,C),S=d(C,M);for(const I of E.fields){if(!p(I,v))continue;const T=(0,i.Ct)(I),b=v.fields[T].aggregations,R={};M.forEach(A=>{const L=A[T],U=(0,f.Nw)({field:L,reducers:b});for(const W of b)Array.isArray(R[W])||(R[W]=[]),R[W].push(U[W])});for(const A of b){const L={name:`${T} (${A})`,values:R[A]??[],type:s.PU.other,config:{}};L.type=m(A,I,L),S.push(L)}}x.push({fields:S,length:M.size})}return x}))},l=(v,u)=>{const D=(0,i.Ct)(v);return u?.fields[D]?.operation==="groupby"},p=(v,u)=>{const D=(0,i.Ct)(v);return u?.fields[D]?.operation==="aggregate"&&Array.isArray(u?.fields[D].aggregations)&&u?.fields[D].aggregations.length>0};function m(v,u,D){switch(v){case f.gy.allIsNull:return s.PU.boolean;case f.gy.last:case f.gy.lastNotNull:case f.gy.first:case f.gy.firstNotNull:return u.type;default:return(0,n.dF)(D)??s.PU.string}}function y(v,u){const D=new Map;for(let P=0;P<v.length;P++){const x=String(u.map(C=>C.values[P])),E=D.get(x)??{};D.has(x)||D.set(x,E);for(let C of v.fields){const M=(0,i.Ct)(C);E[M]||(E[M]={name:M,type:C.type,config:{...C.config},values:[]}),E[M].values.push(C.values[P])}}return D}function d(v,u){const D=[];for(const P of v){const x=[],E=(0,i.Ct)(P);u.forEach(C=>{x.push(C[E].values[0])}),D.push({name:P.name,type:P.type,config:{...P.config},values:x})}return D}},68133:(G,O,e)=>{"use strict";e.d(O,{_:()=>p,l:()=>h});var t=e(81160),n=e(14236),i=e(28240),s=e(11261),r=e(81010),f=e(75059),a=e(25094),c=e(18282),o=e(67641);const h=!0,g=2;var l=(D=>(D.aggregate="aggregate",D.groupBy="groupby",D))(l||{});const p={id:c.F.groupToNestedTable,name:"Group to nested tables",description:"Group data by a field value and create nested tables with the grouped data",defaultOptions:{showSubframeHeaders:h,fields:{}},isApplicable:D=>(0,o.f)(D)>=g?r.M.Applicable:r.M.NotApplicable,isApplicableDescription:D=>{const P=(0,o.f)(D);return`The Group to nested table transformation requires a series with at least ${g} fields to work. The maximum number of fields found on a series is ${P}`},operator:D=>P=>P.pipe((0,t.T)(x=>{if(!Object.keys(D.fields).find(M=>D.fields[M].operation==="groupby"))return x;const C=[];for(const M of x){const S=M.fields.filter(R=>y(R,D));if(S.length===0)continue;const I=(0,a.Y2)(M,S),T=(0,a.Ce)(S,I),b=u(I,D);for(let R=0;R<M.fields.length;R++){const A=M.fields[R];if(!d(A,D))continue;const L=(0,i.Ct)(A),U=D.fields[L].aggregations,W={};I.forEach(w=>{const N=w[L],B=(0,f.Nw)({field:N,reducers:U});for(const V of U)Array.isArray(W[V])||(W[V]=[]),W[V].push(B[V])});for(const w of U){const N={name:`${L} (${w})`,values:W[w],type:s.PU.other,config:{}};N.type=v(w,A,N),T.push(N)}}T.push({config:{},name:"Nested frames",type:s.PU.nestedFrames,values:b}),C.push({fields:T,length:I.size})}return C}))};function m(D,P,x){return{meta:{custom:{noHeader:!(x.showSubframeHeaders===void 0?h:x.showSubframeHeaders)}},length:P,fields:D}}const y=(D,P)=>{const x=(0,i.Ct)(D);return P?.fields[x]?.operation==="groupby"},d=(D,P)=>{const x=(0,i.Ct)(D);return P?.fields[x]?.operation==="aggregate"&&Array.isArray(P?.fields[x].aggregations)&&P?.fields[x].aggregations.length>0},v=(D,P,x)=>{switch(D){case f.gy.allIsNull:return s.PU.boolean;case f.gy.last:case f.gy.lastNotNull:case f.gy.first:case f.gy.firstNotNull:return P.type;default:return(0,n.dF)(x)??s.PU.string}};function u(D,P){const x=[];for(const[,E]of D){const C=[];for(const[M,S]of Object.entries(E)){const I=P.fields[M];(I===void 0||I.aggregations===void 0||I.operation==="aggregate"&&I.aggregations.length===0||I.operation===null||I.operation===void 0)&&C.push(S)}C.length>0?x.push([m(C,C[0].values.length,P)]):x.push([m([],0,P)])}return x}},77678:(G,O,e)=>{"use strict";e.d(O,{H1:()=>P,NX:()=>u,OA:()=>d,Rt:()=>y,Uh:()=>M,ZU:()=>C,cg:()=>T,d$:()=>v,dA:()=>D,ix:()=>x,p3:()=>E,rW:()=>g,rs:()=>S});var t=e(81160),n=e(57875),i=e(75972),s=e(11261),r=e(41260),f=e(97706),a=e(18282),c=e(73060),o=e(39624),h=e(67641);const g=[1e-9,2e-9,25e-10,4e-9,5e-9,1e-8,2e-8,25e-9,4e-8,5e-8,1e-7,2e-7,25e-8,4e-7,5e-7,1e-6,2e-6,25e-7,4e-6,5e-6,1e-5,2e-5,25e-6,4e-5,5e-5,1e-4,2e-4,25e-5,4e-4,5e-4,.001,.002,.0025,.004,.005,.01,.02,.025,.04,.05,.1,.2,.25,.4,.5,1,2,4,5,10,20,25,40,50,100,200,250,400,500,1e3,2e3,2500,4e3,5e3,1e4,2e4,25e3,4e4,5e4,1e5,2e5,25e4,4e5,5e5,1e6,2e6,25e5,4e6,5e6,1e7,2e7,25e6,4e7,5e7,1e8,2e8,25e7,4e8,5e8,1e9,2e9,25e8,4e9,5e9],l=30,p=[],m=(b,R)=>b-R,y={bucketCount:{name:"Bucket count",description:"approx bucket count"},bucketSize:{name:"Bucket size",description:void 0},bucketOffset:{name:"Bucket offset",description:"for non-zero-based buckets"},combine:{name:"Combine series",description:"combine all series into a single histogram"}},d={id:a.F.histogram,name:"Histogram",description:"Calculate a histogram from input data.",defaultOptions:{fields:{}},operator:(b,R)=>A=>A.pipe((0,t.T)(L=>d.transformer(b,R)(L))),transformer:(b,R)=>A=>{if(!Array.isArray(A)||A.length===0)return A;let L,U;b.bucketSize&&((0,h.w)()&&(b.bucketSize=R.interpolate(b.bucketSize.toString())),typeof b.bucketSize=="string"?L=parseFloat(b.bucketSize):L=b.bucketSize,isNaN(L)&&(L=void 0)),b.bucketOffset&&((0,h.w)()&&(b.bucketOffset=R.interpolate(b.bucketOffset.toString())),typeof b.bucketOffset=="string"?U=parseFloat(b.bucketOffset):U=b.bucketOffset,isNaN(U)&&(U=void 0));const W={bucketSize:L,bucketOffset:U,combine:b.combine},w=E(A,W);return w==null?[]:[T(w)]}},v="xMin";function u(b){return b===v||b==="BucketMin"}const D="xMax";function P(b){return b===D||b==="BucketMax"}function x(b){if(b.meta?.type===r.m.HeatmapCells){let U=b.fields.find(H=>H.name==="yMin"),W=b.fields.find(H=>H.name==="yMax"),w=b.fields.find(H=>H.name==="count"),N=[...new Set(W.values)].sort((H,X)=>H-X),B=[...new Set(U.values)].sort((H,X)=>H-X),V=new Map;N.forEach(H=>V.set(H,0));for(let H=0;H<W.values.length;H++){let X=W.values[H];V.set(X,V.get(X)+w.values[H])}return{xMin:{...U,name:"xMin",values:B},xMax:{...W,name:"xMax",values:N},counts:[{...w,values:[...V.values()]}]}}else if(b.meta?.type===r.m.HeatmapRows){let U=[],W=[],w=[],N="0";return b.fields.forEach(V=>{if(V.type===s.PU.number){let K=V.values.reduce((H,X)=>H+X,0);w.push(K),U.push(N),W.push(N=V.name)}}),w.push(0),U.push(N),W.push(N),{xMin:{...b.fields[1],name:"xMin",type:s.PU.string,values:U},xMax:{...b.fields[1],name:"xMax",type:s.PU.string,values:W},counts:[{...b.fields[1],name:"count",type:s.PU.number,values:w}]}}let R,A;const L=[];for(const U of b.fields)u(U.name)?R=U:P(U.name)?A=U:U.type===s.PU.number&&L.push(U);if(!A&&R&&R.values.length>1){let U=R.values,W=(0,f.h)(U[1]-U[0],6);A={...R,name:D,values:U.map(w=>w+W)}}if(!R&&A&&A?.values.length>1){let U=A.values,W=(0,f.h)(U[1]-U[0],6);R={...A,name:v,values:U.map(w=>w-W)}}if(R&&A&&L.length)return{xMin:R,xMax:A,counts:L}}function E(b,R){let A=R?.bucketSize,L=R?.bucketCount??l,U=R?.bucketOffset??0;if(b=b.map(k=>({...k,fields:k.fields.map(Y=>{if(Y.type===s.PU.number){const Z=Number(Y.config.noValue);Number.isNaN(Z)?Y={...Y,values:Y.values.filter(se=>se!=null)}:Y=(0,o.A)(Y,Z)}return Y})})),!A||A<0){let k=[];for(const ne of b)for(const oe of ne.fields)oe.type===s.PU.number&&(k=k.concat(oe.values));k.sort((ne,oe)=>ne-oe);let Y=1/0;if(k.length===1)Y=1;else for(let ne=1;ne<k.length;ne++){let oe=k[ne]-k[ne-1];oe!==0&&(Y=Math.min(Y,oe))}let Z=k[0];const q=(k[k.length-1]-Z)/L;for(let ne=0;ne<g.length;ne++){let oe=g[ne];if(q<oe&&oe>=Y){A=oe;break}}}const W=k=>(0,f.h)(S(k-U,A)+U,9);let w=((""+A).match(/\.\d+$/)??["."])[0].length-1,N=[],B=[],V;for(const k of b)for(const Y of k.fields)if(Y.type===s.PU.number){let Z=I(Y.values,W,p,m);N.push(Z),B.push({...Y,config:{...Y.config,unit:Y.config.unit==="short"?"short":void 0}}),!V&&Y.config.unit&&(V=Y.config)}if(!B.length)return null;let K=(0,c.fj)(N);for(let k=1;k<K.length;k++){let Y=K[k];for(let Z=0;Z<Y.length;Z++)Y[Z]==null&&(Y[Z]=0)}const H={name:v,values:K[0],type:s.PU.number,state:void 0,config:w===0?V??{}:{...V,decimals:w}},X={...H,name:D,values:K[0].map(k=>k+A)};if(R?.combine){const k=new Array(K[0].length).fill(0);for(let Y=1;Y<K.length;Y++)for(let Z=0;Z<k.length;Z++)k[Z]+=K[Y][Z];B=[{...B[0],name:"count",values:k,type:s.PU.number,state:{...B[0].state,displayName:"Count",multipleFrames:!1,origin:{frameIndex:0,fieldIndex:2}}}]}else B.forEach((k,Y)=>{k.values=K[Y+1]});return{xMin:H,xMax:X,counts:B}}function C(b,R){return Math.round(b/R)*R}function M(b,R){return Math.ceil(b/R)*R}function S(b,R){return Math.floor(b/R)*R}function I(b,R,A,L){let U=new Map;for(let B=0;B<b.length;B++){let V=b[B];V!=null&&(V=R(V));let K=U.get(V);K?K.count++:U.set(V,{value:V,count:1})}A&&A.forEach(B=>U.delete(B));let W=[...U.values()];L&&W.sort((B,V)=>L(B.value,V.value));let w=Array(W.length),N=Array(W.length);for(let B=0;B<W.length;B++)w[B]=W[B].value,N[B]=W[B].count;return[w,N]}function T(b,R){if(!b.xMin.display){const A=(0,n.J)({field:b.xMin,theme:R??(0,i.a)()});b.xMin.display=A,b.xMax.display=A}return b.counts[0].display=(0,n.J)({field:b.counts[0],theme:R??(0,i.a)()}),{length:b.xMin.values.length,meta:{type:r.m.Histogram},fields:[b.xMin,b.xMax,...b.counts]}}},41511:(G,O,e)=>{"use strict";e.d(O,{L:()=>a,W:()=>f});var t=e(81160),n=e(85200),i=e(1173),s=e(18282),r=e(73060),f=(c=>(c.outer="outer",c.inner="inner",c.outerTabular="outerTabular",c))(f||{});const a={id:s.F.joinByField,aliasIds:[s.F.seriesToColumns],name:"Join by field",description:"Combine rows from two or more tables, based on a related field between them.  This can be used to outer join multiple time series on the _time_ field to show many time series in one table.",defaultOptions:{byField:void 0,mode:"outer"},operator:(c,o)=>h=>h.pipe((0,t.T)(g=>a.transformer(c,o)(g))),transformer:(c,o)=>{let h;return g=>{if(g.length>1){c.byField&&!h&&(h=n.sJ.get(i.Ct.byName).get(o.interpolate(c.byField)));const l=(0,r.Fd)({frames:g,joinBy:h,mode:c.mode});if(l)return[l]}return g}}}},73060:(G,O,e)=>{"use strict";e.d(O,{Fd:()=>o,JI:()=>m,RC:()=>l,WO:()=>p,Yj:()=>c,fj:()=>d,g2:()=>v});var t=e(14236),n=e(11261),i=e(85200),s=e(1173),r=e(41511);function f(u){const{timeField:D}=(0,t.KR)(u[0]);if(D)return i.sJ.get(s.Ct.firstTimeField).get({});let P=[];for(const x of u[0].fields)x.type===n.PU.number&&P.push(x.name);for(let x=1;x<u.length;x++){const E=[];for(const C of u[0].fields)C.type===n.PU.number&&E.push(C.name);P=P.filter(C=>!E.includes(C))}return i.sJ.get(s.Ct.byName).get(P[0])}function a(u){return u.joinBy??f(u.frames)}function c(u,D){if(D>=0){let P=u.fields[D];P.type!==n.PU.string&&!v(P.values)&&(u=(0,t.ES)(u,D))}return u}function o(u){if(!u.frames?.length)return;const D=u.nullMode??(T=>{let b=T.config.custom?.spanNulls;return b===!0?l:b===-1?p:m});if(u.frames.length===1){let T=u.frames[0],b=T;const R=a(u);let A=b.fields.findIndex(L=>R(L,b,u.frames));if(u.keepOriginIndices&&(b={...T,fields:T.fields.map((L,U)=>{const W={...L},w={frameIndex:0,fieldIndex:U};return W.state?W.state.origin=w:W.state={origin:w},W})},A>0)){const L=b.fields[A],U=b.fields.filter((W,w)=>w!==A);U.unshift(L),b.fields=U,A=0}if(A>=0&&(b=c(b,A)),u.keep){let L=b.fields.filter((U,W)=>W===A||u.keep(U,b,u.frames));T!==b?b.fields=L:b={...T,fields:L}}return b}const P=[],x=[],E=[],C=[];let M=1;const S=a(u);for(let T=0;T<u.frames.length;T++){const b=u.frames[T];if(!b||!b.fields?.length)continue;const R=[l];let A,L=[],U=[];for(let w=0;w<b.fields.length;w++){const N=b.fields[w];if(N.state=N.state||{},!A&&S(N,b,u.frames))A=N;else{if(u.keep&&!u.keep(N,b,u.frames))continue;R.push(D(N));let B=N.labels??{},V=N.name;b.name&&(N.name===n.Bc?V=b.name:B.name==null&&(B={...B,name:b.name})),L.push({...N,name:V,labels:B})}u.keepOriginIndices&&(N.state.origin={frameIndex:T,fieldIndex:w})}if(!A)continue;E.length===0&&E.push(A),P.push(R);const W=[A.values];for(const w of L)W.push(w.values),E.push(w),u.keepDisplayNames||delete w.state?.displayName,U.push(M),M++;C.push(U),x.push(W)}let I=[];return u.mode===r.W.outerTabular?I=h(x,C,E.length,P):u.mode===r.W.inner?I=g(x):I=d(x,P,u.mode),{length:I[0]?I[0].length:0,fields:E.map((T,b)=>({...T,values:I[b]}))}}function h(u,D,P,x){let E={};for(let M=0;M<u.length;M++){let S=u[M],I=S[0];for(let T=0;T<u.length;T++){if(T===M)continue;let b=u[T],R=b[0];for(let A=0;A<I.length;A++){const L=I[A],U=P-1;let W=[L].concat(new Array(U)),w=0;for(let N=1;N<S.length;N++){const B=D[M][w];W[B]=S[N][A],w++}for(let N=0;N<R.length;N++)if(I[A]===R[N]){let B=0;for(let V=1;V<b.length;V++){const K=D[T][B];W[K]=b[V][N],B++}break}E[JSON.stringify(W)]=W}}}let C=[];for(let M=0;M<P;M++)C.push(new Array(0));for(let M in E){const S=E[M];for(let I=0;I<S.length;I++)C[I].push(S[I])}return C}function g(u){const D=[],P=(x,E,C)=>{if(E===x.length){D.push(C);return}const M=x[E],[S,...I]=M;for(let T=0;T<S.length;T++){const b=S[T];if(E===0||C.includes(b)){const R=[...C];E===0&&R.push(b);for(let A=0;A<I.length;A++)R.push(I[A][T]);P(x,E+1,R)}}};return P(u,0,[]),D.length===0?[]:D[0].map((x,E)=>D.map(C=>C[E]))}const l=0,p=1,m=2;function y(u,D,P){for(let x=0,E,C=-1;x<D.length;x++){let M=D[x];if(M>C){for(E=M-1;E>=0&&u[E]==null;)u[E--]=null;for(E=M+1;E<P&&u[E]==null;)u[C=E++]=null}}}function d(u,D,P=r.W.outer){let x=new Set;for(let S=0;S<u.length;S++){let T=u[S][0],b=T.length;for(let R=0;R<b;R++)x.add(T[R])}let E=[Array.from(x).sort((S,I)=>S-I)],C=E[0].length,M=new Map;for(let S=0;S<C;S++)M.set(E[0][S],S);for(let S=0;S<u.length;S++){let I=u[S],T=I[0];for(let b=1;b<I.length;b++){let R=I[b],A=Array(C).fill(void 0),L=D?D[S][b]:p,U=[];for(let W=0;W<R.length;W++){let w=R[W],N=M.get(T[W]);w===null?L!==l&&(A[N]=w,L===m&&U.push(N)):A[N]=w}y(A,U,C),E.push(A)}}return E}function v(u,D=50){const P=u.length;if(P<=1)return!0;let x=0,E=P-1;for(;x<=E&&u[x]==null;)x++;for(;E>=x&&u[E]==null;)E--;if(E<=x)return!0;const C=Math.max(1,Math.floor((E-x+1)/D));for(let M=u[x],S=x+C;S<=E;S+=C){const I=u[S];if(I!=null){if(I<=M)return!1;M=I}}return!0}},6829:(G,O,e)=>{"use strict";e.d(O,{V:()=>f,n:()=>r});var t=e(81160),n=e(28240),i=e(11261),s=e(18282),r=(c=>(c.Columns="columns",c.Rows="rows",c))(r||{});const f={id:s.F.labelsToFields,name:"Labels to fields",description:"Extract time series labels to fields (columns or rows)",defaultOptions:{},operator:(c,o)=>h=>h.pipe((0,t.T)(g=>f.transformer(c,o)(g))),transformer:c=>o=>{if(c.mode==="rows")return a(o,c.keepLabels);const h=[],g=c.keepLabels?.length?new Set(c.keepLabels):void 0;for(const l of o){const p=[],m={};for(const y of l.fields){if(!y.labels){p.push(y);continue}const d={...y,config:{...y.config,displayName:void 0,displayNameFromDS:void 0},labels:void 0};p.push(d);for(const v of Object.keys(y.labels)){if(g&&!g.has(v))continue;if(c.valueLabel===v){d.name=y.labels[v];continue}(m[v]??(m[v]=new Set)).add(y.labels[v])}}for(const y in m)for(const d of m[y]){const v=new Array(l.length).fill(d);p.push({name:y,type:i.PU.string,values:v,config:{}})}h.push({...l,fields:p,length:l.length})}return h}};function a(c,o){const h=[];for(const g of c)for(const l of g.fields)if(l.labels){const p=[],m=[];if(o)for(const y of o)p.push(y),m.push(l.labels[y]);else for(const[y,d]of Object.entries(l.labels))p.push(y),m.push(d);m.length&&h.push({...g,name:(0,n.Ct)(l,g,c),fields:[{name:"label",type:i.PU.string,config:{},values:p},{name:"value",type:i.PU.string,config:{},values:m}],length:m.length})}return h}},58140:(G,O,e)=>{"use strict";e.d(O,{o:()=>a});var t=e(2543),n=e.n(t),i=e(81160),s=e(37471),r=e(81010),f=e(18282);const a={id:f.F.merge,name:"Merge series/tables",description:"Merges multiple series/tables into a single serie/table",defaultOptions:{},isApplicable:m=>m.length>1?r.M.Applicable:r.M.NotApplicable,isApplicableDescription:m=>`The merge transformation requires at least 2 data series to work. There is currently ${m.length} data series.`,operator:m=>y=>y.pipe((0,i.T)(d=>{if(!Array.isArray(d)||d.length<=1)return d;const v=d.filter(I=>I.fields.length>0);if(v.length===0)return[d[0]];const u=new Set,D={},P=[],x=new s.k;for(let I=0;I<v.length;I++){const T=v[I];for(let b=0;b<T.fields.length;b++){const R=T.fields[b];u.has(R.name)||(x.addField(c(R)),u.add(R.name)),D[R.name]=D[R.name]||{},D[R.name][I]=b,v.length-1===I&&l(D,R,v)&&P.push(R.name)}}if(P.length===0)return d;const E={},C=[],M=o(v,D,P),S=h(v,u,D);for(let I=0;I<v.length;I++){const T=v[I];for(let b=0;b<T.length;b++){const R=M(I,b),A=S(I,b);if(!Array.isArray(E[R])){E[R]=[A],C.push(p(R,E));continue}let L=!1;E[R]=E[R].map(U=>g(U,A)?(L=!0,{...U,...A}):U),L||(E[R].push(A),C.push(p(R,E)))}}for(const I of C){const T=E[I.key][I.index];T&&x.add(T)}return[x]}))},c=m=>({...(0,t.omit)(m,["values","state","labels","config"]),values:[],config:{...(0,t.omit)(m.config,"displayName")}}),o=(m,y,d)=>{const v=d.reduce((u,D)=>Object.keys(y[D]).reduce((P,x)=>(P[x]=P[x]||[],P[x].push(y[D][x]),P),u),{});return(u,D)=>v[u].reduce((P,x)=>P+m[u].fields[x].values[D],"")},h=(m,y,d)=>(v,u)=>{const D={},P=Array.from(y);for(const x of P){const E=d[x];if(!E)continue;const C=E[v];if(typeof C!="number")continue;const M=m[v];if(!M||!M.fields)continue;const S=M.fields[C];!S||!S.values||(D[x]=S.values[u])}return D},g=(m,y)=>{let d=!0;for(const v in y)if(!(typeof m[v]>"u")&&m[v]!==null&&m[v]!==y[v]){d=!1;break}return d},l=(m,y,d)=>Object.keys(m[y.name]).length===d.length,p=(m,y)=>({key:m,index:y[m].length-1})},64586:(G,O,e)=>{"use strict";e.d(O,{W:()=>n});var t=e(18282);const n={id:t.F.noop,name:"noop",description:"No-operation transformer",defaultOptions:{},operator:i=>s=>s,transformer:i=>s=>s}},46294:(G,O,e)=>{"use strict";e.d(O,{M:()=>s});var t=e(11261);const n={threshold:(f,a,c)=>f+c,midpoint:(f,a,c)=>(f+a)/2,plusone:(f,a,c)=>f+1};function i(f,a){return f.fields.find(c=>a!=null?c.name===a:c.type===t.PU.time)}function s(f){if(f.frame.length===0)return f.frame;let a=!0,{frame:c,refFieldName:o,refFieldPseudoMax:h,refFieldPseudoMin:g,insertMode:l}=f;l||(l=n.threshold);const p=i(c,o);if(p==null)return c;p.state={...p.state,nullThresholdApplied:!0};const m=c.fields.map(d=>d.config.custom?.insertNulls||p.config.interval||null),y=new Set(m);if(y.delete(null),y.size===0)return c;if(y.size===1){const d=y.values().next().value;if(d<=0)return c;const v=p.values,u=c.fields.map(P=>P.values),D=r(v,u,d,g,h,l,a);return D===u?c:{...c,length:D[0].length,fields:c.fields.map((P,x)=>({...P,values:D[x]}))}}return c}function r(f,a,c,o=null,h=null,g,l){const p=f.length,m=[];if(o!=null&&o<f[0]){let u=Math.ceil((f[0]-o)/c),D=f[0]-u*c;for(;D<f[0];)m.push(g(D-c,D,c)),D+=c}m.push(f[0]);let y=f[0];for(let u=1;u<p;u++){const D=f[u];for(;D-y>c&&(m.push(g(y,D,c)),y+=c,!!l););m.push(D),y=D}if(h!=null&&h>y)for(;y+c<h;)m.push(g(y,h,c)),y+=c;const d=m.length;if(d===p)return a;const v=[];for(let u of a){let D;if(u!==f){D=Array(d);for(let P=0,x=0;P<d;P++)D[P]=f[x]===m[P]?u[x++]:null}else D=m;v.push(D)}return v}},39624:(G,O,e)=>{"use strict";e.d(O,{A:()=>n,C:()=>t});function t(i){return{...i,fields:i.fields.map(s=>{const r=Number(s.config.noValue);return Number.isNaN(r)?s:n(s,r)})}}function n(i,s){const r=i.values.slice();for(let f=0;f<r.length;f++)r[f]===null&&(r[f]=s);return{...i,values:r}}},82280:(G,O,e)=>{"use strict";e.d(O,{X:()=>a,x:()=>f});var t=e(2543),n=e.n(t),i=e(81160),s=e(28240),r=e(18282);const f={id:r.F.order,name:"Order fields by name",description:"Order fields based on configuration given by user",defaultOptions:{indexByName:{}},operator:h=>g=>g.pipe((0,i.T)(l=>{const p=c(h.indexByName);return!Array.isArray(l)||l.length===0?l:l.map(m=>({...m,fields:p(m.fields,l,m)}))}))},a=h=>(g,l)=>o(g,h)-o(l,h),c=h=>(g,l,p)=>{if(!Array.isArray(g)||g.length===0||!h||Object.keys(h).length===0)return g;const m=a(h);return(0,t.clone)(g).sort((y,d)=>m((0,s.Ct)(y,p,l),(0,s.Ct)(d,p,l)))},o=(h,g)=>Number.isInteger(g[h])?g[h]:Number.MAX_SAFE_INTEGER},21128:(G,O,e)=>{"use strict";e.d(O,{Wj:()=>h,rV:()=>o});var t=e(81160),n=e(14236),i=e(28240),s=e(11261),r=e(75059),f=e(85200),a=e(72693),c=e(18282),o=(d=>(d.SeriesToRows="seriesToRows",d.ReduceFields="reduceFields",d))(o||{});const h={id:c.F.reduce,name:"Reduce",description:"Reduce all rows or data points to a single value using a function like max, min, mean or last.",defaultOptions:{reducers:[r.gy.max]},operator:d=>v=>v.pipe((0,t.T)(u=>{if(!d?.reducers?.length)return u;const D=d.fields?(0,f.NS)(d.fields):d.includeTimeField&&d.mode==="reduceFields"?a.Yg:a.zx;if(d.mode==="reduceFields")return m(u,D,d.reducers);const P=g(u,D,d.reducers,d.labelsToFields);return P?[P]:[]}))};function g(d,v,u,D){const P=r.AS.list(u),x=P.map(M=>M.id),E=[],C=D?l(d):[];for(const M of d){const S=M.fields.filter(L=>v(L,M,d)),I=S.length,T=[],b=new Array(I);T.push({name:"Field",type:s.PU.string,values:b,config:{}});const R={};if(D)for(const L of C)R[L]=new Array(I),T.push({name:L,type:s.PU.string,values:R[L],config:{}});const A={};for(const L of P)A[L.id]=new Array(I),T.push({name:L.name,type:s.PU.other,values:A[L.id],config:{}});for(let L=0;L<S.length;L++){const U=S[L],W=(0,r.Nw)({field:U,reducers:x});if(D){if(b[L]=U.name,U.labels)for(const w in U.labels)R[w][L]=U.labels[w]}else b[L]=(0,i.Ct)(U,M,d);for(const w of P){const N=W[w.id];N===null?A[w.id][L]=NaN:A[w.id][L]=N}}for(const L of T)if(L.type===s.PU.other){const U=(0,n.dF)(L);U&&(L.type=U)}E.push({...M,fields:T,length:I})}return p(E)}function l(d){const v=new Set;for(const u of d)for(const D of u.fields)if(D.labels)for(const P of Object.keys(D.labels))v.add(P);return[...v]}function p(d){if(!d?.length)return;const v=d[0];for(let u=1;u<d.length;u++){const D=d[u];for(let P=0;P<v.fields.length;P++){const x=v.fields[P];for(let E=0;E<D.fields.length;E++){const C=D.fields[E],M=P===0&&E===0,S=x.type===C.type&&x.name===C.name;if(M||S){const I=x.values,T=C.values;x.values=I.concat(T)}}}}return v.name=void 0,v.length=v.fields[0].values.length,v}function m(d,v,u){const P=r.AS.list(u).map(E=>E.id),x=[];for(const E of d){const C=[];for(const M of E.fields)if(v(M,E,d)){const S=(0,r.Nw)({field:M,reducers:P});for(const I of P){const T=S[I],b={...M,type:y(I,M),values:[T]};b.state=void 0,P.length>1&&(b.labels||(b.labels={}),b.labels.reducer=r.AS.get(I).name),C.push(b)}}C.length&&x.push({...E,fields:C,length:1})}return x}function y(d,v){switch(d){case r.gy.allValues:case r.gy.uniqueValues:return s.PU.other;case r.gy.first:case r.gy.firstNotNull:case r.gy.last:case r.gy.lastNotNull:return v.type;default:return s.PU.number}}},67641:(G,O,e)=>{"use strict";e.d(O,{f:()=>n,w:()=>t});const t=()=>window?.grafanaBootData?.settings?.featureToggles?.transformationsVariableSupport;function n(i){let s=0;for(const r of i)r.fields.length>s&&(s=r.fields.length);return s}},43585:(G,O,e)=>{"use strict";e.d(O,{O:()=>t});var t=(n=>(n.NoData="no_data",n.Paused="paused",n.Alerting="alerting",n.OK="ok",n.Pending="pending",n.Unknown="unknown",n))(t||{})},8790:(G,O,e)=>{"use strict";e.d(O,{V:()=>t});var t=(n=>(n.Field="field",n.Text="text",n.Skip="skip",n))(t||{})},41987:(G,O,e)=>{"use strict";e.d(O,{Ay:()=>r,Jk:()=>i,hX:()=>s});var t=e(43429),n=e(74135),i=(f=>(f.CloudAlerting="cloud-alerting",f.UnifiedAlerting="unified-alerting",f.Dashboard="dashboard",f.Explore="explore",f.Correlations="correlations",f.Unknown="unknown",f.PanelEditor="panel-editor",f.PanelViewer="panel-viewer",f))(i||{});class s extends t.Ud{constructor(){super(...arguments),this._extensionConfigs=[]}init(a){}setRootPage(a){return this.root=a,this}setComponentsFromLegacyExports(a){if(a.ConfigCtrl&&(this.angularConfigCtrl=a.ConfigCtrl),this.meta&&this.meta.includes){for(const c of this.meta.includes)if(c.type===t.ib.page&&c.component&&!a[c.component]){console.warn("App Page uses unknown component: ",c.component,this.meta);continue}}}get extensionConfigs(){return this._extensionConfigs}addLink(a){const{targets:c,...o}=a;return(Array.isArray(c)?c:[c]).forEach(g=>{this._extensionConfigs.push({...o,extensionPointId:g,type:n.u.link})}),this}addComponent(a){const{targets:c,...o}=a;return(Array.isArray(c)?c:[c]).forEach(g=>{this._extensionConfigs.push({...o,extensionPointId:g,type:n.u.component})}),this}exposeComponent(a){const{id:c,...o}=a;return this._extensionConfigs.push({...o,extensionPointId:`capabilities/${c}`,type:n.u.component}),this}configureExtensionLink(a){return this.addLink({targets:[a.extensionPointId],...a}),this}configureExtensionComponent(a){return this.addComponent({targets:[a.extensionPointId],...a}),this}}var r=(f=>(f.alpha="alpha",f.beta="beta",f.experimental="experimental",f.privatePreview="private preview",f.preview="preview",f))(r||{})},61268:(G,O,e)=>{"use strict";e.d(O,{r:()=>t});var t=(n=>(n.OpenSource="Open Source",n.Pro="Pro",n.Enterprise="Enterprise",n))(t||{})},58649:(G,O,e)=>{"use strict";e.d(O,{En:()=>i,d1:()=>n,tw:()=>t});const t=0,n=100,i="SAML"},94624:(G,O,e)=>{"use strict";e.d(O,{y:()=>t});var t=(n=>(n[n.Off=0]="Off",n[n.Crosshair=1]="Crosshair",n[n.Tooltip=2]="Tooltip",n))(t||{})},39070:(G,O,e)=>{"use strict";e.d(O,{Gu:()=>t,Gv:()=>f,Nx:()=>n,UW:()=>i,zz:()=>s});var t=(a=>(a.NotStarted="NotStarted",a.Loading="Loading",a.Streaming="Streaming",a.Done="Done",a.Error="Error",a))(t||{});const n=["graph","table","logs","trace","nodeGraph","flamegraph","rawPrometheus"];var i=(a=>(a.Null="null",a.Ignore="connected",a.AsZero="null as zero",a))(i||{});const s=a=>!!a;function r(a){return a}function f(a){return typeof a=="object"&&a!==null?!0:!1}},11261:(G,O,e)=>{"use strict";e.d(O,{Bc:()=>n,LE:()=>i,PU:()=>t,aI:()=>s});var t=(r=>(r.time="time",r.number="number",r.string="string",r.boolean="boolean",r.trace="trace",r.geo="geo",r.enum="enum",r.other="other",r.frame="frame",r.nestedFrames="nestedFrames",r))(t||{});const n="Value",i="Time",s="Metric"},41260:(G,O,e)=>{"use strict";e.d(O,{m:()=>t});var t=(n=>(n.TimeSeriesWide="timeseries-wide",n.TimeSeriesLong="timeseries-long",n.TimeSeriesMany="timeseries-many",n.TimeSeriesMulti="timeseries-multi",n.NumericWide="numeric-wide",n.NumericMulti="numeric-multi",n.NumericLong="numeric-long",n.LogLines="log-lines",n.DirectoryListing="directory-listing",n.HeatmapRows="heatmap-rows",n.HeatmapCells="heatmap-cells",n.Histogram="histogram",n))(t||{})},91890:(G,O,e)=>{"use strict";e.d(O,{$0:()=>i,CC:()=>n,uP:()=>s,x0:()=>t,yd:()=>r});var t=(f=>(f.Datasource="Datasource",f.Correlations="Correlations",f.ExploreCorrelationsEditor="CorrelationsEditor",f))(t||{}),n=(f=>(f.Regex="regex",f.Logfmt="logfmt",f))(n||{}),i=(f=>(f.Series="series",f.Field="field",f.Fields="fields",f.Value="value",f.BuiltIn="built-in",f.Template="template",f))(i||{}),s=(f=>(f.Values="values",f))(s||{}),r=(f=>(f.Link="link",f.Off="off",f))(r||{})},40187:(G,O,e)=>{"use strict";e.d(O,{Is:()=>a,ZF:()=>r,mA:()=>s,tD:()=>i,v2:()=>f});var t=e(92341),n=e(43429);class i extends n.Ud{constructor(o){super(),this.DataSourceClass=o,this.components={}}setConfigEditor(o){return this.components.ConfigEditor=o,this}setConfigCtrl(o){return this.angularConfigCtrl=o,this}setQueryCtrl(o){return this.components.QueryCtrl=o,this}setAnnotationQueryCtrl(o){return this.components.AnnotationsQueryCtrl=o,this}setQueryEditor(o){return this.components.QueryEditor=o,this}setExploreQueryField(o){return this.components.ExploreQueryField=o,this}setExploreMetricsQueryField(o){return this.components.ExploreMetricsQueryField=o,this}setExploreLogsQueryField(o){return this.components.ExploreLogsQueryField=o,this}setQueryEditorHelp(o){return this.components.QueryEditorHelp=o,this}setExploreStartPage(o){return this.setQueryEditorHelp(o)}setVariableQueryEditor(o){return this.components.VariableQueryEditor=o,this}setMetadataInspector(o){return this.components.MetadataInspector=o,this}setComponentsFromLegacyExports(o){this.angularConfigCtrl=o.ConfigCtrl,this.components.QueryCtrl=o.QueryCtrl,this.components.AnnotationsQueryCtrl=o.AnnotationsQueryCtrl,this.components.ExploreQueryField=o.ExploreQueryField,this.components.QueryEditor=o.QueryEditor,this.components.QueryEditorHelp=o.QueryEditorHelp,this.components.VariableQueryEditor=o.VariableQueryEditor}}class s{constructor(o){this.name=o.name,this.id=o.id,this.type=o.type,this.meta=o.meta,this.cachingConfig=o.cachingConfig,this.uid=o.uid,this.apiVersion=o.apiVersion}filterQuery(o){return!0}getRef(){const o={type:this.type,uid:this.uid};return this.apiVersion&&(o.apiVersion=this.apiVersion),o}}var r=(c=>(c.Logs="Logs",c.Metrics="Metrics",c.Tracing="Tracing",c))(r||{}),f=(c=>(c.Cancelled="cancelled",c.Timeout="timeout",c.Unknown="unknown",c))(f||{});class a{}a=(0,t.Y)(a),s=(0,t.Y)(s)},24293:(G,O,e)=>{"use strict";e.d(O,{F:()=>n,Y:()=>t});var t=(i=>(i.Thresholds="thresholds",i.PaletteClassic="palette-classic",i.PaletteClassicByName="palette-classic-by-name",i.PaletteSaturated="palette-saturated",i.ContinuousGrYlRd="continuous-GrYlRd",i.ContinuousRdYlGr="continuous-RdYlGr",i.ContinuousBlYlRd="continuous-BlYlRd",i.ContinuousYlRd="continuous-YlRd",i.ContinuousBlPu="continuous-BlPu",i.ContinuousYlBl="continuous-YlBl",i.ContinuousBlues="continuous-blues",i.ContinuousReds="continuous-reds",i.ContinuousGreens="continuous-greens",i.ContinuousPurples="continuous-purples",i.Fixed="fixed",i.Shades="shades",i))(t||{});const n="#808080"},37055:(G,O,e)=>{"use strict";e.d(O,{Ow:()=>n,ZW:()=>t,uo:()=>i});function t(s){return r=>"__systemRef"in r&&r.__systemRef===s}const n=s=>"__systemRef"in s&&typeof s.__systemRef=="string";var i=(s=>(s.Unit="unit",s.Min="min",s.Max="max",s.Decimals="decimals",s.DisplayName="displayName",s.NoValue="noValue",s.Thresholds="thresholds",s.Mappings="mappings",s.Links="links",s.Color="color",s.Filterable="filterable",s))(i||{})},8887:(G,O,e)=>{"use strict";e.d(O,{Uo:()=>i,az:()=>t,n6:()=>n});const t={google:!0,microsoft:!0,github:!0,gitlab:!0,okta:!0,discord:!0,hipchat:!0,amazon:!0,"google-hangouts-alt":!0,pagerduty:!0,line:!0,anchor:!0,"adjust-circle":!0,"angle-double-down":!0,"angle-double-right":!0,"angle-double-left":!0,"angle-double-up":!0,"angle-down":!0,"angle-left":!0,"angle-right":!0,"angle-up":!0,"align-left":!0,"align-right":!0,"application-observability":!0,apps:!0,"archive-alt":!0,arrow:!0,"arrow-down":!0,"arrow-from-right":!0,"arrow-left":!0,"arrow-random":!0,"arrow-right":!0,"arrow-to-right":!0,"arrow-up":!0,"arrows-h":!0,"arrows-v":!0,asserts:!0,"expand-arrows":!0,"expand-arrows-alt":!0,at:!0,ai:!0,backward:!0,bars:!0,bell:!0,"bell-slash":!0,bolt:!0,book:!0,bookmark:!0,"book-open":!0,"brackets-curly":!0,bug:!0,building:!0,"calculator-alt":!0,"calendar-alt":!0,"calendar-slash":!0,camera:!0,capture:!0,"channel-add":!0,"chart-line":!0,check:!0,"check-circle":!0,"check-square":!0,circle:!0,"circle-mono":!0,"clipboard-alt":!0,"clock-nine":!0,cloud:!0,"cloud-download":!0,"cloud-upload":!0,"code-branch":!0,cog:!0,columns:!0,"comment-alt":!0,"comment-alt-message":!0,"comment-alt-share":!0,"comments-alt":!0,compass:!0,"compress-arrows":!0,copy:!0,"corner-down-right-alt":!0,"create-dashboard":!0,"credit-card":!0,crosshair:!0,cube:!0,dashboard:!0,database:!0,"dice-three":!0,docker:!0,"document-info":!0,"document-layout-left":!0,"download-alt":!0,draggabledots:!0,edit:!0,"ellipsis-v":!0,enter:!0,envelope:!0,"exchange-alt":!0,"exclamation-triangle":!0,"exclamation-circle":!0,exclamation:!0,"external-link-alt":!0,eye:!0,"eye-slash":!0,"ellipsis-h":!0,"fa fa-spinner":!0,favorite:!0,"file-alt":!0,"file-blank":!0,"file-copy-alt":!0,"file-download":!0,"file-edit-alt":!0,"file-landscape-alt":!0,filter:!0,flip:!0,folder:!0,font:!0,fire:!0,"folder-open":!0,"folder-plus":!0,"folder-upload":!0,forward:!0,"frontend-observability":!0,"gf-bar-alignment-after":!0,"gf-bar-alignment-before":!0,"gf-bar-alignment-center":!0,"gf-glue":!0,"gf-grid":!0,"gf-interpolation-linear":!0,"gf-interpolation-smooth":!0,"gf-interpolation-step-after":!0,"gf-interpolation-step-before":!0,"gf-landscape":!0,"gf-layout-simple":!0,"gf-logs":!0,"gf-ml":!0,"gf-movepane-left":!0,"gf-movepane-right":!0,"gf-portrait":!0,"gf-service-account":!0,"gf-show-context":!0,"gf-pin":!0,"gf-prometheus":!0,"gf-traces":!0,globe:!0,grafana:!0,"graph-bar":!0,heart:!0,"heart-rate":!0,"heart-break":!0,history:!0,"history-alt":!0,home:!0,"home-alt":!0,"horizontal-align-center":!0,"horizontal-align-left":!0,"horizontal-align-right":!0,hourglass:!0,import:!0,info:!0,"info-circle":!0,k6:!0,"key-skeleton-alt":!0,keyboard:!0,kubernetes:!0,"layer-group":!0,"layers-alt":!0,"library-panel":!0,"line-alt":!0,link:!0,"list-ui-alt":!0,"list-ul":!0,"list-ol":!0,lock:!0,"map-marker":!0,"map-marker-plus":!0,"map-marker-minus":!0,message:!0,minus:!0,"minus-circle":!0,"mobile-android":!0,monitor:!0,palette:!0,"panel-add":!0,paragraph:!0,"pathfinder-unite":!0,pause:!0,"pause-circle":!0,pen:!0,percentage:!0,play:!0,plug:!0,plus:!0,"plus-circle":!0,"plus-square":!0,power:!0,"presentation-play":!0,process:!0,"question-circle":!0,"record-audio":!0,repeat:!0,rocket:!0,"ruler-combined":!0,save:!0,search:!0,"search-minus":!0,"search-plus":!0,"share-alt":!0,shield:!0,"shield-exclamation":!0,signal:!0,signin:!0,signout:!0,sitemap:!0,slack:!0,"sliders-v-alt":!0,spinner:!0,"sort-amount-down":!0,"sort-amount-up":!0,"square-shape":!0,star:!0,"step-backward":!0,stopwatch:!0,"stopwatch-slash":!0,sync:!0,"sync-slash":!0,table:!0,"table-collapse-all":!0,"table-expand-all":!0,"tag-alt":!0,"telegram-alt":!0,"text-fields":!0,"thumbs-up":!0,times:!0,"times-circle":!0,"toggle-on":!0,"toggle-off":!0,"trash-alt":!0,unarchive:!0,unlock:!0,upload:!0,user:!0,"users-alt":!0,"user-arrows":!0,"vertical-align-bottom":!0,"vertical-align-center":!0,"vertical-align-top":!0,"web-section-alt":!0,"wrap-text":!0,rss:!0,x:!0,"add-user":!0,attach:!0};function n(s){return!s||typeof s!="string"?!1:s in t}function i(s){if(n(s))return s}},19484:(G,O,e)=>{"use strict";e.d(O,{R:()=>t});var t=(n=>(n.Grid="grid",n.List="list",n))(t||{})},26272:(G,O,e)=>{"use strict";e.d(O,{Tq:()=>f,ee:()=>s,kb:()=>r,r1:()=>i});var t=e(89550),n=e(65463);const i={alertSuccess:(0,t.R)("alert-success"),alertWarning:(0,t.R)("alert-warning"),alertError:(0,t.R)("alert-error"),alertInfo:(0,t.R)("alert-info")},s={refresh:(0,t.R)("refresh"),componentDidMount:(0,t.R)("component-did-mount"),dataReceived:(0,t.R)("data-received"),dataError:(0,t.R)("data-error"),dataFramesReceived:(0,t.R)("data-frames-received"),dataSnapshotLoad:(0,t.R)("data-snapshot-load"),editModeInitialized:(0,t.R)("init-edit-mode"),initPanelActions:(0,t.R)("init-panel-actions"),initialized:(0,t.R)("panel-initialized"),panelTeardown:(0,t.R)("panel-teardown"),render:(0,t.R)("render")};class r extends n.x{static{this.type="graph-hover"}}class f extends n.a{constructor(){super(...arguments),this.payload={point:{}}}static{this.type="graph-hover-clear"}}},55004:(G,O,e)=>{"use strict";e.d(O,{Cz:()=>f,DG:()=>o,Qp:()=>g,Z7:()=>c,ZF:()=>i,aj:()=>h,ew:()=>r,jQ:()=>a,o4:()=>s,os:()=>n,qD:()=>t});var t=(l=>(l.DataSource="ds",l.Plugin="plugin",l.Grafana="grafana",l.Stream="stream",l))(t||{}),n=(l=>(l.DataStream="stream",l.DataFrame="frame",l.JSON="json",l))(n||{}),i=(l=>(l.Pending="pending",l.Connected="connected",l.Connecting="connecting",l.Disconnected="disconnected",l.Shutdown="shutdown",l.Invalid="invalid",l))(i||{}),s=(l=>(l.Status="status",l.Join="join",l.Leave="leave",l.Message="message",l))(s||{});function r(l){return l.type==="status"}function f(l){return l.type==="join"}function a(l){return l.type==="leave"}function c(l){return l.type==="message"}function o(l){if(l?.length){let p=l.trim().split("/");if(p.length>=3)return{scope:p[0],namespace:p[1],path:p.slice(2).join("/")}}}function h(l){return!!(l?.path&&l.namespace&&l.scope)}function g(l){if(!l.scope)return"";let p=l.scope;return!l.namespace||(p+="/"+l.namespace,!l.path)?p:p+"/"+l.path}},9557:(G,O,e)=>{"use strict";e.d(O,{$b:()=>t,Aj:()=>c,FP:()=>g,Nc:()=>o,Ol:()=>f,ZF:()=>r,_0:()=>l,_C:()=>s,cF:()=>a,s5:()=>n,tG:()=>i,wj:()=>h});var t=(p=>(p.emerg="critical",p.fatal="critical",p.alert="critical",p.crit="critical",p.critical="critical",p.warn="warning",p.warning="warning",p.err="error",p.eror="error",p.error="error",p.info="info",p.information="info",p.informational="info",p.notice="info",p.dbug="debug",p.debug="debug",p.trace="trace",p.unknown="unknown",p))(t||{});const n={0:"critical",1:"critical",2:"critical",3:"error",4:"warning",5:"info",6:"info",7:"debug"};var i=(p=>(p[p.Number=0]="Number",p[p.String=1]="String",p[p.LabelsMap=2]="LabelsMap",p[p.Error=3]="Error",p))(i||{}),s=(p=>(p.none="No de-duplication",p.exact="De-duplication of successive lines that are identical, ignoring ISO datetimes.",p.numbers="De-duplication of successive lines that are identical when ignoring numbers, e.g., IP addresses, latencies.",p.signature="De-duplication of successive lines that have identical punctuation and whitespace.",p))(s||{}),r=(p=>(p.Backward="BACKWARD",p.Forward="FORWARD",p))(r||{});const f=p=>!p||typeof p!="object"?!1:"getLogRowContext"in p;var a=(p=>(p.LogsVolume="LogsVolume",p.LogsSample="LogsSample",p))(a||{}),c=(p=>(p.FullRange="FullRange",p.Limited="Limited",p))(c||{});const o=(p,m)=>p?("getDataProvider"in p||"getSupplementaryRequest"in p)&&"getSupplementaryQuery"in p&&"getSupportedSupplementaryQueryTypes"in p&&p.getSupportedSupplementaryQueryTypes().includes(m):!1,h=p=>!p||typeof p!="object"?!1:"getLogRowContextUi"in p,g=p=>p!=null&&typeof p=="object"&&"toggleQueryFilter"in p&&"queryHasFilter"in p,l=p=>p!=null&&typeof p=="object"&&"modifyQuery"in p&&"getSupportedQueryModifications"in p},64388:(G,O,e)=>{"use strict";e.d(O,{k:()=>t});var t=(n=>(n[n.Standard=0]="Standard",n[n.Canvas=1]="Canvas",n[n.Custom=2]="Custom",n))(t||{})},62625:(G,O,e)=>{"use strict";e.d(O,{X:()=>t});var t=(n=>(n.None="None",n.Viewer="Viewer",n.Editor="Editor",n.Admin="Admin",n))(t||{})},47070:(G,O,e)=>{"use strict";e.d(O,{NV:()=>a,nQ:()=>r,v2:()=>f,wV:()=>s});var t=e(2543),n=e.n(t),i=e(11261),s=(c=>(c.Auto="auto",c.Vertical="vertical",c.Horizontal="horizontal",c))(s||{}),r=(c=>(c[c.Best=100]="Best",c[c.Good=70]="Good",c[c.OK=50]="OK",c))(r||{});class f{constructor(o,h){this.list=[],this.data=o,this.panel=h,this.dataSummary=this.computeDataSummary()}getListAppender(o){return new a(this.list,o)}computeDataSummary(){const o=this.data?.series||[];let h=0,g=0,l=0,p=0,m=0,y=0,d;for(const v of o){p+=v.length,v.meta?.preferredVisualisationType&&(d=v.meta.preferredVisualisationType);for(const u of v.fields)switch(y++,u.type){case i.PU.number:h+=1;break;case i.PU.time:g+=1;break;case i.PU.string:l+=1;break}v.length>m&&(m=v.length)}return{numberFieldCount:h,timeFieldCount:g,stringFieldCount:l,rowCountTotal:p,rowCountMax:m,fieldCount:y,preferredVisualisationType:d,frameCount:o.length,hasData:p>0,hasTimeField:g>0,hasNumberField:h>0,hasStringField:l>0}}getList(){return this.list}}class a{constructor(o,h){this.list=o,this.defaults=h}append(o){this.list.push((0,t.defaultsDeep)(o,this.defaults))}}},43429:(G,O,e)=>{"use strict";e.d(O,{Ac:()=>i,QE:()=>n,Ud:()=>a,ZK:()=>r,ib:()=>f,kv:()=>s,pn:()=>t});var t=(c=>(c.alpha="alpha",c.beta="beta",c.stable="stable",c.deprecated="deprecated",c))(t||{}),n=(c=>(c.panel="panel",c.datasource="datasource",c.app="app",c.renderer="renderer",c.secretsmanager="secretsmanager",c))(n||{}),i=(c=>(c.internal="internal",c.valid="valid",c.invalid="invalid",c.modified="modified",c.missing="missing",c))(i||{}),s=(c=>(c.grafana="grafana",c.commercial="commercial",c.community="community",c.private="private",c.core="core",c))(s||{}),r=(c=>(c.missingSignature="signatureMissing",c.invalidSignature="signatureInvalid",c.modifiedSignature="signatureModified",c.failedBackendStart="failedBackendStart",c.angular="angular",c))(r||{}),f=(c=>(c.dashboard="dashboard",c.page="page",c.panel="panel",c.datasource="datasource",c))(f||{});class a{addConfigPage(o){return this.configPages||(this.configPages=[]),this.configPages.push(o),this}setChannelSupport(){return console.warn("[deprecation] plugin is using ignored option: setChannelSupport",this.meta),this}constructor(){this.meta={}}}},74135:(G,O,e)=>{"use strict";e.d(O,{S:()=>n,u:()=>t});var t=(i=>(i.link="link",i.component="component",i))(t||{}),n=(i=>(i.AlertInstanceAction="grafana/alerting/instance/action",i.AlertingHomePage="grafana/alerting/home",i.AlertingAlertingRuleAction="grafana/alerting/alertingrule/action",i.AlertingRecordingRuleAction="grafana/alerting/recordingrule/action",i.CommandPalette="grafana/commandpalette/action",i.DashboardPanelMenu="grafana/dashboard/panel/menu",i.DataSourceConfig="grafana/datasources/config",i.ExploreToolbarAction="grafana/explore/toolbar/action",i.UserProfileTab="grafana/user/profile/tab",i))(n||{})},51527:(G,O,e)=>{"use strict";e.d(O,{x:()=>n});var t=e(43429);function n(i){return i&&i!==t.Ac.valid&&i!==t.Ac.internal}},73372:(G,O,e)=>{"use strict";e.d(O,{D_:()=>t,Ee:()=>i,FL:()=>n});var t=(s=>(s.Equal="Equal",s.NotEqual="NotEqual",s.EqualRegEx="EqualRegEx",s.NotEqualRegEx="NotEqualRegEx",s))(t||{});const n=s=>!s||typeof s!="object"?!1:"importFromAbstractQueries"in s,i=s=>!s||typeof s!="object"?!1:"exportToAbstractQueries"in s},37891:(G,O,e)=>{"use strict";e.d(O,{n:()=>t});const t={"=":"equals","!=":"not-equals","=~":"regex-match","!~":"regex-not-match"}},12470:(G,O,e)=>{"use strict";e.d(O,{CO:()=>t,ZG:()=>n,zL:()=>i});var t=(s=>(s[s.never=0]="never",s[s.onDashboardLoad=1]="onDashboardLoad",s[s.onTimeRangeChanged=2]="onTimeRangeChanged",s))(t||{}),n=(s=>(s[s.disabled=0]="disabled",s[s.alphabeticalAsc=1]="alphabeticalAsc",s[s.alphabeticalDesc=2]="alphabeticalDesc",s[s.numericalAsc=3]="numericalAsc",s[s.numericalDesc=4]="numericalDesc",s[s.alphabeticalCaseInsensitiveAsc=5]="alphabeticalCaseInsensitiveAsc",s[s.alphabeticalCaseInsensitiveDesc=6]="alphabeticalCaseInsensitiveDesc",s[s.naturalAsc=7]="naturalAsc",s[s.naturalDesc=8]="naturalDesc",s))(n||{}),i=(s=>(s[s.dontHide=0]="dontHide",s[s.hideLabel=1]="hideLabel",s[s.hideVariable=2]="hideVariable",s))(i||{})},25137:(G,O,e)=>{"use strict";e.d(O,{I:()=>t});var t=(n=>(n.Light="light",n.Dark="dark",n))(t||{})},50082:(G,O,e)=>{"use strict";e.d(O,{O:()=>t});var t=(n=>(n.Absolute="absolute",n.Percentage="percentage",n))(t||{})},43127:(G,O,e)=>{"use strict";e.d(O,{Cn:()=>f,E2:()=>r,G$:()=>s,HW:()=>a,lE:()=>i});var t=e(52622),n=e(47232);const i=t.vp,s="YYYY-MM-DD HH:mm:ss";function r(){const c=(0,n.KQ)();return{from:(0,n.KQ)(c).subtract(6,"hour"),to:c,raw:{from:"now-6h",to:"now"}}}function f(){return{from:600,to:0}}function a(c,o){const h=typeof c=="string"?(0,n.KQ)(c):c,g=typeof o=="string"?(0,n.KQ)(o):o;return{from:h,to:g,raw:{from:h,to:g}}}},81010:(G,O,e)=>{"use strict";e.d(O,{M:()=>t,N:()=>n});var t=(i=>(i[i.NotPossible=-1]="NotPossible",i[i.NotApplicable=0]="NotApplicable",i[i.Applicable=1]="Applicable",i[i.HighlyApplicable=2]="HighlyApplicable",i))(t||{}),n=(i=>(i.True="true",i.False="false",i.Null="null",i.Empty="empty",i))(n||{})},25019:(G,O,e)=>{"use strict";e.d(O,{W:()=>n,d:()=>t});var t=(i=>(i.ValueToText="value",i.RangeToText="range",i.RegexToText="regex",i.SpecialValue="special",i))(t||{}),n=(i=>(i.True="true",i.False="false",i.Null="null",i.NaN="nan",i.NullAndNaN="null+nan",i.Empty="empty",i))(n||{})},29505:(G,O,e)=>{"use strict";e.d(O,{J$:()=>i,Qz:()=>t,ZV:()=>r,f5:()=>s,xi:()=>n});var t=(f=>(f.Legacy="legacy",f.Standard="standard",f.Custom="custom",f.Datasource="datasource",f))(t||{});class n{}class i extends n{getType(){return"standard"}}class s extends n{getType(){return"custom"}}class r extends n{getType(){return"datasource"}}},35853:(G,O,e)=>{"use strict";e.d(O,{V:()=>t});function t(){Object.getOwnPropertyDescriptor(Array.prototype,"toArray")||Object.defineProperties(Array.prototype,{get:{value:function(n){return this[n]},writable:!0,enumerable:!1,configurable:!0},set:{value:function(n,i){this[n]=i},writable:!0,enumerable:!1,configurable:!0},add:{value:function(n){this.push(n)},writable:!0,enumerable:!1,configurable:!0},toArray:{value:function(){return this},writable:!0,enumerable:!1,configurable:!0}})}t()},7144:(G,O,e)=>{"use strict";e.d(O,{b:()=>s});var t=e(74848),n=e(96540),i=e(68941);const s=r=>{const{children:f,storageKey:a,defaultValue:c}=r,[o,h]=(0,n.useState)({value:i.M.getObject(r.storageKey,r.defaultValue)});(0,n.useEffect)(()=>{const p=m=>{m.key===a&&h({value:i.M.getObject(r.storageKey,r.defaultValue)})};return window.addEventListener("storage",p),()=>{window.removeEventListener("storage",p)}});const g=p=>{try{i.M.setObject(a,p)}catch(m){console.error(m)}h({value:p})},l=()=>{try{i.M.delete(a)}catch(p){console.log(p)}h({value:c})};return(0,t.jsx)(t.Fragment,{children:f(o.value,g,l)})}},60264:(G,O,e)=>{"use strict";e.d(O,{bk:()=>a,pv:()=>h,iF:()=>o});var t=e(2543),n=e(27310),i=e(69550),s=e(83077);class r{constructor(){this.properties=[]}addCustomEditor(l){return this.properties.push(l),this}getRegistry(){return new s.O(()=>this.properties)}getItems(){return this.properties}}var f=e(39070);class a extends r{addNumberInput(l){return this.addCustomEditor({...l,id:l.path,override:i.D.get("number").editor,editor:i.D.get("number").editor,process:n.m0,shouldApply:l.shouldApply??(()=>!0),settings:l.settings||{}})}addSliderInput(l){return this.addCustomEditor({...l,id:l.path,override:i.D.get("slider").editor,editor:i.D.get("slider").editor,process:n.m0,shouldApply:l.shouldApply??(()=>!0),settings:l.settings||{}})}addTextInput(l){return this.addCustomEditor({...l,id:l.path,override:i.D.get("text").editor,editor:i.D.get("text").editor,process:n.OU,shouldApply:l.shouldApply??(()=>!0),settings:l.settings||{}})}addSelect(l){return this.addCustomEditor({...l,id:l.path,override:i.D.get("select").editor,editor:i.D.get("select").editor,process:n.hL,shouldApply:l.shouldApply?l.shouldApply:()=>!0,settings:l.settings||{options:[]}})}addRadio(l){return this.addCustomEditor({...l,id:l.path,override:i.D.get("radio").editor,editor:i.D.get("radio").editor,process:n.hL,shouldApply:l.shouldApply?l.shouldApply:()=>!0,settings:l.settings||{options:[]}})}addBooleanSwitch(l){return this.addCustomEditor({...l,id:l.path,editor:i.D.get("boolean").editor,override:i.D.get("boolean").editor,process:n.FM,shouldApply:l.shouldApply?l.shouldApply:()=>!0,settings:l.settings||{}})}addColorPicker(l){return this.addCustomEditor({...l,id:l.path,editor:i.D.get("color").editor,override:i.D.get("color").editor,process:n.hS,shouldApply:l.shouldApply?l.shouldApply:()=>!0,settings:l.settings||{}})}addUnitPicker(l){return this.addCustomEditor({...l,id:l.path,editor:i.D.get("unit").editor,override:i.D.get("unit").editor,process:n.lG,shouldApply:l.shouldApply?l.shouldApply:()=>!0,settings:l.settings||{}})}addFieldNamePicker(l){return this.addCustomEditor({...l,id:l.path,editor:i.D.get("field-name").editor,override:i.D.get("field-name").editor,process:n.hS,shouldApply:l.shouldApply?l.shouldApply:()=>!0,settings:l.settings||{}})}addGenericEditor(l,p){return this.addCustomEditor({...l,id:l.path,editor:p,override:p,process:n.hS,shouldApply:l.shouldApply?l.shouldApply:()=>!0,settings:l.settings||{}})}}class c{constructor(l){this.cfg=l,this.path="",this.id="nested-panel-options",this.name="nested",this.editor=()=>null,this.getBuilder=()=>this.cfg.build,this.getNestedValueAccess=p=>{const m=this.cfg.values;return m?m(p):{getValue:y=>p.getValue(`${this.path}.${y}`),onChange:(y,d)=>p.onChange(`${this.path}.${y}`,d)}},this.path=l.path,this.category=l.category,this.defaultValue=this.getDefaultValue(l)}getDefaultValue(l){let p=(0,f.Gv)(l.defaultValue)?(0,t.cloneDeep)(l.defaultValue):{};const m=new h;l.build(m,{data:[]});for(const y of m.getItems())y.defaultValue!=null&&(0,t.set)(p,y.path,y.defaultValue);return p}}function o(g){return(0,f.Gv)(g)&&"id"in g&&g.id==="nested-panel-options"}class h extends r{addNestedOptions(l){const p=new c(l);return this.addCustomEditor(p)}addNumberInput(l){return this.addCustomEditor({...l,id:l.path,editor:i.D.get("number").editor})}addSliderInput(l){return this.addCustomEditor({...l,id:l.path,editor:i.D.get("slider").editor})}addTextInput(l){return this.addCustomEditor({...l,id:l.path,editor:i.D.get("text").editor})}addStringArray(l){return this.addCustomEditor({...l,id:l.path,editor:i.D.get("strings").editor})}addSelect(l){return this.addCustomEditor({...l,id:l.path,editor:i.D.get("select").editor})}addMultiSelect(l){return this.addCustomEditor({...l,id:l.path,editor:i.D.get("multi-select").editor})}addRadio(l){return this.addCustomEditor({...l,id:l.path,editor:i.D.get("radio").editor})}addBooleanSwitch(l){return this.addCustomEditor({...l,id:l.path,editor:i.D.get("boolean").editor})}addColorPicker(l){return this.addCustomEditor({...l,id:l.path,editor:i.D.get("color").editor,settings:l.settings||{}})}addTimeZonePicker(l){return this.addCustomEditor({...l,id:l.path,editor:i.D.get("timezone").editor,settings:l.settings||{}})}addUnitPicker(l){return this.addCustomEditor({...l,id:l.path,editor:i.D.get("unit").editor})}addFieldNamePicker(l){return this.addCustomEditor({...l,id:l.path,editor:i.D.get("field-name").editor})}addDashboardPicker(l){return this.addCustomEditor({...l,id:l.path,editor:i.D.get("dashboard-uid").editor})}}},28802:(G,O,e)=>{"use strict";e.d(O,{t:()=>i});var t=e(2543),n=e.n(t);function i(s){return typeof s=="number"?s:s===""||s===null||s===void 0||Array.isArray(s)?NaN:typeof s=="boolean"?s?1:0:(0,t.toNumber)(s)}},14588:(G,O,e)=>{"use strict";e.r(O),e.d(O,{insertAfterImmutably:()=>s,insertBeforeImmutably:()=>i,moveItemImmutably:()=>n,sortValues:()=>a});var t=e(52622);function n(c,o,h){const g=[...c];return Array.prototype.splice.call(g,h,0,Array.prototype.splice.call(g,o,1)[0]),g}function i(c,o,h){if(h<0||h>c.length)throw new Error("Index out of bounds");const g=[...c];return g.splice(h,0,o),g}function s(c,o,h){if(h<0||h>c.length)throw new Error("Index out of bounds");const g=[...c];return g.splice(h+1,0,o),g}const r=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}),f=(c,o)=>c-o;function a(c){return(o,h)=>{if(o===h)return 0;if(h==null||typeof h=="string"&&h.trim()==="")return-1;if(o==null||typeof o=="string"&&o?.trim()==="")return 1;let g=r.compare;return typeof o=="number"&&typeof h=="number"&&(g=f),c===t.xB.Descending?g(h,o):g(o,h)}}},11710:(G,O,e)=>{"use strict";e.d(O,{b:()=>i,k:()=>n});var t=e(83077),n=(s=>(s.Add="+",s.Subtract="-",s.Divide="/",s.Multiply="*",s))(n||{});const i=new t.O(()=>[{id:"+",name:"Add",operation:(s,r)=>s+r,binaryOperationID:"+"},{id:"-",name:"Subtract",operation:(s,r)=>s-r,binaryOperationID:"-"},{id:"*",name:"Multiply",operation:(s,r)=>s*r,binaryOperationID:"*"},{id:"/",name:"Divide",operation:(s,r)=>s/r,binaryOperationID:"/"}])},72436:(G,O,e)=>{"use strict";e.d(O,{F7:()=>h,Jh:()=>g,_O:()=>u,i8:()=>p});var t=e(2543),n=e.n(t),i=e(44809),s=e.n(i),r=e(37471),f=e(14236),a=e(28240),c=e(11261),o=e(83195),h=(D=>(D[D.full=0]="full",D[D.name=1]="name",D[D.none=2]="none",D))(h||{});function g(D,P){return new p(P).readCSV(D)}var l=(D=>(D[D.Starting=0]="Starting",D[D.InHeader=1]="InHeader",D[D.ReadingRows=2]="ReadingRows",D))(l||{});class p{constructor(P){this.chunk=(x,E)=>{for(let C=0;C<x.data.length;C++){const M=x.data[C];if(M.length<1)continue;const S=M[0];if(S){if(S.startsWith("#")){const I=S.indexOf("#",2);if(I>0){const T=S.slice(1,I),b=T==="name";if(b||{unit:"#"}.hasOwnProperty(T)){this.state===2&&(this.current=new r.k({fields:[]}),this.data.push(this.current));const A=S.slice(I+1);if(b){this.current.addFieldFor(void 0,A);for(let L=1;L<M.length;L++)this.current.addFieldFor(void 0,M[L])}else{const{fields:L}=this.current;for(let U=0;U<L.length;U++){L[U].config||(L[U].config={});const W=L[U].config;W[T]=U===0?A:M[U]}}this.state=1;continue}}else if(this.state===0){this.state=1;continue}continue}if(this.state===0){if((0,f.HW)(S)===c.PU.string){for(const T of M)this.current.addFieldFor(void 0,T);this.state=1;continue}this.state=1}}if(this.state,this.state=2,M.length>this.current.fields.length){const{fields:I}=this.current;for(let T=I.length;T<M.length;T++)this.current.addFieldFor(M[T]);this.callback&&this.callback.onHeader(this.current.fields)}this.current.appendRow(M),this.callback&&this.callback.onRow(M)}},P||(P={}),this.config=P.config||{},this.callback=P.callback,this.current=new r.k({fields:[]}),this.state=0,this.data=[]}readCSV(P){this.current=new r.k({fields:[]}),this.data=[this.current];const x={...this.config,dynamicTyping:!1,skipEmptyLines:!0,comments:!1,chunk:this.chunk};return s().parse(P,x),this.data}}function m(D,P){if(D==null)return"";const x=D.toString();return x.includes('"')?P.quoteChar+x.replace(/"/gi,'""')+P.quoteChar:x.includes(`
`)||P.delimiter&&x.includes(P.delimiter)?P.quoteChar+x+P.quoteChar:x}function y(D,P){return D.display?x=>{const E=D.display(x);return m((0,o.cN)(E),P)}:x=>m(x,P)}function d(D,P,x){const E=D==="name",C=D==="type";for(const M of P){const S=M.config;if(E||C||S&&S.hasOwnProperty(D)){let I="#"+D+"#";for(let T=0;T<P.length;T++){T>0&&(I=I+x.delimiter);let b=P[T].name;C?b=P[T].type:E||(b=P[T].config[D]),b&&(I=I+m(b,x))}return I+x.newline}}return""}function v(){const D=["x","y"];return D.toLocaleString?D.toLocaleString().charAt(1):","}function u(D,P){if(!D)return"";P=(0,t.defaults)(P,{delimiter:v(),newline:`\r
`,quoteChar:'"',encoding:"",headerStyle:1,useExcelHeader:!1});let x=P.useExcelHeader?`sep=${P.delimiter}${P.newline}`:"";for(let E=0;E<D.length;E++){const C=D[E],{fields:M}=C;if(M.length===0)continue;if(P.headerStyle===0)x=x+d("name",M,P)+d("type",M,P)+d("unit",M,P)+d("dateFormat",M,P);else if(P.headerStyle===1){for(let I=0;I<M.length;I++)I>0&&(x+=P.delimiter),x+=`"${(0,a.Ct)(M[I],C).replace(/"/g,'""')}"`;x+=P.newline}const S=M[0].values.length;if(S>0){const I=M.map(T=>y(T,P));for(let T=0;T<S;T++){for(let b=0;b<M.length;b++){b>0&&(x=x+P.delimiter);const R=M[b].values[T];R!==null&&(x=x+I[b](R))}T!==S-1&&(x=x+P.newline)}}E!==D.length-1&&(x=x+P.newline)}return x}},6709:(G,O,e)=>{"use strict";e.d(O,{c:()=>i,u:()=>s});var t=e(71733),n=e(76885);const i={keepTime:"__url_time_range",timeRangeFrom:"__from",timeRangeTo:"__to",includeVars:"__all_variables",seriesName:"__series.name",fieldName:"__field.name",valueTime:"__value.time",valueNumeric:"__value.numeric",valueText:"__value.text",valueRaw:"__value.raw",valueCalc:"__value.calc"};function s(c){const{onClickFn:o,replaceVariables:h,link:g,scopedVars:l,range:p,field:m,internalLink:y}=c,d=f(g.internal?.query,l,h),v=f(g.internal?.panelsState,l,h),u=f(g.internal?.meta?.correlationData,l,h),D=g.title?g.title:y.datasourceName;return{title:h(D,l),href:r(y.datasourceUid,d,p,v),onClick:o?P=>{P.preventDefault&&P.preventDefault(),o({datasourceUid:y.datasourceUid,queries:[d],panelsState:v,correlationHelperData:u,range:p})}:void 0,target:g?.targetBlank?"_blank":"_self",origin:m}}function r(c,o,h,g){return t.I.assureBaseUrl(`/explore?left=${encodeURIComponent((0,n.Pp)({...h?.raw?{range:(0,n.sQ)(h.raw)}:{},datasource:c,queries:[o],panelsState:g}))}`)}function f(c,o,h){if(!c)return c;if(typeof c=="string")return h(c,o);const g=JSON.parse(JSON.stringify(c));return a(g,o,h)}function a(c,o,h){for(const g of Object.keys(c))typeof c[g]=="string"?c[g]=h(c[g],o):typeof c[g]=="object"&&c[g]!==null&&(c[g]=a(c[g],o,h));return c}},22391:(G,O,e)=>{"use strict";e.d(O,{BD:()=>o,EX:()=>h,Iz:()=>r,PG:()=>a,QP:()=>d,fN:()=>s,lO:()=>m,mn:()=>c,p$:()=>i,pN:()=>p,wY:()=>g,wp:()=>y,yV:()=>l,zX:()=>f});var t=e(2543),n=e.n(t);function i(v){const u={uid:v.uid,type:v.type};return v.apiVersion&&(u.apiVersion=v.apiVersion),u}function s(v){return typeof v=="object"&&typeof v?.uid=="string"}function r(v){if(s(v))return v.uid;if((0,t.isString)(v))return v}const f=(v,u)=>D=>{p(v,u,D.currentTarget.value)},a=(v,u)=>D=>{m(v,u,D.currentTarget.value)},c=(v,u)=>D=>{y(v,u,D.currentTarget.value)},o=(v,u)=>D=>{m(v,u,D.value)},h=(v,u)=>D=>{m(v,u,D.currentTarget.checked)},g=(v,u)=>D=>{y(v,u,D.value)},l=(v,u)=>D=>{d(v,u)};function p(v,u,D){const P=v.options;v.onOptionsChange({...P,[u]:D})}const m=(v,u,D)=>{const P=v.options;v.onOptionsChange({...P,jsonData:{...P.jsonData,[u]:D}})},y=(v,u,D)=>{const P=v.options;v.onOptionsChange({...P,secureJsonData:{...P.secureJsonData?P.secureJsonData:{},[u]:D}})},d=(v,u)=>{const D=v.options;v.onOptionsChange({...D,secureJsonData:{...D.secureJsonData?D.secureJsonData:{},[u]:""},secureJsonFields:{...D.secureJsonFields,[u]:!1}})}},95344:(G,O,e)=>{"use strict";e.d(O,{l:()=>n});const t={},n=(i,s,r)=>{let f=`[Deprecation warning] ${i}: ${s} is deprecated`;r&&(f+=`. Use ${r} instead`);const a=Date.now(),c=t[f];(!c||a-c>1e4)&&(console.warn(f),t[f]=a)}},87885:(G,O,e)=>{"use strict";e.d(O,{f:()=>t});var t=(n=>(n[n.Transformations=0]="Transformations",n[n.FieldConfig=1]="FieldConfig",n[n.FieldConfigOverrides=2]="FieldConfigOverrides",n))(t||{})},39306:(G,O,e)=>{"use strict";e.d(O,{R:()=>n,r:()=>i});var t=e(39070);function n({xField:s,yField:r,nullValueMode:f}){const a=s.values,c=r.values,o=a.length;if(c.length!==o)throw new Error("Unexpected field length");const h=f===t.UW.Ignore,g=f===t.UW.AsZero,l=[];for(let p=0;p<o;p++){const m=a[p];let y=c[p];if(y===null){if(h)continue;g&&(y=0)}m!==null&&l.push([m,y])}return l}function i(s,r){if(!r.from||!r.to||!s||s.length===0)return[];const f=r.from.valueOf(),a=r.to.valueOf(),c=s[0][1];return[[f,c],[a,c]]}},8249:(G,O,e)=>{"use strict";e.d(O,{Xy:()=>n,_p:()=>r,h6:()=>f,s6:()=>s,yO:()=>i});const t=/\b(\w+)(!?=~?)"([^"\n]*?)"/g;function n(a){const c={};return a.replace(t,(o,h,g,l)=>(c[h]=l,"")),c}function i(a){return a.reduce((c,o)=>{if(!o)throw new Error("Need parsed labels to find common labels.");return Object.keys(o).forEach(h=>{(c[h]===void 0||c[h]!==o[h])&&delete c[h]}),Object.keys(c).forEach(h=>{o[h]===void 0&&delete c[h]}),c},{...a[0]})}function s(a,c){const o={...a};return Object.keys(c).forEach(h=>{delete o[h]}),o}function r(a,c){if(!a)return!0;for(const[o,h]of Object.entries(a))if(!c||c[o]!==h)return!1;return!0}function f(a,c="",o){if(!a||Object.keys(a).length===0)return c;const g=Object.keys(a).sort().map(l=>`${l}="${a[l]}"`).join(", ");return o?g:["{",g,"}"].join("")}},71733:(G,O,e)=>{"use strict";e.d(O,{I:()=>g});var t=e(80997),n=e(76885);let i={appSubUrl:""},s,r;const f=l=>{try{return new URL(l)}catch{return}},a=l=>{const p=f(l);if(p&&p.origin!==window.location.origin)return l;const m=i.appSubUrl??"",y=m.endsWith("/")?1:0,d=l.startsWith("http");let v=m;return(!l.startsWith("/")||d)&&(v=`${window.location.origin}${m}`),l.length>0&&(l.indexOf(v+"/")===0||l===v)?l.slice(v.length-y):l},c=l=>l.startsWith("/")?`${i.appSubUrl}${a(l)}`:l,g={initialize:l=>{i=l.config,s=l.getTimeRangeForUrl,r=l.getVariablesUrlParams},stripBaseFromUrl:a,assureBaseUrl:c,updateSearchParams:(l,p)=>{const m=new URLSearchParams(p);try{const y=new URL(l);return m.forEach((d,v)=>y.searchParams.set(v,d)),y.href}catch{const y=new URLSearchParams(l);return m.forEach((d,v)=>{y.set(v,d)}),"?"+y.toString()}},getTimeRangeUrlParams:()=>s?n.kM.toUrlParams(s()):null,getVariablesUrlParams:l=>{if(!r)return null;const p=r(l);return n.kM.toUrlParams(p)},getUrlForPartial:(l,p)=>{const m=n.kM.parseKeyValue(l.search.startsWith("?")?l.search.substring(1):l.search);for(const y in p)p[y]===null||p[y]===void 0?delete m[y]:m[y]=p[y];return c(n.kM.renderUrl(l.pathname,m))},processUrl:l=>i.disableSanitizeHtml?l:t.sQ.sanitizeUrl(l)}},92341:(G,O,e)=>{"use strict";e.d(O,{Y:()=>t});function t(n){return new Proxy(n,{apply(i,s,r){return(typeof Reflect>"u"||!Reflect.construct)&&alert("Browser is too old"),Reflect.construct(i,r,s.constructor)}})}},80147:(G,O,e)=>{"use strict";e.d(O,{_:()=>t});function t(n,i){return i.id===n?!0:i.aliasIDs?i.aliasIDs.includes(n):!1}},25352:(G,O,e)=>{"use strict";e.d(O,{u:()=>t});var t=(n=>(n.id="id",n.title="title",n.subTitle="subtitle",n.mainStat="mainstat",n.secondaryStat="secondarystat",n.arc="arc__",n.icon="icon",n.color="color",n.source="source",n.target="target",n.detail="detail__",n.nodeRadius="noderadius",n.thickness="thickness",n.highlighted="highlighted",n.strokeDasharray="strokedasharray",n.fixedX="fixedx",n.fixedY="fixedy",n))(t||{})},97706:(G,O,e)=>{"use strict";e.d(O,{E:()=>n,h:()=>t});function t(i,s=0){if(Number.isInteger(i))return i;let r=10**s,f=i*r*(1+Number.EPSILON);return Math.round(f)/r}function n(i){return((""+i).split(".")[1]||"").length}},92041:(G,O,e)=>{"use strict";e.d(O,{R:()=>n,w:()=>t});const t=i=>Object.keys(i).reduce((s,r)=>(i[r]!==void 0&&(s[r]=i[r]),s),{}),n=i=>typeof i=="object"&&i!==null&&Object.keys(i).length===0},50877:(G,O,e)=>{"use strict";e.d(O,{z:()=>t});const t=n=>({label:n,value:n})},68941:(G,O,e)=>{"use strict";e.d(O,{M:()=>n});class t{get(s){return window.localStorage[s]}set(s,r){window.localStorage[s]=r}getBool(s,r){return r!==void 0&&!this.exists(s)?r:window.localStorage[s]==="true"}getObject(s,r){let f=r;if(this.exists(s)){const a=window.localStorage[s];try{f=JSON.parse(a)}catch(c){console.error(`Error parsing store object: ${s}. Returning default: ${r}. [${c}]`)}}return f}setObject(s,r){let f;try{f=JSON.stringify(r)}catch(a){throw new Error(`Could not stringify object: ${s}. [${a}]`)}try{this.set(s,f)}catch(a){const c=new Error(`Could not save item in localStorage: ${s}. [${a}]`);throw a instanceof Error&&(c.name=a.name),c}return!0}exists(s){return window.localStorage[s]!==void 0}delete(s){window.localStorage.removeItem(s)}}const n=new t},27618:(G,O,e)=>{"use strict";e.d(O,{_:()=>n,j:()=>i});var t=e(83077),n=(s=>(s.Abs="abs",s.Exp="exp",s.Ln="ln",s.Floor="floor",s.Ceil="ceil",s))(n||{});const i=new t.O(()=>[{id:"abs",name:"Absolute value",operation:s=>Math.abs(s),unaryOperationID:"abs"},{id:"exp",name:"Natural exponent",operation:s=>Math.exp(s),unaryOperationID:"exp"},{id:"ln",name:"Natural logarithm",operation:s=>Math.log(s),unaryOperationID:"ln"},{id:"floor",name:"Floor",operation:s=>Math.floor(s),unaryOperationID:"floor"},{id:"ceil",name:"Ceiling",operation:s=>Math.ceil(s),unaryOperationID:"ceil"}])},76885:(G,O,e)=>{"use strict";e.d(O,{Pp:()=>g,kM:()=>h,sQ:()=>l});var t=e(47232);/**
 * @preserve jquery-param (c) 2015 KNOWLEDGECODE | MIT
 */function n(p,m){return m&&Object.keys(m).length>0&&(p+="?"+s(m)),p}function i(p,m){return encodeURIComponent(p).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,m?"%20":"+").replace(/[!'()*]/g,function(y){return"%"+y.charCodeAt(0).toString(16).toUpperCase()})}function s(p,m=!0){const y=[],d=/\[\]$/,v=m?(x,E)=>i(x,E):(x,E)=>encodeURIComponent(x),u=x=>Object.prototype.toString.call(x)==="[object Array]",D=(x,E)=>{if(E=typeof E=="function"?E():E===null||E===void 0?"":E,typeof E!="boolean")y[y.length]=v(x,!0)+"="+v(E,!0);else{const C=E?"":"="+v("false",!0);y[y.length]=v(x,!0)+C}},P=(x,E)=>{let C,M,S;if(x)if(u(E))for(C=0,M=E.length;C<M;C++)d.test(x)?D(x,E[C]):P(x,E[C]);else if(E&&String(E)==="[object Object]")for(S in E)P(x+"["+S+"]",E[S]);else D(x,E);else if(u(E))for(C=0,M=E.length;C<M;C++)D(E[C].name,E[C].value);else for(S in E)P(S,E[S]);return y};return P("",p).join("&")}function r(p){return s(p,!1)}function f(p,m){if(m!=null&&m!==""){const y=p.indexOf("?");y!==-1?p.length-y>1&&(p+="&"):p+="?",p+=m}return p}function a(){const m=window.location.search.substring(1).split("&"),y={};for(const d of m){const v=d.split("=");if(v.length>1){const u=decodeURIComponent(v[0]),D=decodeURIComponent(v[1]);u in y?y[u]=[...y[u],D]:y[u]=[D]}else if(v.length===1){const u=decodeURIComponent(v[0]);y[u]=!0}}return y}function c(p){const m={},y=(p||"").split("&");for(let d of y){let v,u,D;if(d&&(u=d=d.replace(/\+/g,"%20"),v=d.indexOf("="),v!==-1&&(u=d.substring(0,v),D=d.substring(v+1)),u=o(u),u!==void 0)){D=D!==void 0?o(D):!0;let P;typeof D=="string"&&D!==""?P=D==="true"||D==="false"?D==="true":D:P=D,m.hasOwnProperty(u)?Array.isArray(m[u])?m[u].push(D):m[u]=[m[u],isNaN(P)?D:P]:m[u]=isNaN(P)?D:P}}return m}function o(p){try{return decodeURIComponent(p)}catch{return}}const h={renderUrl:n,toUrlParams:s,appendQueryToUrl:f,getUrlSearchParams:a,parseKeyValue:c,serializeParams:r};function g(p,m){return m!==void 0&&console.warn("`compact` parameter is deprecated and will be removed in a future release"),JSON.stringify(p)}const l=p=>{let m=p.from;(0,t.Ar)(m)&&(m=m.valueOf().toString());let y=p.to;return(0,t.Ar)(y)&&(y=y.valueOf().toString()),{from:m,to:y}}},62398:(G,O,e)=>{"use strict";e.d(O,{An:()=>f,Zz:()=>s,bh:()=>a});var t=e(47737),n=e(54479),i=e(25019);function s(o,h){for(const g of o)switch(g.type){case i.d.ValueToText:if(h==null)continue;const l=g.options[h];if(l)return l;break;case i.d.RangeToText:if(h==null)continue;const p=parseFloat(h);if(isNaN(p)||!isNaN(g.options.from)&&p<g.options.from||!isNaN(g.options.to)&&p>g.options.to)continue;return g.options.result;case i.d.RegexToText:if(h==null||typeof h!="string")continue;const d=(0,n.dO)(g.options.pattern);if(h.match(d)){const v={...g.options.result};return v.text!=null&&(v.text=h.replace(d,g.options.result.text||"")),v}case i.d.SpecialValue:switch(g.options.match){case i.W.Null:{if(h==null)return g.options.result;break}case i.W.NaN:{if(typeof h=="number"&&isNaN(h))return g.options.result;break}case i.W.NullAndNaN:{if(typeof h=="number"&&isNaN(h)||h==null)return g.options.result;break}case i.W.True:{if(h===!0||h==="true")return g.options.result;break}case i.W.False:{if(h===!1||h==="false")return g.options.result;break}case i.W.Empty:{if(h==="")return g.options.result;break}}}return null}function r(o){return(typeof o=="number"||typeof o=="string"&&o.trim()!=="")&&!isNaN(o)}var f=(o=>(o[o.ValueToText=1]="ValueToText",o[o.RangeToText=2]="RangeToText",o))(f||{});function a(o,h){const g=[];let l=o.mappingType;if(o.mappingType||(o.valueMaps&&o.valueMaps.length?l=1:o.rangeMaps&&o.rangeMaps.length&&(l=2)),l===1)for(let p=0;p<o.valueMaps.length;p++){const m=o.valueMaps[p];g.push(c({...m,id:p,type:i.d.ValueToText},o.fieldConfig?.defaults?.thresholds||h))}else if(l===2)for(let p=0;p<o.rangeMaps.length;p++){const m=o.rangeMaps[p];g.push(c({...m,id:p,type:i.d.RangeToText},o.fieldConfig?.defaults?.thresholds||h))}return g}function c(o,h){const g={type:i.d.ValueToText,options:{}},l=[];let p;const m=parseFloat(o.text);if(h&&!isNaN(m)){const y=(0,t.yQ)(m,h.steps);y&&y.color&&(p=y.color)}switch(o.type){case 1:case i.d.ValueToText:o.value!=null&&(o.value==="null"?l.push({type:i.d.SpecialValue,options:{match:i.W.Null,result:{text:o.text,color:p}}}):g.options[String(o.value)]={text:o.text,color:p});break;case 2:case i.d.RangeToText:o.from==="null"||o.to==="null"?l.push({type:i.d.SpecialValue,options:{match:i.W.Null,result:{text:o.text,color:p}}}):l.push({type:i.d.RangeToText,options:{from:+o.from,to:+o.to,result:{text:o.text,color:p}}});break}return Object.keys(g.options).length>0&&l.unshift(g),l[0]}},92053:(G,O,e)=>{"use strict";e.d(O,{E:()=>n,c:()=>i});const t="__searchFilter",n=s=>s&&typeof s=="string"?s.indexOf(t)!==-1:!1,i=s=>{const{query:r,wildcardChar:f}=s;if(!n(r))return{};let{options:a}=s;return a=a||{searchFilter:""},{__searchFilter:{value:a.searchFilter?`${a.searchFilter}${f}`:`${f}`,text:""}}}},72495:(G,O,e)=>{"use strict";e.d(O,{k:()=>r});var t=e(44240),n=e(39697),i=e(65961),s=e(67791);function r({whileLoading:f,source:a}){return(0,t.h)((0,n.O)(200).pipe((0,i.u)(f),(0,s.Q)(a)),a)}},26517:(G,O,e)=>{"use strict";e.d(O,{Gl:()=>n,cL:()=>r,rT:()=>c,yW:()=>a});var t=e(83195);function n(o,h){const g=["","K","M","B","T"],l=(0,t.yP)(1e3,g);return(p,m,y)=>{if(p==null)return{text:""};const d=p<0;d&&(p=Math.abs(p));const v=l(p,m,y);return h?v.suffix=v.suffix!==void 0?`${v.suffix}${o}`:void 0:v.prefix=o,d&&(v.prefix=`-${v.prefix?.length?v.prefix:""}`),v}}const i=["f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"],s=i.indexOf("");function r(o){const h=i.findIndex(g=>g.normalize("NFKD")===o.normalize("NFKD"));return h<0?0:h-s}const f=["","Ki","Mi","Gi","Ti","Pi","Ei","Zi","Yi"];function a(o,h=0){const g=f.map(l=>" "+l+o);return(0,t.yP)(1024,g,h)}function c(o,h=0){const g=i.map(l=>" "+l+o);return(0,t.yP)(1e3,g,s+h)}},83195:(G,O,e)=>{"use strict";e.d(O,{Qc:()=>te,cN:()=>X,j_:()=>ee,Ke:()=>De,uH:()=>de,j9:()=>z,Hg:()=>ae,yP:()=>ie,UR:()=>re,cH:()=>ce,Mg:()=>se,gZ:()=>q,G8:()=>oe});var t=e(2543);function n(fe,Te){return fe===null?{text:""}:{text:se(fe,Te),suffix:"%"}}function i(fe,Te){return fe===null?{text:""}:{text:se(100*fe,Te),suffix:"%"}}function s(fe,Te){if(fe==null)return{text:""};const je=r(fe,Te);return je.text.substring(0,1)==="-"?je.text="-0x"+je.text.substring(1):je.text="0x"+je.text,je}function r(fe,Te){return fe==null?{text:""}:{text:parseFloat(se(fe,Te)).toString(16).toUpperCase()}}function f(fe,Te){return fe==null?{text:""}:{text:fe.toExponential(Te??void 0)}}var a=e(42994),c=e(72724),o=e(47232),h=(fe=>(fe.Year="year",fe.Month="month",fe.Week="week",fe.Day="day",fe.Hour="hour",fe.Minute="minute",fe.Second="second",fe.Millisecond="millisecond",fe))(h||{});const g=["year","month","week","day","hour","minute","second","millisecond"],l={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60,second:1,millisecond:.001};function p(fe,Te){return fe===null?{text:""}:Math.abs(fe)<1e3?{text:se(fe,Te),suffix:" ns"}:Math.abs(fe)<1e6?q(fe/1e3,Te," \xB5s"):Math.abs(fe)<1e9?q(fe/1e6,Te," ms"):Math.abs(fe)<6e10?q(fe/1e9,Te," s"):Math.abs(fe)<36e11?q(fe/6e10,Te," min"):Math.abs(fe)<864e11?q(fe/36e11,Te," hour"):q(fe/864e11,Te," day")}function m(fe,Te){return fe===null?{text:""}:Math.abs(fe)<1e3?{text:se(fe,Te),suffix:" \xB5s"}:Math.abs(fe)<1e6?q(fe/1e3,Te," ms"):q(fe/1e6,Te," s")}function y(fe,Te,je){return fe===null?{text:""}:Math.abs(fe)<1e3?{text:se(fe,Te),suffix:" ms"}:Math.abs(fe)<6e4?q(fe/1e3,Te," s"):Math.abs(fe)<36e5?q(fe/6e4,Te," min"):Math.abs(fe)<864e5?q(fe/36e5,Te," hour"):Math.abs(fe)<31536e6?q(fe/864e5,Te," day"):q(fe/31536e6,Te," year")}function d(fe,Te){return fe===null?{text:""}:fe===0?{text:"0",suffix:" s"}:Math.abs(fe)<1e-6?q(fe*1e9,Te," ns"):Math.abs(fe)<.001?q(fe*1e6,Te," \xB5s"):Math.abs(fe)<1?q(fe*1e3,Te," ms"):Math.abs(fe)<60?{text:se(fe,Te),suffix:" s"}:Math.abs(fe)<3600?q(fe/60,Te," min"):Math.abs(fe)<86400?q(fe/3600,Te," hour"):Math.abs(fe)<604800?q(fe/86400,Te," day"):Math.abs(fe)<31536e3?q(fe/604800,Te," week"):q(fe/31556900,Te," year")}function v(fe,Te){return fe===null?{text:""}:Math.abs(fe)<60?{text:se(fe,Te),suffix:" min"}:Math.abs(fe)<1440?q(fe/60,Te," hour"):Math.abs(fe)<10080?q(fe/1440,Te," day"):Math.abs(fe)<604800?q(fe/10080,Te," week"):q(fe/525948,Te," year")}function u(fe,Te){return fe===null?{text:""}:Math.abs(fe)<24?{text:se(fe,Te),suffix:" hour"}:Math.abs(fe)<168?q(fe/24,Te," day"):Math.abs(fe)<8760?q(fe/168,Te," week"):q(fe/8760,Te," year")}function D(fe,Te){return fe===null?{text:""}:Math.abs(fe)<7?{text:se(fe,Te),suffix:" day"}:Math.abs(fe)<365?q(fe/7,Te," week"):q(fe/365,Te," year")}function P(fe,Te,je){if(fe===null)return{text:""};if(fe===0)return{text:"0",suffix:" "+je+"s"};if(fe<0){const Re=P(-fe,Te,je);return Re.suffix||(Re.suffix=""),Re.suffix+=" ago",Re}fe*=l[je]*1e3;const He=[];let Be=!1,Ne=0;Te!=null&&(Ne=Te);for(let Re=0;Re<g.length&&Ne>=0;Re++){const Se=l[g[Re]]*1e3,We=fe/Se;if(We>=1||Be){Be=!0;const Ke=Math.floor(We),Xe=g[Re]+(Ke!==1?"s":"");He.push(Ke+" "+Xe),fe=fe%Se,Ne--}}return{text:He.join(", ")}}function x(fe,Te){if(fe===null)return{text:""};if(fe<1e3)return{text:(0,o.yT)(fe).format("SSS\\m\\s")};if(fe<6e4){let Ne="ss\\s:SSS\\m\\s";return Te===0&&(Ne="ss\\s"),{text:(0,o.yT)(fe).format(Ne)}}if(fe<36e5){let Ne="mm\\m:ss\\s:SSS\\m\\s";return Te===0?Ne="mm\\m":Te===1&&(Ne="mm\\m:ss\\s"),{text:(0,o.yT)(fe).format(Ne)}}let je="mm\\m:ss\\s:SSS\\m\\s";const He=`${("0"+Math.floor((0,o.Ah)(fe,"milliseconds").asHours())).slice(-2)}h`;return Te===0?je="":Te===1?je="mm\\m":Te===2&&(je="mm\\m:ss\\s"),{text:je?`${He}:${(0,o.yT)(fe).format(je)}`:He}}function E(fe,Te){return P(fe,Te,"millisecond")}function C(fe,Te){return P(fe,Te,"second")}function M(fe){if(fe<0){const Ne=M(-fe);return Ne.suffix||(Ne.suffix=""),Ne.suffix+=" ago",Ne}const Te=[],je=Math.floor(fe/3600),He=Math.floor(fe%3600/60),Be=Math.floor(fe%3600%60);return je>9?Te.push(""+je):Te.push("0"+je),He>9?Te.push(""+He):Te.push("0"+He),Be>9?Te.push(""+Be):Te.push("0"+Be),{text:Te.join(":")}}function S(fe){if(fe<0){const Be=S(-fe);return Be.suffix||(Be.suffix=""),Be.suffix+=" ago",Be}let Te="";const je=Math.floor(fe/(24*3600));je>0&&(Te=je+" d ");const He=M(fe-je*24*3600);return{text:Te+He.text}}function I(fe,Te){return d(fe/100,Te)}function T(fe,Te){return x(fe,Te)}function b(fe,Te){return x(fe*1e3,Te)}function R(fe,Te){return(je,He,Be,Ne)=>Te&&(0,o.KQ)().isSame(je,"day")?{text:(0,c.LE)(je,{format:Te,timeZone:Ne})}:{text:(0,c.LE)(je,{format:fe,timeZone:Ne})}}const A=R("YYYY-MM-DD HH:mm:ss"),L=R("YYYY-MM-DD HH:mm:ss","HH:mm:ss"),U=R("MM/DD/YYYY h:mm:ss a"),W=R("MM/DD/YYYY h:mm:ss a","h:mm:ss a");function w(){return R((0,a.Od)({year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}))}function N(){return R((0,a.Od)({year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),(0,a.Od)({hour:"2-digit",minute:"2-digit",second:"2-digit"}))}function B(fe,Te,je,He,Be){return{text:(0,c.LE)(fe,{format:Be?a.WC.fullDateMS:a.WC.fullDate,timeZone:He})}}function V(fe,Te,je,He){return{text:(0,c.fq)(fe,{timeZone:He})}}var K=e(26517);const H=()=>[{name:"Misc",formats:[{name:"Number",id:"none",fn:oe("")},{name:"String",id:"string",fn:ce},{name:"short",id:"short",fn:ie(1e3,[""," K"," Mil"," Bil"," Tri"," Quadr"," Quint"," Sext"," Sept"])},{name:"SI short",id:"sishort",fn:(0,K.rT)("")},{name:"Percent (0-100)",id:"percent",fn:n},{name:"Percent (0.0-1.0)",id:"percentunit",fn:i},{name:"Humidity (%H)",id:"humidity",fn:oe("%H")},{name:"Decibel",id:"dB",fn:oe("dB")},{name:"Candela (cd)",id:"candela",fn:(0,K.rT)("cd")},{name:"Hexadecimal (0x)",id:"hex0x",fn:s},{name:"Hexadecimal",id:"hex",fn:r},{name:"Scientific notation",id:"sci",fn:f},{name:"Locale format",id:"locale",fn:ae},{name:"Pixels",id:"pixel",fn:oe("px")}]},{name:"Acceleration",formats:[{name:"Meters/sec\xB2",id:"accMS2",fn:oe("m/sec\xB2")},{name:"Feet/sec\xB2",id:"accFS2",fn:oe("f/sec\xB2")},{name:"G unit",id:"accG",fn:oe("g")}]},{name:"Angle",formats:[{name:"Degrees (\xB0)",id:"degree",fn:oe("\xB0")},{name:"Radians",id:"radian",fn:oe("rad")},{name:"Gradian",id:"grad",fn:oe("grad")},{name:"Arc Minutes",id:"arcmin",fn:oe("arcmin")},{name:"Arc Seconds",id:"arcsec",fn:oe("arcsec")}]},{name:"Area",formats:[{name:"Square Meters (m\xB2)",id:"areaM2",fn:oe("m\xB2")},{name:"Square Feet (ft\xB2)",id:"areaF2",fn:oe("ft\xB2")},{name:"Square Miles (mi\xB2)",id:"areaMI2",fn:oe("mi\xB2")},{name:"Acres (ac)",id:"acres",fn:oe("ac")},{name:"Hectares (ha)",id:"hectares",fn:oe("ha")}]},{name:"Computation",formats:[{name:"FLOP/s",id:"flops",fn:(0,K.rT)("FLOPS")},{name:"MFLOP/s",id:"mflops",fn:(0,K.rT)("FLOPS",2)},{name:"GFLOP/s",id:"gflops",fn:(0,K.rT)("FLOPS",3)},{name:"TFLOP/s",id:"tflops",fn:(0,K.rT)("FLOPS",4)},{name:"PFLOP/s",id:"pflops",fn:(0,K.rT)("FLOPS",5)},{name:"EFLOP/s",id:"eflops",fn:(0,K.rT)("FLOPS",6)},{name:"ZFLOP/s",id:"zflops",fn:(0,K.rT)("FLOPS",7)},{name:"YFLOP/s",id:"yflops",fn:(0,K.rT)("FLOPS",8)}]},{name:"Concentration",formats:[{name:"parts-per-million (ppm)",id:"ppm",fn:oe("ppm")},{name:"parts-per-billion (ppb)",id:"conppb",fn:oe("ppb")},{name:"nanogram per cubic meter (ng/m\xB3)",id:"conngm3",fn:oe("ng/m\xB3")},{name:"nanogram per normal cubic meter (ng/Nm\xB3)",id:"conngNm3",fn:oe("ng/Nm\xB3")},{name:"microgram per cubic meter (\u03BCg/m\xB3)",id:"con\u03BCgm3",fn:oe("\u03BCg/m\xB3")},{name:"microgram per normal cubic meter (\u03BCg/Nm\xB3)",id:"con\u03BCgNm3",fn:oe("\u03BCg/Nm\xB3")},{name:"milligram per cubic meter (mg/m\xB3)",id:"conmgm3",fn:oe("mg/m\xB3")},{name:"milligram per normal cubic meter (mg/Nm\xB3)",id:"conmgNm3",fn:oe("mg/Nm\xB3")},{name:"gram per cubic meter (g/m\xB3)",id:"congm3",fn:oe("g/m\xB3")},{name:"gram per normal cubic meter (g/Nm\xB3)",id:"congNm3",fn:oe("g/Nm\xB3")},{name:"milligrams per decilitre (mg/dL)",id:"conmgdL",fn:oe("mg/dL")},{name:"millimoles per litre (mmol/L)",id:"conmmolL",fn:oe("mmol/L")}]},{name:"Currency",formats:[{name:"Dollars ($)",id:"currencyUSD",fn:(0,K.Gl)("$")},{name:"Pounds (\xA3)",id:"currencyGBP",fn:(0,K.Gl)("\xA3")},{name:"Euro (\u20AC)",id:"currencyEUR",fn:(0,K.Gl)("\u20AC")},{name:"Yen (\xA5)",id:"currencyJPY",fn:(0,K.Gl)("\xA5")},{name:"Rubles (\u20BD)",id:"currencyRUB",fn:(0,K.Gl)("\u20BD")},{name:"Hryvnias (\u20B4)",id:"currencyUAH",fn:(0,K.Gl)("\u20B4")},{name:"Real (R$)",id:"currencyBRL",fn:(0,K.Gl)("R$")},{name:"Danish Krone (kr)",id:"currencyDKK",fn:(0,K.Gl)("kr",!0)},{name:"Icelandic Kr\xF3na (kr)",id:"currencyISK",fn:(0,K.Gl)("kr",!0)},{name:"Norwegian Krone (kr)",id:"currencyNOK",fn:(0,K.Gl)("kr",!0)},{name:"Swedish Krona (kr)",id:"currencySEK",fn:(0,K.Gl)("kr",!0)},{name:"Czech koruna (czk)",id:"currencyCZK",fn:(0,K.Gl)("czk")},{name:"Swiss franc (CHF)",id:"currencyCHF",fn:(0,K.Gl)("CHF")},{name:"Polish Z\u0142oty (PLN)",id:"currencyPLN",fn:(0,K.Gl)("PLN")},{name:"Bitcoin (\u0E3F)",id:"currencyBTC",fn:(0,K.Gl)("\u0E3F")},{name:"Milli Bitcoin (\u0E3F)",id:"currencymBTC",fn:(0,K.Gl)("mBTC")},{name:"Micro Bitcoin (\u0E3F)",id:"currency\u03BCBTC",fn:(0,K.Gl)("\u03BCBTC")},{name:"South African Rand (R)",id:"currencyZAR",fn:(0,K.Gl)("R")},{name:"Indian Rupee (\u20B9)",id:"currencyINR",fn:(0,K.Gl)("\u20B9")},{name:"South Korean Won (\u20A9)",id:"currencyKRW",fn:(0,K.Gl)("\u20A9")},{name:"Indonesian Rupiah (Rp)",id:"currencyIDR",fn:(0,K.Gl)("Rp")},{name:"Philippine Peso (PHP)",id:"currencyPHP",fn:(0,K.Gl)("PHP")},{name:"Vietnamese Dong (VND)",id:"currencyVND",fn:(0,K.Gl)("\u0111",!0)},{name:"Turkish Lira (\u20BA)",id:"currencyTRY",fn:(0,K.Gl)("\u20BA",!0)},{name:"Malaysian Ringgit (RM)",id:"currencyMYR",fn:(0,K.Gl)("RM")},{name:"CFP franc (XPF)",id:"currencyXPF",fn:(0,K.Gl)("XPF")},{name:"Bulgarian Lev (BGN)",id:"currencyBGN",fn:(0,K.Gl)("BGN")},{name:"Guaran\xED (\u20B2)",id:"currencyPYG",fn:(0,K.Gl)("\u20B2")},{name:"Uruguay Peso (UYU)",id:"currencyUYU",fn:(0,K.Gl)("UYU")}]},{name:"Data",formats:[{name:"bytes(IEC)",id:"bytes",fn:(0,K.yW)("B")},{name:"bytes(SI)",id:"decbytes",fn:(0,K.rT)("B")},{name:"bits(IEC)",id:"bits",fn:(0,K.yW)("b")},{name:"bits(SI)",id:"decbits",fn:(0,K.rT)("b")},{name:"kibibytes",id:"kbytes",fn:(0,K.yW)("B",1)},{name:"kilobytes",id:"deckbytes",fn:(0,K.rT)("B",1)},{name:"mebibytes",id:"mbytes",fn:(0,K.yW)("B",2)},{name:"megabytes",id:"decmbytes",fn:(0,K.rT)("B",2)},{name:"gibibytes",id:"gbytes",fn:(0,K.yW)("B",3)},{name:"gigabytes",id:"decgbytes",fn:(0,K.rT)("B",3)},{name:"tebibytes",id:"tbytes",fn:(0,K.yW)("B",4)},{name:"terabytes",id:"dectbytes",fn:(0,K.rT)("B",4)},{name:"pebibytes",id:"pbytes",fn:(0,K.yW)("B",5)},{name:"petabytes",id:"decpbytes",fn:(0,K.rT)("B",5)}]},{name:"Data rate",formats:[{name:"packets/sec",id:"pps",fn:(0,K.rT)("p/s")},{name:"bytes/sec(IEC)",id:"binBps",fn:(0,K.yW)("B/s")},{name:"bytes/sec(SI)",id:"Bps",fn:(0,K.rT)("B/s")},{name:"bits/sec(IEC)",id:"binbps",fn:(0,K.yW)("b/s")},{name:"bits/sec(SI)",id:"bps",fn:(0,K.rT)("b/s")},{name:"kibibytes/sec",id:"KiBs",fn:(0,K.yW)("B/s",1)},{name:"kibibits/sec",id:"Kibits",fn:(0,K.yW)("b/s",1)},{name:"kilobytes/sec",id:"KBs",fn:(0,K.rT)("B/s",1)},{name:"kilobits/sec",id:"Kbits",fn:(0,K.rT)("b/s",1)},{name:"mebibytes/sec",id:"MiBs",fn:(0,K.yW)("B/s",2)},{name:"mebibits/sec",id:"Mibits",fn:(0,K.yW)("b/s",2)},{name:"megabytes/sec",id:"MBs",fn:(0,K.rT)("B/s",2)},{name:"megabits/sec",id:"Mbits",fn:(0,K.rT)("b/s",2)},{name:"gibibytes/sec",id:"GiBs",fn:(0,K.yW)("B/s",3)},{name:"gibibits/sec",id:"Gibits",fn:(0,K.yW)("b/s",3)},{name:"gigabytes/sec",id:"GBs",fn:(0,K.rT)("B/s",3)},{name:"gigabits/sec",id:"Gbits",fn:(0,K.rT)("b/s",3)},{name:"tebibytes/sec",id:"TiBs",fn:(0,K.yW)("B/s",4)},{name:"tebibits/sec",id:"Tibits",fn:(0,K.yW)("b/s",4)},{name:"terabytes/sec",id:"TBs",fn:(0,K.rT)("B/s",4)},{name:"terabits/sec",id:"Tbits",fn:(0,K.rT)("b/s",4)},{name:"pebibytes/sec",id:"PiBs",fn:(0,K.yW)("B/s",5)},{name:"pebibits/sec",id:"Pibits",fn:(0,K.yW)("b/s",5)},{name:"petabytes/sec",id:"PBs",fn:(0,K.rT)("B/s",5)},{name:"petabits/sec",id:"Pbits",fn:(0,K.rT)("b/s",5)}]},{name:"Date & time",formats:[{name:"Datetime ISO",id:"dateTimeAsIso",fn:A},{name:"Datetime ISO (No date if today)",id:"dateTimeAsIsoNoDateIfToday",fn:L},{name:"Datetime US",id:"dateTimeAsUS",fn:U},{name:"Datetime US (No date if today)",id:"dateTimeAsUSNoDateIfToday",fn:W},{name:"Datetime local",id:"dateTimeAsLocal",fn:w()},{name:"Datetime local (No date if today)",id:"dateTimeAsLocalNoDateIfToday",fn:N()},{name:"Datetime default",id:"dateTimeAsSystem",fn:B},{name:"From Now",id:"dateTimeFromNow",fn:V}]},{name:"Energy",formats:[{name:"Watt (W)",id:"watt",fn:(0,K.rT)("W")},{name:"Kilowatt (kW)",id:"kwatt",fn:(0,K.rT)("W",1)},{name:"Megawatt (MW)",id:"megwatt",fn:(0,K.rT)("W",2)},{name:"Gigawatt (GW)",id:"gwatt",fn:(0,K.rT)("W",3)},{name:"Milliwatt (mW)",id:"mwatt",fn:(0,K.rT)("W",-1)},{name:"Watt per square meter (W/m\xB2)",id:"Wm2",fn:oe("W/m\xB2")},{name:"Volt-Ampere (VA)",id:"voltamp",fn:(0,K.rT)("VA")},{name:"Kilovolt-Ampere (kVA)",id:"kvoltamp",fn:(0,K.rT)("VA",1)},{name:"Volt-Ampere reactive (VAr)",id:"voltampreact",fn:(0,K.rT)("VAr")},{name:"Kilovolt-Ampere reactive (kVAr)",id:"kvoltampreact",fn:(0,K.rT)("VAr",1)},{name:"Watt-hour (Wh)",id:"watth",fn:(0,K.rT)("Wh")},{name:"Watt-hour per Kilogram (Wh/kg)",id:"watthperkg",fn:(0,K.rT)("Wh/kg")},{name:"Kilowatt-hour (kWh)",id:"kwatth",fn:(0,K.rT)("Wh",1)},{name:"Kilowatt-min (kWm)",id:"kwattm",fn:(0,K.rT)("W-Min",1)},{name:"Megawatt-hour (MWh)",id:"mwatth",fn:(0,K.rT)("Wh",2)},{name:"Ampere-hour (Ah)",id:"amph",fn:(0,K.rT)("Ah")},{name:"Kiloampere-hour (kAh)",id:"kamph",fn:(0,K.rT)("Ah",1)},{name:"Milliampere-hour (mAh)",id:"mamph",fn:(0,K.rT)("Ah",-1)},{name:"Joule (J)",id:"joule",fn:(0,K.rT)("J")},{name:"Electron volt (eV)",id:"ev",fn:(0,K.rT)("eV")},{name:"Ampere (A)",id:"amp",fn:(0,K.rT)("A")},{name:"Kiloampere (kA)",id:"kamp",fn:(0,K.rT)("A",1)},{name:"Milliampere (mA)",id:"mamp",fn:(0,K.rT)("A",-1)},{name:"Volt (V)",id:"volt",fn:(0,K.rT)("V")},{name:"Kilovolt (kV)",id:"kvolt",fn:(0,K.rT)("V",1)},{name:"Millivolt (mV)",id:"mvolt",fn:(0,K.rT)("V",-1)},{name:"Decibel-milliwatt (dBm)",id:"dBm",fn:(0,K.rT)("dBm")},{name:"Milliohm (m\u03A9)",id:"mohm",fn:(0,K.rT)("\u03A9",-1)},{name:"Ohm (\u03A9)",id:"ohm",fn:(0,K.rT)("\u03A9")},{name:"Kiloohm (k\u03A9)",id:"kohm",fn:(0,K.rT)("\u03A9",1)},{name:"Megaohm (M\u03A9)",id:"Mohm",fn:(0,K.rT)("\u03A9",2)},{name:"Farad (F)",id:"farad",fn:(0,K.rT)("F")},{name:"Microfarad (\xB5F)",id:"\xB5farad",fn:(0,K.rT)("F",-2)},{name:"Nanofarad (nF)",id:"nfarad",fn:(0,K.rT)("F",-3)},{name:"Picofarad (pF)",id:"pfarad",fn:(0,K.rT)("F",-4)},{name:"Femtofarad (fF)",id:"ffarad",fn:(0,K.rT)("F",-5)},{name:"Henry (H)",id:"henry",fn:(0,K.rT)("H")},{name:"Millihenry (mH)",id:"mhenry",fn:(0,K.rT)("H",-1)},{name:"Microhenry (\xB5H)",id:"\xB5henry",fn:(0,K.rT)("H",-2)},{name:"Lumens (Lm)",id:"lumens",fn:(0,K.rT)("Lm")}]},{name:"Flow",formats:[{name:"Gallons/min (gpm)",id:"flowgpm",fn:oe("gpm")},{name:"Cubic meters/sec (cms)",id:"flowcms",fn:oe("cms")},{name:"Cubic feet/sec (cfs)",id:"flowcfs",fn:oe("cfs")},{name:"Cubic feet/min (cfm)",id:"flowcfm",fn:oe("cfm")},{name:"Litre/hour",id:"litreh",fn:oe("L/h")},{name:"Litre/min (L/min)",id:"flowlpm",fn:oe("L/min")},{name:"milliLitre/min (mL/min)",id:"flowmlpm",fn:oe("mL/min")},{name:"Lux (lx)",id:"lux",fn:oe("lux")}]},{name:"Force",formats:[{name:"Newton-meters (Nm)",id:"forceNm",fn:(0,K.rT)("Nm")},{name:"Kilonewton-meters (kNm)",id:"forcekNm",fn:(0,K.rT)("Nm",1)},{name:"Newtons (N)",id:"forceN",fn:(0,K.rT)("N")},{name:"Kilonewtons (kN)",id:"forcekN",fn:(0,K.rT)("N",1)}]},{name:"Hash rate",formats:[{name:"hashes/sec",id:"Hs",fn:(0,K.rT)("H/s")},{name:"kilohashes/sec",id:"KHs",fn:(0,K.rT)("H/s",1)},{name:"megahashes/sec",id:"MHs",fn:(0,K.rT)("H/s",2)},{name:"gigahashes/sec",id:"GHs",fn:(0,K.rT)("H/s",3)},{name:"terahashes/sec",id:"THs",fn:(0,K.rT)("H/s",4)},{name:"petahashes/sec",id:"PHs",fn:(0,K.rT)("H/s",5)},{name:"exahashes/sec",id:"EHs",fn:(0,K.rT)("H/s",6)}]},{name:"Mass",formats:[{name:"milligram (mg)",id:"massmg",fn:(0,K.rT)("g",-1)},{name:"gram (g)",id:"massg",fn:(0,K.rT)("g")},{name:"pound (lb)",id:"masslb",fn:oe("lb")},{name:"kilogram (kg)",id:"masskg",fn:(0,K.rT)("g",1)},{name:"metric ton (t)",id:"masst",fn:oe("t")}]},{name:"Length",formats:[{name:"millimeter (mm)",id:"lengthmm",fn:(0,K.rT)("m",-1)},{name:"inch (in)",id:"lengthin",fn:oe("in")},{name:"feet (ft)",id:"lengthft",fn:oe("ft")},{name:"meter (m)",id:"lengthm",fn:(0,K.rT)("m")},{name:"kilometer (km)",id:"lengthkm",fn:(0,K.rT)("m",1)},{name:"mile (mi)",id:"lengthmi",fn:oe("mi")}]},{name:"Pressure",formats:[{name:"Millibars",id:"pressurembar",fn:(0,K.rT)("bar",-1)},{name:"Bars",id:"pressurebar",fn:(0,K.rT)("bar")},{name:"Kilobars",id:"pressurekbar",fn:(0,K.rT)("bar",1)},{name:"Pascals",id:"pressurepa",fn:(0,K.rT)("Pa")},{name:"Hectopascals",id:"pressurehpa",fn:oe("hPa")},{name:"Kilopascals",id:"pressurekpa",fn:oe("kPa")},{name:"Inches of mercury",id:"pressurehg",fn:oe('"Hg')},{name:"PSI",id:"pressurepsi",fn:ie(1e3,["psi","ksi","Mpsi"])}]},{name:"Radiation",formats:[{name:"Becquerel (Bq)",id:"radbq",fn:(0,K.rT)("Bq")},{name:"curie (Ci)",id:"radci",fn:(0,K.rT)("Ci")},{name:"Gray (Gy)",id:"radgy",fn:(0,K.rT)("Gy")},{name:"rad",id:"radrad",fn:(0,K.rT)("rad")},{name:"Sievert (Sv)",id:"radsv",fn:(0,K.rT)("Sv")},{name:"milliSievert (mSv)",id:"radmsv",fn:(0,K.rT)("Sv",-1)},{name:"microSievert (\xB5Sv)",id:"radusv",fn:(0,K.rT)("Sv",-2)},{name:"rem",id:"radrem",fn:(0,K.rT)("rem")},{name:"Exposure (C/kg)",id:"radexpckg",fn:(0,K.rT)("C/kg")},{name:"roentgen (R)",id:"radr",fn:(0,K.rT)("R")},{name:"Sievert/hour (Sv/h)",id:"radsvh",fn:(0,K.rT)("Sv/h")},{name:"milliSievert/hour (mSv/h)",id:"radmsvh",fn:(0,K.rT)("Sv/h",-1)},{name:"microSievert/hour (\xB5Sv/h)",id:"radusvh",fn:(0,K.rT)("Sv/h",-2)}]},{name:"Rotational Speed",formats:[{name:"Revolutions per minute (rpm)",id:"rotrpm",fn:oe("rpm")},{name:"Hertz (Hz)",id:"rothz",fn:(0,K.rT)("Hz")},{name:"Kilohertz (kHz)",id:"rotkhz",fn:(0,K.rT)("Hz",1)},{name:"Megahertz (MHz)",id:"rotmhz",fn:(0,K.rT)("Hz",2)},{name:"Gigahertz (GHz)",id:"rotghz",fn:(0,K.rT)("Hz",3)},{name:"Radians per second (rad/s)",id:"rotrads",fn:oe("rad/s")},{name:"Degrees per second (\xB0/s)",id:"rotdegs",fn:oe("\xB0/s")}]},{name:"Temperature",formats:[{name:"Celsius (\xB0C)",id:"celsius",fn:oe("\xB0C")},{name:"Fahrenheit (\xB0F)",id:"fahrenheit",fn:oe("\xB0F")},{name:"Kelvin (K)",id:"kelvin",fn:oe("K")}]},{name:"Time",formats:[{name:"Hertz (1/s)",id:"hertz",fn:(0,K.rT)("Hz")},{name:"nanoseconds (ns)",id:"ns",fn:p},{name:"microseconds (\xB5s)",id:"\xB5s",fn:m},{name:"milliseconds (ms)",id:"ms",fn:y},{name:"seconds (s)",id:"s",fn:d},{name:"minutes (m)",id:"m",fn:v},{name:"hours (h)",id:"h",fn:u},{name:"days (d)",id:"d",fn:D},{name:"duration (ms)",id:"dtdurationms",fn:E},{name:"duration (s)",id:"dtdurations",fn:C},{name:"duration (hh:mm:ss)",id:"dthms",fn:M},{name:"duration (d hh:mm:ss)",id:"dtdhms",fn:S},{name:"Timeticks (s/100)",id:"timeticks",fn:I},{name:"clock (ms)",id:"clockms",fn:T},{name:"clock (s)",id:"clocks",fn:b}]},{name:"Throughput",formats:[{name:"counts/sec (cps)",id:"cps",fn:re("c/s")},{name:"ops/sec (ops)",id:"ops",fn:re("ops/s")},{name:"requests/sec (rps)",id:"reqps",fn:re("req/s")},{name:"reads/sec (rps)",id:"rps",fn:re("rd/s")},{name:"writes/sec (wps)",id:"wps",fn:re("wr/s")},{name:"I/O ops/sec (iops)",id:"iops",fn:re("io/s")},{name:"events/sec (eps)",id:"eps",fn:re("evt/s")},{name:"messages/sec (mps)",id:"mps",fn:re("msg/s")},{name:"records/sec (rps)",id:"recps",fn:re("rec/s")},{name:"rows/sec (rps)",id:"rowsps",fn:re("rows/s")},{name:"counts/min (cpm)",id:"cpm",fn:re("c/m")},{name:"ops/min (opm)",id:"opm",fn:re("ops/m")},{name:"requests/min (rpm)",id:"reqpm",fn:re("req/m")},{name:"reads/min (rpm)",id:"rpm",fn:re("rd/m")},{name:"writes/min (wpm)",id:"wpm",fn:re("wr/m")},{name:"events/min (epm)",id:"epm",fn:re("evts/m")},{name:"messages/min (mpm)",id:"mpm",fn:re("msgs/m")},{name:"records/min (rpm)",id:"recpm",fn:re("rec/m")},{name:"rows/min (rpm)",id:"rowspm",fn:re("rows/m")}]},{name:"Velocity",formats:[{name:"meters/second (m/s)",id:"velocityms",fn:oe("m/s")},{name:"kilometers/hour (km/h)",id:"velocitykmh",fn:oe("km/h")},{name:"miles/hour (mph)",id:"velocitymph",fn:oe("mph")},{name:"knot (kn)",id:"velocityknot",fn:oe("kn")}]},{name:"Volume",formats:[{name:"millilitre (mL)",id:"mlitre",fn:(0,K.rT)("L",-1)},{name:"litre (L)",id:"litre",fn:(0,K.rT)("L")},{name:"cubic meter",id:"m3",fn:oe("m\xB3")},{name:"Normal cubic meter",id:"Nm3",fn:oe("Nm\xB3")},{name:"cubic decimeter",id:"dm3",fn:oe("dm\xB3")},{name:"gallons",id:"gallons",fn:oe("gal")}]},{name:"Boolean",formats:[{name:"True / False",id:"bool",fn:te("True","False")},{name:"Yes / No",id:"bool_yes_no",fn:te("Yes","No")},{name:"On / Off",id:"bool_on_off",fn:te("On","Off")}]}];function X(fe){return`${fe.prefix??""}${fe.text}${fe.suffix??""}`}let k=[];const Y={};let Z=!1;function se(fe,Te){if(fe===null)return"";if(fe===Number.NEGATIVE_INFINITY||fe===Number.POSITIVE_INFINITY)return fe.toLocaleString();if(Te==null&&(Te=j(fe)),fe===0)return fe.toFixed(Te);const je=Te?Math.pow(10,Math.max(0,Te)):1,He=String(Math.round(fe*je)/je);if(He.indexOf("e")!==-1||fe===0)return He;const Be=He.indexOf("."),Ne=Be===-1?0:He.length-Be-1;return Ne<Te?(Ne?He:He+".")+String(je).slice(1,Te-Ne+1):He}function j(fe){const Te=Math.abs(fe);let He=-Math.floor(Math.log(Te)/Math.LN10)+1;const Be=Math.pow(10,-He);return Te/Be>2.25&&++He,fe%1===0&&(He=0),Math.max(0,He)}function q(fe,Te,je){return{text:se(fe,Te),suffix:ne(je,Math.abs(fe)>1)}}function ne(fe,Te){if(!Te)return fe;switch(fe){case" min":case" hour":case" day":case" week":case" year":return`${fe}s`;default:return fe}}function oe(fe,Te){return(je,He)=>{if(je===null)return{text:""};const Be=se(je,He);return fe?Te?{text:Be,prefix:fe}:{text:Be,suffix:" "+fe}:{text:Be}}}function z(fe){return fe&&fe.startsWith("bool")}function te(fe,Te){return je=>({text:je?fe:Te})}const le=(fe,Te)=>Math.log10(Te)/Math.log10(fe);function ie(fe,Te,je=0){return(He,Be)=>{if(He==null)return{text:""};if(He===Number.NEGATIVE_INFINITY||He===Number.POSITIVE_INFINITY||isNaN(He))return{text:He.toLocaleString()};const Ne=He===0?0:Math.floor(le(fe,Math.abs(He))),Re=Te[(0,t.clamp)(je+Ne,0,Te.length-1)];return{text:se(He/fe**(0,t.clamp)(Ne,-je,Te.length-je-1),Be),suffix:Re}}}function ae(fe,Te){return fe==null?{text:""}:{text:fe.toLocaleString(void 0,{maximumFractionDigits:Te??void 0})}}function re(fe){const je=ie(1e3,["","K","M","B","T"]);return(He,Be,Ne)=>{if(He===null)return{text:""};const Re=je(He,Be,Ne);return Re.suffix+=" "+fe,Re}}function ce(fe){return{text:`${fe}`}}function me(){k=H();for(const fe of k)for(const Te of fe.formats)Y[Te.id]=Te.fn;[{from:"farenheit",to:"fahrenheit"}].forEach(fe=>{const Te=Y[fe.to];Te&&(Y[fe.from]=Te)}),Z=!0}function ee(fe){if(!fe)return oe("");Z||me();const Te=Y[fe];if(!Te&&fe){let je=fe.indexOf(":");if(je>0){const He=fe.substring(0,je),Be=fe.substring(je+1);if(He==="prefix")return oe(Be,!0);if(He==="suffix")return oe(Be,!1);if(He==="time")return R(Be);if(He==="si"){const Ne=(0,K.cL)(Be.charAt(0)),Re=Ne===0?Be:Be.substring(1);return(0,K.rT)(Re,Ne)}if(He==="count")return re(Be);if(He==="currency")return(0,K.Gl)(Be);if(He==="bool"){if(je=Be.indexOf("/"),je>=0){const Ne=Be.substring(0,je),Re=Be.substring(je+1);return te(Ne,Re)}return te(Be,"-")}}return oe(fe)}return Te}function de(){return Z||me(),Y}function De(){return Z||me(),k.map(fe=>({text:fe.name,submenu:fe.formats.map(Te=>({text:Te.name,value:Te.id}))}))}},36120:(G,O,e)=>{"use strict";e.d(O,{$:()=>n});var t=e(18008);class n extends t.F{constructor(s){return super(),this.buffer=s.buffer||[],this.capacity=this.buffer.length,this.tail=s.append!=="head",this.index=0,this.add=this.getAddFunction(),s.capacity&&this.setCapacity(s.capacity),new Proxy(this,{get(r,f,a){if(typeof f!="symbol"){const c=+f;if(String(c)===f)return r.get(c)}return Reflect.get(r,f,a)},set(r,f,a,c){if(typeof f!="symbol"){const o=+f;if(String(o)===f)return r.set(o,a),!0}return Reflect.set(r,f,a,c)}})}getAddFunction(){return this.capacity>this.buffer.length?this.tail?s=>{this.buffer.push(s),this.buffer.length>=this.capacity&&(this.add=this.getAddFunction())}:s=>{this.buffer.unshift(s),this.buffer.length>=this.capacity&&(this.add=this.getAddFunction())}:this.tail?s=>{this.buffer[this.index]=s,this.index=(this.index+1)%this.buffer.length}:s=>{let r=this.index-1;r<0&&(r=this.buffer.length-1),this.buffer[r]=s,this.index=r}}setCapacity(s){if(this.capacity===s)return;const r=this.toArray();if(s>this.length)this.buffer=r;else if(s<this.capacity){const f=this.length-s;this.tail?this.buffer=r.slice(f,r.length):this.buffer=r.slice(0,r.length-f)}this.capacity=s,this.index=0,this.add=this.getAddFunction()}setAppendMode(s){const r=s!=="head";r!==this.tail&&(this.buffer=this.toArray().reverse(),this.index=0,this.tail=r,this.add=this.getAddFunction())}reverse(){return this.buffer.reverse()}get(s){return this.buffer[(s+this.index)%this.buffer.length]}set(s,r){this.buffer[(s+this.index)%this.buffer.length]=r}get length(){return this.buffer.length}}},18008:(G,O,e)=>{"use strict";e.d(O,{E:()=>s,F:()=>n});var t;class n{constructor(){this[t]={}}static{t=Symbol.unscopables}*iterator(){for(let f=0;f<this.length;f++)yield this.get(f)}set(f,a){throw"unsupported operation"}add(f){throw"unsupported operation"}push(...f){for(const a of f)this.add(a);return this.length}[Symbol.iterator](){return this.iterator()}forEach(f){return s(this).forEach(f)}map(f){return s(this).map(f)}filter(f){return s(this).filter(f)}at(f){return this.get(f)}toArray(){const f=new Array(this.length);for(let a=0;a<this.length;a++)f[a]=this.get(a);return f}join(f){return this.toArray().join(f)}toJSON(){return this.toArray()}pop(){throw new Error("Method not implemented.")}concat(...f){throw new Error("Method not implemented.")}reverse(){throw new Error("Method not implemented.")}shift(){throw new Error("Method not implemented.")}sort(f){throw new Error("Method not implemented.")}splice(f,a,...c){throw new Error("Method not implemented.")}unshift(...f){throw new Error("Method not implemented.")}fill(f,a,c){throw new Error("Method not implemented.")}copyWithin(f,a,c){throw new Error("Method not implemented.")}slice(f,a){return this.toArray().slice(f,a)}indexOf(f,a){return this.toArray().indexOf(f,a)}lastIndexOf(f,a){return this.toArray().lastIndexOf(f,a)}every(f,a){return this.toArray().every(f,a)}some(f,a){return this.toArray().some(f,a)}reduce(f,a){throw new Error("Method not implemented.")}reduceRight(f,a){throw new Error("Method not implemented.")}find(f,a){return this.toArray().find(f,a)}findIndex(f,a){return this.toArray().findIndex(f,a)}entries(){return this.toArray().entries()}keys(){return this.toArray().keys()}values(){return this.toArray().values()}includes(f,a){return this.toArray().includes(f,a)}flatMap(f,a){return this.toArray().flatMap(f,a)}flat(f){throw new Error("Method not implemented.")}}const i=[];function s(r){return{*[Symbol.iterator](){for(let f=0;f<r.length;f++)yield r.get(f)},forEach(f){for(let a=0;a<r.length;a++)f(r.get(a),a,i)},map(f){const a=[];for(let c=0;c<r.length;c++)a.push(f(r.get(c),c,i));return a},filter(f){const a=[];let c=0;for(const o of this)f(o,c++,i)&&a.push(o);return a}}}},13390:(G,O,e)=>{"use strict";e.d(O,{X:()=>t});const t={RadioButton:{container:"data-testid radio-button"},Breadcrumbs:{breadcrumb:n=>`data-testid ${n} breadcrumb`},TimePicker:{openButton:"data-testid TimePicker Open Button",overlayContent:"data-testid TimePicker Overlay Content",fromField:"data-testid Time Range from field",toField:"data-testid Time Range to field",applyTimeRange:"data-testid TimePicker submit button",copyTimeRange:"data-testid TimePicker copy button",pasteTimeRange:"data-testid TimePicker paste button",calendar:{label:"data-testid Time Range calendar",openButton:"data-testid Open time range calendar",closeButton:"data-testid Close time range Calendar"},absoluteTimeRangeTitle:"data-testid-absolute-time-range-narrow"},DataSourcePermissions:{form:()=>'form[name="addPermission"]',roleType:"Role to add new permission to",rolePicker:"Built-in role picker",permissionLevel:"Permission Level"},DateTimePicker:{input:"data-testid date-time-input"},DataSource:{TestData:{QueryTab:{scenarioSelectContainer:"Test Data Query scenario select container",scenarioSelect:"Test Data Query scenario select",max:"TestData max",min:"TestData min",noise:"TestData noise",seriesCount:"TestData series count",spread:"TestData spread",startValue:"TestData start value",drop:"TestData drop values"}},DataSourceHttpSettings:{urlInput:"data-testid Datasource HTTP settings url"},Jaeger:{traceIDInput:"Trace ID"},Prometheus:{configPage:{connectionSettings:"Data source connection URL",manageAlerts:"prometheus-alerts-manager",scrapeInterval:"data-testid scrape interval",queryTimeout:"data-testid query timeout",defaultEditor:"data-testid default editor",disableMetricLookup:"disable-metric-lookup",prometheusType:"data-testid prometheus type",prometheusVersion:"data-testid prometheus version",cacheLevel:"data-testid cache level",incrementalQuerying:"prometheus-incremental-querying",queryOverlapWindow:"data-testid query overlap window",disableRecordingRules:"disable-recording-rules",customQueryParameters:"data-testid custom query parameters",httpMethod:"data-testid http method",exemplarsAddButton:"data-testid Add exemplar config button",internalLinkSwitch:"data-testid Internal link switch",codeModeMetricNamesSuggestionLimit:"data-testid code mode metric names suggestion limit"},queryEditor:{explain:"data-testid prometheus explain switch wrapper",editorToggle:"data-testid QueryEditorModeToggle",options:"data-testid prometheus options",legend:"data-testid prometheus legend wrapper",format:"data-testid prometheus format",step:"prometheus-step",type:"data-testid prometheus type",exemplars:"prometheus-exemplars",builder:{metricSelect:"data-testid metric select",hints:"data-testid prometheus hints",metricsExplorer:"data-testid metrics explorer",queryAdvisor:"data-testid query advisor"},code:{queryField:"data-testid prometheus query field",metricsCountInfo:"data-testid metrics count disclaimer",metricsBrowser:{openButton:"data-testid open metrics browser",selectMetric:"data-testid select a metric",metricList:"data-testid metric list",labelNamesFilter:"data-testid label names filter",labelValuesFilter:"data-testid label values filter",useQuery:"data-testid use query",useAsRateQuery:"data-testid use as rate query",validateSelector:"data-testid validate selector",clear:"data-testid clear"}}},exemplarMarker:"data-testid Exemplar marker",variableQueryEditor:{queryType:"data-testid query type",labelnames:{metricRegex:"data-testid label names metric regex"},labelValues:{labelSelect:"data-testid label values label select"},metricNames:{metricRegex:"data-testid metric names metric regex"},varQueryResult:"data-testid variable query result",seriesQuery:"data-testid prometheus series query",classicQuery:"data-testid prometheus classic query"},annotations:{minStep:"prometheus-annotation-min-step",title:"data-testid prometheus annotation title",tags:"data-testid prometheus annotation tags",text:"data-testid prometheus annotation text",seriesValueAsTimestamp:"data-testid prometheus annotation series value as timestamp"}}},Menu:{MenuComponent:n=>`${n} menu`,MenuGroup:n=>`${n} menu group`,MenuItem:n=>`${n} menu item`,SubMenu:{container:"data-testid SubMenu container",icon:"data-testid SubMenu icon"}},Panels:{Panel:{title:n=>`data-testid Panel header ${n}`,content:"data-testid panel content",headerItems:n=>`data-testid Panel header item ${n}`,menuItems:n=>`data-testid Panel menu item ${n}`,menu:n=>`data-testid Panel menu ${n}`,containerByTitle:n=>`${n} panel`,headerCornerInfo:n=>`Panel header ${n}`,status:n=>`data-testid Panel status ${n}`,loadingBar:()=>"Panel loading bar",HoverWidget:{container:"data-testid hover-header-container",dragIcon:"data-testid drag-icon"},PanelDataErrorMessage:"data-testid Panel data error message"},Visualization:{Graph:{container:"Graph container",VisualizationTab:{legendSection:"Legend section"},Legend:{legendItemAlias:n=>`gpl alias ${n}`,showLegendSwitch:"gpl show legend"},xAxis:{labels:()=>"div.flot-x-axis > div.flot-tick-label"}},BarGauge:{value:"Bar gauge value",valueV2:"data-testid Bar gauge value"},PieChart:{svgSlice:"data testid Pie Chart Slice"},Text:{container:()=>".markdown-html"},Table:{header:"table header",footer:"table-footer",body:"data-testid table body"}}},VizLegend:{seriesName:n=>`data-testid VizLegend series ${n}`},Drawer:{General:{title:n=>`Drawer title ${n}`,expand:"Drawer expand",contract:"Drawer contract",close:"data-testid Drawer close",rcContentWrapper:()=>".rc-drawer-content-wrapper",subtitle:"data-testid drawer subtitle"},DashboardSaveDrawer:{saveButton:"data-testid Save dashboard drawer button",saveAsButton:"data-testid Save as dashboard drawer button",saveAsTitleInput:"Save dashboard title field"}},PanelEditor:{General:{content:"data-testid Panel editor content"},OptionsPane:{content:"data-testid Panel editor option pane content",select:"Panel editor option pane select",fieldLabel:n=>`${n} field property editor`,fieldInput:n=>`data-testid Panel editor option pane field input ${n}`},DataPane:{content:"data-testid Panel editor data pane content"},applyButton:"data-testid Apply changes and go back to dashboard",toggleVizPicker:"data-testid toggle-viz-picker",toggleVizOptions:"data-testid toggle-viz-options",toggleTableView:"data-testid toggle-table-view",showZoomField:"Map controls Show zoom control field property editor",showAttributionField:"Map controls Show attribution field property editor",showScaleField:"Map controls Show scale field property editor",showMeasureField:"Map controls Show measure tools field property editor",showDebugField:"Map controls Show debug field property editor",measureButton:"show measure tools"},PanelInspector:{Data:{content:"Panel inspector Data content"},Stats:{content:"Panel inspector Stats content"},Json:{content:"data-testid Panel inspector Json content"},Query:{content:"Panel inspector Query content",refreshButton:"Panel inspector Query refresh button",jsonObjectKeys:()=>".json-formatter-key"}},Tab:{title:n=>`data-testid Tab ${n}`,active:()=>'[class*="-activeTabStyle"]'},RefreshPicker:{runButton:"RefreshPicker run button",intervalButton:"RefreshPicker interval button",runButtonV2:"data-testid RefreshPicker run button",intervalButtonV2:"data-testid RefreshPicker interval button"},QueryTab:{content:"Query editor tab content",queryInspectorButton:"Query inspector button",queryHistoryButton:"data-testid query-history-button",addQuery:"data-testid query-tab-add-query",queryGroupTopSection:"data-testid query group top section",addExpression:"data-testid query-tab-add-expression"},QueryHistory:{queryText:"Query text"},QueryEditorRows:{rows:"Query editor row"},QueryEditorRow:{actionButton:n=>`data-testid ${n}`,title:n=>`Query editor row title ${n}`,container:n=>`Query editor row ${n}`},AlertTab:{content:"data-testid Alert editor tab content"},AlertRules:{groupToggle:"data-testid group-collapse-toggle",toggle:"data-testid collapse-toggle",expandedContent:"data-testid expanded-content",previewButton:"data-testid alert-rule preview-button",ruleNameField:"data-testid alert-rule name-field",newFolderButton:"data-testid alert-rule new-folder-button",newFolderNameField:"data-testid alert-rule name-folder-name-field",newFolderNameCreateButton:"data-testid alert-rule name-folder-name-create-button",newEvaluationGroupButton:"data-testid alert-rule new-evaluation-group-button",newEvaluationGroupName:"data-testid alert-rule new-evaluation-group-name",newEvaluationGroupInterval:"data-testid alert-rule new-evaluation-group-interval",newEvaluationGroupCreate:"data-testid alert-rule new-evaluation-group-create-button"},Alert:{alert:n=>`Alert ${n}`,alertV2:n=>`data-testid Alert ${n}`},TransformTab:{content:"data-testid Transform editor tab content",newTransform:n=>`data-testid New transform ${n}`,transformationEditor:n=>`data-testid Transformation editor ${n}`,transformationEditorDebugger:n=>`data-testid Transformation editor debugger ${n}`},Transforms:{card:n=>`data-testid New transform ${n}`,disableTransformationButton:"data-testid Disable transformation button",Reduce:{modeLabel:"data-testid Transform mode label",calculationsLabel:"data-testid Transform calculations label"},SpatialOperations:{actionLabel:"root Action field property editor",locationLabel:"root Location Mode field property editor",location:{autoOption:"Auto location option",coords:{option:"Coords location option",latitudeFieldLabel:"root Latitude field field property editor",longitudeFieldLabel:"root Longitude field field property editor"},geohash:{option:"Geohash location option",geohashFieldLabel:"root Geohash field field property editor"},lookup:{option:"Lookup location option",lookupFieldLabel:"root Lookup field field property editor",gazetteerFieldLabel:"root Gazetteer field property editor"}}},searchInput:"data-testid search transformations",noTransformationsMessage:"data-testid no transformations message",addTransformationButton:"data-testid add transformation button",removeAllTransformationsButton:"data-testid remove all transformations button"},NavBar:{Configuration:{button:"Configuration"},Toggle:{button:"data-testid Toggle menu"},Reporting:{button:"Reporting"}},NavMenu:{Menu:"data-testid navigation mega-menu",item:"data-testid Nav menu item"},NavToolbar:{container:"data-testid Nav toolbar",shareDashboard:"data-testid Share dashboard",markAsFavorite:"data-testid Mark as favorite",editDashboard:{editButton:"data-testid Edit dashboard button",saveButton:"data-testid Save dashboard button",exitButton:"data-testid Exit edit mode button",settingsButton:"data-testid Dashboard settings",addRowButton:"data-testid Add row button",addLibraryPanelButton:"data-testid Add a panel from the panel library button",addVisualizationButton:"data-testid Add new visualization menu item",pastePanelButton:"data-testid Paste panel button",discardChangesButton:"data-testid Discard changes button",discardLibraryPanelButton:"data-testid Discard library panel button",unlinkLibraryPanelButton:"data-testid Unlink library panel button",saveLibraryPanelButton:"data-testid Save library panel button",backToDashboardButton:"data-testid Back to dashboard button"}},PageToolbar:{container:()=>".page-toolbar",item:n=>`${n}`,itemButton:n=>`data-testid ${n}`},QueryEditorToolbarItem:{button:n=>`QueryEditor toolbar item button ${n}`},BackButton:{backArrow:"data-testid Go Back"},OptionsGroup:{group:n=>n?`data-testid Options group ${n}`:"data-testid Options group",toggle:n=>n?`data-testid Options group ${n} toggle`:"data-testid Options group toggle"},PluginVisualization:{item:n=>`Plugin visualization item ${n}`,current:()=>'[class*="-currentVisualizationItem"]'},Select:{option:"data-testid Select option",input:()=>'input[id*="time-options-input"]',singleValue:()=>'div[class*="-singleValue"]'},FieldConfigEditor:{content:"Field config editor content"},OverridesConfigEditor:{content:"Field overrides editor content"},FolderPicker:{container:"Folder picker select container",containerV2:"data-testid Folder picker select container",input:"data-testid folder-picker-input"},ReadonlyFolderPicker:{container:"data-testid Readonly folder picker select container"},DataSourcePicker:{container:"data-testid Data source picker select container",input:()=>'input[id="data-source-picker"]',inputV2:"data-testid Select a data source",dataSourceList:"data-testid Data source list dropdown",advancedModal:{dataSourceList:"data-testid Data source list",builtInDataSourceList:"data-testid Built in data source list"}},TimeZonePicker:{container:"Time zone picker select container",containerV2:"data-testid Time zone picker select container",changeTimeSettingsButton:"data-testid Time zone picker Change time settings button"},WeekStartPicker:{container:"Choose starting day of the week",containerV2:"data-testid Choose starting day of the week",placeholder:"Choose starting day of the week"},TraceViewer:{spanBar:"data-testid SpanBar--wrapper"},QueryField:{container:"data-testid Query field"},QueryBuilder:{queryPatterns:"data-testid Query patterns",labelSelect:"data-testid Select label",inputSelect:"data-testid Select label-input",valueSelect:"data-testid Select value",matchOperatorSelect:"data-testid Select match operator"},ValuePicker:{button:n=>`data-testid Value picker button ${n}`,select:n=>`data-testid Value picker select ${n}`},Search:{section:"Search section",sectionV2:"data-testid Search section",items:"Search items",itemsV2:"data-testid Search items",cards:"data-testid Search cards",collapseFolder:n=>`data-testid Collapse folder ${n}`,expandFolder:n=>`data-testid Expand folder ${n}`,dashboardItem:n=>`${t.Search.dashboardItems} ${n}`,dashboardCard:n=>`data-testid Search card ${n}`,folderHeader:n=>`data-testid Folder header ${n}`,folderContent:n=>`data-testid Folder content ${n}`,dashboardItems:"data-testid Dashboard search item"},DashboardLinks:{container:"data-testid Dashboard link container",dropDown:"data-testid Dashboard link dropdown",link:"data-testid Dashboard link"},LoadingIndicator:{icon:"data-testid Loading indicator"},CallToActionCard:{button:n=>`Call to action button ${n}`,buttonV2:n=>`data-testid Call to action button ${n}`},DataLinksContextMenu:{singleLink:"data-testid Data link"},CodeEditor:{container:"data-testid Code editor container"},ReactMonacoEditor:{editorLazy:"data-testid ReactMonacoEditor editorLazy"},DashboardImportPage:{textarea:"data-testid-import-dashboard-textarea",submit:"data-testid-load-dashboard"},ImportDashboardForm:{name:"data-testid-import-dashboard-title",submit:"data-testid-import-dashboard-submit"},PanelAlertTabContent:{content:"data-testid Unified alert editor tab content"},VisualizationPreview:{card:n=>`data-testid suggestion-${n}`},ColorSwatch:{name:"data-testid-colorswatch"},DashboardRow:{title:n=>`data-testid dashboard-row-title-${n}`},UserProfile:{profileSaveButton:"data-testid-user-profile-save",preferencesSaveButton:"data-testid-shared-prefs-save",orgsTable:"data-testid-user-orgs-table",sessionsTable:"data-testid-user-sessions-table",extensionPointTabs:"data-testid-extension-point-tabs",extensionPointTab:n=>`data-testid-extension-point-tab-${n}`},FileUpload:{inputField:"data-testid-file-upload-input-field",fileNameSpan:"data-testid-file-upload-file-name"},DebugOverlay:{wrapper:"debug-overlay"},OrgRolePicker:{input:"Role"},AnalyticsToolbarButton:{button:"Dashboard insights"},Variables:{variableOption:"data-testid variable-option",variableLinkWrapper:"data-testid variable-link-wrapper"},Annotations:{annotationsTypeInput:"data-testid annotations-type-input",annotationsChoosePanelInput:"data-testid choose-panels-input",editor:{testButton:"data-testid annotations-test-button",resultContainer:"data-testid annotations-query-result-container"}},Tooltip:{container:"data-testid tooltip"},ReturnToPrevious:{buttonGroup:"data-testid dismissable button group",backButton:"data-testid back",dismissButton:"data-testid dismiss"},SQLQueryEditor:{selectColumn:"data-testid select-column",selectAggregation:"data-testid select-aggregation",selectAlias:"data-testid select-alias",filterConjunction:"data-testid filter-conjunction",filterField:"data-testid filter-field",filterOperator:"data-testid filter-operator",headerTableSelector:"data-testid header-table-selector",headerFilterSwitch:"data-testid header-filter-switch",headerGroupSwitch:"data-testid header-group-switch",headerOrderSwitch:"data-testid header-order-switch",headerPreviewSwitch:"data-testid header-preview-switch"},EntityNotFound:{container:"data-testid entity-not-found"}}},13544:(G,O,e)=>{"use strict";e.d(O,{Tp:()=>i});var t=e(13390);const i={pages:{Login:{url:"/login",username:"data-testid Username input field",password:"data-testid Password input field",submit:"data-testid Login button",skip:"data-testid Skip change password button"},Home:{url:"/"},DataSource:{name:"data-testid Data source settings page name input field",delete:"Data source settings page Delete button",readOnly:"data-testid Data source settings page read only message",saveAndTest:"data-testid Data source settings page Save and Test button",alert:"data-testid Data source settings page Alert"},DataSources:{url:"/datasources",dataSources:s=>`Data source list item ${s}`},EditDataSource:{url:s=>`/datasources/edit/${s}`,settings:"Datasource settings page basic settings"},AddDataSource:{url:"/datasources/new",dataSourcePlugins:s=>`Data source plugin item ${s}`,dataSourcePluginsV2:s=>`Add new data source ${s}`},ConfirmModal:{delete:"data-testid Confirm Modal Danger Button"},AddDashboard:{url:"/dashboard/new",itemButton:s=>`data-testid ${s}`,addNewPanel:"data-testid Add new panel",addNewRow:"data-testid Add new row",addNewPanelLibrary:"data-testid Add new panel from panel library"},Dashboard:{url:s=>`/d/${s}`,DashNav:{nav:"Dashboard navigation",navV2:"data-testid Dashboard navigation",publicDashboardTag:"data-testid public dashboard tag",shareButton:"data-testid share-button",scrollContainer:"data-testid Dashboard canvas scroll container",newShareButton:{container:"data-testid new share button",shareLink:"data-testid new share link-button",arrowMenu:"data-testid new share button arrow menu",menu:{container:"data-testid new share button menu",shareInternally:"data-testid new share button share internally",shareExternally:"data-testid new share button share externally",shareSnapshot:"data-testid new share button share snapshot"}},NewExportButton:{container:"data-testid new export button",arrowMenu:"data-testid new export button arrow menu",Menu:{container:"data-testid new export button menu",exportAsJson:"data-testid new export button export as json"}},playlistControls:{prev:"data-testid playlist previous dashboard button",stop:"data-testid playlist stop dashboard button",next:"data-testid playlist next dashboard button"}},Controls:"data-testid dashboard controls",SubMenu:{submenu:"Dashboard submenu",submenuItem:"data-testid template variable",submenuItemLabels:s=>`data-testid Dashboard template variables submenu Label ${s}`,submenuItemValueDropDownValueLinkTexts:s=>`data-testid Dashboard template variables Variable Value DropDown value link text ${s}`,submenuItemValueDropDownDropDown:"Variable options",submenuItemValueDropDownOptionTexts:s=>`data-testid Dashboard template variables Variable Value DropDown option text ${s}`,Annotations:{annotationsWrapper:"data-testid annotation-wrapper",annotationLabel:s=>`data-testid Dashboard annotations submenu Label ${s}`,annotationToggle:s=>`data-testid Dashboard annotations submenu Toggle ${s}`}},Settings:{Actions:{close:"data-testid dashboard-settings-close"},General:{deleteDashBoard:"data-testid Dashboard settings page delete dashboard button",sectionItems:s=>`Dashboard settings section item ${s}`,saveDashBoard:"Dashboard settings aside actions Save button",saveAsDashBoard:"Dashboard settings aside actions Save As button",timezone:"Time zone picker select container",title:"General"},Annotations:{List:{addAnnotationCTA:t.X.CallToActionCard.button("Add annotation query"),addAnnotationCTAV2:t.X.CallToActionCard.buttonV2("Add annotation query"),annotations:"data-testid list-annotations"},Settings:{name:"data-testid Annotations settings name input"},NewAnnotation:{panelFilterSelect:"data-testid annotations-panel-filter",showInLabel:"data-testid show-in-label",previewInDashboard:"data-testid annotations-preview",delete:"data-testid annotations-delete",apply:"data-testid annotations-apply",enable:"data-testid annotation-enable",hide:"data-testid annotation-hide"}},Variables:{List:{addVariableCTA:t.X.CallToActionCard.button("Add variable"),addVariableCTAV2:t.X.CallToActionCard.buttonV2("Add variable"),newButton:"Variable editor New variable button",table:"Variable editor Table",tableRowNameFields:s=>`Variable editor Table Name field ${s}`,tableRowDefinitionFields:s=>`Variable editor Table Definition field ${s}`,tableRowArrowUpButtons:s=>`Variable editor Table ArrowUp button ${s}`,tableRowArrowDownButtons:s=>`Variable editor Table ArrowDown button ${s}`,tableRowDuplicateButtons:s=>`Variable editor Table Duplicate button ${s}`,tableRowRemoveButtons:s=>`Variable editor Table Remove button ${s}`},Edit:{General:{headerLink:"Variable editor Header link",modeLabelNew:"Variable editor Header mode New",modeLabelEdit:"Variable editor Header mode Edit",generalNameInput:"Variable editor Form Name field",generalNameInputV2:"data-testid Variable editor Form Name field",generalTypeSelect:"Variable editor Form Type select",generalTypeSelectV2:"data-testid Variable editor Form Type select",generalLabelInput:"Variable editor Form Label field",generalLabelInputV2:"data-testid Variable editor Form Label field",generalHideSelect:"Variable editor Form Hide select",generalHideSelectV2:"data-testid Variable editor Form Hide select",selectionOptionsMultiSwitch:"data-testid Variable editor Form Multi switch",selectionOptionsIncludeAllSwitch:"data-testid Variable editor Form IncludeAll switch",selectionOptionsCustomAllInput:"data-testid Variable editor Form IncludeAll field",previewOfValuesOption:"data-testid Variable editor Preview of Values option",submitButton:"data-testid Variable editor Run Query button",applyButton:"data-testid Variable editor Apply button"},QueryVariable:{queryOptionsDataSourceSelect:t.X.DataSourcePicker.inputV2,queryOptionsRefreshSelect:"Variable editor Form Query Refresh select",queryOptionsRefreshSelectV2:"data-testid Variable editor Form Query Refresh select",queryOptionsRegExInput:"Variable editor Form Query RegEx field",queryOptionsRegExInputV2:"data-testid Variable editor Form Query RegEx field",queryOptionsSortSelect:"Variable editor Form Query Sort select",queryOptionsSortSelectV2:"data-testid Variable editor Form Query Sort select",queryOptionsQueryInput:"data-testid Variable editor Form Default Variable Query Editor textarea",valueGroupsTagsEnabledSwitch:"Variable editor Form Query UseTags switch",valueGroupsTagsTagsQueryInput:"Variable editor Form Query TagsQuery field",valueGroupsTagsTagsValuesQueryInput:"Variable editor Form Query TagsValuesQuery field"},ConstantVariable:{constantOptionsQueryInput:"Variable editor Form Constant Query field",constantOptionsQueryInputV2:"data-testid Variable editor Form Constant Query field"},DatasourceVariable:{datasourceSelect:"data-testid datasource variable datasource type"},TextBoxVariable:{textBoxOptionsQueryInput:"Variable editor Form TextBox Query field",textBoxOptionsQueryInputV2:"data-testid Variable editor Form TextBox Query field"},CustomVariable:{customValueInput:"data-testid custom-variable-input"},IntervalVariable:{intervalsValueInput:"data-testid interval variable intervals input",autoEnabledCheckbox:"data-testid interval variable auto value checkbox",stepCountIntervalSelect:"data-testid interval variable step count input",minIntervalInput:"data-testid interval variable mininum interval input"},GroupByVariable:{dataSourceSelect:t.X.DataSourcePicker.inputV2,infoText:"data-testid group by variable info text",modeToggle:"data-testid group by variable mode toggle"},AdHocFiltersVariable:{datasourceSelect:t.X.DataSourcePicker.inputV2,infoText:"data-testid ad-hoc filters variable info text",modeToggle:"data-testid ad-hoc filters variable mode toggle"}}}},Annotations:{marker:"data-testid annotation-marker"},Rows:{Repeated:{ConfigSection:{warningMessage:"data-testid Repeated rows warning message"}}}},Dashboards:{url:"/dashboards",dashboards:s=>`Dashboard search item ${s}`},SaveDashboardAsModal:{newName:"Save dashboard title field",save:"Save dashboard button"},SaveDashboardModal:{save:"Dashboard settings Save Dashboard Modal Save button",saveVariables:"Dashboard settings Save Dashboard Modal Save variables checkbox",saveTimerange:"Dashboard settings Save Dashboard Modal Save timerange checkbox",saveRefresh:"Dashboard settings Save Dashboard Modal Save refresh checkbox"},SharePanelModal:{linkToRenderedImage:"Link to rendered image"},ShareDashboardModal:{PublicDashboard:{WillBePublicCheckbox:"data-testid public dashboard will be public checkbox",LimitedDSCheckbox:"data-testid public dashboard limited datasources checkbox",CostIncreaseCheckbox:"data-testid public dashboard cost may increase checkbox",PauseSwitch:"data-testid public dashboard pause switch",EnableAnnotationsSwitch:"data-testid public dashboard on off switch for annotations",CreateButton:"data-testid public dashboard create button",DeleteButton:"data-testid public dashboard delete button",CopyUrlInput:"data-testid public dashboard copy url input",CopyUrlButton:"data-testid public dashboard copy url button",SettingsDropdown:"data-testid public dashboard settings dropdown",TemplateVariablesWarningAlert:"data-testid public dashboard disabled template variables alert",UnsupportedDataSourcesWarningAlert:"data-testid public dashboard unsupported data sources alert",NoUpsertPermissionsWarningAlert:"data-testid public dashboard no upsert permissions alert",EnableTimeRangeSwitch:"data-testid public dashboard on off switch for time range",EmailSharingConfiguration:{Container:"data-testid email sharing config container",ShareType:"data-testid public dashboard share type",EmailSharingInput:"data-testid public dashboard email sharing input",EmailSharingInviteButton:"data-testid public dashboard email sharing invite button",EmailSharingList:"data-testid public dashboard email sharing list",DeleteEmail:"data-testid public dashboard delete email button",ReshareLink:"data-testid public dashboard reshare link button"}},SnapshotScene:{url:s=>`/dashboard/snapshot/${s}`,PublishSnapshot:"data-testid publish snapshot button",CopyUrlButton:"data-testid snapshot copy url button",CopyUrlInput:"data-testid snapshot copy url input"}},ShareDashboardDrawer:{ShareExternally:{container:"data-testid share externally drawer container",copyUrlButton:"data-testid share externally copy url button",shareTypeSelect:"data-testid share externally share type select"},ShareSnapshot:{container:"data-testid share snapshot drawer container"}},ExportDashboardDrawer:{ExportAsJson:{container:"data-testid export as Json drawer container",codeEditor:"data-testid export as Json code editor",exportExternallyToggle:"data-testid export externally toggle type select",saveToFileButton:"data-testid save to file button",copyToClipboardButton:"data-testid copy to clipboard button",cancelButton:"data-testid cancel button"}},PublicDashboard:{page:"public-dashboard-page",NotAvailable:{container:"public-dashboard-not-available",title:"public-dashboard-title",pausedDescription:"public-dashboard-paused-description"},footer:"public-dashboard-footer"},PublicDashboardScene:{loadingPage:"public-dashboard-scene-loading-page",page:"public-dashboard-scene-page",controls:"public-dashboard-controls"},RequestViewAccess:{form:"request-view-access-form",recipientInput:"request-view-access-recipient-input",submitButton:"request-view-access-submit-button"},PublicDashboardConfirmAccess:{submitButton:"data-testid confirm-access-submit-button"},Explore:{url:"/explore",General:{container:"data-testid Explore",graph:"Explore Graph",table:"Explore Table",scrollView:"data-testid explorer scroll view"},QueryHistory:{container:"data-testid QueryHistory"}},SoloPanel:{url:s=>`/d-solo/${s}`},PluginsList:{page:"Plugins list page",list:"Plugins list",listItem:"Plugins list item",signatureErrorNotice:"data-testid Unsigned plugins notice"},PluginPage:{page:"Plugin page",signatureInfo:"data-testid Plugin signature info",disabledInfo:"data-testid Plugin disabled info"},PlaylistForm:{name:"Playlist name",interval:"Playlist interval",itemDelete:"data-testid playlist-form-delete-item"},BrowseDashboards:{table:{body:"data-testid browse-dashboards-table",row:s=>`data-testid browse dashboards row ${s}`,checkbox:s=>`data-testid ${s} checkbox`},NewFolderForm:{form:"data-testid new folder form",nameInput:"data-testid new-folder-name-input",createButton:"data-testid new-folder-create-button"}},Search:{url:"/?search=openn",FolderView:{url:"/?search=open&layout=folders"}},PublicDashboards:{ListItem:{linkButton:"public-dashboard-link-button",configButton:"public-dashboard-configuration-button",trashcanButton:"public-dashboard-remove-button",pauseSwitch:"data-testid public dashboard pause switch"}},UserListPage:{tabs:{allUsers:"data-testid all-users-tab",orgUsers:"data-testid org-users-tab",anonUserDevices:"data-testid anon-user-devices-tab",publicDashboardsUsers:"data-testid public-dashboards-users-tab",users:"data-testid users-tab"},org:{url:"/org/users"},admin:{url:"/admin/users"},publicDashboards:{container:"data-testid public-dashboards-users-list"},UserListAdminPage:{container:"data-testid user-list-admin-page"},UsersListPage:{container:"data-testid users-list-page"},UserAnonListPage:{container:"data-testid user-anon-list-page"},UsersListPublicDashboardsPage:{container:"data-testid users-list-public-dashboards-page",DashboardsListModal:{listItem:s=>`data-testid dashboards-list-item-${s}`}}},ProfilePage:{url:"/profile"}},components:t.X}},85194:(G,O,e)=>{"use strict";e.d(O,{A:()=>Nn});var t=e(74848),n=e(32196),i=e(53076),s=e(96540),r=e(49185),f=e(60578),a=e(14578);const c=22*window.devicePixelRatio,o=10*window.devicePixelRatio,h=.5*window.devicePixelRatio,g=20*window.devicePixelRatio,l=.5*window.devicePixelRatio,p=4*window.devicePixelRatio,m=3*window.devicePixelRatio,y=3*window.devicePixelRatio,d=4*window.devicePixelRatio,v=2*window.devicePixelRatio,u=800,D=120;var P=e(64539),x=e(59093),E=e(28122);const M=({data:St,itemData:nn,onMenuItemClick:ht,onItemFocus:lt,onSandwich:gt,collapseConfig:$t,onExpandGroup:et,onCollapseGroup:Et,onExpandAllGroups:It,onCollapseAllGroups:Qt,getExtraContextMenuButtons:sn,collapsing:ln,allGroupsExpanded:yn,allGroupsCollapsed:Sn,selectedView:En,search:wn})=>{function On(){const Rt=sn?.(nn,St.data,{selectedView:En,isDiff:St.isDiffFlamegraph(),search:wn,collapseConfig:$t})||[];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(P.D,{label:"Focus block",icon:"eye",onClick:()=>{lt(),ht()}}),(0,t.jsx)(P.D,{label:"Copy function name",icon:"copy",onClick:()=>{navigator.clipboard.writeText(nn.label).then(()=>{ht()})}}),(0,t.jsx)(P.D,{label:"Sandwich view",icon:"gf-show-context",onClick:()=>{gt(),ht()}}),Rt.map(({label:Ot,icon:jt,onClick:rt})=>(0,t.jsx)(P.D,{label:Ot,icon:jt,onClick:()=>rt()},Ot)),ln&&(0,t.jsxs)(x.r,{label:"Grouping",children:[$t?$t.collapsed?(0,t.jsx)(P.D,{label:"Expand group",icon:"angle-double-down",onClick:()=>{et(),ht()}}):(0,t.jsx)(P.D,{label:"Collapse group",icon:"angle-double-up",onClick:()=>{Et(),ht()}}):null,!yn&&(0,t.jsx)(P.D,{label:"Expand all groups",icon:"angle-double-down",onClick:()=>{It(),ht()}}),!Sn&&(0,t.jsx)(P.D,{label:"Collapse all groups",icon:"angle-double-up",onClick:()=>{Qt(),ht()}})]})]})}return(0,t.jsx)("div",{"data-testid":"contextMenu",children:(0,t.jsx)(E.t,{renderMenuItems:On,x:nn.posX+10,y:nn.posY,focusOnOpen:!1})})};var S=e(83195),I=e(40845),T=e(48840),b=e(17464),R=e(69503);const A=({data:St,item:nn,totalTicks:ht,position:lt,collapseConfig:gt})=>{const $t=(0,I.of)(w);if(!(nn&&lt))return null;let et;if(St.isDiffFlamegraph()){const Et=U(St,nn,ht);et=(0,t.jsx)(T.j,{className:$t.tooltipTable,columns:[{id:"label",header:""},{id:"baseline",header:"Baseline"},{id:"comparison",header:"Comparison"},{id:"diff",header:"Diff"}],data:Et,getRowId:It=>It.rowId})}else{const Et=L(St,nn,ht);et=(0,t.jsxs)("p",{className:$t.lastParagraph,children:[Et.unitTitle,(0,t.jsx)("br",{}),"Total: ",(0,t.jsx)("b",{children:Et.unitValue})," (",Et.percentValue,"%)",(0,t.jsx)("br",{}),"Self: ",(0,t.jsx)("b",{children:Et.unitSelf})," (",Et.percentSelf,"%)",(0,t.jsx)("br",{}),"Samples: ",(0,t.jsx)("b",{children:Et.samples})]})}return(0,t.jsx)(b.ZL,{children:(0,t.jsx)(R.o,{className:$t.tooltipContainer,position:lt,offset:{x:15,y:0},children:(0,t.jsxs)("div",{className:$t.tooltipContent,children:[(0,t.jsxs)("p",{className:$t.tooltipName,children:[St.getLabel(nn.itemIndexes[0]),gt&&gt.collapsed?(0,t.jsxs)("span",{children:[(0,t.jsx)("br",{}),"and ",gt.items.length," similar items"]}):""]}),et]})})})},L=(St,nn,ht)=>{const lt=St.valueDisplayProcessor(nn.value),gt=St.getSelfDisplay(nn.itemIndexes),$t=Math.round(1e4*(lt.numeric/ht))/100,et=Math.round(1e4*(gt.numeric/ht))/100;let Et=lt.text+lt.suffix,It=gt.text+gt.suffix;const Qt=St.getUnitTitle();return Qt==="Count"&&(lt.suffix||(Et=lt.text),gt.suffix||(It=gt.text)),{percentValue:$t,percentSelf:et,unitTitle:Qt,unitValue:Et,unitSelf:It,samples:lt.numeric.toLocaleString()}},U=(St,nn,ht)=>{const gt=St.getLevels()[0][0].valueRight,$t=ht-gt,et=nn.value-nn.valueRight,Et=Math.round(1e4*et/$t)/100,It=Math.round(1e4*nn.valueRight/gt)/100,Qt=(It-Et)/Et*100,sn=W(St,St.valueDisplayProcessor(et)),ln=W(St,St.valueDisplayProcessor(nn.valueRight)),yn=(0,S.j_)("short");return[{rowId:"1",label:"% of total",baseline:Et+"%",comparison:It+"%",diff:yn(Qt).text+"%"},{rowId:"2",label:"Value",baseline:sn,comparison:ln,diff:W(St,St.valueDisplayProcessor(nn.valueRight-et))},{rowId:"3",label:"Samples",baseline:yn(et).text,comparison:yn(nn.valueRight).text,diff:yn(nn.valueRight-et).text}]};function W(St,nn){let ht=nn.text+nn.suffix;return St.getUnitTitle()==="Count"&&(nn.suffix||(ht=nn.text)),ht}const w=St=>({tooltipContainer:(0,n.css)({title:"tooltipContainer",overflow:"hidden"}),tooltipContent:(0,n.css)({title:"tooltipContent",fontSize:St.typography.bodySmall.fontSize,width:"100%"}),tooltipName:(0,n.css)({title:"tooltipName",marginTop:0,wordBreak:"break-all"}),lastParagraph:(0,n.css)({title:"lastParagraph",marginBottom:0}),name:(0,n.css)({title:"name",marginBottom:"10px"}),tooltipTable:(0,n.css)({title:"tooltipTable",maxWidth:"400px"})}),N=A;var B=e(84140),V=e(5546),K=e(21313);function H(St,nn=0){let ht,lt,gt,$t,et,Et,It,Qt;for(ht=St.length&3,lt=St.length-ht,gt=nn,et=3432918353,Et=461845907,Qt=0;Qt<lt;)It=St.charCodeAt(Qt)&255|(St.charCodeAt(++Qt)&255)<<8|(St.charCodeAt(++Qt)&255)<<16|(St.charCodeAt(++Qt)&255)<<24,++Qt,It=(It&65535)*et+(((It>>>16)*et&65535)<<16)&4294967295,It=It<<15|It>>>17,It=(It&65535)*Et+(((It>>>16)*Et&65535)<<16)&4294967295,gt^=It,gt=gt<<13|gt>>>19,$t=(gt&65535)*5+(((gt>>>16)*5&65535)<<16)&4294967295,gt=($t&65535)+27492+((($t>>>16)+58964&65535)<<16);switch(It=0,ht){case 3:It^=(St.charCodeAt(Qt+2)&255)<<16;case 2:It^=(St.charCodeAt(Qt+1)&255)<<8;case 1:It^=St.charCodeAt(Qt)&255;default:It=(It&65535)*et+(((It>>>16)*et&65535)<<16)&4294967295,It=It<<15|It>>>17,It=(It&65535)*Et+(((It>>>16)*Et&65535)<<16)&4294967295,gt^=It}return gt^=St.length,gt^=gt>>>16,gt=(gt&65535)*2246822507+(((gt>>>16)*2246822507&65535)<<16)&4294967295,gt^=gt>>>13,gt=(gt&65535)*3266489909+(((gt>>>16)*3266489909&65535)<<16)&4294967295,gt^=gt>>>16,gt>>>0}const X=[(0,B.A)({h:24,s:69,l:60}),(0,B.A)({h:34,s:65,l:65}),(0,B.A)({h:194,s:52,l:61}),(0,B.A)({h:163,s:45,l:55}),(0,B.A)({h:211,s:48,l:60}),(0,B.A)({h:246,s:40,l:65}),(0,B.A)({h:305,s:63,l:79}),(0,B.A)({h:47,s:100,l:73}),(0,B.A)({r:183,g:219,b:171}),(0,B.A)({r:244,g:213,b:152}),(0,B.A)({r:78,g:146,b:249}),(0,B.A)({r:249,g:186,b:143}),(0,B.A)({r:242,g:145,b:145}),(0,B.A)({r:130,g:181,b:216}),(0,B.A)({r:229,g:168,b:226}),(0,B.A)({r:174,g:162,b:224}),(0,B.A)({r:154,g:196,b:138}),(0,B.A)({r:242,g:201,b:109}),(0,B.A)({r:101,g:197,b:219}),(0,B.A)({r:249,g:147,b:78}),(0,B.A)({r:234,g:100,b:96}),(0,B.A)({r:81,g:149,b:206}),(0,B.A)({r:214,g:131,b:206}),(0,B.A)({r:128,g:110,b:183})],k=j(1,100,0,1),Y=j(100,100,0,1),Z=`linear-gradient(90deg, ${k} 0%, ${Y} 100%)`,se=`linear-gradient(90deg, ${X[0]} 0%, ${X[2]} 30%, ${X[6]} 50%, ${X[7]} 70%, ${X[8]} 100%)`;function j(St,nn,ht,lt){const gt=Math.min(1,St/nn/(lt-ht)),$t=50-50*gt,et=65+7*gt;return(0,B.A)({h:$t,s:100,l:et})}function q(St,nn){const ht=ae(St),gt=H(ht||"",0)%X.length;let $t=X[gt].clone();return nn.isLight&&($t=$t.brighten(15)),$t}const ne=["rgb(0, 170, 0)","rgb(148, 142, 142)","rgb(200, 0, 0)"],oe=`linear-gradient(90deg, ${ne[0]} 0%, ${ne[1]} 50%, ${ne[2]} 100%)`,z=["rgb(26, 133, 255)","rgb(148, 142, 142)","rgb(220, 50, 32)"],te=`linear-gradient(90deg, ${z[0]} 0%, ${z[1]} 50%, ${z[2]} 100%)`;function le(St,nn,ht,lt,gt){const $t=gt===V.yU.Default?ne:z,et=(0,K.scaleLinear)().domain([-100,0,100]).range($t),Et=St-nn,It=ht-lt;if(lt===0||It===0){const Sn=et(0);return(0,B.A)(Sn)}const Qt=Math.round(1e4*Et/It)/100,ln=(Math.round(1e4*nn/lt)/100-Qt)/Qt*100,yn=et(ln);return(0,B.A)(yn)}const ie=[["phpspy",/^(?<packageName>([^\/]*\/)*)(?<filename>.*\.php+)(?<line_info>.*)$/],["pyspy",/^(?<packageName>([^\/]*\/)*)(?<filename>.*\.py+)(?<line_info>.*)$/],["rbspy",/^(?<packageName>([^\/]*\/)*)(?<filename>.*\.rb+)(?<line_info>.*)$/],["nodespy",/^(\.\/node_modules\/)?(?<packageName>[^/]*)(?<filename>.*\.?(jsx?|tsx?)?):(?<functionName>.*):(?<line_info>.*)$/],["gospy",/^(?<packageName>.*?\/.*?\.|.*?\.|.+)(?<functionName>.*)$/],["javaspy",/^(?<packageName>.+\/)(?<filename>.+\.)(?<functionName>.+)$/],["dotnetspy",/^(?<packageName>.+)\.(.+)\.(.+)\(.*\)$/],["tracing",/^(?<packageName>.+?):.*$/],["pyroscope-rs",/^(?<packageName>[^::]+)/],["ebpfspy",/^(?<packageName>.+)$/],["unknown",/^(?<packageName>.+)$/]];function ae(St){for(const[nn,ht]of ie){const lt=St.match(ht);if(lt)return lt.groups?.packageName||""}}function re(St){const{canvasRef:nn,data:ht,root:lt,depth:gt,direction:$t,wrapperWidth:et,rangeMin:Et,rangeMax:It,matchedLabels:Qt,textAlign:sn,totalViewTicks:ln,totalColorTicks:yn,totalTicksRight:Sn,colorScheme:En,focusedItemData:wn,collapsedMap:On}=St,Rt=De(nn,et,gt),Ot=(0,I.$j)(),jt=(0,s.useMemo)(()=>{const Mn=(0,B.A)(Ot.colors.background.secondary);return Ot.isLight?Mn.darken(10).toHexString():Mn.lighten(10).toHexString()},[Ot]),rt=de(yn,Sn,En,Ot,jt,Et,It,Qt,wn?wn.item.level:0),tn=ce(Rt,ht,rt,sn,On);(0,s.useEffect)(()=>{if(!Rt)return;Rt.clearRect(0,0,Rt.canvas.width,Rt.canvas.height);const Mn=new Path2D;ee(lt,$t,ht,ln,Et,It,et,On,(kn,Yn,Wn,Jn,Ls,fs,ys)=>{ys?Mn.rect(Yn,Wn,Jn,Ls):tn(kn,Yn,Wn,Jn,Ls,fs)}),Rt.fillStyle=jt,Rt.fill(Mn)},[Rt,ht,lt,et,Et,It,ln,$t,tn,On,jt])}function ce(St,nn,ht,lt,gt){return(0,s.useMemo)(()=>St?(et,Et,It,Qt,sn,ln)=>{St.beginPath(),St.rect(Et+l,It,Qt,sn),St.fillStyle=ht(et,ln,!1),St.stroke(),St.fill();const yn=gt.get(et);let Sn=ln;yn&&yn.collapsed&&(Sn=`(${yn.items.length}) `+ln),Qt>=g&&(yn?(fe(St,nn,Sn,et,Qt,lt==="left"?Et+d+v:Et,It,lt),me(St,Et,It,sn,et,yn)):fe(St,nn,Sn,et,Qt,Et,It,lt))}:()=>{},[St,ht,lt,nn,gt])}function me(St,nn,ht,lt,gt,$t){const et=nn+d;St.beginPath(),St.rect(nn,ht,et-nn+m+y,lt),St.fill(),St.beginPath(),$t.collapsed?St.rect(et,ht+lt/4,m,lt/2):$t.items[0]===gt?St.rect(et,ht+lt/2,m,lt/2):$t.items[$t.items.length-1]===gt?St.rect(et,ht,m,lt/2):St.rect(et,ht,m,lt),St.fillStyle="#666",St.fill()}function ee(St,nn,ht,lt,gt,$t,et,Et,It){const Qt=[];Qt.push({item:St,levelOffset:0});const sn=et*window.devicePixelRatio/lt/($t-gt);let ln;for(;Qt.length>0;){const{item:yn,levelOffset:Sn}=Qt.shift();let En=yn.value;const wn=En*sn<=o,On=En*sn-(wn?0:l*2),Rt=c;if(On<h)continue;let Ot=0,jt=!1;const rt=Et.get(yn),tn=rt&&rt.collapsed;if(tn&&ln===rt.items[0]?(Ot=nn==="children"?-1:1,jt=!0):ln=void 0,!jt){const kn=Te(yn.start,lt,gt,sn),Yn=(yn.level+Sn)*c;let Wn=ht.getLabel(yn.itemIndexes[0]);tn&&(ln=yn),It(yn,kn,Yn,On,Rt,Wn,wn)}const Mn=nn==="children"?yn.children:yn.parents;Mn&&Qt.unshift(...Mn.map(kn=>({item:kn,levelOffset:Sn+Ot})))}}function de(St,nn,ht,lt,gt,$t,et,Et,It){return(0,s.useCallback)(function(sn,ln,yn){if(yn&&!Et)return gt;const Sn=sn.valueRight!==void 0&&(ht===V.yU.Default||ht===V.yU.DiffColorBlind)?le(sn.value,sn.valueRight,St,nn,ht):ht===V.zM.ValueBased?j(sn.value,St,$t,et):q(ln,lt);return Et?Et.has(ln)?Sn.toHslString():gt:sn.level>It-1?Sn.toHslString():Sn.lighten(15).toHslString()},[St,nn,ht,lt,$t,et,Et,It,gt])}function De(St,nn,ht){const[lt,gt]=(0,s.useState)();return(0,s.useEffect)(()=>{if(!(ht&&St.current))return;const $t=St.current.getContext("2d"),et=c*ht;St.current.width=Math.round(nn*window.devicePixelRatio),St.current.height=Math.round(et),St.current.style.width=`${nn}px`,St.current.style.height=`${et/window.devicePixelRatio}px`,$t.textBaseline="middle",$t.font=12*window.devicePixelRatio+"px monospace",$t.strokeStyle="white",gt($t)},[St,gt,nn,ht]),lt}function fe(St,nn,ht,lt,gt,$t,et,Et){St.save(),St.clip(),St.fillStyle="#222";const It=nn.valueDisplayProcessor(lt.value),Qt=It.suffix?It.text+It.suffix:It.text,sn=St.measureText(ht),ln=gt-p;let yn=`${ht} (${Qt})`,Sn=Math.max($t,0)+p;sn.width>ln&&(St.textAlign=Et,Et==="right"&&(yn=ht,Sn=$t+gt-p)),St.fillText(yn,Sn,et+c/2+2),St.restore()}function Te(St,nn,ht,lt){return(St-nn*ht)*lt}const je=({data:St,rangeMin:nn,rangeMax:ht,matchedLabels:lt,setRangeMin:gt,setRangeMax:$t,onItemFocused:et,focusedItemData:Et,textAlign:It,onSandwich:Qt,colorScheme:sn,totalProfileTicks:ln,totalProfileTicksRight:yn,totalViewTicks:Sn,root:En,direction:wn,depth:On,showFlameGraphOnly:Rt,collapsedMap:Ot,setCollapsedMap:jt,collapsing:rt,getExtraContextMenuButtons:tn,selectedView:Mn,search:kn})=>{const Yn=He(),[Wn,{width:Jn}]=(0,r.A)(),Ls=(0,s.useRef)(null),[fs,ys]=(0,s.useState)(),[Xn,Ps]=(0,s.useState)();re({canvasRef:Ls,colorScheme:sn,data:St,focusedItemData:Et,root:En,direction:wn,depth:On,rangeMax:ht,rangeMin:nn,matchedLabels:lt,textAlign:It,totalViewTicks:Sn,totalColorTicks:St.isDiffFlamegraph()?ln:Sn,totalTicksRight:yn,wrapperWidth:Jn,collapsedMap:Ot});const Zs=(0,s.useCallback)(pa=>{ys(void 0);const Ba=Ls.current.clientWidth/Sn/(ht-nn),_a=Be({x:pa.nativeEvent.offsetX,y:pa.nativeEvent.offsetY},En,wn,On,Ba,Sn,nn,Ot);Ps(_a?{posY:pa.clientY,posX:pa.clientX,item:_a,label:St.getLabel(_a.itemIndexes[0])}:void 0)},[St,nn,ht,Sn,En,wn,On,Ot]),[Ms,ks]=(0,s.useState)(),wa=(0,s.useCallback)(pa=>{if(Xn===void 0){ys(void 0),ks(void 0);const Ba=Ls.current.clientWidth/Sn/(ht-nn),_a=Be({x:pa.nativeEvent.offsetX,y:pa.nativeEvent.offsetY},En,wn,On,Ba,Sn,nn,Ot);_a&&(ks({x:pa.clientX,y:pa.clientY}),ys(_a))}},[nn,ht,Sn,Xn,ks,En,wn,On,Ot]),Xa=(0,s.useCallback)(()=>{ys(void 0)},[]);return(0,s.useEffect)(()=>{const pa=Ba=>{Ba.target instanceof HTMLElement&&Ba.target.parentElement?.id!=="flameGraphCanvasContainer_clickOutsideCheck"&&Ps(void 0)};return window.addEventListener("click",pa),()=>window.removeEventListener("click",pa)},[Ps]),(0,t.jsxs)("div",{className:Yn.graph,children:[(0,t.jsx)("div",{className:Yn.canvasWrapper,id:"flameGraphCanvasContainer_clickOutsideCheck",ref:Wn,children:(0,t.jsx)("canvas",{ref:Ls,"data-testid":"flameGraph",onClick:Zs,onMouseMove:wa,onMouseLeave:Xa})}),(0,t.jsx)(N,{position:Ms,item:fs,data:St,totalTicks:Sn,collapseConfig:fs?Ot.get(fs):void 0}),!Rt&&Xn&&(0,t.jsx)(M,{data:St,itemData:Xn,collapsing:rt,collapseConfig:Ot.get(Xn.item),onMenuItemClick:()=>{Ps(void 0)},onItemFocus:()=>{gt(Xn.item.start/Sn),$t((Xn.item.start+Xn.item.value)/Sn),et(Xn)},onSandwich:()=>{Qt(St.getLabel(Xn.item.itemIndexes[0]))},onExpandGroup:()=>{jt(Ot.setCollapsedStatus(Xn.item,!1))},onCollapseGroup:()=>{jt(Ot.setCollapsedStatus(Xn.item,!0))},onExpandAllGroups:()=>{jt(Ot.setAllCollapsedStatus(!1))},onCollapseAllGroups:()=>{jt(Ot.setAllCollapsedStatus(!0))},allGroupsCollapsed:Array.from(Ot.values()).every(pa=>pa.collapsed),allGroupsExpanded:Array.from(Ot.values()).every(pa=>!pa.collapsed),getExtraContextMenuButtons:tn,selectedView:Mn,search:kn})]})},He=()=>({graph:(0,n.css)({label:"graph",overflow:"auto",flexGrow:1,flexBasis:"50%"}),canvasContainer:(0,n.css)({label:"canvasContainer",display:"flex"}),canvasWrapper:(0,n.css)({label:"canvasWrapper",cursor:"pointer",flex:1,overflow:"hidden"}),sandwichMarker:(0,n.css)({label:"sandwichMarker",writingMode:"vertical-lr",transform:"rotate(180deg)",overflow:"hidden",whiteSpace:"nowrap"}),sandwichMarkerIcon:(0,n.css)({label:"sandwichMarkerIcon",verticalAlign:"baseline"})}),Be=(St,nn,ht,lt,gt,$t,et,Et)=>{let It=nn,Qt=ht==="children"?0:lt-1;const sn=Math.floor(St.y/(c/window.devicePixelRatio));let ln;for(;It;){const yn=It;if(It=void 0,Qt===sn){ln=yn;break}const Sn=ht==="children"?yn.children:yn.parents||[];for(const En of Sn){const wn=Te(En.start,$t,et,gt),On=Te(En.start+En.value,$t,et,gt);if(wn<=St.x&&St.x<On){It=En;const Rt=Et.get(En);(!Rt||!Rt.collapsed||Rt.items[0]===En)&&(Qt=Qt+(ht==="children"?1:-1));break}}}return ln},Ne=je;var Re=e(29158);const Se=(0,s.memo)(({data:St,focusedItem:nn,totalTicks:ht,sandwichedLabel:lt,onFocusPillClick:gt,onSandwichPillClick:$t})=>{const et=(0,I.of)(We),Et=[],It=(0,S.j_)("short")(ht),Qt=St.valueDisplayProcessor(ht);let sn=Qt.text+Qt.suffix;const ln=St.getUnitTitle();if(ln==="Count"&&(Qt.suffix||(sn=Qt.text)),Et.push((0,t.jsxs)("div",{className:et.metadataPill,children:[sn," | ",It.text,It.suffix," samples (",ln,")"]},"default")),lt&&Et.push((0,t.jsxs)("span",{children:[(0,t.jsx)(a.I,{size:"sm",name:"angle-right"}),(0,t.jsxs)("div",{className:et.metadataPill,children:[(0,t.jsx)(a.I,{size:"sm",name:"gf-show-context"})," ",(0,t.jsx)("span",{className:et.metadataPillName,children:lt.substring(lt.lastIndexOf("/")+1)}),(0,t.jsx)(Re.K,{className:et.pillCloseButton,name:"times",size:"sm",onClick:$t,tooltip:"Remove sandwich view","aria-label":"Remove sandwich view"})]})]},"sandwich")),nn){const yn=Math.round(1e4*(nn.item.value/ht))/100;Et.push((0,t.jsxs)("span",{children:[(0,t.jsx)(a.I,{size:"sm",name:"angle-right"}),(0,t.jsxs)("div",{className:et.metadataPill,children:[(0,t.jsx)(a.I,{size:"sm",name:"eye"})," ",yn,"% of total",(0,t.jsx)(Re.K,{className:et.pillCloseButton,name:"times",size:"sm",onClick:gt,tooltip:"Remove focus","aria-label":"Remove focus"})]})]},"focus"))}return(0,t.jsx)("div",{className:et.metadata,children:Et})});Se.displayName="FlameGraphMetadata";const We=St=>({metadataPill:(0,n.css)({label:"metadataPill",display:"inline-flex",alignItems:"center",background:St.colors.background.secondary,borderRadius:St.shape.borderRadius(8),padding:St.spacing(.5,1),fontSize:St.typography.bodySmall.fontSize,fontWeight:St.typography.fontWeightMedium,lineHeight:St.typography.bodySmall.lineHeight,color:St.colors.text.secondary}),pillCloseButton:(0,n.css)({label:"pillCloseButton",verticalAlign:"text-bottom",margin:St.spacing(0,.5)}),metadata:(0,n.css)({margin:"8px 0",textAlign:"center"}),metadataPillName:(0,n.css)({label:"metadataPillName",maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginLeft:St.spacing(.5)})}),Ke=Se,Xe=({data:St,rangeMin:nn,rangeMax:ht,matchedLabels:lt,setRangeMin:gt,setRangeMax:$t,onItemFocused:et,focusedItemData:Et,textAlign:It,onSandwich:Qt,sandwichItem:sn,onFocusPillClick:ln,onSandwichPillClick:yn,colorScheme:Sn,showFlameGraphOnly:En,getExtraContextMenuButtons:wn,collapsing:On,selectedView:Rt,search:Ot,collapsedMap:jt,setCollapsedMap:rt})=>{const tn=Je(),[Mn,kn]=(0,s.useState)(),[Yn,Wn]=(0,s.useState)(),[Jn,Ls]=(0,s.useState)(0),[fs,ys]=(0,s.useState)(),[Xn,Ps]=(0,s.useState)(0);if((0,s.useEffect)(()=>{if(St){let ks=St.getLevels(),wa=ks.length?ks[0][0].value:0,Xa=ks.length?ks[0][0].valueRight:void 0,pa=wa,Ba;if(sn){const[_a,dr]=St.getSandwichLevels(sn);ks=dr,Ba=_a,pa=dr[0]?.[0]?.value??0}kn(ks),Wn(Ba),Ls(wa),ys(Xa),Ps(pa)}},[St,sn]),!Mn)return null;const Zs={data:St,rangeMin:nn,rangeMax:ht,matchedLabels:lt,setRangeMin:gt,setRangeMax:$t,onItemFocused:et,focusedItemData:Et,textAlign:It,onSandwich:Qt,colorScheme:Sn,totalProfileTicks:Jn,totalProfileTicksRight:fs,totalViewTicks:Xn,showFlameGraphOnly:En,collapsedMap:jt,setCollapsedMap:rt,getExtraContextMenuButtons:wn,collapsing:On,search:Ot,selectedView:Rt},Ms=Yn?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:tn.sandwichCanvasWrapper,children:[(0,t.jsxs)("div",{className:tn.sandwichMarker,children:["Callers",(0,t.jsx)(a.I,{className:tn.sandwichMarkerIcon,name:"arrow-down"})]}),(0,t.jsx)(Ne,{...Zs,root:Yn[Yn.length-1][0],depth:Yn.length,direction:"parents",collapsing:!1})]}),(0,t.jsxs)("div",{className:tn.sandwichCanvasWrapper,children:[(0,t.jsxs)("div",{className:(0,n.cx)(tn.sandwichMarker,tn.sandwichMarkerCalees),children:[(0,t.jsx)(a.I,{className:tn.sandwichMarkerIcon,name:"arrow-up"}),"Callees"]}),(0,t.jsx)(Ne,{...Zs,root:Mn[0][0],depth:Mn.length,direction:"children",collapsing:!1})]})]}):(0,t.jsx)(Ne,{...Zs,root:Mn[0][0],depth:Mn.length,direction:"children"});return(0,t.jsxs)("div",{className:tn.graph,children:[(0,t.jsx)(Ke,{data:St,focusedItem:Et,sandwichedLabel:sn,totalTicks:Xn,onFocusPillClick:ln,onSandwichPillClick:yn}),Ms]})},Je=()=>({graph:(0,n.css)({label:"graph",overflow:"auto",flexGrow:1,flexBasis:"50%"}),sandwichCanvasWrapper:(0,n.css)({label:"sandwichCanvasWrapper",display:"flex",marginBottom:`${c/window.devicePixelRatio}px`}),sandwichMarker:(0,n.css)({label:"sandwichMarker",writingMode:"vertical-lr",transform:"rotate(180deg)",overflow:"hidden",whiteSpace:"nowrap"}),sandwichMarkerCalees:(0,n.css)({label:"sandwichMarkerCalees",textAlign:"right"}),sandwichMarkerIcon:(0,n.css)({label:"sandwichMarkerIcon",verticalAlign:"baseline"})}),st=Xe;var pt=e(76365),xt=e(75198),ot=e(80292),$e=e(55852),ve=e(10354),be=e(19727),he=e(94354),ye=e(38138),Pe=e(83122);const ge=({search:St,setSearch:nn,selectedView:ht,setSelectedView:lt,containerWidth:gt,onReset:$t,textAlign:et,onTextAlignChange:Et,showResetButton:It,colorScheme:Qt,onColorSchemeChange:sn,stickyHeader:ln,extraHeaderElements:yn,vertical:Sn,isDiffMode:En,setCollapsedMap:wn,collapsedMap:On})=>{const Rt=(0,I.of)(Qe),[Ot,jt]=Ie(St,nn),rt=Ot!==""?(0,t.jsx)($e.$n,{icon:"times",fill:"text",size:"sm",onClick:()=>{nn(""),jt("")},children:"Clear"}):null;return(0,t.jsxs)("div",{className:(0,n.cx)(Rt.header,{[Rt.stickyHeader]:ln}),children:[(0,t.jsx)("div",{className:Rt.inputContainer,children:(0,t.jsx)(ve.p,{value:Ot||"",onChange:tn=>{jt(tn.currentTarget.value)},placeholder:"Search...",suffix:rt})}),(0,t.jsxs)("div",{className:Rt.rightContainer,children:[It&&(0,t.jsx)($e.$n,{variant:"secondary",fill:"outline",size:"sm",icon:"history-alt",tooltip:"Reset focus and sandwich state",onClick:()=>{$t()},className:Rt.buttonSpacing,"aria-label":"Reset focus and sandwich state"}),(0,t.jsx)(xe,{value:Qt,onChange:sn,isDiffMode:En}),(0,t.jsxs)(be.e,{className:Rt.buttonSpacing,children:[(0,t.jsx)($e.$n,{variant:"secondary",fill:"outline",size:"sm",tooltip:"Expand all groups",onClick:()=>{wn(On.setAllCollapsedStatus(!1))},"aria-label":"Expand all groups",icon:"angle-double-down",disabled:ht===V.F8.TopTable}),(0,t.jsx)($e.$n,{variant:"secondary",fill:"outline",size:"sm",tooltip:"Collapse all groups",onClick:()=>{wn(On.setAllCollapsedStatus(!0))},"aria-label":"Collapse all groups",icon:"angle-double-up",disabled:ht===V.F8.TopTable})]}),(0,t.jsx)(he.z,{size:"sm",disabled:ht===V.F8.TopTable,options:Ae,value:et,onChange:Et,className:Rt.buttonSpacing}),(0,t.jsx)(he.z,{size:"sm",options:Ee(gt,Sn),value:ht,onChange:lt}),yn&&(0,t.jsx)("div",{className:Rt.extraElements,children:yn})]})]})};function xe(St){const nn=(0,I.of)(Qe);let ht=(0,t.jsxs)(ye.W,{children:[(0,t.jsx)(ye.W.Item,{label:"By package name",onClick:()=>St.onChange(V.zM.PackageBased)}),(0,t.jsx)(ye.W.Item,{label:"By value",onClick:()=>St.onChange(V.zM.ValueBased)})]});const lt={[V.zM.ValueBased]:nn.colorDotByValue,[V.zM.PackageBased]:nn.colorDotByPackage,[V.yU.DiffColorBlind]:nn.colorDotDiffColorBlind,[V.yU.Default]:nn.colorDotDiffDefault}[St.value]||nn.colorDotByValue;let gt=(0,t.jsx)("span",{className:(0,n.cx)(nn.colorDot,lt)});return St.isDiffMode&&(ht=(0,t.jsxs)(ye.W,{children:[(0,t.jsx)(ye.W.Item,{label:"Default (green to red)",onClick:()=>St.onChange(V.yU.Default)}),(0,t.jsx)(ye.W.Item,{label:"Color blind (blue to red)",onClick:()=>St.onChange(V.yU.DiffColorBlind)})]}),gt=(0,t.jsxs)("div",{className:(0,n.cx)(nn.colorDotDiff,lt),children:[(0,t.jsx)("div",{children:"-100% (removed)"}),(0,t.jsx)("div",{children:"0%"}),(0,t.jsx)("div",{children:"+100% (added)"})]})),(0,t.jsx)(Pe.m,{overlay:ht,children:(0,t.jsx)($e.$n,{variant:"secondary",fill:"outline",size:"sm",tooltip:"Change color scheme",onClick:()=>{},className:nn.buttonSpacing,"aria-label":"Change color scheme",children:gt})})}const Ae=[{value:"left",description:"Align text left",icon:"align-left"},{value:"right",description:"Align text right",icon:"align-right"}];function Ee(St,nn){let ht=[{value:V.F8.TopTable,label:"Top Table",description:"Only show top table"},{value:V.F8.FlameGraph,label:"Flame Graph",description:"Only show flame graph"}];return(St>=u||nn)&&ht.push({value:V.F8.Both,label:"Both",description:"Show both the top table and flame graph"}),ht}function Ie(St,nn){const[ht,lt]=(0,s.useState)(St),gt=(0,ot.A)(St);return(0,xt.A)(()=>{nn(ht)},250,[ht]),(0,s.useEffect)(()=>{gt!==St&&St!==ht&&lt(St)},[St,gt,ht]),[ht,lt]}const Qe=St=>({header:(0,n.css)({label:"header",display:"flex",flexWrap:"wrap",justifyContent:"space-between",width:"100%",top:0,gap:St.spacing(1),marginTop:St.spacing(1)}),stickyHeader:(0,n.css)({zIndex:St.zIndex.navbarFixed,position:"sticky",background:St.colors.background.primary}),inputContainer:(0,n.css)({label:"inputContainer",flexGrow:1,minWidth:"150px",maxWidth:"350px"}),rightContainer:(0,n.css)({label:"rightContainer",display:"flex",alignItems:"flex-start",flexWrap:"wrap"}),buttonSpacing:(0,n.css)({label:"buttonSpacing",marginRight:St.spacing(1)}),resetButton:(0,n.css)({label:"resetButton",display:"flex",marginRight:St.spacing(2)}),resetButtonIconWrapper:(0,n.css)({label:"resetButtonIcon",padding:"0 5px",color:St.colors.text.disabled}),colorDot:(0,n.css)({label:"colorDot",display:"inline-block",width:"10px",height:"10px",borderRadius:"50%"}),colorDotDiff:(0,n.css)({label:"colorDotDiff",display:"flex",width:"200px",height:"12px",color:"white",fontSize:9,lineHeight:1.3,fontWeight:300,justifyContent:"space-between",padding:"0 2px",borderRadius:"2px"}),colorDotByValue:(0,n.css)({label:"colorDotByValue",background:Z}),colorDotByPackage:(0,n.css)({label:"colorDotByPackage",background:se}),colorDotDiffDefault:(0,n.css)({label:"colorDotDiffDefault",background:oe}),colorDotDiffColorBlind:(0,n.css)({label:"colorDotDiffColorBlind",background:te}),extraElements:(0,n.css)({label:"extraElements",marginLeft:St.spacing(1)})}),at=ge;var ft=e(70713),ct=e(11261),vt=e(25019),Pt=e(90708),Vt=e(77093),Jt=e(52622);const wt=(0,s.memo)(({data:St,onSymbolClick:nn,search:ht,matchedLabels:lt,onSearch:gt,sandwichItem:$t,onSandwich:et,onTableSort:Et,colorScheme:It})=>{const Qt=(0,s.useMemo)(()=>{let En={};for(let wn=0;wn<St.data.length;wn++){const On=St.getValue(wn),Rt=St.getValueRight(wn),Ot=St.getSelf(wn),jt=St.getLabel(wn);(!lt||lt.has(jt))&&(En[jt]=En[jt]||{},En[jt].self=En[jt].self?En[jt].self+Ot:Ot,En[jt].total=En[jt].total?En[jt].total+On:On,En[jt].totalRight=En[jt].totalRight?En[jt].totalRight+Rt:Rt)}return En},[St,lt]),sn=(0,I.of)(Ye),ln=(0,I.$j)(),[yn,Sn]=(0,s.useState)([{displayName:"Self",desc:!0}]);return(0,t.jsx)("div",{className:sn.topTableContainer,"data-testid":"topTable",children:(0,t.jsx)(ft.Ay,{style:{width:"100%"},children:({width:En,height:wn})=>{if(En<3||wn<3)return null;const On=zt(St,Qt,En,nn,gt,et,ln,It,ht,$t);return(0,t.jsx)(Vt.X,{initialSortBy:yn,onSortByChange:Rt=>{Rt&&Rt.length&&Et?.(Rt[0].displayName+"_"+(Rt[0].desc?"desc":"asc")),Sn(Rt)},data:On,width:En,height:wn})}})})});wt.displayName="FlameGraphTopTableContainer";function zt(St,nn,ht,lt,gt,$t,et,Et,It,Qt){const sn=_n($t,gt,It,Qt),ln={type:ct.PU.string,name:"Symbol",values:[],config:{custom:{width:ht-Pn-D*2},links:[{title:"Highlight symbol",url:"",onClick:En=>{const On=En.origin.field.values[En.origin.rowIndex];lt(On)}}]}};let yn;if(St.isDiffFlamegraph()){ln.config.custom.width=ht-Pn-D*3;const En=on("Baseline","percent"),wn=on("Comparison","percent"),On=on("Diff","percent");On.config.custom.cellOptions.type=Jt.ob.ColorText;const[Rt,Ot]=Et===V.yU.DiffColorBlind?[z[0],z[2]]:[ne[0],ne[2]];On.config.mappings=[{type:vt.d.ValueToText,options:{[1/0]:{text:"new",color:Ot}}},{type:vt.d.ValueToText,options:{[-100]:{text:"removed",color:Rt}}},{type:vt.d.RangeToText,options:{from:0,to:1/0,result:{color:Ot}}},{type:vt.d.RangeToText,options:{from:-1/0,to:0,result:{color:Rt}}}];const jt=St.getLevels(),rt=jt.length?jt[0][0].value:0,tn=jt.length?jt[0][0].valueRight:void 0;for(let Mn in nn){sn.values.push(null),ln.values.push(Mn);const kn=nn[Mn].total,Yn=nn[Mn].totalRight,Wn=rt-tn,Jn=Math.round(1e4*kn/Wn)/100,Ls=Math.round(1e4*Yn/tn)/100,fs=(Ls-Jn)/Jn*100;On.values.push(fs),En.values.push(Jn),wn.values.push(Ls)}yn={fields:[sn,ln,En,wn,On],length:ln.values.length}}else{const En=on("Self",St.selfField.config.unit),wn=on("Total",St.valueField.config.unit);for(let On in nn)sn.values.push(null),ln.values.push(On),En.values.push(nn[On].self),wn.values.push(nn[On].total);yn={fields:[sn,ln,En,wn],length:ln.values.length}}return(0,Pt.we)({data:[yn],fieldConfig:{defaults:{},overrides:[]},replaceVariables:En=>En,theme:et})[0]}function on(St,nn){const ht={width:D,align:"auto",inspect:!1,cellOptions:{type:Jt.ob.Auto}};return{type:ct.PU.number,name:St,values:[],config:{unit:nn,custom:ht}}}const Pn=61;function _n(St,nn,ht,lt){const gt={type:Jt.ob.Custom,cellComponent:et=>(0,t.jsx)(Cn,{frame:et.frame,onSandwich:St,onSearch:nn,search:ht,sandwichItem:lt,rowIndex:et.rowIndex})},$t={filterable:!1,width:Pn,hideHeader:!0,inspect:!1,align:"auto",cellOptions:gt};return{type:ct.PU.number,name:"actions",values:[],config:{custom:$t}}}function Cn(St){const nn=Dt(),ht=St.frame.fields.find($t=>$t.name==="Symbol")?.values[St.rowIndex],lt=St.search===ht,gt=St.sandwichItem===ht;return(0,t.jsxs)("div",{className:nn.actionCellWrapper,children:[(0,t.jsx)(Re.K,{className:nn.actionCellButton,name:"search",variant:lt?"primary":"secondary",tooltip:lt?"Clear from search":"Search for symbol","aria-label":lt?"Clear from search":"Search for symbol",onClick:()=>{St.onSearch(lt?"":ht)}}),(0,t.jsx)(Re.K,{className:nn.actionCellButton,name:"gf-show-context",tooltip:gt?"Remove from sandwich view":"Show in sandwich view",variant:gt?"primary":"secondary","aria-label":gt?"Remove from sandwich view":"Show in sandwich view",onClick:()=>{St.onSandwich(gt?void 0:ht)}})]})}const Ye=St=>({topTableContainer:(0,n.css)({label:"topTableContainer",padding:St.spacing(1),backgroundColor:St.colors.background.secondary,height:"100%"})}),Dt=()=>({actionCellWrapper:(0,n.css)({label:"actionCellWrapper",display:"flex",height:"24px"}),actionCellButton:(0,n.css)({label:"actionCellButton",marginRight:0,width:"24px"})}),yt=wt,Ft=new i.A,an=({data:St,onTableSymbolClick:nn,onViewSelected:ht,onTextAlignSelected:lt,onTableSort:gt,getTheme:$t,stickyHeader:et,extraHeaderElements:Et,vertical:It,showFlameGraphOnly:Qt,disableCollapsing:sn,getExtraContextMenuButtons:ln})=>{const[yn,Sn]=(0,s.useState)(),[En,wn]=(0,s.useState)(0),[On,Rt]=(0,s.useState)(1),[Ot,jt]=(0,s.useState)(""),[rt,tn]=(0,s.useState)(V.F8.Both),[Mn,{width:kn}]=(0,r.A)(),[Yn,Wn]=(0,s.useState)("left"),[Jn,Ls]=(0,s.useState)(),[fs,ys]=(0,s.useState)(new pt.S6),Xn=(0,s.useMemo)(()=>$t(),[$t]),Ps=(0,s.useMemo)(()=>{if(!St)return;const en=new pt.Jz(St,{collapsing:!sn},Xn);return ys(en.getCollapsedMap()),en},[St,Xn,sn]),[Zs,Ms]=un(Ps),ks=Un(Xn),wa=hn(Ot,Ps);(0,s.useEffect)(()=>{kn>0&&kn<u&&rt===V.F8.Both&&!It&&tn(V.F8.FlameGraph)},[rt,tn,kn,It]);const Xa=(0,s.useCallback)(()=>{Sn(void 0),wn(0),Rt(1)},[Sn,Rt,wn]);function pa(){Ls(void 0)}(0,s.useEffect)(()=>{Xa(),pa()},[St,Xa]);const Ba=(0,s.useCallback)(en=>{Ot===en?jt(""):(nn?.(en),jt(en),Xa())},[jt,Xa,nn,Ot]);if(!Ps)return null;const _a=(0,t.jsx)(st,{data:Ps,rangeMin:En,rangeMax:On,matchedLabels:wa,setRangeMin:wn,setRangeMax:Rt,onItemFocused:en=>Sn(en),focusedItemData:yn,textAlign:Yn,sandwichItem:Jn,onSandwich:en=>{Xa(),Ls(en)},onFocusPillClick:Xa,onSandwichPillClick:pa,colorScheme:Zs,showFlameGraphOnly:Qt,collapsing:!sn,getExtraContextMenuButtons:ln,selectedView:rt,search:Ot,collapsedMap:fs,setCollapsedMap:ys}),dr=(0,t.jsx)(yt,{data:Ps,onSymbolClick:Ba,search:Ot,matchedLabels:wa,sandwichItem:Jn,onSandwich:Ls,onSearch:jt,onTableSort:gt,colorScheme:Zs});let Wa;return Qt||rt===V.F8.FlameGraph?Wa=_a:rt===V.F8.TopTable?Wa=(0,t.jsx)("div",{className:ks.tableContainer,children:dr}):rt===V.F8.Both&&(It?Wa=(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:ks.verticalGraphContainer,children:_a}),(0,t.jsx)("div",{className:ks.verticalTableContainer,children:dr})]}):Wa=(0,t.jsxs)("div",{className:ks.horizontalContainer,children:[(0,t.jsx)("div",{className:ks.horizontalTableContainer,children:dr}),(0,t.jsx)("div",{className:ks.horizontalGraphContainer,children:_a})]})),(0,t.jsx)(f.D.Provider,{value:Xn,children:(0,t.jsxs)("div",{ref:Mn,className:ks.container,children:[!Qt&&(0,t.jsx)(at,{search:Ot,setSearch:jt,selectedView:rt,setSelectedView:en=>{tn(en),ht?.(en)},containerWidth:kn,onReset:()=>{Xa(),pa()},textAlign:Yn,onTextAlignChange:en=>{Wn(en),lt?.(en)},showResetButton:!!(yn||Jn),colorScheme:Zs,onColorSchemeChange:Ms,stickyHeader:!!et,extraHeaderElements:Et,vertical:It,isDiffMode:Ps.isDiffFlamegraph(),setCollapsedMap:ys,collapsedMap:fs}),(0,t.jsx)("div",{className:ks.body,children:Wa})]})})};function un(St){const nn=St?.isDiffFlamegraph()?V.yU.Default:V.zM.PackageBased,[ht,lt]=(0,s.useState)(nn);return(0,s.useEffect)(()=>{lt(nn)},[nn]),[ht,lt]}function hn(St,nn){return(0,s.useMemo)(()=>{if(St&&nn){const ht=new Set;let lt=Ft.filter(nn.getUniqueLabels(),St);if(lt)for(let gt of lt)ht.add(nn.getUniqueLabels()[gt]);return ht}},[St,nn])}function Un(St){return{container:(0,n.css)({label:"container",overflow:"auto",height:"100%",display:"flex",flex:"1 1 0",flexDirection:"column",minHeight:0,gap:St.spacing(1)}),body:(0,n.css)({label:"body",flexGrow:1}),tableContainer:(0,n.css)({height:800}),horizontalContainer:(0,n.css)({label:"horizontalContainer",display:"flex",minHeight:0,flexDirection:"row",columnGap:St.spacing(1),width:"100%"}),horizontalGraphContainer:(0,n.css)({flexBasis:"50%"}),horizontalTableContainer:(0,n.css)({flexBasis:"50%",maxHeight:800}),verticalGraphContainer:(0,n.css)({marginBottom:St.spacing(1)}),verticalTableContainer:(0,n.css)({height:800})}}const Nn=an},76365:(G,O,e)=>{"use strict";e.d(O,{S6:()=>h,Jz:()=>m,oA:()=>p,Ik:()=>l});var t=e(11261),n=e(75972),i=e(57875),s=e(5546),r=e(2543);function f(d,v){const u=a(d);return c(u,v,"parents")}function a(d){return d.map(v=>{if(!v.parents?.length)return v;const u={...v,children:[]},D=[{child:u,parent:v.parents[0]}];for(;D.length;){const P=D.shift(),x={...P.parent,children:P.child?[P.child]:[],parents:[]};P.child&&(x.value=P.child.value,P.child.parents=[x]),P.parent.parents?.length&&D.push({child:x,parent:P.parent.parents[0]})}return u})}function c(d,v,u="children"){const D=u==="parents"?"children":"parents",P=[],x=[{previous:void 0,items:d,level:0}];for(;x.length;){const E=x.shift(),C=E.items.flatMap(T=>T.itemIndexes),M={value:E.items.reduce((T,b)=>T+b.value,0),itemIndexes:C,children:[],parents:[],start:0,level:E.level};if(P[E.level]=P[E.level]||[],P[E.level].push(M),E.previous){M[D]=[E.previous];const T=E.previous[u]?.reduce((b,R)=>b+R.value,0)||0;M.start=E.previous.start+T,E.previous[u].push(M)}const S=E.items.flatMap(T=>T[u]||[]),I=(0,r.groupBy)(S,T=>v.getLabel(T.itemIndexes[0]));for(const T of Object.values(I))x.push({previous:M,items:T,level:E.level+1})}return u==="parents"&&(P.reverse(),P.forEach((E,C)=>{E.forEach(M=>{M.level=C})})),P}function o(d,v){const u=[];let D=0,P;const x={};for(let C=0;C<d.data.length;C++){const M=d.getLevel(C),S=C>0?d.getLevel(C-1):void 0;if(u[M]=u[M]||[],S&&S>=M){const T=u[M][u[M].length-1];D=T.start+d.getValue(T.itemIndexes[0])+d.getValueRight(T.itemIndexes[0]),P=T.parents[0]}const I={itemIndexes:[C],value:d.getValue(C)+d.getValueRight(C),valueRight:d.isDiffFlamegraph()?d.getValueRight(C):void 0,start:D,parents:P&&[P],children:[],level:M};x[d.getLabel(C)]?x[d.getLabel(C)].push(I):x[d.getLabel(C)]=[I],P&&P.children.push(I),P=I,u[M].push(I)}const E=new g(v?.collapsingThreshold);return v?.collapsing&&E.addTree(u[0][0]),[u,x,E.getCollapsedMap()]}class h{constructor(v){this.map=new Map,this.map=v||new Map}get(v){return this.map.get(v)}keys(){return this.map.keys()}values(){return this.map.values()}size(){return this.map.size}setCollapsedStatus(v,u){const D=new Map(this.map),P=this.map.get(v),x={...P,collapsed:u};for(const E of P.items)D.set(E,x);return new h(D)}setAllCollapsedStatus(v){const u=new Map(this.map);for(const D of this.map.keys()){const x={...this.map.get(D),collapsed:v};u.set(D,x)}return new h(u)}}class g{constructor(v){this.map=new Map,this.threshold=.99,v!==void 0&&(this.threshold=v)}addTree(v){const u=[v];for(;u.length;){const D=u.shift();D.parents?.length&&this.addItem(D,D.parents[0]),D.children.length&&u.unshift(...D.children)}}addItem(v,u){if(u&&v.value>u.value*this.threshold&&u.children.length===1)if(this.map.has(u)){const D=this.map.get(u);this.map.set(v,D),D.items.push(v)}else{const D={items:[u,v],collapsed:!0};this.map.set(u,D),this.map.set(v,D)}}getCollapsedMap(){return new h(this.map)}}function l(d){return d.missingFields.length?`Data is missing fields: ${d.missingFields.join(", ")}`:d.wrongTypeFields.length?`Data has fields of wrong type: ${d.wrongTypeFields.map(v=>`${v.name} has type ${v.type} but should be ${v.expectedTypes.join(" or ")}`).join(", ")}`:""}function p(d){const v=[["label",[t.PU.string,t.PU.enum]],["level",[t.PU.number]],["value",[t.PU.number]],["self",[t.PU.number]]],u=[],D=[];for(const P of v){const[x,E]=P,C=d.fields.find(M=>M.name===x);if(!C){u.push(x);continue}E.includes(C.type)||D.push({name:x,expectedTypes:E,type:C.type})}if(u.length>0||D.length>0)return{wrongTypeFields:D,missingFields:u}}class m{constructor(v,u,D=(0,n.a)()){this.data=v,this.options=u;const P=p(v);if(P)throw new Error(l(P));if(this.labelField=v.fields.find(E=>E.name==="label"),this.levelField=v.fields.find(E=>E.name==="level"),this.valueField=v.fields.find(E=>E.name==="value"),this.selfField=v.fields.find(E=>E.name==="self"),this.valueRightField=v.fields.find(E=>E.name==="valueRight"),this.selfRightField=v.fields.find(E=>E.name==="selfRight"),(this.valueField||this.selfField)&&!(this.valueField&&this.selfField))throw new Error("Malformed dataFrame: both valueRight and selfRight has to be present if one of them is present.");const x=this.labelField?.config?.type?.enum;x?(this.labelDisplayProcessor=(0,i.J)({field:this.labelField,theme:D}),this.uniqueLabels=x.text||[]):(this.labelDisplayProcessor=E=>({text:E+"",numeric:0}),this.uniqueLabels=[...new Set(this.labelField.values)]),this.valueDisplayProcessor=(0,i.J)({field:this.valueField,theme:D})}isDiffFlamegraph(){return!!(this.valueRightField&&this.selfRightField)}getLabel(v){return this.labelDisplayProcessor(this.labelField.values[v]).text}getLevel(v){return this.levelField.values[v]}getValue(v){return y(this.valueField,v)}getValueRight(v){return y(this.valueRightField,v)}getSelf(v){return y(this.selfField,v)}getSelfRight(v){return y(this.selfRightField,v)}getSelfDisplay(v){return this.valueDisplayProcessor(this.getSelf(v))}getUniqueLabels(){return this.uniqueLabels}getUnitTitle(){switch(this.valueField.config.unit){case s.Zk.Bytes:return"RAM";case s.Zk.Nanoseconds:return"Time"}return"Count"}getLevels(){return this.initLevels(),this.levels}getSandwichLevels(v){const u=this.getNodesWithLabel(v);if(!u?.length)return[[],[]];const D=f(u,this),P=c(u,this);return[D,P]}getNodesWithLabel(v){return this.initLevels(),this.uniqueLabelsMap[v]}getCollapsedMap(){return this.initLevels(),this.collapsedMap}initLevels(){if(!this.levels){const[v,u,D]=o(this,this.options);this.levels=v,this.uniqueLabelsMap=u,this.collapsedMap=D}}}function y(d,v){return d?(typeof v=="number"?[v]:v).reduce((D,P)=>D+d.values[P],0):0}},5546:(G,O,e)=>{"use strict";e.d(O,{F8:()=>n,Zk:()=>t,yU:()=>s,zM:()=>i});var t=(r=>(r.Bytes="bytes",r.Short="short",r.Nanoseconds="ns",r))(t||{}),n=(r=>(r.TopTable="topTable",r.FlameGraph="flameGraph",r.Both="both",r))(n||{}),i=(r=>(r.ValueBased="valueBased",r.PackageBased="packageBased",r))(i||{}),s=(r=>(r.Default="default",r.DiffColorBlind="diffColorBlind",r))(s||{})},80822:(G,O,e)=>{"use strict";e.d(O,{Wn:()=>r,_k:()=>s});var t=e(21423),n=e(41260),i=e(11261);function s(p,m){const y=r({data:p.series},{data:m.series}).data;return{...p,series:y}}function r(p,m){if(!p)return h(m);m.data.forEach(u=>{const D=p.data.find(P=>l(P,u));if(!D){p.data.push(g(u));return}f(D,u)});const y=[...p.errors??[],...m.errors??[]];y.length>0&&(p.errors=y);const d=p.error??m.error;d!=null&&(p.error=d);const v=[...p.traceIds??[],...m.traceIds??[]];return v.length>0&&(p.traceIds=v),p}function f(p,m){const y=Math.max(p.fields.length,m.fields.length);for(let d=0;d<y;d++){if(!p.fields[d])continue;const v=a(p.fields[d],m.fields,d);if(v&&(p.fields[d].values=[].concat.apply(v.values,p.fields[d].values),v.nanos)){const u=p.fields[d].nanos?.slice()||[];p.fields[d].nanos=m.fields[d].nanos?.concat(u)}}p.length+=m.length,p.meta={...p.meta,stats:o(p.meta?.stats??[],m.meta?.stats??[])}}function a(p,m,y){const d=m.filter(v=>v.name===p.name);return d.length===1?d[0]:p.labels?d.find(v=>(0,t.ab)(p.labels??{},v.labels??{})):m[y]}const c="Summary: total bytes processed";function o(p,m){const y=p.find(u=>u.displayName===c),d=m.find(u=>u.displayName===c);if(d!=null&&y!=null)return[{value:d.value+y.value,displayName:c,unit:y.unit}];const v=d??y;return v!=null?[v]:[]}function h(p){return{...p,data:p.data.map(g)}}function g(p){return{...p,fields:p.fields.map(m=>({...m,values:m.values}))}}function l(p,m){if(p.refId!==m.refId||p.name!==m.name)return!1;const y=p.meta?.type,d=m.meta?.type;if(y!==d)return!1;if(y===n.m.TimeSeriesMulti){const D=p.fields.find(x=>x.type===i.PU.number),P=m.fields.find(x=>x.type===i.PU.number);return D===void 0||P===void 0?!1:(0,t.ab)(D.labels??{},P.labels??{})}const v=p.meta?.custom?.frameType,u=m.meta?.custom?.frameType;return v==="LabeledTimeValues"&&u==="LabeledTimeValues"?!0:v===u}},80937:(G,O,e)=>{"use strict";e.d(O,{t:()=>s});var t=e(84555),n=e(32370),i=e(76040);function s(o,h,g,l="="){if(!h||!g)throw new Error("Need label to add to query.");const p=r(o);if(!p.length)return o;const m=f(h,g,l);return a(o,p,m)}function r(o){const h=t.K3.parse(o),g=[];return h.iterate({enter:({to:l,from:p,type:m})=>{if(m.id===t.Fb){const y=(0,i.u)(o.substring(p,l));return g.push({query:y.query,from:p,to:l}),!1}}}),g}function f(o,h,g){const l=h===1/0?"+Inf":h.toString();return{label:o,op:g,value:l}}function a(o,h,g){const l=new n.l;let p="",m=0;for(let y=0;y<h.length;y++){const d=h[y],v=y===h.length-1,u=o.substring(m,d.from),D=v?o.substring(d.to):"";c(d.query.labels,g)||d.query.labels.push(g);const P=l.renderQuery(d.query);p+=u+P+D,m=d.to}return p}function c(o,h){return o.find(g=>g.label===h.label&&g.value===h.value)}},86204:(G,O,e)=>{"use strict";e.d(O,{L:()=>nn});var t=e(74848),n=e(32196),i=e(96540),s=e(14236),r=e(7144),f=e(13544),a=e(14110),c=e(14578),o=e(55852),h=e(40845),g=e(81996),l=e(91793),p=e(3911),m=e(39558),y=e(67061),d=e(60029),v=e(10354),u=e(54438);const D="{}",P="__name__",x=25;function E(ht){let lt="";const gt=[];for(const $t of ht)if(($t.name===P||$t.selected)&&$t.values&&$t.values.length>0){const et=$t.values.filter(Et=>Et.selected).map(Et=>Et.name);et.length>1?gt.push(`${$t.name}=~"${et.map(g.Cs).join("|")}"`):et.length===1&&($t.name===P?lt=et[0]:gt.push(`${$t.name}="${(0,g.Qn)(et[0])}"`))}return[lt,"{",gt.join(","),"}"].join("")}function C(ht,lt,gt){return ht.map($t=>{const et=lt[$t.name];if(et){let Et;if($t.name===gt&&$t.values)Et=$t.values;else{const It=new Set($t.values?.filter(Qt=>Qt.selected).map(Qt=>Qt.name)||[]);Et=et.map(Qt=>({name:Qt,selected:It.has(Qt)}))}return{...$t,loading:!1,values:Et,hidden:!et,facets:Et.length}}return{...$t,loading:!1,hidden:!et,values:void 0,facets:0}})}const M=(0,p.N)(ht=>({wrapper:(0,n.css)({backgroundColor:ht.colors.background.secondary,padding:ht.spacing(1),width:"100%"}),list:(0,n.css)({marginTop:ht.spacing(1),display:"flex",flexWrap:"wrap",maxHeight:"200px",overflow:"auto",alignContent:"flex-start"}),section:(0,n.css)({"& + &":{margin:`${ht.spacing(2)} 0`},position:"relative"}),selector:(0,n.css)({fontFamily:ht.typography.fontFamilyMonospace,marginBottom:ht.spacing(1)}),status:(0,n.css)({padding:ht.spacing(.5),color:ht.colors.text.secondary,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",position:"absolute",width:"50%",right:0,textAlign:"right",opacity:0,[ht.transitions.handleMotion("no-preference","reduce")]:{transition:"opacity 100ms linear"}}),statusShowing:(0,n.css)({opacity:1}),error:(0,n.css)({color:ht.colors.error.main}),valueList:(0,n.css)({marginRight:ht.spacing(1),resize:"horizontal"}),valueListWrapper:(0,n.css)({borderLeft:`1px solid ${ht.colors.border.medium}`,margin:`${ht.spacing(1)} 0`,padding:`${ht.spacing(1)} 0 ${ht.spacing(1)} ${ht.spacing(1)}`}),valueListArea:(0,n.css)({display:"flex",flexWrap:"wrap",marginTop:ht.spacing(1)}),valueTitle:(0,n.css)({marginLeft:`-${ht.spacing(.5)}`,marginBottom:ht.spacing(1)}),validationStatus:(0,n.css)({padding:ht.spacing(.5),marginBottom:ht.spacing(1),color:ht.colors.text.maxContrast,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"})}));class S extends i.Component{constructor(){super(...arguments),this.valueListsRef=i.createRef(),this.state={labels:[],labelSearchTerm:"",metricSearchTerm:"",status:"Ready",error:"",validationStatus:"",valueSearchTerm:""},this.onChangeLabelSearch=lt=>{this.setState({labelSearchTerm:lt.target.value})},this.onChangeMetricSearch=lt=>{this.setState({metricSearchTerm:lt.target.value})},this.onChangeValueSearch=lt=>{this.setState({valueSearchTerm:lt.target.value})},this.onClickRunQuery=()=>{const lt=E(this.state.labels);this.props.onChange(lt)},this.onClickRunRateQuery=()=>{const gt=`rate(${E(this.state.labels)}[$__rate_interval])`;this.props.onChange(gt)},this.onClickClear=()=>{this.setState(lt=>({labels:lt.labels.map($t=>({...$t,values:void 0,selected:!1,loading:!1,hidden:!1,facets:void 0})),labelSearchTerm:"",metricSearchTerm:"",status:"",error:"",validationStatus:"",valueSearchTerm:""})),this.props.deleteLastUsedLabels(),this.fetchValues(P,D)},this.onClickLabel=(lt,gt,$t)=>{const et=this.state.labels.find(Qt=>Qt.name===lt);if(!et)return;const Et=!et.selected;let It={selected:Et};if(et.values&&!Et){const Qt=et.values.map(sn=>({...sn,selected:!1}));It={...It,facets:0,values:Qt}}this.setState({labelSearchTerm:""}),this.updateLabelState(lt,It,"",()=>this.doFacettingForLabel(lt))},this.onClickValue=(lt,gt,$t)=>{const et=this.state.labels.find(It=>It.name===lt);if(!et||!et.values)return;this.setState({labelSearchTerm:""});const Et=et.values.map(It=>({...It,selected:It.name===gt?!It.selected:It.selected}));this.updateLabelState(lt,{values:Et},"",()=>this.doFacetting(lt))},this.onClickMetric=(lt,gt,$t)=>{const et=this.state.labels.find(Qt=>Qt.name===lt);if(!et||!et.values)return;this.setState({metricSearchTerm:""});const Et=et.values.map(Qt=>({...Qt,selected:Qt.name===gt||Qt.selected?!Qt.selected:Qt.selected})),It=Et.some(Qt=>Qt.selected);this.updateLabelState(lt,{selected:It,values:Et},"",()=>this.doFacetting(lt))},this.onClickValidate=()=>{const lt=E(this.state.labels);this.validateSelector(lt)},this.doFacetting=lt=>{const gt=E(this.state.labels);if(gt===D){const $t=this.state.labels.map(et=>({...et,facets:0,values:void 0,hidden:!1}));this.setState({labels:$t},()=>{this.state.labels.forEach(et=>(et.selected||et.name===P)&&this.fetchValues(et.name,gt))})}else this.fetchSeries(gt,lt)}}updateLabelState(lt,gt,$t="",et){this.setState(Et=>{const It=Et.labels.map(sn=>sn.name===lt?{...sn,...gt}:sn),Qt=$t?"":Et.error;return{labels:It,status:$t,error:Qt,validationStatus:""}},et)}componentDidMount(){const{languageProvider:lt,lastUsedLabels:gt}=this.props;if(lt){const $t=gt;lt.start(this.props.timeRange).then(()=>{let et=lt.getLabelKeys();this.fetchValues(P,D);const Et=et.map((It,Qt,sn)=>({name:It,selected:$t.includes(It),loading:!1}));this.setState({labels:Et},()=>{this.state.labels.forEach(It=>{It.selected&&this.fetchValues(It.name,D)})})})}}doFacettingForLabel(lt){const gt=this.state.labels.find(et=>et.name===lt);if(!gt)return;const $t=this.state.labels.filter(et=>et.selected).map(et=>et.name);this.props.storeLastUsedLabels($t),gt.selected?gt.values||this.fetchValues(lt,E(this.state.labels)):this.doFacetting()}async fetchValues(lt,gt){const{languageProvider:$t}=this.props;this.updateLabelState(lt,{loading:!0},`Fetching values for ${lt}`);try{let et=await $t.getLabelValues(lt);if(gt!==E(this.state.labels)){this.updateLabelState(lt,{loading:!1});return}const Et=[],{metricsMetadata:It}=$t;for(const Qt of et){const sn={name:Qt};if(lt===P&&It){const ln=It[Qt];ln&&(sn.details=`(${ln.type}) ${ln.help}`)}Et.push(sn)}this.updateLabelState(lt,{values:Et,loading:!1})}catch(et){console.error(et)}}async fetchSeries(lt,gt){const{languageProvider:$t}=this.props;gt&&this.updateLabelState(gt,{loading:!0},`Facetting labels for ${lt}`);try{const et=await $t.fetchSeriesLabels(lt,!0);if(lt!==E(this.state.labels)){gt&&this.updateLabelState(gt,{loading:!1});return}if(Object.keys(et).length===0){this.setState({error:`Empty results, no matching label for ${lt}`});return}const Et=C(this.state.labels,et,gt);this.setState({labels:Et,error:""}),gt&&this.updateLabelState(gt,{loading:!1})}catch(et){console.error(et)}}async validateSelector(lt){const{languageProvider:gt}=this.props;this.setState({validationStatus:`Validating selector ${lt}`,error:""});const $t=await gt.fetchSeries(lt);this.setState({validationStatus:`Selector is valid (${$t.length} series found)`})}render(){const{theme:lt}=this.props,{labels:gt,labelSearchTerm:$t,metricSearchTerm:et,status:Et,error:It,validationStatus:Qt,valueSearchTerm:sn}=this.state,ln=M(lt);if(gt.length===0)return(0,t.jsx)("div",{className:ln.wrapper,children:(0,t.jsx)(m._,{text:"Loading labels..."})});let yn=gt.find(Ot=>Ot.name===P);yn&&et&&(yn={...yn,values:yn.values?.filter(Ot=>Ot.selected||Ot.name.includes(et))});let Sn=gt.filter(Ot=>!Ot.hidden&&Ot.name!==P);$t&&(Sn=Sn.filter(Ot=>Ot.selected||Ot.name.includes($t)));let En=Sn.filter(Ot=>Ot.selected&&Ot.values);sn&&(En=En.map(Ot=>({...Ot,values:Ot.values?.filter(jt=>jt.selected||jt.name.includes(sn))})));const wn=E(this.state.labels),On=wn===D,Rt=yn?.values?.length||0;return(0,t.jsxs)("div",{className:ln.wrapper,children:[(0,t.jsxs)(y.B,{gap:3,children:[(0,t.jsx)("div",{children:(0,t.jsxs)("div",{className:ln.section,children:[(0,t.jsx)(d.J,{description:"Once a metric is selected only possible labels are shown.",children:"1. Select a metric"}),(0,t.jsx)("div",{children:(0,t.jsx)(v.p,{onChange:this.onChangeMetricSearch,"aria-label":"Filter expression for metric",value:et,"data-testid":f.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.selectMetric})}),(0,t.jsx)("div",{role:"list",className:ln.valueListWrapper,"data-testid":f.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.metricList,children:(0,t.jsx)(l.Y1,{height:Math.min(450,Rt*x),itemCount:Rt,itemSize:x,itemKey:Ot=>yn.values[Ot].name,width:300,className:ln.valueList,children:({index:Ot,style:jt})=>{const rt=yn?.values?.[Ot];return rt?(0,t.jsx)("div",{style:jt,children:(0,t.jsx)(u.J,{name:yn.name,value:rt?.name,title:rt.details,active:rt?.selected,onClick:this.onClickMetric,searchTerm:et})}):null}})})]})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:ln.section,children:[(0,t.jsx)(d.J,{description:"Once label values are selected, only possible label combinations are shown.",children:"2. Select labels to search in"}),(0,t.jsx)("div",{children:(0,t.jsx)(v.p,{onChange:this.onChangeLabelSearch,"aria-label":"Filter expression for label",value:$t,"data-testid":f.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.labelNamesFilter})}),(0,t.jsx)("div",{className:ln.list,style:{height:120},children:Sn.map(Ot=>(0,t.jsx)(u.J,{name:Ot.name,loading:Ot.loading,active:Ot.selected,hidden:Ot.hidden,facets:Ot.facets,onClick:this.onClickLabel,searchTerm:$t},Ot.name))})]}),(0,t.jsxs)("div",{className:ln.section,children:[(0,t.jsx)(d.J,{description:"Use the search field to find values across selected labels.",children:"3. Select (multiple) values for your labels"}),(0,t.jsx)("div",{children:(0,t.jsx)(v.p,{onChange:this.onChangeValueSearch,"aria-label":"Filter expression for label values",value:sn,"data-testid":f.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.labelValuesFilter})}),(0,t.jsx)("div",{className:ln.valueListArea,ref:this.valueListsRef,children:En.map(Ot=>(0,t.jsxs)("div",{role:"list","aria-label":`Values for ${Ot.name}`,className:ln.valueListWrapper,children:[(0,t.jsx)("div",{className:ln.valueTitle,children:(0,t.jsx)(u.J,{name:Ot.name,loading:Ot.loading,active:Ot.selected,hidden:Ot.hidden,facets:Ot.facets||Ot.values?.length,onClick:this.onClickLabel})}),(0,t.jsx)(l.Y1,{height:Math.min(200,x*(Ot.values?.length||0)),itemCount:Ot.values?.length||0,itemSize:28,itemKey:jt=>Ot.values[jt].name,width:200,className:ln.valueList,children:({index:jt,style:rt})=>{const tn=Ot.values?.[jt];return tn?(0,t.jsx)("div",{style:rt,children:(0,t.jsx)(u.J,{name:Ot.name,value:tn?.name,active:tn?.selected,onClick:this.onClickValue,searchTerm:sn})}):null}})]},Ot.name))})]})]})]}),(0,t.jsxs)("div",{className:ln.section,children:[(0,t.jsx)(d.J,{children:"4. Resulting selector"}),(0,t.jsx)("div",{"aria-label":"selector",className:ln.selector,children:wn}),Qt&&(0,t.jsx)("div",{className:ln.validationStatus,children:Qt}),(0,t.jsxs)(y.B,{children:[(0,t.jsx)(o.$n,{"data-testid":f.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.useQuery,"aria-label":"Use selector for query button",disabled:On,onClick:this.onClickRunQuery,children:"Use query"}),(0,t.jsx)(o.$n,{"data-testid":f.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.useAsRateQuery,"aria-label":"Use selector as metrics button",variant:"secondary",disabled:On,onClick:this.onClickRunRateQuery,children:"Use as rate query"}),(0,t.jsx)(o.$n,{"data-testid":f.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.validateSelector,"aria-label":"Validate submit button",variant:"secondary",disabled:On,onClick:this.onClickValidate,children:"Validate selector"}),(0,t.jsx)(o.$n,{"data-testid":f.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.clear,"aria-label":"Selector clear button",variant:"secondary",onClick:this.onClickClear,children:"Clear"}),(0,t.jsx)("div",{className:(0,n.cx)(ln.status,(Et||It)&&ln.statusShowing),children:(0,t.jsx)("span",{className:It?ln.error:"",children:It||Et})})]})]})]})}}const I=(0,h.cV)(S);function T(ht){return typeof ht=="object"&&ht!==null&&"isCanceled"in ht}const b=ht=>{let lt=!1;return{promise:new Promise(($t,et)=>{const Et={isCanceled:!0};ht.then(It=>lt?et(Et):$t(It)),ht.catch(It=>et(lt?Et:It))}),cancel(){lt=!0}}};var R=e(84555),A=e(2543),L=e(75357),U=e(39554),W=e(62938),w=e(85828);function N(){const ht=new Map;return ht.set("expandSuggestionDocs","true"),{onDidChangeValue:lt=>{},onDidChangeTarget:lt=>{},onWillSaveState:lt=>{},get:(lt,gt,$t)=>ht.get(lt)??$t,getBoolean:(lt,gt,$t)=>{const et=ht.get(lt);return et!==void 0?et==="true":$t},getNumber:(lt,gt,$t)=>{const et=ht.get(lt);return et!==void 0?parseInt(et,10):$t},store:(lt,gt,$t,et)=>{gt==null?ht.delete(lt):ht.set(lt,gt.toString())},remove:(lt,gt)=>{ht.delete(lt)},keys:(lt,gt)=>Array.from(ht.keys()),logStorage:()=>{console.log("logStorage: not implemented")},migrate:()=>Promise.resolve(void 0),isNew:lt=>!0,flush:lt=>Promise.resolve(void 0)}}let B=null;function V(){return B===null&&(B={storageService:N()}),B}var K=e(53076),H=e(32264),X=e(20719);class k extends Error{constructor(lt){super("should never happen")}}const Y=new K.A({intraMode:1});function Z(ht){let lt=ht.getAllMetricNames();if(H.$.featureToggles.prometheusCodeModeMetricNamesSearch&&lt.length>ht.metricNamesSuggestionLimit){const{monacoSettings:gt}=ht;gt.enableAutocompleteSuggestionsUpdate(),gt.inputInRange?lt=Y.filter(lt,gt.inputInRange)?.slice(0,ht.metricNamesSuggestionLimit).map($t=>lt[$t])??[]:lt=lt.slice(0,ht.metricNamesSuggestionLimit)}return ht.metricNamesToMetrics(lt).map(gt=>({type:"METRIC_NAME",label:gt.name,insertText:gt.name,detail:`${gt.name} : ${gt.type}`,documentation:gt.help}))}const se=X.AW.map(ht=>({type:"FUNCTION",label:ht.label,insertText:ht.insertText??"",detail:ht.detail,documentation:ht.documentation}));async function j(ht){const lt=Z(ht);return[...se,...lt]}const q=["$__interval","$__range","$__rate_interval","1m","5m","10m","30m","1h","1d"].map(ht=>({type:"DURATION",label:ht,insertText:ht}));function ne(ht){return ht.getHistory().slice(0,10).map(gt=>({type:"HISTORY",label:gt,insertText:gt}))}function oe(ht,lt){const gt=[...lt];return ht!==void 0&&gt.push({name:"__name__",value:ht,op:"="}),`{${gt.map(et=>`${et.name}${et.op}"${(0,g.Qn)(et.value)}"`).join(",")}}`}async function z(ht,lt,gt){if(ht===void 0&&lt.length===0)return Promise.resolve(gt.getAllLabelNames());{const $t=oe(ht,lt);return await gt.getSeriesLabels($t,lt)}}async function te(ht,lt,gt,$t,et){return(await z(ht,$t,et)).map(It=>({type:"LABEL_NAME",label:It,insertText:`${It}${lt}`,triggerOnInsert:gt}))}async function le(ht,lt,gt){return te(ht,"=",!0,lt,gt)}async function ie(ht,lt,gt){return te(ht,"",!1,lt,gt)}async function ae(ht,lt,gt,$t){if(ht===void 0&&gt.length===0)return $t.getLabelValues(lt);{const et=oe(ht,gt);return await $t.getSeriesValues(lt,et)}}async function re(ht,lt,gt,$t,et){return(await ae(ht,lt,$t,et)).map(It=>({type:"LABEL_VALUE",label:It,insertText:gt?It:`"${It}"`}))}function ce(ht,lt){switch(ht.type){case"IN_DURATION":return Promise.resolve(q);case"IN_FUNCTION":return j(lt);case"AT_ROOT":return j(lt);case"EMPTY":{const gt=Z(lt),$t=ne(lt);return Promise.resolve([...$t,...se,...gt])}case"IN_LABEL_SELECTOR_NO_LABEL_NAME":return le(ht.metricName,ht.otherLabels,lt);case"IN_GROUPING":return ie(ht.metricName,ht.otherLabels,lt);case"IN_LABEL_SELECTOR_WITH_LABEL_NAME":return re(ht.metricName,ht.labelName,ht.betweenQuotes,ht.otherLabels,lt);default:throw new k(ht)}}function me(ht,lt){switch(lt){case"parent":return ht.parent;case"firstChild":return ht.firstChild;case"lastChild":return ht.lastChild;case"nextSibling":return ht.nextSibling;default:throw new k(lt)}}function ee(ht,lt){let gt=ht;for(const[$t,et]of lt)if(gt=me(gt,$t),gt===null||gt.type.id!==et)return null;return gt}function de(ht,lt){return lt.slice(ht.from,ht.to)}function De(ht){const lt=ht.slice(1,ht.length-1);if(ht.startsWith('"')&&ht.endsWith('"'))return lt.replace(/\\"/,'"');if(ht.startsWith("'")&&ht.endsWith("'"))return lt.replace(/\\'/,"'");if(ht.startsWith("`")&&ht.endsWith("`"))return lt;throw new Error("FIXME: invalid string literal")}function fe(ht,lt){return ht.every((gt,$t)=>gt===lt[$t])}const Te=0,je=[{path:[R.ww,R.Fb],fun:xt},{path:[R.ab],fun:Je},{path:[R.Dh],fun:st},{path:[R.LW,R.BG],fun:Xe},{path:[Te,R.df,R.ab],fun:Je},{path:[Te,R.BG],fun:Xe},{path:[Te,R.l4],fun:pt},{path:[R.x$],fun:Ke}],He=new Map([[R.Hl,"="],[R.Ed,"=~"],[R.l3,"!="],[R.$i,"!~"]]);function Be(ht){const lt=ht.firstChild;return lt===null?null:He.get(lt.type.id)??null}function Ne(ht,lt){if(ht.type.id!==R.BG)return null;const gt=ee(ht,[["firstChild",R.IC]]);if(gt===null)return null;const $t=ee(gt,[["nextSibling",R.Lf]]);if($t===null)return null;const et=Be($t);if(et===null)return null;const Et=ee(ht,[["lastChild",R.LW]]);if(Et===null)return null;const It=de(gt,lt),Qt=De(de(Et,lt));return{name:It,value:Qt,op:et}}function Re(ht,lt){return ht.type.id!==R.ww?[]:ht.getChildren(R.BG).map($t=>Ne($t,lt)).filter(ve)}function Se(ht){let lt=ht.firstChild;const gt=[];for(;lt!==null;)gt.push(lt),lt=lt.nextSibling;return gt}function We(ht,lt){if(ht.type.id===lt)return ht;const gt=Se(ht);for(const $t of gt){const et=We($t,lt);if(et!==null)return et}return null}function Ke(ht,lt,gt){const $t=ee(ht,[["parent",R.hI],["parent",R.Fn]]);if($t===null)return null;const et=$t.getChild(R.Dh);if(et===null)return null;const Et=We(et,R.gw);return Et===null?null:{type:"IN_GROUPING",metricName:de(Et,lt),otherLabels:[]}}function Xe(ht,lt,gt){const $t=!ht.type.isError,et=ee(ht,[["parent",R.BG]]);if(et===null)return null;const Et=ee(et,[["firstChild",R.IC]]);if(Et===null)return null;const It=de(Et,lt),Qt=ee(et,[["parent",R.ww]]);if(Qt===null)return null;const ln=Re(Qt,lt).filter(En=>En.name!==It),yn=ee(Qt,[["parent",R.Fb],["firstChild",R.gw]]);return yn===null?{type:"IN_LABEL_SELECTOR_WITH_LABEL_NAME",labelName:It,betweenQuotes:$t,otherLabels:ln}:{type:"IN_LABEL_SELECTOR_WITH_LABEL_NAME",metricName:de(yn,lt),labelName:It,betweenQuotes:$t,otherLabels:ln}}function Je(ht,lt,gt){return{type:"AT_ROOT"}}function st(ht,lt,gt){return{type:"IN_FUNCTION"}}function pt(ht,lt,gt){return{type:"IN_DURATION"}}function xt(ht,lt,gt){const $t=ee(ht,[["firstChild",R.BG]]);if($t!==null&&!lt.slice($t.to,gt).includes(","))return null;const et=ee(ht,[["parent",R.Fb],["firstChild",R.gw]]),Et=Re(ht,lt);return et===null?{type:"IN_LABEL_SELECTOR_NO_LABEL_NAME",otherLabels:Et}:{type:"IN_LABEL_SELECTOR_NO_LABEL_NAME",metricName:de(et,lt),otherLabels:Et}}function ot(ht,lt){const gt=ht.cursorAt(lt);for(;;){if(gt.from===lt&&gt.to===lt){const{node:$t}=gt;if($t.type.isError)return $t}if(!gt.next())break}return null}function $e(ht,lt){if(ht==="")return{type:"EMPTY"};const gt=R.K3.parse(ht),$t=ot(gt,lt),et=$t!=null?$t.cursor():gt.cursorAt(lt),Et=et.node,It=[et.type.id];for(;et.parent();)It.push(et.type.id);for(let Qt of je)if(fe(Qt.path,It))return Qt.fun(Et,ht,lt);return null}function ve(ht){return ht!=null}function be(){return{showWords:!1}}function he(ht,lt){switch(ht){case"DURATION":return lt.languages.CompletionItemKind.Unit;case"FUNCTION":return lt.languages.CompletionItemKind.Variable;case"HISTORY":return lt.languages.CompletionItemKind.Snippet;case"LABEL_NAME":return lt.languages.CompletionItemKind.Enum;case"LABEL_VALUE":return lt.languages.CompletionItemKind.EnumMember;case"METRIC_NAME":return lt.languages.CompletionItemKind.Constructor;default:throw new k(ht)}}function ye(ht,lt){return{triggerCharacters:["{",",","[","(","=","~"," ",'"'],provideCompletionItems:($t,et)=>{const Et=$t.getWordAtPosition(et),It=Et!=null?ht.Range.lift({startLineNumber:et.lineNumber,endLineNumber:et.lineNumber,startColumn:Et.startColumn,endColumn:Et.endColumn}):ht.Range.fromPositions(et),Qt={column:et.column,lineNumber:et.lineNumber};if(lt.monacoSettings.setInputInRange($t.getValueInRange(It)),window.getSelection){const Sn=window.getSelection()?.toString();Sn&&Sn.length>0&&(Qt.column=Qt.column-Sn.length)}const sn=$t.getOffsetAt(Qt),ln=$e($t.getValue(),sn);return(ln!=null?ce(ln,lt):Promise.resolve([])).then(Sn=>{const En=Sn.length.toString().length;return{suggestions:Sn.map((On,Rt)=>({kind:he(On.type,ht),label:On.label,insertText:On.insertText,detail:On.detail,documentation:On.documentation,sortText:Rt.toString().padStart(En,"0"),range:It,command:On.triggerOnInsert?{id:"editor.action.triggerSuggest",title:""}:void 0})),incomplete:lt.monacoSettings.suggestionsIncomplete}})}}}var Pe=e(91306);const ge=0;function xe(ht,lt,gt,$t){if(!ht)return!1;const et=Ae(lt,$t);if(!et.length)return!1;let Et=et;if(ht!==lt){const It=Ae(ht,$t);Et=et.flatMap(Qt=>It.filter(sn=>Qt.text===sn.text)||Qt)}return Et.map(It=>Ee(ht,gt,It)).filter(Ie)}function Ae(ht,lt){const gt=[];return lt.parse(ht).iterate({enter:et=>{if(et.type.id===ge){const Et=et.node;gt.push({node:Et,text:ht.substring(Et.from,Et.to)})}}}),gt}function Ee(ht,lt,gt){if(lt.length===1){const Et=gt.node.from===gt.node.to,It=Et&&gt.node.parent?gt.node.parent:gt.node,Qt=Et?ht.substring(It.from,It.to):gt.text;return{startLineNumber:1,startColumn:It.from+1,endLineNumber:1,endColumn:It.to+1,error:Qt}}let $t=0,et=0;for(let Et=0;Et<lt.length;Et++){if(et=$t+lt[Et].length,gt.node.from>et){$t+=lt[Et].length+1;continue}return{startLineNumber:Et+1,startColumn:gt.node.from-$t+1,endLineNumber:Et+1,endColumn:gt.node.to-$t+1,error:gt.text}}return null}function Ie(ht){return ht!==null}const Qe={__interval:{text:"1s",value:"1s"},__rate_interval:{text:"1s",value:"1s"},__auto:{text:"1s",value:"1s"},__interval_ms:{text:"1000",value:1e3},__range_ms:{text:"1000",value:1e3},__range_s:{text:"1",value:1},__range:{text:"1s",value:"1s"}},at={wordPattern:/(-?\d*\.\d\w*)|([^`~!#%^&*()\-=+\[{\]}\\|;:'",.<>\/?\s]+)/g,comments:{lineComment:"#"},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"<",close:">"}],folding:{}},ft=["sum","min","max","avg","group","stddev","stdvar","count","count_values","bottomk","topk","quantile"],ct=["abs","absent","ceil","changes","clamp_max","clamp_min","day_of_month","day_of_week","days_in_month","delta","deriv","exp","floor","histogram_quantile","histogram_avg","histogram_count","histogram_sum","histogram_fraction","histogram_stddev","histogram_stdvar","holt_winters","hour","idelta","increase","irate","label_join","label_replace","ln","log2","log10","minute","month","predict_linear","rate","resets","round","scalar","sort","sort_desc","sqrt","time","timestamp","vector","year"],vt=[];for(let ht=0,lt=ft;ht<lt.length;ht++){let gt=lt[ht];vt.push(gt+"_over_time")}const Pt=["on","ignoring","group_right","group_left","by","without"],Vt="("+Pt.reduce(function(ht,lt){return ht+"|"+lt})+")",Jt=["+","-","*","/","%","^","==","!=",">","<",">=","<=","and","or","unless"],wt=["offset"],on={ignoreCase:!1,defaultToken:"",tokenPostfix:".promql",keywords:ft.concat(ct).concat(vt).concat(Pt).concat(wt),operators:Jt,vectorMatching:Vt,symbols:/[=><!~?:&|+\-*\/^%]+/,escapes:/\\(?:[abfnrtv\\"']|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})/,digits:/\d+(_+\d+)*/,octaldigits:/[0-7]+(_+[0-7]+)*/,binarydigits:/[0-1]+(_+[0-1]+)*/,hexdigits:/[[0-9a-fA-F]+(_+[0-9a-fA-F]+)*/,integersuffix:/(ll|LL|u|U|l|L)?(ll|LL|u|U|l|L)?/,floatsuffix:/[fFlL]?/,tokenizer:{root:[[/@vectorMatching\s*(?=\()/,"type","@clauses"],[/[a-z_]\w*(?=\s*(=|!=|=~|!~))/,"tag"],[/(^#.*$)/,"comment"],[/[a-zA-Z_]\w*/,{cases:{"@keywords":"type","@default":"identifier"}}],[/"([^"\\]|\\.)*$/,"string.invalid"],[/'([^'\\]|\\.)*$/,"string.invalid"],[/"/,"string","@string_double"],[/'/,"string","@string_single"],[/`/,"string","@string_backtick"],{include:"@whitespace"},[/[{}()\[\]]/,"@brackets"],[/[<>](?!@symbols)/,"@brackets"],[/@symbols/,{cases:{"@operators":"delimiter","@default":""}}],[/\d+[smhdwy]/,"number"],[/\d*\d+[eE]([\-+]?\d+)?(@floatsuffix)/,"number.float"],[/\d*\.\d+([eE][\-+]?\d+)?(@floatsuffix)/,"number.float"],[/0[xX][0-9a-fA-F']*[0-9a-fA-F](@integersuffix)/,"number.hex"],[/0[0-7']*[0-7](@integersuffix)/,"number.octal"],[/0[bB][0-1']*[0-1](@integersuffix)/,"number.binary"],[/\d[\d']*\d(@integersuffix)/,"number"],[/\d(@integersuffix)/,"number"]],string_double:[[/[^\\"]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/"/,"string","@pop"]],string_single:[[/[^\\']+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/'/,"string","@pop"]],string_backtick:[[/[^\\`$]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/`/,"string","@pop"]],clauses:[[/[^(,)]/,"tag"],[/\)/,"identifier","@pop"]],whitespace:[[/[ \t\r\n]+/,"white"]]}},Pn={codeLens:!1,contextmenu:!1,fixedOverflowWidgets:!0,folding:!1,fontSize:14,lineDecorationsWidth:8,lineNumbers:"off",minimap:{enabled:!1},overviewRulerBorder:!1,overviewRulerLanes:0,padding:{top:4,bottom:5},renderLineHighlight:"none",scrollbar:{vertical:"hidden",verticalScrollbarSize:8,horizontal:"hidden",horizontalScrollbarSize:0,alwaysConsumeMouseWheel:!1},scrollBeyondLastLine:!1,suggest:be(),suggestFontSize:12,wordWrap:"on"},_n=2,Cn=L.promLanguageDefinition.id;let Ye=!1;function Dt(ht){if(Ye===!1){Ye=!0;const{aliases:lt,extensions:gt,mimetypes:$t}=L.promLanguageDefinition;ht.languages.register({id:Cn,aliases:lt,extensions:gt,mimetypes:$t}),ht.languages.setMonarchTokensProvider(Cn,on),ht.languages.setLanguageConfiguration(Cn,at)}}const yt=(ht,lt)=>({container:(0,n.css)({borderRadius:ht.shape.radius.default,border:`1px solid ${ht.components.input.borderColor}`,display:"flex",flexDirection:"row",justifyContent:"start",alignItems:"center",height:"100%"}),placeholder:(0,n.css)({"::after":{content:`'${lt}'`,fontFamily:ht.typography.fontFamilyMonospace,opacity:.6}})}),an=ht=>{const lt=(0,W.A)(),gt=(0,i.useRef)(V()),$t=(0,i.useRef)(null),{languageProvider:et,history:Et,onBlur:It,onRunQuery:Qt,initialValue:sn,placeholder:ln,onChange:yn,datasource:Sn}=ht,En=(0,U.A)(et),wn=(0,U.A)(Et),On=(0,U.A)(Qt),Rt=(0,U.A)(It),Ot=(0,U.A)(yn),jt=(0,i.useRef)(null),rt=(0,h.$j)(),tn=yt(rt,ln);return(0,i.useEffect)(()=>()=>{jt.current?.()},[]),(0,t.jsx)("div",{"data-testid":f.Tp.components.QueryField.container,className:tn.container,ref:$t,children:(0,t.jsx)(w.m,{overrideServices:gt.current,options:Pn,language:"promql",value:sn,beforeMount:Mn=>{Dt(Mn)},onMount:(Mn,kn)=>{const Yn=Mn.createContextKey("isEditorFocused"+lt,!1);Mn.onDidBlurEditorWidget(()=>{Yn.set(!1),Rt.current(Mn.getValue())}),Mn.onDidFocusEditorText(()=>{Yn.set(!0)});const Wn=new Pe.M9({historyProvider:wn.current,languageProvider:En.current}),Jn=ye(kn,Wn),Ls={...Jn,provideCompletionItems:(Ps,Zs,Ms,ks)=>Mn.getModel()?.id!==Ps.id?{suggestions:[]}:Jn.provideCompletionItems(Ps,Zs,Ms,ks)},{dispose:fs}=kn.languages.registerCompletionItemProvider(Cn,Ls);jt.current=fs;const ys=()=>{const Ps=$t.current;if(Ps!==null){const Zs=Mn.getContentHeight();Ps.style.height=`${Zs+_n}px`,Ps.style.width="100%";const Ms=Ps.clientWidth;Mn.layout({width:Ms,height:Zs})}};Mn.onDidContentSizeChange(ys),ys();const Xn=(0,A.debounce)(()=>{const Ps=Mn.getValue();Ot.current(Ps)},En.current.datasource.getDebounceTimeInMilliseconds());if(Mn.getModel()?.onDidChangeContent(()=>{Xn()}),Mn.addCommand(kn.KeyMod.Shift|kn.KeyCode.Enter,()=>{On.current(Mn.getValue())},"isEditorFocused"+lt),kn.editor.addKeybindingRule({keybinding:kn.KeyMod.CtrlCmd|kn.KeyCode.KeyF,command:null}),Mn.addCommand(kn.KeyMod.CtrlCmd|kn.KeyCode.KeyK,function(){e.g.dispatchEvent(new KeyboardEvent("keydown",{key:"k",metaKey:!0}))}),ln){const Ps=[{range:new kn.Range(1,1,1,1),options:{className:tn.placeholder,isWholeLine:!0}}];let Zs=[];const Ms=()=>{const ks=Mn.getModel();if(!ks)return;const wa=ks.getValueLength()===0?Ps:[];Zs=ks.deltaDecorations(Zs,wa)};Ms(),Mn.onDidChangeModelContent(Ms),Mn.onDidChangeModelContent(ks=>{const wa=Mn.getModel();if(!wa)return;const Xa=wa.getValue(),Ba=(xe(Xa,Sn.interpolateString(Xa,Qe),wa.getLinesContent(),R.K3)||[]).map(({error:_a,...dr})=>({message:`${_a?`Error parsing "${_a}"`:"Parse error"}. The query appears to be incorrect and could fail to be executed.`,severity:kn.MarkerSeverity.Error,...dr}));kn.editor.setModelMarkers(wa,"owner",Ba)})}}})})},un=ht=>(0,t.jsx)(i.Suspense,{fallback:null,children:(0,t.jsx)(an,{...ht})}),hn=ht=>{const lt=(0,i.useRef)(null),{onRunQuery:gt,onChange:$t,...et}=ht,Et=sn=>{lt.current=sn,$t(sn),gt()},It=sn=>{$t(sn)},Qt=sn=>{$t(sn)};return(0,t.jsx)(un,{onChange:Qt,onRunQuery:Et,onBlur:It,...et})},Un="grafana.datasources.prometheus.browser.labels";function Nn(ht,lt,gt){return ht?"(Disabled)":lt?gt?"Metrics browser":"(No metrics found)":"Loading metrics..."}class St extends i.PureComponent{constructor(lt){super(lt),this.refreshHint=()=>{const{datasource:gt,query:$t,data:et}=this.props,Et=gt.getInitHints(),It=Et.length>0?Et[0]:null;if(!et||et.series.length===0){this.setState({hint:It});return}const Qt=(0,s.ci)(et.series[0])?et.series.map(s.w3):et.series,sn=gt.getQueryHints($t,Qt);let ln=sn.length>0?sn[0]:null;this.setState({hint:ln??It})},this.refreshMetrics=async()=>{const{range:gt,datasource:{languageProvider:$t}}=this.props;this.languageProviderInitializationPromise=b($t.start(gt));try{const et=await this.languageProviderInitializationPromise.promise;await Promise.all(et),this.onUpdateLanguage()}catch(et){if(!(T(et)&&et.isCanceled))throw et}},this.onChangeLabelBrowser=gt=>{this.onChangeQuery(gt,!0),this.setState({labelBrowserVisible:!1})},this.onChangeQuery=(gt,$t)=>{const{query:et,onChange:Et,onRunQuery:It}=this.props;if(Et){const Qt={...et,expr:gt};Et(Qt),$t&&It&&It()}},this.onClickChooserButton=()=>{this.setState(gt=>({labelBrowserVisible:!gt.labelBrowserVisible})),(0,a.rR)("user_grafana_prometheus_metrics_browser_clicked",{editorMode:this.state.labelBrowserVisible?"metricViewClosed":"metricViewOpen",app:this.props?.app??""})},this.onClickHintFix=()=>{const{datasource:gt,query:$t,onChange:et,onRunQuery:Et}=this.props,{hint:It}=this.state;It?.fix?.action&&et(gt.modifyQuery($t,It.fix.action)),Et()},this.onUpdateLanguage=()=>{const{datasource:{languageProvider:gt}}=this.props,{metrics:$t}=gt;$t&&this.setState({syntaxLoaded:!0})},this.state={labelBrowserVisible:!1,syntaxLoaded:!1,hint:null}}componentDidMount(){this.props.datasource.languageProvider&&this.refreshMetrics(),this.refreshHint()}componentWillUnmount(){this.languageProviderInitializationPromise&&this.languageProviderInitializationPromise.cancel()}componentDidUpdate(lt){const{data:gt,datasource:{languageProvider:$t},range:et}=this.props;$t!==lt.datasource.languageProvider&&this.setState({syntaxLoaded:!1});const Et=this.rangeChangedToRefresh(et,lt.range);($t!==lt.datasource.languageProvider||Et)&&this.refreshMetrics(),gt&&lt.data&&lt.data.series!==gt.series&&this.refreshHint()}rangeChangedToRefresh(lt,gt){if(lt&&gt){const $t=(0,g.eN)(lt.from.valueOf())===(0,g.eN)(gt.from.valueOf()),et=(0,g.eN)(lt.to.valueOf())===(0,g.eN)(gt.to.valueOf());return!($t&&et)}return!1}render(){const{datasource:lt,datasource:{languageProvider:gt},query:$t,ExtraFieldElement:et,history:Et=[],theme:It}=this.props,{labelBrowserVisible:Qt,syntaxLoaded:sn,hint:ln}=this.state,yn=gt.metrics.length>0,Sn=Nn(lt.lookupsDisabled,sn,yn),En=!(sn&&yn);return(0,t.jsx)(r.b,{storageKey:Un,defaultValue:[],children:(wn,On,Rt)=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"gf-form-inline gf-form-inline--xs-view-flex-column flex-grow-1","data-testid":this.props["data-testid"],children:[(0,t.jsxs)("button",{className:"gf-form-label query-keyword pointer",onClick:this.onClickChooserButton,disabled:En,type:"button","data-testid":f.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.openButton,children:[Sn,(0,t.jsx)(c.I,{name:Qt?"angle-down":"angle-right"})]}),(0,t.jsx)("div",{className:"flex-grow-1 min-width-15",children:(0,t.jsx)(hn,{languageProvider:gt,history:Et,onChange:this.onChangeQuery,onRunQuery:this.props.onRunQuery,initialValue:$t.expr??"",placeholder:"Enter a PromQL query\u2026",datasource:lt})})]}),Qt&&(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(I,{languageProvider:gt,onChange:this.onChangeLabelBrowser,lastUsedLabels:wn||[],storeLastUsedLabels:On,deleteLastUsedLabels:Rt,timeRange:this.props.range})}),et,ln?(0,t.jsx)("div",{className:(0,n.css)({flexBasis:"100%"}),children:(0,t.jsxs)("div",{className:"text-warning",children:[ln.label," ",ln.fix?(0,t.jsx)("button",{type:"button",className:(0,n.cx)((0,o.my)(It),"text-link","muted"),onClick:this.onClickHintFix,children:ln.fix.label}):null]})}):null]})})}}const nn=(0,h.cV)(St)},91306:(G,O,e)=>{"use strict";e.d(O,{M9:()=>i,Ol:()=>n,w0:()=>t});const t="codeModeSuggestionsIncomplete";function n(s){return s.type===t&&"detail"in s&&typeof s.detail=="object"&&s.detail!==null&&"limit"in s.detail&&"datasourceUid"in s.detail}class i{constructor(r){this.languageProvider=r.languageProvider,this.historyProvider=r.historyProvider,this.inputInRange="",this.metricNamesSuggestionLimit=this.languageProvider.datasource.metricNamesAutocompleteSuggestionLimit,this.suggestionsIncomplete=!1,this.getSeriesLabels=this.languageProvider.getSeriesLabels.bind(this.languageProvider),this.getSeriesValues=this.languageProvider.getSeriesValues.bind(this.languageProvider),this.getAllLabelNames=this.languageProvider.getLabelKeys.bind(this.languageProvider),this.getLabelValues=this.languageProvider.getLabelValues.bind(this.languageProvider)}getHistory(){return this.historyProvider.map(r=>r.query.expr).filter(Boolean)}getAllMetricNames(){return this.languageProvider.metrics}metricNamesToMetrics(r){const{metricsMetadata:f}=this.languageProvider;return r.map(c=>{const o=f?.[c];return{name:c,help:o?.help??"",type:o?.type??""}})}enableAutocompleteSuggestionsUpdate(){this.suggestionsIncomplete=!0,dispatchEvent(new CustomEvent(t,{detail:{limit:this.metricNamesSuggestionLimit,datasourceUid:this.languageProvider.datasource.uid}}))}setInputInRange(r){this.inputInRange=r}get monacoSettings(){return{enableAutocompleteSuggestionsUpdate:this.enableAutocompleteSuggestionsUpdate.bind(this),inputInRange:this.inputInRange,setInputInRange:this.setInputInRange.bind(this),suggestionsIncomplete:this.suggestionsIncomplete}}}},4936:(G,O,e)=>{"use strict";e.d(O,{TT:()=>a,Zh:()=>c,jW:()=>f,k1:()=>s});var t=e(74848),n=e(32196),i=e(72093);const s=30,r=o=>{const{options:h,onOptionsChange:g}=o,l=useTheme2(),p=c(l);return jsxs(Fragment,{children:[h.access==="direct"&&jsx(Alert,{title:"Error",severity:"error",children:"Browser access mode in the Prometheus data source is no longer available. Switch to server access mode."}),jsx(DataSourceDescription,{dataSourceName:"Prometheus",docsLink:"https://grafana.com/docs/grafana/latest/datasources/prometheus/configure-prometheus-data-source/"}),jsx("hr",{className:`${p.hrTopSpace} ${p.hrBottomSpace}`}),jsx(DataSourceHttpSettingsOverhaul,{options:h,onOptionsChange:g,secureSocksDSProxyEnabled:config.secureSocksDSProxyEnabled}),jsx("hr",{}),jsxs(ConfigSection,{className:p.advancedSettings,title:"Advanced settings",description:"Additional settings are optional settings that can be configured for more control over your data source.",children:[jsx(AdvancedHttpSettings,{className:p.advancedHTTPSettingsMargin,config:h,onChange:g}),jsx(AlertingSettingsOverhaul,{options:h,onOptionsChange:g}),jsx(PromSettings,{options:h,onOptionsChange:g})]})]})};function f(o){return(0,t.jsx)("a",{href:o||"https://grafana.com/docs/grafana/latest/datasources/prometheus/#configure-the-data-source",target:"_blank",rel:"noopener noreferrer",children:"Visit docs for more details here."})}const a=(o,h,g)=>{const l="Value is not valid";return o&&!o.match(h)?(0,t.jsx)(i.P,{children:g||l}):!0};function c(o){return{additionalSettings:(0,n.css)({marginBottom:"25px"}),secondaryGrey:(0,n.css)({color:o.colors.secondary.text,opacity:"65%"}),inlineError:(0,n.css)({margin:"0px 0px 4px 245px"}),switchField:(0,n.css)({alignItems:"center"}),sectionHeaderPadding:(0,n.css)({paddingTop:"32px"}),sectionBottomPadding:(0,n.css)({paddingBottom:"28px"}),subsectionText:(0,n.css)({fontSize:"12px"}),hrBottomSpace:(0,n.css)({marginBottom:"56px"}),hrTopSpace:(0,n.css)({marginTop:"50px"}),textUnderline:(0,n.css)({textDecoration:"underline"}),versionMargin:(0,n.css)({marginBottom:"12px"}),advancedHTTPSettingsMargin:(0,n.css)({margin:"24px 0 8px 0"}),advancedSettings:(0,n.css)({paddingTop:"32px"}),alertingTop:(0,n.css)({marginTop:"40px !important"}),overhaulPageHeading:(0,n.css)({fontWeight:400}),container:(0,n.css)({maxwidth:578})}}},75212:(G,O,e)=>{"use strict";e.d(O,{gs:()=>ot,UD:()=>$e});var t=e(2543),n=e(13288),i=e(75505),s=e(81160),r=e(59099),f=e(97716),a=e.n(f),c=e(65879),o=e(43659),h=e(43127),g=e(47232),l=e(37891),p=e(41987),m=e(26657),y=e(72574),d=e(47773),v=e(17172),u=e(32264),D=e(80937),P=e(74848),x=e(13544),E=e(71087),C=e(9e4),M=e(81580),S=e(79458),I=e(51440),T=e(68402),b=e(10354),R=e(80109);function A(Pe){const ge=Pe.annotation,xe=Pe.onAnnotationChange,Ae={expr:ge.expr,refId:ge.name,interval:ge.step};return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsxs)(E.D,{children:[(0,P.jsx)(R.$,{...Pe,query:Ae,showExplain:!1,onChange:Ee=>{xe({...ge,expr:Ee.expr})}}),(0,P.jsx)(C.U,{children:(0,P.jsx)(M.c,{label:"Min step",tooltip:(0,P.jsxs)(P.Fragment,{children:["An additional lower limit for the step parameter of the Prometheus query and for the"," ",(0,P.jsx)("code",{children:"$__interval"})," and ",(0,P.jsx)("code",{children:"$__rate_interval"})," variables."]}),children:(0,P.jsx)(I.D,{type:"text","aria-label":"Set lower limit for the step parameter",placeholder:"auto",minWidth:10,onCommitChange:Ee=>{xe({...ge,step:Ee.currentTarget.value})},defaultValue:Ae.interval,id:x.Tp.components.DataSource.Prometheus.annotations.minStep})})})]}),(0,P.jsx)(T.$,{v:.5}),(0,P.jsxs)(C.U,{children:[(0,P.jsx)(M.c,{label:"Title",tooltip:"Use either the name or a pattern. For example, {{instance}} is replaced with label value for the label instance.",children:(0,P.jsx)(b.p,{type:"text",placeholder:"{{alertname}}",value:ge.titleFormat,onChange:Ee=>{xe({...ge,titleFormat:Ee.currentTarget.value})},"data-testid":x.Tp.components.DataSource.Prometheus.annotations.title})}),(0,P.jsx)(M.c,{label:"Tags",children:(0,P.jsx)(b.p,{type:"text",placeholder:"label1,label2",value:ge.tagKeys,onChange:Ee=>{xe({...ge,tagKeys:Ee.currentTarget.value})},"data-testid":x.Tp.components.DataSource.Prometheus.annotations.tags})}),(0,P.jsx)(M.c,{label:"Text",tooltip:"Use either the name or a pattern. For example, {{instance}} is replaced with label value for the label instance.",children:(0,P.jsx)(b.p,{type:"text",placeholder:"{{instance}}",value:ge.textFormat,onChange:Ee=>{xe({...ge,textFormat:Ee.currentTarget.value})},"data-testid":x.Tp.components.DataSource.Prometheus.annotations.text})}),(0,P.jsx)(M.c,{label:"Series value as timestamp",tooltip:"The unit of timestamp is milliseconds. If the unit of the series value is seconds, multiply its range vector by 1000.",children:(0,P.jsx)(S.C,{value:ge.useValueForTime,onChange:Ee=>{xe({...ge,useValueForTime:Ee.currentTarget.value})},"data-testid":x.Tp.components.DataSource.Prometheus.annotations.seriesValueAsTimestamp})})]})]})}var L=e(50556),U=e(81996),W=e(32370),w=e(76040),N=e(62183);const B=/^label_names\(\)\s*$/,V=/^label_values\((?:(.+),\s*)?([a-zA-Z_$][a-zA-Z0-9_]*)\)\s*$/,K=/^metrics\((.+)\)\s*$/,H=/^query_result\((.+)\)\s*$/,X=/^label_names\((.+)\)\s*$/;function k(Pe){if(typeof Pe!="string")return Pe;const ge={refId:"PrometheusDatasource-VariableQuery",qryType:N.B4.LabelNames},xe=Pe.match(X);if(xe)return{...ge,qryType:N.B4.LabelNames,match:xe[1]};const Ae=Pe.match(B);if(Ae)return{...ge,qryType:N.B4.LabelNames};const Ee=Pe.match(/^label_values\(/);if(Ee){const at=Pe.match(V),ft=at?at[2]:"",ct=at?at[1]:"";if(ct){const vt=(0,w.u)(ct);return{...ge,qryType:N.B4.LabelValues,label:ft,metric:vt.query.metric,labelFilters:vt.query.labels}}else return{...ge,qryType:N.B4.LabelValues,label:ft}}const Ie=Pe.match(/^metrics\(/);if(Ie){const at=Pe.match(K),ft=at?at[1]:"";return{...ge,qryType:N.B4.MetricNames,metric:ft}}const Qe=Pe.match(/^query_result\(/);if(Qe){const at=Pe.match(H),ft=at?at[1]:"";return{...ge,qryType:N.B4.VarQueryResult,varQuery:ft}}return!Ae&&!Ee&&!Ie&&!Qe?{...ge,qryType:N.B4.SeriesQuery,seriesQuery:Pe}:ge}function Y(Pe){switch(Pe.qryType){case N.B4.LabelNames:return Pe.match?`label_names(${Pe.match})`:"label_names()";case N.B4.LabelValues:if(Pe.metric||Pe.labelFilters&&Pe.labelFilters.length!==0){const xe={metric:Pe.metric,labels:Pe.labelFilters??[],operations:[]};return`label_values(${W.z.renderQuery(xe)},${Pe.label})`}else return`label_values(${Pe.label})`;case N.B4.MetricNames:return`metrics(${Pe.metric})`;case N.B4.VarQueryResult:return`query_result(${Z(Pe.varQuery)})`;case N.B4.SeriesQuery:return Pe.seriesQuery??"";case N.B4.ClassicQuery:return Pe.classicQuery??""}return""}function Z(Pe){return Pe?Pe.replace(/[\r\n]+/gm,""):""}class se{constructor(ge,xe){this.datasource=ge,this.query=xe,this.datasource=ge,this.query=xe,this.range=(0,h.E2)()}process(ge){this.range=ge;const xe=B,Ae=X,Ee=/^label_values\((?:(.+),\s*)?([a-zA-Z_][a-zA-Z0-9_]*)\)\s*$/,Ie=K,Qe=H,at=this.query.match(xe),ft=this.query.match(Ae);if(ft){const Jt=`{__name__=~".*${ft[1]}.*"}`;return this.datasource.languageProvider.getSeriesLabels(Jt,[]).then(wt=>wt.map(zt=>({text:zt})))}if(at)return this.datasource.getTagKeys({filters:[],timeRange:ge});const ct=this.query.match(Ee);if(ct){const Jt=ct[1],wt=ct[2];return j(Jt)?this.labelValuesQuery(wt,Jt):this.labelValuesQuery(wt)}const vt=this.query.match(Ie);if(vt)return this.metricNameQuery(vt[1]);const Pt=this.query.match(Qe);return Pt?this.queryResultQuery(Pt[1]):["label_values()","metrics()","query_result()"].includes(this.query)?Promise.resolve([]):this.metricNameAndLabelsQuery(this.query)}labelValuesQuery(ge,xe){const Ae=(0,U.mv)(this.range.from,!1),Ee=(0,U.mv)(this.range.to,!0),Ie={...xe&&{"match[]":xe},start:Ae.toString(),end:Ee.toString()};if(!xe||this.datasource.hasLabelsMatchAPISupport()){const Qe=`/api/v1/label/${ge}/values`;return this.datasource.metadataRequest(Qe,Ie).then(at=>(0,t.map)(at.data.data,ft=>({text:ft})))}else return this.datasource.metadataRequest("/api/v1/series",Ie).then(at=>{const ft=(0,t.map)(at.data.data,ct=>ct[ge]||"").filter(ct=>ct!=="");return(0,t.uniq)(ft).map(ct=>({text:ct,expandable:!0}))})}metricNameQuery(ge){const xe=(0,U.mv)(this.range.from,!1),Ae=(0,U.mv)(this.range.to,!0),Ee={start:xe.toString(),end:Ae.toString()};return this.datasource.metadataRequest("/api/v1/label/__name__/values",Ee).then(Qe=>(0,t.chain)(Qe.data.data).filter(at=>new RegExp(ge).test(at)).map(at=>({text:at,expandable:!0})).value())}queryResultQuery(ge){const xe="/api/v1/query",Ae={query:ge,time:(0,U.mv)(this.range.to,!0).toString()};return this.datasource.metadataRequest(xe,Ae).then(Ee=>{switch(Ee.data.data.resultType){case"scalar":case"string":return[{text:Ee.data.data.result[1]||"",expandable:!1}];case"vector":return(0,t.map)(Ee.data.data.result,Ie=>{let Qe=Ie.metric.__name__||"";return delete Ie.metric.__name__,Qe+="{"+(0,t.map)(Ie.metric,(at,ft)=>ft+'="'+at+'"').join(",")+"}",Qe+=" "+Ie.value[1]+" "+Ie.value[0]*1e3,{text:Qe,expandable:!0}});default:throw Error(`Unknown/Unhandled result type: [${Ee.data.data.resultType}]`)}})}metricNameAndLabelsQuery(ge){const xe=(0,U.mv)(this.range.from,!1),Ae=(0,U.mv)(this.range.to,!0),Ee={"match[]":ge,start:xe.toString(),end:Ae.toString()},Ie="/api/v1/series",Qe=this;return this.datasource.metadataRequest(Ie,Ee).then(at=>(0,t.map)(at.data.data,ft=>({text:Qe.datasource.getOriginalMetricName(ft),expandable:!0})))}}function j(Pe){return Pe&&Pe.split(" ").join("")!=="{}"}const q=20;function ne(Pe,ge,xe){const Ae=[],Ee=xe?.languageProvider?.metricsMetadata;if(Pe.trim().match(/^\w+_bucket$|^\w+_bucket{.*}$/))Ae.push({type:"HISTOGRAM_QUANTILE",label:"Selected metric has buckets.",fix:{label:"Consider calculating aggregated quantile by adding histogram_quantile().",action:{type:"ADD_HISTOGRAM_QUANTILE",query:Pe}}});else if(Ee&&re(Pe)){const Qe=ie(Pe),{nameMetric:at}=ae(Qe,"histogram",Ee,!1);if(at){const ct="Selected metric is a native histogram.";Ae.push({type:"HISTOGRAM_AVG",label:ct,fix:{label:"Consider calculating the arithmetic average of observed values by adding histogram_avg().",action:{type:"ADD_HISTOGRAM_AVG",query:Pe}}},{type:"HISTOGRAM_COUNT",label:ct,fix:{label:"Consider calculating the count of observations by adding histogram_count().",action:{type:"ADD_HISTOGRAM_COUNT",query:Pe}}},{type:"HISTOGRAM_SUM",label:ct,fix:{label:"Consider calculating the sum of observations by adding histogram_sum().",action:{type:"ADD_HISTOGRAM_SUM",query:Pe}}},{type:"HISTOGRAM_FRACTION",label:ct,fix:{label:"Consider calculating the estimated fraction of observations between the provided lower and upper values by adding histogram_fraction().",action:{type:"ADD_HISTOGRAM_FRACTION",query:Pe}}},{type:"HISTOGRAM_STDDEV",label:ct,fix:{label:"Consider calculating the estimated standard deviation of observations by adding histogram_stddev().",action:{type:"ADD_HISTOGRAM_STDDEV",query:Pe}}},{type:"HISTOGRAM_STDVAR",label:ct,fix:{label:"Consider calculating the estimated standard variance of observations by adding histogram_stdvar().",action:{type:"ADD_HISTOGRAM_STDVAR",query:Pe}}})}}if(Pe.indexOf("rate(")===-1&&Pe.indexOf("increase(")===-1){const Qe=Pe.match(/\b((?<!:)\w+_(total|sum|count)(?!:))\b/);let at=Qe?Qe[1]:"",ft=!1;if(Ee){const ct=ie(Pe),vt=ae(ct,"counter",Ee,ft);at=vt.nameMetric,ft=vt.certain}if(at){const ct=re(Pe);let Pt=`Selected metric ${ft?"is":"looks like"} a counter.`,Vt;ct?Vt={label:"Consider calculating rate of counter by adding rate().",action:{type:"ADD_RATE",query:Pe}}:Pt=`${Pt} Consider calculating rate of counter by adding rate().`,Ae.push({type:"APPLY_RATE",label:Pt,fix:Vt})}}if(xe&&xe.ruleMappings){const Qe=z(Pe,xe.ruleMappings);Ae.push(...Qe)}return ge&&ge.length>=q&&Pe.trim().match(/^\w+$/)&&Ae.push({type:"ADD_SUM",label:"Many time series results returned.",fix:{label:"Consider aggregating with sum().",action:{type:"ADD_SUM",query:Pe,preventSubmit:!0}}}),Ae}function oe(Pe){const ge=[];return Pe.lookupsDisabled&&ge.push({label:"Labels and metrics lookup was disabled in data source settings.",type:"INFO"}),ge}function z(Pe,ge){const xe=[],Ae=Object.keys(ge).reduce((Ee,Ie)=>{if(Pe.search(Ie)===-1)return Ee;if(ge[Ie].length>1){const{idx:Qe,expandedQuery:at,identifier:ft,identifierValue:ct}=te(Pe,Ie,ge[Ie]);return Qe===-1?(xe.push({type:"EXPAND_RULES_WARNING",label:"We found multiple recording rules that match in this query. To expand the recording rule, add an identifier label/value."}),Ee):{...Ee,[Ie]:{expandedQuery:at,identifier:ft,identifierValue:ct}}}else return{...Ee,[Ie]:{expandedQuery:ge[Ie][0].query}}},{});return(0,t.size)(Ae)>0&&xe.push({type:"EXPAND_RULES",label:"Query contains recording rules.",fix:{label:"Expand rules",action:{type:"EXPAND_RULES",query:Pe,options:Ae}}}),xe}function te(Pe,ge,xe){const{query:Ae}=(0,w.u)(Pe),Ee=le(ge,Ae);if(Ee.length===0)return{idx:-1,identifier:"",identifierValue:"",expandedQuery:""};let Ie="",Qe="",at=-1;return Ee.forEach(ft=>{at===-1&&ft.label.search("uuid")!==-1&&(Ie=ft.label,Qe=ft.value)}),xe.forEach((ft,ct)=>{ft.labels&&Object.entries(ft.labels).forEach(([vt,Pt])=>{at===-1&&vt===Ie&&Pt===Qe&&(at=ct)})}),{idx:at,identifier:Ie,identifierValue:Qe,expandedQuery:xe[at]?.query??""}}function le(Pe,ge){if(ge.metric===Pe)return ge.labels;if(ge.binaryQueries)for(let xe=0;xe<ge.binaryQueries.length;xe++){const Ae=le(Pe,ge.binaryQueries[xe].query);if(Ae&&Ae.length>0)return Ae}return[]}function ie(Pe){return Array.from(Pe.matchAll(/\$?[a-zA-Z_:][a-zA-Z0-9_:]*/g)).map(([ge])=>ge).filter(ge=>!ge.startsWith("$")).flatMap(ge=>ge.split(":"))}function ae(Pe,ge,xe,Ae){return{nameMetric:Pe.find(Ie=>{const Qe=xe[Ie];return Qe&&Qe.type.toLowerCase()===ge?(Ae=!0,!0):!1})??"",certain:Ae}}function re(Pe){return Pe.trim().match(/^\w+$|^\w+{.*}$/)}var ce=e(33115),me=e(59809),ee=e(14110);function de(Pe,ge,xe){const{app:Ae,targets:Ee}=ge;if(Ae===p.Jk.Explore)for(const Ie of Ee)(0,ee.rR)("grafana_prometheus_query_executed",{app:Ae,grafana_version:u.$.buildInfo.version,has_data:Pe.data.some(Qe=>Qe.length>0),has_error:Pe.error!==void 0,expr:Ie.expr,format:Ie.format,instant:Ie.instant,range:Ie.range,exemplar:Ie.exemplar,hinting:Ie.hinting,interval:Ie.interval,intervalFactor:Ie.intervalFactor,utcOffsetSec:Ie.utcOffsetSec,legend:Ie.legendFormat,valueWithRefId:Ie.valueWithRefId,requestId:ge.requestId,showingGraph:Ie.showingGraph,showingTable:Ie.showingTable,editor_mode:Ie.editorMode,simultaneously_sent_query_count:Ee.length,time_range_from:ge?.range?.from?.toISOString(),time_range_to:ge?.range?.to?.toISOString(),time_taken:Date.now()-xe.getTime()})}var De=e(62467),fe=e(65474),Te=e(29505),je=e(96540),He=e(39268),Be=e(14186),Ne=e(90182),Re=e(21744),Se=e(29993);const We=[{label:"Label names",value:N.B4.LabelNames},{label:"Label values",value:N.B4.LabelValues},{label:"Metrics",value:N.B4.MetricNames},{label:"Query result",value:N.B4.VarQueryResult},{label:"Series query",value:N.B4.SeriesQuery},{label:"Classic query",value:N.B4.ClassicQuery}],Ke="PrometheusVariableQueryEditor-VariableQuery",Xe=({onChange:Pe,query:ge,datasource:xe,range:Ae})=>{const[Ee,Ie]=(0,je.useState)(void 0),[Qe,at]=(0,je.useState)(""),[ft,ct]=(0,je.useState)(""),[vt,Pt]=(0,je.useState)(""),[Vt,Jt]=(0,je.useState)(""),[wt,zt]=(0,je.useState)(""),[on,Pn]=(0,je.useState)(""),[_n,Cn]=(0,je.useState)([]),[Ye,Dt]=(0,je.useState)([]);(0,je.useEffect)(()=>{xe.languageProvider.start(Ae)},[]),(0,je.useEffect)(()=>{if(ge)if(ge.qryType===N.B4.ClassicQuery)Ie(ge.qryType),Pn(ge.query??"");else{const lt=Je(ge);ct(lt.match??""),Ie(lt.qryType),at(lt.label??""),Pt(lt.metric??""),Dt(lt.labelFilters??[]),Jt(lt.varQuery??""),zt(lt.seriesQuery??""),Pn(lt.classicQuery??"")}},[ge]),(0,je.useEffect)(()=>{if(Ee!==N.B4.LabelValues)return;const lt=xe.getVariables().map(gt=>({label:gt,value:gt}));if(!vt)xe.getTagKeys({filters:[]}).then(gt=>{const $t=gt.map(({text:et})=>({label:et,value:et}));Cn([...lt,...$t])});else{const gt=[{label:"__name__",op:"=",value:vt}],$t=W.z.renderLabels(gt);xe.languageProvider.fetchLabelsWithMatch($t).then(et=>{const It=Object.keys(et).map(Qt=>({label:Qt,value:Qt}));Cn([...lt,...It])})}},[xe,Ee,vt]);const yt=(lt,gt)=>{const Et={...{qryType:Ee,label:Qe,metric:vt,match:ft,varQuery:Vt,seriesQuery:wt,classicQuery:on,refId:"PrometheusVariableQueryEditor-VariableQuery"},...lt,...gt?{labelFilters:gt}:{labelFilters:Ye}},It=Y(Et);Pe({query:It,qryType:Et.qryType,refId:Ke})},Ft=lt=>{Ie(lt.value),lt.value!==N.B4.SeriesQuery&&yt({qryType:lt.value??0})},an=lt=>{const gt=lt&&lt.value?lt.value:"";at(gt),Ee===N.B4.LabelValues&&gt&&yt({label:gt})},un=lt=>{Pt(lt.metric),Dt(lt.labels);const gt=lt.metric,$t=lt.labels??[];Ee===N.B4.LabelValues&&Qe&&(gt||$t)&&yt({qryType:Ee,metric:gt},$t)},hn=lt=>{Ee===N.B4.LabelNames&&yt({qryType:Ee,match:lt})},Un=lt=>{Ee===N.B4.MetricNames&&lt&&yt({metric:lt})},Nn=lt=>{Jt(lt.currentTarget.value)},St=lt=>{zt(lt.currentTarget.value)},nn=lt=>{Pn(lt.currentTarget.value)},ht=(0,je.useCallback)(()=>({metric:vt,labels:Ye,operations:[]}),[vt,Ye]);return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(He.C,{children:(0,P.jsx)(Be.I,{label:"Query type",labelWidth:20,tooltip:(0,P.jsx)("div",{children:"The Prometheus data source plugin provides the following query types for template variables."}),children:(0,P.jsx)(Ne.l6,{placeholder:"Select query type","aria-label":"Query type",onChange:Ft,value:Ee,options:We,width:25,"data-testid":x.Tp.components.DataSource.Prometheus.variableQueryEditor.queryType})})}),Ee===N.B4.LabelValues&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(He.C,{children:(0,P.jsx)(Be.I,{label:"Label",labelWidth:20,required:!0,"aria-labelledby":"label-select",tooltip:(0,P.jsx)("div",{children:"Returns a list of label values for the label name in all metrics unless the metric is specified."}),children:(0,P.jsx)(Ne.l6,{"aria-label":"label-select",onChange:an,value:Qe,options:_n,width:25,allowCustomValue:!0,isClearable:!0,"data-testid":x.Tp.components.DataSource.Prometheus.variableQueryEditor.labelValues.labelSelect})})}),(0,P.jsx)(Se.I,{query:ht(),datasource:xe,onChange:un,variableEditor:!0})]}),Ee===N.B4.LabelNames&&(0,P.jsx)(He.C,{children:(0,P.jsx)(Be.I,{label:"Metric regex",labelWidth:20,"aria-labelledby":"Metric regex",tooltip:(0,P.jsx)("div",{children:"Returns a list of label names, optionally filtering by specified metric regex."}),children:(0,P.jsx)(b.p,{type:"text","aria-label":"Metric regex",placeholder:"Metric regex",value:ft,onBlur:lt=>{ct(lt.currentTarget.value),hn(lt.currentTarget.value)},onChange:lt=>{ct(lt.currentTarget.value)},width:25,"data-testid":x.Tp.components.DataSource.Prometheus.variableQueryEditor.labelnames.metricRegex})})}),Ee===N.B4.MetricNames&&(0,P.jsx)(He.C,{children:(0,P.jsx)(Be.I,{label:"Metric regex",labelWidth:20,"aria-labelledby":"Metric selector",tooltip:(0,P.jsx)("div",{children:"Returns a list of metrics matching the specified metric regex."}),children:(0,P.jsx)(b.p,{type:"text","aria-label":"Metric selector",placeholder:"Metric regex",value:vt,onChange:lt=>{Pt(lt.currentTarget.value)},onBlur:lt=>{Pt(lt.currentTarget.value),Un(lt.currentTarget.value)},width:25,"data-testid":x.Tp.components.DataSource.Prometheus.variableQueryEditor.metricNames.metricRegex})})}),Ee===N.B4.VarQueryResult&&(0,P.jsx)(He.C,{children:(0,P.jsx)(Be.I,{label:"Query",labelWidth:20,tooltip:(0,P.jsx)("div",{children:"Returns a list of Prometheus query results for the query. This can include Prometheus functions, i.e. sum(go_goroutines)."}),children:(0,P.jsx)(Re.f,{type:"text","aria-label":"Prometheus Query",placeholder:"Prometheus Query",value:Vt,onChange:Nn,onBlur:()=>{Ee===N.B4.VarQueryResult&&Vt&&yt({qryType:Ee})},cols:100,"data-testid":x.Tp.components.DataSource.Prometheus.variableQueryEditor.varQueryResult})})}),Ee===N.B4.SeriesQuery&&(0,P.jsx)(He.C,{children:(0,P.jsx)(Be.I,{label:"Series Query",labelWidth:20,tooltip:(0,P.jsx)("div",{children:'Enter a metric with labels, only a metric or only labels, i.e. go_goroutines{instance="localhost:9090"}, go_goroutines, or {instance="localhost:9090"}. Returns a list of time series associated with the entered data.'}),children:(0,P.jsx)(b.p,{type:"text","aria-label":"Series Query",placeholder:"Series Query",value:wt,onChange:St,onBlur:()=>{Ee===N.B4.SeriesQuery&&wt&&yt({qryType:Ee})},width:100,"data-testid":x.Tp.components.DataSource.Prometheus.variableQueryEditor.seriesQuery})})}),Ee===N.B4.ClassicQuery&&(0,P.jsx)(He.C,{children:(0,P.jsx)(Be.I,{label:"Classic Query",labelWidth:20,tooltip:(0,P.jsx)("div",{children:"The original implemetation of the Prometheus variable query editor. Enter a string with the correct query type and parameters as described in these docs. For example, label_values(label, metric)."}),children:(0,P.jsx)(b.p,{type:"text","aria-label":"Classic Query",placeholder:"Classic Query",value:on,onChange:nn,onBlur:()=>{Ee===N.B4.ClassicQuery&&on&&yt({qryType:Ee})},width:100,"data-testid":x.Tp.components.DataSource.Prometheus.variableQueryEditor.classicQuery})})})]})};function Je(Pe){return typeof Pe=="string"?k(Pe):Pe.query?k(Pe.query):Pe}class st extends Te.f5{constructor(ge,xe=(0,y.w)()){super(),this.datasource=ge,this.templateSrv=xe,this.editor=Xe}query(ge){let xe;if(typeof ge.targets[0]=="string"?xe=ge.targets[0]:xe=ge.targets[0].query,!xe)return(0,De.of)({data:[]});const Ae={...ge.scopedVars,__interval:{text:this.datasource.interval,value:this.datasource.interval},__interval_ms:{text:c.intervalToMs(this.datasource.interval),value:c.intervalToMs(this.datasource.interval)},...this.datasource.getRangeScopedVars(ge.range)},Ee=this.templateSrv.replace(xe,Ae,this.datasource.interpolateQueryExpr),Ie=new se(this.datasource,Ee);return(0,fe.H)(Ie.process(ge.range)).pipe((0,s.T)(at=>({data:at})))}}const pt="60s",xt=["api/v1/query","api/v1/query_range","api/v1/series","api/v1/labels"],ot="-Instant";class $e extends m.iy{constructor(ge,xe=(0,y.w)(),Ae){super(ge),this.templateSrv=xe,this.init=async()=>{this.disableRecordingRules||this.loadRules(),this.exemplarsAvailable=await this.areExemplarsAvailable()},this.processAnnotationResponse=(Ee,Ie)=>{const Qe=(0,d.bE)({data:Ie}).data;if(!Qe||!Qe.length)return[];const at=Ee.annotation,{tagKeys:ft="",titleFormat:ct="",textFormat:vt=""}=at,Pt=c.intervalToSeconds(at.step||pt)*1e3,Vt=ft.split(","),Jt=[];for(const wt of Qe){if(wt.fields.length===0)continue;const zt=wt.fields[0],on=wt.fields[1],Pn=on?.labels||{},_n=Object.keys(Pn).filter(an=>Vt.includes(an)).map(an=>Pn[an]),Cn=[];let Ye=0;on.values.forEach(an=>{let un,hn;const Un=zt.values[Ye];Ee.annotation.useValueForTime?(un=Math.floor(parseFloat(an)),hn=1):(un=Math.floor(parseFloat(Un)),hn=parseFloat(an)),Ye++,Cn.push([un,hn])});const yt=Cn.filter(an=>an[1]>0).map(an=>an[0]);let Ft=null;for(const an of yt){if(Ft&&(Ft.timeEnd??0)+Pt>=an){Ft.timeEnd=an;continue}Ft&&Jt.push(Ft),Ft={time:an,timeEnd:an,annotation:at,title:(0,o.j)(ct,Pn),tags:_n,text:(0,o.j)(vt,Pn)}}Ft&&(Ft.timeEnd=yt[yt.length-1],Jt.push(Ft))}return Jt},this.type="prometheus",this.id=ge.id,this.url=ge.url,this.access=ge.access,this.basicAuth=ge.basicAuth,this.withCredentials=!!ge.withCredentials,this.interval=ge.jsonData.timeInterval||"15s",this.queryTimeout=ge.jsonData.queryTimeout,this.httpMethod=ge.jsonData.httpMethod||"GET",this.exemplarTraceIdDestinations=ge.jsonData.exemplarTraceIdDestinations,this.hasIncrementalQuery=ge.jsonData.incrementalQuerying??!1,this.ruleMappings={},this.languageProvider=Ae??new L.Ay(this),this.lookupsDisabled=ge.jsonData.disableMetricsLookup??!1,this.customQueryParameters=new URLSearchParams(ge.jsonData.customQueryParameters),this.datasourceConfigurationPrometheusFlavor=ge.jsonData.prometheusType,this.datasourceConfigurationPrometheusVersion=ge.jsonData.prometheusVersion,this.defaultEditor=ge.jsonData.defaultEditor,this.disableRecordingRules=ge.jsonData.disableRecordingRules??!1,this.variables=new st(this,this.templateSrv),this.exemplarsAvailable=!0,this.cacheLevel=ge.jsonData.cacheLevel??N.fD.Low,this.metricNamesAutocompleteSuggestionLimit=ge.jsonData.codeModeMetricNamesSuggestionLimit??L.OP,this.cache=new ce.$i({getTargetSignature:this.getPrometheusTargetSignature.bind(this),overlapString:ge.jsonData.incrementalQueryOverlapWindow??ce.Dr}),this.annotations={QueryEditor:A}}getQueryDisplayText(ge){return ge.expr}getPrometheusTargetSignature(ge,xe){return`${this.interpolateString(xe.expr)}|${xe.interval??ge.interval}|${JSON.stringify(ge.rangeRaw??"")}|${xe.exemplar}`}hasLabelsMatchAPISupport(){return this._isDatasourceVersionGreaterOrEqualTo("2.24.0",N.N1.Prometheus)||this._isDatasourceVersionGreaterOrEqualTo("2.0.0",N.N1.Mimir)||this._isDatasourceVersionGreaterOrEqualTo("1.11.0",N.N1.Cortex)||this._isDatasourceVersionGreaterOrEqualTo("0.18.0",N.N1.Thanos)}_isDatasourceVersionGreaterOrEqualTo(ge,xe){return!this.datasourceConfigurationPrometheusVersion||!this.datasourceConfigurationPrometheusFlavor?!0:xe!==this.datasourceConfigurationPrometheusFlavor?!1:a().gte(this.datasourceConfigurationPrometheusVersion,ge)}_addTracingHeaders(ge,xe){ge.headers={},this.access==="proxy"&&(ge.headers["X-Dashboard-UID"]=xe.dashboardUID,ge.headers["X-Panel-Id"]=xe.panelId)}directAccessError(){return(0,n.$)(()=>new Error("Browser access mode in the Prometheus datasource is no longer available. Switch to server access mode."))}_request(ge,xe,Ae={}){if(this.access==="direct")return this.directAccessError();xe=xe||{};for(const[Qe,at]of this.customQueryParameters)xe[Qe]==null&&(xe[Qe]=at);let Ee=this.url+ge;ge.startsWith(`/api/datasources/uid/${this.uid}`)&&(Ee=ge);const Ie=(0,t.defaults)(Ae,{url:Ee,method:this.httpMethod,headers:{}});return Ie.method==="GET"?xe&&Object.keys(xe).length&&(Ie.url=Ie.url+(Ie.url.search(/\?/)>=0?"&":"?")+Object.entries(xe).map(([Qe,at])=>`${encodeURIComponent(Qe)}=${encodeURIComponent(at)}`).join("&")):(Ie.headers["Content-Type"]="application/x-www-form-urlencoded",Ie.data=xe),(this.basicAuth||this.withCredentials)&&(Ie.withCredentials=!0),this.basicAuth&&(Ie.headers.Authorization=this.basicAuth),(0,v.AI)().fetch(Ie)}async importFromAbstractQueries(ge){return ge.map(xe=>this.languageProvider.importFromAbstractQuery(xe))}async exportToAbstractQueries(ge){return ge.map(xe=>this.languageProvider.exportToAbstractQuery(xe))}async metadataRequest(ge,xe={},Ae){if(xt.some(Ee=>ge.includes(Ee)))try{return await(0,i.s)(this._request(`/api/datasources/uid/${this.uid}/resources${ge}`,xe,{method:this.httpMethod,hideFromInspector:!0,showErrorAlert:!1,...Ae}))}catch(Ee){if(this.httpMethod==="POST"&&(0,v.NF)(Ee)&&(Ee.status===405||Ee.status===400))console.warn("Couldn't use configured POST HTTP method for this request. Trying to use GET method instead.");else throw Ee}return await(0,i.s)(this._request(`/api/datasources/uid/${this.uid}/resources${ge}`,xe,{method:"GET",hideFromInspector:!0,...Ae}))}interpolateQueryExpr(ge=[],xe){if(!xe.multi&&!xe.includeAll)return he(ge);if(typeof ge=="string")return ye(ge);const Ae=ge.map(Ee=>ye(Ee));return Ae.length===1?Ae[0]:"("+Ae.join("|")+")"}targetContainsTemplate(ge){return this.templateSrv.containsTemplate(ge.expr)}shouldRunExemplarQuery(ge,xe){if(ge.exemplar){const Ae=this.languageProvider.histogramMetrics.find(Qe=>ge.expr.includes(Qe)),Ee=xe.targets.findIndex(Qe=>Qe.refId===ge.refId),Ie=xe.targets.slice(0,Ee).filter(Qe=>!Qe.hide);return!!(!Ae||Ae&&!Ie.some(Qe=>Qe.expr.includes(Ae)))}return!1}processTargetV2(ge,xe){const Ae=[],Ee={...ge,exemplar:this.shouldRunExemplarQuery(ge,xe),requestId:xe.panelId+ge.refId,utcOffsetSec:xe.range.to.utcOffset()*60};return u.$.featureToggles.promQLScope&&(Ee.scopes=(xe.scopes??[]).map(Ie=>({name:Ie.metadata.name,...Ie.spec}))),u.$.featureToggles.groupByVariable&&(Ee.groupByKeys=xe.groupByKeys),ge.instant&&ge.range?Ae.push({...Ee,refId:Ee.refId,instant:!1},{...Ee,refId:Ee.refId+ot,range:!1}):Ae.push(Ee),Ae}query(ge){if(this.access==="direct")return this.directAccessError();let xe,Ae;const Ee=ge.targets.some(at=>at.instant);this.hasIncrementalQuery&&!Ee?(Ae=this.cache.requestInfo(ge),xe=Ae.requests[0]):xe=ge;const Ie=xe.targets.map(at=>this.processTargetV2(at,xe)),Qe=new Date;return super.query({...xe,targets:Ie.flat()}).pipe((0,s.T)(at=>{const ft={...at,data:this.cache.procFrames(ge,Ae,at.data)};return(0,me.J3)(ft,ge,{exemplarTraceIdDestinations:this.exemplarTraceIdDestinations})}),(0,r.M)(at=>{de(at,ge,Qe)}))}metricFindQuery(ge,xe){if(!ge)return Promise.resolve([]);const Ae={__interval:{text:this.interval,value:this.interval},__interval_ms:{text:c.intervalToMs(this.interval),value:c.intervalToMs(this.interval)},...this.getRangeScopedVars(xe?.range??(0,h.E2)())},Ee=this.templateSrv.replace(ge,Ae,this.interpolateQueryExpr);return new se(this,Ee).process(xe?.range??(0,h.E2)())}getRangeScopedVars(ge){const xe=ge.to.diff(ge.from),Ae=Math.round(xe/1e3);return{__range_ms:{text:xe,value:xe},__range_s:{text:Ae,value:Ae},__range:{text:Ae+"s",value:Ae+"s"}}}async annotationQuery(ge){if(this.access==="direct"){const Qe=new Error("Browser access mode in the Prometheus datasource is no longer available. Switch to server access mode.");return Promise.reject(Qe)}const xe=ge.annotation,{expr:Ae=""}=xe;if(!Ae)return Promise.resolve([]);const Ee=ge.annotation.step||pt,Ie={expr:Ae,range:!0,instant:!1,exemplar:!1,interval:Ee,refId:"X",datasource:this.getRef()};return await(0,i.s)((0,v.AI)().fetch({url:"/api/ds/query",method:"POST",headers:this.getRequestHeaders(),data:{from:((0,U.mv)(ge.range.from,!1)*1e3).toString(),to:((0,U.mv)(ge.range.to,!0)*1e3).toString(),queries:[this.applyTemplateVariables(Ie,{})]},requestId:`prom-query-${xe.name}`}).pipe((0,s.T)(Qe=>this.processAnnotationResponse(ge,Qe.data))))}async getTagKeys(ge){if(!ge||ge.filters.length===0)return await this.languageProvider.fetchLabels(ge.timeRange,ge.queries),this.languageProvider.getLabelKeys().map(Ie=>({value:Ie,text:Ie}));const xe=ge.filters.map(Ie=>({label:Ie.key,value:Ie.value,op:Ie.operator})),Ae=W.z.renderLabels(xe);let Ee=await this.languageProvider.fetchLabelsWithMatch(Ae);return Object.keys(Ee).filter(Ie=>!ge.filters.find(Qe=>Qe.key===Ie)).map(Ie=>({value:Ie,text:Ie}))}async getTagValues(ge){const xe=ge.filters.map(Qe=>({label:Qe.key,value:Qe.value,op:Qe.operator})),Ae=W.z.renderLabels(xe);if(this.hasLabelsMatchAPISupport()){const Qe=`[${this.uid}][${ge.key}]`;return(await this.languageProvider.fetchSeriesValuesWithMatch(ge.key,Ae,Qe,ge.timeRange)).map(at=>({value:at,text:at}))}const Ee=this.getTimeRangeParams(ge.timeRange??(0,h.E2)());return(await this.metadataRequest(`/api/v1/label/${ge.key}/values`,Ee))?.data?.data?.map(Qe=>({text:Qe}))??[]}interpolateVariablesInQueries(ge,xe,Ae){let Ee=ge;return ge&&ge.length&&(Ee=ge.map(Ie=>{const Qe=this.templateSrv.replace(Ie.expr,xe,this.interpolateQueryExpr),at=u.$.featureToggles.promQLScope?Qe:this.templateSrv.replace(this.enhanceExprWithAdHocFilters(Ae,Qe),xe,this.interpolateQueryExpr);return{...Ie,...u.$.featureToggles.promQLScope?{adhocFilters:this.generateScopeFilters(Ae)}:{},datasource:this.getRef(),expr:at,interval:this.templateSrv.replace(Ie.interval,xe)}})),Ee}getQueryHints(ge,xe){return ne(ge.expr??"",xe,this)}getInitHints(){return oe(this)}async loadRules(){try{const xe=(await this.metadataRequest("/api/v1/rules",{},{showErrorAlert:!1})).data?.data?.groups;xe&&(this.ruleMappings=be(xe))}catch(ge){console.log("Rules API is experimental. Ignore next error."),console.error(ge)}}async areExemplarsAvailable(){try{return(await this.metadataRequest("/api/v1/query_exemplars",{query:"test",start:(0,g.KQ)().subtract(30,"minutes").valueOf().toString(),end:(0,g.KQ)().valueOf().toString()},{showErrorAlert:!1})).data.status==="success"}catch{return!1}}modifyQuery(ge,xe){let Ae=ge.expr??"";switch(xe.type){case"ADD_FILTER":{const{key:Ee,value:Ie}=xe.options??{};Ee&&Ie&&(Ae=(0,D.t)(Ae,Ee,Ie));break}case"ADD_FILTER_OUT":{const{key:Ee,value:Ie}=xe.options??{};Ee&&Ie&&(Ae=(0,D.t)(Ae,Ee,Ie,"!="));break}case"ADD_HISTOGRAM_QUANTILE":{Ae=`histogram_quantile(0.95, sum(rate(${Ae}[$__rate_interval])) by (le))`;break}case"ADD_HISTOGRAM_AVG":{Ae=`histogram_avg(rate(${Ae}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_FRACTION":{Ae=`histogram_fraction(0,0.2,rate(${Ae}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_COUNT":{Ae=`histogram_count(rate(${Ae}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_SUM":{Ae=`histogram_sum(rate(${Ae}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_STDDEV":{Ae=`histogram_stddev(rate(${Ae}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_STDVAR":{Ae=`histogram_stdvar(rate(${Ae}[$__rate_interval]))`;break}case"ADD_RATE":{Ae=`rate(${Ae}[$__rate_interval])`;break}case"ADD_SUM":{Ae=`sum(${Ae.trim()}) by ($1)`;break}case"EXPAND_RULES":{xe.options&&(Ae=(0,U.P_)(Ae,xe.options));break}default:break}return{...ge,expr:Ae}}getAdjustedInterval(ge){return(0,U.Xd)(this.cacheLevel,ge)}getTimeRangeParams(ge){return{start:(0,U.mv)(ge.from,!1).toString(),end:(0,U.mv)(ge.to,!0).toString()}}getOriginalMetricName(ge){return(0,me.hF)(ge)}generateScopeFilters(ge){return ge?ge.map(xe=>({...xe,value:this.templateSrv.replace(xe.value,{},this.interpolateQueryExpr),operator:l.n[xe.operator]})):[]}enhanceExprWithAdHocFilters(ge,xe){return!ge||ge.length===0?xe:ge.reduce((Ee,Ie)=>{const{key:Qe,operator:at}=Ie;let{value:ft}=Ie;return(at==="=~"||at==="!~")&&(ft=he(ft)),(0,D.t)(Ee,Qe,ft,at)},xe)}filterQuery(ge){return!(ge.hide||!ge.expr)}applyTemplateVariables(ge,xe,Ae){const Ee={...xe};Ee.__interval={value:"$__interval"},Ee.__interval_ms={value:"$__interval_ms"};const Ie=this.templateSrv.replace(ge.expr,Ee,this.interpolateQueryExpr),Qe=u.$.featureToggles.promQLScope?Ie:this.templateSrv.replace(this.enhanceExprWithAdHocFilters(Ae,Ie),Ee,this.interpolateQueryExpr);return{...ge,...u.$.featureToggles.promQLScope?{adhocFilters:this.generateScopeFilters(Ae)}:{},expr:Qe,interval:this.templateSrv.replace(ge.interval,Ee),legendFormat:this.templateSrv.replace(ge.legendFormat,Ee)}}getVariables(){return this.templateSrv.getVariables().map(ge=>`$${ge.name}`)}interpolateString(ge,xe){return this.templateSrv.replace(ge,xe,this.interpolateQueryExpr)}getDebounceTimeInMilliseconds(){switch(this.cacheLevel){case N.fD.Medium:return 600;case N.fD.High:return 1200;default:return 350}}getDaysToCacheMetadata(){switch(this.cacheLevel){case N.fD.Medium:return 7;case N.fD.High:return 30;default:return 1}}getCacheDurationInMinutes(){return(0,U.u3)(this.cacheLevel)}getDefaultQuery(ge){const xe={refId:"A",expr:"",range:!0,instant:!1};return ge===p.Jk.UnifiedAlerting?{...xe,instant:!0,range:!1}:ge===p.Jk.Explore?{...xe,instant:!0,range:!0}:xe}}function ve(Pe,ge,xe,Ae){const Ee=Math.floor((ge+Ae)/xe)*xe-Ae,Ie=Math.floor((Pe+Ae)/xe)*xe-Ae;return{end:Ee,start:Ie}}function be(Pe){return Pe.reduce((ge,xe)=>xe.rules.filter(Ae=>Ae.type==="recording").reduce((Ae,Ee)=>{const Ie=Ae[Ee.name]??[];return Ie.push({query:Ee.query,labels:Ee.labels}),Ae[Ee.name]=Ie,Ae},ge),{})}function he(Pe){return typeof Pe=="string"?Pe.replace(/\\/g,"\\\\").replace(/'/g,"\\\\'"):Pe}function ye(Pe){return typeof Pe=="string"?Pe.replace(/\\/g,"\\\\\\\\").replace(/[$^*{}\[\]\'+?.()|]/g,"\\\\$&"):Pe}},50556:(G,O,e)=>{"use strict";e.d(O,{AU:()=>u,Ay:()=>x,OP:()=>m,pK:()=>v,xB:()=>d});var t=e(2543),n=e.n(t),i=e(28848),s=e.n(i),r=e(40187),f=e(43127),a=e(73372),c=e(81996),o=e(20719),h=e(76040),g=e(62183);const l=["job","instance"],p="{}",m=1e4,y=M=>({headers:{"X-Grafana-Cache":`private, max-age=${M}`}});function d(M,S){if(!S[M])return;const{type:I,help:T}=S[M];return`${I.toUpperCase()}: ${T}`}function v(M,S){if(S[M])return S[M].help}function u(M,S){if(S[M])return S[M].type}const D=/(="|!="|=~"|!~"|\{|\[|\(|\+|-|\/|\*|%|\^|\band\b|\bor\b|\bunless\b|==|>=|!=|<=|>|<|=|~|,)/,P=86400;class x extends r.Is{constructor(S,I){super(),this.labelKeys=[],this.request=async(T,b,R={},A)=>{try{return(await this.datasource.metadataRequest(T,R,A)).data.data}catch(L){C(L)||console.error(L)}return b},this.start=async T=>(this.timeRange=T??(0,f.E2)(),this.datasource.lookupsDisabled?[]:(this.metrics=await this.fetchLabelValues("__name__")||[],this.histogramMetrics=(0,c.Rg)(this.metrics).sort(),Promise.all([this.loadMetricsMetadata(),this.fetchLabels()]))),this.fetchLabelValues=async T=>{const b=this.datasource.getAdjustedInterval(this.timeRange),A=`/api/v1/label/${this.datasource.interpolateString(T)}/values`;return await this.request(A,[],b,this.getDefaultCacheHeaders())??[]},this.fetchLabels=async(T,b)=>{T&&(this.timeRange=T);let R="/api/v1/labels";const A=this.datasource.getAdjustedInterval(this.timeRange);this.labelFetchTs=Date.now().valueOf();const L=new URLSearchParams({...A});b?.forEach(W=>{const w=(0,h.u)(W.expr);w.query.metric!==""&&(L.append("match[]",w.query.metric),w.query.binaryQueries&&w.query.binaryQueries.forEach(N=>{L.append("match[]",N.query.metric)}))}),this.datasource.httpMethod==="GET"&&(R+=`?${L.toString()}`);const U=await this.request(R,[],L,this.getDefaultCacheHeaders());return Array.isArray(U)&&(this.labelKeys=U.slice().sort()),[]},this.getSeriesValues=async(T,b)=>this.datasource.hasLabelsMatchAPISupport()?await this.fetchSeriesValuesWithMatch(T,b):(await this.getSeries(b))[T]??[],this.fetchSeriesValuesWithMatch=async(T,b,R,A=this.timeRange)=>{const L=T?this.datasource.interpolateString(T):null,U=b?this.datasource.interpolateString(b):null,w={...this.datasource.getAdjustedInterval(A),...U&&{"match[]":U}};let N={...this.getDefaultCacheHeaders(),...R&&{requestId:R}};return Object.keys(N).length||(N=void 0),await this.request(`/api/v1/label/${L}/values`,[],w,N)??[]},this.getSeriesLabels=async(T,b)=>{let R,A;this.datasource.hasLabelsMatchAPISupport()?(b.push({name:"__name__",value:"",op:"!="}),A=await this.fetchSeriesLabelsMatch(T),R=Object.keys(A)):(A=await this.getSeries(T),R=Object.keys(A));const L=new Set(b.map(U=>U.name));return R.filter(U=>!L.has(U))},this.fetchLabelsWithMatch=async(T,b)=>this.datasource.hasLabelsMatchAPISupport()?this.fetchSeriesLabelsMatch(T,b):this.fetchSeriesLabels(T,b),this.fetchSeriesLabels=async(T,b)=>{const R=this.datasource.interpolateString(T),L={...this.datasource.getAdjustedInterval(this.timeRange),"match[]":R},W=await this.request("/api/v1/series",[],L,this.getDefaultCacheHeaders()),{values:w}=(0,c.P7)(W,b);return w},this.fetchSeriesLabelsMatch=async(T,b)=>{const R=this.datasource.interpolateString(T),L={...this.datasource.getAdjustedInterval(this.timeRange),"match[]":R};return(await this.request("/api/v1/labels",[],L,this.getDefaultCacheHeaders())).reduce((w,N)=>({...w,[N]:""}),{})},this.fetchSeries=async T=>{const b="/api/v1/series",A={...this.datasource.getTimeRangeParams(this.timeRange),"match[]":T};return await this.request(b,{},A,this.getDefaultCacheHeaders())},this.fetchDefaultSeries=(0,t.once)(async()=>{const T=await Promise.all(l.map(b=>this.fetchLabelValues(b)));return l.reduce((b,R,A)=>({...b,[R]:T[A]}),{})}),this.datasource=S,this.histogramMetrics=[],this.timeRange=(0,f.E2)(),this.metrics=[],Object.assign(this,I)}getDefaultCacheHeaders(){if(this.datasource.cacheLevel!==g.fD.None)return y(this.datasource.getCacheDurationInMinutes()*60)}cleanText(S){return S.split(D).pop().trimLeft().replace(/"$/,"").replace(/^"/,"")}get syntax(){return o.Ay}async loadMetricsMetadata(){const S=y(this.datasource.getDaysToCacheMetadata()*P);this.metricsMetadata=(0,c.DX)(await this.request("/api/v1/metadata",{},{},{showErrorAlert:!1,...S}))}getLabelKeys(){return this.labelKeys}importFromAbstractQuery(S){return(0,c.pt)(S)}exportToAbstractQuery(S){const I=S.expr;if(!I||I.length===0)return{refId:S.refId,labelMatchers:[]};const T=s().tokenize(I,o.Ay),b=(0,c.VH)(T),R=E(I,T);return R&&R.length>0&&b.push({name:"__name__",operator:a.D_.Equal,value:R}),{refId:S.refId,labelMatchers:b}}async getSeries(S,I){if(this.datasource.lookupsDisabled)return{};try{return S===p?await this.fetchDefaultSeries():await this.fetchSeriesLabels(S,I)}catch(T){return console.error(T),{}}}async getLabelValues(S){return await this.fetchLabelValues(S)}}function E(M,S){let I="";for(const T of S)if(typeof T=="string"){I=T;break}return I}function C(M){return typeof M=="object"&&M!==null&&"cancelled"in M&&M.cancelled===!0}},81996:(G,O,e)=>{"use strict";e.d(O,{Cs:()=>b,DX:()=>D,P7:()=>p,P_:()=>v,Qn:()=>T,Rg:()=>l,VH:()=>w,Xd:()=>N,eN:()=>P,ky:()=>K,mv:()=>V,pt:()=>U,u3:()=>B});var t=e(2543),n=e.n(t),i=e(28848),s=e.n(i),r=e(73372),f=e(77678),a=e(85858),c=e(80937),o=e(50556),h=e(9103),g=e(62183);const l=H=>{const X=new Set,k=new RegExp("_bucket($|:)");for(let Y=0;Y<H.length;Y++){const Z=H[Y];k.test(Z)&&X.add(Z)}return[...X]};function p(H,X=!1){const k={};H.forEach(Z=>{const{__name__:se,...j}=Z;X&&(k.__name__=k.__name__||new Set,k.__name__.has(se)||k.__name__.add(se)),Object.keys(j).forEach(q=>{k[q]||(k[q]=new Set),k[q].has(j[q])||k[q].add(j[q])})});const Y={};return C(Object.keys(k)).forEach(Z=>{Y[Z]=C(Array.from(k[Z]))}),{values:Y,keys:Object.keys(Y)}}const m=/\{[^}]*?(\}|$)/,y=/\b(\w+)(!?=~?)("[^"\n]*?")(,)?(\s*)?/g;function d(H,X=1){if(!H.match(m)){if(H.match(/^[A-Za-z:][\w:]*$/))return{selector:`{__name__="${H}"}`,labelKeys:["__name__"]};throw new Error("Query must contain a selector: "+H)}const k=H.slice(0,X),Y=k.lastIndexOf("{"),Z=k.lastIndexOf("}");if(Y===-1)throw new Error("Not inside selector, missing open brace: "+k);if(Z>-1&&Z>Y)throw new Error("Not inside selector, previous selector already closed: "+k);const se=H.slice(X),q=se.indexOf("}")+X,ne=se.indexOf("{"),oe=ne+X;if(q===-1)throw new Error("Not inside selector, missing closing brace in suffix: "+se);if(ne>-1&&oe<q)throw new Error("Not inside selector, next selector opens before this one closed: "+se);const z=H.slice(Y,q),te={};z.replace(y,(me,ee,de,De)=>{const fe=H.indexOf(me),Te=fe+ee.length+de.length+1,je=fe+ee.length+de.length+De.length-1;return(X<Te||X>je)&&(te[ee]={value:De,operator:de}),""});const ie=H.slice(0,Y).match(/[A-Za-z:][\w:]*$/);ie&&(te.__name__={value:`"${ie[0]}"`,operator:"="});const ae=Object.keys(te).sort(),ce=["{",ae.map(me=>`${me}${te[me].operator}${te[me].value}`).join(","),"}"].join("");return{labelKeys:ae,selector:ce}}function v(H,X){const k=j=>new RegExp(`(\\s|\\(|^)(${j})(\\s|$|\\(|\\[|\\{)`,"ig"),Y=Object.keys(X).reduce((j,q)=>{let ne=[],oe=[],z=[];return j.filter(Boolean).forEach((te,le)=>{te.match(k(q))&&(ne=te.split(q),ne.length===2?(z.push(le),oe.push(...[ne[0],q,ne[1]].filter(Boolean))):ne.length>2&&(z.push(le),ne=ne.map(ae=>ae===""?q:ae),oe.push(...ne)))}),z.forEach(te=>j[te]=""),j=j.filter(Boolean),j.push(...oe),j},[H]);let Z=!1;return Y.map((j,q)=>{if(Z)return Z=!1,"";if(X[j]){const{expandedQuery:ne,identifierValue:oe,identifier:z}=X[j];if(q+1!==Y.length&&Y[q+1].match(y)){Z=!0;const te=new RegExp(`(,)?(\\s)?(${z}=\\"${oe}\\")(,)?(\\s)?`,"g"),le=Y[q+1].replace(te,""),ie=/(\)\{|\}\{|\]\{)/;return u(ne+le,ie)}else return ne}return j}).filter(Boolean).join("")}function u(H,X){const k=H.match(X);if(!k)return H;const Y=k.index??0,Z=H.slice(0,Y+1),se=H.slice(Y+1),j=[];se.replace(y,(z,te,le,ie,ae,re)=>(j.push({key:te,operator:le,value:ie,comma:ae,space:re}),""));let q=Z;j.filter(Boolean).forEach(z=>{const te=z.value.slice(1,-1);q=(0,c.t)(q,z.key,te,z.operator)});let ne=j.reduce((z,te)=>(z+=`${te.key}${te.operator}${te.value}${te.comma??""}${te.space??""}`,z),"");ne="{"+ne+"}";const oe=se.replace(ne,"");return q+oe}function D(H){if(!H)return H;const X={},k={};for(const Z in H){const se=H[Z][0];X[Z]=se,se.type==="histogram"&&(k[`${Z}_bucket`]={type:"counter",help:`Cumulative counters for the observation buckets (${se.help})`},k[`${Z}_count`]={type:"counter",help:`Count of events that have been observed for the histogram metric (${se.help})`},k[`${Z}_sum`]={type:"counter",help:`Total sum of all observed values for the histogram metric (${se.help})`}),se.type==="summary"&&(k[`${Z}_count`]={type:"counter",help:`Count of events that have been observed for the base metric (${se.help})`},k[`${Z}_sum`]={type:"counter",help:`Total sum of all observed values for the base metric (${se.help})`})}const Y={};return Y.ALERTS={type:"counter",help:"Time series showing pending and firing alerts. The sample value is set to 1 as long as the alert is in the indicated active (pending or firing) state."},{...X,...k,...Y}}function P(H){return x(H/1e3)}function x(H){return Math.floor(H/60)}function E(H,X=1){return Math.ceil(H/60)-Math.ceil(H/60)%X}function C(H){return H.slice(0,o.OP)}function M(H){return H&&H.length>=SUGGESTIONS_LIMIT?`, limited to the first ${SUGGESTIONS_LIMIT} received items`:""}const S=/[*+?()|\\.\[\]{}^$]/g;function I(H){return H.replace(S,"\\$&")}function T(H){return H.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/"/g,'\\"')}function b(H){return T(I(H))}const R={"=":r.D_.Equal,"!=":r.D_.NotEqual,"=~":r.D_.EqualRegEx,"!~":r.D_.NotEqualRegEx},A=(0,t.invert)(R);function L(H){const X=H.labelMatchers.map(k=>{const Y=A[k.operator];return Y?`${k.name}${Y}"${k.value}"`:""}).filter(k=>k!=="").join(", ");return X?`{${X}}`:""}function U(H){return{refId:H.refId,expr:L(H),range:!0}}function W(H){return typeof H.content=="string"?H.content:""}function w(H){const X=[];for(const k of H)if(k instanceof i.Token&&k.type==="context-labels"){let Y="",Z="",se="";const j=Array.isArray(k.content)?k.content:[k.content];for(let q of j)if(typeof q=="string"){let ne;ne=q,(ne==="="||ne==="!="||ne==="=~"||ne==="!~")&&(se=ne)}else if(q instanceof i.Token)switch(q.type){case"label-key":Y=W(q);break;case"label-value":Z=W(q),Z=Z.substring(1,Z.length-1);const ne=R[se];ne&&X.push({name:Y,operator:ne,value:Z});break}}return X}function N(H,X){if(H===g.fD.None)return{start:V(X.from,!1).toString(),end:V(X.to,!0).toString()};const k=V(X.from,!1),Y=(0,f.rs)(k,B(H)*60),Z=V(X.to,!0),se=E(Z,B(H))*60;if(Y===se){const ne=se+B(H)*60;return{start:Y.toString(),end:ne.toString()}}const j=Y.toString(),q=se.toString();return{start:j,end:q}}function B(H){switch(H){case g.fD.Medium:return 10;case g.fD.High:return 60;default:return 1}}function V(H,X){return typeof H=="string"&&(H=a.parse(H,X)),Math.ceil(H.valueOf()/1e3)}function K(H,X){return X===void 0&&(X=h.o6),H.length=Math.min(H.length,X),H}},20719:(G,O,e)=>{"use strict";e.d(O,{AW:()=>f,Ay:()=>o,n6:()=>c});const t=[{label:"$__interval",sortValue:"$__interval"},{label:"$__rate_interval",sortValue:"$__rate_interval"},{label:"$__range",sortValue:"$__range"},{label:"1m",sortValue:"00:01:00"},{label:"5m",sortValue:"00:05:00"},{label:"10m",sortValue:"00:10:00"},{label:"30m",sortValue:"00:30:00"},{label:"1h",sortValue:"01:00:00"},{label:"1d",sortValue:"24:00:00"}],n=["by","group_left","group_right","ignoring","on","offset","without"],i=null,s=[{label:"acos",insertText:"acos",detail:"acos(v instant-vector)",documentation:"calculates the arccosine of all elements in v"},{label:"acosh",insertText:"acosh",detail:"acosh(v instant-vector)",documentation:"calculates the inverse hyperbolic cosine of all elements in v"},{label:"asin",insertText:"asin",detail:"asin(v instant-vector)",documentation:"calculates the arcsine of all elements in v"},{label:"asinh",insertText:"asinh",detail:"asinh(v instant-vector)",documentation:"calculates the inverse hyperbolic sine of all elements in v"},{label:"atan",insertText:"atan",detail:"atan(v instant-vector)",documentation:"calculates the arctangent of all elements in v"},{label:"atanh",insertText:"atanh",detail:"atanh(v instant-vector)",documentation:"calculates the inverse hyperbolic tangent of all elements in v"},{label:"cos",insertText:"cos",detail:"cos(v instant-vector)",documentation:"calculates the cosine of all elements in v"},{label:"cosh",insertText:"cosh",detail:"cosh(v instant-vector)",documentation:"calculates the hyperbolic cosine of all elements in v"},{label:"sin",insertText:"sin",detail:"sin(v instant-vector)",documentation:"calculates the sine of all elements in v"},{label:"sinh",insertText:"sinh",detail:"sinh(v instant-vector)",documentation:"calculates the hyperbolic sine of all elements in v"},{label:"tan",insertText:"tan",detail:"tan(v instant-vector)",documentation:"calculates the tangent of all elements in v"},{label:"tanh",insertText:"tanh",detail:"tanh(v instant-vector)",documentation:"calculates the hyperbolic tangent of all elements in v"}],f=[...[{label:"sum",insertText:"sum",documentation:"Calculate sum over dimensions"},{label:"min",insertText:"min",documentation:"Select minimum over dimensions"},{label:"max",insertText:"max",documentation:"Select maximum over dimensions"},{label:"avg",insertText:"avg",documentation:"Calculate the average over dimensions"},{label:"group",insertText:"group",documentation:"All values in the resulting vector are 1"},{label:"stddev",insertText:"stddev",documentation:"Calculate population standard deviation over dimensions"},{label:"stdvar",insertText:"stdvar",documentation:"Calculate population standard variance over dimensions"},{label:"count",insertText:"count",documentation:"Count number of elements in the vector"},{label:"count_values",insertText:"count_values",documentation:"Count number of elements with the same value"},{label:"bottomk",insertText:"bottomk",documentation:"Smallest k elements by sample value"},{label:"topk",insertText:"topk",documentation:"Largest k elements by sample value"},{label:"quantile",insertText:"quantile",documentation:"Calculate \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) over dimensions"}],...s,{insertText:"abs",label:"abs",detail:"abs(v instant-vector)",documentation:"Returns the input vector with all sample values converted to their absolute value."},{insertText:"absent",label:"absent",detail:"absent(v instant-vector)",documentation:"Returns an empty vector if the vector passed to it has any elements and a 1-element vector with the value 1 if the vector passed to it has no elements. This is useful for alerting on when no time series exist for a given metric name and label combination."},{insertText:"absent_over_time",label:"absent_over_time",detail:"absent(v range-vector)",documentation:"Returns an empty vector if the range vector passed to it has any elements and a 1-element vector with the value 1 if the range vector passed to it has no elements."},{insertText:"ceil",label:"ceil",detail:"ceil(v instant-vector)",documentation:"Rounds the sample values of all elements in `v` up to the nearest integer."},{insertText:"changes",label:"changes",detail:"changes(v range-vector)",documentation:"For each input time series, `changes(v range-vector)` returns the number of times its value has changed within the provided time range as an instant vector."},{insertText:"clamp",label:"clamp",detail:"clamp(v instant-vector, min scalar, max scalar)",documentation:"Clamps the sample values of all elements in `v` to have a lower limit of `min` and an upper limit of `max`."},{insertText:"clamp_max",label:"clamp_max",detail:"clamp_max(v instant-vector, max scalar)",documentation:"Clamps the sample values of all elements in `v` to have an upper limit of `max`."},{insertText:"clamp_min",label:"clamp_min",detail:"clamp_min(v instant-vector, min scalar)",documentation:"Clamps the sample values of all elements in `v` to have a lower limit of `min`."},{insertText:"count_scalar",label:"count_scalar",detail:"count_scalar(v instant-vector)",documentation:"Returns the number of elements in a time series vector as a scalar. This is in contrast to the `count()` aggregation operator, which always returns a vector (an empty one if the input vector is empty) and allows grouping by labels via a `by` clause."},{insertText:"deg",label:"deg",detail:"deg(v instant-vector)",documentation:"Converts radians to degrees for all elements in v"},{insertText:"day_of_month",label:"day_of_month",detail:"day_of_month(v=vector(time()) instant-vector)",documentation:"Returns the day of the month for each of the given times in UTC. Returned values are from 1 to 31."},{insertText:"day_of_week",label:"day_of_week",detail:"day_of_week(v=vector(time()) instant-vector)",documentation:"Returns the day of the week for each of the given times in UTC. Returned values are from 0 to 6, where 0 means Sunday etc."},{insertText:"day_of_year",label:"day_of_year",detail:"day_of_year(v=vector(time()) instant-vector)",documentation:"Returns the day of the year for each of the given times in UTC. Returned values are from 1 to 365 for non-leap years, and 1 to 366 in leap years."},{insertText:"days_in_month",label:"days_in_month",detail:"days_in_month(v=vector(time()) instant-vector)",documentation:"Returns number of days in the month for each of the given times in UTC. Returned values are from 28 to 31."},{insertText:"delta",label:"delta",detail:"delta(v range-vector)",documentation:"Calculates the difference between the first and last value of each time series element in a range vector `v`, returning an instant vector with the given deltas and equivalent labels. The delta is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if the sample values are all integers."},{insertText:"deriv",label:"deriv",detail:"deriv(v range-vector)",documentation:"Calculates the per-second derivative of the time series in a range vector `v`, using simple linear regression."},{insertText:"drop_common_labels",label:"drop_common_labels",detail:"drop_common_labels(instant-vector)",documentation:"Drops all labels that have the same name and value across all series in the input vector."},{insertText:"exp",label:"exp",detail:"exp(v instant-vector)",documentation:"Calculates the exponential function for all elements in `v`.\nSpecial cases are:\n* `Exp(+Inf) = +Inf` \n* `Exp(NaN) = NaN`"},{insertText:"floor",label:"floor",detail:"floor(v instant-vector)",documentation:"Rounds the sample values of all elements in `v` down to the nearest integer."},{insertText:"histogram_quantile",label:"histogram_quantile",detail:"histogram_quantile(\u03C6 float, b instant-vector)",documentation:"Calculates the \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) from the buckets `b` of a histogram. The samples in `b` are the counts of observations in each bucket. Each sample must have a label `le` where the label value denotes the inclusive upper bound of the bucket. (Samples without such a label are silently ignored.) The histogram metric type automatically provides time series with the `_bucket` suffix and the appropriate labels."},{insertText:"holt_winters",label:"holt_winters",detail:"holt_winters(v range-vector, sf scalar, tf scalar)",documentation:"Produces a smoothed value for time series based on the range in `v`. The lower the smoothing factor `sf`, the more importance is given to old data. The higher the trend factor `tf`, the more trends in the data is considered. Both `sf` and `tf` must be between 0 and 1."},{insertText:"hour",label:"hour",detail:"hour(v=vector(time()) instant-vector)",documentation:"Returns the hour of the day for each of the given times in UTC. Returned values are from 0 to 23."},{insertText:"idelta",label:"idelta",detail:"idelta(v range-vector)",documentation:"Calculates the difference between the last two samples in the range vector `v`, returning an instant vector with the given deltas and equivalent labels."},{insertText:"increase",label:"increase",detail:"increase(v range-vector)",documentation:"Calculates the increase in the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. The increase is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if a counter increases only by integer increments."},{insertText:"irate",label:"irate",detail:"irate(v range-vector)",documentation:"Calculates the per-second instant rate of increase of the time series in the range vector. This is based on the last two data points. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for."},{insertText:"label_join",label:"label_join",detail:"label_join(v instant-vector, dst_label string, separator string, src_label_1 string, src_label_2 string, ...)",documentation:"For each timeseries in `v`, joins all the values of all the `src_labels` using `separator` and returns the timeseries with the label `dst_label` containing the joined value. There can be any number of `src_labels` in this function."},{insertText:"label_replace",label:"label_replace",detail:"label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)",documentation:"For each timeseries in `v`, `label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)`  matches the regular expression `regex` against the label `src_label`.  If it matches, then the timeseries is returned with the label `dst_label` replaced by the expansion of `replacement`. `$1` is replaced with the first matching subgroup, `$2` with the second etc. If the regular expression doesn't match then the timeseries is returned unchanged."},{insertText:"ln",label:"ln",detail:"ln(v instant-vector)",documentation:"Calculates the natural logarithm for all elements in `v`.\nSpecial cases are:\n * `ln(+Inf) = +Inf`\n * `ln(0) = -Inf`\n * `ln(x < 0) = NaN`\n * `ln(NaN) = NaN`"},{insertText:"log2",label:"log2",detail:"log2(v instant-vector)",documentation:"Calculates the binary logarithm for all elements in `v`. The special cases are equivalent to those in `ln`."},{insertText:"log10",label:"log10",detail:"log10(v instant-vector)",documentation:"Calculates the decimal logarithm for all elements in `v`. The special cases are equivalent to those in `ln`."},{insertText:"minute",label:"minute",detail:"minute(v=vector(time()) instant-vector)",documentation:"Returns the minute of the hour for each of the given times in UTC. Returned values are from 0 to 59."},{insertText:"month",label:"month",detail:"month(v=vector(time()) instant-vector)",documentation:"Returns the month of the year for each of the given times in UTC. Returned values are from 1 to 12, where 1 means January etc."},{insertText:"pi",label:"pi",detail:"pi()",documentation:"Returns pi"},{insertText:"predict_linear",label:"predict_linear",detail:"predict_linear(v range-vector, t scalar)",documentation:"Predicts the value of time series `t` seconds from now, based on the range vector `v`, using simple linear regression."},{insertText:"rad",label:"rad",detail:"rad(v instant-vector)",documentation:"Converts degrees to radians for all elements in v"},{insertText:"rate",label:"rate",detail:"rate(v range-vector)",documentation:"Calculates the per-second average rate of increase of the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. Also, the calculation extrapolates to the ends of the time range, allowing for missed scrapes or imperfect alignment of scrape cycles with the range's time period."},{insertText:"resets",label:"resets",detail:"resets(v range-vector)",documentation:"For each input time series, `resets(v range-vector)` returns the number of counter resets within the provided time range as an instant vector. Any decrease in the value between two consecutive samples is interpreted as a counter reset."},{insertText:"round",label:"round",detail:"round(v instant-vector, to_nearest=1 scalar)",documentation:"Rounds the sample values of all elements in `v` to the nearest integer. Ties are resolved by rounding up. The optional `to_nearest` argument allows specifying the nearest multiple to which the sample values should be rounded. This multiple may also be a fraction."},{insertText:"scalar",label:"scalar",detail:"scalar(v instant-vector)",documentation:"Given a single-element input vector, `scalar(v instant-vector)` returns the sample value of that single element as a scalar. If the input vector does not have exactly one element, `scalar` will return `NaN`."},{insertText:"sgn",label:"sgn",detail:"sgn(v instant-vector)",documentation:"Returns a vector with all sample values converted to their sign, defined as this: 1 if v is positive, -1 if v is negative and 0 if v is equal to zero."},{insertText:"sort",label:"sort",detail:"sort(v instant-vector)",documentation:"Returns vector elements sorted by their sample values, in ascending order."},{insertText:"sort_desc",label:"sort_desc",detail:"sort_desc(v instant-vector)",documentation:"Returns vector elements sorted by their sample values, in descending order."},{insertText:"sqrt",label:"sqrt",detail:"sqrt(v instant-vector)",documentation:"Calculates the square root of all elements in `v`."},{insertText:"time",label:"time",detail:"time()",documentation:"Returns the number of seconds since January 1, 1970 UTC. Note that this does not actually return the current time, but the time at which the expression is to be evaluated."},{insertText:"timestamp",label:"timestamp",detail:"timestamp(v instant-vector)",documentation:"Returns the timestamp of each of the samples of the given vector as the number of seconds since January 1, 1970 UTC."},{insertText:"vector",label:"vector",detail:"vector(s scalar)",documentation:"Returns the scalar `s` as a vector with no labels."},{insertText:"year",label:"year",detail:"year(v=vector(time()) instant-vector)",documentation:"Returns the year for each of the given times in UTC."},{insertText:"avg_over_time",label:"avg_over_time",detail:"avg_over_time(range-vector)",documentation:"The average value of all points in the specified interval."},{insertText:"min_over_time",label:"min_over_time",detail:"min_over_time(range-vector)",documentation:"The minimum value of all points in the specified interval."},{insertText:"max_over_time",label:"max_over_time",detail:"max_over_time(range-vector)",documentation:"The maximum value of all points in the specified interval."},{insertText:"sum_over_time",label:"sum_over_time",detail:"sum_over_time(range-vector)",documentation:"The sum of all values in the specified interval."},{insertText:"count_over_time",label:"count_over_time",detail:"count_over_time(range-vector)",documentation:"The count of all values in the specified interval."},{insertText:"quantile_over_time",label:"quantile_over_time",detail:"quantile_over_time(scalar, range-vector)",documentation:"The \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) of the values in the specified interval."},{insertText:"stddev_over_time",label:"stddev_over_time",detail:"stddev_over_time(range-vector)",documentation:"The population standard deviation of the values in the specified interval."},{insertText:"stdvar_over_time",label:"stdvar_over_time",detail:"stdvar_over_time(range-vector)",documentation:"The population standard variance of the values in the specified interval."},{insertText:"last_over_time",label:"last_over_time",detail:"last_over_time(range-vector)",documentation:"The most recent point value in specified interval."},{insertText:"present_over_time",label:"present_over_time",detail:"present_over_time(range-vector)",documentation:"The value 1 for any series in the specified interval."},{insertText:"histogram_avg",label:"histogram_avg",detail:"histogram_avg(v instant-vector)",documentation:"Returns the arithmetic average of observed values stored in a native histogram. Samples that are not native histograms are ignored and do not show up in the returned vector."},{insertText:"histogram_count",label:"histogram_count",detail:"histogram_count(v instant-vector)",documentation:"Returns the count of observations stored in a native histogram."},{insertText:"histogram_sum",label:"histogram_sum",detail:"histogram_sum(v instant-vector)",documentation:"Returns the sum of observations stored in a native histogram."},{insertText:"histogram_fraction",label:"histogram_fraction",detail:"histogram_fraction(lower scalar, upper scalar, v instant-vector)",documentation:"Returns the estimated fraction of observations between the provided lower and upper values."},{insertText:"histogram_stddev",label:"histogram_stddev",detail:"histogram_stddev(v instant-vector)",documentation:"Returns the estimated standard deviation of observations in a native histogram, based on the geometric mean of the buckets where the observations lie."},{insertText:"histogram_stdvar",label:"histogram_stdvar",detail:"histogram_stdvar(v instant-vector)",documentation:"Returns the estimated standard variance of observations in a native histogram."}],a=f.map(h=>h.label),c={comment:{pattern:/#.*/},"context-aggregation":{pattern:/((by|without)\s*)\([^)]*\)/,lookbehind:!0,inside:{"label-key":{pattern:/[^(),\s][^,)]*[^),\s]*/,alias:"attr-name"},punctuation:/[()]/}},"context-labels":{pattern:/\{[^}]*(?=}?)/,greedy:!0,inside:{comment:{pattern:/#.*/},"label-key":{pattern:/[a-z_]\w*(?=\s*(=|!=|=~|!~))/,alias:"attr-name",greedy:!0},"label-value":{pattern:/"(?:\\.|[^\\"])*"/,greedy:!0,alias:"attr-value"},punctuation:/[{]/}},function:new RegExp(`\\b(?:${f.map(h=>h.label).join("|")})(?=\\s*\\()`,"i"),"context-range":[{pattern:/\[[^\]]*(?=])/,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}},{pattern:/(offset\s+)\w+/,lookbehind:!0,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}}],idList:{pattern:/\d+(\|\d+)+/,alias:"number"},number:/\b-?\d+((\.\d*)?([eE][+-]?\d+)?)?\b/,operator:new RegExp(`/[-+*/=%^~]|&&?|\\|?\\||!=?|<(?:=>?|<|>)?|>[>=]?|\\b(?:${n.join("|")})\\b`,"i"),punctuation:/[{};()`,.]/},o=c},32370:(G,O,e)=>{"use strict";e.d(O,{l:()=>x,z:()=>E});var t=e(20719),n=e(1220),i=e(75161),s=e(38961),r=e(15145);function f(){return[{id:r.jN.HistogramQuantile,name:"Histogram quantile",params:[{name:"Quantile",type:"number",options:[.99,.95,.9,.75,.5,.25]}],defaultParams:[.9],category:r.Ag.Functions,renderer:n.jY,addOperationHandler:n.iZ},a({id:r.jN.HistogramAvg}),a({id:r.jN.HistogramCount}),a({id:r.jN.HistogramSum}),{id:r.jN.HistogramFraction,name:"Histogram fraction",params:[{name:"Lower scalar",type:"number"},{name:"Upper scalar",type:"number"}],defaultParams:[0,.2],category:r.Ag.Functions,renderer:n.jY,addOperationHandler:n.iZ},a({id:r.jN.HistogramStddev}),a({id:r.jN.HistogramStdvar}),{id:r.jN.LabelReplace,name:"Label replace",params:[{name:"Destination label",type:"string"},{name:"Replacement",type:"string"},{name:"Source label",type:"string"},{name:"Regex",type:"string"}],category:r.Ag.Functions,defaultParams:["","$1","","(.*)"],renderer:n.kf,addOperationHandler:n.iZ},{id:r.jN.Ln,name:"Ln",params:[],defaultParams:[],category:r.Ag.Functions,renderer:n.jY,addOperationHandler:n.iZ},c(r.jN.Changes),c(r.jN.Rate,!0),c(r.jN.Irate),c(r.jN.Increase,!0),c(r.jN.Idelta),c(r.jN.Delta),a({id:r.jN.HoltWinters,params:[(0,n.z2)(),{name:"Smoothing Factor",type:"number"},{name:"Trend Factor",type:"number"}],defaultParams:["$__interval",.5,.5],alternativesKey:"range function",category:r.Ag.RangeFunctions,renderer:n.nU,addOperationHandler:g,changeTypeHandler:o}),a({id:r.jN.PredictLinear,params:[(0,n.z2)(),{name:"Seconds from now",type:"number"}],defaultParams:["$__interval",60],alternativesKey:"range function",category:r.Ag.RangeFunctions,renderer:n.nU,addOperationHandler:g,changeTypeHandler:o}),a({id:r.jN.QuantileOverTime,params:[(0,n.z2)(),{name:"Quantile",type:"number"}],defaultParams:["$__interval",.5],alternativesKey:"overtime function",category:r.Ag.RangeFunctions,renderer:n.Kl,addOperationHandler:g,changeTypeHandler:o}),...i.Iu,{id:r.jN.NestedQuery,name:"Binary operation with query",params:[],defaultParams:[],category:r.Ag.BinaryOps,renderer:(M,S,I)=>I,addOperationHandler:l},a({id:r.jN.Abs}),a({id:r.jN.Absent}),a({id:r.jN.Acos,category:r.Ag.Trigonometric}),a({id:r.jN.Acosh,category:r.Ag.Trigonometric}),a({id:r.jN.Asin,category:r.Ag.Trigonometric}),a({id:r.jN.Asinh,category:r.Ag.Trigonometric}),a({id:r.jN.Atan,category:r.Ag.Trigonometric}),a({id:r.jN.Atanh,category:r.Ag.Trigonometric}),a({id:r.jN.Ceil}),a({id:r.jN.Clamp,name:"Clamp",params:[{name:"Minimum Scalar",type:"number"},{name:"Maximum Scalar",type:"number"}],defaultParams:[1,1]}),a({id:r.jN.ClampMax,params:[{name:"Maximum Scalar",type:"number"}],defaultParams:[1]}),a({id:r.jN.ClampMin,params:[{name:"Minimum Scalar",type:"number"}],defaultParams:[1]}),a({id:r.jN.Cos,category:r.Ag.Trigonometric}),a({id:r.jN.Cosh,category:r.Ag.Trigonometric}),a({id:r.jN.DayOfMonth,category:r.Ag.Time}),a({id:r.jN.DayOfWeek,category:r.Ag.Time}),a({id:r.jN.DayOfYear,category:r.Ag.Time}),a({id:r.jN.DaysInMonth,category:r.Ag.Time}),a({id:r.jN.Deg}),c(r.jN.Deriv),a({id:r.jN.Exp}),a({id:r.jN.Floor}),a({id:r.jN.Group}),a({id:r.jN.Hour}),a({id:r.jN.LabelJoin,params:[{name:"Destination Label",type:"string",editor:s.r},{name:"Separator",type:"string"},{name:"Source Label",type:"string",restParam:!0,optional:!0,editor:s.r}],defaultParams:["",",",""],renderer:p,explainHandler:m,addOperationHandler:y}),a({id:r.jN.Log10}),a({id:r.jN.Log2}),a({id:r.jN.Minute}),a({id:r.jN.Month}),a({id:r.jN.Pi,renderer:M=>`${M.id}()`}),a({id:r.jN.Rad}),c(r.jN.Resets),a({id:r.jN.Round,category:r.Ag.Functions,params:[{name:"To Nearest",type:"number"}],defaultParams:[1]}),a({id:r.jN.Scalar}),a({id:r.jN.Sgn}),a({id:r.jN.Sin,category:r.Ag.Trigonometric}),a({id:r.jN.Sinh,category:r.Ag.Trigonometric}),a({id:r.jN.Sort}),a({id:r.jN.SortDesc}),a({id:r.jN.Sqrt}),a({id:r.jN.Stddev}),a({id:r.jN.Tan,category:r.Ag.Trigonometric}),a({id:r.jN.Tanh,category:r.Ag.Trigonometric}),a({id:r.jN.Time,renderer:M=>`${M.id}()`}),a({id:r.jN.Timestamp}),a({id:r.jN.Vector,params:[{name:"Value",type:"number"}],defaultParams:[1],renderer:M=>`${M.id}(${M.params[0]})`}),a({id:r.jN.Year})]}function a(C){return{...C,id:C.id,name:C.name??(0,n.DQ)(C.id),params:C.params??[],defaultParams:C.defaultParams??[],category:C.category??r.Ag.Functions,renderer:C.renderer??(C.params?n.kf:n.jY),addOperationHandler:C.addOperationHandler??n.iZ}}function c(C,M=!1){return{id:C,name:(0,n.DQ)(C),params:[(0,n.z2)(M)],defaultParams:[M?"$__rate_interval":"$__interval"],alternativesKey:"range function",category:r.Ag.RangeFunctions,renderer:h,addOperationHandler:g,changeTypeHandler:o}}function o(C,M){return(C.params[0]==="$__rate_interval"&&M.defaultParams[0]!=="$__rate_interval"||C.params[0]==="$__interval"&&M.defaultParams[0]!=="$__interval")&&(C.params=M.defaultParams),C}function h(C,M,S){let I=(C.params??[])[0]??"5m";return`${M.id}(${S}[${I}])`}function g(C,M,S){const I={id:C.id,params:C.defaultParams};return M.operations.length>0&&S.getOperationDef(M.operations[0].id).addOperationHandler===g?{...M,operations:[I,...M.operations.slice(1)]}:{...M,operations:[I,...M.operations]}}function l(C,M){return{...M,binaryQueries:[...M.binaryQueries??[],{operator:"/",query:M}]}}function p(C,M,S){const I=C.params[0]??"",b=`"${C.params[1]??""}"`;return`${C.id}(${S}, "${I}", ${b}, "${C.params.slice(2).join(b)}")`}function m(C,M){let S=M?.documentation??"no docs";return typeof C.params[1]!="string"&&(S+=" \u{1F6A8}\u{1F6A8}\u{1F6A8} The `separator` must be a string."),S}function y(C,M){const S={id:C.id,params:C.defaultParams};return{...M,operations:[...M.operations,S]}}function d(){return[...(0,n.G3)(r.jN.Sum),...(0,n.G3)(r.jN.Avg),...(0,n.G3)(r.jN.Min),...(0,n.G3)(r.jN.Max),...(0,n.G3)(r.jN.Count),...(0,n.jC)(r.jN.TopK,{params:[{name:"K-value",type:"number"}],defaultParams:[5]}),...(0,n.jC)(r.jN.BottomK,{params:[{name:"K-value",type:"number"}],defaultParams:[5]}),...(0,n.jC)(r.jN.CountValues,{params:[{name:"Identifier",type:"string"}],defaultParams:["count"]}),...(0,n.jC)(r.jN.Quantile,{params:[{name:"Value",type:"number"}],defaultParams:[1]}),v(r.jN.SumOverTime),v(r.jN.AvgOverTime),v(r.jN.MinOverTime),v(r.jN.MaxOverTime),v(r.jN.CountOverTime),v(r.jN.LastOverTime),v(r.jN.PresentOverTime),v(r.jN.AbsentOverTime),v(r.jN.StddevOverTime)]}function v(C){return{id:C,name:(0,n.DQ)(C),params:[(0,n.z2)()],defaultParams:["$__interval"],alternativesKey:"overtime function",category:r.Ag.RangeFunctions,renderer:u,addOperationHandler:g}}function u(C,M,S){let I=(C.params??[])[0]??"$__interval";return`${M.id}(${S}[${I}])`}var D=e(83077);class P{constructor(M){this.categories=[],this.operationsRegistry=new D.O(M)}setOperationCategories(M){this.categories=M}getOperationsForCategory(M){return this.operationsRegistry.list().filter(S=>S.category===M&&!S.hideFromList)}getAlternativeOperations(M){return this.operationsRegistry.list().filter(S=>S.alternativesKey&&S.alternativesKey===M)}getCategories(){return this.categories}getOperationDef(M){return this.operationsRegistry.getIfExists(M)}renderOperations(M,S){for(const I of S){const T=this.operationsRegistry.getIfExists(I.id);if(!T)throw new Error(`Could not find operation ${I.id} in the registry`);M=T.renderer(I,T,M)}return M}renderBinaryQueries(M,S){if(S)for(const I of S)M=`${this.renderBinaryQuery(M,I)}`;return M}renderBinaryQuery(M,S){let I=M+` ${S.operator} `;return S.vectorMatches&&(I+=`${S.vectorMatchesType}(${S.vectorMatches}) `),I+this.renderQuery(S.query,!0)}renderLabels(M){if(M.length===0)return"";let S="{";for(const I of M)S!=="{"&&(S+=", "),S+=`${I.label}${I.op}"${I.value}"`;return S+"}"}renderQuery(M,S){let I=`${M.metric??""}${this.renderLabels(M.labels)}`;return I=this.renderOperations(I,M.operations),!S&&this.hasBinaryOp(M)&&M.binaryQueries?.length&&(I=`(${I})`),I=this.renderBinaryQueries(I,M.binaryQueries),S&&(this.hasBinaryOp(M)||M.binaryQueries?.length)&&(I=`(${I})`),I}hasBinaryOp(M){return M.operations.find(S=>this.getOperationDef(S.id)?.category===r.Ag.BinaryOps)!==void 0}}class x extends P{constructor(){super(()=>{const M=[...f(),...d()];for(const S of M){const I=t.AW.find(T=>T.insertText===S.id);I&&(S.documentation=I.documentation)}return M}),this.setOperationCategories([r.Ag.Aggregations,r.Ag.RangeFunctions,r.Ag.Functions,r.Ag.BinaryOps,r.Ag.Trigonometric,r.Ag.Time])}getQueryPatterns(){return[{name:"Rate then sum",type:r.n5.Rate,operations:[{id:"rate",params:["$__rate_interval"]},{id:"sum",params:[]}]},{name:"Rate then sum by(label) then avg",type:r.n5.Rate,operations:[{id:"rate",params:["$__rate_interval"]},{id:"__sum_by",params:[""]},{id:"avg",params:[]}]},{name:"Histogram quantile on rate",type:r.n5.Histogram,operations:[{id:"rate",params:["$__rate_interval"]},{id:"__sum_by",params:["le"]},{id:"histogram_quantile",params:[.95]}]},{name:"Histogram quantile on increase",type:r.n5.Histogram,operations:[{id:"increase",params:["$__rate_interval"]},{id:"__max_by",params:["le"]},{id:"histogram_quantile",params:[.95]}]},{name:"Binary Query",type:r.n5.Binary,operations:[{id:"rate",params:["$__rate_interval"]},{id:"sum",params:[]}],binaryQueries:[{operator:"/",query:{metric:"",labels:[],operations:[{id:"rate",params:["$__rate_interval"]},{id:"sum",params:[]}]}}]}]}}const E=new x},75161:(G,O,e)=>{"use strict";e.d(O,{AE:()=>s,C8:()=>i,Iu:()=>r});var t=e(1220),n=e(15145);const i=[{id:n.jN.Addition,name:"Add scalar",sign:"+"},{id:n.jN.Subtraction,name:"Subtract scalar",sign:"-"},{id:n.jN.MultiplyBy,name:"Multiply by scalar",sign:"*"},{id:n.jN.DivideBy,name:"Divide by scalar",sign:"/"},{id:n.jN.Modulo,name:"Modulo by scalar",sign:"%"},{id:n.jN.Exponent,name:"Exponent",sign:"^"},{id:n.jN.EqualTo,name:"Equal to",sign:"==",comparison:!0},{id:n.jN.NotEqualTo,name:"Not equal to",sign:"!=",comparison:!0},{id:n.jN.GreaterThan,name:"Greater than",sign:">",comparison:!0},{id:n.jN.LessThan,name:"Less than",sign:"<",comparison:!0},{id:n.jN.GreaterOrEqual,name:"Greater or equal to",sign:">=",comparison:!0},{id:n.jN.LessOrEqual,name:"Less or equal to",sign:"<=",comparison:!0}],s=i.reduce((a,c)=>(a[c.sign]={id:c.id,comparison:c.comparison},a),{}),r=i.map(a=>{const c=[{name:"Value",type:"number"}];let o=[2];return a.comparison&&(c.push({name:"Bool",type:"boolean",description:"If checked comparison will return 0 or 1 for the value rather than filtering."}),o=[2,!1]),{id:a.id,name:a.name,params:c,defaultParams:o,alternativesKey:"binary scalar operations",category:n.Ag.BinaryOps,renderer:f(a.sign),addOperationHandler:t.iZ}});function f(a){return function(o,h,g){let l=o.params[0],p="";return o.params.length===2&&(p=o.params[1]?" bool":""),`${g} ${a}${p} ${l}`}}},38961:(G,O,e)=>{"use strict";e.d(O,{r:()=>a});var t=e(74848),n=e(96540),i=e(50877),s=e(90182),r=e(32370),f=e(1220);function a({onChange:o,index:h,operationId:g,value:l,query:p,datasource:m}){const[y,d]=(0,n.useState)({});return(0,t.jsx)(s.l6,{inputId:(0,f.OS)(g,h),autoFocus:l===""?!0:void 0,openMenuOnFocus:!0,onOpenMenu:async()=>{d({isLoading:!0});const v=await c(p,m);d({options:v,isLoading:void 0})},isLoading:y.isLoading,allowCustomValue:!0,noOptionsMessage:"No labels found",loadingMessage:"Loading labels",options:y.options,value:(0,i.z)(l),onChange:v=>o(h,v.value)})}async function c(o,h){let g=o.labels;h.type==="prometheus"&&(g=[{label:"__name__",op:"=",value:o.metric},...o.labels]);const l=r.z.renderLabels(g),p=await h.languageProvider.fetchLabelsWithMatch(l);return Object.keys(p).map(m=>({label:m,value:m}))}},9103:(G,O,e)=>{"use strict";e.d(O,{dm:()=>Pe,o6:()=>ye});var t=e(74848),n=e(32196),i=e(76459),s=e.n(i),r=e(96540),f=e(23257),a=e.n(f),c=e(50877),o=e(13544),h=e(97801),g=e(81580),l=e(32264),p=e(40845),m=e(55852),y=e(14578),d=e(12681),v=e(88824),u=e(40276),D=e(90182),P=e(39268),x=e(14186),E=e(81996),C=e(26115),M=e(65307),S=e(37390),I=e(10354),T=e(62930),b=e(60782),R=e(19727),A=e(19384),L=e(15292),U=e(56034),W=e(14110),w=e(50556);async function N(Ee,Ie,Qe){let at=!0;const ft=Ee.languageProvider.metricsMetadata;ft&&Object.keys(ft).length===0&&(at=!1);let ct={},vt={},Pt;return Pt=Qe?.map(Vt=>{const Jt=B(Vt,Ee),wt=`${Vt}\xA6${Jt.description}`;return ct[Vt]=Jt,vt[wt]=Jt,Jt}),{isLoading:!1,hasMetadata:at,metrics:Pt??[],metaHaystackDictionary:vt,nameHaystackDictionary:ct,totalMetricCount:Pt?.length??0,filteredMetricCount:Pt?.length??0}}function B(Ee,Ie){let Qe=(0,w.AU)(Ee,Ie.languageProvider.metricsMetadata);const at=(0,w.pK)(Ee,Ie.languageProvider.metricsMetadata);["histogram","summary"].forEach(vt=>{at?.toLowerCase().includes(vt)&&Qe!==vt&&(Qe+=` (${vt})`)});const ft=Ee.match(/^\w+_bucket$|^\w+_bucket{.*}$/);return Qe==="histogram"&&!ft&&(Qe="native histogram"),{value:Ee,type:Qe,description:at}}function V(Ee,Ie){const Qe=K(Ee);return!Ee.isLoading&&Ee.filteredMetricCount!==Qe.length&&Ie(be(Qe.length)),X(Qe,Ee.pageNum,Ee.resultsPerPage)}function K(Ee){let Ie=Ee.metrics;return Ee.fuzzySearchQuery&&!Ee.useBackend&&(Ee.fullMetaSearch?Ie=Ee.metaHaystackOrder.map(Qe=>Ee.metaHaystackDictionary[Qe]):Ie=Ee.nameHaystackOrder.map(Qe=>Ee.nameHaystackDictionary[Qe])),Ee.selectedTypes.length>0&&(Ie=Ie.filter((Qe,at)=>Ee.selectedTypes.some(ct=>Qe.type&&ct.value?Qe.type.includes(ct.value):!Qe.type&&ct.value==="no type"))),Ee.includeNullMetadata||(Ie=Ie.filter(Qe=>Qe.type!==void 0&&Qe.description!==void 0)),Ie}function H(Ee){if(!Ee.metrics.length)return[];const Ie=Ee.resultsPerPage===0?1:Ee.resultsPerPage,Qe=Math.floor(K(Ee).length/Ie)+1;return[...Array(Qe).keys()].map(at=>at+1)}function X(Ee,Ie,Qe){const at=Qe===0?1:Qe,ft=Ie===1?0:(Ie-1)*at,ct=ft+at;return Ee.slice(ft,ct)}const k=(Ee,Ie,Qe)=>Ee<1?1:Ee>Qe?Qe:Ee??Ie;async function Y(Ee,Ie,Qe){const at=(0,C.b4)(Ee),ft=Ie.map(Pt=>`,${Pt.label}="${Pt.value}"`),ct=`label_values({__name__=~".*${at}"${Ie?ft.join():""}},__name__)`;return await Qe.metricFindQuery(ct).then(Pt=>Pt.map(Vt=>B(Vt.text,Qe)))}function Z(Ee,Ie,Qe,at){switch(Ee){case"grafana_prom_metric_encycopedia_tracking":(0,W.rR)(Ee,{metric:Qe,hasMetadata:Ie?.hasMetadata,totalMetricCount:Ie?.totalMetricCount,fuzzySearchQuery:Ie?.fuzzySearchQuery,fullMetaSearch:Ie?.fullMetaSearch,selectedTypes:Ie?.selectedTypes,useRegexSearch:Ie?.useBackend,includeResultsWithoutMetadata:Ie?.includeNullMetadata});case"grafana_prom_metric_encycopedia_disable_text_wrap_interaction":(0,W.rR)(Ee,{disableTextWrap:Ie?.disableTextWrap});case"grafana_prometheus_metric_encyclopedia_open":(0,W.rR)(Ee,{query:at})}}const se=[{value:"counter",description:"A cumulative metric that represents a single monotonically increasing counter whose value can only increase or be reset to zero on restart."},{value:"gauge",description:"A metric that represents a single numerical value that can arbitrarily go up and down."},{value:"histogram",description:"A histogram samples observations (usually things like request durations or response sizes) and counts them in configurable buckets."},{value:"native histogram",description:"Native histograms are different from classic Prometheus histograms in a number of ways: Native histogram bucket boundaries are calculated by a formula that depends on the scale (resolution) of the native histogram, and are not user defined."},{value:"summary",description:"A summary samples observations (usually things like request durations and response sizes) and can calculate configurable quantiles over a sliding time window."},{value:"unknown",description:"These metrics have been given the type unknown in the metadata."},{value:"no type",description:"These metrics have no defined type in the metadata."}],j={browse:"Search metrics by name",metadataSearchSwitch:"Include description in search",type:"Filter by type",includeNullMetadata:"Include results with no metadata",setUseBackend:"Enable regex search"};function q(Ee){const{state:Ie,onChangeFullMetaSearch:Qe,onChangeIncludeNullMetadata:at,onChangeDisableTextWrap:ft,onChangeUseBackend:ct}=Ee,vt=(0,p.$j)(),Pt=ne(vt);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:Pt.selectItem,children:[(0,t.jsx)(L.d,{"data-testid":je.searchWithMetadata,value:Ie.fullMetaSearch,disabled:Ie.useBackend||!Ie.hasMetadata,onChange:()=>Qe()}),(0,t.jsx)("div",{className:Pt.selectItemLabel,children:j.metadataSearchSwitch})]}),(0,t.jsxs)("div",{className:Pt.selectItem,children:[(0,t.jsx)(L.d,{value:Ie.includeNullMetadata,disabled:!Ie.hasMetadata,onChange:()=>at()}),(0,t.jsx)("div",{className:Pt.selectItemLabel,children:j.includeNullMetadata})]}),(0,t.jsxs)("div",{className:Pt.selectItem,children:[(0,t.jsx)(L.d,{value:Ie.disableTextWrap,onChange:()=>ft()}),(0,t.jsx)("div",{className:Pt.selectItemLabel,children:"Disable text wrap"})]}),(0,t.jsxs)("div",{className:Pt.selectItem,children:[(0,t.jsx)(L.d,{"data-testid":je.setUseBackend,value:Ie.useBackend,onChange:()=>ct()}),(0,t.jsxs)("div",{className:Pt.selectItemLabel,children:[j.setUseBackend,"\xA0"]}),(0,t.jsx)(U.m,{content:"Filter metric names by regex search, using an additional call on the Prometheus API.",placement:"bottom-end",children:(0,t.jsx)(y.I,{name:"info-circle",size:"xs",className:Pt.settingsIcon})})]})]})}function ne(Ee){return{settingsIcon:(0,n.css)({color:Ee.colors.text.secondary}),selectItem:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center",padding:"4px 0"}),selectItemLabel:(0,n.css)({margin:`0 0 0 ${Ee.spacing(1)}`,alignSelf:"center",color:Ee.colors.text.secondary,fontSize:"12px"})}}var oe=e(67061);function z({feedbackUrl:Ee}){const Ie=(0,p.of)(te);return(0,t.jsx)(oe.B,{children:(0,t.jsxs)("a",{href:Ee,className:Ie.link,title:"The metrics explorer is new, please let us know how we can improve it",target:"_blank",rel:"noreferrer noopener",children:[(0,t.jsx)(y.I,{name:"comment-alt-message"})," Give feedback"]})})}function te(Ee){return{link:(0,n.css)({color:Ee.colors.text.secondary,fontSize:Ee.typography.bodySmall.fontSize,":hover":{color:Ee.colors.text.link},margin:"-25px 0 30px 0"})}}var le=e(4936);function ie(Ee){const{metrics:Ie,onChange:Qe,onClose:at,query:ft,state:ct,disableTextWrap:vt}=Ee,Pt=(0,p.$j)(),Vt=ae(Pt,vt);function Jt(Cn){Cn.value&&(Qe({...ft,metric:Cn.value}),Z("grafana_prom_metric_encycopedia_tracking",ct,Cn.value),at())}function wt(Cn){return ct.fullMetaSearch&&Cn?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("td",{children:on(Cn.type??"")}),(0,t.jsx)("td",{children:(0,t.jsx)(a(),{textToHighlight:Cn.description??"",searchWords:ct.metaHaystackMatches,autoEscape:!0,highlightClassName:Vt.matchHighLight})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("td",{children:on(Cn.type??"")}),(0,t.jsx)("td",{children:Cn.description??""})]})}function zt(Cn,Ye,Dt){return(0,t.jsxs)(t.Fragment,{children:[Cn,(0,t.jsx)("span",{className:Vt.tooltipSpace,children:(0,t.jsx)(U.m,{content:(0,t.jsxs)(t.Fragment,{children:["When creating a ",Ye,", Prometheus exposes multiple series with the type counter."," ",(0,le.jW)(Dt)]}),placement:"bottom-start",interactive:!0,children:(0,t.jsx)(y.I,{name:"info-circle",size:"xs"})})})]})}function on(Cn){return Cn?Cn.includes("(summary)")?zt(Cn,"summary","https://prometheus.io/docs/concepts/metric_types/#summary"):Cn.includes("(histogram)")?zt(Cn,"histogram","https://prometheus.io/docs/concepts/metric_types/#histogram"):Cn:""}function Pn(){let Cn;return ct.fuzzySearchQuery||(Cn="There are no metrics found in the data source."),ft.labels.length>0&&(Cn="There are no metrics found. Try to expand your label filters."),(ct.fuzzySearchQuery||ct.selectedTypes.length>0)&&(Cn="There are no metrics found. Try to expand your search and filters."),(0,t.jsx)("tr",{className:Vt.noResults,children:(0,t.jsx)("td",{colSpan:3,children:Cn})})}function _n(Cn){return Cn.useBackend?[Cn.fuzzySearchQuery]:Cn.fullMetaSearch?Cn.metaHaystackMatches:Cn.nameHaystackMatches}return(0,t.jsxs)("table",{className:Vt.table,children:[(0,t.jsx)("thead",{className:Vt.stickyHeader,children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:`${Vt.nameWidth} ${Vt.tableHeaderPadding}`,children:"Name"}),ct.hasMetadata&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("th",{className:`${Vt.typeWidth} ${Vt.tableHeaderPadding}`,children:"Type"}),(0,t.jsx)("th",{className:`${Vt.descriptionWidth} ${Vt.tableHeaderPadding}`,children:"Description"})]}),(0,t.jsx)("th",{className:Vt.selectButtonWidth,children:" "})]})}),(0,t.jsx)("tbody",{children:(0,t.jsxs)(t.Fragment,{children:[Ie.length>0&&Ie.map((Cn,Ye)=>(0,t.jsxs)("tr",{className:Vt.row,children:[(0,t.jsx)("td",{className:Vt.nameOverflow,children:(0,t.jsx)(a(),{textToHighlight:Cn?.value??"",searchWords:_n(ct),autoEscape:!0,highlightClassName:Vt.matchHighLight})}),ct.hasMetadata&&wt(Cn),(0,t.jsx)("td",{children:(0,t.jsx)(m.$n,{size:"md",variant:"secondary",onClick:()=>Jt(Cn),className:Vt.centerButton,children:"Select"})})]},Cn?.value??Ye)),Ie.length===0&&!ct.isLoading&&Pn()]})})]})}const ae=(Ee,Ie)=>({table:(0,n.css)({tableLayout:Ie?void 0:"fixed",borderRadius:Ee.shape.radius.default,width:"100%",whiteSpace:Ie?"nowrap":"normal",td:{padding:Ee.spacing(1)},"td,th":{minWidth:Ee.spacing(3),borderBottom:`1px solid ${Ee.colors.border.weak}`}}),row:(0,n.css)({label:"row",borderBottom:`1px solid ${Ee.colors.border.weak}`,"&:last-child":{borderBottom:0}}),tableHeaderPadding:(0,n.css)({padding:"8px"}),matchHighLight:(0,n.css)({background:"inherit",color:Ee.components.textHighlight.text,backgroundColor:Ee.components.textHighlight.background}),nameWidth:(0,n.css)({width:Ie?void 0:"37.5%"}),nameOverflow:(0,n.css)({overflowWrap:Ie?void 0:"anywhere"}),typeWidth:(0,n.css)({width:Ie?void 0:"15%"}),descriptionWidth:(0,n.css)({width:Ie?void 0:"35%"}),selectButtonWidth:(0,n.css)({width:Ie?void 0:"12.5%"}),stickyHeader:(0,n.css)({position:"sticky",top:0,backgroundColor:Ee.colors.background.primary}),noResults:(0,n.css)({textAlign:"center",color:Ee.colors.text.secondary}),tooltipSpace:(0,n.css)({marginLeft:"4px"}),centerButton:(0,n.css)({display:"block",margin:"auto",border:"none"})});var re=e(78036);const ce=(Ee,Ie)=>({modal:(0,n.css)({width:"85vw",[Ee.breakpoints.down("md")]:{width:"100%"},[Ee.breakpoints.up("xl")]:{width:"60%"}}),inputWrapper:(0,n.css)({display:"flex",flexDirection:"row",flexWrap:"wrap"}),inputItemFirst:(0,n.css)({flexBasis:"40%",paddingRight:"16px",[Ee.breakpoints.down("md")]:{paddingRight:"0px",paddingBottom:"16px"}}),inputItem:(0,n.css)({flexGrow:1,flexBasis:"20%",[Ee.breakpoints.down("md")]:{minWidth:"100%"}}),selectWrapper:(0,n.css)({marginBottom:Ee.spacing(1)}),resultsAmount:(0,n.css)({color:Ee.colors.text.secondary,fontSize:"0.85rem",padding:"0 0 4px 0"}),resultsData:(0,n.css)({margin:`4px 0 ${Ee.spacing(2)} 0`}),resultsDataCount:(0,n.css)({margin:0}),resultsDataFiltered:(0,n.css)({color:Ee.colors.text.secondary,textAlign:"center",border:"solid 1px rgba(204, 204, 220, 0.25)",padding:"7px"}),resultsDataFilteredText:(0,n.css)({display:"inline",verticalAlign:"text-top"}),results:(0,n.css)({height:"calc(80vh - 310px)",overflowY:"scroll"}),resultsFooter:(0,n.css)({marginTop:"24px",display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center",position:"sticky"}),currentlySelected:(0,n.css)({color:"grey",opacity:"75%",fontSize:"0.75rem"}),loadingSpinner:(0,n.css)({visibility:"hidden"}),visible:(0,n.css)({visibility:"visible"}),settingsBtn:(0,n.css)({float:"right"}),noBorder:(0,n.css)({border:"none"}),resultsPerPageLabel:(0,n.css)({color:Ee.colors.text.secondary,opacity:"75%",paddingTop:"5px",fontSize:"0.85rem",marginRight:"8px"}),resultsPerPageWrapper:(0,n.css)({display:"flex"})});var me=e(53076),ee=e(2543);const de=new me.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1});function De(Ee,Ie,Qe){const[at,ft,ct]=de.search(Ee,Ie,0,1e5);let vt=[],Pt=new Set;if(at&&ct){const Vt=(Jt,wt)=>{wt&&Pt.add(Jt)};for(let Jt=0;Jt<ct.length;Jt++){let wt=ct[Jt];me.A.highlight(Ee[ft.idx[wt]],ft.ranges[wt],Vt),vt.push(Ee[ft.idx[wt]])}Qe([vt,[...Pt]])}else Ie||Qe([[],[]])}const fe=(0,ee.debounce)(De,300),Te=Ee=>{const{datasource:Ie,isOpen:Qe,onClose:at,onChange:ft,query:ct,initialMetrics:vt}=Ee,[Pt,Vt]=(0,r.useReducer)(He.reducer,(0,re.ue)(ct)),Jt=(0,p.$j)(),wt=ce(Jt,Pt.disableTextWrap),zt=(0,r.useCallback)(async()=>{Vt(Be(!0));const yt=await N(Ie,ct,vt);Vt(Ne({isLoading:!1,hasMetadata:yt.hasMetadata,metrics:yt.metrics,metaHaystackDictionary:yt.metaHaystackDictionary,nameHaystackDictionary:yt.nameHaystackDictionary,totalMetricCount:yt.metrics.length,filteredMetricCount:yt.metrics.length}))},[ct,Ie,vt]);(0,r.useEffect)(()=>{zt()},[zt]);const on=se.map(yt=>({value:yt.value,label:yt.value,description:yt.description})),Pn=(0,r.useMemo)(()=>s()(async yt=>{Vt(Be(!0));const Ft=await Y(yt,ct.labels,Ie);Vt(Re({metrics:Ft,filteredMetricCount:Ft.length,isLoading:!1}))},Ie.getDebounceTimeInMilliseconds()),[Ie,ct]);function _n(yt){Vt(Xe(yt))}function Cn(yt){Vt(Je(yt))}function Ye(yt,Ft){Pt.useBackend&&yt===""?zt():Pt.useBackend?Pn(yt):Ft?fe(Object.keys(Pt.metaHaystackDictionary),yt,Cn):fe(Object.keys(Pt.nameHaystackDictionary),yt,_n)}const Dt=(0,t.jsx)(q,{state:Pt,onChangeFullMetaSearch:()=>{const yt=!Pt.fullMetaSearch;Vt(st(yt)),ft({...ct,fullMetaSearch:yt}),Ye(Pt.fuzzySearchQuery,yt)},onChangeIncludeNullMetadata:()=>{Vt(pt(!Pt.includeNullMetadata)),ft({...ct,includeNullMetadata:!Pt.includeNullMetadata})},onChangeDisableTextWrap:()=>{Vt($e()),ft({...ct,disableTextWrap:!Pt.disableTextWrap}),Z("grafana_prom_metric_encycopedia_disable_text_wrap_interaction",Pt,"")},onChangeUseBackend:()=>{const yt=!Pt.useBackend;Vt(ot(yt)),ft({...ct,useBackend:yt}),yt===!1?zt():Pt.fuzzySearchQuery!==""&&Pn(Pt.fuzzySearchQuery)}});return(0,t.jsxs)(S.a,{"data-testid":je.metricModal,isOpen:Qe,title:"Metrics explorer",onDismiss:at,"aria-label":"Browse metrics",className:wt.modal,children:[(0,t.jsx)(z,{feedbackUrl:"https://forms.gle/DEMAJHoAMpe3e54CA"}),(0,t.jsxs)("div",{className:wt.inputWrapper,"data-testid":o.Tp.components.DataSource.Prometheus.queryEditor.builder.metricsExplorer,children:[(0,t.jsx)("div",{className:(0,n.cx)(wt.inputItem,wt.inputItemFirst),children:(0,t.jsx)(I.p,{autoFocus:!0,"data-testid":je.searchMetric,placeholder:j.browse,value:Pt.fuzzySearchQuery,onInput:yt=>{const Ft=yt.currentTarget.value??"";Vt(Ke(Ft)),Ye(Ft,Pt.fullMetaSearch)}})}),Pt.hasMetadata&&(0,t.jsx)("div",{className:wt.inputItem,children:(0,t.jsx)(D.KF,{"data-testid":je.selectType,inputId:"my-select",options:on,value:Pt.selectedTypes,placeholder:j.type,onChange:yt=>Vt(xt(yt))})}),(0,t.jsx)("div",{children:(0,t.jsx)(T.y,{className:`${wt.loadingSpinner} ${Pt.isLoading?wt.visible:""}`})}),(0,t.jsx)("div",{className:wt.inputItem,children:(0,t.jsx)(b.G,{"aria-label":"Additional settings",content:Dt,placement:"bottom-end",closeButton:!1,children:(0,t.jsxs)(R.e,{className:wt.settingsBtn,children:[(0,t.jsx)(m.$n,{variant:"secondary",size:"md",onClick:()=>Vt(ve()),"data-testid":je.showAdditionalSettings,className:wt.noBorder,children:"Additional Settings"}),(0,t.jsx)(m.$n,{className:wt.noBorder,variant:"secondary",icon:Pt.showAdditionalSettings?"angle-up":"angle-down"})]})})})]}),(0,t.jsxs)("div",{className:wt.resultsData,children:[ct.metric&&(0,t.jsxs)("i",{className:wt.currentlySelected,children:["Currently selected: ",ct.metric]}),ct.labels.length>0&&(0,t.jsxs)("div",{className:wt.resultsDataFiltered,children:[(0,t.jsx)(y.I,{name:"info-circle",size:"sm"}),(0,t.jsx)("div",{className:wt.resultsDataFilteredText,children:"\xA0These metrics have been pre-filtered by labels chosen in the label filters."})]})]}),(0,t.jsx)("div",{className:wt.results,children:Pt.metrics&&(0,t.jsx)(ie,{metrics:V(Pt,Vt),onChange:ft,onClose:at,query:ct,state:Pt,disableTextWrap:Pt.disableTextWrap})}),(0,t.jsxs)("div",{className:wt.resultsFooter,children:[(0,t.jsxs)("div",{className:wt.resultsAmount,children:["Showing ",Pt.filteredMetricCount," of ",Pt.totalMetricCount," results"]}),(0,t.jsx)(A.d,{currentPage:Pt.pageNum??1,numberOfPages:H(Pt).length,onNavigate:yt=>{Vt(We(yt??1))}}),(0,t.jsxs)("div",{className:wt.resultsPerPageWrapper,children:[(0,t.jsx)("p",{className:wt.resultsPerPageLabel,children:"# Results per page\xA0"}),(0,t.jsx)(I.p,{"data-testid":je.resultsPerPage,value:k(Pt.resultsPerPage,re.J3,re.yH),placeholder:"results per page",width:10,title:"The maximum results per page is "+re.yH,type:"number",onInput:yt=>{const Ft=+yt.currentTarget.value;isNaN(Ft)||Ft>=re.yH||Vt(Se(Ft))}})]})]})]})},je={metricModal:"metric-modal",searchMetric:"search-metric",searchWithMetadata:"search-with-metadata",selectType:"select-type",metricCard:"metric-card",useMetric:"use-metric",searchPage:"search-page",resultsPerPage:"results-per-page",setUseBackend:"set-use-backend",showAdditionalSettings:"show-additional-settings"},He=(0,M.Z0)({name:"metrics-modal-state",initialState:(0,re.ue)(),reducers:{filterMetricsBackend:(Ee,Ie)=>{Ee.metrics=Ie.payload.metrics,Ee.filteredMetricCount=Ie.payload.filteredMetricCount,Ee.isLoading=Ie.payload.isLoading},buildMetrics:(Ee,Ie)=>{Ee.isLoading=Ie.payload.isLoading,Ee.metrics=Ie.payload.metrics,Ee.hasMetadata=Ie.payload.hasMetadata,Ee.metaHaystackDictionary=Ie.payload.metaHaystackDictionary,Ee.nameHaystackDictionary=Ie.payload.nameHaystackDictionary,Ee.totalMetricCount=Ie.payload.totalMetricCount,Ee.filteredMetricCount=Ie.payload.filteredMetricCount},setIsLoading:(Ee,Ie)=>{Ee.isLoading=Ie.payload},setFilteredMetricCount:(Ee,Ie)=>{Ee.filteredMetricCount=Ie.payload},setResultsPerPage:(Ee,Ie)=>{Ee.resultsPerPage=Ie.payload},setPageNum:(Ee,Ie)=>{Ee.pageNum=Ie.payload},setFuzzySearchQuery:(Ee,Ie)=>{Ee.fuzzySearchQuery=Ie.payload,Ee.pageNum=1},setNameHaystack:(Ee,Ie)=>{Ee.nameHaystackOrder=Ie.payload[0],Ee.nameHaystackMatches=Ie.payload[1]},setMetaHaystack:(Ee,Ie)=>{Ee.metaHaystackOrder=Ie.payload[0],Ee.metaHaystackMatches=Ie.payload[1]},setFullMetaSearch:(Ee,Ie)=>{Ee.fullMetaSearch=Ie.payload,Ee.pageNum=1},setIncludeNullMetadata:(Ee,Ie)=>{Ee.includeNullMetadata=Ie.payload,Ee.pageNum=1},setSelectedTypes:(Ee,Ie)=>{Ee.selectedTypes=Ie.payload,Ee.pageNum=1},setUseBackend:(Ee,Ie)=>{Ee.useBackend=Ie.payload,Ee.fullMetaSearch=!1,Ee.pageNum=1},setDisableTextWrap:Ee=>{Ee.disableTextWrap=!Ee.disableTextWrap},showAdditionalSettings:Ee=>{Ee.showAdditionalSettings=!Ee.showAdditionalSettings}}}),{setIsLoading:Be,buildMetrics:Ne,filterMetricsBackend:Re,setResultsPerPage:Se,setPageNum:We,setFuzzySearchQuery:Ke,setNameHaystack:Xe,setMetaHaystack:Je,setFullMetaSearch:st,setIncludeNullMetadata:pt,setSelectedTypes:xt,setUseBackend:ot,setDisableTextWrap:$e,showAdditionalSettings:ve,setFilteredMetricCount:be}=He.actions,he=" ",ye=1e3;function Pe({datasource:Ee,query:Ie,onChange:Qe,onGetMetrics:at,labelsFilters:ft,metricLookupDisabled:ct,onBlur:vt,variableEditor:Pt}){const Vt=(0,p.of)(ge),[Jt,wt]=(0,r.useState)({}),zt=l.$.featureToggles.prometheusMetricEncyclopedia,on=[{value:"BrowseMetrics",label:"Metrics explorer",description:"Browse and filter all metrics and metadata with a fuzzy search"}],Pn=(0,r.useCallback)((hn,Un)=>{const Nn=hn.label??hn.value;return Nn?Nn.toLowerCase?Un.split(he).reduce((nn,ht)=>{const lt=Nn.toLowerCase().includes(ht.toLowerCase());let gt=!1;return zt&&(gt=Nn==="Metrics explorer"),nn&&(lt||gt)},!0):!0:!1},[zt]),_n=(0,r.useCallback)((hn,Un)=>hn.__isNew__?hn.label:(0,t.jsx)(a(),{searchWords:Un.inputValue.split(he),textToHighlight:hn.label??"",highlightClassName:Vt.highlight}),[Vt.highlight]),Cn=(hn,Un)=>{const Nn=(0,C.b4)(hn);return xe(Nn,Un)},Ye=hn=>Ee.metricFindQuery(Cn(hn,ft)).then(Nn=>{const St=Nn.length;(0,E.ky)(Nn),St>Nn.length?wt({...Jt,resultsTruncated:!0}):wt({...Jt,resultsTruncated:!1});const nn=Nn.map(ht=>({label:ht.text,value:ht.text}));return zt?[...on,...nn]:nn}),Dt=()=>Promise.resolve([]),yt=s()(hn=>Ye(hn),Ee.getDebounceTimeInMilliseconds()),Ft=hn=>{const Un=hn.data;if(Un.value==="BrowseMetrics"){const Nn=hn.isFocused?Vt.focus:"";return(0,t.jsx)("div",{...hn.innerProps,ref:hn.innerRef,className:`${Vt.customOptionWidth} metric-encyclopedia-open`,"data-testid":o.Tp.components.Select.option,onKeyDown:St=>{St.code==="Enter"&&wt({...Jt,metricsModalOpen:!0})},children:(0,t.jsxs)("div",{className:`${Vt.customOption} ${Nn} metric-encyclopedia-open`,children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"metric-encyclopedia-open",children:Un.label}),(0,t.jsx)("div",{className:`${Vt.customOptionDesc} metric-encyclopedia-open`,children:Un.description})]}),(0,t.jsxs)(m.$n,{fill:"text",size:"sm",variant:"secondary",onClick:()=>wt({...Jt,metricsModalOpen:!0}),className:"metric-encyclopedia-open",children:["Open",(0,t.jsx)(y.I,{name:"arrow-right"})]})]})})}return(0,d.o5)(hn)},an=({children:hn,maxHeight:Un,innerRef:Nn,innerProps:St})=>{const nn=(0,p.$j)(),ht=(0,v.J)(nn),lt=!r.isValidElement(hn)&&Jt.resultsTruncated;return(0,t.jsxs)("div",{...St,className:`${ht.menu} ${Vt.customMenuContainer}`,style:{maxHeight:Math.round(Un*.9)},"aria-label":"Select options menu",children:[(0,t.jsx)(u.E,{scrollRefCallback:Nn,autoHide:!1,autoHeightMax:"inherit",hideHorizontalTrack:!0,showScrollIndicators:!0,children:hn}),lt&&(0,t.jsx)("div",{className:Vt.customMenuFooter,children:(0,t.jsx)("div",{children:"Only the top 1000 metrics are displayed in the metric select. Use the metrics explorer to view all metrics."})})]})},un=()=>(0,t.jsx)(D.DW,{"data-testid":o.Tp.components.DataSource.Prometheus.queryEditor.builder.metricSelect,isClearable:!!Pt,inputId:"prometheus-metric-select",className:Vt.select,value:Ie.metric?(0,c.z)(Ie.metric):void 0,placeholder:"Select metric",allowCustomValue:!0,formatOptionLabel:_n,filterOption:Pn,minMenuHeight:250,onOpenMenu:async()=>{if(ct)return;wt({isLoading:!0});const hn=await at(),Un=hn.map(St=>St.value),Nn=hn.length;hn.length>ye&&(0,E.ky)(hn),wt(zt?{metrics:[...on,...hn],isLoading:void 0,initialMetrics:Un,resultsTruncated:Nn>hn.length}:{metrics:hn,isLoading:void 0,resultsTruncated:Nn>hn.length})},loadOptions:ct?Dt:yt,isLoading:Jt.isLoading,defaultOptions:Jt.metrics??Array.from(new Array(25),()=>({value:""})),onChange:hn=>{const Un=hn?.value;Un?zt&&Un==="BrowseMetrics"?(Z("grafana_prometheus_metric_encyclopedia_open",null,"",Ie),wt({...Jt,metricsModalOpen:!0})):Qe({...Ie,metric:Un}):Qe({...Ie,metric:""})},components:zt?{Option:Ft,MenuList:an}:{MenuList:an},onBlur:vt});return(0,t.jsxs)(t.Fragment,{children:[zt&&!Ee.lookupsDisabled&&Jt.metricsModalOpen&&(0,t.jsx)(Te,{datasource:Ee,isOpen:Jt.metricsModalOpen,onClose:()=>wt({...Jt,metricsModalOpen:!1}),query:Ie,onChange:Qe,initialMetrics:Jt.initialMetrics??[]}),Pt?(0,t.jsx)(P.C,{children:(0,t.jsx)(x.I,{label:"Metric",labelWidth:20,tooltip:(0,t.jsx)("div",{children:"Optional: returns a list of label values for the label name in the specified metric."}),children:un()})}):(0,t.jsx)(h.B,{children:(0,t.jsx)(g.c,{label:"Metric",children:un()})})]})}const ge=Ee=>({select:(0,n.css)({minWidth:"125px"}),highlight:(0,n.css)({label:"select__match-highlight",background:"inherit",padding:"inherit",color:Ee.colors.warning.contrastText,backgroundColor:Ee.colors.warning.main}),customOption:(0,n.css)({padding:"8px",display:"flex",justifyContent:"space-between",cursor:"pointer",":hover":{backgroundColor:Ee.colors.emphasize(Ee.colors.background.primary,.1)}}),customOptionlabel:(0,n.css)({color:Ee.colors.text.primary}),customOptionDesc:(0,n.css)({color:Ee.colors.text.secondary,fontSize:Ee.typography.size.xs,opacity:"50%"}),focus:(0,n.css)({backgroundColor:Ee.colors.emphasize(Ee.colors.background.primary,.1)}),customOptionWidth:(0,n.css)({minWidth:"400px"}),customMenuFooter:(0,n.css)({flex:0,display:"flex",justifyContent:"space-between",padding:Ee.spacing(1.5),borderTop:`1px solid ${Ee.colors.border.weak}`,color:Ee.colors.text.secondary}),customMenuContainer:(0,n.css)({display:"flex",flexDirection:"column",background:Ee.colors.background.primary,boxShadow:Ee.shadows.z3})}),xe=(Ee,Ie)=>{const Qe=Ie?Ae(Ie):[];return`label_values({__name__=~".*${Ee}"${Qe?Qe.join(""):""}},__name__)`},Ae=Ee=>Ee.map(Ie=>`,${Ie.label}="${Ie.value}"`)},29993:(G,O,e)=>{"use strict";e.d(O,{I:()=>I});var t=e(74848),n=e(96540),i=e(50556),s=e(81996),r=e(32370),f=e(26115),a=e(32196),c=e(2543),o=e(85269),h=e(97801),g=e(81580),l=e(39268),p=e(76892),m=e(76459),y=e.n(m),d=e(50877),v=e(13544),u=e(81392),D=e(3721),P=e(90182);function x({item:b,defaultOp:R,onChange:A,onDelete:L,onGetLabelNames:U,onGetLabelValues:W,invalidLabel:w,invalidValue:N,getLabelValuesAutofillSuggestions:B,debounceDuration:V}){const[K,H]=(0,n.useState)({}),[X,k]=(0,n.useState)(!1),[Y,Z]=(0,n.useState)(!1),se=(oe=b.op)=>E.find(z=>z.label===oe)?.isMultiValue,j=oe=>{if(oe){const z=/\(([^)]+)\)/,te=oe?.match(z);return te&&te[0].indexOf("|")>0?[oe]:oe.indexOf("|")>0?oe.split("|"):[oe]}return[]},q=y()(oe=>B(oe,b.label),V),ne=b?.value??"";return(0,t.jsx)("div",{"data-testid":"prometheus-dimensions-filter-item",children:(0,t.jsxs)(u.M,{children:[(0,t.jsx)(P.l6,{placeholder:"Select label","data-testid":v.Tp.components.QueryBuilder.labelSelect,inputId:"prometheus-dimensions-filter-item-key",width:"auto",value:b.label?(0,d.z)(b.label):null,allowCustomValue:!0,onOpenMenu:async()=>{H({isLoadingLabelNames:!0});const oe=await U(b);k(!0),H({labelNames:oe,isLoadingLabelNames:void 0})},onCloseMenu:()=>{k(!1)},isOpen:X,isLoading:K.isLoadingLabelNames??!1,options:K.labelNames,onChange:oe=>{oe.label&&A({...b,op:b.op??R,label:oe.label})},invalid:w}),(0,t.jsx)(P.l6,{"data-testid":v.Tp.components.QueryBuilder.matchOperatorSelect,className:"query-segment-operator",value:(0,d.z)(b.op??R),options:E,width:"auto",onChange:oe=>{oe.value!=null&&A({...b,op:oe.value,value:se(oe.value)?b.value:j(b?.value)[0]})}}),(0,t.jsx)(P.DW,{placeholder:"Select value","data-testid":v.Tp.components.QueryBuilder.valueSelect,inputId:"prometheus-dimensions-filter-item-value",width:"auto",value:se()?j(ne).map(d.z):j(ne).map(d.z)[0],allowCustomValue:!0,formatCreateLabel:oe=>oe,createOptionPosition:b.op?.includes("~")?"first":"last",onOpenMenu:async()=>{H({isLoadingLabelValues:!0});const oe=await W(b);(0,s.ky)(oe),Z(!0),H({...K,labelValues:oe,isLoadingLabelValues:void 0})},onCloseMenu:()=>{Z(!1)},isOpen:Y,defaultOptions:K.labelValues,isMulti:se(),isLoading:K.isLoadingLabelValues,loadOptions:q,onChange:oe=>{if(oe.value)A({...b,value:oe.value,op:b.op??R});else{const z=oe.map(te=>te.label).join("|");A({...b,value:z,op:b.op??R})}},invalid:N}),(0,t.jsx)(D.Z,{"aria-label":`remove-${b.label}`,icon:"times",variant:"secondary",onClick:L})]})},ne)}const E=[{label:"=",value:"=",isMultiValue:!1},{label:"!=",value:"!=",isMultiValue:!1},{label:"=~",value:"=~",isMultiValue:!0},{label:"!~",value:"!~",isMultiValue:!0}],C="Select at least 1 label filter (label and value)";function M({labelsFilters:b,onChange:R,onGetLabelNames:A,onGetLabelValues:L,labelFilterRequired:U,getLabelValuesAutofillSuggestions:W,debounceDuration:w,variableEditor:N}){const B="=",[V,K]=(0,n.useState)([{op:B}]);(0,n.useEffect)(()=>{b.length>0?K(b):K([{op:B}])},[b]);const H=Y=>{K(Y);const Z=Y.filter(se=>se.label!=null&&se.value!=null);(0,c.isEqual)(Z,b)||R(Z)},X=V.some(Y=>Y.label&&Y.value),k=()=>(0,t.jsx)(o.o,{items:V,onChange:H,renderItem:(Y,Z,se)=>(0,t.jsx)(x,{debounceDuration:w,item:Y,defaultOp:B,onChange:Z,onDelete:se,onGetLabelNames:A,onGetLabelValues:L,invalidLabel:U&&!Y.label,invalidValue:U&&!Y.value,getLabelValuesAutofillSuggestions:W})});return(0,t.jsx)(t.Fragment,{children:N?(0,t.jsx)(l.C,{children:(0,t.jsxs)("div",{className:(0,a.cx)((0,a.css)({display:"flex"})),children:[(0,t.jsx)(p.c,{width:20,tooltip:(0,t.jsx)("div",{children:"Optional: used to filter the metric select for this query type."}),children:"Label filters"}),k()]})}):(0,t.jsx)(h.B,{children:(0,t.jsx)(g.c,{label:"Label filters",error:C,invalid:U&&!X,children:k()})})})}var S=e(9103);function I({datasource:b,query:R,onChange:A,onBlur:L,variableEditor:U}){const W=k=>{A({...R,labels:k})},w=(0,n.useCallback)(async k=>{const Y=b.getVariables(),Z=await k;return[...Y.map(se=>({label:se,value:se})),...Z.map(se=>({label:se.value,value:se.value,title:se.description}))]},[b]),N=async k=>{if(!R.metric)return await b.languageProvider.fetchLabels(),b.languageProvider.getLabelKeys().map(j=>({value:j}));const Y=R.labels.filter(j=>j!==k);Y.push({label:"__name__",op:"=",value:R.metric});const Z=r.z.renderLabels(Y);let se=await b.languageProvider.fetchLabelsWithMatch(Z);return Object.keys(se).filter(j=>!Y.find(q=>q.label===j)).map(j=>({value:j}))},B=(k,Y)=>{const Z={label:Y??"__name__",op:"=~",value:(0,f.b4)(`.*${k}`)},se=R.labels.filter(oe=>oe.label!==Z.label);se.push(Z),R.metric&&se.push({label:"__name__",op:"=",value:R.metric});const j=se.map(oe=>({...oe,label:b.interpolateString(oe.label),value:b.interpolateString(oe.value)})),q=r.z.renderLabels(j);let ne;return b.hasLabelsMatchAPISupport()?ne=K(Z,q):ne=V(Z,q),ne.then(oe=>((0,s.ky)(oe),oe))},V=(k,Y)=>{if(!k.label)return Promise.resolve([]);const Z=b.languageProvider.fetchSeries(Y),se=b.interpolateString(k.label);return Z.then(j=>{const q=new Set;return j.forEach(ne=>{const oe=ne[se];q.add(oe)}),Array.from(q).map(ne=>({label:ne,value:ne}))})},K=(k,Y)=>{if(!k.label)return Promise.resolve([]);const Z=`[${b.uid}][${R.metric}][${k.label}][${k.op}]`;return b.languageProvider.fetchSeriesValuesWithMatch(k.label,Y,Z).then(se=>se.map(j=>({value:j,label:j})))},H=async k=>{if(!k.label)return[];if(!R.metric)return(await b.languageProvider.getLabelValues(k.label)).map(j=>({value:j}));const Y=R.labels.filter(j=>j!==k);Y.push({label:"__name__",op:"=",value:R.metric});const Z=Y.map(j=>({...j,label:b.interpolateString(j.label),value:b.interpolateString(j.value)})),se=r.z.renderLabels(Z);return b.hasLabelsMatchAPISupport()?K(k,se):V(k,se)},X=(0,n.useCallback)(()=>w(T(b,R)),[b,R,w]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(S.dm,{query:R,onChange:A,onGetMetrics:X,datasource:b,labelsFilters:R.labels,metricLookupDisabled:b.lookupsDisabled,onBlur:L||(()=>{}),variableEditor:U}),(0,t.jsx)(M,{debounceDuration:b.getDebounceTimeInMilliseconds(),getLabelValuesAutofillSuggestions:B,labelsFilters:R.labels,onChange:W,onGetLabelNames:k=>w(N(k)),onGetLabelValues:k=>w(H(k)),variableEditor:U})]})}async function T(b,R){b.languageProvider.metricsMetadata||await b.languageProvider.loadMetricsMetadata(),b.languageProvider.metricsMetadata||(b.languageProvider.metricsMetadata={});let A;if(R.labels.length>0){const L=r.z.renderLabels(R.labels);A=(await b.languageProvider.getSeries(L,!0)).__name__??[]}else A=await b.languageProvider.getLabelValues("__name__")??[];return A.map(L=>({value:L,description:(0,i.xB)(L,b.languageProvider.metricsMetadata)}))}},26432:(G,O,e)=>{"use strict";e.d(O,{W:()=>h,i:()=>g});var t=e(74848),n=e(96540),i=e(67061),s=e(20719),r=e(32370),f=e(76040),a=e(27994),c=e(96625),o=e(3884);const h="Fetch all series matching metric name and label filters.",g=(0,n.memo)(({query:l})=>{const p=(0,f.u)(l||"").query,m={grammar:s.Ay,name:"promql"};return(0,t.jsxs)(i.B,{gap:.5,direction:"column",children:[(0,t.jsx)(a.r,{stepNumber:1,title:(0,t.jsx)(o.Z,{query:`${p.metric} ${r.z.renderLabels(p.labels)}`,lang:m}),children:h}),(0,t.jsx)(c.k,{stepNumber:2,queryModeller:r.z,query:p,lang:m})]})});g.displayName="PromQueryBuilderExplained"},80109:(G,O,e)=>{"use strict";e.d(O,{$:()=>a});var t=e(74848),n=e(32196),i=e(13544),s=e(40845),r=e(86204),f=e(26432);function a(o){const{query:h,datasource:g,range:l,onRunQuery:p,onChange:m,data:y,app:d,showExplain:v}=o,u=(0,s.of)(c);return(0,t.jsxs)("div",{"data-testid":i.Tp.components.DataSource.Prometheus.queryEditor.code.queryField,className:u.wrapper,children:[(0,t.jsx)(r.L,{datasource:g,query:h,range:l,onRunQuery:p,onChange:m,history:[],data:y,app:d}),v&&(0,t.jsx)(f.i,{query:h.expr})]})}const c=o=>({wrapper:(0,n.css)({".gf-form":{marginBottom:0}})})},78036:(G,O,e)=>{"use strict";e.d(O,{J3:()=>t,mt:()=>s,ue:()=>i,yH:()=>n});const t=100,n=1e3;function i(r){return{isLoading:!0,metrics:[],hasMetadata:!0,metaHaystackDictionary:{},metaHaystackMatches:[],metaHaystackOrder:[],nameHaystackDictionary:{},nameHaystackOrder:[],nameHaystackMatches:[],totalMetricCount:0,filteredMetricCount:null,resultsPerPage:t,pageNum:1,fuzzySearchQuery:"",fullMetaSearch:r?.fullMetaSearch??!1,includeNullMetadata:r?.includeNullMetadata??!0,selectedTypes:[],useBackend:r?.useBackend??!1,disableTextWrap:r?.disableTextWrap??!1,showAdditionalSettings:!1}}function s(r){return{useBackend:r?.useBackend??!1,disableTextWrap:r?.disableTextWrap??!1,fullMetaSearch:r?.fullMetaSearch??!1,includeNullMetadata:r.includeNullMetadata??!1}}},1220:(G,O,e)=>{"use strict";e.d(O,{DQ:()=>m,G3:()=>v,Kl:()=>g,OS:()=>y,iZ:()=>p,jC:()=>u,jY:()=>a,kf:()=>c,nU:()=>h,z2:()=>d});var t=e(2543),n=e.n(t),i=e(55127),s=e.n(i),r=e(38961),f=e(15145);function a(I,T,b){const R=l(I,T,b),A=I.id+"(";return b&&R.push(b),A+R.join(", ")+")"}function c(I,T,b){const R=l(I,T,b),A=I.id+"(";return b&&R.unshift(b),A+R.join(", ")+")"}function o(I,T,b,R){if(T.params.length<2)throw`Cannot render a function with params of length [${T.params.length}]`;let A=(I.params??[])[0]??"5m";const L=l({...I,params:I.params.slice(1)},{...T,params:T.params.slice(1),defaultParams:T.defaultParams.slice(1)},b),U=I.id+"(";return b&&(R?L.push(`${b}[${A}]`):L.unshift(`${b}[${A}]`)),U+L.join(", ")+")"}function h(I,T,b){return o(I,T,b,!1)}function g(I,T,b){return o(I,T,b,!0)}function l(I,T,b){return(I.params??[]).map((R,A)=>T.params[A].type==="string"?'"'+R+'"':R)}function p(I,T){const b={id:I.id,params:I.defaultParams};return{...T,operations:[...T.operations,b]}}function m(I){return(0,t.capitalize)(I.replace(/_/g," "))}function y(I,T){return`operations.${I}.param.${T}`}function d(I=!1){const T=[{label:"$__interval",value:"$__interval"},{label:"1m",value:"1m"},{label:"5m",value:"5m"},{label:"10m",value:"10m"},{label:"1h",value:"1h"},{label:"24h",value:"24h"}];return I&&T.unshift({label:"$__rate_interval",value:"$__rate_interval"}),{name:"Range",type:"string",options:T}}function v(I,T={}){return[{id:I,name:m(I),params:[{name:"By label",type:"string",restParam:!0,optional:!0}],defaultParams:[],alternativesKey:"plain aggregations",category:f.Ag.Aggregations,renderer:a,paramChangedHandler:M(`__${I}_by`),explainHandler:x(I,""),addOperationHandler:p,...T},{id:`__${I}_by`,name:`${m(I)} by`,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:r.r}],defaultParams:[""],alternativesKey:"aggregations by",category:f.Ag.Aggregations,renderer:D(I),paramChangedHandler:C(I),explainHandler:x(I,"by"),addOperationHandler:p,hideFromList:!0,...T},{id:`__${I}_without`,name:`${m(I)} without`,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:r.r}],defaultParams:[""],alternativesKey:"aggregations by",category:f.Ag.Aggregations,renderer:P(I),paramChangedHandler:C(I),explainHandler:x(I,"without"),addOperationHandler:p,hideFromList:!0,...T}]}function u(I,T,b={}){const R=v(I,b);return R[0].params.unshift(...T.params),R[1].params.unshift(...T.params),R[2].params.unshift(...T.params),R[0].defaultParams=T.defaultParams,R[1].defaultParams=[...T.defaultParams,""],R[2].defaultParams=[...T.defaultParams,""],R[1].renderer=E(I),R[2].renderer=E(I),R}function D(I){return function(b,R,A){return`${I} by(${b.params.join(", ")}) (${A})`}}function P(I){return function(b,R,A){return`${I} without(${b.params.join(", ")}) (${A})`}}function x(I,T){return function(R){const A=R.params.map(U=>`\`${U}\``).join(" and "),L=s()("label",R.params.length);switch(T){case"by":return`Calculates ${I} over dimensions while preserving ${L} ${A}.`;case"without":return`Calculates ${I} over the dimensions ${A}. All other labels are preserved.`;default:return`Calculates ${I} over the dimensions.`}}}function E(I){return function(b,R,A){const L=R.params.findIndex(w=>w.restParam),U=b.params.slice(0,L),W=b.params.slice(L);return`${I} by(${W.join(", ")}) (${U.map((w,N)=>R.params[N].type==="string"?`"${w}"`:w).join(", ")}, ${A})`}}function C(I){return function(b,R,A){return R.params.length<A.params.length?{...R,id:I}:R}}function M(I){return function(b,R,A){return R.params.length===A.params.length?{...R,id:I}:R}}function S(I,T){if(!I.label||!I.op||!I.value||T.length<2)return!1;const b=I.op.toString().startsWith("!");return T.filter(L=>L.label===I.label&&L.value===I.value&&L.op!==I.op).some(L=>!!(b&&L?.op?.toString().startsWith("!")===!1||b===!1&&L?.op?.toString().startsWith("!")))}},76040:(G,O,e)=>{"use strict";e.d(O,{u:()=>s});var t=e(84555),n=e(75161),i=e(26115);function s(d){const v=(0,i.qk)(d),D=t.K3.parse(v).topNode,x={query:{metric:"",labels:[],operations:[]},errors:[]};try{f(v,D,x)}catch(E){console.error(E),E instanceof Error&&x.errors.push({text:E.message})}return y(x.query)&&(x.errors=[]),r(d)&&(x.errors=[]),x}function r(d){const v={query:{metric:"",labels:[],operations:[]},errors:[]};d=d.replace(/\$__interval/g,"1s"),d=d.replace(/\$__interval_ms/g,"1000"),d=d.replace(/\$__rate_interval/g,"1s"),d=d.replace(/\$__range_ms/g,"1000"),d=d.replace(/\$__range_s/g,"1"),d=d.replace(/\$__range/g,"1s");const D=t.K3.parse(d).topNode;try{f(d,D,v)}catch{return!1}return v.errors.length===0}function f(d,v,u){const D=u.query;switch(v.type.id){case t.gw:{D.metric=(0,i.AA)(d,v);break}case t.BG:{D.labels.push(c(d,v));const P=v.getChild(i.Ql);P&&u.errors.push((0,i.xz)(d,P));break}case t.R6:{h(d,v,u);break}case t.Fn:{g(d,v,u);break}case t.df:{p(d,v,u);break}case i.Ql:{if(a(v))break;u.errors.push((0,i.xz)(d,v));break}default:{v.type.id===t.ek&&u.errors.push((0,i.xz)(d,v));let P=v.firstChild;for(;P;)f(d,P,u),P=P.nextSibling}}}function a(d){return d.prevSibling?.firstChild?.type.id===t.Fb}function c(d,v){const u=(0,i.AA)(d,v.getChild(t.IC)),D=(0,i.AA)(d,v.getChild(t.Lf)),P=(0,i.AA)(d,v.getChild(t.LW)).replace(/^["'`]|["'`]$/g,"");return{label:u,op:D,value:P}}const o=["changes","rate","irate","increase","delta"];function h(d,v,u){const D=u.query,P=v.getChild(t.m3),x=(0,i.AA)(d,P),E=v.getChild(t.Dh),C=[];let M="";if(o.includes(x)||x.endsWith("_over_time")){let I=(0,i.AA)(d,v).match(/\[(.+)\]/);I?.[1]&&(M=I[1],C.push(I[1]))}const S={id:x,params:C};if(D.operations.unshift(S),E){if((0,i.AA)(d,E)==="(["+M+"])")return;l(d,E,u,S)}}function g(d,v,u){const D=u.query,P=v.getChild(t.xb);let x=(0,i.AA)(d,P);const E=v.getChild(t.hI),C=[];E&&(E.getChild("By")&&x&&(x=`__${x}_by`),E.getChild(t.xB)&&(x=`__${x}_without`),C.push(...(0,i.R1)(d,E,t.IC)));const M=v.getChild(t.Dh),S={id:x,params:[]};D.operations.unshift(S),l(d,M,u,S),S.params.push(...C)}function l(d,v,u,D){if(v)switch(v.type.id){case t.Dh:{let P=v.firstChild;for(;P;){let x;P.type.id===t.df?x=P:x=P.getChild(t.df),x&&u.errors.push({text:"Query parsing is ambiguous.",from:x.from,to:x.to}),l(d,P,u,D),P=P.nextSibling}break}case t.Po:{D.params.push(parseFloat((0,i.AA)(d,v)));break}case t.LW:{D.params.push((0,i.AA)(d,v).replace(/"/g,""));break}default:f(d,v,u)}}function p(d,v,u){const D=u.query,P=v.firstChild,x=(0,i.AA)(d,P.nextSibling),E=m(d,v.getChild(t.eM)??v.getChild(t.Ue)),C=v.lastChild,M=n.AE[x],S=P.type.id===t.Po,I=C.type.id===t.Po,T=C.type.id===t.df;if(S||f(d,P,u),I)D.operations.push((0,i.rq)(M,d,C,!!E?.isBool));else if(T){const b=(0,i.z9)(C);b?.type.id===t.Po&&D.operations.push((0,i.rq)(M,d,b,!!E?.isBool)),f(d,C,u)}else{D.binaryQueries=D.binaryQueries||[];const b={operator:x,query:{metric:"",labels:[],operations:[]}};E?.isMatcher&&(b.vectorMatchesType=E.matchType,b.vectorMatches=E.matches),D.binaryQueries.push(b),f(d,C,{query:b.query,errors:u.errors})}}function m(d,v){if(v){if(v.getChild("Bool"))return{isBool:!0,isMatcher:!1};{let u="";const D=v.getChild(t.x$);return D&&(u=(0,i.R1)(d,D,t.IC).join(", ")),{isMatcher:!0,isBool:!1,matches:u,matchType:v.getChild(t.On)?"on":"ignoring"}}}}function y(d){return d.labels.length===0&&d.operations.length===0&&!d.metric}},26115:(G,O,e)=>{"use strict";e.d(O,{AA:()=>c,Ql:()=>t,R1:()=>h,b4:()=>g,qk:()=>r,rq:()=>o,xz:()=>i,z9:()=>n});const t=0;function n(l){return l.firstChild?n(l.firstChild):l}function i(l,p){return{text:c(l,p),from:p.from,to:p.to,parentType:p.parent?.name}}const s=/\$(\w+)|\[\[([\s\S]+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g;function r(l){return l.replace(s,(p,m,y,d,v,u,D)=>{const P=d||D;let x=m,E="0";return y&&(x=y,E="1"),v&&(x=v,E="2"),`__V_${E}__`+x+"__V__"+(P?"__F__"+P+"__F__":"")})}const f=[(l,p)=>`$${l}`,(l,p)=>`[[${l}${p?`:${p}`:""}]]`,(l,p)=>`\${${l}${p?`:${p}`:""}}`];function a(l){return l.replace(/__V_(\d)__(.+?)__V__(?:__F__(\w+)__F__)?/g,(p,m,y,d)=>f[parseInt(m,10)](y,d))}function c(l,p){return p?a(l.substring(p.from,p.to)):""}function o(l,p,m,y){const d=[parseFloat(c(p,m))];return l.comparison&&d.push(y),{id:l.id,params:d}}function h(l,p,m){if(p.type.id===m)return[c(l,p)];const y=[];let d=0,v=p.childAfter(d);for(;v;)y.push(...h(l,v,m)),d=v.to,v=p.childAfter(d);return y}const g=l=>l.split(" ").map(m=>`${m}.*`).join("")},27994:(G,O,e)=>{"use strict";e.d(O,{r:()=>r});var t=e(74848),n=e(32196),i=e(36663),s=e(40845);function r({title:a,stepNumber:c,markdown:o,children:h}){const g=(0,s.of)(f);return(0,t.jsxs)("div",{className:g.box,children:[c!==void 0&&(0,t.jsx)("div",{className:g.stepNumber,children:c}),(0,t.jsxs)("div",{className:g.boxInner,children:[a&&(0,t.jsx)("div",{className:g.header,children:(0,t.jsx)("span",{children:a})}),(0,t.jsxs)("div",{className:g.body,children:[o&&(0,t.jsx)("div",{dangerouslySetInnerHTML:{__html:(0,i.G)(o)}}),h]})]})]})}const f=a=>({box:(0,n.css)({background:a.colors.background.secondary,padding:a.spacing(1),borderRadius:a.shape.radius.default,position:"relative"}),boxInner:(0,n.css)({marginLeft:a.spacing(4)}),stepNumber:(0,n.css)({fontWeight:a.typography.fontWeightMedium,background:a.colors.secondary.main,width:"20px",height:"20px",borderRadius:a.shape.radius.circle,display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"10px",left:"11px",fontSize:a.typography.bodySmall.fontSize}),header:(0,n.css)({paddingBottom:a.spacing(.5),display:"flex",alignItems:"center",fontFamily:a.typography.fontFamilyMonospace}),body:(0,n.css)({color:a.colors.text.secondary,"p:last-child":{margin:0},a:{color:a.colors.text.link,textDecoration:"underline"}})})},96625:(G,O,e)=>{"use strict";e.d(O,{k:()=>s});var t=e(74848),n=e(27994),i=e(3884);function s({query:r,queryModeller:f,stepNumber:a,lang:c,onMouseEnter:o,onMouseLeave:h}){return(0,t.jsx)(t.Fragment,{children:r.operations.map((g,l)=>{const p=f.getOperationDef(g.id);if(!p)return`Operation ${g.id} not found`;const m=p.renderer(g,p,"<expr>"),y=p.explainHandler?p.explainHandler(g,p):p.documentation??"no docs";return(0,t.jsx)("div",{onMouseEnter:()=>o?.(g,l),onMouseLeave:()=>h?.(g,l),children:(0,t.jsx)(n.r,{stepNumber:l+a,title:(0,t.jsx)(i.Z,{query:m,lang:c}),markdown:y})},l)})})}},3884:(G,O,e)=>{"use strict";e.d(O,{Z:()=>f});var t=e(74848),n=e(32196),i=e(28848),s=e.n(i),r=e(40845);function f({query:c,lang:o,className:h}){const g=(0,r.$j)(),l=a(g),p=s().highlight(c,o.grammar,o.name);return(0,t.jsx)("div",{className:(0,n.cx)(l.editorField,"prism-syntax-highlight",h),"aria-label":"selector",dangerouslySetInnerHTML:{__html:p}})}const a=c=>({editorField:(0,n.css)({fontFamily:c.typography.fontFamilyMonospace,fontSize:c.typography.bodySmall.fontSize})})},15145:(G,O,e)=>{"use strict";e.d(O,{Ag:()=>t,jN:()=>n,n5:()=>i});var t=(s=>(s.Aggregations="Aggregations",s.RangeFunctions="Range functions",s.Functions="Functions",s.BinaryOps="Binary operations",s.Trigonometric="Trigonometric",s.Time="Time Functions",s))(t||{}),n=(s=>(s.Abs="abs",s.Absent="absent",s.AbsentOverTime="absent_over_time",s.Acos="acos",s.Acosh="acosh",s.Asin="asin",s.Asinh="asinh",s.Atan="atan",s.Atanh="atanh",s.Avg="avg",s.AvgOverTime="avg_over_time",s.BottomK="bottomk",s.Ceil="ceil",s.Changes="changes",s.Clamp="clamp",s.ClampMax="clamp_max",s.ClampMin="clamp_min",s.Cos="cos",s.Cosh="cosh",s.Count="count",s.CountOverTime="count_over_time",s.CountScalar="count_scalar",s.CountValues="count_values",s.DayOfMonth="day_of_month",s.DayOfWeek="day_of_week",s.DayOfYear="day_of_year",s.DaysInMonth="days_in_month",s.Deg="deg",s.Delta="delta",s.Deriv="deriv",s.DropCommonLabels="drop_common_labels",s.Exp="exp",s.Floor="floor",s.Group="group",s.HistogramQuantile="histogram_quantile",s.HistogramAvg="histogram_avg",s.HistogramCount="histogram_count",s.HistogramSum="histogram_sum",s.HistogramFraction="histogram_fraction",s.HistogramStddev="histogram_stddev",s.HistogramStdvar="histogram_stdvar",s.HoltWinters="holt_winters",s.Hour="hour",s.Idelta="idelta",s.Increase="increase",s.Irate="irate",s.LabelJoin="label_join",s.LabelReplace="label_replace",s.Last="last",s.LastOverTime="last_over_time",s.Ln="ln",s.Log10="log10",s.Log2="log2",s.Max="max",s.MaxOverTime="max_over_time",s.Min="min",s.MinOverTime="min_over_time",s.Minute="minute",s.Month="month",s.Pi="pi",s.PredictLinear="predict_linear",s.Present="present",s.PresentOverTime="present_over_time",s.Quantile="quantile",s.QuantileOverTime="quantile_over_time",s.Rad="rad",s.Rate="rate",s.Resets="resets",s.Round="round",s.Scalar="scalar",s.Sgn="sgn",s.Sin="sin",s.Sinh="sinh",s.Sort="sort",s.SortDesc="sort_desc",s.Sqrt="sqrt",s.Stddev="stddev",s.StddevOverTime="stddev_over_time",s.Sum="sum",s.SumOverTime="sum_over_time",s.Tan="tan",s.Tanh="tanh",s.Time="time",s.Timestamp="timestamp",s.TopK="topk",s.Vector="vector",s.Year="year",s.Addition="__addition",s.Subtraction="__subtraction",s.MultiplyBy="__multiply_by",s.DivideBy="__divide_by",s.Modulo="__modulo",s.Exponent="__exponent",s.NestedQuery="__nested_query",s.EqualTo="__equal_to",s.NotEqualTo="__not_equal_to",s.GreaterThan="__greater_than",s.LessThan="__less_than",s.GreaterOrEqual="__greater_or_equal",s.LessOrEqual="__less_or_equal",s))(n||{}),i=(s=>(s.Rate="rate",s.Histogram="histogram",s.Binary="binary",s))(i||{})},33115:(G,O,e)=>{"use strict";e.d(O,{$i:()=>a,Dr:()=>r});var t=e(70416),n=e(47232),i=e(77678),s=e(67414);const r="10m",f=c=>`${c.type}|${c.name}|${JSON.stringify(c.labels??"")}`;class a{constructor(o){this.cache=new Map;const h=o.overlapString;if((0,t.di)(h)){const g=(0,t.E9)(h);this.overlapWindowMs=(0,t.WT)(g)}else{const g=(0,t.E9)(r);this.overlapWindowMs=(0,t.WT)(g)}this.getTargetSignature=o.getTargetSignature}requestInfo(o){const h=o.range.from.valueOf(),g=o.range.to.valueOf(),l=o.rangeRaw?.to?.toString()==="now";let p=l,m;const y=new Map;o.targets.forEach(d=>{let v=`${o.dashboardUID}|${o.panelId}|${d.refId}`,u=this.getTargetSignature(o,d);y.set(v,u)});for(const[d,v]of y){let u=this.cache.get(d);if(u?.sig!==v?p=!1:(m=u?.prevTo??1/0,p=g>m&&h<=m),!p)break}if(p&&m){let d=Math.max(m-this.overlapWindowMs,h);const v=(0,n.KQ)(g),u=(0,n.KQ)((0,i.rs)(d,o.intervalMs));o={...o,range:{...o.range,from:u,to:v}}}else y.forEach((d,v)=>{this.cache.delete(v)});return{requests:[o],targSigs:y,shouldCache:l}}procFrames(o,h,g){if(h?.shouldCache){const l=o.range.from.valueOf(),p=o.range.to.valueOf(),m=new Map;g.forEach(d=>{let v=`${o.dashboardUID}|${o.panelId}|${d.refId}`,u=m.get(v);u||(u=[],m.set(v,u)),u.push(d)});let y=[];m.forEach((d,v)=>{let u=(v?this.cache.get(v)?.frames:null)??[];d.forEach(P=>{if(P.length===0||P.fields.length===0)return;let x=f(P.fields[1]),E=u.find(C=>f(C.fields[1])===x);if(!E)u.push(P);else{let C=E.fields.map(I=>I.values),M=P.fields.map(I=>I.values),S=(0,s.c)(C,M);if(S){for(let I=0;I<S.length;I++)E.fields[I].values=S[I];E.length=E.fields[0].values.length}}});let D=[];u.forEach(P=>{let x=P.fields.map(C=>C.values),E=(0,s.F)(x,l,p);if(E[0].length>0){for(let C=0;C<E.length;C++)P.fields[C].values=E[C];D.push(P)}}),this.cache.set(v,{sig:h.targSigs.get(v),frames:D,prevTo:p}),y.push(...D)}),g=y.map(d=>({...d,fields:d.fields.map(v=>({...v,config:{...v.config},values:v.values.slice()}))}))}return g}}},59809:(G,O,e)=>{"use strict";e.d(O,{Bm:()=>S,J3:()=>m,L:()=>I,hF:()=>E});var t=e(2543),n=e.n(t),i=e(41987),s=e(41260),r=e(11261),f=e(28240),a=e(52622),c=e(57875),o=e(32264),h=e(19347);const g=/^[+-]?inf(?:inity)?$/i,l=(T,b)=>b.app===i.Jk.Explore&&(T.meta?.custom?.resultType==="vector"||T.meta?.custom?.resultType==="scalar")?!0:b.targets.find(A=>A.refId===T.refId)?.format==="table",p=(T,b)=>T.meta?.type===s.m.HeatmapCells?!1:b.targets.find(A=>A.refId===T.refId)?.format==="heatmap";function m(T,b,R){o.$.featureToggles.prometheusDataplane&&T.data.forEach(Z=>{const se=b.targets.find(j=>j.refId===Z.refId);se&&se.legendFormat==="__auto"&&Z.fields.forEach(j=>{if(j.labels?.__name__&&j.labels?.__name__===j.name){const q={...j,name:r.Bc};j.config.displayNameFromDS=(0,f.Ct)(q,Z,T.data)}})});const[A,L]=(0,t.partition)(T.data,Z=>l(Z,b)),U=d(A),[W,w]=(0,t.partition)(L,Z=>Z.meta?.custom?.resultType==="exemplar"),{exemplarTraceIdDestinations:N}=R,B=W.map(Z=>{if(N?.length)for(const se of N){const j=Z.fields.find(q=>q.name===se.name);if(j){const q=u(se);j.config.links=j.config.links?.length?[...j.config.links,...q]:q}}return{...Z,meta:{...Z.meta,dataTopic:a.QR.Annotations}}}),[V,K]=(0,t.partition)(w,Z=>p(Z,b));V.forEach(Z=>{if(Z.name==null){let se=Z.fields.find(j=>j.type===r.PU.number);if(se){let j=se.labels?.le;j&&(Z.name=j,se.config.displayNameFromDS=j)}}});const H=(0,t.groupBy)(V,Z=>Z.refId);let X=[];for(const Z in H){const se=H[Z],j=(0,t.groupBy)(se,q=>{const ne=q.fields.find(oe=>oe.type===r.PU.number);if(ne?.labels&&y in ne.labels){const{le:oe,...z}=ne?.labels;return Object.values(z).join()}return Object.values(ne?.labels??[]).join()});(0,t.forOwn)(j,(q,ne)=>{const oe=q.sort(S);X.push(C(M(oe)))})}const k=K.map(Z=>({...Z,meta:{...Z.meta,preferredVisualisationType:"graph"}})),Y=(0,t.flatten)(X);return{...T,data:[...k,...U,...Y,...B]}}const y="le";function d(T){if(T.length===0||T.length===1&&T[0].length===0)return T;const b=(0,t.groupBy)(T,"refId"),R=Object.keys(b);return R.map(L=>{const U=v(R.length,L),W=x({data:[],valueName:U}),w=P([]),N=[];b[L].forEach(V=>{const H=V.fields[1]?.labels??{};Object.keys(H).sort().forEach(X=>{if(!N.some(k=>k.name===X)){const k=X===y;N.push({name:X,config:{filterable:!0},type:k?r.PU.number:r.PU.string,values:[]})}})}),b[L].forEach(V=>{const K=V.fields[0]?.values??[],H=V.fields[1]?.values??[];K.forEach(X=>w.values.push(X)),H.forEach(X=>{W.values.push(I(X));const k=V.fields[1].labels??{};N.forEach(Y=>Y.values.push(D(k,Y.name)))})});const B=[w,...N,W];return{refId:L,fields:B,meta:{...b[L][0].meta,preferredVisualisationType:"rawPrometheus"},length:w.values.length}})}function v(T,b=""){return T>1?`Value #${b}`:"Value"}function u(T){const b=[];if(T.datasourceUid){const A=(0,h.l)().getInstanceSettings(T.datasourceUid);A&&b.push({title:T.urlDisplayLabel||`Query with ${A?.name}`,url:"",internal:{query:{query:"${__value.raw}",queryType:"traceql"},datasourceUid:T.datasourceUid,datasourceName:A?.name??"Data source not found"}})}return T.url&&b.push({title:T.urlDisplayLabel||`Go to ${T.url}`,url:T.url,targetBlank:!0}),b}function D(T,b){return T.hasOwnProperty(b)?b===y?I(T[b]):T[b]:""}function P(T,b=!1){return{name:r.LE,type:r.PU.time,config:{},values:T.map(R=>b?R[0]:R[0]*1e3)}}function x({data:T,valueName:b=r.Bc,parseValue:R=!0,labels:A,displayNameFromDS:L}){return{name:b,type:r.PU.number,display:(0,c.J)(),config:{displayNameFromDS:L},labels:A,values:T.map(U=>R?I(U[1]):U[1])}}function E(T){const b=T.__name__||"";delete T.__name__;const R=Object.entries(T).map(A=>`${A[0]}="${A[1]}"`).join(",");return`${b}{${R}}`}function C(T){if(T.length===0||T.length===1&&T[0].length===0)return[];const b=T[0].fields.find(A=>A.type===r.PU.time),R=T.map(A=>{let L=A.fields.find(U=>U.type===r.PU.number);return{...L,name:L.config.displayNameFromDS}});return[{...T[0],meta:{...T[0].meta,type:s.m.HeatmapRows},fields:[b,...R]}]}function M(T){for(let b=T.length-1;b>0;b--){const R=T[b].fields.find(L=>L.type===r.PU.number),A=T[b-1].fields.find(L=>L.type===r.PU.number);if(!R||!A)throw new Error("Prometheus heatmap transform error: data should be a time series");for(let L=0;L<R.values.length;L++){const U=A.values[L]||[0];R.values[L]-=U,R.values[L]<1e-9&&(R.values[L]=0)}}return T}function S(T,b){let R,A;try{R=I(T.fields[1].state?.displayName??T.name??T.fields[1].name),A=I(b.fields[1].state?.displayName??b.name??b.fields[1].name)}catch(L){return console.error(L),0}return R>A?1:R<A?-1:0}function I(T){return g.test(T)?T[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY:parseFloat(T)}},62183:(G,O,e)=>{"use strict";e.d(O,{B4:()=>s,N1:()=>n,fD:()=>t,m_:()=>i});var t=(r=>(r.Low="Low",r.Medium="Medium",r.High="High",r.None="None",r))(t||{}),n=(r=>(r.Cortex="Cortex",r.Mimir="Mimir",r.Prometheus="Prometheus",r.Thanos="Thanos",r))(n||{}),i=(r=>(r.Auto="__auto",r.Verbose="__verbose",r.Custom="__custom",r))(i||{}),s=(r=>(r[r.LabelNames=0]="LabelNames",r[r.LabelValues=1]="LabelValues",r[r.MetricNames=2]="MetricNames",r[r.VarQueryResult=3]="VarQueryResult",r[r.SeriesQuery=4]="SeriesQuery",r[r.ClassicQuery=5]="ClassicQuery",r))(s||{})},27642:(G,O,e)=>{"use strict";e.d(O,{L:()=>n,y:()=>i});var t=e(32264);function n(s){return{grafana_version:t.$.buildInfo.version,plugin_type:String(s.type),plugin_version:s.info.version,plugin_id:s.id,plugin_name:s.name}}function i(s){return{...n(s.meta),datasource_uid:s.uid}}},44027:(G,O,e)=>{"use strict";e.d(O,{G:()=>a});var t=e(96540),n=e(92470),i=e(95187),s=e(14110),r=e(27642);const f="grafana_plugin_";function a(){const o=(0,n.Q)();return(0,t.useMemo)(()=>{const h=(0,i.S)(o)?(0,r.y)(o.instanceSettings):(0,r.L)(o.meta);return(g,l)=>{if(!c(g))throw new Error(`Interactions reported in plugins should start with: "${f}".`);return(0,s.rR)(g,{...l,...h})}},[o])}function c(o){return o.startsWith(f)&&o.length>f.length}},61298:(G,O,e)=>{"use strict";e.d(O,{fX:()=>i,nB:()=>n,n_:()=>t,p6:()=>s});var t=(r=>(r.DashboardView="dashboard-view",r.DataRequest="data-request",r))(t||{});const n=r=>!!r.payload.page,i=r=>!!r.payload.interactionName,s=r=>!!r.payload.experimentId},14110:(G,O,e)=>{"use strict";e.d(O,{G$:()=>s,Jy:()=>r,Xp:()=>a,rR:()=>f});var t=e(32264),n=e(12131),i=e(63415);const s=c=>{(0,i.x$)().addEvent({type:i.on.MetaAnalytics,payload:c})},r=()=>{const c=n.Ny.getLocation(),o=`${t.$.appSubUrl??""}${c.pathname}${c.search}${c.hash}`;(0,i.x$)().addEvent({type:i.on.Pageview,payload:{page:o}})},f=(c,o)=>{t.$.reportingStaticContext&&t.$.reportingStaticContext instanceof Object&&(o={...o,...t.$.reportingStaticContext}),(0,i.x$)().addEvent({type:i.on.Interaction,payload:{interactionName:c,properties:o}})},a=(c,o,h)=>{(0,i.x$)().addEvent({type:i.on.ExperimentView,payload:{experimentId:c,experimentGroup:o,experimentVariant:h}})}},55882:(G,O,e)=>{"use strict";e.d(O,{s:()=>g});var t=e(74848),n=e(96540),i=e(22391),s=e(51527),r=e(13544),f=e(90182),a=e(67061),c=e(98624),o=e(19347),h=e(26657);class g extends n.PureComponent{constructor(p){super(p),this.dataSourceSrv=(0,o.l)(),this.state={},this.onChange=(m,y)=>{if(y.action==="clear"&&this.props.onClear){this.props.onClear();return}const d=this.dataSourceSrv.getInstanceSettings(m.value);d&&(this.props.onChange(d),this.setState({error:void 0}))}}static{this.defaultProps={autoFocus:!1,openMenuOnFocus:!1,placeholder:"Select data source"}}componentDidMount(){const{current:p}=this.props;this.dataSourceSrv.getInstanceSettings(p)||this.setState({error:"Could not find data source "+p})}getCurrentValue(){const{current:p,hideTextValue:m,noDefault:y}=this.props;if(!p&&y)return;const d=this.dataSourceSrv.getInstanceSettings(p);if(d)return{label:d.name.slice(0,37),value:d.uid,imgUrl:d.meta.info.logos.small,hideText:m,meta:d.meta};const v=(0,i.Iz)(p);return v===h.dR.uid||v===h.dR.name?{label:v,value:v,hideText:m}:{label:(v??"no name")+" - not found",value:v??void 0,imgUrl:"",hideText:m}}getDataSourceOptions(){const{alerting:p,tracing:m,metrics:y,mixed:d,dashboard:v,variables:u,annotations:D,pluginId:P,type:x,filter:E,logs:C}=this.props;return this.dataSourceSrv.getList({alerting:p,tracing:m,metrics:y,logs:C,dashboard:v,mixed:d,variables:u,annotations:D,pluginId:P,filter:E,type:x}).map(S=>({value:S.name,label:`${S.name}${S.isDefault?" (default)":""}`,imgUrl:S.meta.info.logos.small,meta:S.meta}))}render(){const{autoFocus:p,onBlur:m,onClear:y,openMenuOnFocus:d,placeholder:v,width:u,inputId:D,disabled:P=!1,isLoading:x=!1}=this.props,{error:E}=this.state,C=this.getDataSourceOptions(),M=this.getCurrentValue(),S=typeof y=="function";return(0,t.jsx)("div",{"aria-label":"Data source picker select container","data-testid":r.Tp.components.DataSourcePicker.container,children:(0,t.jsx)(f.l6,{isLoading:x,disabled:P,"aria-label":"Select a data source","data-testid":r.Tp.components.DataSourcePicker.inputV2,inputId:D||"data-source-picker",className:"ds-picker select-container",isMulti:!1,isClearable:S,backspaceRemovesValue:!1,onChange:this.onChange,options:C,autoFocus:p,onBlur:m,width:u,openMenuOnFocus:d,maxMenuHeight:500,placeholder:v,noOptionsMessage:"No datasources found",value:M??null,invalid:!!E||!!this.props.invalid,getOptionLabel:I=>I.meta&&(0,s.x)(I.meta.signature)&&I!==M?(0,t.jsxs)(a.B,{alignItems:"center",justifyContent:"space-between",children:[(0,t.jsx)("span",{children:I.label})," ",(0,t.jsx)(c.B,{status:I.meta.signature})]}):I.label||""})})}}},96937:(G,O,e)=>{"use strict";e.d(O,{f:()=>t,p:()=>n});let t=()=>{throw new Error("EmbeddedDashboard requires runtime initialization")};function n(i){t=i}},97152:(G,O,e)=>{"use strict";e.d(O,{a:()=>n,e:()=>i});var t=e(74848);let n=({message:s})=>(0,t.jsxs)("div",{children:["Unable to render data: ",s,"."]});function i(s){n=s}},24308:(G,O,e)=>{"use strict";e.d(O,{Y:()=>i,m:()=>n});var t=e(74848);let n=()=>(0,t.jsx)("div",{children:"PanelRenderer can only be used after Grafana instance has been started."});function i(s){n=s}},46235:(G,O,e)=>{"use strict";e.d(O,{V:()=>n,l:()=>i});var t=e(74848);let n=({children:s})=>(0,t.jsx)("div",{children:s});function i(s){n=s}},32264:(G,O,e)=>{"use strict";e.d(O,{$:()=>h,p:()=>r});var t=e(2543),n=e.n(t),i=e(42994),s=e(97594);class r{constructor(l){this.publicDashboardsEnabled=!0,this.snapshotEnabled=!0,this.datasources={},this.panels={},this.apps={},this.auth={},this.minRefreshInterval="",this.appUrl="",this.appSubUrl="",this.namespace="default",this.windowTitlePrefix="",this.newPanelTitle="",this.externalUserMngLinkUrl="",this.externalUserMngLinkName="",this.externalUserMngInfo="",this.allowOrgCreate=!1,this.feedbackLinksEnabled=!0,this.disableLoginForm=!1,this.defaultDatasource="",this.angularSupportEnabled=!1,this.authProxyEnabled=!1,this.exploreEnabled=!1,this.queryHistoryEnabled=!1,this.helpEnabled=!1,this.profileEnabled=!1,this.newsFeedEnabled=!0,this.ldapEnabled=!1,this.jwtHeaderName="",this.jwtUrlLogin=!1,this.sigV4AuthEnabled=!1,this.azureAuthEnabled=!1,this.secureSocksDSProxyEnabled=!1,this.samlEnabled=!1,this.samlName="",this.autoAssignOrg=!0,this.verifyEmailEnabled=!1,this.oauth={},this.rbacEnabled=!0,this.disableUserSignUp=!1,this.loginHint="",this.passwordHint="",this.loginError=void 0,this.viewersCanEdit=!1,this.editorsCanAdmin=!1,this.disableSanitizeHtml=!1,this.trustedTypesDefaultPolicyEnabled=!1,this.cspReportOnlyEnabled=!1,this.liveEnabled=!0,this.featureToggles={},this.anonymousEnabled=!1,this.anonymousDeviceLimit=void 0,this.licenseInfo={},this.rendererAvailable=!1,this.rendererVersion="",this.rendererDefaultImageWidth=1e3,this.rendererDefaultImageHeight=500,this.rendererDefaultImageScale=1,this.secretsManagerPluginEnabled=!1,this.supportBundlesEnabled=!1,this.http2Enabled=!1,this.grafanaJavascriptAgent={enabled:!1,customEndpoint:"",apiKey:"",errorInstrumentalizationEnabled:!0,consoleInstrumentalizationEnabled:!1,webVitalsInstrumentalizationEnabled:!1},this.pluginCatalogURL="https://grafana.com/grafana/plugins/",this.pluginAdminEnabled=!0,this.pluginAdminExternalManageEnabled=!1,this.pluginCatalogHiddenPlugins=[],this.pluginsCDNBaseURL="",this.expressionsEnabled=!1,this.awsAllowedAuthProviders=[],this.awsAssumeRoleEnabled=!1,this.azure={managedIdentityEnabled:!1,workloadIdentityEnabled:!1,userIdentityEnabled:!1,userIdentityFallbackCredentialsEnabled:!1,azureEntraPasswordCredentialsEnabled:!1},this.caching={enabled:!1},this.unifiedAlertingEnabled=!1,this.unifiedAlerting={minInterval:"",alertStateHistoryBackend:void 0,alertStateHistoryPrimary:void 0},this.recordedQueries={enabled:!0},this.featureHighlights={enabled:!1},this.reporting={enabled:!0},this.analytics={enabled:!0},this.googleAnalytics4SendManualPageViews=!1,this.sqlConnectionLimits={maxOpenConns:100,maxIdleConns:100,connMaxLifetime:14400},this.disableFrontendSandboxForPlugins=[],this.cloudMigrationFeedbackURL="",this.exploreDefaultTimeOffset="1h",this.bootData=l.bootData;const p={datasources:{},windowTitlePrefix:"Grafana - ",panels:{},newPanelTitle:"Panel Title",playlist_timespan:"1m",unsaved_changes_warning:!0,appUrl:"",appSubUrl:"",buildInfo:{version:"1.0",commit:"1",env:"production"},viewersCanEdit:!1,editorsCanAdmin:!1,disableSanitizeHtml:!1};(0,t.merge)(this,p,l),this.buildInfo=l.buildInfo||p.buildInfo,this.dateFormats&&i.WC.update(this.dateFormats),a(this),f(this),this.featureToggles.disableAngular&&(this.angularSupportEnabled=!1),this.theme2=(0,s.g)(this.bootData.user.theme),this.bootData.user.lightTheme=this.theme2.isLight,this.theme=this.theme2.v1}}function f(g){const l=g.featureToggles,m=window.localStorage.getItem("grafana.featureToggles");if(m){const y=m.split(",");for(const d of y){const[v,u]=d.split("="),D=u==="true"||u==="1";l[v]=D,console.log(`Setting feature toggle ${v} = ${D} via localstorage`)}}}function a(g){if(window.location.href.indexOf("__feature")===-1)return;const l=g.buildInfo.env==="development",p=new Set(["queryServiceFromUI"]);new URLSearchParams(window.location.search).forEach((y,d)=>{if(d.startsWith("__feature.")){const v=g.featureToggles,u=d.substring(10),D=y==="true"||y==="";D!==v[d]&&(l||p.has(u)?(v[u]=D,console.log(`Setting feature toggle ${u} = ${D} via url`)):console.log(`Unable to change feature toggle ${u} via url in production.`))}})}const c=window.grafanaBootData||{settings:{},user:{},navTree:[]},o=c.settings;o.bootData=c;const h=new r(o)},7117:(G,O,e)=>{"use strict";e.r(O),e.d(O,{CopyPanelEvent:()=>h.ah,DataSourcePicker:()=>R.s,DataSourceWithBackend:()=>E.iy,EchoEventType:()=>r.on,EmbeddedDashboard:()=>w.f,FakeEchoSrv:()=>r.c_,GrafanaBootConfig:()=>d.p,HealthCheckError:()=>E.b1,HealthStatus:()=>E.VQ,HistoryWrapper:()=>o.K9,MetaAnalyticsEventName:()=>v.n_,PanelDataErrorView:()=>S.a,PanelRenderer:()=>M.m,PluginPage:()=>b.V,RefreshEvent:()=>h._,StreamingFrameAction:()=>c.Kh,ThemeChangedEvent:()=>h.E8,TimeRangeUpdatedEvent:()=>h.sR,config:()=>d.$,createDataSourcePluginEventProperties:()=>A.y,createMonitoringLogger:()=>x.DW,createPluginEventProperties:()=>A.L,createQueryRunner:()=>T.d,featureEnabled:()=>P.a,frameToMetricFindValue:()=>C.$h,getAngularLoader:()=>n.E,getAppEvents:()=>h.J7,getBackendSrv:()=>t.AI,getDataSourceSrv:()=>i.l,getEchoSrv:()=>r.x$,getGrafanaLiveSrv:()=>c.oF,getLegacyAngularInjector:()=>a.C,getLocationSrv:()=>s.X,getPluginComponentExtensions:()=>g.Dp,getPluginExtensions:()=>g.O3,getPluginImportUtils:()=>u.o,getPluginLinkExtensions:()=>g.Kf,getRunRequest:()=>T.XJ,getTemplateSrv:()=>f.w,hasAllPermissions:()=>K,hasAnyPermission:()=>H,hasPermission:()=>B,hasPermissionInMetadata:()=>V,isExperimentViewEvent:()=>v.p6,isExpressionReference:()=>E.s9,isFetchError:()=>t.NF,isInteractionEvent:()=>v.fX,isPageviewEvent:()=>v.nB,isPluginExtensionComponent:()=>m.a,isPluginExtensionLink:()=>m.D,loadPluginCss:()=>u.PL,locationSearchToObject:()=>o.SE,locationService:()=>o.Ny,logDebug:()=>x.MD,logError:()=>x.vV,logInfo:()=>x.fH,logWarning:()=>x.FF,navigationLogger:()=>o.Lc,registerEchoBackend:()=>r.pl,reportExperimentView:()=>D.Xp,reportInteraction:()=>D.rR,reportMetaAnalytics:()=>D.G$,reportPageview:()=>D.Jy,setAngularLoader:()=>n.w,setAppEvents:()=>h.H8,setBackendSrv:()=>t.u5,setChromeHeaderHeightHook:()=>W._,setCurrentUser:()=>y.l,setDataSourceSrv:()=>i.h,setEchoSrv:()=>r.H2,setEmbeddedDashboard:()=>w.p,setGrafanaLiveSrv:()=>c.S8,setLegacyAngularInjector:()=>a.j,setLocationService:()=>o.vG,setLocationSrv:()=>s.T,setPluginComponentHook:()=>p.A,setPluginExtensionGetter:()=>g.cE,setPluginExtensionsHook:()=>l.Vu,setPluginImportUtils:()=>u.se,setQueryRunnerFactory:()=>T.HC,setReturnToPreviousHook:()=>U._,setRunRequest:()=>T.pC,setTemplateSrv:()=>f.d,toDataQueryError:()=>I.u,toDataQueryResponse:()=>C.bE,useChromeHeaderHeight:()=>W.k,usePluginComponent:()=>p.S,usePluginComponentExtensions:()=>l.kr,usePluginComponents:()=>l.f_,usePluginExtensions:()=>l.pc,usePluginInteractionReporter:()=>L.G,usePluginLinkExtensions:()=>l.vl,usePluginLinks:()=>l.Ux,useReturnToPrevious:()=>U.i});var t=e(17172),n=e(7376),i=e(19347),s=e(23509),r=e(63415),f=e(72574),a=e(81634),c=e(78731),o=e(12131),h=e(3591),g=e(4402),l=e(3197),p=e(79396),m=e(80882),y=e(61706),d=e(32264),v=e(61298),u=e(89191),D=e(14110),P=e(33378),x=e(34867),E=e(26657),C=e(47773),M=e(24308),S=e(97152),I=e(12091),T=e(63639),b=e(46235),R=e(55882),A=e(27642),L=e(44027),U=e(14778),W=e(23172),w=e(96937),N=e(29263);const B=X=>(0,N.ZU)(X,(0,y.H)()),V=(X,k)=>(0,N.T6)(X,k),K=X=>(0,N.Fj)(X,(0,y.H)()),H=X=>(0,N.jW)(X,(0,y.H)())},7376:(G,O,e)=>{"use strict";e.d(O,{E:()=>i,w:()=>n});let t;function n(s){t=s}function i(){return t}},63415:(G,O,e)=>{"use strict";e.d(O,{H2:()=>i,c_:()=>f,on:()=>t,pl:()=>r,x$:()=>s});var t=(a=>(a.Performance="performance",a.MetaAnalytics="meta-analytics",a.Pageview="pageview",a.Interaction="interaction",a.ExperimentView="experimentview",a.GrafanaJavascriptAgent="grafana-javascript-agent",a))(t||{});let n;function i(a){if(n instanceof f)for(const c of n.buffer)a.addEvent(c.event,c.meta);n=a}function s(){return n||(n=new f),n}const r=a=>{s().addBackend(a)};class f{constructor(){this.buffer=[]}flush(){this.buffer=[]}addBackend(c){}addEvent(c,o){this.buffer.push({event:c,meta:o})}}},12131:(G,O,e)=>{"use strict";e.d(O,{K9:()=>a,Lc:()=>l,Ny:()=>o,SE:()=>c,vG:()=>h});var t=e(17929),n=e(76885),i=e(95344),s=e(91040),r=e(40621),f=e(32264);class a{constructor(m){this.history=m||t.zR({basename:f.$.appSubUrl??"/"}),this.partial=this.partial.bind(this),this.push=this.push.bind(this),this.replace=this.replace.bind(this),this.getSearch=this.getSearch.bind(this),this.getHistory=this.getHistory.bind(this),this.getLocation=this.getLocation.bind(this)}getHistory(){return this.history}getSearch(){return new URLSearchParams(this.history.location.search)}partial(m,y){const d=this.history.location,v=this.getSearchObject();for(const D in m)m[D]===null||m[D]===void 0?delete v[D]:v[D]=m[D];const u=n.kM.renderUrl(d.pathname,v);y?this.history.replace(u,this.history.location.state):this.history.push(u,this.history.location.state)}push(m){this.history.push(m)}replace(m){this.history.replace(m)}reload(){const m=this.history.location.state?.routeReloadCounter;this.history.replace({...this.history.location,state:{routeReloadCounter:m?m+1:1}})}getLocation(){return this.history.location}getSearchObject(){return c(this.history.location.search)}update(m){if((0,i.l)("LocationSrv","update","partial, push or replace"),m.partial&&m.query)this.partial(m.query,m.partial);else{const y={pathname:m.path};m.query&&(y.search=n.kM.toUrlParams(m.query)),m.replace?this.replace(y):this.push(y)}}}function c(p){let m=typeof p=="number"?String(p):p;return m.length>0?m.startsWith("?")?n.kM.parseKeyValue(m.substring(1)):n.kM.parseKeyValue(m):{}}let o=new a;const h=p=>{throw new Error("locationService can be only overriden in test environment")},g=(0,s.h)("Router"),l=g.logger;(0,r.h)("location",o,g)},23509:(G,O,e)=>{"use strict";e.d(O,{T:()=>n,X:()=>i});let t;function n(s){t=s}function i(){return t}},63639:(G,O,e)=>{"use strict";e.d(O,{HC:()=>n,XJ:()=>f,d:()=>i,pC:()=>r});let t;const n=a=>{if(t)throw new Error("Runner should only be set when Grafana is starting.");t=a},i=()=>{if(!t)throw new Error("`createQueryRunner` can only be used after Grafana instance has started.");return t()};let s;function r(a){if(s)throw new Error("runRequest function should only be set once, when Grafana is starting.");s=a}function f(){if(!s)throw new Error("getRunRequest can only be used after Grafana instance has started.");return s}},3591:(G,O,e)=>{"use strict";e.d(O,{E8:()=>i,H8:()=>a,J7:()=>c,_:()=>n,ah:()=>r,sR:()=>s});var t=e(65463);class n extends t.a{static{this.type="refresh"}}class i extends t.x{static{this.type="theme-changed"}}class s extends t.x{static{this.type="time-range-updated"}}class r extends t.x{static{this.type="copy-panel"}}let f;function a(o){f=o}function c(){return f}},17172:(G,O,e)=>{"use strict";e.d(O,{AI:()=>s,NF:()=>t,u5:()=>i});function t(r){return typeof r=="object"&&r!==null&&"status"in r&&"data"in r}let n;const i=r=>{n=r},s=()=>n},19347:(G,O,e)=>{"use strict";e.d(O,{h:()=>n,l:()=>i});let t;function n(s){t=s}function i(){return t}},81634:(G,O,e)=>{"use strict";e.d(O,{C:()=>i,j:()=>n});let t;const n=s=>{t=s},i=()=>t},78731:(G,O,e)=>{"use strict";e.d(O,{Kh:()=>t.Kh,S8:()=>i,oF:()=>s});var t=e(9631);let n;const i=r=>{n=r},s=()=>n},4402:(G,O,e)=>{"use strict";e.d(O,{Dp:()=>a,Kf:()=>f,O3:()=>r,cE:()=>i});var t=e(80882);let n;function i(c){if(n)throw new Error("setPluginExtensionGetter() function should only be called once, when Grafana is starting.");n=c}function s(){if(!n)throw new Error("getPluginExtensionGetter() can only be used after the Grafana instance has started.");return n}const r=c=>s()(c),f=c=>{const{extensions:o}=r(c);return{extensions:o.filter(t.D)}},a=c=>{const{extensions:o}=r(c);return{extensions:o.filter(t.a)}}},79396:(G,O,e)=>{"use strict";e.d(O,{A:()=>n,S:()=>i});let t;function n(s){if(t)throw new Error("setPluginComponentHook() function should only be called once, when Grafana is starting.");t=s}function i(s){if(!t)throw new Error("setPluginComponentHook(options) can only be used after the Grafana instance has started.");return t(s)}},3197:(G,O,e)=>{"use strict";e.d(O,{Ux:()=>f,Vu:()=>s,f_:()=>a,kr:()=>o,pc:()=>r,vl:()=>c});var t=e(96540),n=e(80882);let i;function s(h){if(i)throw new Error("setPluginExtensionsHook() function should only be called once, when Grafana is starting.");i=h}function r(h){if(!i)throw new Error("usePluginExtensions(options) can only be used after the Grafana instance has started.");return i(h)}function f(h){const{extensions:g,isLoading:l}=r(h);return(0,t.useMemo)(()=>({links:g.filter(n.D),isLoading:l}),[g,l])}function a(h){const{extensions:g,isLoading:l}=r(h);return(0,t.useMemo)(()=>({components:g.filter(n.a).map(({component:p})=>p),isLoading:l}),[g,l])}function c(h){const{extensions:g,isLoading:l}=r(h);return(0,t.useMemo)(()=>({extensions:g.filter(n.D),isLoading:l}),[g,l])}function o(h){const{extensions:g,isLoading:l}=r(h);return(0,t.useMemo)(()=>({extensions:g.filter(n.a),isLoading:l}),[g,l])}},80882:(G,O,e)=>{"use strict";e.d(O,{D:()=>n,a:()=>i});var t=e(74135);function n(s){return s?s.type===t.u.link&&("path"in s||"onClick"in s):!1}function i(s){return s?s.type===t.u.component&&"component"in s:!1}},72574:(G,O,e)=>{"use strict";e.d(O,{d:()=>n,w:()=>i});let t;const n=s=>{t=s},i=()=>t},61706:(G,O,e)=>{"use strict";e.d(O,{H:()=>i,l:()=>n});let t=null;function n(s){if(t)throw new Error("User should only be set once, when Grafana is starting.");t=s}function i(){if(!t)throw new Error("User can only be used after Grafana instance has started.");return t}},26657:(G,O,e)=>{"use strict";e.d(O,{iy:()=>C,dR:()=>u,b1:()=>P,VQ:()=>x,s9:()=>D,ph:()=>S,x7:()=>M});var t=e(62467),n=e(75505),i=e(44240),s=e(63720),r=e(66847),f=e(40187),a=e(22391),c=e(55004),o=e(89667),h=e(92341),g=e(32264),l=e(19347),p=e(78731),m=e(17172),y=e(9631),d=e(47773);function v(I){const{intervalMs:T,maxDataPoints:b,requestId:R,panelId:A,queryCachingTTL:L,range:{from:U,to:W}}=I;if(!I.targets.length)return(0,t.of)({data:[]});const w={intervalMs:T,maxDataPoints:b,queryCachingTTL:L,timeRange:{from:U.valueOf().toString(),to:W.valueOf().toString(),timezone:I.timezone}};return(0,m.AI)().fetch({url:`/api/public/dashboards/${g.$.publicDashboardAccessToken}/panels/${A}/query`,method:"POST",data:w,requestId:R}).pipe((0,s.n)(N=>(0,t.of)((0,d.bE)(N,I.targets))),(0,r.W)(N=>(0,t.of)((0,d.bE)(N))))}const u=Object.freeze({type:"__expr__",uid:"__expr__",name:"Expression"});function D(I){if(!I)return!1;const T=typeof I=="string"?I:I.type;return T===u.type||T===u.name||T==="-100"}class P extends Error{constructor(T,b){super(T),this.details=b,this.name="HealthCheckError"}}var x=(I=>(I.Unknown="UNKNOWN",I.OK="OK",I.Error="ERROR",I))(x||{}),E=(I=>(I.PluginID="X-Plugin-Id",I.DatasourceUID="X-Datasource-Uid",I.DashboardUID="X-Dashboard-Uid",I.PanelID="X-Panel-Id",I.PanelPluginId="X-Panel-Plugin-Id",I.QueryGroupID="X-Query-Group-Id",I.FromExpression="X-Grafana-From-Expr",I.SkipQueryCache="X-Cache-Skip",I))(E||{});class C extends f.mA{constructor(T){super(T),this.streamOptionsProvider=S}query(T){if(g.$.publicDashboardAccessToken)return v(T);const{intervalMs:b,maxDataPoints:R,queryCachingTTL:A,range:L,requestId:U,hideFromInspector:W=!1}=T;let w=T.targets,N=!1;const B=new Set,V=new Set,K=w.map(Y=>{let Z=this.getRef(),se=this.id,j=!0;if(D(Y.datasource))return N=!0,{...Y,datasource:u};if(Y.datasource){const q=(0,l.l)().getInstanceSettings(Y.datasource,T.scopedVars);if(!q)throw new Error(`Unknown Datasource: ${JSON.stringify(Y.datasource)}`);const ne=q.rawRef??(0,a.p$)(q),oe=q.id;(ne.uid!==Z.uid||se!==oe)&&(Z=ne,se=oe,j=!1)}return Z.type?.length&&B.add(Z.type),Z.uid?.length&&V.add(Z.uid),{...j?this.applyTemplateVariables(Y,T.scopedVars,T.filters):Y,datasource:Z,datasourceId:se,intervalMs:b,maxDataPoints:R,queryCachingTTL:A}});if(!K.length)return(0,t.of)({data:[]});const H={queries:K,from:L?.from.valueOf().toString(),to:L?.to.valueOf().toString()};if(g.$.featureToggles.queryOverLive)return(0,p.oF)().getQueryData({request:T,body:H});const X={};X["X-Plugin-Id"]=Array.from(B).join(", "),X["X-Datasource-Uid"]=Array.from(V).join(", ");let k="/api/ds/query?ds_type="+this.type;return g.$.featureToggles.queryServiceFromUI&&(g.$.featureToggles.queryService||g.$.featureToggles.grafanaAPIServerWithExperimentalAPIs?(!N&&V.size,k=`/apis/query.grafana.app/v0alpha1/namespaces/${g.$.namespace}/query?ds_type=' + this.type`):console.warn("feature toggle queryServiceFromUI also requires the queryService to be running")),N&&(X["X-Grafana-From-Expr"]="true",k+="&expression=true"),U&&(k+=`&requestId=${U}`),T.dashboardUID&&(X["X-Dashboard-Uid"]=T.dashboardUID,T.panelId&&(X["X-Panel-Id"]=`${T.panelId}`)),T.panelPluginId&&(X["X-Panel-Plugin-Id"]=`${T.panelPluginId}`),T.queryGroupId&&(X["X-Query-Group-Id"]=`${T.queryGroupId}`),T.skipQueryCache&&(X["X-Cache-Skip"]="true"),(0,m.AI)().fetch({url:k,method:"POST",data:H,requestId:U,hideFromInspector:W,headers:X}).pipe((0,s.n)(Y=>{const Z=(0,d.bE)(Y,K);return Z.data?.length&&Z.data.find(se=>se.meta?.channel)?M(Z,T,this.streamOptionsProvider):(0,t.of)(Z)}),(0,r.W)(Y=>(0,t.of)((0,d.bE)(Y))))}getRequestHeaders(){const T={};return T["X-Plugin-Id"]=this.type,T["X-Datasource-Uid"]=this.uid,T}interpolateVariablesInQueries(T,b,R){return T.map(A=>this.applyTemplateVariables(A,b,R))}applyTemplateVariables(T,b,R){return T}async getResource(T,b,R){const A=this.getRequestHeaders();return(await(0,n.s)((0,m.AI)().fetch({...R,method:"GET",headers:R?.headers?{...R.headers,...A}:A,params:b??R?.params,url:`/api/datasources/uid/${this.uid}/resources/${T}`}))).data}async postResource(T,b,R){const A=this.getRequestHeaders();return(await(0,n.s)((0,m.AI)().fetch({...R,method:"POST",headers:R?.headers?{...R.headers,...A}:A,data:b??{...b},url:`/api/datasources/uid/${this.uid}/resources/${T}`}))).data}async callHealthCheck(){return(0,n.s)((0,m.AI)().fetch({method:"GET",url:`/api/datasources/uid/${this.uid}/health`,showErrorAlert:!1,headers:this.getRequestHeaders()})).then(T=>T.data).catch(T=>T.data)}async testDatasource(){return this.callHealthCheck().then(T=>T.status==="OK"?{status:"success",message:T.message}:Promise.reject({status:"error",message:T.message,error:new P(T.message,T.details)}))}}function M(I,T,b){const R=(0,p.oF)();if(!R)return(0,t.of)(I);const A=[],L=[];for(const U of I.data){const W=(0,c.DG)(U.meta?.channel);if(W){const w=U;L.push(R.getDataStream({addr:W,buffer:b(T,w),frame:(0,o.Nw)(U)}))}else A.push(U)}return A.length&&L.push((0,t.of)({...I,data:A})),L.length===1?L[0]:(0,i.h)(...L)}const S=(I,T)=>{const b={maxLength:I.maxDataPoints??500,action:y.Kh.Append};return I.rangeRaw?.to==="now"&&(b.maxDelta=I.range.to.valueOf()-I.range.from.valueOf()),b};C=(0,h.Y)(C)},23172:(G,O,e)=>{"use strict";e.d(O,{_:()=>n,k:()=>i});let t;const n=s=>{t=s},i=()=>(t||console.error("useChromeHeaderHeight hook not found"),t?.())},33378:(G,O,e)=>{"use strict";e.d(O,{a:()=>n});var t=e(32264);const n=i=>{const{enabledFeatures:s}=t.$.licenseInfo;return s&&s[i]}},34867:(G,O,e)=>{"use strict";e.d(O,{DW:()=>o,FF:()=>r,MD:()=>f,fH:()=>s,l$:()=>c,vV:()=>a});var t=e(32631),n=e(37930),i=e(32264);function s(h,g){i.$.grafanaJavascriptAgent.enabled&&t.P.api.pushLog([h],{level:n.$b.INFO,context:g})}function r(h,g){i.$.grafanaJavascriptAgent.enabled&&t.P.api.pushLog([h],{level:n.$b.WARN,context:g})}function f(h,g){i.$.grafanaJavascriptAgent.enabled&&t.P.api.pushLog([h],{level:n.$b.DEBUG,context:g})}function a(h,g){i.$.grafanaJavascriptAgent.enabled&&t.P.api.pushError(h,{context:g})}function c(h,g,l){i.$.grafanaJavascriptAgent.enabled&&t.P.api.pushMeasurement({type:h,values:g,context:l})}function o(h,g){const l=p=>({source:h,...g,...p});return{logDebug:(p,m)=>f(p,l(m)),logInfo:(p,m)=>s(p,l(m)),logWarning:(p,m)=>r(p,l(m)),logError:(p,m)=>a(p,l(m)),logMeasurement:(p,m,y)=>c(p,m,l(y))}}},89191:(G,O,e)=>{"use strict";e.d(O,{PL:()=>n,o:()=>r,se:()=>s});var t=e(32264);async function n(f){try{const a=t.$.bootData.user.theme==="light"?f.light:f.dark;return window.System.import(a)}catch(a){console.error(a)}}let i;function s(f){if(i)throw new Error("pluginImportUtils should only be set once, when Grafana is starting.");i=f}function r(){if(!i)throw new Error("pluginImportUtils can only be used after Grafana instance has started.");return i}},47773:(G,O,e)=>{"use strict";e.d(O,{$h:()=>g,bE:()=>a});var t=e(39070),n=e(89667),i=e(14236),s=e(11261),r=e(12091);const f={severity:"info",text:"Cached response"};function a(l,p){const m={data:[],state:t.Gu.Done},y="traceId"in l?l.traceId:void 0;y!=null&&(m.traceIds=[y]);const d=l;if(d.data?.results){const v=d.data.results,u=p?.length?p.map(x=>x.refId):Object.keys(v),D=c(d),P=[];for(const x of u){const E=v[x];E&&(E.refId=x,P.push(E))}for(const x of P){if(x.error){const E={refId:x.refId,message:x.error,status:x.status};y!=null&&(E.traceId=y),m.error||(m.error={...E}),m.errors?m.errors.push({...E}):m.errors=[{...E}],m.state=t.Gu.Error}if(x.frames?.length){for(let E of x.frames){D&&(E=o(E));const C=(0,n.or)(E);C.refId||(C.refId=x.refId),m.data.push(C)}continue}if(x.series?.length)for(const E of x.series)E.refId||(E.refId=x.refId),m.data.push((0,i.Vc)(E));if(x.tables?.length)for(const E of x.tables)E.refId||(E.refId=x.refId),m.data.push((0,i.Vc)(E))}}return d.status&&d.status!==200&&(m.state!==t.Gu.Error&&(m.state=t.Gu.Error),m.error||(m.error=(0,r.u)(l))),m}function c(l){const p=l?.headers;return!p||!p.get?!1:p.get("X-Cache")==="HIT"}function o(l){return{...l,schema:{...l.schema,fields:[...l.schema?.fields??[]],meta:{...l.schema?.meta,notices:[...l.schema?.meta?.notices??[],f],isCachedResponse:!0}}}}function h(l){const p=a(l);if(p.error?.data?.message)return{status:"error",message:p.error.data.message,details:p.error?.data?.error?{message:p.error.data.error}:void 0};if(p.error?.refId&&p.error?.message)return{status:"error",message:p.error.message};throw l}function g(l){if(!l||!l.length)return[];const p=[];let m=l.fields.find(y=>y.type===s.PU.string);if(m||(m=l.fields.find(y=>y.type!==s.PU.time)),m)for(let y=0;y<m.values.length;y++)p.push({text:""+m.values[y]});return p}},14778:(G,O,e)=>{"use strict";e.d(O,{_:()=>n,i:()=>i});let t;const n=s=>{t=s},i=()=>t?t():()=>console.error("ReturnToPrevious hook not found")},52622:(G,O,e)=>{"use strict";e.d(O,{$N:()=>W,$l:()=>V,$m:()=>se,$p:()=>R,CD:()=>U,D7:()=>c,F8:()=>A,GR:()=>p,J1:()=>a,L4:()=>d,Lt:()=>P,Ly:()=>C,NU:()=>m,Nj:()=>D,ON:()=>x,QH:()=>n,QR:()=>t,RU:()=>s,SV:()=>L,T6:()=>H,TZ:()=>K,WQ:()=>i,Wq:()=>k,Y$:()=>g,aG:()=>f,dx:()=>y,eX:()=>B,fY:()=>j,gs:()=>u,lm:()=>M,ob:()=>X,on:()=>v,qM:()=>Z,q_:()=>r,uH:()=>o,vM:()=>h,vp:()=>oe,wV:()=>I,xB:()=>w,yL:()=>l,yp:()=>b,zT:()=>q});var t=(z=>(z.AlertStates="alertStates",z.Annotations="annotations",z.Series="series",z))(t||{}),n=(z=>(z.Linear="linear",z.Quad="quad",z))(n||{}),i=(z=>(z.Clamped="clamped",z.Mod="mod",z))(i||{}),s=(z=>(z.Field="field",z.Fixed="fixed",z.Template="template",z))(s||{}),r=(z=>(z.Field="field",z.Fixed="fixed",z.Mapping="mapping",z))(r||{}),f=(z=>(z.Auto="auto",z.Coords="coords",z.Geohash="geohash",z.Lookup="lookup",z))(f||{}),a=(z=>(z.Count="count",z.Size="size",z))(a||{}),c=(z=>(z.auto="auto",z.ge="ge",z.le="le",z.unknown="unknown",z))(c||{}),o=(z=>(z.Ascending="Ascending",z.Descending="Descending",z))(o||{}),h=(z=>(z.Auto="auto",z.Bottom="bottom",z.Hidden="hidden",z.Left="left",z.Right="right",z.Top="top",z))(h||{}),g=(z=>(z.Series="series",z.Text="text",z))(g||{}),l=(z=>(z.Always="always",z.Auto="auto",z.Never="never",z))(l||{}),p=(z=>(z.Bars="bars",z.Line="line",z.Points="points",z))(p||{}),m=(z=>(z.Constant="constant",z.NegativeY="negative-Y",z))(m||{}),y=(z=>(z.Linear="linear",z.Smooth="smooth",z.StepAfter="stepAfter",z.StepBefore="stepBefore",z))(y||{}),d=(z=>(z.Linear="linear",z.Log="log",z.Ordinal="ordinal",z.Symlog="symlog",z))(d||{}),v=(z=>(z.Hue="hue",z.None="none",z.Opacity="opacity",z.Scheme="scheme",z))(v||{}),u=(z=>(z.None="none",z.Normal="normal",z.Percent="percent",z))(u||{}),D=(z=>(z[z.After=1]="After",z[z.Before=-1]="Before",z[z.Center=0]="Center",z))(D||{}),P=(z=>(z[z.Horizontal=0]="Horizontal",z[z.Vertical=1]="Vertical",z))(P||{}),x=(z=>(z[z.Down=-1]="Down",z[z.Left=-1]="Left",z[z.Right=1]="Right",z[z.Up=1]="Up",z))(x||{});const E={dash:[]};var C=(z=>(z.Area="area",z.Dashed="dashed",z.DashedAndArea="dashed+area",z.Line="line",z.LineAndArea="line+area",z.Off="off",z.Series="series",z))(C||{}),M=(z=>(z.Hidden="hidden",z.List="list",z.Table="table",z))(M||{});const S={calcs:[]};var I=(z=>(z.Auto="auto",z.Horizontal="horizontal",z.Vertical="vertical",z))(I||{});const T={timezone:[]};var b=(z=>(z.Background="background",z.BackgroundSolid="background_solid",z.None="none",z.Value="value",z))(b||{}),R=(z=>(z.Area="area",z.Line="line",z.None="none",z))(R||{}),A=(z=>(z.Auto="auto",z.Center="center",z))(A||{}),L=(z=>(z.Auto="auto",z.Name="name",z.None="none",z.Value="value",z.ValueAndName="value_and_name",z))(L||{}),U=(z=>(z.Inverted="inverted",z.SameAsValue="same_as_value",z.Standard="standard",z))(U||{}),W=(z=>(z.Multi="multi",z.None="none",z.Single="single",z))(W||{}),w=(z=>(z.Ascending="asc",z.Descending="desc",z.None="none",z))(w||{});const N={calcs:[]};var B=(z=>(z.Basic="basic",z.Gradient="gradient",z.Lcd="lcd",z))(B||{}),V=(z=>(z.Color="color",z.Hidden="hidden",z.Text="text",z))(V||{}),K=(z=>(z.Auto="auto",z.Left="left",z.Top="top",z))(K||{}),H=(z=>(z.Auto="auto",z.Manual="manual",z))(H||{}),X=(z=>(z.Auto="auto",z.BasicGauge="basic",z.ColorBackground="color-background",z.ColorBackgroundSolid="color-background-solid",z.ColorText="color-text",z.Custom="custom",z.DataLinks="data-links",z.Gauge="gauge",z.GradientGauge="gradient-gauge",z.Image="image",z.JSONView="json-view",z.LcdGauge="lcd-gauge",z.Sparkline="sparkline",z))(X||{}),k=(z=>(z.Basic="basic",z.Gradient="gradient",z))(k||{});const Y={fields:[],reducer:[]};var Z=(z=>(z.Auto="auto",z.Lg="lg",z.Md="md",z.Sm="sm",z))(Z||{}),se=(z=>(z.CSV="csv",z.Date="date",z.Distributed="distributed",z.DoubleQuote="doublequote",z.Glob="glob",z.HTML="html",z.JSON="json",z.Lucene="lucene",z.PercentEncode="percentencode",z.Pipe="pipe",z.QueryParam="queryparam",z.Raw="raw",z.Regex="regex",z.SQLString="sqlstring",z.SingleQuote="singlequote",z.Text="text",z.UriEncode="uriencode",z))(se||{}),j=(z=>(z.exact="exact",z.none="none",z.numbers="numbers",z.signature="signature",z))(j||{}),q=(z=>(z.EQ="eq",z.GT="gt",z.GTE="gte",z.LT="lt",z.LTE="lte",z.NEQ="neq",z))(q||{});const ne={align:"auto",inspect:!1},oe="browser"},33623:(G,O,e)=>{"use strict";e.d(O,{KQ:()=>i,QB:()=>s});var t=e(52622);const n="11.2.0-pre",i={barRadius:0,barWidth:.97,fullHighlight:!1,groupWidth:.7,orientation:t.wV.Auto,showValue:t.yL.Auto,stacking:t.gs.None,xTickLabelRotation:0,xTickLabelSpacing:0},s={fillOpacity:80,gradientMode:t.on.None,lineWidth:1}},16371:(G,O,e)=>{"use strict";e.d(O,{K:()=>i});var t=e(52622);const n="11.2.0-pre",i={displayMode:t.eX.Gradient,maxVizHeight:300,minVizHeight:16,minVizWidth:8,namePlacement:t.TZ.Auto,showUnfilled:!0,sizing:t.T6.Auto,valueMode:t.$l.Color}},37827:(G,O,e)=>{"use strict";e.d(O,{K:()=>n});const t="11.2.0-pre",n={selectedSeries:0}},44955:(G,O,e)=>{"use strict";e.d(O,{K:()=>i});var t=e(52622);const n="11.2.0-pre",i={minVizHeight:75,minVizWidth:75,showThresholdLabels:!1,showThresholdMarkers:!0,sizing:t.T6.Auto}},87487:(G,O,e)=>{"use strict";e.d(O,{KQ:()=>n});const t="11.2.0-pre",n={layers:[]},i={allLayers:!0,id:"zero",lat:0,lon:0,zoom:1};var s=(f=>(f.Details="details",f.None="none",f))(s||{}),r=(f=>(f.Coords="coords",f.Fit="fit",f.Zero="zero",f))(r||{})},96529:(G,O,e)=>{"use strict";e.d(O,{KQ:()=>f});var t=e(52622);const n="11.2.0-pre";var i=(a=>(a.Opacity="opacity",a.Scheme="scheme",a))(i||{}),s=(a=>(a.Exponential="exponential",a.Linear="linear",a))(s||{}),r=(a=>(a.X="x",a.Xy="xy",a.Y="y",a))(r||{});const f={calculate:!1,cellGap:1,cellValues:{},color:{scheme:"Oranges",fill:"dark-orange",reverse:!1,exponent:.5,steps:64},exemplars:{color:"rgba(255,0,255,0.7)"},filterValues:{le:1e-9},legend:{show:!0},selectionMode:"x",showValue:t.yL.Auto,tooltip:{mode:t.$N.Single,yHistogram:!1,showColorScale:!1}}},42226:(G,O,e)=>{"use strict";e.d(O,{KQ:()=>i,QB:()=>s});var t=e(52622);const n="11.2.0-pre",i={bucketCount:30,bucketOffset:0},s={fillOpacity:80,gradientMode:t.on.None,lineWidth:1}},69383:(G,O,e)=>{"use strict";e.d(O,{K:()=>n});const t="11.2.0-pre",n={showImage:!0}},65391:(G,O,e)=>{"use strict";e.d(O,{KQ:()=>f});const t="11.2.0-pre";var n=(a=>(a.Donut="donut",a.Pie="pie",a))(n||{}),i=(a=>(a.Name="name",a.Percent="percent",a.Value="value",a))(i||{}),s=(a=>(a.Percent="percent",a.Value="value",a))(s||{});const r={values:[]},f={displayLabels:[]}},89607:(G,O,e)=>{"use strict";e.d(O,{K:()=>i});var t=e(52622);const n="11.2.0-pre",i={colorMode:t.yp.Value,graphMode:t.$p.Area,justifyMode:t.F8.Auto,percentChangeColorMode:t.CD.Standard,showPercentChange:!1,textMode:t.SV.Auto,wideLayout:!0}},15821:(G,O,e)=>{"use strict";e.d(O,{KQ:()=>i,QB:()=>s});var t=e(52622);const n="11.2.0-pre",i={alignValue:"left",mergeValues:!0,rowHeight:.9,showValue:t.yL.Auto},s={fillOpacity:70,lineWidth:0}},64337:(G,O,e)=>{"use strict";e.d(O,{KQ:()=>i,QB:()=>s});var t=e(52622);const n="11.2.0-pre",i={colWidth:.9,rowHeight:.9,showValue:t.yL.Auto},s={fillOpacity:70,lineWidth:1}},52037:(G,O,e)=>{"use strict";e.d(O,{K:()=>i});var t=e(52622);const n="11.2.0-pre",i={cellHeight:t.qM.Sm,footer:{show:!1,countRows:!1,reducer:[]},frameIndex:0,showHeader:!0,showTypeIcons:!1,sortBy:[]}},12183:(G,O,e)=>{"use strict";e.d(O,{KQ:()=>f});const t="11.2.0-pre";var n=(a=>(a.Code="code",a.HTML="html",a.Markdown="markdown",a))(n||{}),i=(a=>(a.Go="go",a.Html="html",a.Json="json",a.Markdown="markdown",a.Plaintext="plaintext",a.Sql="sql",a.Typescript="typescript",a.Xml="xml",a.Yaml="yaml",a))(i||{});const s="plaintext",r={language:"plaintext",showLineNumbers:!1,showMiniMap:!1},f={content:`# Title

For markdown syntax help: [commonmark.org/help](https://commonmark.org/help/)`,mode:"markdown"}},10055:(G,O,e)=>{"use strict";e.d(O,{KQ:()=>a,QB:()=>f});var t=e(52622);const n="11.2.0-pre";var i=(c=>(c.Auto="auto",c.Manual="manual",c))(i||{}),s=(c=>(c.Lines="lines",c.Points="points",c.PointsAndLines="points+lines",c))(s||{});const r={exclude:[]},f={label:t.yL.Auto,show:"points"},a={series:[]}},73134:(G,O,e)=>{"use strict";e.d(O,{CO:()=>f,GW:()=>C,OA:()=>D,Ol:()=>l,QB:()=>E,Yb:()=>h,Ye:()=>M,ZG:()=>c,aD:()=>i,bf:()=>s,bt:()=>P,dM:()=>m,lt:()=>d,rw:()=>r,ss:()=>x,yV:()=>v});const t={tags:[]},n={exclude:!1,ids:[]},i={list:[]},s={builtIn:0,enable:!0,hide:!1},r={includeAll:!1,multi:!1,options:[],skipUrlSync:!1};var f=(S=>(S[S.never=0]="never",S[S.onDashboardLoad=1]="onDashboardLoad",S[S.onTimeRangeChanged=2]="onTimeRangeChanged",S))(f||{}),a=(S=>(S[S.dontHide=0]="dontHide",S[S.hideLabel=1]="hideLabel",S[S.hideVariable=2]="hideVariable",S))(a||{}),c=(S=>(S[S.alphabeticalAsc=1]="alphabeticalAsc",S[S.alphabeticalCaseInsensitiveAsc=5]="alphabeticalCaseInsensitiveAsc",S[S.alphabeticalCaseInsensitiveDesc=6]="alphabeticalCaseInsensitiveDesc",S[S.alphabeticalDesc=2]="alphabeticalDesc",S[S.disabled=0]="disabled",S[S.naturalAsc=7]="naturalAsc",S[S.naturalDesc=8]="naturalDesc",S[S.numericalAsc=3]="numericalAsc",S[S.numericalDesc=4]="numericalDesc",S))(c||{});const o={asDropdown:!1,includeVars:!1,keepTime:!1,tags:[],targetBlank:!1};var h=(S=>(S.ContinuousBlPu="continuous-BlPu",S.ContinuousBlYlRd="continuous-BlYlRd",S.ContinuousBlues="continuous-blues",S.ContinuousGrYlRd="continuous-GrYlRd",S.ContinuousGreens="continuous-greens",S.ContinuousPurples="continuous-purples",S.ContinuousRdYlGr="continuous-RdYlGr",S.ContinuousReds="continuous-reds",S.ContinuousYlBl="continuous-YlBl",S.ContinuousYlRd="continuous-YlRd",S.Fixed="fixed",S.PaletteClassic="palette-classic",S.PaletteClassicByName="palette-classic-by-name",S.Shades="shades",S.Thresholds="thresholds",S))(h||{});const g={h:9,w:12,x:0,y:0};var l=(S=>(S.Absolute="absolute",S.Percentage="percentage",S))(l||{});const p={steps:[]};var m=(S=>(S.RangeToText="range",S.RegexToText="regex",S.SpecialValue="special",S.ValueToText="value",S))(m||{}),y=(S=>(S.Empty="empty",S.False="false",S.NaN="nan",S.Null="null",S.NullAndNan="null+nan",S.True="true",S))(y||{});const d={hidden:!1,refresh_intervals:["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],time_options:["5m","15m","1h","6h","12h","24h","2d","7d","30d"]};var v=(S=>(S[S.Crosshair=1]="Crosshair",S[S.Off=0]="Off",S[S.Tooltip=2]="Tooltip",S))(v||{});const u=0,D={links:[],repeatDirection:"h",targets:[],transformations:[],transparent:!1},P={overrides:[]},x={id:""},E={links:[],mappings:[]},C={collapsed:!1,panels:[]},M={editable:!0,fiscalYearStartMonth:0,graphTooltip:0,links:[],panels:[],schemaVersion:39,tags:[],timezone:"browser"}},39651:(G,O,e)=>{"use strict";e.d(O,{Gu:()=>i,gB:()=>n});var t=e(52622);const n={align:"auto",inspect:!1,cellOptions:{type:t.ob.Auto}};var i=(s=>(s.NotStarted="NotStarted",s.Loading="Loading",s.Streaming="Streaming",s.Done="Done",s.Error="Error",s))(i||{})},79422:(G,O,e)=>{"use strict";e.d(O,{Ye:()=>i,lt:()=>r,rw:()=>s,zL:()=>n});var t=e(73134),n=(p=>(p[p.dontHide=0]="dontHide",p[p.hideLabel=1]="hideLabel",p[p.hideVariable=2]="hideVariable",p))(n||{});const i=t.Ye,s={...t.rw},r=t.lt,f=t.OA,a=t.GW,c=t.QB,o=t.bt,h=t.ss,g=t.bf,l=t.aD},11807:(G,O,e)=>{"use strict";e.d(O,{l:()=>h});var t=e(74848),n=e(32196),i=e(73287),s=e(14110),r=e(40845),f=e(29158),a=e(88575),c=e(32372),o=e(94471);function h({rawSql:l,datasourceType:p}){const[m,y]=(0,i.A)(),d=(0,r.of)(g),v=D=>{y(D),(0,s.rR)("grafana_sql_preview_copied",{datasource:p})},u=(0,t.jsxs)("div",{className:d.labelWrapper,children:[(0,t.jsx)("span",{className:d.label,children:"Preview"}),(0,t.jsx)(f.K,{tooltip:"Copy to clipboard",onClick:()=>v(l),name:"copy"})]});return(0,t.jsx)(a.D,{label:u,className:d.grow,children:(0,t.jsx)(c.B,{language:"sql",height:80,value:(0,o.s)(l),monacoOptions:{scrollbar:{vertical:"hidden"},scrollBeyondLastLine:!1},readOnly:!0,showMiniMap:!1})})}function g(l){return{grow:(0,n.css)({flexGrow:1}),label:(0,n.css)({fontSize:12,fontWeight:l.typography.fontWeightMedium}),labelWrapper:(0,n.css)({display:"flex",justifyContent:"space-between",paddingBottom:l.spacing(.5)})}}},94471:(G,O,e)=>{"use strict";e.d(O,{s:()=>n});var t=e(27633);function n(i){return t.Ay.format(i).replace(/(\$ \{ .* \})|(\$ __)|(\$ \w+)/g,s=>s.replace(/\s/g,""))}},42418:(G,O,e)=>{"use strict";e.d(O,{F:()=>h});var t=e(74848),n=e(32196),i=e(96540),s=e(13544),r=e(40845),f=e(55852),a=e(14578),c=e(90613),o=e(94753);const h=i.forwardRef(({title:p,onRemove:m,children:y,buttonContent:d,elevated:v,bottomSpacing:u,topSpacing:D,className:P,severity:x="error",...E},C)=>{const M=(0,r.$j)(),I=l(M,x,!!p,v,u,D),T={error:"alert",warning:"alert",info:"status",success:"status"},b=E.role||T[x],R=E["aria-label"]||p;return(0,t.jsx)("div",{ref:C,className:(0,n.cx)(I.wrapper,P),role:b,"aria-label":R,...E,children:(0,t.jsxs)(c.a,{"data-testid":s.Tp.components.Alert.alertV2(x),display:"flex",backgroundColor:x,borderRadius:"default",paddingY:1,paddingX:2,borderStyle:"solid",borderColor:x,alignItems:"stretch",boxShadow:v?"z3":void 0,children:[(0,t.jsx)(c.a,{paddingTop:1,paddingRight:2,children:(0,t.jsx)("div",{className:I.icon,children:(0,t.jsx)(a.I,{size:"xl",name:g(x)})})}),(0,t.jsxs)(c.a,{paddingY:1,grow:1,children:[(0,t.jsx)(o.E,{color:"primary",weight:"medium",children:p}),y&&(0,t.jsx)("div",{className:I.content,children:y})]}),m&&!d&&(0,t.jsx)("div",{className:I.close,children:(0,t.jsx)(f.$n,{"aria-label":"Close alert",icon:"times",onClick:m,type:"button",fill:"text",variant:"secondary"})}),m&&d&&(0,t.jsx)(c.a,{marginLeft:1,display:"flex",alignItems:"center",children:(0,t.jsx)(f.$n,{"aria-label":"Close alert",variant:"secondary",onClick:m,type:"button",children:d})})]})})});h.displayName="Alert";const g=p=>{switch(p){case"error":return"exclamation-circle";case"warning":return"exclamation-triangle";case"info":return"info-circle";case"success":return"check"}},l=(p,m,y,d,v,u)=>{const D=p.colors[m];return{wrapper:(0,n.css)({flexGrow:1,marginBottom:p.spacing(v??2),marginTop:p.spacing(u??0),position:"relative","&:before":{content:'""',position:"absolute",top:0,left:0,bottom:0,right:0,background:p.colors.background.primary,zIndex:-1}}),icon:(0,n.css)({color:D.text,position:"relative",top:"-1px"}),content:(0,n.css)({color:p.colors.text.primary,paddingTop:y?p.spacing(.5):0,maxHeight:"50vh",overflowY:"auto"}),close:(0,n.css)({position:"relative",color:p.colors.text.secondary,background:"none",display:"flex",top:"-6px",right:"-14px"})}}},28270:(G,O,e)=>{"use strict";e.d(O,{p:()=>m});var t=e(74848),n=e(32196),i=e(2543),s=e(96540),r=e(40845),f=e(88575),a=e(32982);const c=(0,s.memo)(()=>{const d=(0,r.of)(o);return(0,t.jsxs)("div",{className:d.ellipsis,children:[(0,t.jsx)("span",{className:d.firstDot,children:"."}),(0,t.jsx)("span",{className:d.secondDot,children:"."}),(0,t.jsx)("span",{className:d.thirdDot,children:"."})]})});c.displayName="EllipsisAnimated";const o=d=>({ellipsis:(0,n.css)({display:"inline"}),firstDot:(0,n.css)({[d.transitions.handleMotion("no-preference","reduce")]:{animation:`${h} 2s linear infinite`}}),secondDot:(0,n.css)({[d.transitions.handleMotion("no-preference","reduce")]:{animation:`${g} 2s linear infinite`}}),thirdDot:(0,n.css)({[d.transitions.handleMotion("no-preference","reduce")]:{animation:`${l} 2s linear infinite`}})}),h=(0,n.keyframes)`
  0% {
    opacity: 1;
  }
  65% {
    opacity: 1;
  }
  66% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
  `,g=(0,n.keyframes)`
  0% {
    opacity: 0;
  }
  21% {
    opacity: 0.5;
  }
  22% {
    opacity: 1;
  }
  65% {
    opacity: 1;
  }
  66% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
  `,l=(0,n.keyframes)`
  0% {
    opacity: 0;
  }
  43% {
    opacity: 0.5;
  }
  44% {
    opacity: 1;
  }
  65% {
    opacity: 1;
  }
  66% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
  `,p=2*1e3;function m(d){const{invalid:v,loading:u,onFinishChange:D,saveErrorMessage:P="Error saving this value",error:x,children:E,disabled:C,...M}=d,[S,I]=s.useState({isLoading:!1,showSuccess:!1,showError:v}),T=(0,s.useRef)(null);s.useEffect(()=>{let U;if(S.showSuccess){const W=S.showError?0:p;U=setTimeout(()=>{I({...S,showSuccess:!1})},W)}return()=>{window.clearTimeout(U)}},[S]);const b=(0,s.useCallback)(U=>{v||(I({...S,isLoading:!0,showSuccess:!1}),D(U).then(()=>{I({isLoading:!1,showSuccess:!0,showError:!1})}).catch(()=>{I({...S,isLoading:!1,showError:!0})}))},[v,S,D]),R=(0,s.useMemo)(()=>(0,i.debounce)(b,600,{leading:!1}),[b]),A=v||S.showError||void 0,L=(0,r.of)(y);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.D,{...M,loading:u||void 0,invalid:A,disabled:C,error:x||S.showError&&P,ref:T,className:L.widthFitContent,children:s.cloneElement(E(U=>{R(U)}))}),S.isLoading&&(0,t.jsxs)(a.r,{referenceElement:T.current,placement:"right",children:["Saving ",(0,t.jsx)(c,{})]}),S.showSuccess&&(0,t.jsx)(a.r,{suffixIcon:"check",referenceElement:T.current,placement:"right",children:"Saved!"})]})}m.displayName="AutoSaveField";const y=()=>({widthFitContent:(0,n.css)({width:"fit-content"})})},39938:(G,O,e)=>{"use strict";e.d(O,{E:()=>l});var t=e(74848),n=e(32196),i=e(96540),s=e(70255),r=e(84140),f=e(40845),a=e(72129),c=e(14578),o=e(56034);const h=i.memo(({icon:y,color:d,text:v,tooltip:u,className:D,...P})=>{const x=(0,f.of)(m,d),E=(0,t.jsxs)("div",{className:(0,n.cx)(x.wrapper,D),...P,children:[y&&(0,t.jsx)(c.I,{name:y,size:"sm"}),v]});return u?(0,t.jsx)(o.m,{content:u,placement:"auto",children:E}):E});h.displayName="Badge";const g=({rootProps:y})=>{const d=(0,f.of)(p);return(0,t.jsx)(s.A,{width:60,height:22,containerClassName:d.container,...y})},l=(0,a.j)(h,g),p=()=>({container:(0,n.css)({lineHeight:1})}),m=(y,d)=>{let v=y.visualization.getColorByName(d),u="",D="",P="";return y.isDark?(D=(0,r.A)(v).setAlpha(.15).toString(),u=(0,r.A)(v).setAlpha(.25).toString(),P=(0,r.A)(v).lighten(15).toString()):(D=(0,r.A)(v).setAlpha(.15).toString(),u=(0,r.A)(v).setAlpha(.25).toString(),P=(0,r.A)(v).darken(20).toString()),{wrapper:(0,n.css)({display:"inline-flex",padding:"1px 4px",borderRadius:y.shape.radius.default,background:D,border:`1px solid ${u}`,color:P,fontWeight:y.typography.fontWeightRegular,gap:"2px",fontSize:y.typography.bodySmall.fontSize,lineHeight:y.typography.bodySmall.lineHeight,alignItems:"center"})}}},97696:(G,O,e)=>{"use strict";e.d(O,{xE:()=>E});var t=e(74848),n=e(32196),i=e(96540),s=e(84140),r=e(47070),f=e(50082),a=e(58649),c=e(83195),o=e(24293),h=e(8066),g=e(13544),l=e(52622),p=e(29413),m=e(55852),y=e(9286);const d=18,v=50,u=150,D=1.5,P=1,x=10;class E extends i.PureComponent{static{this.defaultProps={lcdCellWidth:12,value:{text:"100",numeric:100},displayMode:l.eX.Gradient,orientation:r.wV.Horizontal,field:{min:0,max:100,thresholds:{mode:f.O.Absolute,steps:[]}},itemSpacing:8,showUnfilled:!0}}render(){const{onClick:w,className:N,theme:B}=this.props,{title:V}=this.props.value,K=S(this.props);return w?(0,t.jsxs)("button",{type:"button",style:K.wrapper,onClick:w,className:(0,n.cx)((0,m.my)(B),N),children:[(0,t.jsx)("div",{style:K.title,children:V}),this.renderBarAndValue()]}):(0,t.jsxs)("div",{style:K.wrapper,className:N,children:[V&&(0,t.jsx)("div",{style:K.title,children:V}),this.renderBarAndValue()]})}renderBarAndValue(){switch(this.props.displayMode){case"lcd":return this.renderRetroBars();case"basic":case"gradient":default:return this.renderBasicAndGradientBars()}}renderBasicAndGradientBars(){const{value:w,showUnfilled:N,valueDisplayMode:B}=this.props,V=R(this.props);return(0,t.jsxs)("div",{style:V.wrapper,children:[B!==l.$l.Hidden&&(0,t.jsx)(y.i,{"data-testid":g.Tp.components.Panels.Visualization.BarGauge.valueV2,value:w,style:V.value}),N&&(0,t.jsx)("div",{style:V.emptyBar}),(0,t.jsx)("div",{style:V.bar})]})}renderRetroBars(){const{display:w,field:N,value:B,itemSpacing:V,alignmentFactors:K,orientation:H,lcdCellWidth:X,text:k,valueDisplayMode:Y,theme:Z}=this.props,{valueHeight:se,valueWidth:j,maxBarHeight:q,maxBarWidth:ne,wrapperWidth:oe,wrapperHeight:z}=I(this.props),te=N.min??a.tw,le=N.max??a.d1,ie=C(H),ae=le-te,re=ie?q:ne,ce=V,me=Math.floor(re/X),ee=Math.floor((re-ce*me)/me),de=L(this.props),fe=U(K||B,de,j,se,H,k),Te={width:`${oe}px`,height:`${z}px`,display:"flex"};ie?(Te.flexDirection="column-reverse",Te.alignItems="center"):(Te.flexDirection="row",Te.alignItems="center",fe.justifyContent="flex-end");const je=[];for(let He=0;He<me;He++){const Be=te+ae/me*He,Ne=T(Be,B,w),Re={borderRadius:Z.shape.radius.default};Ne.isLit?Re.backgroundImage=`radial-gradient(${Ne.background} 10%, ${Ne.backgroundShade})`:Re.backgroundColor=Ne.background,ie?(Re.height=`${ee}px`,Re.width=`${ne}px`,Re.marginTop=`${ce}px`):(Re.width=`${ee}px`,Re.height=`${q}px`,Re.marginRight=`${ce}px`),je.push((0,t.jsx)("div",{style:Re},He.toString()))}return(0,t.jsxs)("div",{style:Te,children:[je,Y!==l.$l.Hidden&&(0,t.jsx)(y.i,{"data-testid":g.Tp.components.Panels.Visualization.BarGauge.valueV2,value:B,style:fe})]})}}function C(W){return W===r.wV.Vertical}function M(W){const{height:w,width:N,alignmentFactors:B,orientation:V,text:K,namePlacement:H}=W,X=B?B.title:W.value.title;if(!X)return{fontSize:0,width:0,height:0,placement:"above"};if(C(V)){const ne=K?.titleSize??14;return{fontSize:ne,width:N,height:ne*D,placement:"below"}}if(w>40&&H===l.TZ.Auto||H===l.TZ.Top){if(K?.titleSize)return{fontSize:K?.titleSize,width:0,height:K.titleSize*D,placement:"above"};const oe=Math.max(Math.min(w*.45,v),17);return{fontSize:oe/D,width:0,height:oe,placement:"above"}}const se=Math.max(w*.6,d)/D,j=(0,p.kD)(X,se),q=Math.min(j.width+15,N*.4);return{fontSize:K?.titleSize??se,height:0,width:q,placement:"left"}}function S(W){const w={display:"flex",overflow:"hidden",width:"100%"},N=M(W),B={fontSize:`${N.fontSize}px`,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",width:"100%",alignItems:"center",alignSelf:"center"};return C(W.orientation)?(w.flexDirection="column-reverse",B.textAlign="center"):N.placement==="above"?w.flexDirection="column":(w.flexDirection="row",B.width=`${N.width}px`,B.textAlign="right",B.paddingRight="10px"),{wrapper:w,title:B}}function I(W){const{height:w,width:N,orientation:B,text:V,alignmentFactors:K,valueDisplayMode:H}=W,X=M(W),k=K??W.value,Y=(0,c.cN)(k);let Z=0,se=0,j=0,q=0,ne=0,oe=0;const z=V?.valueSize??Math.max(X.fontSize,12),le=(0,p.kD)(Y,z).width+x*2;return C(B)?(V?.valueSize?j=V.valueSize*P:j=Math.min(Math.max(w*.1,d),v),q=N,H===l.$l.Hidden&&(j=0,q=0),Z=w-(X.height+j),se=N,ne=N,oe=w-X.height):(H===l.$l.Hidden?(j=0,q=0):(j=w-X.height,q=Math.max(Math.min(N*.2,u),le)),Z=w-X.height,se=N-q-X.width,X.placement==="above"?(ne=N,oe=w-X.height):(ne=N-X.width,oe=w)),{valueWidth:q,valueHeight:j,maxBarWidth:se,maxBarHeight:Z,wrapperHeight:oe,wrapperWidth:ne}}function T(W,w,N){if(W===null)return{background:o.F,border:o.F};const B=N?N(W).color:null;return B?w===null||isNaN(w.numeric)||W!==null&&W>w.numeric?{background:(0,s.A)(B).setAlpha(.18).toRgbString(),border:"transparent",isLit:!1}:{background:(0,s.A)(B).setAlpha(.95).toRgbString(),backgroundShade:(0,s.A)(B).setAlpha(.55).toRgbString(),border:(0,s.A)(B).setAlpha(.9).toRgbString(),isLit:!0}:{background:o.F,border:o.F}}function b(W,w,N){const B=Math.min((W-w)/(N-w),1);return isNaN(B)?0:B}function R(W){const{displayMode:w,field:N,value:B,alignmentFactors:V,orientation:K,theme:H,text:X}=W,{valueWidth:k,valueHeight:Y,maxBarHeight:Z,maxBarWidth:se}=I(W),j=N.min??a.tw,q=N.max??a.d1,ne=b(B.numeric,j,q),oe=L(W),z=B.color??o.F,le=U(V||B,oe,k,Y,K,X),ie=w==="basic",ae={display:"flex",flexGrow:1},re={borderRadius:H.shape.radius.default,position:"relative",zIndex:1},ce={background:H.colors.background.secondary,flexGrow:1,display:"flex",borderRadius:H.shape.radius.default,position:"relative"};if(C(K)){const me=Math.max(ne*Z,1);ae.flexDirection="column",ae.justifyContent="flex-end",re.transition="height 1s",re.height=`${me}px`,re.width=`${se}px`,ce.bottom="-3px",ce.width=`${k}px`,ie?(re.background=`${(0,s.A)(z).setAlpha(.35).toRgbString()}`,re.borderTop=`2px solid ${z}`):re.background=A(W,Z)}else{const me=Math.max(ne*se,1);ae.flexDirection="row-reverse",ae.justifyContent="flex-end",ae.alignItems="stretch",re.transition="width 1s",re.height=`${Z}px`,re.width=`${me}px`,ce.left="-3px",ce.height=`${Y}px`,ie?(re.background=`${(0,s.A)(z).setAlpha(.35).toRgbString()}`,re.borderRight=`2px solid ${z}`):re.background=A(W,se)}return{wrapper:ae,bar:re,value:le,emptyBar:ce}}function A(W,w){const{field:N,value:B,orientation:V,theme:K}=W,H=C(V)?"0deg":"90deg",X=N.min,k=N.max;let Y="",Z=0,se=(0,h.Hs)(N.color?.mode);if(se.id===o.Y.Thresholds){const j=N.thresholds;for(let q=0;q<j.steps.length;q++){const ne=j.steps[q],oe=W.theme.visualization.getColorByName(ne.color),z=j.mode===f.O.Percentage?ne.value/100:b(ne.value,X,k),te=z*w,le=Math.round(te-(te-Z)/2),ie=j.mode===f.O.Percentage?X+(k-X)*z:ne.value;if(Y==="")Y=`linear-gradient(${H}, ${oe}, ${oe}`;else{if(B.numeric<ie)break;Z=te,Y+=` ${le}px, ${oe}`}}return Y+")"}if(se.isContinuous&&se.getColors){const j=se.getColors(K);for(let q=0;q<j.length;q++){const ne=j[q];if(Y==="")Y=`linear-gradient(${H}, ${ne} 0px`;else{const z=q/(j.length-1)*w;Y+=`, ${ne} ${z}px`}}return Y+")"}return B.color??o.F}function L(W){if(W.valueDisplayMode==="text")return W.theme.colors.text.primary;const{value:w}=W;return w.color?w.color:o.F}function U(W,w,N,B,V,K){const H={color:w,height:`${B}px`,width:`${N}px`,display:"flex",alignItems:"center",textWrap:"nowrap",lineHeight:P};let X=N;const k=(0,c.cN)(W);return C(V)?(H.fontSize=K?.valueSize??(0,p.Vr)(k,X,B,P),H.justifyContent="center"):(H.fontSize=K?.valueSize??(0,p.Vr)(k,X-x*2,B,P),H.justifyContent="flex-end",H.paddingLeft=`${x}px`,H.paddingRight=`${x}px`,X-=x),H}},37494:(G,O,e)=>{"use strict";e.d(O,{yV:()=>U,yp:()=>b,$p:()=>R,F8:()=>A,SV:()=>L});var t=e(74848),n=e(32196),i=e(96540),s=e(55852),r=e(9286),f=e(84140),a=e(11261),c=e(83195),o=e(52622),h=e(24284),g=e(29413),l=e(5926),p=e(14578);const m=({percentChange:W,styles:w})=>{const N=W&&(W>0?"arrow-up":W<0?"arrow-down":void 0);return(0,t.jsxs)("div",{style:w.containerStyles,children:[N&&(0,t.jsx)(p.I,{name:N,height:w.iconSize,width:w.iconSize,viewBox:"6 6 12 12"}),y(W)]})},y=W=>W?.toLocaleString(void 0,{style:"percent",maximumSignificantDigits:3})??"",d=1.2,v=30,u=500;class D{constructor(w){this.props=w;const{width:N,height:B,value:V,text:K}=w;this.valueColor=V.color??"gray",this.panelPadding=B>100?12:8,this.textValues=I(w),this.justifyCenter=S(w.justifyMode,this.textValues.title),this.valueToAlignTo=this.textValues.valueToAlignTo,this.titleToAlignTo=this.textValues.titleToAlignTo,this.titleFontSize=0,this.valueFontSize=0,this.chartHeight=0,this.chartWidth=0,this.maxTextWidth=N-this.panelPadding*2,this.maxTextHeight=B-this.panelPadding*2,K&&(K.titleSize&&(this.titleFontSize=K.titleSize,this.titleToAlignTo=void 0),K.valueSize&&(this.valueFontSize=K.valueSize,this.valueToAlignTo=""))}getTitleStyles(){const w={fontSize:`${this.titleFontSize}px`,lineHeight:d};return(this.props.colorMode===b.Background||this.props.colorMode===b.BackgroundSolid)&&(w.color=(0,h.mZ)(this.valueColor,this.props.theme.isDark)),w}getValueStyles(){const w={fontSize:this.valueFontSize,fontWeight:u,lineHeight:d,position:"relative",zIndex:1};switch(this.justifyCenter&&(w.textAlign="center"),this.props.colorMode){case b.Value:w.color=this.valueColor;break;case b.Background:case b.BackgroundSolid:w.color=(0,h.mZ)(this.valueColor,this.props.theme.isDark);break;case b.None:w.color=this.props.theme.colors.text.primary;break}return w}getPercentChangeStyles(w,N,B){const K=this.getValueAndTitleContainerStyles(),H=Math.max(this.valueFontSize/2.5,12);let X=Math.max(this.valueFontSize/3,10);const k=this.props.theme.visualization,Y=T(w,N,B,k),Z={fontSize:H,fontWeight:u,lineHeight:d,position:"relative",display:"flex",alignItems:"center",gap:Math.max(H/3,4),zIndex:1,color:Y};switch(this.justifyCenter&&(Z.textAlign="center"),K.flexDirection==="column"&&H>12&&(Z.marginTop=-(H/4)),K.flexDirection==="row"&&(Z.alignItems="baseline",Z.lineHeight=d*2.5),this.props.colorMode){case b.Background:case b.BackgroundSolid:Z.color=(0,h.mZ)(this.valueColor,this.props.theme.isDark);break}return this.props.textMode===L.None&&(Z.fontSize=(0,g.Vr)(y(w),this.maxTextWidth*.8,this.maxTextHeight*.8,d,void 0,u),X=Z.fontSize*.8),{containerStyles:Z,iconSize:X}}getValueAndTitleContainerStyles(){const w={display:"flex",flexWrap:"wrap"};return this.justifyCenter&&(w.alignItems="center",w.justifyContent="center",w.flexGrow=1,w.gap="0.75ch"),w}getPanelStyles(){const{width:w,height:N,theme:B,colorMode:V,textMode:K}=this.props,H={width:`${w}px`,height:`${N}px`,padding:`${K===L.None?2:this.panelPadding}px`,borderRadius:B.shape.radius.default,position:"relative",display:"flex"},X=B.isDark?1:-.7;switch(V){case b.Background:const k=(0,f.A)(this.valueColor).darken(15*X).spin(8).toRgbString(),Y=(0,f.A)(this.valueColor).darken(5*X).spin(-8).toRgbString();H.background=`linear-gradient(120deg, ${k}, ${Y})`;break;case b.BackgroundSolid:H.background=(0,f.A)(this.valueColor).toString();break;case b.Value:H.background="transparent";break}return this.justifyCenter&&(H.alignItems="center",H.flexDirection="row"),H}renderChart(){const{sparkline:w,colorMode:N}=this.props;if(!w||w.y?.type!==a.PU.number)return null;let B,V;switch(N){case b.Background:case b.BackgroundSolid:B="rgba(255,255,255,0.4)",V=(0,f.A)(this.valueColor).brighten(40).toRgbString();break;case b.None:case b.Value:default:V=this.valueColor,B=(0,f.A)(this.valueColor).setAlpha(.2).toRgbString();break}const K={custom:{drawStyle:o.GR.Line,lineWidth:1,fillColor:B,lineColor:V}};return(0,t.jsx)("div",{style:this.getChartStyles(),children:(0,t.jsx)(l.O,{height:this.chartHeight,width:this.chartWidth,sparkline:w,config:K,theme:this.props.theme})})}getChartStyles(){return{position:"absolute",right:0,bottom:0}}}class P extends D{constructor(w){super(w);const N=this.titleToAlignTo?.length?.3:1;this.valueToAlignTo.length&&(this.valueFontSize=(0,g.Vr)(this.valueToAlignTo,this.maxTextWidth*N,this.maxTextHeight,d,void 0,u)),this.titleToAlignTo?.length&&(this.titleFontSize=(0,g.Vr)(this.titleToAlignTo,this.maxTextWidth*.6,this.maxTextHeight,d,v),this.titleFontSize=Math.min(this.valueFontSize*.7,this.titleFontSize))}getValueAndTitleContainerStyles(){const w=super.getValueAndTitleContainerStyles();return w.flexDirection="row",w.alignItems="center",w.flexGrow=1,this.justifyCenter||(w.justifyContent="space-between"),w}renderChart(){return null}getPanelStyles(){const w=super.getPanelStyles();return w.alignItems="center",w}}class x extends D{constructor(w){super(w);const{width:N,height:B}=w,V=.5,K=.6,H=1-K,X=.4;this.chartWidth=N,this.chartHeight=B*V,this.titleToAlignTo?.length&&(this.titleFontSize=(0,g.Vr)(this.titleToAlignTo,this.maxTextWidth*K,this.maxTextHeight*X,d,v)),this.valueToAlignTo.length&&(this.valueFontSize=(0,g.Vr)(this.valueToAlignTo,this.maxTextWidth*H,this.maxTextHeight*V,d,void 0,u))}getValueAndTitleContainerStyles(){const w=super.getValueAndTitleContainerStyles();return w.flexDirection="row",w.flexGrow=1,this.justifyCenter||(w.justifyContent="space-between"),w}getPanelStyles(){const w=super.getPanelStyles();return w.flexDirection="row",w.justifyContent="space-between",w}}class E extends D{constructor(w){super(w);const{width:N,height:B}=w,V=.15,K=.25;let H=0;this.chartHeight=B*K,this.chartWidth=N,this.titleToAlignTo?.length&&(this.titleFontSize=(0,g.Vr)(this.titleToAlignTo,this.maxTextWidth,B*V,d,v),H=this.titleFontSize*d),this.valueToAlignTo.length&&(this.valueFontSize=(0,g.Vr)(this.valueToAlignTo,this.maxTextWidth,this.maxTextHeight-this.chartHeight-H,d,void 0,u)),this.titleToAlignTo?.length&&(this.titleFontSize=Math.min(this.valueFontSize*.7,this.titleFontSize)),this.chartHeight=B-this.titleFontSize*d-this.valueFontSize*d}getValueAndTitleContainerStyles(){const w=super.getValueAndTitleContainerStyles();return w.flexDirection="column",w.justifyContent="center",w}getPanelStyles(){const w=super.getPanelStyles();return w.flexDirection="column",w}}class C extends D{constructor(w){super(w);const{height:N}=w,B=.15;let V=0;this.titleToAlignTo?.length&&(this.titleFontSize=(0,g.Vr)(this.titleToAlignTo,this.maxTextWidth,N*B,d,v),V=this.titleFontSize*d),this.valueToAlignTo.length&&(this.valueFontSize=(0,g.Vr)(this.valueToAlignTo,this.maxTextWidth,this.maxTextHeight-V,d,void 0,u)),this.titleToAlignTo?.length&&(this.titleFontSize=Math.min(this.valueFontSize*.7,this.titleFontSize))}getValueAndTitleContainerStyles(){const w=super.getValueAndTitleContainerStyles();return w.flexDirection="column",w.flexGrow=1,w}renderChart(){return null}getPanelStyles(){const w=super.getPanelStyles();return w.alignItems="center",w}}function M(W){const{width:w,height:N,sparkline:B}=W;return w/N>2.5&&!W.disableWideLayout?N>50&&B&&B.y.values.length>1?new x(W):new P(W):N>100&&B&&B.y.values.length>1?new E(W):new C(W)}function S(W,w){return W===A.Center?!0:(w??"").length===0}function I(W){const{value:w,alignmentFactors:N,count:B}=W;let{textMode:V}=W;const K=N?N.title:w.title,H=(0,c.cN)(N||w);switch(V===L.Auto&&(B??1)===1&&(V=L.Value),V){case L.Name:return{...w,title:void 0,prefix:void 0,suffix:void 0,text:w.title||"",titleToAlignTo:void 0,valueToAlignTo:K??"",tooltip:(0,c.cN)(w)};case L.Value:return{...w,title:void 0,titleToAlignTo:void 0,valueToAlignTo:H,tooltip:w.title};case L.None:return{numeric:w.numeric,color:w.color,title:void 0,text:"",titleToAlignTo:void 0,valueToAlignTo:"1",tooltip:`Name: ${w.title}
Value: ${(0,c.cN)(w)}`};case L.ValueAndName:default:return{...w,titleToAlignTo:K,valueToAlignTo:H}}}function T(W,w,N,B){return w===o.CD.SameAsValue?N.color:W*(w===o.CD.Inverted?-1:1)>0?B.getColorByName("green"):B.getColorByName("red")}var b=(W=>(W.Background="background",W.BackgroundSolid="background_solid",W.None="none",W.Value="value",W))(b||{}),R=(W=>(W.None="none",W.Line="line",W.Area="area",W))(R||{}),A=(W=>(W.Auto="auto",W.Center="center",W))(A||{}),L=(W=>(W.Auto="auto",W.Value="value",W.ValueAndName="value_and_name",W.Name="name",W.None="none",W))(L||{});class U extends i.PureComponent{static{this.defaultProps={justifyMode:"auto"}}render(){const{onClick:w,className:N,hasLinks:B,theme:V}=this.props,K=M(this.props),H=K.getPanelStyles(),X=K.getValueAndTitleContainerStyles(),k=K.getValueStyles(),Y=K.getTitleStyles(),Z=K.textValues,se=this.props.value.percentChange,j=this.props.percentChangeColorMode,q=se!=null&&!Number.isNaN(se),ne=B?void 0:Z.tooltip;return w?(0,t.jsxs)("button",{type:"button",className:(0,n.cx)((0,s.my)(V),N),style:H,onClick:w,title:ne,children:[(0,t.jsxs)("div",{style:X,children:[Z.title&&(0,t.jsx)("div",{style:Y,children:Z.title}),(0,t.jsx)(r.i,{value:Z,style:k})]}),K.renderChart()]}):(0,t.jsxs)("div",{className:N,style:H,title:ne,children:[(0,t.jsxs)("div",{style:X,children:[Z.title&&(0,t.jsx)("div",{style:Y,children:Z.title}),(0,t.jsx)(r.i,{value:Z,style:k}),q&&(0,t.jsx)(m,{percentChange:se,styles:K.getPercentChangeStyles(se,j,k)})]}),K.renderChart()]})}}},54438:(G,O,e)=>{"use strict";e.d(O,{J:()=>c});var t=e(74848),n=e(32196),i=e(96540),s=e(23257),r=e.n(s),f=e(40845),a=e(5313);const c=(0,i.forwardRef)(({name:h,value:g,hidden:l,facets:p,onClick:m,className:y,loading:d,searchTerm:v,active:u,style:D,title:P,highlightParts:x,...E},C)=>{const M=(0,f.$j)(),S=o(M),I=v?[v]:[],T=(0,i.useCallback)(R=>{m&&!l&&m(h,g,R)},[m,h,l,g]);let b=g||h;return p&&(b=`${b} (${p})`),(0,t.jsx)("button",{ref:C,onClick:T,style:D,title:P||b,type:"button",role:"option","aria-selected":!!u,className:(0,n.cx)(S.base,u&&S.active,d&&S.loading,l&&S.hidden,y,m&&!l&&S.hover),...E,children:x!==void 0?(0,t.jsx)(a.z,{text:b,highlightClassName:S.matchHighLight,highlightParts:x}):(0,t.jsx)(r(),{textToHighlight:b,searchWords:I,autoEscape:!0,highlightClassName:S.matchHighLight})},b)});c.displayName="Label";const o=h=>({base:(0,n.css)({display:"inline-block",cursor:"pointer",fontSize:h.typography.size.sm,lineHeight:h.typography.bodySmall.lineHeight,backgroundColor:h.colors.background.secondary,color:h.colors.text.primary,whiteSpace:"nowrap",textShadow:"none",padding:h.spacing(.5),borderRadius:h.shape.radius.default,border:"none",marginRight:h.spacing(1),marginBottom:h.spacing(.5)}),loading:(0,n.css)({fontWeight:h.typography.fontWeightMedium,backgroundColor:h.colors.primary.shade,color:h.colors.text.primary,[h.transitions.handleMotion("no-preference","reduce")]:{animation:"pulse 3s ease-out 0s infinite normal forwards"},"@keyframes pulse":{"0%":{color:h.colors.text.primary},"50%":{color:h.colors.text.secondary},"100%":{color:h.colors.text.disabled}}}),active:(0,n.css)({fontWeight:h.typography.fontWeightMedium,backgroundColor:h.colors.primary.main,color:h.colors.primary.contrastText}),matchHighLight:(0,n.css)({background:"inherit",color:h.components.textHighlight.text,backgroundColor:h.components.textHighlight.background}),hidden:(0,n.css)({opacity:.6,cursor:"default",border:"1px solid transparent"}),hover:(0,n.css)({"&:hover":{opacity:.85,cursor:"pointer"}})})},32012:(G,O,e)=>{"use strict";e.d(O,{H:()=>o});var t=e(74848),n=e(32196),i=e(48470),s=e(40845),r=e(55852),f=e(58898),a=e(30958),c=e(14578);const o=g=>{const{onChange:l,className:p,loadData:m,icon:y,buttonProps:d,hideDownIcon:v,variant:u,disabled:D,...P}=g,x=(0,s.of)(h),E=(0,s.of)(a.T);let C=g.children;return v||(C=[g.children,(0,t.jsx)(c.I,{name:"angle-down",className:x.icons.right},"down-icon")]),(0,t.jsx)(i.A,{onChange:(0,f.k)(l),loadData:(0,f.W)(m),dropdownClassName:(0,n.cx)(E.dropdown,x.popup),...P,expandIcon:null,children:(0,t.jsx)(r.$n,{icon:y,disabled:D,variant:u,...d??{},children:C})})};o.displayName="ButtonCascader";const h=g=>({popup:(0,n.css)({label:"popup",zIndex:g.zIndex.dropdown}),icons:{right:(0,n.css)({margin:"1px 0 0 4px"}),left:(0,n.css)({margin:"-1px 4px 0 0"})}})},55852:(G,O,e)=>{"use strict";e.d(O,{$n:()=>g,Ez:()=>D,Jt:()=>p,U_:()=>v,hs:()=>m,my:()=>u,z9:()=>l});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(16797),f=e(87266),a=e(14578),c=e(56034);const o=null,h=null,g=i.forwardRef(({variant:P="primary",size:x="md",fill:E="solid",icon:C,fullWidth:M,children:S,className:I,type:T="button",tooltip:b,disabled:R,tooltipPlacement:A,onClick:L,...U},W)=>{const w=(0,s.$j)(),N=m({theme:w,size:x,variant:P,fill:E,fullWidth:M,iconOnly:!S}),B=(0,n.cx)(N.button,{[N.disabled]:R},I),V=!!b,K=(0,t.jsxs)("button",{className:B,type:T,onClick:R?void 0:L,...U,"aria-disabled":V&&R,disabled:!V&&R,ref:b?void 0:W,children:[(0,t.jsx)(p,{icon:C,size:x,className:N.icon}),S&&(0,t.jsx)("span",{className:N.content,children:S})]});return b?(0,t.jsx)(c.m,{ref:W,content:b,placement:A,children:K}):K});g.displayName="Button";const l=i.forwardRef(({variant:P="primary",size:x="md",fill:E="solid",icon:C,fullWidth:M,children:S,className:I,onBlur:T,onFocus:b,disabled:R,tooltip:A,tooltipPlacement:L,...U},W)=>{const w=(0,s.$j)(),N=m({theme:w,fullWidth:M,size:x,variant:P,fill:E,iconOnly:!S}),B=(0,n.cx)(N.button,{[(0,n.css)(N.disabled,{pointerEvents:"none"})]:R},I),V=(0,t.jsxs)("a",{className:B,...U,tabIndex:R?-1:0,"aria-disabled":R,ref:A?void 0:W,children:[(0,t.jsx)(p,{icon:C,size:x,className:N.icon}),S&&(0,t.jsx)("span",{className:N.content,children:S})]});return A?(0,t.jsx)(c.m,{ref:W,content:A,placement:L,children:V}):V});l.displayName="LinkButton";const p=({icon:P,size:x,className:E,iconType:C})=>P?i.isValidElement(P)?i.cloneElement(P,{className:E,size:x}):(0,t.jsx)(a.I,{name:P,size:x,className:E,type:C}):null,m=P=>{const{theme:x,variant:E,fill:C="solid",size:M,iconOnly:S,fullWidth:I}=P,{height:T,padding:b,fontSize:R}=(0,f.SM)(M,x),A=v(x,E,C),L=d(x,E,C),U=(0,r.getFocusStyles)(x),W=x.spacing.gridSize*b-1;return{button:(0,n.css)({label:"button",display:"inline-flex",alignItems:"center",fontSize:R,fontWeight:x.typography.fontWeightMedium,fontFamily:x.typography.fontFamily,padding:`0 ${W}px`,height:x.spacing(T),lineHeight:`${x.spacing.gridSize*T-2}px`,verticalAlign:"middle",cursor:"pointer",borderRadius:x.shape.radius.default,"&:focus":U,"&:focus-visible":U,"&:focus:not(:focus-visible)":(0,r.getMouseFocusStyles)(x),...I&&{flexGrow:1,justifyContent:"center"},...A,":disabled":L,"&[disabled]":L}),disabled:(0,n.css)(L,{"&:hover":(0,n.css)(L)}),img:(0,n.css)({width:"16px",height:"16px",margin:x.spacing(0,1,0,.5)}),icon:S?(0,n.css)({marginRight:x.spacing(-b/2),marginLeft:x.spacing(-b/2)}):(0,n.css)({marginRight:x.spacing(b/2)}),content:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center",whiteSpace:"nowrap",overflow:"hidden",height:"100%"})}};function y(P,x,E){let C=x.border,M="transparent",S="transparent";return x.name==="secondary"&&(M=x.border,S=P.colors.emphasize(x.border,.25),C=P.colors.border.strong),E==="outline"?{background:"transparent",color:x.text,border:`1px solid ${C}`,transition:P.transitions.create(["background-color","border-color","color"],{duration:P.transitions.duration.short}),"&:hover":{background:x.transparent,borderColor:P.colors.emphasize(C,.25),color:x.text}}:E==="text"?{background:"transparent",color:x.text,border:"1px solid transparent",transition:P.transitions.create(["background-color","color"],{duration:P.transitions.duration.short}),"&:focus":{outline:"none",textDecoration:"none"},"&:hover":{background:x.transparent,textDecoration:"none"}}:{background:x.main,color:x.contrastText,border:`1px solid ${M}`,transition:P.transitions.create(["background-color","box-shadow","border-color","color"],{duration:P.transitions.duration.short}),"&:hover":{background:x.shade,color:x.contrastText,boxShadow:P.shadows.z1,borderColor:S}}}function d(P,x,E){const C={cursor:"not-allowed",boxShadow:"none",color:P.colors.text.disabled,transition:"none"};return E==="text"?{...C,background:"transparent",border:"1px solid transparent"}:E==="outline"?{...C,background:"transparent",border:`1px solid ${P.colors.border.weak}`}:{...C,background:P.colors.action.disabledBackground,border:"1px solid transparent"}}function v(P,x,E){switch(x){case"secondary":return y(P,P.colors.secondary,E);case"destructive":return y(P,P.colors.error,E);case"success":return y(P,P.colors.success,E);case"primary":default:return y(P,P.colors.primary,E)}}const u=P=>(0,n.css)({background:"transparent",color:P.colors.text.primary,border:"none",padding:0}),D=P=>(0,n.css)({background:"transparent",border:"none",padding:0,fontFamily:"inherit",color:"inherit",height:"100%","&:hover":{background:"transparent",color:"inherit"}})},19727:(G,O,e)=>{"use strict";e.d(O,{e:()=>r});var t=e(74848),n=e(32196),i=e(96540),s=e(40845);const r=(0,i.forwardRef)(({className:a,children:c,...o},h)=>{const g=(0,s.of)(f);return(0,t.jsx)("div",{ref:h,className:(0,n.cx)("button-group",g.wrapper,a),...o,children:c})});r.displayName="ButtonGroup";const f=a=>({wrapper:(0,n.css)({display:"flex","> .button-group:not(:first-child) > button, > button:not(:first-child)":{borderTopLeftRadius:0,borderBottomLeftRadius:0},"> .button-group:not(:last-child) > button, > button:not(:last-child)":{borderTopRightRadius:0,borderBottomRightRadius:0,borderRightWidth:0}})})},61458:(G,O,e)=>{"use strict";e.d(O,{V:()=>s});var t=e(74848),n=e(32196),i=e(40845);const s=({className:f,children:a})=>{const c=(0,i.of)(r);return(0,t.jsx)("div",{className:(0,n.cx)(c,f),children:a})},r=()=>(0,n.css)({display:"flex",button:{flexGrow:1,justifyContent:"center"},"> *":{flexGrow:1},label:{flexGrow:1,textAlign:"center"}})},76442:(G,O,e)=>{"use strict";e.d(O,{c:()=>s});var t=e(74848),n=e(32196),i=e(40845);const s=({message:f,callToActionElement:a,footer:c,className:o})=>{const h=(0,i.of)(r);return(0,t.jsxs)("div",{className:(0,n.cx)([h.wrapper,o]),children:[f&&(0,t.jsx)("div",{className:h.message,children:f}),a,c&&(0,t.jsx)("div",{className:h.footer,children:c})]})},r=f=>({wrapper:(0,n.css)({label:"call-to-action-card",background:f.colors.background.secondary,borderRadius:f.shape.radius.default,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flexGrow:1,padding:f.spacing(3),[f.breakpoints.down("sm")]:{padding:f.spacing(3,1)}}),message:(0,n.css)({marginBottom:f.spacing(3),fontStyle:"italic"}),footer:(0,n.css)({marginTop:f.spacing(3)})})},10860:(G,O,e)=>{"use strict";e.d(O,{H:()=>C,Z:()=>c});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(16797),f=e(81507);const a=i.createContext(null),c=({disabled:M,href:S,onClick:I,children:T,isSelected:b,isCompact:R,className:A,...L})=>{const U=(0,i.useMemo)(()=>i.Children.toArray(T).some(B=>i.isValidElement(B)&&B.type===o),[T]),W=M||!I&&!S,w=I&&!M?I:void 0,N=(0,s.of)(f.i,M,W,b,R);return(0,t.jsx)(f.Q,{disableEvents:M,disableHover:W,isSelected:b,className:(0,n.cx)(N.container,A),...L,children:(0,t.jsxs)(a.Provider,{value:{href:S,onClick:w,disabled:M,isSelected:b},children:[!U&&(0,t.jsx)(o,{}),T]})})},o=({children:M,className:S,"aria-label":I})=>{const T=(0,i.useContext)(a),b=(0,s.of)(h),{href:R,onClick:A,isSelected:L}=T??{href:void 0,onClick:void 0,isSelected:void 0};return(0,t.jsxs)("h2",{className:(0,n.cx)(b.heading,S),children:[R?(0,t.jsx)("a",{href:R,className:b.linkHack,"aria-label":I,onClick:A,children:M}):A?(0,t.jsx)("button",{onClick:A,className:b.linkHack,"aria-label":I,type:"button",children:M}):(0,t.jsx)(t.Fragment,{children:M}),L!==void 0&&(0,t.jsx)("input",{"aria-label":"option",type:"radio",checked:L,readOnly:!0})]})};o.displayName="Heading";const h=M=>({heading:(0,n.css)({gridArea:"Heading",justifySelf:"start",display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",marginBottom:0,fontSize:M.typography.size.md,letterSpacing:"inherit",lineHeight:M.typography.body.lineHeight,color:M.colors.text.primary,fontWeight:M.typography.fontWeightMedium,"& input[readonly]":{cursor:"inherit"}}),linkHack:(0,n.css)({all:"unset","&::after":{position:"absolute",content:'""',top:0,bottom:0,left:0,right:0,borderRadius:M.shape.radius.default},"&:focus-visible":{outline:"none",outlineOffset:0,boxShadow:"none","&::after":{...(0,r.getFocusStyles)(M),zIndex:1}}})}),g=({children:M,className:S})=>{const I=(0,s.of)(l);return(0,t.jsx)("div",{className:(0,n.cx)(I.tagList,S),children:M})};g.displayName="Tags";const l=M=>({tagList:(0,n.css)({position:"relative",gridArea:"Tags",alignSelf:"center"})}),p=({children:M,className:S})=>{const I=(0,s.of)(m);return(0,t.jsx)("p",{className:(0,n.cx)(I.description,S),children:M})};p.displayName="Description";const m=M=>({description:(0,n.css)({width:"100%",gridArea:"Description",margin:M.spacing(1,0,0),color:M.colors.text.secondary,lineHeight:M.typography.body.lineHeight})}),y=({children:M,align:S="start",className:I})=>{const T=(0,s.of)(d);return(0,t.jsx)("div",{className:(0,n.cx)(T.media,I,(0,n.css)({alignSelf:S})),children:M})};y.displayName="Figure";const d=M=>({media:(0,n.css)({position:"relative",gridArea:"Figure",marginRight:M.spacing(2),width:"40px","> img":{width:"100%"},"&:empty":{display:"none"}})}),v=(0,i.memo)(({children:M,className:S,separator:I="|"})=>{const T=(0,s.of)(u);let b=M;const R=i.Children.toArray(M).filter(Boolean);return R.length?(b=R.map((A,L)=>(0,t.jsx)("div",{className:T.metadataItem,children:A},`element_${L}`)),R.length>1&&I&&(b=R.reduce((A,L,U)=>[A,(0,t.jsx)("span",{className:T.separator,children:I},`separator_${U}`),L])),(0,t.jsx)("div",{className:(0,n.cx)(T.metadata,S),children:b})):null});v.displayName="Meta";const u=M=>({metadata:(0,n.css)({gridArea:"Meta",display:"flex",alignItems:"center",width:"100%",fontSize:M.typography.size.sm,color:M.colors.text.secondary,margin:M.spacing(.5,0,0),lineHeight:M.typography.bodySmall.lineHeight,overflowWrap:"anywhere"}),metadataItem:(0,n.css)({zIndex:0}),separator:(0,n.css)({margin:`0 ${M.spacing(1)}`})}),D=({children:M,disabled:S,variant:I,className:T})=>{const b=(0,s.of)(P),A=(0,i.useContext)(a)?.disabled||S,L=I==="primary"?b.actions:b.secondaryActions;return(0,t.jsx)("div",{className:(0,n.cx)(L,T),children:i.Children.map(M,U=>i.isValidElement(U)?(0,i.cloneElement)(U,{disabled:A,...U.props}):null)})},P=M=>({actions:(0,n.css)({display:"flex",flexDirection:"row",flexWrap:"wrap",gap:M.spacing(1),gridArea:"Actions",marginTop:M.spacing(2)}),secondaryActions:(0,n.css)({alignSelf:"center",color:M.colors.text.secondary,display:"flex",flexDirection:"row",flexWrap:"wrap",gap:M.spacing(1),gridArea:"Secondary",marginTop:M.spacing(2)})}),x=({children:M,disabled:S,className:I})=>(0,t.jsx)(D,{variant:"primary",disabled:S,className:I,children:M});x.displayName="Actions";const E=({children:M,disabled:S,className:I})=>(0,t.jsx)(D,{variant:"secondary",disabled:S,className:I,children:M});E.displayName="SecondaryActions";const C=M=>({inner:(0,n.css)({display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",flexWrap:"wrap"}),...h(M),...u(M),...m(M),...d(M),...P(M),...l(M)});c.Heading=o,c.Tags=g,c.Figure=y,c.Meta=v,c.Actions=x,c.SecondaryActions=E,c.Description=p},81507:(G,O,e)=>{"use strict";e.d(O,{Q:()=>a,i:()=>c});var t=e(74848),n=e(32196),i=e(40845),s=e(16797);const r=({children:o,href:h})=>{const{inner:g}=(0,i.of)(f);return h?(0,t.jsx)("a",{className:g,href:h,children:o}):(0,t.jsx)(t.Fragment,{children:o})},f=o=>({inner:(0,n.css)({display:"flex",width:"100%",padding:o.spacing(2)})}),a=({children:o,disableEvents:h,disableHover:g,isSelected:l,className:p,href:m,...y})=>{const{oldContainer:d}=(0,i.of)(c,h,g,l);return(0,t.jsx)("div",{...y,className:(0,n.cx)(d,p),children:(0,t.jsx)(r,{href:m,children:o})})},c=(o,h=!1,g=!1,l,p)=>{const m=l!==void 0;return{container:(0,n.css)({display:"grid",position:"relative",gridTemplateColumns:"auto 1fr auto",gridTemplateRows:"1fr auto auto auto",gridAutoColumns:"1fr",gridAutoFlow:"row",gridTemplateAreas:`
        "Figure Heading Tags"
        "Figure Meta Tags"
        "Figure Description Tags"
        "Figure Actions Secondary"`,width:"100%",padding:o.spacing(p?1:2),background:o.colors.background.secondary,borderRadius:o.shape.radius.default,marginBottom:"8px",pointerEvents:h?"none":"auto",[o.transitions.handleMotion("no-preference","reduce")]:{transition:o.transitions.create(["background-color","box-shadow","border-color","color"],{duration:o.transitions.duration.short})},...!g&&{"&:hover":{background:o.colors.emphasize(o.colors.background.secondary,.03),cursor:"pointer",zIndex:1},"&:focus":s.getFocusStyles(o)},...m&&{cursor:"pointer"},...l&&{outline:`solid 2px ${o.colors.primary.border}`}}),oldContainer:(0,n.css)({display:"flex",width:"100%",background:o.colors.background.secondary,borderRadius:o.shape.radius.default,position:"relative",pointerEvents:h?"none":"auto",marginBottom:o.spacing(1),[o.transitions.handleMotion("no-preference","reduce")]:{transition:o.transitions.create(["background-color","box-shadow","border-color","color"],{duration:o.transitions.duration.short})},...!g&&{"&:hover":{background:o.colors.emphasize(o.colors.background.secondary,.03),cursor:"pointer",zIndex:1},"&:focus":s.getFocusStyles(o)}})}}},3988:(G,O,e)=>{"use strict";e.d(O,{v:()=>u});var t=e(74848),n=e(32196),i=e(47078),s=e.n(i),r=e(48470),f=e(96540),a=e(40845),c=e(14578),o=e(29158),h=e(10354),g=e(67061),l=e(90182),p=e(58898),m=e(30958);const y=(0,n.css)({"&:focus":{outline:"none"}}),d=" / ";class v extends f.PureComponent{constructor(P){super(P),this.flattenOptions=(M,S=[])=>{let I=[];for(const T of M){const b=[...S];b.push(T),!T.items||T.items.length===0?I.push({singleLabel:b[b.length-1].label,label:b.map(R=>R.label).join(this.props.separator||d),value:b.map(R=>R.value)}):I=[...I,...this.flattenOptions(T.items,b)]}return I},this.getSearchableOptions=s()(M=>this.flattenOptions(M)),this.onChange=(M,S)=>{const I=this.props.hideActiveLevelLabel?"":this.props.displayAllSelectedLevels?S.map(b=>b.label).join(this.props.separator||d):S[S.length-1].label,T={rcValue:{value:M,label:I},focusCascade:!0,activeLabel:I,isSearching:!1,inputValue:I};this.setState(T),this.props.onSelect(S[S.length-1].value)},this.onSelect=M=>{const S=M.value||[],I=this.props.displayAllSelectedLevels?M.label:M.singleLabel||"",T={activeLabel:I,inputValue:I,rcValue:{value:S,label:I},isSearching:!1,focusCascade:!1};this.setState(T),this.props.onSelect(S[S.length-1])},this.onCreateOption=M=>{this.setState({activeLabel:M,inputValue:M,rcValue:[],isSearching:!1}),this.props.onSelect(M)},this.onBlur=()=>{this.setState({isSearching:!1,focusCascade:!1}),this.state.activeLabel===""&&this.setState({rcValue:[]}),this.props.onBlur?.()},this.onBlurCascade=()=>{this.setState({focusCascade:!1}),this.props.onBlur?.()},this.onInputKeyDown=M=>{if(["ArrowDown","ArrowUp","Enter","ArrowLeft","ArrowRight"].includes(M.key))return;const{activeLabel:S}=this.state;this.setState({focusCascade:!1,isSearching:!0,inputValue:S})},this.onSelectInputChange=M=>{this.setState({inputValue:M})};const x=this.getSearchableOptions(P.options),{rcValue:E,activeLabel:C}=this.setInitialValue(x,P.initialValue);this.state={isSearching:!1,focusCascade:!1,rcValue:E,activeLabel:C,inputValue:""}}static{this.defaultProps={changeOnSelect:!0}}setInitialValue(P,x){if(!x)return{rcValue:[],activeLabel:""};for(const E of P){const C=E.value||[];if(C[C.length-1]===x)return{rcValue:C,activeLabel:this.props.displayAllSelectedLevels?E.label:E.singleLabel||""}}return this.props.allowCustomValue?{rcValue:[],activeLabel:x}:{rcValue:[],activeLabel:""}}render(){const{allowCustomValue:P,formatCreateLabel:x,placeholder:E,width:C,changeOnSelect:M,options:S,disabled:I,id:T,isClearable:b,theme:R}=this.props,{focusCascade:A,isSearching:L,rcValue:U,activeLabel:W,inputValue:w}=this.state,N=this.getSearchableOptions(S),B=(0,m.T)(R);return(0,t.jsx)("div",{children:L?(0,t.jsx)(l.l6,{allowCustomValue:P,placeholder:E,autoFocus:!A,onChange:this.onSelect,onBlur:this.onBlur,options:N,onCreateOption:this.onCreateOption,formatCreateLabel:x,width:C,onInputChange:this.onSelectInputChange,disabled:I,inputValue:w,inputId:T}):(0,t.jsx)(r.A,{onChange:(0,p.k)(this.onChange),options:S,changeOnSelect:M,value:U.value,fieldNames:{label:"label",value:"value",children:"items"},expandIcon:null,open:this.props.alwaysOpen,disabled:I,dropdownClassName:B.dropdown,children:(0,t.jsx)("div",{className:y,children:(0,t.jsx)(h.p,{autoFocus:this.props.autoFocus,width:C,placeholder:E,onBlur:this.onBlurCascade,value:W,onKeyDown:this.onInputKeyDown,onChange:()=>{},suffix:(0,t.jsxs)(g.B,{gap:.5,children:[b&&W!==""&&(0,t.jsx)(o.K,{name:"times","aria-label":"Clear selection",onClick:V=>{V.preventDefault(),V.stopPropagation(),this.setState({rcValue:[],activeLabel:"",inputValue:""}),this.props.onSelect("")}}),(0,t.jsx)(c.I,{name:A?"angle-up":"angle-down"})]}),disabled:I,id:T})})})})}}const u=(0,a.cV)(v)},58898:(G,O,e)=>{"use strict";e.d(O,{W:()=>n,k:()=>t});const t=r=>(f,a)=>{r&&r(f.map(c=>String(c)),i(a))},n=r=>f=>{r&&r(i(f))},i=r=>r.map(s),s=r=>{const f=r.value?String(r.value):"";return{value:f,label:typeof r.label=="string"?r.label:f}}},30958:(G,O,e)=>{"use strict";e.d(O,{T:()=>f});var t=e(32196);const n=(0,t.keyframes)({"0%":{opacity:0,transformOrigin:"0% 0%",transform:"scaleY(0.8)"},"100%":{opacity:1,transformOrigin:"0% 0%",transform:"scaleY(1)"}}),i=(0,t.keyframes)({"0%":{opacity:1,transformOrigin:"0% 0%",transform:"scaleY(1)"},"100%":{opacity:0,transformOrigin:"0% 0%",transform:"scaleY(0.8)"}}),s=(0,t.keyframes)({"0%":{opacity:0,transformOrigin:"0% 100%",transform:"scaleY(0.8)"},"100%":{opacity:1,transformOrigin:"0% 100%",transform:"scaleY(1)"}}),r=(0,t.keyframes)({"0%":{opacity:1,transformOrigin:"0% 100%",transform:"scaleY(1)"},"100%":{opacity:0,transformOrigin:"0% 100%",transform:"scaleY(0.8)"}}),f=a=>({dropdown:(0,t.css)({"&.rc-cascader-dropdown":{position:"absolute",zIndex:9999,"&-hidden":{display:"none"}},".rc-cascader":{"&-menus":{overflow:"hidden",background:a.colors.background.canvas,border:`1px solid ${a.colors.border.weak}`,borderRadius:a.shape.radius.default,boxShadow:a.shadows.z3,whiteSpace:"nowrap","&.slide-up-enter, &.slide-up-appear":{animationDuration:"0.3s",animationFillMode:"both",transformOrigin:"0 0",opacity:0,animationTimingFunction:"cubic-bezier(0.08, 0.82, 0.17, 1)",animationPlayState:"paused"},"&.slide-up-enter.slide-up-enter-active.rc-cascader-menus-placement, &.slide-up-appear.slide-up-appear-active.rc-cascader-menus-placement":{"&-bottomLeft":{animationName:n,animationPlayState:"running"},"&-topLeft":{animationName:s,animationPlayState:"running"}},"&.slide-up-leave":{animationDuration:"0.3s",animationFillMode:"both",transformOrigin:"0 0",opacity:1,animationTimingFunction:"cubic-bezier(0.6, 0.04, 0.98, 0.34)",animationPlayState:"paused","&.slide-up-leave-active.rc-cascader-menus-placement":{"&-bottomLeft":{animationName:i,animationPlayState:"running"},"&-topLeft":{animationName:r,animationPlayState:"running"}}}},"&-menu":{display:"inline-block",maxWidth:"50vw",height:"192px",listStyle:"none",margin:0,padding:0,borderRight:`1px solid ${a.colors.border.weak}`,overflow:"auto","&:last-child":{borderRight:0},"&-item":{height:a.spacing(4),lineHeight:a.spacing(4),padding:a.spacing(0,4,0,2),cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",transition:"all 0.3s ease",position:"relative","&:hover":{background:a.colors.action.hover},"&-disabled":{cursor:"not-allowed",color:a.colors.text.disabled,"&:hover":{background:"transparent"},"&:after":{position:"absolute",right:"12px",content:"'loading'",color:a.colors.text.disabled,fontStyle:"italic"}},"&-active":{color:a.colors.text.maxContrast,background:a.colors.background.secondary,"&:hover":{background:a.colors.action.hover}},"&-expand":{position:"relative","&:after":{background:a.colors.background.secondary,content:"''",height:a.spacing(3),mask:"url(../img/icons/unicons/angle-right.svg)",maskType:"luminance",position:"absolute",right:0,top:a.spacing(.5),width:a.spacing(3)}}}}}})})},8866:(G,O,e)=>{"use strict";e.d(O,{N:()=>i});var t=e(74848),n=e(96540);class i extends n.PureComponent{constructor(){super(...arguments),this.myRef=(0,n.createRef)(),this.state={hasEventListener:!1},this.onOutsideClick=r=>{const f=this.myRef.current;(!f||r.target instanceof Node&&!f.contains(r.target))&&this.props.onClick()}}static{this.defaultProps={includeButtonPress:!0,parent:typeof window<"u"?window:void 0,useCapture:!1}}componentDidMount(){this.props.parent.addEventListener("click",this.onOutsideClick,this.props.useCapture),this.props.includeButtonPress&&this.props.parent.addEventListener("keyup",this.onOutsideClick,this.props.useCapture)}componentWillUnmount(){this.props.parent.removeEventListener("click",this.onOutsideClick,this.props.useCapture),this.props.includeButtonPress&&this.props.parent.removeEventListener("keyup",this.onOutsideClick,this.props.useCapture)}render(){return(0,t.jsx)("div",{ref:this.myRef,children:this.props.children})}}},10534:(G,O,e)=>{"use strict";e.d(O,{b:()=>h});var t=e(74848),n=e(32196),i=e(96540),s=e(76412),r=e(40845),f=e(55852),a=e(14578),c=e(32982);const o=2*1e3;function h({onClipboardCopy:p,onClipboardError:m,children:y,getText:d,icon:v,variant:u,...D}){const P=(0,r.of)(l),[x,E]=(0,i.useState)(!1);(0,i.useEffect)(()=>{let S;return x&&(S=setTimeout(()=>{E(!1)},o)),()=>{window.clearTimeout(S)}},[x]);const C=(0,i.useRef)(null),M=(0,i.useCallback)(async()=>{const S=d();try{await g(S,C),E(!0),p?.(S)}catch(I){m?.(S,I)}},[d,p,m]);return(0,t.jsxs)(t.Fragment,{children:[x&&(0,t.jsx)(c.r,{placement:"top",referenceElement:C.current,children:(0,t.jsx)(s.x,{i18nKey:"clipboard-button.inline-toast.success",children:"Copied"})}),(0,t.jsxs)(f.$n,{onClick:M,icon:v,variant:x?"success":u,"aria-label":x?"Copied":void 0,...D,className:(0,n.cx)(P.button,x&&P.successButton,D.className),ref:C,children:[y,x&&(0,t.jsx)("div",{className:P.successOverlay,children:(0,t.jsx)(a.I,{name:"check"})})]})]})}const g=async(p,m)=>{if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(p);{const y=document.createElement("textarea");m.current?.appendChild(y),y.value=p,y.focus(),y.select(),document.execCommand("copy"),y.remove()}},l=p=>({button:(0,n.css)({position:"relative"}),successButton:(0,n.css)({"> *":(0,n.css)({visibility:"hidden"})}),successOverlay:(0,n.css)({position:"absolute",top:0,bottom:0,right:0,left:0,visibility:"visible"})})},57418:(G,O,e)=>{"use strict";e.d(O,{M:()=>h});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(96540),f=e(40845),a=e(16797),c=e(14578),o=e(62930);const h=({label:l,isOpen:p,onToggle:m,className:y,contentClassName:d,children:v,labelId:u,loading:D=!1,headerDataTestId:P,contentDataTestId:x})=>{const[E,C]=(0,r.useState)(p),M=(0,f.of)(g),S=b=>{b.target instanceof HTMLElement&&b.target.tagName==="A"||(b.preventDefault(),b.stopPropagation(),m?.(!E),C(!E))},{current:I}=(0,r.useRef)((0,i.uniqueId)()),T=u??`collapse-label-${I}`;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{onClick:S,className:(0,n.cx)(M.header,y),children:[(0,t.jsx)("button",{type:"button",id:`collapse-button-${I}`,className:M.button,onClick:S,"aria-expanded":E&&!D,"aria-controls":`collapse-content-${I}`,"aria-labelledby":T,children:D?(0,t.jsx)(o.y,{className:M.spinner}):(0,t.jsx)(c.I,{name:E?"angle-up":"angle-down",className:M.icon})}),(0,t.jsx)("div",{className:M.label,id:`collapse-label-${I}`,"data-testid":P,children:l})]}),E&&(0,t.jsx)("div",{id:`collapse-content-${I}`,className:(0,n.cx)(M.content,d),"data-testid":x,children:v})]})},g=l=>({header:(0,n.css)({display:"flex",cursor:"pointer",boxSizing:"border-box",flexDirection:"row-reverse",position:"relative",justifyContent:"space-between",fontSize:l.typography.size.lg,padding:`${l.spacing(.5)} 0`,"&:focus-within":(0,a.getFocusStyles)(l)}),button:(0,n.css)({all:"unset","&:focus-visible":{outline:"none",outlineOffset:"unset",transition:"none",boxShadow:"none"}}),icon:(0,n.css)({color:l.colors.text.secondary}),content:(0,n.css)({padding:`${l.spacing(2)} 0`}),spinner:(0,n.css)({display:"flex",alignItems:"center",width:l.spacing(2)}),label:(0,n.css)({display:"flex"})})},82762:(G,O,e)=>{"use strict";e.d(O,{S:()=>o,a:()=>c});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(55852),f=e(14578);const a=h=>({collapse:(0,n.css)({label:"collapse",marginBottom:h.spacing(1),backgroundColor:h.colors.background.primary,border:`1px solid ${h.colors.border.weak}`,position:"relative",borderRadius:h.shape.radius.default,width:"100%",display:"flex",flexDirection:"column",flex:"1 1 0"}),collapseBody:(0,n.css)({label:"collapse__body",padding:h.spacing(h.components.panel.padding),paddingTop:0,flex:1,overflow:"hidden",display:"flex",flexDirection:"column"}),bodyContentWrapper:(0,n.css)({label:"bodyContentWrapper",flex:1,overflow:"hidden"}),loader:(0,n.css)({label:"collapse__loader",height:"2px",position:"relative",overflow:"hidden",background:"none",margin:h.spacing(.5)}),loaderActive:(0,n.css)({label:"collapse__loader_active","&:after":{content:"' '",display:"block",width:"25%",top:0,height:"250%",position:"absolute",animation:"loader 2s cubic-bezier(0.17, 0.67, 0.83, 0.67) 500ms",animationIterationCount:100,left:"-25%",background:h.colors.primary.main},"@keyframes loader":{from:{left:"-25%",opacity:.1},to:{left:"100%",opacity:1}}}),header:(0,n.css)({label:"collapse__header",padding:h.spacing(1,2,1,2),display:"flex"}),headerCollapsed:(0,n.css)({label:"collapse__header--collapsed",padding:h.spacing(1,2,1,2)}),headerLabel:(0,n.css)({label:"collapse__header-label",fontWeight:h.typography.fontWeightMedium,marginRight:h.spacing(1),fontSize:h.typography.size.md,display:"flex",flex:"0 0 100%"}),icon:(0,n.css)({label:"collapse__icon",margin:h.spacing(.25,1,0,-1)})}),c=({isOpen:h,onToggle:g,...l})=>{const[p,m]=(0,i.useState)(h);return(0,t.jsx)(o,{isOpen:p,collapsible:!0,...l,onToggle:()=>{m(!p),g&&g(!p)}})},o=({isOpen:h,label:g,loading:l,collapsible:p,onToggle:m,className:y,children:d})=>{const v=(0,s.of)(r.my),u=(0,s.of)(a),D=()=>{m&&m(!h)},P=(0,n.cx)([u.collapse,y]),x=l?(0,n.cx)([u.loader,u.loaderActive]):(0,n.cx)([u.loader]),E=p?(0,n.cx)([u.header]):(0,n.cx)([u.headerCollapsed]);return(0,t.jsxs)("div",{className:P,children:[(0,t.jsxs)("button",{type:"button",className:(0,n.cx)(v,E),onClick:D,children:[p&&(0,t.jsx)(f.I,{className:u.icon,name:h?"angle-down":"angle-right"}),(0,t.jsx)("div",{className:(0,n.cx)([u.headerLabel]),children:g})]}),h&&(0,t.jsxs)("div",{className:(0,n.cx)([u.collapseBody]),children:[(0,t.jsx)("div",{className:x}),(0,t.jsx)("div",{className:u.bodyContentWrapper,children:d})]})]})};o.displayName="Collapse"},36314:(G,O,e)=>{"use strict";e.d(O,{A:()=>h});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(96540),f=e(84140),a=e(40845),c=e(10354);const o=(0,r.forwardRef)(({color:p,onChange:m,isClearable:y=!1,onClick:d,onBlur:v,disabled:u,buttonAriaLabel:D,...P},x)=>{const[E,C]=(0,r.useState)(p),[M,S]=(0,r.useState)(p),I=(0,r.useMemo)(()=>(0,i.debounce)(m,100),[]);(0,r.useEffect)(()=>{const R=(0,f.A)(p);R.isValid()&&p!==M&&(C(R.toString()),S(p))},[p,M]);const T=R=>{const{value:A}=R.currentTarget;if(C(A),A===""&&y){I(A);return}const L=(0,f.A)(A);L.isValid()&&I(L.toString())},b=R=>{(0,f.A)(E).isValid()||C(p),v?.(R)};return(0,t.jsx)(c.p,{...P,value:E,onChange:T,disabled:u,onClick:d,onBlur:b,addonBefore:(0,t.jsx)(g,{onClick:d,ariaLabel:D,disabled:u,color:p}),ref:x})});o.displayName="ColorInput";const h=o,g=({color:p,onClick:m,disabled:y,ariaLabel:d})=>{const v=(0,a.of)(l);return(0,t.jsx)("button",{type:"button",onClick:m,"aria-label":d,disabled:y||!m,className:(0,n.cx)(v,(0,n.css)({backgroundColor:p}))})},l=p=>(0,n.css)({height:"100%",width:`${p.spacing.gridSize*4}px`,borderRadius:`${p.shape.radius.default} 0 0 ${p.shape.radius.default}`,border:`1px solid ${p.colors.border.medium}`})},83598:(G,O,e)=>{"use strict";e.d(O,{Dp:()=>m,sk:()=>p});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(3911),f=e(40321),a=e(13840),c=e(95868),o=e(70045),h=e(83876),g=e(70104);const l=(d,v="ColorPicker")=>class extends i.Component{constructor(){super(...arguments),this.pickerTriggerRef=(0,i.createRef)()}static{this.displayName=v}render(){const{theme:D,children:P,onChange:x,color:E}=this.props,C=y(D),M=i.createElement(d,{...this.props,children:null,onChange:x});return(0,t.jsx)(c.I,{content:M,hideAfter:300,children:(S,I,T)=>(0,t.jsxs)(t.Fragment,{children:[this.pickerTriggerRef.current&&(0,t.jsx)(a.A,{...T,referenceElement:this.pickerTriggerRef.current,wrapperClassName:C.colorPicker,onMouseLeave:I,onMouseEnter:S,onKeyDown:b=>(0,f.Q)(b,I)}),P?P({ref:this.pickerTriggerRef,showColorPicker:S,hideColorPicker:I}):(0,t.jsx)(h.q,{ref:this.pickerTriggerRef,onClick:S,onMouseLeave:I,color:D.visualization.getColorByName(E||"#000000"),"aria-label":E})]})})}},p=(0,s.cV)(l(o.$,"ColorPicker")),m=(0,s.cV)(l(g.o,"SeriesColorPicker")),y=(0,r.N)(d=>({colorPicker:(0,n.css)({position:"absolute",zIndex:d.zIndex.tooltip,color:d.colors.text.primary,maxWidth:"400px",fontSize:d.typography.size.sm})}))},99128:(G,O,e)=>{"use strict";e.d(O,{i:()=>g});var t=e(74848),n=e(32196),i=e(96540),s=e(7612),r=e(65229),f=e(23596),a=e(40845),c=e(8866),o=e(36314),h=e(95151);const g=(0,i.forwardRef)(({value:p="",onChange:m,returnColorAs:y="rgb",...d},v)=>{const[u,D]=(0,i.useState)(p),[P,x]=(0,i.useState)(!1),E=(0,a.$j)(),C=(0,a.of)(l),M=(0,a.of)(h.$);return(0,r.A)(S=>{if(S===p)return;if(!S){m("");return}const I=E.visualization.getColorByName(S);m(y==="rgb"?f.MV.asRgbString(I):f.MV.asHexString(I))},500,[u]),(0,t.jsx)(c.N,{onClick:()=>x(!1),children:(0,t.jsxs)("div",{className:C.wrapper,children:[P&&!d.disabled&&(0,t.jsx)(s.p9,{"data-testid":"color-popover",color:u,onChange:D,className:(0,n.cx)(M.root,C.picker)}),(0,t.jsx)(o.A,{...d,theme:E,color:u,onChange:D,buttonAriaLabel:"Open color picker",onClick:()=>x(!0),onBlur:()=>x(!1),ref:v,isClearable:!0})]})})});g.displayName="ColorPickerInput";const l=p=>({wrapper:(0,n.css)({position:"relative"}),picker:(0,n.css)({"&.react-colorful":{position:"absolute",width:"100%",zIndex:11,bottom:"36px"}}),inner:(0,n.css)({position:"absolute"})})},70045:(G,O,e)=>{"use strict";e.d(O,{$:()=>u});var t=e(74848),n=e(32196),i=e(85690),s=e(96540),r=e(23596),f=e(40845),a=e(3911),c=e(83876),o=e(2543);function h(P,x){const E=new Array(P.length);for(let C=0;C<P.length;C++){const M=P.length-1-C;E[C]=x(P[M],M,P)}return E}const l=({hue:P,selectedColor:x,onColorSelect:E,...C})=>{const M=(0,o.upperFirst)(P.name),S=(0,f.of)(p);return(0,t.jsxs)("div",{className:S.colorRow,children:[(0,t.jsx)("div",{className:S.colorLabel,children:M}),(0,t.jsx)("div",{...C,className:S.swatchRow,children:h(P.shades,I=>(0,t.jsx)(c.q,{"aria-label":I.name,variant:I.primary?c.h.Large:c.h.Small,isSelected:I.name===x,color:I.color,onClick:()=>E(I.name)},I.name))})]})},p=P=>({colorRow:(0,n.css)({display:"grid",gridTemplateColumns:"25% 1fr",gridColumnGap:P.spacing(2),padding:P.spacing(.5,0),"&:hover":{background:P.colors.background.secondary}}),colorLabel:(0,n.css)({paddingLeft:P.spacing(2),display:"flex",alignItems:"center"}),swatchRow:(0,n.css)({display:"flex",gap:P.spacing(1),alignItems:"center",justifyContent:"space-around",flexDirection:"row"})}),m=({color:P,onChange:x})=>{const E=(0,f.$j)(),C=(0,f.of)(y),M=[];for(const S of E.visualization.hues)M.push((0,t.jsx)(l,{selectedColor:P,hue:S,onColorSelect:x},S.name));return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:C.swatches,children:M}),(0,t.jsxs)("div",{className:C.extraColors,children:[(0,t.jsx)(c.q,{isSelected:P==="transparent",color:"rgba(0,0,0,0)",label:"Transparent",onClick:()=>x("transparent")}),(0,t.jsx)(c.q,{isSelected:P==="text",color:E.colors.text.primary,label:"Text color",onClick:()=>x("text")})]})]})},y=P=>({container:(0,n.css)({display:"flex",flexDirection:"column"}),extraColors:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"space-around",gap:P.spacing(1),padding:P.spacing(1,0)}),swatches:(0,n.css)({display:"grid",flexGrow:1})});var d=e(95151);class v extends s.Component{constructor(x){super(x),this.getTabClassName=E=>{const{activePicker:C}=this.state;return`ColorPickerPopover__tab ${C===E&&"ColorPickerPopover__tab--active"}`},this.handleChange=E=>{const{onChange:C,enableNamedColors:M,theme:S}=this.props;if(M)return C(E);C(r.MV.asHexString(S.visualization.getColorByName(E)))},this.onTabChange=E=>()=>this.setState({activePicker:E}),this.renderPicker=()=>{const{activePicker:E}=this.state,{color:C}=this.props;switch(E){case"spectrum":return(0,t.jsx)(d.A,{color:C,onChange:this.handleChange});case"palette":return(0,t.jsx)(m,{color:C,onChange:this.handleChange});default:return this.renderCustomPicker(E)}},this.renderCustomPicker=E=>{const{customPickers:C,color:M,theme:S}=this.props;return C?s.createElement(C[E].tabComponent,{color:M,theme:S,onChange:this.handleChange}):null},this.renderCustomPickerTabs=()=>{const{customPickers:E}=this.props;return E?(0,t.jsx)(t.Fragment,{children:Object.keys(E).map(C=>(0,t.jsx)("button",{className:this.getTabClassName(C),onClick:this.onTabChange(C),type:"button",children:E[C].name},C))}):null},this.state={activePicker:"palette"}}render(){const{theme:x}=this.props,E=D(x);return(0,t.jsx)(i.n1,{contain:!0,restoreFocus:!0,autoFocus:!0,children:(0,t.jsxs)("div",{tabIndex:-1,className:E.colorPickerPopover,children:[(0,t.jsxs)("div",{className:E.colorPickerPopoverTabs,children:[(0,t.jsx)("button",{className:this.getTabClassName("palette"),onClick:this.onTabChange("palette"),type:"button",children:"Colors"}),(0,t.jsx)("button",{className:this.getTabClassName("spectrum"),onClick:this.onTabChange("spectrum"),type:"button",children:"Custom"}),this.renderCustomPickerTabs()]}),(0,t.jsx)("div",{className:E.colorPickerPopoverContent,children:this.renderPicker()})]})})}}const u=(0,f.cV)(v);u.displayName="ColorPickerPopover";const D=(0,a.N)(P=>({colorPickerPopover:(0,n.css)({borderRadius:P.shape.radius.default,boxShadow:P.shadows.z3,background:P.colors.background.primary,border:`1px solid ${P.colors.border.weak}`,".ColorPickerPopover__tab":{width:"50%",textAlign:"center",padding:P.spacing(1,0),background:P.colors.background.secondary,color:P.colors.text.secondary,fontSize:P.typography.bodySmall.fontSize,cursor:"pointer",border:"none","&:focus:not(:focus-visible)":{outline:"none",boxShadow:"none"},":focus-visible":{position:"relative"}},".ColorPickerPopover__tab--active":{color:P.colors.text.primary,fontWeight:P.typography.fontWeightMedium,background:P.colors.background.primary}}),colorPickerPopoverContent:(0,n.css)({width:"246px",fontSize:P.typography.bodySmall.fontSize,minHeight:"184px",padding:P.spacing(1),display:"flex",flexDirection:"column"}),colorPickerPopoverTabs:(0,n.css)({display:"flex",width:"100%",borderRadius:`${P.shape.radius.default} ${P.shape.radius.default} 0 0`})}))},83876:(G,O,e)=>{"use strict";e.d(O,{h:()=>c,q:()=>o});var t=e(74848),n=e(32196),i=e(95382),s=e(96540),r=e(84140),f=e(13544),a=e(40845),c=(g=>(g.Small="small",g.Large="large",g))(c||{});const o=s.forwardRef(({color:g,label:l,variant:p="small",isSelected:m,"aria-label":y,...d},v)=>{const u=(0,a.$j)(),{isFocusVisible:D,focusProps:P}=(0,i.o)(),x=h(u,p,g,D,m),E=!!l,C=y||l;return(0,t.jsxs)("div",{ref:v,className:x.wrapper,"data-testid":f.Tp.components.ColorSwatch.name,...d,children:[E&&(0,t.jsx)("span",{className:x.label,children:l}),(0,t.jsx)("button",{className:x.swatch,...P,"aria-label":C?`${C} color`:"Pick a color",type:"button"})]})}),h=(g,l,p,m,y)=>{const d=(0,r.A)(p),u=l==="small"?"16px":"32px";let D="none";return d.getAlpha()<.1&&(D=`2px solid ${g.colors.border.medium}`),{wrapper:(0,n.css)({display:"flex",alignItems:"center",cursor:"pointer"}),label:(0,n.css)({marginRight:g.spacing(1)}),swatch:(0,n.css)({width:u,height:u,background:`${p}`,border:D,borderRadius:g.shape.radius.circle,outlineOffset:"1px",outline:m?`2px solid  ${g.colors.primary.main}`:"none",boxShadow:y?`inset 0 0 0 2px ${p}, inset 0 0 0 4px ${g.colors.getContrastText(p)}`:"none",[g.transitions.handleMotion("no-preference")]:{transition:g.transitions.create(["transform"],{duration:g.transitions.duration.short})},"&:hover":{transform:"scale(1.1)"},"@media (forced-colors: active)":{forcedColorAdjust:"none"}})}};o.displayName="ColorSwatch"},70104:(G,O,e)=>{"use strict";e.d(O,{o:()=>f,t:()=>a});var t=e(74848),n=e(40845),i=e(14186),s=e(15292),r=e(70045);const f=c=>{const{yaxis:o,onToggleAxis:h,color:g,...l}=c,p=h?{yaxis:{name:"Y-Axis",tabComponent(){return(0,t.jsx)(i.I,{labelWidth:20,label:"Use right y-axis",children:(0,t.jsx)(s.K,{value:o===2,label:"Use right y-axis",onChange:h})})}}}:void 0;return(0,t.jsx)(r.$,{...l,color:g||"#000000",customPickers:p})},a=(0,n.cV)(f)},95151:(G,O,e)=>{"use strict";e.d(O,{$:()=>g,A:()=>l});var t=e(74848),n=e(32196),i=e(96540),s=e(7612),r=e(65229),f=e(84140),a=e(23596),c=e(40845),o=e(36314);const h=({color:p,onChange:m})=>{const[y,d]=(0,i.useState)(p);(0,r.A)(P=>{m(a.MV.asHexString(v.visualization.getColorByName(P)))},500,[y]);const v=(0,c.$j)(),u=(0,c.of)(g),D=(0,i.useMemo)(()=>y.startsWith("rgba")?y:(0,f.A)(v.visualization.getColorByName(p)).toRgbString(),[y,v,p]);return(0,t.jsxs)("div",{className:u.wrapper,children:[(0,t.jsx)(s.p9,{className:u.root,color:D,onChange:d}),(0,t.jsx)(o.A,{theme:v,color:D,onChange:d,className:u.colorInput})]})},g=p=>({wrapper:(0,n.css)({flexGrow:1}),root:(0,n.css)({"&.react-colorful":{width:"auto"},".react-colorful":{"&__saturation":{borderRadius:`${p.shape.radius.default} ${p.shape.radius.default} 0 0`},"&__alpha":{borderRadius:`0 0 ${p.shape.radius.default} ${p.shape.radius.default}`},"&__alpha, &__hue":{height:p.spacing(2),position:"relative"},"&__pointer":{height:p.spacing(2),width:p.spacing(2)}}}),colorInput:(0,n.css)({marginTop:p.spacing(2)})}),l=h},82702:(G,O,e)=>{"use strict";e.d(O,{Z:()=>f});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(55852);const f=({children:c,className:o,closeOnConfirm:h,confirmText:g="Save",confirmVariant:l="primary",disabled:p=!1,onCancel:m,onClick:y,onConfirm:d,size:v="md"})=>{const u=(0,i.useRef)(null),D=(0,i.useRef)(null),[P,x]=(0,i.useState)(!1),[E,C]=(0,i.useState)(!1),M=(0,s.of)(a);(0,i.useEffect)(()=>{P?(D.current?.focus(),C(!0)):E&&(u.current?.focus(),C(!1))},[E,P]);const S=L=>{L&&L.preventDefault(),x(!0),y?.()},I=L=>{L&&L.preventDefault(),x(!1),u.current?.focus(),m?.()},T=L=>{L&&L.preventDefault(),d?.(),h&&x(!1)},b=(0,n.cx)(o,M.mainButton,{[M.mainButtonHide]:P}),R=(0,n.cx)(M.confirmButton,{[M.confirmButtonHide]:!P}),A=(0,n.cx)(M.confirmButtonContainer,{[M.confirmButtonContainerHide]:!P});return(0,t.jsxs)("div",{className:M.container,children:[(0,t.jsx)("span",{className:b,children:typeof c=="string"?(0,t.jsx)(r.$n,{disabled:p,size:v,fill:"text",onClick:S,ref:u,children:c}):i.cloneElement(c,{disabled:p,onClick:S,ref:u})}),(0,t.jsx)("div",{className:A,children:(0,t.jsxs)("span",{className:R,children:[(0,t.jsx)(r.$n,{size:v,variant:l,onClick:T,ref:D,children:g}),(0,t.jsx)(r.$n,{size:v,fill:"text",onClick:I,children:"Cancel"})]})})]})};f.displayName="ConfirmButton";const a=c=>({container:(0,n.css)({alignItems:"center",display:"flex",justifyContent:"flex-end",position:"relative"}),mainButton:(0,n.css)({opacity:1,[c.transitions.handleMotion("no-preference")]:{transition:c.transitions.create(["opacity"],{duration:c.transitions.duration.shortest,easing:c.transitions.easing.easeOut})},zIndex:2}),mainButtonHide:(0,n.css)({opacity:0,[c.transitions.handleMotion("no-preference")]:{transition:c.transitions.create(["opacity","visibility"],{duration:c.transitions.duration.shortest,easing:c.transitions.easing.easeIn})},visibility:"hidden",zIndex:0}),confirmButtonContainer:(0,n.css)({overflow:"visible",position:"absolute",pointerEvents:"all",right:0}),confirmButtonContainerHide:(0,n.css)({overflow:"hidden",pointerEvents:"none"}),confirmButton:(0,n.css)({alignItems:"flex-start",background:c.colors.background.primary,display:"flex",opacity:1,transform:"translateX(0)",[c.transitions.handleMotion("no-preference")]:{transition:c.transitions.create(["opacity","transform"],{duration:c.transitions.duration.shortest,easing:c.transitions.easing.easeOut})},zIndex:1}),confirmButtonHide:(0,n.css)({opacity:0,transform:"translateX(100%)",[c.transitions.handleMotion("no-preference")]:{transition:c.transitions.create(["opacity","transform","visibility"],{duration:c.transitions.duration.shortest,easing:c.transitions.easing.easeIn})},visibility:"hidden"})})},91605:(G,O,e)=>{"use strict";e.d(O,{e:()=>s});var t=e(74848),n=e(55852),i=e(82702);const s=({size:r,disabled:f,onConfirm:a,"aria-label":c,closeOnConfirm:o})=>(0,t.jsx)(i.Z,{confirmText:"Delete",confirmVariant:"destructive",size:r||"md",disabled:f,onConfirm:a,closeOnConfirm:o,children:(0,t.jsx)(n.$n,{"aria-label":c,variant:"destructive",icon:"times",size:r||"sm"})})},45014:(G,O,e)=>{"use strict";e.d(O,{k:()=>g});var t=e(74848),n=e(32196),i=e(96540),s=e(49785),r=e(13544),f=e(40845),a=e(55852),c=e(88575),o=e(10354),h=e(67061);const g=({body:p,confirmPromptText:m,confirmButtonLabel:y,confirmButtonVariant:d,dismissButtonVariant:v,dismissButtonLabel:u,onConfirm:D,onDismiss:P,onAlternative:x,alternativeButtonLabel:E,description:C,justifyButtons:M="flex-end",disabled:S})=>{const[I,T]=(0,i.useState)(S),b=(0,f.of)(l),R=(0,i.useRef)(null),A=W=>{T(m?.toLowerCase().localeCompare(W.currentTarget.value.toLowerCase())!==0)};(0,i.useEffect)(()=>{R.current?.focus()},[]),(0,i.useEffect)(()=>{T(S?!0:!!m)},[m,S]);const L=async()=>{T(!0);try{await D()}finally{T(!1)}},{handleSubmit:U}=(0,s.mN)();return(0,t.jsxs)("form",{onSubmit:U(L),children:[(0,t.jsxs)("div",{className:b.text,children:[p,C?(0,t.jsx)("div",{className:b.description,children:C}):null,m?(0,t.jsx)("div",{className:b.confirmationInput,children:(0,t.jsx)(h.B,{alignItems:"flex-start",children:(0,t.jsx)(c.D,{disabled:S,children:(0,t.jsx)(o.p,{placeholder:`Type "${m}" to confirm`,onChange:A})})})}):null]}),(0,t.jsx)("div",{className:b.buttonsContainer,children:(0,t.jsxs)(h.B,{justifyContent:M,gap:2,wrap:"wrap",children:[(0,t.jsx)(a.$n,{variant:v,onClick:P,fill:"outline",children:u}),(0,t.jsx)(a.$n,{type:"submit",variant:d,disabled:I,ref:R,"data-testid":r.Tp.pages.ConfirmModal.delete,children:y}),x?(0,t.jsx)(a.$n,{variant:"primary",onClick:x,children:E}):null]})})]})},l=p=>({text:(0,n.css)({fontSize:p.typography.h5.fontSize,color:p.colors.text.primary}),description:(0,n.css)({fontSize:p.typography.body.fontSize}),confirmationInput:(0,n.css)({paddingTop:p.spacing(1)}),buttonsContainer:(0,n.css)({paddingTop:p.spacing(3)})})},96374:(G,O,e)=>{"use strict";e.d(O,{u:()=>f});var t=e(74848),n=e(32196),i=e(40845),s=e(37390),r=e(45014);const f=({isOpen:c,title:o,body:h,description:g,confirmText:l,confirmVariant:p="destructive",confirmationText:m,dismissText:y="Cancel",dismissVariant:d="secondary",alternativeText:v,modalClass:u,icon:D="exclamation-triangle",onConfirm:P,onDismiss:x,onAlternative:E,confirmButtonVariant:C="destructive",disabled:M})=>{const S=(0,i.of)(a);return(0,t.jsx)(s.a,{className:(0,n.cx)(S.modal,u),title:o,icon:D,isOpen:c,onDismiss:x,children:(0,t.jsx)(r.k,{body:h,description:g,confirmButtonLabel:l,dismissButtonLabel:y,dismissButtonVariant:d,confirmPromptText:m,alternativeButtonLabel:v,confirmButtonVariant:C,onConfirm:P,onDismiss:x,onAlternative:E,disabled:M})})},a=()=>({modal:(0,n.css)({width:"500px"})})},28122:(G,O,e)=>{"use strict";e.d(O,{t:()=>a});var t=e(74848),n=e(96540),i=e(29647),s=e(13544),r=e(38138),f=e(17464);const a=n.memo(({x:c,y:o,onClose:h,focusOnOpen:g=!0,renderMenuItems:l,renderHeader:p})=>{const m=(0,n.useRef)(null),[y,d]=(0,n.useState)({});(0,n.useLayoutEffect)(()=>{const x=m.current;if(x){const E=x.getBoundingClientRect(),C=5,M={right:window.innerWidth<c+E.width,bottom:window.innerHeight<o+E.height+C};d({position:"fixed",left:M.right?c-E.width-C:c-C,top:Math.max(0,M.bottom?o-E.height-C:o+C)})}},[c,o]),(0,i.A)(m,()=>{h?.()});const v=p?.(),u=l?.(),D=x=>{g&&x(0)},P=x=>{x.key==="Escape"&&(x.preventDefault(),x.stopPropagation(),h?.())};return(0,t.jsx)(f.ZL,{children:(0,t.jsx)(r.W,{header:v,ref:m,style:y,ariaLabel:s.Tp.components.Menu.MenuComponent("Context"),onOpen:D,onClick:h,onKeyDown:P,children:u})})});a.displayName="ContextMenu"},51686:(G,O,e)=>{"use strict";e.d(O,{n:()=>s});var t=e(74848),n=e(96540),i=e(28122);const s=({children:r,renderMenuItems:f,focusOnOpen:a=!0})=>{const[c,o]=(0,n.useState)(!1),[h,g]=(0,n.useState)({x:0,y:0});return(0,t.jsxs)(t.Fragment,{children:[r({openMenu:l=>{o(!0),g({x:l.pageX,y:l.pageY})}}),c&&(0,t.jsx)(i.t,{onClose:()=>o(!1),x:h.x,y:h.y,renderMenuItems:f,focusOnOpen:a})]})}},40276:(G,O,e)=>{"use strict";e.d(O,{E:()=>c,A:()=>o});var t=e(74848),n=e(32196),i=e(96540),s=e(62295),r=e(40845);const f=({children:l})=>{const[p,m]=(0,i.useState)(!1),[y,d]=(0,i.useState)(!1),v=(0,i.useRef)(null),u=(0,i.useRef)(null),D=(0,r.of)(a);return(0,i.useEffect)(()=>{const P=new IntersectionObserver(x=>{x.forEach(E=>{E.target===v.current?m(!E.isIntersecting):E.target===u.current&&d(!E.isIntersecting)})});return[v,u].forEach(x=>{x.current&&P.observe(x.current)}),()=>P.disconnect()},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:(0,n.cx)(D.scrollIndicator,D.scrollTopIndicator,{[D.scrollIndicatorVisible]:p})}),(0,t.jsxs)("div",{className:D.scrollContent,children:[(0,t.jsx)("div",{ref:v}),l,(0,t.jsx)("div",{ref:u})]}),(0,t.jsx)("div",{className:(0,n.cx)(D.scrollIndicator,D.scrollBottomIndicator,{[D.scrollIndicatorVisible]:y})})]})},a=l=>({scrollContent:(0,n.css)({flex:1,position:"relative"}),scrollIndicator:(0,n.css)({height:l.spacing(6),left:0,opacity:0,pointerEvents:"none",position:"absolute",right:0,[l.transitions.handleMotion("no-preference","reduce")]:{transition:l.transitions.create("opacity")},zIndex:1}),scrollTopIndicator:(0,n.css)({background:`linear-gradient(0deg, transparent, ${l.colors.background.canvas})`,top:0}),scrollBottomIndicator:(0,n.css)({background:`linear-gradient(180deg, transparent, ${l.colors.background.canvas})`,bottom:0}),scrollIndicatorVisible:(0,n.css)({opacity:1})}),c=({autoHide:l=!1,autoHideTimeout:p=200,setScrollTop:m,className:y,testId:d,autoHeightMin:v="0",autoHeightMax:u="100%",hideTracksWhenNotNeeded:D=!1,hideHorizontalTrack:P,hideVerticalTrack:x,scrollRefCallback:E,showScrollIndicators:C=!1,updateAfterMountMs:M,scrollTop:S,onScroll:I,children:T,divId:b})=>{const R=(0,i.useRef)(null),A=(0,r.of)(h);(0,i.useEffect)(()=>{R.current&&E&&E(R.current.view)},[R,E]),g(R.current,S),(0,i.useEffect)(()=>{M&&setTimeout(()=>{const K=R.current;K?.update&&K.update()},M)},[M]);function L(K,H,X){return X.style&&H&&(X.style.display="none"),(0,t.jsx)("div",{...X,className:K})}const U=(0,i.useCallback)(K=>L("track-horizontal",P,K),[P]),W=(0,i.useCallback)(K=>L("track-vertical",x,K),[x]),w=(0,i.useCallback)(K=>(0,t.jsx)("div",{...K,className:"thumb-horizontal"}),[]),N=(0,i.useCallback)(K=>(0,t.jsx)("div",{...K,className:"thumb-vertical"}),[]),B=(0,i.useCallback)(K=>(K.style&&K.style.WebkitOverflowScrolling==="touch"&&(K.style.WebkitOverflowScrolling="auto"),(0,t.jsx)("div",{...K,className:"scrollbar-view",id:b})),[b]),V=(0,i.useCallback)(()=>{R.current&&m&&m(R.current.getValues())},[m]);return(0,t.jsx)(s.Ay,{"data-testid":d,ref:R,className:(0,n.cx)(A.customScrollbar,y,{[A.scrollbarWithScrollIndicators]:C}),onScrollStop:V,autoHeight:!0,autoHide:l,autoHideTimeout:p,hideTracksWhenNotNeeded:D,autoHeightMax:u,autoHeightMin:v,renderTrackHorizontal:U,renderTrackVertical:W,renderThumbHorizontal:w,renderThumbVertical:N,renderView:B,onScroll:I,children:C?(0,t.jsx)(f,{children:T}):T})},o=c,h=l=>({customScrollbar:(0,n.css)({display:"flex",flexGrow:1,".scrollbar-view":{display:"flex",flexGrow:1,flexDirection:"column"},".track-vertical":{borderRadius:l.shape.borderRadius(2),width:`${l.spacing(1)} !important`,right:0,bottom:l.spacing(.25),top:l.spacing(.25)},".track-horizontal":{borderRadius:l.shape.borderRadius(2),height:`${l.spacing(1)} !important`,right:l.spacing(.25),bottom:l.spacing(.25),left:l.spacing(.25)},".thumb-vertical":{background:l.colors.action.focus,borderRadius:l.shape.borderRadius(2),opacity:0},".thumb-horizontal":{background:l.colors.action.focus,borderRadius:l.shape.borderRadius(2),opacity:0},"&:hover":{".thumb-vertical, .thumb-horizontal":{opacity:1,transition:"opacity 0.3s ease-in-out"}}}),scrollbarWithScrollIndicators:(0,n.css)({".scrollbar-view":{position:"static !important"}})});function g(l,p){(0,i.useEffect)(()=>{l&&p!=null&&l.scrollTop(p)},[p,l])}},14689:(G,O,e)=>{"use strict";e.d(O,{R:()=>i});var t=e(74848),n=e(55852);function i({link:s,buttonProps:r}){return(0,t.jsx)("a",{href:s.href,target:s.target,rel:"noreferrer",onClick:s.onClick?f=>{!(f.ctrlKey||f.metaKey||f.shiftKey)&&s.onClick&&(f.preventDefault(),s.onClick(f))}:void 0,children:(0,t.jsx)(n.$n,{icon:s.target==="_blank"?"external-link-alt":void 0,variant:"primary",size:"sm",...r,children:s.title})})}},64078:(G,O,e)=>{"use strict";e.d(O,{l:()=>I});var t=e(74848),n=e(32196),i=e(34743),s=e(36376),r=e(7315),f=e(28848),a=e.n(f),c=e(96540),o=e(80292),h=e(52845),g=e(29317),l=e(91890),p=e(6709),m=e(41781),y=e(40845),d=e(72307),v=e(40276),u=e(10354),D=e(17464),P=e(43538);class x{getBoundingClientRect(){const R=window.getSelection(),A=R&&R.anchorNode;return A&&A.parentElement?A.parentElement.getBoundingClientRect():{top:0,left:0,bottom:0,right:0,width:0,height:0,x:0,y:0,toJSON:()=>{}}}get clientWidth(){return this.getBoundingClientRect().width}get clientHeight(){return this.getBoundingClientRect().height}}const E=(b,R)=>b-R*Math.floor(b/R),C={builtInVariable:{pattern:/(\${\S+?})/}},M=[(0,m.D)({onlyIn:b=>"type"in b&&b.type==="code_block",getSyntax:()=>"links"},{...a().languages,links:C})],S=b=>({input:(0,u.n)({theme:b,invalid:!1}).input,editor:(0,n.css)({".token.builtInVariable":{color:b.colors.success.text},".token.variable":{color:b.colors.primary.text}}),suggestionsWrapper:(0,n.css)({boxShadow:b.shadows.z2}),wrapperOverrides:(0,n.css)({width:"100%","> .slate-query-field__wrapper":{padding:0,backgroundColor:"transparent",border:"none"}})}),I=(0,c.memo)(({value:b,onChange:R,suggestions:A,placeholder:L="http://your-grafana.com/d/000000010/annotations"})=>{const U=(0,c.useRef)(null),W=(0,y.of)(S),[w,N]=(0,c.useState)(!1),[B,V]=(0,c.useState)(0),[K,H]=(0,c.useState)((0,d.mO)(b)),X=(0,o.A)(K),[k,Y]=(0,c.useState)(0),Z=[(0,i.cY)(({rects:ie})=>({alignmentAxis:ie.reference.width})),(0,i.UU)({fallbackAxisSideDirection:"start",crossAxis:!1,boundary:document.body}),(0,i.BN)()],{refs:se,floatingStyles:j}=(0,s.we)({open:w,placement:"bottom-start",onOpenChange:N,middleware:Z,whileElementsMounted:r.ll,strategy:"fixed"}),q=(0,c.useRef)({showingSuggestions:w,suggestions:A,suggestionsIndex:B,linkUrl:K,onChange:R});q.current={showingSuggestions:w,suggestions:A,suggestionsIndex:B,linkUrl:K,onChange:R};const ne=(0,c.useRef)(null);(0,c.useEffect)(()=>{Y(T(ne.current,B))},[B]);const oe=c.useCallback((ie,ae)=>{if(!q.current.showingSuggestions){if(ie.key==="="||ie.key==="$"||ie.keyCode===32&&ie.ctrlKey){const re=new x;return se.setReference(re),N(!0)}return ae()}switch(ie.key){case"Backspace":case"Escape":return N(!1),V(0);case"Enter":return ie.preventDefault(),te(q.current.suggestions[q.current.suggestionsIndex]);case"ArrowDown":case"ArrowUp":ie.preventDefault();const re=ie.key==="ArrowDown"?1:-1;return V(ce=>E(ce+re,q.current.suggestions.length));default:return ae()}},[]);(0,c.useEffect)(()=>{X&&X.selection.isFocused&&!K.selection.isFocused&&q.current.onChange(h.A.serialize(K))},[K,X]);const z=c.useCallback(({value:ie})=>{H(ie)},[]),te=(ie,ae=U.current)=>{const ce=le()==="$";ie.origin!==l.$0.Template||ie.value===p.c.includeVars?ae.insertText(`${ce?"":"$"}{${ie.value}}`):ae.insertText(`${ce?"":"$"}{${ie.value}:queryparam}`),H(ae.value),N(!1),V(0),q.current.onChange(h.A.serialize(ae.value))},le=()=>{const ie=document.getElementById("data-link-input");let ae="",re,ce;return window.getSelection&&(re=window.getSelection(),re&&re.rangeCount>0&&(ce=re.getRangeAt(0).cloneRange(),ce.collapse(!0),ce.setStart(ie,0),ae=ce.toString().slice(-1))),ae};return(0,t.jsx)("div",{className:W.wrapperOverrides,children:(0,t.jsx)("div",{className:"slate-query-field__wrapper",children:(0,t.jsxs)("div",{id:"data-link-input",className:"slate-query-field",children:[w&&(0,t.jsx)(D.ZL,{children:(0,t.jsx)("div",{ref:se.setFloating,style:j,children:(0,t.jsx)(v.A,{scrollTop:k,autoHeightMax:"300px",setScrollTop:({scrollTop:ie})=>Y(ie),children:(0,t.jsx)(P.k,{activeRef:ne,suggestions:q.current.suggestions,onSuggestionSelect:te,onClose:()=>N(!1),activeIndex:B})})})}),(0,t.jsx)(g.KE,{schema:d.yx,ref:U,placeholder:L,value:q.current.linkUrl,onChange:z,onKeyDown:(ie,ae,re)=>oe(ie,re),plugins:M,className:(0,n.cx)(W.editor,W.input,(0,n.css)({padding:"3px 8px"}))})]})})})});I.displayName="DataLinkInput";function T(b,R){return(b?.clientHeight??0)*R}},43538:(G,O,e)=>{"use strict";e.d(O,{k:()=>h});var t=e(74848),n=e(96540),i=e(32196),s=e(2543),r=e.n(s),f=e(37151),a=e(40845),c=e(33552);const o=l=>({list:(0,i.css)({borderBottom:`1px solid ${l.colors.border.weak}`,"&:last-child":{border:"none"}}),wrapper:(0,i.css)({background:l.colors.background.primary,width:"250px"}),item:(0,i.css)({background:"none",padding:"2px 8px",userSelect:"none",color:l.colors.text.primary,cursor:"pointer","&:hover":{background:l.colors.action.hover}}),label:(0,i.css)({color:l.colors.text.secondary}),activeItem:(0,i.css)({background:l.colors.background.secondary,"&:hover":{background:l.colors.background.secondary}}),itemValue:(0,i.css)({fontFamily:l.typography.fontFamilyMonospace,fontSize:l.typography.size.sm})}),h=({suggestions:l,...p})=>{const m=(0,n.useRef)(null);(0,f.A)(m,()=>{p.onClose&&p.onClose()});const y=(0,n.useMemo)(()=>(0,s.groupBy)(l,v=>v.origin),[l]),d=(0,a.of)(o);return(0,t.jsx)("div",{role:"menu",ref:m,className:d.wrapper,children:Object.keys(y).map((v,u)=>{const D=u===0?0:Object.keys(y).reduce((P,x,E)=>E>=u?P:P+y[x].length,0);return(0,n.createElement)(g,{...p,suggestions:y[v],label:`${(0,s.capitalize)(v)}`,activeIndex:p.activeIndex,activeIndexOffset:D,key:v})})})};h.displayName="DataLinkSuggestions";const g=n.memo(({activeIndex:l,activeIndexOffset:p,label:m,onClose:y,onSuggestionSelect:d,suggestions:v,activeRef:u})=>{const D=(0,a.of)(o);return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(c.B,{className:D.list,items:v,renderItem:(P,x)=>{const E=x+p===l;return(0,t.jsx)("div",{role:"menuitem",tabIndex:0,className:(0,i.cx)(D.item,E&&D.activeItem),ref:E?u:void 0,onClick:()=>{d(P)},title:P.documentation,children:(0,t.jsxs)("span",{className:D.itemValue,children:[(0,t.jsx)("span",{className:D.label,children:m})," ",P.label]})})}})})});g.displayName="DataLinkSuggestionsList"},59796:(G,O,e)=>{"use strict";e.d(O,{e:()=>c});var t=e(74848),n=e(32196),i=e(13544),s=e(14555),r=e(51686),f=e(59093),a=e(64539);const c=({children:o,links:h,style:g})=>{const l=[{items:(0,s.J)(h),label:"Data links"}],p=l[0].items.length,m=()=>l.map((d,v)=>(0,t.jsx)(f.r,{label:d.label,children:(d.items||[]).map((u,D)=>(0,t.jsx)(a.D,{url:u.url,label:u.label,target:u.target,icon:u.icon,active:u.active,onClick:u.onClick},`${d.label}-${v}-${D}}`))},`${d.label}${v}`)),y=(0,n.css)({cursor:"context-menu"});if(p>1)return(0,t.jsx)(r.n,{renderMenuItems:m,children:({openMenu:d})=>o({openMenu:d,targetClassName:y})});{const d=h()[0];return(0,t.jsx)("a",{href:d.href,onClick:d.onClick,target:d.target,title:d.title,style:{...g,overflow:"hidden",display:"flex"},"data-testid":i.Tp.components.DataLinksContextMenu.singleLink,children:o({})})}}},64919:(G,O,e)=>{"use strict";e.d(O,{e:()=>E});var t=e(74848),n=e(32196),i=e(38127),s=e(2543),r=e(96540),f=e(40845),a=e(55852),c=e(37390),o=e(14555),h=e(88575),g=e(10354),l=e(15292),p=e(64078);const m=M=>({listItem:(0,n.css)({marginBottom:M.spacing()}),infoText:(0,n.css)({paddingBottom:M.spacing(2),marginLeft:"66px",color:M.colors.text.secondary})}),y=(0,r.memo)(({index:M,value:S,onChange:I,suggestions:T,isLast:b})=>{const R=(0,f.of)(m),A=(W,w)=>{I(M,{...S,url:W},w)},L=W=>{I(M,{...S,title:W.target.value})},U=()=>{I(M,{...S,targetBlank:!S.targetBlank})};return(0,t.jsxs)("div",{className:R.listItem,children:[(0,t.jsx)(h.D,{label:"Title",children:(0,t.jsx)(g.p,{value:S.title,onChange:L,placeholder:"Show details"})}),(0,t.jsx)(h.D,{label:"URL",invalid:(0,o.F)(S.url),error:"Data link is an Explore URL in a deprecated format. Please visit the URL to be redirected, and edit this data link to use that URL.",children:(0,t.jsx)(p.l,{value:S.url,onChange:A,suggestions:T})}),(0,t.jsx)(h.D,{label:"Open in new tab",children:(0,t.jsx)(l.d,{value:S.targetBlank||!1,onChange:U})}),b&&(0,t.jsx)("div",{className:R.infoText,children:"With data links you can reference data variables like series name, labels and values. Type CMD+Space, CTRL+Space, or $ to open variable suggestions."})]})});y.displayName="DataLinkEditor";const d=({link:M,index:S,getSuggestions:I,onSave:T,onCancel:b})=>{const[R,A]=(0,r.useState)(M);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y,{value:R,index:S,isLast:!1,suggestions:I(),onChange:(L,U)=>{A(U)}}),(0,t.jsxs)(c.a.ButtonRow,{children:[(0,t.jsx)(a.$n,{variant:"secondary",onClick:()=>b(S),fill:"outline",children:"Cancel"}),(0,t.jsx)(a.$n,{onClick:()=>{T(S,R)},children:"Save"})]})]})};var v=e(72093),u=e(14578),D=e(29158);const P=({link:M,onEdit:S,onRemove:I,index:T,itemKey:b})=>{const R=(0,f.of)(x),{title:A="",url:L=""}=M,U=A.trim()!=="",W=L.trim()!=="",w=(0,o.F)(L);return(0,t.jsx)(i.sx,{draggableId:b,index:T,children:N=>(0,t.jsx)(t.Fragment,{children:(0,r.createElement)("div",{className:(0,n.cx)(R.wrapper,R.dragRow),ref:N.innerRef,...N.draggableProps,key:T},(0,t.jsx)("div",{className:(0,n.cx)(R.dragHandle,R.icons),...N.dragHandleProps,children:(0,t.jsx)(u.I,{name:"draggabledots",size:"lg"})}),(0,t.jsxs)("div",{className:R.linkDetails,children:[(0,t.jsx)("div",{className:(0,n.cx)(R.url,!W&&R.notConfigured,w&&R.errored),children:U?A:"Data link title not provided"}),(0,t.jsx)("div",{className:(0,n.cx)(R.url,!W&&R.notConfigured,w&&R.errored),title:L,children:W?L:"Data link url not provided"}),w&&(0,t.jsx)(v.P,{children:"Explore data link may not work in the future. Please edit."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(D.K,{name:"pen",onClick:S,tooltip:"Edit data link title"}),(0,t.jsx)(D.K,{name:"times",onClick:I,tooltip:"Remove data link title"})]}))})},b)},x=M=>({wrapper:(0,n.css)({display:"flex",flexGrow:1,alignItems:"center",justifyContent:"space-between",width:"100%",marginBottom:M.spacing(2),padding:"10px 0 0 10px","&:last-child":{marginBottom:0}}),linkDetails:(0,n.css)({display:"flex",flexDirection:"column",flexGrow:1}),errored:(0,n.css)({color:M.colors.error.text,fontStyle:"italic"}),notConfigured:(0,n.css)({fontStyle:"italic"}),title:(0,n.css)({color:M.colors.text.primary,fontSize:M.typography.size.sm,fontWeight:M.typography.fontWeightMedium}),url:(0,n.css)({color:M.colors.text.secondary,fontSize:M.typography.size.sm,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"90%"}),dragRow:(0,n.css)({position:"relative"}),icons:(0,n.css)({display:"flex",padding:6,alignItems:"center",gap:8}),dragHandle:(0,n.css)({cursor:"grab","&:focus-visible&:after":{bottom:0,content:'""',left:0,position:"absolute",right:0,top:0,outline:`2px solid ${M.colors.primary.main}`,outlineOffset:"-2px"}})}),E=({links:M,onChange:S,getSuggestions:I,data:T,showOneClick:b=!1})=>{const[R,A]=(0,r.useState)(null),[L,U]=(0,r.useState)(!1),[W,w]=(0,r.useState)([]);(0,r.useEffect)(()=>{w(M??[])},[M]);const N=(0,f.of)(C),B=R!==null,V=(Z,se)=>{if(L)if(se.title.trim()===""&&se.url.trim()===""){U(!1),A(null);return}else A(null),U(!1);const j=(0,s.cloneDeep)(W);j[Z]=se,S(j),A(null)},K=()=>{let Z=(0,s.cloneDeep)(W);A(Z.length),U(!0)},H=Z=>{L&&U(!1),A(null)},X=Z=>{const se=(0,s.cloneDeep)(W);se.splice(Z,1),S(se)},k=Z=>{if(!M||!Z.destination)return;const se=(0,s.cloneDeep)(W),j=se[Z.source.index];se.splice(Z.source.index,1),se.splice(Z.destination.index,0,j),w(se),S(se)},Y=(Z,se)=>b?(0,t.jsxs)("div",{className:N.oneClickOverlay,children:[(0,t.jsx)("span",{className:N.oneClickSpan,children:"One-click"}),Z]},se):Z;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.JY,{onDragEnd:k,children:(0,t.jsx)(i.gL,{droppableId:"sortable-links",direction:"vertical",children:Z=>(0,t.jsxs)("div",{className:N.wrapper,ref:Z.innerRef,...Z.droppableProps,children:[W.map((se,j)=>{const q=`${se.title}/${j}`,ne=(0,t.jsx)(P,{index:j,link:se,onChange:V,onEdit:()=>A(j),onRemove:()=>X(j),data:T,itemKey:q},q);return j===0?Y(ne,q):ne}),Z.placeholder]})})}),B&&R!==null&&(0,t.jsx)(c.a,{title:"Edit link",isOpen:!0,closeOnBackdropClick:!1,onDismiss:()=>{H(R)},children:(0,t.jsx)(d,{index:R,link:L?{title:"",url:""}:W[R],data:T,onSave:V,onCancel:H,getSuggestions:I})}),(0,t.jsx)(a.$n,{size:"sm",icon:"plus",onClick:K,variant:"secondary",children:"Add link"})]})},C=M=>({wrapper:(0,n.css)({marginBottom:M.spacing(2)}),oneClickOverlay:(0,n.css)({height:"auto",border:`1px dashed ${M.colors.border.medium}`,paddingBottom:10,fontSize:10,color:M.colors.text.link}),oneClickSpan:(0,n.css)({padding:10,marginBottom:-10,display:"inline-block"})})},79961:(G,O,e)=>{"use strict";e.d(O,{n:()=>f});var t=e(74848),n=e(32196),i=e(40845),s=e(14578),r=e(14689);function f({links:c}){const o=(0,i.of)(a);if(c.length===1)return(0,t.jsx)(r.R,{link:c[0]});const h=c.filter(l=>l.target==="_blank"),g=c.filter(l=>l.target==="_self");return(0,t.jsxs)(t.Fragment,{children:[g.map((l,p)=>(0,t.jsx)(r.R,{link:l},p)),(0,t.jsxs)("div",{className:o.wrapper,children:[(0,t.jsx)("p",{className:o.externalLinksHeading,children:"External links"}),h.map((l,p)=>(0,t.jsxs)("a",{href:l.href,target:l.target,className:o.externalLink,children:[(0,t.jsx)(s.I,{name:"external-link-alt"}),l.title]},p))]})]})}const a=c=>({wrapper:(0,n.css)({flexBasis:"150px",width:"100px",marginTop:c.spacing(1)}),externalLinksHeading:(0,n.css)({color:c.colors.text.secondary,fontWeight:c.typography.fontWeightRegular,fontSize:c.typography.size.sm,margin:0}),externalLink:(0,n.css)({color:c.colors.text.link,fontWeight:c.typography.fontWeightRegular,display:"block",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis","&:hover":{textDecoration:"underline"},div:{marginRight:c.spacing(1)}})})},19849:(G,O,e)=>{"use strict";e.d(O,{i:()=>s});var t=e(74848),n=e(15292),i=e(14186);function s({options:r,onOptionsChange:f}){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h3",{className:"page-heading",children:"Alerting"}),(0,t.jsx)("div",{className:"gf-form-group",children:(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(i.I,{labelWidth:29,label:"Manage alert rules in Alerting UI",disabled:r.readOnly,tooltip:"Manage alert rules for this data source. To manage other alerting resources, add an Alertmanager data source.",children:(0,t.jsx)(n.K,{value:r.jsonData.manageAlerts!==!1,onChange:a=>f({...r,jsonData:{...r.jsonData,manageAlerts:a.currentTarget.checked}})})})})})})]})}},28623:(G,O,e)=>{"use strict";e.d(O,{K:()=>a});var t=e(74848),n=e(55852),i=e(14186),s=e(39268),r=e(10354),f=e(21744);const a=({hasCert:c,label:o,onChange:h,onClick:g,placeholder:l})=>(0,t.jsxs)(s.C,{children:[(0,t.jsx)(i.I,{label:o,labelWidth:14,disabled:c,children:c?(0,t.jsx)(r.p,{type:"text",value:"configured",width:24}):(0,t.jsx)(f.f,{rows:7,onChange:h,placeholder:l,required:!0})}),c&&(0,t.jsx)(n.$n,{variant:"secondary",onClick:g,style:{marginLeft:4},children:"Reset"})]})},11184:(G,O,e)=>{"use strict";e.d(O,{P:()=>p});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(96540),f=e(40845),a=e(55852),c=e(90090),o=e(14578),h=e(56286);const g=()=>({layout:(0,n.css)({display:"flex",alignItems:"center",marginBottom:"4px","> *":{marginLeft:"4px",marginBottom:0,height:"100%","&:first-child, &:last-child":{marginLeft:0}}})}),l=({header:y,onBlur:d,onChange:v,onRemove:u,onReset:D})=>{const P=(0,f.of)(g);return(0,t.jsxs)("div",{className:P.layout,children:[(0,t.jsx)(c.z,{label:"Header",name:"name",placeholder:"X-Custom-Header",labelWidth:5,value:y.name||"",onChange:x=>v({...y,name:x.target.value}),onBlur:d}),(0,t.jsx)(h.L,{label:"Value","aria-label":"Value",name:"value",isConfigured:y.configured,value:y.value,labelWidth:5,inputWidth:y.configured?11:12,placeholder:"Header Value",onReset:()=>D(y.id),onChange:x=>v({...y,value:x.target.value}),onBlur:d}),(0,t.jsx)(a.$n,{type:"button","aria-label":"Remove header",variant:"secondary",size:"xs",onClick:x=>u(y.id),children:(0,t.jsx)(o.I,{name:"trash-alt"})})]})};l.displayName="CustomHeaderRow";class p extends r.PureComponent{constructor(d){super(d),this.state={headers:[]},this.updateSettings=()=>{const{headers:P}=this.state,x=Object.fromEntries(Object.entries(this.props.dataSourceConfig.jsonData).filter(([C,M])=>!C.startsWith("httpHeaderName"))),E=Object.fromEntries(Object.entries(this.props.dataSourceConfig.secureJsonData||{}).filter(([C,M])=>!C.startsWith("httpHeaderValue")));for(const[C,M]of P.entries())x[`httpHeaderName${C+1}`]=M.name,M.configured||(E[`httpHeaderValue${C+1}`]=M.value);this.props.onChange({...this.props.dataSourceConfig,jsonData:x,secureJsonData:E})},this.onHeaderAdd=()=>{this.setState(P=>({headers:[...P.headers,{id:(0,i.uniqueId)(),name:"",value:"",configured:!1}]}))},this.onHeaderChange=(P,x)=>{this.setState(({headers:E})=>({headers:E.map((C,M)=>P!==M?C:{...x})}))},this.onHeaderReset=P=>{this.setState(({headers:x})=>({headers:x.map((E,C)=>E.id!==P?E:{...E,value:"",configured:!1})}))},this.onHeaderRemove=P=>{this.setState(({headers:x})=>({headers:x.filter(E=>E.id!==P)}),this.updateSettings)};const{jsonData:v,secureJsonData:u,secureJsonFields:D}=this.props.dataSourceConfig;this.state={headers:Object.keys(v).sort().filter(P=>P.startsWith("httpHeaderName")).map((P,x)=>({id:(0,i.uniqueId)(),name:v[P],value:u!==void 0?u[P]:"",configured:D&&D[`httpHeaderValue${x+1}`]||!1}))}}render(){const{headers:d}=this.state,{dataSourceConfig:v}=this.props;return(0,t.jsxs)("div",{className:"gf-form-group",children:[(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)("h6",{children:"Custom HTTP Headers"})}),(0,t.jsx)("div",{children:d.map((u,D)=>(0,t.jsx)(l,{header:u,onChange:P=>{this.onHeaderChange(D,P)},onBlur:this.updateSettings,onRemove:this.onHeaderRemove,onReset:this.onHeaderReset},u.id))}),!v.readOnly&&(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(a.$n,{variant:"secondary",icon:"plus",type:"button",onClick:u=>{this.onHeaderAdd()},children:"Add header"})})]})}}var m=null},91409:(G,O,e)=>{"use strict";e.d(O,{t:()=>T});var t=e(74848),n=e(32196),i=e(96540),s=e(13544),r=e(40845),f=e(42418),a=e(90090),c=e(38894),o=e(14186),h=e(91634),g=e(14578),l=e(90182),p=e(15292),m=e(79924),y=e(94753),d=e(56286);const v=({dataSourceConfig:b,onChange:R})=>{const A=b.secureJsonData?b.secureJsonData.basicAuthPassword:"",L=()=>{R({...b,secureJsonData:{...b.secureJsonData,basicAuthPassword:""},secureJsonFields:{...b.secureJsonFields,basicAuthPassword:!1}})},U=W=>{R({...b,secureJsonData:{...b.secureJsonData,basicAuthPassword:W.currentTarget.value}})};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.I,{disabled:b.readOnly,children:(0,t.jsx)(a.z,{label:"User",labelWidth:10,inputWidth:18,placeholder:"user",value:b.basicAuthUser,onChange:W=>R({...b,basicAuthUser:W.currentTarget.value})})}),(0,t.jsx)(o.I,{disabled:b.readOnly,children:(0,t.jsx)(d.L,{isConfigured:!!(b.secureJsonFields&&b.secureJsonFields.basicAuthPassword),value:A||"",inputWidth:18,labelWidth:10,onReset:L,onChange:U})})]})};var u=e(11184);const D=26,P=({dataSourceConfig:b,onChange:R,showForwardOAuthIdentityOption:A=!0})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"gf-form-inline",children:[(0,t.jsx)(o.I,{label:"TLS Client Auth",labelWidth:D,disabled:b.readOnly,children:(0,t.jsx)(p.K,{id:"http-settings-tls-client-auth",value:b.jsonData.tlsAuth||!1,onChange:L=>R({...b.jsonData,tlsAuth:L.currentTarget.checked})})}),(0,t.jsx)(o.I,{label:"With CA Cert",tooltip:"Needed for verifying self-signed TLS Certs",labelWidth:D,disabled:b.readOnly,children:(0,t.jsx)(p.K,{id:"http-settings-ca-cert",value:b.jsonData.tlsAuthWithCACert||!1,onChange:L=>R({...b.jsonData,tlsAuthWithCACert:L.currentTarget.checked})})})]}),(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsx)(o.I,{label:"Skip TLS Verify",labelWidth:D,disabled:b.readOnly,children:(0,t.jsx)(p.K,{id:"http-settings-skip-tls-verify",value:b.jsonData.tlsSkipVerify||!1,onChange:L=>R({...b.jsonData,tlsSkipVerify:L.currentTarget.checked})})})}),A&&(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsx)(o.I,{label:"Forward OAuth Identity",tooltip:"Forward the user's upstream OAuth identity to the data source (Their access token gets passed along).",labelWidth:D,disabled:b.readOnly,children:(0,t.jsx)(p.K,{id:"http-settings-forward-oauth",value:b.jsonData.oauthPassThru||!1,onChange:L=>R({...b.jsonData,oauthPassThru:L.currentTarget.checked})})})})]});var x=e(17081),E=e(95180);const C=[{label:"Server (default)",value:"proxy"},{label:"Browser",value:"direct"}],M={label:"Server (default)",value:"proxy"},S=()=>(0,t.jsxs)(f.F,{severity:"info",title:"",topSpacing:3,children:[(0,t.jsxs)("p",{children:["Access mode controls how requests to the data source will be handled.",(0,t.jsxs)("strong",{children:["\xA0",(0,t.jsx)("i",{children:"Server"})]})," ","should be the preferred way if nothing else is stated."]}),(0,t.jsx)(y.E,{weight:"medium",children:"Server access mode (Default):"}),(0,t.jsx)("p",{children:"All requests will be made from the browser to Grafana backend/server which in turn will forward the requests to the data source and by that circumvent possible Cross-Origin Resource Sharing (CORS) requirements. The URL needs to be accessible from the grafana backend/server if you select this access mode."}),(0,t.jsx)(y.E,{weight:"medium",children:"Browser access mode:"}),(0,t.jsx)("p",{children:"All requests will be made from the browser directly to the data source and may be subject to Cross-Origin Resource Sharing (CORS) requirements. The URL needs to be accessible from the browser if you select this access mode."})]}),I=26,T=b=>{const{defaultUrl:R,dataSourceConfig:A,onChange:L,showAccessOptions:U,sigV4AuthToggleEnabled:W,showForwardOAuthIdentityOption:w,azureAuthSettings:N,renderSigV4Editor:B,secureSocksDSProxyEnabled:V,urlLabel:K,urlDocs:H}=b,[X,k]=(0,i.useState)(!1),[Y,Z]=(0,i.useState)(!1),se=(0,r.$j)();let j;const q=(0,i.useCallback)(ae=>{const re=N?.azureAuthSupported&&N.getAzureAuthEnabled(A)||!1;if(Z(re),re){const ce=A.jsonData.oauthPassThru!==void 0?A.jsonData.oauthPassThru:!1;ae={...ae,jsonData:{...A.jsonData,oauthPassThru:re?!1:ce}}}L({...A,...ae})},[N,A,L]);switch(A.access){case"direct":j=(0,t.jsxs)(t.Fragment,{children:["Your access method is ",(0,t.jsx)("em",{children:"Browser"}),", this means the URL needs to be accessible from the browser.",H]});break;case"proxy":j=(0,t.jsxs)(t.Fragment,{children:["Your access method is ",(0,t.jsx)("em",{children:"Server"}),", this means the URL needs to be accessible from the grafana backend/server.",H]});break;default:j=(0,t.jsxs)(t.Fragment,{children:["Specify a complete HTTP URL (for example http://your_server:8080) ",H]})}const ne=(0,t.jsx)(l.l6,{"aria-label":"Access",className:"width-20 gf-form-input",options:C,value:C.filter(ae=>ae.value===A.access)[0]||M,onChange:ae=>q({access:ae.value}),disabled:A.readOnly}),oe=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/.test(A.url),z=(0,n.css)({boxShadow:`inset 0 0px 5px ${se.v1.palette.red}`}),te=(0,n.cx)({"width-20":!0,[z]:!oe}),le=(0,i.useId)(),ie=(0,t.jsx)(h.p,{id:le,className:te,placeholder:R,value:A.url,"data-testid":s.Tp.components.DataSource.DataSourceHttpSettings.urlInput,onChange:ae=>q({url:ae.currentTarget.value}),disabled:A.readOnly});return(0,t.jsxs)("div",{className:"gf-form-group",children:[(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h3",{className:"page-heading",children:"HTTP"}),(0,t.jsxs)("div",{className:"gf-form-group",children:[(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(a.z,{interactive:!!H,label:K??"URL",labelWidth:13,tooltip:j,inputEl:ie})}),U&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"gf-form-inline",children:[(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(a.z,{label:"Access",labelWidth:13,inputWidth:20,inputEl:ne})}),(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsxs)("button",{type:"button",className:"gf-form-label query-keyword pointer",onClick:()=>k(ae=>!ae),children:["Help\xA0",(0,t.jsx)(g.I,{name:X?"angle-down":"angle-right",style:{marginBottom:0}})]})})]}),X&&(0,t.jsx)(S,{})]}),A.access==="proxy"&&(0,t.jsxs)("div",{className:"gf-form-group",children:[(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(c.I,{width:13,tooltip:"Grafana proxy deletes forwarded cookies by default. Specify cookies by name that should be forwarded to the data source.",children:"Allowed cookies"}),(0,t.jsx)(m.u,{tags:A.jsonData.keepCookies,width:40,onChange:ae=>q({jsonData:{...A.jsonData,keepCookies:ae}}),disabled:A.readOnly})]}),(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(a.z,{label:"Timeout",type:"number",labelWidth:13,inputWidth:20,tooltip:"HTTP request timeout in seconds",placeholder:"Timeout in seconds","aria-label":"Timeout in seconds",value:A.jsonData.timeout,onChange:ae=>{q({jsonData:{...A.jsonData,timeout:parseInt(ae.currentTarget.value,10)}})},disabled:A.readOnly})})]})]})]}),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h3",{className:"page-heading",children:"Auth"}),(0,t.jsxs)("div",{className:"gf-form-group",children:[(0,t.jsxs)("div",{className:"gf-form-inline",children:[(0,t.jsx)(o.I,{label:"Basic auth",labelWidth:I,disabled:A.readOnly,children:(0,t.jsx)(p.K,{id:"http-settings-basic-auth",value:A.basicAuth,onChange:ae=>{q({basicAuth:ae.currentTarget.checked})}})}),(0,t.jsx)(o.I,{label:"With Credentials",tooltip:"Whether credentials such as cookies or auth headers should be sent with cross-site requests.",labelWidth:I,disabled:A.readOnly,children:(0,t.jsx)(p.K,{id:"http-settings-with-credentials",value:A.withCredentials,onChange:ae=>{q({withCredentials:ae.currentTarget.checked})}})})]}),N?.azureAuthSupported&&(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsx)(o.I,{label:"Azure Authentication",tooltip:"Use Azure authentication for Azure endpoint.",labelWidth:I,disabled:A.readOnly,children:(0,t.jsx)(p.K,{id:"http-settings-azure-auth",value:Y,onChange:ae=>{q(N.setAzureAuthEnabled(A,ae.currentTarget.checked))}})})}),W&&(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsx)(o.I,{label:"SigV4 auth",labelWidth:I,disabled:A.readOnly,children:(0,t.jsx)(p.K,{id:"http-settings-sigv4-auth",value:A.jsonData.sigV4Auth||!1,onChange:ae=>{q({jsonData:{...A.jsonData,sigV4Auth:ae.currentTarget.checked}})}})})}),A.access==="proxy"&&(0,t.jsx)(P,{dataSourceConfig:A,onChange:ae=>q({jsonData:ae}),showForwardOAuthIdentityOption:Y?!1:w})]}),A.basicAuth&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h6",{children:"Basic Auth Details"}),(0,t.jsx)("div",{className:"gf-form-group",children:(0,t.jsx)(v,{...b})})]}),N?.azureAuthSupported&&Y&&N.azureSettingsUI&&(0,t.jsx)(N.azureSettingsUI,{dataSourceConfig:A,onChange:L}),A.jsonData.sigV4Auth&&W&&B,(A.jsonData.tlsAuth||A.jsonData.tlsAuthWithCACert)&&(0,t.jsx)(E.j,{dataSourceConfig:A,onChange:L}),A.access==="proxy"&&(0,t.jsx)(u.P,{dataSourceConfig:A,onChange:L})]}),V&&(0,t.jsx)(x.Y,{options:A,onOptionsChange:L})]})}},17081:(G,O,e)=>{"use strict";e.d(O,{Y:()=>s});var t=e(74848),n=e(15292),i=e(14186);function s({options:r,onOptionsChange:f}){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h3",{className:"page-heading",children:"Secure Socks Proxy"}),(0,t.jsx)("div",{className:"gf-form-group",children:(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(i.I,{labelWidth:26,label:"Enabled",tooltip:"Connect to this datasource via the secure socks proxy.",children:(0,t.jsx)(n.K,{value:r.jsonData.enableSecureSocksProxy??!1,onChange:a=>f({...r,jsonData:{...r.jsonData,enableSecureSocksProxy:a.currentTarget.checked}})})})})})})]})}},95180:(G,O,e)=>{"use strict";e.d(O,{j:()=>a});var t=e(74848),n=e(32196),i=e(90090),s=e(14578),r=e(56034),f=e(28623);const a=({dataSourceConfig:c,onChange:o})=>{const h=c.secureJsonFields&&c.secureJsonFields.tlsCACert,g=c.secureJsonFields&&c.secureJsonFields.tlsClientCert,l=c.secureJsonFields&&c.secureJsonFields.tlsClientKey,p=c.jsonData&&c.jsonData.serverName,m=v=>u=>{u.preventDefault();const D={...c.secureJsonFields};D[v]=!1,o({...c,secureJsonFields:D})},y=v=>u=>{const D={...c.secureJsonData};D[v]=u.currentTarget.value,o({...c,secureJsonData:D})},d=v=>{const u={...c.jsonData,serverName:v.currentTarget.value};o({...c,jsonData:u})};return(0,t.jsxs)("div",{className:"gf-form-group",children:[(0,t.jsxs)("div",{className:(0,n.cx)("gf-form",(0,n.css)({alignItems:"baseline"})),children:[(0,t.jsx)("h6",{children:"TLS/SSL Auth Details"}),(0,t.jsx)(r.m,{placement:"right-end",content:"TLS/SSL Certs are encrypted and stored in the Grafana database.",theme:"info",children:(0,t.jsx)(s.I,{name:"info-circle",size:"xs",style:{marginLeft:"10px"}})})]}),(0,t.jsxs)("div",{children:[c.jsonData.tlsAuthWithCACert&&(0,t.jsx)(f.K,{hasCert:!!h,onChange:y("tlsCACert"),placeholder:"Begins with -----BEGIN CERTIFICATE-----",label:"CA Cert",onClick:m("tlsCACert")}),c.jsonData.tlsAuth&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(i.z,{label:"ServerName",labelWidth:7,inputWidth:30,placeholder:"domain.example.com",value:p&&c.jsonData.serverName,onChange:d})}),(0,t.jsx)(f.K,{hasCert:!!g,label:"Client Cert",onChange:y("tlsClientCert"),placeholder:"Begins with -----BEGIN CERTIFICATE-----",onClick:m("tlsClientCert")}),(0,t.jsx)(f.K,{hasCert:!!l,label:"Client Key",placeholder:"Begins with -----BEGIN RSA PRIVATE KEY-----",onChange:y("tlsClientKey"),onClick:m("tlsClientKey")})]})]})]})}},98239:(G,O,e)=>{"use strict";e.d(O,{l:()=>l});var t=e(74848),n=e(32196),i=e(34743),s=e(36376),r=e(7315),f=e(96540),a=e(47232),c=e(40845),o=e(10354),h=e(56181);const g=m=>(0,a.KQ)(m).format("L"),l=({value:m,minDate:y,maxDate:d,onChange:v,closeOnSelect:u,placeholder:D="Date",...P})=>{const[x,E]=(0,f.useState)(!1),C=(0,c.of)(p),M=[(0,i.UU)({crossAxis:!1,boundary:document.body}),(0,i.BN)()],{context:S,refs:I,floatingStyles:T}=(0,s.we)({open:x,placement:"bottom-start",onOpenChange:E,middleware:M,whileElementsMounted:r.ll,strategy:"fixed"}),b=(0,s.kp)(S),R=(0,s.s9)(S),{getReferenceProps:A,getFloatingProps:L}=(0,s.bv)([R,b]);return(0,t.jsxs)("div",{className:C.container,children:[(0,t.jsx)(o.p,{ref:I.setReference,type:"text",autoComplete:"off",placeholder:D,value:m&&g(m),onChange:U=>{U.target.value===""&&v("")},className:C.input,...P,...A()}),(0,t.jsx)("div",{className:C.popover,ref:I.setFloating,style:T,...L(),children:(0,t.jsx)(h.l,{isOpen:x,value:m&&typeof m!="string"?m:(0,a.KQ)().toDate(),minDate:y,maxDate:d,onChange:U=>{v(U),u&&E(!1)},onClose:()=>E(!1)})})]})},p=m=>({container:(0,n.css)({position:"relative"}),input:(0,n.css)({"input[type='date']::-webkit-inner-spin-button, input[type='date']::-webkit-calendar-picker-indicator":{display:"none",WebkitAppearance:"none"}}),popover:(0,n.css)({zIndex:m.zIndex.tooltip})})},56181:(G,O,e)=>{"use strict";e.d(O,{l:()=>o});var t=e(74848),n=e(32196),i=e(96540),s=e(29426),r=e(40845),f=e(8866),a=e(14578),c=e(72265);const o=(0,i.memo)(l=>{const p=(0,r.of)(g),{isOpen:m,onClose:y}=l;return m?(0,t.jsx)(f.N,{useCapture:!0,includeButtonPress:!1,onClick:y,children:(0,t.jsx)("div",{className:p.modal,"data-testid":"date-picker",children:(0,t.jsx)(h,{...l})})}):null});o.displayName="DatePicker";const h=(0,i.memo)(({value:l,minDate:p,maxDate:m,onChange:y})=>{const d=(0,r.of)(c.h2);return(0,t.jsx)(s.Ay,{className:d.body,tileClassName:d.title,value:l||new Date,minDate:p,maxDate:m,nextLabel:(0,t.jsx)(a.I,{name:"angle-right"}),prevLabel:(0,t.jsx)(a.I,{name:"angle-left"}),onChange:v=>{v&&!Array.isArray(v)&&y(v)},locale:"en"})});h.displayName="Body";const g=l=>({modal:(0,n.css)({zIndex:l.zIndex.modal,boxShadow:l.shadows.z3,backgroundColor:l.colors.background.primary,border:`1px solid ${l.colors.border.weak}`,borderTopLeftRadius:l.shape.radius.default,borderBottomLeftRadius:l.shape.radius.default,"button:disabled":{color:l.colors.text.disabled}})})},63383:(G,O,e)=>{"use strict";e.d(O,{K:()=>b});var t=e(74848),n=e(32196),i=e(34743),s=e(36376),r=e(7315),f=e(18828),a=e(85690),c=e(93225),o=e(96540),h=e(29426),g=e(49045),l=e(72724),p=e(47232),m=e(1933),y=e(13390),d=e(40845),v=e(55852),u=e(14186),D=e(14578),P=e(10354),x=e(67061),E=e(88448),C=e(17464),M=e(66070),S=e(72265),I=e(47619),T=e(99225);const b=({date:U,maxDate:W,minDate:w,label:N,onChange:B,disabledHours:V,disabledMinutes:K,disabledSeconds:H,timeZone:X,showSeconds:k=!0,clearable:Y=!1})=>{const[Z,se]=(0,o.useState)(!1),j=(0,o.useRef)(null),{overlayProps:q,underlayProps:ne}=(0,c.e)({onClose:()=>se(!1),isDismissable:!0,isOpen:Z,shouldCloseOnInteractOutside:de=>{const De=document.getElementsByClassName(M.i)[0];return!(De&&De.contains(de))}},j),{dialogProps:oe}=(0,f.s)({},j),z=(0,d.$j)(),{modalBackdrop:te}=(0,d.of)(E.o),le=(0,g.A)(`(min-width: ${z.breakpoints.values.lg}px)`),ie=(0,d.of)(L),ae=[(0,i.UU)({crossAxis:!1,boundary:document.body}),(0,i.BN)()],{refs:re,floatingStyles:ce}=(0,s.we)({open:Z,placement:"bottom-start",onOpenChange:se,middleware:ae,whileElementsMounted:r.ll,strategy:"fixed"}),me=(0,o.useCallback)(de=>{se(!1),B(de)},[B]),ee=(0,o.useCallback)(de=>{de.preventDefault(),se(!0)},[se]);return(0,t.jsxs)("div",{"data-testid":"date-time-picker",style:{position:"relative"},children:[(0,t.jsx)(R,{date:U,onChange:B,isFullscreen:le,onOpen:ee,label:N,ref:re.setReference,showSeconds:k,clearable:Y,timeZone:X}),Z?le?(0,t.jsx)(C.ZL,{children:(0,t.jsx)(a.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("div",{ref:j,...q,...oe,children:(0,t.jsx)(A,{date:U,onChange:me,isFullscreen:!0,onClose:()=>se(!1),maxDate:W,minDate:w,ref:re.setFloating,style:ce,showSeconds:k,disabledHours:V,disabledMinutes:K,disabledSeconds:H,timeZone:X})})})}):(0,t.jsxs)(C.ZL,{children:[(0,t.jsx)("div",{className:te,...ne}),(0,t.jsx)(a.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("div",{ref:j,...q,...oe,children:(0,t.jsx)("div",{className:ie.modal,children:(0,t.jsx)(A,{date:U,maxDate:W,minDate:w,onChange:me,isFullscreen:!1,onClose:()=>se(!1),showSeconds:k,disabledHours:V,disabledMinutes:K,disabledSeconds:H,timeZone:X})})})})]}):null]})},R=o.forwardRef(({date:U,label:W,onChange:w,onOpen:N,timeZone:B,showSeconds:V=!0,clearable:K=!1},H)=>{const X=(0,d.of)(L),k=V?"YYYY-MM-DD HH:mm:ss":"YYYY-MM-DD HH:mm",[Y,Z]=(0,o.useState)(()=>({value:U?(0,l.LE)(U,{timeZone:B}):K?"":(0,l.LE)((0,p.KQ)(),{timeZone:B}),invalid:!1}));(0,o.useEffect)(()=>{if(U){const oe=(0,l.LE)(U,{format:k,timeZone:B});Z({invalid:!(0,I.f)(oe),value:(0,p.Ar)(U)?oe:U})}},[U,k,B]);const se=(0,o.useCallback)(oe=>{const z=!(0,I.f)(oe.currentTarget.value);Z({value:oe.currentTarget.value,invalid:z})},[]),j=(0,o.useCallback)(()=>{if(!Y.invalid&&Y.value){const oe=(0,p.oZ)((0,m.O)({timeZone:B}),Y.value);w(oe)}},[Y,w,B]),q=(0,o.useCallback)(()=>{Z({value:"",invalid:!1}),w()},[w]),ne=(0,t.jsx)(v.$n,{"aria-label":"Time picker",icon:"calendar-alt",variant:"secondary",onClick:N});return(0,t.jsx)(u.I,{label:W,invalid:!!(Y.value&&Y.invalid),className:X.field,children:(0,t.jsx)(P.p,{onChange:se,addonAfter:ne,value:Y.value,onBlur:j,"data-testid":y.X.DateTimePicker.input,placeholder:"Select date/time",ref:H,suffix:K&&Y.value&&(0,t.jsx)(D.I,{name:"times",className:X.clearIcon,onClick:q})})})});R.displayName="DateTimeInput";const A=o.forwardRef(({date:U,onClose:W,onChange:w,isFullscreen:N,maxDate:B,minDate:V,style:K,showSeconds:H=!0,disabledHours:X,disabledMinutes:k,disabledSeconds:Y,timeZone:Z},se)=>{const j=(0,d.of)(S.h2),q=(0,d.of)(L),[ne,oe]=(0,o.useState)(()=>U&&U.isValid()?(0,p.oZ)((0,m.O)({timeZone:Z}),U):(0,p.oZ)((0,m.O)({timeZone:Z}),new Date)),[z,te]=(0,o.useState)(()=>U&&U.isValid()?(0,T.Q)(U.toDate(),(0,m.O)({timeZone:Z})):(0,T.Q)(new Date,(0,m.O)({timeZone:Z}))),le=(0,o.useCallback)(re=>{re&&!Array.isArray(re)&&te(re)},[]),ie=(0,o.useCallback)(re=>{oe(re)},[]),ae=()=>{const re=(0,p.KQ)(ne);re.set("date",z.getDate()),re.set("month",z.getMonth()),re.set("year",z.getFullYear()),w(re)};return(0,t.jsxs)("div",{className:(0,n.cx)(q.container,{[q.fullScreen]:N}),style:K,ref:se,children:[(0,t.jsx)(h.Ay,{next2Label:null,prev2Label:null,value:z,nextLabel:(0,t.jsx)(D.I,{name:"angle-right"}),nextAriaLabel:"Next month",prevLabel:(0,t.jsx)(D.I,{name:"angle-left"}),prevAriaLabel:"Previous month",onChange:le,locale:"en",className:j.body,tileClassName:j.title,maxDate:B,minDate:V}),(0,t.jsx)("div",{className:q.time,children:(0,t.jsx)(M.R,{showSeconds:H,onChange:ie,value:ne,disabledHours:X,disabledMinutes:k,disabledSeconds:Y})}),(0,t.jsxs)(x.B,{children:[(0,t.jsx)(v.$n,{type:"button",onClick:ae,children:"Apply"}),(0,t.jsx)(v.$n,{variant:"secondary",type:"button",onClick:W,children:"Cancel"})]})]})});A.displayName="DateTimeCalendar";const L=U=>({container:(0,n.css)({padding:U.spacing(1),border:`1px ${U.colors.border.weak} solid`,borderRadius:U.shape.radius.default,backgroundColor:U.colors.background.primary,zIndex:U.zIndex.modal}),fullScreen:(0,n.css)({position:"absolute"}),time:(0,n.css)({marginBottom:U.spacing(2)}),modal:(0,n.css)({position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:U.zIndex.modal,maxWidth:"280px"}),clearIcon:(0,n.css)({cursor:"pointer"}),field:(0,n.css)({marginBottom:0,width:"100%"})})},5308:(G,O,e)=>{"use strict";e.d(O,{N:()=>L});var t=e(74848),n=e(32196),i=e(34743),s=e(36376),r=e(7315),f=e(18828),a=e(85690),c=e(93225),o=e(96540),h=e(40845),g=e(76412),l=e(55852),p=e(40276),m=e(88575),y=e(14578),d=e(10354),v=e(56034),u=e(42617),D=e(11752),P=e(32432);const x=/^now$|^now(\-|\+)(\d{1,10})([wdhms])$/,E=B=>({from:I(B.from),to:I(B.to)}),C=B=>{const V=b(B.from),K=b(B.to);return{from:V,to:K,display:`${V} to ${K}`}},M=(B,V=Date.now())=>S(B)?I(B)>Math.ceil(V/1e3)?{isValid:!1,errorMessage:"Can not enter value prior to January 1, 1970."}:{isValid:!0}:{isValid:!1,errorMessage:"Value not in relative time format."},S=B=>x.test(B),I=B=>{const V=x.exec(B);if(!V||V.length!==4)return 0;const[,K,H,X]=V,k=parseInt(H,10);if(isNaN(k))return 0;const Y=k*T[X];return K==="+"?Y*-1:Y},T={w:604800,d:86400,h:3600,m:60,s:1},b=B=>{if(B===0)return"now";const V=Math.abs(B);return B<0?`now+${R(V)}`:`now-${R(V)}`};function R(B){const V=[{unit:"w",value:604800},{unit:"d",value:86400},{unit:"h",value:3600},{unit:"m",value:60},{unit:"s",value:1}];for(const{unit:H,value:X}of V)if(B%X===0)return`${B/X}${H}`;const K=V[V.length-1];return`${B}${K.unit}`}const A=P.o.filter(B=>S(B.from));function L(B){const{timeRange:V,onChange:K}=B,[H,X]=(0,o.useState)(!1),k=(0,o.useCallback)(()=>X(!1),[]),Y=C(V),[Z,se]=(0,o.useState)({value:Y.from,validation:M(Y.from)}),[j,q]=(0,o.useState)({value:Y.to,validation:M(Y.to)}),ne=(0,o.useRef)(null),{overlayProps:oe,underlayProps:z}=(0,c.e)({onClose:()=>X(!1),isDismissable:!0,isOpen:H},ne),{dialogProps:te}=(0,f.s)({},ne),le=[(0,i.UU)({crossAxis:!1,boundary:document.body}),(0,i.BN)()],{context:ie,refs:ae,floatingStyles:re}=(0,s.we)({open:H,placement:"bottom-start",onOpenChange:X,middleware:le,whileElementsMounted:r.ll,strategy:"fixed"}),ce=(0,s.kp)(ie),me=(0,s.s9)(ie),{getReferenceProps:ee,getFloatingProps:de}=(0,s.bv)([me,ce]),De=(0,h.of)(w(Z.validation.errorMessage,j.validation.errorMessage)),fe=He=>{const Be=E(He);Be&&(k(),se({...Z,value:He.from}),q({...j,value:He.to}),K(Be))},Te=(0,o.useCallback)(He=>{He.stopPropagation(),He.preventDefault(),X(!H)},[H]),je=He=>{if(He.preventDefault(),!j.validation.isValid||!Z.validation.isValid)return;const Be=E({from:Z.value,to:j.value,display:""});Be&&(K(Be),X(!1))};return(0,t.jsxs)("div",{className:De.container,children:[(0,t.jsxs)("button",{ref:ae.setReference,className:De.pickerInput,type:"button",onClick:Te,...ee(),children:[(0,t.jsx)("span",{className:De.clockIcon,children:(0,t.jsx)(y.I,{name:"clock-nine"})}),(0,t.jsxs)("span",{children:[Y.from," to ",Y.to]}),(0,t.jsx)("span",{className:De.caretIcon,children:(0,t.jsx)(y.I,{name:H?"angle-up":"angle-down",size:"lg"})})]}),H&&(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{role:"presentation",className:De.backdrop,...z}),(0,t.jsx)(a.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("div",{ref:ne,...oe,...te,children:(0,t.jsx)("div",{className:De.content,ref:ae.setFloating,style:re,...de(),children:(0,t.jsxs)("div",{className:De.body,children:[(0,t.jsx)(p.A,{className:De.leftSide,hideHorizontalTrack:!0,children:(0,t.jsx)(D.l,{title:(0,g.t)("time-picker.time-range.example-title","Example time ranges"),options:A,onChange:fe,value:Y})}),(0,t.jsxs)("div",{className:De.rightSide,children:[(0,t.jsx)("div",{className:De.title,children:(0,t.jsx)(u.e,{children:(0,t.jsx)(v.m,{content:(0,t.jsx)(U,{}),placement:"bottom",theme:"info",children:(0,t.jsx)("div",{children:(0,t.jsxs)(g.x,{i18nKey:"time-picker.time-range.specify",children:["Specify time range ",(0,t.jsx)(y.I,{name:"info-circle"})]})})})})}),(0,t.jsx)(m.D,{label:"From",invalid:!Z.validation.isValid,error:Z.validation.errorMessage,children:(0,t.jsx)(d.p,{onClick:He=>He.stopPropagation(),onBlur:()=>se({...Z,validation:M(Z.value)}),onChange:He=>se({...Z,value:He.currentTarget.value}),value:Z.value})}),(0,t.jsx)(m.D,{label:"To",invalid:!j.validation.isValid,error:j.validation.errorMessage,children:(0,t.jsx)(d.p,{onClick:He=>He.stopPropagation(),onBlur:()=>q({...j,validation:M(j.value)}),onChange:He=>q({...j,value:He.currentTarget.value}),value:j.value})}),(0,t.jsx)(l.$n,{"aria-label":"TimePicker submit button",onClick:je,children:"Apply time range"})]})]})})})})]})]})}const U=()=>{const B=(0,h.of)(W);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:B.supported,children:["Supported formats: ",(0,t.jsx)("code",{className:B.tooltip,children:"now-[digit]s/m/h/d/w"})]}),(0,t.jsx)("div",{children:"Example: to select a time range from 10 minutes ago to now"}),(0,t.jsx)("code",{className:B.tooltip,children:"From: now-10m To: now"}),(0,t.jsxs)("div",{className:B.link,children:["For more information see"," ",(0,t.jsxs)("a",{href:"https://grafana.com/docs/grafana/latest/dashboards/time-range-controls/",children:["docs ",(0,t.jsx)(y.I,{name:"external-link-alt"})]}),"."]})]})},W=B=>({supported:(0,n.css)({marginBottom:B.spacing(1)}),tooltip:(0,n.css)({margin:0}),link:(0,n.css)({marginTop:B.spacing(1)})}),w=(B,V)=>K=>{const H=(0,d.n)({theme:K,invalid:!1}),k=250+N(K,B)+N(K,V);return{backdrop:(0,n.css)({position:"fixed",zIndex:K.zIndex.modalBackdrop,top:0,right:0,bottom:0,left:0}),container:(0,n.css)({display:"flex",position:"relative"}),pickerInput:(0,n.cx)(H.input,H.wrapper,(0,n.css)({display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",paddingRight:0,paddingLeft:0,lineHeight:`${K.spacing.gridSize*K.components.height.md-2}px`})),caretIcon:(0,n.cx)(H.suffix,(0,n.css)({position:"relative",marginLeft:K.spacing(.5)})),clockIcon:(0,n.cx)(H.prefix,(0,n.css)({position:"relative",marginRight:K.spacing(.5)})),content:(0,n.css)({background:K.colors.background.primary,boxShadow:K.shadows.z3,position:"absolute",zIndex:K.zIndex.modal,width:"500px",top:"100%",borderRadius:K.shape.radius.default,border:`1px solid ${K.colors.border.weak}`,left:0,whiteSpace:"normal"}),body:(0,n.css)({display:"flex",height:`${k}px`}),description:(0,n.css)({color:K.colors.text.secondary,fontSize:K.typography.size.sm}),leftSide:(0,n.css)({width:"50% !important",borderRight:`1px solid ${K.colors.border.medium}`}),rightSide:(0,n.css)({width:"50%",padding:K.spacing(1)}),title:(0,n.css)({marginBottom:K.spacing(1)})}};function N(B,V){return V?V.length>34?B.spacing.gridSize*6.5:B.spacing.gridSize*4:0}},66070:(G,O,e)=>{"use strict";e.d(O,{R:()=>g,i:()=>h});var t=e(74848),n=e(32196),i=e(79770),s=e(47232),r=e(40845),f=e(16797),a=e(87266),c=e(14578),o=e(78537);const h="time-of-day-picker-panel",g=({minuteStep:m=1,showHour:y=!0,showSeconds:d=!1,onChange:v,value:u,size:D="auto",disabled:P,disabledHours:x,disabledMinutes:E,disabledSeconds:C})=>{const M=(0,r.of)(p);return(0,t.jsx)(i.A,{className:(0,n.cx)((0,a.lH)()[D],M.input),popupClassName:(0,n.cx)(M.picker,h),defaultValue:(0,s.AN)(),onChange:S=>{if((0,s.u8)(S))return v((0,s.KQ)(S))},allowEmpty:!1,showSecond:d,value:(0,s.AN)(u),showHour:y,minuteStep:m,inputIcon:(0,t.jsx)(l,{wrapperStyle:M.caretWrapper}),disabled:P,disabledHours:x,disabledMinutes:E,disabledSeconds:C})},l=({wrapperStyle:m=""})=>(0,t.jsx)("div",{className:m,children:(0,t.jsx)(c.I,{name:"angle-down"})}),p=m=>{const y=m.components.input.background,d=m.v1.palette.black,v=m.colors.background.secondary,u=m.shape.radius.default,D=m.components.input.borderColor;return{caretWrapper:(0,n.css)({position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",display:"inline-block",textAlign:"right",color:m.colors.text.secondary}),picker:(0,n.css)({".rc-time-picker-panel-select":{fontSize:"14px",backgroundColor:y,color:m.colors.text.secondary,borderColor:D,li:{outlineWidth:"2px","&.rc-time-picker-panel-select-option-selected":{backgroundColor:"inherit",border:`1px solid ${m.v1.palette.orange}`,borderRadius:u,color:m.colors.text.primary},"&:hover":{background:v,color:m.colors.text.primary},"&.rc-time-picker-panel-select-option-disabled":{color:m.colors.action.disabledText}}},".rc-time-picker-panel-inner":{boxShadow:`0px 4px 4px ${d}`,backgroundColor:y,borderColor:D,borderRadius:u,marginTop:"3px",".rc-time-picker-panel-input-wrap":{marginRight:"2px","&, .rc-time-picker-panel-input":{backgroundColor:y,paddingTop:"2px"}},".rc-time-picker-panel-combobox":{display:"flex"}}}),input:(0,n.css)({".rc-time-picker-input":{backgroundColor:y,borderRadius:u,borderColor:D,color:m.colors.text.primary,height:m.spacing(4),"&:focus":(0,f.getFocusStyles)(m),"&:disabled":{backgroundColor:m.colors.action.disabledBackground,color:m.colors.action.disabledText,border:`1px solid ${m.colors.action.disabledBackground}`,"&:focus":{boxShadow:"none"}}}})}}},54230:(G,O,e)=>{"use strict";e.d(O,{b:()=>d});var t=e(74848),n=e(32196),i=e(96540),s=e(47232),r=e(43127),f=e(13544),a=e(40845),c=e(8866),o=e(14578),h=e(10354),g=e(85068),l=e(3799),p=e(32432),m=e(47619);const y=()=>{},d=({value:u,onChange:D,onChangeTimeZone:P=y,clearable:x,weekStart:E,hideTimeZone:C=!0,timeZone:M="browser",placeholder:S="Select time range",isReversed:I=!0,hideQuickRanges:T=!1,disabled:b=!1,showIcon:R=!1})=>{const[A,L]=(0,i.useState)(!1),U=(0,a.of)(v,b),W=V=>{V.stopPropagation(),V.preventDefault(),!b&&L(!A)},w=()=>{L(!1)},N=V=>{w(),D(V)},B=V=>{V.stopPropagation();const K=(0,s.KQ)(null),H=(0,s.KQ)(null);D({from:K,to:H,raw:{from:K,to:H}})};return(0,t.jsxs)("div",{className:U.container,children:[(0,t.jsxs)("button",{type:"button",className:U.pickerInput,"data-testid":f.Tp.components.TimePicker.openButton,onClick:W,children:[R&&(0,t.jsx)(o.I,{name:"clock-nine",size:"sm",className:U.icon}),(0,t.jsx)(l.f,{value:u,timeZone:M,placeholder:S}),!b&&(0,t.jsxs)("span",{className:U.caretIcon,children:[(0,m.X)(u)&&x&&(0,t.jsx)(o.I,{className:U.clearIcon,name:"times",size:"lg",onClick:B}),(0,t.jsx)(o.I,{name:A?"angle-up":"angle-down",size:"lg"})]})]}),A&&(0,t.jsx)(c.N,{includeButtonPress:!1,onClick:w,children:(0,t.jsx)(g.r,{timeZone:M,value:(0,m.X)(u)?u:(0,r.E2)(),onChange:N,quickOptions:p.o,onChangeTimeZone:P,className:U.content,hideTimeZone:C,isReversed:I,hideQuickRanges:T,weekStart:E})})]})},v=(u,D=!1)=>{const P=(0,h.n)({theme:u,invalid:!1});return{container:(0,n.css)({display:"flex",position:"relative"}),content:(0,n.css)({marginLeft:0,position:"absolute",top:"116%",zIndex:u.zIndex.dropdown}),pickerInput:(0,n.cx)(P.input,D&&P.inputDisabled,P.wrapper,(0,n.css)({display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",paddingRight:0,lineHeight:`${u.spacing.gridSize*4-2}px`})),caretIcon:(0,n.cx)(P.suffix,(0,n.css)({position:"relative",top:"-1px",marginLeft:u.spacing(.5)})),clearIcon:(0,n.css)({marginRight:u.spacing(.5),"&:hover":{color:u.colors.text.maxContrast}}),placeholder:(0,n.css)({color:u.colors.text.disabled,opacity:1}),icon:(0,n.css)({marginRight:u.spacing(.5)})}}},15666:(G,O,e)=>{"use strict";e.d(O,{$6:()=>P,_8:()=>C,xS:()=>E});var t=e(74848),n=e(32196),i=e(18828),s=e(85690),r=e(93225),f=e(96540),a=e(65879),c=e(72724),o=e(91410),h=e(85858),g=e(13544),l=e(40845),p=e(76412),m=e(19727),y=e(88448),d=e(27746),v=e(56034),u=e(85068),D=e(32432);function P(T){const[b,R]=(0,f.useState)(!1),{value:A,onMoveBackward:L,onMoveForward:U,onZoom:W,onError:w,timeZone:N,fiscalYearStartMonth:B,timeSyncButton:V,isSynced:K,history:H,onChangeTimeZone:X,onChangeFiscalYearStartMonth:k,hideQuickRanges:Y,widthOverride:Z,isOnCanvas:se,onToolbarTimePickerClick:j,weekStart:q}=T,ne=je=>{T.onChange(je),R(!1)};(0,f.useEffect)(()=>{b&&j&&j()},[b,j]);const oe=()=>{R(je=>!je)},z=()=>{R(!1)},te=(0,f.createRef)(),le=(0,f.createRef)(),{overlayProps:ie,underlayProps:ae}=(0,r.e)({onClose:z,isDismissable:!0,isOpen:b,shouldCloseOnInteractOutside:je=>!le.current?.contains(je)},te),{dialogProps:re}=(0,i.s)({},te),ce=(0,l.of)(S),{modalBackdrop:me}=(0,l.of)(y.o),ee=!a.isRelativeTime(A.raw.from)||!a.isRelativeTime(A.raw.to),de=K?"active":se?"canvas":"default",fe=A?.to?.isBefore(A.from)?"exclamation-triangle":"clock-nine",Te=M(A,N);return(0,t.jsxs)(m.e,{className:ce.container,children:[ee&&(0,t.jsx)(d.I,{"aria-label":(0,p.t)("time-picker.range-picker.backwards-time-aria-label","Move time range backwards"),variant:de,onClick:L,icon:"angle-left",narrow:!0}),(0,t.jsx)(v.m,{ref:le,content:(0,t.jsx)(E,{timeRange:A,timeZone:N}),placement:"bottom",interactive:!0,children:(0,t.jsx)(d.I,{"data-testid":g.Tp.components.TimePicker.openButton,"aria-label":(0,p.t)("time-picker.range-picker.current-time-selected","Time range selected: {{currentTimeRange}}",{currentTimeRange:Te}),"aria-controls":"TimePickerContent",onClick:oe,icon:fe,isOpen:b,variant:de,children:(0,t.jsx)(C,{...T})})}),b&&(0,t.jsxs)("div",{"data-testid":g.Tp.components.TimePicker.overlayContent,children:[(0,t.jsx)("div",{role:"presentation",className:(0,n.cx)(me,ce.backdrop),...ae}),(0,t.jsx)(s.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("section",{className:ce.content,ref:te,...ie,...re,children:(0,t.jsx)(u.r,{timeZone:N,fiscalYearStartMonth:B,value:A,onChange:ne,quickOptions:D.o,history:H,showHistory:!0,widthOverride:Z,onChangeTimeZone:X,onChangeFiscalYearStartMonth:k,hideQuickRanges:Y,onError:w,weekStart:q})})})]}),V,ee&&(0,t.jsx)(d.I,{"aria-label":(0,p.t)("time-picker.range-picker.forwards-time-aria-label","Move time range forwards"),onClick:U,icon:"angle-right",narrow:!0,variant:de}),(0,t.jsx)(v.m,{content:x,placement:"bottom",children:(0,t.jsx)(d.I,{"aria-label":(0,p.t)("time-picker.range-picker.zoom-out-button","Zoom out time range"),onClick:W,icon:"search-minus",variant:de})})]})}P.displayName="TimeRangePicker";const x=()=>(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(p.x,{i18nKey:"time-picker.range-picker.zoom-out-tooltip",children:["Time range zoom out ",(0,t.jsx)("br",{})," CTRL+Z"]})}),E=({timeRange:T,timeZone:b})=>{const R=(0,l.of)(I);return(0,t.jsxs)(t.Fragment,{children:[(0,c.LE)(T.from,{timeZone:b}),(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)(p.x,{i18nKey:"time-picker.range-picker.to",children:"to"})}),(0,c.LE)(T.to,{timeZone:b}),(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)("span",{className:R.utc,children:(0,o.le)(b)})})]})},C=(0,f.memo)(({hideText:T,value:b,timeZone:R})=>{const A=(0,l.of)(I);return T?null:(0,t.jsxs)("span",{className:A.container,"aria-live":"polite","aria-atomic":"true",children:[(0,t.jsx)("span",{children:M(b,R)}),(0,t.jsx)("span",{className:A.utc,children:a.describeTimeRangeAbbreviation(b,R)})]})});C.displayName="TimePickerButtonLabel";const M=(T,b)=>{const R={to:h.isMathString(T.raw.to)?T.raw.to:T.to,from:h.isMathString(T.raw.from)?T.raw.from:T.from};return a.describeTimeRange(R,b)},S=T=>({container:(0,n.css)({position:"relative",display:"flex",verticalAlign:"middle"}),backdrop:(0,n.css)({display:"none",[T.breakpoints.down("sm")]:{display:"block"}}),content:(0,n.css)({position:"absolute",right:0,top:"116%",zIndex:T.zIndex.dropdown,[T.breakpoints.down("sm")]:{position:"fixed",right:"50%",top:"50%",transform:"translate(50%, -50%)",zIndex:T.zIndex.modal}})}),I=T=>({container:(0,n.css)({display:"flex",alignItems:"center",whiteSpace:"nowrap"}),utc:(0,n.css)({color:T.v1.palette.orange,fontSize:T.typography.size.sm,paddingLeft:"6px",lineHeight:"28px",verticalAlign:"bottom",fontWeight:T.typography.fontWeightMedium})})},72265:(G,O,e)=>{"use strict";e.d(O,{h2:()=>y,nB:()=>g});var t=e(74848),n=e(32196),i=e(96540),s=e(29426),r=e(53531),f=e(40845),a=e(76412),c=e(14578),o=e(99225);const h={saturday:"islamic",sunday:"gregory",monday:"iso8601"};function g({onChange:d,from:v,to:u,timeZone:D,weekStart:P="monday"}){const x=l(v,u,new Date,D),E=p(d,D),C=(0,f.of)(y);return(0,t.jsx)(s.Ay,{selectRange:!0,next2Label:null,prev2Label:null,className:C.body,tileClassName:C.title,value:x,nextLabel:(0,t.jsx)(c.I,{name:"angle-right"}),nextAriaLabel:(0,a.t)("time-picker.calendar.next-month","Next month"),prevLabel:(0,t.jsx)(c.I,{name:"angle-left"}),prevAriaLabel:(0,a.t)("time-picker.calendar.previous-month","Previous month"),onChange:E,locale:"en",calendarType:h[P]})}g.displayName="Body";function l(d,v,u=new Date,D){let P=d.isValid()?d.toDate():u,x=v.isValid()?v.toDate():u;return D&&(P=(0,o.Q)(P,D),x=(0,o.Q)(x,D)),P>x?[x,P]:[P,x]}function p(d,v){return(0,i.useCallback)(u=>{if(!Array.isArray(u))return console.error("onCalendarChange: should be run in selectRange={true}");if(u[0]&&u[1]){const D=(0,r.b)(m(u[0]),{timeZone:v}),P=(0,r.b)(m(u[1]),{timeZone:v});d(D,P)}},[d,v])}function m(d){return[d.getFullYear(),d.getMonth(),d.getDate(),d.getHours(),d.getMinutes(),d.getSeconds()]}const y=d=>{const v=".react-calendar__tile--hasActive:not(.react-calendar__tile--range)";return{title:(0,n.css)({color:d.colors.text.primary,backgroundColor:d.colors.background.primary,fontSize:d.typography.size.md,border:"1px solid transparent","&:hover":{position:"relative"},"&:disabled":{color:d.colors.action.disabledText}}),body:(0,n.css)({zIndex:d.zIndex.modal,backgroundColor:d.colors.background.primary,width:"268px",".react-calendar__navigation":{display:"flex"},".react-calendar__navigation__label, .react-calendar__navigation__arrow, .react-calendar__navigation":{paddingTop:"4px",backgroundColor:"inherit",color:d.colors.text.primary,border:0,fontWeight:d.typography.fontWeightMedium},".react-calendar__month-view__weekdays":{backgroundColor:"inherit",textAlign:"center",color:d.colors.primary.text,abbr:{border:0,textDecoration:"none",cursor:"default",display:"block",padding:"4px 0 4px 0"}},".react-calendar__month-view__days":{backgroundColor:"inherit"},".react-calendar__tile, .react-calendar__tile--now":{marginBottom:"4px",backgroundColor:"inherit",height:"26px"},".react-calendar__navigation__label, .react-calendar__navigation > button:focus, .time-picker-calendar-tile:focus":{outline:0},[`${v}, .react-calendar__tile--active, .react-calendar__tile--active:hover`]:{color:d.colors.primary.contrastText,fontWeight:d.typography.fontWeightMedium,background:d.colors.primary.main,boxShadow:"none",border:"0px"},".react-calendar__tile--rangeEnd, .react-calendar__tile--rangeStart":{padding:0,border:"0px",color:d.colors.primary.contrastText,fontWeight:d.typography.fontWeightMedium,background:d.colors.primary.main,abbr:{backgroundColor:d.colors.primary.main,borderRadius:"100px",display:"block",paddingTop:"2px",height:"26px"}},[`${v}, .react-calendar__tile--rangeStart`]:{borderTopLeftRadius:"20px",borderBottomLeftRadius:"20px"},[`${v}, .react-calendar__tile--rangeEnd`]:{borderTopRightRadius:"20px",borderBottomRightRadius:"20px"}})}}},85068:(G,O,e)=>{"use strict";e.d(O,{r:()=>me});var t=e(74848),n=e(32196),i=e(96540),s=e(47232),r=e(65879),f=e(13544),a=e(40845),c=e(16797),o=e(76412),h=e(67647),g=e(14578),l=e(2543),p=e(91410),m=e(55852),y=e(88575),d=e(90182),v=e(63021),u=e(40675),D=e(40980),P=e(20333),x=e(79451),E=e(17624),C=e(67459),M=e(32432);const S=Re=>{const{timeZone:Se,fiscalYearStartMonth:We,timestamp:Ke=Date.now(),onChangeTimeZone:Xe,onChangeFiscalYearStartMonth:Je}=Re,[st,pt]=(0,i.useState)(!1),[xt,ot]=(0,i.useState)("tz"),$e=(0,i.useId)(),ve=(0,i.useId)(),be=(0,i.useId)(),he=(0,i.useCallback)(ge=>{ge&&ge.stopPropagation(),pt(!st)},[st,pt]),ye=(0,a.of)(I);if(!(0,l.isString)(Se))return null;const Pe=(0,p.QZ)(Se,Ke);return Pe?(0,t.jsxs)("div",{children:[(0,t.jsxs)("section",{"aria-label":(0,o.t)("time-picker.footer.time-zone-selection","Time zone selection"),className:ye.container,children:[(0,t.jsxs)("div",{className:ye.timeZoneContainer,children:[(0,t.jsxs)("div",{className:ye.timeZone,children:[(0,t.jsx)(C.U,{title:Pe.name}),(0,t.jsx)("div",{className:ye.spacer}),(0,t.jsx)(x.E,{info:Pe})]}),(0,t.jsx)(E.X,{timeZone:Se,timestamp:Ke})]}),(0,t.jsx)("div",{className:ye.spacer}),(0,t.jsx)(m.$n,{"data-testid":f.Tp.components.TimeZonePicker.changeTimeSettingsButton,variant:"secondary",onClick:he,size:"sm","aria-expanded":st,"aria-controls":$e,icon:st?"angle-up":"angle-down",children:(0,t.jsx)(o.x,{i18nKey:"time-picker.footer.change-settings-button",children:"Change time settings"})})]}),st?(0,t.jsxs)("div",{className:ye.editContainer,id:$e,children:[(0,t.jsxs)(v.U,{children:[(0,t.jsx)(u.o,{label:(0,o.t)("time-picker.footer.time-zone-option","Time zone"),active:xt==="tz",onChangeTab:()=>{ot("tz")},"aria-controls":ve}),(0,t.jsx)(u.o,{label:(0,o.t)("time-picker.footer.fiscal-year-option","Fiscal year"),active:xt==="fy",onChangeTab:()=>{ot("fy")},"aria-controls":be})]}),(0,t.jsx)(D.J,{children:xt==="tz"?(0,t.jsx)("section",{role:"tabpanel","data-testid":f.Tp.components.TimeZonePicker.containerV2,id:ve,className:(0,n.cx)(ye.timeZoneContainer,ye.timeSettingContainer),children:(0,t.jsx)(P.U,{includeInternal:!0,onChange:ge=>{he(),(0,l.isString)(ge)&&Xe(ge)},onBlur:he,menuShouldPortal:!1})}):(0,t.jsx)("section",{role:"tabpanel","data-testid":f.Tp.components.TimeZonePicker.containerV2,id:be,className:(0,n.cx)(ye.timeZoneContainer,ye.timeSettingContainer),children:(0,t.jsx)(y.D,{className:ye.fiscalYearField,label:(0,o.t)("time-picker.footer.fiscal-year-start","Fiscal year start month"),children:(0,t.jsx)(d.l6,{value:We,menuShouldPortal:!1,options:M.Z,onChange:ge=>{Je&&Je(ge.value??0)}})})})})]}):null]}):null},I=Re=>({container:(0,n.css)({borderTop:`1px solid ${Re.colors.border.weak}`,padding:Re.spacing(1.5),display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"}),editContainer:(0,n.css)({borderTop:`1px solid ${Re.colors.border.weak}`,padding:Re.spacing(1.5),paddingTop:0,justifyContent:"space-between",alignItems:"center"}),spacer:(0,n.css)({marginLeft:"7px"}),timeSettingContainer:(0,n.css)({paddingTop:Re.spacing(1)}),fiscalYearField:(0,n.css)({marginBottom:0}),timeZoneContainer:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",flexGrow:1}),timeZone:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"baseline",flexGrow:1})});var T=e(42617),b=e(53531),R=e(72724),A=e(10354),L=e(56034),U=e(47619),W=e(18828),w=e(85690),N=e(93225),B=e(59875),V=e(88448),K=e(72265),H=e(67061);function X({onClose:Re,onApply:Se}){return(0,t.jsxs)(H.B,{gap:2,justifyContent:"space-between",children:[(0,t.jsx)(m.$n,{variant:"secondary",onClick:Re,children:(0,t.jsx)(o.x,{i18nKey:"time-picker.calendar.cancel-button",children:"Cancel"})}),(0,t.jsx)(m.$n,{onClick:Se,children:(0,t.jsx)(o.x,{i18nKey:"time-picker.calendar.apply-button",children:"Apply time range"})})]})}X.displayName="Footer";var k=e(29158);function Y({onClose:Re}){return(0,t.jsxs)(H.B,{justifyContent:"space-between",children:[(0,t.jsx)(T.e,{children:(0,t.jsx)(o.x,{i18nKey:"time-picker.calendar.select-time",children:"Select a time range"})}),(0,t.jsx)(k.K,{"data-testid":f.Tp.components.TimePicker.calendar.closeButton,tooltip:(0,o.t)("time-picker.calendar.close","Close calendar"),name:"times",variant:"secondary",onClick:Re})]})}Y.displayName="Header";const Z=(Re,Se=!1)=>({container:(0,n.css)({top:0,position:"absolute",[`${Se?"left":"right"}`]:"546px"}),modalContainer:(0,n.css)({label:"modalContainer",margin:"0 auto"}),calendar:(0,n.css)({display:"flex",flexDirection:"column",gap:Re.spacing(1),padding:Re.spacing(1),label:"calendar",boxShadow:Re.shadows.z3,backgroundColor:Re.colors.background.primary,border:`1px solid ${Re.colors.border.weak}`,borderRadius:Re.shape.radius.default}),modal:(0,n.css)({label:"modal",boxShadow:Re.shadows.z3,left:"50%",position:"fixed",top:"50%",transform:"translate(-50%, -50%)",zIndex:Re.zIndex.modal})});function se(Re){const Se=(0,a.$j)(),{modalBackdrop:We}=(0,a.of)(V.o),Ke=Z(Se,Re.isReversed),{isOpen:Xe,isFullscreen:Je,onClose:st}=Re,pt=(0,i.createRef)(),{dialogProps:xt}=(0,W.s)({"aria-label":f.Tp.components.TimePicker.calendar.label},pt),{overlayProps:ot}=(0,N.e)({isDismissable:!0,isOpen:Xe,onClose:st},pt),$e=!Je;if(!Xe)return null;const ve=(0,t.jsxs)("section",{className:Ke.calendar,ref:pt,...ot,...xt,"data-testid":f.Tp.components.TimePicker.calendar.label,children:[(0,t.jsx)(Y,{...Re}),(0,t.jsx)(K.nB,{...Re}),$e&&(0,t.jsx)(X,{...Re})]});return $e?(0,t.jsxs)(B.Sf,{children:[(0,t.jsx)("div",{className:We}),(0,t.jsx)(w.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("div",{className:Ke.modal,children:(0,t.jsx)("div",{className:Ke.modalContainer,children:ve})})})]}):(0,t.jsx)(w.n1,{contain:!0,restoreFocus:!0,autoFocus:!0,children:(0,t.jsx)("div",{className:Ke.container,children:ve})})}const j=(0,i.memo)(se);se.displayName="TimePickerCalendar";const q={default:()=>(0,o.t)("time-picker.range-content.default-error",'Please enter a past date or "now"'),range:()=>(0,o.t)("time-picker.range-content.range-error",`"From" can't be after "To"`)},ne=Re=>{const{value:Se,isFullscreen:We=!1,timeZone:Ke,onApply:Xe,isReversed:Je,fiscalYearStartMonth:st,onError:pt,weekStart:xt}=Re,[ot,$e]=z(Se.raw.from,Se.raw.to,Ke),ve=(0,a.of)(le),[be,he]=(0,i.useState)(ot),[ye,Pe]=(0,i.useState)($e),[ge,xe]=(0,i.useState)(!1),Ae=(0,i.useId)(),Ee=(0,i.useId)();(0,i.useEffect)(()=>{const[zt,on]=z(Se.raw.from,Se.raw.to,Ke);he(zt),Pe(on)},[Se.raw.from,Se.raw.to,Ke]);const Ie=(0,i.useCallback)(zt=>{zt.preventDefault(),xe(!0)},[xe]),Qe=(0,i.useCallback)(()=>{if(ye.invalid||be.invalid)return;const zt={from:be.value,to:ye.value},on=r.convertRawToRange(zt,Ke,st);Xe(on)},[be.invalid,be.value,Xe,Ke,ye.invalid,ye.value,st]),at=(0,i.useCallback)((zt,on)=>{const[Pn,_n]=z(zt,on,Ke);he(Pn),Pe(_n)},[Ke]),ft=zt=>{zt.key==="Enter"&&Qe()},ct=()=>{const zt={from:be.value,to:ye.value};navigator.clipboard.writeText(JSON.stringify(zt))},vt=async()=>{const zt=await navigator.clipboard.readText();let on;try{on=JSON.parse(zt)}catch{pt&&pt(zt);return}const[Pn,_n]=z(on.from,on.to,Ke);he(Pn),Pe(_n)},Pt=r.convertRawToRange({from:"now/fy",to:"now/fy"},Ke,st),Vt=(0,o.t)("time-picker.range-content.fiscal-year","Fiscal year"),Jt=(0,t.jsx)("div",{className:ve.tooltip,children:r.isFiscal(Se)?(0,t.jsx)(L.m,{content:`${Vt}: ${Pt.from.format("MMM-DD")} - ${Pt.to.format("MMM-DD")}`,children:(0,t.jsx)(g.I,{name:"info-circle"})}):null}),wt=(0,t.jsx)(m.$n,{"aria-label":(0,o.t)("time-picker.range-content.open-input-calendar","Open calendar"),"data-testid":f.Tp.components.TimePicker.calendar.openButton,icon:"calendar-alt",variant:"secondary",type:"button",onClick:Ie});return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:ve.fieldContainer,children:[(0,t.jsx)(y.D,{label:(0,o.t)("time-picker.range-content.from-input","From"),invalid:be.invalid,error:be.errorMessage,children:(0,t.jsx)(A.p,{id:Ae,onClick:zt=>zt.stopPropagation(),onChange:zt=>at(zt.currentTarget.value,ye.value),addonAfter:wt,onKeyDown:ft,"data-testid":f.Tp.components.TimePicker.fromField,value:be.value})}),Jt]}),(0,t.jsxs)("div",{className:ve.fieldContainer,children:[(0,t.jsx)(y.D,{label:(0,o.t)("time-picker.range-content.to-input","To"),invalid:ye.invalid,error:ye.errorMessage,children:(0,t.jsx)(A.p,{id:Ee,onClick:zt=>zt.stopPropagation(),onChange:zt=>at(be.value,zt.currentTarget.value),addonAfter:wt,onKeyDown:ft,"data-testid":f.Tp.components.TimePicker.toField,value:ye.value})}),Jt]}),(0,t.jsxs)("div",{className:ve.buttonsContainer,children:[(0,t.jsx)(m.$n,{"data-testid":f.Tp.components.TimePicker.copyTimeRange,icon:"copy",variant:"secondary",tooltip:(0,o.t)("time-picker.copy-paste.tooltip-copy","Copy time range to clipboard"),type:"button",onClick:ct}),(0,t.jsx)(m.$n,{"data-testid":f.Tp.components.TimePicker.pasteTimeRange,icon:"clipboard-alt",variant:"secondary",tooltip:(0,o.t)("time-picker.copy-paste.tooltip-paste","Paste time range"),type:"button",onClick:vt}),(0,t.jsx)(m.$n,{"data-testid":f.Tp.components.TimePicker.applyTimeRange,type:"button",onClick:Qe,children:(0,t.jsx)(o.x,{i18nKey:"time-picker.range-content.apply-button",children:"Apply time range"})})]}),(0,t.jsx)(j,{isFullscreen:We,isOpen:ge,from:(0,b.b)(be.value,{timeZone:Ke}),to:(0,b.b)(ye.value,{timeZone:Ke}),onApply:Qe,onClose:()=>xe(!1),onChange:at,timeZone:Ke,isReversed:Je,weekStart:xt})]})};function oe(Re,Se,We){const Ke={from:Re,to:Se},Xe=r.convertRawToRange(Ke,We);return!(Xe.from.isSame(Xe.to)||Xe.from.isBefore(Xe.to))}function z(Re,Se,We){const Ke=te(Re,We),Xe=te(Se,We),Je=!(0,U.f)(Ke,!1,We),st=!(0,U.f)(Xe,!0,We),pt=oe(Ke,Xe,We)&&!st;return[{value:Ke,invalid:Je||pt,errorMessage:pt&&!Je?q.range():q.default()},{value:Xe,invalid:st,errorMessage:q.default()}]}function te(Re,Se){return(0,s.Ar)(Re)?(0,R.LE)(Re,{timeZone:Se}):Re}function le(Re){return{fieldContainer:(0,n.css)({display:"flex"}),buttonsContainer:(0,n.css)({display:"flex",gap:Re.spacing(.5),marginTop:Re.spacing(1)}),tooltip:(0,n.css)({paddingLeft:Re.spacing(1),paddingTop:Re.spacing(3)})}}var ie=e(11752);const ae=(Re,Se)=>r.convertRawToRange({from:Re.from,to:Re.to},Se),re=(Re,Se)=>{const We=(0,R.LE)(Re.from,{timeZone:Se}),Ke=(0,R.LE)(Re.to,{timeZone:Se});return{from:We,to:Ke,display:`${We} to ${Ke}`}},ce=Re=>{const{quickOptions:Se=[],isReversed:We,isFullscreen:Ke,hideQuickRanges:Xe,timeZone:Je,fiscalYearStartMonth:st,value:pt,onChange:xt,history:ot,showHistory:$e,className:ve,hideTimeZone:be,onChangeTimeZone:he,onChangeFiscalYearStartMonth:ye}=Re,Pe=!ot?.length,ge=Ke&&$e||!Ke&&($e&&!Pe||!Xe),xe=(0,a.of)(je,We,Xe,ge,Ke),Ae=fe(ot,Je),Ee=Te(pt.raw,Se),[Ie,Qe]=(0,i.useState)(""),at=Se.filter(ct=>ct.display.toLowerCase().includes(Ie.toLowerCase())),ft=ct=>xt(ae(ct));return(0,t.jsxs)("div",{id:"TimePickerContent",className:(0,n.cx)(xe.container,ve),children:[(0,t.jsxs)("div",{className:xe.body,children:[(!Ke||!Xe)&&(0,t.jsxs)("div",{className:xe.rightSide,children:[(0,t.jsx)("div",{className:xe.timeRangeFilter,children:(0,t.jsx)(h.Z,{width:0,value:Ie,onChange:Qe,placeholder:(0,o.t)("time-picker.content.filter-placeholder","Search quick ranges")})}),(0,t.jsxs)("div",{className:xe.scrollContent,children:[!Ke&&(0,t.jsx)(ee,{...Re,historyOptions:Ae}),!Xe&&(0,t.jsx)(ie.l,{options:at,onChange:ft,value:Ee})]})]}),Ke&&(0,t.jsx)("div",{className:xe.leftSide,children:(0,t.jsx)(de,{...Re,historyOptions:Ae})})]}),!be&&Ke&&(0,t.jsx)(S,{timeZone:Je,fiscalYearStartMonth:st,onChangeTimeZone:he,onChangeFiscalYearStartMonth:ye})]})},me=Re=>{const{widthOverride:Se}=Re,We=(0,a.$j)(),Ke=(Se||window.innerWidth)>=We.breakpoints.values.lg;return(0,t.jsx)(ce,{...Re,isFullscreen:Ke})},ee=Re=>{const{value:Se,hideQuickRanges:We,onChange:Ke,timeZone:Xe,historyOptions:Je=[],showHistory:st,onError:pt,weekStart:xt}=Re,ot=(0,a.of)(He),$e=(0,s.Ar)(Se.raw.from)||(0,s.Ar)(Se.raw.to),[ve,be]=(0,i.useState)(!$e),he=We?!1:ve,ye=Pe=>Ke(ae(Pe,Xe));return(0,t.jsxs)("fieldset",{children:[(0,t.jsx)("div",{className:ot.header,children:(0,t.jsxs)("button",{type:"button",className:ot.expandButton,onClick:()=>{We||be(!he)},"data-testid":f.Tp.components.TimePicker.absoluteTimeRangeTitle,"aria-expanded":!he,"aria-controls":"expanded-timerange",children:[(0,t.jsx)(T.e,{children:(0,t.jsx)(o.x,{i18nKey:"time-picker.absolute.title",children:"Absolute time range"})}),!We&&(0,t.jsx)(g.I,{name:he?"angle-down":"angle-up"})]})}),!he&&(0,t.jsxs)("div",{className:ot.body,id:"expanded-timerange",children:[(0,t.jsx)("div",{className:ot.form,children:(0,t.jsx)(ne,{value:Se,onApply:Ke,timeZone:Xe,isFullscreen:!1,onError:pt,weekStart:xt})}),st&&(0,t.jsx)(ie.l,{title:(0,o.t)("time-picker.absolute.recent-title","Recently used absolute ranges"),options:Je,onChange:ye,placeholderEmpty:null})]})]})},de=Re=>{const{onChange:Se,value:We,timeZone:Ke,fiscalYearStartMonth:Xe,isReversed:Je,historyOptions:st,onError:pt,weekStart:xt}=Re,ot=(0,a.of)(Be,Re.hideQuickRanges),$e=ve=>Se(ae(ve,Ke));return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:ot.container,children:[(0,t.jsx)("div",{className:ot.title,"data-testid":f.Tp.components.TimePicker.absoluteTimeRangeTitle,children:(0,t.jsx)(T.e,{children:(0,t.jsx)(o.x,{i18nKey:"time-picker.absolute.title",children:"Absolute time range"})})}),(0,t.jsx)(ne,{value:We,timeZone:Ke,fiscalYearStartMonth:Xe,onApply:Se,isFullscreen:!0,isReversed:Je,onError:pt,weekStart:xt})]}),Re.showHistory&&(0,t.jsx)("div",{className:ot.recent,children:(0,t.jsx)(ie.l,{title:(0,o.t)("time-picker.absolute.recent-title","Recently used absolute ranges"),options:st||[],onChange:$e,placeholderEmpty:(0,t.jsx)(De,{})})})]})},De=(0,i.memo)(()=>{const Re=(0,a.of)(Ne),Se=(0,o.t)("time-picker.content.empty-recent-list-info","It looks like you haven't used this time picker before. As soon as you enter some time intervals, recently used intervals will appear here.");return(0,t.jsxs)("div",{className:Re.container,children:[(0,t.jsx)("div",{children:(0,t.jsx)("span",{children:Se})}),(0,t.jsx)(o.x,{i18nKey:"time-picker.content.empty-recent-list-docs",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("a",{className:Re.link,href:"https://grafana.com/docs/grafana/latest/dashboards/time-range-controls",target:"_new",children:"Read the documentation"}),(0,t.jsx)("span",{children:" to find out more about how to enter custom time ranges."})]})})]})});function fe(Re,Se){return!Array.isArray(Re)||Re.length===0?[]:Re.map(We=>re(We,Se))}De.displayName="EmptyRecentList";const Te=(Re,Se)=>(0,i.useMemo)(()=>{if(r.isRelativeTimeRange(Re))return Se.find(We=>We.from===Re.from&&We.to===Re.to)},[Re,Se]),je=(Re,Se,We,Ke,Xe)=>({container:(0,n.css)({background:Re.colors.background.primary,boxShadow:Re.shadows.z3,width:`${Xe?"546px":"262px"}`,borderRadius:Re.shape.radius.default,border:`1px solid ${Re.colors.border.weak}`,[`${Se?"left":"right"}`]:0,display:"flex",flexDirection:"column"}),body:(0,n.css)({display:"flex",flexDirection:"row-reverse",height:`${Ke?"381px":"217px"}`,maxHeight:"100vh"}),leftSide:(0,n.css)({display:"flex",flexDirection:"column",borderRight:`${Se?"none":`1px solid ${Re.colors.border.weak}`}`,width:`${We?"100%":"60%"}`,overflow:"auto",scrollbarWidth:"thin",order:Se?1:0}),rightSide:(0,n.css)({width:`${Xe?"40%":"100%"}; !important`,borderRight:Se?`1px solid ${Re.colors.border.weak}`:"none",display:"flex",flexDirection:"column"}),timeRangeFilter:(0,n.css)({padding:Re.spacing(1)}),spacing:(0,n.css)({marginTop:"16px"}),scrollContent:(0,n.css)({overflowY:"auto",scrollbarWidth:"thin"})}),He=Re=>({header:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderBottom:`1px solid ${Re.colors.border.weak}`,padding:"7px 9px 7px 9px"}),expandButton:(0,n.css)({backgroundColor:"transparent",border:"none",display:"flex",width:"100%","&:focus-visible":(0,c.getFocusStyles)(Re)}),body:(0,n.css)({borderBottom:`1px solid ${Re.colors.border.weak}`}),form:(0,n.css)({padding:"7px 9px 7px 9px"})}),Be=(Re,Se)=>({container:(0,n.css)({paddingTop:"9px",paddingLeft:"11px",paddingRight:Se?"11px":"20%"}),title:(0,n.css)({marginBottom:"11px"}),recent:(0,n.css)({flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"flex-end",paddingTop:Re.spacing(1)})}),Ne=Re=>({container:(0,n.css)({padding:"12px",margin:"12px","a, span":{fontSize:"13px"}}),link:(0,n.css)({color:Re.colors.text.link})})},42617:(G,O,e)=>{"use strict";e.d(O,{e:()=>f});var t=e(74848),n=e(32196),i=e(96540),s=e(40845);const r=a=>({text:(0,n.css)({fontSize:a.typography.size.md,fontWeight:a.typography.fontWeightMedium,color:a.colors.text.primary,margin:0,display:"flex"})}),f=(0,i.memo)(({children:a})=>{const c=(0,s.of)(r);return(0,t.jsx)("h3",{className:c.text,children:a})});f.displayName="TimePickerTitle"},3799:(G,O,e)=>{"use strict";e.d(O,{f:()=>a});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(15666),f=e(47619);const a=(0,i.memo)(function({hideText:h,value:g,timeZone:l="browser",placeholder:p="No time range selected",className:m}){const y=(0,s.of)(c);return h?null:(0,t.jsx)("span",{className:m,children:(0,f.X)(g)?(0,t.jsx)(r._8,{value:g,timeZone:l}):(0,t.jsx)("span",{className:y.placeholder,children:p})})}),c=o=>({placeholder:(0,n.css)({color:o.colors.text.disabled,opacity:1})})},11752:(G,O,e)=>{"use strict";e.d(O,{l:()=>m});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(76412),f=e(42617),a=e(62938),c=e(16797);const o=P=>({container:(0,n.css)({display:"flex",alignItems:"center",flexDirection:"row-reverse",justifyContent:"space-between"}),selected:(0,n.css)({background:P.colors.action.selected,fontWeight:P.typography.fontWeightMedium}),radio:(0,n.css)({opacity:0,width:"0 !important","&:focus-visible + label":(0,c.getFocusStyles)(P)}),label:(0,n.css)({cursor:"pointer",flex:1,padding:"7px 9px 7px 9px","&:hover":{background:P.colors.action.hover,cursor:"pointer"}})}),h=(0,i.memo)(({value:P,onSelect:x,selected:E=!1,name:C})=>{const M=(0,s.of)(o),S=(0,a.A)();return(0,t.jsxs)("li",{className:(0,n.cx)(M.container,E&&M.selected),children:[(0,t.jsx)("input",{className:M.radio,checked:E,name:C,type:"checkbox","data-role":"item",tabIndex:-1,id:S,onChange:()=>x(P)}),(0,t.jsx)("label",{className:M.label,htmlFor:S,children:P.display})]})});h.displayName="TimeRangeOption";const g=(P,x)=>(P%x+x)%x,l=["ArrowUp","ArrowDown","Home","End","Enter","Tab"],p=({localRef:P,options:x})=>{const[E,C]=(0,i.useState)(0);return(0,i.useEffect)(()=>{const S=P.current?.querySelectorAll('[data-role="item"]')||[],I=Array.from(S).findIndex(b=>b.checked),T=I>=0?I:0;S.forEach((b,R)=>{b.tabIndex=R===T?0:-1}),C(T)},[P,x]),[S=>{const I=P?.current?.querySelectorAll('[data-role="item"]'),T=I?.length??0;l.indexOf(S.key)>-1&&(S.preventDefault(),S.key!=="Tab"&&S.stopPropagation());let b=null;switch(S.key){case"ArrowUp":b=g(E-1,T);break;case"ArrowDown":b=g(E+1,T);break;case"Home":b=0;break;case"End":b=T-1;break;case"Enter":I?.[E]?.click();break;default:break}b!==null&&(C(b),I?.[b]?.focus(),I?.forEach((R,A)=>{R.tabIndex=A===b?0:-1}))}]},m=P=>{const x=(0,s.of)(u),{title:E,options:C,placeholderEmpty:M}=P;return typeof M<"u"&&C.length<=0?(0,t.jsx)(t.Fragment,{children:M}):E?(0,t.jsx)("section",{"aria-label":E,children:(0,t.jsxs)("fieldset",{children:[(0,t.jsx)("div",{className:x.title,children:(0,t.jsx)(f.e,{children:E})}),(0,t.jsx)(y,{...P})]})}):(0,t.jsx)(y,{...P})},y=({options:P,value:x,onChange:E,title:C})=>{const M=(0,s.of)(D),S=(0,i.useRef)(null),[I]=p({localRef:S,options:P});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("ul",{role:"presentation",onKeyDown:I,ref:S,"aria-roledescription":(0,r.t)("time-picker.time-range.aria-role","Time range selection"),children:P.map((T,b)=>(0,t.jsx)(h,{value:T,selected:v(T,x),onSelect:E,name:C??(0,r.t)("time-picker.time-range.default-title","Time ranges")},d(T,b)))}),(0,t.jsx)("div",{className:M.grow})]})};function d(P,x){return`${P.from}-${P.to}-${x}`}function v(P,x){return!x||!P?!1:x.from===P.from&&x.to===P.to}const u=()=>({title:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 16px 5px 9px"})}),D=()=>({grow:(0,n.css)({flexGrow:1,alignItems:"flex-start"})})},20333:(G,O,e)=>{"use strict";e.d(O,{U:()=>P});var t=e(74848),n=e(2543),i=e(96540),s=e(91410),r=e(76412),f=e(90182),a=e(32196),c=e(40845);const o=I=>{const{children:T,label:b}=I,R=(0,c.of)(h);return b?(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:R.header,children:(0,t.jsx)("span",{className:R.label,children:b})}),T]}):(0,t.jsx)("div",{children:T})},h=I=>({header:(0,a.css)({padding:"7px 10px",width:"100%",borderTop:`1px solid ${I.colors.border.weak}`,textTransform:"capitalize"}),label:(0,a.css)({fontSize:I.typography.size.sm,color:I.colors.text.secondary,fontWeight:I.typography.fontWeightMedium})});var g=e(17624),l=e(13544),p=e(14578),m=e(79451),y=e(67459);const d="tz-utc-offset",v=I=>{const{children:T,innerProps:b,innerRef:R,data:A,isSelected:L,isFocused:U}=I,W=(0,c.of)(D),w=Date.now(),N=(0,a.cx)(W.container,U&&W.containerFocused);if(!(0,n.isString)(A.value))return null;const B=(0,s.QZ)(A.value,w);return(0,t.jsx)("div",{className:N,...b,ref:R,"data-testid":l.Tp.components.Select.option,children:(0,t.jsxs)("div",{className:(0,a.cx)(W.leftColumn,W.row),children:[(0,t.jsxs)("div",{className:(0,a.cx)(W.leftColumn,W.wideRow),children:[(0,t.jsx)(y.U,{title:T}),(0,t.jsx)("div",{className:W.spacer}),(0,t.jsx)(m.E,{info:B})]}),(0,t.jsxs)("div",{className:W.rightColumn,children:[(0,t.jsx)(g.X,{timeZone:B?.ianaName||A.value,timestamp:w,className:d}),L&&(0,t.jsx)("span",{children:(0,t.jsx)(p.I,{name:"check"})})]})]})})},u=I=>{const{children:T,innerProps:b,innerRef:R,data:A,isSelected:L,isFocused:U}=I,W=(0,c.of)(D),w=Date.now(),N=(0,a.cx)(W.container,U&&W.containerFocused);if(!(0,n.isString)(A.value))return null;const B=(0,s.QZ)(A.value,w);return(0,t.jsx)("div",{className:N,...b,ref:R,"data-testid":l.Tp.components.Select.option,children:(0,t.jsxs)("div",{className:W.body,children:[(0,t.jsxs)("div",{className:W.row,children:[(0,t.jsx)("div",{className:W.leftColumn,children:(0,t.jsx)(y.U,{title:T})}),(0,t.jsx)("div",{className:W.rightColumn,children:L&&(0,t.jsx)("span",{children:(0,t.jsx)(p.I,{name:"check"})})})]}),(0,t.jsxs)("div",{className:W.row,children:[(0,t.jsx)("div",{className:W.leftColumn,children:(0,t.jsx)(m.E,{info:B})}),(0,t.jsx)("div",{className:W.rightColumn,children:(0,t.jsx)(g.X,{timestamp:w,timeZone:B?.ianaName||A.value,className:d})})]})]})})},D=I=>({container:(0,a.css)({display:"flex",alignItems:"center",flexDirection:"row",flexShrink:0,whiteSpace:"nowrap",cursor:"pointer",padding:"6px 8px 4px","&:hover":{background:I.colors.action.hover}}),containerFocused:(0,a.css)({background:I.colors.action.hover}),body:(0,a.css)({display:"flex",fontWeight:I.typography.fontWeightMedium,flexDirection:"column",flexGrow:1}),row:(0,a.css)({display:"flex",flexDirection:"row"}),leftColumn:(0,a.css)({flexGrow:1,textOverflow:"ellipsis"}),rightColumn:(0,a.css)({justifyContent:"flex-end",alignItems:"center"}),wideRow:(0,a.css)({display:"flex",flexDirection:"row",alignItems:"baseline"}),spacer:(0,a.css)({marginLeft:"6px"})}),P=I=>{const{onChange:T,width:b,autoFocus:R=!1,onBlur:A,value:L,includeInternal:U=!1,disabled:W=!1,inputId:w,menuShouldPortal:N=!0,openMenuOnFocus:B=!0}=I,V=x(U),K=E(V,L),H=M(),X=b&&b<=45?u:v,k=(0,i.useCallback)(Y=>{if(!Y||!(0,n.isString)(Y.value))return T(L);T(Y.value)},[T,L]);return(0,t.jsx)(f.l6,{inputId:w,value:K,placeholder:(0,r.t)("time-picker.zone.select-search-input","Type to search (country, city, abbreviation)"),autoFocus:R,menuShouldPortal:N,openMenuOnFocus:B,width:b,filterOption:H,options:V,onChange:k,onBlur:A,components:{Option:X,Group:o},disabled:W,"aria-label":(0,r.t)("time-picker.zone.select-aria-label","Time zone picker")})},x=I=>{const T=Date.now();return(0,s.U3)(I).map(R=>{const A=R.zones.reduce((L,U)=>{const W=(0,s.QZ)(U,T);return W&&L.push({label:W.name,value:W.zone,searchIndex:S(W,T)}),L},[]);return{label:R.name,options:A}})},E=(I,T)=>(0,i.useMemo)(()=>{if(T===void 0)return;const b=(0,n.toLower)(T);return I.find(A=>A.label?b.startsWith((0,n.toLower)(A.label)):C(b))?.options.find(A=>(0,n.isEmpty)(b)?A.value===s.g$.default:(0,n.toLower)(A.value)===b)},[I,T]),C=I=>{switch(I){case s.g$.default:case s.g$.localBrowserTime:case s.g$.utc:return!0;default:return!1}},M=()=>(0,i.useCallback)((I,T)=>!T||!I.data||!I.data.searchIndex?!0:I.data.searchIndex.indexOf((0,n.toLower)(T))>-1,[]),S=(I,T)=>{const b=[(0,n.toLower)(I.name),(0,n.toLower)(I.abbreviation),(0,n.toLower)((0,g.t)(T,I.zone))];for(const R of I.countries)b.push((0,n.toLower)(R.name)),b.push((0,n.toLower)(R.code));return b.join("|")}},79451:(G,O,e)=>{"use strict";e.d(O,{E:()=>r});var t=e(74848),n=e(32196),i=e(96540),s=e(40845);const r=({info:c})=>{const o=(0,s.of)(a),h=f(c);return c?(0,t.jsx)("div",{className:o.description,children:h}):null},f=c=>(0,i.useMemo)(()=>{const o=[];if(!c)return"";if(c.name==="Europe/Simferopol")return"Ukraine, EEST";if(c.countries.length>0){const h=c.countries[0];o.push(h.name)}return c.abbreviation&&o.push(c.abbreviation),o.join(", ")},[c]),a=c=>({description:(0,n.css)({fontWeight:"normal",fontSize:c.typography.size.sm,color:c.colors.text.secondary,whiteSpace:"normal",textOverflow:"ellipsis"})})},17624:(G,O,e)=>{"use strict";e.d(O,{X:()=>a,t:()=>c});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(72724),f=e(40845);const a=h=>{const{timestamp:g,timeZone:l,className:p}=h,m=(0,f.of)(o);return(0,i.isString)(l)?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("span",{className:(0,n.cx)(m.offset,p),children:c(g,l)})}):null},c=(h,g)=>`UTC${(0,r.LE)(h,{timeZone:g,format:"Z"})}`,o=h=>{const g=(0,n.css)({fontWeight:"normal",fontSize:h.typography.size.sm,color:h.colors.text.secondary,whiteSpace:"normal"});return{offset:(0,n.css)(g,{color:h.colors.text.primary,background:h.colors.background.secondary,padding:"2px 5px",borderRadius:h.shape.radius.default,marginLeft:"4px"})}}},67459:(G,O,e)=>{"use strict";e.d(O,{U:()=>s});var t=e(74848),n=e(32196),i=e(40845);const s=({title:f})=>{const a=(0,i.of)(r);return f?(0,t.jsx)("span",{className:a.title,children:f}):null},r=f=>({title:(0,n.css)({fontWeight:f.typography.fontWeightRegular,textOverflow:"ellipsis"})})},15648:(G,O,e)=>{"use strict";e.d(O,{l:()=>c,r:()=>a});var t=e(74848),n=e(96540),i=e(13544),s=e(90182);const r=[{value:"",label:"Default"},{value:"saturday",label:"Saturday"},{value:"sunday",label:"Sunday"},{value:"monday",label:"Monday"}],f=o=>["saturday","sunday","monday"].includes(o),a=o=>f(o)?o:"monday",c=o=>{const{onChange:h,width:g,autoFocus:l=!1,onBlur:p,value:m,disabled:y=!1,inputId:d}=o,v=(0,n.useCallback)(u=>{u.value!==void 0&&h(u.value)},[h]);return(0,t.jsx)(s.l6,{inputId:d,value:r.find(u=>u.value===m)?.value,placeholder:i.Tp.components.WeekStartPicker.placeholder,autoFocus:l,openMenuOnFocus:!0,width:g,options:r,onChange:v,onBlur:p,disabled:y})}},32432:(G,O,e)=>{"use strict";e.d(O,{Z:()=>n,o:()=>t});const t=[{from:"now-5m",to:"now",display:"Last 5 minutes"},{from:"now-15m",to:"now",display:"Last 15 minutes"},{from:"now-30m",to:"now",display:"Last 30 minutes"},{from:"now-1h",to:"now",display:"Last 1 hour"},{from:"now-3h",to:"now",display:"Last 3 hours"},{from:"now-6h",to:"now",display:"Last 6 hours"},{from:"now-12h",to:"now",display:"Last 12 hours"},{from:"now-24h",to:"now",display:"Last 24 hours"},{from:"now-2d",to:"now",display:"Last 2 days"},{from:"now-7d",to:"now",display:"Last 7 days"},{from:"now-30d",to:"now",display:"Last 30 days"},{from:"now-90d",to:"now",display:"Last 90 days"},{from:"now-6M",to:"now",display:"Last 6 months"},{from:"now-1y",to:"now",display:"Last 1 year"},{from:"now-2y",to:"now",display:"Last 2 years"},{from:"now-5y",to:"now",display:"Last 5 years"},{from:"now-1d/d",to:"now-1d/d",display:"Yesterday"},{from:"now-2d/d",to:"now-2d/d",display:"Day before yesterday"},{from:"now-7d/d",to:"now-7d/d",display:"This day last week"},{from:"now-1w/w",to:"now-1w/w",display:"Previous week"},{from:"now-1M/M",to:"now-1M/M",display:"Previous month"},{from:"now-1Q/fQ",to:"now-1Q/fQ",display:"Previous fiscal quarter"},{from:"now-1y/y",to:"now-1y/y",display:"Previous year"},{from:"now-1y/fy",to:"now-1y/fy",display:"Previous fiscal year"},{from:"now/d",to:"now/d",display:"Today"},{from:"now/d",to:"now",display:"Today so far"},{from:"now/w",to:"now/w",display:"This week"},{from:"now/w",to:"now",display:"This week so far"},{from:"now/M",to:"now/M",display:"This month"},{from:"now/M",to:"now",display:"This month so far"},{from:"now/y",to:"now/y",display:"This year"},{from:"now/y",to:"now",display:"This year so far"},{from:"now/fQ",to:"now",display:"This fiscal quarter so far"},{from:"now/fQ",to:"now/fQ",display:"This fiscal quarter"},{from:"now/fy",to:"now",display:"This fiscal year so far"},{from:"now/fy",to:"now/fy",display:"This fiscal year"}],n=[{label:"January",value:0},{label:"February",value:1},{label:"March",value:2},{label:"April",value:3},{label:"May",value:4},{label:"June",value:5},{label:"July",value:6},{label:"August",value:7},{label:"September",value:8},{label:"October",value:9},{label:"November",value:10},{label:"December",value:11}]},47619:(G,O,e)=>{"use strict";e.d(O,{X:()=>r,f:()=>s});var t=e(47232),n=e(85858),i=e(53531);function s(f,a,c){return(0,t.Ar)(f)?f.isValid():n.isMathString(f)?n.isValid(f):(0,i.b)(f,{roundUp:a,timeZone:c}).isValid()}function r(f){return n.isValid(f.from)&&n.isValid(f.to)}},99225:(G,O,e)=>{"use strict";e.d(O,{Q:()=>n});var t=e(91410);function n(i,s){const r=(0,t.HD)(s);if(!r)return i;const f=r.utcOffset(i.getTime()),a=i.getTimezoneOffset(),c=f-a;return new Date(i.getTime()-c*1e3*60)}},25994:(G,O,e)=>{"use strict";e.d(O,{c:()=>s});var t=e(74848),n=e(32196),i=e(40845);const s=({direction:f="horizontal",spacing:a=2})=>{const c=(0,i.of)(r,a);return f==="vertical"?(0,t.jsx)("div",{className:c.verticalDivider}):(0,t.jsx)("hr",{className:c.horizontalDivider})};s.displayName="Divider";const r=(f,a)=>({horizontalDivider:(0,n.css)({borderTop:`1px solid ${f.colors.border.weak}`,margin:f.spacing(a,0),width:"100%"}),verticalDivider:(0,n.css)({borderRight:`1px solid ${f.colors.border.weak}`,margin:f.spacing(0,a),height:"100%"})})},69144:(G,O,e)=>{"use strict";e.d(O,{l:()=>n});var t=e(32196);const n=(i,s)=>{const r=s||"middle",f=i.colors.emphasize(i.colors.background.secondary,.15),a=i.colors.primary.border,c=i.spacing(2),o=4,h=200;let g="50%",l="50%";switch(r){case"start":{g="0%",l="0%";break}case"end":{g="100%",l="100%";break}}const p=(0,t.css)({position:"relative","&:before":{content:'""',position:"absolute",transition:i.transitions.create("border-color"),zIndex:1},"&:after":{background:f,content:'""',position:"absolute",transition:i.transitions.create("background"),transform:"translate(-50%, -50%)",borderRadius:i.shape.radius.pill,zIndex:1},"&:hover":{"&:before":{borderColor:a},"&:after":{background:a}}});return{dragHandleVertical:(0,t.cx)(p,(0,t.css)({cursor:"col-resize",width:c,"&:before":{borderRight:"1px solid transparent",height:"100%",left:g,transform:"translateX(-50%)"},"&:after":{left:g,top:"50%",height:h,width:o}})),dragHandleHorizontal:(0,t.cx)(p,(0,t.css)({height:c,cursor:"row-resize","&:before":{borderTop:"1px solid transparent",top:l,transform:"translateY(-50%)",width:"100%"},"&:after":{left:"50%",top:l,height:o,width:h}}))}}},87978:(G,O,e)=>{"use strict";e.d(O,{_:()=>v});var t=e(74848),n=e(32196),i=e(18828),s=e(85690),r=e(93225),f=e(50848),a=e(96540),c=e(13544),o=e(40845),h=e(76412),g=e(40276),l=e(69144),p=e(29158),m=e(94753),y=e(24932);const d={sm:{width:"25vw",minWidth:384},md:{width:"50vw",minWidth:568},lg:{width:"75vw",minWidth:744}};function v({children:C,onClose:M,closeOnMaskClick:S=!0,scrollableContent:I=!0,title:T,subtitle:b,width:R,size:A="md",tabs:L}){const[U,W,w]=u(),N=(0,o.of)(x),B=(0,o.of)(E,A),V=(0,o.of)(l.l),K=a.useRef(null),{dialogProps:H,titleProps:X}=(0,i.s)({},K),{overlayProps:k}=(0,r.e)({isDismissable:!1,isOpen:!0,onClose:M},K);P();const Y=(0,t.jsx)("div",{className:N.content,children:C}),Z=U??R??d[A].width,se=d[A].minWidth;return(0,t.jsx)(f.A,{open:!0,onClose:M,placement:"right",getContainer:".main-view",className:N.drawerContent,rootClassName:N.drawer,classNames:{wrapper:B},styles:{wrapper:{width:Z,minWidth:se}},width:"",motion:{motionAppear:!0,motionName:N.drawerMotion},maskClassName:N.mask,maskClosable:S,maskMotion:{motionAppear:!0,motionName:N.maskMotion},children:(0,t.jsx)(s.n1,{restoreFocus:!0,contain:!0,autoFocus:!0,children:(0,t.jsxs)("div",{"aria-label":typeof T=="string"?c.Tp.components.Drawer.General.title(T):c.Tp.components.Drawer.General.title("no title"),className:N.container,...k,...H,ref:K,children:[(0,t.jsx)("div",{className:(0,n.cx)(V.dragHandleVertical,N.resizer),onMouseDown:W,onTouchStart:w}),typeof T=="string"&&(0,t.jsxs)("div",{className:(0,n.cx)(N.header,!!L&&N.headerWithTabs),children:[(0,t.jsx)("div",{className:N.actions,children:(0,t.jsx)(p.K,{name:"times",variant:"secondary",onClick:M,"data-testid":c.Tp.components.Drawer.General.close,tooltip:(0,h.t)("grafana-ui.drawer.close","Close")})}),(0,t.jsxs)("div",{className:N.titleWrapper,children:[(0,t.jsx)(m.E,{element:"h3",...X,children:T}),b&&(0,t.jsx)("div",{className:N.subtitle,"data-testid":c.Tp.components.Drawer.General.subtitle,children:b}),L&&(0,t.jsx)("div",{className:N.tabsWrapper,children:L})]})]}),typeof T!="string"&&T,I?(0,t.jsx)(g.E,{children:Y}):Y]})})})}function u(){const[C,M]=(0,a.useState)(void 0),S=(0,a.useCallback)(L=>{M(D(L.clientX))},[]),I=(0,a.useCallback)(L=>{const U=L.touches[0];M(D(U.clientX))},[]),T=(0,a.useCallback)(L=>{document.removeEventListener("mousemove",S),document.removeEventListener("mouseup",T)},[S]),b=(0,a.useCallback)(L=>{document.removeEventListener("touchmove",I),document.removeEventListener("touchend",b)},[I]);function R(L){L.stopPropagation(),L.preventDefault(),document.addEventListener("mousemove",S),document.addEventListener("mouseup",T)}function A(L){L.stopPropagation(),L.preventDefault(),document.addEventListener("touchmove",I),document.addEventListener("touchend",b)}return[C,R,A]}function D(C){let M=document.body.offsetWidth-(C-document.body.offsetLeft);return`${Math.min(M/document.body.clientWidth*100,98).toFixed(2)}vw`}function P(){(0,a.useEffect)(()=>{if(document.body)return document.body.classList.add("body-drawer-open"),()=>{document.body.classList.remove("body-drawer-open")}},[])}const x=C=>({container:(0,n.css)({display:"flex",flexDirection:"column",height:"100%",flex:"1 1 0",minHeight:"100%",position:"relative"}),drawer:(0,n.css)({".main-view &":{top:80},".main-view--search-bar-hidden &":{top:40},".main-view--chrome-hidden &":{top:0},".rc-drawer-content-wrapper":{boxShadow:C.shadows.z3}}),drawerContent:(0,n.css)({backgroundColor:`${C.colors.background.primary} !important`,display:"flex",overflow:"unset !important",flexDirection:"column"}),drawerMotion:(0,n.css)({"&-appear":{transform:"translateX(100%)",transition:"none !important","&-active":{transition:`${C.transitions.create("transform")} !important`,transform:"translateX(0)"}}}),mask:(0,n.css)({backgroundColor:"transparent",position:"fixed","&:before":{backgroundColor:`${C.components.overlay.background} !important`,backdropFilter:"blur(1px)",bottom:0,content:'""',left:0,position:"fixed",right:0,".main-view &":{top:80},".main-view--search-bar-hidden &":{top:40},".main-view--chrome-hidden &":{top:0}}}),maskMotion:(0,n.css)({"&-appear":{opacity:0,"&-active":{opacity:1,transition:C.transitions.create("opacity")}}}),header:(0,n.css)({label:"drawer-header",flexGrow:0,padding:C.spacing(2,2,3),borderBottom:`1px solid ${C.colors.border.weak}`}),headerWithTabs:(0,n.css)({borderBottom:"none"}),actions:(0,n.css)({position:"absolute",right:C.spacing(1),top:C.spacing(1)}),titleWrapper:(0,n.css)({label:"drawer-title",overflowWrap:"break-word"}),subtitle:(0,n.css)({label:"drawer-subtitle",color:C.colors.text.secondary,paddingTop:C.spacing(1)}),content:(0,n.css)({padding:C.spacing(2),height:"100%",flexGrow:1}),tabsWrapper:(0,n.css)({label:"drawer-tabs",paddingLeft:C.spacing(2),margin:C.spacing(1,-1,-3,-3)}),resizer:(0,n.css)({top:0,left:C.spacing(-1),bottom:0,position:"absolute",zIndex:C.zIndex.modal})});function E(C,M){return(0,n.css)({label:`drawer-content-wrapper-${M}`,overflow:"unset !important",[C.breakpoints.down("md")]:{width:`calc(100% - ${C.spacing(2)}) !important`,minWidth:"0 !important"}})}},9261:(G,O,e)=>{"use strict";e.d(O,{f:()=>p});var t=e(74848),n=e(32196),i=e(34743),s=e(36376),r=e(7315),f=e(85690),a=e(96540),c=e(40845),o=e(38138),h=e(64539),g=e(27746);const l=y=>{const{className:d,options:v,value:u,onChange:D,narrow:P,variant:x,...E}=y,C=(0,c.of)(m),[M,S]=(0,a.useState)(!1),I=[(0,i.cY)(0),(0,i.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,i.BN)()],{context:T,refs:b,floatingStyles:R}=(0,s.we)({open:M,placement:"bottom-end",onOpenChange:S,middleware:I,whileElementsMounted:r.ll}),A=(0,s.kp)(T),L=(0,s.s9)(T),{getReferenceProps:U,getFloatingProps:W}=(0,s.bv)([L,A]),w=N=>{D(N),S(!1)};return(0,t.jsxs)("div",{className:C.wrapper,children:[(0,t.jsx)(g.I,{className:d,isOpen:M,narrow:P,variant:x,ref:b.setReference,...U(),...E,children:u?.label||(u?.value!=null?String(u?.value):null)}),M&&(0,t.jsx)("div",{className:C.menuWrapper,ref:b.setFloating,...W(),style:R,children:(0,t.jsx)(f.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)(o.W,{tabIndex:-1,onClose:()=>S(!1),children:v.map(N=>(0,t.jsx)(h.D,{label:N.label??String(N.value),onClick:()=>w(N),active:N.value===u?.value,ariaChecked:N.value===u?.value,ariaLabel:N.ariaLabel||N.label,disabled:N.isDisabled,component:N.component,role:"menuitemradio"},`${N.value}`))})})})]})};l.displayName="ButtonSelect";const p=(0,a.memo)(l),m=y=>({wrapper:(0,n.css)({position:"relative",display:"inline-flex"}),menuWrapper:(0,n.css)({zIndex:y.zIndex.dropdown})})},83122:(G,O,e)=>{"use strict";e.d(O,{m:()=>l});var t=e(74848),n=e(32196),i=e(34743),s=e(36376),r=e(7315),f=e(96540),a=e(86634),c=e(40845),o=e(67892),h=e(18976),g=e(17464);const l=f.memo(({children:m,overlay:y,placement:d,offset:v,onVisibleChange:u})=>{const[D,P]=(0,f.useState)(!1),x=(0,f.useRef)(null),E=(0,f.useCallback)(N=>{P(N),u?.(N)},[u]),C=[(0,i.cY)({mainAxis:v?.[0]??8,crossAxis:v?.[1]??0}),(0,i.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,i.BN)()],{context:M,refs:S,floatingStyles:I}=(0,s.we)({open:D,placement:(0,h.O)(d),onOpenChange:E,middleware:C,whileElementsMounted:r.ll}),T=(0,s.kp)(M),b=(0,s.s9)(M),{getReferenceProps:R,getFloatingProps:A}=(0,s.bv)([b,T]),L=150,U=(0,c.of)(p,L),W=()=>{E(!1)},w=N=>{N.key==="Tab"&&E(!1)};return(0,t.jsxs)(t.Fragment,{children:[f.cloneElement(m,{ref:S.setReference,...R()}),D&&(0,t.jsx)(g.ZL,{children:(0,t.jsx)(s.s3,{context:M,children:(0,t.jsx)("div",{ref:S.setFloating,style:I,onClick:W,onKeyDown:w,children:(0,t.jsx)(a.A,{nodeRef:x,appear:!0,in:!0,timeout:{appear:L,exit:0,enter:0},classNames:U,children:(0,t.jsx)("div",{ref:x,children:o.renderOrCallToRender(y,{...A()})})})})})})]})});l.displayName="Dropdown";const p=(m,y)=>({appear:(0,n.css)({opacity:"0",position:"relative",transformOrigin:"top",[m.transitions.handleMotion("no-preference")]:{transform:"scaleY(0.5)"}}),appearActive:(0,n.css)({opacity:"1",[m.transitions.handleMotion("no-preference")]:{transform:"scaleY(1)",transition:`transform ${y}ms cubic-bezier(0.2, 0, 0.2, 1), opacity ${y}ms cubic-bezier(0.2, 0, 0.2, 1)`}})})},41670:(G,O,e)=>{"use strict";e.d(O,{Z:()=>s});var t=e(74848),n=e(32196),i=e(40845);const s=({children:f})=>{const a=(0,i.of)(r);return(0,t.jsx)("div",{className:a.container,children:f})},r=f=>({container:(0,n.css)({borderLeft:`3px solid ${f.colors.info.main}`,backgroundColor:`${f.colors.background.secondary}`,padding:f.spacing(2),minWidth:"350px",borderRadius:f.shape.radius.default,marginBottom:f.spacing(4)})})},69529:(G,O,e)=>{"use strict";e.d(O,{p:()=>x});var t=e(74848),n=e(32196),i=e(8867),s=e(40845),r=e(90613),f=e(67061),a=e(94753),c=e(36348);const o=({width:M="auto",height:S})=>{const I=(0,s.of)(h);return(0,t.jsx)(i.default,{src:c,className:I.svg,height:S,width:M})};o.displayName="GrotCTA";const h=M=>({svg:(0,n.css)({"#grot-cta-cactus-1, #grot-cta-cactus-2":{fill:M.isDark?"#58558c":"#c9c5f4"}})});var g=e(96540),l=e(22687);const p=-20,m=5,y=-5,d=5,v=({width:M="auto",height:S})=>{const I=(0,g.useRef)(null),T=(0,s.of)(u);return(0,g.useEffect)(()=>{const b=R=>{if(window.matchMedia("(prefers-reduced-motion: reduce").matches)return;const A=I.current?.querySelector("#grot-not-found-arm"),L=I.current?.querySelector("#grot-not-found-magnifier"),{clientX:U,clientY:W}=R,{innerWidth:w,innerHeight:N}=window,B=W/N,V=U/w,K=D(B,p,m),H=D(V,y,d);window.requestAnimationFrame(()=>{A?.setAttribute("style",`transform: rotate(${K}deg) translateX(${H}%)`),L?.setAttribute("style",`transform: rotate(${K}deg) translateX(${H}%)`)})};return window.addEventListener("mousemove",b),()=>{window.removeEventListener("mousemove",b)}},[]),(0,t.jsx)(i.default,{innerRef:I,src:l,className:T.svg,height:S,width:M})};v.displayName="GrotNotFound";const u=M=>({svg:(0,n.css)({"#grot-not-found-arm, #grot-not-found-magnifier":{transformOrigin:"center"}})}),D=(M,S,I)=>M*(I-S)+S;var P=e(9886);const x=({button:M,children:S,image:I,message:T,hideImage:b=!1,variant:R,role:A})=>{const L=(0,s.of)(C),U=I??E(R);return(0,t.jsx)(r.a,{paddingY:4,display:"flex",direction:"column",alignItems:"center",role:A,children:(0,t.jsxs)("div",{className:L.container,children:[!b&&U,(0,t.jsxs)(f.B,{direction:"column",alignItems:"center",children:[(0,t.jsx)(a.E,{variant:"h4",textAlignment:"center",children:T}),S&&(0,t.jsx)(a.E,{color:"secondary",textAlignment:"center",children:S})]}),M]})})};function E(M){switch(M){case"call-to-action":return(0,t.jsx)(o,{width:300});case"not-found":return(0,t.jsx)(v,{width:300});case"completed":return(0,t.jsx)(i.default,{src:P,width:300});default:throw new Error(`Unknown variant: ${M}`)}}const C=M=>({container:(0,n.css)({display:"flex",flexDirection:"column",alignItems:"center",gap:M.spacing(4),maxWidth:"600px"})})},66602:(G,O,e)=>{"use strict";e.d(O,{Xc:()=>c,Xw:()=>a,tH:()=>f});var t=e(74848),n=e(96540),i=e(32631),s=e(42418),r=e(52446);class f extends n.PureComponent{constructor(){super(...arguments),this.state={error:null,errorInfo:null}}componentDidCatch(h,g){i.P?.api?.pushError(h),this.setState({error:h,errorInfo:g}),this.props.onError&&this.props.onError(h)}componentDidUpdate(h){const{dependencies:g,onRecover:l}=this.props;if(this.state.error&&g&&h.dependencies){for(let p=0;p<g.length;p++)if(g[p]!==h.dependencies[p]){this.setState({error:null,errorInfo:null}),l&&l();break}}}render(){const{children:h}=this.props,{error:g,errorInfo:l}=this.state;return h({error:g,errorInfo:l})}}class a extends n.PureComponent{static{this.defaultProps={title:"An unexpected error happened",style:"alertbox"}}render(){const{title:h,children:g,style:l,dependencies:p}=this.props;return(0,t.jsx)(f,{dependencies:p,children:({error:m,errorInfo:y})=>y?l==="alertbox"?(0,t.jsx)(s.F,{title:h||"",children:(0,t.jsxs)("details",{style:{whiteSpace:"pre-wrap"},children:[m&&m.toString(),(0,t.jsx)("br",{}),y.componentStack]})}):(0,t.jsx)(r.D,{title:h||"",error:m,errorInfo:y}):g})}}function c(o,h={}){const g=l=>(0,t.jsx)(a,{...h,children:(0,t.jsx)(o,{...l})});return g.displayName="WithErrorBoundary",g}},52446:(G,O,e)=>{"use strict";e.d(O,{D:()=>s});var t=e(74848),n=e(32196),i=e(40845);const s=({error:f,errorInfo:a,title:c})=>{const o=(0,i.of)(r);return(0,t.jsxs)("div",{className:o,children:[(0,t.jsx)("h2",{children:c}),(0,t.jsxs)("details",{style:{whiteSpace:"pre-wrap"},children:[f&&f.toString(),(0,t.jsx)("br",{}),a&&a.componentStack]})]})};s.displayName="ErrorWithStack";const r=()=>(0,n.css)({width:"500px",margin:"64px auto"})},29678:(G,O,e)=>{"use strict";e.d(O,{y:()=>s});var t=e(74848),n=e(41987),i=e(39938);const s=({featureState:f,tooltip:a})=>{const c=r(f);return(0,t.jsx)(i.E,{text:c.text,color:c.color,icon:c.icon,tooltip:a})};function r(f){switch(f){case n.Ay.alpha:return{text:"Alpha",icon:"exclamation-triangle",color:"orange"};case n.Ay.beta:return{text:"Beta",icon:"rocket",color:"blue"};case n.Ay.experimental:return{text:"Experimental",icon:"exclamation-triangle",color:"orange"};case n.Ay.preview:return{text:"Preview",icon:"rocket",color:"blue"};case n.Ay.privatePreview:return{text:"Private preview",icon:"rocket",color:"blue"}}}},37270:(G,O,e)=>{"use strict";e.d(O,{gH:()=>p,wI:()=>d});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(96540),f=e(20978),a=e(47172),c=e(83195),o=e(40845),h=e(42418),g=e(14578),l=e(73569);function p({options:x,children:E,readAs:C,onLoad:M,fileListRenderer:S,onFileRemove:I}){const[T,b]=(0,r.useState)([]),[R,A]=(0,r.useState)([]),L=(0,c.j_)("decbytes")(x?.maxSize?x?.maxSize:0),U=(0,r.useCallback)((se,j)=>{b(q=>q.map(ne=>(ne.id===se.id&&j(ne),ne)))},[]),W=(0,r.useCallback)((se,j,q)=>{let ne=se.map(D);if(x?.multiple===!1?b(ne):b(oe=>[...oe,...ne]),k(j),x?.onDrop)x.onDrop(se,j,q);else for(const oe of ne){const z=new FileReader,te=()=>{C?z[C](oe.file):z.readAsText(oe.file)};U(oe,le=>{le.abortUpload=()=>{z.abort()},le.retryUpload=()=>{U(oe,ie=>{ie.error=null,ie.progress=void 0}),te()}}),z.onabort=()=>{U(oe,le=>{le.error=new DOMException("Aborted")})},z.onprogress=le=>{U(oe,ie=>{ie.progress=le.loaded})},z.onload=()=>{M?.(z.result)},z.onerror=()=>{U(oe,le=>{le.error=z.error})},te()}},[M,x,C,U]),w=se=>{const j=T.filter(q=>se.id!==q.id);b(j),I?.(se)},{getRootProps:N,getInputProps:B,isDragActive:V}=(0,f.VB)({...x,useFsAccessApi:!1,onDrop:W,accept:y(x?.accept)}),K=(0,o.$j)(),H=P(K,V),X=T.map(se=>S?S(se,w):(0,t.jsx)(l.I,{file:se,removeFile:w},se.id)),k=se=>{let j=[];se.map(q=>{q.errors.map(ne=>{j.findIndex(oe=>oe.code===ne.code&&oe.message===ne.message)===-1&&j.push(ne)})}),A(j)},Y=se=>(0,t.jsx)("div",{className:H.errorAlert,children:(0,t.jsx)(h.F,{title:"Upload failed",severity:"error",onRemove:Z,children:se.map(j=>{switch(j.code){case a.O4.FileTooLarge:return(0,t.jsxs)("div",{children:["File is larger than ",(0,c.cN)(L)]},j.message+j.code);default:return(0,t.jsx)("div",{children:j.message},j.message+j.code)}})})}),Z=()=>{A([])};return(0,t.jsxs)("div",{className:H.container,children:[(0,t.jsxs)("div",{"data-testid":"dropzone",...N({className:H.dropzone}),children:[(0,t.jsx)("input",{...B()}),E??(0,t.jsx)(d,{primaryText:v(T,x)})]}),R.length>0&&Y(R),(0,t.jsxs)("small",{className:(0,n.cx)(H.small,H.acceptContainer),children:[x?.maxSize&&`Max file size: ${(0,c.cN)(L)}`,x?.maxSize&&x?.accept&&(0,t.jsx)("span",{className:H.acceptSeparator,children:"|"}),x?.accept&&u(x.accept)]}),X]})}function m(x){return["txt","json","csv","xls","yml"].some(E=>x.match(E))?"text/plain":"application/octet-stream"}function y(x){return(0,i.isString)(x)?{[m(x)]:[x]}:Array.isArray(x)?x.reduce((E,C)=>{const M=m(C);return E[M]=E[M]?[...E[M],C]:[C],E},{}):x}function d({primaryText:x="Drop file here or click to upload",secondaryText:E=""}){const C=(0,o.$j)(),M=P(C);return(0,t.jsxs)("div",{className:(0,n.cx)(M.defaultDropZone),"data-testid":"file-drop-zone-default-children",children:[(0,t.jsx)(g.I,{className:(0,n.cx)(M.icon),name:"upload",size:"xl"}),(0,t.jsx)("h6",{className:(0,n.cx)(M.primaryText),children:x}),(0,t.jsx)("small",{className:M.small,children:E})]})}function v(x,E){return E?.multiple===void 0||E?.multiple?"Upload file":x.length?"Replace file":"Upload file"}function u(x){return(0,i.isString)(x)?`Accepted file type: ${x}`:Array.isArray(x)?`Accepted file types: ${x.join(", ")}`:`Accepted file types: ${Object.values(x).flat().join(", ")}`}function D(x){return{id:(0,i.uniqueId)("file"),file:x,error:null}}function P(x,E){return{container:(0,n.css)({display:"flex",flexDirection:"column",width:"100%",padding:x.spacing(2),borderRadius:x.shape.radius.default,border:`1px dashed ${x.colors.border.strong}`,backgroundColor:E?x.colors.background.secondary:x.colors.background.primary,cursor:"pointer",alignItems:"center",justifyContent:"center"}),dropzone:(0,n.css)({height:"100%",width:"100%",display:"flex",flexDirection:"column"}),defaultDropZone:(0,n.css)({textAlign:"center"}),icon:(0,n.css)({marginBottom:x.spacing(1)}),primaryText:(0,n.css)({marginBottom:x.spacing(1)}),acceptContainer:(0,n.css)({textAlign:"center",margin:0}),acceptSeparator:(0,n.css)({margin:`0 ${x.spacing(1)}`}),small:(0,n.css)({color:x.colors.text.secondary}),errorAlert:(0,n.css)({paddingTop:"10px"})}}},73569:(G,O,e)=>{"use strict";e.d(O,{I:()=>h});var t=e(74848),n=e(32196),i=e(83195),s=e(40845),r=e(53550),f=e(55852),a=e(14578),c=e(29158);const o="Remove file";function h({file:l,removeFile:p}){const m=(0,s.of)(g),{file:y,progress:d,error:v,abortUpload:u,retryUpload:D}=l,P=()=>v?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:m.error,children:v.message}),D&&(0,t.jsx)(c.K,{name:"sync",tooltip:"Retry",tooltipPlacement:"top",onClick:D}),p&&(0,t.jsx)(c.K,{className:D?m.marginLeft:"",name:"trash-alt",onClick:()=>p(l),tooltip:o})]}):d&&y.size>d?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("progress",{className:m.progressBar,max:y.size,value:d}),(0,t.jsxs)("span",{className:m.paddingLeft,children:[Math.round(d/y.size*100),"%"]}),u&&(0,t.jsx)(f.$n,{variant:"secondary",type:"button",fill:"text",onClick:u,children:"Cancel upload"})]}):p&&(0,t.jsx)(c.K,{name:"trash-alt",onClick:()=>p(l),tooltip:o,tooltipPlacement:"top"}),x=(0,i.j_)("decbytes")(y.size);return(0,t.jsxs)("div",{className:m.fileListContainer,children:[(0,t.jsxs)("span",{className:m.fileNameWrapper,children:[(0,t.jsx)(a.I,{name:"file-blank",size:"lg","aria-hidden":!0}),(0,t.jsx)("span",{className:m.padding,children:(0,r.i)(y.name)}),(0,t.jsx)("span",{children:(0,i.cN)(x)})]}),(0,t.jsx)("div",{className:m.fileNameWrapper,children:P()})]})}function g(l){return{fileListContainer:(0,n.css)({width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:l.spacing(2),border:`1px dashed ${l.colors.border.medium}`,backgroundColor:`${l.colors.background.secondary}`,marginTop:l.spacing(1)}),fileNameWrapper:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center"}),padding:(0,n.css)({padding:l.spacing(0,1)}),paddingLeft:(0,n.css)({paddingLeft:l.spacing(2)}),marginLeft:(0,n.css)({marginLeft:l.spacing(1)}),error:(0,n.css)({paddingRight:l.spacing(2),color:l.colors.error.text}),progressBar:(0,n.css)({borderRadius:l.shape.radius.default,height:"4px","::-webkit-progress-bar":{backgroundColor:l.colors.border.weak,borderRadius:l.shape.radius.default},"::-webkit-progress-value":{backgroundColor:l.colors.primary.main,borderRadius:l.shape.radius.default}})}}},92887:(G,O,e)=>{"use strict";e.d(O,{IB:()=>n.I,gH:()=>t.gH,wI:()=>t.wI});var t=e(37270),n=e(73569)},73546:(G,O,e)=>{"use strict";e.d(O,{e:()=>g});var t=e(74848),n=e(32196),i=e(96540),s=e(62938),r=e(13544),f=e(40845),a=e(16797),c=e(53550),o=e(55852),h=e(14578);const g=({onFileUpload:p,className:m,children:y="Upload file",accept:d="*",size:v="md",showFileName:u})=>{const D=(0,f.of)(l(v)),[P,x]=(0,i.useState)(""),E=(0,s.A)(),C=(0,i.useCallback)(M=>{const S=M.currentTarget?.files?.[0];S&&x(S.name??""),p(M)},[p]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("input",{type:"file",id:E,className:D.fileUpload,onChange:C,multiple:!1,accept:d,"data-testid":r.Tp.components.FileUpload.inputField}),(0,t.jsxs)("label",{htmlFor:E,className:(0,n.cx)(D.labelWrapper,m),children:[(0,t.jsx)(h.I,{name:"upload",className:D.icon}),y]}),u&&P&&(0,t.jsx)("span",{"aria-label":"File name",className:D.fileName,"data-testid":r.Tp.components.FileUpload.fileNameSpan,children:(0,c.i)(P)})]})},l=p=>m=>{const y=(0,o.hs)({theme:m,variant:"primary",size:p,iconOnly:!1}),d=(0,a.getFocusStyles)(m);return{fileUpload:(0,n.css)({height:"0.1px",opacity:"0",overflow:"hidden",position:"absolute",width:"0.1px",zIndex:-1,"&:focus + label":d,"&:focus-visible + label":d}),labelWrapper:y.button,icon:y.icon,fileName:(0,n.css)({marginLeft:m.spacing(.5)})}}},67647:(G,O,e)=>{"use strict";e.d(O,{Z:()=>c});var t=e(74848),n=e(96540),i=e(54479);function s(...o){const h=n.useRef(null);return n.useEffect(()=>{o.forEach(g=>{g&&(typeof g=="function"?g(h.current):g.current=h.current)})},[o]),h}var r=e(55852),f=e(14578),a=e(10354);const c=(0,n.forwardRef)(({value:o,width:h,onChange:g,escapeRegex:l=!0,...p},m)=>{const y=(0,n.useRef)(null),d=s(m,y),v=o!==""?(0,t.jsx)(r.$n,{icon:"times",fill:"text",size:"sm",onClick:u=>{y.current?.focus(),g(""),u.stopPropagation()},children:"Clear"}):null;return(0,t.jsx)(a.p,{prefix:(0,t.jsx)(f.I,{name:"search"}),suffix:v,width:h,type:"text",value:l?(0,i.xb)(o??""):o,onChange:u=>g(l?(0,i.jD)(u.currentTarget.value):u.currentTarget.value),...p,ref:d})});c.displayName="FilterInput"},92174:(G,O,e)=>{"use strict";e.d(O,{m:()=>f});var t=e(74848),n=e(32196),i=e(40845),s=e(55852),r=e(14578);const f=({label:c,selected:o,onClick:h,icon:g="check"})=>{const l=(0,i.of)(a),p=(0,i.of)(s.my);return(0,t.jsxs)("button",{type:"button",className:(0,n.cx)(p,l.wrapper,o&&l.selected),onClick:h,children:[(0,t.jsx)("span",{children:c}),o&&(0,t.jsx)(r.I,{name:g,className:l.icon})]})},a=c=>({wrapper:(0,n.css)({background:c.colors.background.secondary,borderRadius:c.shape.radius.pill,padding:c.spacing(0,2),fontSize:c.typography.bodySmall.fontSize,fontWeight:c.typography.fontWeightMedium,lineHeight:c.typography.bodySmall.lineHeight,color:c.colors.text.secondary,display:"flex",alignItems:"center",height:"32px",position:"relative",border:`1px solid ${c.colors.background.secondary}`,whiteSpace:"nowrap","&:hover":{background:c.colors.action.hover,color:c.colors.text.primary}}),selected:(0,n.css)({color:c.colors.text.primary,background:c.colors.action.selected,"&:hover":{background:c.colors.action.focus}}),icon:(0,n.css)({marginLeft:c.spacing(.5)})})},90090:(G,O,e)=>{"use strict";e.d(O,{z:()=>s});var t=e(74848),n=e(32196),i=e(38894);const s=({label:f,tooltip:a,labelWidth:c=6,inputWidth:o=12,inputEl:h,className:g,interactive:l,...p})=>{const m=r();return(0,t.jsxs)("div",{className:(0,n.cx)(m.formField,g),children:[(0,t.jsx)(i.I,{width:c,tooltip:a,interactive:l,children:f}),h||(0,t.jsx)("input",{type:"text",className:`gf-form-input ${o?`width-${o}`:""}`,...p,disabled:p.disabled})]})};s.displayName="FormField";const r=()=>({formField:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative"})})},38894:(G,O,e)=>{"use strict";e.d(O,{I:()=>a});var t=e(74848),n=e(46942),i=e.n(n),s=e(14578),r=e(56034);const a=({children:c,isFocused:o,isInvalid:h,className:g,htmlFor:l,tooltip:p,width:m,interactive:y,...d})=>{const v=i()(g,`gf-form-label width-${m||"10"}`,{"gf-form-label--is-focused":o,"gf-form-label--is-invalid":h});return(0,t.jsxs)("label",{className:v,...d,htmlFor:l,children:[c,p&&(0,t.jsx)(r.m,{placement:"top",content:p,theme:"info",interactive:y,children:(0,t.jsx)(s.I,{name:"info-circle",size:"sm",style:{marginLeft:"10px"}})})]})}},9286:(G,O,e)=>{"use strict";e.d(O,{i:()=>i});var t=e(74848);function n(s){return s<20?.9:s<26?.8:.6}const i=({value:s,className:r,style:f,...a})=>{const c=(s.prefix??"").length>0,o=(s.suffix??"").length>0;let h;if(f&&f.fontSize&&typeof f.fontSize=="number"){const g=f.fontSize,l=n(g);h={fontSize:g*l}}return(0,t.jsx)("div",{className:r,style:f,...a,children:(0,t.jsxs)("div",{children:[c&&(0,t.jsx)("span",{children:s.prefix}),(0,t.jsx)("span",{children:s.text}),o&&(0,t.jsx)("span",{style:h,children:s.suffix})]})})};i.displayName="FormattedDisplayValue"},10880:(G,O,e)=>{"use strict";e.d(O,{S:()=>a});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(16797),f=e(60029);const a=i.forwardRef(({label:o,description:h,value:g,htmlValue:l,onChange:p,disabled:m,className:y,indeterminate:d,invalid:v,...u},D)=>{const P=(0,i.useCallback)(C=>{p&&p(C)},[p]),x=(0,s.of)(c,v),E=d?"mixed":void 0;return(0,t.jsxs)("label",{className:(0,n.cx)(x.wrapper,y),children:[(0,t.jsxs)("div",{className:x.checkboxWrapper,children:[(0,t.jsx)("input",{type:"checkbox",className:(0,n.cx)(x.input,d&&x.inputIndeterminate),checked:g,disabled:m,onChange:P,value:l,"aria-checked":E,...u,ref:D}),(0,t.jsx)("span",{className:x.checkmark})]}),o&&(0,t.jsx)("span",{className:x.label,children:o}),h&&(0,t.jsx)("span",{className:x.description,children:h})]})}),c=(o,h=!1)=>{const g=(0,f.f)(o),l=2,p=1,m=y=>h?o.colors.error.border:y;return{wrapper:(0,n.css)({display:"inline-grid",alignItems:"center",columnGap:o.spacing(p),gridAutoRows:"max-content",position:"relative",verticalAlign:"middle"}),input:(0,n.css)({position:"absolute",zIndex:1,top:0,left:0,width:"100% !important",height:"100%",opacity:0,"&:focus + span, &:focus-visible + span":(0,r.getFocusStyles)(o),"&:focus:not(:focus-visible) + span":(0,r.getMouseFocusStyles)(o),"&:checked + span":{background:o.colors.primary.main,border:`1px solid ${m(o.colors.primary.main)}`,"&:hover":{background:o.colors.primary.shade},"&:after":{content:'""',position:"absolute",zIndex:2,left:"4px",top:0,width:"6px",height:"12px",border:`solid ${o.colors.primary.contrastText}`,borderWidth:"0 3px 3px 0",transform:"rotate(45deg)"}},"&:disabled + span":{backgroundColor:o.colors.action.disabledBackground,cursor:"not-allowed",border:`1px solid ${m(o.colors.action.disabledBackground)}`,"&:hover":{backgroundColor:o.colors.action.disabledBackground},"&:after":{borderColor:o.colors.action.disabledText}}}),inputIndeterminate:(0,n.css)({"&[aria-checked='mixed'] + span":{border:`1px solid ${m(o.colors.primary.main)}`,background:o.colors.primary.main,"&:hover":{background:o.colors.primary.shade},"&:after":{content:'""',position:"absolute",zIndex:2,left:"2px",right:"2px",top:"calc(50% - 1.5px)",height:"3px",border:`1.5px solid ${o.colors.primary.contrastText}`,backgroundColor:o.colors.primary.contrastText,width:"auto",transform:"none"}},"&:disabled[aria-checked='mixed'] + span":{backgroundColor:o.colors.action.disabledBackground,border:`1px solid ${m(o.colors.error.transparent)}`,"&:after":{borderColor:o.colors.action.disabledText}}}),checkboxWrapper:(0,n.css)({display:"flex",alignItems:"center",gridColumnStart:1,gridRowStart:1}),checkmark:(0,n.css)({position:"relative",zIndex:2,display:"inline-block",width:o.spacing(l),height:o.spacing(l),borderRadius:o.shape.radius.default,background:o.components.input.background,border:`1px solid ${m(o.components.input.borderColor)}`,"&:hover":{cursor:"pointer",borderColor:m(o.components.input.borderHover)}}),label:(0,n.cx)(g.label,(0,n.css)({gridColumnStart:2,gridRowStart:1,position:"relative",zIndex:2,cursor:"pointer",maxWidth:"fit-content",lineHeight:o.typography.bodySmall.lineHeight,marginBottom:0})),description:(0,n.cx)(g.description,(0,n.css)({gridColumnStart:2,gridRowStart:2,lineHeight:o.typography.bodySmall.lineHeight,marginTop:0}))}};a.displayName="Checkbox"},88575:(G,O,e)=>{"use strict";e.d(O,{D:()=>c});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(67892),f=e(72093),a=e(60029);const c=i.forwardRef(({label:g,description:l,horizontal:p,invalid:m,loading:y,disabled:d,required:v,error:u,children:D,className:P,validationMessageHorizontalOverflow:x,htmlFor:E,...C},M)=>{const S=(0,s.of)(h),I=E??(0,r.getChildId)(D),T=typeof g=="string"?(0,t.jsx)(a.J,{htmlFor:I,description:l,children:`${g}${v?" *":""}`}):g,b=o({invalid:m,disabled:d,loading:y});return(0,t.jsxs)("div",{className:(0,n.cx)(S.field,p&&S.fieldHorizontal,P),...C,children:[T,(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{ref:M,children:i.cloneElement(D,b)}),m&&u&&!p&&(0,t.jsx)("div",{className:(0,n.cx)(S.fieldValidationWrapper,{[S.validationMessageHorizontalOverflow]:!!x}),children:(0,t.jsx)(f.P,{children:u})})]}),m&&u&&p&&(0,t.jsx)("div",{className:(0,n.cx)(S.fieldValidationWrapper,S.fieldValidationWrapperHorizontal,{[S.validationMessageHorizontalOverflow]:!!x}),children:(0,t.jsx)(f.P,{children:u})})]})});c.displayName="Field";function o(g){for(const l in g)g[l]===void 0&&delete g[l];return g}const h=g=>({field:(0,n.css)({display:"flex",flexDirection:"column",marginBottom:g.spacing(2)}),fieldHorizontal:(0,n.css)({flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap"}),fieldValidationWrapper:(0,n.css)({marginTop:g.spacing(.5)}),fieldValidationWrapperHorizontal:(0,n.css)({flex:"1 1 100%"}),validationMessageHorizontalOverflow:(0,n.css)({width:0,overflowX:"visible","& > *":{whiteSpace:"nowrap"}})})},95984:(G,O,e)=>{"use strict";e.d(O,{E:()=>n});var t=e(49785);const n=({name:i,control:s,children:r,...f})=>{const{fields:a,append:c,prepend:o,remove:h,swap:g,move:l,insert:p}=(0,t.jz)({control:s,name:i,...f});return r({fields:a,append:c,prepend:o,remove:h,swap:g,move:l,insert:p})}},84167:(G,O,e)=>{"use strict";e.d(O,{n:()=>r});var t=e(74848),n=e(32196),i=e(40845),s=e(17408);const r=({label:a,children:c,className:o,...h})=>{const g=(0,i.of)(f);return(0,t.jsxs)("fieldset",{className:(0,n.cx)(g.wrapper,o),...h,children:[a&&(0,t.jsx)(s.s,{children:a}),c]})},f=a=>({wrapper:(0,n.css)({marginBottom:a.spacing(4),"&:last-child":{marginBottom:0}})})},72093:(G,O,e)=>{"use strict";e.d(O,{P:()=>r});var t=e(74848),n=e(32196),i=e(40845),s=e(14578);const r=({children:a,horizontal:c,className:o})=>{const h=(0,i.of)(f),g=(0,n.cx)(c?h.horizontal:h.vertical,o);return(0,t.jsxs)("div",{role:"alert",className:g,children:[(0,t.jsx)(s.I,{className:h.fieldValidationMessageIcon,name:"exclamation-triangle"}),a]})},f=a=>{const c=`
      font-size: ${a.typography.size.sm};
      font-weight: ${a.typography.fontWeightMedium};
      padding: ${a.spacing(.5,1)};
      color: ${a.colors.error.contrastText};
      background: ${a.colors.error.main};
      border-radius: ${a.shape.radius.default};
      position: relative;
      display: inline-block;
      align-self: flex-start;

      a {
        color: ${a.colors.error.contrastText};
        text-decoration: underline;
      }

      a:hover {
        text-decoration: none;
      }
    `;return{vertical:(0,n.css)(c,{margin:a.spacing(.5,0,0,0),"&:before":{content:'""',position:"absolute",left:"9px",top:"-5px",width:0,height:0,borderWidth:"0 4px 5px 4px",borderColor:`transparent transparent ${a.colors.error.main} transparent`,borderStyle:"solid"}}),horizontal:(0,n.css)(c,{marginLeft:"10px","&:before":{content:'""',position:"absolute",left:"-5px",top:"9px",width:0,height:0,borderWidth:"4px 5px 4px 0",borderColor:"transparent #e02f44 transparent transparent",borderStyle:"solid"}}),fieldValidationMessageIcon:(0,n.css)({marginRight:a.spacing()})}}},51253:(G,O,e)=>{"use strict";e.d(O,{l:()=>r});var t=e(74848),n=e(32196),i=e(96540),s=e(49785);function r({defaultValues:f,onSubmit:a,validateOnMount:c=!1,validateFieldsOnMount:o,children:h,validateOn:g="onSubmit",maxWidth:l=600,...p}){const{handleSubmit:m,trigger:y,formState:d,...v}=(0,s.mN)({mode:g,defaultValues:f});return(0,i.useEffect)(()=>{c&&y(o)},[y,o,c]),(0,t.jsx)("form",{className:(0,n.css)({maxWidth:l!=="none"?l+"px":l,width:"100%"}),onSubmit:m(a),...p,children:h({errors:d.errors,formState:d,trigger:y,...v})})}},14186:(G,O,e)=>{"use strict";e.d(O,{I:()=>c});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(67892),f=e(72093),a=e(76892);const c=({children:h,label:g,tooltip:l,labelWidth:p="auto",invalid:m,loading:y,disabled:d,required:v,className:u,htmlFor:D,grow:P,shrink:x,error:E,transparent:C,interactive:M,...S})=>{const I=(0,s.$j)(),T=o(I,P,x),b=D??(0,r.getChildId)(h),R=typeof g=="string"?(0,t.jsx)(a.c,{interactive:M,width:p,tooltip:l,htmlFor:b,transparent:C,children:`${g}${v?" *":""}`}):g;return(0,t.jsxs)("div",{className:(0,n.cx)(T.container,u),...S,children:[R,(0,t.jsxs)("div",{className:T.childContainer,children:[(0,i.cloneElement)(h,{invalid:m,disabled:d,loading:y}),m&&E&&(0,t.jsx)("div",{className:(0,n.cx)(T.fieldValidationWrapper),children:(0,t.jsx)(f.P,{children:E})})]})]})};c.displayName="InlineField";const o=(h,g,l)=>({container:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative",flex:`${g?1:0} ${l?1:0} auto`,margin:`0 ${h.spacing(.5)} ${h.spacing(.5)} 0`}),childContainer:(0,n.css)({flex:`${g?1:0} ${l?1:0} auto`}),fieldValidationWrapper:(0,n.css)({marginTop:h.spacing(.5)})})},39268:(G,O,e)=>{"use strict";e.d(O,{C:()=>s});var t=e(74848),n=e(32196),i=e(40845);const s=({children:f,className:a,...c})=>{const o=(0,i.of)(r);return(0,t.jsx)("div",{className:(0,n.cx)(o.container,a),...c,children:f})},r=f=>({container:(0,n.css)({label:"InlineFieldRow",display:"flex",flexDirection:"row",flexWrap:"wrap",alignContent:"flex-start",rowGap:f.spacing(.5)})})},76892:(G,O,e)=>{"use strict";e.d(O,{c:()=>f});var t=e(74848),n=e(32196),i=e(40845),s=e(14578),r=e(56034);const f=({children:c,className:o,tooltip:h,width:g,transparent:l,interactive:p,as:m="label",...y})=>{const d=(0,i.of)(a,l,g);return(0,t.jsxs)(m,{className:(0,n.cx)(d.label,o),...y,children:[c,h&&(0,t.jsx)(r.m,{interactive:p,placement:"top",content:h,theme:"info",children:(0,t.jsx)(s.I,{tabIndex:0,name:"info-circle",size:"sm",className:d.icon})})]})},a=(c,o=!1,h)=>({label:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"space-between",flexShrink:0,padding:c.spacing(0,1),fontWeight:c.typography.fontWeightMedium,fontSize:c.typography.size.sm,backgroundColor:o?"transparent":c.colors.background.secondary,height:c.spacing(c.components.height.md),lineHeight:c.spacing(c.components.height.md),marginRight:c.spacing(.5),borderRadius:c.shape.radius.default,border:"none",width:h?h!=="auto"?`${8*h}px`:h:"100%",color:c.colors.text.primary}),icon:(0,n.css)({color:c.colors.text.secondary,marginLeft:"10px",":hover":{color:c.colors.text.primary}})})},63056:(G,O,e)=>{"use strict";e.d(O,{e:()=>s});var t=e(74848),n=e(32196),i=e(40845);const s=({children:f,className:a,grow:c,...o})=>{const h=(0,i.of)(r,c);return(0,t.jsx)("div",{className:(0,n.cx)(h.container,a),...o,children:f})};s.displayName="InlineSegmentGroup";const r=(f,a)=>({container:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative",flex:`${a?1:0} 0 auto`,marginBottom:f.spacing(.5)})})},60029:(G,O,e)=>{"use strict";e.d(O,{J:()=>r,f:()=>f});var t=e(74848),n=e(32196),i=e(40845),s=e(14578);const r=({children:a,description:c,className:o,category:h,...g})=>{const l=(0,i.of)(f),p=h?.map((m,y)=>(0,t.jsxs)("span",{className:l.categories,children:[(0,t.jsx)("span",{children:m}),(0,t.jsx)(s.I,{name:"angle-right",className:l.chevron})]},`${m}/${y}`));return(0,t.jsx)("div",{className:(0,n.cx)(l.label,o),children:(0,t.jsxs)("label",{...g,children:[(0,t.jsxs)("div",{className:l.labelContent,children:[p,a]}),c&&(0,t.jsx)("span",{className:l.description,children:c})]})})},f=a=>({label:(0,n.css)({label:"Label",fontSize:a.typography.size.sm,fontWeight:a.typography.fontWeightMedium,lineHeight:1.25,marginBottom:a.spacing(.5),color:a.colors.text.primary,maxWidth:"480px"}),labelContent:(0,n.css)({display:"flex",alignItems:"center"}),description:(0,n.css)({label:"Label-description",color:a.colors.text.secondary,fontSize:a.typography.size.sm,fontWeight:a.typography.fontWeightRegular,marginTop:a.spacing(.25),display:"block"}),categories:(0,n.css)({label:"Label-categories",display:"inline-flex",alignItems:"center"}),chevron:(0,n.css)({margin:a.spacing(0,.25)})})},91634:(G,O,e)=>{"use strict";e.d(O,{O:()=>f,p:()=>a});var t=e(74848),n=e(46942),i=e.n(n),s=e(96540),r=e(29734),f=(c=>(c.Invalid="invalid",c.Valid="valid",c))(f||{});class a extends s.PureComponent{constructor(){super(...arguments),this.state={error:null},this.validatorAsync=o=>h=>{const g=(0,r.tf)(h.target.value,o);this.setState(l=>({...l,error:g?g[0]:null}))},this.populateEventPropsWithStatus=(o,h)=>{const g={...o};return h&&Object.keys(r.Pw).forEach(l=>{((0,r.K)(l,h)||o[l])&&(g[l]=async p=>{p.persist(),(0,r.K)(l,h)&&await this.validatorAsync(h[l]).apply(this,[p]),o[l]&&o[l].apply(null,[p,this.status])})}),g}}static{this.defaultProps={className:""}}get status(){return this.state.error?"invalid":"valid"}get isInvalid(){return this.status==="invalid"}render(){const{validationEvents:o,className:h,hideErrorMessage:g,inputRef:l,...p}=this.props,{error:m}=this.state,y=i()("gf-form-input",{invalid:this.isInvalid},h),d=this.populateEventPropsWithStatus(p,o);return(0,t.jsxs)("div",{style:{flexGrow:1},children:[(0,t.jsx)("input",{...d,ref:l,className:y}),m&&!g&&(0,t.jsx)("span",{children:m})]})}}},24169:(G,O,e)=>{"use strict";e.d(O,{A:()=>r,s:()=>s});var t=e(74848),n=e(28581),i=e(14578);const s=f=>{const a=f.selectProps.menuIsOpen;return(0,t.jsx)(n.c.IndicatorsContainer,{...f,children:(0,t.jsx)(i.I,{name:a?"angle-up":"angle-down",style:{marginTop:"7px"}})})},r=s},11206:(G,O,e)=>{"use strict";e.d(O,{A:()=>s,l:()=>i});var t=e(74848),n=e(28581);const i=r=>{const{children:f}=r;return(0,t.jsx)(n.c.NoOptionsMessage,{...r,children:(0,t.jsx)("div",{className:"gf-form-select-box__desc-option",children:(0,t.jsx)("div",{className:"gf-form-select-box__desc-option__body",children:f})})})},s=i},22209:(G,O,e)=>{"use strict";e.d(O,{DW:()=>T,l6:()=>I});var t=e(74848),n=e(46942),i=e.n(n),s=e(96540),r=e(28581),f=e(46005),a=e(8539),c=e(66963),o=e(60578),h=e(40276),g=e(62235),l=e(23731),p=e(56034),m=e(24169),y=e(11206),d=e(14578);const v=A=>{const{children:L,isSelected:U,data:W}=A;return(0,t.jsx)(r.c.Option,{...A,children:(0,t.jsxs)("div",{className:"gf-form-select-box__desc-option",children:[W.imgUrl&&(0,t.jsx)("img",{className:"gf-form-select-box__desc-option__img",src:W.imgUrl,alt:""}),(0,t.jsxs)("div",{className:"gf-form-select-box__desc-option__body",children:[(0,t.jsx)("div",{children:L}),W.description&&(0,t.jsx)("div",{className:"gf-form-select-box__desc-option__desc",children:W.description})]}),U&&(0,t.jsx)(d.I,{name:"check","aria-hidden":"true"})]})})},u=null;var D=e(32196),P=e(3911),x=e(40845);const E=(0,P.N)(A=>({header:(0,D.css)({display:"flex",alignItems:"center",justifyContent:"flex-start",justifyItems:"center",cursor:"pointer",padding:"7px 10px",width:"100%",borderBottom:`1px solid ${A.colors.background.secondary}`,"&:hover":{color:A.colors.text.maxContrast}}),label:(0,D.css)({flexGrow:1}),icon:(0,D.css)({paddingRight:"2px"})}));class C extends s.PureComponent{constructor(){super(...arguments),this.state={expanded:!1},this.onToggleChildren=()=>{this.setState(L=>({expanded:!L.expanded}))}}componentDidMount(){if(this.props.data.expanded)this.setState({expanded:!0});else if(this.props.selectProps&&this.props.selectProps.value){const{value:L}=this.props.selectProps.value;L&&this.props.options.some(U=>U.value===L)&&this.setState({expanded:!0})}}componentDidUpdate(L){L.selectProps.inputValue!==""&&this.setState({expanded:!0})}render(){const{children:L,label:U,theme:W}=this.props,{expanded:w}=this.state,N=E(W);return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:N.header,onClick:this.onToggleChildren,role:"presentation",children:[(0,t.jsx)("span",{className:N.label,children:U}),(0,t.jsx)(d.I,{className:N.icon,name:w?"angle-up":"angle-down"})]}),w&&L]})}}const M=(0,x.cV)(C),S=A=>(0,t.jsx)(r.c.MenuList,{...A,children:(0,t.jsx)(h.E,{autoHide:!1,autoHeightMax:"inherit",children:A.children})});class I extends s.PureComponent{static{this.contextType=o.D}static{this.defaultProps={className:"",isDisabled:!1,isSearchable:!0,isClearable:!1,isMulti:!1,openMenuOnFocus:!1,autoFocus:!1,isLoading:!1,backspaceRemovesValue:!0,maxMenuHeight:300,tabSelectsValue:!0,allowCustomValue:!1,components:{Option:v,SingleValue:g.K,IndicatorsContainer:m.A,MenuList:S,Group:M}}}render(){const{defaultValue:L,getOptionLabel:U,getOptionValue:W,onChange:w,options:N,placeholder:B,width:V,value:K,className:H,isDisabled:X,isLoading:k,isSearchable:Y,isClearable:Z,backspaceRemovesValue:se,isMulti:j,autoFocus:q,openMenuOnFocus:ne,onBlur:oe,maxMenuHeight:z,noOptionsMessage:te,isOpen:le,components:ie,tooltipContent:ae,tabSelectsValue:re,onCloseMenu:ce,onOpenMenu:me,allowCustomValue:ee,formatCreateLabel:de,"aria-label":De}=this.props;let fe="";V&&(fe="width-"+V);let Te=f.Ay;const je={};ee&&(Te=c.A,je.formatCreateLabel=de??(Ne=>Ne));const He=i()("gf-form-input","gf-form-input--form-dropdown",fe,H),Be={...I.defaultProps.components,...ie};return(0,t.jsx)(b,{onCloseMenu:ce,onOpenMenu:me,tooltipContent:ae,isOpen:le,children:(Ne,Re)=>(0,t.jsx)(Te,{captureMenuScroll:!1,classNamePrefix:"gf-form-select-box",className:He,components:Be,defaultValue:L,value:K,getOptionLabel:U,getOptionValue:W,menuShouldScrollIntoView:!1,isSearchable:Y,onChange:w,options:N,placeholder:B||"Choose",styles:(0,l.A)(this.context),isDisabled:X,isLoading:k,isClearable:Z,autoFocus:q,onBlur:oe,openMenuOnFocus:ne,maxMenuHeight:z,noOptionsMessage:te,isMulti:j,backspaceRemovesValue:se,menuIsOpen:le,onMenuOpen:Ne,onMenuClose:Re,tabSelectsValue:re,"aria-label":De,...je})})}}class T extends s.PureComponent{static{this.contextType=o.D}static{this.defaultProps={className:"",components:{},loadingMessage:()=>"Loading...",isDisabled:!1,isClearable:!1,isMulti:!1,isSearchable:!0,backspaceRemovesValue:!0,autoFocus:!1,openMenuOnFocus:!1,maxMenuHeight:300}}render(){const{defaultValue:L,getOptionLabel:U,getOptionValue:W,onChange:w,placeholder:N,width:B,value:V,className:K,loadOptions:H,defaultOptions:X,isLoading:k,loadingMessage:Y,noOptionsMessage:Z,isDisabled:se,isSearchable:j,isClearable:q,backspaceRemovesValue:ne,autoFocus:oe,onBlur:z,openMenuOnFocus:te,maxMenuHeight:le,isMulti:ie,tooltipContent:ae,onCloseMenu:re,onOpenMenu:ce,isOpen:me}=this.props;let ee="";B&&(ee="width-"+B);const de=i()("gf-form-input","gf-form-input--form-dropdown",ee,K);return(0,t.jsx)(b,{onCloseMenu:re,onOpenMenu:ce,tooltipContent:ae,isOpen:me,children:(De,fe)=>(0,t.jsx)(a.A,{captureMenuScroll:!1,classNamePrefix:"gf-form-select-box",className:de,components:{Option:v,SingleValue:g.K,IndicatorsContainer:m.A,NoOptionsMessage:y.A},defaultValue:L,value:V,getOptionLabel:U,getOptionValue:W,menuShouldScrollIntoView:!1,onChange:w,loadOptions:H,isLoading:k,defaultOptions:X,placeholder:N||"Choose",styles:(0,l.A)(this.context),loadingMessage:Y,noOptionsMessage:Z,isDisabled:se,isSearchable:j,isClearable:q,autoFocus:oe,onBlur:z,openMenuOnFocus:te,maxMenuHeight:le,isMulti:ie,backspaceRemovesValue:ne})})}}class b extends s.PureComponent{constructor(){super(...arguments),this.state={isOpenInternal:!1},this.onOpenMenu=()=>{const{onOpenMenu:L}=this.props;L&&L(),this.setState({isOpenInternal:!0})},this.onCloseMenu=()=>{const{onCloseMenu:L}=this.props;L&&L(),this.setState({isOpenInternal:!1})}}render(){const{children:L,isOpen:U,tooltipContent:W}=this.props,{isOpenInternal:w}=this.state;let N;return(w||U)&&(N=!1),W?(0,t.jsx)(p.m,{show:N,content:W,placement:"bottom",children:(0,t.jsx)("div",{children:L(this.onOpenMenu,this.onCloseMenu)})}):(0,t.jsx)("div",{children:L(this.onOpenMenu,this.onCloseMenu)})}}const R=null},74716:(G,O,e)=>{"use strict";e.d(O,{d:()=>h});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(96540),f=e(40845),a=e(14578),c=e(56034);class o extends r.PureComponent{constructor(){super(...arguments),this.state={id:(0,i.uniqueId)()},this.internalOnChange=p=>{p.stopPropagation(),this.props.onChange(p)}}render(){const{labelClass:p="",switchClass:m="",label:y,checked:d,disabled:v,transparent:u,className:D,theme:P,tooltip:x,tooltipPlacement:E}=this.props,C=g(P),M=this.state.id,S=`gf-form-label ${p} ${u?"gf-form-label--transparent":""} pointer`,I=(0,n.cx)(C.switch,m,{[C.switchTransparent]:u});return(0,t.jsx)("div",{className:C.container,children:(0,t.jsxs)("label",{htmlFor:M,className:(0,n.cx)("gf-form",C.labelContainer,D),children:[y&&(0,t.jsxs)("div",{className:S,children:[y,x&&(0,t.jsx)(c.m,{placement:E||"auto",content:x,theme:"info",children:(0,t.jsx)(a.I,{name:"info-circle",size:"sm",style:{marginLeft:"10px"}})})]}),(0,t.jsxs)("div",{className:I,children:[(0,t.jsx)("input",{disabled:v,id:M,type:"checkbox",checked:d,onChange:this.internalOnChange}),(0,t.jsx)("span",{className:C.slider})]})]})})}}const h=(0,f.cV)(o),g=l=>{const p=(0,n.css)({background:l.v1.palette.gray1,borderRadius:l.shape.radius.pill,height:"16px",width:"32px",display:"block",position:"relative","&::before":{position:"absolute",content:"''",height:"12px",width:"12px",left:"2px",top:"2px",background:l.components.input.background,transition:"0.4s",borderRadius:l.shape.radius.circle,boxShadow:l.shadows.z1}});return{container:(0,n.css)({display:"flex",flexShrink:0}),labelContainer:(0,n.css)({display:"flex",cursor:"pointer",marginRight:l.spacing(.5)}),switch:(0,n.css)({display:"flex",position:"relative",width:"56px",height:l.spacing(4),background:l.components.input.background,border:`1px solid ${l.components.input.borderColor}`,borderRadius:l.shape.radius.default,alignItems:"center",justifyContent:"center",input:{opacity:0,width:0,height:0},[`input:checked + .${p}`]:{background:l.colors.primary.main},[`input:checked + .${p}::before`]:{transform:"translateX(16px)"}}),switchTransparent:(0,n.css)({background:"transparent",border:0,width:"40px"}),slider:p}}},17408:(G,O,e)=>{"use strict";e.d(O,{s:()=>r});var t=e(74848),n=e(32196),i=e(40845);const s=f=>({legend:(0,n.css)({fontSize:f.typography.h3.fontSize,fontWeight:f.typography.fontWeightRegular,margin:f.spacing(0,0,2,0)})}),r=({children:f,className:a,...c})=>{const o=(0,i.of)(s);return(0,t.jsx)("legend",{className:(0,n.cx)(o.legend,a),...c,children:f})}},94354:(G,O,e)=>{"use strict";e.d(O,{z:()=>m});var t=e(74848),n=e(32196),i=e(2543),s=e(96540),r=e(8887),f=e(40845),a=e(14578),c=e(13544),o=e(16797),h=e(56034),g=e(87266);const l=s.forwardRef(({children:d,active:v=!1,disabled:u=!1,size:D="md",onChange:P,onClick:x,id:E,name:C=void 0,description:M,fullWidth:S,"aria-label":I},T)=>{const b=(0,f.of)(p,D,S),R=(0,t.jsx)("input",{type:"radio",className:b.radio,onChange:P,onClick:x,disabled:u,id:E,checked:v,name:C,"aria-label":I,ref:T});return M?(0,t.jsxs)("div",{className:b.radioOption,"data-testid":c.Tp.components.RadioButton.container,children:[(0,t.jsx)(h.m,{content:M,placement:"bottom",children:R}),(0,t.jsx)("label",{className:b.radioLabel,htmlFor:E,title:M||I,children:d})]}):(0,t.jsxs)("div",{className:b.radioOption,"data-testid":c.Tp.components.RadioButton.container,children:[R,(0,t.jsx)("label",{className:b.radioLabel,htmlFor:E,title:M||I,children:d})]})});l.displayName="RadioButton";const p=(d,v,u)=>{const{fontSize:D,height:P,padding:x}=(0,g.SM)(v,d),E=d.colors.text.secondary,C=d.colors.text.primary,M=P*d.spacing.gridSize-4-2;return{radioOption:(0,n.css)({display:"flex",justifyContent:"space-between",position:"relative",flex:u?"1 0 0":"none",textAlign:"center"}),radio:(0,n.css)({position:"absolute",opacity:0,zIndex:2,width:"100% !important",height:"100%",cursor:"pointer","&:checked + label":{color:d.colors.text.primary,fontWeight:d.typography.fontWeightMedium,background:d.colors.action.selected,zIndex:1},"&:focus + label, &:focus-visible + label":(0,o.getFocusStyles)(d),"&:focus:not(:focus-visible) + label":(0,o.getMouseFocusStyles)(d),"&:disabled + label":{color:d.colors.text.disabled,cursor:"not-allowed"}}),radioLabel:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"center",fontSize:D,height:`${M}px`,lineHeight:`${M}px`,color:E,padding:d.spacing(0,x),borderRadius:d.shape.radius.default,background:d.colors.background.primary,cursor:"pointer",userSelect:"none",whiteSpace:"nowrap",flexGrow:1,"&:hover":{color:C}})}};function m({options:d,value:v,onChange:u,onClick:D,disabled:P,disabledOptions:x,size:E="md",id:C,className:M,fullWidth:S=!1,autoFocus:I=!1,"aria-label":T,invalid:b=!1}){const R=(0,s.useCallback)(N=>()=>{u&&u(N.value)},[u]),A=(0,s.useCallback)(N=>()=>{D&&D(N.value)},[D]),L=C??(0,i.uniqueId)("radiogroup-"),U=(0,s.useRef)(L),W=(0,f.of)(y),w=(0,s.useRef)(null);return(0,s.useEffect)(()=>{I&&w.current&&w.current.focus()},[I]),(0,t.jsx)("div",{role:"radiogroup","aria-label":T,className:(0,n.cx)(W.radioGroup,S&&W.fullWidth,b&&W.invalid,M),children:d.map((N,B)=>{const V=x&&N.value&&x.includes(N.value),K=N.icon?(0,r.Uo)(N.icon):void 0,H=!!(N.imgUrl||N.label||N.component);return(0,t.jsxs)(l,{size:E,disabled:V||P,active:v===N.value,"aria-label":N.ariaLabel,onChange:R(N),onClick:A(N),id:`option-${N.value}-${L}`,name:U.current,description:N.description,fullWidth:S,ref:v===N.value?w:void 0,children:[K&&(0,t.jsx)(a.I,{name:K,className:(0,n.cx)(H&&W.icon)}),N.imgUrl&&(0,t.jsx)("img",{src:N.imgUrl,alt:N.label,className:W.img}),N.label," ",N.component?(0,t.jsx)(N.component,{}):null]},`o.label-${B}`)})})}m.displayName="RadioButtonGroup";const y=d=>({radioGroup:(0,n.css)({display:"inline-flex",flexDirection:"row",flexWrap:"nowrap",border:`1px solid ${d.components.input.borderColor}`,borderRadius:d.shape.radius.default,padding:"2px"}),fullWidth:(0,n.css)({display:"flex"}),icon:(0,n.css)({marginRight:"6px"}),img:(0,n.css)({width:d.spacing(2),height:d.spacing(2),marginRight:d.spacing(1)}),invalid:(0,n.css)({border:`1px solid ${d.colors.error.border}`})})},79569:(G,O,e)=>{"use strict";e.d(O,{J:()=>s});var t=e(74848),n=e(32196),i=e(40845);const s=({id:f,name:a,label:c,checked:o,value:h,disabled:g,description:l,onChange:p,...m})=>{const y=(0,i.of)(r);return(0,t.jsxs)("label",{title:l,className:y.label,children:[(0,t.jsx)("input",{...m,id:f,name:a,type:"radio",checked:o,value:h,disabled:g,className:y.input,onChange:()=>p&&p(f)}),(0,t.jsxs)("div",{children:[c,l&&(0,t.jsx)("div",{className:y.description,children:l})]})]})},r=f=>({input:(0,n.css)({position:"relative",appearance:"none",outline:"none",backgroundColor:f.colors.background.canvas,width:`${f.spacing(2)} !important`,height:f.spacing(2),border:`1px solid ${f.colors.border.medium}`,borderRadius:f.shape.radius.circle,margin:"3px 0",":checked":{backgroundColor:f.v1.palette.white,border:`5px solid ${f.colors.primary.main}`},":disabled":{backgroundColor:`${f.colors.action.disabledBackground} !important`,borderColor:f.colors.border.weak},":disabled:checked":{border:`1px solid ${f.colors.border.weak}`},":disabled:checked::after":{content:'""',width:"6px",height:"6px",backgroundColor:f.colors.text.disabled,borderRadius:f.shape.radius.circle,display:"inline-block",position:"absolute",top:"4px",left:"4px"},":focus":{outline:"none !important",boxShadow:`0 0 0 1px ${f.colors.background.canvas}, 0 0 0 3px ${f.colors.primary.main}`}}),label:(0,n.css)({fontSize:f.typography.fontSize,lineHeight:"22px",display:"grid",gridTemplateColumns:`${f.spacing(2)} auto`,gap:f.spacing(1)}),description:(0,n.css)({fontSize:f.typography.size.sm,color:f.colors.text.secondary})})},83186:(G,O,e)=>{"use strict";e.d(O,{a:()=>a});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(40845),f=e(79569);function a({name:o,id:h,options:g,value:l,onChange:p,className:m,disabled:y,disabledOptions:d=[]}){const v=(0,r.of)(c),u=h??(0,i.uniqueId)("radiogroup-list-");return(0,t.jsx)("div",{id:h,className:(0,n.cx)(v.container,m),role:"radiogroup",children:g.map((D,P)=>{const x=`${u}-${P}`,E=l&&l===D.value,C=y||d.some(S=>S===D.value),M=()=>p&&D.value&&p(D.value);return(0,t.jsx)(f.J,{id:x,name:o,label:D.label,description:D.description,checked:E,value:D.value,disabled:C,onChange:M},P)})})}const c=o=>({container:(0,n.css)({display:"grid",gap:o.spacing(1)})})},87266:(G,O,e)=>{"use strict";e.d(O,{SM:()=>c,Xb:()=>s,g$:()=>r,gm:()=>i,lH:()=>f});var t=e(32196),n=e(16797);const i=o=>(0,t.css)({"&:focus":(0,n.getFocusStyles)(o)}),s=(o,h=!1)=>{const g=h?o.colors.error.border:o.components.input.borderColor,l=h?o.colors.error.shade:o.components.input.borderHover,p=o.components.input.background,m=o.components.input.text,y=o.isDark?"#2e2f35":"#bab4ca";return(0,t.cx)(r(o),(0,t.css)({background:p,lineHeight:o.typography.body.lineHeight,fontSize:o.typography.size.md,color:m,border:`1px solid ${g}`,"&:-webkit-autofill, &:-webkit-autofill:hover":{boxShadow:`inset 0 0 0 1px rgba(255, 255, 255, 0), inset 0 0 0 100px ${p}!important`,WebkitTextFillColor:`${m} !important`,borderColor:y},"&:-webkit-autofill:focus":{boxShadow:`0 0 0 2px ${o.colors.background.primary}, 0 0 0px 4px ${o.colors.primary.main}, inset 0 0 0 1px rgba(255, 255, 255, 0), inset 0 0 0 100px ${p}!important`,WebkitTextFillColor:`${m} !important`},"&:hover":{borderColor:l},"&:focus":{outline:"none"},"&:disabled":{backgroundColor:o.colors.action.disabledBackground,color:o.colors.action.disabledText,border:`1px solid ${o.colors.action.disabledBackground}`,"&:hover":{borderColor:g}},"&::placeholder":{color:o.colors.text.disabled,opacity:1}}))},r=o=>(0,t.css)({padding:o.spacing(0,1,0,1)}),f=()=>({sm:(0,t.css)({width:a("sm")}),md:(0,t.css)({width:a("md")}),lg:(0,t.css)({width:a("lg")}),auto:(0,t.css)({width:a("auto")})}),a=o=>{switch(o){case"sm":return"200px";case"md":return"320px";case"lg":return"580px";case"auto":default:return"auto"}};function c(o,h){switch(o){case"sm":return{padding:1,fontSize:h.typography.size.sm,height:h.components.height.sm};case"lg":return{padding:3,fontSize:h.typography.size.lg,height:h.components.height.lg};case"md":default:return{padding:2,fontSize:h.typography.size.md,height:h.components.height.md}}}},95164:(G,O,e)=>{"use strict";e.d(O,{_:()=>d});var t=e(74848),n=e(34796),i=e.n(n),s=e(96540),r=e(83195),f=e(58649),a=e(50082),c=e(52622),o=e(29413),h=e(55852),g=e(24293),l=e(47737);const p={mode:a.O.Absolute,steps:[{value:-1/0,color:"green"},{value:80,color:"red"}]};function m(v,u,D,P){const x=D!=null,E=P===c.wV.Vertical?u:v,C=Math.min(E*.15/1.5,20),M=C*1.5,S=x?u-M:u,I=Math.min(S,v);return{showLabel:x,gaugeHeight:I,titleFontSize:C}}function y(v,u,D,P){if(u.color?.mode!==g.Y.Thresholds)return[{value:u.min??f.tw,color:D.color??g.F}];const x=u.thresholds??p,E=x.mode===a.O.Percentage,C=x.steps;let M=u.min??f.tw,S=u.max??f.d1;E&&(M=0,S=100);const I=(0,l.yQ)(M,C),T=(0,l.yQ)(S,C),b=[{value:+M.toFixed(v),color:P.visualization.getColorByName(I.color)}];let R=!0;for(let A=0;A<C.length;A++){const L=C[A];if(R){I===L&&(R=!1);continue}const U=C[A-1];if(b.push({value:L.value,color:P.visualization.getColorByName(U.color)}),L===T)break}return b.push({value:+S.toFixed(v),color:P.visualization.getColorByName(T.color)}),b}class d extends s.PureComponent{constructor(){super(...arguments),this.canvasElement=null,this.renderVisualization=()=>{const{width:u,value:D,height:P,onClick:x,text:E,theme:C,orientation:M}=this.props,S=m(u,P,D.title,M),I=M===c.wV.Vertical?`${S.gaugeHeight}px`:"100%",T=(0,t.jsx)("div",{style:{height:`${S.gaugeHeight}px`,width:I},ref:b=>this.canvasElement=b});return(0,t.jsxs)(t.Fragment,{children:[x?(0,t.jsx)("button",{className:(0,h.my)(C),type:"button",onClick:x,children:T}):T,S.showLabel&&(0,t.jsx)("div",{style:{textAlign:"center",fontSize:E?.titleSize??S.titleFontSize,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",position:"relative",width:I,top:"-4px",cursor:"default"},children:D.title})]})}}static{this.defaultProps={showThresholdMarkers:!0,showThresholdLabels:!1,field:{min:0,max:100,thresholds:p}}}componentDidMount(){this.draw()}componentDidUpdate(){this.draw()}draw(){const{field:u,showThresholdLabels:D,showThresholdMarkers:P,width:x,height:E,theme:C,value:M,orientation:S}=this.props,I=m(x,E,M.title),T=S===c.wV.Vertical?I.gaugeHeight:x,b=Math.min(T,I.gaugeHeight),R=C.colors.background.secondary,A=D?1.5:1,L=Math.min(b/5.5,40)/A,U=L/5,W=(0,r.cN)(M),N=Math.min(T,b*1.3)*.9-((L+(P?U:0)+(D?10:0))*2+10),B=this.props.text?.valueSize??(0,o.Vr)(W,N,b,1,L*1.7),V=Math.max(B/2.5,12);let K=u.min??f.tw,H=u.max??f.d1,X=M.numeric;u.thresholds?.mode===a.O.Percentage&&(K=0,H=100,M.percent===void 0?X=(X-K)/(H-K)*100:X=M.percent*100);const k=u.decimals===void 0?2:u.decimals;P&&(K=+K.toFixed(k),H=+H.toFixed(k));const Y={series:{gauges:{gauge:{min:K,max:H,neutralValue:u.custom?.neutral,background:{color:R},border:{color:null},shadow:{show:!1},width:L},frame:{show:!1},label:{show:!1},layout:{margin:0,thresholdWidth:0,vMargin:0},cell:{border:{width:0}},threshold:{values:y(k,u,M,C),label:{show:D,margin:U+1,font:{size:V}},show:P,width:U},value:{color:M.color,formatter:()=>W,font:{size:B,family:C.typography.fontFamily}},show:!0}}},Z={data:[[0,X]],label:M.title};try{this.canvasElement&&i().plot(this.canvasElement,[Z],Y)}catch(se){console.error("Gauge rendering error",se,Y,M)}}render(){return(0,t.jsx)("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",overflow:"hidden"},className:this.props.className,children:this.renderVisualization()})}}},29158:(G,O,e)=>{"use strict";e.d(O,{K:()=>g});var t=e(74848),n=e(32196),i=e(96540),s=e(95344),r=e(23596),f=e(40845),a=e(16797),c=e(55852),o=e(78318),h=e(56034);const g=i.forwardRef((p,m)=>{const{size:y="md",variant:d="secondary"}=p;let v;y==="xxl"||y==="xxxl"?((0,s.l)("IconButton",'size="xxl" and size="xxxl"','size="xl"'),v="xl"):v=y;const u=(0,f.of)(l,v,d);let D,P;if("tooltip"in p){const{tooltip:x}=p;D=typeof x=="string"?x:void 0}else if("ariaLabel"in p||"aria-label"in p){const{ariaLabel:x,["aria-label"]:E}=p;D=E||x,P=m}if("tooltip"in p){const{name:x,iconType:E,className:C,tooltip:M,tooltipPlacement:S,...I}=p;return(0,t.jsx)(h.m,{ref:m,content:M,placement:S,children:(0,t.jsx)("button",{...I,ref:P,"aria-label":D,className:(0,n.cx)(u.button,C),type:"button",children:(0,t.jsx)(c.Jt,{icon:x,size:v,className:u.icon,iconType:E})})})}else{const{name:x,iconType:E,className:C,...M}=p;return(0,t.jsx)("button",{...M,ref:P,"aria-label":D,className:(0,n.cx)(u.button,C),type:"button",children:(0,t.jsx)(c.Jt,{icon:x,size:v,className:u.icon,iconType:E})})}});g.displayName="IconButton";const l=(p,m,y)=>{const d=(0,o.cs)(m)+p.spacing.gridSize;let v=p.colors.text.primary;return y==="primary"?v=p.colors.primary.text:y==="destructive"&&(v=p.colors.error.text),{button:(0,n.css)({zIndex:0,position:"relative",margin:`0 ${p.spacing.x0_5} 0 0`,boxShadow:"none",border:"none",display:"inline-flex",background:"transparent",justifyContent:"center",alignItems:"center",padding:0,color:v,"&[disabled], &:disabled":{cursor:"not-allowed",color:p.colors.action.disabledText,opacity:.65},"&:before":{zIndex:-1,position:"absolute",opacity:0,width:`${d}px`,height:`${d}px`,borderRadius:p.shape.radius.default,content:'""',[p.transitions.handleMotion("no-preference","reduce")]:{transitionDuration:"0.2s",transitionTimingFunction:"cubic-bezier(0.4, 0, 0.2, 1)",transitionProperty:"opacity"}},"&:focus, &:focus-visible":(0,a.getFocusStyles)(p),"&:focus:not(:focus-visible)":(0,a.getMouseFocusStyles)(p),"&:hover":{"&:before":{backgroundColor:y==="secondary"?p.colors.action.hover:r.MV.alpha(v,.12),opacity:1}}}),icon:(0,n.css)({verticalAlign:"baseline"})}}},14578:(G,O,e)=>{"use strict";e.d(O,{I:()=>h});var t=e(74848),n=e(32196),i=e(96540),s=e(8867),r=e(8887),f=e(40845),a=e(87019),c=e(78318);const o=g=>({icon:(0,n.css)({display:"inline-block",fill:"currentColor",flexShrink:0,label:"Icon",lineHeight:0,verticalAlign:"middle"}),orange:(0,n.css)({fill:g.v1.palette.orange}),spin:(0,n.css)({[g.transitions.handleMotion("no-preference","reduce")]:{animation:`${a.t} 2s infinite linear`}})}),h=i.forwardRef(({size:g="md",type:l="default",name:p,className:m,style:y,title:d="",...v},u)=>{const D=(0,f.of)(o);(0,r.n6)(p)||console.warn("Icon component passed an invalid icon name",p);const P=p==="fa fa-spinner"?"spinner":p,x=(0,c.Wj)(),E=(0,c.cs)(g),C=E,M=p.startsWith("gf-bar-align")?16:p.startsWith("gf-interp")?30:E,S=(0,c.Xi)(P,l),I=`${x}${S}/${P}.svg`,T=(0,n.cx)(D.icon,m,l==="mono"?{[D.orange]:p==="favorite"}:"",{[D.spin]:P==="spinner"});return(0,t.jsx)(s.default,{"aria-hidden":v.tabIndex===void 0&&!d&&!v["aria-label"]&&!v["aria-labelledby"]&&!v["aria-describedby"],innerRef:u,src:I,width:M,height:C,title:d,className:T,style:y,...v})});h.displayName="Icon"},78318:(G,O,e)=>{"use strict";e.d(O,{Wj:()=>r,Xi:()=>n,cs:()=>i});const t=["grafana","favorite","heart-break","heart","panel-add","library-panel","circle-mono"];function n(f,a){return f?.startsWith("gf-")?"custom":t.includes(f)?"mono":a==="default"?"unicons":a==="solid"?"solid":"mono"}function i(f){switch(f){case"xs":return 12;case"sm":return 14;case"md":return 16;case"lg":return 18;case"xl":return 24;case"xxl":return 36;case"xxxl":return 48}}let s;function r(){if(s)return s;const f=typeof window<"u"&&window.__grafana_public_path__;return f?s=f+"img/icons/":s="public/img/icons/",s}},86460:(G,O,e)=>{"use strict";e.d(O,{e:()=>a});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(29678),f=e(37166);const a=(0,i.memo)((0,i.forwardRef)(({title:o,featureState:h,...g},l)=>{const p=(0,s.of)(c),m=h?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:p.badge,children:(0,t.jsx)(r.y,{featureState:h})}),(0,t.jsx)("h3",{children:o})]}):(0,t.jsx)("h3",{children:o});return(0,t.jsx)(f.w,{branded:!0,title:m,urlTitle:"Read documentation",ref:l,...g})}));a.displayName="FeatureInfoBox";const c=o=>({badge:(0,n.css)({marginBottom:o.spacing(1)})})},37166:(G,O,e)=>{"use strict";e.d(O,{w:()=>a});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(42418),f=e(14578);const a=i.memo(i.forwardRef(({title:o,className:h,children:g,branded:l,url:p,urlTitle:m,onDismiss:y,severity:d="info",...v},u)=>{const D=(0,s.of)(c);return(0,t.jsxs)(r.F,{severity:d,className:h,...v,ref:u,title:o,children:[(0,t.jsx)("div",{children:g}),p&&(0,t.jsxs)("a",{href:p,className:(0,n.cx)("external-link",D.docsLink),target:"_blank",rel:"noreferrer",children:[(0,t.jsx)(f.I,{name:"book"})," ",m||"Read more"]})]})}));a.displayName="InfoBox";const c=o=>({docsLink:(0,n.css)({display:"inline-block",marginTop:o.spacing(2)})})},32982:(G,O,e)=>{"use strict";e.d(O,{r:()=>h});var t=e(74848),n=e(32196),i=e(34743),s=e(36376),r=e(7315),f=e(96540),a=e(40845),c=e(14578),o=e(17464);function h({referenceElement:p,children:m,suffixIcon:y,placement:d}){const v=(0,a.of)(g),u=(0,a.$j)(),D=[(0,i.cY)(8),(0,i.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,i.BN)()],{context:P,refs:x,floatingStyles:E}=(0,s.we)({open:!0,placement:d,middleware:D,whileElementsMounted:r.ll,strategy:"fixed"});(0,f.useLayoutEffect)(()=>{x.setReference(p)},[p,x]);const{styles:C}=(0,s.DL)(P,{initial:({side:M})=>({opacity:0,transform:l(M,u)}),duration:u.transitions.duration.shortest});return(0,t.jsx)(o.ZL,{children:(0,t.jsx)("div",{style:{display:"inline-block",...E},ref:x.setFloating,"aria-live":"polite",children:(0,t.jsxs)("span",{className:(0,n.cx)(v.root),style:C,children:[m&&(0,t.jsx)("span",{children:m}),y&&(0,t.jsx)(c.I,{name:y})]})})})}const g=p=>({root:(0,n.css)({...p.typography.bodySmall,willChange:"transform",background:p.components.tooltip.background,color:p.components.tooltip.text,padding:p.spacing(.5,1.5),borderRadius:p.shape.radius.pill,display:"inline-flex",gap:p.spacing(.5),alignItems:"center"})}),l=(p,m)=>{switch(p){case"top":return`translateY(${m.spacing(1)})`;case"bottom":return`translateY(-${m.spacing(1)})`;case"left":return`translateX(${m.spacing(1)})`;case"right":return`translateX(-${m.spacing(1)})`}}},16504:(G,O,e)=>{"use strict";e.d(O,{e:()=>n});var t=e(49785);const n=t.xI},51440:(G,O,e)=>{"use strict";e.d(O,{D:()=>r});var t=e(74848),n=e(96540),i=e(29413),s=e(10354);const r=n.forwardRef((a,c)=>{const{defaultValue:o="",minWidth:h=10,maxWidth:g,onCommitChange:l,onKeyDown:p,onBlur:m,...y}=a,[d,v]=n.useState(o),[u,D]=n.useState(h);return(0,n.useEffect)(()=>{D(f(d.toString(),h,g))},[d,g,h]),(0,t.jsx)(s.p,{...y,ref:c,value:d.toString(),onChange:P=>{v(P.currentTarget.value)},width:u,onBlur:P=>{m?m(P):l&&l(P)},onKeyDown:P=>{p?p(P):P.key==="Enter"&&l&&l(P)},"data-testid":"autosize-input"})});function f(a,c,o){if(!a)return c;const g=(0,i.kD)(a.toString(),14).width/8+3;return c&&g<c?c:o&&g>o?o:g}r.displayName="AutoSizeInput"},10354:(G,O,e)=>{"use strict";e.d(O,{n:()=>h,p:()=>o});var t=e(74848),n=e(32196),i=e(96540),s=e(71473),r=e(40845),f=e(3911),a=e(87266),c=e(62930);const o=(0,i.forwardRef)((g,l)=>{const{className:p,addonAfter:m,addonBefore:y,prefix:d,suffix:v,invalid:u,loading:D,width:P=0,...x}=g,[E,C]=(0,s.A)(),[M,S]=(0,s.A)(),I=(0,r.$j)(),T=h({theme:I,invalid:!!u,width:P});return(0,t.jsxs)("div",{className:(0,n.cx)(T.wrapper,p),"data-testid":"input-wrapper",children:[!!y&&(0,t.jsx)("div",{className:T.addon,children:y}),(0,t.jsxs)("div",{className:T.inputWrapper,children:[d&&(0,t.jsx)("div",{className:T.prefix,ref:E,children:d}),(0,t.jsx)("input",{ref:l,className:T.input,...x,style:{paddingLeft:d?C.width+12:void 0,paddingRight:v||D?S.width+12:void 0}}),(v||D)&&(0,t.jsxs)("div",{className:T.suffix,ref:M,children:[D&&(0,t.jsx)(c.y,{className:T.loadingIndicator,inline:!0}),v]})]}),!!m&&(0,t.jsx)("div",{className:T.addon,children:m})]})});o.displayName="Input";const h=(0,f.N)(({theme:g,invalid:l=!1,width:p})=>{const m="28px",y=(0,n.css)({position:"absolute",top:0,zIndex:1,display:"flex",alignItems:"center",justifyContent:"center",flexGrow:0,flexShrink:0,fontSize:g.typography.size.md,height:"100%",minWidth:m,color:g.colors.text.secondary});return{wrapper:(0,n.cx)((0,n.css)({label:"input-wrapper",display:"flex",width:p?g.spacing(p):"100%",height:g.spacing(g.components.height.md),borderRadius:g.shape.radius.default,"&:hover":{"> .prefix, .suffix, .input":{borderColor:l?g.colors.error.border:g.colors.primary.border},"input[type='number']":{appearance:"textfield"},"input[type='number']::-webkit-inner-spin-button, input[type='number']::-webkit-outer-spin-button":{WebkitAppearance:"inner-spin-button !important",opacity:1}}})),inputWrapper:(0,n.css)({label:"input-inputWrapper",position:"relative",flexGrow:1,zIndex:1,"&:not(:first-child):last-child":{"> input":{borderLeft:"none",borderTopLeftRadius:0,borderBottomLeftRadius:0}},"&:first-child:not(:last-child)":{"> input":{borderRight:"none",borderTopRightRadius:0,borderBottomRightRadius:0}},"&:not(:first-child):not(:last-child)":{"> input":{borderRight:"none",borderTopRightRadius:0,borderBottomRightRadius:0,borderTopLeftRadius:0,borderBottomLeftRadius:0}},input:{"&:not(:first-child)":{paddingLeft:m},"&:not(:last-child)":{paddingRight:m},"&[readonly]":{cursor:"default"}}}),input:(0,n.cx)((0,a.gm)(g),(0,a.Xb)(g,l),(0,n.css)({label:"input-input",position:"relative",zIndex:0,flexGrow:1,borderRadius:g.shape.radius.default,height:"100%",width:"100%"})),inputDisabled:(0,n.css)({backgroundColor:g.colors.action.disabledBackground,color:g.colors.action.disabledText,border:`1px solid ${g.colors.action.disabledBackground}`,"&:focus":{boxShadow:"none"}}),addon:(0,n.css)({label:"input-addon",display:"flex",justifyContent:"center",alignItems:"center",flexGrow:0,flexShrink:0,position:"relative","&:first-child":{borderTopRightRadius:0,borderBottomRightRadius:0,"> :last-child":{borderTopRightRadius:0,borderBottomRightRadius:0}},"&:last-child":{borderTopLeftRadius:0,borderBottomLeftRadius:0,"> :first-child":{borderTopLeftRadius:0,borderBottomLeftRadius:0}},"> *:focus":{zIndex:2}}),prefix:(0,n.cx)(y,(0,n.css)({label:"input-prefix",paddingLeft:g.spacing(1),paddingRight:g.spacing(.5),borderRight:"none",borderTopRightRadius:0,borderBottomRightRadius:0})),suffix:(0,n.cx)(y,(0,n.css)({label:"input-suffix",paddingLeft:g.spacing(1),paddingRight:g.spacing(1),marginBottom:"-2px",borderLeft:"none",borderTopLeftRadius:0,borderBottomLeftRadius:0,right:0})),loadingIndicator:(0,n.css)({"& + *":{marginLeft:g.spacing(.5)}})}})},48840:(G,O,e)=>{"use strict";e.d(O,{j:()=>u});var t=e(74848),n=e(32196),i=e(2543),s=e(96540),r=e(32885),f=e(39070),a=e(40845),c=e(14578),o=e(19384),h=e(56034),g=e(29158);const l=(0,n.css)({display:"flex",alignItems:"center",height:"100%"});function p({row:E,__rowID:C}){return(0,t.jsx)("div",{className:l,children:(0,t.jsx)(g.K,{tooltip:"toggle row expanded","aria-controls":C,name:E.isExpanded?"angle-down":"angle-right","aria-expanded":E.isExpanded,...E.getToggleRowExpandedProps(),size:"lg"})})}function m({isAllRowsExpanded:E,toggleAllRowsExpanded:C}){return(0,t.jsx)("div",{className:l,children:(0,t.jsx)(g.K,{"aria-label":E?"Collapse all rows":"Expand all rows",name:E?"table-collapse-all":"table-expand-all",onClick:()=>C(),size:"lg",tooltip:E?"Collapse all rows":"Expand all rows",variant:"secondary"})})}const y="__expander";function d(E,C=!1){return[{id:y,Cell:p,...C&&{Header:m},disableSortBy:!0,width:0},...E.map(M=>({id:M.id,accessor:M.id,Header:M.header||(()=>null),sortType:M.sortType||"alphanumeric",disableSortBy:!M.sortType,width:M.disableGrow?0:void 0,visible:M.visible,...M.cell&&{Cell:M.cell}}))]}const v=E=>{const C=E.colors.emphasize(E.colors.background.primary,.03);return{container:(0,n.css)({display:"flex",gap:E.spacing(2),flexDirection:"column",width:"100%",overflowX:"auto"}),cell:(0,n.css)({padding:E.spacing(1),minWidth:E.spacing(3)}),table:(0,n.css)({borderRadius:E.shape.radius.default,width:"100%"}),disableGrow:(0,n.css)({width:0}),header:(0,n.css)({borderBottom:`1px solid ${E.colors.border.weak}`,minWidth:E.spacing(3),"&, & > button":{position:"relative",whiteSpace:"nowrap",padding:E.spacing(1)},"& > button":{"&:after":{content:'"\\00a0"'},width:"100%",height:"100%",background:"none",border:"none",paddingRight:E.spacing(2.5),textAlign:"left",fontWeight:E.typography.fontWeightMedium}}),row:(0,n.css)({label:"row",borderBottom:`1px solid ${E.colors.border.weak}`,"&:hover":{backgroundColor:C},"&:last-child":{borderBottom:0}}),expandedRow:(0,n.css)({label:"expanded-row-content",borderBottom:"none"}),expandedContentCell:(0,n.css)({borderBottom:`1px solid ${E.colors.border.weak}`,position:"relative",padding:E.spacing(2,2,2,5),"&:before":{content:'""',position:"absolute",width:"1px",top:0,left:"16px",bottom:E.spacing(2),background:E.colors.border.medium}}),expandedContentRow:(0,n.css)({label:"expanded-row-content"}),sortableHeader:(0,n.css)({"&&":{padding:0}})}};function u({className:E,columns:C,data:M,getRowId:S,headerTooltips:I,pageSize:T=0,renderExpandedRow:b,showExpandAll:R=!1,fetchData:A,initialSortBy:L=[]}){const U=(0,a.of)(v),W=(0,s.useMemo)(()=>d(C,R),[C,R]),w=D(),N=(0,s.useCallback)(j=>`${w}-${j.id}`.replace(/\s/g,""),[w]),B=[r.useSortBy,r.useExpanded],V=M.length>T,K=T>0;K&&B.push(r.usePagination);const H=(0,r.useTable)({columns:W,data:M,autoResetExpanded:!1,autoResetSortBy:!1,disableMultiSort:!0,manualSortBy:!!A,getRowId:S,initialState:{hiddenColumns:[!b&&y,...W.filter(j=>!(!j.visible||j.visible(M))).map(j=>j.id).filter(f.zz)].filter(f.zz),sortBy:L}},...B),{getTableProps:X,getTableBodyProps:k,headerGroups:Y,prepareRow:Z}=H,{sortBy:se}=H.state;return(0,s.useEffect)(()=>{A&&A({sortBy:se})},[se,A]),(0,s.useEffect)(()=>{K&&H.setPageSize(T)},[K,T,H.setPageSize,H]),(0,t.jsxs)("div",{className:U.container,children:[(0,t.jsxs)("table",{...X(),className:(0,n.cx)(U.table,E),children:[(0,t.jsx)("thead",{children:Y.map(j=>{const{key:q,...ne}=j.getHeaderGroupProps();return(0,t.jsx)("tr",{...ne,children:j.headers.map(oe=>{const{key:z,...te}=oe.getHeaderProps(),le=I?.[oe.id];return(0,t.jsx)("th",{className:(0,n.cx)(U.header,{[U.disableGrow]:oe.width===0,[U.sortableHeader]:oe.canSort}),...te,...oe.isSorted&&{"aria-sort":oe.isSortedDesc?"descending":"ascending"},children:(0,t.jsx)(x,{column:oe,headerTooltip:le})},z)})},q)})}),(0,t.jsx)("tbody",{...k(),children:(K?H.page:H.rows).map(j=>{Z(j);const{key:q,...ne}=j.getRowProps(),oe=N(j),z=j.isExpanded;return(0,t.jsxs)(s.Fragment,{children:[(0,t.jsx)("tr",{...ne,className:(0,n.cx)(U.row,z&&U.expandedRow),children:j.cells.map(te=>{const{key:le,...ie}=te.getCellProps();return(0,t.jsx)("td",{className:U.cell,...ie,children:te.render("Cell",{__rowID:oe})},le)})}),z&&b&&(0,t.jsx)("tr",{...ne,id:oe,className:U.expandedContentRow,children:(0,t.jsx)("td",{className:U.expandedContentCell,colSpan:j.cells.length,children:b(j.original)})})]},q)})})]}),K&&V&&(0,t.jsx)("span",{children:(0,t.jsx)(o.d,{currentPage:H.state.pageIndex+1,numberOfPages:H.pageOptions.length,onNavigate:j=>H.gotoPage(j-1)})})]})}const D=()=>(0,s.useMemo)(()=>(0,i.uniqueId)("InteractiveTable"),[]),P=E=>({sortIcon:(0,n.css)({position:"absolute",top:E.spacing(1)}),headerTooltipIcon:(0,n.css)({marginLeft:E.spacing(.5)})});function x({column:{canSort:E,render:C,isSorted:M,isSortedDesc:S,getSortByToggleProps:I},headerTooltip:T}){const b=(0,a.of)(P),{onClick:R}=I(),A=(0,t.jsxs)(t.Fragment,{children:[C("Header"),T&&(0,t.jsx)(h.m,{theme:"info-alt",content:T.content,placement:"top-end",children:(0,t.jsx)(c.I,{className:b.headerTooltipIcon,name:T.iconName||"info-circle","data-testid":"header-tooltip-icon"})}),M&&(0,t.jsx)("span",{"aria-hidden":"true",className:b.sortIcon,children:(0,t.jsx)(c.I,{name:S?"angle-down":"angle-up"})})]});return E?(0,t.jsx)("button",{type:"button",onClick:R,children:A}):A}},24022:(G,O,e)=>{"use strict";e.d(O,{B:()=>s});var t=e(74848),n=e(96540),i=e(44533);class s extends n.PureComponent{constructor(){super(...arguments),this.wrapperRef=(0,n.createRef)(),this.renderJson=()=>{const{json:f,config:a,open:c,onDidRender:o}=this.props,h=this.wrapperRef.current,g=new i.O(f,c,a);h.hasChildNodes()?h.replaceChild(g.render(),h.lastChild):h.appendChild(g.render()),o&&o(g.json)}}static{this.defaultProps={open:3,config:{animateOpen:!0}}}componentDidMount(){this.renderJson()}componentDidUpdate(){this.renderJson()}render(){const{className:f}=this.props;return(0,t.jsx)("div",{className:f,ref:this.wrapperRef})}}},44533:(G,O,e)=>{"use strict";e.d(O,{O:()=>v});var t=e(2543);function n(u){return u.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function i(u){return!!u&&typeof u==="object"}function s(u){if(u===void 0)return"";if(u===null||typeof u=="object"&&!u.constructor)return"Object";const P=/function ([^(]*)/.exec(u.constructor.toString());return P&&P.length>1?P[1]:""}function r(u){return u===null?"null":typeof u}function f(u,D){const P=r(u);return P==="null"||P==="undefined"?P:(P==="string"&&(D='"'+n(D)+'"'),P==="function"?u.toString().replace(/[\r\n]/g,"").replace(/\{.*\}/,"")+"{\u2026}":D)}let a="";function c(u){return i(u)?(a=s(u),Array.isArray(u)&&(a+="["+u.length+"]")):a=f(u,u.toString()),a}function o(u){return`json-formatter-${u}`}function h(u,D,P){const x=document.createElement(u);return D&&x.classList.add(o(D)),P!==void 0&&(P instanceof Node?x.appendChild(P):x.appendChild(document.createTextNode(String(P)))),x}const g=/(^\d{1,4}[\.|\\/|-]\d{1,2}[\.|\\/|-]\d{1,4})(\s*(?:0?[1-9]:[0-5]|1(?=[012])\d:[0-5])\d\s*[ap]m)?$/,l=/\d{2}:\d{2}:\d{2} GMT-\d{4}/,p=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z/,m=10,y=typeof window<"u"&&window.requestAnimationFrame||(u=>(u(),0)),d={animateOpen:!0,animateClose:!0};class v{constructor(D,P=1,x=d,E){this.json=D,this.open=P,this.config=x,this.key=E,this._isOpen=null,this.element=null,this.skipChildren=!1}get isOpen(){return this._isOpen!==null?this._isOpen:this.open>0}set isOpen(D){this._isOpen=D}get isDate(){return this.type==="string"&&(g.test(this.json)||p.test(this.json)||l.test(this.json))}get isUrl(){return this.type==="string"&&this.json.indexOf("http")===0}get isArray(){return Array.isArray(this.json)}get isObject(){return i(this.json)}get isEmptyObject(){return!this.keys.length&&!this.isArray}get isEmpty(){return this.isEmptyObject||this.keys&&!this.keys.length&&this.isArray}get hasKey(){return typeof this.key<"u"}get constructorName(){return s(this.json)}get type(){return r(this.json)}get keys(){return this.isObject?Object.keys(this.json).map(D=>D||'""'):[]}toggleOpen(){this.isOpen=!this.isOpen,this.element&&(this.isOpen?this.appendChildren(this.config.animateOpen):this.removeChildren(this.config.animateClose),this.element.classList.toggle(o("open")))}openAtDepth(D=1){D<0||(this.open=D,this.isOpen=D!==0,this.element&&(this.removeChildren(!1),D===0?this.element.classList.remove(o("open")):(this.appendChildren(this.config.animateOpen),this.element.classList.add(o("open")))))}isNumberArray(){return this.json.length>0&&this.json.length<4&&((0,t.isNumber)(this.json[0])||(0,t.isNumber)(this.json[1]))}renderArray(){const D=h("span");return D.appendChild(h("span","bracket","[")),this.isNumberArray()?(this.json.forEach((P,x)=>{x>0&&D.appendChild(h("span","array-comma",",")),D.appendChild(h("span","number",P))}),this.skipChildren=!0):D.appendChild(h("span","number",this.json.length)),D.appendChild(h("span","bracket","]")),D}render(D=!1){this.element=h("div","row");const P=h("a","toggler-link"),x=h("span","toggler");if(this.isObject&&P.appendChild(x),this.hasKey&&P.appendChild(h("span","key",`${this.key}:`)),this.isObject){const C=h("span","value"),M=h("span"),S=h("span","constructor-name",this.constructorName);if(M.appendChild(S),this.isArray){const I=this.renderArray();M.appendChild(I)}C.appendChild(M),P.appendChild(C)}else{const C=this.isUrl?h("a"):h("span");C.classList.add(o(this.type)),this.isDate&&C.classList.add(o("date")),this.isUrl&&(C.classList.add(o("url")),C.setAttribute("href",this.json));const M=f(this.json,this.json);C.appendChild(document.createTextNode(M)),P.appendChild(C)}const E=h("div","children");return this.isObject&&E.classList.add(o("object")),this.isArray&&E.classList.add(o("array")),this.isEmpty&&E.classList.add(o("empty")),this.config&&this.config.theme&&this.element.classList.add(o(this.config.theme)),this.isOpen&&this.element.classList.add(o("open")),D||this.element.appendChild(P),this.skipChildren?P.removeChild(x):this.element.appendChild(E),this.isObject&&this.isOpen&&this.appendChildren(),this.isObject&&P.addEventListener("click",this.toggleOpen.bind(this)),this.element}appendChildren(D=!1){const P=this.element&&this.element.querySelector(`div.${o("children")}`);if(!(!P||this.isEmpty))if(D){let x=0;const E=()=>{const C=this.keys[x],M=new v(this.json[C],this.open-1,this.config,C);P.appendChild(M.render()),x+=1,x<this.keys.length&&(x>m?E():y(E))};y(E)}else this.keys.forEach(x=>{const E=new v(this.json[x],this.open-1,this.config,x);P.appendChild(E.render())})}removeChildren(D=!1){const P=this.element&&this.element.querySelector(`div.${o("children")}`);if(D){let x=0;const E=()=>{P&&P.children.length&&(P.removeChild(P.children[0]),x+=1,x>m?E():y(E))};y(E)}else P&&(P.innerHTML="")}}},90613:(G,O,e)=>{"use strict";e.d(O,{a:()=>a});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(16795),f=e(55738);const a=(0,i.forwardRef)((g,l)=>{const{children:p,margin:m,marginX:y,marginY:d,marginTop:v,marginBottom:u,marginLeft:D,marginRight:P,padding:x,paddingX:E,paddingY:C,paddingTop:M,paddingBottom:S,paddingLeft:I,paddingRight:T,display:b,backgroundColor:R,grow:A,shrink:L,basis:U,flex:W,borderColor:w,borderStyle:N,borderRadius:B,direction:V,justifyContent:K,alignItems:H,boxShadow:X,element:k,gap:Y,width:Z,minWidth:se,maxWidth:j,height:q,minHeight:ne,maxHeight:oe,...z}=g,te=(0,s.of)(h,m,y,d,v,u,D,P,x,E,C,M,S,I,T,b,R,A,L,U,W,w,N,B,V,K,H,X,Y),le=(0,s.of)(f.E,Z,se,j,q,ne,oe),ie=k??"div";return(0,t.jsx)(ie,{ref:l,className:(0,n.cx)(te.root,le),...z,children:p})});a.displayName="Box";const c=(g,l)=>{switch(g){case"error":case"success":case"info":case"warning":return l.colors[g].borderTransparent;default:return g?l.colors.border[g]:void 0}},o=(g,l)=>{switch(g){case"error":case"success":case"info":case"warning":return l.colors[g].transparent;default:return g?l.colors.background[g]:void 0}},h=(g,l,p,m,y,d,v,u,D,P,x,E,C,M,S,I,T,b,R,A,L,U,W,w,N,B,V,K,H)=>({root:(0,n.css)([(0,r.Y)(g,l,X=>({margin:g.spacing(X)})),(0,r.Y)(g,p,X=>({marginLeft:g.spacing(X),marginRight:g.spacing(X)})),(0,r.Y)(g,m,X=>({marginTop:g.spacing(X),marginBottom:g.spacing(X)})),(0,r.Y)(g,y,X=>({marginTop:g.spacing(X)})),(0,r.Y)(g,d,X=>({marginBottom:g.spacing(X)})),(0,r.Y)(g,v,X=>({marginLeft:g.spacing(X)})),(0,r.Y)(g,u,X=>({marginRight:g.spacing(X)})),(0,r.Y)(g,D,X=>({padding:g.spacing(X)})),(0,r.Y)(g,P,X=>({paddingLeft:g.spacing(X),paddingRight:g.spacing(X)})),(0,r.Y)(g,x,X=>({paddingTop:g.spacing(X),paddingBottom:g.spacing(X)})),(0,r.Y)(g,E,X=>({paddingTop:g.spacing(X)})),(0,r.Y)(g,C,X=>({paddingBottom:g.spacing(X)})),(0,r.Y)(g,M,X=>({paddingLeft:g.spacing(X)})),(0,r.Y)(g,S,X=>({paddingRight:g.spacing(X)})),(0,r.Y)(g,I,X=>({display:X})),(0,r.Y)(g,T,X=>({backgroundColor:o(X,g)})),(0,r.Y)(g,N,X=>({flexDirection:X})),(0,r.Y)(g,b,X=>({flexGrow:X})),(0,r.Y)(g,R,X=>({flexShrink:X})),(0,r.Y)(g,A,X=>({flexBasis:X})),(0,r.Y)(g,L,X=>({flex:X})),(0,r.Y)(g,W,X=>({borderStyle:X})),(0,r.Y)(g,U,X=>({borderColor:c(X,g)})),(W||U)&&{borderWidth:"1px"},(0,r.Y)(g,B,X=>({justifyContent:X})),(0,r.Y)(g,V,X=>({alignItems:X})),(0,r.Y)(g,w,X=>({borderRadius:g.shape.radius[X]})),(0,r.Y)(g,K,X=>({boxShadow:g.shadows[X]})),(0,r.Y)(g,H,X=>({gap:g.spacing(X)}))])})},71259:(G,O,e)=>{"use strict";e.d(O,{x:()=>f});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(16795);const f=(0,i.forwardRef)((c,o)=>{const{alignItems:h,children:g,gap:l,columns:p,minColumnWidth:m,...y}=c,d=(0,s.of)(a,l,p,m,h);return(0,t.jsx)("div",{ref:o,...y,className:d.grid,children:g})});f.displayName="Grid";const a=(c,o,h,g,l)=>({grid:(0,n.css)([{display:"grid"},(0,r.Y)(c,o,p=>({gap:c.spacing(p)})),g&&(0,r.Y)(c,g,p=>({gridTemplateColumns:`repeat(auto-fill, minmax(${c.spacing(p)}, 1fr))`})),h&&(0,r.Y)(c,h,p=>({gridTemplateColumns:`repeat(${p}, 1fr)`})),(0,r.Y)(c,l,p=>({alignItems:p}))])})},66864:(G,O,e)=>{"use strict";e.d(O,{Gy:()=>a,PE:()=>f,gW:()=>c,mc:()=>o});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=(p=>(p[p.Horizontal=0]="Horizontal",p[p.Vertical=1]="Vertical",p))(r||{});const f=({children:p,orientation:m=0,spacing:y="sm",justify:d="flex-start",align:v="normal",wrap:u=!1,width:D="100%",height:P="100%",...x})=>{const E=(0,s.of)(h,m,y,d,v,u);return(0,t.jsx)("div",{className:E.layout,style:{width:D,height:P},...x,children:i.Children.toArray(p).filter(Boolean).map((C,M)=>(0,t.jsx)("div",{className:E.childWrapper,children:C},M))})},a=({children:p,spacing:m,justify:y,align:d="center",wrap:v,width:u,height:D})=>(0,t.jsx)(f,{spacing:m,justify:y,orientation:0,align:d,width:u,height:D,wrap:v,children:p}),c=({children:p,spacing:m,justify:y,align:d,width:v,height:u})=>(0,t.jsx)(f,{spacing:m,justify:y,orientation:1,align:d,width:v,height:u,children:p}),o=({children:p,padding:m,margin:y,grow:d,shrink:v})=>{const u=(0,s.of)(l,m,y);return(0,t.jsx)("div",{className:(0,n.cx)(u.wrapper,d!==void 0&&(0,n.css)({flexGrow:d}),v!==void 0&&(0,n.css)({flexShrink:v})),children:p})},h=(p,m,y,d,v,u)=>{const D=y!=="none"?p.spacing(g[y]):0,P=m===0&&!u||m===1?0:`-${D}`,x=m===1?"vertical-group":"horizontal-group";return{layout:(0,n.css)({label:x,display:"flex",flexDirection:m===1?"column":"row",flexWrap:u?"wrap":"nowrap",justifyContent:d,alignItems:v,height:"100%",maxWidth:"100%",marginBottom:P}),childWrapper:(0,n.css)({label:"layoutChildrenWrapper",marginBottom:m===0&&!u?0:D,marginRight:m===0?D:0,display:"flex",alignItems:v,"&:last-child":{marginBottom:m===1?0:void 0,marginRight:m===0?0:void 0}})}},g={none:0,xs:.5,sm:1,md:2,lg:3},l=(p,m,y)=>{const d=m&&m!=="none"&&p.spacing(g[m])||0,v=y&&y!=="none"&&p.spacing(g[y])||0;return{wrapper:(0,n.css)({label:"container",margin:v,padding:d})}}},68402:(G,O,e)=>{"use strict";e.d(O,{$:()=>i});var t=e(74848),n=e(90613);const i=({v:s=0,h:r=0,layout:f})=>(0,t.jsx)(n.a,{paddingRight:r,paddingBottom:s,display:f==="inline"?"inline-block":"block"})},67061:(G,O,e)=>{"use strict";e.d(O,{B:()=>a});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(16795),f=e(55738);const a=i.forwardRef((o,h)=>{const{gap:g=1,alignItems:l,justifyContent:p,direction:m,wrap:y,children:d,grow:v,shrink:u,basis:D,flex:P,width:x,minWidth:E,maxWidth:C,height:M,minHeight:S,maxHeight:I,...T}=o,b=(0,s.of)(c,g,l,p,m,y,v,u,D,P),R=(0,s.of)(f.E,x,E,C,M,S,I);return(0,t.jsx)("div",{ref:h,className:(0,n.cx)(b.flex,R),...T,children:d})});a.displayName="Stack";const c=(o,h,g,l,p,m,y,d,v,u)=>({flex:(0,n.css)([{display:"flex"},(0,r.Y)(o,p,D=>({flexDirection:D})),(0,r.Y)(o,m,D=>({flexWrap:typeof D=="boolean"?D?"wrap":"nowrap":D})),(0,r.Y)(o,g,D=>({alignItems:D})),(0,r.Y)(o,l,D=>({justifyContent:D})),(0,r.Y)(o,h,D=>({gap:o.spacing(D)})),(0,r.Y)(o,y,D=>({flexGrow:D})),(0,r.Y)(o,d,D=>({flexShrink:D})),(0,r.Y)(o,v,D=>({flexBasis:D})),(0,r.Y)(o,u,D=>({flex:D}))])})},16795:(G,O,e)=>{"use strict";e.d(O,{Y:()=>n});function t(i,s,r,f){const a=s[f];if(a!=null)return{[i.breakpoints.up(f)]:r(a)}}function n(i,s,r){return s==null?null:typeof s!="object"||!("xs"in s)?r(s):[t(i,s,r,"xs"),t(i,s,r,"sm"),t(i,s,r,"md"),t(i,s,r,"lg"),t(i,s,r,"xl"),t(i,s,r,"xxl")]}},55738:(G,O,e)=>{"use strict";e.d(O,{E:()=>i});var t=e(32196),n=e(16795);const i=(s,r,f,a,c,o,h)=>(0,t.css)([(0,n.Y)(s,r,g=>({width:s.spacing(g)})),(0,n.Y)(s,f,g=>({minWidth:s.spacing(g)})),(0,n.Y)(s,a,g=>({maxWidth:s.spacing(g)})),(0,n.Y)(s,c,g=>({height:s.spacing(g)})),(0,n.Y)(s,o,g=>({minHeight:s.spacing(g)})),(0,n.Y)(s,h,g=>({maxHeight:s.spacing(g)}))])},50720:(G,O,e)=>{"use strict";e.d(O,{N:()=>f});var t=e(74848),n=e(96540),i=e(54625),s=e(71733),r=e(80997);const f=(0,n.forwardRef)(({href:a,children:c,...o},h)=>{const g=s.I.stripBaseFromUrl(r.sQ.sanitizeUrl(a??""));return(0,t.jsx)(i.Link,{ref:h,to:g,...o,children:c})});f.displayName="Link"},72109:(G,O,e)=>{"use strict";e.d(O,{Y:()=>g});var t=e(74848),n=e(32196),i=e(96540),s=e(80997),r=e(71733),f=e(40845),a=e(14578),c=e(71356),o=e(50720);const h={h1:"xl",h2:"xl",h3:"lg",h4:"lg",h5:"md",h6:"md",body:"md",bodySmall:"xs"},g=(0,i.forwardRef)(({href:p,color:m="link",external:y=!1,inline:d=!0,variant:v="body",weight:u,icon:D,children:P,...x},E)=>{const C=s.sQ.sanitizeUrl(p??""),M=(0,f.$j)(),S=l(M,d,v,u,m),I=D||"external-link-alt";if(y)return(0,t.jsxs)("a",{href:C,ref:E,...x,target:"_blank",rel:"noreferrer",className:S,children:[P,(0,t.jsx)(a.I,{size:h[v]||"md",name:I})]});const T=r.I.stripBaseFromUrl(C);return(0,t.jsxs)(o.N,{ref:E,href:T,...x,className:S,children:[P,D&&(0,t.jsx)(a.I,{name:D,size:h[v]||"md"})]})});g.displayName="TextLink";const l=(p,m,y,d,v)=>(0,n.css)([y&&{...p.typography[y]},d&&{fontWeight:(0,c.iV)(d,p)},v&&{color:p.colors.text[v]},{alignItems:"center",gap:"0.25em",display:"inline-flex",textDecoration:"none","&:hover":{textDecoration:"underline",color:p.colors.text.link}},m&&{textDecoration:"underline","&:hover":{textDecoration:"none"}}])},85918:(G,O,e)=>{"use strict";e.d(O,{p:()=>f});var t=e(74848),n=e(32196),i=e(96540),s=e(3911);const r=(0,s.N)((a=!1)=>({list:(0,n.css)({listStyleType:"none",margin:0,padding:0}),item:(0,n.css)({display:a&&"inline-block"||"block"})}));class f extends i.PureComponent{constructor(c){super(c)}render(){const{items:c,renderItem:o,getItemKey:h,className:g,inline:l}=this.props,p=r(l);return(0,t.jsx)("ul",{className:(0,n.cx)(p.list,g),children:c.map((m,y)=>(0,t.jsx)("li",{className:p.item,children:o(m,y)},h?h(m):y))})}}},1551:(G,O,e)=>{"use strict";e.d(O,{c:()=>s});var t=e(74848),n=e(96540),i=e(85918);class s extends n.PureComponent{render(){return(0,t.jsx)(i.p,{inline:!0,...this.props})}}},33552:(G,O,e)=>{"use strict";e.d(O,{B:()=>s});var t=e(74848),n=e(96540),i=e(85918);class s extends n.PureComponent{render(){return(0,t.jsx)(i.p,{...this.props})}}},57514:(G,O,e)=>{"use strict";e.d(O,{G:()=>h});var t=e(74848),n=e(32196),i=e(40845);const s=28,r=2.4,f=500,a=4e3,c=300,o=100/s*100;function h({width:l,delay:p=c,ariaLabel:m="Loading bar"}){const y=Math.min(Math.max(Math.round(l*r),f),a),d=(0,i.of)(g,p,y),v={overflow:"hidden"};return(0,t.jsx)("div",{style:v,children:(0,t.jsx)("div",{"aria-label":m,className:d.bar})})}const g=(l,p,m)=>{const y=(0,n.keyframes)({"0%":{transform:"translateX(-100%)"},"85%, 100%":{transform:`translateX(${o}%)`}});return{bar:(0,n.css)({width:s+"%",height:1,background:"linear-gradient(90deg, rgba(110, 159, 255, 0) 0%, #6E9FFF 80.75%, rgba(110, 159, 255, 0) 100%)",transform:"translateX(-100%)",willChange:"transform",[l.transitions.handleMotion("no-preference")]:{animationName:y,animationDelay:`${p}ms`,animationTimingFunction:"linear",animationIterationCount:"infinite",animationDuration:`${m}ms`},[l.transitions.handleMotion("reduce")]:{animationName:y,animationDelay:`${p}ms`,animationTimingFunction:"linear",animationIterationCount:"infinite",animationDuration:`${4*m}ms`}})}}},39558:(G,O,e)=>{"use strict";e.d(O,{_:()=>r});var t=e(74848),n=e(32196),i=e(40845),s=e(62930);const r=({text:a,className:c,...o})=>{const h=(0,i.of)(f);return(0,t.jsxs)("div",{className:(0,n.cx)(h.container,c),...o,children:[a," ",(0,t.jsx)(s.y,{inline:!0})]})},f=a=>({container:(0,n.css)({marginBottom:a.spacing(4)})})},76218:(G,O,e)=>{"use strict";e.d(O,{O:()=>r});var t=e(74848),n=e(96540),i=e(90182),s=e(64278);const r=({value:f,onChange:a,context:c,item:o})=>{const h=o.settings??{},g=(0,s.sE)(c.data,h?.filter),l=(0,s.m3)(g,f,void 0,void 0,h.baseNameMode),p=(0,n.useCallback)(y=>{if(!(y&&!(0,s.v3)(y.value,g)))return a(y?.value)},[g,a]),m=l.find(y=>y.value===f);return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(i.l6,{value:m,placeholder:h.placeholderText??"Select field",options:l,onChange:p,noOptionsMessage:h.noFieldsMessage,width:h.width,isClearable:h.isClearable!==!1})})}},9988:(G,O,e)=>{"use strict";e.d(O,{bx:()=>o,cH:()=>l});var t=e(74848),n=e(96540),i=e(11261),s=e(1173),r=e(85200),f=e(4025),a=e(90182);const c=(0,n.memo)(p=>{const{data:m,options:y,onChange:d,id:v}=p,u=h(m),D=g(u,y),P=(0,n.useCallback)(E=>d(E.value),[d]),x=D.find(E=>E.value===y);return(0,t.jsx)(a.l6,{inputId:v,value:x,options:D,onChange:P})});c.displayName="FieldTypeMatcherEditor";const o=[{value:i.PU.number,label:"Number",icon:(0,f.lV)(i.PU.number)},{value:i.PU.string,label:"String",icon:(0,f.lV)(i.PU.string)},{value:i.PU.time,label:"Time",icon:(0,f.lV)(i.PU.time)},{value:i.PU.boolean,label:"Boolean",icon:(0,f.lV)(i.PU.boolean)},{value:i.PU.trace,label:"Traces",icon:(0,f.lV)(i.PU.trace)},{value:i.PU.enum,label:"Enum",icon:(0,f.lV)(i.PU.enum)},{value:i.PU.other,label:"Other",icon:(0,f.lV)(i.PU.other)}],h=p=>(0,n.useMemo)(()=>{const m=new Map;for(const y of o)m.set(y.value,0);for(const y of p)for(const d of y.fields){const v=d.type||i.PU.other;let u=m.get(v);u||(u=0),m.set(v,u+1)}return m},[p]),g=(p,m)=>(0,n.useMemo)(()=>{let y=!1;const d=[];for(const v of o){const u=p.get(v.value),D=m===v.value;(u||D)&&d.push({...v,label:`${v.label} (${p.get(v.value)})`}),D&&(y=!0)}return m&&!y&&d.push({value:m,label:`${m} (No matches)`}),d},[p,m]),l={id:s.Ct.byType,component:c,matcher:r.sJ.get(s.Ct.byType),name:"Fields with type",description:"Set properties for fields of a specific type (number, string, boolean)",optionsToLabel:p=>p}},19346:(G,O,e)=>{"use strict";e.d(O,{N:()=>g,r1:()=>y});var t=e(74848),n=e(32196),i=e(96540),s=e(75059),r=e(1173),f=e(85200),a=e(52622),c=e(40845),o=e(10354),h=e(90182);const g=[{label:"==",value:a.zT.EQ},{label:"!=",value:a.zT.NEQ},{label:">",value:a.zT.GT},{label:">=",value:a.zT.GTE},{label:"<",value:a.zT.LT},{label:"<=",value:a.zT.LTE}];function l(d){return d===s.gy.allIsNull||d===s.gy.allIsZero}const p=({options:d,onChange:v})=>{const u=(0,c.of)(m),D=(0,i.useMemo)(()=>s.AS.selectOptions([d?.reducer]),[d?.reducer]),P=(0,i.useCallback)(S=>v({...d,reducer:S.value}),[d,v]),x=(0,i.useCallback)(S=>v({...d,op:S.value}),[d,v]),E=(0,i.useCallback)(S=>{const I=S.currentTarget.valueAsNumber;return v({...d,value:I})},[d,v]),C=d??{},M=l(d.reducer);return(0,t.jsxs)("div",{className:u.spot,children:[(0,t.jsx)(h.l6,{value:D.current,options:D.options,onChange:P,placeholder:"Select field reducer"}),C.reducer&&!M&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.l6,{value:g.find(S=>S.value===C.op),options:g,onChange:x,"aria-label":"Comparison operator",width:19}),(0,t.jsx)(o.p,{type:"number",value:C.value,onChange:E})]})]})},m=d=>({spot:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center",alignContent:"flex-end",gap:"4px"})}),y={id:r.Ct.byValue,component:p,matcher:f.sJ.get(r.Ct.byValue),name:"Fields with values",description:"Set properties for fields with reducer condition",optionsToLabel:d=>`${d?.reducer} ${d?.op} ${d?.value}`}},74668:(G,O,e)=>{"use strict";e.d(O,{R:()=>g,X:()=>c});var t=e(74848),n=e(96540),i=e(28240),s=e(1173),r=e(85200),f=e(90182);const a=(l,p,m)=>{if(!m)return;let y=l.find(d=>!p.some(v=>d===v));if(y)return y};function c({value:l,data:p,onChange:m,placeholder:y}){const d=(0,n.useMemo)(()=>o(p),[p]),[v,u]=(0,n.useState)({refIds:[],value:void 0}),D=(0,n.useMemo)(()=>d.find(x=>x.value===l)??a(d,v.refIds,v.value),[l,d,v]),P=(0,n.useCallback)(x=>{m(x?.value)},[m]);return(d!==v.refIds||D?.value!==v.value)&&u({refIds:d,value:D?.value}),(0,t.jsx)(f.l6,{options:d,onChange:P,isClearable:!0,placeholder:y??"Select query refId",value:D})}function o(l){const p=new Map;for(const y of l){const d=y.refId??"",v=p.get(d)??[];v.length===0&&p.set(d,v),v.push(y)}const m=[];for(const[y,d]of p.entries())m.push({value:y,label:`Query: ${y??"(missing refId)"}`,description:h(d)});return m}function h(l){return`Frames (${l.length}):
    ${l.slice(0,Math.min(3,l.length)).map(p=>(0,i.Ri)(p)).join(", ")} ${l.length>3?"...":""}`}const g={id:s.Ct.byFrameRefID,component:l=>(0,t.jsx)(c,{value:l.options,data:l.data,onChange:l.onChange}),matcher:r.sJ.get(s.Ct.byFrameRefID),name:"Fields returned by query",description:"Set properties for fields from a specific query",optionsToLabel:l=>l}},84349:(G,O,e)=>{"use strict";e.d(O,{g:()=>u});var t=e(83077),n=e(74848),i=e(96540),s=e(1173),r=e(85200),f=e(10354);const a=(0,i.memo)(D=>{const{options:P,onChange:x}=D,E=(0,i.useCallback)(C=>x(C.target.value),[x]);return(0,n.jsx)(f.p,{placeholder:"Enter regular expression",defaultValue:P,onBlur:E})});a.displayName="FieldNameByRegexMatcherEditor";const c={id:s.Ct.byRegexp,component:a,matcher:r.sJ.get(s.Ct.byRegexp),name:"Fields with name matching regex",description:"Set properties for fields with names matching a regex",optionsToLabel:D=>D};var o=e(90182),h=e(64278);const g=(0,i.memo)(D=>{const{data:P,options:x,onChange:E,id:C}=D,M=(0,h.sE)(P),S=(0,h.m3)(M,x),I=(0,i.useCallback)(b=>{if((0,h.v3)(b.value,M))return E(b.value)},[M,E]),T=S.find(b=>b.value===x);return(0,n.jsx)(o.l6,{value:T,options:S,onChange:I,inputId:C})});g.displayName="FieldNameMatcherEditor";const l={id:s.Ct.byName,component:g,matcher:r.sJ.get(s.Ct.byName),name:"Fields with name",description:"Set properties for a specific field",optionsToLabel:D=>D},p=(0,i.memo)(D=>{const{data:P,options:x,onChange:E}=D,{readOnly:C,prefix:M}=x,S=(0,h.sE)(P),I=(0,h.m3)(S,void 0),T=(0,i.useCallback)(b=>{if(Array.isArray(b))return E({...x,names:b.reduce((R,A)=>((0,h.v3)(A.value,S)&&R.push(A.value),R),[])})},[S,E,x]);if(C){const b=(x.names??[]).join(", ");return(0,n.jsx)(f.p,{value:b,readOnly:!0,disabled:!0,prefix:M})}return(0,n.jsx)(o.KF,{value:x.names,options:I,onChange:T})});p.displayName="FieldNameMatcherEditor";const m={id:s.Ct.byNames,component:p,matcher:r.sJ.get(s.Ct.byNames),name:"Fields with name",description:"Set properties for a specific field",optionsToLabel:D=>(D.names??[]).join(", "),excludeFromPicker:!0};var y=e(9988),d=e(19346),v=e(74668);const u=new t.O(()=>[l,c,y.cH,v.R,m,d.r1])},64278:(G,O,e)=>{"use strict";e.d(O,{BP:()=>f,m3:()=>c,sE:()=>a,v3:()=>r});var t=e(96540),n=e(28240),i=e(27310),s=e(4025);function r(o,h){return o?h.display.has(o)||h.raw.has(o):!1}function f(o,h){const g={display:new Set,raw:new Set,fields:new Map};for(const l of o)for(const p of l.fields){if(h&&!h(p))continue;const m=(0,n.Ct)(p,l,o);g.display.add(m),g.fields.set(m,p),p.name&&m!==p.name&&(g.raw.add(p.name),g.fields.set(p.name,p))}return g}function a(o,h){return(0,t.useMemo)(()=>f(o,h),[o,h])}function c(o,h,g,l,p){return(0,t.useMemo)(()=>{let m=!1;const y=[];if(g&&y.push(g),p===i.X4.OnlyBaseNames)for(const d of o.raw)!m&&d===h&&(m=!0),y.push({value:d,label:`${d} (base field name)`});else{for(const d of o.display){!m&&d===h&&(m=!0);const v=o.fields.get(d);(!l||l===v?.type)&&y.push({value:d,label:d,icon:v?(0,s.SS)(v):void 0})}if(p!==i.X4.ExcludeBaseNames)for(const d of o.raw)o.display.has(d)||(!m&&d===h&&(m=!0),y.push({value:d,label:`${d} (base field name)`}))}return h&&!m&&y.push({value:h,label:`${h} (not found)`}),y},[o,h,g,l,p])}},38138:(G,O,e)=>{"use strict";e.d(O,{W:()=>g});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(90613),f=e(27183),a=e(59093),c=e(64539),o=e(32653);const h=i.forwardRef(({header:p,children:m,ariaLabel:y,onOpen:d,onClose:v,onKeyDown:u,...D},P)=>{const x=(0,s.of)(l),E=(0,i.useRef)(null);(0,i.useImperativeHandle)(P,()=>E.current);const[C]=(0,o.t)({isMenuOpen:!0,localRef:E,onOpen:d,onClose:v,onKeyDown:u});return(0,t.jsxs)(r.a,{...D,"aria-label":y,backgroundColor:"primary",borderRadius:"default",boxShadow:"z3",display:"inline-block",onKeyDown:C,paddingX:0,paddingY:.5,ref:E,role:"menu",tabIndex:-1,children:[p&&(0,t.jsx)("div",{className:(0,n.cx)(x.header,!!m&&i.Children.toArray(m).length>0&&x.headerBorder),children:p}),m]})});h.displayName="Menu";const g=Object.assign(h,{Item:c.D,Divider:f.N,Group:a.r}),l=p=>({header:(0,n.css)({padding:p.spacing(.5,1,1,1)}),headerBorder:(0,n.css)({borderBottom:`1px solid ${p.colors.border.weak}`})})},27183:(G,O,e)=>{"use strict";e.d(O,{N:()=>s});var t=e(74848),n=e(32196),i=e(40845);function s(){const f=(0,i.of)(r);return(0,t.jsx)("div",{className:f.divider})}const r=f=>({divider:(0,n.css)({height:1,backgroundColor:f.colors.border.weak,margin:f.spacing(.5,0)})})},59093:(G,O,e)=>{"use strict";e.d(O,{r:()=>f});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(40845);const f=({label:c,ariaLabel:o,children:h})=>{const g=(0,r.of)(a),l=`group-label-${(0,i.uniqueId)()}`;return(0,t.jsxs)("div",{role:"group","aria-labelledby":!o&&c?l:void 0,"aria-label":o,children:[c&&(0,t.jsx)("label",{id:l,className:g.groupLabel,"aria-hidden":!0,children:c}),h]})};f.displayName="MenuGroup";const a=c=>({groupLabel:(0,n.css)({color:c.colors.text.secondary,fontSize:c.typography.size.sm,padding:c.spacing(.5,1)})})},64539:(G,O,e)=>{"use strict";e.d(O,{D:()=>p});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(16797),f=e(14578),a=e(67061),c=e(13544),o=e(32653);const h=y=>{if(!y)return!1;const d=y.parentElement.getBoundingClientRect(),v=y.getBoundingClientRect();return v.width!==0&&d.right+v.width+10>window.innerWidth},g=(0,i.memo)(({items:y,isOpen:d,close:v,customStyle:u})=>{const D=(0,s.of)(l),P=(0,i.useRef)(null),[x]=(0,o.t)({localRef:P,isMenuOpen:d,close:v}),[E,C]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{d&&P.current&&C(h(P.current))},[d]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:D.iconWrapper,"aria-hidden":!0,"data-testid":c.Tp.components.Menu.SubMenu.icon,children:(0,t.jsx)(f.I,{name:"angle-right",className:D.icon})}),d&&(0,t.jsx)("div",{ref:P,className:(0,n.cx)(D.subMenu,{[D.pushLeft]:E}),"data-testid":c.Tp.components.Menu.SubMenu.container,style:u,children:(0,t.jsx)("div",{tabIndex:-1,className:D.itemsWrapper,role:"menu",onKeyDown:x,children:y})})]})});g.displayName="SubMenu";const l=y=>({iconWrapper:(0,n.css)({display:"flex",flex:1,justifyContent:"end"}),icon:(0,n.css)({opacity:.7,marginLeft:y.spacing(1),color:y.colors.text.secondary}),itemsWrapper:(0,n.css)({background:y.colors.background.primary,boxShadow:y.shadows.z3,display:"inline-block",borderRadius:y.shape.radius.default}),pushLeft:(0,n.css)({right:"100%",left:"unset"}),subMenu:(0,n.css)({position:"absolute",top:0,left:"100%",zIndex:y.zIndex.dropdown})}),p=i.memo(i.forwardRef((y,d)=>{const{url:v,icon:u,label:D,description:P,ariaLabel:x,ariaChecked:E,target:C,onClick:M,className:S,active:I,disabled:T,destructive:b,childItems:R,role:A,tabIndex:L=-1,customSubMenuContainerStyles:U,shortcut:W,testId:w}=y,N=(0,s.of)(m),[B,V]=(0,i.useState)(I),[K,H]=(0,i.useState)(!1),X=(0,i.useCallback)(()=>{T||(H(!0),V(!0))},[T]),k=(0,i.useCallback)(()=>{T||(H(!1),V(!1))},[T]),Y=R&&R.length>0,Z=Y?"div":v===void 0?"button":"a",se=(0,n.cx)({[N.item]:!0,[N.active]:B,[N.disabled]:T,[N.destructive]:b&&!T},S),j={[Z==="button"?"disabled":"aria-disabled"]:T,...Z==="a"&&T&&{href:void 0,onClick:void 0},...T&&{tabIndex:-1,"data-disabled":T}},q=(0,i.useRef)(null);(0,i.useImperativeHandle)(d,()=>q.current);const ne=te=>{switch(te.key){case"ArrowRight":te.preventDefault(),te.stopPropagation(),Y&&(H(!0),V(!0));break;default:break}},oe=()=>{H(!1),V(!1),q?.current?.focus()},z=!!(W&&W.length>0);return(0,t.jsxs)(Z,{target:C,className:se,rel:C==="_blank"?"noopener noreferrer":void 0,href:v,onClick:M,onMouseEnter:X,onMouseLeave:k,onKeyDown:ne,role:v?A:A||"menuitem","data-role":"menuitem",ref:q,"data-testid":w,"aria-label":x,"aria-checked":E,tabIndex:L,...j,children:[(0,t.jsxs)(a.B,{direction:"row",justifyContent:"flex-start",alignItems:"center",children:[u&&(0,t.jsx)(f.I,{name:u,className:N.icon,"aria-hidden":!0}),(0,t.jsx)("span",{className:N.ellipsis,children:D}),(0,t.jsxs)("div",{className:(0,n.cx)(N.rightWrapper,{[N.withShortcut]:z}),children:[z&&(0,t.jsxs)("div",{className:N.shortcut,children:[(0,t.jsx)(f.I,{name:"keyboard",title:"keyboard shortcut"}),W]}),Y&&(0,t.jsx)(g,{items:R,isOpen:K,close:oe,customStyle:U})]})]}),P&&(0,t.jsx)("div",{className:(0,n.cx)(N.description,N.ellipsis,{[N.descriptionWithIcon]:u!==void 0}),children:P}),y.component?(0,t.jsx)(y.component,{}):null]})}));p.displayName="MenuItem";const m=y=>({item:(0,n.css)({background:"none",cursor:"pointer",whiteSpace:"nowrap",color:y.colors.text.primary,display:"flex",flexDirection:"column",alignItems:"stretch",padding:y.spacing(.5,2),minHeight:y.spacing(4),margin:0,border:"none",width:"100%",position:"relative","&:hover, &:focus-visible":{background:y.colors.action.hover,color:y.colors.text.primary,textDecoration:"none"},"&:focus-visible":(0,r.getFocusStyles)(y)}),active:(0,n.css)({background:y.colors.action.hover}),destructive:(0,n.css)({color:y.colors.error.text,svg:{color:y.colors.error.text},"&:hover, &:focus, &:focus-visible":{background:y.colors.error.main,color:y.colors.error.contrastText,svg:{color:y.colors.error.contrastText}}}),disabled:(0,n.css)({color:y.colors.action.disabledText,label:"menu-item-disabled","&:hover, &:focus, &:focus-visible":{cursor:"not-allowed",background:"none",color:y.colors.action.disabledText}}),icon:(0,n.css)({opacity:.7,color:y.colors.text.secondary}),rightWrapper:(0,n.css)({display:"flex",alignItems:"center",marginLeft:"auto"}),withShortcut:(0,n.css)({minWidth:y.spacing(10.5)}),shortcut:(0,n.css)({display:"flex",alignItems:"center",gap:y.spacing(1),marginLeft:y.spacing(2),color:y.colors.text.secondary,opacity:.7}),description:(0,n.css)({...y.typography.bodySmall,color:y.colors.text.secondary,textAlign:"start"}),descriptionWithIcon:(0,n.css)({marginLeft:y.spacing(3)}),ellipsis:(0,n.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"})})},32653:(G,O,e)=>{"use strict";e.d(O,{t:()=>r});var t=e(96540),n=e(94701);const i=(f,a)=>(f%a+a)%a,s=-1,r=({localRef:f,isMenuOpen:a,close:c,onOpen:o,onClose:h,onKeyDown:g})=>{const[l,p]=(0,t.useState)(s);return(0,t.useEffect)(()=>{a&&p(0)},[a]),(0,t.useEffect)(()=>{const y=f?.current?.querySelectorAll('[data-role="menuitem"]:not([data-disabled])');y?.[l]?.focus(),y?.forEach((d,v)=>{d.tabIndex=v===l?0:-1})},[f,l]),(0,n.A)(()=>{o?.(p)}),[y=>{const d=f?.current?.querySelectorAll('[data-role="menuitem"]:not([data-disabled])'),v=d?.length??0;switch(y.key){case"ArrowUp":y.preventDefault(),y.stopPropagation(),p(i(l-1,v));break;case"ArrowDown":y.preventDefault(),y.stopPropagation(),p(i(l+1,v));break;case"ArrowLeft":y.preventDefault(),y.stopPropagation(),p(s),c?.();break;case"Home":y.preventDefault(),y.stopPropagation(),p(0);break;case"End":y.preventDefault(),y.stopPropagation(),p(v-1);break;case"Enter":y.preventDefault(),y.stopPropagation(),d?.[l]?.click();break;case"Escape":h?.();break;case"Tab":y.preventDefault(),h?.();break;default:break}g?.(y)}]}},37390:(G,O,e)=>{"use strict";e.d(O,{a:()=>m});var t=e(74848),n=e(32196),i=e(18828),s=e(85690),r=e(93225),f=e(59875),a=e(96540),c=e(40845),o=e(76412),h=e(29158),g=e(67061),l=e(29473),p=e(88448);function m(v){const{title:u,children:D,isOpen:P=!1,closeOnEscape:x=!0,closeOnBackdropClick:E=!0,className:C,contentClassName:M,onDismiss:S,onClickBackdrop:I,trapFocus:T=!0}=v,b=(0,c.of)(p.o),R=(0,a.useRef)(null),{overlayProps:A,underlayProps:L}=(0,r.e)({isKeyboardDismissDisabled:!x,isOpen:P,onClose:S},R),{dialogProps:U,titleProps:W}=(0,i.s)({},R);if(!P)return null;const w=(0,n.cx)(b.modalHeader,typeof u!="string"&&b.modalHeaderWithTabs);return(0,t.jsxs)(f.Sf,{children:[(0,t.jsx)("div",{role:"presentation",className:b.modalBackdrop,onClick:I||(E?S:void 0),...L}),(0,t.jsx)(s.n1,{contain:T,autoFocus:!0,restoreFocus:!0,children:(0,t.jsxs)("div",{className:(0,n.cx)(b.modal,C),ref:R,...A,...U,children:[(0,t.jsxs)("div",{className:w,children:[typeof u=="string"&&(0,t.jsx)(d,{...v,title:u,id:W.id}),typeof u!="string"&&u,(0,t.jsx)("div",{className:b.modalHeaderClose,children:(0,t.jsx)(h.K,{name:"times",size:"xl",onClick:S,"aria-label":(0,o.t)("grafana-ui.modal.close-tooltip","Close")})})]}),(0,t.jsx)("div",{className:(0,n.cx)(b.modalContent,M),children:D})]})})]})}function y({leftItems:v,children:u}){const D=(0,c.of)(p.o);return v?(0,t.jsx)("div",{className:D.modalButtonRow,children:(0,t.jsxs)(g.B,{justifyContent:"space-between",children:[(0,t.jsx)(g.B,{justifyContent:"flex-start",gap:2,children:v}),(0,t.jsx)(g.B,{justifyContent:"flex-end",gap:2,children:u})]})}):(0,t.jsx)("div",{className:D.modalButtonRow,children:(0,t.jsx)(g.B,{justifyContent:"flex-end",gap:2,wrap:"wrap",children:u})})}m.ButtonRow=y;function d({icon:v,iconTooltip:u,title:D,id:P}){return(0,t.jsx)(l.r,{icon:v,iconTooltip:u,title:D,id:P})}},29473:(G,O,e)=>{"use strict";e.d(O,{r:()=>s});var t=e(74848),n=e(40845),i=e(88448);const s=({icon:r,iconTooltip:f,title:a,children:c,id:o})=>{const h=(0,n.of)(i.o);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h2",{className:h.modalHeaderTitle,id:o,children:a}),c]})}},95246:(G,O,e)=>{"use strict";e.d(O,{O:()=>n});var t=e(74848);const n=({children:i})=>(0,t.jsx)("div",{className:"share-modal-body",children:(0,t.jsx)("div",{className:"share-modal-header",children:(0,t.jsx)("div",{className:"share-modal-content",children:i})})})},25897:(G,O,e)=>{"use strict";e.d(O,{J:()=>r});var t=e(74848),n=e(40675),i=e(63021),s=e(29473);const r=({icon:f,title:a,tabs:c,activeTab:o,onChangeTab:h})=>(0,t.jsx)(s.r,{icon:f,title:a,children:(0,t.jsx)(i.U,{hideBorder:!0,children:c.map((g,l)=>(0,t.jsx)(n.o,{label:g.label,icon:g.icon,suffix:g.tabSuffix,active:g.value===o,onChangeTab:()=>h(g)},`${g.value}-${l}`))})})},71678:(G,O,e)=>{"use strict";e.d(O,{$s:()=>f,EO:()=>r,YO:()=>s,wE:()=>i});var t=e(74848),n=e(96540);const i=n.createContext({component:null,props:{},showModal:()=>{},hideModal:()=>{}});class s extends n.Component{constructor(c){super(c),this.showModal=(o,h)=>{this.setState({component:o,props:h})},this.hideModal=()=>{this.setState({component:null,props:{}})},this.state={component:c.component||null,props:c.props||{},showModal:this.showModal,hideModal:this.hideModal}}render(){return(0,t.jsx)(i.Provider,{value:this.state,children:this.props.children})}}const r=()=>(0,t.jsx)(i.Consumer,{children:({component:a,props:c})=>a?(0,t.jsx)(a,{...c}):null}),f=i.Consumer},88448:(G,O,e)=>{"use strict";e.d(O,{o:()=>n});var t=e(32196);const n=i=>{const s=i.shape.radius.default;return{modal:(0,t.css)({position:"fixed",zIndex:i.zIndex.modal,background:i.colors.background.primary,boxShadow:i.shadows.z3,borderRadius:s,border:`1px solid ${i.colors.border.weak}`,backgroundClip:"padding-box",outline:"none",width:"750px",maxWidth:"100%",left:0,right:0,marginLeft:"auto",marginRight:"auto",top:"10%",maxHeight:"80%",display:"flex",flexDirection:"column"}),modalBackdrop:(0,t.css)({position:"fixed",zIndex:i.zIndex.modalBackdrop,top:0,right:0,bottom:0,left:0,backgroundColor:i.components.overlay.background,backdropFilter:"blur(1px)"}),modalHeader:(0,t.css)({label:"modalHeader",display:"flex",alignItems:"center",minHeight:"42px",margin:i.spacing(1,2,0,2)}),modalHeaderWithTabs:(0,t.css)({borderBottom:`1px solid ${i.colors.border.weak}`}),modalHeaderTitle:(0,t.css)({fontSize:i.typography.size.lg,margin:i.spacing(0,4,0,1),display:"flex",alignItems:"center",position:"relative",top:"2px"}),modalHeaderIcon:(0,t.css)({marginRight:i.spacing(2),fontSize:"inherit","&:before":{verticalAlign:"baseline"}}),modalHeaderClose:(0,t.css)({height:"100%",display:"flex",alignItems:"center",color:i.colors.text.secondary,flexGrow:1,justifyContent:"flex-end"}),modalContent:(0,t.css)({overflow:"auto",padding:i.spacing(3),width:"100%"}),modalButtonRow:(0,t.css)({paddingTop:i.spacing(3)})}}},32372:(G,O,e)=>{"use strict";e.d(O,{B:()=>m});var t=e(74848),n=e(32196),i=e(96540),s=e(96915),r=e(13544),f=e(40845),a=e(85828),c=e(19716);function o(d){for(let v=d.length-1;v>0;v--){const u=d.charAt(v);if(u==="$")return{index:v,prefix:d.substring(v)};if(u===" "||u==="	"||u==='"'||u==="'")return{index:v+1,prefix:d.substring(v+1)}}return{index:0,prefix:d}}function h(d,v,u,D){const P=[];for(const x of u)v&&!x.label.startsWith(v)||P.push({...x,kind:g(d,x.kind),range:D,insertText:x.insertText??x.label});return P}function g(d,v){switch(v){case c.q.Method:return d.languages.CompletionItemKind.Method;case c.q.Field:return d.languages.CompletionItemKind.Field;case c.q.Property:return d.languages.CompletionItemKind.Property;case c.q.Constant:return d.languages.CompletionItemKind.Constant;case c.q.Text:return d.languages.CompletionItemKind.Text}return d.languages.CompletionItemKind.Text}function l(d,v,u,D){if(!(!v||!u))return d.languages.registerCompletionItemProvider(v,{triggerCharacters:["$"],provideCompletionItems:(P,x,E)=>{if(P.id!==D)return;const C={startLineNumber:x.lineNumber,endLineNumber:x.lineNumber,startColumn:x.column,endColumn:x.column};if(E.triggerCharacter==="$")return C.startColumn=x.column-1,{suggestions:h(d,"$",u(),C)};const M=P.getValueInRange({startLineNumber:x.lineNumber,startColumn:1,endLineNumber:x.lineNumber,endColumn:x.column}),{index:S,prefix:I}=o(M);C.startColumn=S+1;const T=h(d,I,u(),C);if(T.length)return{suggestions:T}}})}class p extends i.PureComponent{constructor(v){super(v),this.loadCustomLanguage=()=>{const{language:u}=this.props,D=s.l.getIfExists(u);return D?D.init():Promise.resolve()},this.getEditorValue=()=>"",this.onBlur=()=>{const{onBlur:u}=this.props;u&&u(this.getEditorValue())},this.onFocus=()=>{const{onFocus:u}=this.props;u&&u(this.getEditorValue())},this.onSave=()=>{const{onSave:u}=this.props;u&&u(this.getEditorValue())},this.handleBeforeMount=u=>{this.monaco=u;const{onBeforeEditorMount:D}=this.props;D?.(u)},this.handleOnMount=(u,D)=>{const{getSuggestions:P,language:x,onChange:E,onEditorDidMount:C}=this.props;this.modelId=u.getModel()?.id,this.getEditorValue=()=>u.getValue(),P&&this.modelId&&(this.completionCancel=l(D,x,P,this.modelId)),u.onKeyDown(M=>{M.keyCode===D.KeyCode.KeyS&&(M.ctrlKey||M.metaKey)&&(M.preventDefault(),this.onSave())}),E&&u.getModel()?.onDidChangeContent(()=>E(u.getValue())),C&&C(u,D)}}componentWillUnmount(){this.completionCancel&&this.completionCancel.dispose(),this.props.onEditorWillUnmount?.()}componentDidUpdate(v){const{getSuggestions:u,language:D}=this.props,P=v.language!==D;if(v.getSuggestions!==u||P){if(this.completionCancel&&this.completionCancel.dispose(),!this.monaco){console.warn("Monaco instance not loaded yet");return}u&&this.modelId&&(this.completionCancel=l(this.monaco,D,u,this.modelId))}P&&this.loadCustomLanguage()}render(){const{theme:v,language:u,width:D,height:P,showMiniMap:x,showLineNumbers:E,readOnly:C,monacoOptions:M}=this.props,{alwaysConsumeMouseWheel:S,...I}=M??{},T=this.props.value??"",b=T.length>100,R=this.props.containerStyles??y(v).container,A={wordWrap:"off",tabSize:2,codeLens:!1,contextmenu:!1,minimap:{enabled:b&&x,renderCharacters:!1},readOnly:C,lineNumbersMinChars:4,lineDecorationsWidth:1*v.spacing.gridSize,overviewRulerBorder:!1,automaticLayout:!0,padding:{top:.5*v.spacing.gridSize,bottom:.5*v.spacing.gridSize},fixedOverflowWidgets:!0,scrollbar:{alwaysConsumeMouseWheel:S??!1}};return E||(A.glyphMargin=!1,A.folding=!1,A.lineNumbers="off",A.lineNumbersMinChars=0),(0,t.jsx)("div",{className:R,onFocus:this.onFocus,onBlur:this.onBlur,"data-testid":r.Tp.components.CodeEditor.container,children:(0,t.jsx)(a.m,{width:D,height:P,language:u,value:T,options:{...A,...I??{}},beforeMount:this.handleBeforeMount,onMount:this.handleOnMount,keepCurrentModel:!0})})}}const m=(0,f.cV)(p),y=d=>({container:(0,n.css)({borderRadius:d.shape.radius.default,border:`1px solid ${d.components.input.borderColor}`})})},85828:(G,O,e)=>{"use strict";e.d(O,{m:()=>o});var t=e(74848),n=e(32196),i=e(13544),s=e(40845),r=e(16817);const f=g=>{const l=(0,r.A)(async()=>await g);return{...l,dependency:l.value}};var a=e(52446),c=e(39558);const o=g=>{const l=(0,s.of)(h),{loading:p,error:m,dependency:y}=f(Promise.all([e.e(8477),e.e(6556),e.e(8926)]).then(e.bind(e,16556)));if(p)return(0,t.jsx)(c._,{text:"Loading editor",className:l.container});if(m)return(0,t.jsx)(a.D,{title:"React Monaco Editor failed to load",error:m,errorInfo:{componentStack:m?.stack??""}});const d=y.ReactMonacoEditor;return(0,t.jsx)(d,{...g,loading:g.loading??null,wrapperProps:{"data-testid":i.Tp.components.ReactMonacoEditor.editorLazy}})},h=g=>({container:(0,n.css)({marginBottom:"unset",marginLeft:g.spacing(1)})})},19716:(G,O,e)=>{"use strict";e.d(O,{q:()=>t});var t=(n=>(n.Method="method",n.Field="field",n.Property="property",n.Constant="constant",n.Text="text",n))(t||{})},99544:(G,O,e)=>{"use strict";e.d(O,{O:()=>n});var t=e(19716);function n(i){const s="${"+i.value+"}",r=i.value===i.label?i.origin:`${i.label} / ${i.origin}`;return{label:s,kind:t.q.Property,detail:r,documentation:i.documentation}}},95247:(G,O,e)=>{"use strict";e.d(O,{d:()=>g});var t=e(74848),n=e(32196),i=e(96540),s=e(13544),r=e(40845),f=e(16797),a=e(14578),c=e(29158),o=e(50720),h=e(15068);const g=(0,i.memo)(({title:p,section:m,parent:y,pageIcon:d,onGoBack:v,children:u,titleHref:D,parentHref:P,leftItems:x,isFullscreen:E,className:C,"aria-label":M,buttonOverflowAlignment:S="right",forceShowLeftItems:I=!1})=>{const T=(0,r.of)(l),b=(0,n.cx)("page-toolbar",T.toolbar,{"page-toolbar--fullscreen":E,[T.noPageIcon]:!d},C),R=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:T.truncateText,children:p}),m&&(0,t.jsxs)("span",{className:T.pre,children:[" / ",m]})]});return(0,t.jsxs)("nav",{className:b,"aria-label":M,children:[(0,t.jsxs)("div",{className:T.leftWrapper,children:[d&&!v&&(0,t.jsx)("div",{className:T.pageIcon,children:(0,t.jsx)(a.I,{name:d,size:"lg","aria-hidden":!0})}),v&&(0,t.jsx)("div",{className:T.pageIcon,children:(0,t.jsx)(c.K,{name:"arrow-left",tooltip:"Go back (Esc)",tooltipPlacement:"bottom",size:"xxl","data-testid":s.Tp.components.BackButton.backArrow,onClick:v})}),(0,t.jsxs)("nav",{"aria-label":"Search links",className:T.navElement,children:[y&&P&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(o.N,{"aria-label":`Search dashboard in the ${y} folder`,className:(0,n.cx)(T.titleText,T.parentLink,T.titleLink,T.truncateText),href:P,children:[y," ",(0,t.jsx)("span",{className:T.parentIcon})]}),D&&(0,t.jsx)("span",{className:(0,n.cx)(T.titleText,T.titleDivider),"aria-hidden":!0,children:"/"})]}),(p||!!x?.length)&&(0,t.jsxs)("div",{className:T.titleWrapper,children:[p&&(0,t.jsx)("h1",{className:T.h1Styles,children:D?(0,t.jsx)(o.N,{"aria-label":"Search dashboard by name",className:(0,n.cx)(T.titleText,T.titleLink),href:D,children:R}):(0,t.jsx)("div",{className:T.titleText,children:R})}),x?.map((A,L)=>(0,t.jsx)("div",{className:(0,n.cx)(T.leftActionItem,{[T.forceShowLeftActionItems]:I}),children:A},L))]})]})]}),(0,t.jsx)(h.U,{alignment:S,children:i.Children.toArray(u).filter(Boolean)})]})});g.displayName="PageToolbar";const l=p=>{const{spacing:m,typography:y}=p,d=(0,f.getFocusStyles)(p);return{pre:(0,n.css)({whiteSpace:"pre"}),toolbar:(0,n.css)({alignItems:"center",background:p.colors.background.canvas,display:"flex",gap:p.spacing(2),justifyContent:"space-between",padding:p.spacing(1.5,2),[p.breakpoints.down("md")]:{paddingLeft:"53px"}}),noPageIcon:(0,n.css)({[p.breakpoints.down("md")]:{paddingLeft:p.spacing(2)}}),leftWrapper:(0,n.css)({display:"flex",flexWrap:"nowrap",maxWidth:"70%"}),pageIcon:(0,n.css)({display:"none",[p.breakpoints.up("sm")]:{display:"flex",paddingRight:p.spacing(1),alignItems:"center"}}),truncateText:(0,n.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),titleWrapper:(0,n.css)({display:"flex",margin:0,minWidth:0}),navElement:(0,n.css)({display:"flex",alignItems:"center",minWidth:0}),h1Styles:(0,n.css)({margin:m(0,1,0,0),lineHeight:"inherit",flexGrow:1,minWidth:0}),parentIcon:(0,n.css)({marginLeft:p.spacing(.5)}),titleText:(0,n.css)({display:"flex",fontSize:y.size.lg,margin:0,borderRadius:p.shape.radius.default}),titleLink:(0,n.css)({"&:focus-visible":d}),titleDivider:(0,n.css)({padding:m(0,.5,0,.5),display:"none",[p.breakpoints.up("md")]:{display:"unset"}}),parentLink:(0,n.css)({display:"none",[p.breakpoints.up("md")]:{display:"unset",flex:1}}),leftActionItem:(0,n.css)({display:"none",alignItems:"center",paddingRight:m(.5),[p.breakpoints.up("md")]:{display:"flex"}}),forceShowLeftActionItems:(0,n.css)({display:"flex"})}}},19384:(G,O,e)=>{"use strict";e.d(O,{d:()=>a});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(55852),f=e(14578);const a=({currentPage:o,numberOfPages:h,onNavigate:g,hideWhenSinglePage:l,showSmallVersion:p,className:m})=>{const y=(0,s.of)(c),d=p?1:8,v=(0,i.useMemo)(()=>{const u=[...new Array(h).keys()],D=h>d,P=(x,E)=>(0,t.jsx)("li",{className:y.item,children:(0,t.jsx)(r.$n,{size:"sm",variant:E,onClick:()=>g(x),children:x})},x);return u.reduce((x,E)=>{const C=E+1,M=C===o?"primary":"secondary",S=d,I=h-d+1,T=I-S,b=C===1||C===h,R=T>-1&&o>=S&&o<=I,A=p?1:3,L=p?0:2;return D?b||o<S&&C<S||T>=0&&o>I&&C>I||T<0&&o>=S&&C>I||R&&C>=o-L&&C<=o+L?x.push(P(C,M)):(C===S&&o<S||C===I&&o>I||R&&(C===o-A||C===o+A))&&x.push((0,t.jsx)("li",{className:y.item,children:(0,t.jsx)(f.I,{className:y.ellipsis,name:"ellipsis-v"})},C)):x.push(P(C,M)),x},[])},[o,h,g,d,p,y.ellipsis,y.item]);return l&&h<=1?null:(0,t.jsx)("div",{className:(0,n.cx)(y.container,m),children:(0,t.jsxs)("ol",{children:[(0,t.jsx)("li",{className:y.item,children:(0,t.jsx)(r.$n,{"aria-label":"previous page",size:"sm",variant:"secondary",onClick:()=>g(o-1),disabled:o===1,children:(0,t.jsx)(f.I,{name:"angle-left"})})}),v,(0,t.jsx)("li",{className:y.item,children:(0,t.jsx)(r.$n,{"aria-label":"next page",size:"sm",variant:"secondary",onClick:()=>g(o+1),disabled:o===h,children:(0,t.jsx)(f.I,{name:"angle-right"})})})]})})},c=()=>({container:(0,n.css)({float:"right"}),item:(0,n.css)({display:"inline-block",paddingLeft:"10px",marginBottom:"5px"}),ellipsis:(0,n.css)({transform:"rotate(90deg)"})})},89963:(G,O,e)=>{"use strict";e.d(O,{I:()=>a});var t=e(74848),n=e(32196),i=e(13544),s=e(40845),r=e(14578),f=e(56034);const a=({onCancel:h,loading:g})=>{const l=window.matchMedia("(prefers-reduced-motion: reduce)").matches,p=(0,s.of)(o);return g?(0,t.jsx)(f.m,{content:"Cancel query",children:(0,t.jsx)(r.I,{className:(0,n.cx)(p.spin,{[p.clickable]:!!h}),name:l?"hourglass":"sync",size:"sm",onClick:h,"data-testid":i.Tp.components.LoadingIndicator.icon})}):null},c=(0,n.keyframes)({"0%":{transform:"rotate(0deg) scaleX(-1)"},"100%":{transform:"rotate(359deg) scaleX(-1)"}}),o=h=>({clickable:(0,n.css)({cursor:"pointer"}),spin:(0,n.css)({[h.transitions.handleMotion("no-preference")]:{animation:`${c} 3s linear infinite`}})})},79041:(G,O,e)=>{"use strict";e.d(O,{XF:()=>s,d2:()=>r,e4:()=>i});var t=e(96540),n=e(18226);const i=(0,t.createContext)({eventsScope:"global",eventBus:new n.o}),s=i.Provider,r=()=>(0,t.useContext)(i)},91052:(G,O,e)=>{"use strict";e.d(O,{NR:()=>W});var t=e(89963),n=e(74848),i=e(32196),s=e(96540),r=e(42941),f=e(49185),a=e(39070),c=e(13544),o=e(40845),h=e(16797);function g({children:w,delay:N}){const[B,V]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{window.setTimeout(()=>{V(!0)},N)},[w,N]),(0,n.jsx)(n.Fragment,{children:B?w:null})}var l=e(14578),p=e(57514),m=e(94753),y=e(56034),d=e(83122),v=e(27746);function u({menu:w,title:N,placement:B="bottom",offset:V,dragClassCancel:K,menuButtonClass:H,onOpenMenu:X}){const k=N?c.Tp.components.Panels.Panel.menu(N):"panel-menu-button",Y=(0,s.useCallback)(Z=>{Z&&X&&X()},[X]);return(0,n.jsx)(d.m,{overlay:w,placement:B,offset:V,onVisibleChange:Y,children:(0,n.jsx)(v.I,{"aria-label":`Menu for panel with ${N?`title ${N}`:"no title"}`,title:"Menu",icon:"ellipsis-v",iconSize:"md",narrow:!0,"data-testid":k,className:(0,i.cx)(H,K)})})}function D({menu:w,title:N,dragClass:B,children:V,offset:K=-32,onOpenMenu:H}){const X=(0,o.of)(P),k=(0,s.useRef)(null),Y=c.Tp.components.Panels.Panel.HoverWidget,Z=(0,s.useCallback)(j=>{k.current?.setPointerCapture(j.pointerId)},[]),se=(0,s.useCallback)(j=>{k.current?.releasePointerCapture(j.pointerId)},[]);return V===void 0||s.Children.count(V)===0?null:(0,n.jsxs)("div",{className:(0,i.cx)(X.container,"show-on-hover"),style:{top:K},"data-testid":Y.container,children:[B&&(0,n.jsx)("div",{className:(0,i.cx)(X.square,X.draggable,B),onPointerDown:Z,onPointerUp:se,ref:k,"data-testid":Y.dragIcon,children:(0,n.jsx)(l.I,{name:"expand-arrows",className:X.draggableIcon})}),V,w&&(0,n.jsx)(u,{menu:w,title:N,placement:"bottom",menuButtonClass:X.menuButton,onOpenMenu:H})]})}function P(w){return{container:(0,i.css)({label:"hover-container-widget",[w.transitions.handleMotion("no-preference","reduce")]:{transition:"all .1s linear"},display:"flex",position:"absolute",zIndex:1,right:0,boxSizing:"content-box",alignItems:"center",background:w.colors.background.secondary,color:w.colors.text.primary,border:`1px solid ${w.colors.border.weak}`,borderRadius:w.shape.radius.default,height:w.spacing(4),boxShadow:w.shadows.z1}),square:(0,i.css)({display:"flex",justifyContent:"center",alignItems:"center",width:w.spacing(4),height:"100%"}),draggable:(0,i.css)({cursor:"move",[w.breakpoints.down("md")]:{display:"none"}}),menuButton:(0,i.css)({background:"inherit",border:"none","&:hover":{background:w.colors.secondary.main}}),draggableIcon:(0,i.css)({transform:"rotate(45deg)",color:w.colors.text.secondary,"&:hover":{color:w.colors.text.primary}})}}var x=e(55852);const E=(0,s.forwardRef)(({className:w,children:N,href:B,onClick:V,target:K,title:H,...X},k)=>{const Y=(0,o.of)(C);return B?(0,n.jsx)("a",{ref:k,href:B,onClick:V,target:K,title:H,className:(0,i.cx)(Y.linkItem,w),...X,children:N}):V?(0,n.jsx)(x.$n,{ref:k,className:(0,i.cx)(Y.item,w),variant:"secondary",fill:"text",onClick:V,children:N}):(0,n.jsx)("span",{ref:k,className:(0,i.cx)(Y.item,w),...X,children:N})});E.displayName="TitleItem";const C=w=>{const N=(0,i.css)({color:`${w.colors.text.secondary}`,label:"panel-header-item",cursor:"auto",border:"none",borderRadius:`${w.shape.radius.default}`,padding:`${w.spacing(0,1)}`,height:`${w.spacing(w.components.panel.headerHeight)}`,display:"flex",alignItems:"center",justifyContent:"center","&:focus, &:focus-visible":{...(0,h.getFocusStyles)(w),zIndex:1},"&: focus:not(:focus-visible)":(0,h.getMouseFocusStyles)(w),"&:hover ":{boxShadow:`${w.shadows.z1}`,background:`${w.colors.background.secondary}`,color:`${w.colors.text.primary}`}});return{item:N,linkItem:(0,i.cx)(N,(0,i.css)({cursor:"pointer"}))}};function M({description:w,className:N}){const B=(0,o.of)(S),V=()=>{const K=typeof w=="function"?w():w;return(0,n.jsx)("div",{className:"panel-info-content markdown-html",children:(0,n.jsx)("div",{dangerouslySetInnerHTML:{__html:K}})})};return w!==""?(0,n.jsx)(y.m,{interactive:!0,content:V,children:(0,n.jsx)(E,{className:(0,i.cx)(N,B.description),children:(0,n.jsx)(l.I,{name:"info-circle",size:"md"})})}):null}const S=w=>({description:(0,i.css)({code:{whiteSpace:"normal",wordWrap:"break-word"},"pre > code":{display:"block"}})});function I({message:w,onClick:N,ariaLabel:B="status"}){const V=(0,o.of)(T);return(0,n.jsx)(v.I,{className:V.buttonStyles,onClick:N,variant:"destructive",icon:"exclamation-triangle",iconSize:"md",tooltip:w||"","aria-label":B,"data-testid":c.Tp.components.Panels.Panel.status("error")})}const T=w=>{const{headerHeight:N,padding:B}=w.components.panel;return{buttonStyles:(0,i.css)({label:"panel-header-state-button",display:"flex",alignItems:"center",justifyContent:"center",padding:w.spacing(B),width:w.spacing(N),height:w.spacing(N),borderRadius:w.shape.radius.default})}};function b({width:w,height:N,children:B,padding:V="md",title:K="",description:H="",displayMode:X="default",titleItems:k,menu:Y,dragClass:Z,dragClassCancel:se,hoverHeader:j=!1,hoverHeaderOffset:q,loadingState:ne,statusMessage:oe,statusMessageOnClick:z,leftItems:te,actions:le,onCancelQuery:ie,onOpenMenu:ae,collapsible:re=!1,collapsed:ce,onToggleCollapse:me,onFocus:ee,onMouseMove:de,onMouseEnter:De}){const fe=(0,o.$j)(),Te=(0,o.of)(U),je=(0,s.useId)(),He=(0,s.useId)().replace(/:/g,"_"),Be=!j,[Ne,Re]=(0,r.A)(!0);ce===void 0&&(ce=!Ne);const Se="show-on-hover",We=X==="transparent",Ke=A(fe,Be),{contentStyle:Xe,innerWidth:Je,innerHeight:st}=L(V,fe,Ke,ce,N,w),pt={height:Ke,cursor:Z?"move":"auto"},xt={width:w,height:ce?void 0:N},[ot,{width:$e}]=(0,f.A)();te&&(le=te);const ve=typeof K=="string"?c.Tp.components.Panels.Panel.title(K):"Panel",be=(0,n.jsxs)(n.Fragment,{children:[!re&&K&&(0,n.jsx)("div",{className:Te.title,children:(0,n.jsx)(m.E,{element:"h2",variant:"h6",truncate:!0,title:typeof K=="string"?K:void 0,id:He,children:K})}),re&&(0,n.jsx)("div",{className:Te.title,children:(0,n.jsx)(m.E,{element:"h2",variant:"h6",children:(0,n.jsxs)("button",{type:"button",className:Te.clearButtonStyles,onClick:()=>{Re(),me&&me(!ce)},"aria-expanded":!ce,"aria-controls":ce?void 0:je,children:[(0,n.jsx)(l.I,{name:ce?"angle-right":"angle-down","aria-hidden":!!K,"aria-label":K?void 0:"toggle collapse panel"}),(0,n.jsx)(m.E,{variant:"h6",truncate:!0,id:He,children:K})]})})}),(0,n.jsxs)("div",{className:(0,i.cx)(Te.titleItems,se),"data-testid":"title-items-container",children:[(0,n.jsx)(M,{description:H,className:se}),k]}),ne===a.Gu.Streaming&&(0,n.jsx)(y.m,{content:ie?"Stop streaming":"Streaming",children:(0,n.jsx)(E,{className:se,"data-testid":"panel-streaming",onClick:ie,children:(0,n.jsx)(l.I,{name:"circle-mono",size:"md",className:Te.streaming})})}),ne===a.Gu.Loading&&ie&&(0,n.jsx)(g,{delay:2e3,children:(0,n.jsx)(y.m,{content:"Cancel query",children:(0,n.jsx)(E,{className:(0,i.cx)(se,Te.pointer),"data-testid":"panel-cancel-query",onClick:ie,children:(0,n.jsx)(l.I,{name:"sync-slash",size:"md"})})})}),(0,n.jsx)("div",{className:Te.rightAligned,children:le&&(0,n.jsx)("div",{className:Te.rightActions,children:R(le,he=>he)})})]});return(0,n.jsxs)("section",{className:(0,i.cx)(Te.container,{[Te.transparentContainer]:We}),style:xt,"aria-labelledby":K?He:void 0,"data-testid":ve,tabIndex:0,onFocus:ee,onMouseMove:de,onMouseEnter:De,ref:ot,children:[(0,n.jsx)("div",{className:Te.loadingBarContainer,children:ne===a.Gu.Loading?(0,n.jsx)(p.G,{width:$e,ariaLabel:"Panel loading bar"}):null}),j&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(D,{menu:Y,title:typeof K=="string"?K:void 0,offset:q,dragClass:Z,onOpenMenu:ae,children:be}),oe&&(0,n.jsx)("div",{className:Te.errorContainerFloating,children:(0,n.jsx)(I,{message:oe,onClick:z,ariaLabel:"Panel status"})})]}),Be&&(0,n.jsxs)("div",{className:(0,i.cx)(Te.headerContainer,Z),style:pt,"data-testid":"header-container",children:[oe&&(0,n.jsx)("div",{className:se,children:(0,n.jsx)(I,{message:oe,onClick:z,ariaLabel:"Panel status"})}),be,Y&&(0,n.jsx)(u,{menu:Y,title:typeof K=="string"?K:void 0,placement:"bottom-end",menuButtonClass:(0,i.cx)(Te.menuItem,se,Se),onOpenMenu:ae})]}),!ce&&(0,n.jsx)("div",{id:je,"data-testid":c.Tp.components.Panels.Panel.content,className:(0,i.cx)(Te.content,N===void 0&&Te.containNone),style:Xe,children:typeof B=="function"?B(Je,st):B})]})}const R=(w,N)=>{const B=s.Children.toArray(w).filter(Boolean);return B.length>0?N(B):null},A=(w,N)=>N?w.spacing.gridSize*w.components.panel.headerHeight:0,L=(w,N,B,V,K,H)=>{const X=(w==="md"?N.components.panel.padding:0)*N.spacing.gridSize,k=X*2,Y=1*2;let Z=0;H&&(Z=H-k-Y);let se=0;return K&&(se=K-B-k-Y),V&&(se=B),{contentStyle:{padding:X},innerWidth:Z,innerHeight:se}},U=w=>{const{background:N,borderColor:B,padding:V}=w.components.panel;return{container:(0,i.css)({label:"panel-container",backgroundColor:N,border:`1px solid ${B}`,position:"relative",borderRadius:w.shape.radius.default,height:"100%",display:"flex",flexDirection:"column",".show-on-hover":{opacity:"0",visibility:"hidden"},"&:focus-visible, &:hover":{".show-on-hover":{opacity:"1",visibility:"visible"}},"&:focus-visible":(0,h.getFocusStyles)(w),"&:focus-within:not(:focus)":{".show-on-hover":{visibility:"visible",opacity:"1"}}}),transparentContainer:(0,i.css)({label:"panel-transparent-container",backgroundColor:"transparent",border:"1px solid transparent",boxSizing:"border-box","&:hover":{border:`1px solid ${B}`}}),loadingBarContainer:(0,i.css)({label:"panel-loading-bar-container",position:"absolute",top:0,width:"100%",zIndex:1}),containNone:(0,i.css)({contain:"none"}),content:(0,i.css)({label:"panel-content",flexGrow:1,contain:"size layout"}),headerContainer:(0,i.css)({label:"panel-header",display:"flex",alignItems:"center"}),pointer:(0,i.css)({cursor:"pointer"}),streaming:(0,i.css)({label:"panel-streaming",marginRight:0,color:w.colors.success.text,"&:hover":{color:w.colors.success.text}}),title:(0,i.css)({label:"panel-title",display:"flex",padding:w.spacing(0,V),minWidth:0,"& > h2":{minWidth:0}}),items:(0,i.css)({display:"flex"}),item:(0,i.css)({display:"flex",justifyContent:"center",alignItems:"center"}),hiddenMenu:(0,i.css)({visibility:"hidden"}),menuItem:(0,i.css)({label:"panel-menu",border:"none",background:w.colors.secondary.main,"&:hover":{background:w.colors.secondary.shade}}),errorContainerFloating:(0,i.css)({label:"error-container",position:"absolute",left:0,top:0,zIndex:1}),rightActions:(0,i.css)({display:"flex",padding:w.spacing(0,V),gap:w.spacing(1)}),rightAligned:(0,i.css)({label:"right-aligned-container",marginLeft:"auto",display:"flex",alignItems:"center"}),titleItems:(0,i.css)({display:"flex",height:"100%"}),clearButtonStyles:(0,i.css)({alignItems:"center",display:"flex",gap:w.spacing(.5),background:"transparent",border:"none",padding:0,maxWidth:"100%"})}},W=b;W.LoadingIndicator=t.I,W.TitleItem=E},88895:(G,O,e)=>{"use strict";e.d(O,{B:()=>t});var t=(n=>(n.ToggleSelection="select",n.AppendToSelection="append",n))(t||{})},52494:(G,O,e)=>{"use strict";e.d(O,{_:()=>s});var t=e(74848),n=e(32196),i=e(40845);const s=({children:f,className:a,...c})=>{const o=(0,i.of)(r);return(0,t.jsx)("div",{className:(0,n.cx)(o,a),...c,children:f})},r=f=>(0,n.css)({backgroundColor:f.components.panel.background,border:`1px solid ${f.components.panel.borderColor}`,borderRadius:f.shape.radius.default})},98624:(G,O,e)=>{"use strict";e.d(O,{B:()=>s});var t=e(74848),n=e(43429),i=e(39938);const s=({status:f,color:a,...c})=>{const o=r(f);return(0,t.jsx)(i.E,{text:o.text,color:o.color,icon:o.icon,tooltip:o.tooltip,...c})};s.displayName="PluginSignatureBadge";function r(f){switch(f||(f=n.Ac.invalid),f){case n.Ac.internal:return{text:"Core",color:"blue",tooltip:"Core plugin that is bundled with Grafana"};case n.Ac.valid:return{text:"Signed",icon:"lock",color:"green",tooltip:"Signed and verified plugin"};case n.Ac.invalid:return{text:"Invalid signature",icon:"exclamation-triangle",color:"red",tooltip:"Invalid plugin signature"};case n.Ac.modified:return{text:"Modified signature",icon:"exclamation-triangle",color:"red",tooltip:"Valid signature but content has been modified"};case n.Ac.missing:return{text:"Missing signature",icon:"exclamation-triangle",color:"red",tooltip:"Missing plugin signature"};default:return{text:"Unsigned",icon:"exclamation-triangle",color:"red",tooltip:"Unsigned external plugin"}}}},17464:(G,O,e)=>{"use strict";e.d(O,{ZL:()=>r,gF:()=>f,qB:()=>a});var t=e(74848),n=e(96540),i=e(40961),s=e(40845);function r(o){const{children:h,className:g,root:l,forwardedRef:p}=o,m=(0,s.$j)(),y=(0,n.useRef)(null),d=l??f();return y.current||(y.current=document.createElement("div"),g&&(y.current.className=g),y.current.style.position="relative",y.current.style.zIndex=`${m.zIndex.portal}`),(0,n.useLayoutEffect)(()=>(y.current&&d.appendChild(y.current),()=>{y.current&&d.removeChild(y.current)}),[d]),i.createPortal((0,t.jsx)("div",{ref:p,children:h}),y.current)}function f(){return window.document.getElementById("grafana-portal-container")??document.body}function a(){return(0,t.jsx)("div",{id:"grafana-portal-container"})}const c=n.forwardRef((o,h)=>(0,t.jsx)(r,{...o,forwardedRef:h}));c.displayName="RefForwardingPortal"},20084:(G,O,e)=>{"use strict";e.d(O,{X:()=>E});var t=e(74848),n=e(32196),i=e(46942),s=e.n(i),r=e(2543),f=e.n(r),a=e(96540),c=e(52845),o=e(29317),h=e(13544),g=e(80903),l=e(4269),p=e(88295),m=e(74738),y=e(31589),d=e(1020),v=e(99453),u=e(40845),D=e(16797),P=e(72307);class x extends a.PureComponent{constructor(S){super(S),this.lastExecutedValue=null,this.mounted=!1,this.editor=null,this.onChange=(A,L)=>{const U=A.document!==this.state.value.document,W=this.state.value;this.props.onRichValueChange&&this.props.onRichValueChange(A),this.setState({value:A},()=>{if(U){const w=c.A.serialize(W)!==c.A.serialize(A);w&&L&&this.runOnChangeAndRunQuery(),w&&!L&&this.runOnChangeDebounced()}})},this.runOnChange=()=>{const{onChange:A}=this.props,L=c.A.serialize(this.state.value);A&&A(this.cleanText(L))},this.runOnRunQuery=()=>{const{onRunQuery:A}=this.props;A&&(A(),this.lastExecutedValue=this.state.value)},this.runOnChangeAndRunQuery=()=>{this.runOnChange(),this.runOnRunQuery()},this.handleBlur=(A,L,U)=>{const{onBlur:W}=this.props;if(W)W();else{const w=this.lastExecutedValue?c.A.serialize(this.lastExecutedValue):"",N=c.A.serialize(L.value);w!==N&&this.runOnChangeAndRunQuery()}return U()},this.runOnChangeDebounced=(0,r.debounce)(this.runOnChange,500);const{onTypeahead:I,cleanText:T,portalOrigin:b,onWillApplySuggestion:R}=S;this.plugins=[(0,g.Pz)({onTypeahead:I,cleanText:T,portalOrigin:b,onWillApplySuggestion:R}),(0,l.U)({handler:this.runOnChangeAndRunQuery}),(0,p.O)(),(0,m.v)(),(0,y.l)(),(0,d.T)(),(0,v.s)(),...S.additionalPlugins||[]].filter(A=>A),this.state={suggestions:[],typeaheadContext:null,typeaheadPrefix:"",typeaheadText:"",value:(0,P.mO)(S.query||"",S.syntax)}}static{this.defaultProps={onBlur:()=>{}}}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}componentDidUpdate(S,I){const{query:T,syntax:b,syntaxLoaded:R}=this.props;if(!S.syntaxLoaded&&R&&this.editor){const L=this.editor.insertText(" ").deleteBackward(1);this.onChange(L.value,!0)}const{value:A}=this.state;T!==S.query&&T!==c.A.serialize(A)&&this.setState({value:(0,P.mO)(T||"",b)})}cleanText(S){return S.replace(/[\r]/g,"")}render(){const{disabled:S,theme:I}=this.props,T=s()("slate-query-field__wrapper",{"slate-query-field__wrapper--disabled":S}),b=C(I);return(0,t.jsx)("div",{className:(0,n.cx)(T,b.wrapper),children:(0,t.jsx)("div",{className:"slate-query-field","data-testid":h.Tp.components.QueryField.container,children:(0,t.jsx)(o.KE,{ref:R=>this.editor=R,schema:P.yx,autoCorrect:!1,readOnly:this.props.disabled,onBlur:this.handleBlur,onClick:this.props.onClick,onChange:R=>{this.onChange(R.value,!1)},placeholder:this.props.placeholder,plugins:this.plugins,spellCheck:!1,value:this.state.value})})})}}const E=(0,u.cV)(x),C=M=>{const S=(0,D.getFocusStyles)(M);return{wrapper:(0,n.css)({"&:focus-within":S})}}},11134:(G,O,e)=>{"use strict";e.d(O,{cC:()=>g,cb:()=>h});var t=e(74848),n=e(91e3),i=e(96540),s=e(70416),r=e(13544),f=e(76412),a=e(19727),c=e(9261),o=e(27746);const h=["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"];class g extends i.PureComponent{constructor(y){super(y),this.onChangeSelect=d=>{const{onIntervalChanged:v}=this.props;v&&d.value!=null&&v(d.value)}}static{this.offOption={label:"Off",value:"",ariaLabel:"Turn off auto refresh"}}static{this.liveOption={label:"Live",value:"LIVE",ariaLabel:"Turn on live streaming"}}static{this.autoOption={label:"Auto",value:"auto",ariaLabel:"Select refresh from the query range"}}static{this.isLive=y=>y===g.liveOption.value}getVariant(){return this.props.isLive||this.props.primary?"primary":this.props.isOnCanvas?"canvas":"default"}render(){const{onRefresh:y,intervals:d,tooltip:v,value:u,text:D,isLoading:P,noIntervalPicker:x,width:E,showAutoInterval:C}=this.props,M=u||"",S=this.getVariant(),I=p({intervals:d,showAutoInterval:C}),T=I.find(({value:V})=>V===M),b=l(g.offOption.value);let R=T||b;R.label===b.label&&(R={value:""});const A=R.ariaLabel,L=(0,f.t)("refresh-picker.aria-label.duration-selected","Choose refresh time interval with current interval {{durationAriaLabel}} selected",{durationAriaLabel:A}),U=(0,f.t)("refresh-picker.aria-label.choose-interval","Auto refresh turned off. Choose refresh time interval"),W=R.value===""?U:L,w=(0,f.t)("refresh-picker.tooltip.interval-selected","Set auto refresh interval"),N=(0,f.t)("refresh-picker.tooltip.turned-off","Auto refresh off"),B=R.value===""?N:w;return(0,t.jsxs)(a.e,{className:"refresh-picker",children:[(0,t.jsx)(o.I,{"aria-label":D,tooltip:v,onClick:y,variant:S,icon:P?"spinner":"sync",style:E?{width:E}:void 0,"data-testid":r.Tp.components.RefreshPicker.runButtonV2,children:D}),!x&&(0,t.jsx)(c.f,{value:R,options:I,onChange:this.onChangeSelect,variant:S,"data-testid":r.Tp.components.RefreshPicker.intervalButtonV2,"aria-label":W,tooltip:B})]})}}function l(m){switch(m){case g.liveOption.value:return{label:(0,f.t)("refresh-picker.live-option.label","Live"),value:m,ariaLabel:(0,f.t)("refresh-picker.live-option.aria-label","Turn on live streaming")};case g.offOption.value:return{label:(0,f.t)("refresh-picker.off-option.label","Off"),value:m,ariaLabel:(0,f.t)("refresh-picker.off-option.aria-label","Turn off auto refresh")};case g.autoOption.value:return{label:(0,f.t)("refresh-picker.auto-option.label",g.autoOption.label),value:m,ariaLabel:(0,f.t)("refresh-picker.auto-option.aria-label",g.autoOption.ariaLabel)}}return{label:m,value:m}}function p({intervals:m=h,showAutoInterval:y=!1}={}){const d=m.map(v=>{const u=(0,s.E9)(v),D=(0,n.a)(u);return{label:v,value:v,ariaLabel:D}});return y&&d.unshift(l(g.autoOption.value)),d.unshift(l(g.offOption.value)),d}},44522:(G,O,e)=>{"use strict";e.d(O,{I:()=>i});var t=e(96540),n=e(80997);function i({component:s,content:r,...f}){return t.createElement(s||"span",{dangerouslySetInnerHTML:{__html:n.sQ.sanitize(r)},...f})}},56286:(G,O,e)=>{"use strict";e.d(O,{L:()=>c});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(55852),f=e(90090);const a=()=>({noRadiusInput:(0,n.css)({borderBottomRightRadius:"0 !important",borderTopRightRadius:"0 !important"}),noRadiusButton:(0,n.css)({borderBottomLeftRadius:"0 !important",borderTopLeftRadius:"0 !important"})}),c=({label:o="Password",labelWidth:h,inputWidth:g=12,onReset:l,isConfigured:p,tooltip:m,placeholder:y="Password",interactive:d,...v})=>{const u=a();return(0,t.jsx)(f.z,{label:o,tooltip:m,interactive:d,labelWidth:h,inputEl:p?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("input",{type:"text",className:(0,n.cx)(`gf-form-input width-${g}`,u.noRadiusInput),disabled:!0,value:"configured",...(0,i.omit)(v,"value")}),(0,t.jsx)(r.$n,{onClick:l,variant:"secondary",type:"button",children:"Reset"})]}):(0,t.jsx)("input",{type:"password",className:`gf-form-input width-${g}`,placeholder:y,...v})})};c.displayName="SecretFormField"},9226:(G,O,e)=>{"use strict";e.d(O,{L4:()=>a});var t=e(74848),n=e(55852),i=e(10354),s=e(67061);const r="configured",f="Reset",a=({isConfigured:c,onReset:o,...h})=>(0,t.jsxs)(s.B,{children:[!c&&(0,t.jsx)(i.p,{...h,type:"password"}),c&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.p,{...h,type:"text",disabled:!0,value:r}),(0,t.jsx)(n.$n,{onClick:o,variant:"secondary",children:f})]})]})},49718:(G,O,e)=>{"use strict";e.d(O,{L:()=>t.L4});var t=e(9226)},58724:(G,O,e)=>{"use strict";e.d(O,{lp:()=>g});var t=e(74848),n=e(32196),i=e(40845),s=e(55852),r=e(90613),f=e(67061),a=e(21744);const c="configured",o="Reset",h=l=>({configuredStyle:(0,n.css)({minHeight:l.spacing(l.components.height.md),paddingTop:l.spacing(.5),resize:"none"})}),g=({isConfigured:l,onReset:p,...m})=>{const y=(0,i.of)(h);return(0,t.jsxs)(f.B,{children:[(0,t.jsxs)(r.a,{children:[!l&&(0,t.jsx)(a.f,{...m}),l&&(0,t.jsx)(a.f,{...m,rows:1,disabled:!0,value:c,className:(0,n.cx)(y.configuredStyle)})]}),l&&(0,t.jsx)(s.$n,{onClick:p,variant:"secondary",children:o})]})}},7968:(G,O,e)=>{"use strict";e.d(O,{l:()=>t.lp});var t=e(58724)},38401:(G,O,e)=>{"use strict";e.d(O,{Y:()=>h});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(40845),f=e(76892),a=e(13102),c=e(86997),o=e(2336);function h({options:g,value:l,onChange:p,Component:m,className:y,allowCustomValue:d,allowEmptyValue:v,placeholder:u,disabled:D,inputMinWidth:P,inputPlaceholder:x,onExpandedChange:E,autofocus:C=!1,...M}){const[S,I,T,b]=(0,o.Q)(C,E),R=P?Math.max(P,I):I,A=(0,r.of)(c.m);if(!T){const L=(0,i.isObject)(l)?l.label:l,U=L!=null?String(L):void 0;return(0,t.jsx)(S,{disabled:D,Component:m||(0,t.jsx)(f.c,{className:(0,n.cx)(A.segment,{[A.queryPlaceholder]:u!==void 0&&!l,[A.disabled]:D},y),children:U||u})})}return(0,t.jsx)(a.a,{...M,value:l&&!(0,i.isObject)(l)?{value:l}:l,placeholder:x,options:g,width:R,onClickOutside:()=>b(!1),allowCustomValue:d,allowEmptyValue:v,onChange:L=>{b(!1),p(L)}})}},83684:(G,O,e)=>{"use strict";e.d(O,{s:()=>l});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(41053),f=e(40845),a=e(76412),c=e(76892),o=e(13102),h=e(86997),g=e(2336);function l({value:m,onChange:y,loadOptions:d,reloadOptionsOnChange:v=!1,Component:u,className:D,allowCustomValue:P,allowEmptyValue:x,disabled:E,placeholder:C,inputMinWidth:M,inputPlaceholder:S,autofocus:I=!1,onExpandedChange:T,noOptionMessageHandler:b=p,...R}){const[A,L]=(0,r.A)(d,[d]),[U,W,w,N]=(0,g.Q)(I,T),B=M?Math.max(M,W):W,V=(0,f.of)(h.m);if(!w){const K=(0,i.isObject)(m)?m.label:m,H=K!=null?String(K):void 0;return(0,t.jsx)(U,{onClick:v?void 0:L,disabled:E,Component:u||(0,t.jsx)(c.c,{className:(0,n.cx)(V.segment,{[V.queryPlaceholder]:C!==void 0&&!m,[V.disabled]:E},D),children:H||C})})}return(0,t.jsx)(o.a,{...R,value:m&&!(0,i.isObject)(m)?{value:m}:m,placeholder:S,options:A.value??[],loadOptions:v?L:void 0,width:B,noOptionsMessage:b(A),allowCustomValue:P,allowEmptyValue:x,onClickOutside:()=>{N(!1)},onChange:K=>{N(!1),y(K)}})}function p(m){return m.loading?(0,a.t)("grafana-ui.segment-async.loading","Loading options..."):m.error?(0,a.t)("grafana-ui.segment-async.error","Failed to load options"):(0,a.t)("grafana-ui.segment-async.no-options","No options found")}},57752:(G,O,e)=>{"use strict";e.d(O,{o:()=>g});var t=e(74848),n=e(32196),i=e(96540),s=e(37151),r=e(40845),f=e(29413),a=e(76892),c=e(86997),o=e(2336);const h=14;function g({value:l,onChange:p,Component:m,className:y,placeholder:d,inputPlaceholder:v,disabled:u,autofocus:D=!1,onExpandedChange:P,...x}){const E=(0,i.useRef)(null),[C,M]=(0,i.useState)(l),[S,I]=(0,i.useState)((0,f.kD)((l||"").toString(),h).width),[T,,b,R]=(0,o.Q)(D,P),A=(0,r.of)(c.m);if((0,s.A)(E,()=>{R(!1),p(C)}),!b)return(0,t.jsx)(T,{disabled:u,Component:m||(0,t.jsx)(a.c,{className:(0,n.cx)(A.segment,{[A.queryPlaceholder]:d!==void 0&&!C,[A.disabled]:u},y),children:l||d})});const L=(0,n.css)({width:`${Math.max(S+20,32)}px`});return(0,t.jsx)("input",{...x,ref:E,autoFocus:!0,className:(0,n.cx)("gf-form gf-form-input",L),value:C,placeholder:v,onChange:U=>{const{width:W}=(0,f.kD)(U.target.value,h);I(W),M(U.target.value)},onBlur:()=>{R(!1),p(C)},onKeyDown:U=>{[13,27].includes(U.keyCode)&&(R(!1),p(C))}})}},64765:(G,O,e)=>{"use strict";e.d(O,{L:()=>f});var t=e(74848),n=e(32196),i=e(40845),s=e(39268),r=e(76892);const f=({label:c,htmlFor:o,children:h,fill:g})=>{const l=(0,i.of)(a);return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(s.C,{children:[(0,t.jsx)(r.c,{htmlFor:o,width:12,className:l.label,children:c}),h,g&&(0,t.jsx)("div",{className:l.fill,children:(0,t.jsx)(r.c,{children:""})})]})})},a=c=>({label:(0,n.css)({color:c.colors.primary.text}),fill:(0,n.css)({flexGrow:1,marginBottom:c.spacing(.5)})})},13102:(G,O,e)=>{"use strict";e.d(O,{a:()=>r});var t=e(74848),n=e(96540),i=e(40845),s=e(90182);function r({value:f,placeholder:a="",options:c=[],onChange:o,onClickOutside:h,loadOptions:g=void 0,width:l,noOptionsMessage:p="",allowCustomValue:m=!1,allowEmptyValue:y=!1,...d}){const v=(0,n.useRef)(null),u=(0,i.$j)();let D=l>0?l/u.spacing.gridSize:void 0,P,x={};return g?(P=s.DW,x={loadOptions:g,defaultOptions:!0}):P=s.l6,(0,t.jsx)("div",{...d,ref:v,children:(0,t.jsx)(P,{width:D,noOptionsMessage:p,placeholder:a,autoFocus:!0,isOpen:!0,onChange:o,options:c,value:f,closeMenuOnSelect:!1,onCloseMenu:()=>{if(v&&v.current){const E=v.current.querySelector('input[id^="react-select-"]');E&&(E.value||y)?o({value:E.value,label:E.value}):h()}},allowCustomValue:m,...x})})}},86997:(G,O,e)=>{"use strict";e.d(O,{m:()=>n});var t=e(32196);const n=i=>{const s="v1"in i?i.v1.palette:i.palette;return{segment:(0,t.css)({cursor:"pointer",width:"auto"}),queryPlaceholder:(0,t.css)({color:s.gray2}),disabled:(0,t.css)({cursor:"not-allowed",opacity:.65,boxShadow:"none"})}}},2336:(G,O,e)=>{"use strict";e.d(O,{Q:()=>r});var t=e(74848),n=e(96540),i=e(40845),s=e(55852);const r=(f,a)=>{const c=(0,n.useRef)(null),o=(0,i.of)(s.my),[h,g]=(0,n.useState)(f),[l,p]=(0,n.useState)(0),m=d=>{g(d),a&&a(d)};return[({Component:d,onClick:v,disabled:u})=>(0,t.jsx)("button",{type:"button",className:o,ref:c,disabled:u,onClick:()=>{m(!0),c&&c.current&&p(c.current.clientWidth*1.25),v?.()},children:d}),l,h,m]}},5342:(G,O,e)=>{"use strict";e.d(O,{O:()=>r,p:()=>f});var t=e(74848),n=e(40845),i=e(29158),s=e(88824);const r=({innerProps:a,children:c})=>{const o=(0,n.$j)(),h=(0,s.J)(o);return(0,t.jsx)("div",{...a,className:h.multiValueContainer,children:c})},f=({children:a,innerProps:c})=>{const o=(0,n.$j)(),h=(0,s.J)(o);return(0,t.jsx)(i.K,{...c,name:"times",size:"sm",className:h.multiValueRemove,tooltip:"Remove"})}},90182:(G,O,e)=>{"use strict";e.d(O,{Iv:()=>j,DW:()=>Y,gZ:()=>se,KF:()=>k,l6:()=>X,KA:()=>E.K,ip:()=>Z});var t=e(74848),n=e(72635),i=e(96540),s=e(46005),r=e(8539),f=e(93943),a=e(66963),c=e(50877),o=e(40845),h=e(14578),g=e(62930),l=e(28581);const p=q=>{let ne;return"data-testid"in q.selectProps&&q.selectProps["data-testid"]&&(ne=q.selectProps["data-testid"]+"-input"),(0,t.jsx)(l.c.Input,{...q,"data-testid":ne})};function m({selectProps:q}){const ne=q.menuIsOpen,oe=ne?"search":"angle-down",z=ne?"sm":"md";return(0,t.jsx)(h.I,{name:oe,size:z})}var y=e(32196),d=e(10354);const v=(0,i.forwardRef)((q,ne)=>{const{children:oe}=q,z=(0,o.$j)(),te=(0,d.n)({theme:z,invalid:!1});return(0,t.jsx)("div",{className:(0,y.cx)(te.suffix,(0,y.css)({position:"relative"})),ref:ne,children:oe})});v.displayName="IndicatorsContainer";var u=e(87266);const D=(0,i.forwardRef)(function({focused:ne,invalid:oe,disabled:z,children:te,innerProps:le,prefix:ie,...ae},re){const ce=(0,o.of)(P,oe,!!ie);return(0,t.jsxs)("div",{className:ce.input,...le,ref:re,children:[ie&&(0,t.jsx)("div",{className:(0,y.cx)(ce.prefix),children:ie}),te]})}),P=(q,ne,oe)=>{const z=(0,d.n)({theme:q,invalid:ne});return{input:(0,y.cx)((0,u.g$)(q),(0,y.css)({width:"100%",maxWidth:"100%",display:"flex",flexDirection:"row",alignItems:"center",flexWrap:"wrap",justifyContent:"space-between",paddingRight:0,position:"relative",boxSizing:"border-box"}),oe&&(0,y.css)({paddingLeft:0})),prefix:(0,y.cx)(z.prefix,(0,y.css)({position:"relative"}))}};var x=e(5342),E=e(4603),C=e(12681),M=e(88824);const S=({children:q,cx:ne,getClassNames:oe,getStyles:z,Heading:te,headingProps:le,label:ie,selectProps:ae,theme:re})=>{const ce=(0,o.of)(M.J);return(0,t.jsxs)("div",{className:ce.group,children:[(0,t.jsx)(te,{cx:ne,getClassNames:oe,getStyles:z,selectProps:ae,theme:re,...le,children:ie}),q]})};var I=e(94753);const T=q=>{const ne=(0,o.of)(M.J);return(0,t.jsx)("div",{className:ne.groupHeader,children:(0,t.jsx)(I.E,{weight:"bold",variant:"bodySmall",color:"secondary",children:q.children??""})})};var b=e(62235);class R extends i.Component{render(){const{children:ne}=this.props,{selectProps:oe}=this.props;if(oe&&Array.isArray(ne)&&Array.isArray(ne[0])&&oe.maxVisibleValues!==void 0&&!(oe.showAllSelectedWhenOpen&&oe.menuIsOpen)){const[z,...te]=ne,le=z.slice(0,oe.maxVisibleValues);return this.renderContainer([le,...te])}return this.renderContainer(ne)}renderContainer(ne){const{isMulti:oe,theme:z,selectProps:te}=this.props,le=this.props.selectProps?.noMultiValueWrap&&!this.props.selectProps?.menuIsOpen,ie=(0,M.J)(z),ae=te["data-testid"],re=(0,y.cx)(ie.valueContainer,{[ie.valueContainerMulti]:oe&&!le,[ie.valueContainerMultiNoWrap]:oe&&le});return(0,t.jsx)("div",{"data-testid":ae,className:re,children:ne})}}const A=(0,o.cV)(R);var L=e(23731);const U=(q,ne)=>{if(Array.isArray(q)){const oe=q.filter(Boolean);return oe?.length?oe:void 0}if(typeof q=="object")return[q];if(typeof q=="string"||typeof q=="number"){const oe=W(q,ne);if(oe)return[oe]}},W=(q,ne)=>{for(const oe of ne)if("options"in oe){let z=W(q,oe.options);if(z)return z}else if("value"in oe&&oe.value===q)return oe;return null},w=q=>q.map(({description:ne,...oe})=>oe),N=q=>{const{children:ne,innerProps:oe,selectProps:{menuIsOpen:z,onMenuClose:te,onMenuOpen:le},isFocused:ie,isMulti:ae,getValue:re,innerRef:ce}=q,me=q.selectProps;return me.renderControl?i.createElement(me.renderControl,{isOpen:z,value:ae?re():re()[0],ref:ce,onClick:z?te:le,onBlur:te,disabled:!!me.disabled,invalid:!!me.invalid}):(0,t.jsx)(D,{ref:ce,innerProps:oe,prefix:me.prefix,focused:ie,invalid:!!me.invalid,disabled:!!me.disabled,children:ne})};function B({allowCustomValue:q=!1,allowCreateWhileLoading:ne=!1,"aria-label":oe,"data-testid":z,autoFocus:te=!1,backspaceRemovesValue:le=!0,blurInputOnSelect:ie,cacheOptions:ae,className:re,closeMenuOnSelect:ce=!0,components:me,createOptionPosition:ee="last",defaultOptions:de,defaultValue:De,disabled:fe=!1,filterOption:Te,formatCreateLabel:je,getOptionLabel:He,getOptionValue:Be,inputValue:Ne,invalid:Re,isClearable:Se=!1,id:We,isLoading:Ke=!1,isMulti:Xe=!1,inputId:Je,isOpen:st,isOptionDisabled:pt,isSearchable:xt=!0,loadOptions:ot,loadingMessage:$e="Loading options...",maxMenuHeight:ve=300,minMenuHeight:be,maxVisibleValues:he,menuPlacement:ye="auto",menuPosition:Pe,menuShouldPortal:ge=!0,noOptionsMessage:xe=(0,n.t)("grafana-ui.select.no-options-label","No options found"),onBlur:Ae,onChange:Ee,onCloseMenu:Ie,onCreateOption:Qe,onInputChange:at,onKeyDown:ft,onMenuScrollToBottom:ct,onMenuScrollToTop:vt,onOpenMenu:Pt,onFocus:Vt,openMenuOnFocus:Jt=!1,options:wt=[],placeholder:zt=(0,n.t)("grafana-ui.select.placeholder","Choose"),prefix:on,renderControl:Pn,showAllSelectedWhenOpen:_n=!0,tabSelectsValue:Cn=!0,value:Ye,virtualized:Dt=!1,noMultiValueWrap:yt,width:Ft,isValidNewOption:an,formatOptionLabel:un,hideSelectedOptions:hn,...Un}){const Nn=(0,o.$j)(),St=(0,M.J)(Nn),nn=(0,i.useRef)(null),[ht,lt]=(0,i.useState)(!1),gt=(0,L.z)(Nn,Ft),[$t,et]=(0,i.useState)(!!Ne);(0,i.useEffect)(()=>{if(ot&&st&&nn.current&&nn.current.controlRef&&ye==="auto"){const En=window.innerHeight-nn.current.controlRef.getBoundingClientRect().bottom;lt(En<ve)}},[ve,ye,ot,st]);const Et=(0,i.useCallback)((En,wn)=>{if(Xe&&En==null)return Ee([],wn);Ee(En,wn)},[Xe,Ee]);let It=s.Ay;const Qt={};let sn={},ln;if(Xe&&ot)ln=Ye;else if(Xe&&Ye&&Array.isArray(Ye)&&!ot)ln=Ye.map(En=>{const wn=W(En.value??En,wt);return wn||(typeof En=="string"?(0,c.z)(En):En)});else if(ot){const En=De||Ye;ln=En?[En]:[]}else ln=U(Ye,wt);const yn={"aria-label":oe,"data-testid":z,autoFocus:te,backspaceRemovesValue:le,blurInputOnSelect:ie,captureMenuScroll:ct||vt,closeMenuOnSelect:ce,defaultValue:De,disabled:fe,filterOption:$t?Te:null,getOptionLabel:He,getOptionValue:Be,hideSelectedOptions:hn,inputValue:Ne,invalid:Re,isClearable:Se,id:We,isDisabled:fe,isLoading:Ke,isMulti:Xe,inputId:Je,isOptionDisabled:pt,isSearchable:xt,maxMenuHeight:ve,minMenuHeight:be,maxVisibleValues:he,menuIsOpen:st,menuPlacement:ye==="auto"&&ht?"top":ye,menuPosition:Pe,menuShouldBlockScroll:!0,menuPortalTarget:ge&&typeof document<"u"?document.body:void 0,menuShouldScrollIntoView:!1,onBlur:Ae,onChange:Et,onInputChange:(En,wn)=>{const On=at?.(En,wn)??En,Rt=!!On;return Rt!==$t&&et(Rt),On},onKeyDown:ft,onMenuClose:Ie,onMenuOpen:Pt,onMenuScrollToBottom:ct,onMenuScrollToTop:vt,onFocus:Vt,formatOptionLabel:un,openMenuOnFocus:Jt,options:Dt?w(wt):wt,placeholder:zt,prefix:on,renderControl:Pn,showAllSelectedWhenOpen:_n,tabSelectsValue:Cn,value:Xe?ln:ln?.[0],noMultiValueWrap:yt};q&&(It=a.A,Qt.allowCreateWhileLoading=ne,Qt.formatCreateLabel=je??V,Qt.onCreateOption=Qe,Qt.createOptionPosition=ee,Qt.isValidNewOption=an),ot&&(It=q?f.A:r.A,sn={loadOptions:ot,cacheOptions:ae,defaultOptions:de});const Sn=Dt?C.zd:C.eB;return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(It,{ref:nn,components:{MenuList:Sn,Group:S,GroupHeading:T,ValueContainer:A,IndicatorsContainer:K,IndicatorSeparator:H,Control:N,Option:C.o5,ClearIndicator(En){const{clearValue:wn}=En;return(0,t.jsx)(h.I,{name:"times",role:"button","aria-label":"select-clear-value",className:St.singleValueRemove,onMouseDown:On=>{On.preventDefault(),On.stopPropagation(),wn()}})},LoadingIndicator(){return(0,t.jsx)(g.y,{inline:!0})},LoadingMessage(){return(0,t.jsx)("div",{className:St.loadingMessage,children:$e})},NoOptionsMessage(){return(0,t.jsx)("div",{className:St.loadingMessage,"aria-label":"No options provided",children:xe})},DropdownIndicator:m,SingleValue(En){return(0,t.jsx)(b.K,{...En,isDisabled:fe})},SelectContainer:E.K,MultiValueContainer:x.O,MultiValueRemove:fe?()=>null:x.p,Input:p,...me},styles:gt,className:re,...yn,...Qt,...sn,...Un})})}function V(q){return(0,t.jsxs)("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[(0,t.jsx)("div",{children:q}),(0,t.jsx)("div",{style:{flexGrow:1}}),(0,t.jsx)("div",{className:"muted small",style:{display:"flex",gap:"8px",alignItems:"center"},children:"Hit enter to add"})]})}function K(q){const{showAllSelectedWhenOpen:ne,maxVisibleValues:oe,menuIsOpen:z}=q.selectProps,te=q.getValue();if(oe!==void 0&&Array.isArray(q.children)){const le=te.length;if(le>oe&&!(ne&&z)){const ie=[...q.children];return ie.splice(-1,0,(0,t.jsxs)("span",{id:"excess-values",children:["(+",le-oe,")"]},"excess-values")),(0,t.jsx)(v,{...q,children:ie})}}return(0,t.jsx)(v,{...q})}function H(){return(0,t.jsx)(t.Fragment,{})}function X(q){return(0,t.jsx)(B,{...q})}function k(q){return(0,t.jsx)(B,{...q,isMulti:!0})}function Y(q){return(0,t.jsx)(B,{...q})}function Z(q){return(0,t.jsx)(B,{virtualized:!0,...q})}function se(q){return(0,t.jsx)(B,{virtualized:!0,...q})}function j(q){return(0,t.jsx)(B,{...q,isMulti:!0})}},4603:(G,O,e)=>{"use strict";e.d(O,{K:()=>c});var t=e(74848),n=e(32196),i=e(28581),s=e(40845),r=e(16797),f=e(87266),a=e(10354);const c=h=>{const{isDisabled:g,isFocused:l,children:p,selectProps:{invalid:m=!1}}=h,y=(0,s.of)(o,l,g,m);return(0,t.jsx)(i.c.SelectContainer,{...h,className:(0,n.cx)(y.wrapper,h.className),children:p})},o=(h,g,l,p)=>{const m=(0,a.n)({theme:h,invalid:p});return{wrapper:(0,n.cx)(m.wrapper,(0,f.Xb)(h,p),g&&(0,n.css)((0,r.getFocusStyles)(h)),l&&m.inputDisabled,(0,n.css)({position:"relative",boxSizing:"border-box",flexDirection:"row",flexWrap:"wrap",alignItems:"stretch",justifyContent:"space-between",minHeight:"32px",height:"auto",maxWidth:"100%",padding:0,cursor:l?"not-allowed":"pointer"}))}}},12681:(G,O,e)=>{"use strict";e.d(O,{eB:()=>p,o5:()=>P,zd:()=>u});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(96540),f=e(91793),a=e(8887),c=e(13544),o=e(40845),h=e(40276),g=e(14578),l=e(88824);const p=({children:x,maxHeight:E,innerRef:C,innerProps:M})=>{const S=(0,o.$j)(),I=(0,l.J)(S);return(0,t.jsx)("div",{...M,className:I.menu,style:{maxHeight:E},"aria-label":"Select options menu",children:(0,t.jsx)(h.E,{scrollRefCallback:C,autoHide:!1,autoHeightMax:"inherit",hideHorizontalTrack:!0,children:x})})};p.displayName="SelectMenu";const m=37,y=8,d=8,v=36,u=({children:x,maxHeight:E,innerRef:C,options:M,focusedOption:S})=>{const I=(0,o.$j)(),T=(0,l.J)(I),b=(0,r.useRef)(null),R=(0,r.useMemo)(()=>M.flatMap(N=>N.options?[N,...N.options]:[N]),[M]),A=R.findIndex(N=>N.value===S?.value);if((0,r.useLayoutEffect)(()=>{b.current?.scrollToItem(A)},[A]),!Array.isArray(x))return null;const L=x.flatMap((N,B)=>D(N)?[r.cloneElement(N,{children:null}),...N.props.children.slice(0,-1),r.cloneElement(N.props.children.at(-1),{innerProps:{style:{borderBottom:`1px solid ${I.colors.border.weak}`,height:m}}})]:[N]),W=((0,i.max)(R.map(N=>N.label?.length))??0)*y+d*2+v,w=Math.min(L.length*m,E);return(0,t.jsx)(f.Y1,{outerRef:C,ref:b,className:T.menu,height:w,width:W,"aria-label":"Select options menu",itemCount:L.length,itemSize:m,children:({index:N,style:B})=>(0,t.jsx)("div",{style:{...B,overflow:"hidden"},children:L[N]})})},D=x=>r.isValidElement(x)&&Array.isArray(x.props.children);u.displayName="VirtualizedSelectMenu";const P=({children:x,data:E,innerProps:C,innerRef:M,isFocused:S,isSelected:I,renderOptionLabel:T})=>{const b=(0,o.$j)(),R=(0,l.J)(b),A=E.icon?(0,a.Uo)(E.icon):void 0,{onMouseMove:L,onMouseOver:U,...W}=C;return(0,t.jsxs)("div",{ref:M,className:(0,n.cx)(R.option,S&&R.optionFocused,I&&R.optionSelected,E.isDisabled&&R.optionDisabled),...W,"data-testid":c.Tp.components.Select.option,title:E.title,children:[A&&(0,t.jsx)(g.I,{name:A,className:R.optionIcon}),E.imgUrl&&(0,t.jsx)("img",{className:R.optionImage,src:E.imgUrl,alt:E.label||String(E.value)}),(0,t.jsxs)("div",{className:R.optionBody,children:[(0,t.jsx)("span",{children:T?T(E):x}),E.description&&(0,t.jsx)("div",{className:R.optionDescription,children:E.description}),E.component&&(0,t.jsx)(E.component,{})]})]})};P.displayName="SelectMenuOptions"},62235:(G,O,e)=>{"use strict";e.d(O,{K:()=>p});var t=e(74848),n=e(32196),i=e(28581),s=e(8887),r=e(40845),f=e(96540);function a(y,d={}){const{duration:v=250,delay:u=250}=d,[D,P]=(0,f.useState)(y),x=(0,f.useRef)();return(0,f.useEffect)(()=>{let E;if(y)E=setTimeout(()=>{x.current=new Date,P(y)},u);else{const C=x.current?Date.now()-x.current.valueOf():0,M=()=>{x.current=void 0,P(y)};C>=v?M():E=setTimeout(M,v-C)}return()=>{E&&(clearTimeout(E),E=void 0)}},[y,v,u]),D}var c=e(14578),o=e(62930),h=e(31511),g=e(72960);const l=y=>({singleValue:(0,n.css)({label:"singleValue",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",boxSizing:"border-box",maxWidth:"100%",gridArea:"1 / 1 / 2 / 3"}),spinnerWrapper:(0,n.css)({width:"16px",height:"16px",display:"inline-block",marginRight:"10px",position:"relative",verticalAlign:"middle",overflow:"hidden"}),spinnerIcon:(0,n.css)({width:"100%",height:"100%",position:"absolute"}),optionIcon:(0,n.css)({marginRight:y.spacing(1),color:y.colors.text.secondary}),disabled:(0,n.css)({color:y.colors.text.disabled}),isOpen:(0,n.css)({color:y.colors.text.disabled})}),p=y=>{const{children:d,data:v,isDisabled:u}=y,D=(0,r.of)(l),P=a(v.loading||!1,{delay:250,duration:750}),x=v.icon?(0,s.Uo)(v.icon):void 0;return(0,t.jsxs)(i.c.SingleValue,{...y,className:(0,n.cx)(D.singleValue,u&&D.disabled,y.selectProps.menuIsOpen&&D.isOpen),children:[v.imgUrl?(0,t.jsx)(m,{loading:P,imgUrl:v.imgUrl,styles:D,alt:String(v.label??v.value)}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.n,{horizontal:!0,size:16,visible:P,duration:150,children:(0,t.jsx)("div",{className:D.spinnerWrapper,children:(0,t.jsx)(o.y,{className:D.spinnerIcon,inline:!0})})}),x&&(0,t.jsx)(c.I,{name:x,role:"img",className:D.optionIcon})]}),!v.hideText&&d]})},m=y=>(0,t.jsxs)("div",{className:y.styles.spinnerWrapper,children:[(0,t.jsx)(h.A,{duration:150,visible:y.loading,children:(0,t.jsx)(o.y,{className:y.styles.spinnerIcon,inline:!0})}),(0,t.jsx)(h.A,{duration:150,visible:!y.loading,children:(0,t.jsx)("img",{className:y.styles.spinnerIcon,src:y.imgUrl,alt:y.alt})})]})},88824:(G,O,e)=>{"use strict";e.d(O,{J:()=>i});var t=e(32196),n=e(3911);const i=(0,n.N)(s=>({menu:(0,t.css)({label:"grafana-select-menu",background:s.components.dropdown.background,boxShadow:s.shadows.z3,position:"relative",minWidth:"100%",zIndex:1}),option:(0,t.css)({label:"grafana-select-option",padding:"8px",position:"relative",display:"flex",alignItems:"center",flexDirection:"row",flexShrink:0,whiteSpace:"nowrap",cursor:"pointer",borderLeft:"2px solid transparent","&:hover":{background:s.colors.action.hover,"@media (forced-colors: active), (prefers-contrast: more)":{border:`1px solid ${s.colors.primary.border}`}}}),optionIcon:(0,t.css)({marginRight:s.spacing(1)}),optionImage:(0,t.css)({label:"grafana-select-option-image",width:"16px",marginRight:"10px"}),optionDescription:(0,t.css)({label:"grafana-select-option-description",fontWeight:"normal",fontSize:s.typography.size.sm,color:s.colors.text.secondary,whiteSpace:"normal",lineHeight:s.typography.body.lineHeight}),optionBody:(0,t.css)({label:"grafana-select-option-body",display:"flex",fontWeight:s.typography.fontWeightMedium,flexDirection:"column",flexGrow:1}),optionFocused:(0,t.css)({label:"grafana-select-option-focused",background:s.colors.action.focus,"@media (forced-colors: active), (prefers-contrast: more)":{border:`1px solid ${s.colors.primary.border}`}}),optionSelected:(0,t.css)({background:s.colors.action.selected,"&::before":{backgroundImage:s.colors.gradients.brandVertical,borderRadius:s.shape.radius.default,content:'" "',display:"block",height:"100%",position:"absolute",transform:"translateX(-50%)",width:s.spacing(.5),left:0}}),optionDisabled:(0,t.css)({label:"grafana-select-option-disabled",backgroundColor:s.colors.action.disabledBackground,color:s.colors.action.disabledText,cursor:"not-allowed"}),singleValue:(0,t.css)({label:"grafana-select-single-value",color:s.components.input.text,gridArea:"1 / 1 / 2 / 3",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",boxSizing:"border-box",maxWidth:"100%"}),valueContainer:(0,t.css)({label:"grafana-select-value-container",alignItems:"center",display:"grid",position:"relative",boxSizing:"border-box",flex:"1 1 0%",outline:"none",overflow:"hidden"}),valueContainerMulti:(0,t.css)({label:"grafana-select-value-container-multi",flexWrap:"wrap",display:"flex"}),valueContainerMultiNoWrap:(0,t.css)({display:"grid",gridAutoFlow:"column"}),loadingMessage:(0,t.css)({label:"grafana-select-loading-message",padding:s.spacing(1),textAlign:"center",width:"100%"}),multiValueContainer:(0,t.css)({label:"grafana-select-multi-value-container",display:"flex",alignItems:"center",lineHeight:1,background:s.colors.background.secondary,borderRadius:s.shape.radius.default,margin:s.spacing(.25,1,.25,0),padding:s.spacing(.25,0,.25,1),color:s.colors.text.primary,fontSize:s.typography.size.sm,overflow:"hidden",whiteSpace:"nowrap","&:hover":{background:s.colors.emphasize(s.colors.background.secondary)}}),multiValueRemove:(0,t.css)({label:"grafana-select-multi-value-remove",margin:s.spacing(0,.5),cursor:"pointer",svg:{marginBottom:0}}),singleValueRemove:(0,t.css)({cursor:"pointer","&:hover":{color:s.colors.text.primary}}),groupHeader:(0,t.css)({padding:s.spacing(1,1,1,.75),borderLeft:"2px solid transparent"}),group:(0,t.css)({"&:not(:first-child)":{borderTop:`1px solid ${s.colors.border.weak}`},':has(+ [role="option"])':{borderBottom:`1px solid ${s.colors.border.weak}`}})}))},23731:(G,O,e)=>{"use strict";e.d(O,{A:()=>n,z:()=>i});var t=e(96540);function n(s){return{clearIndicator:()=>({}),container:()=>({}),control:()=>({}),dropdownIndicator:()=>({}),group:()=>({}),groupHeading:()=>({}),indicatorsContainer:()=>({}),indicatorSeparator:()=>({}),input:function(r){return{...r,color:"inherit",margin:0,padding:0,zIndex:1,overflow:"hidden"}},loadingIndicator:()=>({}),loadingMessage:()=>({}),menu:()=>({}),menuList:({maxHeight:r})=>({maxHeight:r}),multiValue:()=>({}),multiValueLabel:()=>({overflow:"hidden",textOverflow:"ellipsis"}),multiValueRemove:()=>({}),noOptionsMessage:()=>({}),option:()=>({}),placeholder:r=>({...r,color:s.colors.text.secondary}),singleValue:()=>({}),valueContainer:()=>({})}}function i(s,r){return(0,t.useMemo)(()=>({...n(s),menuPortal:f=>({...f,zIndex:s.zIndex.portal}),menu:({top:f,bottom:a,position:c})=>({top:f,bottom:a,position:c,minWidth:"100%",zIndex:s.zIndex.dropdown}),container:()=>({width:r?s.spacing(r):"100%",display:r==="auto"?"inline-flex":"flex"}),option:(f,a)=>({...f,opacity:a.isDisabled?.5:1})}),[s,r])}},62883:()=>{"use strict"},67570:(G,O,e)=>{"use strict";e.d(O,{u:()=>p});var t=e(2543),n=e.n(t),i=e(96540),s=e(13752),r=e(62467),f=e(11150),a=e(96083),c=e(63720),o=e(59099),h=e(54479),g=e(11134);function l(m){return{label:m,value:stringToMs(m)}}class p extends i.PureComponent{constructor(y){super(y),this.propsSubject=new s.B,this.subscription=null}componentDidMount(){this.subscription=this.propsSubject.pipe((0,c.n)(y=>g.cC.isLive(y.interval)?(0,r.of)({}):y.loading?f.t:(0,a.Y)((0,h.dc)(y.interval))),(0,o.M)(()=>this.props.func())).subscribe(),this.propsSubject.next(this.props)}componentDidUpdate(y){g.cC.isLive(y.interval)&&g.cC.isLive(this.props.interval)||(0,t.isEqual)(y,this.props)||this.propsSubject.next(this.props)}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe(),this.propsSubject.unsubscribe()}render(){return null}}},63250:(G,O,e)=>{"use strict";e.d(O,{I1:()=>v,_$:()=>p,gl:()=>g});var t=e(2543),n=e.n(t),i=e(75059),s=e(47070),r=e(50082),f=e(62398),a=e(24293),c=e(90708),o=e(47737);const h=["reduceOptions","orientation"];function g(u,D,P){let x=u.options;if(u.fieldConfig=u.fieldConfig||{defaults:{},overrides:[]},D==="singlestat"&&P.angular)return l(u,P);for(const E of h)P.hasOwnProperty(E)&&(x[E]=(0,t.cloneDeep)(P[E]));return x}function l(u,D){const P=D.angular,x=i.AS.getIfExists(P.valueName),E={reduceOptions:{calcs:[x?x.id:i.gy.mean]},orientation:s.wV.Horizontal},C={};if(P.format&&(C.unit=P.format),P.tableColumn&&(E.reduceOptions.fields=`/^${P.tableColumn}$/`),P.nullPointMode&&(C.nullValueMode=P.nullPointMode),P.nullText&&(C.noValue=P.nullText),(P.decimals||P.decimals===0)&&(C.decimals=P.decimals),P.thresholds&&P.colors){const S=P.thresholds.split(",").map(T=>Number(T.trim())),I=[];for(const T of P.colors){const b=I.length-1;b>=0?I.push({value:S[b],color:T}):I.push({value:-1/0,color:T})}C.thresholds={mode:r.O.Absolute,steps:I}}const M=(0,f.bh)(P,C.thresholds);return M&&M.length&&(C.mappings=M),P.gauge&&P.gauge.show&&(C.min=P.gauge.minValue,C.max=P.gauge.maxValue),u.fieldConfig.defaults=C,E}function p(u){if(!u.options)return{};const D=parseFloat(u.pluginVersion||"6.1");let P=u.options;D<6.2&&(P=y(P)),D<6.3&&(P=m(P));const{fieldOptions:x}=P;if(D<6.6&&x){if(x&&x.override){const{override:M,...S}=P.fieldOptions;P={...P,fieldOptions:{...S,overrides:[]}}}let E=x?.defaults?.thresholds;E?delete x.defaults.thresholds:(E=x?.thresholds,delete x.thresholds),E&&(x.defaults.thresholds={mode:r.O.Absolute,steps:E});const{defaults:C}=x;C.color&&typeof C.color=="string"&&(C.color={mode:a.Y.Fixed,fixedColor:C.color}),(0,c.BF)(C)}if(D<7&&(u.fieldConfig=u.fieldConfig||{defaults:{},overrides:[]},u.fieldConfig={defaults:x&&x.defaults?{...u.fieldConfig.defaults,...x.defaults}:u.fieldConfig.defaults,overrides:x&&x.overrides?[...u.fieldConfig.overrides,...x.overrides]:u.fieldConfig.overrides},x&&(P.reduceOptions={values:x.values,limit:x.limit,calcs:x.calcs}),delete P.fieldOptions),D<7.1){const E=u.fieldConfig.defaults.title;E!=null&&(u.fieldConfig.defaults.displayName=E,delete u.fieldConfig.defaults.title)}if(D<8){const E=u.fieldConfig?.defaults;let C=E?.unit;C==="percent"?((0,t.isNumber)(E.min)||(E.min=0),(0,t.isNumber)(E.max)||(E.max=100)):C==="percentunit"&&((0,t.isNumber)(E.min)||(E.min=0),(0,t.isNumber)(E.max)||(E.max=1))}return P}function m(u){const{fieldOptions:D}=u;if(!D)return u;const{mappings:P,...x}=u.fieldOptions;let E;return u.thresholds&&(E={mode:r.O.Absolute,steps:d(u.thresholds)}),{...u,fieldOptions:{...x,defaults:{...D.defaults,mappings:P,thresholds:E}}}}function y(u){const{valueOptions:D}=u;if(!D)return u;const P={},x={};if(P.mappings=u.valueMappings,P.thresholds=u.thresholds,P.defaults=x,x.unit=D.unit,x.decimals=D.decimals,D.stat){const C=i.AS.get(D.stat);C&&(P.calcs=[C.id])}x.min=u.minValue,x.max=u.maxValue;const E={...u,fieldOptions:P};return(0,t.omit)(E,"valueMappings","thresholds","valueOptions","minValue","maxValue")}function d(u){if(!u||!u.length)return;const D=u.map(P=>({value:P.value===null?-1/0:P.value,color:P.color}));return(0,o.RU)(D),D[0].value=-1/0,D}function v(u){return(0,f.bh)(u)}},37713:(G,O,e)=>{"use strict";e.d(O,{I1:()=>t.I1,_$:()=>t._$,gl:()=>t.gl});var t=e(63250)},47097:(G,O,e)=>{"use strict";e.d(O,{F:()=>l});var t=e(74848),n=e(32196),i=e(94659),s=e(9821),r=e(96540),f=e(40845),a=e(80427);const c=p=>{const{value:m,children:y,visible:d,placement:v,tipFormatter:u,...D}=p,P=(0,r.useRef)(null),x=(0,r.useRef)(null),E=(0,f.of)(o);function C(){x.current!==null&&cancelAnimationFrame(x.current)}function M(){x.current=requestAnimationFrame(()=>{P.current?.forceAlign()})}return(0,r.useEffect)(()=>(d?M():C(),C),[m,d]),(0,t.jsx)(a.A,{overlayClassName:E.tooltip,placement:v,overlay:u??m,overlayInnerStyle:{minHeight:"auto"},ref:P,visible:d,...D,children:y})},o=p=>({tooltip:(0,n.css)({position:"absolute",display:"block",visibility:"visible",fontSize:p.typography.bodySmall.fontSize,opacity:.9,padding:3,zIndex:p.zIndex.tooltip})}),h=c;var g=e(24849);const l=({min:p,max:m,onChange:y,onAfterChange:d,orientation:v="horizontal",reverse:u,step:D,formatTooltipResult:P,value:x,tooltipAlwaysVisible:E=!0})=>{const C=(0,r.useCallback)(b=>{y?.(typeof b=="number"?[b,b]:b)},[y]),M=(0,r.useCallback)(b=>{d?.(typeof b=="number"?[b,b]:b)},[d]),S=v==="horizontal",I=(0,f.of)(g.$,S),T=(b,R)=>(0,t.jsx)(h,{value:R.value,visible:E||R.dragging,tipFormatter:P?()=>P(R.value):void 0,placement:S?"top":"right",children:b});return(0,t.jsxs)("div",{className:(0,n.cx)(I.container,I.slider),children:[(0,t.jsx)(i.Global,{styles:I.tooltip}),(0,t.jsx)(s.A,{min:p,max:m,step:D,defaultValue:x,range:!0,onChange:C,onChangeComplete:M,vertical:!S,reverse:u,handleRender:T})]})};l.displayName="RangeSlider"},77014:(G,O,e)=>{"use strict";e.d(O,{A:()=>o});var t=e(74848),n=e(32196),i=e(94659),s=e(9821),r=e(96540),f=e(40845),a=e(10354),c=e(24849);const o=({min:h,max:g,onChange:l,onAfterChange:p,orientation:m="horizontal",reverse:y,step:d,value:v,ariaLabelForHandle:u,marks:D,included:P})=>{const x=m==="horizontal",E=(0,f.of)(c.$,x,!!D),C=s.A,[M,S]=(0,r.useState)(v??h),I=(0,r.useCallback)(U=>{const W=typeof U=="number"?U:U[0];S(W),l?.(W)},[S,l]),T=(0,r.useCallback)(U=>{let W=+U.target.value;Number.isNaN(W)&&(W=0),S(W),l&&l(W),p&&p(W)},[l,p]),b=(0,r.useCallback)(U=>{const W=+U.target.value;W>g?S(g):W<h&&S(h)},[g,h]),R=(0,r.useCallback)(U=>{const W=typeof U=="number"?U:U[0];p?.(W)},[p]),A=x?[]:[E.sliderInputVertical],L=x?[]:[E.sliderInputFieldVertical];return(0,t.jsxs)("div",{className:(0,n.cx)(E.container,E.slider),children:[(0,t.jsx)(i.Global,{styles:E.tooltip}),(0,t.jsxs)("div",{className:(0,n.cx)(E.sliderInput,...A),children:[(0,t.jsx)(C,{min:h,max:g,step:d,defaultValue:v,value:M,onChange:I,onChangeComplete:R,vertical:!x,reverse:y,ariaLabelForHandle:u,marks:D,included:P}),(0,t.jsx)(a.p,{type:"text",className:(0,n.cx)(E.sliderInputField,...L),value:M,onChange:T,onBlur:b,min:h,max:g})]})]})};o.displayName="Slider"},24849:(G,O,e)=>{"use strict";e.d(O,{$:()=>s});var t=e(32196),n=e(94659),i=e(12415);const s=(r,f,a=!1)=>{const{spacing:c}=r,o=r.colors.border.strong,h=r.colors.primary.main,g=r.colors.primary.main,p=`box-shadow: 0px 0px 0px 6px ${r.colors.primary.transparent}`;return{container:(0,t.css)({width:"100%",margin:f?"inherit":c(1,3,1,1),paddingBottom:f&&a?r.spacing(1):"inherit",height:f?"auto":"100%"}),slider:(0,t.css)`
      .rc-slider {
        display: flex;
        flex-grow: 1;
        margin-left: 7px; // half the size of the handle to align handle to the left on 0 value
      }
      .rc-slider-mark {
        top: ${r.spacing(1.75)};
      }
      .rc-slider-mark-text {
        color: ${r.colors.text.disabled};
        font-size: ${r.typography.bodySmall.fontSize};
      }
      .rc-slider-mark-text-active {
        color: ${r.colors.text.primary};
      }
      .rc-slider-handle {
        border: none;
        background-color: ${g};
        box-shadow: ${r.shadows.z1};
        cursor: pointer;
        opacity: 1;
      }

      .rc-slider-handle:hover,
      .rc-slider-handle:active,
      .rc-slider-handle-click-focused:focus {
        ${p};
      }

      // The triple class names is needed because that's the specificity used in the source css :(
      .rc-slider-handle-dragging.rc-slider-handle-dragging.rc-slider-handle-dragging,
      .rc-slider-handle:focus-visible {
        box-shadow: 0 0 0 5px ${r.colors.text.primary};
      }

      .rc-slider-dot,
      .rc-slider-dot-active {
        background-color: ${r.colors.text.primary};
        border-color: ${r.colors.text.primary};
      }

      .rc-slider-track {
        background-color: ${h};
      }
      .rc-slider-rail {
        background-color: ${o};
        cursor: pointer;
      }
    `,tooltip:(0,n.css)`
      body {
        .rc-slider-tooltip {
          cursor: grab;
          user-select: none;
          z-index: ${r.zIndex.tooltip};
        }

        .rc-slider-tooltip-inner {
          color: ${r.colors.text.primary};
          background-color: transparent !important;
          border-radius: 0;
          box-shadow: none;
        }

        .rc-slider-tooltip-placement-top .rc-slider-tooltip-arrow {
          display: none;
        }

        .rc-slider-tooltip-placement-top {
          padding: 0;
        }
      }
    `,sliderInput:(0,t.css)({display:"flex",flexDirection:"row",alignItems:"center",width:"100%"}),sliderInputVertical:(0,t.css)({flexDirection:"column",height:"100%",".rc-slider":{margin:0,order:2}}),sliderInputField:(0,t.css)({marginLeft:r.spacing(3),width:"60px",input:{textAlign:"center"}}),sliderInputFieldVertical:(0,t.css)({margin:`0 0 ${r.spacing(3)} 0`,order:1})}}},5926:(G,O,e)=>{"use strict";e.d(O,{O:()=>v});var t=e(74848),n=e(2543),i=e(96540),s=e(39624),r=e(21423),f=e(11261),a=e(8066),c=e(52622),o=e(81297),h=e(51336),g=e(16895),l=e(73060),p=e(14236),m=e(46294);function y(u,D){const P=u.y.values.length,x={...u.y.config,...D},E=u.x??{name:"",values:[...Array(P).keys()],type:f.PU.number,config:{}};let C={refId:"sparkline",fields:[E,{...u.y,config:x}],length:P};return(0,l.g2)(E.values)||(C=(0,p.ES)(C,0)),(0,m.M)({frame:C,refFieldPseudoMin:u.timeRange?.from.valueOf(),refFieldPseudoMax:u.timeRange?.to.valueOf()})}const d={drawStyle:c.GR.Line,showPoints:c.yL.Auto,axisPlacement:c.vM.Hidden,pointSize:2};class v extends i.PureComponent{constructor(D){super(D);const P=y(D.sparkline,D.config);this.state={data:(0,g.bq)(P,(0,g.ro)(P)),alignedDataFrame:P,configBuilder:this.prepareConfig(P)}}static getDerivedStateFromProps(D,P){const x=y(D.sparkline,D.config),E=(0,s.C)(x);return E?{...P,data:(0,g.bq)(E,(0,g.ro)(E)),alignedDataFrame:E}:{...P}}componentDidUpdate(D,P){const{alignedDataFrame:x}=this.state;if(!x)return;let E=!1;if(D.sparkline!==this.props.sparkline){const C=!(0,r.bW)(this.state.alignedDataFrame,P.alignedDataFrame),M=!(0,n.isEqual)(x.fields[1].state?.range,P.alignedDataFrame.fields[1].state?.range);E=C||M}else E=!(0,n.isEqual)(D.config,this.props.config);E&&this.setState({configBuilder:this.prepareConfig(x)})}getYRange(D){let{min:P,max:x}=this.state.alignedDataFrame.fields[1].state?.range;const E=+this.state.alignedDataFrame.fields[1].config?.noValue;return Number.isNaN(E)||(P=Math.min(P,+E),x=Math.max(x,+E)),P===x?(P===0?x=100:(P=0,x*=2),[P,x]):[Math.max(P,D.config.min??-1/0),Math.min(x,D.config.max??1/0)]}prepareConfig(D){const{theme:P}=this.props,x=new h.e;x.setCursor({show:!1,x:!1,y:!1});const E=D.fields[0];x.addScale({scaleKey:"x",orientation:c.Lt.Horizontal,direction:c.ON.Right,isTime:!1,range:()=>{const{sparkline:C}=this.props;if(C.x){if(C.timeRange&&C.x.type===f.PU.time)return[C.timeRange.from.valueOf(),C.timeRange.to.valueOf()];const M=C.x.values;return[M[0],M[M.length-1]]}return[0,C.y.values.length-1]}}),x.addAxis({scaleKey:"x",theme:P,placement:c.vM.Hidden});for(let C=0;C<D.fields.length;C++){const M=D.fields[C],S=M.config,I={...d,...S.custom};if(M===E||M.type!==f.PU.number)continue;const T=S.unit||"__fixed";x.addScale({scaleKey:T,orientation:c.Lt.Vertical,direction:c.ON.Up,range:()=>this.getYRange(M)}),x.addAxis({scaleKey:T,theme:P,placement:c.vM.Hidden});const b=(0,a.Qi)(M),R=b.getCalculator(M,P)(0,0),A=I.drawStyle===c.GR.Points?c.yL.Always:I.showPoints;x.addSeries({pxAlign:!1,scaleKey:T,theme:P,colorMode:b,thresholds:S.thresholds,drawStyle:I.drawStyle,lineColor:I.lineColor??R,lineWidth:I.lineWidth,lineInterpolation:I.lineInterpolation,showPoints:A,pointSize:I.pointSize,fillOpacity:I.fillOpacity,fillColor:I.fillColor,lineStyle:I.lineStyle,gradientMode:I.gradientMode})}return x}render(){const{data:D,configBuilder:P}=this.state,{width:x,height:E}=this.props;return(0,t.jsx)(o.Z,{data:D,config:P,width:x,height:E})}}},62930:(G,O,e)=>{"use strict";e.d(O,{y:()=>h});var t=e(74848),n=e(32196),i=e(8867),s=e(40845),r=e(4025),f=e(76412),a=e(87019),c=e(14578),o=e(78318);const h=({className:p,inline:m=!1,iconClassName:y,style:d,size:v="md"})=>{const u=(0,s.of)(g),D=(0,s.of)(l,v),x=window.matchMedia("(prefers-reduced-motion: reduce)").matches?"hourglass":"spinner";if(typeof v!="string"||!(0,r.rJ)(v)){const E=(0,o.Wj)(),C=(0,o.Xi)(x,"default"),M=`${E}${C}/${x}.svg`;return(0,t.jsx)("div",{"data-testid":"Spinner",style:d,className:(0,n.cx)({[u.inline]:m},D.wrapper,p),children:(0,t.jsx)(i.default,{src:M,width:v,height:v,className:(0,n.cx)(u.spin,D.icon,p),style:d})})}return(0,t.jsx)("div",{"data-testid":"Spinner",style:d,className:(0,n.cx)({[u.inline]:m},p),children:(0,t.jsx)(c.I,{className:(0,n.cx)(u.spin,y),name:x,size:v,"aria-label":(0,f.t)("grafana-ui.spinner.aria-label","Loading")})})},g=p=>({inline:(0,n.css)({display:"inline-block"}),spin:(0,n.css)({[p.transitions.handleMotion("no-preference")]:{animation:`${a.t} 2s infinite linear`}})}),l=(p,m)=>({wrapper:(0,n.css)({fontSize:typeof m=="string"?m:`${m}px`}),icon:(0,n.css)({display:"inline-block",fill:"currentColor",flexShrink:0,label:"Icon",lineHeight:0,verticalAlign:"middle"})})},21633:(G,O,e)=>{"use strict";e.d(O,{h:()=>g});var t=e(32196),n=e(2543),i=e.n(n),s=e(96540),r=e(40845),f=e(69144);const a=.3,c=new Set(["ArrowUp","ArrowDown"]),o=new Set(["ArrowLeft","ArrowRight"]),h={row:{dim:"width",axis:"clientX",min:"minWidth",max:"maxWidth"},column:{dim:"height",axis:"clientY",min:"minHeight",max:"maxHeight"}};function g(d){const{direction:v,initialSize:u=.5,dragPosition:D="middle",onResizing:P,onSizeChanged:x}=d,E=16,C=(0,s.useRef)(null),M=(0,s.useRef)(null),S=(0,s.useRef)(null),I=(0,s.useRef)(null),T=(0,s.useRef)(null),b=(0,s.useRef)("1fr"),R=(0,s.useRef)(void 0),A=(0,s.useRef)(void 0),L=h[v].dim,U=h[v].axis,W=h[v].min,w=h[v].max;m(I.current,te=>{for(const le of te){if(!le.target.isSameNode(I.current)||!M.current)return;const ie=M.current.getBoundingClientRect()[L],ae=p(M.current);C.current.ariaValueNow=l(ie,ae[W],ae[w])}},500,[w,W,v,L]);const N=(0,s.useRef)(null),B=(0,s.useCallback)(te=>{M.current&&(b.current=M.current.getBoundingClientRect()[L],T.current=I.current.getBoundingClientRect()[L],N.current=te[U],C.current.setPointerCapture(te.pointerId),R.current=p(M.current),A.current=void 0)},[L,U]),V=(0,s.useCallback)(te=>{if(N.current!==null&&b.current!=="1fr"){const le=te[U]-N.current,ie=R.current,ae=(0,n.clamp)(b.current+le,ie[W],ie[w]),re=ae/(T.current-E);M.current.style.flexGrow=`${re}`,S.current.style.flexGrow=`${1-re}`,C.current.ariaValueNow=l(ae,ie[W],ie[w]),P?.(re,ae)}},[E,U,W,w,P]),K=(0,s.useCallback)(te=>{te.preventDefault(),te.stopPropagation(),C.current.releasePointerCapture(te.pointerId),N.current=null,typeof b.current=="number"&&x?.(parseFloat(M.current.style.flexGrow),b.current)},[x]),H=(0,s.useRef)(new Set),X=(0,s.useRef)(null),k=(0,s.useCallback)(te=>{if(H.current.size===0){X.current=null;return}else if(b.current==="1fr")return;const ae=(te-(X.current??te))*a;let re=0;v==="row"?(H.current.has("ArrowLeft")&&(re-=ae),H.current.has("ArrowRight")&&(re+=ae)):(H.current.has("ArrowUp")&&(re-=ae),H.current.has("ArrowDown")&&(re+=ae));const ce=R.current,me=M.current.getBoundingClientRect()[L],ee=(0,n.clamp)(me+re,ce[W],ce[w]),de=ee/(T.current-E);M.current.style.flexGrow=`${de}`,S.current.style.flexGrow=`${1-de}`,C.current.ariaValueNow=l(ee,ce[W],ce[w]),P?.(de,ee),X.current=te,window.requestAnimationFrame(k)},[v,E,W,w,L,P]),Y=(0,s.useCallback)(te=>{if(!M.current||!S.current||!C.current||!I.current)return;if(te.key==="Enter"){A.current===void 0?(A.current=M.current.style.flexGrow,M.current.style.flexGrow="0",S.current.style.flexGrow="1"):(M.current.style.flexGrow=A.current,S.current.style.flexGrow=`${1-parseFloat(A.current)}`,A.current=void 0);return}else if(te.key==="Home"){R.current=p(M.current),T.current=I.current.getBoundingClientRect()[L];const ie=R.current[W]/(T.current-E);M.current.style.flexGrow=`${ie}`,S.current.style.flexGrow=`${1-ie}`,C.current.ariaValueNow="0";return}else if(te.key==="End"){R.current=p(M.current),T.current=I.current.getBoundingClientRect()[L];const ie=R.current[w]/(T.current-E);M.current.style.flexGrow=`${ie}`,S.current.style.flexGrow=`${1-ie}`,C.current.ariaValueNow="100";return}if(!(v==="column"&&c.has(te.key)||v==="row"&&o.has(te.key))||H.current.has(te.key))return;if(A.current=void 0,te.preventDefault(),te.stopPropagation(),b.current=M.current.getBoundingClientRect()[L],T.current=I.current.getBoundingClientRect()[L],R.current=p(M.current),!H.current.has(te.key)){const ie=H.current.size===0;H.current.add(te.key),ie&&window.requestAnimationFrame(k)}},[v,k,E,w,L,W]),Z=(0,s.useCallback)(te=>{v==="row"&&!o.has(te.key)||v==="column"&&!c.has(te.key)||(H.current.delete(te.key),typeof b.current=="number"&&x?.(parseFloat(M.current.style.flexGrow),b.current))},[v,x]),se=(0,s.useCallback)(()=>{if(!M.current||!S.current)return;M.current.style.flexGrow="0.5",S.current.style.flexGrow="0.5";const te=p(M.current);R.current=te,b.current=M.current.getBoundingClientRect()[L],C.current.ariaValueNow=`${l(b.current,te[W],te[w])}`},[w,L,W]),j=(0,s.useCallback)(()=>{H.current.size>0&&(H.current.clear(),N.current=null,typeof b.current=="number"&&x?.(parseFloat(M.current.style.flexGrow),b.current))},[x]),q=(0,r.of)(y,v),ne=(0,r.of)(f.l,D),oe=v==="column"?ne.dragHandleHorizontal:ne.dragHandleVertical,z=(0,s.useId)();return{containerProps:{ref:I,className:q.container},primaryProps:{ref:M,className:q.panel,style:{[W]:"min-content",flexGrow:(0,n.clamp)(u??.5,0,1)}},secondaryProps:{ref:S,className:q.panel,style:{flexGrow:(0,n.clamp)(1-u,0,1),[W]:"min-content"}},splitterProps:{onPointerUp:K,onPointerDown:B,onPointerMove:V,onKeyDown:Y,onKeyUp:Z,onDoubleClick:se,onBlur:j,ref:C,style:{[L]:`${E}px`},role:"separator","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":u*100,"aria-controls":`start-panel-${z}`,"aria-label":"Pane resize widget",tabIndex:0,className:oe}}}function l(d,v,u){return`${(0,n.clamp)((d-v)/(u-v)*100,0,100)}`}function p(d){const v=document.body.style.overflow,u=d.style.width,D=d.style.height,P=d.style.flexGrow;document.body.style.overflow="hidden",d.style.flexGrow="0";const{width:x,height:E}=d.getBoundingClientRect();d.style.flexGrow="100";const{width:C,height:M}=d.getBoundingClientRect();return document.body.style.overflow=v,d.style.width=u,d.style.height=D,d.style.flexGrow=P,{minWidth:x,maxWidth:C,minHeight:E,maxHeight:M}}function m(d,v,u=0,D){const P=(0,n.throttle)(v,u);(0,s.useLayoutEffect)(()=>{if(!d)return;const x=new ResizeObserver(P);return x.observe(d,{box:"device-pixel-content-box"}),()=>x.disconnect()},D)}function y(d,v){return{container:(0,t.css)({display:"flex",flexDirection:v==="row"?"row":"column",width:"100%",flexGrow:1,overflow:"hidden"}),panel:(0,t.css)({display:"flex",position:"relative",flexBasis:0})}}},42734:(G,O,e)=>{"use strict";e.d(O,{S:()=>a});var t=e(74848),n=e(2543),i=e.n(n),s=e(96540),r=e(75059),f=e(90182);class a extends s.PureComponent{constructor(){super(...arguments),this.checkInput=()=>{const{stats:o,allowMultiple:h,defaultStat:g,onChange:l}=this.props,p=r.AS.list(o);if(p.length!==o.length){const m=p.map(d=>d.id),y=(0,n.difference)(o,m);console.warn("Unknown stats",y,o),l(p.map(d=>d.id))}!h&&o.length>1&&(console.warn("Removing extra stat",o),l([o[0]])),g&&o.length<1&&l([g])},this.onSelectionChange=o=>{const{onChange:h}=this.props;Array.isArray(o)?h(o.map(g=>g.value)):h(o&&o.value?[o.value]:[])}}static{this.defaultProps={allowMultiple:!1}}componentDidMount(){this.checkInput()}componentDidUpdate(o){this.checkInput()}render(){const{stats:o,allowMultiple:h,defaultStat:g,placeholder:l,className:p,menuPlacement:m,width:y,inputId:d,filterOptions:v}=this.props,u=r.AS.selectOptions(o,v);return(0,t.jsx)(f.l6,{value:u.current,className:p,isClearable:!g,isMulti:h,width:y,isSearchable:!0,options:u.options,placeholder:l,onChange:this.onSelectionChange,menuPlacement:m,inputId:d})}}},15292:(G,O,e)=>{"use strict";e.d(O,{K:()=>g,d:()=>h});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(96540),f=e(95344),a=e(40845),c=e(16797),o=e(14578);const h=(0,r.forwardRef)(({value:p,checked:m,onChange:y,id:d,label:v,disabled:u,invalid:D=!1,...P},x)=>{m&&(0,f.l)("Switch","checked prop","value");const E=(0,a.of)(l),C=(0,r.useRef)(d||(0,i.uniqueId)("switch-"));return(0,t.jsxs)("div",{className:(0,n.cx)(E.switch,D&&E.invalid),children:[(0,t.jsx)("input",{type:"checkbox",disabled:u,checked:p,onChange:M=>{!u&&y?.(M)},id:C.current,...P,ref:x}),(0,t.jsx)("label",{htmlFor:C.current,"aria-label":v??"Toggle switch",children:(0,t.jsx)(o.I,{name:"check",size:"xs"})})]})});h.displayName="Switch";const g=(0,r.forwardRef)(({transparent:p,className:m,showLabel:y,label:d,value:v,id:u,invalid:D,...P},x)=>{const E=(0,a.of)(l,p);return(0,t.jsxs)("div",{className:(0,n.cx)(E.inlineContainer,m,P.disabled&&E.disabled,D&&E.invalid),children:[y&&(0,t.jsx)("label",{htmlFor:u,className:(0,n.cx)(E.inlineLabel,v&&E.inlineLabelEnabled,"inline-switch-label"),children:d}),(0,t.jsx)(h,{...P,id:u,label:d,ref:x,value:v})]})});g.displayName="Switch";const l=(p,m)=>({switch:(0,n.css)({width:"32px",height:"16px",position:"relative",lineHeight:1,input:{opacity:0,left:"-100vw",zIndex:-1e3,position:"absolute","&:checked + label":{background:p.colors.primary.main,borderColor:p.colors.primary.main,"&:hover":{background:p.colors.primary.shade},svg:{transform:"translate3d(17px, -50%, 0)",background:p.colors.primary.contrastText,color:p.colors.primary.main}},"&:disabled + label":{background:p.colors.action.disabledBackground,borderColor:p.colors.border.weak,cursor:"not-allowed",svg:{background:p.colors.text.disabled}},"&:disabled:checked + label":{background:p.colors.primary.transparent,svg:{color:p.colors.primary.contrastText}},"&:focus + label, &:focus-visible + label":(0,c.getFocusStyles)(p),"&:focus:not(:focus-visible) + label":(0,c.getMouseFocusStyles)(p)},label:{width:"100%",height:"100%",cursor:"pointer",borderRadius:p.shape.radius.pill,background:p.components.input.background,border:`1px solid ${p.components.input.borderColor}`,transition:"all 0.3s ease","&:hover":{borderColor:p.components.input.borderHover},svg:{position:"absolute",display:"block",color:"transparent",width:"12px",height:"12px",borderRadius:p.shape.radius.circle,background:p.colors.text.secondary,boxShadow:p.shadows.z1,top:"50%",transform:"translate3d(1px, -50%, 0)",transition:"transform 0.2s cubic-bezier(0.19, 1, 0.22, 1)","@media (forced-colors: active)":{border:`1px solid ${p.colors.primary.contrastText}`}}}}),inlineContainer:(0,n.css)({padding:p.spacing(0,1),height:p.spacing(p.components.height.md),display:"inline-flex",alignItems:"center",background:m?"transparent":p.components.input.background,border:`1px solid ${m?"transparent":p.components.input.borderColor}`,borderRadius:p.shape.radius.default,"&:hover":{border:`1px solid ${m?"transparent":p.components.input.borderHover}`,".inline-switch-label":{color:p.colors.text.primary}}}),disabled:(0,n.css)({backgroundColor:"rgba(204, 204, 220, 0.04)",color:"rgba(204, 204, 220, 0.6)",border:"1px solid rgba(204, 204, 220, 0.04)"}),inlineLabel:(0,n.css)({cursor:"pointer",paddingRight:p.spacing(1),color:p.colors.text.secondary,whiteSpace:"nowrap"}),inlineLabelEnabled:(0,n.css)({color:p.colors.text.primary}),invalid:(0,n.css)({"input + label, input:checked + label, input:hover + label":{border:`1px solid ${p.colors.error.border}`}})})},60734:(G,O,e)=>{"use strict";e.d(O,{q:()=>h});var t=e(74848),n=e(32196),i=e(96540),s=e(29158),r=e(63021),f=e(40675),a=e(40980),c=e(40845),o=e(40276);function h({tabs:l,defaultTab:p,closeIconTooltip:m,onClose:y,testId:d}){const[v,u]=(0,i.useState)(l.some(C=>C.value===p)?p:l[0].value),D=(0,c.of)(g),P=(0,c.$j)(),x=C=>{u(C.value)},E=`calc(100% - (${P.components.menuTabs.height}px + ${P.spacing(1)}))`;return(0,t.jsxs)("div",{className:D.container,"data-testid":d,children:[(0,t.jsxs)(r.U,{className:D.tabs,children:[l.map(C=>(0,t.jsx)(f.o,{label:C.label,active:C.value===v,onChangeTab:()=>x(C),icon:C.icon},C.value)),(0,t.jsx)(s.K,{className:D.close,onClick:y,name:"times",tooltip:m??"Close"})]}),(0,t.jsx)(o.E,{autoHeightMin:E,autoHeightMax:E,children:(0,t.jsx)(a.J,{className:D.tabContent,children:l.find(C=>C.value===v)?.content})})]})}const g=l=>({container:(0,n.css)({height:"100%"}),tabContent:(0,n.css)({padding:l.spacing(2),backgroundColor:l.colors.background.primary,height:"100%"}),close:(0,n.css)({position:"absolute",right:"16px",top:"5px",cursor:"pointer",fontSize:l.typography.size.lg}),tabs:(0,n.css)({paddingTop:l.spacing(1),borderColor:l.colors.border.weak,ul:{marginLeft:l.spacing(2)}})})},14746:(G,O,e)=>{"use strict";e.d(O,{b:()=>l});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(96540),f=e(72436),a=e(40845),c=e(3911),o=e(14578),h=e(21744);class g extends r.PureComponent{constructor(y){super(y),this.readCSV=(0,i.debounce)(()=>{const{config:u}=this.props,{text:D}=this.state;this.setState({data:(0,f.Jh)(D,{config:u})})},150),this.onTextChange=u=>{this.setState({text:u.target.value})};const{text:d,config:v}=y;this.state={text:d,data:(0,f.Jh)(d,{config:v})}}componentDidUpdate(y,d){const{text:v}=this.state;(v!==d.text||this.props.config!==y.config)&&this.readCSV(),this.props.text!==y.text&&this.props.text!==v&&this.setState({text:this.props.text}),this.state.data!==d.data&&this.props.onSeriesParsed(this.state.data,this.state.text)}render(){const{width:y,height:d,theme:v}=this.props,{data:u}=this.state,D=p(v);return(0,t.jsxs)("div",{className:D.tableInputCsv,children:[(0,t.jsx)(h.f,{style:{width:y,height:d},placeholder:"Enter CSV here...",value:this.state.text,onChange:this.onTextChange,className:D.textarea}),u&&(0,t.jsx)("footer",{className:D.footer,children:u.map((P,x)=>(0,t.jsxs)("span",{children:["Rows:",P.length,", Columns:",P.fields.length," \xA0",(0,t.jsx)(o.I,{name:"check-circle"})]},x))})]})}}const l=(0,a.cV)(g);l.displayName="TableInputCSV";const p=(0,c.N)(m=>({tableInputCsv:(0,n.css)({position:"relative"}),textarea:(0,n.css)({height:"100%",width:"100%"}),footer:(0,n.css)({position:"absolute",bottom:"15px",right:"15px",border:"1px solid #222",background:m.colors.success.main,padding:`1px ${m.spacing(.5)}`,fontSize:"80%"})}))},92015:(G,O,e)=>{"use strict";e.d(O,{u:()=>c,d:()=>h});var t=e(74848),n=e(96540),i=e(75059),s=e(13544),r=e(32196);const f=g=>{const l=(0,r.css)({width:"100%",listStyle:"none"}),p=(0,r.css)({width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-between"});return g.value&&!Array.isArray(g.value)?(0,t.jsx)("span",{children:g.value}):g.value&&Array.isArray(g.value)&&g.value.length>0?(0,t.jsx)("ul",{className:l,children:g.value.map((m,y)=>{const d=Object.keys(m)[0];return(0,t.jsxs)("li",{className:p,children:[(0,t.jsx)("span",{children:d}),(0,t.jsx)("span",{children:m[d]})]},y)})}):a},a=()=>(0,t.jsx)("span",{children:"\xA0"});function c(g){const{totalColumnsWidth:l,footerGroups:p,isPaginationVisible:m,tableStyles:y}=g,d=s.Tp.components.Panels.Visualization.Table;return(0,t.jsx)("div",{style:{position:m?"relative":"absolute",width:l?`${l}px`:"100%",bottom:"0px"},children:p.map(v=>{const{key:u,...D}=v.getFooterGroupProps();return(0,n.createElement)("div",{className:y.tfoot,...D,key:u,"data-testid":d.footer},v.headers.map(P=>o(P,y)))})})}function o(g,l){const{key:p,...m}=g.getHeaderProps();return m?(m.style=m.style??{},m.style.position="absolute",m.style.justifyContent=g.justifyContent,(0,t.jsx)("div",{className:l.headerCell,...m,children:g.render("Footer")},p)):null}function h(g,l,p){if(l===void 0)return a;if(p){if(l[g]===void 0)return a;const m=i.AS.get(i.gy.count).name;return f({value:[{[m]:String(l[g])}]})}return f({value:l[g]})}},30355:(G,O,e)=>{"use strict";e.d(O,{a:()=>l,t:()=>g});var t=e(74848),n=e(58563),i=e(14236),s=e(11261),r=e(52622),f=e(40845),a=e(29413),c=e(9286),o=e(5926),h=e(57021);const g={type:r.ob.Sparkline,drawStyle:r.GR.Line,lineInterpolation:r.dx.Smooth,lineWidth:1,fillOpacity:17,gradientMode:r.on.Hue,pointSize:2,barAlignment:r.Nj.Center,showPoints:r.yL.Never,hideValue:!1},l=y=>{const{field:d,innerWidth:v,tableStyles:u,cell:D,cellProps:P,timeRange:x}=y,E=p(D.value),C=(0,f.$j)();if(!E)return(0,t.jsx)("div",{...P,className:u.cellContainer,children:d.config.noValue||"no data"});E.x&&!E.x.config.interval&&E.x.values.length>1&&(E.x.config.interval=E.x.values[1]-E.x.values[0]),E.y.values=E.y.values.map(A=>Number.isFinite(A)?A:null);const M=(0,n.AP)(E.y);E.y.config.min=M.min,E.y.config.max=M.max,E.y.state={range:M},E.timeRange=x;const S=m(d),I={color:d.config.color,custom:{...g,...S}},T=d.config.custom?.cellOptions?.hideValue;let b=0,R=null;if(!T){const A=(0,i.LI)(D.value)?D.value.value:null,L=d.display(A),U=(0,h.zi)(d,L,D.row.index);b=(0,a.kD)(`${U.prefix??""}${U.text}${U.suffix??""}`,16).width+C.spacing.gridSize,R=(0,t.jsx)(c.i,{style:{width:`${b-C.spacing.gridSize}px`,textAlign:"right",marginRight:C.spacing(1)},value:L})}return(0,t.jsxs)("div",{...P,className:u.cellContainer,children:[R,(0,t.jsx)("div",{children:(0,t.jsx)(o.O,{width:v-b,height:u.cellHeightInner,sparkline:E,config:I,theme:u.theme})})]})};function p(y){if(Array.isArray(y))return{y:{name:"test",type:s.PU.number,values:y,config:{}}};if((0,i.ci)(y)){const d=y.fields.find(u=>u.type===s.PU.time),v=y.fields.find(u=>u.type===s.PU.number);if(d&&v)return{x:d,y:v}}}function m(y){let d=(0,h.bk)(y);if(d.type===r.ob.Auto&&(d={...d,type:r.ob.Sparkline}),d.type===r.ob.Sparkline)return d;throw new Error(`Expected options type ${r.ob.Sparkline} but got ${d.type}`)}},77093:(G,O,e)=>{"use strict";e.d(O,{X:()=>He});var t=e(74848),n=e(96540),i=e(32885),s=e(75059),r=e(11261),f=e(19845),a=e(13544),c=e(52622),o=e(40845),h=e(40276),g=e(19384),l=e(92015),p=e(4025),m=e(14578),y=e(32196),d=e(13840),v=e(91793),u=e(83195),D=e(67061),P=e(67647),x=e(9261),E=e(10880),C=e(60029);const M=28,S=M*5,I={Contains:{label:"Contains",value:"Contains",description:"Contains"},"=":{label:"=",value:"=",description:"Equals"},"!=":{label:"!=",value:"!=",description:"Not equals"},">":{label:">",value:">",description:"Greater"},">=":{label:">=",value:">=",description:"Greater or Equal"},"<":{label:"<",value:"<",description:"Less"},"<=":{label:"<=",value:"<=",description:"Less or Equal"},Expression:{label:"Expression",value:"Expression",description:'Bool Expression (Char $ represents the column value in the expression, e.g. "$ >= 10 && $ <= 12")'}},T=Object.values(I),b=I.Contains,R=I.Expression,A=Be=>{if(Be=Be.trim().replace(/\\/g,""),/^(\d{4}-\d{2}-\d{2}|\d{4}\/\d{2}\/\d{2})/.test(Be)){const Se=new Date(Be);if(!isNaN(Se.getTime())){const We=(0,u.j_)("dateTimeAsIso");return(0,u.cN)(We(Se.getTime()))}}const Ne=parseFloat(Be);if(!isNaN(Ne))return Ne;const Re=Be.toLowerCase();return Re==="true"||Re==="false"?Re==="true":Be},L=({options:Be,values:Ne,caseSensitive:Re,showOperators:Se,onChange:We,searchFilter:Ke,setSearchFilter:Xe,operator:Je,setOperator:st})=>{const pt=(0,n.useMemo)(()=>new RegExp(Ke,Re?void 0:"i"),[Ke,Re]),xt=(0,n.useMemo)(()=>Be.filter(Ie=>{if(!Se||!Ke||Je.value===b.value)return Ie.label===void 0?!1:pt.test(Ie.label);if(Je.value===R.value){if(Ie.value===void 0)return!1;try{const Qe=Ke.replace(/\\/g,""),at=new Function("$",`'use strict'; return ${Qe};`),ft=A(Ie.value);return at(ft)}catch{}return!1}else{if(Ie.value===void 0)return!1;const Qe=A(Ie.value),at=A(Ke);switch(Je.value){case"=":return Qe===at;case"!=":return Qe!==at;case">":return Qe>at;case">=":return Qe>=at;case"<":return Qe<at;case"<=":return Qe<=at}return!1}}),[Be,pt,Se,Je,Ke]),ot=(0,n.useMemo)(()=>xt.filter(Ie=>Ne.includes(Ie)),[xt,Ne]),$e=(0,n.useMemo)(()=>xt.length===ot.length,[xt,ot]),ve=(0,n.useMemo)(()=>ot.length>0&&xt.length>ot.length,[xt,ot]),be=(0,n.useMemo)(()=>ot.length?`${ot.length} selected`:"Select all",[ot]),he=(0,n.useMemo)(()=>xt.length!==ot.length?"Add all displayed values to the filter":"Remove all displayed values from the filter",[xt,ot]),ye=(0,o.of)(W),ge=(0,o.$j)().spacing.gridSize,xe=(0,n.useMemo)(()=>Math.min(xt.length*M,S)+ge,[ge,xt.length]),Ae=(0,n.useCallback)(Ie=>Qe=>{const at=Qe.currentTarget.checked?Ne.concat(Ie):Ne.filter(ft=>ft.value!==Ie.value);We(at)},[We,Ne]),Ee=(0,n.useCallback)(()=>{if(xt.length===ot.length){const Ie=Ne.filter(Qe=>!xt.includes(Qe));We(Ie)}else{const Ie=[...new Set([...Ne,...xt])];We(Ie)}},[We,Ne,xt,ot]);return(0,t.jsxs)(D.B,{direction:"column",gap:.25,children:[!Se&&(0,t.jsx)(P.Z,{placeholder:"Filter values",onChange:Xe,value:Ke}),Se&&(0,t.jsxs)(D.B,{direction:"row",gap:0,children:[(0,t.jsx)(x.f,{variant:"canvas",options:T,onChange:st,value:Je,tooltip:Je.description}),(0,t.jsx)(P.Z,{placeholder:"Filter values",onChange:Xe,value:Ke})]}),xt.length>0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.Y1,{height:xe,itemCount:xt.length,itemSize:M,itemData:{items:xt,values:ot,onCheckedChanged:Ae,className:ye.filterListRow},width:"100%",className:ye.filterList,children:U}),(0,t.jsxs)(D.B,{direction:"column",gap:.25,children:[(0,t.jsx)("div",{className:(0,y.cx)(ye.selectDivider)}),(0,t.jsx)("div",{className:(0,y.cx)(ye.filterListRow),children:(0,t.jsx)(E.S,{value:$e,indeterminate:ve,label:be,description:he,onChange:Ee})})]})]}):(0,t.jsx)(C.J,{className:ye.noValuesLabel,children:"No values"})]})};function U({index:Be,style:Ne,data:{onCheckedChanged:Re,items:Se,values:We,className:Ke}}){const Xe=Se[Be],{value:Je,label:st}=Xe,pt=We.find(xt=>xt.value===Je)!==void 0;return(0,t.jsx)("div",{className:Ke,style:Ne,title:st,children:(0,t.jsx)(E.S,{value:pt,label:st,onChange:Re(Xe)})})}const W=Be=>({filterList:(0,y.css)({label:"filterList"}),filterListRow:(0,y.css)({label:"filterListRow",cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",padding:Be.spacing(.5),":hover":{backgroundColor:Be.colors.action.hover}}),selectDivider:(0,y.css)({label:"selectDivider",width:"100%",borderTop:`1px solid ${Be.colors.border.medium}`,padding:Be.spacing(.5,2)}),noValuesLabel:(0,y.css)({paddingTop:Be.spacing(1)})});var w=e(8866),N=e(29158),B=e(55852),V=e(57021);const K=({column:{preFilteredRows:Be,filterValue:Ne,setFilter:Re},onClose:Se,field:We,searchFilter:Ke,setSearchFilter:Xe,operator:Je,setOperator:st})=>{const pt=(0,o.$j)(),xt=(0,n.useMemo)(()=>(0,V.MY)(Be,We),[Be,We]),ot=(0,n.useMemo)(()=>(0,V.Yz)(xt),[xt]),$e=(0,n.useMemo)(()=>(0,V.Sj)(ot,Ne),[ot,Ne]),[ve,be]=(0,n.useState)($e),[he,ye]=(0,n.useState)(!1),Pe=(0,n.useCallback)(Ie=>Se(),[Se]),ge=(0,n.useCallback)(Ie=>{const Qe=ve.length?ve:void 0;Re(Qe),Se()},[Re,ve,Se]),xe=(0,n.useCallback)(Ie=>{Re(void 0),Se()},[Re,Se]),Ae=(0,n.useMemo)(()=>Ne!==void 0,[Ne]),Ee=(0,o.of)(H);return(0,t.jsx)(w.N,{onClick:Pe,useCapture:!0,children:(0,t.jsx)("div",{className:(0,y.cx)(Ee.filterContainer),onClick:X,children:(0,t.jsxs)(D.B,{direction:"column",gap:3,children:[(0,t.jsxs)(D.B,{direction:"column",gap:.5,children:[(0,t.jsxs)(D.B,{justifyContent:"space-between",alignItems:"center",children:[(0,t.jsx)(C.J,{className:Ee.label,children:"Filter by values:"}),(0,t.jsx)(N.K,{name:"text-fields",tooltip:"Match case",style:{color:he?pt.colors.text.link:pt.colors.text.disabled},onClick:()=>{ye(Ie=>!Ie)}})]}),(0,t.jsx)("div",{className:(0,y.cx)(Ee.listDivider)}),(0,t.jsx)(L,{onChange:be,values:ve,options:ot,caseSensitive:he,showOperators:!0,searchFilter:Ke,setSearchFilter:Xe,operator:Je,setOperator:st})]}),(0,t.jsxs)(D.B,{gap:3,children:[(0,t.jsxs)(D.B,{children:[(0,t.jsx)(B.$n,{size:"sm",onClick:ge,children:"Ok"}),(0,t.jsx)(B.$n,{size:"sm",variant:"secondary",onClick:Pe,children:"Cancel"})]}),Ae&&(0,t.jsx)(D.B,{children:(0,t.jsx)(B.$n,{fill:"text",size:"sm",onClick:xe,children:"Clear filter"})})]})]})})})},H=Be=>({filterContainer:(0,y.css)({label:"filterContainer",width:"100%",minWidth:"250px",height:"100%",maxHeight:"400px",backgroundColor:Be.colors.background.primary,border:`1px solid ${Be.colors.border.weak}`,padding:Be.spacing(2),boxShadow:Be.shadows.z3,borderRadius:Be.shape.radius.default}),listDivider:(0,y.css)({label:"listDivider",width:"100%",borderTop:`1px solid ${Be.colors.border.medium}`,padding:Be.spacing(.5,2)}),label:(0,y.css)({marginBottom:0})}),X=Be=>{Be.stopPropagation()},k=({column:Be,field:Ne,tableStyles:Re})=>{const Se=(0,n.useRef)(null),[We,Ke]=(0,n.useState)(!1),Xe=(0,o.of)(Y),Je=(0,n.useMemo)(()=>!!Be.filterValue,[Be.filterValue]),st=(0,n.useCallback)(()=>Ke(!0),[Ke]),pt=(0,n.useCallback)(()=>Ke(!1),[Ke]),[xt,ot]=(0,n.useState)(""),[$e,ve]=(0,n.useState)(b);return!Ne||!Ne.config.custom?.filterable?null:(0,t.jsxs)("button",{className:(0,y.cx)(Re.headerFilter,Je?Xe.filterIconEnabled:Xe.filterIconDisabled),ref:Se,type:"button",onClick:st,children:[(0,t.jsx)(m.I,{name:"filter"}),We&&Se.current&&(0,t.jsx)(d.A,{content:(0,t.jsx)(K,{column:Be,tableStyles:Re,field:Ne,onClose:pt,searchFilter:xt,setSearchFilter:ot,operator:$e,setOperator:ve}),placement:"bottom-start",referenceElement:Se.current,show:!0})]})},Y=Be=>({filterIconEnabled:(0,y.css)({label:"filterIconEnabled",color:Be.colors.primary.text}),filterIconDisabled:(0,y.css)({label:"filterIconDisabled",color:Be.colors.text.disabled})}),Z=Be=>{const{headerGroups:Ne,showTypeIcons:Re,tableStyles:Se}=Be,We=a.Tp.components.Panels.Visualization.Table;return(0,t.jsx)("div",{role:"rowgroup",className:Se.headerRow,children:Ne.map(Ke=>{const{key:Xe,...Je}=Ke.getHeaderGroupProps();return(0,n.createElement)("div",{className:Se.thead,...Je,key:Xe,"aria-label":We.header,role:"row"},Ke.headers.map((st,pt)=>se(st,Se,Re)))})})};function se(Be,Ne,Re){const{key:Se,...We}=Be.getHeaderProps(),Ke=Be.field??null,Xe=Ke?.config.custom;Be.canResize&&(We.style.userSelect=Be.isResizing?"none":"auto"),We.style.position="absolute",We.style.justifyContent=Be.justifyContent,We.style.left=Be.totalLeft;let Je=Be.render("Header"),st=Be.canSort&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("button",{...Be.getSortByToggleProps(),className:Ne.headerCellLabel,children:[Re&&(0,t.jsx)(m.I,{name:(0,p.SS)(Ke),title:Ke?.type,size:"sm",className:Ne.typeIcon}),(0,t.jsx)("div",{children:Je}),Be.isSorted&&(Be.isSortedDesc?(0,t.jsx)(m.I,{size:"lg",name:"arrow-down",className:Ne.sortIcon}):(0,t.jsx)(m.I,{name:"arrow-up",size:"lg",className:Ne.sortIcon}))]}),Be.canFilter&&(0,t.jsx)(k,{column:Be,tableStyles:Ne,field:Ke})]});return st&&Xe?.headerComponent?st=(0,t.jsx)(Xe.headerComponent,{field:Ke,defaultContent:st}):Xe?.headerComponent&&(Je=(0,t.jsx)(Xe.headerComponent,{field:Ke,defaultContent:Je})),(0,t.jsxs)("div",{className:Ne.headerCell,...We,role:"columnheader",children:[Be.canSort&&st,!Be.canSort&&Je,!Be.canSort&&Be.canFilter&&(0,t.jsx)(k,{column:Be,tableStyles:Ne,field:Ke}),Be.canResize&&(0,t.jsx)("div",{...Be.getResizerProps(),className:Ne.resizeHandle})]},Se)}var j=e(64423),q=e(56978),ne=e(69129),oe=e(79041);function z({tableStyles:Be,nestedData:Ne,rowIndex:Re,width:Se,cellHeight:We}){const Ke=Ne.values,Xe=[],Je=(0,o.$j)(),st=(0,o.of)(te);let pt=Be.rowHeight+Je.spacing.gridSize;return Ke[Re].forEach((xt,ot)=>{const $e=!!xt.meta?.custom?.noHeader,ve=Be.rowHeight*(xt.length+($e?0:1)),be={height:ve,paddingLeft:V.jV,position:"absolute",top:pt};pt+=ve+Je.spacing.gridSize,Xe.push((0,t.jsx)("div",{style:be,children:(0,t.jsx)(He,{data:xt,width:Se-V.jV,height:Be.rowHeight*(xt.length+1),noHeader:$e,cellHeight:We})},`subTable_${Re}_${ot}`))}),(0,t.jsx)("div",{className:st.subTables,children:Xe})}const te=Be=>({subTables:(0,y.css)({"&:before":{content:'""',position:"absolute",width:"1px",top:Be.spacing(5),left:Be.spacing(1),bottom:Be.spacing(2),background:Be.colors.border.medium}})});function le(Be,Ne,Re){return Be.values[Ne].reduce((Ke,Xe)=>{if(Xe.length){const Je=!!Xe.meta?.custom?.noHeader;return Ke+Re.rowHeight*(Xe.length+(Je?0:1))+8}return Ke},Re.rowHeight)??Re.rowHeight}var ie=e(49618);const ae=Be=>{const{data:Ne,rows:Re,headerHeight:Se,footerPaginationEnabled:We,rowHeight:Ke,itemCount:Xe,pageIndex:Je,tableState:st,prepareRow:pt,onCellFilterAdded:xt,width:ot,cellHeight:$e=c.qM.Sm,timeRange:ve,tableStyles:be,nestedDataField:he,listHeight:ye,listRef:Pe,enableSharedCrosshair:ge=!1,initialRowIndex:xe=void 0,headerGroups:Ae,longestField:Ee}=Be,[Ie,Qe]=(0,n.useState)(xe);xe===void 0&&Ie!==void 0&&Qe(void 0);const at=(0,o.$j)(),ft=(0,oe.d2)();let ct=null;window.OffscreenCanvas!==void 0&&(ct=new OffscreenCanvas(256,1024).getContext("2d")),ct!=null&&(ct.font=`${at.typography.fontSize}px ${at.typography.body.fontFamily}`);const vt=(0,n.useMemo)(()=>{const Dt=Ne.fields.find(yt=>yt.type===r.PU.time);return Dt?(0,V.HY)(Dt):0},[Ne]),Pt=(0,n.useCallback)((Dt,yt)=>{if(!ft||!ge||!(0,f.S1)(yt))return;const Ft=yt.fields.find(an=>an.type===r.PU.time);ft.eventBus.publish(new ne.b_({point:{time:Ft.values[Dt]}}))},[ge,ft]),Vt=(0,n.useCallback)(()=>{!ft||!ge||ft.eventBus.publish(new ne.ql)},[ge,ft]),Jt=(0,n.useCallback)(Dt=>{if(Dt.payload.point?.time&&Dt.payload.rowIndex!==void 0){const yt=Ne.fields.find(hn=>hn.type===r.PU.time),Ft=yt.values[Dt.payload.rowIndex],an=Dt.payload.point.time;if((0,V.Iy)(an,Ft,vt)){Qe(Dt.payload.rowIndex);return}const un=yt.values.findIndex(hn=>(0,V.Iy)(an,hn,vt));if(un!==-1){Qe(un);return}Qe(void 0)}},[Ne.fields,vt]);(0,n.useEffect)(()=>{if(!ft||!ge||!(0,f.S1)(Ne)||We)return;const Dt=new j.yU;return Dt.add(ft.eventBus.getStream(ne.b_).pipe((0,q.B)(250)).subscribe({next:yt=>{ft.eventBus!==yt.origin&&Jt(yt)}})),Dt.add(ft.eventBus.getStream(ne.ql).pipe((0,q.B)(250)).subscribe({next:yt=>{ft.eventBus!==yt.origin&&Qe(void 0)}})),()=>{Dt.unsubscribe()}},[Ne,ge,We,Jt,ft]);let wt;if(Ie!==void 0){const Dt=Re.findIndex(yt=>yt.index===Ie);Dt!==-1&&(wt=Se+(Dt-1)*Ke)}const zt=(0,n.useCallback)(Dt=>st.pageIndex*st.pageSize+Dt,[st.pageIndex,st.pageSize]);let on,Pn;for(const Dt of Ne.fields){const yt=Dt.config.custom,Ft=yt!==void 0&&yt.cellOptions!==void 0;Ft&&yt.cellOptions.type===c.ob.ColorBackground&&yt.cellOptions.applyToRow&&(on=an=>{const un=Dt.display(Dt.values.get(an));return(0,V.HW)(be,yt.cellOptions,un)}),Ft&&(yt.cellOptions.type===c.ob.Auto||yt.cellOptions.type===c.ob.ColorBackground||yt.cellOptions.type===c.ob.ColorText)&&yt.cellOptions.wrapText?Pn=Dt:Ee!==void 0&&(Pn=Ee)}const _n=(0,n.useCallback)(({index:Dt,style:yt,rowHighlightIndex:Ft})=>{const an=zt(Dt),un=Re[an];let hn={};pt(un);const Un=st.expanded[un.id]?(0,y.css)({"&:hover":{background:"inherit"}}):{},Nn=he&&st.expanded[un.id];if(Ft!==void 0&&un.index===Ft&&(yt={...yt,backgroundColor:at.components.table.rowSelected},hn={"aria-selected":"true"}),on){const{bgColor:ht,textColor:lt}=on(un.index);yt.background=ht,yt.color=lt}if(Pn){const lt=Ne.fields.filter(et=>!et.config.custom?.hidden).findIndex(et=>et.name===Pn.name),gt=at.typography.body.lineHeight*at.typography.fontSize,$t=(0,V.M2)(Pn.values[Dt],Ae[0].headers[lt],ct,gt,be.rowHeight);yt.height=$t.height}const{key:St,...nn}=un.getRowProps({style:yt,...hn});return(0,t.jsxs)("div",{...nn,className:(0,y.cx)(be.row,Un),onMouseEnter:()=>Pt(Dt,Ne),onMouseLeave:Vt,children:[Nn&&(0,t.jsx)(z,{nestedData:he,tableStyles:be,rowIndex:un.index,width:ot,cellHeight:$e}),un.cells.map((ht,lt)=>(0,t.jsx)(ie.n,{tableStyles:be,cell:ht,onCellFilterAdded:xt,columnIndex:lt,columnCount:un.cells.length,timeRange:ve,frame:Ne,rowStyled:on!==void 0,rowExpanded:Nn,textWrapped:Pn!==void 0,height:Number(yt.height)},lt))]},St)},[$e,Ne,he,xt,Pt,Vt,pt,zt,Re,st.expanded,be,Pn,at.components.table.rowSelected,at.typography.fontSize,at.typography.body.lineHeight,ve,ot,on,Ae,ct]),Cn=Dt=>{const yt=zt(Dt),Ft=Re[yt];if(st.expanded[Ft.id]&&he)return le(he,Ft.index,be);if(Pn){const un=Ne.fields.filter(Un=>!Un.config.custom?.hidden).findIndex(Un=>Un.name===Pn.name),hn=at.typography.fontSize*at.typography.body.lineHeight;return(0,V.M2)(Pn.values[Dt],Ae[0].headers[un],ct,hn,be.rowHeight).height}return be.rowHeight},Ye=Dt=>{const{scrollTop:yt}=Dt.currentTarget;Pe.current!==null&&Pe.current.scrollTo(yt)};return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(h.A,{onScroll:Ye,hideHorizontalTrack:!0,scrollTop:wt,children:(0,t.jsx)(v._m,{height:ye,itemCount:Xe,itemSize:Cn,width:"100%",ref:Pe,style:{overflow:void 0},children:({index:Dt,style:yt})=>_n({index:Dt,style:yt,rowHighlightIndex:Ie})},Ke+Je)})})};function re(Be,Ne){(0,n.useEffect)(()=>{if(Be.current&&Ne.current){const Re=Be.current.querySelector(".track-vertical"),Se=Ne.current.firstChild;Se&&Re&&(Re.remove(),Se instanceof HTMLElement&&(Se.querySelector(":scope > .track-vertical")?.remove(),Se.append(Re)))}})}function ce(Be,Ne,Re,Se){const We=JSON.stringify(Object.keys(Be.expanded));(0,n.useEffect)(()=>{let Ke=0;Se||(Number.isFinite(Be.lastExpandedOrCollapsedIndex)&&(Ke=Be.lastExpandedOrCollapsedIndex),Ke=Be.pageIndex===0?Ke-1:Ke-Be.pageIndex-Be.pageIndex*Be.pageSize),Ne.current?.resetAfterIndex(Math.max(Ke,0))},[Be.lastExpandedOrCollapsedIndex,Be.pageSize,Be.pageIndex,Ne,Re,We,Se])}var me=e(28240);function ee({onColumnResize:Be,onSortByChange:Ne,data:Re}){return(0,n.useCallback)((Se,We)=>{switch(We.type){case"columnDoneResizing":if(Be){const Xe=Se.columnResizing?.headerIdWidths?.[0]?.[0],Je=parseInt(Xe,10),st=Math.round(Se.columnResizing.columnWidths?.[Xe]),pt=Re.fields?.[Je];if(!pt)return Se;const xt=(0,me.Ct)(pt,Re);Be(xt,st)}case"toggleSortBy":if(Ne){const Ke=[];for(const Xe of Se.sortBy){const Je=Re.fields[parseInt(Xe.id,10)];Je&&Ke.push({displayName:(0,me.Ct)(Je,Re),desc:Xe.desc})}Ne(Ke)}case"toggleRowExpanded":if(We.id)return{...Se,lastExpandedOrCollapsedIndex:parseInt(We.id,10)}}return Se},[Re,Be,Ne])}function de(Be,Ne){const Re={};if(Be){Re.sortBy=[];for(const Se of Be)for(const We of Ne)We.Header===Se.displayName&&Re.sortBy.push({id:We.id,desc:Se.desc})}return Re}var De=e(69770);const fe=150,Te=36,je="No data",He=(0,n.memo)(Be=>{const{ariaLabel:Ne,data:Re,height:Se,onCellFilterAdded:We,width:Ke,columnMinWidth:Xe=fe,noHeader:Je,resizable:st=!0,initialSortBy:pt,footerOptions:xt,showTypeIcons:ot,footerValues:$e,enablePagination:ve,cellHeight:be=c.qM.Sm,timeRange:he,enableSharedCrosshair:ye=!1,initialRowIndex:Pe=void 0,fieldConfig:ge}=Be,xe=(0,n.useRef)(null),Ae=(0,n.useRef)(null),Ee=(0,n.useRef)(null),Ie=(0,o.$j)(),Qe=(0,De.k)(Ie,be),at=Je?0:Qe.rowHeight,[ft,ct]=(0,n.useState)($e),vt=ge?.defaults?.noValue??je,Pt=(0,n.useMemo)(()=>{const ln=Te;let yn=0;if(!ft)return 0;for(const Sn of ft)Array.isArray(Sn)&&Sn.length>yn&&(yn=Sn.length);return yn>1?ln*yn:ln},[ft]),Vt=(0,n.useMemo)(()=>Re.fields.length?Array(Re.length).fill(0):[],[Re]),Jt=!!(xt?.countRows&&xt.reducer&&xt.reducer.length&&xt.reducer[0]===s.gy.count),wt=Re.fields.find(ln=>ln.type===r.PU.nestedFrames),zt=wt!==void 0,on=(0,n.useMemo)(()=>(0,V.GH)(Re,Ke,Xe,zt,ft,Jt),[Re,Ke,Xe,ft,zt,Jt]),Pn=(0,n.useRef)(),_n=ee({...Be,onSortByChange:ln=>{Pn.current(!1),Be.onSortByChange&&Be.onSortByChange(ln)}}),Cn=!!Re.meta?.uniqueRowIdFields?.length,Ye=(0,n.useMemo)(()=>{const ln={columns:on,data:Vt,disableResizing:!st,stateReducer:_n,autoResetPage:!1,initialState:de(pt,on),autoResetFilters:!1,sortTypes:{number:V.Ok,"alphanumeric-insensitive":V.IM}};return Cn&&(ln.getRowId=(yn,Sn)=>(0,f.t9)(Re,Sn),ln.autoResetExpanded=!1),ln},[pt,on,Vt,st,_n,Cn,Re]),{getTableProps:Dt,headerGroups:yt,footerGroups:Ft,rows:an,prepareRow:un,totalColumnsWidth:hn,page:Un,state:Nn,gotoPage:St,setPageSize:nn,pageOptions:ht,toggleAllRowsExpanded:lt}=(0,i.useTable)(Ye,i.useFilters,i.useSortBy,i.useAbsoluteLayout,i.useResizeColumns,i.useExpanded,i.usePagination),gt=Nn;Pn.current=lt,(0,n.useEffect)(()=>{xt||ct($e)},[$e,xt]),(0,n.useEffect)(()=>{if(!xt)return;if(!xt.show){ct(void 0);return}if(Jt){const yn=[];yn[0]=an.length.toString()??Re.length.toString(),ct(yn);return}const ln=(0,V.Ux)(yt[0].headers,(0,V.XX)(an),xt,Ie);ct(ln)},[xt,Ie,Nn.filters,Re]);let $t=Se-(at+Pt);ve&&($t-=Qe.cellHeight);const et=Math.round($t/Qe.rowHeight)-1;(0,n.useEffect)(()=>{et<=0||nn(et)},[et,nn]),(0,n.useEffect)(()=>{Re.length/et<Nn.pageIndex&&St(0)},[Re]),ce(gt,xe,Re,Cn),re(Ee,Ae);const Et=(0,n.useCallback)(ln=>{St(ln-1)},[St]),It=ve?Un.length:an.length;let Qt=null;if(ve){const ln=Nn.pageIndex*Nn.pageSize+1;let yn=ln+Nn.pageSize-1;const Sn=Ke<550;yn>Re.length&&(yn=Re.length),Qt=(0,t.jsxs)("div",{className:Qe.paginationWrapper,children:[(0,t.jsx)(g.d,{currentPage:Nn.pageIndex+1,numberOfPages:ht.length,showSmallVersion:Sn,onNavigate:Et}),Sn?null:(0,t.jsxs)("div",{className:Qe.paginationSummary,children:[ln," - ",yn<an.length?yn:an.length," of ",an.length," rows"]})]})}const sn=(0,V.O4)(ge,Re);return(0,t.jsxs)("div",{...Dt(),className:Qe.table,"aria-label":Ne,role:"table",ref:Ae,style:{width:Ke,height:Se},children:[(0,t.jsx)(h.E,{hideVerticalTrack:!0,children:(0,t.jsxs)("div",{className:Qe.tableContentWrapper(hn),children:[!Je&&(0,t.jsx)(Z,{headerGroups:yt,showTypeIcons:ot,tableStyles:Qe}),It>0?(0,t.jsx)("div",{"data-testid":a.Tp.components.Panels.Visualization.Table.body,ref:Ee,children:(0,t.jsx)(ae,{headerGroups:yt,data:Re,rows:an,width:Ke,cellHeight:be,headerHeight:at,rowHeight:Qe.rowHeight,itemCount:It,pageIndex:Nn.pageIndex,listHeight:$t,listRef:xe,tableState:Nn,prepareRow:un,timeRange:he,onCellFilterAdded:We,nestedDataField:wt,tableStyles:Qe,footerPaginationEnabled:!!ve,enableSharedCrosshair:ye,initialRowIndex:Pe,longestField:sn})}):(0,t.jsx)("div",{style:{height:Se-at,width:Ke},className:Qe.noData,children:vt}),ft&&(0,t.jsx)(l.u,{isPaginationVisible:!!ve,footerValues:ft,footerGroups:Ft,totalColumnsWidth:hn,tableStyles:Qe})]})}),Qt]})});He.displayName="Table"},49618:(G,O,e)=>{"use strict";e.d(O,{n:()=>n});var t=e(74848);const n=({cell:i,tableStyles:s,onCellFilterAdded:r,timeRange:f,userProps:a,frame:c,rowStyled:o,rowExpanded:h,textWrapped:g,height:l})=>{const p=i.getCellProps(),m=i.column.field;if(!m?.display)return null;if(p.style){p.style.minWidth=p.style.width;const d=i.column.justifyContent;d==="flex-end"&&!m.config.unit?(p.style.textAlign="right",p.style.direction="rtl"):p.style.justifyContent=d}let y=(typeof i.column.width=="number"?i.column.width:24)-s.cellPadding*2;return(0,t.jsx)(t.Fragment,{children:i.render("Cell",{field:m,tableStyles:s,onCellFilterAdded:r,cellProps:p,innerWidth:y,timeRange:f,userProps:a,frame:c,rowStyled:o,rowExpanded:h,textWrapped:g,height:l})})}},69770:(G,O,e)=>{"use strict";e.d(O,{k:()=>n});var t=e(32196);function n(s,r){const f=s.colors.border.weak,a=s.colors.primary.border,c=6,o=i(s,r,c),h=o+2,g=28,l=(p,m,y,d,v,u,D,P,x)=>(0,t.css)({label:d?"cellContainerOverflow":"cellContainerNoOverflow",padding:`${c}px`,width:"100%",height:x?"auto !important":`${h-1}px`,wordBreak:D?"break-all":"inherit",display:"flex",...v?{overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap"}:{},alignItems:"center",borderRight:`1px solid ${f}`,color:P?"inherit":p??void 0,background:P?void 0:m??void 0,backgroundClip:"padding-box","&:last-child:not(:only-child)":{borderRight:"none"},"&:hover":{overflow:d&&!D?"visible":void 0,width:u||!d?"auto":"auto !important",height:(u||d)&&!D?"auto !important":`${h-1}px`,minHeight:`${h-1}px`,wordBreak:u?"break-word":void 0,whiteSpace:u&&d?"normal":"nowrap",boxShadow:d?`0 0 2px ${s.colors.primary.main}`:void 0,background:P?"inherit":y??s.colors.background.primary,zIndex:1,".cellActions":{color:"#FFF",visibility:"visible",opacity:1,width:"auto",background:"rgba(0, 0, 0, 0.6)"}},a:{color:"inherit"},".cellActions":{display:"flex",position:d?void 0:"absolute",top:d?void 0:"1px",right:d?void 0:0,margin:d?s.spacing(0,-.5,0,.5):"auto",visibility:"hidden",opacity:0,width:0,alignItems:"center",height:"100%",padding:s.spacing(1,.5,1,1),background:m?"none":"rgba(0, 0, 0, 0.5)",svg:{color:p}},".cellActionsLeft":{right:"auto !important",left:0},".cellActionsTransparent":{background:"none"}});return{theme:s,cellHeight:o,buildCellContainerStyle:l,cellPadding:c,cellHeightInner:o-c*2,rowHeight:h,table:(0,t.css)({height:"100%",width:"100%",overflow:"auto",display:"flex",flexDirection:"column"}),thead:(0,t.css)({label:"thead",height:`${g}px`,overflowY:"auto",overflowX:"hidden",position:"relative"}),tfoot:(0,t.css)({label:"tfoot",height:`${g}px`,borderTop:`1px solid ${f}`,overflowY:"auto",overflowX:"hidden",position:"relative"}),headerRow:(0,t.css)({label:"row",borderBottom:`1px solid ${f}`}),headerCell:(0,t.css)({height:"100%",padding:`0 ${c}px`,overflow:"hidden",whiteSpace:"nowrap",display:"flex",alignItems:"center",fontWeight:s.typography.fontWeightMedium,"&:last-child":{borderRight:"none"}}),headerCellLabel:(0,t.css)({border:"none",padding:0,background:"inherit",cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontWeight:s.typography.fontWeightMedium,display:"flex",alignItems:"center",marginRight:s.spacing(.5),"&:hover":{textDecoration:"underline",color:s.colors.text.link}}),cellContainerText:l(void 0,void 0,void 0,!0,!0),cellContainerTextNoOverflow:l(void 0,void 0,void 0,!1,!0),cellContainer:l(void 0,void 0,void 0,!0,!1),cellContainerNoOverflow:l(void 0,void 0,void 0,!1,!1),cellText:(0,t.css)({overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap"}),sortIcon:(0,t.css)({marginLeft:s.spacing(.5)}),cellLink:(0,t.css)({cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap",color:s.colors.text.link,fontWeight:s.typography.fontWeightMedium,paddingRight:s.spacing(1.5),"&:hover":{textDecoration:"underline",color:s.colors.text.link}}),cellLinkForColoredCell:(0,t.css)({cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap",fontWeight:s.typography.fontWeightMedium,textDecoration:"underline"}),imageCellLink:(0,t.css)({cursor:"pointer",overflow:"hidden",height:"100%"}),headerFilter:(0,t.css)({background:"transparent",border:"none",label:"headerFilter",padding:0}),paginationWrapper:(0,t.css)({display:"flex",height:`${o}px`,justifyContent:"center",alignItems:"center",width:"100%",li:{marginBottom:0}}),paginationSummary:(0,t.css)({color:s.colors.text.secondary,fontSize:s.typography.bodySmall.fontSize,display:"flex",justifyContent:"flex-end",padding:s.spacing(0,1,0,2)}),tableContentWrapper:p=>{const m=p!==void 0?`${p}px`:"100%";return(0,t.css)({label:"tableContentWrapper",width:m,display:"flex",flexDirection:"column"})},row:(0,t.css)({label:"row",borderBottom:`1px solid ${f}`,"&:hover":{backgroundColor:s.components.table.rowHoverBackground},"&:last-child":{borderBottom:0}}),imageCell:(0,t.css)({height:"100%"}),resizeHandle:(0,t.css)({label:"resizeHandle",cursor:"col-resize !important",display:"inline-block",background:a,opacity:0,[s.transitions.handleMotion("no-preference","reduce")]:{transition:"opacity 0.2s ease-in-out"},width:"8px",height:"100%",position:"absolute",right:"-4px",borderRadius:s.shape.radius.default,top:0,touchAction:"none","&:hover":{opacity:1}}),typeIcon:(0,t.css)({marginRight:s.spacing(1),color:s.colors.text.secondary}),noData:(0,t.css)({alignItems:"center",display:"flex",height:"100%",justifyContent:"center",width:"100%"}),expanderCell:(0,t.css)({display:"flex",flexDirection:"column",justifyContent:"center",height:`${h}px`,cursor:"pointer"})}}function i(s,r,f){const a=s.typography.fontSize,c=s.typography.body.lineHeight;switch(r){case"md":return 42;case"lg":return 48;case"sm":default:return f*2+a*c}}},88407:(G,O,e)=>{"use strict";e.d(O,{Zi:()=>n,mc:()=>t});const t="=",n="!="},57021:(G,O,e)=>{"use strict";e.d(O,{jV:()=>z,HY:()=>Je,MY:()=>re,XX:()=>Be,zi:()=>Ke,HW:()=>st,bk:()=>Re,GH:()=>le,Sj:()=>de,Ux:()=>je,j1:()=>te,O4:()=>xt,M2:()=>pt,Iy:()=>Xe,o7:()=>Se,IM:()=>De,Ok:()=>fe,Yz:()=>me});var t=e(2543),n=e(47078),i=e.n(n),s=e(84140),r=e(11261),f=e(28240),a=e(14236),c=e(19845),o=e(83195),h=e(75059),g=e(57875),l=e(52622),p=e(24284),m=e(74848),y=e(50082),d=e(58563),v=e(47070),u=e(97696),D=e(59796);const P={mode:y.O.Absolute,steps:[{color:"blue",value:-1/0},{color:"green",value:20}]},x=ot=>{const{field:$e,innerWidth:ve,tableStyles:be,cell:he,cellProps:ye,row:Pe}=ot,ge=$e.display(he.value),xe=Re($e);let Ae=(0,d.xg)($e,!1);Ae.thresholds||(Ae={...Ae,thresholds:P});let Ee=l.eX.Gradient,Ie;xe.type===l.ob.Gauge&&(Ee=xe.mode??l.eX.Gradient,Ie=xe.valueDisplayMode!==void 0?xe.valueDisplayMode:l.$l.Text);const Qe=()=>(0,t.isFunction)($e.getLinks)?$e.getLinks({valueRowIndex:Pe.index}):[],at=!!Qe().length,ft=Ke($e,ge,he.row.index),ct=vt=>{const{openMenu:Pt,targetClassName:Vt}=vt;return(0,m.jsx)(u.xE,{width:ve,height:be.cellHeightInner,field:Ae,display:$e.display,text:{valueSize:14},value:ge,orientation:v.wV.Horizontal,theme:be.theme,alignmentFactors:ft,onClick:Pt,className:Vt,itemSpacing:1,lcdCellWidth:8,displayMode:Ee,valueDisplayMode:Ie})};return(0,m.jsxs)("div",{...ye,className:be.cellContainer,children:[at&&(0,m.jsx)(D.e,{links:Qe,style:{display:"flex",width:"100%"},children:vt=>ct(vt)}),!at&&ct({})]})};var E=e(90914);const C=ot=>{const{field:$e,row:ve,cellProps:be,tableStyles:he}=ot,ye=(0,E.k)($e,ve);return(0,m.jsx)("div",{...be,className:he.cellContainerText,children:ye&&ye.map((Pe,ge)=>(0,m.jsx)("span",{className:he.cellLink,onClick:Pe.onClick,children:(0,m.jsx)("a",{href:Pe.href,target:Pe.target,children:Pe.title})},ge))})};var M=e(32196),S=e(96540),I=e(40845),T=e(55852),b=e(29158),R=e(67061),A=e(10534),L=e(87978),U=e(32372);function W({value:ot,onDismiss:$e,mode:ve}){let be=ot;if((0,t.isString)(ot)){const ye=ot.trim();if(ye[0]==="{"||ye[0]==="["||ve==="code")try{ot=JSON.parse(ot),ve="code"}catch{ve="text"}else ve="text"}else be=JSON.stringify(ot,null," ");let he=be;return ve==="code"&&(he=JSON.stringify(ot,null," ")),(0,m.jsxs)(L._,{onClose:$e,title:"Inspect value",children:[ve==="code"?(0,m.jsx)(U.B,{width:"100%",height:500,language:"json",showLineNumbers:!0,showMiniMap:(he&&he.length)>100,value:he,readOnly:!0}):(0,m.jsx)("pre",{children:he}),(0,m.jsx)(A.b,{icon:"copy",getText:()=>he,children:"Copy to Clipboard"})]})}var w=e(88407);function N({field:ot,cell:$e,previewMode:ve,showFilters:be,onCellFilterAdded:he}){const[ye,Pe]=(0,S.useState)(!1),ge=te(ot)==="flex-end",xe=!!ot.config.custom?.inspect,Ae={size:"sm",tooltipPlacement:"top"},Ee=(0,S.useCallback)(Qe=>{he&&he({key:ot.name,operator:w.mc,value:$e.value})},[$e,ot,he]),Ie=(0,S.useCallback)(Qe=>{he&&he({key:ot.name,operator:w.Zi,value:$e.value})},[$e,ot,he]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:`cellActions${ge?" cellActionsLeft":""}`,children:(0,m.jsxs)(R.B,{gap:.5,children:[xe&&(0,m.jsx)(b.K,{name:"eye",tooltip:"Inspect value",onClick:()=>{Pe(!0)},...Ae}),be&&(0,m.jsx)(b.K,{name:"search-plus",onClick:Ee,tooltip:"Filter for value",...Ae}),be&&(0,m.jsx)(b.K,{name:"search-minus",onClick:Ie,tooltip:"Filter out value",...Ae})]})}),ye&&(0,m.jsx)(W,{mode:ve,value:$e.value,onDismiss:()=>{Pe(!1)}})]})}const B=ot=>{const{field:$e,cell:ve,tableStyles:be,row:he,cellProps:ye,frame:Pe,rowStyled:ge,rowExpanded:xe,textWrapped:Ae,height:Ee}=ot,Ie=!!$e.config.custom?.inspect,Qe=$e.display(ve.value),at=ot.onCellFilterAdded&&$e.config.filterable,ft=at&&ve.value!==void 0||Ie,ct=Re($e),vt=!!(0,E.k)($e,he)?.length,Pt=(0,I.of)(T.Ez),[Vt,Jt]=(0,S.useState)(!1);let wt;const zt=140,on=()=>{Jt(!1)},Pn=()=>{Jt(!0)};if(ct.type===l.ob.Custom){const Ft=ct.cellComponent;wt=(0,m.jsx)(Ft,{field:$e,value:ve.value,rowIndex:he.index,frame:Pe})}else S.isValidElement(ve.value)?wt=ve.value:wt=(0,o.cN)(Qe);const _n=typeof wt=="string",Cn=Qe.text.length<=zt&&/\s/.test(Qe.text),Ye=V(be,ct,Qe,Ie,_n,Cn,Ae,ge,xe);if(_n){let Ft=ye.style?.justifyContent;Ft==="flex-end"?ye.style={...ye.style,textAlign:"right"}:Ft==="center"&&(ye.style={...ye.style,textAlign:"center"})}Ee&&(ye.style={...ye.style,height:Ee}),Ae&&(ye.style={...ye.style,textWrap:"wrap"});const{key:Dt,...yt}=ye;return(0,m.jsxs)("div",{...yt,onMouseEnter:ft?Pn:void 0,onMouseLeave:ft?on:void 0,className:Ye,children:[!vt&&(_n?`${wt}`:(0,m.jsx)("div",{className:be.cellText,children:wt})),vt&&(0,m.jsx)(D.e,{links:()=>(0,E.k)($e,he)||[],children:Ft=>Ft.openMenu?(0,m.jsx)("button",{className:(0,M.cx)(Pt,K(be,ct,Ft.targetClassName)),onClick:Ft.openMenu,children:wt}):(0,m.jsx)("div",{className:K(be,ct,Ft.targetClassName),children:wt})}),Vt&&ft&&(0,m.jsx)(N,{...ot,previewMode:"text",showFilters:at})]},Dt)};function V(ot,$e,ve,be=!1,he=!1,ye=!1,Pe=!1,ge=!1,xe=!1){let Ae,Ee,Ie;const Qe=st(ot,$e,ve);return Ae=Qe.textColor,Ee=Qe.bgColor,Ie=Qe.bgHoverColor,ot.buildCellContainerStyle(Ae,Ee,Ie,!be,he,ye,Pe,ge,xe)}function K(ot,$e,ve){return $e.type===l.ob.Auto?(0,M.cx)(ot.cellLink,ve):(0,M.cx)(ot.cellLinkForColoredCell,ve)}var H=e(92015),X=e(64136),k=e(27430);function Y(ot){const{cell:$e,tableStyles:ve,cellProps:be}=ot;let he="";return $e.value instanceof k.A?he=new X.A().writeGeometry($e.value,{featureProjection:"EPSG:3857",dataProjection:"EPSG:4326"}):$e.value!=null&&(he=`${$e.value}`),(0,m.jsx)("div",{...be,className:ve.cellContainer,children:(0,m.jsx)("div",{className:ve.cellText,style:{fontFamily:"monospace"},children:he})})}const Z=10,se=ot=>{const{field:$e,cell:ve,tableStyles:be,row:he,cellProps:ye}=ot,Pe=Re($e),{title:ge,alt:xe}=Pe.type===l.ob.Image?Pe:{title:void 0,alt:void 0},Ae=$e.display(ve.value),Ee=!!(0,E.k)($e,he)?.length,Ie=(0,m.jsx)("img",{style:{height:be.cellHeight-Z,width:"auto"},src:Ae.text,className:be.imageCell,alt:xe,title:ge});return(0,m.jsxs)("div",{...ye,className:be.cellContainer,children:[!Ee&&Ie,Ee&&(0,m.jsx)(D.e,{style:{height:be.cellHeight-Z,width:"auto"},links:()=>(0,E.k)($e,he)||[],children:Qe=>Qe.openMenu?(0,m.jsx)("div",{onClick:Qe.openMenu,role:"button",tabIndex:0,onKeyDown:at=>{at.key==="Enter"&&Qe.openMenu&&Qe.openMenu(at)},children:Ie}):Ie})]})};function j(ot){const{cell:$e,tableStyles:ve,cellProps:be,field:he,row:ye}=ot,Pe=!!he.config.custom?.inspect,ge=(0,M.css)({cursor:"pointer",fontFamily:"monospace"});let xe=$e.value,Ae=xe;if((0,t.isString)(xe))try{xe=JSON.parse(xe)}catch{}else Ae=JSON.stringify(xe,null," ");const Ee=!!(0,E.k)(he,ye)?.length,Ie=(0,I.of)(T.Ez);return(0,m.jsxs)("div",{...be,className:Pe?ve.cellContainerNoOverflow:ve.cellContainer,children:[(0,m.jsxs)("div",{className:(0,M.cx)(ve.cellText,ge),children:[!Ee&&(0,m.jsx)("div",{className:ve.cellText,children:Ae}),Ee&&(0,m.jsx)(D.e,{links:()=>(0,E.k)(he,ye)||[],children:Qe=>Qe.openMenu?(0,m.jsx)(T.$n,{className:(0,M.cx)(Ie),onClick:Qe.openMenu,children:Ae}):(0,m.jsx)(m.Fragment,{children:Ae})})]}),Pe&&(0,m.jsx)(N,{...ot,previewMode:"code"})]})}var q=e(14578);function ne({row:ot,tableStyles:$e}){return(0,m.jsx)("div",{className:$e.expanderCell,...ot.getToggleRowExpandedProps(),children:(0,m.jsx)(q.I,{"aria-label":ot.isExpanded?"Collapse row":"Expand row",name:ot.isExpanded?"angle-down":"angle-right",size:"lg"})})}var oe=e(30355);const z=50;function te(ot){if(!ot)return"flex-start";if(ot.config.custom)switch(ot.config.custom.align){case"right":return"flex-end";case"left":return"flex-start";case"center":return"center"}return ot.type===r.PU.number?"flex-end":"flex-start"}function le(ot,$e,ve,be,he,ye){const Pe=[];let ge=0;be&&(Pe.push({Header:()=>null,id:"expander",Cell:ne,width:z,minWidth:z,filter:(Ae,Ee,Ie)=>[],justifyContent:"left",field:ot.fields[0],sortType:"basic"}),$e-=z);for(const[Ae,Ee]of ot.fields.entries()){const Ie=Ee.config.custom||{};if(Ie.hidden||Ee.type===r.PU.nestedFrames)continue;Ie.width?$e-=Ie.width:ge++;const Qe=ft=>{switch(ft){case r.PU.number:case r.PU.frame:return"number";case r.PU.time:return"basic";default:return"alphanumeric-insensitive"}},at=ie(Ie.cellOptions?.type,Ee);Pe.push({Cell:at,id:Ae.toString(),field:Ee,Header:Ie.hideHeader?"":(0,f.Ct)(Ee,ot),accessor:(ft,ct)=>Ee.values[ct],sortType:Qe(Ee.type),width:Ie.width,minWidth:Ie.minWidth??ve,filter:i()(ae(Ee)),justifyContent:te(Ee),Footer:(0,H.d)(Ae,he,ye)})}let xe=$e/ge;for(let Ae=ge;Ae>0;Ae--)for(const Ee of Pe)!Ee.width&&Ee.minWidth>xe&&(Ee.width=Ee.minWidth,$e-=Ee.width,ge-=1,xe=$e/ge);for(const Ae of Pe)Ae.width||(Ae.width=xe),Ae.minWidth=50;return Pe}function ie(ot,$e){switch(ot){case l.ob.Custom:case l.ob.ColorText:case l.ob.ColorBackground:return B;case l.ob.Image:return se;case l.ob.Gauge:return x;case l.ob.Sparkline:return oe.a;case l.ob.JSONView:return j;case l.ob.DataLinks:return C}if($e.type===r.PU.geo)return Y;if($e.type===r.PU.frame){const ve=$e.values[0];return(0,a.ci)(ve)&&(0,c.aH)(ve)?oe.a:j}return $e.type===r.PU.other?j:B}function ae(ot){return function($e,ve,be){return $e.length===0||!be||!ot?$e:$e.filter(he=>{if(!he.values.hasOwnProperty(ve))return!1;const ye=ce(he,ot);return be.find(Pe=>Pe.value===ye)!==void 0})}}function re(ot,$e){if(!$e||ot.length===0)return{};const ve={};for(let be=0;be<ot.length;be++){const he=ce(ot[be],$e);ve[he||"(Blanks)"]=he}return ve}function ce(ot,$e){if(!$e||!ot)return"";const ve=$e.values[ot.index],be=$e.display?$e.display(ve):ve;return $e.display?(0,o.cN)(be):be}function me(ot){return Object.keys(ot).reduce(($e,ve)=>$e.concat({value:ot[ve],label:ve}),[]).sort(ee)}function ee(ot,$e){return ot.label===void 0&&$e.label===void 0?0:ot.label===void 0&&$e.label!==void 0?-1:ot.label!==void 0&&$e.label===void 0?1:ot.label<$e.label?-1:ot.label>$e.label?1:0}function de(ot,$e){return $e?ot.filter(ve=>$e.some(be=>be.value===ve.value)):[]}function De(ot,$e,ve){return String(ot.values[ve]).localeCompare(String($e.values[ve]),void 0,{sensitivity:"base"})}function fe(ot,$e,ve){const be=Te(ot.values[ve]),he=Te($e.values[ve]);return be===he?0:be>he?1:-1}function Te(ot){return(0,a.LI)(ot)?ot.value??Number.NEGATIVE_INFINITY:ot==null||ot===""||isNaN(ot)?Number.NEGATIVE_INFINITY:typeof ot=="number"?ot:Number(ot)}function je(ot,$e,ve,be){return We(ot),ot.map((he,ye)=>{if(he?.field?.type!==r.PU.number)return ye===0&&ve.reducer&&ve.reducer.length>0?h.AS.get(ve.reducer[0]).name:void 0;let Pe=(0,t.clone)(he.field);return Pe.values=$e[he.id],Pe.state=void 0,he.field=Pe,ve.fields&&ve.fields.length>0?ve.fields.find(xe=>xe===he?.field?.name)?He(he.field,ve.reducer,be):void 0:He(he.field,ve.reducer||[],be)})}function He(ot,$e,ve){const be=$e[0];if(be===void 0)return"";const he=ot.display??(0,g.J)({field:ot,theme:ve}),ye=(0,h.Nw)({field:ot,reducers:$e})[be];return h.AS.get(be).preservesUnits?(0,o.cN)(he(ye)):(0,o.cN)({text:ye})}function Be(ot){const $e=[];for(const ve in ot)for(const[be,he]of Object.entries(ot[ve].values))$e[be]===void 0&&($e[be]=[]),$e[be].push(he);return $e}const Ne={type:l.ob.Auto};function Re(ot){return ot.config.custom?.displayMode?Se(ot.config.custom?.displayMode):ot.config.custom?.cellOptions?ot.config.custom.cellOptions:Ne}function Se(ot){switch(ot){case"basic":case"gradient-gauge":case"lcd-gauge":let $e=l.eX.Basic;return ot==="gradient-gauge"?$e=l.eX.Gradient:ot==="lcd-gauge"&&($e=l.eX.Lcd),{type:l.ob.Gauge,mode:$e};case"color-background":case"color-background-solid":let ve=l.Wq.Basic;return ot==="color-background"&&(ve=l.Wq.Gradient),{type:l.ob.ColorBackground,mode:ve};default:return{type:ot}}}function We(ot){const $e=ot.findIndex((ve,be)=>ve?.id!==String(be));$e===-1||ot[$e]?.id==="expander"||(ot.splice($e,0,{id:String($e)}),We(ot))}function Ke(ot,$e,ve){let be=ot.state?.alignmentFactors;if(be)return be.text.length<$e.text.length&&(be.text=$e.text),be;{be={...$e};const he=Math.min(ot.values.length,ve+1e3);for(let ye=ve+1;ye<he;ye++)ot.display(ot.values[ye]).text.length>be.text.length&&(be.text=$e.text);return ot.state?ot.state.alignmentFactors=be:ot.state={alignmentFactors:be},be}}function Xe(ot,$e,ve){return Math.abs(Math.floor(ot)-$e)<ve}function Je(ot){let $e=-Number.MAX_VALUE,ve=Number.MAX_VALUE;if(ot.values.length<2)return 0;for(let be=0;be<ot.values.length;be++){const he=ot.values[be];he>$e&&($e=he),he<ve&&(ve=he)}return($e-ve)/ot.values.length}function st(ot,$e,ve){const be=ot.theme.isDark?1:-.7;let he,ye,Pe;if($e.type===l.ob.ColorText)he=ve.color;else if($e.type===l.ob.ColorBackground){const ge=$e.mode??l.Wq.Gradient;if(ge===l.Wq.Basic)he=(0,p.mZ)(ve.color,ot.theme.isDark),ye=(0,s.A)(ve.color).toRgbString(),Pe=(0,s.A)(ve.color).setAlpha(1).toRgbString();else if(ge===l.Wq.Gradient){const xe=(0,s.A)(ve.color).setAlpha(1).toRgbString(),Ae=(0,s.A)(ve.color).darken(10*be).spin(5);he=(0,p.mZ)(ve.color,ot.theme.isDark),ye=`linear-gradient(120deg, ${Ae.toRgbString()}, ${ve.color})`,Pe=`linear-gradient(120deg, ${Ae.setAlpha(1).toRgbString()}, ${xe})`}}return{textColor:he,bgColor:ye,bgHoverColor:Pe}}function pt(ot,$e,ve,be,he){const ye=Number($e.width??300),Pe=1.17,ge=42;if(ve!==null&&typeof ot=="string"){const xe=ot.split(/\s/),Ae=[];let Ee="",Ie=0,Qe=0;for(let ct=0;ct<xe.length;ct++){const vt=xe[ct];let Pt=ve.measureText(Ee+" "+vt).width;Pt<ye?(Ee+=" "+vt,Ie++):(Ae.push({width:Pt,line:Ee}),Ee=vt,Ie=0)}for(let ct=0;ct<Ae.length;ct++)if(Ae[ct].width>ye){let vt=Math.floor(Ae[ct].width/ye)-1;Qe+=vt}let at=Ae.length+Qe,ft=38;return at>5?ft=at*be*Pe:ft=at*be+ge,{width:ye,height:ft}}return{width:ye,height:he}}function xt(ot,$e){let ve;if(ot!==void 0&&ot.defaults.custom!==void 0&&ot.defaults.custom.cellOptions.wrapText){const he=$e.fields.filter(ye=>ye.type===r.PU.string);if(he.length>=1&&he[0].values.length>0){const ye=he[0].values.length;let Pe=0;if(ye<=30)for(const ge of he){const xe=ge.values[0].length;xe>Pe&&(Pe=xe,ve=ge)}else for(const ge of he){const xe=(0,t.sampleSize)(ge.values,3),Ae=(xe[0]?.length+xe[1]?.length+xe[2]?.length)/3;Ae>Pe&&(Pe=Ae,ve=ge)}}}return ve}},53402:(G,O,e)=>{"use strict";e.d(O,{p:()=>r});var t=e(74848),n=e(32196),i=e(83195),s=e(40845);const r=({value:a})=>{const c=(0,s.of)(f);return(0,t.jsx)("span",{className:c.counter,children:(0,i.Hg)(a,0).text})},f=a=>({counter:(0,n.css)({label:"counter",marginLeft:a.spacing(1),borderRadius:a.spacing(3),backgroundColor:a.colors.action.hover,padding:a.spacing(.25,1),color:a.colors.text.secondary,fontWeight:a.typography.fontWeightMedium,fontSize:a.typography.size.sm})})},40675:(G,O,e)=>{"use strict";e.d(O,{o:()=>h});var t=e(74848),n=e(32196),i=e(96540),s=e(13544),r=e(40845),f=e(16797),a=e(55852),c=e(14578),o=e(53402);const h=i.forwardRef(({label:l,active:p,icon:m,onChangeTab:y,counter:d,suffix:v,className:u,href:D,...P},x)=>{const E=(0,r.of)(g),C=(0,r.of)(a.my),M=()=>(0,t.jsxs)(t.Fragment,{children:[m&&(0,t.jsx)(c.I,{name:m}),l,typeof d=="number"&&(0,t.jsx)(o.p,{value:d}),v&&(0,t.jsx)(v,{className:E.suffix})]}),I={className:(0,n.cx)(C,E.link,p?E.activeStyle:E.notActive),"data-testid":s.Tp.components.Tab.title(l),...P,onClick:y,role:"tab","aria-selected":p};return D?(0,t.jsx)("div",{className:E.item,children:(0,t.jsx)("a",{...I,href:D,ref:x,children:M()})}):(0,t.jsx)("div",{className:E.item,children:(0,t.jsx)("button",{...I,type:"button",ref:x,children:M()})})});h.displayName="Tab";const g=l=>({item:(0,n.css)({listStyle:"none",position:"relative",display:"flex",whiteSpace:"nowrap",padding:l.spacing(.5)}),link:(0,n.css)({color:l.colors.text.secondary,padding:l.spacing(1,1.5,.5),borderRadius:l.shape.radius.default,display:"block",height:"100%",svg:{marginRight:l.spacing(1)},"&:focus-visible":(0,f.getFocusStyles)(l),"&::before":{display:"block",content:'" "',position:"absolute",left:0,right:0,height:"4px",borderRadius:l.shape.radius.default,bottom:0}}),notActive:(0,n.css)({"a:hover, &:hover, &:focus":{color:l.colors.text.primary,"&::before":{backgroundColor:l.colors.action.hover}}}),activeStyle:(0,n.css)({label:"activeTabStyle",color:l.colors.text.primary,overflow:"hidden","&::before":{backgroundImage:l.colors.gradients.brandHorizontal}}),suffix:(0,n.css)({marginLeft:l.spacing(1)})})},40980:(G,O,e)=>{"use strict";e.d(O,{J:()=>s});var t=e(74848),n=e(32196),i=e(40845);const s=({children:f,className:a,...c})=>{const o=(0,i.of)(r);return(0,t.jsx)("div",{...c,className:(0,n.cx)(o.tabContent,a),children:f})},r=f=>({tabContent:(0,n.css)({background:f.colors.background.primary})})},63021:(G,O,e)=>{"use strict";e.d(O,{U:()=>r});var t=e(74848),n=e(32196),i=e(96540),s=e(40845);const r=(0,i.forwardRef)(({children:a,className:c,hideBorder:o=!1},h)=>{const g=(0,s.of)(f);return(0,t.jsx)("div",{className:(0,n.cx)(g.tabsWrapper,o&&g.noBorder,c),ref:h,children:(0,t.jsx)("div",{className:g.tabs,role:"tablist",children:a})})}),f=a=>({tabsWrapper:(0,n.css)({borderBottom:`1px solid ${a.colors.border.weak}`,overflowX:"auto"}),noBorder:(0,n.css)({borderBottom:0}),tabs:(0,n.css)({position:"relative",display:"flex",height:`${a.components.menuTabs.height}px`,alignItems:"center"})});r.displayName="TabsBar"},90685:(G,O,e)=>{"use strict";e.d(O,{s:()=>c});var t=e(74848),n=e(32196),i=e(96540),s=e(13544),r=e(40845),f=e(14578),a=e(53402);const c=(0,i.forwardRef)(({label:h,active:g,icon:l,counter:p,className:m,suffix:y,onChangeTab:d,href:v,...u},D)=>{const P=(0,r.of)(o),x=()=>(0,t.jsxs)(t.Fragment,{children:[l&&(0,t.jsx)(f.I,{name:l}),h,typeof p=="number"&&(0,t.jsx)(a.p,{value:p}),y&&(0,t.jsx)(y,{className:P.suffix})]}),E=(0,n.cx)(P.link,g&&P.activeStyle);return(0,t.jsx)("a",{href:v,className:E,...u,onClick:d,"aria-label":u["aria-label"]||s.Tp.components.Tab.title(h),role:"tab","aria-selected":g,ref:D,children:x()})});c.displayName="Tab";const o=h=>({link:(0,n.css)({padding:"6px 12px",display:"block",height:"100%",cursor:"pointer",position:"relative",color:h.colors.text.primary,svg:{marginRight:h.spacing(1)},"&:hover, &:focus":{textDecoration:"underline"}}),activeStyle:(0,n.css)({label:"activeTabStyle",color:h.colors.text.maxContrast,overflow:"hidden","&::before":{display:"block",content:'" "',position:"absolute",left:0,width:"4px",bottom:"2px",top:"2px",borderRadius:h.shape.radius.default,backgroundImage:"linear-gradient(0deg, #f05a28 30%, #fbca0a 99%)"}}),suffix:(0,n.css)({marginLeft:h.spacing(1)})})},79924:(G,O,e)=>{"use strict";e.d(O,{u:()=>g});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(55852),f=e(10354),a=e(69613),c=e(29158);const o=({name:p,disabled:m,onRemove:y})=>{const{color:d,borderColor:v}=(0,i.useMemo)(()=>(0,a.MC)(p),[p]),u=(0,s.of)(h);return(0,t.jsxs)("li",{className:u.itemStyle,style:{backgroundColor:d,borderColor:v},children:[(0,t.jsx)("span",{className:u.nameStyle,children:p}),(0,t.jsx)(c.K,{name:"times",size:"lg",disabled:m,tooltip:`Remove "${p}" tag`,onClick:()=>y(p),className:u.buttonStyles})]})},h=p=>{const m=p.spacing.gridSize*3;return{itemStyle:(0,n.css)({display:"flex",gap:"3px",alignItems:"center",height:`${m}px`,lineHeight:`${m-2}px`,color:"#fff",borderWidth:"1px",borderStyle:"solid",borderRadius:p.shape.radius.default,padding:`0 ${p.spacing(.5)}`,whiteSpace:"nowrap",textShadow:"none",fontWeight:500,fontSize:p.typography.size.sm}),nameStyle:(0,n.css)({maxWidth:"25ch",textOverflow:"ellipsis",overflow:"hidden"}),buttonStyles:(0,n.css)({margin:0,"&:hover::before":{display:"none"}})}},g=({placeholder:p="New tag (enter key to add)",tags:m=[],onChange:y,width:d,className:v,disabled:u,addOnBlur:D,invalid:P,id:x})=>{const[E,C]=(0,i.useState)(""),M=(0,s.of)(l),S=(0,s.$j)(),I=(0,i.useCallback)(L=>{C(L.target.value)},[]),T=L=>{y(m.filter(U=>U!==L))},b=L=>{L?.preventDefault(),m.includes(E)||y(m.concat(E)),C("")},R=()=>{D&&E&&b()},A=L=>{L.key==="Enter"&&E!==""&&b(L)};return(0,t.jsxs)("div",{className:(0,n.cx)(M.wrapper,v,d?(0,n.css)({width:S.spacing(d)}):""),children:[(0,t.jsx)(f.p,{id:x,disabled:u,placeholder:p,onChange:I,value:E,onKeyDown:A,onBlur:R,invalid:P,suffix:(0,t.jsx)(r.$n,{fill:"text",className:M.addButtonStyle,onClick:b,size:"md",disabled:E.length<=0,children:"Add"})}),m?.length>0&&(0,t.jsx)("ul",{className:M.tags,children:m.map(L=>(0,t.jsx)(o,{name:L,onRemove:T,disabled:u},L))})]})},l=p=>({wrapper:(0,n.css)({minHeight:p.spacing(4),display:"flex",flexDirection:"column",gap:p.spacing(1),flexWrap:"wrap"}),tags:(0,n.css)({display:"flex",justifyContent:"flex-start",flexWrap:"wrap",gap:p.spacing(.5)}),addButtonStyle:(0,n.css)({margin:`0 -${p.spacing(1)}`})})},78369:(G,O,e)=>{"use strict";e.d(O,{v:()=>g});var t=e(74848),n=e(32196),i=e(96540),s=e(70255),r=e(40845),f=e(69613),a=e(72129),c=e(14578);const o=(0,i.forwardRef)(({name:m,onClick:y,icon:d,className:v,colorIndex:u,...D},P)=>{const x=(0,r.$j)(),E=p(x,m,u),C=S=>{S.preventDefault(),S.stopPropagation(),y?.(m,S)},M=(0,n.cx)(E.wrapper,v,{[E.hover]:y!==void 0});return y?(0,t.jsxs)("button",{...D,className:M,onClick:C,ref:P,children:[d&&(0,t.jsx)(c.I,{name:d}),m]}):(0,t.jsxs)("span",{...D,className:M,ref:P,children:[d&&(0,t.jsx)(c.I,{name:d}),m]})});o.displayName="Tag";const h=({rootProps:m})=>{const y=(0,r.of)(l);return(0,t.jsx)(s.A,{width:60,height:22,containerClassName:y.container,...m})},g=(0,a.j)(o,h),l=()=>({container:(0,n.css)({lineHeight:1})}),p=(m,y,d)=>{let v;return d===void 0?v=(0,f.MC)(y):v=(0,f.yC)(d),{wrapper:(0,n.css)({appearance:"none",borderStyle:"none",fontWeight:m.typography.fontWeightMedium,fontSize:m.typography.size.sm,lineHeight:m.typography.bodySmall.lineHeight,verticalAlign:"baseline",backgroundColor:v.color,color:m.v1.palette.gray98,whiteSpace:"pre",textShadow:"none",padding:"3px 6px",borderRadius:m.shape.radius.default}),hover:(0,n.css)({"&:hover":{opacity:.85,cursor:"pointer"}})}}},64149:(G,O,e)=>{"use strict";e.d(O,{L:()=>o});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(72129),f=e(78369);const a=(0,i.memo)((0,i.forwardRef)(({displayMax:l,tags:p,icon:m,onClick:y,className:d,getAriaLabel:v,getColorIndex:u},D)=>{const P=(0,s.$j)(),x=g(P,!!(l&&l>0)),E=p.length,C=l?p.slice(0,l):p;return(0,t.jsxs)("ul",{className:(0,n.cx)(x.wrapper,d),"aria-label":"Tags",ref:D,children:[C.map((M,S)=>(0,t.jsx)("li",{className:x.li,children:(0,t.jsx)(f.v,{name:M,icon:m,onClick:y,"aria-label":v?.(M,S),"data-tag-id":S,colorIndex:u?.(M,S)})},M)),l&&l>0&&E-l>0&&(0,t.jsxs)("span",{className:x.moreTagsLabel,children:["+ ",E-l]})]})}));a.displayName="TagList";const c=({rootProps:l})=>{const p=(0,s.of)(h);return(0,t.jsxs)("div",{className:p.container,...l,children:[(0,t.jsx)(f.v.Skeleton,{}),(0,t.jsx)(f.v.Skeleton,{})]})},o=(0,r.j)(a,c),h=l=>({container:(0,n.css)({display:"flex",gap:l.spacing(1)})}),g=(l,p)=>({wrapper:(0,n.css)({position:"relative",alignItems:p?"center":"unset",display:"flex",flex:"1 1 auto",flexWrap:"wrap",flexShrink:p?0:1,justifyContent:"flex-end",gap:"6px"}),moreTagsLabel:(0,n.css)({color:l.colors.text.secondary,fontSize:l.typography.size.sm}),li:(0,n.css)({listStyle:"none"})})},21744:(G,O,e)=>{"use strict";e.d(O,{f:()=>f});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(87266);const f=(0,i.forwardRef)(({invalid:c,className:o,...h},g)=>{const l=(0,s.of)(a,c);return(0,t.jsx)("textarea",{...h,className:(0,n.cx)(l.textarea,o),ref:g})}),a=(c,o=!1)=>({textarea:(0,n.cx)((0,r.Xb)(c),(0,r.gm)(c),(0,n.css)({display:"block",borderRadius:c.shape.radius.default,padding:`${c.spacing.gridSize/4}px ${c.spacing.gridSize}px`,width:"100%",borderColor:o?c.colors.error.border:c.components.input.borderColor}))});f.displayName="TextArea"},94753:(G,O,e)=>{"use strict";e.d(O,{E:()=>o});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(65848),f=e(56034);const a=i.forwardRef(({childElement:g,children:l},p)=>{const[m,y]=(0,i.useState)(!1),d=(0,i.useRef)(null);(0,i.useImperativeHandle)(p,()=>d.current);const v=(0,i.useMemo)(()=>new ResizeObserver(D=>{for(const P of D)P.target.clientWidth&&P.target.scrollWidth&&(P.target.scrollWidth>P.target.clientWidth&&y(!0),P.target.scrollWidth<=P.target.clientWidth&&y(!1))}),[]);(0,i.useEffect)(()=>{const{current:D}=d;return D&&v.observe(D),()=>{v.disconnect()}},[y,v]);const u=D=>typeof D=="string"?D:r.renderToStaticMarkup((0,t.jsx)(t.Fragment,{children:D})).replace(/(<([^>]+)>)/gi,"");return m?(0,t.jsx)(f.m,{ref:d,content:u(l),children:g(void 0)}):g(d)});a.displayName="TruncatedText";var c=e(71356);const o=i.forwardRef(({element:g="span",variant:l,weight:p,color:m,truncate:y,italic:d,textAlignment:v,children:u,tabular:D,...P},x)=>{const E=(0,s.of)(h,g,l,m,p,y,d,v,D),C=M=>(0,i.createElement)(g,{...P,style:void 0,className:E,ref:M},u);return!y||g==="span"?C(void 0):(0,t.jsx)(a,{childElement:C,children:u,ref:x})});o.displayName="Text";const h=(g,l,p,m,y,d,v,u,D)=>(0,n.css)([{margin:0,padding:0,...(0,c.d$)(g,l,p)},p&&{...g.typography[p]},m&&{color:(0,c.vT)(m,g)},y&&{fontWeight:(0,c.iV)(y,g)},d&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},v&&{fontStyle:"italic"},u&&{textAlign:u},D&&{fontFeatureSettings:'"tnum"'}])},71356:(G,O,e)=>{"use strict";e.d(O,{d$:()=>i,iV:()=>t,vT:()=>n});const t=(s,r)=>{switch(s){case"bold":return r.typography.fontWeightBold;case"medium":return r.typography.fontWeightMedium;case"light":return r.typography.fontWeightLight;case"regular":case void 0:return r.typography.fontWeightRegular}},n=(s,r)=>{switch(s){case"error":return r.colors.error.text;case"success":return r.colors.success.text;case"info":return r.colors.info.text;case"warning":return r.colors.warning.text;default:return s?r.colors.text[s]:void 0}},i=(s,r,f)=>{if(f)return s.typography[f];switch(r){case"span":return;case"h1":return s.typography.h1;case"h2":return s.typography.h2;case"h3":return s.typography.h3;case"h4":return s.typography.h4;case"h5":return s.typography.h5;case"h6":return s.typography.h6;default:return s.typography.body}}},60782:(G,O,e)=>{"use strict";e.d(O,{G:()=>h});var t=e(74848),n=e(32196),i=e(34743),s=e(36376),r=e(7315),f=e(96540),a=e(40845),c=e(18976),o=e(29158);const h=(0,f.memo)(({children:l,theme:p="info",placement:m="auto",content:y,title:d,closeButton:v=!0,onClose:u,footer:D,fitContent:P=!1,onOpen:x,show:E})=>{const C=(0,f.useRef)(null),M=(0,a.$j)(),S=(0,a.of)(g),I=S[p],[T,b]=(0,f.useState)(E),R=E??T,A=[(0,i.cY)(8),(0,i.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,i.BN)(),(0,i.UE)({element:C})],{context:L,refs:U,floatingStyles:W}=(0,s.we)({open:R,placement:(0,c.O)(m),onOpenChange:K=>{E===void 0&&b(K),K?x?.():u?.()},middleware:A,whileElementsMounted:r.ll,strategy:"fixed"}),w=(0,s.kp)(L),N=(0,s.s9)(L),{getReferenceProps:B,getFloatingProps:V}=(0,s.bv)([N,w]);return(0,t.jsxs)(t.Fragment,{children:[(0,f.cloneElement)(l,{ref:U.setReference,tabIndex:0,"aria-expanded":R,...B()}),R&&(0,t.jsx)(s.s3,{context:L,modal:!1,closeOnFocusOut:!1,children:(0,t.jsxs)("div",{"data-testid":"toggletip-content",className:(0,n.cx)(I.container,{[S.fitContent]:P}),ref:U.setFloating,style:W,...V(),children:[(0,t.jsx)(s.ie,{strokeWidth:.3,stroke:M.colors.border.weak,className:I.arrow,ref:C,context:L}),!!d&&(0,t.jsx)("div",{className:I.header,children:d}),v&&(0,t.jsx)("div",{className:I.headerClose,children:(0,t.jsx)(o.K,{"aria-label":"Close",name:"times","data-testid":"toggletip-header-close",onClick:()=>{b(!1),u?.()}})}),(0,t.jsxs)("div",{className:I.body,children:[(typeof y=="string"||(0,f.isValidElement)(y))&&y,typeof y=="function"&&y({})]}),!!D&&(0,t.jsx)("div",{className:I.footer,children:D})]})})]})});h.displayName="Toggletip";const g=l=>{const p=(0,c.f)(l,l.colors.background.primary,l.colors.border.weak,l.components.tooltip.text,{topBottom:2,rightLeft:2}),m=(0,c.f)(l,l.colors.error.main,l.colors.error.main,l.colors.error.contrastText,{topBottom:2,rightLeft:2});return{info:p,error:m,fitContent:(0,n.css)({maxWidth:"fit-content"})}}},27746:(G,O,e)=>{"use strict";e.d(O,{I:()=>g});var t=e(74848),n=e(32196),i=e(96540),s=e(8887),r=e(13544),f=e(40845),a=e(16797),c=e(55852),o=e(14578),h=e(56034);const g=(0,i.forwardRef)(({tooltip:y,icon:d,iconSize:v,className:u,children:D,imgSrc:P,imgAlt:x,fullWidth:E,isOpen:C,narrow:M,variant:S="default",iconOnly:I,"aria-label":T,isHighlighted:b,...R},A)=>{const L=(0,f.of)(m),U=(0,n.cx)({[L.button]:!0,[L.buttonFullWidth]:E,[L.narrow]:M},L[S],u),W=(0,n.cx)({[L.content]:!0,[L.contentWithIcon]:!!d,[L.contentWithRightIcon]:C!==void 0}),w=(0,t.jsxs)("button",{ref:A,className:U,"aria-label":l(T,y),"aria-expanded":C,...R,children:[p(d,v),P&&(0,t.jsx)("img",{className:L.img,src:P,alt:x??""}),D&&!I&&(0,t.jsx)("div",{className:W,children:D}),C===!1&&(0,t.jsx)(o.I,{name:"angle-down"}),C===!0&&(0,t.jsx)(o.I,{name:"angle-up"}),b&&(0,t.jsx)("div",{className:L.highlight})]});return y?(0,t.jsx)(h.m,{ref:A,content:y,placement:"bottom",children:w}):w});g.displayName="ToolbarButton";function l(y,d){return y||(d?r.Tp.components.PageToolbar.item(d):void 0)}function p(y,d){return y?(0,s.n6)(y)?(0,t.jsx)(o.I,{name:y,size:`${d||"lg"}`}):y:null}const m=y=>{const d=(0,c.U_)(y,"primary","solid"),v=(0,c.U_)(y,"destructive","solid"),u=(0,n.css)({color:y.colors.text.primary,background:y.colors.secondary.main,"&:hover":{color:y.colors.text.primary,background:y.colors.secondary.shade,border:`1px solid ${y.colors.border.medium}`}});return{button:(0,n.css)({label:"toolbar-button",position:"relative",display:"flex",alignItems:"center",height:y.spacing(y.components.height.md),padding:y.spacing(0,1),borderRadius:y.shape.radius.default,lineHeight:`${y.components.height.md*y.spacing.gridSize-2}px`,fontWeight:y.typography.fontWeightMedium,border:`1px solid ${y.colors.secondary.border}`,whiteSpace:"nowrap",[y.transitions.handleMotion("no-preference","reduce")]:{transition:y.transitions.create(["background","box-shadow","border-color","color"],{duration:y.transitions.duration.short})},"&:focus, &:focus-visible":{...(0,a.getFocusStyles)(y),zIndex:1},"&:focus:not(:focus-visible)":(0,a.getMouseFocusStyles)(y),"&:hover":{boxShadow:y.shadows.z1},"&[disabled], &:disabled":{cursor:"not-allowed",opacity:y.colors.action.disabledOpacity,background:y.colors.action.disabledBackground,boxShadow:"none","&:hover":{color:y.colors.text.disabled,background:y.colors.action.disabledBackground,boxShadow:"none"}}}),default:(0,n.css)({color:y.colors.text.secondary,background:"transparent",border:"1px solid transparent","&:hover":{color:y.colors.text.primary,background:y.colors.background.secondary}}),canvas:u,active:(0,n.cx)(u,(0,n.css)({"&::before":{display:"block",content:'" "',position:"absolute",left:0,right:0,height:"2px",bottom:0,borderRadius:y.shape.radius.default,backgroundImage:y.colors.gradients.brandHorizontal}})),primary:(0,n.css)(d),destructive:(0,n.css)(v),narrow:(0,n.css)({padding:y.spacing(0,.5)}),img:(0,n.css)({width:"16px",height:"16px",marginRight:y.spacing(1)}),buttonFullWidth:(0,n.css)({flexGrow:1}),content:(0,n.css)({flexGrow:1}),contentWithIcon:(0,n.css)({display:"none",paddingLeft:y.spacing(1),[`@media ${a.mediaUp(y.v1.breakpoints.md)}`]:{display:"block"}}),contentWithRightIcon:(0,n.css)({paddingRight:y.spacing(.5)}),highlight:(0,n.css)({backgroundColor:y.colors.success.main,borderRadius:y.shape.radius.circle,width:"6px",height:"6px",position:"absolute",top:"-3px",right:"-3px",zIndex:1})}}},15068:(G,O,e)=>{"use strict";e.d(O,{U:()=>h});var t=e(74848),n=e(32196),i=e(18828),s=e(85690),r=e(93225),f=e(96540),a=e(40845),c=e(17464),o=e(27746);const h=(0,f.forwardRef)(({alignment:l="left",className:p,children:m,...y},d)=>{const v=f.Children.toArray(m).filter(A=>A!=null),[u,D]=(0,f.useState)(Array(v.length).fill(!1)),P=(0,f.useRef)(null),[x,E]=(0,f.useState)(!1),C=(0,f.useRef)(null),M=(0,f.createRef)(),{overlayProps:S}=(0,r.e)({onClose:()=>E(!1),isDismissable:!0,isOpen:x,shouldCloseOnInteractOutside:A=>{const L=(0,c.gF)();return!C.current?.contains(A)&&!L.contains(A)}},M),{dialogProps:I}=(0,i.s)({},M),T=(0,a.$j)(),b=l==="left"?u.indexOf(!1)-1:u.length,R=g(T,b,l);return(0,f.useLayoutEffect)(()=>{const A=new IntersectionObserver(L=>{L.forEach(U=>{if(U.target instanceof HTMLElement&&U.target.parentNode){const W=Array.prototype.indexOf.call(U.target.parentNode.children,U.target);D(w=>{const N=[...w];return N[W]=U.isIntersecting,N})}})},{threshold:1,root:P.current});return P.current&&Array.from(P.current.children).forEach(L=>{L instanceof HTMLElement&&L!==C.current&&A.observe(L)}),()=>A.disconnect()},[m]),(0,t.jsxs)("div",{ref:P,className:(0,n.cx)(R.container,p),...y,children:[v.map((A,L)=>(0,t.jsx)("div",{style:{order:L,visibility:u[L]?"visible":"hidden"},className:R.childWrapper,children:A},L)),u.includes(!1)&&(0,t.jsxs)("div",{ref:C,className:R.overflowButton,children:[(0,t.jsx)(o.I,{variant:x?"active":"default",tooltip:"Show more items",onClick:()=>E(!x),icon:"ellipsis-v",iconOnly:!0,narrow:!0}),x&&(0,t.jsx)(s.n1,{contain:!0,autoFocus:!0,children:(0,t.jsx)("div",{className:R.overflowItems,ref:M,...S,...I,children:v.map((A,L)=>!u[L]&&A)})})]})]})});h.displayName="ToolbarButtonRow";const g=(l,p,m)=>({overflowButton:(0,n.css)({order:p}),overflowItems:(0,n.css)({alignItems:"center",backgroundColor:l.colors.background.primary,borderRadius:l.shape.radius.default,boxShadow:l.shadows.z2,display:"flex",flexWrap:"wrap",gap:l.spacing(1),marginTop:l.spacing(1),maxWidth:"80vw",padding:l.spacing(.5,1),position:"absolute",right:0,top:"100%",width:"max-content",zIndex:l.zIndex.dropdown}),container:(0,n.css)({alignItems:"center",display:"flex",gap:l.spacing(1),justifyContent:m==="left"?"flex-start":"flex-end",minWidth:0,position:"relative"}),childWrapper:(0,n.css)({alignItems:"center",display:"flex",gap:l.spacing(1)})})},13840:(G,O,e)=>{"use strict";e.d(O,{A:()=>o});var t=e(74848),n=e(34743),i=e(36376),s=e(7315),r=e(96540),f=e(40845),a=e(18976),c=e(17464);function o({content:h,show:g,placement:l,className:p,wrapperClassName:m,referenceElement:y,renderArrow:d,...v}){const u=(0,f.$j)(),D=(0,r.useRef)(null),P=[(0,n.cY)(8),(0,n.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,n.BN)()];d&&P.push((0,n.UE)({element:D}));const{context:x,refs:E,floatingStyles:C}=(0,i.we)({open:g,placement:(0,a.O)(l),middleware:P,whileElementsMounted:s.ll,strategy:"fixed"});(0,r.useLayoutEffect)(()=>{E.setReference(y)},[y,E]);const{styles:M}=(0,i.DL)(x,{initial:()=>({opacity:0}),duration:u.transitions.duration.enteringScreen});return g?(0,t.jsx)(c.ZL,{children:(0,t.jsx)("div",{ref:E.setFloating,style:{...C,...M},className:m,...v,children:(0,t.jsxs)("div",{className:p,children:[d&&(0,t.jsx)(i.ie,{fill:u.colors.border.weak,ref:D,context:x}),typeof h=="string"&&h,r.isValidElement(h)&&r.cloneElement(h),typeof h=="function"&&h({})]})})}):void 0}},95868:(G,O,e)=>{"use strict";e.d(O,{I:()=>n});var t=e(96540);class n extends t.Component{constructor(){super(...arguments),this.hideTimeout=null,this.state={show:!1},this.showPopper=()=>{this.hideTimeout&&clearTimeout(this.hideTimeout),this.setState({show:!0})},this.hidePopper=()=>{this.hideTimeout=setTimeout(()=>{this.setState({show:!1})},this.props.hideAfter)}}render(){const{children:s,content:r,placement:f="auto"}=this.props,{show:a}=this.state;return s(this.showPopper,this.hidePopper,{show:a,placement:f,content:r})}}},56034:(G,O,e)=>{"use strict";e.d(O,{m:()=>h});var t=e(74848),n=e(34743),i=e(36376),s=e(7315),r=e(96540),f=e(13544),a=e(40845),c=e(18976),o=e(17464);const h=(0,r.forwardRef)(({children:l,theme:p,interactive:m,show:y,placement:d,content:v},u)=>{const D=(0,r.useRef)(null),[P,x]=(0,r.useState)(y),E=y??P,C=[(0,n.cY)(8),(0,n.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,n.BN)(),(0,n.UE)({element:D})],{context:M,refs:S,floatingStyles:I}=(0,i.we)({open:E,placement:(0,c.O)(d),onOpenChange:x,middleware:C,whileElementsMounted:s.ll}),T=(0,r.useId)(),b=(0,i.Mk)(M,{delay:{close:m?100:0},move:!1}),R=(0,i.iQ)(M),A=(0,i.s9)(M),{getReferenceProps:L,getFloatingProps:U}=(0,i.bv)([A,b,R]),W=typeof v=="function",N=(0,a.of)(g)[p??"info"],B=(0,r.useCallback)(K=>{S.setReference(K),typeof u=="function"?u(K):u&&(u.current=K)},[u,S]),V="aria-label"in l.props&&l.props["aria-label"]===v;return(0,t.jsxs)(t.Fragment,{children:[(0,r.cloneElement)(l,{ref:B,tabIndex:0,"aria-describedby":!V&&E?T:void 0,...L()}),E&&(0,t.jsx)(o.ZL,{children:(0,t.jsxs)("div",{ref:S.setFloating,style:I,...U(),children:[(0,t.jsx)(i.ie,{className:N.arrow,ref:D,context:M}),(0,t.jsxs)("div",{"data-testid":f.Tp.components.Tooltip.container,id:T,role:"tooltip",className:N.container,children:[typeof v=="string"&&v,(0,r.isValidElement)(v)&&(0,r.cloneElement)(v),W&&v({})]})]})})]})});h.displayName="Tooltip";const g=l=>{const p=(0,c.f)(l,l.components.tooltip.background,l.components.tooltip.background,l.components.tooltip.text,{topBottom:.5,rightLeft:1}),m=(0,c.f)(l,l.colors.error.main,l.colors.error.main,l.colors.error.contrastText,{topBottom:.5,rightLeft:1});return{info:p,"info-alt":p,error:m}}},5313:(G,O,e)=>{"use strict";e.d(O,{z:()=>s});var t=e(74848),n=e(96540);function i(r,f){const a=[];return r.forEach(c=>{a.push(c.start,c.end+1)}),a[0]!==0&&a.unshift(0),a[a.length-1]!==f&&a.push(f),a}const s=r=>{let{highlightParts:f,text:a,highlightClassName:c}=r;if(!f?.length)return null;let o=[],h=i(f,a.length),g=f[0].start===0;for(let l=1;l<h.length;l++){let p=h[l-1],m=h[l];o.push((0,n.createElement)(g?"mark":"span",{key:l-1,className:g?c:void 0},a.substring(p,m))),g=!g}return(0,t.jsx)("div",{children:o})}},2056:(G,O,e)=>{"use strict";e.d(O,{p:()=>f});var t=e(74848),n=e(96540),i=e(83195),s=e(3988);function r(a){return`Custom unit: ${a}`}class f extends n.PureComponent{constructor(){super(...arguments),this.onChange=c=>{this.props.onChange(c.value)}}render(){const{value:c,width:o}=this.props;let h;const l=(0,i.Ke)().map(p=>{const m=p.submenu.map(y=>{const d={label:y.text,value:y.value};return y.value===c&&(h=d),d});return{label:p.text,value:p.text,items:m}});return c&&!h&&(h={value:c,label:c}),(0,t.jsx)(s.v,{width:o,initialValue:h&&h.label,allowCustomValue:!0,changeOnSelect:!1,formatCreateLabel:r,options:l,placeholder:"Choose",isClearable:!0,onSelect:this.props.onChange})}}},12942:(G,O,e)=>{"use strict";e.d(O,{e:()=>r});var t=e(74848),n=e(32196),i=e(40845),s=e(16795);const r=({src:a,alt:c,width:o,height:h})=>{const g=(0,i.of)(f,o,h);return(0,t.jsx)("img",{className:g.image,src:a,alt:c})},f=(a,c=3,o=3)=>({image:(0,n.css)([(0,s.Y)(a,c,h=>({width:a.spacing(h)})),(0,s.Y)(a,o,h=>({height:a.spacing(h)})),{borderRadius:a.shape.radius.circle}])})},99635:(G,O,e)=>{"use strict";e.d(O,{n:()=>o});var t=e(74848),n=e(32196),i=e(96540),s=e(47232),r=e(40845),f=e(56034);const a=l=>{const m=(0,s.KQ)(l).diff((0,s.KQ)(),"hours",!1);return`Active last ${(Math.floor(-m/24)+1)*24}h`},c=l=>{if(!l)return"";const[p,m]=l.split(" ");return`${p?.[0]??""}${m?.[0]??""}`.toUpperCase()},o=({userView:l,className:p,children:m,onClick:y,showTooltip:d=!0})=>{const{user:v,lastActiveAt:u}=l,D=(0,s.KQ)(u).diff((0,s.KQ)(),"minutes",!0)>=-15,P=(0,r.$j)(),x=(0,i.useMemo)(()=>g(P,D),[P,D]),E=(0,t.jsx)("button",{type:"button",onClick:y,className:(0,n.cx)(x.container,y&&x.pointer,p),"aria-label":`${v.name} icon`,children:m?(0,t.jsx)("div",{className:(0,n.cx)(x.content,x.textContent),children:m}):v.avatarUrl?(0,t.jsx)("img",{className:x.content,src:v.avatarUrl,alt:`${v.name} avatar`}):(0,t.jsx)("div",{className:(0,n.cx)(x.content,x.textContent),children:c(v.name)})});if(d){const C=(0,t.jsxs)("div",{className:x.tooltipContainer,children:[(0,t.jsx)("div",{className:x.tooltipName,children:v.name}),(0,t.jsx)("div",{className:x.tooltipDate,children:D?(0,t.jsxs)("div",{className:x.dotContainer,children:[(0,t.jsx)("span",{children:"Active last 15m"}),(0,t.jsx)("span",{className:x.dot})]}):a(u)})]});return(0,t.jsx)(f.m,{content:C,children:E})}else return E},h=l=>`0 0 0 1px ${l}`,g=(l,p)=>{const m=p?l.colors.primary.main:l.colors.border.medium,y=p?l.colors.primary.text:l.colors.border.strong;return{container:(0,n.css)({padding:0,width:"30px",height:"30px",background:"none",border:"none",borderRadius:l.shape.radius.circle,"& > *":{borderRadius:l.shape.radius.circle}}),content:(0,n.css)({lineHeight:"24px",maxWidth:"100%",border:`3px ${l.colors.background.primary} solid`,boxShadow:h(m),backgroundClip:"padding-box","&:hover":{boxShadow:h(y)}}),textContent:(0,n.css)({background:l.colors.background.primary,padding:0,color:l.colors.text.secondary,textAlign:"center",fontSize:l.typography.size.sm,"&:focus":{boxShadow:h(m)}}),tooltipContainer:(0,n.css)({textAlign:"center",padding:l.spacing(0,1)}),tooltipName:(0,n.css)({fontWeight:l.typography.fontWeightBold}),tooltipDate:(0,n.css)({fontWeight:l.typography.fontWeightRegular}),dotContainer:(0,n.css)({display:"flex",alignItems:"center"}),dot:(0,n.css)({height:"6px",width:"6px",backgroundColor:l.colors.primary.main,borderRadius:l.shape.radius.circle,display:"inline-block",marginLeft:l.spacing(1)}),pointer:(0,n.css)({cursor:"pointer"})}}},51986:(G,O,e)=>{"use strict";e.d(O,{i:()=>a});var t=e(74848),n=e(96540),i=e(13544),s=e(40845),r=e(55852),f=e(90182);function a({"aria-label":c,label:o,icon:h,options:g,onChange:l,variant:p,minWidth:m=16,size:y="sm",isFullWidth:d=!0,menuPlacement:v,fill:u,buttonCss:D}){const[P,x]=(0,n.useState)(!1),E=(0,s.$j)();return(0,t.jsxs)(t.Fragment,{children:[!P&&(0,t.jsx)(r.$n,{size:y||"sm",className:D,icon:h||"plus",onClick:()=>x(!0),variant:p,fill:u,fullWidth:d,"data-testid":i.Tp.components.ValuePicker.button(c??o),children:o}),P&&(0,t.jsx)("span",{style:{minWidth:E.spacing(m),flexGrow:d?1:void 0},children:(0,t.jsx)(f.l6,{placeholder:o,options:g,"aria-label":i.Tp.components.ValuePicker.select(c??o),isOpen:!0,onCloseMenu:()=>x(!1),autoFocus:!0,onChange:C=>{x(!1),l(C)},menuPlacement:v})})]})}},67266:(G,O,e)=>{"use strict";e.d(O,{KU:()=>a});var t=e(74848),n=e(32196),i=e(49185),s=e(40845),r=e(16797),f=e(40276);const a=({width:h,height:g,legend:l,children:p})=>{const m=(0,s.$j)(),y=(0,s.of)(c),d={display:"flex",width:`${h}px`,height:`${g}px`},[v,u]=(0,i.A)();if(!l)return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("div",{style:d,className:y.viz,children:p(h,g)})});let{placement:D,maxHeight:P="35%",maxWidth:x="60%"}=l.props;document.body.clientWidth<m.breakpoints.values.lg&&(D="bottom");let E=null;const C={};switch(D){case"bottom":d.flexDirection="column",C.maxHeight=P,u.height&&(E={width:h,height:g-u.height});break;case"right":d.flexDirection="row",C.maxWidth=x,u.width&&(E={width:h-u.width,height:g}),l.props.width&&(C.width=l.props.width,E={width:h-l.props.width,height:g});break}return E?.width===0&&(E.width=h),E?.height===0&&(E.height=g),(0,t.jsxs)("div",{style:d,children:[(0,t.jsx)("div",{className:y.viz,children:E&&p(E.width,E.height)}),(0,t.jsx)("div",{style:C,ref:v,children:(0,t.jsx)(f.E,{hideHorizontalTrack:!0,children:l})})]})},c=h=>({viz:(0,n.css)({flexGrow:2,borderRadius:h.shape.radius.default,"&:focus-visible":(0,r.getFocusStyles)(h)})}),o=({children:h})=>(0,t.jsx)(t.Fragment,{children:h});a.Legend=o},94536:(G,O,e)=>{"use strict";e.d(O,{p:()=>f});var t=e(74848),n=e(32196),i=e(96540),s=e(8066),r=e(40845);const f=i.memo(i.forwardRef(({color:c,className:o,gradient:h,lineStyle:g,...l},p)=>{const m=(0,r.$j)(),y=(0,r.of)(a);let d;if(h){const u=s.uf.get(h).getColors?.(m);u?.length?d=`linear-gradient(90deg, ${u.join(", ")})`:d=m.visualization.getColorByName("")}else d=c;let v;return g?.fill==="dot"&&!h?v={backgroundImage:`radial-gradient(circle at 2px 2px, ${c} 2px, transparent 0)`,backgroundSize:"4px 4px",backgroundRepeat:"space"}:g?.fill==="dash"&&!h?v={backgroundImage:`linear-gradient(to right, ${c} 100%, transparent 0%)`,backgroundSize:"6px 4px",backgroundRepeat:"space"}:v={background:d,borderRadius:m.shape.radius.pill},(0,t.jsx)("div",{"data-testid":"series-icon",ref:p,className:(0,n.cx)(o,y.forcedColors,y.container),style:v,...l})})),a=c=>({container:(0,n.css)({marginRight:"8px",display:"inline-block",width:"14px",height:"4px"}),forcedColors:(0,n.css)({"@media (forced-colors: active)":{forcedColorAdjust:"none"}})});f.displayName="SeriesIcon"},96516:(G,O,e)=>{"use strict";e.d(O,{t:()=>I});var t=e(74848),n=e(96540),i=e(69129),s=e(52622),r=e(79041),f=e(88895),a=e(32196),c=e(40845),o=e(1551),h=e(33552),g=e(34375);const l=({items:T,itemRenderer:b,onLabelMouseOver:R,onLabelMouseOut:A,onLabelClick:L,placement:U,className:W,readonly:w})=>{const N=(0,c.of)(p);b||(b=V=>(0,t.jsx)(g.M,{item:V,onLabelClick:L,onLabelMouseOver:R,onLabelMouseOut:A,readonly:w}));const B=V=>`${V.getItemKey?V.getItemKey():V.label}`;switch(U){case"right":{const V=(K,H)=>(0,t.jsx)("span",{className:N.itemRight,children:b(K,H)});return(0,t.jsx)("div",{className:(0,a.cx)(N.rightWrapper,W),children:(0,t.jsx)(h.B,{items:T,renderItem:V,getItemKey:B})})}case"bottom":default:{const V=T.filter(X=>X.yAxis===1),K=T.filter(X=>X.yAxis!==1),H=(X,k)=>(0,t.jsx)("span",{className:N.itemBottom,children:b(X,k)});return(0,t.jsxs)("div",{className:(0,a.cx)(N.bottomWrapper,W),children:[V.length>0&&(0,t.jsx)("div",{className:N.section,children:(0,t.jsx)(o.c,{items:V,renderItem:H,getItemKey:B})}),K.length>0&&(0,t.jsx)("div",{className:(0,a.cx)(N.section,N.sectionRight),children:(0,t.jsx)(o.c,{items:K,renderItem:H,getItemKey:B})})]})}}};l.displayName="VizLegendList";const p=T=>{const b=(0,a.css)({paddingRight:"10px",display:"flex",fontSize:T.typography.bodySmall.fontSize,whiteSpace:"nowrap"});return{itemBottom:b,itemRight:(0,a.cx)(b,(0,a.css)({marginBottom:T.spacing(.5)})),rightWrapper:(0,a.css)({paddingLeft:T.spacing(.5)}),bottomWrapper:(0,a.css)({display:"flex",flexWrap:"wrap",justifyContent:"space-between",width:"100%",paddingLeft:T.spacing(.5),gap:"15px 25px"}),section:(0,a.css)({display:"flex"}),sectionRight:(0,a.css)({justifyContent:"flex-end",flexGrow:1,flexBasis:"50%"})}};var m=e(14578),y=e(83195),d=e(16797),v=e(94134);const u=({item:T,onLabelClick:b,onLabelMouseOver:R,onLabelMouseOut:A,className:L,readonly:U})=>{const W=(0,c.of)(D),w=(0,n.useCallback)(V=>{R&&R(T,V)},[T,R]),N=(0,n.useCallback)(V=>{A&&A(T,V)},[T,A]),B=(0,n.useCallback)(V=>{b&&b(T,V)},[T,b]);return(0,t.jsxs)("tr",{className:(0,a.cx)(W.row,L),children:[(0,t.jsx)("td",{children:(0,t.jsxs)("span",{className:W.itemWrapper,children:[(0,t.jsx)(v.R,{color:T.color,seriesName:T.fieldName??T.label,readonly:U,lineStyle:T.lineStyle}),(0,t.jsxs)("button",{disabled:U,type:"button",title:T.label,onBlur:N,onFocus:w,onMouseOver:w,onMouseOut:N,onClick:U?void 0:B,className:(0,a.cx)(W.label,T.disabled&&W.labelDisabled),children:[T.label," ",T.yAxis===2&&(0,t.jsx)("span",{className:W.yAxisLabel,children:"(right y-axis)"})]})]})}),T.getDisplayValues&&T.getDisplayValues().map((V,K)=>(0,t.jsx)("td",{className:W.value,children:(0,y.cN)(V)},`${V.title}-${K}`))]})};u.displayName="LegendTableItem";const D=T=>{const b=d.hoverColor(T.colors.background.primary,T);return{row:(0,a.css)({label:"LegendRow",fontSize:T.v1.typography.size.sm,borderBottom:`1px solid ${T.colors.border.weak}`,td:{padding:T.spacing(.25,1),whiteSpace:"nowrap"},"&:hover":{background:b}}),label:(0,a.css)({label:"LegendLabel",whiteSpace:"nowrap",background:"none",border:"none",fontSize:"inherit",padding:0,maxWidth:"600px",textOverflow:"ellipsis",overflow:"hidden",userSelect:"text"}),labelDisabled:(0,a.css)({label:"LegendLabelDisabled",color:T.colors.text.disabled}),itemWrapper:(0,a.css)({display:"flex",whiteSpace:"nowrap",alignItems:"center"}),value:(0,a.css)({textAlign:"right"}),yAxisLabel:(0,a.css)({color:T.colors.text.secondary})}},P="Name",x=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}).compare,E=({items:T,sortBy:b,sortDesc:R,itemRenderer:A,className:L,onToggleSort:U,onLabelClick:W,onLabelMouseOver:w,onLabelMouseOut:N,readonly:B,isSortable:V})=>{const K=(0,c.of)(C),H={};V&&(H[P]="");for(const X of T)if(X.getDisplayValues)for(const k of X.getDisplayValues())H[k.title??"?"]=k.description??"";if(b!=null){let X=new Map;T.forEach(Y=>{if(b!==P&&Y.getDisplayValues){const Z=Y.getDisplayValues().find(j=>j.title===b),se=Z==null||Number.isNaN(Z.numeric)?-1/0:Z.numeric;X.set(Y,se)}});let k=R?-1:1;b===P?T.sort((Y,Z)=>k*x(Y.label,Z.label)):T.sort((Y,Z)=>{const se=X.get(Y)??0,j=X.get(Z)??0;return k*(se-j)})}return A||(A=(X,k)=>(0,t.jsx)(u,{item:X,onLabelClick:W,onLabelMouseOver:w,onLabelMouseOut:N,readonly:B},`${X.label}-${k}`)),(0,t.jsxs)("table",{className:(0,a.cx)(K.table,L),children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[!V&&(0,t.jsx)("th",{}),Object.keys(H).map(X=>(0,t.jsxs)("th",{title:H[X],className:(0,a.cx)(K.header,U&&K.headerSortable,V&&K.nameHeader,{[K.withIcon]:b===X}),onClick:()=>{U&&U(X)},children:[X,b===X&&(0,t.jsx)(m.I,{size:"xs",name:R?"angle-down":"angle-up"})]},X))]})}),(0,t.jsx)("tbody",{children:T.map(A)})]})},C=T=>({table:(0,a.css)({width:"100%","th:first-child":{width:"100%",borderBottom:`1px solid ${T.colors.border.weak}`}}),header:(0,a.css)({color:T.colors.primary.text,fontWeight:T.typography.fontWeightMedium,borderBottom:`1px solid ${T.colors.border.weak}`,padding:T.spacing(.25,1,.25,1),fontSize:T.typography.bodySmall.fontSize,textAlign:"right",whiteSpace:"nowrap"}),nameHeader:(0,a.css)({textAlign:"left",paddingLeft:"30px"}),withIcon:(0,a.css)({paddingRight:"4px"}),headerSortable:(0,a.css)({cursor:"pointer"})});var M=e(29995),S=e(44895);function I({items:T,displayMode:b,sortBy:R,seriesVisibilityChangeBehavior:A=M.K.Isolate,sortDesc:L,onLabelClick:U,onToggleSort:W,placement:w,className:N,itemRenderer:B,readonly:V,isSortable:K}){const{eventBus:H,onToggleSeriesVisibility:X,onToggleLegendSort:k}=(0,r.d2)(),Y=(0,n.useCallback)((j,q)=>{H?.publish({type:i.b_.type,payload:{raw:q,x:0,y:0,dataId:j.label}})},[H]),Z=(0,n.useCallback)((j,q)=>{H?.publish({type:i.ql.type,payload:{raw:q,x:0,y:0,dataId:j.label}})},[H]),se=(0,n.useCallback)((j,q)=>{U&&U(j,q),X&&X(j.fieldName??j.label,A===M.K.Hide?f.B.AppendToSelection:(0,S.W)(q))},[X,U,A]);switch(b){case s.lm.Table:return(0,t.jsx)(E,{className:N,items:T,placement:w,sortBy:R,sortDesc:L,onLabelClick:se,onToggleSort:W||k,onLabelMouseOver:Y,onLabelMouseOut:Z,itemRenderer:B,readonly:V,isSortable:K});case s.lm.List:return(0,t.jsx)(l,{className:N,items:T,placement:w,onLabelMouseOver:Y,onLabelMouseOut:Z,onLabelClick:se,itemRenderer:B,readonly:V});default:return null}}I.displayName="VizLegend"},34375:(G,O,e)=>{"use strict";e.d(O,{M:()=>l});var t=e(74848),n=e(32196),i=e(96540),s=e(13544),r=e(40845),f=e(94134),a=e(2543),c=e(83195),o=e(1551);const h=({stats:m})=>{const y=(0,r.of)(g);return m.length===0?null:(0,t.jsx)(o.c,{className:y.list,items:m,renderItem:d=>(0,t.jsxs)("div",{className:y.item,title:d.description,children:[d.title&&`${(0,a.capitalize)(d.title)}:`," ",(0,c.cN)(d)]})})},g=()=>({list:(0,n.css)({flexGrow:1,textAlign:"right"}),item:(0,n.css)({marginLeft:"8px"})});h.displayName="VizLegendStatsList";const l=({item:m,onLabelClick:y,onLabelMouseOver:d,onLabelMouseOut:v,className:u,readonly:D})=>{const P=(0,r.of)(p),x=(0,i.useCallback)(M=>{d&&d(m,M)},[m,d]),E=(0,i.useCallback)(M=>{v&&v(m,M)},[m,v]),C=(0,i.useCallback)(M=>{y&&y(m,M)},[m,y]);return(0,t.jsxs)("div",{className:(0,n.cx)(P.itemWrapper,m.disabled&&P.itemDisabled,u),"data-testid":s.Tp.components.VizLegend.seriesName(m.label),children:[(0,t.jsx)(f.R,{seriesName:m.fieldName??m.label,color:m.color,gradient:m.gradient,readonly:D,lineStyle:m.lineStyle}),(0,t.jsx)("button",{disabled:D,type:"button",onBlur:E,onFocus:x,onMouseOver:x,onMouseOut:E,onClick:C,className:P.label,children:m.label}),m.getDisplayValues&&(0,t.jsx)(h,{stats:m.getDisplayValues()})]})};l.displayName="VizLegendListItem";const p=m=>({label:(0,n.css)({label:"LegendLabel",whiteSpace:"nowrap",background:"none",border:"none",fontSize:"inherit",padding:0,userSelect:"text"}),itemDisabled:(0,n.css)({label:"LegendLabelDisabled",color:m.colors.text.disabled}),itemWrapper:(0,n.css)({label:"LegendItemWrapper",display:"flex",whiteSpace:"nowrap",alignItems:"center",flexGrow:1}),value:(0,n.css)({textAlign:"right"}),yAxisLabel:(0,n.css)({color:m.v1.palette.gray2})})},94134:(G,O,e)=>{"use strict";e.d(O,{R:()=>f});var t=e(74848),n=e(96540),i=e(83598),s=e(79041),r=e(94536);const f=(0,n.memo)(({seriesName:a,color:c,gradient:o,readonly:h,lineStyle:g})=>{const{onSeriesColorChange:l}=(0,s.d2)(),p=(0,n.useCallback)(m=>l(a,m),[a,l]);return a&&l&&c&&!h?(0,t.jsx)(i.Dp,{color:c,onChange:p,enableNamedColors:!0,children:({ref:m,showColorPicker:y,hideColorPicker:d})=>(0,t.jsx)(r.p,{color:c,className:"pointer",ref:m,onClick:y,onMouseLeave:d,lineStyle:g})}):(0,t.jsx)(r.p,{color:c,gradient:o,lineStyle:g})});f.displayName="VizLegendSeriesIcon"},29995:(G,O,e)=>{"use strict";e.d(O,{K:()=>t});var t=(n=>(n[n.Isolate=0]="Isolate",n[n.Hide=1]="Hide",n))(t||{})},44895:(G,O,e)=>{"use strict";e.d(O,{W:()=>n});var t=e(88895);function n(i){return i.ctrlKey||i.metaKey||i.shiftKey?t.B.AppendToSelection:t.B.ToggleSelection}},12509:(G,O,e)=>{"use strict";e.d(O,{S:()=>a});var t=e(74848),n=e(2543),i=e(96540),s=e(47070);const r=(o,h,g,l)=>{const p=f(o,h,l),m=f(h,o,l),y=Math.max(p,m);let d=Math.floor(o/y),v=Math.ceil(l/d);d=Math.ceil(l/v);const u=d-(d*v-l),D=o/u-g+g/u;return{width:o/d-g+g/d,height:h/v-g+g/v,widthOnLastRow:D,xCount:d,yCount:v}};function f(o,h,g){const l=Math.ceil(Math.sqrt(g*o/h));return Math.floor(l*h/o)*l<g?h/Math.ceil(l*h/o):o/l}class a extends i.PureComponent{static{this.defaultProps={itemSpacing:8}}constructor(h){super(h),this.state={values:h.getValues()}}componentDidUpdate(h){const{renderCounter:g,source:l}=this.props;(g!==h.renderCounter||l!==h.source)&&this.setState({values:this.props.getValues()})}getOrientation(){const{orientation:h,width:g,height:l}=this.props;return h===s.wV.Auto?g>l?s.wV.Vertical:s.wV.Horizontal:h}renderGrid(){const{renderValue:h,height:g,width:l,itemSpacing:p,getAlignmentFactors:m,orientation:y}=this.props,{values:d}=this.state,v=r(l,g,p,d.length),u=m?m(d,v.width,v.height):{};let D=0,P=0,x=[];for(let E=0;E<d.length;E++){const C=d[E],S=P===v.yCount-1?v.widthOnLastRow:v.width,I=v.height,T=D*S+p*D,b=P*I+p*P,R={position:"absolute",left:T,top:b,width:`${S}px`,height:`${I}px`};x.push((0,t.jsx)("div",{style:R,children:h({value:C,width:S,height:I,alignmentFactors:u,orientation:y,count:d.length})},E)),D++,D===v.xCount&&(D=0,P++)}return(0,t.jsx)("div",{style:{position:"relative"},children:x})}render(){const{renderValue:h,height:g,width:l,itemSpacing:p,getAlignmentFactors:m,autoGrid:y,orientation:d,maxVizHeight:v,minVizWidth:u,minVizHeight:D}=this.props,{values:P}=this.state;if(y&&d===s.wV.Auto)return this.renderGrid();const x={display:"flex"},E={display:"flex",overflow:`${u?"auto":"hidden"} ${D?"auto":"hidden"}`};let C=g,M=l;const S=this.getOrientation();switch(S){case s.wV.Horizontal:const T=(g+p)/P.length-p;E.flexDirection="column",E.height=`${g}px`,x.marginBottom=`${p}px`,M=l,C=(0,n.clamp)(T,D??0,v??T);break;case s.wV.Vertical:E.flexDirection="row",E.justifyContent="space-between",x.marginRight=`${p}px`,C=g,M=Math.max(l/P.length-p+p/P.length,u??0)}x.width=`${M}px`,x.height=`${C}px`;const I=m?m(P,M,C):{};return(0,t.jsx)("div",{style:E,children:P.map((T,b)=>(0,t.jsx)("div",{style:c(x,b,P.length),children:h({value:T,width:M,height:C,alignmentFactors:I,orientation:S,count:P.length})},b))})}}function c(o,h,g){return h===g-1?{...o,marginRight:0,marginBottom:0}:o}},3139:(G,O,e)=>{"use strict";e.d(O,{g:()=>f,o:()=>a});var t=e(74848),n=e(32196),i=e(40845),s=e(94536);const r=c=>({icon:(0,n.css)({marginRight:c.spacing(1),verticalAlign:"middle"}),seriesTable:(0,n.css)({display:"table"}),seriesTableRow:(0,n.css)({display:"table-row",fontSize:c.typography.bodySmall.fontSize}),seriesTableCell:(0,n.css)({display:"table-cell"}),label:(0,n.css)({wordBreak:"break-all"}),value:(0,n.css)({paddingLeft:c.spacing(2),textAlign:"right"}),activeSeries:(0,n.css)({fontWeight:c.typography.fontWeightBold,color:c.colors.text.maxContrast}),timestamp:(0,n.css)({fontWeight:c.typography.fontWeightBold,fontSize:c.typography.bodySmall.fontSize})}),f=({color:c,label:o,value:h,isActive:g})=>{const l=(0,i.of)(r);return(0,t.jsxs)("div",{"data-testid":"SeriesTableRow",className:(0,n.cx)(l.seriesTableRow,g&&l.activeSeries),children:[c&&(0,t.jsx)("div",{className:l.seriesTableCell,children:(0,t.jsx)(s.p,{color:c,className:l.icon})}),o&&(0,t.jsx)("div",{className:(0,n.cx)(l.seriesTableCell,l.label),children:o}),h&&(0,t.jsx)("div",{className:(0,n.cx)(l.seriesTableCell,l.value),children:h})]})},a=({timestamp:c,series:o})=>{const h=(0,i.of)(r);return(0,t.jsxs)(t.Fragment,{children:[c&&(0,t.jsx)("div",{className:h.timestamp,"aria-label":"Timestamp",children:c}),o.map((g,l)=>(0,t.jsx)(f,{isActive:g.isActive,label:g.label,color:g.color,value:g.value},`${g.label}-${l}`))]})}},75128:(G,O,e)=>{"use strict";e.d(O,{n:()=>f});var t=e(74848),n=e(32196),i=e(40845),s=e(17464),r=e(69503);const f=({content:c,position:o,offset:h})=>{const g=(0,i.of)(a);return o?(0,t.jsx)(s.ZL,{className:g.portal,children:(0,t.jsx)(r.o,{position:o,offset:h||{x:0,y:0},children:c})}):null};f.displayName="VizTooltip";const a=()=>({portal:(0,n.css)({position:"absolute",top:0,left:0,pointerEvents:"none",width:"100%",height:"100%"})})},69503:(G,O,e)=>{"use strict";e.d(O,{o:()=>c});var t=e(74848),n=e(32196),i=e(96540),s=e(52908),r=e(40845),f=e(16797),a=e(10875);const c=({position:{x:h,y:g},offset:{x:l,y:p},children:m,allowPointerEvents:y=!1,className:d,...v})=>{const u=(0,i.useRef)(null),[D,P]=(0,i.useState)({width:0,height:0}),{width:x,height:E}=(0,s.A)(),[C,M]=(0,i.useState)({x:h+l,y:g+p}),S=(0,i.useMemo)(()=>new ResizeObserver(T=>{for(let b of T){const R=Math.floor(b.contentRect.width+16),A=Math.floor(b.contentRect.height+2*8);(D.width!==R||D.height!==A)&&P({width:Math.min(R,x),height:Math.min(A,E)})}}),[D,x,E]);(0,i.useLayoutEffect)(()=>(u.current&&S.observe(u.current),()=>{S.disconnect()}),[S]),(0,i.useLayoutEffect)(()=>{if(u&&u.current){const{x:T,y:b}=(0,a.Ju)(h,g,D.width,D.height,l,p,x,E);M({x:T,y:b})}},[x,E,h,l,g,p,D]);const I=(0,r.of)(o);return(0,t.jsx)("div",{ref:u,style:{position:"fixed",left:0,pointerEvents:y?"auto":"none",top:0,transform:`translate(${C.x}px, ${C.y}px)`,transition:"transform ease-out 0.1s"},"aria-live":"polite","aria-atomic":"true",...v,className:(0,n.cx)(I.wrapper,d),children:m})};c.displayName="VizTooltipContainer";const o=h=>({wrapper:(0,n.css)((0,f.getTooltipContainerStyles)(h))})},11389:(G,O,e)=>{"use strict";e.d(O,{o:()=>r});var t=e(74848),n=e(32196),i=e(40845),s=e(13471);const r=({items:a,children:c,isPinned:o,scrollable:h=!1,maxHeight:g})=>{const l=(0,i.of)(f),p=h?{maxHeight:g,overflowY:"auto"}:{};return(0,t.jsxs)("div",{className:l.wrapper,style:p,children:[a.map(({label:m,value:y,color:d,colorIndicator:v,colorPlacement:u,isActive:D,lineStyle:P},x)=>(0,t.jsx)(s.B,{label:m,value:y,color:d,colorIndicator:v,colorPlacement:u,isActive:D,justify:"space-between",isPinned:o,lineStyle:P,showValueScroll:!h},x)),c]})},f=a=>({wrapper:(0,n.css)({display:"flex",flexDirection:"column",flex:1,gap:4,borderTop:`1px solid ${a.colors.border.medium}`,padding:a.spacing(1)})})},58749:(G,O,e)=>{"use strict";e.d(O,{S:()=>c});var t=e(74848),n=e(32196),i=e(67061),s=e(14689),r=e(55852),f=e(40845);const a="add-annotation-button",c=({dataLinks:h,annotate:g})=>{const l=(0,f.of)(o),p=()=>{const m={variant:"secondary"};return(0,t.jsx)(i.B,{direction:"column",justifyContent:"flex-start",children:h.map((y,d)=>(0,t.jsx)(s.R,{link:y,buttonProps:m},d))})};return(0,t.jsxs)("div",{className:l.wrapper,children:[h.length>0&&(0,t.jsx)("div",{className:l.dataLinks,children:p()}),g!=null&&(0,t.jsx)("div",{className:l.addAnnotations,children:(0,t.jsx)(r.$n,{icon:"comment-alt",variant:"secondary",size:"sm",id:a,onClick:g,children:"Add annotation"})})]})},o=h=>({wrapper:(0,n.css)({display:"flex",flexDirection:"column",flex:1,padding:h.spacing(0)}),dataLinks:(0,n.css)({borderTop:`1px solid ${h.colors.border.medium}`,padding:h.spacing(1)}),addAnnotations:(0,n.css)({borderTop:`1px solid ${h.colors.border.medium}`,padding:h.spacing(1)})})},52415:(G,O,e)=>{"use strict";e.d(O,{A:()=>r});var t=e(74848),n=e(32196),i=e(40845),s=e(13471);const r=({item:a,isPinned:c})=>{const o=(0,i.of)(f),{label:h,value:g,color:l,colorIndicator:p}=a;return(0,t.jsx)("div",{className:o.wrapper,children:(0,t.jsx)(s.B,{label:h,value:g,color:l,colorIndicator:p,marginRight:"22px",isPinned:c})})},f=a=>({wrapper:(0,n.css)({display:"flex",flexDirection:"column",flex:1,padding:a.spacing(1)})})},13471:(G,O,e)=>{"use strict";e.d(O,{B:()=>u});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(32982),f=e(56034),a=e(24293),c=e(94536),o=e(79871),h=e(10875),g=(P=>(P[P.Leading=0]="Leading",P[P.Trailing=1]="Trailing",P))(g||{});const l=({color:P=a.F,colorIndicator:x=o.Ev,position:E=0,lineStyle:C})=>{const M=(0,s.of)(p);return x===o.fX.series?(0,t.jsx)(c.p,{color:P,lineStyle:C,className:E===0?M.leading:M.trailing}):(0,t.jsx)("span",{style:{backgroundColor:P},className:(0,n.cx)(E===0?M.leading:M.trailing,(0,h.L$)(x,M))})},p=P=>({leading:(0,n.css)({marginRight:P.spacing(.5)}),trailing:(0,n.css)({marginLeft:P.spacing(.5)}),value:(0,n.css)({width:"12px",height:"12px",borderRadius:P.shape.radius.default,fontWeight:500,minWidth:"12px"}),hexagon:(0,n.css)({}),pie_1_4:(0,n.css)({}),pie_2_4:(0,n.css)({}),pie_3_4:(0,n.css)({}),marker_sm:(0,n.css)({width:"4px",height:"4px",borderRadius:P.shape.radius.circle,minWidth:"4px"}),marker_md:(0,n.css)({width:"8px",height:"8px",borderRadius:P.shape.radius.circle,minWidth:"8px"}),marker_lg:(0,n.css)({width:"12px",height:"12px",borderRadius:P.shape.radius.circle,minWidth:"12px"})});var m=(P=>(P.label="label",P.value="value",P))(m||{});const y="Copied to clipboard",d=2*1e3,v=7,u=({label:P,value:x,color:E,colorIndicator:C,colorPlacement:M=o.lJ.first,justify:S="flex-start",isActive:I=!1,marginRight:T="0px",isPinned:b,lineStyle:R,showValueScroll:A})=>{const L=(0,s.of)(D,S,T),U=A?{maxHeight:55,whiteSpace:"wrap",wordBreak:"break-word",overflowY:"auto"}:{whiteSpace:"wrap",wordBreak:"break-word"},[W,w]=(0,i.useState)(!1),[N,B]=(0,i.useState)(null),[V,K]=(0,i.useState)(!1),H=(0,i.useRef)(null),X=(0,i.useRef)(null);(0,i.useEffect)(()=>{let j;return V&&(j=setTimeout(()=>{K(!1)},d)),()=>{window.clearTimeout(j)}},[V]);const k=async(j,q)=>{if(!(navigator?.clipboard&&window.isSecureContext)){Y(j,q);return}try{await navigator.clipboard.writeText(j),B({[`${q}`]:j}),K(!0)}catch{B(null)}},Y=(j,q)=>{const ne=document.createElement("textarea");H.current?.appendChild(ne),ne.value=j,ne.focus(),ne.select();try{document.execCommand("copy")&&(B({[`${q}`]:j}),K(!0))}catch(oe){console.error("Unable to copy to clipboard",oe)}ne.remove()},Z=j=>{j.currentTarget.offsetWidth<j.currentTarget.scrollWidth&&w(!0)},se=()=>w(!1);return P.length*v>window.innerWidth/2&&(P=P.replaceAll("{",`{
  `).replaceAll("}",`
}`).replaceAll(", ",`,
  `)),(0,t.jsxs)("div",{className:L.contentWrapper,children:[(E||P)&&(0,t.jsxs)("div",{className:L.valueWrapper,children:[E&&M===o.lJ.first&&(0,t.jsx)(l,{color:E,colorIndicator:C,lineStyle:R}),b?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(f.m,{content:P,interactive:!1,show:W,children:(0,t.jsxs)(t.Fragment,{children:[V&&N?.label&&(0,t.jsx)(r.r,{placement:"top",referenceElement:H.current,children:y}),(0,t.jsx)("div",{className:(0,n.cx)(L.label,I&&L.activeSeries,navigator?.clipboard&&L.copy),onMouseEnter:Z,onMouseLeave:se,onClick:()=>k(P,"label"),ref:H,children:P})]})})}):(0,t.jsx)("div",{className:(0,n.cx)(L.label,I&&L.activeSeries),children:P})]}),(0,t.jsxs)("div",{className:L.valueWrapper,children:[E&&M===o.lJ.leading&&(0,t.jsx)(l,{color:E,colorIndicator:C,position:g.Leading,lineStyle:R}),b?(0,t.jsxs)(t.Fragment,{children:[V&&N?.value&&(0,t.jsx)(r.r,{placement:"top",referenceElement:X.current,children:y}),(0,t.jsx)("div",{className:(0,n.cx)(L.value,I,navigator?.clipboard&&L.copy),style:U,onClick:()=>k(x?x.toString():"","value"),ref:X,children:x})]}):(0,t.jsx)("div",{className:(0,n.cx)(L.value,I),style:U,children:x}),E&&M===o.lJ.trailing&&(0,t.jsx)(l,{color:E,colorIndicator:C,position:g.Trailing,lineStyle:R})]})]})},D=(P,x,E)=>({contentWrapper:(0,n.css)({display:"flex",alignItems:"start",justifyContent:x,marginRight:E}),label:(0,n.css)({color:P.colors.text.secondary,fontWeight:400,textOverflow:"ellipsis",overflow:"hidden",marginRight:P.spacing(2)}),value:(0,n.css)({fontWeight:500,textOverflow:"ellipsis",overflow:"hidden"}),valueWrapper:(0,n.css)({display:"flex",alignItems:"center"}),activeSeries:(0,n.css)({fontWeight:P.typography.fontWeightBold,color:P.colors.text.maxContrast}),copy:(0,n.css)({cursor:"pointer"})})},79871:(G,O,e)=>{"use strict";e.d(O,{Ev:()=>i,fX:()=>t,lJ:()=>n});var t=(s=>(s.series="series",s.value="value",s.hexagon="hexagon",s.pie_1_4="pie_1_4",s.pie_2_4="pie_2_4",s.pie_3_4="pie_3_4",s.marker_sm="marker_sm",s.marker_md="marker_md",s.marker_lg="marker_lg",s))(t||{}),n=(s=>(s.hidden="hidden",s.first="first",s.leading="leading",s.trailing="trailing",s))(n||{});const i="series"},10875:(G,O,e)=>{"use strict";e.d(O,{Ju:()=>a,L$:()=>c,cp:()=>l});var t=e(11261),n=e(8066),i=e(83195),s=e(24293),r=e(52622),f=e(79871);const a=(p=0,m=0,y=0,d=0,v=0,u=0,D=0,P=0)=>{let x=p,E=m;const C=Math.max(p+v+y-(D-v),0),M=Math.abs(Math.min(p-v-y-v,0)),S=C>0,I=M>0,T=Math.max(m+u+d-(P-u),0),b=Math.abs(Math.min(m-u-d-u,0)),R=T>0,A=b>0;return S&&I?x=C>M?v:D-v-y:S?x=p-v-y:x=p+v,R&&A?E=T>b?u:P-u-d:R?E=m-u-d:E=m+u,{x,y:E}},c=(p,m)=>{switch(p){case f.fX.value:return m.value;case f.fX.hexagon:return m.hexagon;case f.fX.pie_1_4:return m.pie_1_4;case f.fX.pie_2_4:return m.pie_2_4;case f.fX.pie_3_4:return m.pie_3_4;case f.fX.marker_sm:return m.marker_sm;case f.fX.marker_md:return m.marker_md;case f.fX.marker_lg:return m.marker_lg;default:return m.value}},o=(p,m)=>p.numeric-m.numeric,h=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}),g=(p,m)=>h.compare(`${p.value}`,`${m.value}`),l=(p,m,y,d,v,u,D=P=>!0)=>{let P=[],x=!0;for(let E=0;E<p.length;E++){const C=p[E];if(C===m||C.type===t.PU.time||!D(C)||C.config.custom?.hideFrom?.tooltip||C.config.custom?.hideFrom?.viz||v===r.$N.Single&&d!==E)continue;let M=y[E];if(M==null)continue;C.type===t.PU.number||C.type===t.PU.boolean||C.type===t.PU.enum||(x=!1);const S=p[E].values[M];if(S==null&&C.config.noValue==null)continue;const I=C.display(S),T=Number.isNaN(I.numeric)?u===r.xB.Descending?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER:I.numeric,b=(0,n.Qi)(C);let R=f.fX.series,A=f.lJ.first;b.isByValue&&(R=f.fX.value,A=f.lJ.trailing),P.push({label:C.state?.displayName??C.name,value:(0,i.cN)(I),color:I.color??s.F,colorIndicator:R,colorPlacement:A,isActive:v===r.$N.Multi&&d===E,numeric:T,lineStyle:C.config.custom?.lineStyle})}if(u!==r.xB.None&&P.length>1){const E=x?o:g,C=u===r.xB.Descending?-1:1;P.sort((M,S)=>C*E(M,S))}return P}},94333:(G,O,e)=>{"use strict";e.r(O),e.d(O,{Alert:()=>Ee.F,AlertingSettings:()=>lt.i,AsyncMultiSelect:()=>Gn.Iv,AsyncSelect:()=>Gn.DW,AsyncVirtualizedSelect:()=>Gn.gZ,AutoSaveField:()=>se.p,AutoSizeInput:()=>Ja.D,Avatar:()=>rn.e,Badge:()=>Ys.E,BarGauge:()=>pt.xE,BarGaugeDisplayMode:()=>Ca.eX,BigValue:()=>Xe.yV,BigValueColorMode:()=>Xe.yp,BigValueGraphMode:()=>Xe.$p,BigValueJustifyMode:()=>Xe.F8,BigValueTextMode:()=>Xe.SV,Box:()=>Xn.a,BrowserLabel:()=>Mo.J,Button:()=>tn.$n,ButtonCascader:()=>x.H,ButtonGroup:()=>Mn.e,ButtonSelect:()=>Go.f,CallToActionCard:()=>Jt.c,Card:()=>Fa.Z,CardContainer:()=>fo.Q,Cascader:()=>P.v,CertificationKey:()=>et.K,Checkbox:()=>Ar.S,ClickOutsideWrapper:()=>Pt.N,ClipboardButton:()=>D.b,CodeEditor:()=>le.B,CodeEditorSuggestionItemKind:()=>ae.q,CollapsableSection:()=>at.M,Collapse:()=>Qe.S,ColorPicker:()=>S.sk,ColorPickerInput:()=>I.i,ConfirmButton:()=>h.Z,ConfirmModal:()=>z.u,Container:()=>Ea.mc,ContextMenu:()=>wt.t,ControlledCollapse:()=>Qe.a,Counter:()=>We.p,CustomHeadersSettings:()=>ht.P,CustomScrollbar:()=>v.E,DataLinkButton:()=>ft.R,DataLinkInput:()=>Ye.l,DataLinksContextMenu:()=>Dt.e,DataLinksInlineEditor:()=>Cn.e,DataSourceHttpSettings:()=>nn.t,DatePicker:()=>K.l,DatePickerWithInput:()=>H.l,DateTimePicker:()=>X.K,DeleteButton:()=>g.e,Divider:()=>cs.c,Drawer:()=>wn._,Dropdown:()=>Ut.m,EmptySearchResult:()=>b.Z,EmptyState:()=>R.p,ErrorBoundary:()=>Nn.tH,ErrorBoundaryAlert:()=>Nn.Xw,ErrorWithStack:()=>St.D,EventBusPlugin:()=>gr.Ku,EventsCanvas:()=>fr.a,FIXED_UNIT:()=>Rr.s,FadeTransition:()=>It.A,FeatureBadge:()=>un.y,FeatureInfoBox:()=>an.e,Field:()=>wa.D,FieldArray:()=>$n.E,FieldLinkList:()=>ct.n,FieldSet:()=>pa.n,FieldValidationMessage:()=>Ba.P,FileDropzone:()=>Zr.gH,FileDropzoneDefaultChildren:()=>Zr.wI,FileListItem:()=>Zr.IB,FileUpload:()=>so.e,FilterInput:()=>pr.Z,FilterPill:()=>oe.m,Form:()=>Ot.l,FormattedValueDisplay:()=>ko.i,FullWidthButtonContainer:()=>vt.V,Gauge:()=>st._,Graph:()=>Ka.T,GraphContextMenu:()=>Za.H,GraphContextMenuHeader:()=>Za.i,GraphNG:()=>da.o,GraphSeriesToggler:()=>Ie.M,GraphWithLegend:()=>Sa.I,Grid:()=>Zs.x,HorizontalGroup:()=>Ea.Gy,Icon:()=>c.I,IconButton:()=>o.K,InfoBox:()=>Ft.w,InlineField:()=>_a.I,InlineFieldRow:()=>en.C,InlineFormLabel:()=>In.I,InlineLabel:()=>Wa.c,InlineSegmentGroup:()=>dr.e,InlineSwitch:()=>Kr.K,InlineToast:()=>E.r,Input:()=>za.p,InputControl:()=>rt.e,InteractiveTable:()=>Y.j,JSONFormatter:()=>hn.B,JsonExplorer:()=>Un.O,KeyboardPlugin:()=>gr.Z7,Label:()=>ks.J,LegacyForms:()=>ii,LegacyInputStatus:()=>n.O,Legend:()=>Xa.s,Link:()=>Ls.N,LinkButton:()=>tn.z9,List:()=>k.B,LoadingBar:()=>M.G,LoadingPlaceholder:()=>C._,Marker:()=>fr.pH,Menu:()=>zt.W,MenuGroup:()=>on.r,MenuItem:()=>Pn.D,Modal:()=>ce.a,ModalHeader:()=>me.r,ModalRoot:()=>De.EO,ModalTabContent:()=>de.O,ModalTabsHeader:()=>ee.J,ModalsContext:()=>De.wE,ModalsController:()=>De.$s,ModalsProvider:()=>De.YO,MultiSelect:()=>Gn.KF,PageToolbar:()=>fe.d,Pagination:()=>j.d,PanelChrome:()=>be.NR,PanelChromeLoadingIndicator:()=>he.I,PanelContainer:()=>So._,PanelContextProvider:()=>ye.XF,PanelContextRoot:()=>ye.e4,PlotLegend:()=>Er.$,PluginSignatureBadge:()=>Yt.B,Popover:()=>m.A,PopoverController:()=>p.I,Portal:()=>d.ZL,PortalContainer:()=>d.qB,QueryField:()=>te.X,RadioButtonDot:()=>ja.J,RadioButtonGroup:()=>ha.z,RadioButtonList:()=>ua.a,RangeSlider:()=>Rt.F,ReactMonacoEditor:()=>ie.m,RefreshPicker:()=>U.cC,RelativeTimeRangePicker:()=>ao.N,RenderUserContentAsHTML:()=>Ke.I,ScaleDistribution:()=>Ca.L4,SecretInput:()=>Wr.L,SecretTextArea:()=>Fr.l,SecureSocksProxySettings:()=>gt.Y,Segment:()=>sn.Y,SegmentAsync:()=>ln.s,SegmentInput:()=>yn.o,SegmentSection:()=>En.L,SegmentSelect:()=>Sn.a,Select:()=>Gn.l6,SelectContainer:()=>Gn.KA,SelectMenuOptions:()=>qn.o5,SeriesColorPicker:()=>S.Dp,SeriesColorPickerPopover:()=>T.o,SeriesColorPickerPopoverWithTheme:()=>T.t,SeriesIcon:()=>yt.p,SeriesTable:()=>$e.o,SeriesTableRow:()=>$e.g,SeriesVisibilityChangeBehavior:()=>ge.K,SeriesVisibilityChangeMode:()=>Dr.B,SetInterval:()=>Te.u,SlideOutTransition:()=>Qt.n,Slider:()=>On.A,Space:()=>Ms.$,Sparkline:()=>Je.O,Spinner:()=>Et.y,Stack:()=>Ps.B,StatsPicker:()=>L.S,Switch:()=>Kr.d,TLSAuthSettings:()=>$t.j,Tab:()=>Ne.o,TabContent:()=>Se.J,TabbedContainer:()=>u.q,Table:()=>je.X,TableInputCSV:()=>He.b,TabsBar:()=>Be.U,Tag:()=>q.v,TagList:()=>ne.L,TagsInput:()=>Z.u,Text:()=>ys.E,TextArea:()=>$r.f,TextLink:()=>fs.Y,TimeOfDayPicker:()=>N.R,TimePickerTooltip:()=>W.xS,TimeRangeInput:()=>mo.b,TimeRangeLabel:()=>w.f,TimeRangePicker:()=>W.$6,TimeSeries:()=>ro.Z,TimeZonePicker:()=>B.U,Toggletip:()=>y.G,ToolbarButton:()=>kn.I,ToolbarButtonRow:()=>Yn.U,Tooltip:()=>l.m,TooltipPlugin:()=>Di.T,TooltipPlugin2:()=>gr.xl,UPLOT_AXIS_FONT_SIZE:()=>qs.pi,UPlotChart:()=>xs.Z,UPlotConfigBuilder:()=>Aa.e,UnitPicker:()=>A.p,UserIcon:()=>Tn.n,ValuePicker:()=>Wn.i,VerticalGroup:()=>Ea.gW,VerticalTab:()=>Re.s,VirtualizedSelect:()=>Gn.ip,VizLayout:()=>Pe.KU,VizLegend:()=>xe.t,VizLegendListItem:()=>Ae.M,VizRepeater:()=>ve.S,VizTooltip:()=>xt.n,VizTooltipContainer:()=>ot.o,WeekStartPicker:()=>V.l,WithContextMenu:()=>_n.n,XYCanvas:()=>fr._X,ZoomPlugin:()=>wo.j,buildScaleKey:()=>No.My,clearButtonStyles:()=>tn.my,convertOldAngularValueMapping:()=>Vt.I1,defaultIntervals:()=>U.cb,fieldMatchersUI:()=>Jn.g,getCardStyles:()=>Fa.H,getDragStyles:()=>ds.l,getInputStyles:()=>za.n,getPortalContainer:()=>d.gF,getSelectStyles:()=>es.J,getWeekStart:()=>V.r,graphFieldOptions:()=>js.t,graphTickFormatter:()=>ur.Yn,graphTimeFormat:()=>ur.Jc,preparePlotFrame:()=>No.mY,resetSelectStyles:()=>Qn.A,sharedInputStyle:()=>jt.Xb,sharedSingleStatMigrationHandler:()=>Vt._$,sharedSingleStatPanelChangedHandler:()=>Vt.gl,useGraphNGContext:()=>Uo.I,usePanelContext:()=>ye.d2,useSplitter:()=>Gs.h,variableSuggestionToCodeEditorSuggestion:()=>re.O,withErrorBoundary:()=>Nn.Xc});var t=e(90090),n=e(91634),i=e(24169),s=e(11206),r=e(22209),f=e(74716),a=e(56286),c=e(14578),o=e(29158),h=e(82702),g=e(91605),l=e(56034),p=e(95868),m=e(13840),y=e(60782),d=e(17464),v=e(40276),u=e(60734),D=e(10534),P=e(3988),x=e(32012),E=e(32982),C=e(39558),M=e(57514),S=e(83598),I=e(99128),T=e(70104),b=e(41670),R=e(69529),A=e(2056),L=e(42734),U=e(11134),W=e(15666),w=e(3799),N=e(66070),B=e(20333),V=e(15648),K=e(56181),H=e(98239),X=e(63383),k=e(33552),Y=e(48840),Z=e(79924),se=e(28270),j=e(19384),q=e(78369),ne=e(64149),oe=e(92174),z=e(96374),te=e(20084),le=e(32372),ie=e(85828),ae=e(19716),re=e(99544),ce=e(37390),me=e(29473),ee=e(25897),de=e(95246),De=e(71678),fe=e(95247),Te=e(67570),je=e(77093),He=e(14746),Be=e(63021),Ne=e(40675),Re=e(90685),Se=e(40980),We=e(53402),Ke=e(44522),Xe=e(37494),Je=e(5926),st=e(95164),pt=e(97696),xt=e(75128),ot=e(69503),$e=e(3139),ve=e(12509),be=e(91052),he=e(89963),ye=e(79041),Pe=e(67266),ge=e(29995),xe=e(96516),Ae=e(34375),Ee=e(42418),Ie=e(84656),Qe=e(82762),at=e(57418),ft=e(14689),ct=e(79961),vt=e(61458),Pt=e(8866),Vt=e(37713),Jt=e(76442),wt=e(28122),zt=e(38138),on=e(59093),Pn=e(64539),_n=e(51686),Cn=e(64919),Ye=e(64078),Dt=e(59796),yt=e(94536),Ft=e(37166),an=e(86460),un=e(29678),hn=e(24022),Un=e(44533),Nn=e(66602),St=e(52446),nn=e(91409),ht=e(11184),lt=e(19849),gt=e(17081),$t=e(95180),et=e(28623),Et=e(62930),It=e(31511),Qt=e(72960),sn=e(38401),ln=e(83684),yn=e(57752),Sn=e(13102),En=e(64765),wn=e(87978),On=e(77014),Rt=e(47097),Ot=e(51253),jt=e(87266),rt=e(16504),tn=e(55852),Mn=e(19727),kn=e(27746),Yn=e(15068),Wn=e(51986),Jn=e(84349),Ls=e(50720),fs=e(72109),ys=e(94753),Xn=e(90613),Ps=e(67061),Zs=e(71259),Ms=e(68402),ks=e(60029),wa=e(88575),Xa=e(17408),pa=e(84167),Ba=e(72093),_a=e(14186),dr=e(63056),Wa=e(76892),en=e(39268),$n=e(95984),Qn=e(23731),Gn=e(90182),qn=e(12681),es=e(88824),Ss=e(62883),_s=e.n(Ss),Pa={};for(const Wo in Ss)["default","Icon","IconButton","ConfirmButton","DeleteButton","Tooltip","PopoverController","Popover","Toggletip","Portal","getPortalContainer","PortalContainer","CustomScrollbar","TabbedContainer","ClipboardButton","Cascader","ButtonCascader","InlineToast","LoadingPlaceholder","LoadingBar","ColorPicker","SeriesColorPicker","ColorPickerInput","SeriesColorPickerPopover","SeriesColorPickerPopoverWithTheme","EmptySearchResult","EmptyState","UnitPicker","StatsPicker","RefreshPicker","defaultIntervals","TimeRangePicker","TimePickerTooltip","TimeRangeLabel","TimeOfDayPicker","TimeZonePicker","WeekStartPicker","getWeekStart","DatePicker","DatePickerWithInput","DateTimePicker","List","InteractiveTable","TagsInput","AutoSaveField","Pagination","Tag","TagList","FilterPill","ConfirmModal","QueryField","CodeEditor","ReactMonacoEditor","CodeEditorSuggestionItemKind","variableSuggestionToCodeEditorSuggestion","Modal","ModalHeader","ModalTabsHeader","ModalTabContent","ModalsProvider","ModalRoot","ModalsController","ModalsContext","PageToolbar","SetInterval","Table","TableInputCSV","TabsBar","Tab","VerticalTab","TabContent","Counter","RenderUserContentAsHTML","BigValue","BigValueColorMode","BigValueGraphMode","BigValueJustifyMode","BigValueTextMode","Sparkline","Gauge","BarGauge","VizTooltip","VizTooltipContainer","SeriesTable","SeriesTableRow","VizRepeater","PanelChrome","PanelChromeLoadingIndicator","PanelContextProvider","PanelContextRoot","usePanelContext","VizLayout","SeriesVisibilityChangeBehavior","VizLegend","VizLegendListItem","Alert","GraphSeriesToggler","Collapse","ControlledCollapse","CollapsableSection","DataLinkButton","FieldLinkList","FullWidthButtonContainer","ClickOutsideWrapper","CallToActionCard","ContextMenu","Menu","MenuGroup","MenuItem","WithContextMenu","DataLinksInlineEditor","DataLinkInput","DataLinksContextMenu","SeriesIcon","InfoBox","FeatureInfoBox","FeatureBadge","JSONFormatter","JsonExplorer","ErrorBoundary","ErrorBoundaryAlert","withErrorBoundary","ErrorWithStack","DataSourceHttpSettings","CustomHeadersSettings","AlertingSettings","SecureSocksProxySettings","TLSAuthSettings","CertificationKey","Spinner","FadeTransition","SlideOutTransition","Segment","SegmentAsync","SegmentInput","SegmentSelect","SegmentSection","Drawer","Slider","RangeSlider","Form","sharedInputStyle","InputControl","Button","LinkButton","ButtonGroup","clearButtonStyles","ToolbarButton","ToolbarButtonRow","ValuePicker","fieldMatchersUI","Link","TextLink","Text","Box","Stack","Grid","Space","Label","Field","Legend","FieldSet","FieldValidationMessage","InlineField","InlineSegmentGroup","InlineLabel","InlineFieldRow","FieldArray","resetSelectStyles","SelectMenuOptions","getSelectStyles","HorizontalGroup","VerticalGroup","Container","Badge","RadioButtonGroup","RadioButtonDot","RadioButtonList","Input","getInputStyles","AutoSizeInput","FilterInput","Switch","InlineSwitch","Checkbox","TextArea","FileUpload","TimeRangeInput","RelativeTimeRangePicker","Card","getCardStyles","CardContainer","FormattedValueDisplay","ButtonSelect","Dropdown","PluginSignatureBadge","UserIcon","Avatar","InlineFormLabel","Divider","getDragStyles","useSplitter","LegacyForms","LegacyInputStatus","ScaleDistribution","BarGaugeDisplayMode","UPlotConfigBuilder","UPLOT_AXIS_FONT_SIZE","UPlotChart","PlotLegend","FIXED_UNIT","BrowserLabel","PanelContainer","Graph","GraphWithLegend","GraphContextMenu","GraphContextMenuHeader","graphTimeFormat","graphTickFormatter","GraphNG","TimeSeries","useGraphNGContext","preparePlotFrame","buildScaleKey","ZoomPlugin","TooltipPlugin","convertOldAngularValueMapping","sharedSingleStatMigrationHandler","sharedSingleStatPanelChangedHandler","AsyncMultiSelect","AsyncSelect","AsyncVirtualizedSelect","MultiSelect","Select","SelectContainer","VirtualizedSelect"].indexOf(Wo)<0&&(Pa[Wo]=()=>Ss[Wo]);e.d(O,Pa);var Ea=e(66864),Ys=e(39938),ha=e(94354),ja=e(79569),ua=e(83186),za=e(10354),Ja=e(51440),pr=e(67647),Wr=e(49718),Fr=e(7968),Kr=e(15292),Ar=e(10880),$r=e(21744),so=e(73546),Zr=e(92887),mo=e(54230),ao=e(5308),Fa=e(10860),fo=e(81507),ko=e(9286),Go=e(9261),Ut=e(83122),Yt=e(98624),Tn=e(99635),rn=e(12942),In=e(38894),cs=e(25994),ds=e(69144),Gs=e(21633),js=e(52198),Ca=e(52622),Aa=e(51336),qs=e(30501),xs=e(81297),Er=e(24182),fr=e(96747),gr=e(66737),Rr=e(52811),Dr=e(88895),Mo=e(54438),So=e(52494),Ka=e(48747),Sa=e(5484),Za=e(33083),ur=e(65036),da=e(99755),ro=e(18262),Uo=e(16998),No=e(65575),wo=e(76284),Di=e(90606);const ii={SecretFormField:a.L,FormField:t.z,Select:r.l6,AsyncSelect:r.DW,IndicatorsContainer:i.s,NoOptionsMessage:s.l,Input:n.p,Switch:f.d}},31511:(G,O,e)=>{"use strict";e.d(O,{A:()=>f});var t=e(74848),n=e(32196),i=e(96540),s=e(86634),r=e(40845);function f(c){const{visible:o,children:h,duration:g=250}=c,l=(0,r.of)(a,g),p=(0,i.useRef)(null);return(0,t.jsx)(s.A,{in:o,mountOnEnter:!0,unmountOnExit:!0,timeout:g,classNames:l,nodeRef:p,children:i.cloneElement(h,{ref:p})})}const a=(c,o)=>({enter:(0,n.css)({label:"enter",opacity:0}),enterActive:(0,n.css)({label:"enterActive",opacity:1,[c.transitions.handleMotion("no-preference","reduce")]:{transition:`opacity ${o}ms ease-out`}}),exit:(0,n.css)({label:"exit",opacity:1}),exitActive:(0,n.css)({label:"exitActive",opacity:0,[c.transitions.handleMotion("no-preference","reduce")]:{transition:`opacity ${o}ms ease-out`}})})},72960:(G,O,e)=>{"use strict";e.d(O,{n:()=>f});var t=e(74848),n=e(32196),i=e(96540),s=e(86634),r=e(40845);function f(c){const{visible:o,children:h,duration:g=250,horizontal:l,size:p}=c,m=(0,r.of)(a,g,l?"width":"height",p),y=(0,i.useRef)(null);return(0,t.jsx)(s.A,{in:o,mountOnEnter:!0,unmountOnExit:!0,timeout:g,classNames:m,nodeRef:y,children:i.cloneElement(h,{ref:y})})}const a=(c,o,h,g)=>({enter:(0,n.css)({label:"enter",[`${h}`]:0,opacity:0}),enterActive:(0,n.css)({label:"enterActive",[`${h}`]:`${g}px`,opacity:1,[c.transitions.handleMotion("no-preference")]:{transition:`opacity ${o}ms ease-out, ${h} ${o}ms ease-out`},[c.transitions.handleMotion("reduce")]:{transition:`opacity ${o}ms ease-out`}}),exit:(0,n.css)({label:"exit",[`${h}`]:`${g}px`,opacity:1}),exitActive:(0,n.css)({label:"exitActive",opacity:0,[`${h}`]:0,[c.transitions.handleMotion("no-preference")]:{transition:`opacity ${o}ms ease-out, ${h} ${o}ms ease-out`},[c.transitions.handleMotion("reduce")]:{transition:`opacity ${o}ms ease-out`}})})},81297:(G,O,e)=>{"use strict";e.d(O,{Z:()=>o});var t=e(74848),n=e(96540),i=e(36613),s=e(16895),r=e(7650);function f(h,g){return g.width===h.width&&g.height===h.height}function a(h,g){return g.data===h.data}function c(h,g){return g.config===h.config}class o extends n.Component{constructor(g){super(g),this.plotContainer=(0,n.createRef)(),this.plotCanvasBBox=(0,n.createRef)(),this.state={plot:null}}reinitPlot(){let{width:g,height:l,plotRef:p}=this.props;if(this.state.plot?.destroy(),g===0&&l===0)return;this.props.config.addHook("setSize",d=>{d.over});const m={width:Math.floor(this.props.width),height:Math.floor(this.props.height),...this.props.config.getConfig()};(0,s.uY)("UPlot",!1,"Reinitializing plot",m);const y=new i.A(m,this.props.data,this.plotContainer.current);p&&p(y),this.setState({plot:y})}componentDidMount(){this.reinitPlot()}componentWillUnmount(){this.state.plot?.destroy()}componentDidUpdate(g){let{plot:l}=this.state;f(g,this.props)?c(g,this.props)?a(g,this.props)||l?.setData(this.props.data):this.reinitPlot():l?.setSize({width:Math.floor(this.props.width),height:Math.floor(this.props.height)})}render(){return(0,t.jsxs)("div",{style:{position:"relative"},children:[(0,t.jsx)("div",{ref:this.plotContainer,"data-testid":"uplot-main-div"}),this.props.children]})}}},24182:(G,O,e)=>{"use strict";e.d(O,{$:()=>g,t:()=>h});var t=e(74848),n=e(96540),i=e(28240),s=e(8066),r=e(52622),f=e(40845),a=e(67266),c=e(96516),o=e(16895);function h(l,p){return l.getSeries().some(m=>{const y=m.props.dataFrameFieldIndex;if(!y)return!1;const d=p[y.frameIndex]?.fields[y.fieldIndex];return!(!d||d.config.custom?.hideFrom?.legend)})}const g=(0,n.memo)(({data:l,config:p,placement:m,calcs:y,displayMode:d,...v})=>{const u=(0,f.$j)(),D=p.getSeries().map(P=>{const x=P.props,E=x.dataFrameFieldIndex,C=p.getAxisPlacement(P.props.scaleKey);if(!E)return;const M=l[E.frameIndex]?.fields[E.fieldIndex];if(!M||M.config.custom?.hideFrom?.legend)return;const S=(0,i.Ct)(M,l[E.frameIndex],l),T=(0,s.lz)(M,u).color;return{disabled:!(x.show??!0),fieldIndex:E,color:T,label:S,yAxis:C===r.vM.Left||C===r.vM.Bottom?1:2,getDisplayValues:()=>(0,o.UO)(y,M,u),getItemKey:()=>`${S}-${E.frameIndex}-${E.fieldIndex}`,lineStyle:x.lineStyle}}).filter(P=>P!==void 0);return(0,t.jsx)(a.KU.Legend,{placement:m,...v,children:(0,t.jsx)(c.t,{placement:m,items:D,displayMode:d,sortBy:v.sortBy,sortDesc:v.sortDesc,isSortable:!0})})});g.displayName="PlotLegend"},52198:(G,O,e)=>{"use strict";e.d(O,{t:()=>n});var t=e(52622);const n={drawStyle:[{label:"Lines",value:t.GR.Line},{label:"Bars",value:t.GR.Bars},{label:"Points",value:t.GR.Points}],lineInterpolation:[{description:"Linear",value:t.dx.Linear,icon:"gf-interpolation-linear"},{description:"Smooth",value:t.dx.Smooth,icon:"gf-interpolation-smooth"},{description:"Step before",value:t.dx.StepBefore,icon:"gf-interpolation-step-before"},{description:"Step after",value:t.dx.StepAfter,icon:"gf-interpolation-step-after"}],barAlignment:[{description:"Before",value:t.Nj.Before,icon:"gf-bar-alignment-before"},{description:"Center",value:t.Nj.Center,icon:"gf-bar-alignment-center"},{description:"After",value:t.Nj.After,icon:"gf-bar-alignment-after"}],showPoints:[{label:"Auto",value:t.yL.Auto,description:"Show points when the density is low"},{label:"Always",value:t.yL.Always},{label:"Never",value:t.yL.Never}],axisPlacement:[{label:"Auto",value:t.vM.Auto,description:"First field on the left, everything else on the right"},{label:"Left",value:t.vM.Left},{label:"Right",value:t.vM.Right},{label:"Hidden",value:t.vM.Hidden}],fillGradient:[{label:"None",value:t.on.None},{label:"Opacity",value:t.on.Opacity,description:"Enable fill opacity gradient"},{label:"Hue",value:t.on.Hue,description:"Small color hue gradient"},{label:"Scheme",value:t.on.Scheme,description:"Use color scheme to define gradient"}],stacking:[{label:"Off",value:t.gs.None},{label:"Normal",value:t.gs.Normal},{label:"100%",value:t.gs.Percent}],thresholdsDisplayModes:[{label:"Off",value:t.Ly.Off},{label:"As lines",value:t.Ly.Line},{label:"As lines (dashed)",value:t.Ly.Dashed},{label:"As filled regions",value:t.Ly.Area},{label:"As filled regions and lines",value:t.Ly.LineAndArea},{label:"As filled regions and lines (dashed)",value:t.Ly.DashedAndArea}]}},30501:(G,O,e)=>{"use strict";e.d(O,{Zj:()=>l,pi:()=>o,zH:()=>g});var t=e(83195),n=e(97706),i=e(42994),s=e(72724),r=e(52622),f=e(29413),a=e(52811),c=e(93060);const o=12,h=8;class g extends a.R{merge(d){this.props.size=(0,c.Y)("max",this.props.size,d.size),this.props.label||(this.props.label=d.label),this.props.placement===r.vM.Auto&&(this.props.placement=d.placement)}calculateSpace(d,v,u,D,P){const x=d.axes[v],E=d.scales[x.scale];if(x.side!==2||!E)return 30;const C=40;if(E.time){const M=P/C,S=(D-u)/M,I=p(d,[u],v,C,S);return(0,f.kD)(I[0],o).width+18}return C}calculateAxisSize(d,v,u){const D=d.axes[u];let P=D.ticks.size;if(D.side===2)P+=D.gap+o;else if(v?.length){let x=v.reduce((C,M)=>Math.max(C,(0,f.kD)(M,o).width),0);const E=Math.min(d.width*.4,x);P+=D.gap+D.labelGap+E}return Math.ceil(P)}getConfig(){let{scaleKey:d,label:v,show:u=!0,placement:D=r.vM.Auto,grid:P={show:!0},ticks:x,space:E,filter:C,gap:M=5,formatValue:S,splits:I,values:T,incrs:b,isTime:R,timeZone:A,theme:L,tickLabelRotation:U,size:W,color:w,border:N,decimals:B,distr:V=r.L4.Linear}=this.props;const K=`${o}px ${L.typography.fontFamily}`,H=L.isDark?"rgba(240, 250, 255, 0.09)":"rgba(0, 10, 23, 0.09)";(0,t.j9)(d)&&(I=[0,1]),B===0&&V===r.L4.Linear&&(C=(k,Y)=>Y.map(Z=>Number.isInteger(Z)?Z:null));let X={scale:d,show:u,stroke:w??L.colors.text.primary,side:m(D),font:K,size:W??((k,Y,Z)=>this.calculateAxisSize(k,Y,Z)),rotate:U,gap:M,labelGap:0,grid:{show:P.show,stroke:H,width:1/devicePixelRatio},ticks:Object.assign({show:!0,stroke:N?.show?w??L.colors.text.primary:H,width:1/devicePixelRatio,size:4},x),splits:I,values:T,space:E??((k,Y,Z,se,j)=>this.calculateSpace(k,Y,Z,se,j)),filter:C,incrs:b};return N?.show&&(X.border={stroke:w??L.colors.text.primary,width:1/devicePixelRatio,...N}),v!=null&&v.length>0&&(X.label=v,X.labelSize=o+h,X.labelFont=K,X.labelGap=h),T?X.values=T:R?X.values=p:S&&(X.values=(k,Y,Z,se,j)=>{let q=(0,n.E)((0,n.h)(j,6));return Y.map(ne=>S(ne,q>0?q:void 0))}),X.timeZone=A,X}}const l={second:1e3,minute:60*1e3,hour:60*60*1e3,day:24*60*60*1e3,month:28*24*60*60*1e3,year:365*24*60*60*1e3};function p(y,d,v,u,D){const P=y.axes[v],x="timeZone"in P&&typeof P.timeZone=="string"?P.timeZone:void 0,E=y.scales.x,C=(E?.max??0)-(E?.min??0),M=Math.round(l.year/l.day)*l.day,S=Math.round(D/l.day)*l.day;let I=i.WC.interval.year;return D<l.second?I=i.WC.interval.millisecond:D<=l.minute?I=i.WC.interval.second:C<=l.day?I=i.WC.interval.minute:D<=l.day?I=i.WC.interval.hour:C<l.year?I=i.WC.interval.day:S===M?I=i.WC.interval.year:D<=l.year&&(I=i.WC.interval.month),d.map(T=>T==null?"":(0,s.LE)(T,{format:I,timeZone:x}))}function m(y){switch(y){case r.vM.Top:return 0;case r.vM.Right:return 1;case r.vM.Bottom:return 2;case r.vM.Left:}return 3}},51336:(G,O,e)=>{"use strict";e.d(O,{e:()=>P});var t=e(2543),n=e(36613),i=e(43127),s=e(91410),r=e(52622),f=e(16895),a=e(30501),c=e(93060),o=e(24293),h=e(23596),g=e(52811),l=e(74863);class p extends g.R{getConfig(){const{facets:E,drawStyle:C,pathBuilder:M,pointsBuilder:S,pointsFilter:I,lineInterpolation:T,lineWidth:b,lineStyle:R,barAlignment:A,barWidthFactor:L,barMaxWidth:U,showPoints:W,pointSize:w,scaleKey:N,pxAlign:B,spanNulls:V,show:K=!0}=this.props;let H={},X=this.getLineColor();H.stroke=X,H.width=b,R&&R.fill!=="solid"&&(R.fill==="dot"&&(H.cap="round"),H.dash=R.dash??[10,10]),M!=null?H.paths=M:C===r.GR.Points?H.paths=()=>null:C!=null&&(H.paths=(Z,se,j,q)=>y(C,T,A,L,U)(Z,se,j,q));const k=typeof X=="string"?X:(Z,se)=>Z.series[se]._stroke,Y={points:{stroke:k,fill:k,size:!w||w<b?void 0:w,filter:I}};return S!=null?Y.points.show=S:C===r.GR.Points?Y.points.show=!0:W===r.yL.Auto?C===r.GR.Bars&&(Y.points.show=!1):W===r.yL.Never?Y.points.show=!1:W===r.yL.Always&&(Y.points.show=!0),{scale:N,facets:E,spanGaps:typeof V=="number"?!1:V,value:()=>"",pxAlign:B,show:K,fill:this.getFill(),...H,...Y}}getLineColor(){const{lineColor:E,gradientMode:C,colorMode:M,thresholds:S,theme:I,hardMin:T,hardMax:b,softMin:R,softMax:A,dynamicSeriesColor:L}=this.props;return C===r.on.None&&L?(U,W)=>L(W)??E??o.F:C===r.on.Scheme&&M?.id!==o.Y.Fixed?(0,l.pl)(1,I,M,S,T,b,R,A):C===r.on.Hue?(0,l.B5)(E??o.F,1,I):E??o.F}getFill(){const{lineColor:E,fillColor:C,gradientMode:M,fillOpacity:S,colorMode:I,thresholds:T,theme:b,hardMin:R,hardMax:A,softMin:L,softMax:U,dynamicSeriesColor:W}=this.props;if(C)return C;const w=M??r.on.None,N=(S??0)/100;if(w===r.on.None&&W&&N>0)return(B,V)=>{let K=B.series[V]._stroke;return h.MV.alpha(K??"",N)};switch(w){case r.on.Opacity:return(0,l.WO)(C??E,N);case r.on.Hue:return(0,l.B5)(C??E,N,b);case r.on.Scheme:if(I?.id!==o.Y.Fixed)return(0,l.pl)(N,b,I,T,R,A,L,U);default:if(N>0)return h.MV.alpha(E??"",N)}}}let m;function y(x,E,C=r.Nj.Center,M=.6,S=200){const I=n.A.paths;if(m||(m={linear:I.linear(),smooth:I.spline(),stepBefore:I.stepped({align:-1}),stepAfter:I.stepped({align:1})}),x===r.GR.Bars){let T=`bars|${C}|${M}|${S}`;return m[T]||(m[T]=I.bars({size:[M,S],align:C})),m[T]}else if(x===r.GR.Line){if(E===r.dx.StepBefore)return m.stepBefore;if(E===r.dx.StepAfter)return m.stepAfter;if(E===r.dx.Smooth)return m.smooth}return m.linear}var d=e(84140),v=e(50082);function u(x){const E=x.config.mode===r.Ly.Dashed||x.config.mode===r.Ly.DashedAndArea?[10,10]:[];function C(W,w,N,B){let V=W.ctx,K=0;for(let H=0;H<N.length;H++)if(N[H].color==="transparent"){K=H;break}V.lineWidth=2,V.setLineDash(E);for(let H=1;H<N.length;H++){const X=N[H];let k;K>=H&&H>0?k=(0,d.A)(B.visualization.getColorByName(N[H-1].color)):k=(0,d.A)(B.visualization.getColorByName(X.color)),k.getAlpha()===1&&k.setAlpha(.7);let Y=Math.round(W.bbox.left),Z=Math.round(W.valToPos(X.value,w,!0)),se=Math.round(W.bbox.left+W.bbox.width),j=Math.round(W.valToPos(X.value,w,!0));V.beginPath(),V.moveTo(Y,Z),V.lineTo(se,j),V.strokeStyle=k.toString(),V.stroke()}}function M(W,w,N,B){let V=W.ctx,K=(0,l.Z8)(W,w,N.map(H=>{let X=(0,d.A)(B.visualization.getColorByName(H.color));return X.getAlpha()===1&&X.setAlpha(.15),[H.value,X.toString()]}),!0);V.fillStyle=K,V.fillRect(W.bbox.left,W.bbox.top,W.bbox.width,W.bbox.height)}const{scaleKey:S,thresholds:I,theme:T,config:b,hardMin:R,hardMax:A,softMin:L,softMax:U}=x;return W=>{const w=W.ctx,{min:N,max:B}=W.scales.x,{min:V,max:K}=W.scales[S];if(N==null||B==null||V==null||K==null)return;let{steps:H,mode:X}=I;if(X===v.O.Percentage){let[k,Y]=(0,l.EJ)(W,S,R,A,L,U),Z=Y-k;H=H.map(se=>({...se,value:k+Z*(se.value/100)}))}switch(w.save(),b.mode){case r.Ly.Line:case r.Ly.Dashed:C(W,S,H,T);break;case r.Ly.Area:M(W,S,H,T);break;case r.Ly.LineAndArea:case r.Ly.DashedAndArea:M(W,S,H,T),C(W,S,H,T)}w.restore()}}const D={drag:{setScale:!1},points:{size:(x,E)=>x.series[E].points.size*2,width:(x,E,C)=>C/4},focus:{prox:30}};class P{constructor(E=i.lE){this.uid=Math.random().toString(36).slice(2),this.series=[],this.axes={},this.scales=[],this.bands=[],this.stackingGroups=[],this.hasLeftAxis=!1,this.hooks={},this.tz=void 0,this.mode=1,this.frames=void 0,this.thresholds={},this.padding=void 0,this.prepData=void 0,this.scaleKeys=["",""],this.tzDate=C=>{let M=new Date(C);return this.tz?n.A.tzDate(M,this.tz):M},this.tz=(0,s.QZ)(E,Date.now())?.ianaName}addHook(E,C){(0,f.uY)("UPlotConfigBuilder",!1,"addHook",E),this.hooks[E]||(this.hooks[E]=[]),this.hooks[E].push(C)}addThresholds(E){this.thresholds[E.scaleKey]||(this.thresholds[E.scaleKey]=E,this.addHook("drawClear",u(E)))}addAxis(E){E.placement=E.placement??r.vM.Auto,E.grid=E.grid??{};let C=E.scaleKey;if(C==="x"&&(C+=E.timeZone??""),this.axes[C]){this.axes[C].merge(E);return}E.placement===r.vM.Auto&&(E.placement=this.hasLeftAxis?r.vM.Right:r.vM.Left),E.placement===r.vM.Left&&(this.hasLeftAxis=!0),E.placement===r.vM.Hidden&&(E.grid.show=!1,E.size=0),this.axes[C]=new a.zH(E)}getAxisPlacement(E){return this.axes[E]?.props.placement??r.vM.Left}setCursor(E){this.cursor=(0,t.merge)({},this.cursor,E)}setMode(E){this.mode=E}setSelect(E){this.select=E}addSeries(E){this.series.push(new p(E))}getSeries(){return this.series}addScale(E){const C=this.scales.find(M=>M.props.scaleKey===E.scaleKey);if(C){C.merge(E);return}this.scales.push(new c.G(E))}addBand(E){this.bands.push(E)}setStackingGroups(E){this.stackingGroups=E}getStackingGroups(){return this.stackingGroups}setPrepData(E){this.prepData=C=>(this.frames=C,E(C,this.getStackingGroups()))}setPadding(E){this.padding=E}getConfig(){if(this.cachedConfig)return this.cachedConfig;const E={...f.NN,mode:this.mode,series:[this.mode===2?null:{value:()=>""}]};E.axes=this.ensureNonOverlappingAxes(Object.values(this.axes)).map(M=>M.getConfig()),E.series=[...E.series,...this.series.map(M=>M.getConfig())],E.scales=this.scales.reduce((M,S)=>({...M,...S.getConfig()}),{}),E.hooks=this.hooks,E.select=this.select;const C=(M="")=>(S,I)=>{let T=S.series[I].points._stroke;if(typeof T!="string"){let b=this.frames[0].fields[I];T=b.display(b.values[S.cursor.idxs[I]]).color}return T+M};return E.cursor=(0,t.merge)({},D,{points:{stroke:C("80"),fill:C()}},this.cursor),E.tzDate=this.tzDate,Array.isArray(this.padding)&&(E.padding=this.padding),this.stackingGroups.forEach(M=>{(0,f.Tz)(M).forEach(S=>{this.addBand(S)})}),this.bands.length&&(E.bands=this.bands),this.cachedConfig=E,E}ensureNonOverlappingAxes(E){const C=E.find(I=>I.props.scaleKey==="x"),M=E.filter(I=>I.props.grid?.show===void 0),S=M.findIndex(I=>I.props.placement===r.vM.Left||I.props.placement===r.vM.Right||I.props.placement===r.vM.Bottom&&I!==C);for(let I=0;I<M.length;I++)M[I]===C||I===S?M[I].props.grid.show=!0:M[I].props.grid.show=!1;return E}}},93060:(G,O,e)=>{"use strict";e.d(O,{G:()=>f,Y:()=>a});var t=e(36613),n=e(77678),i=e(83195),s=e(52622),r=e(52811);class f extends r.R{merge(o){this.props.min=a("min",this.props.min,o.min),this.props.max=a("max",this.props.max,o.max)}getConfig(){let{isTime:o,scaleKey:h,min:g,max:l,softMin:p,softMax:m,range:y,direction:d,orientation:v,centeredZero:u,decimals:D}=this.props;const P=this.props.distribution,x=o?{}:{distr:P===s.L4.Symlog?4:P===s.L4.Log?3:P===s.L4.Ordinal?2:1,log:P===s.L4.Log||P===s.L4.Symlog?this.props.log??2:void 0,asinh:P===s.L4.Symlog?this.props.linearThreshold??1:void 0};if(P===s.L4.Log){let A=this.props.log,L=A===2?Math.log2:Math.log10;g!=null&&(g<=0?g=null:g=A**Math.floor(L(g))),l!=null&&(l<=0?l=null:l=A**Math.ceil(L(l))),p!=null&&(p<=0?p=null:p=A**Math.floor(L(p))),m!=null&&(m<=0?m=null:m=A**Math.ceil(L(m)))}let E=p==null?3:1,C=m==null?3:1;const M={min:{pad:.1,hard:g??-1/0,soft:p||0,mode:E},max:{pad:.1,hard:l??1/0,soft:m||0,mode:C}};let S=p==null&&g!=null,I=m==null&&l!=null,T=S&&I;const b=(A,L,U,W)=>{const w=A.scales[W];let N=[L,U];if(!T&&L==null&&U==null)return N;let B=w.log??10;if(w.distr===1||w.distr===2||w.distr===4){if(u){let V=Math.abs(L),K=Math.abs(U),H=Math.max(V,K);H===0&&(H=80),L=-H,U=H}w.distr===4?N=t.A.rangeAsinh(L,U,B,!0):N=t.A.rangeNum(S?g:L,I?l:U,M)}else w.distr===3&&(N=t.A.rangeLog(g??L,l??U,B,!0));if(D===0)if(w.distr===1||w.distr===2)N[0]=(0,n.rs)(N[0],1),N[1]=(0,n.Uh)(N[1],1);else if(w.distr===3){let V=w.log===2?Math.log2:Math.log10;if(N[0]<=1)N[0]=1;else{let H=Math.floor(V(N[0]));N[0]=B**H}let K=Math.ceil(V(N[1]));N[1]=B**K,N[0]===N[1]&&(N[1]*=B)}else w.distr===4&&(N[0]=(0,n.rs)(N[0],1),N[1]=(0,n.Uh)(N[1],1));return(w.distr===1||w.distr===4)&&(S&&(N[0]=g),I&&(N[1]=l)),N[0]>=N[1]&&(N[0]=w.distr===3?1:0,N[1]=100),N};let R=!o&&!T;return(0,i.j9)(h)&&(R=!1,y=[0,1]),{[h]:{time:o,auto:R,range:y??b,dir:d,ori:v,...x}}}}function a(c,o,h){const g=o!=null,l=h!=null;return g?l?c==="min"?o<h?o:h:o>h?o:h:o:h}},74863:(G,O,e)=>{"use strict";e.d(O,{B5:()=>o,EJ:()=>p,WO:()=>c,Z8:()=>g,pl:()=>y});var t=e(84140),n=e(23596),i=e(24293),s=e(50082),r=e(52622),f=e(29413);function a(d,v,u){let D=0,P=0,x=0,E=0;return d===3?(P=v.top,E=v.top+v.height):d===2?(D=v.left+v.width,x=v.left):d===1?(P=v.top+v.height,E=v.top):d===0&&(D=v.left,x=v.left+v.width),u.createLinearGradient(D,P,x,E)}function c(d,v){return(u,D)=>{const P=(0,f.Yc)(),x=a(u.scales.x.ori===r.Lt.Horizontal?3:2,u.bbox,P);return x.addColorStop(0,n.MV.alpha(d,v)),x.addColorStop(1,n.MV.alpha(d,0)),x}}function o(d,v,u){return(D,P)=>{const x=(0,f.Yc)(),E=a(D.scales.x.ori===r.Lt.Horizontal?3:2,D.bbox,x),C=(0,t.A)(d).spin(-25).darken(5),M=(0,t.A)(d).saturate(20).spin(20).brighten(10);return u.isDark?(E.addColorStop(0,M.lighten(10).setAlpha(v).toString()),E.addColorStop(1,C.darken(10).setAlpha(v).toString())):(E.addColorStop(0,M.lighten(10).setAlpha(v).toString()),E.addColorStop(1,C.setAlpha(v).toString())),E}}var h=(d=>(d[d.Right=0]="Right",d[d.Up=1]="Up",d[d.Left=2]="Left",d[d.Down=3]="Down",d))(h||{});function g(d,v,u,D=!1){let P=d.scales[v],x=null,E=null;for(let N=0;N<u.length;N++){let B=u[N][0];if((B<=P.min||x==null)&&(x=N),E=N,B>=P.max)break}if(x===E)return u[x][1];let C=u[x][0],M=u[E][0];C===-1/0&&(C=P.min),M===1/0&&(M=P.max);let S=Math.round(d.valToPos(C,v,!0)),I=Math.round(d.valToPos(M,v,!0)),T=S-I;if(T===0)return u[E][1];let b,R,A,L;d.scales.x.ori===r.Lt.Horizontal?(b=A=0,R=S,L=I):(R=L=0,b=S,A=I);let W=(0,f.Yc)().createLinearGradient(b,R,A,L),w;for(let N=x;N<=E;N++){let B=u[N],V=N===x?S:N===E?I:Math.round(d.valToPos(B[0],v,!0)),K=(S-V)/T;D&&N>x&&W.addColorStop(K,w),W.addColorStop(K,w=B[1])}return W}function l(d,v){let u=d.scales[v],D=1/0,P=-1/0;return d.series.forEach((x,E)=>{if(x.show&&x.scale===v)if(x.min==null){let C=d.data[E];for(let M=0;M<C.length;M++)C[M]!=null&&(D=Math.min(D,C[M]),P=Math.max(P,C[M]))}else D=Math.min(D,x.min),P=Math.max(P,x.max)}),P===D&&(D=u.min,P=u.max),[D,P]}function p(d,v,u,D,P,x){let E=u??P??null,C=D??x??null;if(E==null||C==null){let[M,S]=l(d,v);E=E??M??0,C=C??S??100}return[E,C]}function m(d){return d==="transparent"||d[0]==="#"&&d.slice(-2)==="00"}function y(d,v,u,D,P,x,E,C){if(!u)throw Error("Missing colorMode required for color scheme gradients");if(!D)throw Error("Missing thresholds required for color scheme gradients");return(M,S)=>{let I=M.series[S].scale,T="";if(u.id===i.Y.Thresholds)if(D.mode===s.O.Absolute){const b=D.steps.map(R=>[R.value,m(R.color)?"#0000":n.MV.alpha(v.visualization.getColorByName(R.color),d)]);T=g(M,I,b,!0)}else{const[b,R]=p(M,I,P,x,E,C),A=R-b,L=D.steps.map(U=>[b+A*(U.value/100),n.MV.alpha(v.visualization.getColorByName(U.color),d)]);T=g(M,I,L,!0)}else if(u.getColors){const b=u.getColors(v),[R,A]=p(M,I,P,x,E,C),L=A-R,U=b.map((W,w)=>[R+L*(w/(b.length-1)),n.MV.alpha(v.visualization.getColorByName(W),d)]);T=g(M,I,U,!1)}return T}}},78226:(G,O,e)=>{"use strict";e.d(O,{a:()=>f});var t=e(74848),n=e(96540),i=e(1604),s=e(6967),r=e(97620);function f({id:a,events:c,renderEventMarker:o,mapEventToXYCoords:h,config:g}){const l=(0,n.useRef)(),[p,m]=(0,n.useState)(0),y=(0,i.A)();(0,n.useLayoutEffect)(()=>{g.addHook("init",v=>{l.current=v}),g.addHook("draw",()=>{y()&&m(v=>v+1)})},[g,m]);const d=(0,n.useMemo)(()=>{const v=[];if(!l.current||c.length===0)return v;for(let u=0;u<c.length;u++){const D=c[u];for(let P=0;P<D.length;P++){const x=h(D,{fieldIndex:P,frameIndex:u});x&&v.push((0,n.createElement)(s.p,{...x,key:`${a}-marker-${u}-${P}`},o(D,{fieldIndex:P,frameIndex:u})))}}return(0,t.jsx)(t.Fragment,{children:v})},[c,o,p]);return l.current?(0,t.jsx)(r._,{left:l.current.bbox.left/window.devicePixelRatio,top:l.current.bbox.top/window.devicePixelRatio,children:d}):null}},6967:(G,O,e)=>{"use strict";e.d(O,{p:()=>n});var t=e(74848);const n=({x:i,y:s,children:r})=>(0,t.jsx)("div",{style:{position:"absolute",top:`${s}px`,left:`${i}px`},children:r})},97620:(G,O,e)=>{"use strict";e.d(O,{_:()=>s});var t=e(74848),n=e(32196),i=e(96540);const s=({children:r,left:f,top:a})=>{const c=(0,i.useMemo)(()=>(0,n.css)({position:"absolute",overflow:"visible",left:`${f}px`,top:`${a}px`}),[f,a]);return(0,t.jsx)("div",{className:c,children:r})}},96747:(G,O,e)=>{"use strict";e.d(O,{_X:()=>i._,a:()=>t.a,pH:()=>n.p});var t=e(78226),n=e(6967),i=e(97620)},55129:(G,O,e)=>{"use strict";e.d(O,{M:()=>i});var t=e(52622),n=e(52811);function i(r,f){const a="na",c=`${r.min!==void 0?r.min:a}-${r.max!==void 0?r.max:a}`,o=`${r.custom?.axisSoftMin!==void 0?r.custom.axisSoftMin:a}-${r.custom?.axisSoftMax!==void 0?r.custom.axisSoftMax:a}`,h=`${r.custom?.axisPlacement!==void 0?r.custom?.axisPlacement:t.vM.Auto}`,g=r.unit??n.s,l=r.custom?.scaleDistribution?s(r.custom.scaleDistribution):t.L4.Linear,p=r.custom?.axisLabel?r.custom.axisLabel:a;return`${g}/${c}/${o}/${h}/${l}/${p}/${f}`}function s(r){return r.type===t.L4.Log?`${r.type}${r.log}`:r.type}},96287:(G,O,e)=>{"use strict";e.d(O,{J:()=>r});var t=e(74848),n=e(32196),i=e(29158),s=e(40845);const r=({onClick:a,"aria-label":c,style:o})=>{const h=(0,s.of)(f);return(0,t.jsx)(i.K,{"aria-label":c??"Close",className:h,name:"times",onClick:a,style:o})},f=a=>(0,n.css)({position:"absolute",margin:"0px",right:a.spacing(1),top:a.spacing(1.25)})},68268:(G,O,e)=>{"use strict";e.d(O,{K:()=>c});var t=e(2543),n=e.n(t),i=e(96540),s=e(64423),r=e(99165),f=e(69129),a=e(26272);const c=({config:o,eventBus:h,frame:g})=>{const l=(0,i.useRef)(g);return l.current=g,(0,i.useLayoutEffect)(()=>{let p=null;const m={point:{time:null},data:l.current};o.addHook("init",E=>{p=E});let y=null;o.addHook("setSeries",(E,C)=>{y=C}),o.addHook("setLegend",()=>{if(!(p.cursor.event==null)){let C=p.cursor.idxs.find(M=>M!=null);if(C==null)x();else{let M=C,S=y,I=p.data[0]??p.data[1][0];m.point.time=I[M],m.rowIndex=M??void 0,m.columnIndex=S??void 0,m.data=l.current;let T=p.cursor.top;m.point.panelRelY=T===0?.001:T>0?T/p.rect.height:1,P()}}});function d(E){const C=E.payload?.point?.time;if(C){const M=p.valToPos(C,"x");p.setCursor({left:M,top:p.rect.height/2})}}const v=new s.yU,u=new f.b_(m).setTags(["uplot"]),D=new f.ql().setTags(["uplot"]);let P=(0,t.throttle)(()=>{h.publish(u)},100),x=(0,t.throttle)(()=>{h.publish(D)},100);return v.add(h.getStream(f.b_).subscribe({next:E=>{h===E.origin||E.tags?.has("uplot")||d(E)}})),v.add(h.getStream(a.kb).subscribe({next:E=>d(E)})),v.add(h.getStream(f.ql).pipe((0,r.c)(50)).subscribe({next:E=>{h===E.origin||E.tags?.has("uplot")||p.cursor._lock||p.setCursor({left:-10,top:-10})}})),()=>{v.unsubscribe()}},[o]),null}},23117:(G,O,e)=>{"use strict";e.d(O,{Z:()=>c});var t=e(2543),n=e.n(t),i=e(96540);const s=.1,r=2,f=new Set(["ArrowRight","ArrowLeft","ArrowUp","ArrowDown","Shift"," "]),a=o=>{let h=o.root,g=new Set,l=null,p=null;if(!h)return;h.tabIndex=0;const m=(x,E)=>{const{cursor:C}=o;if(C.left===void 0||C.top===void 0)return;const{width:M,height:S}=o.over.style,[I,T]=[Math.floor(parseFloat(M)),Math.floor(parseFloat(S))];o.setCursor({left:(0,t.clamp)(C.left+x,0,I),top:(0,t.clamp)(C.top+E,0,T)})},y=x=>{if(g.size===0||!o){p=null;return}const M=(x-(p??x))*s;let S=0,I=0;g.has("ArrowUp")&&(I-=M),g.has("ArrowDown")&&(I+=M),g.has("ArrowLeft")&&(S-=M),g.has("ArrowRight")&&(S+=M),g.has("Shift")&&(S*=r,I*=r),m(S,I);const{cursor:T}=o;if(g.has(" ")&&T){const b=Number(o.over.style.height.slice(0,-2));o.setSelect({left:T.left<l?T.left:l,top:0,width:Math.abs(T.left-(l??T.left)),height:b},!1)}p=x,window.requestAnimationFrame(y)},d=x=>{if(x.key==="Tab"){o.setCursor({left:-5,top:-5});return}if(!f.has(x.key))return;if(x.preventDefault(),x.stopPropagation(),!g.has(x.key)){const C=g.size===0;g.add(x.key),l=x.key===" "&&l===null?o.cursor.left:l,C&&window.requestAnimationFrame(y)}},v=x=>{f.has(x.key)&&(g.delete(x.key),x.key===" "&&(x.preventDefault(),x.stopPropagation(),o.setSelect(o.select),l=null))},u=()=>{if(!h?.matches(":focus-visible"))return;const x=parseFloat(o.over.style.width),E=parseFloat(o.over.style.height);o.setCursor({left:x/2,top:E/2})},D=()=>{p=null,l=null,g.clear(),o.setSelect({left:0,top:0,width:0,height:0},!1)};h.addEventListener("keydown",d),h.addEventListener("keyup",v),h.addEventListener("focus",u),h.addEventListener("blur",D);const P=()=>{h?.removeEventListener("keydown",d),h?.removeEventListener("keyup",v),h?.removeEventListener("focus",u),h?.removeEventListener("blur",D),h=null};(o.hooks.destroy??=[]).push(P)},c=({config:o})=>((0,i.useLayoutEffect)(()=>o.addHook("init",a),[o]),null)},38761:(G,O,e)=>{"use strict";e.d(O,{b3:()=>g,xl:()=>d});var t=e(74848),n=e(32196),i=e(96540),s=e(40961),r=e(73134),f=e(40845),a=e(17464),c=e(96287);const o=void 0,h=10;var g=(u=>(u[u.xOne=0]="xOne",u[u.xAll=1]="xAll",u[u.xyOne=2]="xyOne",u))(g||{});function l(u,D){return{...u,...D,style:{...u.style,...D.style}}}function p(){return{style:{transform:"",pointerEvents:"none"},isHovering:!1,isPinned:!1,contents:null,plot:null,dismiss:()=>{}}}const m=5,y=u=>u!=null&&!u.ctrlKey&&!u.metaKey,d=({config:u,hoverMode:D,render:P,clientZoom:x=!1,queryZoom:E,onSelectRange:C,maxWidth:M,syncMode:S=r.yV.Off,syncScope:I="global"})=>{const T=(0,i.useRef)(null),b=(0,i.useRef)(null);b.current==null&&(b.current=(0,a.gF)());const[{plot:R,isHovering:A,isPinned:L,contents:U,style:W,dismiss:w},N]=(0,i.useReducer)(l,null,p),B=(0,i.useRef)(),V=(0,f.of)(v,M),K=(0,i.useRef)(P);return K.current=P,(0,i.useLayoutEffect)(()=>{B.current={width:0,height:0,observer:new ResizeObserver(Se=>{let We=B.current;for(const Ke of Se)Ke.borderBoxSize?.length>0?(We.width=Ke.borderBoxSize[0].inlineSize,We.height=Ke.borderBoxSize[0].blockSize):(We.width=Ke.contentRect.width,We.height=Ke.contentRect.height)})};let H=!1,X=!1,k=R,Y=A,Z=!1,se=L,j=W,q=!1;const ne=S===r.yV.Tooltip;S!==r.yV.Off&&u.scales[0].props.isTime&&u.setCursor({sync:{key:I,scales:["x",null]}});const oe=()=>{re?Y=q&&Z&&ne:Y=ae!=null||D===1&&Z};let z=0,te=0,le=null,ie=R?.cursor.idxs.slice(),ae=null,re=!1,ce=!1,me=!1;const ee=(Se=!1)=>{ce||(Y?queueMicrotask(De):setTimeout(De,100),ce=!0),Se&&(me=!0)},de=Se=>{T.current.contains(Se.target)||fe()},De=()=>{ce=!1,me&&(j={pointerEvents:se?"all":"none"},k.cursor._lock=se,se?(document.addEventListener("mousedown",de,!0),document.addEventListener("keydown",de,!0)):(document.removeEventListener("mousedown",de,!0),document.removeEventListener("keydown",de,!0)),me=!1);let Se={style:j,isPinned:se,isHovering:Y,contents:Y||le!=null?K.current(k,ie,ae,se,fe,le,re):null,dismiss:fe};N(Se),le=null},fe=()=>{let Se=se;se=!1,Y=!1,k.setCursor({left:-10,top:-10}),ee(Se)};u.addHook("init",Se=>{N({plot:k=Se}),x&&Se.over.addEventListener("mousedown",We=>{if(y(We)&&We.button===0&&We.shiftKey){X=!0,Se.cursor.drag.x=!1,Se.cursor.drag.y=!0;let Ke=Xe=>{Se.cursor.drag.x=!0,Se.cursor.drag.y=!1,document.removeEventListener("mouseup",Ke,!0)};document.addEventListener("mouseup",Ke,!0)}},!0),Se.over.addEventListener("click",We=>{if(We.target===Se.over)if(We.ctrlKey||We.metaKey){let Ke;Se.scales.x.ori===0?Ke=Se.posToVal(Se.cursor.left,"x"):Ke=Se.posToVal(Se.select.top+Se.select.height,"x"),le={from:Ke,to:Ke},ee(!1)}else Y&&ae!=null&&!se&&(se=!0,ee(!0))})}),u.addHook("setSelect",Se=>{const We=Se.scales.x.ori===0;if(!re&&(x||E!=null))if(y(Se.cursor.event)){if(C!=null){let Ke=[];const Xe=!!Se.cursor.drag.y,Je=!!Se.cursor.drag.x;let st=null,pt=[];Je&&(st={from:We?Se.posToVal(Se.select.left,"x"):Se.posToVal(Se.select.top+Se.select.height,"x"),to:We?Se.posToVal(Se.select.left+Se.select.width,"x"):Se.posToVal(Se.select.top,"x")}),Xe&&u.scales.forEach(xt=>{const ot=xt.props.scaleKey;if(ot!=="x"){let $e={from:We?Se.posToVal(Se.select.top+Se.select.height,ot):Se.posToVal(Se.select.left+Se.select.width,ot),to:We?Se.posToVal(Se.select.top,ot):Se.posToVal(Se.select.left,ot)};pt.push($e)}}),Je?Xe?Ke=pt.map(xt=>({x:st,y:xt})):Ke=[{x:st}]:Xe&&(Ke=pt.map(xt=>({y:xt}))),C(Ke)}else if(x&&X){if(Se.select.height>=m){for(let Ke in Se.scales)if(Ke!=="x"){const Xe=We?Se.posToVal(Se.select.top,Ke):Se.posToVal(Se.select.left+Se.select.width,Ke),Je=We?Se.posToVal(Se.select.top+Se.select.height,Ke):Se.posToVal(Se.select.left,Ke);Se.setScale(Ke,{min:Je,max:Xe})}H=!0}X=!1}else if(E!=null&&Se.select.width>=m){const Ke=We?Se.posToVal(Se.select.left,"x"):Se.posToVal(Se.select.top+Se.select.height,"x"),Xe=We?Se.posToVal(Se.select.left+Se.select.width,"x"):Se.posToVal(Se.select.top,"x");E({from:Ke,to:Xe}),H=!1}}else le={from:We?Se.posToVal(Se.select.left,"x"):Se.posToVal(Se.select.top+Se.select.height,"x"),to:We?Se.posToVal(Se.select.left+Se.select.width,"x"):Se.posToVal(Se.select.top,"x")},ee(!0);Se.setSelect({left:0,width:0,top:0,height:0},!1)}),(x||E!=null)&&u.setCursor({bind:{dblclick:Se=>()=>{if(!y(Se.cursor.event))return null;if(x&&H){for(let We in Se.scales)We!=="x"&&Se.setScale(We,{min:null,max:null});H=!1}else if(E!=null){let We=Se.scales.x;const Ke=We.min,Xe=We.max,Je=(Xe-Ke)/2;E({from:Ke-Je,to:Xe+Je})}return null}}}),u.addHook("setData",Se=>{H=!1,X=!1,se&&fe()}),u.addHook("setSeries",(Se,We)=>{ae=We,re=Se.cursor.event==null,oe(),ee()}),u.addHook("setLegend",Se=>{ie=k?.cursor.idxs.slice(),Z=ie.some((Ke,Xe)=>Xe>0&&Ke!=null),re=Se.cursor.event==null;let We=Y;oe(),(Y||Y!==We)&&ee()});const Te=16;let je=0,He=0;const Be=()=>{Y&&!se&&fe(),je=window.innerWidth-Te,He=window.innerHeight-Te},Ne=()=>{q=k.rect.bottom<=He&&k.rect.top>=0&&k.rect.left>=0&&k.rect.right<=je};Be(),u.addHook("ready",Ne),u.addHook("setCursor",Se=>{if(re=Se.cursor.event==null,!Y)return;let{left:We=-10,top:Ke=-10}=Se.cursor;if(We>=0||Ke>=0){let Xe=Se.rect.left+We,Je=Se.rect.top+Ke,st="",{width:pt,height:xt}=B.current;pt+=h,xt+=h,te!==0?Je+xt<He||Je-xt<0?te=0:te!==-xt&&(te=-xt):Je+xt>He&&Je-xt>=0&&(te=-xt),z!==0?Xe+pt<je||Xe-pt<0?z=0:z!==-pt&&(z=-pt):Xe+pt>je&&Xe-pt>=0&&(z=-pt);const ot=Xe+(z===0?h:-h),$e=Je+(te===0?h:-h);st=`translateX(${ot}px) ${z===0?"":"translateX(-100%)"} translateY(${$e}px) ${te===0?"":"translateY(-100%)"}`,T.current!=null?T.current.style.transform=st:(j.transform=st,ee())}});const Re=Se=>{Ne(),Y&&!se&&Se.target instanceof HTMLElement&&Se.target.contains(k.root)&&fe()};return window.addEventListener("resize",Be),window.addEventListener("scroll",Re,!0),()=>{window.removeEventListener("resize",Be),window.removeEventListener("scroll",Re,!0),document.removeEventListener("mousedown",de,!0),document.removeEventListener("keydown",de,!0)}},[u]),(0,i.useLayoutEffect)(()=>{const H=B.current;if(T.current!=null){H.observer.observe(T.current);const{width:X,height:k}=T.current.getBoundingClientRect();H.width=X,H.height=k;const Y=R.cursor.event;Y!=null?!(performance.now()-Y.timeStamp>16)&&R.over.dispatchEvent(Y):R.setCursor({left:R.cursor.left,top:R.cursor.top},!0)}else H.width=0,H.height=0},[A]),R&&A?(0,s.createPortal)((0,t.jsxs)("div",{className:(0,n.cx)(V.tooltipWrapper,L&&V.pinned),style:W,"aria-live":"polite","aria-atomic":"true",ref:T,children:[L&&(0,t.jsx)(c.J,{onClick:w}),U]}),b.current):null},v=(u,D)=>({tooltipWrapper:(0,n.css)({top:0,left:0,zIndex:u.zIndex.portal,whiteSpace:"pre",borderRadius:u.shape.radius.default,position:"fixed",background:u.colors.background.primary,border:`1px solid ${u.colors.border.weak}`,boxShadow:u.shadows.z2,userSelect:"text",maxWidth:D??"none"}),pinned:(0,n.css)({boxShadow:u.shadows.z3})})},66737:(G,O,e)=>{"use strict";e.d(O,{Ku:()=>n.K,Z7:()=>i.Z,xl:()=>t.xl});var t=e(38761),n=e(68268),i=e(23117)},52811:(G,O,e)=>{"use strict";e.d(O,{R:()=>n,s:()=>t});const t="__fixed";class n{constructor(s){this.props=s}}},16895:(G,O,e)=>{"use strict";e.d(O,{NN:()=>h,Tz:()=>l,UO:()=>u,bq:()=>m,ro:()=>p,sw:()=>y,uY:()=>P});var t=e(11261),n=e(50311),i=e(75059),s=e(57875),r=e(52622),f=e(40621),a=e(91040),c=e(55129);const o=(x,E,C)=>{let M=E%2?C[0]||C[2]:C[1]||C[3];return C[E]||!M?0:8},h={ms:1,focus:{alpha:1},cursor:{focus:{prox:30}},legend:{show:!1},padding:[o,o,o,o],series:[],hooks:{}};var g=(x=>(x[x.Pos=1]="Pos",x[x.Neg=-1]="Neg",x))(g||{});function l(x){let E=[],{series:C,dir:M}=x,S=C.length-1,I=C.slice().reverse();return I.forEach((T,b)=>{if(b!==S){let R=I[b+1];E.push({series:[T,R],dir:-1*M})}}),E}function p(x){let E=new Map;return x.fields.forEach(({config:C,values:M,type:S},I)=>{if(I===0)return;let{custom:T}=C;if(T==null||T.hideFrom?.viz)return;let{stacking:b}=T;if(b==null)return;let{mode:R,group:A}=b;if(R===r.gs.None)return;let L=T.transform,U=d(L,M),W=T.drawStyle,w=W===r.GR.Bars?T.barAlignment:W===r.GR.Line?T.lineInterpolation:null,N=`${U}|${R}|${A}|${(0,c.M)(C,S)}|${W}|${w}`,B=E.get(N);B==null&&(B={series:[],dir:U},E.set(N,B)),B.series.push(I)}),[...E.values()]}function m(x,E,C){let M=Array(x.fields.length),S=E.length,I=x.length,T=S>0?Array(I).fill(0):[],b=S>0?Array(I).fill(!1):[],R=Array.from({length:S},()=>T.slice()),A=Array.from({length:S},()=>b.slice());if(E.forEach((L,U)=>{let W=A[U];L.series.forEach(w=>{let N=x.fields[w];if(N.config.custom?.hideFrom?.viz)return;let B=N.values;for(let V=0;V<I;V++)B[V]!=null&&(W[V]=!0)})}),x.fields.forEach((L,U)=>{let W=L.values;if(U===0){L.type===t.PU.time?M[0]=(0,n.ks)(L).values:M[0]=W;return}let{custom:w}=L.config;if(!w||w.hideFrom?.viz){M[U]=W;return}if(w.transform===r.NU.Constant){let B=W.findIndex(K=>K!=null),V=W[B];W=Array(W.length).fill(void 0),W[B]=V}else if(W=W.slice(),w.transform===r.NU.NegativeY)for(let B=0;B<W.length;B++)W[B]!=null&&(W[B]*=-1);let N=w.stacking?.mode;if(!N||N===r.gs.None)M[U]=W;else{let B=E.findIndex(X=>X.series.indexOf(U)>-1),V=R[B],K=A[B],H=M[U]=Array(I);for(let X=0;X<I;X++){let k=W[X];k!=null?H[X]=V[X]+=k:H[X]=K[X]?V[X]:k}}}),C){let L=M.map((U,W)=>{let w=E.findIndex(N=>N.series.indexOf(W)>-1);return w!==-1?R[w]:U});C({totals:L})}return x.fields.forEach((L,U)=>{if(U===0||L.config.custom?.hideFrom?.viz)return;if(L.config.custom?.stacking?.mode===r.gs.Percent){let w=E.findIndex(K=>K.series.indexOf(U)>-1),N=R[w],B=E[w],V=M[U];for(let K=0;K<I;K++){let H=V[K];H!=null&&(V[K]=N[K]===0?0:B.dir*(H/N[K]))}}}),M}function y(x,E){let C,M=1,S=1,I=x.data[1][E],T=x.data[1][E];for(let b=1;b<x.data.length;b++){const A=x.data[b][E];A!=null&&(I==null?I=A:A>I&&(I=x.data[b][E],M=b),T==null?T=A:A<T&&(T=x.data[b][E],S=b))}return T==null&&I==null?C=void 0:T!=null&&I!=null?C=(x.valToPos(T,x.series[S].scale)+x.valToPos(I,x.series[M].scale))/2:C=x.valToPos(T||I,x.series[M||S].scale),C!==void 0&&C<0&&(C=x.bbox.height/devicePixelRatio),C}function d(x,E){const C=v(E);return x===r.NU.NegativeY?C?1:-1:C?-1:1}function v(x,E=100){const C=x.length;if(C===0)return!1;let M=0,S=C-1;for(;M<=S&&x[M]==null;)M++;for(;S>=M&&x[S]==null;)S--;let I=0,T=0;if(S>=M){const b=Math.max(1,Math.floor((S-M+1)/E));for(let R=M;R<=S;R+=b){const A=x[R];A!=null&&typeof A=="number"&&(A<0||Object.is(A,-0)?I++:A>0&&T++)}if(I>T)return!0}return!1}const u=(x,E,C)=>{if(!x?.length)return[];const M=b=>b==null?"-":b.toFixed(1),S=E.display??M;let I=null;const T=(0,i.Nw)({field:E,reducers:x});return x.map(b=>{const R=i.AS.get(b);let A=S;return R.id===i.gy.diffperc&&(A=(0,s.J)({field:{...E,config:{...E.config,unit:"percent"}},theme:C})),(R.id===i.gy.count||R.id===i.gy.changeCount||R.id===i.gy.distinctCount)&&(I||(I=(0,s.J)({field:{...E,config:{...E.config,unit:"none"}},theme:C})),A=I),{...A(T[b]),title:R.name,description:R.description}})},D=(0,a.h)("uPlot"),P=D.logger;(0,f.h)("graphng",void 0,D)},99755:(G,O,e)=>{"use strict";e.d(O,{o:()=>d});var t=e(74848),n=e(96540),i=e(64423),s=e(99165),r=e(85200),f=e(1173),a=e(11261),c=e(69129),o=e(26272),h=e(79041),g=e(67266),l=e(81297),p=e(16895),m=e(65575);function y(v,u,D=[]){for(const P of D)if(typeof P=="function"){if(!P(v,u))return!1}else if(u[P]!==v[P])return!1;return!0}class d extends n.Component{constructor(u){super(u),this.panelContext={},this.subscription=new i.yU,this.getTimeRange=()=>this.props.timeRange;let D=this.prepState(u);D.alignedData=D.config.prepData([D.alignedFrame]),this.state=D,this.plotInstance=n.createRef()}static{this.contextType=h.e4}prepState(u,D=!0){let P=null;const{frames:x,fields:E,preparePlotFrame:C}=u,S=(C||m.mY)(x,E||{x:r.sJ.get(f.Ct.firstTimeField).get({}),y:r.sJ.get(f.Ct.byTypes).get(new Set([a.PU.number,a.PU.enum]))},u.timeRange);if((0,p.uY)("GraphNG",!1,"data aligned",S),S){let I=this.state?.config;D&&(I=u.prepConfig(S,this.props.frames,this.getTimeRange),(0,p.uY)("GraphNG",!1,"config prepared",I)),P={alignedFrame:S,config:I},(0,p.uY)("GraphNG",!1,"data prepared",P.alignedData)}return P}handleCursorUpdate(u){const D=u.payload?.point?.time,P=this.plotInstance.current;if(P&&D){const x=P.valToPos(D,"x");let E;if(x&&(E=(0,p.sw)(P,P.posToIdx(x))),!E||!x)return;P.setCursor({left:x,top:E})}}componentDidMount(){this.panelContext=this.context;const{eventBus:u}=this.panelContext;this.subscription.add(u.getStream(c.b_).pipe((0,s.c)(50)).subscribe({next:D=>{u!==D.origin&&this.handleCursorUpdate(D)}})),this.subscription.add(u.getStream(o.kb).pipe((0,s.c)(50)).subscribe({next:D=>this.handleCursorUpdate(D)})),this.subscription.add(u.getStream(c.ql).pipe((0,s.c)(50)).subscribe({next:()=>{const D=this.plotInstance?.current;D&&!D.cursor._lock&&D.setCursor({left:-10,top:-10})}}))}componentDidUpdate(u){const{frames:D,structureRev:P,timeZone:x,propsToDiff:E}=this.props,C=!y(u,this.props,E);if(D!==u.frames||C||x!==u.timeZone){let M=this.prepState(this.props,!1);M&&((this.state.config===void 0||x!==u.timeZone||P!==u.structureRev||!P||C)&&(M.config=this.props.prepConfig(M.alignedFrame,this.props.frames,this.getTimeRange),(0,p.uY)("GraphNG",!1,"config recreated",M.config)),M.alignedData=M.config.prepData([M.alignedFrame]),this.setState(M))}}componentWillUnmount(){this.subscription.unsubscribe()}render(){const{width:u,height:D,children:P,renderLegend:x}=this.props,{config:E,alignedFrame:C,alignedData:M}=this.state;return E?(0,t.jsx)(g.KU,{width:u,height:D,legend:x(E),children:(S,I)=>(0,t.jsx)(l.Z,{config:E,data:M,width:S,height:I,plotRef:T=>this.plotInstance.current=T,children:P?P(E,C):null})}):null}}},16998:(G,O,e)=>{"use strict";e.d(O,{I:()=>i});var t=e(96540);const n=(0,t.createContext)({}),i=()=>{const{data:s,dimFields:r,mapSeriesIndexToDataFrameFieldIndex:f}=(0,t.useContext)(n),a=(0,t.useCallback)(()=>{const c=r.x;let o=null;for(let h=0;h<s.fields.length;h++)if(c(s.fields[h],s,[s])){o=s.fields[h];break}return o},[s,r]);return{dimFields:r,mapSeriesIndexToDataFrameFieldIndex:f,getXAxisField:a,alignedData:s}}},65575:(G,O,e)=>{"use strict";e.d(O,{My:()=>p,wX:()=>h,mY:()=>l});var t=e(11261),n=e(73060),i=e(52622),s=e(52811);const r={threshold:(y,d,v)=>y+v,midpoint:(y,d,v)=>(y+d)/2,plusone:(y,d,v)=>y+1};function f(y){if(y.frame.length===0)return y.frame;let d=!0,{frame:v,refFieldName:u,refFieldPseudoMax:D,refFieldPseudoMin:P,insertMode:x}=y;x||(x=r.threshold);const E=h(v,u);if(E==null)return v;E.state={...E.state,nullThresholdApplied:!0};const C=v.fields.map(S=>S.config.custom?.insertNulls||E.config.interval||null),M=new Set(C);if(M.delete(null),M.size===0)return v;if(M.size===1){const S=M.values().next().value;if(S<=0)return v;const I=E.values,T=v.fields.map(R=>R.values),b=a(I,T,S,P,D,x,d);return b===T?v:{...v,length:b[0].length,fields:v.fields.map((R,A)=>({...R,values:b[A]}))}}return v}function a(y,d,v,u=null,D=null,P,x){const E=y.length,C=[];if(u!=null&&u<y[0]){let T=Math.ceil((y[0]-u)/v),b=y[0]-T*v;for(;b<y[0];)C.push(P(b-v,b,v)),b+=v}C.push(y[0]);let M=y[0];for(let T=1;T<E;T++){const b=y[T];for(;b-M>v&&(C.push(P(M,b,v)),M+=v,!!x););C.push(b),M=b}if(D!=null&&D>M)for(;M+v<D;)C.push(P(M,D,v)),M+=v;const S=C.length;if(S===E)return d;const I=[];for(let T of d){let b;if(T!==y){b=Array(S);for(let R=0,A=0;R<S;R++)b[R]=y[A]===C[R]?T[A++]:null}else b=C;I.push(b)}return I}function c(y,d,v){let u,D;for(let P=0;P<d.length;P++)if(d[P]==null)D==null&&u!=null&&(D=P);else{if(D!=null){if(y[P]-u<v)for(;D<P;)d[D++]=void 0;D=null}u=y[P]}return d}function o(y){return y.type===t.PU.number&&y.config.custom?.drawStyle===i.GR.Bars&&!y.config.custom?.hideFrom?.viz}function h(y,d){return y.fields.find(v=>d!=null?v.name===d:v.type===t.PU.time)}function g(y,d){const v=h(y,d);let u=v?.values;for(let D=0;D<y.fields.length;D++){let P=y.fields[D];if(P===v||o(P))continue;let x=P.config.custom?.spanNulls;typeof x=="number"&&x!==-1&&u&&(P.values=c(u,P.values,x))}return y}function l(y,d,v){let u;e:for(let E of y)for(let C of E.fields)if(d.x(C,E,y)){u=C;break e}y=y.map(E=>u?.state?.nullThresholdApplied?E:f({frame:E,refFieldName:u.name,refFieldPseudoMin:v?.from.valueOf(),refFieldPseudoMax:v?.to.valueOf()}));let D=0;y.forEach(E=>{E.fields.forEach(C=>{o(C)&&(C.config.custom={...C.config.custom,spanNulls:-1},D++)})});let P=1/0;D>1&&y.forEach(E=>{if(!E.fields.some(o))return;const C=u.values;for(let M=0;M<C.length;M++)M>0&&(P=Math.min(P,C[M]-C[M-1]))});let x=(0,n.Fd)({frames:y,joinBy:d.x,keep:d.y,keepOriginIndices:!0});return x?(x=g(x,u.name),P!==1/0&&(x.fields.forEach((E,C)=>{let M=E.values;if(C===0){let S=M[M.length-1];M.push(S+P,S+2*P)}else o(E)?M.push(null,null):M.push(void 0,void 0)}),x.length+=2),x):null}function p(y,d){const v="na",u=`${y.min!==void 0?y.min:v}-${y.max!==void 0?y.max:v}`,D=`${y.custom?.axisSoftMin!==void 0?y.custom.axisSoftMin:v}-${y.custom?.axisSoftMax!==void 0?y.custom.axisSoftMax:v}`,P=`${y.custom?.axisPlacement!==void 0?y.custom?.axisPlacement:i.vM.Auto}`,x=y.unit??s.s,E=y.custom?.scaleDistribution?m(y.custom.scaleDistribution):i.L4.Linear,C=y.custom?.axisLabel?y.custom.axisLabel:v;return`${x}/${u}/${D}/${P}/${E}/${C}/${d}`}function m(y){return y.type===i.L4.Log?`${y.type}${y.log}`:y.type}},48747:(G,O,e)=>{"use strict";e.d(O,{T:()=>v});var t=e(74848),n=e(34796),i=e.n(n),s=e(2543),r=e(96540),f=e(61443),a=e(52622),c=e(75128),o=e(33083),h=e(3139),g=e(65036);const l=({dimensions:D,activeDimensions:P,pos:x,timeZone:E})=>{let C=null;if(P.xAxis===null)return null;P.yAxis&&(C=P.yAxis[0]);const M=P.xAxis[1]?(0,f.WK)(D.xAxis,P.xAxis[0],P.xAxis[1]):x.x,S=(0,g.DU)(D.yAxis.columns,D.xAxis.columns,M,E),I=S.time,T=S.results.map((b,R)=>({color:b.color,label:b.label,value:b.value,isActive:C===R}));return(0,t.jsx)(h.o,{series:T,timestamp:I})};l.displayName="MultiModeGraphTooltip";var p=e(83195),m=e(28240);const y=({dimensions:D,activeDimensions:P,timeZone:x})=>{if(P.yAxis===null||P.yAxis[1]===void 0||P.xAxis===null||P.xAxis[1]===void 0)return null;const E=(0,f.WK)(D.xAxis,P.xAxis[0],P.xAxis[1]),C=(0,f.P4)(D.xAxis,P.xAxis[0]),M=C.display?(0,p.cN)(C.display(E)):E,S=(0,f.P4)(D.yAxis,P.yAxis[0]),I=(0,f.WK)(D.yAxis,P.yAxis[0],P.yAxis[1]),T=S.display,b=T(I);return(0,t.jsx)(h.o,{series:[{color:b.color,label:(0,m.Ct)(S),value:(0,p.cN)(b)}],timestamp:M})};y.displayName="SingleModeGraphTooltip";const d=({mode:D=a.$N.Single,dimensions:P,activeDimensions:x,pos:E,timeZone:C})=>!x||!x.xAxis?null:D==="single"?(0,t.jsx)(y,{dimensions:P,activeDimensions:x,timeZone:C}):(0,t.jsx)(l,{dimensions:P,activeDimensions:x,pos:E,timeZone:C});d.displayName="GraphTooltip";class v extends r.PureComponent{constructor(){super(...arguments),this.state={isTooltipVisible:!1,isContextVisible:!1},this.element=null,this.$element=null,this.onPlotSelected=(P,x)=>{const{onHorizontalRegionSelected:E}=this.props;E&&E(x.xaxis.from,x.xaxis.to)},this.onPlotHover=(P,x,E)=>{this.setState({isTooltipVisible:!0,activeItem:E,pos:x})},this.onPlotClick=(P,x,E)=>{this.setState({isContextVisible:!0,isTooltipVisible:!1,contextItem:E,contextPos:x})},this.renderTooltip=()=>{const{children:P,series:x,timeZone:E}=this.props,{pos:C,activeItem:M,isTooltipVisible:S}=this.state;let I;if(!S||!C||x.length===0||(r.Children.forEach(P,N=>{if(I)return;(N&&N.type&&(N.type.displayName||N.type.name))===c.n.displayName&&(I=N)}),!I))return null;const T=I.props,b=T.mode||"single";if(!M&&b==="single")return null;const R=T.tooltipComponent||d,A=M?M.series.seriesIndex:0,L=M?M.dataIndex:void 0,U={xAxis:[A,L],yAxis:M?[M.series.seriesIndex,M.dataIndex]:null},W={dimensions:{xAxis:(0,f.r4)("xAxis",x.map(N=>N.timeField)),yAxis:(0,f.r4)("yAxis",x.map(N=>N.valueField))},activeDimensions:U,pos:C,mode:T.mode||a.$N.Single,timeZone:E},w=r.createElement(R,{...W});return r.cloneElement(I,{content:w,position:{x:C.pageX,y:C.pageY},offset:{x:10,y:10}})},this.renderContextMenu=()=>{const{series:P}=this.props,{contextPos:x,contextItem:E,isContextVisible:C}=this.state;if(!C||!x||!E||P.length===0)return null;const M=E?E.series.seriesIndex:0,S=E?E.dataIndex:void 0,I={xAxis:[M,S],yAxis:E?[E.series.seriesIndex,E.dataIndex]:null},T={xAxis:(0,f.r4)("xAxis",P.map(L=>L.timeField)),yAxis:(0,f.r4)("yAxis",P.map(L=>L.valueField))},b=()=>this.setState({isContextVisible:!1}),R=()=>({datapoint:E.datapoint,dataIndex:E.dataIndex,series:E.series,seriesIndex:E.series.seriesIndex,pageX:x.pageX,pageY:x.pageY}),A={x:x.pageX,y:x.pageY,onClose:b,getContextMenuSource:R,timeZone:this.props.timeZone,dimensions:T,contextDimensions:I};return(0,t.jsx)(o.H,{...A})},this.getBarWidth=()=>{const{series:P}=this.props;return Math.min(...P.map(x=>x.timeStep))}}static{this.defaultProps={showLines:!0,showPoints:!1,showBars:!1,isStacked:!1,lineWidth:1}}componentDidUpdate(P,x){P!==this.props&&this.draw()}componentDidMount(){this.draw(),this.element&&(this.$element=i()(this.element),this.$element.bind("plotselected",this.onPlotSelected),this.$element.bind("plothover",this.onPlotHover),this.$element.bind("plotclick",this.onPlotClick))}componentWillUnmount(){this.$element&&this.$element.unbind("plotselected",this.onPlotSelected)}getYAxes(P){return P.length===0?[{show:!0,min:-1,max:1}]:(0,s.uniqBy)(P.map(x=>{const E=x.yAxis?x.yAxis.index:1,C=x.yAxis&&x.yAxis.min&&!isNaN(x.yAxis.min)?x.yAxis.min:null,M=x.yAxis&&x.yAxis.tickDecimals&&!isNaN(x.yAxis.tickDecimals)?x.yAxis.tickDecimals:null;return{show:!0,index:E,position:E===1?"left":"right",min:C,tickDecimals:M}}),x=>x.index)}draw(){if(this.element===null)return;const{width:P,series:x,timeRange:E,showLines:C,showBars:M,showPoints:S,isStacked:I,lineWidth:T,timeZone:b,onHorizontalRegionSelected:R}=this.props;if(!P)return;const A=P/100,L=E.from.valueOf(),U=E.to.valueOf(),W=this.getYAxes(x),w={legend:{show:!1},series:{stack:I,lines:{show:C,lineWidth:T,zero:!1},points:{show:S,fill:1,fillColor:!1,radius:2},bars:{show:M,fill:1,barWidth:M?this.getBarWidth()/1.5:1,zero:!1,lineWidth:T},shadowSize:0},xaxis:{timezone:b,show:!0,mode:"time",min:L,max:U,label:"Datetime",ticks:A,timeformat:(0,g.Jc)(A,L,U),tickFormatter:g.Yn},yaxes:W,grid:{minBorderMargin:0,markings:[],backgroundColor:null,borderWidth:0,hoverable:!0,clickable:!0,color:"#a1a1a1",margin:{left:0,right:0},labelMarginX:0,mouseActiveRadius:30},selection:{mode:R?"x":null,color:"#666"},crosshair:{mode:"x"}};try{i().plot(this.element,x.filter(N=>N.isVisible),w)}catch(N){throw console.error("Graph rendering error",N,w,x),new Error("Error rendering panel")}}render(){const{ariaLabel:P,height:x,width:E,series:C}=this.props,M=C.length===0,S=this.renderTooltip(),I=this.renderContextMenu();return(0,t.jsxs)("div",{className:"graph-panel","aria-label":P,children:[(0,t.jsx)("div",{className:"graph-panel__chart",ref:T=>this.element=T,style:{height:x,width:E},onMouseLeave:()=>{this.setState({isTooltipVisible:!1})}}),M&&(0,t.jsx)("div",{className:"datapoints-warning",children:"No data"}),S,I]})}}const u=null},33083:(G,O,e)=>{"use strict";e.d(O,{H:()=>l,i:()=>p});var t=e(74848),n=e(32196),i=e(61443),s=e(72724),r=e(28122),f=e(9286),a=e(66864),c=e(59093),o=e(64539),h=e(94536),g=e(40845);const l=({getContextMenuSource:y,timeZone:d,itemsGroup:v,dimensions:u,contextDimensions:D,...P})=>{const x=y(),E=v?v.map(S=>({...S,items:S.items?.filter(I=>I.label)})):[],C=()=>{if(!x)return null;let S;if(u?.yAxis&&D?.yAxis?.[1]){const T=(0,i.WK)(u.yAxis,D.yAxis[0],D.yAxis[1]),b=x.series.valueField.display;S=b(T)}const I=(0,s.LE)(x.datapoint[0],{defaultWithMS:x.series.hasMsResolution,timeZone:d});return(0,t.jsx)(p,{timestamp:I,seriesColor:x.series.color,displayName:x.series.alias||x.series.label,displayValue:S})},M=()=>E?.map((S,I)=>(0,t.jsx)(c.r,{label:S.label,children:(S.items||[]).map(T=>(0,t.jsx)(o.D,{url:T.url,label:T.label,target:T.target,icon:T.icon,active:T.active,onClick:T.onClick},`${T.label}`))},`${S.label}${I}`));return(0,t.jsx)(r.t,{...P,renderMenuItems:M,renderHeader:C})},p=({timestamp:y,seriesColor:d,displayName:v,displayValue:u})=>{const D=(0,g.of)(m);return(0,t.jsxs)("div",{className:D.wrapper,children:[(0,t.jsx)("strong",{children:y}),(0,t.jsxs)(a.Gy,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(h.p,{color:d}),(0,t.jsx)("span",{className:D.displayName,children:v})]}),u&&(0,t.jsx)(f.i,{value:u})]})]})};function m(y){return{wrapper:(0,n.css)({padding:y.spacing(.5,1),fontSize:y.typography.size.sm,zIndex:y.zIndex.tooltip}),displayName:(0,n.css)({whiteSpace:"nowrap",paddingLeft:y.spacing(.5)})}}},84656:(G,O,e)=>{"use strict";e.d(O,{M:()=>s});var t=e(2543),n=e.n(t),i=e(96540);class s extends i.Component{constructor(f){super(f),this.onSeriesToggle=this.onSeriesToggle.bind(this),this.state={hiddenSeries:[],toggledSeries:f.series}}componentDidUpdate(f){const{series:a}=this.props;(0,t.isEqual)(f.series,a)||this.setState({hiddenSeries:[],toggledSeries:a})}onSeriesToggle(f,a){const{series:c,onHiddenSeriesChanged:o}=this.props,{hiddenSeries:h}=this.state;if(a.ctrlKey||a.metaKey||a.shiftKey){const m=h.indexOf(f)>-1?h.filter(d=>d!==f):h.concat([f]),y=c.map(d=>({...d,isVisible:m.indexOf(d.label)===-1}));this.setState({hiddenSeries:m,toggledSeries:y},()=>o?o(m):void 0);return}const g=c.map(m=>m.label),l=h.length+1===g.length?[]:(0,t.difference)(g,[f]),p=c.map(m=>({...m,isVisible:l.indexOf(m.label)===-1}));this.setState({hiddenSeries:l,toggledSeries:p},()=>o?o(l):void 0)}render(){const{children:f}=this.props,{toggledSeries:a}=this.state;return f({onSeriesToggle:this.onSeriesToggle,toggledSeries:a})}}},5484:(G,O,e)=>{"use strict";e.d(O,{I:()=>c});var t=e(74848),n=e(32196),i=e(40276),s=e(96516),r=e(40845),f=e(48747);const a=(h,g=!1,l=!1)=>{const p=h.reduce((y,d)=>y+(d[1]||0),0)===0,m=!h.reduce((y,d)=>y&&d[1]!==null,!0);return g&&m||l&&p},c=h=>{const{series:g,timeRange:l,width:p,height:m,showBars:y,showLines:d,showPoints:v,sortLegendBy:u,sortLegendDesc:D,legendDisplayMode:P,legendVisibility:x,placement:E,onSeriesToggle:C,onToggleSort:M,hideEmpty:S,hideZero:I,isStacked:T,lineWidth:b,onHorizontalRegionSelected:R,timeZone:A,children:L,ariaLabel:U}=h,{graphContainer:W,wrapper:w,legendContainer:N}=(0,r.of)(o,h.placement),B=g.reduce((V,K)=>a(K.data,S,I)?V:V.concat([{label:K.label,color:K.color||"",disabled:!K.isVisible,yAxis:K.yAxis.index,getDisplayValues:()=>K.info||[]}]),[]);return(0,t.jsxs)("div",{className:w,"aria-label":U,children:[(0,t.jsx)("div",{className:W,children:(0,t.jsx)(f.T,{series:g,timeRange:l,timeZone:A,showLines:d,showPoints:v,showBars:y,width:p,height:m,isStacked:T,lineWidth:b,onHorizontalRegionSelected:R,children:L})}),x&&(0,t.jsx)("div",{className:N,children:(0,t.jsx)(i.E,{hideHorizontalTrack:!0,children:(0,t.jsx)(s.t,{items:B,displayMode:P,placement:E,sortBy:u,sortDesc:D,onLabelClick:(V,K)=>{C&&C(V.label,K)},onToggleSort:M})})})]})},o=(h,g)=>({wrapper:(0,n.css)({display:"flex",flexDirection:g==="bottom"?"column":"row"}),graphContainer:(0,n.css)({minHeight:"65%",flexGrow:1}),legendContainer:(0,n.css)({padding:"10px 0",maxHeight:g==="bottom"?"35%":"none"})})},65036:(G,O,e)=>{"use strict";e.d(O,{DU:()=>f,Jc:()=>c,Yn:()=>a});var t=e(83195),n=e(28240),i=e(72724),s=e(42994);const r=(o,h)=>{let g=0,l=o.values.length-1,p;for(;;){if(g>l)return Math.max(l,0);p=Math.floor((g+l)/2);const m=o.values[p];if(m===h)return p;m&&m<h?g=p+1:l=p-1}},f=(o,h,g,l)=>{let p,m,y,d,v;const u=[];let D,P;for(p=0;p<o.length;p++){m=o[p];const x=h[p];y=r(x,g),d=g-x.values[y],v=x.values[y],(D===void 0||d>=0&&(d<D||D<0)||d<0&&d>D)&&(D=d,P=x.display?(0,t.cN)(x.display(v)):v);const E=m.display(m.values[y]);u.push({value:(0,t.cN)(E),datapointIndex:y,seriesIndex:p,color:E.color,label:(0,n.Ct)(m),time:x.display?(0,t.cN)(x.display(v)):v})}return{results:u,time:P}},a=(o,h)=>(0,i.LE)(o,{format:h?.options?.timeformat,timeZone:h?.options?.timezone}),c=(o,h,g)=>{if(h&&g&&o){const l=g-h,p=l/o/1e3,m=86400010,y=31536e6;return p<=10?s.WC.interval.millisecond:p<=45?s.WC.interval.second:l<=m?s.WC.interval.minute:p<=8e4?s.WC.interval.hour:l<=y?s.WC.interval.day:p<=31536e3?s.WC.interval.month:s.WC.interval.year}return s.WC.interval.minute}},18262:(G,O,e)=>{"use strict";e.d(O,{Z:()=>R});var t=e(74848),n=e(96540),i=e(79041),s=e(24182),r=e(40845),f=e(99755),a=e(2543),c=e(36613),o=e(11261),h=e(83195),g=e(57875),l=e(8066),p=e(24293),m=e(28240),y=e(94624),d=e(52622),v=e(51336),u=e(74863),D=e(16895),P=e(65575);const x=new Set(["bytes","bits","kbytes","mbytes","gbytes","tbytes","pbytes","binBps","binbps","KiBs","Kibits","MiBs","Mibits","GiBs","Gibits","TiBs","Tibits","PiBs","Pibits"]),E=Array(53);for(let A=0;A<E.length;A++)E[A]=2**A;const C=(A,L=1)=>A==null?"-":A.toFixed(L),M={drawStyle:d.GR.Line,showPoints:d.yL.Auto,axisPlacement:d.vM.Auto},S=({frame:A,theme:L,timeZones:U,getTimeRange:W,sync:w,allFrames:N,renderers:B,tweakScale:V=H=>H,tweakAxis:K=H=>H})=>{const H="__global_",X=new v.e(U[0]);let k;X.setPrepData(ie=>(k=ie[0],(0,D.bq)(ie[0],X.getStackingGroups())));const Y=A.fields[0];if(!Y)return X;const Z="x";let se="";const j=Y.config.custom?.axisPlacement!==d.vM.Hidden?d.vM.Bottom:d.vM.Hidden,q=Y.config.custom?.axisPlacement!==d.vM.Hidden;if(Y.type===o.PU.time){X.addScale({scaleKey:Z,orientation:d.Lt.Horizontal,direction:d.ON.Right,isTime:!0,range:()=>{const ae=W();return[ae.from.valueOf(),ae.to.valueOf()]}});const ie=U.length>1?(ae,re)=>re.map((ce,me)=>me<2?null:ce):void 0;for(let ae=0;ae<U.length;ae++){const re=U[ae];X.addAxis({scaleKey:Z,isTime:!0,placement:j,show:q,label:Y.config.custom?.axisLabel,timeZone:re,theme:L,grid:{show:ae===0&&Y.config.custom?.axisGridShow},filter:ie})}U.length>1&&X.addHook("drawAxes",ae=>{ae.ctx.save(),ae.ctx.fillStyle=L.colors.text.primary,ae.ctx.textAlign="left",ae.ctx.textBaseline="bottom";let re=0;ae.axes.forEach(ce=>{if(ce.side===2){let me=ce._pos+ce._size;ae.ctx.fillText(U[re],ae.bbox.left,me*c.A.pxRatio),re++}}),ae.ctx.restore()})}else X.addScale({scaleKey:Z,orientation:d.Lt.Horizontal,direction:d.ON.Right,range:(ie,ae,re)=>[Y.config.min??ae,Y.config.max??re]}),X.addAxis({scaleKey:Z,placement:j,show:q,label:Y.config.custom?.axisLabel,theme:L,grid:{show:Y.config.custom?.axisGridShow},formatValue:(ie,ae)=>(0,h.cN)(Y.display(ie,ae))});let ne=B?.flatMap(ie=>Object.values(ie.fieldMap).filter(ae=>ie.indicesOnly.indexOf(ae)===-1))??[],oe;for(let ie=1;ie<A.fields.length;ie++){const ae=A.fields[ie],re={...ae.config,custom:{...M,...ae.config.custom}},ce=re.custom;if(ae===Y||ae.type!==o.PU.number&&ae.type!==o.PU.enum)continue;let me=ae.display??C;ae.config.custom?.stacking?.mode===d.gs.Percent&&(me=(0,g.J)({field:{...ae,config:{...ae.config,unit:"percentunit"}},theme:L}));const ee=(0,P.My)(re,ae.type),de=(0,l.Qi)(ae),fe=(0,l.lz)(ae,L).color;if(X.addScale(V({scaleKey:ee,orientation:d.Lt.Vertical,direction:d.ON.Up,distribution:ce.scaleDistribution?.type,log:ce.scaleDistribution?.log,linearThreshold:ce.scaleDistribution?.linearThreshold,min:ae.config.min,max:ae.config.max,softMin:ce.axisSoftMin,softMax:ce.axisSoftMax,centeredZero:ce.axisCenteredZero,range:ce.stacking?.mode===d.gs.Percent?(Se,We,Ke)=>(We=We<0?-1:0,Ke=Ke>0?1:0,[We,Ke]):ae.type===o.PU.enum?(Se,We,Ke)=>[-1,ae.config.type.enum.text.length]:void 0,decimals:ae.config.decimals},ae)),se||(se=ee),ce.axisPlacement!==d.vM.Hidden){let Se;ce.axisColorMode===d.Y$.Series&&(de.isByValue&&ae.config.custom?.gradientMode===d.on.Scheme&&de.id===p.Y.Thresholds?Se=(0,u.pl)(1,L,de,ae.config.thresholds):Se=fe);const We={border:{show:ce.axisBorderShow||!1,width:1/devicePixelRatio,stroke:Se||L.colors.text.primary},ticks:{show:ce.axisBorderShow||!1,stroke:Se||L.colors.text.primary},color:Se||L.colors.text.primary};let Ke,Xe,Je;if(x.has(re.unit))Ke=E;else if(ae.type===o.PU.enum){let st=ae.config.type.enum.text;Je=st.map((pt,xt)=>xt),Xe=st}X.addAxis(K({scaleKey:ee,label:ce.axisLabel,size:ce.axisWidth,placement:ce.axisPlacement??d.vM.Auto,formatValue:(st,pt)=>(0,h.cN)(me(st,pt)),theme:L,grid:{show:ce.axisGridShow},decimals:ae.config.decimals,distr:ce.scaleDistribution?.type,splits:Je,values:Xe,incrs:Ke,...We},ae))}const Te=ce.drawStyle===d.GR.Points?d.yL.Always:ce.showPoints;let je=()=>null;ce.spanNulls!==!0&&(je=(Se,We,Ke,Xe)=>{let Je=[],st=Se.series[We];if(!Ke&&Xe&&Xe.length){const[pt,xt]=st.idxs,ot=Se.data[0],$e=Se.data[We],ve=Math.round(Se.valToPos(ot[pt],"x",!0)),be=Math.round(Se.valToPos(ot[xt],"x",!0));Xe[0][0]===ve&&Je.push(pt);for(let he=0;he<Xe.length;he++){let ye=Xe[he],Pe=Xe[he+1];if(Pe&&ye[1]===Pe[0]){let ge=Se.posToIdx(ye[1],!0);if($e[ge]==null)for(let xe=1;xe<100;xe++){if($e[ge+xe]!=null){ge+=xe;break}if($e[ge-xe]!=null){ge-=xe;break}}Je.push(ge)}}Xe[Xe.length-1][1]===be&&Je.push(xt)}return Je.length?Je:null});let{fillOpacity:He}=ce,Be=null,Ne=null;if(ae.state?.origin){oe||(oe=I(A,N));const Se=N[ae.state.origin.frameIndex],We=Se?.fields[ae.state.origin.fieldIndex],Ke=(0,m.Ct)(We??ae,Se,N);if(ne.indexOf(Ke)>=0)Be=()=>null,Ne=()=>{};else if(ce.transform===d.NU.Constant){const Xe=c.A.paths.linear();Be=(Je,st)=>{const pt=Je._data,xt=W();let ot=[xt.from.valueOf(),xt.to.valueOf()],$e=pt[st].find(he=>he!=null),ve=[$e,$e],be=pt.slice();return be[0]=ot,be[st]=ve,Xe({...Je,_data:be},st,0,1)}}if(ce.fillBelowTo){const Xe=A.fields.find(xt=>ce.fillBelowTo===xt.name||ce.fillBelowTo===xt.config?.displayNameFromDS||ce.fillBelowTo===(0,m.Ct)(xt,A,N)),Je=Xe?(0,m.Ct)(Xe,A,N):ce.fillBelowTo,st=oe.get(Ke),pt=oe.get(Je);(0,a.isNumber)(pt)&&(0,a.isNumber)(st)?(X.addBand({series:[st,pt],fill:void 0}),He||(He=35)):He=0}}let Re;de.id===p.Y.Thresholds&&(Re=Se=>(0,l.lz)(k.fields[Se],L).color),X.addSeries({pathBuilder:Be,pointsBuilder:Ne,scaleKey:ee,showPoints:Te,pointsFilter:je,colorMode:de,fillOpacity:He,theme:L,dynamicSeriesColor:Re,drawStyle:ce.drawStyle,lineColor:ce.lineColor??fe,lineWidth:ce.lineWidth,lineInterpolation:ce.lineInterpolation,lineStyle:ce.lineStyle,barAlignment:ce.barAlignment,barWidthFactor:ce.barWidthFactor,barMaxWidth:ce.barMaxWidth,pointSize:ce.pointSize,spanNulls:ce.spanNulls||!1,show:!ce.hideFrom?.viz,gradientMode:ce.gradientMode,thresholds:re.thresholds,hardMin:ae.config.min,hardMax:ae.config.max,softMin:ce.axisSoftMin,softMax:ce.axisSoftMax,dataFrameFieldIndex:ae.state?.origin}),ce.thresholdsStyle&&re.thresholds&&(ce.thresholdsStyle.mode??d.Ly.Off)!==d.Ly.Off&&X.addThresholds({config:ce.thresholdsStyle,thresholds:re.thresholds,scaleKey:ee,theme:L,hardMin:ae.config.min,hardMax:ae.config.max,softMin:ce.axisSoftMin,softMax:ce.axisSoftMax})}let z=(0,D.ro)(A);X.setStackingGroups(z),B?.forEach(ie=>{oe||(oe=I(A,N));let ae={};for(let re in ie.fieldMap){let ce=ie.fieldMap[re];ae[re]=oe.get(ce)}ie.init(X,ae)}),X.scaleKeys=[Z,se];const te=15;let le={dataIdx:(ie,ae,re,ce)=>{let me=ie.data[ae];if(me[re]==null){let ee=null,de=null,De;for(De=re;ee==null&&De-- >0;)me[De]!=null&&(ee=De);for(De=re;de==null&&De++<me.length;)me[De]!=null&&(de=De);let fe=ie.data[0],Te=ie.valToPos(ce,"x"),je=de==null?1/0:ie.valToPos(fe[de],"x"),He=ee==null?-1/0:ie.valToPos(fe[ee],"x"),Be=Te-He,Ne=je-Te;Be<=Ne?Be<=te&&(re=ee):Ne<=te&&(re=de)}return re}};return w&&w()!==y.y.Off&&(le.sync={key:H,scales:[Z,null]}),X.setCursor(le),X};function I(A,L){const U=new Map;return A.fields.forEach((W,w)=>{const N=W.state?.origin;if(N){const B=L[N.frameIndex]?.fields[N.fieldIndex];B&&U.set((0,m.Ct)(B,L[N.frameIndex],L),w)}}),U}const T=["legend","options","theme"];class b extends n.Component{constructor(){super(...arguments),this.prepConfig=(L,U,W)=>{const{sync:w}=this.context,{theme:N,timeZone:B,renderers:V,tweakAxis:K,tweakScale:H}=this.props;return S({frame:L,theme:N,timeZones:Array.isArray(B)?B:[B],getTimeRange:W,sync:w,allFrames:U,renderers:V,tweakScale:H,tweakAxis:K})},this.renderLegend=L=>{const{legend:U,frames:W}=this.props;return!L||U&&!U.showLegend||!(0,s.t)(L,W)?null:(0,t.jsx)(s.$,{data:W,config:L,...U})}}static{this.contextType=i.e4}render(){return(0,t.jsx)(f.o,{...this.props,prepConfig:this.prepConfig,propsToDiff:T,renderLegend:this.renderLegend})}}const R=(0,r.cV)(b);R.displayName="TimeSeries"},90606:(G,O,e)=>{"use strict";e.d(O,{T:()=>D});var t=e(74848),n=e(32196),i=e(96540),s=e(1604),r=e(94624),f=e(57875),a=e(24293),c=e(28240),o=e(83195),h=e(11261),g=e(14588),l=e(52622),p=e(3139),m=e(17464),y=e(69503),d=e(16895),v=e(40845);const u=10,D=({mode:C=l.$N.Single,sortOrder:M=l.xB.None,sync:S,timeZone:I,config:T,renderTooltip:b,...R})=>{const A=(0,i.useRef)(),L=(0,v.$j)(),[U,W]=(0,i.useState)(null),[w,N]=(0,i.useState)(null),[B,V]=(0,i.useState)([]),[K,H]=(0,i.useState)(null),[X,k]=(0,i.useState)(!1),Y=(0,s.A)();let Z=null;const se=(0,v.of)(E);if((0,i.useLayoutEffect)(()=>{let z;const te=()=>{Y()&&(k(!0),A.current?.root.classList.add("plot-active"))},le=()=>{Y()&&(H(null),k(!1),A.current?.root.classList.remove("plot-active"))};return T.addHook("syncRect",(ie,ae)=>z=ae),T.addHook("init",ie=>{A.current=ie,ie.over.addEventListener("mouseenter",te),ie.over.addEventListener("mouseleave",le),Z=ie.root.closest("[tabindex]"),Z&&(Z.addEventListener("focus",te),Z.addEventListener("blur",le)),S&&S()===r.y.Crosshair&&ie.root.classList.add("shared-crosshair")}),T.addHook("setLegend",ie=>{Y()&&(N(ie.legend.idx),V(ie.legend.idxs.slice()))}),T.addHook("setCursor",ie=>{if(!z||!Y())return;const{x:ae,y:re}=x(ie,z);H(ae!==void 0&&re!==void 0?{x:ae,y:re}:null)}),T.addHook("setSeries",(ie,ae)=>{Y()&&W(ae)}),()=>{H(null),A.current&&(A.current.over.removeEventListener("mouseleave",le),A.current.over.removeEventListener("mouseenter",te),Z&&(Z.removeEventListener("focus",te),Z.removeEventListener("blur",le)))}},[T,H,k,N,V]),w===null||!X&&S&&S()===r.y.Crosshair)return null;let j=R.data.fields[0];if(!j)return null;const q=j.display||(0,f.J)({field:j,timeZone:I,theme:L});let ne=null,oe=q(j.values[w]).text;if(b)ne=b(R.data,U,w);else{if(C===l.$N.Single&&U!==null){const z=R.data.fields[U];if(!z)return null;const te=B?.[U]??w;oe=q(j.values[te]).text;const ie=(z.display||(0,f.J)({field:z,timeZone:I,theme:L}))(z.values[te]);ne=(0,t.jsx)(p.o,{series:[{color:ie.color||a.F,label:(0,c.Ct)(z,R.data,R.frames),value:ie?(0,o.cN)(ie):null}],timestamp:oe})}if(C===l.$N.Multi){let z=[];const te=R.data,le=te.fields,ie=[];for(let ae=0;ae<le.length;ae++){const re=te.fields[ae];if(!re||re===j||re.type===h.PU.time||re.type!==h.PU.number||re.config.custom?.hideFrom?.tooltip||re.config.custom?.hideFrom?.viz)continue;const ce=R.data.fields[ae].values[B[ae]],me=re.display(ce);ie.push(ce),z.push({color:me.color||a.F,label:(0,c.Ct)(re,te,R.frames),value:me?(0,o.cN)(me):null,isActive:U===ae})}if(M!==l.xB.None){const ae=[...z],re=g.sortValues(M);z.sort((ce,me)=>{const ee=ae.indexOf(ce),de=ae.indexOf(me);return re(ie[ee],ie[de])})}ne=(0,t.jsx)(p.o,{series:z,timestamp:oe})}}return(0,t.jsx)(m.ZL,{className:X?se.tooltipWrapper:void 0,children:ne&&K&&(0,t.jsx)(y.o,{position:{x:K.x,y:K.y},offset:{x:u,y:u},children:ne})})};function P({left:C,top:M},S){return C===void 0||M===void 0?!1:C<0||C>S.width||M<0||M>S.height}function x(C,M){let S,I;const T=C.cursor.left||0,b=C.cursor.top||0;if(P(C.cursor,M)){const R=C.posToIdx(T);if(b<0||b>M.height){let A=(0,d.sw)(C,R);A&&(I=M.top+A,T>=0&&T<=M.width&&(S=M.left+C.valToPos(C.data[0][C.posToIdx(T)],C.series[0].scale)))}}else S=M.left+T,I=M.top+b;return{x:S,y:I}}const E=C=>({tooltipWrapper:(0,n.css)({"z-index":C.zIndex.portal+1+" !important"})})},76284:(G,O,e)=>{"use strict";e.d(O,{j:()=>s});var t=e(96540);const n=5,i=r=>r!=null&&!r.ctrlKey&&!r.metaKey,s=({onZoom:r,config:f,withZoomY:a=!1})=>((0,t.useLayoutEffect)(()=>{let c=!1,o=!1;a&&f.addHook("init",h=>{h.over.addEventListener("mousedown",g=>{if(i(g)&&g.button===0&&g.shiftKey){o=!0,h.cursor.drag.x=!1,h.cursor.drag.y=!0;let l=p=>{h.cursor.drag.x=!0,h.cursor.drag.y=!1,document.removeEventListener("mouseup",l,!0)};document.addEventListener("mouseup",l,!0)}},!0)}),f.addHook("setSelect",h=>{const g=h.scales.x.ori===0;if(i(h.cursor.event)){if(a&&o){if(h.select.height>=n){for(let l in h.scales)if(l!=="x"){const p=g?h.posToVal(h.select.top,l):h.posToVal(h.select.left+h.select.width,l),m=g?h.posToVal(h.select.top+h.select.height,l):h.posToVal(h.select.left,l);h.setScale(l,{min:m,max:p})}c=!0}o=!1}else if(h.select.width>=n){const l=g?h.posToVal(h.select.left,"x"):h.posToVal(h.select.top+h.select.height,"x"),p=g?h.posToVal(h.select.left+h.select.width,"x"):h.posToVal(h.select.top,"x");r({from:l,to:p}),c=!1}}h.setSelect({left:0,width:0,top:0,height:0},!1)}),f.setCursor({bind:{dblclick:h=>()=>{if(!i(h.cursor.event))return null;if(a&&c){for(let g in h.scales)g!=="x"&&h.setScale(g,{min:null,max:null});c=!1}else{let g=h.scales.x;const l=g.min,p=g.max,m=(p-l)/2;r({from:l-m,to:p+m})}return null}}})},[f,r,a]),null)},8984:(G,O,e)=>{"use strict";e.r(O),e.d(O,{ALERTING_COLOR:()=>s.xj,AxisPlacement:()=>c.vM,BarAlignment:()=>c.Nj,BarValueVisibility:()=>c.TC,BracesPlugin:()=>a.e1,ClearPlugin:()=>a.vJ,ClipboardPlugin:()=>a.sW,DEFAULT_ANNOTATION_COLOR:()=>s.Mk,DOMUtil:()=>s.bk,DrawStyle:()=>c.yg,EventsWithValidation:()=>s.Pw,GlobalStyles:()=>r.kH,GraphGradientMode:()=>c.on,GraphThresholdsStyleMode:()=>c.Ly,IndentationPlugin:()=>a.TA,LegendDisplayMode:()=>c.lm,LineInterpolation:()=>c.dx,NO_DATA_COLOR:()=>s.nO,NewlinePlugin:()=>a.Om,NodeGraphDataFrameFieldNames:()=>s.uc,OK_COLOR:()=>s.Xw,PENDING_COLOR:()=>s.ct,PointVisibility:()=>c.nT,REGION_FILL_ALPHA:()=>s.UJ,ReactUtils:()=>s.zt,RunnerPlugin:()=>a.Ul,SCHEMA:()=>s.yx,ScaleDirection:()=>c.ON,ScaleOrientation:()=>c.Lt,SearchFunctionType:()=>s.Tt,SelectionShortcutsPlugin:()=>a.l9,SlatePrism:()=>a.De,StackingMode:()=>c.gs,SuggestionsPlugin:()=>a.Pz,TableCellDisplayMode:()=>c.ob,ThemeContext:()=>r.Dx,TooltipDisplayMode:()=>c.$N,ansicolor:()=>s.DB,attachDebugger:()=>s.hF,calculateFontSize:()=>s.Vr,colors:()=>s.Tj,commonOptionsBuilder:()=>f.j,createLogger:()=>s.h,fuzzyMatch:()=>s.It,getCanvasContext:()=>s.Yc,getCellLinks:()=>s.kl,getScrollbarWidth:()=>s.XJ,getTagColor:()=>s.yC,getTagColorIndexFromName:()=>s.JF,getTagColorsFromName:()=>s.MC,getTextColorForAlphaBackground:()=>s.mZ,getTextColorForBackground:()=>s.sg,getTheme:()=>r.O4,hasValidationEvent:()=>s.K,isCompactUrl:()=>s.Fr,linkModelToContextMenuItems:()=>s.Jl,makeFragment:()=>s.dF,makeValue:()=>s.mO,measureText:()=>s.kD,mockTheme:()=>r.mG,mockThemeContext:()=>r.fq,regexValidation:()=>s.RP,sortedColors:()=>s.Ih,styleMixins:()=>r.YF,stylesFactory:()=>r.N3,useForceUpdate:()=>s.CH,useStyles:()=>r.IS,useStyles2:()=>r.of,useTheme:()=>r.DP,useTheme2:()=>r.$j,validate:()=>s.tf,withTheme:()=>r.SL,withTheme2:()=>r.cV});var t=e(94333),i={};for(const o in t)o!=="default"&&(i[o]=()=>t[o]);e.d(O,i);var n=e(80186),i={};for(const o in n)["default","Icon","IconButton","ConfirmButton","DeleteButton","Tooltip","PopoverController","Popover","Toggletip","Portal","getPortalContainer","PortalContainer","CustomScrollbar","TabbedContainer","ClipboardButton","Cascader","ButtonCascader","InlineToast","LoadingPlaceholder","LoadingBar","ColorPicker","SeriesColorPicker","ColorPickerInput","SeriesColorPickerPopover","SeriesColorPickerPopoverWithTheme","EmptySearchResult","EmptyState","UnitPicker","StatsPicker","RefreshPicker","defaultIntervals","TimeRangePicker","TimePickerTooltip","TimeRangeLabel","TimeOfDayPicker","TimeZonePicker","WeekStartPicker","getWeekStart","DatePicker","DatePickerWithInput","DateTimePicker","List","InteractiveTable","TagsInput","AutoSaveField","Pagination","Tag","TagList","FilterPill","ConfirmModal","QueryField","CodeEditor","ReactMonacoEditor","CodeEditorSuggestionItemKind","variableSuggestionToCodeEditorSuggestion","Modal","ModalHeader","ModalTabsHeader","ModalTabContent","ModalsProvider","ModalRoot","ModalsController","ModalsContext","PageToolbar","SetInterval","Table","TableInputCSV","TabsBar","Tab","VerticalTab","TabContent","Counter","RenderUserContentAsHTML","BigValue","BigValueColorMode","BigValueGraphMode","BigValueJustifyMode","BigValueTextMode","Sparkline","Gauge","BarGauge","VizTooltip","VizTooltipContainer","SeriesTable","SeriesTableRow","VizRepeater","PanelChrome","PanelChromeLoadingIndicator","PanelContextProvider","PanelContextRoot","usePanelContext","VizLayout","SeriesVisibilityChangeBehavior","VizLegend","VizLegendListItem","Alert","GraphSeriesToggler","Collapse","ControlledCollapse","CollapsableSection","DataLinkButton","FieldLinkList","FullWidthButtonContainer","ClickOutsideWrapper","CallToActionCard","ContextMenu","Menu","MenuGroup","MenuItem","WithContextMenu","DataLinksInlineEditor","DataLinkInput","DataLinksContextMenu","SeriesIcon","InfoBox","FeatureInfoBox","FeatureBadge","JSONFormatter","JsonExplorer","ErrorBoundary","ErrorBoundaryAlert","withErrorBoundary","ErrorWithStack","DataSourceHttpSettings","CustomHeadersSettings","AlertingSettings","SecureSocksProxySettings","TLSAuthSettings","CertificationKey","Spinner","FadeTransition","SlideOutTransition","Segment","SegmentAsync","SegmentInput","SegmentSelect","SegmentSection","Drawer","Slider","RangeSlider","Form","sharedInputStyle","InputControl","Button","LinkButton","ButtonGroup","clearButtonStyles","ToolbarButton","ToolbarButtonRow","ValuePicker","fieldMatchersUI","Link","TextLink","Text","Box","Stack","Grid","Space","Label","Field","Legend","FieldSet","FieldValidationMessage","InlineField","InlineSegmentGroup","InlineLabel","InlineFieldRow","FieldArray","resetSelectStyles","SelectMenuOptions","getSelectStyles","HorizontalGroup","VerticalGroup","Container","Badge","RadioButtonGroup","RadioButtonDot","RadioButtonList","Input","getInputStyles","AutoSizeInput","FilterInput","Switch","InlineSwitch","Checkbox","TextArea","FileUpload","TimeRangeInput","RelativeTimeRangePicker","Card","getCardStyles","CardContainer","FormattedValueDisplay","ButtonSelect","Dropdown","PluginSignatureBadge","UserIcon","Avatar","InlineFormLabel","Divider","getDragStyles","useSplitter","LegacyForms","LegacyInputStatus","ScaleDistribution","BarGaugeDisplayMode","UPlotConfigBuilder","UPLOT_AXIS_FONT_SIZE","UPlotChart","PlotLegend","FIXED_UNIT","BrowserLabel","PanelContainer","Graph","GraphWithLegend","GraphContextMenu","GraphContextMenuHeader","graphTimeFormat","graphTickFormatter","GraphNG","TimeSeries","useGraphNGContext","preparePlotFrame","buildScaleKey","ZoomPlugin","TooltipPlugin","convertOldAngularValueMapping","sharedSingleStatMigrationHandler","sharedSingleStatPanelChangedHandler","AsyncMultiSelect","AsyncSelect","AsyncVirtualizedSelect","MultiSelect","Select","SelectContainer","VirtualizedSelect","SecretInput","SecretTextArea","FileDropzone","FileDropzoneDefaultChildren","FileListItem","graphFieldOptions","EventsCanvas","Marker","XYCanvas","EventBusPlugin","KeyboardPlugin","TooltipPlugin2","SeriesVisibilityChangeMode"].indexOf(o)<0&&(i[o]=()=>n[o]);e.d(O,i);var s=e(67985),r=e(7918),f=e(42482),a=e(50955),c=e(49149)},38248:(G,O,e)=>{"use strict";e.d(O,{W:()=>p,r:()=>h});var t=e(74848),n=e(11261),i=e(27310),s=e(52622),r=e(88575),f=e(94354),a=e(10354),c=e(90182),o=e(52198);function h(m,y,d){const v=["Axis"];m.addRadio({path:"axisPlacement",name:"Placement",category:v,defaultValue:o.t.axisPlacement[0].value,settings:{options:o.t.axisPlacement}}).addTextInput({path:"axisLabel",name:"Label",category:v,defaultValue:"",settings:{placeholder:"Optional text",expandTemplateVars:!0},showIf:u=>u.axisPlacement!==s.vM.Hidden,shouldApply:u=>u.type!==n.PU.time&&u.type!==n.PU.string}).addNumberInput({path:"axisWidth",name:"Width",category:v,settings:{placeholder:"Auto"},showIf:u=>u.axisPlacement!==s.vM.Hidden}).addRadio({path:"axisGridShow",name:"Show grid lines",category:v,defaultValue:void 0,settings:{options:[{value:void 0,label:"Auto"},{value:!0,label:"On"},{value:!1,label:"Off"}]},showIf:u=>u.axisPlacement!==s.vM.Hidden}).addRadio({path:"axisColorMode",name:"Color",category:v,defaultValue:s.Y$.Text,settings:{options:[{value:s.Y$.Text,label:"Text"},{value:s.Y$.Series,label:"Series"}]},showIf:u=>u.axisPlacement!==s.vM.Hidden}).addBooleanSwitch({path:"axisBorderShow",name:"Show border",category:v,defaultValue:!1,showIf:u=>u.axisPlacement!==s.vM.Hidden}),m.addCustomEditor({id:"scaleDistribution",path:"scaleDistribution",name:"Scale",category:v,editor:p,override:p,defaultValue:{type:s.L4.Linear},shouldApply:u=>u.type===n.PU.number,process:i.hS}).addBooleanSwitch({path:"axisCenteredZero",name:"Centered zero",category:v,defaultValue:!1,showIf:u=>u.scaleDistribution?.type!==s.L4.Log}).addNumberInput({path:"axisSoftMin",name:"Soft min",defaultValue:y.axisSoftMin,category:v,settings:{placeholder:"See: Standard options > Min"}}).addNumberInput({path:"axisSoftMax",name:"Soft max",defaultValue:y.axisSoftMax,category:v,settings:{placeholder:"See: Standard options > Max"}})}const g=[{label:"Linear",value:s.L4.Linear},{label:"Logarithmic",value:s.L4.Log},{label:"Symlog",value:s.L4.Symlog}],l=[{label:"2",value:2},{label:"10",value:10}],p=({value:m,onChange:y})=>{const d=m?.type??s.L4.Linear,v=m?.log??2;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{marginBottom:16},children:(0,t.jsx)(f.z,{value:d,options:g,onChange:u=>{y({...m,type:u,log:u===s.L4.Linear?void 0:v})}})}),(d===s.L4.Log||d===s.L4.Symlog)&&(0,t.jsx)(r.D,{label:"Log base",children:(0,t.jsx)(c.l6,{options:l,value:v,onChange:u=>{y({...m,log:u.value})}})}),d===s.L4.Symlog&&(0,t.jsx)(r.D,{label:"Linear threshold",children:(0,t.jsx)(a.p,{placeholder:"1",value:m?.linearThreshold,onChange:u=>{y({...m,linearThreshold:Number(u.currentTarget.value)})}})})]})}},11404:(G,O,e)=>{"use strict";e.d(O,{e:()=>c});var t=e(74848),n=e(2543),i=e.n(n),s=e(96540),r=e(92174),f=e(67061);const a=({value:o,onChange:h})=>{const g=(0,s.useCallback)(l=>{h({...o,[l]:!o[l]})},[o,h]);return(0,t.jsx)(f.B,{gap:.5,children:Object.keys(o).map(l=>{const p=l;return(0,t.jsx)(r.m,{icon:o[p]?"eye-slash":"eye",onClick:()=>g(p),label:(0,n.startCase)(p),selected:o[p]},p)})})};function c(o){o.addCustomEditor({id:"hideFrom",name:"Hide in area",category:["Series"],path:"hideFrom",defaultValue:{tooltip:!1,viz:!1,legend:!1},editor:a,override:a,shouldApply:()=>!0,hideFromDefaults:!0,process:h=>h})}},22680:(G,O,e)=>{"use strict";e.d(O,{H:()=>i});var t=e(69550),n=e(52622);function i(s,r=!0){s.addBooleanSwitch({path:"legend.showLegend",name:"Visibility",category:["Legend"],description:"",defaultValue:!0}).addRadio({path:"legend.displayMode",name:"Mode",category:["Legend"],description:"",defaultValue:n.lm.List,settings:{options:[{value:n.lm.List,label:"List"},{value:n.lm.Table,label:"Table"}]},showIf:f=>f.legend.showLegend}).addRadio({path:"legend.placement",name:"Placement",category:["Legend"],description:"",defaultValue:"bottom",settings:{options:[{value:"bottom",label:"Bottom"},{value:"right",label:"Right"}]},showIf:f=>f.legend.showLegend}).addNumberInput({path:"legend.width",name:"Width",category:["Legend"],settings:{placeholder:"Auto"},showIf:f=>f.legend.showLegend&&f.legend.placement==="right"}),r&&s.addCustomEditor({id:"legend.calcs",path:"legend.calcs",name:"Values",category:["Legend"],description:"Select values or calculations to show in legend",editor:t.D.get("stats-picker").editor,defaultValue:[],settings:{allowMultiple:!0},showIf:f=>f.legend.showLegend!==!1})}},56675:(G,O,e)=>{"use strict";e.d(O,{I:()=>g,m:()=>h});var t=e(74848),n=e(27310),i=e(11261),s=e(52622),r=e(94354),f=e(29158),a=e(10354),c=e(67061),o=e(52198);const h=({value:l,context:p,onChange:m,item:y})=>(0,t.jsxs)(c.B,{children:[(0,t.jsx)(r.z,{value:l?.mode||s.gs.None,options:y.settings?.options??[],onChange:d=>{m({...l,mode:d})}}),p.isOverride&&l?.mode&&l?.mode!==s.gs.None&&(0,t.jsx)(a.p,{type:"text",placeholder:"Group",suffix:(0,t.jsx)(f.K,{name:"question-circle",tooltip:"Name of the stacking group",tooltipPlacement:"top"}),defaultValue:l?.group,onChange:d=>{m({...l,group:d.currentTarget.value.trim()})}})]});function g(l,p,m=["Graph styles"]){l.addCustomEditor({id:"stacking",path:"stacking",name:"Stack series",category:m,defaultValue:p,editor:h,override:h,settings:{options:o.t.stacking},process:n.hS,shouldApply:y=>y.type===i.PU.number})}},71242:(G,O,e)=>{"use strict";e.d(O,{I:()=>t});function t(n,i=!0){i&&n.addNumberInput({path:"text.titleSize",category:["Text size"],name:"Title",settings:{placeholder:"Auto",integer:!1,min:1,max:200},defaultValue:void 0}),n.addNumberInput({path:"text.valueSize",category:["Text size"],name:"Value",settings:{placeholder:"Auto",integer:!1,min:1,max:200},defaultValue:void 0})}},89654:(G,O,e)=>{"use strict";e.d(O,{D:()=>n});var t=e(52622);function n(i,s=!1,r=!1,f){const a=["Tooltip"],c=s?[{value:t.$N.Single,label:"Single"},{value:t.$N.None,label:"Hidden"}]:[{value:t.$N.Single,label:"Single"},{value:t.$N.Multi,label:"All"},{value:t.$N.None,label:"Hidden"}],o=[{value:t.xB.None,label:"None"},{value:t.xB.Ascending,label:"Ascending"},{value:t.xB.Descending,label:"Descending"}];i.addRadio({path:"tooltip.mode",name:"Tooltip mode",category:a,defaultValue:f?.tooltip?.mode??t.$N.Single,settings:{options:c}}).addRadio({path:"tooltip.sort",name:"Values sort order",category:a,defaultValue:f?.tooltip?.sort??t.xB.None,showIf:h=>h.tooltip?.mode===t.$N.Multi,settings:{options:o}}),r&&i.addNumberInput({path:"tooltip.hoverProximity",name:"Hover proximity",description:"How close the cursor must be to a point to trigger the tooltip, in pixels",category:a,settings:{integer:!0},showIf:h=>h.tooltip?.mode!==t.$N.None}),i.addNumberInput({path:"tooltip.maxWidth",name:"Max width",category:a,settings:{integer:!0},showIf:h=>h.tooltip?.mode!==t.$N.None}).addNumberInput({path:"tooltip.maxHeight",name:"Max height",category:a,defaultValue:void 0,settings:{integer:!0},showIf:h=>h.tooltip?.mode===t.$N.Multi})}},42482:(G,O,e)=>{"use strict";e.d(O,{j:()=>t});var t={};e.r(t),e.d(t,{ScaleDistributionEditor:()=>n.W,StackingEditor:()=>a.m,addAxisConfig:()=>n.r,addHideFrom:()=>i.e,addLegendOptions:()=>s.H,addStackingConfig:()=>a.I,addTextSizeOptions:()=>f.I,addTooltipOptions:()=>r.D});var n=e(38248),i=e(11404),s=e(22680),r=e(89654),f=e(71242),a=e(56675)},49149:(G,O,e)=>{"use strict";e.d(O,{$N:()=>t.$N,Lt:()=>t.Lt,Ly:()=>t.Ly,Nj:()=>t.Nj,ON:()=>t.ON,TC:()=>t.yL,dx:()=>t.dx,gs:()=>t.gs,lm:()=>t.lm,nT:()=>t.yL,ob:()=>t.ob,on:()=>t.on,vM:()=>t.vM,yg:()=>t.GR});var t=e(52622)},74738:(G,O,e)=>{"use strict";e.d(O,{v:()=>t});function t(){return{onKeyDown(n,i,s){const r=i.value;if(r.selection.isExpanded)return s();if(n.key==="k"&&n.ctrlKey){n.preventDefault();const f=r.anchorText.text,a=r.selection.anchor.offset,o=f.length-a;return i.deleteForward(o),!0}return s()}}}},99453:(G,O,e)=>{"use strict";e.d(O,{s:()=>i});const t=(s,r,f)=>{if(!s.length)return;const a=s.slice(0,-1).join("").length+s.length-1;return s.join(`
`).slice(r,a+f)},n=s=>s?.replace(/[\uFEFF]/g,"");function i(){const s={onCopy(r,f,a){r.preventDefault();const{document:c,selection:o}=f.value,{start:{offset:h},end:{offset:g}}=o,l=c.getLeafBlocksAtRange(o).toArray().map(m=>m.text),p=n(t(l,h,g));return p&&r.clipboardData&&r.clipboardData.setData("Text",p),!0},onPaste(r,f,a){if(r.preventDefault(),r.clipboardData){const o=n(r.clipboardData.getData("Text"))?.split(`
`);if(o&&o.length){f.insertText(o[0]);for(const h of o.slice(1))f.splitBlock().insertText(h)}}return!0}};return{...s,onCut(r,f,a){return s.onCopy(r,f,a),f.deleteAtRange(f.value.selection),!0}}}},1020:(G,O,e)=>{"use strict";e.d(O,{T:()=>h});var t=e(57746),n=e(82611),i=e(52845);const s=(0,t.Sn)("mod+["),r=(0,t.Sn)("shift+tab"),f=(0,t.Sn)("mod+]"),a="  ",c=(g,l,p)=>{const{startBlock:m,endBlock:y,selection:{start:{offset:d,key:v},end:{offset:u,key:D}}}=l.value;if(i.A.serialize(l.value)==="")return;g.preventDefault();const P=m.getFirstText();P&&d===0&&v===P.key&&u===P.text.length&&D===P.key||!m.equals(y)?o(l,"right"):l.insertText(a)},o=(g,l)=>{const p=g.value.selection,m=g.value.document.getLeafBlocksAtRange(p).toArray();if(l==="left")for(const y of m){const d=y.text.length-y.text.trimLeft().length,v=y.getFirstText().key,u={anchor:{key:v,offset:d,path:[]},focus:{key:v,offset:d,path:[]}};g.deleteBackwardAtRange(n.Q6.create(u),Math.min(a.length,d))}else{const{startText:y}=g.value,d=y.text.slice(0,p.start.offset),v=/^\s*$/.test(d);for(const u of m)g.insertTextByKey(u.getFirstText().key,0,a);v&&g.moveStartBackward(a.length)}};function h(){return{onKeyDown(g,l,p){if(s(g)||r(g))g.preventDefault(),o(l,"left");else if(f(g))g.preventDefault(),o(l,"right");else if(g.key==="Tab")c(g,l,p);else return p();return!0}}}},50955:(G,O,e)=>{"use strict";e.d(O,{e1:()=>s,vJ:()=>r.v,sW:()=>f.s,TA:()=>a.T,Om:()=>c.O,Ul:()=>o.U,l9:()=>h.l,De:()=>g.D,Pz:()=>l.Pz});var t=e(62938);const n={"[":"]","{":"}","(":")"},i="brace_match";function s(){return{onKeyDown(p,m,y){const{value:d}=m;switch(p.key){case"(":case"{":case"[":{const{start:{offset:v,key:u},end:{offset:D,key:P},focus:{offset:x}}=d.selection,E=d.focusText.text;if(d.selection.isExpanded)return p.preventDefault(),m.insertTextByKey(u,v,p.key).insertTextByKey(P,D+1,n[p.key]).moveEndBackward(1),!0;if(x===E.length||E[x]===" "||Object.values(n).includes(E[x])){p.preventDefault();const C=n[p.key],M={key:`${i}-${(0,t.A)()}`,type:`${i}-${C}`,anchor:{key:u,offset:v,object:"point"},focus:{key:P,offset:D+1,object:"point"},object:"annotation"};return m.insertText(p.key).insertText(C).addAnnotation(M).moveBackward(1),!0}break}case")":case"}":case"]":{const v=d.anchorText.text,u=d.selection.anchor.offset,D=v[u],P=p.key,x=`${i}-${P}`,E=d.annotations.find(C=>C?.type===x&&C.anchor.key===d.anchorText.key);if(E&&D===P&&!d.selection.isExpanded)return p.preventDefault(),m.moveFocusForward(1).removeAnnotation(E).moveAnchorForward(1),!0;break}case"Backspace":{const v=d.anchorText.text,u=d.selection.anchor.offset,D=v[u-1],P=v[u];if(n[D]&&n[D]===P)return p.preventDefault(),m.deleteBackward(1).deleteForward(1).focus(),!0}default:break}return y()}}}var r=e(74738),f=e(99453),a=e(1020),c=e(88295),o=e(4269),h=e(31589),g=e(41781),l=e(80903)},88295:(G,O,e)=>{"use strict";e.d(O,{O:()=>n});function t(i){let s=i.length-i.trimLeft().length;if(s){let r=i[0];for(;--s;)r+=i[0];return r}return""}function n(){return{onKeyDown(i,s,r){const f=s.value;if(f.selection.isExpanded)return r();if(i.key==="Enter"){i.preventDefault();const{startBlock:a}=f,c=a.text,o=t(c);return s.splitBlock().insertText(o).focus()}return r()}}}},4269:(G,O,e)=>{"use strict";e.d(O,{U:()=>t});function t({handler:n}){return{onKeyDown(i,s,r){return n&&i.key==="Enter"&&(i.shiftKey||i.ctrlKey)?(i.preventDefault(),n(i),s):r()}}}},31589:(G,O,e)=>{"use strict";e.d(O,{l:()=>i});var t=e(57746);const n=(0,t.Sn)("mod+l");function i(){return{onKeyDown(s,r,f){if(n(s)){s.preventDefault();const{focusBlock:a,document:c}=r.value;r.moveAnchorToStartOfBlock(),c.getNextBlock(a.key)?r.moveFocusToStartOfNextBlock():r.moveFocusToEndOfText()}else return f();return!0}}}},84694:(G,O,e)=>{"use strict";e.d(O,{A:()=>n});const n="prism-token"},41781:(G,O,e)=>{"use strict";e.d(O,{D:()=>l,R:()=>d});var t=e(28848),n=e.n(t),i=e(82611),s=e(84694),r=e(74848),f=e(49568);function a(v){return v.object==="block"&&v.type==="code_block"}function c(v){return"javascript"}function o(v,u,D){const{decoration:P}=v;if(P.type!==s.A)return D();const x=P.data.get("className");return(0,r.jsx)("span",{className:x,children:v.children})}class h extends(0,f.Record)({onlyIn:a,getSyntax:c,renderDecoration:o}){constructor(u){super(u)}}const g=h;function l(v={},u=n().languages){const D=new g(v);return{decorateNode:(P,x,E)=>{if(!D.onlyIn(P))return E();const C=i.eB.create(P),M=D.getSyntax(C),S=u[M];if(!S)return[];const T=C.getTexts().map(L=>L&&L.getText()).join(`
`),b=n().tokenize(T,S),R=d(b),A=x.value.data.set("tokens",R);return x.setData(A),p(D,b,C)},renderDecoration:(P,x,E)=>D.renderDecoration({children:P.children,decoration:P.decoration},x,E)}}function p(v,u,D){const P=D.getTexts(),x=[];let E=0,C=0;return P.forEach(M=>{C=E+M.getText().length;let S=0;function I(T,b){if(typeof T=="string"){if(b){const R=m({text:M,textStart:E,textEnd:C,start:S,end:S+T.length,className:`prism-token token ${b}`,block:D});R&&x.push(R)}S+=T.length}else if(b=`${b} ${T.type}`,T.alias&&(b+=" "+T.alias),typeof T.content=="string"){const R=m({text:M,textStart:E,textEnd:C,start:S,end:S+T.content.length,className:`prism-token token ${b}`,block:D});R&&x.push(R),S+=T.content.length}else for(let R=0;R<T.content.length;R+=1)I(T.content[R],b)}u.forEach(I),E=C+1}),x}function m({text:v,textStart:u,textEnd:D,start:P,end:x,className:E,block:C}){return P>=D||x<=u?null:(P=Math.max(P,u),x=Math.min(x,D),P-=u,x-=u,C.createDecoration({object:"decoration",anchor:{key:v.key,offset:P,object:"point"},focus:{key:v.key,offset:x,object:"point"},type:s.A,data:{className:E}}))}function y(v){return typeof v=="string"?[{content:v,types:[],aliases:[]}]:Array.isArray(v)?v.flatMap(u=>y(u)):v instanceof n().Token?y(v.content).flatMap(u=>{let D=[];return typeof v.alias=="string"?D=[v.alias]:D=v.alias??[],{content:u.content,types:[v.type,...u.types],aliases:[...D,...u.aliases]}}):[]}function d(v){const u=y(v);if(!u.length)return[];const D=u[0];D.prev=null,D.next=u.length>=2?u[1]:null,D.offsets={start:0,end:D.content.length};for(let x=1;x<u.length-1;x++)u[x].prev=u[x-1],u[x].next=u[x+1],u[x].offsets={start:u[x-1].offsets.end,end:u[x-1].offsets.end+u[x].content.length};const P=u[u.length-1];return P.prev=u.length>=2?u[u.length-2]:null,P.next=null,P.offsets={start:u.length>=2?u[u.length-2].offsets.end:0,end:u.length>=2?u[u.length-2].offsets.end+P.content.length:P.content.length},u}},80903:(G,O,e)=>{"use strict";e.d(O,{Pz:()=>W});var t=e(74848),n=e(2543),i=e(32196),s=e(96540),r=e(40961),f=e(91793),a=e(60578),c=e(50774),o=e(49579);const h=B=>B.reduce((V,{items:K,label:H})=>(V.push({label:H,kind:c.I.GroupTitle}),K.reduce((X,k)=>(X.push(k),X),V)),[]),g=B=>B.reduce((V,K)=>V.length<K.label.length?K.label:V,""),l=(B,V,K)=>{const H=(0,o.A)(K,{font:B.typography.fontFamilyMonospace,fontSize:B.typography.bodySmall.fontSize,fontWeight:"normal"}),X=m(H.width,B),k=p(H.height,B),Y=y(k,V);return{listWidth:X,listHeight:Y,itemHeight:k}},p=(B,V)=>{const K=V.spacing.gridSize*2;return B+K},m=(B,V)=>{const K=V.spacing.gridSize*3;return Math.min(Math.max(B+K,200),800)},y=(B,V)=>{const K=Math.min(V.length,10),H=100,X=K*B;return Math.max(X,H)};var d=e(36663),v=e(40845);const u=(B,V,K)=>({typeaheadItem:(0,i.css)({label:"type-ahead-item",zIndex:11,padding:B.spacing(1,1,1,2),border:B.colors.border.medium,overflowY:"scroll",overflowX:"hidden",outline:"none",background:B.colors.background.secondary,color:B.colors.text.secondary,boxShadow:`0 0 20px ${B.v1.colors.dropdownShadow}`,visibility:K===!0?"visible":"hidden",width:"250px",minHeight:`${V+parseInt(B.spacing(.25),10)}px`,position:"relative",wordBreak:"break-word"})}),D=({item:B,height:V})=>{const K=B&&!!B.documentation,H=B?B.label:"",X=(0,d.G)(B?.documentation),k=(0,v.$j)(),Y=u(k,V,K);return(0,t.jsxs)("div",{className:(0,i.cx)([Y.typeaheadItem]),children:[(0,t.jsx)("b",{children:H}),(0,t.jsx)("hr",{}),(0,t.jsx)("div",{dangerouslySetInnerHTML:{__html:X}})]})};var P=e(23257),x=e.n(P),E=e(5313);const C=B=>({typeaheadItem:(0,i.css)({border:"none",background:"none",textAlign:"left",label:"type-ahead-item",height:"auto",fontFamily:B.typography.fontFamilyMonospace,padding:B.spacing(1,1,1,2),fontSize:B.typography.bodySmall.fontSize,textOverflow:"ellipsis",overflow:"hidden",zIndex:11,display:"block",whiteSpace:"nowrap",cursor:"pointer",[B.transitions.handleMotion("no-preference","reduce")]:{transition:"color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), border-color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), background 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), padding 0.15s cubic-bezier(0.645, 0.045, 0.355, 1)"}}),typeaheadItemSelected:(0,i.css)({label:"type-ahead-item-selected",backgroundColor:B.colors.background.secondary}),typeaheadItemMatch:(0,i.css)({label:"type-ahead-item-match",color:B.v1.palette.yellow,borderBottom:`1px solid ${B.v1.palette.yellow}`,padding:"inherit",background:"inherit"}),typeaheadItemGroupTitle:(0,i.css)({label:"type-ahead-item-group-title",color:B.colors.text.secondary,fontSize:B.typography.bodySmall.fontSize,lineHeight:B.typography.body.lineHeight,padding:B.spacing(1)})}),M=B=>{const V=(0,v.of)(C),{isSelected:K,item:H,prefix:X,style:k,onMouseEnter:Y,onMouseLeave:Z,onClickItem:se}=B,j=K?(0,i.cx)([V.typeaheadItem,V.typeaheadItemSelected]):(0,i.cx)([V.typeaheadItem]),q=(0,i.cx)([V.typeaheadItemMatch]),ne=(0,i.cx)([V.typeaheadItemGroupTitle]),oe=H.label||"";return H.kind===c.I.GroupTitle?(0,t.jsx)("li",{className:ne,style:k,children:(0,t.jsx)("span",{children:oe})}):(0,t.jsx)("li",{role:"none",children:(0,t.jsx)("button",{role:"menuitem",className:j,style:k,onMouseDown:se,onMouseEnter:Y,onMouseLeave:Z,type:"button",children:H.highlightParts!==void 0?(0,t.jsx)(E.z,{text:oe,highlightClassName:q,highlightParts:H.highlightParts}):(0,t.jsx)(x(),{textToHighlight:oe,searchWords:[X??""],autoEscape:!0,highlightClassName:q})})})},S=(B,V)=>B-V*Math.floor(B/V);class I extends s.PureComponent{constructor(){super(...arguments),this.listRef=(0,s.createRef)(),this.state={hoveredItem:null,typeaheadIndex:null,allItems:[],listWidth:-1,listHeight:-1,itemHeight:-1},this.componentDidMount=()=>{this.props.menuRef&&this.props.menuRef(this),document.addEventListener("selectionchange",this.handleSelectionChange);const V=h(this.props.groupedItems),K=g(V),{listWidth:H,listHeight:X,itemHeight:k}=l(this.context,V,K);this.setState({listWidth:H,listHeight:X,itemHeight:k,allItems:V})},this.componentWillUnmount=()=>{document.removeEventListener("selectionchange",this.handleSelectionChange)},this.handleSelectionChange=()=>{this.forceUpdate()},this.componentDidUpdate=(V,K)=>{if(this.state.typeaheadIndex!==null&&K.typeaheadIndex!==this.state.typeaheadIndex&&this.listRef&&this.listRef.current){if(this.state.typeaheadIndex===1){this.listRef.current.scrollToItem(0);return}this.listRef.current.scrollToItem(this.state.typeaheadIndex)}if((0,n.isEqual)(V.groupedItems,this.props.groupedItems)===!1){const H=h(this.props.groupedItems),X=g(H),{listWidth:k,listHeight:Y,itemHeight:Z}=l(this.context,H,X);this.setState({listWidth:k,listHeight:Y,itemHeight:Z,allItems:H,typeaheadIndex:null})}},this.onMouseEnter=V=>{this.setState({hoveredItem:V})},this.onMouseLeave=()=>{this.setState({hoveredItem:null})},this.moveMenuIndex=V=>{const K=this.state.allItems.length;if(K){const H=this.state.typeaheadIndex||0;let X=S(H+V,K);this.state.allItems[X].kind===c.I.GroupTitle&&(X=S(X+V,K)),this.setState({typeaheadIndex:X});return}},this.insertSuggestion=()=>{this.props.onSelectSuggestion&&this.state.typeaheadIndex!==null&&this.props.onSelectSuggestion(this.state.allItems[this.state.typeaheadIndex])}}static{this.contextType=a.D}get menuPosition(){if(!window.getSelection)return"";const V=window.getSelection(),K=V&&V.anchorNode;if(K&&K.parentElement){const H=K.parentElement.getBoundingClientRect(),X=window.scrollX,k=window.scrollY;return`position: absolute; display: flex; top: ${H.top+k+H.height+6}px; left: ${H.left+X-2}px`}return""}render(){const{prefix:V,isOpen:K=!1,origin:H}=this.props,{allItems:X,listWidth:k,listHeight:Y,itemHeight:Z,hoveredItem:se,typeaheadIndex:j}=this.state,q=b(this.context),ne=se||j,oe=X[se||j||0];return(0,t.jsxs)(T,{origin:H,isOpen:K,style:this.menuPosition,children:[(0,t.jsx)("ul",{role:"menu",className:q.typeahead,"data-testid":"typeahead",children:(0,t.jsx)(f.Y1,{ref:this.listRef,itemCount:X.length,itemSize:Z,itemKey:z=>{const te=X&&X[z];return te?`${z}-${te.label}`:`${z}`},width:k,height:Y,children:({index:z,style:te})=>{const le=X&&X[z];return le?(0,t.jsx)(M,{onClickItem:()=>this.props.onSelectSuggestion?this.props.onSelectSuggestion(le):{},isSelected:j===null?!1:X[j]===le,item:le,prefix:V,style:te,onMouseEnter:()=>this.onMouseEnter(z),onMouseLeave:this.onMouseLeave}):null}})}),ne&&(0,t.jsx)(D,{height:Y,item:oe})]})}}class T extends s.PureComponent{constructor(V){super(V);const{index:K=0,origin:H="query",style:X}=V;this.node=document.createElement("div"),this.node.setAttribute("style",X),this.node.classList.add("slate-typeahead",`slate-typeahead-${H}-${K}`),document.body.appendChild(this.node)}componentWillUnmount(){document.body.removeChild(this.node)}render(){return this.props.isOpen?(this.node.setAttribute("style",this.props.style),this.node.classList.add("slate-typeahead--open"),r.createPortal(this.props.children,this.node)):(this.node.classList.remove("slate-typeahead--open"),null)}}const b=B=>({typeahead:(0,i.css)({maxHeight:300,overflowY:"auto",strong:{color:B.v1.palette.yellow}})});var R=e(72307),A=e(75071),L=e(84694);const U=250;function W({onTypeahead:B,cleanText:V,onWillApplySuggestion:K,portalOrigin:H}){let X,k={groupedItems:[],typeaheadPrefix:"",typeaheadContext:"",typeaheadText:""};const Y=(0,n.debounce)(w,U),Z=se=>{k={...k,...se}};return{onBlur:(se,j,q)=>(k={...k,groupedItems:[]},q()),onClick:(se,j,q)=>(k={...k,groupedItems:[]},q()),onKeyDown:(se,j,q)=>{const oe=k.groupedItems.length;switch(se.key){case"Escape":{if(oe)return se.preventDefault(),k={...k,groupedItems:[]},j.insertText("");break}case"ArrowDown":case"ArrowUp":if(oe){se.preventDefault(),X.moveMenuIndex(se.key==="ArrowDown"?1:-1);return}break;case"Enter":{if(!(se.shiftKey||se.ctrlKey)&&oe)return se.preventDefault(),X.insertSuggestion();break}case"Tab":{if(oe)return se.preventDefault(),X.insertSuggestion();break}default:{se.key.length===1&&Y(j,Z,B,V);break}}return q()},commands:{selectSuggestion:(se,j)=>{const q=k.groupedItems;if(!q||!q.length)return se;const ne=se.applyTypeahead(j);return Y(se,Z,B,V),ne},applyTypeahead:(se,j)=>{let q=j.insertText||j.label;const ne=j.kind==="function",oe=j.move||0,z=oe>0?oe:0,te=oe<0?-oe:0,{typeaheadPrefix:le,typeaheadText:ie,typeaheadContext:ae}=k;K&&(q=K(q,{groupedItems:k.groupedItems,typeaheadContext:ae,typeaheadPrefix:le,typeaheadText:ie}));const{forward:re,backward:ce}=N(q,le,ie,ne,j.deleteBackwards,V);if(q.match(/\n/)){const me=(0,R.dF)(q);return se.deleteBackward(ce).deleteForward(re).insertFragment(me).focus(),se}return k={...k,groupedItems:[]},se.snapshotSelection().deleteBackward(ce).deleteForward(re).insertText(q).moveForward(z).moveBackward(te).focus(),se}},renderEditor(se,j,q){if(j.value.selection.isExpanded)return q();const ne=q();return(0,t.jsxs)(t.Fragment,{children:[ne,(0,t.jsx)(I,{menuRef:oe=>X=oe,origin:H,prefix:k.typeaheadPrefix,isOpen:!!k.groupedItems.length,groupedItems:k.groupedItems,onSelectSuggestion:j.selectSuggestion})]})}}}const w=async(B,V,K,H)=>{if(!K)return;const{value:X}=B,{selection:k}=X,Y=X.document.getClosestBlock(X.focusBlock.key),Z=X.selection.start.offset-1,se=Y&&Y.getDecorations(B),j=se?se.filter(ce=>ce.start.offset<=Z&&ce.end.offset>Z&&ce.type===L.A).toArray():[],q=se&&se.filter(ce=>ce.end.offset<=Z&&ce.type===L.A&&ce.data.get("className").includes("label-key")).last(),ne=q&&X.focusText.text.slice(q.start.offset,q.end.offset),oe=j.map(ce=>ce.data.get("className")).join(" ").split(" ").filter(ce=>ce.length);let z=X.focusText.text,te=z.slice(0,k.focus.offset);j.length&&(z=X.focusText.text.slice(j[0].start.offset,j[0].end.offset),te=X.focusText.text.slice(j[0].start.offset,k.focus.offset));const le=te.match(/(?:!?=~?"?|")(.*)/);le?te=le[1]:H&&(te=H(te));const{suggestions:ie,context:ae}=await K({prefix:te,text:z,value:X,wrapperClasses:oe,labelKey:ne||void 0,editor:B}),re=ie.map(ce=>{if(!ce.items)return ce;const me=ce.searchFunctionType||(ce.prefixMatch?A.T.Prefix:A.T.Word),ee=A.H[me];let de={...ce};return te&&(ce.skipFilter||(de.items=de.items.filter(De=>(De.filterText||De.label).length>=te.length),de.items=ee(de.items,te)),de.items=de.items.filter(De=>!(De.insertText===te||(De.filterText??De.label)===te))),ce.skipSort||(de.items=(0,n.sortBy)(de.items,De=>De.sortText===void 0?De.sortValue!==void 0?De.sortValue:De.label:De.sortText||De.label)),de}).filter(ce=>ce.items&&ce.items.length);V({groupedItems:re,typeaheadPrefix:te,typeaheadContext:ae,typeaheadText:z}),B.blur().focus()};function N(B,V,K,H,X,k){const Y=X||V.length,Z=k?k(K):K,se=K.indexOf(V),j=se>-1?Z.length-se-V.length:Z.length-V.length;return{forward:!!(V&&j>0||B===K)&&!H?j+se:0,backward:Y}}},63211:(G,O,e)=>{"use strict";e.d(O,{k:()=>T});var t=e(74848),n=e(94659),i=e(40845);function s(b){return(0,n.css)({".sr-only":{position:"absolute",width:"1px",height:"1px",padding:0,margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",border:0}})}function r(b){return(0,n.css)({".alert-state-paused, .alert-state-pending":{color:b.colors.text.secondary,fontWeight:b.typography.fontWeightMedium},".alert-state-ok":{color:b.colors.success.text,fontWeight:b.typography.fontWeightMedium},".alert-state-warning":{color:b.colors.warning.text,fontWeight:b.typography.fontWeightMedium},".alert-state-critical":{color:b.colors.error.text,fontWeight:b.typography.fontWeightMedium}})}function f(b){return(0,n.css)({".panel-options-group":{borderBottom:`1px solid ${b.colors.border.weak}`},".panel-options-group__header":{padding:b.spacing(1,2,1,1),position:"relative",display:"flex",alignItems:"center",cursor:"pointer",fontWeight:500,color:b.colors.text.primary,"&:hover":{background:b.colors.emphasize(b.colors.background.primary,.03)}},".panel-options-group__icon":{color:b.colors.text.secondary,marginRight:b.spacing(1),padding:b.spacing(0,.9,0,.6)},".panel-options-group__title":{position:"relative"},".panel-options-group__body":{padding:b.spacing(1,2,1,4)}})}function a(b){return(0,n.css)({".card-section":{marginBottom:b.spacing(4)},".card-list":{display:"flex",flexDirection:"row",flexWrap:"wrap",listStyleType:"none"},".card-item":{display:"block",height:"100%",background:b.colors.background.secondary,boxShadow:"none",padding:b.spacing(2),borderRadius:"4px","&:hover":{background:b.colors.emphasize(b.colors.background.secondary,.03)},".label-tag":{marginLeft:b.spacing(1),fontSize:"11px",padding:"2px 6px"}},".card-item-body":{display:"flex",overflow:"hidden"},".card-item-details":{overflow:"hidden"},".card-item-header":{marginBottom:b.spacing(2)},".card-item-type":{color:b.colors.text.secondary,textTransform:"uppercase",fontSize:b.typography.size.sm,fontWeight:b.typography.fontWeightMedium},".card-item-badge":{margin:"6px 0"},".card-item-notice":{fontSize:b.typography.size.sm},".card-item-name":{color:b.colors.text.primary,overflow:"hidden",textOverflow:"ellipsis",width:"100%"},".card-item-label":{marginLeft:b.spacing(1)},".card-item-sub-name":{color:b.colors.text.secondary,overflow:"hidden",textOverflow:"ellipsis",width:"100%"},".card-item-sub-name--header":{color:b.colors.text.secondary,textTransform:"uppercase",marginBottom:b.spacing(2),fontSize:b.typography.size.sm,fontWeight:"bold"},".card-list-layout-grid":{".card-item-type":{display:"inline-block"},".card-item-notice":{fontSize:b.typography.size.sm,display:"inline-block",marginLeft:b.spacing(2)},".card-item-header-action":{float:"right"},".card-item-wrapper":{width:"100%",padding:b.spacing(0,2,2,0)},".card-item-wrapper--clickable":{cursor:"pointer"},".card-item-figure":{margin:b.spacing(0,2,2,0),height:"80px",img:{width:"80px"}},".card-item-name":{fontSize:b.typography.h3.fontSize},[b.breakpoints.up("md")]:{".card-item-wrapper":{width:"50%"}},[b.breakpoints.up("lg")]:{".card-item-wrapper":{width:"33.333333%"}},"&.card-list-layout-grid--max-2-col":{[b.breakpoints.up("lg")]:{".card-item-wrapper":{width:"50%"}}}},".card-list-layout-list":{".card-item-wrapper":{padding:0,width:"100%",marginBottom:b.spacing(1)},".card-item-wrapper--clickable":{cursor:"pointer"},".card-item":{borderRadius:"2px"},".card-item-header":{float:"right",textAlign:"right"},".card-item-figure":{margin:b.spacing(0,2,0,0),img:{width:"48px"}},".card-item-name":{fontSize:b.typography.h4.fontSize},".card-item-sub-name":{fontSize:b.typography.size.sm},".layout-selector":{marginRight:0}}})}function c(b){return(0,n.css)({"code, pre, kbd, samp":{...b.typography.code,fontSize:b.typography.bodySmall.fontSize,backgroundColor:b.colors.background.primary,color:b.colors.text.primary,border:`1px solid ${b.colors.border.medium}`,borderRadius:"4px"},code:{whiteSpace:"nowrap",padding:"2px 5px",margin:"0 2px"},pre:{display:"block",margin:`0 0 ${b.typography.body.lineHeight}`,lineHeight:b.typography.body.lineHeight,wordBreak:"break-all",wordWrap:"break-word",whiteSpace:"pre-wrap",overflow:"auto",padding:"10px",code:{padding:0,color:"inherit",whiteSpace:"pre-wrap",backgroundColor:"transparent",border:0}}})}function o(b){return(0,n.css)({".delta-html":{background:b.colors.background.secondary,paddingTop:"5px",paddingBottom:"5px",userSelect:"none"},".diff-line":{color:b.colors.text.primary,fontFamily:b.typography.fontFamilyMonospace,fontSize:b.typography.size.sm,lineHeight:2,marginBottom:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",position:"relative","&:after":{left:"-40px"}},".diff-line-number":{color:b.colors.text.secondary,display:"inline-block",fontSize:b.typography.size.xs,lineHeight:2.3,textAlign:"right",width:"30px"},".diff-line-number-hide":{visibility:"hidden"},".diff-line-icon":{color:b.colors.text.primary,fontSize:b.typography.size.xs,float:"right",position:"relative",top:"2px",right:"10px"},".diff-json-new, .diff-json-old, .diff-json-deleted, .diff-json-added":{color:b.v1.palette.gray5,".diff-line-number":{color:b.colors.text.primary}},".diff-json-new":{backgroundColor:b.isDark?"#457740":"#664e33"},".diff-json-old":{backgroundColor:b.isDark?"#a04338":"#5a372a"},".diff-json-added":{backgroundColor:b.colors.primary.shade},".diff-json-deleted":{backgroundColor:b.colors.error.shade},".diff-value":{userSelect:"all"},".diff-circle":{marginRight:"0.5em","*":{marginBottom:"1px"}},".diff-circle-changed":{color:"#f59433"},".diff-circle-added":{color:"#29d761"},".diff-circle-deleted":{color:"#fd474a"},".diff-item-added, .diff-item-deleted":{listStyle:"none"},".diff-group":{background:b.colors.background.secondary,fontSize:"16px",fontStyle:"normal",padding:"10px 15px",margin:b.spacing(2,0),".diff-group":{padding:"0 5px"}},".diff-group-name":{display:"inline-block",width:"100%",fontSize:"16px",paddingLeft:"1.75em",margin:"0 0 14px 0"},".diff-summary-key":{paddingLeft:"0.25em"},".diff-list":{paddingLeft:"40px",".diff-list":{paddingLeft:0}},".diff-item":{color:b.v1.palette.gray2,lineHeight:2.5,"> div":{display:"inline"}},".diff-item-changeset":{listStyle:"none"},".diff-label":{backgroundColor:b.colors.action.hover,borderRadius:"3px",color:b.colors.text.primary,display:"inline",fontSize:`${b.typography.fontSize}px`,margin:"0 5px",padding:"3px 8px"},".diff-linenum":{float:"right"},".diff-arrow":{color:b.colors.text.primary},".diff-block":{width:"100%",display:"inline-block"},".diff-block-title":{fontSize:"16px",display:"inline-block"},".diff-title":{fontSize:"16px"},".diff-change-container":{margin:"0 0",paddingLeft:"3em",paddingRight:0},".diff-change-group":{width:"100%",color:b.colors.text.primary,marginBottom:"14px"},".diff-change-item":{display:"inline-block"},".diff-change-title":{fontSize:"16px"},".bullet-position-container":{position:"relative",left:"-6px"},".diff-list-circle":{marginBottom:"3px"}})}var h=e(16797);function g(b){const R=window.grafanaBootData?.settings.featureToggles.bodyScrolling;return(0,n.css)({html:{MsOverflowStyle:"scrollbar",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)",height:"100%",fontSize:`${b.typography.htmlFontSize}px`,fontFamily:b.typography.fontFamily,lineHeight:b.typography.body.lineHeight,fontKerning:"normal"},":root":{colorScheme:b.colors.mode},body:{height:"100%",width:"100%",position:R?"unset":"absolute",color:b.colors.text.primary,backgroundColor:b.colors.background.canvas,...b.typography.body,...R&&{overflowY:"scroll !important",paddingRight:"0 !important","@media print":{overflow:"visible"},"@page":{margin:0,size:"auto",padding:0}}},"h1, .h1":l(b.typography.h1),"h2, .h2":l(b.typography.h2),"h3, .h3":l(b.typography.h3),"h4, .h4":l(b.typography.h4),"h5, .h5":l(b.typography.h5),"h6, .h6":l(b.typography.h6),p:{margin:b.spacing(0,0,2)},textarea:{overflow:"auto"},button:{letterSpacing:b.typography.body.letterSpacing,"&:focus-visible":(0,h.getFocusStyles)(b),"&:focus":{outline:"none"}},"small, .small":{fontSize:b.typography.bodySmall.fontSize,fontWeight:"normal"},"b, strong":{fontWeight:b.typography.fontWeightMedium},em:{fontStyle:"italic",color:b.colors.text.primary},cite:{fontStyle:"normal"},blockquote:{padding:b.spacing(0,0,0,2),margin:b.spacing(0,0,2),borderLeft:`5px solid ${b.v1.palette.gray3}`,p:{marginBottom:0,fontSize:b.typography.fontSize*1.25,fontWeight:300,lineHeight:1.25},small:{display:"block",lineHeight:b.typography.body.lineHeight,color:b.v1.palette.gray2,"&:before":{content:"'\\2014 \\00A0'"}}},"q:before, q:after, blockquote:before, blockquote:after":{content:"''"},address:{display:"block",marginBottom:b.spacing(2),fontStyle:"normal",lineHeight:b.typography.body.lineHeight},"a.external-link":{color:b.colors.text.link,textDecoration:"normal","&:hover":{color:b.colors.text.link,textDecoration:"underline"}},".link":{color:b.colors.text.primary,cursor:"pointer"},".link:hover":{color:b.colors.text.maxContrast},".pointer":{cursor:"pointer"},"audio, canvas, progress, video":{display:"inline-block",verticalAlign:"baseline"},"audio:not([controls])":{display:"none",height:0},"abbr[title]":{borderBottom:"1px dotted",cursor:"help"},dfn:{fontStyle:"italic"},"sub, sup":{fontSize:"75%",lineHeight:0,position:"relative",verticalAlign:"baseline"},sup:{top:"-0.5em"},sub:{bottom:"-0.25em"},hr:{marginTop:b.spacing(2),marginBottom:b.spacing(2),border:0,borderTop:`1px solid ${b.colors.border.medium}`},"mark, .mark":{background:b.colors.warning.main},"ul, ol":{padding:0},"ul ul, ul ol, ol ol, ol ul":{marginBottom:0},li:{lineHeight:b.typography.body.lineHeight},dl:{marginBottom:b.spacing(2)},"dt, dd":{lineHeight:b.typography.body.lineHeight},dt:{fontWeight:b.typography.fontWeightMedium},"button, input, optgroup, select, textarea":{color:"inherit",font:"inherit",margin:0},optgroup:{fontWeight:"bold"},'button, html input[type="button"], input[type="submit"]':{WebkitAppearance:"button",cursor:"pointer"},'input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration':{WebkitAppearance:"none"},table:{borderCollapse:"collapse",borderSpacing:0},th:{fontWeight:b.typography.fontWeightMedium},"td, th":{padding:0},".muted":{color:b.colors.text.secondary},"a.muted:hover, a.muted:focus":{color:b.colors.text.primary},".text-warning":{color:b.colors.warning.text,"&:hover, &:focus":{color:b.colors.emphasize(b.colors.warning.text,.15)}},".text-error":{color:b.colors.error.text,"&:hover, &:focus":{color:b.colors.emphasize(b.colors.error.text,.15)}},".text-success":{color:"$success-text-color","&:hover, &:focus":{color:b.colors.emphasize(b.colors.success.text,.15)}},a:{cursor:"pointer",color:b.colors.text.primary,textDecoration:"none","&:focus":{outline:"none"},"&:focus-visible":(0,h.getFocusStyles)(b),"&:[disabled]":{cursor:"default",pointerEvents:"none !important"}},".text-link":{textDecoration:"underline"},".text-left":{textAlign:"left"},".text-right":{textAlign:"right"},".text-center":{textAlign:"center"},".highlight-search-match":{background:b.components.textHighlight.background,color:b.components.textHighlight.text,padding:0},".template-variable":{color:b.colors.primary.text}})}function l(b){return{margin:0,fontSize:b.fontSize,lineHeight:b.lineHeight,fontWeight:b.fontWeight,letterSpacing:b.letterSpacing,fontFamily:b.fontFamily,marginBottom:"0.45em"}}function p(b){return(0,n.css)({"iframe.intercom-borderless-frame":{colorScheme:b.colors.mode}})}function m(b){return(0,n.css)({".filter-table *":{boxSizing:"border-box"},".filter-table":{width:"100%",borderCollapse:"separate",tbody:{"tr:nth-child(odd)":{background:b.colors.emphasize(b.colors.background.primary,.02)}},th:{width:"auto",padding:b.spacing(.5,1),textAlign:"left",lineHeight:"30px",height:"30px",whiteSpace:"nowrap"},td:{padding:b.spacing(.5,1),lineHeight:"30px",height:"30px",whiteSpace:"nowrap"},".link-td":{padding:0,lineHeight:"30px",height:"30px",whiteSpace:"nowrap",a:{display:"block",padding:b.spacing(0,1),height:"30px"}},".ellipsis":{display:"block",width:"100%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},".expanded":{borderColor:b.components.panel.background},".expanded > td":{paddingBottom:0},".filter-table__avatar":{width:"25px",height:"25px",borderRadius:"50%"},"&--hover":{"tbody tr:hover":{background:b.colors.emphasize(b.colors.background.primary,.05)}}}})}function y(b){const R=typeof window<"u"&&window.__grafana_public_path__,A=R?`${R}fonts/`:"public/fonts/";return(0,n.css)([{"@font-face":{fontFamily:"Roboto Mono",fontStyle:"normal",fontWeight:400,fontDisplay:"swap",src:`url('${A}roboto/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSh0mQ.woff2') format('woff2')`,unicodeRange:"U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD"}},{"@font-face":{fontFamily:"Roboto Mono",fontStyle:"normal",fontWeight:500,fontDisplay:"swap",src:`url('${A}roboto/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSh0mQ.woff2') format('woff2')`,unicodeRange:"U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD"}},{"@font-face":{fontFamily:"Inter",fontStyle:"normal",fontWeight:400,fontDisplay:"swap",src:`url('${A}inter/Inter-Regular.woff2') format('woff2')`}},{"@font-face":{fontFamily:"Inter",fontStyle:"normal",fontWeight:500,fontDisplay:"swap",src:`url('${A}inter/Inter-Medium.woff2') format('woff2')`}}])}function d(b){return(0,n.css)({"input, button, select, textarea":{fontFamily:b.typography.body.fontFamily,fontSize:b.typography.body.fontSize,fontWeight:b.typography.body.fontWeight,lineHeight:b.typography.body.lineHeight},"input, select":{backgroundColor:b.components.input.background,color:b.components.input.text,border:"none",boxShadow:"none"},textarea:{height:"auto"},"input[type='file'], input[type='image'], input[type='submit'], input[type='reset'], input[type='button'], input[type='radio'], input[type='checkbox']":{width:"auto"}})}function v(b){return(0,n.css)({".json-formatter-row":{fontFamily:"monospace","&, a, a:hover":{color:b.colors.text.primary,textDecoration:"none"},".json-formatter-row":{marginLeft:b.spacing(2)},".json-formatter-children":{"&.json-formatter-empty":{opacity:.5,marginLeft:b.spacing(2),"&::after":{display:"none"},"&.json-formatter-object::after":{content:"'No properties'"},"&.json-formatter-array::after":{content:"'[]'"}}},".json-formatter-string":{color:b.isDark?"#23d662":"green",whiteSpace:"pre-wrap",wordWrap:"break-word",wordBreak:"break-all"},".json-formatter-number":{color:b.isDark?b.colors.primary.text:b.colors.primary.main},".json-formatter-boolean":{color:b.isDark?b.colors.primary.text:b.colors.error.main},".json-formatter-null":{color:b.isDark?"#eec97d":"#855a00"},".json-formatter-undefined":{color:b.isDark?"rgb(239, 143, 190)":"rgb(202, 11, 105)"},".json-formatter-function":{color:b.isDark?"#fd48cb":"#ff20ed"},".json-formatter-url":{textDecoration:"underline",color:b.isDark?"#027bff":b.colors.primary.main,cursor:"pointer"},".json-formatter-bracket":{color:b.isDark?"#9494ff":b.colors.primary.main},".json-formatter-key":{color:b.isDark?"#23a0db":"#00008b",cursor:"pointer",paddingRight:b.spacing(.25),marginRight:b.spacing(.5)},".json-formatter-constructor-name":{cursor:"pointer"},".json-formatter-array-comma":{marginRight:b.spacing(.5)},".json-formatter-toggler":{lineHeight:"16px",fontSize:b.typography.size.xs,verticalAlign:"middle",opacity:.6,cursor:"pointer",paddingRight:b.spacing(.25),"&::after":{display:"inline-block",transition:"transform 100ms ease-in",content:"'\u25BA'"}},"> a > .json-formatter-preview-text":{opacity:0,transition:"opacity 0.15s ease-in",fontStyle:"italic"},"&:hover > a > .json-formatter-preview-text":{opacity:.6},"&.json-formatter-open":{"> .json-formatter-toggler-link .json-formatter-toggler::after":{transform:"rotate(90deg)"},"> .json-formatter-children::after":{display:"inline-block"},"> a > .json-formatter-preview-text":{display:"none"},"&.json-formatter-empty::after":{display:"block"}}}})}function u(b){return(0,n.css)({".gf-form-select-box__control":{width:"100%",marginRight:b.spacing(.5),backgroundColor:b.components.input.background,border:`1px solid ${b.components.input.borderColor}`,borderRadius:b.shape.radius.default,color:b.components.input.text,cursor:"default",height:b.spacing(4),outline:"none",overflow:"hidden",position:"relative"},".gf-form-select-box__control--is-focused":{backgroundColor:b.components.input.background,borderColor:b.colors.primary.border,outline:"none",boxShadow:`inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px ${b.colors.primary.border}`},".gf-form-select-box__control--is-disabled":{backgroundColor:b.colors.action.disabledBackground},".gf-form-select-box__control--menu-right":{".gf-form-select-box__menu":{right:0,left:"unset"}},".gf-form-select-box__input":{input:{lineHeight:"inherit"}},".gf-form-select-box__menu":{background:b.colors.background.primary,boxShadow:b.shadows.z3,position:"absolute",zIndex:b.zIndex.dropdown,minWidth:"100%","&-notice--no-options":{backgroundColor:b.components.input.background,padding:"10px"}},".gf-form-select-box__menu-list":{overflowY:"auto",maxHeight:"300px",maxWidth:"600px"},".tag-filter .gf-form-select-box__menu":{width:"100%"},".gf-form-select-box__multi-value":{display:"inline",margin:"0 6px 0 0",cursor:"pointer"},".gf-form-select-box__multi-value__remove":{textAlign:"center",display:"inline-block",marginLeft:"2px",position:"relative"},".gf-form-select-box__multi-value__label":{display:"inline",verticalAlign:"middle"},".gf-form-select-box__option":{borderLeft:"2px solid transparent",whiteSpace:"nowrap",backgroundColor:b.components.input.background,"&.gf-form-select-box__option--is-focused":{color:b.colors.text.primary,background:b.colors.action.hover,borderImage:b.colors.gradients.brandVertical,borderImageSlice:1,borderStyle:"solid",borderTop:0,borderRight:0,borderBottom:0,borderLeftWidth:"2px"},"&.gf-form-select-box__option--is-selected":{".fa":{color:b.colors.text.primary}}},".gf-form-select-box__placeholder":{color:b.colors.text.disabled},".gf-form-select-box__control--is-focused .gf-form-select-box__placeholder":{display:"none"},".gf-form-select-box__value-container":{display:"inline-block",padding:"6px 20px 6px 10px",verticalAlign:"middle","> div":{display:"inline-block",verticalAlign:"middle"}},".gf-form-select-box__indicators":{position:"absolute",height:"100%",right:"8px",top:"1px",display:"inline-block",textAlign:"right"},".gf-form-input--form-dropdown":{padding:0,border:0,overflow:"visible",position:"relative"},".gf-form--has-input-icon":{".gf-form-select-box__value-container":{paddingLeft:"30px"}},".gf-form-select-box__desc-option":{display:"flex",alignItems:"center",justifyContent:"flex-start",justifyItems:"center",cursor:"pointer",padding:"7px 10px",width:"100%"},".gf-form-select-box__desc-option__body":{display:"flex",flexDirection:"column",flexGrow:1,paddingRight:"10px",fontWeight:b.typography.fontWeightMedium},".gf-form-select-box__desc-option__desc":{fontWeight:"normal",fontSize:b.typography.bodySmall.fontSize,color:b.colors.text.secondary},".gf-form-select-box__desc-option__img":{width:"16px",marginRight:"10px"},".gf-form-select-box__option-group__header":{display:"flex",alignItems:"center",justifyContent:"flex-start",justifyItems:"center",cursor:"pointer",padding:"7px 10px",width:"100%",borderBottom:`1px solid ${b.v1.palette.dark9}`,textTransform:"capitalize",".fa":{paddingRight:"2px"}},".gf-form-select-box-button-select":{height:"auto"},".select-button":{display:"flex",alignItems:"center"}})}function D(b){return(0,n.css)({".markdown-html":{img:{maxWidth:"100%"},"ul, ol":{paddingLeft:b.spacing(3),marginBottom:b.spacing(2)},table:{marginBottom:b.spacing(2),"td, th":{padding:b.spacing(.5,1)},th:{fontWeight:b.typography.fontWeightMedium,background:b.colors.background.secondary}},"table, th, td":{border:`1px solid ${b.colors.border.medium}`,borderCollapse:"collapse"},a:{color:b.colors.text.link,textDecoration:"none","&:hover":{color:b.colors.text.link,textDecoration:"underline"}},"p:last-child":{marginBottom:0},"table:last-child, ul:last-child, ol:last-child":{marginBottom:0}}})}function P(b){const R=b.breakpoints.values.xxl+b.spacing.gridSize*2+b.components.sidemenu.width,A=window.grafanaBootData?.settings.featureToggles.bodyScrolling;return(0,n.css)({".grafana-app":A?{display:"flex",flexDirection:"column",minHeight:"100vh"}:{display:"flex",alignItems:"stretch",position:"absolute",width:"100%",height:"100%",top:0,left:0},".main-view":A?{display:"flex",flexDirection:"column",flexGrow:1,position:"relative",minWidth:0}:{position:"relative",display:"flex",flexDirection:"column",flexGrow:1,height:"100%",flex:"1 1 0",minWidth:0},".page-scrollbar-content":{display:"flex",minHeight:"100%",flexDirection:"column",width:"100%",height:"100%"},".page-container":{flexGrow:1,flexBasis:"100%",paddingLeft:b.spacing(2),paddingRight:b.spacing(2),[b.breakpoints.up("sm")]:{margin:b.spacing(0,1)},[b.breakpoints.up("md")]:{margin:b.spacing(0,2)},[`@media (min-width: ${R}px)`]:{maxWidth:`${b.breakpoints.values.xxl}px`,marginLeft:"auto",marginRight:"auto",width:"100%"}},".page-full":{marginLeft:b.spacing(2),paddingLeft:b.spacing(2),paddingRight:b.spacing(2)},".page-body":{padding:b.spacing(1),background:b.components.panel.background,border:`1px solid ${b.components.panel.borderColor}`,marginBottom:"32px",[b.breakpoints.up("md")]:{padding:b.spacing(2)},[b.breakpoints.up("lg")]:{padding:b.spacing(3)}},".page-heading":{fontSize:b.typography.h4.fontSize,marginTop:0,marginBottom:b.spacing(2)},".page-action-bar":{marginBottom:b.spacing(2),display:"flex",alignItems:"flex-start",gap:b.spacing(2)},".page-action-bar--narrow":{marginBottom:0},".page-action-bar__spacer":{width:b.spacing(2),flexGrow:1},".page-sub-heading":{marginBottom:b.spacing(2)},".page-sub-heading-icon":{marginLeft:b.spacing(1),marginTop:b.spacing(.5)},".page-hidden":{display:"none"}})}function x(b){return(0,n.css)({".query-editor-row":{marginBottom:"2px","&--disabled":{".query-keyword":{color:b.colors.text.secondary}}},".query-keyword":{fontWeight:b.typography.fontWeightMedium,color:`${b.colors.primary.text} !important`},".query-part":{backgroundColor:b.colors.background.secondary,"&:hover":{background:b.colors.emphasize(b.colors.background.secondary,.03)}},".query-segment-operator":{color:`${b.v1.palette.orange} !important`},".tight-form-func":{background:b.colors.background.secondary},'input[type="text"].tight-form-func-param':{fontSize:b.typography.bodySmall.fontSize,background:"transparent",border:"none",margin:0,padding:0},".tight-form-func-controls":{textAlign:"center",".fa-arrow-left":{float:"left",position:"relative",top:2},".fa-arrow-right":{float:"right",position:"relative",top:2},".fa-remove":{marginLeft:"10px"}}})}function E(b){return(0,n.css)({".rc-time-picker-input,.rc-time-picker-panel-input-wrap,.rc-time-picker-panel-inner":{backgroundColor:b.components.input.background,color:b.colors.text.secondary,borderColor:b.components.input.borderColor,fontSize:b.typography.body.fontSize},".rc-time-picker-input":{padding:b.spacing(0,1),height:b.spacing(4)},".rc-time-picker-panel":{width:"176px"},".rc-time-picker-panel-select":{width:"50%","&:only-child":{width:"100%"},".rc-time-picker-panel-select-option-selected":{backgroundColor:b.colors.background.secondary},"li:hover":{backgroundColor:b.colors.background.secondary}},".rc-time-picker-panel-narrow":{maxWidth:"none"}})}var C=e(72129);const M=b=>(0,n.css)({".react-loading-skeleton":C.Q});function S(b){return(0,n.css)({".slate-query-field":{fontSize:b.typography.fontSize,fontFamily:b.typography.fontFamilyMonospace,height:"auto",wordBreak:"break-word",overflow:"auto"},".slate-query-field__wrapper":{position:"relative",display:"inline-block",padding:"6px 8px",minHeight:"32px",width:"100%",color:b.colors.text.primary,backgroundColor:b.components.input.background,backgroundImage:"none",border:`1px solid ${b.components.input.borderColor}`,borderRadius:b.shape.radius.default,transition:"all 0.3s",lineHeight:"18px"},".slate-query-field__wrapper--disabled":{backgroundColor:"inherit",cursor:"not-allowed"},".slate-typeahead":{".typeahead":{position:"relative",zIndex:b.zIndex.typeahead,borderRadius:b.shape.radius.default,border:`1px solid ${b.components.panel.borderColor}`,maxHeight:"66vh",overflowY:"scroll",overflowX:"hidden",outline:"none",listStyle:"none",background:b.components.panel.background,color:b.colors.text.primary,boxShadow:b.shadows.z2},".typeahead-group__title":{color:b.colors.text.secondary,fontSize:b.typography.size.sm,lineHeight:b.typography.body.lineHeight,padding:b.spacing(1)},".typeahead-item":{height:"auto",fontFamily:b.typography.fontFamilyMonospace,padding:b.spacing(1,1,1,2),fontSize:b.typography.size.sm,textOverflow:"ellipsis",overflow:"hidden",zIndex:1,display:"block",whiteSpace:"nowrap",cursor:"pointer",transition:"color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), border-color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), background 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), padding 0.15s cubic-bezier(0.645, 0.045, 0.355, 1)"},".typeahead-item__selected":{backgroundColor:b.isDark?b.v1.palette.dark9:b.v1.palette.gray6,".typeahead-item-hint":{fontSize:b.typography.size.xs,color:b.colors.text.primary,whiteSpace:"normal"}},".typeahead-match":{color:b.v1.palette.yellow,borderBottom:`1px solid ${b.v1.palette.yellow}`,padding:"inherit",background:"inherit"}},".slate-query-field, .prism-syntax-highlight":{".token.comment, .token.block-comment, .token.prolog, .token.doctype, .token.cdata":{color:b.colors.text.secondary},".token.variable, .token.entity":{color:b.colors.text.primary},".token.property, .token.tag, .token.constant, .token.symbol, .token.deleted":{color:b.colors.error.text},".token.attr-value, .token.selector, .token.string, .token.char, .token.builtin, .token.inserted":{color:b.colors.success.text},".token.boolean, .token.number, .token.operator, .token.url":{color:"#fe85fc"},".token.function, .token.attr-name, .token.function-name, .token.atrule, .token.keyword, .token.class-name":{color:b.colors.primary.text},".token.punctuation, .token.regex, .token.important":{color:b.v1.palette.orange},".token.important":{fontWeight:"normal"},".token.bold":{fontWeight:"bold"},".token.italic":{fontStyle:"italic"},".token.entity":{cursor:"help"},".namespace":{opacity:.7}}})}function I(b){return(0,n.css)({".uplot":{fontFamily:"inherit"},".u-select":{background:"rgba(120, 120, 130, 0.2)"},".u-hz .u-cursor-x, .u-vt .u-cursor-y":{borderRight:"1px dashed rgba(120, 120, 130, 0.5)"},".u-hz .u-cursor-y, .u-vt .u-cursor-x":{borderBottom:"1px dashed rgba(120, 120, 130, 0.5)"},".shared-crosshair:not(.plot-active) .u-cursor-pt":{display:"none !important"}})}function T(){const b=(0,i.$j)();return(0,t.jsx)(n.Global,{styles:[s(b),f(b),r(b),c(b),o(b),g(b),p(b),m(b),y(b),d(b),v(b),a(b),D(b),P(b),x(b),E(b),M(b),S(b),I(b),u(b)]})}},40845:(G,O,e)=>{"use strict";e.d(O,{$j:()=>m,DP:()=>p,IS:()=>y,SL:()=>g,cV:()=>l,fq:()=>v,of:()=>d});var t=e(74848),n=e(4146),i=e.n(n),s=e(47078),r=e.n(s),f=e(96540),a=e(60578),c=e(3911);let o=null;const h=new WeakMap,g=u=>{const D=P=>{const x=o||a.D;return(0,t.jsx)(x.Consumer,{children:E=>(0,t.jsx)(u,{...P,theme:E.v1})})};return D.displayName=`WithTheme(${u.displayName})`,i()(D,u),D},l=u=>{const D=P=>{const x=o||a.D;return(0,t.jsx)(x.Consumer,{children:E=>(0,t.jsx)(u,{...P,theme:E})})};return D.displayName=`WithTheme(${u.displayName})`,i()(D,u),D};function p(){return(0,f.useContext)(o||a.D).v1}function m(){return(0,f.useContext)(o||a.D)}function y(u){const D=p();let P=h.get(u);return P||(P=(0,c.N)(u),h.set(u,P)),P(D)}function d(u,...D){const P=m();let x=h.get(u);return x||(x=r()(u,{maxSize:10}),h.set(u,x)),x(P,...D)}const v=u=>(o=f.createContext(u),()=>{o=null})},7918:(G,O,e)=>{"use strict";e.d(O,{kH:()=>c.k,Dx:()=>t.D,O4:()=>r,mG:()=>f,fq:()=>n.fq,YF:()=>o,N3:()=>a.N,IS:()=>n.IS,of:()=>n.of,DP:()=>n.DP,$j:()=>n.$j,SL:()=>n.SL,cV:()=>n.cV});var t=e(60578),n=e(40845),i=e(75972);let s;const r=(h="dark")=>s?s(h):(0,i.a)({colors:{mode:h}}).v1,f=h=>(s=h,()=>{s=null});var a=e(3911),c=e(63211),o=e(16797)},16797:(G,O,e)=>{"use strict";e.r(O),e.d(O,{cardChrome:()=>n,focusCss:()=>c,getFocusStyles:()=>h,getMouseFocusStyles:()=>o,getTooltipContainerStyles:()=>g,hoverColor:()=>i,listItem:()=>s,listItemSelected:()=>r,mediaUp:()=>f});var t=e(84140);function n(l){return`
    background: ${l.colors.background.secondary};
    &:hover {
      background: ${i(l.colors.background.secondary,l)};
    }
    box-shadow: ${l.components.panel.boxShadow};
    border-radius: ${l.shape.radius.default};
`}function i(l,p){return p.isDark?(0,t.A)(l).brighten(2).toString():(0,t.A)(l).darken(2).toString()}function s(l){return`
  background: ${l.colors.background.secondary};
  &:hover {
    background: ${i(l.colors.background.secondary,l)};
  }
  box-shadow: ${l.components.panel.boxShadow};
  border-radius: ${l.shape.radius.default};
`}function r(l){return`
    background: ${i(l.colors.background.secondary,l)};
    color: ${l.colors.text.maxContrast};
`}function f(l){return`only screen and (min-width: ${l})`}const a=l=>l.hasOwnProperty("v1"),c=l=>{const p=a(l),m=p?l.colors.background.canvas:l.colors.bodyBg,y=p?l.colors.primary.main:l.colors.formFocusOutline;return`
  outline: 2px dotted transparent;
  outline-offset: 2px;
  box-shadow: 0 0 0 2px ${m}, 0 0 0px 4px ${y};
  transition-property: outline, outline-offset, box-shadow;
  transition-duration: 0.2s;
  transition-timing-function: cubic-bezier(0.19, 1, 0.22, 1);`};function o(l){return{outline:"none",boxShadow:"none"}}function h(l){return{outline:"2px dotted transparent",outlineOffset:"2px",boxShadow:`0 0 0 2px ${l.colors.background.canvas}, 0 0 0px 4px ${l.colors.primary.main}`,transitionTimingFunction:"cubic-bezier(0.19, 1, 0.22, 1)",transitionDuration:"0.2s",transitionProperty:"outline, outline-offset, box-shadow"}}const g=l=>({overflow:"hidden",background:l.colors.background.secondary,boxShadow:l.shadows.z2,maxWidth:"800px",padding:l.spacing(1),borderRadius:l.shape.radius.default,zIndex:l.zIndex.tooltip})},3911:(G,O,e)=>{"use strict";e.d(O,{N:()=>i});var t=e(47078),n=e.n(t);function i(s){return n()(s)}},50774:(G,O,e)=>{"use strict";e.d(O,{I:()=>t});var t=(n=>(n.GroupTitle="GroupTitle",n))(t||{})},29621:()=>{"use strict"},4025:(G,O,e)=>{"use strict";e.d(O,{GO:()=>s,SS:()=>r,Uo:()=>t.Uo,lV:()=>f,rJ:()=>i});var t=e(8887),n=e(11261);const i=a=>["xs","sm","md","lg","xl","xxl","xxxl"].includes(a),s=()=>Object.keys(t.az);function r(a){return f(a?.type)}function f(a){if(a)switch(a){case n.PU.time:return"clock-nine";case n.PU.string:return"font";case n.PU.number:return"calculator-alt";case n.PU.boolean:return"toggle-on";case n.PU.trace:return"info-circle";case n.PU.enum:return"list-ol";case n.PU.geo:return"map-marker";case n.PU.other:return"brackets-curly"}return"question-circle"}},80186:(G,O,e)=>{"use strict";e.r(O),e.d(O,{CompletionItemKind:()=>r.I,getAvailableIcons:()=>c.GO,getFieldTypeIcon:()=>c.SS,getFieldTypeIconName:()=>c.lV,isIconSize:()=>c.rJ,toIconName:()=>c.Uo});var t=e(64611),n=e.n(t),y={};for(const d in t)d!=="default"&&(y[d]=()=>t[d]);e.d(O,y);var i=e(11866),s=e.n(i),y={};for(const d in i)d!=="default"&&(y[d]=()=>i[d]);e.d(O,y);var r=e(50774),f=e(29621),a=e.n(f),y={};for(const d in f)["default","CompletionItemKind"].indexOf(d)<0&&(y[d]=()=>f[d]);e.d(O,y);var c=e(4025),o=e(19932),h=e.n(o),y={};for(const d in o)["default","CompletionItemKind","getAvailableIcons","getFieldTypeIcon","getFieldTypeIconName","isIconSize","toIconName"].indexOf(d)<0&&(y[d]=()=>o[d]);e.d(O,y);var g=e(72389),l=e.n(g),y={};for(const d in g)["default","CompletionItemKind","getAvailableIcons","getFieldTypeIcon","getFieldTypeIconName","isIconSize","toIconName"].indexOf(d)<0&&(y[d]=()=>g[d]);e.d(O,y);var p=e(65484),m=e.n(p),y={};for(const d in p)["default","CompletionItemKind","getAvailableIcons","getFieldTypeIcon","getFieldTypeIconName","isIconSize","toIconName"].indexOf(d)<0&&(y[d]=()=>p[d]);e.d(O,y)},11866:()=>{"use strict"},65484:()=>{"use strict"},19932:()=>{"use strict"},72389:()=>{"use strict"},64611:()=>{"use strict"},40321:(G,O,e)=>{"use strict";e.d(O,{Q:()=>t});const t=(n,i)=>{n.key==="Tab"||n.altKey||n.ctrlKey||n.metaKey||(n.stopPropagation(),n.key==="Escape"&&i())}},24284:(G,O,e)=>{"use strict";e.d(O,{Ih:()=>v,Mk:()=>r,Tj:()=>g,UJ:()=>h,Xw:()=>f,ct:()=>o,mZ:()=>d,nO:()=>c,sg:()=>y,xj:()=>a});var t=e(2543),n=e.n(t),i=e(84140);const s=4,r="rgba(0, 211, 255, 1)",f="rgba(11, 237, 50, 1)",a="rgba(237, 46, 24, 1)",c="rgba(150, 150, 150, 1)",o="rgba(247, 149, 32, 1)",h=.09,g=["#7EB26D","#EAB839","#6ED0E0","#EF843C","#E24D42","#1F78C1","#BA43A9","#705DA0","#508642","#CCA300","#447EBC","#C15C17","#890F02","#0A437C","#6D1F62","#584477","#B7DBAB","#F4D598","#70DBED","#F9BA8F","#F29191","#82B5D8","#E5A8E2","#AEA2E0","#629E51","#E5AC0E","#64B0C8","#E0752D","#BF1B00","#0A50A1","#962D82","#614D93","#9AC48A","#F2C96D","#65C5DB","#F9934E","#EA6460","#5195CE","#D683CE","#806EB7","#3F6833","#967302","#2F575E","#99440A","#58140C","#052B51","#511749","#3F2B5B","#E0F9D7","#FCEACA","#CFFAFF","#F9E2D2","#FCE2DE","#BADFF4","#F9D9F9","#DEDAF7"];function l(u){const D=(0,t.map)(u,p),P=(0,t.sortBy)(D,["h"]),x=(0,t.chunk)(P,s),E=(0,t.map)(x,M=>(0,t.sortBy)(M,"l")),C=(0,t.flattenDeep)((0,t.zip)(...E));return(0,t.map)(C,m)}function p(u){return(0,i.A)(u).toHsl()}function m(u){return(0,i.A)(u).toHexString()}function y(u){return(0,i.A)(u).getBrightness()>180?"rgb(32, 34, 38)":"rgb(247, 248, 250)"}function d(u,D){const P=(0,i.A)(u),x=P.getBrightness();return P.getAlpha()<.3?D?"rgb(247, 248, 250)":"rgb(32, 34, 38)":x>180?"rgb(32, 34, 38)":"rgb(247, 248, 250)"}let v=l(g)},14555:(G,O,e)=>{"use strict";e.d(O,{F:()=>n,J:()=>t});const t=i=>i().map(s=>({label:s.title,ariaLabel:s.title,url:s.href,target:s.target,icon:`${s.target==="_blank"?"external-link-alt":"link"}`,onClick:s.onClick})),n=i=>/\/explore\?.*&(left|right)=\[(.*\,){2,}(.*){1}\]/.test(i)},40621:(G,O,e)=>{"use strict";e.d(O,{h:()=>t});function t(n,i,s){}},53550:(G,O,e)=>{"use strict";e.d(O,{i:()=>t});function t(n){const s=n.lastIndexOf("."),r=n.substring(s),f=n.substring(0,s);return f.length<16?n:`${f.substring(0,16)}...${r}`}},9830:(G,O,e)=>{"use strict";e.d(O,{I:()=>i});var t=e(2543),n=e.n(t);function i(s,r){let f=0,a=s.indexOf(r);r=r.replace(/\s/g,"");const c=[];if(a!==-1)return{distance:0,found:!0,ranges:[{start:a,end:a+r.length-1}]};for(const o of r){const h=s.indexOf(o,a);if(h===-1)return{distance:1/0,ranges:[],found:!1};if(a!==-1&&(f+=h-a),a=h+1,c.length===0)c.push({start:h,end:h});else{const g=(0,t.last)(c);h===g.end+1?g.end++:c.push({start:h,end:h})}}return{distance:f,ranges:c,found:!0}}},76412:(G,O,e)=>{"use strict";e.d(O,{t:()=>a,x:()=>r});var t=e(74848),n=e(72635),i=e(32389);function s(){typeof n.default.options.resources!="object"&&n.default.use(i.r9).init({resources:{},returnEmptyString:!1,lng:"en-US"})}const r=c=>(s(),(0,t.jsx)(i.x6,{...c})),f=n.default.t,a=(c,o,h)=>(s(),f(c,o,h))},67985:(G,O,e)=>{"use strict";e.d(O,{xj:()=>r.xj,Mk:()=>r.Mk,bk:()=>t,Pw:()=>f.Pw,nO:()=>r.nO,uc:()=>D,Xw:()=>r.Xw,ct:()=>r.ct,UJ:()=>r.UJ,zt:()=>s,yx:()=>a.yx,Tt:()=>y.T,DB:()=>d.DB,hF:()=>u.h,Vr:()=>p.Vr,Tj:()=>r.Tj,h:()=>v.h,It:()=>P.I,Yc:()=>p.Yc,kl:()=>l.k,XJ:()=>g,yC:()=>o.yC,JF:()=>o.JF,MC:()=>o.MC,mZ:()=>r.mZ,sg:()=>r.sg,K:()=>f.K,Fr:()=>c.F,Jl:()=>c.J,dF:()=>a.dF,mO:()=>a.mO,kD:()=>p.kD,RP:()=>f.RP,Ih:()=>r.Ih,CH:()=>m.C,tf:()=>f.tf});var t={};e.r(t),e.d(t,{getNextCharacter:()=>i,getPreviousCousin:()=>n}),typeof window<"u"&&"Element"in window&&!Element.prototype.closest&&(Element.prototype.closest=function(x){const E=(this.document||this.ownerDocument).querySelectorAll(x);let C=this,M;do{for(M=E.length;--M>=0&&E.item(M)!==C;);C=C.parentElement}while(M<0&&C);return C});function n(x,E){let C=x.parentElement.previousSibling,M;for(;C;){if(M=C.querySelector(E),M)return M;C=C.previousSibling}}function i(x){const E=(x||window).getSelection();if(!E||!E.anchorNode)return null;const C=E.getRangeAt(0),M=E.anchorNode.textContent,S=C.startOffset;return M.slice(S,S+1)}var s=e(67892),r=e(24284),f=e(29734),a=e(72307),c=e(14555),o=e(69613);let h=null;function g(){if(h!==null)return h;if(typeof document<"u"){const x=document.createElement("div"),E={width:"100px",height:"100px",position:"absolute",top:"-9999px",overflow:"scroll",MsOverflowStyle:"scrollbar"};Object.keys(E).map(C=>{x.style[C]=E[C]}),document.body.appendChild(x),h=x.offsetWidth-x.clientWidth,document.body.removeChild(x)}else h=0;return h||0}var l=e(90914),p=e(29413),m=e(69731),y=e(75071),d=e(88838),v=e(91040),u=e(40621),D=(x=>(x.id="id",x.title="title",x.subTitle="subTitle",x.mainStat="mainStat",x.secondaryStat="secondaryStat",x.source="source",x.target="target",x.detail="detail__",x.arc="arc__",x.color="color",x))(D||{}),P=e(9830)},87019:(G,O,e)=>{"use strict";e.d(O,{t:()=>n});var t=e(32196);const n=(0,t.keyframes)({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(359deg)"}})},91040:(G,O,e)=>{"use strict";e.d(O,{h:()=>s});var t=e(2543),n=e.n(t);const i=(0,t.throttle)((...r)=>{console.log(...r)},500),s=r=>{let f=!1;return typeof window<"u"&&(f=window.localStorage.getItem("grafana.debug")==="true"),{logger:(a,c=!1,...o)=>{},enable:()=>f=!0,disable:()=>f=!1,isEnabled:()=>f}}},29413:(G,O,e)=>{"use strict";e.d(O,{Vr:()=>a,Yc:()=>r,kD:()=>f});let t;const n=new Map,i=500;let s="";function r(){return t||(t=document.createElement("canvas").getContext("2d")),t}function f(c,o,h=400){const g=`${h} ${o}px 'Inter'`,l=c+g,p=n.get(l);if(p)return p;const m=r();s!==g&&(m.font=s=g);const y=m.measureText(c);return n.size===i&&n.clear(),n.set(l,y),y}function a(c,o,h,g,l,p){const m=f(c,14,p),y=o/(m.width+2)*14,d=h/g,v=Math.min(d,y);return Math.min(v,l??v)}},67892:(G,O,e)=>{"use strict";e.r(O),e.d(O,{getChildId:()=>n,renderOrCallToRender:()=>i});var t=e(96540);function n(s){let r;const f=t.Children.only(s);return"id"in f?.props?r=f.props.id:"inputId"in f.props&&(r=f?.props.inputId),typeof r=="string"?r:void 0}function i(s,r){if(t.isValidElement(s)||typeof s=="string"||typeof s=="number")return s;if(typeof s=="function"&&r)return s(r);throw new Error(`${s} is not a React element nor a function that returns React element`)}},75071:(G,O,e)=>{"use strict";e.d(O,{H:()=>f,T:()=>n});var t=e(9830),n=(a=>(a.Word="Word",a.Prefix="Prefix",a.Fuzzy="Fuzzy",a))(n||{});const f={Word:(a,c)=>a.filter(o=>(o.filterText||o.label).includes(c)),Prefix:(a,c)=>a.filter(o=>(o.filterText||o.label).startsWith(c)),Fuzzy:(a,c)=>(c=c.toLowerCase(),a.filter(o=>{const{distance:h,ranges:g,found:l}=(0,t.I)(o.label.toLowerCase(),c);return l?(o.sortValue=h,o.highlightParts=g,!0):!1}))}},72129:(G,O,e)=>{"use strict";e.d(O,{Q:()=>s,j:()=>r});var t=e(74848),n=e(32196);const s={animationName:(0,n.keyframes)({"0%":{opacity:0},"100%":{opacity:1}}),animationDelay:"100ms",animationTimingFunction:"ease-in",animationDuration:"100ms",animationFillMode:"backwards"},r=(f,a)=>Object.assign(f,{Skeleton:o=>(0,t.jsx)(a,{...o,rootProps:{style:s}})})},72307:(G,O,e)=>{"use strict";e.d(O,{dF:()=>i,mO:()=>s,yx:()=>n});var t=e(82611);const n={document:{nodes:[{match:[{type:"paragraph"},{type:"code_block"},{type:"code_line"}]}]},inlines:{}},i=(r,f)=>{const a=r.split(`
`).map(o=>t.eB.create({type:"code_line",nodes:[t.EY.create(o)]})),c=t.eB.create({data:{syntax:f},type:"code_block",nodes:a});return t.yo.create({nodes:[c]})},s=(r,f)=>{const a=i(r,f);return t.WT.create({document:a})}},90914:(G,O,e)=>{"use strict";e.d(O,{k:()=>t});const t=(n,i)=>{let s;if(n.getLinks&&(s=n.getLinks({valueRowIndex:i.index})),!!s){for(let r=0;r<s?.length;r++)if(s[r].onClick){const f=s[r].onClick;s[r].onClick=a=>{a.ctrlKey||a.metaKey||a.shiftKey||(a.preventDefault(),f(a,{field:n,rowIndex:i.index}))}}return s}}},69613:(G,O,e)=>{"use strict";e.d(O,{JF:()=>i,MC:()=>s,yC:()=>r});const t=["#D32D20","#1E72B8","#B240A2","#705DA0","#466803","#497A3C","#3D71AA","#B15415","#890F02","#6E6E6E","#0A437C","#6D1F62","#584477","#4C7A3F","#2F4F4F","#BF1B00","#7662B1","#8A2EB8","#517A00","#000000","#3F6833","#2F575E","#99440A","#AE561A","#0E4AB4","#58140C","#052B51","#511749","#3F2B5B"],n=["#FF7368","#459EE7","#E069CF","#9683C6","#6C8E29","#76AC68","#6AA4E2","#E7823D","#AF3528","#9B9B9B","#3069A2","#934588","#7E6A9D","#88C477","#557575","#E54126","#A694DD","#B054DE","#8FC426","#262626","#658E59","#557D84","#BF6A30","#FF9B53","#3470DA","#7E3A32","#2B5177","#773D6F","#655181"];function i(c=""){const o=f(c.toLowerCase());return Math.abs(o%t.length)}function s(c=""){const o=i(c);return r(o)}function r(c){return{color:t[c],borderColor:n[c]}}function f(c){let o=5381;for(let h=0;h<c.length;h++)o=(o<<5)+o+c.charCodeAt(h);return o}var a={getTagColorsFromName:s}},18976:(G,O,e)=>{"use strict";e.d(O,{O:()=>n,f:()=>i});var t=e(32196);function n(s){switch(s){case"auto":return"bottom";case"auto-start":return"bottom-start";case"auto-end":return"bottom-end";default:return s??"bottom"}}function i(s,r,f,a,c){return{arrow:(0,t.css)({fill:r}),container:(0,t.css)({backgroundColor:r,borderRadius:s.shape.radius.default,border:`1px solid ${f}`,boxShadow:s.shadows.z2,color:a,fontSize:s.typography.bodySmall.fontSize,padding:s.spacing(c.topBottom,c.rightLeft),[s.transitions.handleMotion("no-preference","reduce")]:{transition:"opacity 0.3s"},zIndex:s.zIndex.tooltip,maxWidth:"400px",overflowWrap:"break-word","&[data-popper-interactive='false']":{pointerEvents:"none"}}),headerClose:(0,t.css)({color:s.colors.text.secondary,position:"absolute",right:s.spacing(1),top:s.spacing(1.5),backgroundColor:"transparent",border:0}),header:(0,t.css)({paddingTop:s.spacing(1),paddingBottom:s.spacing(2)}),body:(0,t.css)({paddingTop:s.spacing(1),paddingBottom:s.spacing(1)}),footer:(0,t.css)({paddingTop:s.spacing(2),paddingBottom:s.spacing(1)})}}},69731:(G,O,e)=>{"use strict";e.d(O,{C:()=>n});var t=e(96540);function n(){const[i,s]=(0,t.useState)(0);return(0,t.useCallback)(()=>s(r=>r+1),[])}},29734:(G,O,e)=>{"use strict";e.d(O,{K:()=>i,Pw:()=>t,RP:()=>s,tf:()=>n});var t=(r=>(r.onBlur="onBlur",r.onFocus="onFocus",r.onChange="onChange",r))(t||{});const n=(r,f)=>{const a=f.reduce((c,o)=>o.rule(r)?c:c.concat(o.errorMessage),[]);return a.length>0?a:null},i=(r,f)=>f&&f[r],s=(r,f)=>({rule:a=>!!a.match(r),errorMessage:f||"Value is not valid"})},91950:(G,O,e)=>{"use strict";e.d(O,{A:()=>i,f:()=>r});var t=e(2543),n=e.n(t);class i{constructor(a){if(this.columns=[],this.columnMap={},this.rows=[],this.type="table",a){if(a.columns)for(const c of a.columns)this.addColumn(c);if(a.rows)for(const c of a.rows)this.addRow(c)}}sort(a){a.col===null||a.col===void 0||this.columns.length<=a.col||(this.rows.sort((c,o)=>(c=c[a.col],o=o[a.col],+(c==null)-+(o==null)||+(c>o)||-(c<o))),a.desc&&this.rows.reverse(),this.columns[a.col].sort=!0,this.columns[a.col].desc=a.desc)}addColumn(a){this.columnMap[a.text]||(this.columns.push(a),this.columnMap[a.text]=a)}addRow(a){this.rows.push(a)}}function s(f,a,c){let o=!1;for(let h=0;h<f.length;h++)if(a[h]!==void 0&&c[h]!==void 0){if(a[h]!==c[h])return!1}else(a[h]===void 0||c[h]===void 0)&&(o=!0);return o}function r(f,...a){const c=f||new i;if(arguments.length===1)return c;if(arguments.length===2)return c.columns=a[0].hasOwnProperty("columns")?[...a[0].columns]:[],c.rows=a[0].hasOwnProperty("rows")?[...a[0].rows]:[],c;const o=a.filter(d=>!!d.columns),h={},g=o.slice().reduce((d,v)=>(v.columns.forEach(u=>{const{text:D}=u;h[D]===void 0&&(h[D]=d.length,d.push(u))}),d),[]),l=o.map(d=>d.columns.map(v=>h[v.text])),p=o.reduce((d,v,u)=>{const D=l[u];return v.rows.forEach(P=>{const x=[];D.forEach((E,C)=>{x[E]=P[C]}),d.push(x)}),d},[]),m={},y=p.reduce((d,v,u)=>{if(!m[u]){let D=u+1;for(;D<p.length;){const P=(0,t.findIndex)(p,x=>s(g,v,x),D);if(P>-1){const x=p[P];for(let E=0;E<g.length;E++)v[E]===void 0&&x[E]!==void 0&&(v[E]=x[E]);m[P]=x,D=P+1}else break}d.push(v)}return d},[]);return c.columns=g,c.rows=y,c}},97007:(G,O,e)=>{"use strict";e.d(O,{N:()=>n});var t=e(65307);const n=(0,t.VP)("core/cleanUpState")},82467:(G,O,e)=>{"use strict";e.d(O,{Do:()=>t.Do,Vz:()=>n.Vz,YA:()=>n.YA,dx:()=>t.dx});var t=e(16001),n=e(28215)},28138:(G,O,e)=>{"use strict";e.d(O,{A:()=>i,l:()=>n});var t=e(18226);const n=new t.o,i=n},5108:(G,O,e)=>{"use strict";e.d(O,{x:()=>N});var t=e(74848),n=e(32196),i=e(2543),s=e(96540),r=e(40845),f=e(68402),a=e(90613),c=e(94753),o=e(55852),h=e(9025),g=e(8484),l=e(27677),p=e(43907),m=e(67061),y=e(90182),d=e(25469),v=e(17172);class u extends s.Component{constructor(se){super(se),this.state={isLoading:!1},this.search=this.search.bind(this),this.debouncedSearch=(0,i.debounce)(this.search,300,{leading:!0,trailing:!0})}search(se){return this.setState({isLoading:!0}),(0,i.isNil)(se)&&(se=""),(0,v.AI)().get("/api/serviceaccounts/search").then(j=>j.serviceAccounts.map(q=>({id:q.id,value:q.id,label:q.login,imgUrl:q.avatarUrl,login:q.login}))).finally(()=>{this.setState({isLoading:!1})})}render(){const{className:se,onSelected:j,inputId:q}=this.props,{isLoading:ne}=this.state;return(0,t.jsx)("div",{className:"service-account-picker","data-testid":"serviceAccountPicker",children:(0,t.jsx)(y.DW,{isClearable:!0,className:se,inputId:q,isLoading:ne,defaultOptions:!0,loadOptions:this.debouncedSearch,onChange:j,placeholder:"Start typing to search for service accounts",noOptionsMessage:"No service accounts found","aria-label":"Service Account picker"})})}}class D extends s.Component{constructor(se){super(se),this.state={isLoading:!1},this.search=this.search.bind(this),this.debouncedSearch=(0,i.debounce)(this.search,300,{leading:!0,trailing:!0})}componentDidMount(){const{teamId:se}=this.props;se&&(0,v.AI)().get(`/api/teams/${se}`).then(j=>{this.setState({value:{value:j,label:j.name,imgUrl:j.avatarUrl}})})}search(se){return this.setState({isLoading:!0}),(0,i.isNil)(se)&&(se=""),(0,v.AI)().get(`/api/teams/search?perpage=100&page=1&query=${se}`).then(j=>{const q=j.teams.map(ne=>({value:ne,label:ne.name,imgUrl:ne.avatarUrl}));return this.setState({isLoading:!1}),q})}render(){const{onSelected:se,className:j}=this.props,{isLoading:q,value:ne}=this.state;return(0,t.jsx)("div",{className:"user-picker","data-testid":"teamPicker",children:(0,t.jsx)(y.DW,{isLoading:q,defaultOptions:!0,loadOptions:this.debouncedSearch,value:ne,onChange:se,className:j,placeholder:"Select a team",noOptionsMessage:"No teams found","aria-label":"Team picker"})})}}class P extends s.Component{constructor(se){super(se),this.state={isLoading:!1},this.search=this.search.bind(this),this.debouncedSearch=(0,i.debounce)(this.search,300,{leading:!0,trailing:!0})}search(se){return this.setState({isLoading:!0}),(0,i.isNil)(se)&&(se=""),(0,v.AI)().get(`/api/org/users/lookup?query=${se}&limit=100`).then(j=>j.map(q=>({id:q.userId,value:q.userId,label:q.login,imgUrl:q.avatarUrl,login:q.login}))).finally(()=>{this.setState({isLoading:!1})})}render(){const{className:se,onSelected:j,inputId:q}=this.props,{isLoading:ne}=this.state;return(0,t.jsx)("div",{className:"user-picker","data-testid":"userPicker",children:(0,t.jsx)(y.DW,{isClearable:!0,className:se,inputId:q,isLoading:ne,defaultOptions:!0,loadOptions:this.debouncedSearch,onChange:j,placeholder:"Start typing to search for user",noOptionsMessage:"No users found","aria-label":"User picker"})})}}var x=e(24897),E=(Z=>(Z.None="None",Z.Team="Team",Z.User="User",Z.ServiceAccount="ServiceAccount",Z.BuiltInRole="builtInRole",Z))(E||{});const C=({title:Z=(0,g.t)("access-control.add-permission.title","Add permission for"),permissions:se,assignments:j,onAdd:q,onCancel:ne})=>{const[oe,z]=(0,s.useState)(E.None),[te,le]=(0,s.useState)(0),[ie,ae]=(0,s.useState)(0),[re,ce]=(0,s.useState)(""),[me,ee]=(0,s.useState)(""),de=(0,s.useMemo)(()=>{const fe=[];return j.users&&fe.push({value:E.User,label:(0,g.t)("access-control.add-permission.user-label","User")}),j.serviceAccounts&&fe.push({value:E.ServiceAccount,label:(0,g.t)("access-control.add-permission.serviceaccount-label","Service Account")}),j.teams&&fe.push({value:E.Team,label:(0,g.t)("access-control.add-permission.team-label","Team")}),j.builtInRoles&&fe.push({value:E.BuiltInRole,label:(0,g.t)("access-control.add-permission.role-label","Role")}),fe},[j]);(0,s.useEffect)(()=>{se.length>0&&ee(se[0])},[se]);const De=()=>oe===E.Team&&te>0||oe===E.User&&ie>0||oe===E.ServiceAccount&&ie>0||E.BuiltInRole&&x.XT.hasOwnProperty(re);return(0,t.jsxs)("div",{className:"cta-form","aria-label":"Permissions slider",children:[(0,t.jsx)(d.J,{onClick:ne}),(0,t.jsx)("h5",{children:Z}),(0,t.jsx)("form",{name:"addPermission",onSubmit:fe=>{fe.preventDefault(),q({userId:ie,teamId:te,builtInRole:re,permission:me,target:oe})},children:(0,t.jsxs)(m.B,{gap:1,direction:"row",children:[(0,t.jsx)(y.l6,{"aria-label":"Role to add new permission to",value:oe,options:de,onChange:fe=>z(fe.value),disabled:de.length===0,width:"auto"}),oe===E.User&&(0,t.jsx)(P,{onSelected:fe=>ae(fe?.value||0)}),oe===E.ServiceAccount&&(0,t.jsx)(u,{onSelected:fe=>ae(fe?.value||0)}),oe===E.Team&&(0,t.jsx)(D,{onSelected:fe=>le(fe.value?.id||0)}),oe===E.BuiltInRole&&(0,t.jsx)(y.l6,{"aria-label":"Built-in role picker",options:Object.values(x.XT).filter(fe=>fe!==x.XT.None).map(fe=>({value:fe,label:fe})),onChange:fe=>ce(fe.value||""),width:"auto"}),(0,t.jsx)(y.l6,{"aria-label":"Permission Level",width:"auto",value:se.find(fe=>fe===me),options:se.map(fe=>({label:fe,value:fe})),onChange:fe=>ee(fe.value||"")}),(0,t.jsx)(o.$n,{type:"submit",disabled:!De(),children:(0,t.jsx)(g.x6,{i18nKey:"access-control.add-permissions.save",children:"Save"})})]})})]})};var M=e(56034),S=e(14578);const I=({item:Z,permissionLevels:se,canSet:j,onRemove:q,onChange:ne})=>{const oe=(0,r.of)(L);return(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:T(Z)}),(0,t.jsx)("td",{children:R(Z)}),(0,t.jsx)("td",{children:Z.isInherited&&(0,t.jsx)("em",{className:oe.inherited,children:"Inherited from folder"})}),(0,t.jsx)("td",{children:(0,t.jsx)(y.l6,{disabled:!j||!Z.isManaged,onChange:z=>ne(Z,z.value),value:se.find(z=>z===Z.permission),options:se.map(z=>({value:z,label:z}))})}),(0,t.jsx)("td",{children:Z.warning?(0,t.jsx)(M.m,{content:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.a,{marginBottom:1,children:Z.warning}),A(Z)]}),children:(0,t.jsx)(S.I,{name:"exclamation-triangle",className:oe.warning})}):(0,t.jsx)(M.m,{content:A(Z),children:(0,t.jsx)(S.I,{name:"info-circle"})})}),(0,t.jsx)("td",{children:Z.isManaged?(0,t.jsx)(o.$n,{size:"sm",icon:"times",variant:"destructive",disabled:!j,onClick:()=>q(Z),"aria-label":`Remove permission for ${b(Z)}`}):(0,t.jsx)(M.m,{content:Z.isInherited?"Inherited Permission":"Provisioned Permission",children:(0,t.jsx)(o.$n,{size:"sm",icon:"lock","aria-label":"Locked permission indicator"})})})]})},T=Z=>Z.teamId?(0,t.jsx)("img",{className:"filter-table__avatar",src:Z.teamAvatarUrl,alt:`Avatar for team ${Z.teamId}`}):Z.userId?(0,t.jsx)("img",{className:"filter-table__avatar",src:Z.userAvatarUrl,alt:`Avatar for user ${Z.userId}`}):(0,t.jsx)(S.I,{size:"xl",name:"shield"}),b=Z=>Z.userId?Z.userLogin:Z.teamId?Z.team:Z.builtInRole,R=Z=>Z.userId?(0,t.jsxs)("span",{children:[Z.userLogin," "]},"name"):Z.teamId?(0,t.jsxs)("span",{children:[Z.team," "]},"name"):Z.builtInRole?(0,t.jsxs)("span",{children:[Z.builtInRole," "]},"name"):(0,t.jsx)("span",{},"name"),A=Z=>`Actions: ${[...new Set(Z.actions)].sort().join(" ")}`,L=Z=>({warning:(0,n.css)({color:Z.colors.warning.main}),inherited:(0,n.css)({color:Z.colors.text.secondary,flexWrap:"nowrap"})}),U=({title:Z,items:se,compareKey:j,permissionLevels:q,canSet:ne,onRemove:oe,onChange:z})=>{const te=(0,s.useMemo)(()=>{const le={};for(let ie of se){const ae=ie[j];if(!le[ae]){le[ae]=ie;continue}if(ie.actions.length>le[ae].actions.length){le[ae]=ie;continue}ie.actions.length===le[ae].actions.length&&!ie.isInherited&&(le[ae]=ie)}return Object.keys(le).map(ie=>le[ie])},[se,j]);return te.length===0?null:(0,t.jsx)("div",{children:(0,t.jsxs)("table",{className:"filter-table gf-form-group",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{style:{width:"1%"}}),(0,t.jsx)("th",{children:Z}),(0,t.jsx)("th",{style:{width:"1%"}}),(0,t.jsx)("th",{style:{width:"40%"},children:(0,t.jsx)(g.x6,{i18nKey:"access-control.permission-list.permission",children:"Permission"})}),(0,t.jsx)("th",{style:{width:"1%"}}),(0,t.jsx)("th",{style:{width:"1%"}})]})}),(0,t.jsx)("tbody",{children:te.map((le,ie)=>(0,t.jsx)(I,{item:le,onRemove:oe,onChange:z,canSet:ne,permissionLevels:q},`${ie}-${le.userId}`))})]})})},W="",w={permissions:[],assignments:{teams:!1,users:!1,serviceAccounts:!1,builtInRoles:!1}},N=({title:Z=(0,g.t)("access-control.permissions.title","Permissions"),buttonLabel:se=(0,g.t)("access-control.permissions.add-label","Add a permission"),emptyLabel:j=(0,g.t)("access-control.permissions.no-permissions","There are no permissions"),resource:q,resourceId:ne,canSetPermissions:oe,addPermissionTitle:z,getWarnings:te,epilogue:le})=>{const ie=(0,r.of)(Y),[ae,re]=(0,s.useState)(!1),[ce,me]=(0,s.useState)([]),[ee,de]=(0,s.useState)(w),De=(0,s.useCallback)(async()=>{let Je=await V(q,ne);te&&(Je=te(Je)),me(Je)},[q,ne,te]);(0,s.useEffect)(()=>{B(q).then(Je=>(de(Je),De()))},[q,ne,De]);const fe=Je=>{let st=null;Je.target===E.User||Je.target===E.ServiceAccount?st=K(q,ne,Je.userId,Je.permission):Je.target===E.Team?st=H(q,ne,Je.teamId,Je.permission):Je.target===E.BuiltInRole&&(st=X(q,ne,Je.builtInRole,Je.permission)),st!==null&&st.then(De)},Te=Je=>{let st=null;Je.userId?st=K(q,ne,Je.userId,W):Je.teamId?st=H(q,ne,Je.teamId,W):Je.isServiceAccount&&Je.userId?st=K(q,ne,Je.userId,W):Je.builtInRole&&(st=X(q,ne,Je.builtInRole,W)),st!==null&&st.then(De)},je=(Je,st)=>{Je.permission!==st&&(Je.userId?fe({permission:st,userId:Je.userId,target:E.User}):Je.isServiceAccount?fe({permission:st,userId:Je.userId,target:E.User}):Je.teamId?fe({permission:st,teamId:Je.teamId,target:E.Team}):Je.builtInRole&&fe({permission:st,builtInRole:Je.builtInRole,target:E.BuiltInRole}))},He=(0,s.useMemo)(()=>(0,i.sortBy)(ce.filter(Je=>Je.teamId),["team","isManaged"]),[ce]),Be=(0,s.useMemo)(()=>(0,i.sortBy)(ce.filter(Je=>Je.userId&&!Je.isServiceAccount),["userLogin","isManaged"]),[ce]),Ne=(0,s.useMemo)(()=>(0,i.sortBy)(ce.filter(Je=>Je.userId&&Je.isServiceAccount),["userLogin","isManaged"]),[ce]),Re=(0,s.useMemo)(()=>(0,i.sortBy)(ce.filter(Je=>Je.builtInRole),["builtInRole","isManaged"]),[ce]),Se=(0,g.t)("access-control.permissions.role","Role"),We=(0,g.t)("access-control.permissions.user","User"),Ke=(0,g.t)("access-control.permissions.serviceaccount","Service Account"),Xe=(0,g.t)("access-control.permissions.team","Team");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[oe&&q==="folders"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.x6,{i18nKey:"access-control.permissions.permissions-change-warning",children:"This will change permissions for this folder and all its descendants. In total, this will affect:"}),(0,t.jsx)(p.x,{selectedItems:{folder:{[ne]:!0},dashboard:{},panel:{},$all:!1}}),(0,t.jsx)(f.$,{v:2})]}),ce.length===0&&(0,t.jsx)(a.a,{children:(0,t.jsx)(c.E,{children:j})}),(0,t.jsx)(U,{title:Se,items:Re,compareKey:"builtInRole",permissionLevels:ee.permissions,onChange:je,onRemove:Te,canSet:oe}),(0,t.jsx)(U,{title:We,items:Be,compareKey:"userLogin",permissionLevels:ee.permissions,onChange:je,onRemove:Te,canSet:oe}),(0,t.jsx)(U,{title:Ke,items:Ne,compareKey:"userLogin",permissionLevels:ee.permissions,onChange:je,onRemove:Te,canSet:oe}),(0,t.jsx)(U,{title:Xe,items:He,compareKey:"team",permissionLevels:ee.permissions,onChange:je,onRemove:Te,canSet:oe}),oe&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.$n,{className:ie.addPermissionButton,variant:"primary",onClick:()=>re(!0),icon:"plus",children:se},"add-permission"),(0,t.jsx)(h.a,{in:ae,children:(0,t.jsx)(C,{title:z,onAdd:fe,permissions:ee.permissions,assignments:ee.assignments,onCancel:()=>re(!1)})})]})]}),le&&le(ce)]})},B=async Z=>{try{return await(0,l.AI)().get(`/api/access-control/${Z}/description`)}catch(se){return console.error("failed to load resource description: ",se),w}},V=(Z,se)=>(0,l.AI)().get(`/api/access-control/${Z}/${se}`),K=(Z,se,j,q)=>k(Z,se,"users",j,q),H=(Z,se,j,q)=>k(Z,se,"teams",j,q),X=(Z,se,j,q)=>k(Z,se,"builtInRoles",j,q),k=(Z,se,j,q,ne)=>(0,l.AI)().post(`/api/access-control/${Z}/${se}/${j}/${q}`,{permission:ne}),Y=Z=>({breakdown:(0,n.css)({...Z.typography.bodySmall,color:Z.colors.text.secondary,marginBottom:Z.spacing(2)}),addPermissionButton:(0,n.css)({marginBottom:Z.spacing(2)})})},9025:(G,O,e)=>{"use strict";e.d(O,{a:()=>a});var t=e(74848),n=e(96540),i=e(22669);const s="200px",r=200,f={transition:`max-height ${r}ms ease-in-out`,overflow:"hidden"},a=({children:c,in:o,maxHeight:h=s,style:g=f})=>{const l=(0,n.useRef)(null),p={exited:{maxHeight:0},entering:{maxHeight:h},entered:{maxHeight:"unset",overflow:"visible"},exiting:{maxHeight:0}};return(0,t.jsx)(i.Ay,{in:o,timeout:r,nodeRef:l,children:m=>(0,t.jsx)("div",{style:{...g,...p[m]},ref:l,children:c})})}},75269:(G,O,e)=>{"use strict";e.d(O,{H:()=>i});var t=e(96540),n=e(76888);const i=t.memo(({actions:s})=>{const{chrome:r}=(0,n.Il)();return(0,t.useLayoutEffect)(()=>{r.update({actions:s})}),null});i.displayName="TopNavUpdate"},10804:(G,O,e)=>{"use strict";e.d(O,{K:()=>s});var t=e(74848),n=e(32196),i=e(40845);function s({className:f,leftActionsSeparator:a}){const c=(0,i.of)(r);return a?(0,t.jsx)("div",{className:(0,n.cx)(f,c.leftActionsSeparator)}):(0,t.jsx)("div",{className:(0,n.cx)(f,c.line)})}const r=f=>({leftActionsSeparator:(0,n.css)({display:"flex",flexGrow:1}),line:(0,n.css)({width:1,backgroundColor:f.colors.border.medium,height:24})})},57571:(G,O,e)=>{"use strict";e.d(O,{l:()=>t});const t=40},19361:(G,O,e)=>{"use strict";e.d(O,{M:()=>o});var t=e(74848),n=e(32196),i=e(23596),s=e(40845);const r=({className:h,logo:g})=>(0,t.jsx)("img",{className:h,src:`${g||"public/img/grafana_icon.svg"}`,alt:"SyncLab"}),f=({className:h,children:g})=>{const l=(0,s.$j)(),p=(0,n.css)({"&:before":{content:'""',position:"fixed",left:0,right:0,bottom:0,top:0,background:`url(public/img/g8_login_${l.isDark?"dark":"light"}.svg)`,backgroundPosition:"top center",backgroundSize:"auto",backgroundRepeat:"no-repeat",opacity:0,transition:"opacity 3s ease-in-out",[l.breakpoints.up("md")]:{backgroundPosition:"center",backgroundSize:"cover"}}});return(0,t.jsx)("div",{className:(0,n.cx)(p,h),children:g})},a=({className:h})=>(0,t.jsx)("img",{className:h,src:"public/img/grafana_icon.svg",alt:"SyncLab"}),c=()=>{const h=(0,s.$j)();return(0,n.css)({background:i.MV.alpha(h.colors.background.primary,.7),backgroundSize:"cover"})};class o{static{this.LoginLogo=r}static{this.LoginBackground=f}static{this.MenuLogo=a}static{this.LoginBoxBackground=c}static{this.AppTitle="SyncCity"}static{this.LoginTitle="SyncCity by SyncLab"}static{this.LoginSubtitle="Smart city monitoring platform"}static{this.HideEdition=!0}static{this.GetLoginSubTitle=()=>null}}},3984:(G,O,e)=>{"use strict";e.d(O,{Z:()=>t});function t(n,i,s){const r=[];let f=!1,a;function c(o,h=!1){if(f)return;const g=o.url?.split("?")??["",""];let l=g[0];const p=new URLSearchParams(g[1]);if(p.has("editview")&&(l+=`?editview=${p.get("editview")}`),s&&l===s.url){r.unshift({text:s.text,href:o.url??""}),f=!0;return}const m=l.length>0&&a===l;if(a=l,!o.hideFromBreadcrumbs&&!(h&&m)){const d=o.children?.findIndex(v=>v.active)??-1;if(d>0){const v=o.children?.[d];v&&r.unshift({text:v.text,href:v.url??""})}r.unshift({text:o.text,href:o.url??""})}o.parentItem&&c(o.parentItem)}return i&&c(i),c(n,!0),r}},25469:(G,O,e)=>{"use strict";e.d(O,{J:()=>r});var t=e(74848),n=e(32196),i=e(40845),s=e(29158);const r=({onClick:a,"aria-label":c,style:o})=>{const h=(0,i.of)(f);return(0,t.jsx)(s.K,{"aria-label":c??"Close",className:h,name:"times",onClick:a,style:o,tooltip:"Close"})},f=a=>(0,n.css)({position:"absolute",right:a.spacing(.5),top:a.spacing(1)})},27921:(G,O,e)=>{"use strict";e.d(O,{A:()=>n});var t=e(96540);const n=i=>(0,t.lazy)(i)},38645:(G,O,e)=>{"use strict";e.d(O,{Dd:()=>c,wi:()=>l});var t=e(74848),n=e(32196),i=e(96540),s=e(32264),r=e(40845),f=e(14578),a=e(8484);let c=()=>[{target:"_blank",id:"documentation",text:(0,a.t)("nav.help/documentation","Documentation"),icon:"document-info",url:"https://grafana.com/docs/grafana/latest/?utm_source=grafana_footer"},{target:"_blank",id:"support",text:(0,a.t)("nav.help/support","Support"),icon:"question-circle",url:"https://grafana.com/products/enterprise/?utm_source=grafana_footer"},{target:"_blank",id:"community",text:(0,a.t)("nav.help/community","Community"),icon:"comments-alt",url:"https://community.grafana.com/?utm_source=grafana_footer"}];function o(y){return{hasReleaseNotes:!0,isBeta:y.includes("-beta")}}function h(y){const{buildInfo:d,licenseInfo:v}=s.$,u=[],D=v.stateInfo?` (${v.stateInfo})`:"";if(y||u.push({target:"_blank",id:"license",text:`${d.edition}${D}`,url:v.licenseUrl}),d.hideVersion)return u;const{hasReleaseNotes:P}=o(d.version);return u.push({target:"_blank",id:"version",text:d.versionString,url:P?"https://github.com/grafana/grafana/blob/main/CHANGELOG.md":void 0}),d.hasUpdate&&u.push({target:"_blank",id:"updateVersion",text:"New version available!",icon:"download-alt",url:"https://grafana.com/grafana/download?utm_source=grafana_footer"}),u}function g(y){c=y}const l=(0,i.memo)(({customLinks:y,hideEdition:d})=>{const v=(y||c()).concat(h(d)),u=(0,r.of)(m);return(0,t.jsx)("footer",{className:u.footer,children:(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)("ul",{className:u.list,children:v.map((D,P)=>(0,t.jsx)("li",{className:u.listItem,children:(0,t.jsx)(p,{item:D})},P))})})})});l.displayName="Footer";function p({item:y}){const d=y.url?(0,t.jsx)("a",{href:y.url,target:y.target,rel:"noopener noreferrer",id:y.id,children:y.text}):y.text;return(0,t.jsxs)(t.Fragment,{children:[y.icon&&(0,t.jsx)(f.I,{name:y.icon})," ",d]})}const m=y=>({footer:(0,n.css)({...y.typography.bodySmall,color:y.colors.text.primary,display:"block",padding:y.spacing(2,0),position:"relative",width:"98%","a:hover":{color:y.colors.text.maxContrast,textDecoration:"underline"},[y.breakpoints.down("md")]:{display:"none"}}),list:(0,n.css)({listStyle:"none"}),listItem:(0,n.css)({display:"inline-block","&:after":{content:"' | '",padding:y.spacing(0,1)},"&:last-child:after":{content:"''",paddingLeft:0}})})},53153:(G,O,e)=>{"use strict";e.d(O,{S:()=>y});var t=e(74848),n=e(96540),i=e(49785),s=e(13544),r=e(32264),f=e(40845),a=e(42418),c=e(88575),o=e(67061),h=e(55852),g=e(56034),l=e(4691),p=e(78361),m=e(35043);const y=({onSubmit:d,onSkip:v,showDefaultPasswordWarning:u})=>{const D=(0,f.of)(l.$),[P,x]=(0,n.useState)(!1),[E,C]=(0,n.useState)(!0),{handleSubmit:M,register:S,getValues:I,formState:{errors:T},watch:b}=(0,i.mN)({defaultValues:{newPassword:"",confirmNew:""}}),R=b("newPassword"),A=L=>{d(L.newPassword)};return(0,t.jsxs)("form",{onSubmit:M(A),children:[u&&(0,t.jsx)(a.F,{severity:"info",title:"Continuing to use the default password exposes you to security risks."}),(0,t.jsx)(c.D,{label:"New password",invalid:!!T.newPassword,error:T?.newPassword?.message,children:(0,t.jsx)(p.s,{onFocus:()=>x(!0),...S("newPassword",{required:"New Password is required",onBlur:()=>C(!1),validate:{strongPasswordValidationRegister:m.DP}}),id:"new-password",autoFocus:!0,autoComplete:"new-password"})}),P&&(0,t.jsx)(m.zJ,{pristine:E,password:R,strongPasswordValidations:m.NQ}),(0,t.jsx)(c.D,{label:"Confirm new password",invalid:!!T.confirmNew,error:T?.confirmNew?.message,children:(0,t.jsx)(p.s,{...S("confirmNew",{required:"Confirmed Password is required",validate:L=>L===I().newPassword||"Passwords must match!"}),id:"confirm-new-password",autoComplete:"new-password"})}),(0,t.jsxs)(o.B,{direction:"column",children:[(0,t.jsx)(h.$n,{type:"submit",className:D.submitButton,children:"Submit"}),!r.$.auth.basicAuthStrongPasswordPolicy&&v&&(0,t.jsx)(g.m,{content:"If you skip you will be prompted to change password next time you log in.",placement:"bottom",children:(0,t.jsx)(h.$n,{className:D.skipButton,fill:"text",onClick:v,type:"button","data-testid":s.Tp.pages.Login.skip,children:"Skip"})})]})]})}},72235:(G,O,e)=>{"use strict";e.d(O,{l:()=>r});var t=e(74848),n=e(32196),i=e(96540),s=e(49785);function r({defaultValues:f,onSubmit:a,validateOnMount:c=!1,validateFieldsOnMount:o,children:h,validateOn:g="onSubmit",maxWidth:l=600,...p}){const{handleSubmit:m,trigger:y,formState:d,...v}=(0,s.mN)({mode:g,defaultValues:f});return(0,i.useEffect)(()=>{c&&y(o)},[y,o,c]),(0,t.jsx)("form",{className:(0,n.css)({maxWidth:l!=="none"?l+"px":l,width:"100%"}),onSubmit:m(a),...p,children:h({errors:d.errors,formState:d,trigger:y,...v})})}},30249:(G,O,e)=>{"use strict";e.d(O,{o:()=>p});var t=e(74848),n=e(96540),i=e(85200),s=e(1173),r=e(11261),f=e(90708),a=e(67266),c=e(81297),o=e(16895),h=e(40458);function g(m,y,d=[]){for(const v of d)if(typeof v=="function"){if(!v(m,y))return!1}else if(y[v]!==m[v])return!1;return!0}const l={x:i.sJ.get(s.Ct.firstTimeField).get({}),y:i.sJ.get(s.Ct.byTypes).get(new Set([r.PU.number,r.PU.enum]))};class p extends n.Component{constructor(y){super(y),this.getTimeRange=()=>this.props.timeRange;let d=this.prepState(y);d.alignedData=d.config.prepData([d.alignedFrame]),this.state=d,this.plotInstance=n.createRef()}prepState(y,d=!0){let v=null;const{frames:u,fields:D=l,preparePlotFrame:P,replaceVariables:x,dataLinkPostProcessor:E}=y,C=P??h.m,M=u.some(I=>I.fields.some(T=>(T.config.links?.length??0)>0)),S=C(u,{...D,y:M?()=>!0:D.y},y.timeRange);if((0,o.uY)("GraphNG",!1,"data aligned",S),S){let I=S;if(M){const b=Array.isArray(this.props.timeZone)?this.props.timeZone[0]:this.props.timeZone;S.fields.forEach(R=>{R.getLinks=(0,f._M)(S,R,{...R.state?.scopedVars,__dataContext:{value:{data:[S],field:R,frame:S,frameIndex:0}}},x,b,E)}),I={...S,fields:S.fields.filter((R,A)=>A===0||D.y(R,S,[S]))}}let T=this.state?.config;d&&(T=y.prepConfig(I,this.props.frames,this.getTimeRange),(0,o.uY)("GraphNG",!1,"config prepared",T)),v={alignedFrame:I,config:T},(0,o.uY)("GraphNG",!1,"data prepared",v.alignedData)}return v}componentDidUpdate(y){const{frames:d,structureRev:v,timeZone:u,cursorSync:D,propsToDiff:P}=this.props,x=!g(y,this.props,P);if(d!==y.frames||x||u!==y.timeZone||D!==y.cursorSync){let E=this.prepState(this.props,!1);E&&((this.state.config===void 0||u!==y.timeZone||D!==y.cursorSync||v!==y.structureRev||!v||x)&&(E.config=this.props.prepConfig(E.alignedFrame,this.props.frames,this.getTimeRange),(0,o.uY)("GraphNG",!1,"config recreated",E.config)),E.alignedData=E.config.prepData([E.alignedFrame]),this.setState(E))}}render(){const{width:y,height:d,children:v,renderLegend:u}=this.props,{config:D,alignedFrame:P,alignedData:x}=this.state;return D?(0,t.jsx)(a.KU,{width:y,height:d,legend:u(D),children:(E,C)=>(0,t.jsx)(c.Z,{config:D,data:x,width:E,height:C,plotRef:M=>this.plotInstance.current=M,children:v?v(D,P):null})}):null}}},40458:(G,O,e)=>{"use strict";e.d(O,{m:()=>o});var t=e(11261),n=e(73060),i=e(46294);function s(h,g,l){let p,m;for(let y=0;y<g.length;y++)if(g[y]==null)m==null&&p!=null&&(m=y);else{if(m!=null&&p!=null){if(h[y]-p<l)for(;m<y;)g[m++]=void 0;m=null}p=h[y]}return g}var r=e(52622);function f(h){return h.type===t.PU.number&&h.config.custom?.drawStyle===r.GR.Bars&&!h.config.custom?.hideFrom?.viz}function a(h,g){return h.fields.find(l=>g!=null?l.name===g:l.type===t.PU.time)}function c(h,g){const l=a(h,g);let p=l?.values;for(let m=0;m<h.fields.length;m++){let y=h.fields[m];if(y===l||f(y))continue;let d=y.config.custom?.spanNulls;typeof d=="number"&&d!==-1&&p&&(y.values=s(p,y.values,d))}return h}function o(h,g,l){let p;e:for(let v of h)for(let u of v.fields)if(g.x(u,v,h)){p=u;break e}h=h.map(v=>p?.state?.nullThresholdApplied?v:(0,i.M)({frame:v,refFieldName:p.name,refFieldPseudoMin:l?.from.valueOf(),refFieldPseudoMax:l?.to.valueOf()}));let m=h.reduce((v,u)=>v+u.fields.reduce((D,P)=>D+(f(P)?1:0),0),0),y=1/0;m>1&&h.forEach(v=>{if(!v.fields.some(f))return;const u=p.values;for(let D=0;D<u.length;D++)D>0&&(y=Math.min(y,u[D]-u[D-1]))});let d=(0,n.Fd)({frames:h,joinBy:g.x,keep:g.y,keepOriginIndices:!0,keepDisplayNames:!0,nullMode:v=>{if(f(v))return n.WO;let u=v.config.custom?.spanNulls;return u===!0?n.RC:u===-1?n.WO:n.JI}});return d?(d=c(d,p.name),y!==1/0&&(d.fields.forEach((v,u)=>{let D=v.values;if(u===0){let P=D[D.length-1];D.push(P+y,P+2*y)}else f(v)?D.push(null,null):D.push(void 0,void 0)}),d.length+=2),d):null}},18759:(G,O,e)=>{"use strict";e.d(O,{T:()=>r});var t=e(74848),n=e(32196),i=e(40845),s=e(16795);function r({children:a,spacing:c,level:o}){const h=(0,i.of)(f,c,o);return(0,t.jsx)("span",{className:(0,n.css)(h.indentor),children:a})}const f=(a,c,o)=>({indentor:(0,n.css)((0,s.Y)(a,c,h=>({paddingLeft:a.spacing(h*o)})))})},61680:(G,O,e)=>{"use strict";e.d(O,{b:()=>s});var t=e(74848),n=e(96540),i=e(33390);const s=r=>{const{children:f,storageKey:a,defaultValue:c}=r,[o,h]=(0,n.useState)({value:i.A.getObject(r.storageKey,r.defaultValue)});(0,n.useEffect)(()=>{const p=m=>{m.key===a&&h({value:i.A.getObject(r.storageKey,r.defaultValue)})};return window.addEventListener("storage",p),()=>{window.removeEventListener("storage",p)}});const g=p=>{try{i.A.setObject(a,p)}catch(m){console.error(m)}h({value:p})},l=()=>{try{i.A.delete(a)}catch(p){console.log(p)}h({value:c})};return(0,t.jsx)(t.Fragment,{children:f(o.value,g,l)})}},87570:(G,O,e)=>{"use strict";e.d(O,{A:()=>c});var t=e(74848),n=e(96540),i=e(17172),s=e(2913),r=e(8484);const f=()=>!!s.Ay.oauth&&Object.keys(s.Ay.oauth).length>0;class a extends n.PureComponent{constructor(g){super(g),this.changePassword=l=>{const p={newPassword:l,confirmNew:l,oldPassword:"admin"};if(this.props.resetCode){const m={code:this.props.resetCode,newPassword:l,confirmPassword:l};(0,i.AI)().post("/api/user/password/reset",m).then(()=>{this.toGrafana()})}else(0,i.AI)().put("/api/user/password",p).then(()=>{this.toGrafana()}).catch(m=>console.error(m))},this.login=l=>{this.setState({loginErrorMessage:void 0,isLoggingIn:!0}),(0,i.AI)().post("/login",l,{showErrorAlert:!1}).then(p=>{if(this.result=p,l.password!=="admin"||s.Ay.ldapEnabled||s.Ay.authProxyEnabled){this.toGrafana();return}else this.changeView(l.password==="admin")}).catch(p=>{const m=(0,i.NF)(p)?o(p):void 0;this.setState({isLoggingIn:!1,loginErrorMessage:m||(0,r.t)("login.error.unknown","Unknown error occurred")})})},this.changeView=l=>{this.setState({isChangingPassword:!0,showDefaultPasswordWarning:l})},this.toGrafana=()=>{this.result?.redirectUrl?s.Ay.appSubUrl!==""&&!this.result.redirectUrl.startsWith(s.Ay.appSubUrl)?window.location.assign(s.Ay.appSubUrl+this.result.redirectUrl):window.location.assign(this.result.redirectUrl):window.location.assign(s.Ay.appSubUrl+"/")},this.state={isLoggingIn:!1,isChangingPassword:!1,showDefaultPasswordWarning:!1,loginErrorMessage:s.Ay.loginError}}render(){const{children:g}=this.props,{isLoggingIn:l,isChangingPassword:p,showDefaultPasswordWarning:m,loginErrorMessage:y}=this.state,{login:d,toGrafana:v,changePassword:u}=this,{loginHint:D,passwordHint:P,disableLoginForm:x,disableUserSignUp:E}=s.Ay;return(0,t.jsx)(t.Fragment,{children:g({isOauthEnabled:f(),loginHint:D,passwordHint:P,disableLoginForm:x,disableUserSignUp:E,login:d,isLoggingIn:l,changePassword:u,skipPasswordChange:v,isChangingPassword:p,showDefaultPasswordWarning:m,loginErrorMessage:y})})}}const c=a;function o(h){switch(h.data?.messageId){case"password-auth.empty":case"password-auth.failed":case"password-auth.invalid":return(0,r.t)("login.error.invalid-user-or-password","Invalid username or password");case"login-attempt.blocked":return(0,r.t)("login.error.blocked","You have exceeded the number of login attempts for this user. Please try again later.");default:return h.data?.message}}},4691:(G,O,e)=>{"use strict";e.d(O,{$:()=>p,Q:()=>l});var t=e(74848),n=e(32196),i=e(96540),s=e(49785),r=e(13544),f=e(40845),a=e(88575),c=e(10354),o=e(55852),h=e(8484),g=e(78361);const l=({children:m,onSubmit:y,isLoggingIn:d,passwordHint:v,loginHint:u})=>{const D=(0,f.of)(p),P=(0,i.useId)(),x=(0,i.useId)(),{handleSubmit:E,register:C,formState:{errors:M}}=(0,s.mN)({mode:"onChange"});return(0,t.jsx)("div",{className:D.wrapper,children:(0,t.jsxs)("form",{onSubmit:E(y),children:[(0,t.jsx)(a.D,{label:(0,h.t)("login.form.username-label","Email or username"),invalid:!!M.user,error:M.user?.message,children:(0,t.jsx)(c.p,{...C("user",{required:(0,h.t)("login.form.username-required","Email or username is required")}),id:P,autoFocus:!0,autoCapitalize:"none",placeholder:u||(0,h.t)("login.form.username-placeholder","email or username"),"data-testid":r.Tp.pages.Login.username})}),(0,t.jsx)(a.D,{label:(0,h.t)("login.form.password-label","Password"),invalid:!!M.password,error:M.password?.message,children:(0,t.jsx)(g.s,{...C("password",{required:(0,h.t)("login.form.password-required","Password is required")}),id:x,autoComplete:"current-password",placeholder:v||(0,h.t)("login.form.password-placeholder","password")})}),(0,t.jsx)(o.$n,{type:"submit","data-testid":r.Tp.pages.Login.submit,className:D.submitButton,disabled:d,children:d?(0,h.t)("login.form.submit-loading-label","Logging in..."):(0,h.t)("login.form.submit-label","Log in")}),m]})})},p=m=>({wrapper:(0,n.css)({width:"100%",paddingBottom:m.spacing(2)}),submitButton:(0,n.css)({justifyContent:"center",width:"100%"}),skipButton:(0,n.css)({alignSelf:"flex-start"})})},20851:(G,O,e)=>{"use strict";e.d(O,{GU:()=>o,YO:()=>g,qm:()=>c});var t=e(74848),n=e(32196),i=e(96540),s=e(32264),r=e(40845),f=e(19361),a=e(38645);const c=({children:l,enterAnimation:p=!0})=>{const m=(0,r.of)(g);return(0,t.jsx)("div",{className:(0,n.cx)(m.loginInnerBox,p&&m.enterAnimation),children:l})},o=({children:l,branding:p,isChangingPassword:m})=>{const y=(0,r.of)(g),[d,v]=(0,i.useState)(!1),u=p?.loginSubtitle??f.M.LoginSubtitle,D=p?.loginTitle??f.M.LoginTitle,P=p?.loginBoxBackground||f.M.LoginBoxBackground(),x=p?.loginLogo,E=p?.hideEdition??f.M.HideEdition;return(0,i.useEffect)(()=>v(!0),[]),(0,t.jsxs)(f.M.LoginBackground,{className:(0,n.cx)(y.container,d&&y.loginAnim,p?.loginBackground,{[y.containerBodyScrolling]:s.$.featureToggles.bodyScrolling}),children:[(0,t.jsx)("div",{className:y.loginMain,children:(0,t.jsxs)("div",{className:(0,n.cx)(y.loginContent,P,"login-content-box"),children:[(0,t.jsxs)("div",{className:y.loginLogoWrapper,children:[(0,t.jsx)(f.M.LoginLogo,{className:y.loginLogo,logo:x}),(0,t.jsx)("div",{className:y.titleWrapper,children:m?(0,t.jsx)("h1",{className:y.mainTitle,children:"Update your password"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h1",{className:y.mainTitle,children:D}),u&&(0,t.jsx)("h3",{className:y.subTitle,children:u})]})})]}),(0,t.jsx)("div",{className:y.loginOuterBox,children:l})]})}),p?.hideFooter?(0,t.jsx)(t.Fragment,{}):(0,t.jsx)(a.wi,{hideEdition:E,customLinks:p?.footerLinks})]})},h=(0,n.keyframes)`
from{
  opacity: 0;
  transform: translate(-60px, 0px);
}

to{
  opacity: 1;
  transform: translate(0px, 0px);
}`,g=l=>({loginMain:(0,n.css)({flexGrow:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minWidth:"100%"}),container:(0,n.css)({minHeight:"100%",backgroundPosition:"center",backgroundRepeat:"no-repeat",minWidth:"100%",marginLeft:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}),containerBodyScrolling:(0,n.css)({flex:1}),loginAnim:(0,n.css)({"&:before":{opacity:1},".login-content-box":{opacity:1}}),submitButton:(0,n.css)({justifyContent:"center",width:"100%"}),loginLogo:(0,n.css)({width:"100%",maxWidth:200,marginBottom:l.spacing(2),[l.breakpoints.up("sm")]:{maxWidth:250}}),loginLogoWrapper:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",padding:l.spacing(3)}),titleWrapper:(0,n.css)({textAlign:"center"}),mainTitle:(0,n.css)({fontSize:22,[l.breakpoints.up("sm")]:{fontSize:32}}),subTitle:(0,n.css)({fontSize:l.typography.size.md,color:l.colors.text.secondary}),loginContent:(0,n.css)({maxWidth:478,width:"calc(100% - 2rem)",display:"flex",alignItems:"stretch",flexDirection:"column",position:"relative",justifyContent:"flex-start",zIndex:1,minHeight:320,borderRadius:l.shape.radius.default,padding:l.spacing(2,0),opacity:0,[l.transitions.handleMotion("no-preference","reduce")]:{transition:"opacity 0.5s ease-in-out"},[l.breakpoints.up("sm")]:{minHeight:l.spacing(40),justifyContent:"center"}}),loginOuterBox:(0,n.css)({display:"flex",overflowY:"hidden",alignItems:"center",justifyContent:"center"}),loginInnerBox:(0,n.css)({padding:l.spacing(0,2,2,2),display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flexGrow:1,maxWidth:415,width:"100%",transform:"translate(0px, 0px)",[l.transitions.handleMotion("no-preference")]:{transition:"0.25s ease"}}),enterAnimation:(0,n.css)({[l.transitions.handleMotion("no-preference")]:{animation:`${h} ease-out 0.2s`}})})},60188:(G,O,e)=>{"use strict";e.d(O,{Q:()=>a});var t=e(74848),n=e(2543),i=e.n(n),s=e(96540),r=e(10354),f=e(88575);class a extends s.PureComponent{constructor(){super(...arguments),this.state={text:"",inputCorrected:!1},this.inputRef=s.createRef(),this.updateValue=()=>{const o=this.inputRef.current?.value;let h=!1,g="";const l=this.props.min,p=this.props.max;let m=o!==""?Number(o):void 0;m&&!Number.isNaN(m)&&(l!=null&&m<l?(g=l.toString(),h=!0):p!=null&&m>p?(g=p.toString(),h=!0):g=o??"",this.setState({text:g,inputCorrected:h})),h&&this.updateValueDebounced(),!Number.isNaN(m)&&m!==this.props.value&&this.props.onChange(m)},this.updateValueDebounced=(0,n.debounce)(this.updateValue,500),this.onChange=o=>{this.setState({text:o.currentTarget.value}),this.updateValueDebounced()},this.onKeyPress=o=>{o.key==="Enter"&&this.updateValue()}}componentDidMount(){this.setState({text:isNaN(this.props.value)?"":`${this.props.value}`})}componentDidUpdate(o){if(this.props.value!==o.value){const h=isNaN(this.props.value)?"":`${this.props.value}`;h!==this.state.text&&this.setState({text:h})}}renderInput(){return(0,t.jsx)(r.p,{type:"number",ref:this.inputRef,min:this.props.min,max:this.props.max,step:this.props.step,autoFocus:this.props.autoFocus,value:this.state.text,onChange:this.onChange,onBlur:this.updateValue,onKeyPress:this.onKeyPress,placeholder:this.props.placeholder,disabled:this.props.fieldDisabled,width:this.props.width,suffix:this.props.suffix})}render(){const{inputCorrected:o}=this.state;if(o){let h="",{min:g,max:l}=this.props;return l==null?g!=null&&(h=`< ${g}`):g!=null?h=`${g} < > ${l}`:h=`> ${l}`,(0,t.jsx)(f.D,{invalid:o,error:`Out of range ${h}`,validationMessageHorizontalOverflow:!0,style:{direction:"rtl"},children:this.renderInput()})}return this.renderInput()}}},77268:(G,O,e)=>{"use strict";e.d(O,{a:()=>a});var t=e(74848),n=e(32196),i=e(40845),s=e(83598),r=e(29158),f=e(83876);const a=({value:o,settings:h,onChange:g,details:l})=>{const p=(0,i.$j)(),m=(0,i.of)(c);return(0,t.jsx)(s.sk,{color:o??"",onChange:g,enableNamedColors:h?.enableNamedColors!==!1,children:({ref:y,showColorPicker:d,hideColorPicker:v})=>(0,t.jsxs)("div",{className:m.spot,children:[(0,t.jsx)("div",{className:m.colorPicker,children:(0,t.jsx)(f.q,{ref:y,onClick:d,onMouseLeave:v,color:o?p.visualization.getColorByName(o):p.components.input.borderColor})}),l&&(0,t.jsxs)(t.Fragment,{children:[o?(0,t.jsx)("span",{className:m.colorText,onClick:d,children:o}):(0,t.jsx)("span",{className:m.placeholderText,onClick:d,children:h?.placeholder??"Select color"}),h?.isClearable&&o&&(0,t.jsx)(r.K,{name:"times",onClick:()=>g(void 0),tooltip:"Clear settings"})]})]})})},c=o=>({spot:(0,n.css)({cursor:"pointer",color:o.colors.text.primary,background:o.components.input.background,padding:"3px",height:o.v1.spacing.formInputHeight,border:`1px solid ${o.components.input.borderColor}`,display:"flex",flexDirection:"row",alignItems:"center",alignContent:"flex-end","&:hover":{border:`1px solid ${o.components.input.borderHover}`}}),colorPicker:(0,n.css)({padding:`0 ${o.spacing(1)}`}),colorText:(0,n.css)({flexGrow:2}),placeholderText:(0,n.css)({flexGrow:2,color:o.colors.text.secondary})})},72626:(G,O,e)=>{"use strict";e.d(O,{w:()=>s});var t=e(74848),n=e(96540),i=e(60188);const s=({value:r,onChange:f,item:a})=>{const{settings:c}=a,o=(0,n.useCallback)(h=>{f(c?.integer&&h!==void 0?Math.floor(h):h)},[f,c?.integer]);return(0,t.jsx)(i.Q,{value:r,min:c?.min,max:c?.max,step:c?.step,placeholder:c?.placeholder,onChange:o})}},33919:(G,O,e)=>{"use strict";e.d(O,{H:()=>ot,u:()=>$e});var t=e(74848),n=e(69550),i=e(27310),s=e(11261),r=e(50082),f=e(15292),a=e(94354),c=e(20333),o=e(76218),h=e(96540),g=e(32196),l=e(2543),p=e(47737),m=e(60578),y=e(24284),d=e(10354),v=e(83598),u=e(29158),D=e(55852),P=e(60029),x=e(3911);const E=[{value:r.O.Absolute,label:"Absolute",description:"Pick thresholds based on the absolute values"},{value:r.O.Percentage,label:"Percentage",description:"Pick threshold based on the percent between min/max"}];class C extends h.PureComponent{constructor(be){super(be),this.onAddThreshold=()=>{const{steps:ye}=this.state;let Pe=0;ye.length>1&&(Pe=ye[ye.length-1].value+10);let ge=y.Tj.filter(Ee=>!ye.some(Ie=>Ie.color===Ee))[1];ge||(ge="#CCCCCC");const xe={value:Pe,color:ge,key:M++},Ae=[...ye,xe];(0,p.RU)(Ae),this.setState({steps:Ae},()=>{this.latestThresholdInputRef.current&&this.latestThresholdInputRef.current.focus(),this.onChange()})},this.onRemoveThreshold=ye=>{const{steps:Pe}=this.state;Pe.length&&ye.key!==Pe[0].key&&this.setState({steps:Pe.filter(ge=>ge.key!==ye.key)},this.onChange)},this.onChangeThresholdValue=(ye,Pe)=>{const ge=ye.target.value.replace(/,/g,"."),xe=parseFloat(ge),Ae=isNaN(xe)?"":xe,Ee=this.state.steps.map(Ie=>(Ie.key===Pe.key&&(Ie={...Ie,value:Ae}),Ie));Ee.length&&(Ee[0].value=-1/0),(0,p.RU)(Ee),this.setState({steps:Ee})},this.onChangeThresholdColor=(ye,Pe)=>{const{steps:ge}=this.state,xe=ge.map(Ae=>(Ae.key===ye.key&&(Ae={...Ae,color:Pe}),Ae));this.setState({steps:xe},this.onChange)},this.onBlur=()=>{const ye=[...this.state.steps];(0,p.RU)(ye),this.setState({steps:ye},this.onChange)},this.onChange=()=>{this.props.onChange(I(this.props.thresholds,this.state.steps))},this.onModeChanged=ye=>{this.props.onChange({...this.props.thresholds,mode:ye})};const he=S(be.thresholds.steps);he[0].value=-1/0,this.state={steps:he},this.latestThresholdInputRef=h.createRef()}renderInput(be,he,ye){const Pe=this.props.thresholds.mode===r.O.Percentage,ge=`Threshold ${ye+1}`;return isFinite(be.value)?(0,t.jsx)(d.p,{type:"number",step:"0.0001",onChange:xe=>this.onChangeThresholdValue(xe,be),value:be.value,"aria-label":ge,ref:ye===0?this.latestThresholdInputRef:null,onBlur:this.onBlur,prefix:(0,t.jsxs)("div",{className:he.inputPrefix,children:[(0,t.jsx)("div",{className:he.colorPicker,children:(0,t.jsx)(v.sk,{color:be.color,onChange:xe=>this.onChangeThresholdColor(be,xe),enableNamedColors:!0})}),Pe&&(0,t.jsx)("div",{className:he.percentIcon,children:"%"})]}),suffix:(0,t.jsx)(u.K,{className:he.trashIcon,name:"trash-alt",onClick:()=>this.onRemoveThreshold(be),tooltip:`Remove ${ge}`})},Pe.toString()):(0,t.jsx)(d.p,{type:"text",value:"Base","aria-label":ge,disabled:!0,prefix:(0,t.jsx)("div",{className:he.colorPicker,children:(0,t.jsx)(v.sk,{color:be.color,onChange:xe=>this.onChangeThresholdColor(be,xe),enableNamedColors:!0})})})}render(){const{thresholds:be}=this.props,{steps:he}=this.state;return(0,t.jsx)(m.D.Consumer,{children:ye=>{const Pe=T(ye);return(0,t.jsxs)("div",{className:Pe.wrapper,children:[(0,t.jsx)(D.$n,{size:"sm",icon:"plus",onClick:()=>this.onAddThreshold(),variant:"secondary",className:Pe.addButton,fullWidth:!0,children:"Add threshold"}),(0,t.jsx)("div",{className:Pe.thresholds,children:he.slice(0).reverse().map((ge,xe)=>(0,t.jsx)("div",{className:Pe.item,children:this.renderInput(ge,Pe,xe)},`${ge.key}`))}),(0,t.jsxs)("div",{children:[(0,t.jsx)(P.J,{description:"Percentage means thresholds relative to min & max",children:"Thresholds mode"}),(0,t.jsx)(a.z,{options:E,onChange:this.onModeChanged,value:be.mode})]})]})}})}}let M=100;function S(ve){return(!ve||ve.length===0)&&(ve=[{value:-1/0,color:"green"}]),ve.filter((be,he)=>(0,l.isNumber)(be.value)||he===0).map(be=>({color:be.color,value:be.value===null?-1/0:be.value,key:M++}))}function I(ve,be){return{mode:ve.mode??r.O.Absolute,steps:be.map(ye=>{const{key:Pe,...ge}=ye;return ge})}}const T=(0,x.N)(ve=>({wrapper:(0,g.css)`
      display: flex;
      flex-direction: column;
    `,thresholds:(0,g.css)`
      display: flex;
      flex-direction: column;
      margin-bottom: ${ve.spacing(2)};
    `,item:(0,g.css)`
      margin-bottom: ${ve.spacing(1)};

      &:last-child {
        margin-bottom: 0;
      }
    `,colorPicker:(0,g.css)`
      padding: 0 ${ve.spacing(1)};
    `,addButton:(0,g.css)`
      margin-bottom: ${ve.spacing(1)};
    `,percentIcon:(0,g.css)`
      font-size: ${ve.typography.bodySmall.fontSize};
      color: ${ve.colors.text.secondary};
    `,inputPrefix:(0,g.css)`
      display: flex;
      align-items: center;
    `,trashIcon:(0,g.css)`
      color: ${ve.colors.text.secondary};
      cursor: pointer;
      margin-right: 0;

      &:hover {
        color: ${ve.colors.text};
      }
    `}));class b extends h.PureComponent{constructor(be){super(be)}render(){const{onChange:be}=this.props;let he=this.props.value;return he||(he={mode:r.O.Percentage,steps:[]}),(0,t.jsx)(C,{thresholds:he,onChange:be})}}var R=e(25019),A=e(40845),L=e(66864),U=e(14578),W=e(37390),w=e(80744),N=e(25148),B=e(38127),V=e(51986),K=e(90182);function H({mapping:ve,index:be,onChange:he,onRemove:ye,onDuplicate:Pe,showIconPicker:ge}){const{key:xe,result:Ae,id:Ee}=ve,Ie=(0,A.of)(X),Qe=(0,h.useRef)(null),at=(0,h.useCallback)(Cn=>{const Ye={...ve,result:{...ve.result}};Cn(Ye),he(be,Ye)},[ve,be,he]);(0,h.useEffect)(()=>{Qe.current&&ve.isNew&&(Qe.current.focus(),at(Cn=>{Cn.isNew=!1}))},[ve,Qe,at]);const ft=Cn=>{at(Ye=>{Ye.result.color=Cn})},ct=()=>{at(Cn=>{Cn.result.color=void 0})},vt=Cn=>{at(Ye=>{Ye.result.icon=Cn})},Pt=()=>{at(Cn=>{Cn.result.icon=void 0})},Vt=Cn=>{at(Ye=>{Ye.key=Cn.currentTarget.value})},Jt=Cn=>{at(Ye=>{Ye.result.text=Cn.currentTarget.value})},wt=Cn=>{at(Ye=>{Ye.from=parseFloat(Cn.currentTarget.value)})},zt=Cn=>{at(Ye=>{Ye.to=parseFloat(Cn.currentTarget.value)})},on=Cn=>{at(Ye=>{Ye.pattern=Cn.currentTarget.value})},Pn=Cn=>{at(Ye=>{Ye.specialMatch=Cn.value})},_n=[{label:"Null",value:R.W.Null,description:"Matches null and undefined values"},{label:"NaN",value:R.W.NaN,description:"Matches against Number.NaN (not a number)"},{label:"Null + NaN",value:R.W.NullAndNaN,description:"Matches null, undefined and NaN"},{label:"True",value:R.W.True,description:"Boolean true values"},{label:"False",value:R.W.False,description:"Boolean false values"},{label:"Empty",value:R.W.Empty,description:"Empty string"}];return(0,t.jsx)(B.sx,{draggableId:Ee,index:be,children:Cn=>(0,t.jsxs)("tr",{className:Ie.dragRow,ref:Cn.innerRef,...Cn.draggableProps,children:[(0,t.jsx)("td",{children:(0,t.jsx)("div",{className:Ie.dragHandle,...Cn.dragHandleProps,children:(0,t.jsx)(U.I,{name:"draggabledots",size:"lg"})})}),(0,t.jsx)("td",{className:Ie.typeColumn,children:ve.type}),(0,t.jsxs)("td",{children:[ve.type===R.d.ValueToText&&(0,t.jsx)(d.p,{ref:Qe,type:"text",value:xe??"",onChange:Vt,placeholder:"Exact value to match"}),ve.type===R.d.RangeToText&&(0,t.jsxs)("div",{className:Ie.rangeInputWrapper,children:[(0,t.jsx)(d.p,{type:"number",value:ve.from??"",placeholder:"Range start",onChange:wt,prefix:"From"}),(0,t.jsx)(d.p,{type:"number",value:ve.to??"",placeholder:"Range end",onChange:zt,prefix:"To"})]}),ve.type===R.d.RegexToText&&(0,t.jsx)(d.p,{type:"text",value:ve.pattern??"",placeholder:"Regular expression",onChange:on}),ve.type===R.d.SpecialValue&&(0,t.jsx)(K.l6,{value:_n.find(Ye=>Ye.value===ve.specialMatch),options:_n,onChange:Pn})]}),(0,t.jsx)("td",{children:(0,t.jsx)(d.p,{type:"text",value:Ae.text??"",onChange:Jt,placeholder:"Optional display text"})}),(0,t.jsxs)("td",{className:Ie.textAlignCenter,children:[Ae.color&&(0,t.jsxs)(L.Gy,{spacing:"sm",justify:"center",children:[(0,t.jsx)(v.sk,{color:Ae.color,onChange:ft,enableNamedColors:!0}),(0,t.jsx)(u.K,{name:"times",onClick:ct,tooltip:"Remove color",tooltipPlacement:"top"})]}),!Ae.color&&(0,t.jsx)(v.sk,{color:"gray",onChange:ft,enableNamedColors:!0,children:Ye=>(0,t.jsx)(D.$n,{variant:"primary",fill:"text",onClick:Ye.showColorPicker,ref:Ye.ref,size:"sm",children:"Set color"})})]}),ge&&(0,t.jsx)("td",{className:Ie.textAlignCenter,children:(0,t.jsxs)(L.Gy,{spacing:"sm",justify:"center",children:[(0,t.jsx)(N.n,{onChange:vt,onClear:Pt,value:Ae.icon,size:w.Iy.SMALL,folderName:w.Iu.Icon,mediaType:w.zu.Icon,color:Ae.color}),Ae.icon&&(0,t.jsx)(u.K,{name:"times",onClick:Pt,tooltip:"Remove icon",tooltipPlacement:"top"})]})}),(0,t.jsx)("td",{className:Ie.textAlignCenter,children:(0,t.jsxs)(L.Gy,{spacing:"sm",children:[(0,t.jsx)(u.K,{name:"copy",onClick:()=>Pe(be),"data-testid":"duplicate-value-mapping","aria-label":"Duplicate value mapping",tooltip:"Duplicate"}),(0,t.jsx)(u.K,{name:"trash-alt",onClick:()=>ye(be),"data-testid":"remove-value-mapping","aria-label":"Delete value mapping",tooltip:"Delete"})]})})]})},Ee)}const X=ve=>({dragRow:(0,g.css)({position:"relative"}),dragHandle:(0,g.css)({cursor:"grab","&:focus-visible&:after":{bottom:0,content:'""',left:0,position:"absolute",right:0,top:0,outline:`2px solid ${ve.colors.primary.main}`,outlineOffset:"-2px"}}),rangeInputWrapper:(0,g.css)({display:"flex","> div:first-child":{marginRight:ve.spacing(2)}}),regexInputWrapper:(0,g.css)({display:"flex","> div:first-child":{marginRight:ve.spacing(2)}}),typeColumn:(0,g.css)({textTransform:"capitalize",textAlign:"center",width:"1%"}),textAlignCenter:(0,g.css)({textAlign:"center"})});function k({value:ve,onChange:be,onClose:he,showIconPicker:ye}){const Pe=(0,A.of)(Y),[ge,xe]=(0,h.useState)([]);(0,h.useEffect)(()=>{xe(ne(ve))},[ve]);const Ae=vt=>{if(!ve||!vt.destination)return;const Pt=[...ge],Vt=Pt[vt.source.index];Pt.splice(vt.source.index,1),Pt.splice(vt.destination.index,0,Vt),xe(Pt)},Ee=(vt,Pt)=>{const Vt=[...ge];Vt.splice(vt,1,Pt),xe(Vt)},Ie=vt=>{const Pt=[...ge];Pt.splice(vt,1),xe(Pt)},Qe=[{label:"Value",value:R.d.ValueToText,description:"Match a specific text value"},{label:"Range",value:R.d.RangeToText,description:"Match a numerical range of values"},{label:"Regex",value:R.d.RegexToText,description:"Match a regular expression with replacement"},{label:"Special",value:R.d.SpecialValue,description:"Match on null, NaN, boolean and empty values"}],at=vt=>{xe([...ge,se({type:vt.value,result:{},isNew:!0})])},ft=vt=>{const Pt=j(ge[vt]),Vt=[...ge];Vt.splice(vt,0,{...Pt});for(let Jt=vt;Jt<ge.length;Jt++)Vt[Jt].result.index=Jt;xe(Vt)},ct=()=>{be(q(ge)),he()};return(0,h.useEffect)(()=>{ve?.length||at({value:R.d.ValueToText})},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:Pe.tableWrap,children:(0,t.jsxs)("table",{className:Pe.editTable,children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{style:{width:"1%"}}),(0,t.jsx)("th",{style:{width:"40%",textAlign:"left"},colSpan:2,children:"Condition"}),(0,t.jsx)("th",{style:{textAlign:"left"},children:"Display text"}),(0,t.jsx)("th",{style:{width:"10%"},children:"Color"}),ye&&(0,t.jsx)("th",{style:{width:"10%"},children:"Icon"}),(0,t.jsx)("th",{style:{width:"1%"}})]})}),(0,t.jsx)(B.JY,{onDragEnd:Ae,children:(0,t.jsx)(B.gL,{droppableId:"sortable-field-mappings",direction:"vertical",children:vt=>(0,t.jsxs)("tbody",{ref:vt.innerRef,...vt.droppableProps,children:[ge.map((Pt,Vt)=>(0,t.jsx)(H,{mapping:Pt,index:Vt,onChange:Ee,onRemove:Ie,onDuplicate:ft,showIconPicker:ye},Pt.id)),vt.placeholder]})})})]})}),(0,t.jsxs)(W.a.ButtonRow,{leftItems:(0,t.jsx)(V.i,{label:"Add a new mapping",variant:"secondary",size:"md",icon:"plus",menuPlacement:"auto",minWidth:40,options:Qe,onChange:at}),children:[(0,t.jsx)(D.$n,{variant:"secondary",fill:"outline",onClick:he,children:"Cancel"}),(0,t.jsx)(D.$n,{variant:"primary",onClick:ct,children:"Update"})]})]})}const Y=ve=>({tableWrap:(0,g.css)`
    max-height: calc(80vh - 170px);
    min-height: 40px;
    overflow: auto;
  `,editTable:(0,g.css)({width:"100%",marginBottom:ve.spacing(2),"thead th":{textAlign:"center"},"tbody tr:hover":{background:ve.colors.action.hover}," th, td":{padding:ve.spacing(1)}})});function Z(){return(0,l.uniqueId)("mapping-")}function se(ve){return{type:R.d.ValueToText,result:{},id:Z(),...ve}}function j(ve){return{...se(ve),id:Z()}}function q(ve){const be=[],he={type:R.d.ValueToText,options:{}};return ve.forEach((ye,Pe)=>{const ge={...ye.result,index:Pe};switch((!ge.text||ge.text.trim().length===0)&&(ge.text=void 0),ye.type){case R.d.ValueToText:ye.key!=null&&(he.options[ye.key]=ge);break;case R.d.RangeToText:ye.from!=null&&ye.to!=null&&be.push({type:ye.type,options:{from:ye.from,to:ye.to,result:ge}});break;case R.d.RegexToText:ye.pattern!=null&&be.push({type:ye.type,options:{pattern:ye.pattern,result:ge}});break;case R.d.SpecialValue:be.push({type:ye.type,options:{match:ye.specialMatch,result:ge}})}}),Object.keys(he.options).length>0&&be.unshift(he),be}function ne(ve){const be=[];if(ve)for(const he of ve)switch(he.type){case R.d.ValueToText:for(const ye in he.options)be.push(se({type:he.type,result:he.options[ye],key:ye}));break;case R.d.RangeToText:be.push(se({type:he.type,result:he.options.result,from:he.options.from??0,to:he.options.to??0}));break;case R.d.RegexToText:be.push(se({type:he.type,result:he.options.result,pattern:he.options.pattern}));break;case R.d.SpecialValue:be.push(se({type:he.type,result:he.options.result,specialMatch:he.options.match??R.W.Null}))}return be.sort((he,ye)=>(he.result.index??0)>(ye.result.index??0)?1:-1),be}const oe=(0,h.memo)(ve=>{const{value:be,onChange:he,item:ye}=ve,Pe=(0,A.of)(z),ge=ye.settings?.icon,[xe,Ae]=(0,h.useState)(!1),Ee=(0,h.useCallback)(()=>{Ae(!1)},[Ae]),Ie=(0,h.useMemo)(()=>ne(be),[be]),Qe=(0,h.useCallback)((ft,ct)=>{Ie[ct].result.color=ft,he(q(Ie))},[Ie,he]),at=(0,h.useCallback)((ft,ct)=>{Ie[ct].result.icon=ft,he(q(Ie))},[Ie,he]);return(0,t.jsxs)(L.gW,{children:[(0,t.jsx)("table",{className:Pe.compactTable,children:(0,t.jsx)("tbody",{children:Ie.map((ft,ct)=>(0,t.jsxs)("tr",{children:[(0,t.jsxs)("td",{children:[ft.type===R.d.ValueToText&&ft.key,ft.type===R.d.RangeToText&&(0,t.jsxs)("span",{children:["[",ft.from," - ",ft.to,"]"]}),ft.type===R.d.RegexToText&&ft.pattern,ft.type===R.d.SpecialValue&&ft.specialMatch]}),(0,t.jsx)("td",{children:(0,t.jsx)(U.I,{name:"arrow-right"})}),(0,t.jsx)("td",{children:ft.result.text}),ft.result.color&&(0,t.jsx)("td",{children:(0,t.jsx)(v.sk,{color:ft.result.color,onChange:vt=>Qe(vt,ct),enableNamedColors:!0})}),ge&&ft.result.icon&&(0,t.jsx)("td",{"data-testid":"iconPicker",children:(0,t.jsx)(N.n,{onChange:vt=>at(vt,ct),value:ft.result.icon,size:w.Iy.SMALL,folderName:w.Iu.Icon,mediaType:w.zu.Icon,color:ft.result.color})})]},ct.toString()))})}),(0,t.jsxs)(D.$n,{variant:"secondary",size:"sm",fullWidth:!0,onClick:()=>Ae(!0),children:[Ie.length>0&&(0,t.jsx)("span",{children:"Edit value mappings"}),Ie.length===0&&(0,t.jsx)("span",{children:"Add value mappings"})]}),(0,t.jsx)(W.a,{isOpen:xe,title:"Value mappings",onDismiss:Ee,className:Pe.modal,closeOnBackdropClick:!1,children:(0,t.jsx)(k,{value:be,onChange:he,onClose:Ee,showIconPicker:ge})})]})});oe.displayName="ValueMappingsEditor";const z=ve=>({modal:(0,g.css)({width:"980px"}),compactTable:(0,g.css)({width:"100%","tbody td":{padding:ve.spacing(.5)}})});var te=e(59429);const le=({value:ve,onChange:be,item:he})=>{const{placeholder:ye,isClearable:Pe}=he?.settings??{},ge=(0,h.useCallback)(xe=>{be(xe?.value?.uid)},[be]);return(0,t.jsx)(te.b,{isClearable:Pe,defaultOptions:!0,onChange:ge,placeholder:ye,value:ve})};var ie=e(77268),ae=e(8066),re=e(24293),ce=e(88575);const me=({value:ve,onChange:be,item:he,id:ye})=>{const Pe=(0,A.$j)(),ge=(0,A.of)(de),xe=(0,ae.Hs)(ve?.mode),Ee=(he.settings?.byValueSupport?ae.uf.list():ae.uf.list().filter(ct=>!ct.isByValue)).filter(ct=>!ct.excludeFromPicker).map(ct=>{let vt=ct.isByValue?" (by value)":"";return{value:ct.id,label:`${ct.name}${vt}`,description:ct.description,isContinuous:ct.isContinuous,isByValue:ct.isByValue,component(){return(0,t.jsx)(ee,{mode:ct,theme:Pe})}}}),Ie=ct=>{be({...ve,mode:ct.value})},Qe=ct=>{be({...ve,mode:ft,fixedColor:ct})},at=ct=>{be({...ve,mode:ft,seriesBy:ct})},ft=ve?.mode??re.Y.Thresholds;if(ft===re.Y.Fixed||ft===re.Y.Shades)return(0,t.jsxs)("div",{className:ge.group,children:[(0,t.jsx)(K.l6,{minMenuHeight:200,options:Ee,value:ft,onChange:Ie,className:ge.select,inputId:ye}),(0,t.jsx)(ie.a,{value:ve?.fixedColor,onChange:Qe})]});if(he.settings?.bySeriesSupport&&xe.isByValue){const ct=[{label:"Last",value:"last"},{label:"Min",value:"min"},{label:"Max",value:"max"}];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{marginBottom:Pe.spacing(2)},children:(0,t.jsx)(K.l6,{minMenuHeight:200,options:Ee,value:ft,onChange:Ie,inputId:ye})}),(0,t.jsx)(ce.D,{label:"Color series by",children:(0,t.jsx)(a.z,{value:ve?.seriesBy??"last",options:ct,onChange:at})})]})}return(0,t.jsx)(K.l6,{minMenuHeight:200,options:Ee,value:ft,onChange:Ie,inputId:ye})},ee=({mode:ve,theme:be})=>{if(!ve.getColors)return null;const he=ve.getColors(be).map(be.visualization.getColorByName),ye={height:"8px",width:"100%",margin:"2px 0",borderRadius:"3px",opacity:1};if(ve.isContinuous)ye.background=`linear-gradient(90deg, ${he.join(",")})`;else{let Pe="",ge="";for(let xe=0;xe<he.length;xe++){const Ae=he[xe];if(Pe==="")Pe=`linear-gradient(90deg, ${Ae} 0%`;else{const Ie=xe/(he.length-1)*100;Pe+=`, ${ge} ${Ie}%, ${Ae} ${Ie}%`}ge=Ae}ye.background=Pe}return(0,t.jsx)("div",{style:ye})},de=ve=>({group:(0,g.css)({display:"flex"}),select:(0,g.css)({marginRight:ve.spacing(1),flexGrow:1})});var De=e(91890),fe=e(64919);const Te=({value:ve,onChange:be,context:he})=>(0,t.jsx)(fe.e,{links:ve,onChange:be,data:he.data,getSuggestions:()=>he.getSuggestions?he.getSuggestions(De.uP.Values):[]});class je extends h.PureComponent{constructor(){super(...arguments),this.state={isLoading:!0,options:[]},this.updateOptions=async()=>{const{item:be}=this.props,{settings:he}=be;let ye=be.settings?.options||[];he?.getOptions&&(ye=await he.getOptions(this.props.context)),this.state.options!==ye&&this.setState({isLoading:!1,options:ye})}}componentDidMount(){this.updateOptions()}componentDidUpdate(be){const he=be.item?.settings,ye=this.props.item?.settings;if(he!==ye)this.updateOptions();else if(ye?.getOptions){const Pe=be.context?.data,ge=this.props.context?.data;Pe!==ge&&this.updateOptions()}}render(){const{options:be,isLoading:he}=this.state,{value:ye,onChange:Pe,item:ge}=this.props,{settings:xe}=ge;return(0,t.jsx)(K.KF,{isLoading:he,value:ye,defaultValue:ye,allowCustomValue:xe?.allowCustomValue,onChange:Ae=>{Pe(Ae.map(Ee=>Ee.value).flatMap(Ee=>Ee!==void 0?[Ee]:[]))},options:be})}}var He=e(72626);class Be extends h.PureComponent{constructor(){super(...arguments),this.state={isLoading:!0,options:[]},this.updateOptions=async()=>{const{item:be}=this.props,{settings:he}=be;let ye=be.settings?.options||[];he?.getOptions&&(ye=await he.getOptions(this.props.context)),this.state.options!==ye&&this.setState({isLoading:!1,options:ye})}}componentDidMount(){this.updateOptions()}componentDidUpdate(be){const he=be.item?.settings,ye=this.props.item?.settings;if(he!==ye)this.updateOptions();else if(ye?.getOptions){const Pe=be.context?.data,ge=this.props.context?.data;Pe!==ge&&this.updateOptions()}}render(){const{options:be,isLoading:he}=this.state,{value:ye,onChange:Pe,item:ge}=this.props,{settings:xe}=ge;let Ae=be.find(Ee=>Ee.value===ye);return!Ae&&ye&&(Ae={label:`${ye}`,value:ye}),(0,t.jsx)(K.l6,{isLoading:he,value:Ae,defaultValue:ye,allowCustomValue:xe?.allowCustomValue,isClearable:xe?.isClearable,onChange:Ee=>Pe(Ee?.value),options:be})}}var Ne=e(57602),Re=e(42734);const Se=({value:ve,onChange:be,item:he,id:ye})=>(0,t.jsx)(Re.S,{stats:ve,onChange:be,allowMultiple:!!he.settings?.allowMultiple,defaultStat:he.settings?.defaultStat,inputId:ye});var We=e(29286),Ke=e(32264);class Xe extends h.PureComponent{constructor(){super(...arguments),this.state={showAdd:!1},this.onRemoveString=be=>{const{value:he,onChange:ye}=this.props,Pe=[...he];Pe.splice(be,1),ye(Pe)},this.onValueChange=(be,he)=>{if("key"in be&&be.key!=="Enter")return;const{value:ye,onChange:Pe}=this.props,ge=be.currentTarget.value.trim();if(he<0){ge&&(be.currentTarget.value="",Pe([...ye,ge])),this.setState({showAdd:!1});return}if(!ge)return this.onRemoveString(he);const xe=[...ye];xe[he]=ge,Pe(xe)}}render(){const{value:be,item:he}=this.props,{showAdd:ye}=this.state,Pe=Je(Ke.$.theme2),ge=he.settings?.placeholder||"Add text";return(0,t.jsxs)("div",{children:[be.map((xe,Ae)=>(0,t.jsx)(d.p,{className:Pe.textInput,defaultValue:xe||"",onBlur:Ee=>this.onValueChange(Ee,Ae),onKeyDown:Ee=>this.onValueChange(Ee,Ae),suffix:(0,t.jsx)(U.I,{className:Pe.trashIcon,name:"trash-alt",onClick:()=>this.onRemoveString(Ae)})},`${Ae}/${xe}`)),ye?(0,t.jsx)(d.p,{autoFocus:!0,className:Pe.textInput,placeholder:ge,defaultValue:"",onBlur:xe=>this.onValueChange(xe,-1),onKeyDown:xe=>this.onValueChange(xe,-1),suffix:(0,t.jsx)(U.I,{name:"plus-circle"})}):(0,t.jsx)(D.$n,{icon:"plus",size:"sm",variant:"secondary",onClick:()=>this.setState({showAdd:!0}),children:ge})]})}}const Je=(0,x.N)(ve=>({textInput:(0,g.css)({marginBottom:"5px","&:hover":{border:`1px solid ${ve.components.input.borderHover}`}}),trashIcon:(0,g.css)({color:ve.colors.text.secondary,cursor:"pointer","&:hover":{color:ve.colors.text.primary}})}));var st=e(2056);function pt({value:ve,onChange:be,item:he}){const ye=(0,A.of)(xt);return he?.settings?.isClearable&&ve!=null?(0,t.jsxs)("div",{className:ye.wrapper,children:[(0,t.jsx)("span",{className:ye.first,children:(0,t.jsx)(st.p,{value:ve,onChange:be})}),(0,t.jsx)(u.K,{name:"times",onClick:()=>be(void 0),tooltip:"Clear unit selection"})]}):(0,t.jsx)(st.p,{value:ve,onChange:be})}const xt=ve=>({wrapper:(0,g.css)({width:"100%",display:"flex",flexDirection:"row",alignItems:"center"}),first:(0,g.css)({marginRight:ve.spacing(1),flexGrow:2})}),ot=()=>{const ve={id:"number",name:"Number",description:"Allows numeric values input",editor:He.w},be={id:"slider",name:"Slider",description:"Allows numeric values input",editor:Ne.G},he={id:"text",name:"Text",description:"Allows string values input",editor:We.g},ye={id:"strings",name:"String array",description:"An array of strings",editor:Xe},Pe={id:"boolean",name:"Boolean",description:"Allows boolean values input",editor(wt){const{id:zt,...on}=wt;return(0,t.jsx)(f.d,{...on,onChange:Pn=>wt.onChange(Pn.currentTarget.checked)})}},ge={id:"select",name:"Select",description:"Allows option selection",editor:Be},xe={id:"multi-select",name:"Multi select",description:"Allows for multiple option selection",editor:je},Ae={id:"radio",name:"Radio",description:"Allows option selection",editor(wt){return(0,t.jsx)(a.z,{...wt,options:wt.item.settings?.options})}},Ee={id:"unit",name:"Unit",description:"Allows unit input",editor:pt},Ie={id:"color",name:"Color",description:"Allows color selection",editor(wt){return(0,t.jsx)(ie.a,{value:wt.value,onChange:wt.onChange,settings:wt.item.settings,details:!0})}},Qe={id:"fieldColor",name:"Field Color",description:"Field color selection",editor:me},at={id:"links",name:"Links",description:"Allows defining data links",editor:Te},ft={id:"stats-picker",name:"Stats Picker",editor:Se,description:""},ct={id:"timezone",name:"Time zone",description:"Time zone selection",editor:c.U},vt={id:"field-name",name:"Field name",description:"Allows selecting a field name from a data frame",editor:o.O};return[he,ve,be,Pe,Ae,ge,Ee,at,ft,ye,ct,Qe,Ie,xe,vt,{id:"dashboard-uid",name:"Dashboard",description:"Select dashboard",editor:le},{id:"mappings",name:"Mappings",description:"Allows defining value mappings",editor:oe},{id:"thresholds",name:"Thresholds",description:"Allows defining thresholds",editor:b}]},$e=()=>{const ve=["Standard options"],be={id:"displayName",path:"displayName",name:"Display name",description:"Change the field or series name",editor:n.D.get("text").editor,override:n.D.get("text").editor,process:i.AM,settings:{placeholder:"none",expandTemplateVars:!0},shouldApply:()=>!0,category:ve},he={id:"unit",path:"unit",name:"Unit",description:"",editor:n.D.get("unit").editor,override:n.D.get("unit").editor,process:i.OU,settings:{placeholder:"none"},shouldApply:()=>!0,category:ve},ye={id:"fieldMinMax",path:"fieldMinMax",name:"Field min/max",description:"Calculate min max per field",editor:n.D.get("boolean").editor,override:n.D.get("boolean").editor,process:i.FM,shouldApply:ct=>ct.type===s.PU.number,showIf:ct=>ct.min===void 0||ct.max===void 0,category:ve},Pe={id:"min",path:"min",name:"Min",description:"Leave empty to calculate based on all values",editor:n.D.get("number").editor,override:n.D.get("number").editor,process:i.m0,settings:{placeholder:"auto"},shouldApply:ct=>ct.type===s.PU.number,category:ve},ge={id:"max",path:"max",name:"Max",description:"Leave empty to calculate based on all values",editor:n.D.get("number").editor,override:n.D.get("number").editor,process:i.m0,settings:{placeholder:"auto"},shouldApply:ct=>ct.type===s.PU.number,category:ve},xe={id:"decimals",path:"decimals",name:"Decimals",editor:n.D.get("number").editor,override:n.D.get("number").editor,process:i.m0,settings:{placeholder:"auto",min:0,max:15,integer:!0},shouldApply:ct=>ct.type===s.PU.number,category:ve},Ae={id:"noValue",path:"noValue",name:"No value",description:"What to show when there is no value",editor:n.D.get("text").editor,override:n.D.get("text").editor,process:i.OU,settings:{placeholder:"-"},shouldApply:()=>!0,category:ve},Ee={id:"links",path:"links",name:"Data links",editor:n.D.get("links").editor,override:n.D.get("links").editor,process:i.Ch,settings:{placeholder:"-"},shouldApply:()=>!0,category:["Data links"],getItemsCount:ct=>ct?ct.length:0},Ie={id:"color",path:"color",name:"Color scheme",editor:n.D.get("fieldColor").editor,override:n.D.get("fieldColor").editor,process:i.hS,shouldApply:()=>!0,settings:{byValueSupport:!0,preferThresholdsMode:!0},category:ve},Qe={id:"mappings",path:"mappings",name:"Value mappings",description:"Modify the display text based on input value",editor:n.D.get("mappings").editor,override:n.D.get("mappings").editor,process:i.xT,settings:{},defaultValue:[],shouldApply:ct=>ct.type!==s.PU.time,category:["Value mappings"],getItemsCount:ct=>ct?ct.length:0},at={id:"thresholds",path:"thresholds",name:"Thresholds",editor:n.D.get("thresholds").editor,override:n.D.get("thresholds").editor,process:i.N7,settings:{},defaultValue:{mode:r.O.Absolute,steps:[{value:-1/0,color:"green"},{value:80,color:"red"}]},shouldApply:()=>!0,category:["Thresholds"],getItemsCount:ct=>ct?ct.steps.length:0},ft={id:"filterable",path:"filterable",name:"Ad-hoc filterable",hideFromDefaults:!0,editor:n.D.get("boolean").editor,override:n.D.get("boolean").editor,process:i.FM,shouldApply:()=>!0,settings:{},category:ve};return[he,Pe,ge,ye,xe,be,Ie,Ae,Ee,Qe,at,ft]}},57602:(G,O,e)=>{"use strict";e.d(O,{G:()=>o});var t=e(74848),n=e(32196),i=e(94659),s=e(9821),r=e(96540),f=e(40845),a=e(24849),c=e(60188);const o=({value:l,onChange:p,item:m})=>{const y=(0,r.useRef)(null),{settings:d}=m,v=d?.min||0,u=d?.max||100,D=d?.step,P=d?.marks||{[v]:v,[u]:u},x=d?.included,E=d?.ariaLabelForHandle,C=75,M=!0,S=(0,f.$j)(),[I,T]=(0,r.useState)(l??v),[b,R]=(0,r.useState)(C);(0,r.useEffect)(()=>{l!=null&&l!==I&&T(l)},[l,I]),(0,r.useEffect)(()=>{const N=getComputedStyle(y.current),B=N.getPropertyValue("font-weight")||"normal",V=N.getPropertyValue("font-size")||"16px",K=N.getPropertyValue("font-family")||"Arial",H="0",X=4,k=8,Y=Math.max((u+(D||0)).toString().length,(u-(D||0)).toString().length)+X,Z=H.repeat(Y),se=h(Z,`${B} ${V} ${K}`);se&&R(se+k*2)},[u,D]);const A=(0,r.useCallback)(N=>{const B=typeof N=="number"?N:N[0];T(B),p&&p(B)},[T,p]),L=(0,r.useCallback)(N=>{let B=N;(Number.isNaN(B)||!B)&&(B=0),T(B),p&&p(B)},[p]),U=(0,a.$)(S,M,!!P),W=g(S,b),w=M?[]:[U.sliderInputVertical];return(0,t.jsxs)("div",{className:(0,n.cx)(U.container,U.slider),children:[(0,t.jsx)(i.Global,{styles:U.slider}),(0,t.jsxs)("div",{className:(0,n.cx)(U.sliderInput,...w),children:[(0,t.jsx)(s.A,{min:v,max:u,step:D,defaultValue:l,value:I,onChange:A,vertical:!M,reverse:!1,ariaLabelForHandle:E,marks:P,included:x}),(0,t.jsx)("span",{className:W.numberInputWrapper,ref:y,children:(0,t.jsx)(c.Q,{value:I,onChange:L,max:u,min:v,step:D})})]})]})};function h(l,p){const y=document.createElement("canvas").getContext("2d");return y?(y.font=p,y.measureText(l).width):null}const g=(l,p)=>({numberInputWrapper:(0,n.css)({marginLeft:l.spacing(3),maxHeight:"32px",maxWidth:p,minWidth:p,overflow:"visible",width:"100%"})})},29286:(G,O,e)=>{"use strict";e.d(O,{g:()=>r});var t=e(74848),n=e(96540),i=e(21744),s=e(10354);const r=({value:f,onChange:a,item:c,suffix:o})=>{const h=c.settings?.useTextarea?i.f:s.p,g=(0,n.useCallback)(l=>{let p=f??"";"key"in l?l.key==="Enter"&&!c.settings?.useTextarea&&(p=l.currentTarget.value.trim()):p=l.currentTarget.value.trim(),p!==f&&a(p===""?void 0:p)},[f,c.settings?.useTextarea,a]);return(0,t.jsx)(h,{placeholder:c.settings?.placeholder,defaultValue:f||"",rows:c.settings?.useTextarea&&c.settings.rows||5,onBlur:g,onKeyDown:g,suffix:o})}},13773:(G,O,e)=>{"use strict";e.d(O,{Q:()=>r});var t=e(74848),n=e(32196),i=e(96540),s=e(40845);function r({info:a}){const c=(0,s.of)(f);return(0,t.jsx)("div",{className:c.container,children:a.map((o,h)=>(0,t.jsxs)(i.Fragment,{children:[(0,t.jsxs)("div",{className:c.infoItem,children:[(0,t.jsx)("div",{className:c.label,children:o.label}),o.value]}),h+1<a.length&&(0,t.jsx)("div",{"data-testid":"page-info-separator",className:c.separator})]},h))})}const f=a=>({container:(0,n.css)({display:"flex",flexDirection:"row",gap:a.spacing(1.5),overflow:"auto"}),infoItem:(0,n.css)({...a.typography.bodySmall,display:"flex",flexDirection:"column",gap:a.spacing(.5)}),label:(0,n.css)({color:a.colors.text.secondary}),separator:(0,n.css)({borderLeft:`1px solid ${a.colors.border.weak}`})})},39419:(G,O,e)=>{"use strict";e.d(O,{A:()=>r});var t=e(74848),n=e(90613),i=e(39558);const r=({pageName:f=""})=>{const a=`Loading ${f}...`;return(0,t.jsx)(n.a,{display:"flex",alignItems:"center",direction:"column",justifyContent:"center",paddingTop:10,children:(0,t.jsx)(i._,{text:a})})}},7392:(G,O,e)=>{"use strict";e.d(O,{L:()=>a});var t=e(74848),n=e(32196),i=e(13544),s=e(40845),r=e(69529),f=e(72109);function a({entity:o="Page"}){const h=(0,s.of)(c);return(0,t.jsx)("div",{className:h.container,"data-testid":i.Tp.components.EntityNotFound.container,children:(0,t.jsxs)(r.p,{message:`${o} not found`,variant:"not-found",children:["We're looking but can't seem to find this ",o.toLowerCase(),". Try returning"," ",(0,t.jsx)(f.Y,{href:"/",children:"home"})," or seeking help on the"," ",(0,t.jsx)(f.Y,{href:"https://community.grafana.com",external:!0,children:"community site."})]})})}function c(o){return{container:(0,n.css)({padding:o.spacing(8,2,2,2)})}}},69444:(G,O,e)=>{"use strict";e.d(O,{Y:()=>V});var t=e(74848),n=e(32196),i=e(96540),s=e(64388),r=e(32264),f=e(40845),a=e(76888);function c({children:H,scrollRefCallback:X,scrollTop:k,divId:Y}){const Z=(0,f.of)(o),se=(0,i.useRef)(null);return(0,i.useEffect)(()=>{!r.$.featureToggles.bodyScrolling&&se.current&&X&&X(se.current)},[se,X]),(0,i.useEffect)(()=>{!r.$.featureToggles.bodyScrolling&&se.current&&k!=null&&se.current?.scrollTo(0,k)},[k]),r.$.featureToggles.bodyScrolling?H:(0,t.jsx)("div",{ref:se,className:(0,n.cx)(Z.nativeScrollbars,"scrollbar-view"),id:Y,children:H})}function o(){return{nativeScrollbars:(0,n.css)({label:"native-scroll-container",minHeight:"calc(100% + 0px)",maxHeight:"calc(100% + 0px)",display:"flex",flexDirection:"column",flexGrow:1,overflow:"auto"})}}var h=e(39419);const g=({isLoading:H,children:X,className:k})=>{let Y=k?(0,t.jsx)("div",{className:k,children:X}):X;return(0,t.jsx)(t.Fragment,{children:H?(0,t.jsx)(h.A,{}):Y})};var l=e(13773),p=e(17172),m=e(94753),y=e(29158),d=e(88575),v=e(10354);const u=({value:H,onEdit:X})=>{const k=(0,f.of)(D),[Y,Z]=(0,i.useState)(H),[se,j]=(0,i.useState)(!1),[q,ne]=(0,i.useState)(!1),[oe,z]=(0,i.useState)();(0,i.useEffect)(()=>{Z(H)},[H]);const te=(0,i.useCallback)(async le=>{const ie=le.currentTarget.value;if(!ie)z("Please enter a title");else if(ie===H)z(void 0),j(!1);else{ne(!0);try{await X(ie),z(void 0),j(!1)}catch(ae){(0,p.NF)(ae)?z(ae.data.message):ae instanceof Error&&z(ae.message)}ne(!1)}},[X,H]);return se?(0,t.jsx)("div",{className:k.inputContainer,children:(0,t.jsx)(d.D,{className:k.field,loading:q,invalid:!!oe,error:oe,children:(0,t.jsx)(v.p,{className:k.input,defaultValue:Y,onKeyDown:le=>{le.key==="Enter"&&te(le)},autoFocus:!0,onBlur:te,onChange:le=>Z(le.currentTarget.value),onFocus:()=>j(!0)})})}):(0,t.jsx)("div",{className:k.textContainer,children:(0,t.jsxs)("div",{className:k.textWrapper,children:[(0,t.jsx)(m.E,{element:"h1",truncate:!0,children:Y}),(0,t.jsx)(y.K,{name:"pen",size:"lg",tooltip:"Edit title",onClick:()=>j(!0)})]})})};u.displayName="EditableTitle";const D=H=>({textContainer:(0,n.css)({minWidth:0}),field:(0,n.css)({flex:1,left:`calc(-${H.spacing(1)} - 1px)`,position:"relative",marginBottom:0}),input:(0,n.css)({input:{...H.typography.h1}}),inputContainer:(0,n.css)({display:"flex",flex:1}),textWrapper:(0,n.css)({alignItems:"center",display:"flex",gap:H.spacing(1)})});function P({navItem:H,renderTitle:X,actions:k,info:Y,subTitle:Z,onEditTitle:se}){const j=(0,f.of)(x),q=Z??H.subTitle,ne=se?(0,t.jsx)(u,{value:H.text,onEdit:se}):(0,t.jsxs)("div",{className:j.title,children:[H.img&&(0,t.jsx)("img",{className:j.img,src:H.img,alt:`logo for ${H.text}`}),X?X(H.text):(0,t.jsx)("h1",{children:H.text})]});return(0,t.jsxs)("div",{className:j.pageHeader,children:[(0,t.jsxs)("div",{className:j.topRow,children:[(0,t.jsxs)("div",{className:j.titleInfoContainer,children:[ne,Y&&(0,t.jsx)(l.Q,{info:Y})]}),(0,t.jsx)("div",{className:j.actions,children:k})]}),q&&(0,t.jsx)("div",{className:j.subTitle,children:q})]})}const x=H=>({topRow:(0,n.css)({alignItems:"flex-start",display:"flex",flexDirection:"row",flexWrap:"wrap",gap:H.spacing(1,3)}),title:(0,n.css)({display:"flex",flexDirection:"row",maxWidth:"100%",h1:{display:"flex",marginBottom:0}}),actions:(0,n.css)({display:"flex",flexDirection:"row",gap:H.spacing(1)}),titleInfoContainer:(0,n.css)({display:"flex",label:"title-info-container",flex:1,flexWrap:"wrap",gap:H.spacing(1,4),justifyContent:"space-between",maxWidth:"100%",minWidth:"200px"}),pageHeader:(0,n.css)({label:"page-header",display:"flex",flexDirection:"column",gap:H.spacing(1),marginBottom:H.spacing(2)}),subTitle:(0,n.css)({position:"relative",color:H.colors.text.secondary}),img:(0,n.css)({width:"32px",height:"32px",marginRight:H.spacing(2)})});var E=e(63021),C=e(8984),M=e(40675);function S({navItem:H}){const X=(0,f.of)(I);return(0,t.jsx)("div",{className:X.tabsWrapper,children:(0,t.jsx)(E.U,{children:H.children.map((k,Y)=>{const Z=k.icon?(0,C.toIconName)(k.icon):void 0;return!k.hideFromTabs&&(0,t.jsx)(M.o,{label:k.text,active:k.active,icon:Z,counter:k.tabCounter,href:k.url,suffix:k.tabSuffix,onChangeTab:k.onClick},`${k.url}-${Y}`)})})})}const I=H=>({tabsWrapper:(0,n.css)({paddingBottom:H.spacing(3)})});var T=e(25508),b=e(17422),R=e(99140),A=e(31678);function L(H,X){if(X)return X;if(H&&R.M_)return(0,A.useSelector)((0,T.Mz)(U,k=>(0,b.tc)(k,H??"home")))}function U(H){return H.navIndex}var W=e(28215),w=e(19361),N=e(3984);function B(H,X){const k=(0,A.useSelector)(Y=>Y.navIndex)?.[W.Id];(0,i.useEffect)(()=>{const Y=(H?.node!==H?.main?H?.node:H?.main)??{text:"Grafana"},Z=(0,N.Z)(Y,X,k).map(se=>se.text).reverse();Z[Z.length-1]=w.M.AppTitle,document.title=Z.join(" - ")},[k,H,X])}const V=({navId:H,navModel:X,pageNav:k,renderTitle:Y,onEditTitle:Z,actions:se,subTitle:j,children:q,className:ne,info:oe,layout:z=s.k.Standard,scrollTop:te,scrollRef:le,...ie})=>{const ae=(0,f.of)(K),re=L(H,X),{chrome:ce}=(0,a.Il)();B(re,k);const me=k??re?.node;return(0,i.useLayoutEffect)(()=>{re&&ce.update({sectionNav:re,pageNav:k,layout:z})},[re,k,ce,z]),(0,t.jsxs)("div",{className:(0,n.cx)(ae.wrapper,ne),...ie,children:[z===s.k.Standard&&(0,t.jsx)(c,{divId:"page-scrollbar",autoHeightMin:"100%",scrollTop:te,scrollRefCallback:le,children:(0,t.jsxs)("div",{className:ae.pageInner,children:[me&&(0,t.jsx)(P,{actions:se,onEditTitle:Z,navItem:me,renderTitle:Y,info:oe,subTitle:j}),k&&k.children&&(0,t.jsx)(S,{navItem:k}),(0,t.jsx)("div",{className:ae.pageContent,children:q})]})}),z===s.k.Canvas&&(0,t.jsx)(c,{divId:"page-scrollbar",autoHeightMin:"100%",scrollTop:te,scrollRefCallback:le,children:(0,t.jsx)("div",{className:ae.canvasContent,children:q})}),z===s.k.Custom&&q]})};V.Contents=g;const K=H=>({wrapper:(0,n.css)(r.$.featureToggles.bodyScrolling?{label:"page-wrapper",display:"flex",flex:"1 1 0",flexDirection:"column",position:"relative"}:{label:"page-wrapper",height:"100%",display:"flex",flex:"1 1 0",flexDirection:"column",minHeight:0}),pageContent:(0,n.css)({label:"page-content",flexGrow:1}),primaryBg:(0,n.css)({background:H.colors.background.primary}),pageInner:(0,n.css)({label:"page-inner",padding:H.spacing(2),borderBottom:"none",background:H.colors.background.primary,display:"flex",flexDirection:"column",flexGrow:1,margin:H.spacing(0,0,0,0),[H.breakpoints.up("md")]:{padding:H.spacing(4)}}),canvasContent:(0,n.css)({label:"canvas-content",display:"flex",flexDirection:"column",padding:H.spacing(2),flexBasis:"100%",flexGrow:1})})},68313:(G,O,e)=>{"use strict";e.d(O,{$:()=>h});var t=e(74848),n=e(32196),i=e(96540),s=e(32264),r=e(40845),f=e(55852),a=e(90182),c=e(14578),o=e(17706);const h=({onChange:l,maxMenuHeight:p,isWidget:m=!1})=>{const y=()=>s.$.featureToggles.vizAndWidgetSplit?m?(0,o.nr)():(0,o.if)():(0,o.A4)(),d=(0,i.useMemo)(y,[m]),v=(0,i.useMemo)(()=>d.map(C=>({label:C.name,imgUrl:C.info.logos.small,value:C})).sort((C,M)=>C.label?.localeCompare(M.label)),[d]),[u,D]=(0,i.useState)([]),P=(0,i.useCallback)(C=>{const M=C.filter(S=>S.value).map(S=>S.value);l(M),D(C)},[l]),x=(0,r.of)(g),E={defaultOptions:!0,getOptionLabel:C=>C.label,getOptionValue:C=>C.value,noOptionsMessage:"No Panel types found",placeholder:"Filter by type",maxMenuHeight:p,options:v,value:u,onChange:P};return(0,t.jsxs)("div",{className:x.container,children:[u.length>0&&(0,t.jsx)(f.$n,{size:"xs",icon:"trash-alt",fill:"text",className:x.clear,onClick:()=>P([]),"aria-label":"Clear types",children:"Clear types"}),(0,t.jsx)(a.KF,{...E,prefix:(0,t.jsx)(c.I,{name:"filter"}),"aria-label":"Panel Type filter"})]})};function g(l){return{container:(0,n.css)`
      label: container;
      position: relative;
      min-width: 180px;
      flex-grow: 1;
    `,clear:(0,n.css)`
      label: clear;
      font-size: ${l.spacing(1.5)};
      position: absolute;
      top: -${l.spacing(4.5)};
      right: 0;
    `}}},78361:(G,O,e)=>{"use strict";e.d(O,{s:()=>f});var t=e(74848),n=e(96540),i=e(13544),s=e(10354),r=e(29158);const f=(0,n.forwardRef)((a,c)=>{const[o,h]=(0,n.useState)(!1);return(0,t.jsx)(s.p,{...a,type:o?"text":"password","data-testid":i.Tp.pages.Login.password,ref:c,suffix:(0,t.jsx)(r.K,{name:o?"eye-slash":"eye","aria-controls":a.id,role:"switch","aria-checked":o,onClick:()=>{h(!o)},tooltip:o?"Hide password":"Show password"})})});f.displayName="PasswordField"},22214:(G,O,e)=>{"use strict";e.d(O,{j:()=>f});var t=e(74848),n=e(32196),i=e(96540),s=e(36663),r=e(40845);const f=i.memo(i.forwardRef(({className:o,children:h,markdown:g,styleOverrides:l,onRemove:p,...m},y)=>{const d=(0,r.of)(v=>c(v,l?.borderTop));return(0,t.jsxs)("div",{className:(0,n.cx)(d.wrapper,o),...m,ref:y,children:[g&&a(g),h]})}));function a(o){const h=(0,s.G)(o);return(0,t.jsx)("div",{className:"markdown-html",dangerouslySetInnerHTML:{__html:h}})}f.displayName="OperationRowHelp";const c=(o,h)=>{const g=o.shape.radius.default,l=o.colors.background.secondary;return{wrapper:(0,n.css)`
      padding: ${o.spacing(2)};
      border: 2px solid ${l};
      border-top: ${h?h+l:"none"};
      border-radius: 0 0 ${g} ${g};
      position: relative;
      top: -4px;
    `}}},10343:(G,O,e)=>{"use strict";e.d(O,{A:()=>c,q:()=>a});var t=e(74848),n=e(32196),i=e(13544),s=e(40845),r=e(29158);function f(h){const g=(0,s.of)(o);return(0,t.jsx)("div",{className:(0,n.cx)(g.icon,"active"in h&&h.active&&g.active),children:(0,t.jsx)(r.K,{name:h.icon,tooltip:h.title,className:g.icon,disabled:!!h.disabled,onClick:h.onClick,type:"button","data-testid":h.dataTestId??i.Tp.components.QueryEditorRow.actionButton(h.title),..."active"in h&&{"aria-pressed":h.active}})})}function a(h){return(0,t.jsx)(f,{...h})}const c=h=>(0,t.jsx)(f,{...h}),o=h=>({icon:(0,n.css)({display:"flex",position:"relative",color:h.colors.text.secondary}),active:(0,n.css)({"&:before":{display:"block",content:'" "',position:"absolute",left:-1,right:2,height:3,borderRadius:h.shape.radius.default,bottom:-8,backgroundImage:h.colors.gradients.brandHorizontal}})})},7788:(G,O,e)=>{"use strict";e.d(O,{u:()=>y});var t=e(74848),n=e(32196),i=e(38127),s=e(96540),r=e(22589),f=e(14110),a=e(40845),c=e(67892),o=e(29158),h=e(67061),g=e(14578),l=e(8484);const p=({actionsElement:v,disabled:u,draggable:D,collapsable:P=!0,dragHandleProps:x,headerElement:E,isContentVisible:C,onRowToggle:M,reportDragMousePosition:S,title:I,id:T,expanderMessages:b})=>{const R=(0,a.of)(m);let A=C?(0,l.t)("query-operation.header.collapse-row","Collapse query row"):(0,l.t)("query-operation.header.expand-row","Expand query row");b!==void 0&&C?A=b.close:b!==void 0&&(A=b?.open);const L=(0,l.t)("query-operation.header.drag-and-drop","Drag and drop to reorder");return(0,t.jsxs)("div",{className:R.header,children:[(0,t.jsxs)("div",{className:R.column,children:[P&&(0,t.jsx)(o.K,{name:C?"angle-down":"angle-right",tooltip:A,className:R.collapseIcon,onClick:M,"aria-expanded":C,"aria-controls":T}),I&&(0,t.jsx)("div",{className:R.titleWrapper,onClick:M,"aria-label":"Query operation row title",children:(0,t.jsx)("div",{className:(0,n.cx)(R.title,u&&R.disabled),children:I})}),E]}),(0,t.jsxs)(h.B,{gap:1,alignItems:"center",children:[v,D&&(0,t.jsx)("div",{onMouseMove:S,...x,children:(0,t.jsx)(g.I,{title:L,name:"draggabledots",size:"lg",className:R.dragIcon})})]})]})},m=v=>({header:(0,n.css)`
    label: Header;
    padding: ${v.spacing(.5,.5)};
    border-radius: ${v.shape.radius.default};
    background: ${v.colors.background.secondary};
    min-height: ${v.spacing(4)};
    display: grid;
    grid-template-columns: minmax(100px, max-content) min-content;
    align-items: center;
    justify-content: space-between;
    white-space: nowrap;

    &:focus {
      outline: none;
    }
  `,column:(0,n.css)`
    label: Column;
    display: flex;
    align-items: center;
  `,dragIcon:(0,n.css)`
    cursor: grab;
    color: ${v.colors.text.disabled};
    margin: ${v.spacing(0,.5)};
    &:hover {
      color: ${v.colors.text};
    }
  `,collapseIcon:(0,n.css)`
    margin-left: ${v.spacing(.5)};
    color: ${v.colors.text.disabled};
    }
  `,titleWrapper:(0,n.css)`
    display: flex;
    align-items: center;
    flex-grow: 1;
    cursor: pointer;
    overflow: hidden;
    margin-right: ${v.spacing(.5)};
  `,title:(0,n.css)`
    font-weight: ${v.typography.fontWeightBold};
    color: ${v.colors.text.link};
    margin-left: ${v.spacing(.5)};
    overflow: hidden;
    text-overflow: ellipsis;
  `,disabled:(0,n.css)`
    color: ${v.colors.text.disabled};
  `});p.displayName="QueryOperationRowHeader";function y({children:v,actions:u,title:D,headerElement:P,onClose:x,onOpen:E,isOpen:C,disabled:M,draggable:S,collapsable:I,index:T,id:b,expanderMessages:R}){const[A,L]=(0,s.useState)(C!==void 0?C:!0),U=(0,a.of)(d),W=(0,s.useCallback)(()=>{L(!A)},[A,L]);(0,s.useEffect)(()=>{typeof C=="boolean"&&L(C)},[C]);const w=(0,s.useCallback)(K=>{if(K.defaultPrevented){const H=K.currentTarget.getBoundingClientRect(),X=K.clientX-H.left,k=K.clientY-H.top;(0,f.rR)("query_row_reorder_drag_position",{x:X/H.width,y:k/H.height,width:H.width,height:H.height})}},[]);(0,r.A)(()=>{A?E&&E():x&&x()},[A]);const N={isOpen:A,onOpen:()=>{L(!0)},onClose:()=>{L(!1)}},B=u&&c.renderOrCallToRender(u,N),V=P&&c.renderOrCallToRender(P,N);return S?(0,t.jsx)(i.sx,{draggableId:b,index:T,children:K=>(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{ref:K.innerRef,className:U.wrapper,...K.draggableProps,children:[(0,t.jsx)("div",{children:(0,t.jsx)(p,{id:b,actionsElement:B,disabled:M,draggable:!0,collapsable:I,dragHandleProps:K.dragHandleProps,headerElement:V,isContentVisible:A,onRowToggle:W,reportDragMousePosition:w,title:D,expanderMessages:R})}),A&&(0,t.jsx)("div",{className:U.content,children:v})]})})}):(0,t.jsxs)("div",{className:U.wrapper,children:[(0,t.jsx)(p,{id:b,actionsElement:B,disabled:M,draggable:!1,collapsable:I,headerElement:V,isContentVisible:A,onRowToggle:W,reportDragMousePosition:w,title:D,expanderMessages:R}),A&&(0,t.jsx)("div",{className:U.content,children:v})]})}const d=v=>({wrapper:(0,n.css)`
      margin-bottom: ${v.spacing(2)};
    `,content:(0,n.css)`
      margin-top: ${v.spacing(.5)};
      margin-left: ${v.spacing(3)};
    `});y.displayName="QueryOperationRow"},37425:(G,O,e)=>{"use strict";e.d(O,{n:()=>me});var t=e(74848),n=e(96540),i=e(40845),s=e(8866),r=e(17464),f=e(32196),a=e(62930),c=e(14578),o=e(56034),h=e(10354),g=e(87266),l=e(16797),p=e(88824);const m=(0,n.forwardRef)(({children:ee,iconName:de},De)=>{const fe=(0,i.of)(y);return(0,t.jsxs)("div",{className:fe.container,ref:De,children:[de&&(0,t.jsx)(c.I,{name:de,size:"xs"}),ee]})});m.displayName="ValueContainer";const y=ee=>{const{prefix:de}=(0,h.n)({theme:ee}),{multiValueContainer:De}=(0,p.J)(ee);return{container:(0,f.cx)(de,De,(0,f.css)`
        position: relative;
        padding: ${ee.spacing(.5,1,.5,1)};

        svg {
          margin-right: ${ee.spacing(.5)};
        }
      `)}},d=360,v=300,u=320,D=360,P=320,x=360,E=D+x,C=ee=>ee.stopPropagation(),M=({appliedRoles:ee,basicRole:de,disabled:De,isFocused:fe,query:Te,showBasicRole:je,width:He,isLoading:Be,onOpen:Ne,onClose:Re,onQueryChange:Se,...We})=>{const Ke=(0,i.of)(I,!1,!!fe,!!De,!1,He),Xe=(0,n.useRef)(null);(0,n.useEffect)(()=>{fe&&Xe.current?.focus()});const Je=pt=>{const xt=pt.target?.value;Se(xt)},st=je&&de!=="None";return fe?(0,t.jsxs)("div",{className:Ke.wrapper,children:[st&&(0,t.jsx)(m,{children:de}),ee.map(pt=>(0,t.jsx)(m,{children:pt.group+":"+(pt.displayName||pt.name)},pt.uid)),!De&&(0,t.jsx)("input",{...We,className:Ke.input,ref:Xe,onMouseDown:C,onChange:Je,"data-testid":"role-picker-input",placeholder:fe?"Select role":"",value:Te}),(0,t.jsx)("div",{className:Ke.suffix,children:(0,t.jsx)(c.I,{name:"angle-up",className:Ke.dropdownIndicator,onMouseDown:Re})})]}):(0,t.jsxs)("div",{className:(0,f.cx)(Ke.wrapper,Ke.selectedRoles),onMouseDown:Ne,children:[st&&(0,t.jsx)(m,{children:de}),(0,t.jsx)(S,{appliedRoles:ee,numberOfRoles:ee.length,showBuiltInRole:st}),Be&&(0,t.jsx)("div",{className:Ke.spinner,children:(0,t.jsx)(a.y,{size:16,inline:!0})})]})};M.displayName="RolePickerInput";const S=({showBuiltInRole:ee,numberOfRoles:de,appliedRoles:De})=>{const fe=(0,i.of)(Te=>T(Te));return(0,t.jsx)(t.Fragment,{children:de?(0,t.jsx)(o.m,{content:(0,t.jsx)("div",{className:fe.tooltip,children:De?.map(Te=>(0,t.jsx)("p",{children:Te.group+":"+(Te.displayName||Te.name)},Te.uid))}),children:(0,t.jsx)(m,{children:`${ee?"+":""}${de} role${de>1?"s":""}`})}):!ee&&(0,t.jsx)(m,{children:"No roles assigned"})})},I=(ee,de,De,fe,Te,je)=>{const He=(0,h.n)({theme:ee,invalid:de});return{wrapper:(0,f.cx)(He.wrapper,(0,g.Xb)(ee,de),De&&(0,f.css)`
          ${l.focusCss(ee.v1)}
        `,fe&&He.inputDisabled,(0,f.css)({minWidth:je||d+"px",width:je,minHeight:"32px",height:"auto",flexDirection:"row",paddingRight:ee.spacing(1),maxWidth:"100%",alignItems:"center",display:"flex",flexWrap:"wrap",justifyContent:"flex-start",position:"relative",boxSizing:"border-box",cursor:"default"}),Te&&(0,f.css)`
          padding-left: 0;
        `),input:(0,f.cx)((0,g.Xb)(ee,de),(0,f.css)`
        max-width: 120px;
        border: none;
        cursor: ${De?"default":"pointer"};
      `),suffix:He.suffix,dropdownIndicator:(0,f.css)`
      cursor: pointer;
    `,selectedRoles:(0,f.css)`
      display: flex;
      align-items: center;
      cursor: ${fe?"not-allowed":"pointer"};
    `,tooltip:(0,f.css)`
      p {
        margin-bottom: ${ee.spacing(.5)};
      }
    `,spinner:(0,f.css)({display:"flex",flexGrow:1,justifyContent:"flex-end"})}},T=ee=>({tooltip:(0,f.css)`
    p {
      margin-bottom: ${ee.spacing(.5)};
    }
  `});var b=e(72109),R=e(40276),A=e(67061),L=e(55852),U=e(83186),W=e(31678);const w=ee=>({hideScrollBar:(0,f.css)({".scrollbar-view":{"&::-webkit-scrollbar":{display:"none"},scrollbarWidth:"none"}}),menuWrapper:(0,f.css)({display:"flex",maxHeight:"650px",position:"absolute",zIndex:ee.zIndex.dropdown,overflow:"hidden",minWidth:"auto"}),menu:(0,f.css)({minWidth:`${u}px`,maxWidth:`${D}px`,"& > div":{paddingTop:ee.spacing(1)}}),menuLeft:(0,f.css)({flexDirection:"row-reverse"}),subMenu:(0,f.css)({height:"100%",minWidth:`${P}px`,maxWidth:`${x}px`,display:"flex",flexDirection:"column",borderLeft:`1px solid ${ee.components.input.borderColor}`,"& > div":{paddingTop:ee.spacing(1)}}),subMenuLeft:(0,f.css)({borderRight:`1px solid ${ee.components.input.borderColor}`,borderLeft:"unset"}),groupHeader:(0,f.css)({padding:ee.spacing(0,4.5),display:"flex",alignItems:"center",color:ee.colors.text.primary,fontWeight:ee.typography.fontWeightBold}),container:(0,f.css)({padding:ee.spacing(1),border:`1px ${ee.colors.border.weak} solid`,borderRadius:ee.shape.radius.default,backgroundColor:ee.colors.background.primary,zIndex:ee.zIndex.modal}),menuSection:(0,f.css)({marginBottom:ee.spacing(2)}),menuOptionCheckbox:(0,f.css)({display:"flex",margin:ee.spacing(0,1,0,.25)}),menuButtonRow:(0,f.css)({backgroundColor:ee.colors.background.primary,padding:ee.spacing(1)}),menuOptionBody:(0,f.css)({fontWeight:ee.typography.fontWeightRegular,padding:ee.spacing(0,1.5,0,0)}),menuOptionDisabled:(0,f.css)({color:ee.colors.text.disabled,cursor:"not-allowed"}),menuOptionExpand:(0,f.css)({position:"absolute",right:ee.spacing(2.5),color:ee.colors.text.disabled,"&:after":{content:'">"'}}),menuOptionInfoSign:(0,f.css)({color:ee.colors.text.disabled}),basicRoleSelector:(0,f.css)({margin:ee.spacing(1,1.25,1,1.5)}),subMenuPortal:(0,f.css)({height:"100%","> div":{height:"100%"}}),subMenuButtonRow:(0,f.css)({backgroundColor:ee.colors.background.primary,padding:ee.spacing(1)}),checkboxPartiallyChecked:(0,f.css)({input:{"&:checked + span":{"&:after":{borderWidth:"0 3px 0px 0",transform:"rotate(90deg)"}}}}),loadingSpinner:(0,f.css)({marginLeft:ee.spacing(1)})}),N=Object.values(W.OrgRole).map(ee=>({label:ee===W.OrgRole.None?"No basic role":ee,value:ee})),B=({value:ee,onChange:de,disabled:De,disabledMesssage:fe,tooltipMessage:Te})=>{const je=(0,i.of)(w),He=(0,i.$j)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:je.groupHeader,children:[(0,t.jsx)("span",{style:{marginRight:He.spacing(1)},children:"Basic roles"}),De&&fe&&(0,t.jsx)(o.m,{placement:"right-end",interactive:!0,content:(0,t.jsx)("div",{children:fe}),children:(0,t.jsx)(c.I,{name:"question-circle"})}),!De&&Te&&(0,t.jsx)(o.m,{placement:"right-end",interactive:!0,content:Te,children:(0,t.jsx)(c.I,{name:"info-circle",size:"xs"})})]}),(0,t.jsx)(U.a,{name:"Basic Role Selector",className:je.basicRoleSelector,options:N,value:ee,onChange:de,disabled:De})]})};var V=e(10880);const K=(0,n.memo)(n.forwardRef(({name:ee,value:de,isFocused:De,isSelected:fe,partiallySelected:Te,disabled:je,onChange:He,onClick:Be,onOpenSubMenu:Ne,onCloseSubMenu:Re,children:Se,root:We},Ke)=>{const Xe=(0,i.$j)(),Je=(0,p.J)(Xe),st=(0,i.of)(w),pt=(0,f.cx)(Je.option,De&&Je.optionFocused,je&&st.menuOptionDisabled),xt=be=>{je||de&&He(de)},ot=be=>{Be&&Be(de)},$e=()=>{Ne&&Ne(de)},ve=()=>{Re&&Re()};return(0,t.jsx)("div",{onMouseEnter:$e,onMouseLeave:ve,children:(0,t.jsxs)("div",{ref:Ke,className:pt,"aria-label":"Role picker option",onClick:ot,children:[(0,t.jsx)(V.S,{value:fe,className:(0,f.cx)(st.menuOptionCheckbox,{[st.checkboxPartiallyChecked]:Te}),onChange:xt,disabled:je}),(0,t.jsxs)("div",{className:(0,f.cx)(Je.optionBody,st.menuOptionBody),children:[(0,t.jsx)("span",{children:ee}),(0,t.jsx)("span",{className:st.menuOptionExpand})]}),We&&Se&&(0,t.jsx)(r.ZL,{className:st.subMenuPortal,root:We,children:Se})]})})}));K.displayName="RoleMenuGroupOption";const H=(0,n.forwardRef)(({data:ee,isFocused:de,isSelected:De,disabled:fe,onChange:Te,hideDescription:je},He)=>{const Be=(0,i.$j)(),Ne=(0,p.J)(Be),Re=(0,i.of)(w),Se=(0,f.cx)(Ne.option,de&&Ne.optionFocused,fe&&Re.menuOptionDisabled),We=Ke=>{fe||(Ke.preventDefault(),Ke.stopPropagation(),Te(ee))};return(0,t.jsxs)("div",{ref:He,className:Se,"aria-label":"Role picker option",onClick:We,children:[(0,t.jsx)(V.S,{value:De,className:Re.menuOptionCheckbox,onChange:We,disabled:fe}),(0,t.jsxs)("div",{className:(0,f.cx)(Ne.optionBody,Re.menuOptionBody),children:[(0,t.jsx)("span",{children:ee.displayName||ee.name}),!je&&ee.description&&(0,t.jsx)("div",{className:Ne.optionDescription,children:ee.description})]}),ee.description&&(0,t.jsx)(o.m,{content:ee.description,children:(0,t.jsx)(c.I,{name:"info-circle",className:Re.menuOptionInfoSign})})]})});H.displayName="RoleMenuOption";var X=e(3246);const k=({options:ee,selectedOptions:de,disabledOptions:De,onSelect:fe,onClear:Te,showOnLeft:je})=>{const He=(0,i.$j)(),Be=(0,p.J)(He),Ne=(0,i.of)(w),Re=async()=>{Te&&Te()};return(0,t.jsxs)("div",{className:(0,f.cx)(Ne.subMenu,{[Ne.subMenuLeft]:je}),"aria-label":"Role picker submenu",children:[(0,t.jsx)(R.E,{autoHide:!1,autoHeightMax:`${v}px`,hideHorizontalTrack:!0,children:(0,t.jsx)("div",{className:Be.optionBody,children:ee.map((Se,We)=>(0,t.jsx)(H,{data:Se,isSelected:!!(Se.uid&&(de.find(Ke=>Ke.uid===Se.uid)||De?.find(Ke=>Ke.uid===Se.uid))),disabled:!!(Se.uid&&De?.find(Ke=>Ke.uid===Se.uid))||(0,X.W)(Se),onChange:fe,hideDescription:!0},We))})}),(0,t.jsx)("div",{className:Ne.subMenuButtonRow,children:(0,t.jsx)(A.B,{justifyContent:"flex-end",children:(0,t.jsx)(L.$n,{size:"sm",fill:"text",onClick:Re,children:"Clear"})})})]})},Y=(0,n.forwardRef)(({roles:ee,renderedName:de,showGroups:De,optionGroups:fe,onGroupChange:Te,groupSelected:je,groupPartiallySelected:He,subMenuNode:Be,selectedOptions:Ne,onRoleChange:Re,onClearSubMenu:Se,showOnLeftSubMenu:We},Ke)=>{const[Xe,Je]=(0,n.useState)(!1),[st,pt]=(0,n.useState)(""),xt=(0,i.$j)(),ot=(0,p.J)(xt),$e=(0,i.of)(w),ve=(0,n.useCallback)(he=>{pt(he),Je(!0)},[]),be=(0,n.useCallback)(()=>{Je(!1),pt("")},[]);return(0,t.jsx)("div",{children:ee.length>0&&(0,t.jsxs)("div",{className:$e.menuSection,children:[(0,t.jsx)("div",{className:$e.groupHeader,children:de}),(0,t.jsx)("div",{className:ot.optionBody}),De&&fe?.length?fe.map(he=>(0,t.jsx)(K,{name:he.name,value:he.value,isSelected:je(he.value)||He(he.value),partiallySelected:He(he.value),disabled:he.options?.every(X.W),onChange:Te,onOpenSubMenu:ve,onCloseSubMenu:be,root:Be,isFocused:Xe&&st===he.value,children:Xe&&st===he.value&&(0,t.jsx)(k,{options:he.options,selectedOptions:Ne,onSelect:Re,onClear:()=>Se(st),showOnLeft:We})},he.value)):ee.map(he=>(0,t.jsx)(H,{data:he,isSelected:!!(he.uid&&Ne.find(ye=>ye.uid===he.uid)),disabled:(0,X.W)(he),onChange:Re,hideDescription:!0},he.uid))]})})});Y.displayName="RoleMenuGroupsSection";var Z=(ee=>(ee.fixed="fixed",ee.custom="custom",ee.plugin="plugin",ee))(Z||{});const se={ldap:"LDAP",current:"Current org"},j=(0,t.jsxs)(t.Fragment,{children:['You can now select the "No basic role" option and add permissions to your custom needs. You can find more information in\xA0',(0,t.jsx)(b.Y,{href:"https://grafana.com/docs/grafana/latest/administration/roles-and-permissions/#organization-roles",variant:"bodySmall",external:!0,children:"our documentation"}),"."]}),q=({basicRole:ee,options:de,appliedRoles:De,showGroups:fe,basicRoleDisabled:Te,disabledMessage:je,showBasicRole:He,onSelect:Be,onBasicRoleSelect:Ne,onUpdate:Re,updateDisabled:Se,offset:We,menuLeft:Ke,apply:Xe})=>{const[Je,st]=(0,n.useState)(De),[pt,xt]=(0,n.useState)(ee),[ot,$e]=(0,n.useState)({}),ve=(0,n.useRef)(null),be=(0,i.$j)(),he=(0,p.J)(be),ye=(0,i.of)(w);(0,n.useEffect)(()=>{Be(Je)},[Je,Be]),(0,n.useEffect)(()=>{Ne&&pt&&Ne(pt)},[pt,Ne]),(0,n.useEffect)(()=>{const ct=de.filter(ne).sort(re),vt=de.filter(oe).sort(re),Pt=de.filter(z).sort(re),Vt={fixed:te(vt).sort((Jt,wt)=>Jt.name.localeCompare(wt.name)),custom:te(ct).sort((Jt,wt)=>Jt.name.localeCompare(wt.name)),plugin:te(Pt).sort((Jt,wt)=>Jt.name.localeCompare(wt.name))};$e({fixed:{groupType:"fixed",optionGroup:Vt.fixed,renderedName:"Fixed roles",roles:vt},custom:{groupType:"custom",optionGroup:Vt.custom,renderedName:"Custom roles",roles:ct},plugin:{groupType:"plugin",optionGroup:Vt.plugin,renderedName:"Plugin roles",roles:Pt}})},[de]);const Pe=ct=>{const vt=[];for(const Pt of Je)le(Pt)===ct&&vt.push(Pt);return vt},ge=(ct,vt)=>{const Pt=Pe(vt),Vt=ot[ct]?.optionGroup.find(Jt=>Jt.value===vt);return Pt.length>0&&Pt.length>=Vt.options.length},xe=(ct,vt)=>{const Pt=Pe(vt),Vt=ot[ct]?.optionGroup.find(Jt=>Jt.value===vt);return Pt.length>0&&Pt.length<Vt.options.length},Ae=ct=>{Je.find(vt=>vt.uid===ct.uid)?st(Je.filter(vt=>vt.uid!==ct.uid)):st([...Je,ct])},Ee=(ct,vt)=>{const Pt=ot[ct]?.optionGroup.find(Vt=>Vt.value===vt);if(Pt)if(ge(ct,vt)||xe(ct,vt))st(Je.filter(Vt=>!Pt.options.find(Jt=>Vt.uid===Jt.uid)));else{const Vt=Pt.options.filter(wt=>wt.delegatable),Jt=Je.filter(wt=>!Pt.options.find(zt=>wt.uid===zt.uid));st([...Jt,...Vt])}},Ie=ct=>{xt(ct)},Qe=async()=>{st([])},at=ct=>{const vt=Je.filter(Pt=>le(Pt)!==ct);st(vt)},ft=()=>{Re(Je,pt)};return(0,t.jsxs)("div",{className:(0,f.cx)(he.menu,ye.menuWrapper,{[ye.menuLeft]:Ke},(0,f.css)({top:`${We.vertical}px`,left:Ke?"unset":`${We.horizontal}px`,right:Ke?`${We.horizontal}px`:"unset"})),children:[(0,t.jsxs)("div",{className:ye.menu,"aria-label":"Role picker menu",children:[(0,t.jsxs)(R.E,{autoHide:!1,autoHeightMax:`${v}px`,hideHorizontalTrack:!0,hideVerticalTrack:!0,className:(0,f.cx)(ye.hideScrollBar),children:[He&&(0,t.jsx)("div",{className:ye.menuSection,children:(0,t.jsx)(B,{value:pt,onChange:Ie,disabled:Te,disabledMesssage:je,tooltipMessage:j})}),Object.entries(ot).map(([ct,vt])=>(0,t.jsx)(Y,{roles:vt.roles,renderedName:vt.renderedName,showGroups:fe,optionGroups:vt.optionGroup,groupSelected:Pt=>ge(vt.groupType,Pt),groupPartiallySelected:Pt=>xe(vt.groupType,Pt),onGroupChange:Pt=>Ee(vt.groupType,Pt),subMenuNode:ve?.current,selectedOptions:Je,onRoleChange:Ae,onClearSubMenu:at,showOnLeftSubMenu:Ke},ct))]}),(0,t.jsx)("div",{className:ye.menuButtonRow,children:(0,t.jsxs)(A.B,{justifyContent:"flex-end",children:[(0,t.jsx)(L.$n,{size:"sm",fill:"text",onClick:Qe,disabled:Se,children:"Clear all"}),(0,t.jsx)(L.$n,{size:"sm",onClick:ft,disabled:Se,children:Xe?"Apply":"Update"})]})})]}),(0,t.jsx)("div",{ref:ve})]})},ne=ee=>!ee.name?.startsWith("fixed:")&&!ee.name.startsWith("plugins:"),oe=ee=>ee.name?.startsWith("fixed:"),z=ee=>ee.name?.startsWith("plugins:"),te=ee=>{const de={};return ee.forEach(fe=>{const Te=le(fe),je=ie(fe);de[Te]||(de[Te]={name:je,roles:[]}),de[Te].roles.push(fe)}),Object.entries(de).map(([fe,Te])=>({name:se[fe]||ce(Te.name),value:fe,options:Te.roles.sort(re)}))},le=ee=>{const de=ae(ee),De=ie(ee);return`${de}:${De}`},ie=ee=>ee.group||"Other",ae=ee=>{const de=ee.name.indexOf(":");return de<0?"unknown":ee.name.substring(0,de)},re=(ee,de)=>ee.name.localeCompare(de.name),ce=ee=>ee.slice(0,1).toUpperCase()+ee.slice(1),me=({basicRole:ee,appliedRoles:de,roleOptions:De,disabled:fe,isLoading:Te,basicRoleDisabled:je,basicRoleDisabledMessage:He,showBasicRole:Be,onRolesChange:Ne,onBasicRoleChange:Re,canUpdateRoles:Se=!0,apply:We=!1,maxWidth:Ke=d,width:Xe})=>{const[Je,st]=(0,n.useState)(!1),[pt,xt]=(0,n.useState)(de),[ot,$e]=(0,n.useState)(ee),[ve,be]=(0,n.useState)(""),[he,ye]=(0,n.useState)({vertical:0,horizontal:0}),[Pe,ge]=(0,n.useState)(!1),xe=(0,n.useRef)(null),Ae=(0,i.$j)(),Ee=typeof Xe=="number"?Ae.spacing(Xe):Xe;(0,n.useEffect)(()=>{$e(ee),xt(de)},[de,ee,Re]);const Ie=(0,n.useCallback)(()=>{const{horizontal:zt,vertical:on,menuToLeft:Pn}=Qe();zt&&on&&(ye({horizontal:zt,vertical:on}),ge(Pn))},[]);(0,n.useEffect)(()=>{Je&&Ie()},[Je,pt,Ie]);const Qe=()=>{const zt=xe?.current?.getBoundingClientRect();if(!zt)return{};const{bottom:on,top:Pn,left:_n,right:Cn}=zt;let Ye=_n,Dt=!1;const yt=window.innerHeight-on;let Ft=on+5,an=!1;return yt<v+20&&(Ft=Pn-v-50),Pn<v+50&&(Ft=Pn,Ye=Cn+5,an=!0),Ye+E>window.innerWidth&&(Ye=window.innerWidth-(an?_n:Cn),Dt=!0),{horizontal:Ye,vertical:Ft,menuToLeft:Dt}},at=(0,n.useCallback)(zt=>{fe||(zt.preventDefault(),zt.stopPropagation(),Ie(),st(!0))},[fe,Ie]),ft=(0,n.useCallback)(()=>{st(!1),be(""),xt(de),$e(ee)},[de,ee]),ct=()=>Je&&ft(),vt=zt=>{be(zt||"")},Pt=zt=>{xt(zt)},Vt=zt=>{$e(zt)},Jt=(zt,on)=>{Re&&on&&on!==ee&&Re(on),Se&&Ne(zt),be(""),st(!1)},wt=()=>{const zt=De.map(on=>({...on,delegatable:Se&&on.delegatable}));return ve&&ve.trim()!==""?zt.filter(on=>on.name?.toLowerCase().includes(ve.toLowerCase())):zt};return(0,t.jsx)("div",{"data-testid":"role-picker",style:{position:"relative",maxWidth:Ee||Ke,width:Ee},ref:xe,children:(0,t.jsxs)(s.N,{onClick:ct,useCapture:!1,children:[(0,t.jsx)(M,{basicRole:ot,appliedRoles:pt,query:ve,onQueryChange:vt,onOpen:at,onClose:ft,isFocused:Je,disabled:fe,showBasicRole:Be,width:Ee,isLoading:Te}),Je&&(0,t.jsx)(r.ZL,{children:(0,t.jsx)("div",{onClick:zt=>zt.stopPropagation(),children:(0,t.jsx)(q,{options:wt(),basicRole:ot,appliedRoles:de,onBasicRoleSelect:Vt,onSelect:Pt,onUpdate:Jt,showGroups:ve.length===0||ve.trim()==="",basicRoleDisabled:je,disabledMessage:He,showBasicRole:Be,updateDisabled:je&&!Se,apply:We,offset:he,menuLeft:Pe})})})]})})}},89062:(G,O,e)=>{"use strict";e.d(O,{y:()=>c});var t=e(74848),n=e(96540),i=e(41053),s=e(10096),r=e(31678),f=e(37425),a=e(85927);const c=({basicRole:o,roles:h,userId:g,orgId:l,onBasicRoleChange:p,roleOptions:m,disabled:y,basicRoleDisabled:d,basicRoleDisabledMessage:v,apply:u=!1,onApplyRoles:D,pendingRoles:P,maxWidth:x,width:E,isLoading:C})=>{const[{loading:M,value:S=h||[]},I]=(0,i.A)(async()=>{try{if(h)return h;if(u&&P?.length)return P;if(s.TP.hasPermission(r.AccessControlAction.ActionUserRolesList)&&g>0)return await(0,a.Xh)(g,l)}catch{console.error("Error loading options")}return[]},[l,g,P,h]);(0,n.useEffect)(()=>{l&&I()},[I,l]);const T=async R=>{u?D&&D(R,g,l):(await(0,a.eA)(R,g,l),await I())},b=s.TP.hasPermission(r.AccessControlAction.ActionUserRolesAdd)&&s.TP.hasPermission(r.AccessControlAction.ActionUserRolesRemove);return(0,t.jsx)(f.n,{appliedRoles:S,basicRole:o,onRolesChange:T,onBasicRoleChange:p,roleOptions:m,isLoading:M||C,disabled:y,basicRoleDisabled:d,basicRoleDisabledMessage:v,showBasicRole:!0,apply:u,canUpdateRoles:b,maxWidth:x,width:E})}},85927:(G,O,e)=>{"use strict";e.d(O,{G3:()=>a,RL:()=>i,Xh:()=>s,eA:()=>r,xN:()=>f});var t=e(17172),n=e(3246);const i=async c=>{let o="/api/access-control/roles?delegatable=true";c&&(o+=`&targetOrgId=${c}`);const h=await(0,t.AI)().get(o);return!h||!h.length?[]:h.map(n.c)},s=async(c,o)=>{let h=`/api/access-control/users/${c}/roles`;o&&(h+=`?targetOrgId=${o}`);try{const g=await(0,t.AI)().get(h);return!g||!g.length?[]:g.map(n.c)}catch(g){return(0,t.NF)(g)&&(g.isHandled=!0),[]}},r=(c,o,h)=>{let g=`/api/access-control/users/${o}/roles`;h&&(g+=`?targetOrgId=${h}`);const l=c.flatMap(p=>p.uid);return(0,t.AI)().put(g,{orgId:h,roleUids:l})},f=async(c,o)=>{let h=`/api/access-control/teams/${c}/roles`;o&&(h+=`?targetOrgId=${o}`);try{const g=await(0,t.AI)().get(h);return!g||!g.length?[]:g.map(n.c)}catch(g){return(0,t.NF)(g)&&(g.isHandled=!0),[]}},a=(c,o,h)=>{let g=`/api/access-control/teams/${o}/roles`;h&&(g+=`?targetOrgId=${h}`);const l=c.flatMap(p=>p.uid);return(0,t.AI)().put(g,{orgId:h,roleUids:l})}},3246:(G,O,e)=>{"use strict";e.d(O,{W:()=>t,c:()=>n});const t=i=>i.delegatable!==void 0&&!i.delegatable,n=i=>{const s="fixed:";if(!i.displayName&&i.name.startsWith(s)){let r="";r=i.name.replace(s,"").replace(/:/g," "),i.displayName=r}return i}},47694:(G,O,e)=>{"use strict";e.d(O,{y:()=>h});var t=e(74848),n=e(8867),i=e(80997),s=e(62938);const r=2,f=5,a=m=>{const y=m.match(new RegExp('<style type="text/css">([\\s\\S]*?)<\\/style>'));return y?y[0]:null},c=m=>m.match(new RegExp(`<svg.*id\\s*=\\s*(['"])(.*?)\\1`))?.[r],o=m=>{let y=c(m);if(!y){y=`x${(0,s.A)()}`;const v=m.indexOf("<svg")+f;m=m.substring(0,v)+`id="${y}" `+m.substring(v)}let d=a(m);if(d){let v=d.replace(/(#(.*?))?\./g,`#${y} .`);m=m.replace(d,v)}return m},h=m=>{const{cleanStyle:y,...d}=m;return(0,t.jsx)(n.default,{...d,cacheRequests:!0,preProcessor:y?p:l})};let g=new Map;function l(m){let y=g.get(m);return y||(y=i.sQ.sanitizeSVGContent(m),g.set(m,y)),y}function p(m){let y=g.get(m);return y||(y=i.sQ.sanitizeSVGContent(m),y.indexOf('<style type="text/css">')>-1&&(y=o(y)),g.set(m,y)),y}},59429:(G,O,e)=>{"use strict";e.d(O,{b:()=>g});var t=e(74848),n=e(76459),i=e.n(n),s=e(96540),r=e(90182),f=e(27677),a=e(28676);const c=(l="Dashboards",p)=>`${l}/${p}`;async function o(l=""){return f.IB.search({type:"dash-db",query:l,limit:100}).then(p=>p.map(m=>({value:{uid:m.uid,title:m.title,folderTitle:m.folderTitle,folderUid:m.folderUid},label:c(m?.folderTitle,m.title)})))}const h=i()(o,250,{leading:!0}),g=({value:l,onChange:p,placeholder:m="Select dashboard",noOptionsMessage:y="No dashboards found",...d})=>{const[v,u]=(0,s.useState)();(0,s.useEffect)(()=>{!l||l===v?.value?.uid||(async()=>{const P=await(0,a.n)().getDashboardDTO(l);P.dashboard&&u({value:{uid:P.dashboard.uid,title:P.dashboard.title,folderTitle:P.meta.folderTitle,folderUid:P.meta.folderUid},label:c(P.meta?.folderTitle,P.dashboard.title)})})()},[l]);const D=(0,s.useCallback)(P=>{u(P),p?.(P?.value)},[p,u]);return(0,t.jsx)(r.DW,{loadOptions:h,onChange:D,placeholder:m,noOptionsMessage:y,value:v,defaultOptions:!0,...d})}},36607:(G,O,e)=>{"use strict";e.d(O,{d:()=>ie});var t=e(74848),n=e(96540),i=e(32264),s=e(32196),r=e(34743),f=e(36376),a=e(7315),c=e(76459),o=e.n(c),h=e(40845),g=e(10354),l=e(14578),p=e(42418),m=e(57514),y=e(8484),d=e(55314),v=e(24439),u=e(40957),D=e(31678),P=e(70255),x=e(91793),E=e(10022),C=e(29158),M=e(94753),S=e(18759),I=e(37690);const T=40,b="md",R=(re,ce)=>`${re}-${ce||"root"}`;function A({items:re,focusedItemIndex:ce,foldersAreOpenable:me,idPrefix:ee,selectedFolder:de,onFolderExpand:De,onFolderSelect:fe,isItemLoaded:Te,requestLoadMore:je}){const He=(0,n.useRef)(null),Be=(0,h.of)(W),Ne=(0,n.useMemo)(()=>({items:re,focusedItemIndex:ce,foldersAreOpenable:me,selectedFolder:de,onFolderExpand:De,onFolderSelect:fe,idPrefix:ee}),[re,ce,me,de,De,fe,ee]),Re=(0,n.useCallback)(We=>Te(We),[Te]),Se=(0,n.useCallback)((We,Ke)=>{const{parentUID:Xe}=re[We];je(Xe)},[je,re]);return(0,t.jsx)("div",{className:Be.table,role:"tree",children:re.length>0?(0,t.jsx)(E.A,{ref:He,itemCount:re.length,isItemLoaded:Re,loadMoreItems:Se,children:({onItemsRendered:We,ref:Ke})=>(0,t.jsx)(x.Y1,{ref:Ke,height:T*Math.min(6.5,re.length),width:"100%",itemData:Ne,itemSize:T,itemCount:re.length,onItemsRendered:We,children:U})}):(0,t.jsx)("div",{className:Be.emptyMessage,children:(0,t.jsx)(y.x6,{i18nKey:"browse-dashboards.folder-picker.empty-message",children:"No folders found"})})})}const L=[100,200,130,160,150];function U({index:re,style:ce,data:me}){const{items:ee,focusedItemIndex:de,foldersAreOpenable:De,selectedFolder:fe,onFolderExpand:Te,onFolderSelect:je,idPrefix:He}=me,{item:Be,isOpen:Ne,level:Re,parentUID:Se}=ee[re],We=(0,n.useRef)(null),Ke=(0,n.useId)(),Xe=(0,D.useSelector)(I.ku),Je=(0,D.useSelector)(I.Am),st=(Be.uid?Je[Be.uid]:Xe)?.items??[];let pt=[];Be.uid&&(pt=(Se?Je[Se]:Xe)?.items??[]);const xt=(0,h.of)(W),ot=(0,n.useCallback)(ve=>{ve.preventDefault(),ve.stopPropagation(),Be.uid&&Te(Be.uid,!Ne)},[Be.uid,Ne,Te]),$e=(0,n.useCallback)(()=>{Be.kind==="folder"&&je(Be)},[Be,je]);return Be.kind==="ui"&&Be.uiKind==="pagination-placeholder"?(0,t.jsxs)("span",{style:ce,className:xt.row,children:[(0,t.jsx)(S.T,{level:Re,spacing:2}),(0,t.jsx)(P.A,{width:L[re%L.length]})]}):Be.kind!=="folder"?null:(0,t.jsx)("div",{ref:We,style:ce,className:(0,s.cx)(xt.row,{[xt.rowFocused]:re===de,[xt.rowSelected]:Be.uid===fe}),tabIndex:-1,onClick:$e,"aria-expanded":Ne,"aria-selected":Be.uid===fe,"aria-labelledby":Ke,"aria-level":Re+1,role:"treeitem","aria-owns":st.length>0?st.map(ve=>R(He,ve.uid)).join(" "):void 0,"aria-setsize":st.length,"aria-posinset":pt.findIndex(ve=>ve.uid===Be.uid)+1,id:R(He,Be.uid),children:(0,t.jsxs)("div",{className:xt.rowBody,children:[(0,t.jsx)(S.T,{level:Re,spacing:2}),De?(0,t.jsx)(C.K,{size:b,onMouseDown:ot,tabIndex:-1,"aria-label":Ne?`Collapse folder ${Be.title}`:`Expand folder ${Be.title}`,name:Ne?"angle-down":"angle-right"}):(0,t.jsx)("span",{className:xt.folderButtonSpacer}),(0,t.jsx)("label",{className:xt.label,id:Ke,children:(0,t.jsx)(M.E,{truncate:!0,children:Be.title})})]})})}const W=re=>{const ce=(0,s.css)({height:T,display:"flex",position:"relative",alignItems:"center",flexGrow:1,gap:re.spacing(.5),overflow:"hidden",padding:re.spacing(0,1)});return{table:(0,s.css)({background:re.components.input.background}),emptyMessage:(0,s.css)({padding:re.spacing(1),textAlign:"center",width:"100%"}),folderButtonSpacer:(0,s.css)({paddingLeft:re.spacing(.5)}),row:(0,s.css)({display:"flex",position:"relative",alignItems:"center",":not(:first-child)":{borderTop:`solid 1px ${re.colors.border.weak}`}}),rowFocused:(0,s.css)({backgroundColor:re.colors.background.secondary}),rowSelected:(0,s.css)({"&::before":{display:"block",content:'""',position:"absolute",left:0,bottom:0,top:0,width:4,borderRadius:re.shape.radius.default,backgroundImage:re.colors.gradients.brandVertical}}),rowBody:ce,label:(0,s.css)({lineHeight:T+"px",flexGrow:1,minWidth:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap","&:hover":{textDecoration:"underline",cursor:"pointer"}})}};var w=e(16797);function N({handleClearSelection:re,isLoading:ce,invalid:me,label:ee,...de},De){const fe=(0,h.$j)(),Te=V(fe,me),je=He=>{(He.key==="Enter"||He.key===" ")&&re?.(He)};return(0,t.jsx)("div",{className:Te.wrapper,children:(0,t.jsxs)("div",{className:Te.inputWrapper,children:[ee?(0,t.jsx)("div",{className:Te.prefix,children:(0,t.jsx)(l.I,{name:"folder"})}):void 0,(0,t.jsxs)("button",{type:"button",className:(0,s.cx)(Te.fakeInput,ee?Te.hasPrefix:void 0),...de,ref:De,children:[ce?(0,t.jsx)(P.A,{width:100}):ee?(0,t.jsx)(M.E,{truncate:!0,children:ee}):(0,t.jsx)(M.E,{truncate:!0,color:"secondary",children:(0,t.jsx)(y.x6,{i18nKey:"browse-dashboards.folder-picker.button-label",children:"Select folder"})}),!ce&&re&&(0,t.jsx)(l.I,{role:"button",tabIndex:0,"aria-label":(0,y.t)("browse-dashboards.folder-picker.clear-selection","Clear selection"),className:Te.clearIcon,name:"times",onClick:re,onKeyDown:je})]}),(0,t.jsx)("div",{className:Te.suffix,children:(0,t.jsx)(l.I,{name:"angle-down"})})]})})}const B=(0,n.forwardRef)(N),V=(re,ce=!1)=>{const me=(0,g.n)({theme:re,invalid:ce});return{wrapper:me.wrapper,inputWrapper:me.inputWrapper,prefix:(0,s.css)([me.prefix,{pointerEvents:"none",color:re.colors.text.primary}]),suffix:(0,s.css)([me.suffix,{pointerEvents:"none"}]),fakeInput:(0,s.css)([me.input,{textAlign:"left",letterSpacing:"normal","&:focus":{outline:"unset",boxShadow:"unset"},"&:focus-visible":(0,s.css)`
          ${(0,w.focusCss)(re)}
        `,alignItems:"center",display:"flex",flexWrap:"nowrap",justifyContent:"space-between",paddingRight:28}]),hasPrefix:(0,s.css)({paddingLeft:28}),clearIcon:(0,s.css)({color:re.colors.text.secondary,cursor:"pointer","&:hover":{color:re.colors.text.primary},"&:focus:not(:focus-visible)":(0,w.getMouseFocusStyles)(re),"&:focus-visible":(0,w.getFocusStyles)(re)})}};var K=e(25508),H=e(92955),X=e(93519),k=e(64756);const Y=(0,K.Mz)([re=>re,(re,ce)=>ce],(re,ce)=>{const me=new Set,ee=[],de={};let De=!1;for(const fe of ce){if(me.has(fe.requestId))continue;const Te=d.cU.endpoints.listFolders.select({parentUid:fe.arg.parentUid,page:fe.arg.page,limit:fe.arg.limit,permission:fe.arg.permission})(re);Te.status==="pending"&&(De=!0);const je=Te.originalArgs?.parentUid;je?(de[je]||(de[je]=[]),de[je].push(Te)):ee.push(Te)}return{isLoading:De,rootPages:ee,pagesByParent:de}});function Z(re){const ce=re.at(-1),me=ce?.originalArgs?.page;return ce?.data?[ce.data.length<ce.originalArgs.limit,me]:[!1,me]}function se(re,ce,me){const ee=(0,k.wA)(),de=(0,n.useRef)([]),De=(0,k.d4)(je=>Y(je,de.current)),fe=(0,n.useCallback)(je=>{const He=je?De.pagesByParent[je]:De.rootPages,[Be,Ne]=Z(He??[]);if(Be)return;const Re={parentUid:je,page:(Ne??0)+1,limit:H.md,permission:me},Se=ee(d.cU.endpoints.listFolders.initiate(Re));de.current=de.current.concat([Se])},[De,ee,me]);return(0,n.useEffect)(()=>()=>{for(const je of de.current)je.unsubscribe()},[]),{items:(0,n.useMemo)(()=>{if(!re)return[];function je(Be,Ne,Re){const Se=Ne.flatMap(Ke=>(Ke.data??[]).flatMap(Je=>{const st=ce[Je.uid],pt={isOpen:!!st,level:Re,item:{kind:"folder",title:Je.title,uid:Je.uid}},xt=st&&De.pagesByParent[Je.uid];if(xt){const ot=je(Je.uid,xt,Re+1);return[pt,...ot]}return pt})),[We]=Z(Ne);return We||Se.push(...(0,X.T)(H.md,Be,Re)),Se}const He=je(void 0,De.rootPages,1);return He.unshift(j),He},[De,re,ce]),isLoading:De.isLoading,requestNextPage:fe}}const j={isOpen:!0,level:0,item:{kind:"folder",title:"Dashboards",uid:""}};function q({tree:re,handleCloseOverlay:ce,handleFolderSelect:me,handleFolderExpand:ee,idPrefix:de,search:De,visible:fe}){const[Te,je]=(0,n.useState)(-1),He=!!i.$.featureToggles.nestedFolders;(0,n.useEffect)(()=>{fe&&je(-1)},[fe]),(0,n.useEffect)(()=>{je(0)},[De]),(0,n.useEffect)(()=>{document.getElementById(R(de,re[Te]?.item.uid))?.scrollIntoView({block:"nearest",inline:"nearest"})},[Te,de,re]);const Be=(0,n.useCallback)(Ne=>{const Re=He&&!De;switch(Ne.key){case"ArrowRight":case"ArrowLeft":Re&&(Ne.preventDefault(),ee(re[Te].item.uid,Ne.key==="ArrowRight"));break;case"ArrowUp":Te>0&&(Ne.preventDefault(),je(Te-1));break;case"ArrowDown":Te<re.length-1&&(Ne.preventDefault(),je(Te+1));break;case"Enter":Ne.preventDefault();const Se=re[Te].item;Se.kind==="folder"&&me(Se);break;case"Tab":Ne.stopPropagation(),ce();break;case"Escape":Ne.stopPropagation(),Ne.preventDefault(),ce();break}},[Te,ce,ee,me,He,De,re]);return{focusedItemIndex:Te,handleKeyDown:Be}}const ne=o()(oe,300);async function oe(re,ce){const me=await(0,v.getGrafanaSearcher)().search({query:re,kind:["folder"],limit:100,permission:ce}),ee=me.view.map(de=>(0,u.hI)(de,me.view));return{...me,items:ee}}function z({value:re,invalid:ce,showRootFolder:me=!0,clearable:ee=!1,excludeUIDs:de,permission:De=D.PermissionLevelString.Edit,onChange:fe}){const Te=(0,h.of)(te),je=(0,d.kH)(re||d.hT),He=!!i.$.featureToggles.nestedFolders,[Be,Ne]=(0,n.useState)(""),[Re,Se]=(0,n.useState)(null),[We,Ke]=(0,n.useState)(!1),[Xe,Je]=(0,n.useState)(!1),[st,pt]=(0,n.useState)(!1),[xt,ot]=(0,n.useState)({}),$e=(0,n.useId)(),[ve]=(0,n.useState)(void 0),be=(0,n.useRef)(0),he=!!(st&&!(Be&&Re)),{items:ye,isLoading:Pe,requestNextPage:ge}=se(he,xt,De);(0,n.useEffect)(()=>{if(!Be){Se(null);return}const yt=Date.now();Ke(!0),ne(Be,De).then(Ft=>{if(yt>be.current){const an=Ft.view.map(un=>(0,u.hI)(un,Ft.view));Se({...Ft,items:an}),Ke(!1),be.current=yt}})},[Be,De]);const xe=[(0,r.UU)({crossAxis:!1,boundary:document.body})],{context:Ae,refs:Ee,floatingStyles:Ie,elements:Qe}=(0,f.we)({open:st,placement:"bottom",onOpenChange:yt=>{yt&&(Ne(""),Je(!0)),pt(yt)},middleware:xe,whileElementsMounted:a.ll}),at=(0,f.kp)(Ae),ft=(0,f.s9)(Ae),{getReferenceProps:ct,getFloatingProps:vt}=(0,f.bv)([ft,at]),Pt=(0,n.useCallback)(async(yt,Ft)=>{ot(an=>({...an,[yt]:Ft})),Ft&&!xt[yt]&&ge(yt)},[ge,xt]),Vt=(0,n.useCallback)(yt=>{fe&&fe(yt.uid,yt.title),pt(!1)},[fe]),Jt=(0,n.useCallback)(yt=>{yt.preventDefault(),yt.stopPropagation(),fe&&fe(void 0,void 0)},[fe]),wt=(0,n.useCallback)(()=>pt(!1),[pt]),zt=(0,n.useCallback)(yt=>{Be||ge(yt)},[Be,ge]),on=(0,n.useMemo)(()=>{let yt=[];return he?yt=ye:yt=Re?.items.map(Ft=>({isOpen:!1,level:0,item:{kind:"folder",title:Ft.title,uid:Ft.uid}}))??[],(!me||de?.length)&&(yt=yt.filter(Ft=>!(!me&&Ft===j||de?.includes(Ft.item.uid)))),yt},[ye,de,he,Re?.items,me]),Pn=(0,n.useCallback)(yt=>{const Ft=on[yt];if(!Ft)return!1;const an=Ft.item;return!(an.kind==="ui"&&an.uiKind==="pagination-placeholder")},[on]),_n=Pe||We,{focusedItemIndex:Cn,handleKeyDown:Ye}=q({tree:on,handleCloseOverlay:wt,handleFolderSelect:Vt,handleFolderExpand:Pt,idPrefix:$e,search:Be,visible:st});let Dt=je.data?.title;return re===""&&(Dt="Dashboards"),st?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.p,{ref:Ee.setReference,autoFocus:!0,prefix:Dt?(0,t.jsx)(l.I,{name:"folder"}):null,placeholder:Dt??(0,y.t)("browse-dashboards.folder-picker.search-placeholder","Search folders"),value:Be,invalid:ce,className:Te.search,onChange:yt=>Ne(yt.currentTarget.value),"aria-autocomplete":"list","aria-expanded":!0,"aria-haspopup":!0,"aria-controls":$e,"aria-owns":$e,"aria-activedescendant":R($e,on[Cn]?.item.uid),role:"combobox",suffix:(0,t.jsx)(l.I,{name:"search"}),...ct(),onKeyDown:Ye}),(0,t.jsx)("fieldset",{ref:Ee.setFloating,id:$e,className:Te.tableWrapper,style:{...Ie,width:Qe.domReference?.clientWidth},...vt(),children:ve?(0,t.jsx)(p.F,{className:Te.error,severity:"warning",title:(0,y.t)("browse-dashboards.folder-picker.error-title","Error loading folders"),children:ve.message||ve.toString?.()||(0,y.t)("browse-dashboards.folder-picker.unknown-error","Unknown error")}):(0,t.jsxs)("div",{children:[_n&&(0,t.jsx)("div",{className:Te.loader,children:(0,t.jsx)(m.G,{width:600})}),(0,t.jsx)(A,{items:on,selectedFolder:re,focusedItemIndex:Cn,onFolderExpand:Pt,onFolderSelect:Vt,idPrefix:$e,foldersAreOpenable:He&&!(Be&&Re),isItemLoaded:Pn,requestLoadMore:zt})]})})]}):(0,t.jsx)(B,{label:Dt,handleClearSelection:ee&&re!==void 0?Jt:void 0,invalid:ce,isLoading:je.isLoading,autoFocus:Xe,ref:Ee.setReference,"aria-label":Dt?(0,y.t)("browse-dashboards.folder-picker.accessible-label","Select folder: {{ label }} currently selected",{label:Dt}):void 0,...ct()})}const te=re=>({button:(0,s.css)({maxWidth:"100%"}),error:(0,s.css)({marginBottom:0}),tableWrapper:(0,s.css)({boxShadow:re.shadows.z3,position:"relative",zIndex:re.zIndex.portal}),loader:(0,s.css)({position:"absolute",top:0,left:0,right:0,zIndex:re.zIndex.portal+1,overflow:"hidden"}),search:(0,s.css)({input:{cursor:"default"}})});var le=e(85242);function ie(re){const ce=i.$.featureToggles.newFolderPicker||i.$.featureToggles.nestedFolders,{initialTitle:me,dashboardId:ee,enableCreateNew:de,...De}=re;return ce?(0,t.jsx)(z,{...De}):(0,t.jsx)(ae,{...re})}function ae({value:re,showRootFolder:ce,onChange:me,initialTitle:ee,dashboardId:de,enableCreateNew:De,inputId:fe,skipInitialLoad:Te}){const je=(0,n.useCallback)(He=>{me&&me(He.uid,He.title)},[me]);return(0,t.jsx)(le.sR,{onChange:je,showRoot:ce,initialFolderUid:re,initialTitle:ee,inputId:fe,skipInitialLoad:Te,dashboardId:de,enableCreateNew:De})}},85242:(G,O,e)=>{"use strict";e.d(O,{sR:()=>P});var t=e(74848),n=e(32196),i=e(76459),s=e.n(i),r=e(96540),f=e(16817),a=e(26272),c=e(13544),o=e(14110),h=e(40845),g=e(10354),l=e(90182),p=e(28138),m=e(8484),y=e(16233),d=e(11230),v=e(31678);const u="+ Add new",D="-10";function P(M){const{dashboardId:S,allowEmpty:I,onChange:T,filter:b,enableCreateNew:R,inputId:A,onClear:L,enableReset:U,initialFolderUid:W,initialTitle:w="",permissionLevel:N=v.PermissionLevelString.Edit,rootName:B,showRoot:V=!0,skipInitialLoad:K,searchQueryType:H,customAdd:X,folderWarning:k,invalid:Y}=M,Z=B??"Dashboards",[se,j]=(0,r.useState)(null),[q,ne]=(0,r.useState)(!1),[oe,z]=(0,r.useState)(""),[te,le]=(0,r.useState)(se?.title??""),ie=(0,h.of)(C),ae=typeof L=="function",re=(0,r.useCallback)(async Ne=>{const Re=await(0,d.c0)(Ne,N,H),We=x(Re,b);return(0,o.rR)("grafana_folder_picker_results_loaded",{results:We.length,searchTermLength:Ne.length,enableCreateNew:!!R}),(y.TP.hasPermission(v.AccessControlAction.DashboardsWrite)||y.TP.hasPermission(v.AccessControlAction.DashboardsCreate))&&Z?.toLowerCase().startsWith(Ne.toLowerCase())&&V&&We.unshift({label:Z,value:""}),U&&Ne===""&&w!==""&&!We.find(Xe=>Xe.label===w)&&We.unshift({label:w,value:W}),R&&X?[...We,{value:D,label:u,title:Ne}]:We},[U,W,w,N,Z,V,H,b,R,X]),ce=(0,r.useMemo)(()=>s()(re,300,{leading:!0}),[re]),me=async()=>{const Ne={label:w,value:void 0},Re={label:Z,value:""},Se=await re("");let We=null;W!=null?We=Se.find(Ke=>Ke.value===W)||null:U&&w?We=Ne:W&&(We=Se.find(Ke=>Ke.id===W)||null),!We&&!I&&(y.TP.isEditor?We=Re:!!S?We=Ne:We=Se.length>0?Se[0]:Ne),!q&&j(We)};(0,r.useEffect)(()=>{se&&se.value!==W&&!q&&se.value&&se.label&&T({uid:se.value,title:se.label})},[se,W]),(0,f.A)(async()=>{if(K){const Ne=await E({getFolder:d.Ql,folderUid:W,folderName:w});j(Ne)}await me()},[K,W,w]),(0,r.useEffect)(()=>{se&&se.id===D&&ne(!0)},[se]);const ee=(0,r.useCallback)((Ne,Re)=>{if(Ne?.value===D)j({id:D,title:oe}),le(oe);else{if(Ne||(Ne={value:"",label:Z}),Re.action==="clear"&&L){L();return}j(Ne),T({uid:Ne.value,title:Ne.label})}},[T,L,Z,oe]),de=(0,r.useCallback)(async Ne=>{if(k?.warningCondition(Ne))return(0,o.rR)("grafana_folder_picker_folder_created",{status:"failed_condition"}),!1;const Re=await(0,d.vV)({title:Ne});let Se={value:"",label:"Not created"};return Re.uid?((0,o.rR)("grafana_folder_picker_folder_created",{status:"success"}),p.A.emit(a.r1.alertSuccess,["Folder Created","OK"]),Se={value:Re.uid,label:Re.title},j(Re),ee(Se,{action:"create-option",option:Se})):((0,o.rR)("grafana_folder_picker_folder_created",{status:"failed"}),p.A.emit(a.r1.alertError,["Folder could not be created"])),Se},[k,ee]),De=(0,r.useCallback)(Ne=>{const Re=!!X?.disallowValues;if(Ne.key==="Enter"&&Re&&!X?.isAllowedValue(te)){Ne.preventDefault();return}switch(Ne.key){case"Enter":{de(se?.title),ne(!1);break}case"Escape":j({value:"",label:Z}),ne(!1)}},[X?.disallowValues,X?.isAllowedValue,te,de,se?.title,Z]),fe=Ne=>{const Re=Ne.currentTarget.value;le(Re),j({id:void 0,title:Re})},Te=()=>{j({value:"",label:Z}),ne(!1)},je=(Ne,{action:Re})=>{Re==="input-change"&&z(Se=>Ne),Re==="menu-close"&&z(Se=>Ne)},He=()=>k?.warningCondition(te)?(0,t.jsx)(k.warningComponent,{}):null,Be=()=>k?.warningCondition(oe)?(0,t.jsx)(k.warningComponent,{}):null;return q?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(He,{}),(0,t.jsx)("div",{className:ie.newFolder,children:"Press enter to create the new folder."}),(0,t.jsx)(g.p,{width:30,autoFocus:!0,value:te,onChange:fe,onKeyDown:De,placeholder:"Press enter to confirm new folder.",onBlur:Te})]}):(0,t.jsxs)("div",{"data-testid":c.Tp.components.FolderPicker.containerV2,children:[(0,t.jsx)(Be,{}),(0,t.jsx)(l.gZ,{inputId:A,"data-testid":c.Tp.components.FolderPicker.input,loadingMessage:(0,m.t)("folder-picker.loading","Loading folders..."),defaultOptions:!0,defaultValue:se,inputValue:oe,onInputChange:je,value:se,allowCustomValue:R&&!X,loadOptions:ce,onChange:ee,onCreateOption:de,invalid:Y,isClearable:ae})]})}function x(M,S){return(S?S(M):M).map(T=>({label:T.title,value:T.uid}))}async function E({folderName:M,folderUid:S,getFolder:I}){if(S==null)throw new Error("folderUid is not found.");return M?{label:M,value:S}:{label:(await I(S)).title,value:S}}const C=M=>({newFolder:(0,n.css)({color:M.colors.warning.main,fontSize:M.typography.bodySmall.fontSize,paddingBottom:M.spacing(1)})})},73725:(G,O,e)=>{"use strict";e.d(O,{r:()=>c});var t=e(74848),n=e(16817),i=e(90182),s=e(14578),r=e(53477),f=e(24439);const a=()=>(0,f.getGrafanaSearcher)().getSortOptions();function c({onChange:o,value:h,placeholder:g,filter:l,getSortOptions:p,isClearable:m}){const y=(0,n.A)(async()=>{const v=await(p??a)();return l?v.filter(u=>l.includes(u.value)):v},[p,l]);if(y.loading)return null;const d=!!(h?.includes("desc")||h?.startsWith("-"));return(0,t.jsx)(i.l6,{width:28,onChange:o,value:y.value?.find(v=>v.value===h)??null,options:y.value,"aria-label":"Sort",placeholder:g??`Sort (Default ${r.r4.label})`,prefix:(0,t.jsx)(s.I,{name:d?"sort-amount-down":"sort-amount-up"}),isClearable:m},h)}},46334:(G,O,e)=>{"use strict";e.d(O,{$:()=>a,E:()=>f});var t=e(74848),n=e(32196),i=e(69613),s=e(40845),r=e(14578);const f=({count:c,label:o,onClick:h,removeIcon:g})=>{const{color:l}=(0,i.MC)(o),p=(0,s.of)(a),m=c!==0&&(0,t.jsx)("span",{style:{marginLeft:"3px"},children:`(${c})`});return(0,t.jsxs)("span",{className:p.badge,style:{backgroundColor:l},children:[g&&(0,t.jsx)(r.I,{onClick:h,name:"times"}),o," ",m]})},a=c=>({badge:(0,n.css)({...c.typography.bodySmall,backgroundColor:c.v1.palette.gray1,borderRadius:c.shape.radius.default,color:c.v1.palette.white,display:"inline-block",height:"20px",lineHeight:"20px",padding:c.spacing(0,.75),verticalAlign:"baseline",whiteSpace:"nowrap","&:hover":{opacity:.85}})})},99818:(G,O,e)=>{"use strict";e.d(O,{$:()=>m});var t=e(74848),n=e(32196),i=e(96540),s=e(28581),r=e(54479),f=e(40845),a=e(90182),c=e(14578),o=e(8484),h=e(46334);const g=({data:d,className:v,label:u,isFocused:D,innerProps:P})=>{const x=(0,f.of)(l);return(0,t.jsx)("div",{className:(0,n.cx)(x.option,D&&x.optionFocused),"aria-label":"Tag option",...P,children:(0,t.jsx)("div",{className:(0,n.cx)(x.optionInner,v),children:typeof u=="string"?(0,t.jsx)(h.E,{label:u,removeIcon:!1,count:d.count??0}):u})})},l=d=>({option:(0,n.css)({padding:d.spacing(1),whiteSpace:"nowrap",cursor:"pointer",borderLeft:"2px solid transparent","&:hover":{background:d.colors.background.secondary}}),optionFocused:(0,n.css)({background:d.colors.background.secondary,borderStyle:"solid",borderTop:0,borderRight:0,borderBottom:0,borderLeftWidth:"2px"}),optionInner:(0,n.css)({position:"relative",textAlign:"left",width:"100%",display:"block",cursor:"pointer",padding:"2px 0"})}),p=(d,v)=>RegExp((0,r.jD)(v),"i").test(d.value),m=({allowCustomValue:d=!1,formatCreateLabel:v,hideValues:u,inputId:D,isClearable:P,onChange:x,placeholder:E,tagOptions:C,tags:M,width:S})=>{const I=(0,f.of)(y),T=M.map(k=>({value:k,label:k,count:0})),[b,R]=(0,i.useState)(T),[A,L]=(0,i.useState)(!1),[U,W]=(0,i.useState)(M),[w,N]=(0,i.useState)(T),B=(0,i.useMemo)(()=>M.join(),[M]),V=(0,i.useCallback)(async()=>(await C()).map(Y=>M.includes(Y.term)?{value:Y.term,label:Y.term,count:0}:{value:Y.term,label:Y.term,count:Y.count}),[C,M]),K=(0,i.useCallback)(async()=>{L(!0);const k=await V();d&&w.forEach(Y=>k.push(Y)),R(k),L(!1)},[d,w,V]);(0,i.useEffect)(()=>{M.length>0&&b.length===0&&K()},[K,b.length,M.length]),(0,i.useEffect)(()=>{M!==U&&(W(M),K())},[K,U,M]);const H=k=>{k.forEach(Y=>Y.count=0),x((k||[]).map(Y=>Y.value)),d&&N(k.filter(Y=>!M.includes(Y)))},X={onFocus:K,isLoading:A,options:b,allowCreateWhileLoading:!0,allowCustomValue:d,formatCreateLabel:v,defaultOptions:!0,filterOption:p,getOptionLabel:k=>k.label,getOptionValue:k=>k.value,inputId:D,isMulti:!0,onChange:H,loadingMessage:(0,o.t)("tag-filter.loading","Loading..."),noOptionsMessage:(0,o.t)("tag-filter.no-tags","No tags found"),placeholder:E||(0,o.t)("tag-filter.placeholder","Filter by tag"),value:T,width:S,components:{Option:g,MultiValueLabel:()=>null,MultiValueRemove(k){const{data:Y}=k;return(0,t.jsx)(s.c.MultiValueRemove,{...k,children:(0,t.jsx)(h.E,{label:Y.label,removeIcon:!0,count:Y.count},Y.label)})},MultiValueContainer:u?()=>null:s.c.MultiValueContainer}};return(0,t.jsxs)("div",{className:I.tagFilter,children:[P&&M.length>0&&(0,t.jsx)("button",{className:I.clear,onClick:()=>H([]),children:"Clear tags"}),(0,t.jsx)(a.KF,{...X,prefix:(0,t.jsx)(c.I,{name:"tag-alt"}),"aria-label":"Tag filter"},B)]})};m.displayName="TagFilter";const y=d=>{const v=(0,h.$)(d);return{tagFilter:(0,n.css)({position:"relative",minWidth:"180px",flexGrow:1,[`.${v.badge}`]:{marginLeft:"6px",cursor:"pointer"}}),clear:(0,n.css)({background:"none",border:"none",textDecoration:"underline",fontSize:"12px",padding:"none",position:"absolute",top:"-17px",right:0,cursor:"pointer",color:d.colors.text.secondary,"&:hover":{color:d.colors.text.primary}})}}},25573:(G,O,e)=>{"use strict";e.d(O,{m:()=>l});var t=e(74848),n=e(2543),i=e.n(n),s=e(26272),r=e(65879),f=e(47232),a=e(15666),c=e(76412),o=e(28138),h=e(61680);const g="grafana.dashboard.timepicker.history",l=u=>(0,t.jsx)(h.b,{storageKey:g,defaultValue:[],children:(D,P)=>{const x=m(D),E=p(x);return(0,t.jsx)(a.$6,{...u,history:E,onChange:C=>{y(C,x,P),u.onChange(C)},onError:C=>o.A.emit(s.r1.alertError,[(0,c.t)("time-picker.copy-paste.default-error-title","Invalid time range"),(0,c.t)("time-picker.copy-paste.default-error-message","{{error}} is not a valid time range",{error:C})])})}});function p(u){return u.map(D=>r.convertRawToRange(D,"utc",void 0,"YYYY-MM-DD HH:mm:ss"))}function m(u){return u.map(D=>{const P=typeof D.from=="string"?D.from:D.from.toISOString(),x=typeof D.to=="string"?D.to:D.to.toISOString();return{from:P,to:x}})}function y(u,D,P){if(!d(u))return;const x={from:typeof u.raw.from=="string"?u.raw.from:u.raw.from.toISOString(),to:typeof u.raw.to=="string"?u.raw.to:u.raw.to.toISOString()},E=v([x,...D]);P(E)}function d(u){return(0,f.Ar)(u.raw.from)||(0,f.Ar)(u.raw.to)}function v(u){return(0,n.uniqBy)(u,D=>D.from+D.to).slice(0,4)}},82389:(G,O,e)=>{"use strict";e.d(O,{I:()=>g});var t=e(74848),n=e(96540),i=e(24293),s=e(11261),r=e(52622),f=e(67266),a=e(96516),c=e(30249),o=e(28895);const h=["rowHeight","colWidth","showValue","mergeValues","alignValue","tooltip"];class g extends n.Component{constructor(){super(...arguments),this.getValueColor=(p,m,y)=>{const d=this.props.frames[p].fields[m];if(d.display){const v=d.display(y);if(v.color)return v.color}return i.F},this.prepConfig=(p,m,y)=>(0,o.iE)({frame:p,getTimeRange:y,allFrames:this.props.frames,...this.props,timeZones:Array.isArray(this.props.timeZone)?this.props.timeZone:[this.props.timeZone],rowHeight:p.fields.length>2?this.props.rowHeight:1,getValueColor:this.getValueColor,hoverMulti:this.props.tooltip?.mode===r.$N.Multi}),this.renderLegend=p=>{const{legend:m,legendItems:y}=this.props;return!p||!y||!m||m.showLegend===!1?null:(0,t.jsx)(f.KU.Legend,{placement:m.placement,children:(0,t.jsx)(a.t,{placement:m.placement,items:y,displayMode:m.displayMode,readonly:!0})})}}render(){return(0,t.jsx)(c.o,{...this.props,fields:{x:p=>p.type===s.PU.time,y:p=>p.type===s.PU.number||p.type===s.PU.boolean||p.type===s.PU.string||p.type===s.PU.enum},prepConfig:this.prepConfig,propsToDiff:h,renderLegend:this.renderLegend})}}},28895:(G,O,e)=>{"use strict";e.d(O,{pm:()=>R,GY:()=>H,c5:()=>X,jY:()=>V,EI:()=>N,iE:()=>L,Qe:()=>w,Or:()=>B});var t=e(24293),n=e(28240),i=e(83195),s=e(11261),r=e(50082),f=e(58563),a=e(47737),c=e(73060),o=e(46294),h=e(39624),g=e(73134),l=e(52622),p=e(51336),m=e(52811),y=e(16895),d=e(36613),v=e(23596),u=e(39758),D=e(4134);const{round:P,min:x,ceil:E}=Math,C=2;let M=6;const S=u.ur;function I(k,Y,Z,se,j){(0,u.mn)(Z,k,S,Y,(q,ne,oe)=>{let z=se*ne,te=se*oe;j(q,z,te)})}function T(k){const{mode:Y,numSeries:Z,isDiscrete:se,hasMappedNull:j,rowHeight:q=0,colWidth:ne=0,showValue:oe,mergeValues:z=!1,theme:te,label:le,formatValue:ie,alignValue:ae="left",getTimeRange:re,getValueColor:ce,getFieldConfig:me,hoverMulti:ee}=k;let de,De;const fe=he=>{De=Array(Z).fill(null).map(ye=>Array(he).fill(null))},Te=`500 ${Math.round(12*devicePixelRatio)}px ${te.typography.fontFamily}`,je=Array(Z).fill(null);let He=null;const Be=[ne,1/0],Ne=1-Be[0],Re=(Be[1]??1/0)*d.A.pxRatio,Se=new Map,We=new Map;function Ke(he){Se.forEach((ye,Pe)=>{he.fillStyle=Pe,he.fill(ye)}),We.forEach((ye,Pe)=>{he.strokeStyle=Pe,he.stroke(ye)}),Se.clear(),We.clear()}function Xe(he,ye,Pe,ge,xe,Ae,Ee,Ie,Qe,at,ft,ct,vt){Ee=Math.max(1,Ee);const Pt=ce(at+1,ct),Vt=me(at),Jt=b(Vt,Pt);if(De[at][ft]={x:P(xe-Pe),y:P(Ae-ge),w:Ee,h:Ie,sidx:at+1,didx:ft,fillColor:Jt},vt){let wt=Jt,zt=Se.get(wt);if(zt==null&&Se.set(wt,zt=new Path2D),ye(zt,xe,Ae,Ee,Ie),Qe){let on=Pt,Pn=We.get(on);Pn==null&&We.set(on,Pn=new Path2D),ye(Pn,xe+Qe/2,Ae+Qe/2,Ee-Qe,Ie-Qe)}}else he.beginPath(),ye(he,xe,Ae,Ee,Ie),he.fillStyle=Jt,he.fill(),Qe&&(he.beginPath(),ye(he,xe+Qe/2,Ae+Qe/2,Ee-Qe,Ie-Qe),he.strokeStyle=Pt,he.lineWidth=Qe,he.stroke())}const Je=(he,ye,Pe,ge)=>(d.A.orient(he,ye,(xe,Ae,Ee,Ie,Qe,at,ft,ct,vt,Pt,Vt,Jt,wt,zt)=>{let on=P((xe.width||0)*d.A.pxRatio),Pn=se(ye),_n=Pn&&j(ye);he.ctx.save(),zt(he.ctx,he.bbox.left,he.bbox.top,he.bbox.width,he.bbox.height),he.ctx.clip(),I(q,ye-1,Z,Vt,(Cn,Ye,Dt)=>{if(Y===R.Changes)for(let yt=0;yt<Ee.length;yt++){let Ft=Ee[yt];if(Ft!=null||_n){let an=Math.round(at(Ae[yt],Ie,Pt,ct)),un=yt;for(;++un<Ee.length&&(Ee[un]===void 0||z&&Ee[un]===Ft););let hn=un===Ee.length?ct+Pt+on:Math.round(at(Ae[un],Ie,Pt,ct));Xe(he.ctx,zt,ct,vt,an,P(vt+Ye),hn-an,P(Dt),on,Cn,yt,Ft,Pn),yt=un-1}}else if(Y===R.Samples){let yt=at(Ae[1],Ie,Pt,ct)-at(Ae[0],Ie,Pt,ct),Ft=yt*Ne,an=P(x(Re,yt-Ft)-on),un=an/2;for(let hn=Pe;hn<=ge;hn++){let Un=Ee[hn];if(Un!=null||_n){let Nn=at(Ae[hn],Ie,Pt,ct);Xe(he.ctx,zt,ct,vt,P(Nn-un),P(vt+Ye),an,P(Dt),on,Cn,hn,Un,Pn)}}}}),Pn&&(he.ctx.lineWidth=on,Ke(he.ctx)),he.ctx.restore()}),null),st=ie==null||oe===l.yL.Never?!1:(he,ye,Pe,ge)=>(he.ctx.save(),he.ctx.rect(he.bbox.left,he.bbox.top,he.bbox.width,he.bbox.height),he.ctx.clip(),he.ctx.font=Te,he.ctx.textAlign=Y===R.Changes?ae:"center",he.ctx.textBaseline="middle",d.A.orient(he,ye,(xe,Ae,Ee,Ie,Qe,at,ft,ct,vt,Pt,Vt)=>{let Jt=P((xe.width||0)*d.A.pxRatio),zt=se(ye)&&j(ye),on=P(ft(ve[ye-1],Qe,Vt,vt));for(let Pn=0;Pn<Ee.length;Pn++)if(Ee[Pn]!=null||zt){const _n=De[ye-1][Pn];if(!_n||_n.x>=Pt)continue;let Cn=Math.floor(_n?.w/M);if(oe===l.yL.Auto&&Cn<2)continue;let Ye=ie(ye,Ee[Pn]),Dt=P(_n.x+ct+_n.w/2);Y===R.Changes&&(ae==="left"?Dt=P(_n.x+ct+Jt+C):ae==="right"&&(Dt=P(_n.x+ct+_n.w-Jt-C))),he.ctx.fillStyle=te.colors.getContrastText(_n.fillColor,3),he.ctx.fillText(Ye.slice(0,Cn),Dt,on)}}),he.ctx.restore(),!1),pt=he=>{let ye="";for(let Pe=32;Pe<=126;Pe++)ye+=String.fromCharCode(Pe);M=Math.ceil(he.ctx.measureText(ye).width/ye.length*d.A.pxRatio),M+=2.5,he.root.querySelectorAll(".u-cursor-pt").forEach(Pe=>{Pe.style.borderRadius="0"})},xt=he=>{de=de||new D.C$(0,0,he.bbox.width,he.bbox.height),de.clear(),fe(he.data[0].length),he.series.forEach(ye=>{ye._paths=null})};function ot(he,ye,Pe=!1){je.fill(null),He=null,!(he<0)&&de.get(he,0,d.A.pxRatio,1e4,ge=>{he>=ge.x&&he<=ge.x+ge.w&&(ye>=ge.y&&ye<=ge.y+ge.h?je[ge.sidx]=He=ge:(ee||Pe)&&(je[ge.sidx]=ge))})}const $e={x:Y===R.Changes,y:!1,dataIdx:(he,ye)=>{if(ye===1){if(de.o.length===0&&de.q==null)for(const xe of De)for(const Ae of xe)Ae&&de.add(Ae);let Pe=he.cursor.left*d.A.pxRatio,ge=he.cursor.top*d.A.pxRatio;ot(Pe,ge,he.cursor.event==null)}return je[ye]?.didx},focus:{prox:1e3,dist:(he,ye)=>He?.sidx===ye?0:1/0},points:{fill:"rgba(255,255,255,0.2)",bbox:(he,ye)=>{let Pe=je[ye],ge=Pe!=null;return{left:ge?Pe.x/d.A.pxRatio:-10,top:ge?Pe.y/d.A.pxRatio:-10,width:ge?Pe.w/d.A.pxRatio:0,height:ge?Pe.h/d.A.pxRatio:0}}}},ve=Array(Z).fill(0),be=[0,1];return{cursor:$e,xSplits:Y===R.Samples?(he,ye,Pe,ge,xe,Ae)=>{let Ee=[],Ie=he.data[0][1]-he.data[0][0],Qe=E(xe/Ie);for(let at=0;at<he.data[0].length;at+=Qe){let ft=he.data[0][at];ft>=Pe&&ft<=ge&&Ee.push(ft)}return Ee}:null,xRange:he=>{const ye=re();let Pe=ye.from.valueOf(),ge=ye.to.valueOf();if(Y===R.Samples){let Ee=(he.data[0][1]-he.data[0][0])/2;Pe<=he.data[0][0]&&(Pe=he.data[0][0]-Ee);let Ie=he.data[0].length-1;ge>=he.data[0][Ie]&&(ge=he.data[0][Ie]+Ee)}return[Pe,ge]},ySplits:he=>(I(q,null,Z,he.bbox.height,(ye,Pe,ge)=>{let xe=P(Pe+ge/2);ve[ye]=he.posToVal(xe/d.A.pxRatio,m.s)}),ve),yValues:(he,ye)=>ye.map((Pe,ge)=>le(ge+1)),yRange:be,drawPaths:Je,drawPoints:st,init:pt,drawClear:xt}}function b(k,Y){if(Y[0]==="#"&&Y.length===9)return Y;const Z=(k.fillOpacity??100)/100;return(0,v.X4)(Y,Z)}var R=(k=>(k.Changes="changes",k.Samples="samples",k))(R||{});const A={lineWidth:0,fillOpacity:80},L=({frame:k,theme:Y,timeZones:Z,getTimeRange:se,mode:j,rowHeight:q,colWidth:ne,showValue:oe,alignValue:z,mergeValues:te,getValueColor:le,hoverMulti:ie})=>{const ae=new p.e(Z[0]),re="x",ce=Te=>{const je=Te.config?.color?.mode;return!(je&&Te.display&&je.startsWith("continuous-"))},me=Te=>Te.config.mappings?.some(je=>je.type===g.dM.SpecialValue&&je.options.match==="null")||!1,ee=(Te,je)=>{const He=k.fields[Te];return He.state?.origin?.fieldIndex!==void 0&&He.state?.origin?.frameIndex!==void 0&&le?le(He.state?.origin?.frameIndex,He.state?.origin?.fieldIndex,je):t.F},de={mode:j,numSeries:k.fields.length-1,isDiscrete:Te=>ce(k.fields[Te]),hasMappedNull:Te=>me(k.fields[Te]),mergeValues:te,rowHeight:q,colWidth:ne,showValue:oe,alignValue:z,theme:Y,label:Te=>(0,n.Ct)(k.fields[Te],k),getFieldConfig:Te=>k.fields[Te].config.custom,getValueColor:ee,getTimeRange:se,formatValue:(Te,je)=>(0,i.cN)(k.fields[Te].display(je)),hoverMulti:ie},De=T(de);ae.addHook("init",De.init),ae.addHook("drawClear",De.drawClear),ae.setPrepData(Te=>(0,y.bq)(Te[0],(0,y.ro)(Te[0]))),ae.setCursor(De.cursor),ae.addScale({scaleKey:re,isTime:!0,orientation:l.Lt.Horizontal,direction:l.ON.Right,range:De.xRange}),ae.addScale({scaleKey:m.s,isTime:!1,orientation:l.Lt.Vertical,direction:l.ON.Up,range:De.yRange}),ae.addAxis({scaleKey:re,isTime:!0,splits:De.xSplits,placement:l.vM.Bottom,timeZone:Z[0],theme:Y,grid:{show:!0}}),ae.addAxis({scaleKey:m.s,isTime:!1,placement:l.vM.Left,splits:De.ySplits,values:De.yValues,grid:{show:!1},ticks:{show:!1},gap:16,theme:Y});let fe=0;for(let Te=0;Te<k.fields.length;Te++){if(Te===0)continue;const je=k.fields[Te],He=je.config,Be={...A,...He.custom};je.state.seriesIndex=fe++,ae.addSeries({scaleKey:m.s,pathBuilder:De.drawPaths,pointsBuilder:De.drawPoints,lineWidth:Be.lineWidth,fillOpacity:Be.fillOpacity,theme:Y,show:!Be.hideFrom?.viz,thresholds:He.thresholds,dataFrameFieldIndex:je.state?.origin})}return ae};function U(k){let Y=k.config.custom?.spanNulls;return Y?Y===!0?1/0:Y:-1}function W(k,Y){const Z=k.config.thresholds;if(k.type!==s.PU.number||!Z||!Z.steps.length)return;const se=N(k.config,Y);if(se.length!==Z.steps.length)return;const j=new Map,q=new Map;for(let z=0;z<se.length;z++)j.set(Z.steps[z],se[z].label),q.set(se[z].label,se[z].color);let ne=k.values;const oe=new Array(k.values.length);if(Z.mode===r.O.Percentage){const{min:z,max:te}=(0,f.xg)(k),le=te-z;ne=ne.map(ie=>ie==null?ie:(ie-z)/le*100)}for(let z=0;z<oe.length;z++){const te=ne[z];te==null?oe[z]=te:oe[z]=j.get((0,a.yQ)(te,Z.steps))}return{...k,config:{...k.config,custom:{...k.config.custom,spanNulls:U(k)}},type:s.PU.string,values:oe,display:z=>({text:String(z),color:q.get(String(z)),numeric:NaN})}}function w(k,Y,Z,se){if(!k?.length)return{warn:"No data in response"};(0,n.Fm)(k);let j=!1;const q=[];for(let ne of k){let oe=-1,z=-1;for(let re=0;re<ne.fields.length;re++)if(ne.fields[re].type===s.PU.time){if(oe===-1)oe=re;else if(z===-1){z=re;break}}let te=oe!==-1,le=!1;if(ne=(0,c.Yj)(ne,oe),z!==-1){let re={...ne,fields:ne.fields.filter((me,ee)=>ee!==z)},ce={length:ne.length,fields:[ne.fields[z]]};ne=(0,c.Fd)({frames:[re,ce],keepDisplayNames:!0,nullMode:()=>c.WO}),ne.fields.forEach((me,ee)=>{if(ee>0){let de=me.values;for(let De=0;De<de.length;De++)de[De]==null&&(de[De]=null)}}),le=!0}let ie=(0,o.M)({frame:ne,refFieldPseudoMin:Z.from.valueOf(),refFieldPseudoMax:Z.to.valueOf()});ie!==ne&&(le=!0),ne=(0,h.C)(ie);const ae=[];for(let re of ne.fields)if(!re.config.custom?.hideFrom?.viz)switch(re.type){case s.PU.time:te=!0,j=!0,ae.push(re);break;case s.PU.enum:case s.PU.number:if(Y&&re.config.color?.mode===t.Y.Thresholds){const ce=W(re,se);if(ce){ae.push(ce),le=!0;continue}}case s.PU.boolean:case s.PU.string:re={...re,config:{...re.config,custom:{...re.config.custom,spanNulls:U(re)}}},le=!0,ae.push(re);break;default:le=!0}te&&ae.length>1&&(j=!0,le?q.push({...ne,fields:ae}):q.push(ne))}return j?q.length?{frames:q}:{warn:"No graphable fields"}:{warn:"Data does not have a time field"}}function N(k,Y){const Z=[],se=k.thresholds;if(!se||!se.steps.length)return Z;const j=se.steps,q=(0,i.j_)(se.mode===r.O.Percentage?"percent":k.unit??""),ne=oe=>(0,i.cN)(q(oe,k.decimals??void 0));for(let oe=0;oe<j.length;oe++){let z=j[oe],te=z.value,le="",ie="";te===-1/0&&oe<j.length-1?(te=j[oe+1].value,le="< "):ie="+",Z.push({label:`${le}${ne(te)}${ie}`,color:Y.visualization.getColorByName(z.color),yAxis:1})}return Z}function B(k,Y,Z){if(!(!k||Y.showLegend===!1))return V(K(k),Z)}function V(k,Y){if(!k.length)return;const Z=[],se=k[0].config,j=se.color?.mode??t.Y.Fixed,q=se.thresholds;if(j===t.Y.Thresholds&&q?.steps&&q.steps.length>1)return N(se,Y);if(j.startsWith("continuous"))return;const ne=new Map;return k.forEach(oe=>{oe.config.custom?.hideFrom?.legend||oe.values.forEach(z=>{let te=oe.display(z);te.color&&ne.set(te.text,te.color)})}),ne.forEach((oe,z)=>{z.length>0&&Z.push({label:z,color:Y.visualization.getColorByName(oe??t.F),yAxis:1})}),Z}function K(k){const Y=[];for(const Z of k)for(const se of Z.fields)se.type!==s.PU.time&&Y.push(se);return Y}function H(k,Y){let Z,se=Y+1;if(se>=k.values.length)return null;const j=k.values[Y];for(;Z===void 0;){if(se>=k.values.length)return null;const q=k.values[se];q===void 0||q===j?se++:Z=se}return Z}function X(k){if(k<0||Number.isNaN(k))return"";let Y,Z,se,j,q,ne,oe,z;return oe=Math.floor(k/1e3),ne=Math.floor(oe/60),oe=oe%60,q=Math.floor(ne/60),ne=ne%60,j=Math.floor(q/24),q=q%24,Y=Math.floor(j/365),Y>0&&(j=j%365),Z=Math.floor(j/30),Z>0&&(j=j%30),se=Math.floor(j/7),se>0&&(j=j%7),z=Math.round(k%1e3*1e3)/1e3,(Y>0?Y+"y "+(Z>0?Z+"mo ":"")+(se>0?se+"w ":"")+(j>0?j+"d ":""):Z>0?Z+"mo "+(se>0?se+"w ":"")+(j>0?j+"d ":""):se>0?se+"w "+(j>0?j+"d ":""):j>0?j+"d "+(q>0?q+"h ":""):q>0?q+"h "+(ne>0?ne+"m ":""):ne>0?ne+"m "+(oe>0?oe+"s ":""):oe>0?oe+"s "+(z>0?z+"ms ":""):z>0?z+"ms ":"0").trim()}},35043:(G,O,e)=>{"use strict";e.d(O,{DP:()=>h,NQ:()=>o,zJ:()=>g});var t=e(74848),n=e(32196),i=e(90613),s=e(40845),r=e(14578),f=e(94753),a=e(2913),c=e(8484);const o=[{message:"At least 12 characters",validation:m=>m.length>=12},{message:"One uppercase letter",validation:m=>/[A-Z]+/.test(m)},{message:"One lowercase letter",validation:m=>/[a-z]+/.test(m)},{message:"One number",validation:m=>/[0-9]+/.test(m)},{message:"One symbol",validation:m=>/[\W]/.test(m)}],h=m=>!a.Ay.auth.basicAuthStrongPasswordPolicy||o.every(y=>y.validation(m))||(0,c.t)("profile.change-password.strong-password-validation-register","Password does not comply with the strong password policy"),g=({strongPasswordValidations:m,password:y,pristine:d})=>(0,t.jsx)(i.a,{marginBottom:2,children:m.map(v=>(0,t.jsx)(l,{strongPasswordValidation:v,password:y,pristine:d},v.message))}),l=({strongPasswordValidation:m,password:y,pristine:d})=>{const v=(0,s.of)(p),{basicAuthStrongPasswordPolicy:u}=a.Ay.auth;if(!u)return null;const{message:D,validation:P}=m,x=y.length>0&&P(y),E=x||d?"check":"exclamation-triangle",C=x?"secondary":d?"primary":"error";let M;return x?M=v.icon.valid:d?M=v.icon.pending:M=v.icon.error,(0,t.jsxs)(i.a,{display:"flex",alignItems:"center",marginTop:1,children:[(0,t.jsx)(r.I,{className:(0,n.cx)(v.icon.style,M),name:E}),(0,t.jsx)(f.E,{color:C,children:D})]},D)},p=m=>({icon:{style:(0,n.css)({marginRight:m.spacing(1)}),valid:(0,n.css)({color:m.colors.success.text}),pending:(0,n.css)({color:m.colors.secondary.text}),error:(0,n.css)({color:m.colors.error.text})}})},93522:(G,O,e)=>{"use strict";e.d(O,{N:()=>g});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(37390),f=e(71259),a=e(94753),c=e(8484),o=e(63917);const h=y=>[{category:(0,c.t)("help-modal.shortcuts-category.global","Global"),shortcuts:[{keys:["g","h"],description:(0,c.t)("help-modal.shortcuts-description.go-to-home-dashboard","Go to Home Dashboard")},{keys:["g","d"],description:(0,c.t)("help-modal.shortcuts-description.go-to-dashboards","Go to Dashboards")},{keys:["g","e"],description:(0,c.t)("help-modal.shortcuts-description.go-to-explore","Go to Explore")},{keys:["g","p"],description:(0,c.t)("help-modal.shortcuts-description.go-to-profile","Go to Profile")},{keys:[`${y} + k`],description:(0,c.t)("help-modal.shortcuts-description.open-search","Open search")},{keys:["esc"],description:(0,c.t)("help-modal.shortcuts-description.exit-edit/setting-views","Exit edit/setting views")},{keys:["?"],description:(0,c.t)("help-modal.shortcuts-description.show-all-shortcuts","Show all keyboard shortcuts")},{keys:["c","t"],description:(0,c.t)("help-modal.shortcuts-description.change-theme","Change theme")}]},{category:(0,c.t)("help-modal.shortcuts-category.time-range","Time range"),shortcuts:[{keys:["t","z"],description:(0,c.t)("help-modal.shortcuts-description.zoom-out-time-range","Zoom out time range")},{keys:["t","\u2190"],description:(0,c.t)("help-modal.shortcuts-description.move-time-range-back","Move time range back")},{keys:["t","\u2192"],description:(0,c.t)("help-modal.shortcuts-description.move-time-range-forward","Move time range forward")},{keys:["t","a"],description:(0,c.t)("help-modal.shortcuts-description.make-time-range-permanent","Make time range absolute/permanent")},{keys:["t","c"],description:(0,c.t)("help-modal.shortcuts-description.copy-time-range","Copy time range")},{keys:["t","v"],description:(0,c.t)("help-modal.shortcuts-description.paste-time-range","Paste time range")}]},{category:(0,c.t)("help-modal.shortcuts-category.dashboard","Dashboard"),shortcuts:[{keys:[`${y} + s`],description:(0,c.t)("help-modal.shortcuts-description.save-dashboard","Save dashboard")},{keys:["d","r"],description:(0,c.t)("help-modal.shortcuts-description.refresh-all-panels","Refresh all panels")},{keys:["d","s"],description:(0,c.t)("help-modal.shortcuts-description.dashboard-settings","Dashboard settings")},{keys:["d","v"],description:(0,c.t)("help-modal.shortcuts-description.toggle-active-mode","Toggle in-active / view mode")},{keys:["d","k"],description:(0,c.t)("help-modal.shortcuts-description.toggle-kiosk","Toggle kiosk mode (hides top nav)")},{keys:["d","\u21E7 + e"],description:(0,c.t)("help-modal.shortcuts-description.expand-all-rows","Expand all rows")},{keys:["d","\u21E7 + c"],description:(0,c.t)("help-modal.shortcuts-description.collapse-all-rows","Collapse all rows")},{keys:["d","a"],description:(0,c.t)("help-modal.shortcuts-description.toggle-auto-fit","Toggle auto fit panels (experimental feature)")},{keys:[`${y} + o`],description:(0,c.t)("help-modal.shortcuts-description.toggle-graph-crosshair","Toggle shared graph crosshair")},{keys:["d","l"],description:(0,c.t)("help-modal.shortcuts-description.toggle-all-panel-legends","Toggle all panel legends")},{keys:["d","x"],description:(0,c.t)("help-modal.shortcuts-description.toggle-exemplars","Toggle exemplars in all panel")}]},{category:(0,c.t)("help-modal.shortcuts-category.focused-panel","Focused panel"),shortcuts:[{keys:["e"],description:(0,c.t)("help-modal.shortcuts-description.toggle-panel-edit","Toggle panel edit view")},{keys:["v"],description:(0,c.t)("help-modal.shortcuts-description.toggle-panel-fullscreen","Toggle panel fullscreen view")},{keys:["p","s"],description:(0,c.t)("help-modal.shortcuts-description.open-shared-modal","Open Panel Share Modal")},{keys:["p","d"],description:(0,c.t)("help-modal.shortcuts-description.duplicate-panel","Duplicate Panel")},{keys:["p","r"],description:(0,c.t)("help-modal.shortcuts-description.remove-panel","Remove Panel")},{keys:["p","l"],description:(0,c.t)("help-modal.shortcuts-description.toggle-panel-legend","Toggle panel legend")}]}],g=({onDismiss:y})=>{const d=(0,s.of)(m),v=(0,i.useMemo)(()=>(0,o.gn)(),[]),u=(0,i.useMemo)(()=>h(v),[v]);return(0,t.jsx)(r.a,{title:(0,c.t)("help-modal.title","Shortcuts"),isOpen:!0,onDismiss:y,onClickBackdrop:y,children:(0,t.jsx)(f.x,{columns:{xs:1,sm:2},gap:3,tabIndex:0,children:Object.values(u).map(({category:D,shortcuts:P})=>(0,t.jsx)("section",{children:(0,t.jsxs)("table",{className:d.table,children:[(0,t.jsx)("caption",{children:(0,t.jsx)(a.E,{element:"p",variant:"h5",children:D})}),(0,t.jsx)("thead",{className:"sr-only",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Keys"}),(0,t.jsx)("th",{children:"Description"})]})}),(0,t.jsx)("tbody",{children:P.map(({keys:x,description:E})=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:d.keys,children:x.map(C=>(0,t.jsx)(l,{children:C},C))}),(0,t.jsx)("td",{children:(0,t.jsx)(a.E,{variant:"bodySmall",element:"p",children:E})})]},x.join()))})]})},D))})})},l=({children:y})=>{const d=(0,s.of)(m),v=(0,i.useMemo)(()=>p(y),[y]),u=(0,t.jsx)("span",{dangerouslySetInnerHTML:{__html:v}});return(0,t.jsx)("kbd",{className:d.shortcutTableKey,children:(0,t.jsx)(a.E,{variant:"code",children:u})})};function p(y){let d,v;if(y.includes("ctrl"))d="ctrl",v="Control";else if(y.includes("esc"))d="esc",v="Escape";else return y;return y.replace(d,`<span class="sr-only">${v}</span><span aria-hidden="true" role="none">${d}</span>`)}function m(y){return{table:(0,n.css)({borderCollapse:"separate",borderSpacing:y.spacing(2),"& caption":{captionSide:"top"}}),keys:(0,n.css)({textAlign:"end",whiteSpace:"nowrap",minWidth:83}),shortcutTableKey:(0,n.css)({display:"inline-block",textAlign:"center",marginRight:y.spacing(.5),padding:"3px 5px",lineHeight:"10px",verticalAlign:"middle",border:`solid 1px ${y.colors.border.medium}`,borderRadius:y.shape.radius.default,color:y.colors.text.primary,backgroundColor:y.colors.background.secondary})}}},2913:(G,O,e)=>{"use strict";e.d(O,{Ay:()=>s,_R:()=>f,config:()=>n.$,yn:()=>a,zj:()=>r});var t=e(43429),n=e(32264);let i=n.$;const s=i,r=()=>i,f=c=>{i={...i,...c}},a=n.$.panels?.debug?.state===t.pn.alpha},15054:(G,O,e)=>{"use strict";e.d(O,{FG:()=>l,HG:()=>r,IZ:()=>h,MM:()=>m,Pz:()=>s,bJ:()=>a,cV:()=>i,cx:()=>c,dU:()=>n,o9:()=>f,sD:()=>t,tH:()=>o,wV:()=>p});const t=30,n=8,i=24,s="v",r="h",f=4,a=250,c=t*3,o="panel-copy",h=2,g=23763571993,l=40,p="VisualizationSelectPane.ListMode",m="WidgetSelectPane.ListMode"},76888:(G,O,e)=>{"use strict";e.d(O,{Il:()=>r,YE:()=>s,k9:()=>c,ni:()=>f});var t=e(96540),n=e(12131),i=e(32264);const s=(0,t.createContext)(void 0);function r(){const o=(0,t.useContext)(s);if(!o)throw new Error("No GrafanaContext found");return o}function f(){const{chrome:o}=r();return(0,t.useCallback)((h,g)=>{const{pathname:l,search:p}=n.Ny.getLocation();o.setReturnToPrevious({title:h,href:g??l+p})},[o])}const a=40;function c(){const{chrome:o}=r(),{kioskMode:h,searchBarHidden:g,chromeless:l}=o.useState();return h||l||!i.$.featureToggles.bodyScrolling?0:g?a:a*2}},3169:(G,O,e)=>{"use strict";e.d(O,{Cf:()=>l,_2:()=>p,gi:()=>h,q8:()=>g,tZ:()=>o});var t=e(96540),n=e(62938),i=e(94954),s=e(31678),r=e(82467);const f={title:"",text:"",severity:s.AppNotificationSeverity.Success,icon:"check"},a={title:"",text:"",severity:s.AppNotificationSeverity.Warning,icon:"exclamation-triangle"},c={title:"",text:"",severity:s.AppNotificationSeverity.Error,icon:"exclamation-triangle"},o=(m,y="",d)=>({...f,title:m,text:y,id:(0,n.A)(),timestamp:Date.now(),showing:!0}),h=(m,y="",d,v)=>({...c,text:(0,i.q)(y),title:m,id:(0,n.A)(),traceId:d,component:v,timestamp:Date.now(),showing:!0}),g=(m,y="",d)=>({...a,title:m,text:y,traceId:d,id:(0,n.A)(),timestamp:Date.now(),showing:!0}),l=(m,y="",d)=>({severity:s.AppNotificationSeverity.Info,icon:"info-circle",title:m,text:y,id:(0,n.A)(),timestamp:Date.now(),showing:!0});function p(){const m=(0,s.useDispatch)();return(0,t.useMemo)(()=>({success:(y,d="")=>{m((0,r.dx)(o(y,d)))},warning:(y,d="",v)=>{m((0,r.dx)(g(y,d,v)))},error:(y,d="",v)=>{m((0,r.dx)(h(y,d,v)))},info:(y,d="")=>{m((0,r.dx)(l(y,d)))}}),[m])}},10096:(G,O,e)=>{"use strict";e.d(O,{Ef:()=>n.E,TP:()=>i.TP,lE:()=>t.A,rO:()=>s.r});var t=e(28138),n=e(18898),i=e(16233),s=e(31140)},39640:(G,O,e)=>{"use strict";e.d(O,{$H:()=>o,Ay:()=>h});var t=e(2543),n=e(33390),i=e(38877),s=e(19347);const r=D=>{const P=(0,s.l)().getInstanceSettings(D.datasourceName);return{id:D.ts.toString(),createdAt:D.ts,datasourceName:D.datasourceName,datasourceUid:P?.uid||"",starred:D.starred,comment:D.comment,queries:D.queries}},f=D=>{if(!(0,s.l)().getInstanceSettings({uid:D.datasourceUid}))throw new Error("Datasource not found.");return{ts:D.createdAt,datasourceName:D.datasourceName,starred:D.starred,comment:D.comment,queries:D.queries}};var a=e(75533);const c="grafana.explore.richHistory",o=1e4;class h{async getRichHistory(P){const x=m().map(r),E=P.starred?x.filter(S=>S.starred===!0):x,C=P.from&&P.to?[P.from,P.to]:void 0,M=(0,a.a_)(E,P.sortOrder,P.datasourceFilters,P.search,C);return{richHistory:M,total:M.length}}async addToRichHistory(P){const x=Date.now(),E={id:x.toString(),createdAt:x,...P},C=f(E),M=l(m()),S=C.queries.map(A=>(0,t.omit)(A,["key","refId"])),I=M.length>0&&M[0].queries.map(A=>(0,t.omit)(A,["key","refId"]));if((0,t.isEqual)(S,I)){const A=new Error("Entry already exists");throw A.name=i.m.DuplicatedEntry,A}const{queriesToKeep:T,limitExceeded:b}=p(M),R=[C,...T];try{n.A.setObject(c,R)}catch(A){if(A instanceof Error&&A.name==="QuotaExceededError")u(i.m.StorageFull,`Saving rich history failed: ${A.message}`);else throw A}return b?{warning:{type:i.C.LimitExceeded,message:`Query history reached the limit of ${o}. Old, not-starred items have been removed.`},richHistoryQuery:E}:{richHistoryQuery:E}}async deleteAll(){n.A.delete(c)}async deleteRichHistory(P){const x=parseInt(P,10),C=n.A.getObject(c,[]).filter(M=>M.ts!==x);n.A.setObject(c,C)}async updateStarred(P,x){return g(P,E=>E.starred=x)}async updateComment(P,x){return g(P,E=>E.comment=x)}async getSettings(){return{activeDatasourcesOnly:n.A.getObject(a.mE.activeDatasourcesOnly)??n.A.getObject(a.mE.legacyActiveDatasourceOnly,!1),retentionPeriod:n.A.getObject(a.mE.retentionPeriod,7),starredTabAsFirstTab:n.A.getBool(a.mE.starredTabAsFirstTab,!1),lastUsedDatasourceFilters:n.A.getObject(a.mE.datasourceFilters,[]).map(x=>x.value)}}async updateSettings(P){n.A.set(a.mE.activeDatasourcesOnly,P.activeDatasourcesOnly),n.A.set(a.mE.retentionPeriod,P.retentionPeriod),n.A.set(a.mE.starredTabAsFirstTab,P.starredTabAsFirstTab),n.A.setObject(a.mE.datasourceFilters,(P.lastUsedDatasourceFilters||[]).map(x=>({value:x})))}}function g(D,P){const x=parseInt(D,10),E=n.A.getObject(c,[]),C=(0,t.find)(E,{ts:x});if(!C)throw new Error("Rich history item not found.");return P(C),n.A.setObject(c,E),r(C)}function l(D){const P=n.A.getObject(a.mE.retentionPeriod,7),x=(0,a.wQ)(P,{isLastTs:!1});return D.filter(E=>E.ts>x||E.starred===!0)||[]}function p(D){let P=!1,x=D.length-1;for(;x>=0&&D.length>=o;)D[x].starred||(D.splice(x,1),P=!0),x--;return{queriesToKeep:D,limitExceeded:P}}function m(){const D=n.A.getObject(c,[]);return y(D)}function y(D){return D.map(x=>{const E=x.queries.map((C,M)=>d(x,C,M));return{...x,queries:E}})}function d(D,P,x){const E="ABCDEFGHIJKLMNOPQRSTUVXYZ";return typeof P=="object"?P:v(P)?JSON.parse(P):{expr:P,refId:E[x]}}function v(D){try{JSON.parse(D)}catch{return!1}return!0}function u(D,P){const x=new Error(P);throw x.name=D,x}},38877:(G,O,e)=>{"use strict";e.d(O,{C:()=>n,m:()=>t});var t=(i=>(i.StorageFull="StorageFull",i.DuplicatedEntry="DuplicatedEntry",i))(t||{}),n=(i=>(i.LimitExceeded="LimitExceeded",i))(n||{})},75533:(G,O,e)=>{"use strict";e.d(O,{a_:()=>r,mE:()=>g,wQ:()=>f});var t=e(2543),n=e.n(t),i=e(47232),s=e(91650);function r(l,p,m,y,d){const v=c(l,m),u=o(v,y),D=d?a(u,d):u;return h(D,p)}const f=(l,p)=>{let m=p.now;return m||(m=p.tz?(0,i.oZ)(p.tz):(0,i.KQ)()),m.add(-l,"d"),(p.isLastTs?m.endOf("d"):m.startOf("d")).valueOf()};function a(l,p){return l.filter(m=>m.createdAt>p[0]&&m.createdAt<p[1])}function c(l,p){return p.length>0?l.filter(m=>p.includes(m.datasourceName)):l}function o(l,p){return l.filter(m=>m.comment.includes(p)?!0:m.queries.filter(d=>Object.values((0,t.omit)(d,["datasource","key","refId","hide","queryType"])).some(v=>v?.toString().includes(p))).length>0)}const h=(l,p)=>{let m;return p===s.x.Ascending&&(m=(y,d)=>y.createdAt<d.createdAt?-1:y.createdAt>d.createdAt?1:0),p===s.x.Descending&&(m=(y,d)=>y.createdAt<d.createdAt?1:y.createdAt>d.createdAt?-1:0),p===s.x.DatasourceZA&&(m=(y,d)=>y.datasourceName<d.datasourceName?-1:y.datasourceName>d.datasourceName?1:0),p===s.x.DatasourceAZ&&(m=(y,d)=>y.datasourceName<d.datasourceName?1:y.datasourceName>d.datasourceName?-1:0),l.sort(m)},g={retentionPeriod:"grafana.explore.richHistory.retentionPeriod",starredTabAsFirstTab:"grafana.explore.richHistory.starredTabAsFirstTab",legacyActiveDatasourceOnly:"grafana.explore.richHistory.activeDatasourceOnly",activeDatasourcesOnly:"grafana.explore.richHistory.activeDatasourcesOnly",datasourceFilters:"grafana.explore.richHistory.datasourceFilters"}},11401:(G,O,e)=>{"use strict";e.d(O,{tU:()=>d,a:()=>y,gQ:()=>v});var t=e(32264),n=e(10096),i=e(91650),s=e(39640),r=e(75505),f=e(17172),a=e(19347),c=e(65615);const o=u=>{const D=(0,a.l)().getInstanceSettings({uid:u.datasourceUid});return{id:u.uid,createdAt:u.createdAt*1e3,datasourceName:D?.name||"",datasourceUid:u.datasourceUid,starred:u.starred,comment:u.comment,queries:u.queries}},h=u=>({uid:u.id,createdAt:Math.floor(u.createdAt/1e3),datasourceUid:u.datasourceUid,starred:u.starred,comment:u.comment,queries:u.queries});class g{constructor(){this.preferenceService=new c.W("user")}async addToRichHistory(D){const{result:P}=await(0,f.AI)().post("/api/query-history",{dataSourceUid:D.datasourceUid,queries:D.queries});return{richHistoryQuery:o(P)}}async deleteAll(){throw new Error("not supported")}async deleteRichHistory(D){(0,f.AI)().delete(`/api/query-history/${D}`)}async getRichHistory(D){const P=l(D);let x="query-history-get-all";D.starred&&(x="query-history-get-starred");const C=(await(0,r.s)((0,f.AI)().fetch({method:"GET",url:`/api/query-history?${P}`,requestId:x}))).data,M=(C.result.queryHistory||[]).map(o),S=C.result.totalCount||0;return{richHistory:M,total:S}}async getSettings(){return{activeDatasourcesOnly:!1,lastUsedDatasourceFilters:void 0,retentionPeriod:14,starredTabAsFirstTab:(await this.preferenceService.load()).queryHistory?.homeTab==="starred"}}async updateComment(D,P){const x=await(0,f.AI)().patch(`/api/query-history/${D}`,{comment:P});return o(x.result)}updateSettings(D){return this.preferenceService.patch({queryHistory:{homeTab:D.starredTabAsFirstTab?"starred":"query"}})}async updateStarred(D,P){let x;return P?x=await(0,f.AI)().post(`/api/query-history/star/${D}`):x=await(0,f.AI)().delete(`/api/query-history/star/${D}`),o(x.result)}}function l(u){let D=`${u.datasourceFilters.map(P=>{const x=(0,a.l)().getInstanceSettings(P).uid;return`datasourceUid=${encodeURIComponent(x)}`}).join("&")}`;return u.search&&(D=D+`&searchString=${u.search}`),u.sortOrder&&(D=D+`&sort=${u.sortOrder===i.x.Ascending?"time-asc":"time-desc"}`),u.starred||(D=D+`&to=${u.to}`,D=D+`&from=${u.from}`),D=D+"&limit=100",D=D+`&page=${u.page||1}`,u.starred&&(D=D+`&onlyStarred=${u.starred}`),D}const p=new s.Ay,m=new g,y=()=>t.$.queryHistoryEnabled?m:p,d=()=>p,v=()=>t.$.queryHistoryEnabled?{availableFilters:[i.x.Descending,i.x.Ascending],lastUsedDataSourcesAvailable:!1,clearHistory:!1,onlyActiveDataSource:!1,changeRetention:!1,queryHistoryAvailable:n.TP.isSignedIn}:{availableFilters:[i.x.Descending,i.x.Ascending,i.x.DatasourceAZ,i.x.DatasourceZA],lastUsedDataSourcesAvailable:!0,clearHistory:!0,onlyActiveDataSource:!0,changeRetention:!0,queryHistoryAvailable:!0}},16021:(G,O,e)=>{"use strict";e.d(O,{u:()=>n});var t=e(96540);function n(i,s){const[r,f]=(0,t.useState)();return(0,t.useEffect)(()=>{const a=i.subscribe(s,f);return()=>a.unsubscribe()},[i,s]),r}},60619:(G,O,e)=>{"use strict";e.d(O,{Y:()=>n});var t=e(96540);function n({breakpoint:i,onChange:s}){(0,t.useEffect)(()=>{const r=window.matchMedia(`(min-width: ${i}px)`),f=a=>s(a);return r.addEventListener("change",f),()=>r.removeEventListener("change",f)},[i,s])}},25249:(G,O,e)=>{"use strict";e.d(O,{C:()=>i});var t=e(31678),n=e(17422);const i=s=>{const r=(0,t.useSelector)(f=>f.navIndex);return(0,n.tc)(r,s)}},83277:(G,O,e)=>{"use strict";e.d(O,{s:()=>s});var t=e(96540),n=e(24180),i=e(12131);function s(){const{search:r}=(0,n.zy)(),f=(0,t.useMemo)(()=>(0,i.SE)(r||""),[r]),a=(0,t.useCallback)((c,o)=>i.Ny.partial(c,o),[]);return[f,a]}},74513:(G,O,e)=>{"use strict";e.d(O,{Nm:()=>h,Yj:()=>g,dK:()=>p,rd:()=>l,wi:()=>o});var t=e(2543),n=e.n(t);const i="en-US",s="fr-FR",r="es-ES",f="de-DE",a="pt-BR",c="zh-Hans",o="pseudo-LOCALE",h=i,g=[{code:i,name:"English",loader:{grafana:()=>e.e(9521).then(e.t.bind(e,19521,19))}},{code:s,name:"Fran\xE7ais",loader:{grafana:()=>e.e(5648).then(e.t.bind(e,35648,19))}},{code:r,name:"Espa\xF1ol",loader:{grafana:()=>e.e(680).then(e.t.bind(e,70680,19))}},{code:f,name:"Deutsch",loader:{grafana:()=>e.e(3082).then(e.t.bind(e,23082,19))}},{code:c,name:"\u4E2D\u6587\uFF08\u7B80\u4F53\uFF09",loader:{grafana:()=>e.e(9538).then(e.t.bind(e,29538,19))}},{code:a,name:"Portugu\xEAs Brasileiro",loader:{grafana:()=>e.e(2288).then(e.t.bind(e,12288,19))}}];{const m=e(55905);if(m.keys().includes("app/extensions/locales/localeExtensions")){const{LOCALE_EXTENSIONS:y,ENTERPRISE_I18N_NAMESPACE:d}=m("app/extensions/locales/localeExtensions");for(const v of g){const u=y[v.code];u&&(v.loader[d]=u)}}}const l=g.map(m=>m.code),p=(0,t.uniq)(g.flatMap(m=>Object.keys(m.loader)))},84753:(G,O,e)=>{"use strict";e.d(O,{Y:()=>h,a:()=>g});var t=e(5086),n=e(32017),i=e.n(n),s=e(47078),r=e.n(s),f=e(8484);const a=l=>r()(l,{isEqual:i()}),c=a((l,p)=>new Intl.DateTimeFormat(l,p)),o=a((l,p)=>new Intl.DurationFormat(l,p)),h=a((l,p={})=>{if(typeof l=="string")return h(new Date(l),p);const m=(0,f.iL)();return c(m.language,p).format(l)}),g=a((l,p={})=>{const m=(0,f.iL)();return o(m.language,p).format(l)})},8484:(G,O,e)=>{"use strict";e.d(O,{x6:()=>l,iL:()=>m,JL:()=>h,t:()=>p});var t=e(74848),n=e(72635),i=e(94997),s=e(32389),r=e(74513);const f=y=>y.split("-")[0].toLowerCase(),a={type:"backend",init(){},async read(y,d,v){let u=r.Yj.find(x=>x.code===y);if(u||(u=r.Yj.find(x=>f(x.code)===f(y))),!u)return v(new Error(`No message loader available for ${y}`),null);const D=u.loader[d];if(!D)return v(new Error(`No message loader available for ${y} with namespace ${d}`),null);const P=await D();v(null,P)}};let c,o;async function h(y){const d={partialBundledLanguages:!0,resources:{},returnEmptyString:!1,supportedLngs:r.rd,fallbackLng:r.Nm,ns:r.dK};if(o=n.default,y==="detect"){o=o.use(i.A);const u={order:["navigator"],caches:[]};d.detection=u}else d.lng=r.rd.includes(y)?y:void 0;return await o.use(a).use(s.r9).init(d),c=n.default.getFixedT(null,r.dK),{language:o.resolvedLanguage}}function g(y){const d=VALID_LANGUAGES.includes(y)?y:void 0;return i18n.changeLanguage(d)}const l=y=>(0,t.jsx)(s.x6,{shouldUnescape:!0,ns:r.dK,...y}),p=(y,d,v)=>(c||(console.warn("t() was called before i18n was initialized. This is probably caused by calling t() in the root module scope, instead of lazily on render"),c=n.default.t),c(y,d,v));function m(){return c?o||n.default:(console.warn("An attempt to internationalize was made before it was initialized. This was probably caused by calling a locale-aware function in the root module scope, instead of in render"),n.default)}},18898:(G,O,e)=>{"use strict";e.d(O,{E:()=>n});class t{constructor(){this.panelsRendered=0,this.enabled=void 0}renderingCompleted(){this.panelsRendered+=1,window.panelsRendered=this.panelsRendered}}const n=new t},16001:(G,O,e)=>{"use strict";e.d(O,{$K:()=>y,Do:()=>h,XC:()=>l,XR:()=>g,dx:()=>o,fX:()=>D,g5:()=>m,oF:()=>p,qN:()=>u});var t=e(65307),n=e(25508),i=e(31678);const s=25,r="notifications",f=`${r}/lastRead`,a={byId:C(),lastRead:Number.parseInt(window.localStorage.getItem(f)??`${Date.now()}`,10)},c=(0,t.Z0)({name:"appNotifications",initialState:a,reducers:{notifyApp:(S,{payload:I})=>{Object.values(S.byId).some(T=>P(I,T)&&T.showing)||(S.byId[I.id]=I,M(S.byId))},hideAppNotification:(S,{payload:I})=>{I in S.byId&&(S.byId[I].showing=!1,M(S.byId))},clearNotification:(S,{payload:I})=>{delete S.byId[I],M(S.byId)},clearAllNotifications:S=>{S.byId={},M(S.byId)},readAllNotifications:(S,{payload:I})=>{S.lastRead=I}}}),{notifyApp:o,hideAppNotification:h,clearNotification:g,clearAllNotifications:l,readAllNotifications:p}=c.actions,m=c.reducer,y=S=>S.lastRead,d=S=>S.byId,v=(0,n.Mz)(d,S=>Object.values(S).sort((I,T)=>T.timestamp-I.timestamp)),u=(0,n.Mz)(v,S=>S.filter(x)),D=(0,n.Mz)(d,S=>Object.values(S).filter(I=>I.showing));function P(S,I){return S.icon===I.icon&&S.severity===I.severity&&S.text===I.text&&S.title===I.title}function x(S){return S.severity===i.AppNotificationSeverity.Warning||S.severity===i.AppNotificationSeverity.Error}function E(S){return typeof S=="object"&&S!==null&&"id"in S&&"icon"in S&&"title"in S&&"text"in S}function C(){const S=window.localStorage.getItem(r);if(!S)return{};const I=JSON.parse(S);return Object.values(I).every(T=>E(T))?I:{}}function M(S){const I=Object.values(S).filter(x).sort((T,b)=>b.timestamp-T.timestamp).slice(0,s).reduce((T,b)=>(T[b.id]={id:b.id,severity:b.severity,icon:b.icon,title:b.title,text:b.text,traceId:b.traceId,timestamp:b.timestamp,showing:!1},T),{});try{window.localStorage.setItem(r,JSON.stringify(I))}catch(T){console.error("Unable to persist notifications to local storage"),console.error(T)}}},91219:(G,O,e)=>{"use strict";e.d(O,{I_:()=>l,L1:()=>f,TU:()=>h,ci:()=>c,fc:()=>o,ve:()=>g});var t=e(65307),n=e(32264),i=e(36689);const s=n.$.bootData?.navTree??[];function r(p){return p.map(m=>{const y=m.children&&r(m.children);return{...m,children:y,text:(0,i.C)(m.id)??m.text,subTitle:(0,i.o)(m.id)??m.subTitle,emptyMessage:(0,i.C)(m.emptyMessageId)}})}const f="starred/",a=(0,t.Z0)({name:"navBarTree",initialState:()=>r(n.$.bootData?.navTree??[]),reducers:{setStarred:(p,m)=>{const y=p.find(P=>P.id==="starred"),{id:d,title:v,url:u,isStarred:D}=m.payload;if(y)if(D){y.children||(y.children=[]);const P={id:f+d,text:v,url:u};y.children.push(P),y.children.sort((x,E)=>x.text.localeCompare(E.text))}else{const P=y.children?.findIndex(x=>x.id===f+d)??-1;P>-1&&y?.children?.splice(P,1)}},setBookmark:(p,m)=>{if(!n.$.featureToggles.pinNavItems)return;const y=p.find(u=>u.id==="bookmarks"),{item:d,isSaved:v}=m.payload;if(y)if(v){y.children||=[];const u={...d,children:[],sortWeight:0,emptyMessageId:"",emptyMessage:"",parentItem:{id:y.id,text:y.text}};y.children.push(u)}else y.children=y.children?.filter(u=>u.id!==d.id)??[]},updateDashboardName:(p,m)=>{const{id:y,title:d,url:v}=m.payload,u=p.find(D=>D.id==="starred");if(u){const D=u.children?.find(P=>P.id===y);D&&(D.text=d,D.url=v,u.children?.sort((P,x)=>P.text.localeCompare(x.text)))}},removePluginFromNavTree:(p,m)=>{const y="plugin-page-"+m.payload.pluginID,d=p.findIndex(v=>v.id===y);d>-1&&p.splice(d,1)}}}),{setStarred:c,removePluginFromNavTree:o,updateDashboardName:h,setBookmark:g}=a.actions,l=a.reducer},28215:(G,O,e)=>{"use strict";e.d(O,{Id:()=>f,Im:()=>p,Vz:()=>g,YA:()=>l,_h:()=>y,s2:()=>a});var t=e(65307),n=e(2543),i=e.n(n),s=e(2913),r=e(36689);const f="home";function a(){const d={},v=(0,n.cloneDeep)(s.Ay.bootData.navTree),u=v.find(P=>P.id===f),D=v.filter(P=>P.id!==f);return u&&c(d,[u]),c(d,D,d[f]),d}function c(d,v,u){const D=[];for(const P of v){const x={...P,text:(0,r.C)(P.id)??P.text,subTitle:(0,r.o)(P.id)??P.subTitle,emptyMessage:(0,r.C)(P.emptyMessageId),parentItem:u};x.id&&(d[x.id]=x),x.children&&c(d,x.children,x),D.push(x)}u&&(u.children=D),d["not-found"]={...o("Page not found","404 Error").node},d.error={...o("Page error","An unexpected error").node}}function o(d,v){const u={text:d,subTitle:v,icon:"exclamation-triangle"};return{node:u,main:u}}const h={},g=(0,t.VP)("navIndex/updateNavIndex"),l=(0,t.VP)("navIndex/updateConfigurationSubtitle"),p=(0,t.VP)("navIndex/removeNavIndex"),m=(d,v)=>({...d,parentItem:{...d.parentItem,text:d.parentItem?.text??"",subTitle:v}}),y=(d=h,v)=>{if(g.match(v)){let D=function(E){if(E.children)for(const C of E.children)P[C.id]={...C,parentItem:E};E.parentItem&&D(E.parentItem)};var u=D;const P={},x=v.payload;return D(x),{...d,...P}}else if(l.match(v)){const D=`Organization: ${v.payload}`;return{...d,cfg:{...d.cfg,subTitle:D},datasources:m(d.datasources,D),correlations:m(d.correlations,D),users:m(d.users,D),teams:m(d.teams,D),plugins:m(d.plugins,D),"org-settings":m(d["org-settings"],D),apikeys:m(d.apikeys,D)}}else p.match(v)&&delete d[v.payload];return d}},17422:(G,O,e)=>{"use strict";e.d(O,{rH:()=>f,tc:()=>r});var t=e(41811),n=e(71101),i=e(28215);const s=()=>{const o={id:"not-found",text:"Page not found",icon:"exclamation-triangle",subTitle:"404 Error",url:"not-found"};return{node:o,main:o}},r=(0,t.A)((o,h,g,l=!1)=>{if(o[h]){const p=o[h],m=l?p:f(p),y=a(m,h);return{node:p,main:y}}return g||s()});function f(o){return o.id===n.Rj?o:o.parentItem&&o.parentItem.id!==i.Id?f(o.parentItem):o}function a(o,h){return o.id===h?{...o,active:!0}:o.children&&o.children.length>0?{...o,children:o.children.map(g=>a(g,h))}:o}const c=o=>`${o.main.text}${o.node.text?": "+o.node.text:""}`},65615:(G,O,e)=>{"use strict";e.d(O,{W:()=>n});var t=e(27677);class n{constructor(s){this.resourceUri=s}update(s){return t.IB.put(`/api/${this.resourceUri}/preferences`,s)}patch(s){return t.IB.patch(`/api/${this.resourceUri}/preferences`,s)}load(){return t.IB.get(`/api/${this.resourceUri}/preferences`)}}},2619:(G,O,e)=>{"use strict";e.d(O,{Q:()=>s});var t=e(96540),n=e(13752),i=e(69731);class s{constructor(a){this._subject=new n.B,this._state=a}useState(){return r(this)}get state(){return this._state}setState(a){this._state={...this._state,...a},this._subject.next(this._state)}subscribeToState(a){return this._subject.subscribe(a)}}function r(f){const a=(0,i.C)();return(0,t.useEffect)(()=>{const c=f.subscribeToState({next:a});return()=>c.unsubscribe()},[f,a]),f.state}},27677:(G,O,e)=>{"use strict";e.d(O,{Mf:()=>He,IB:()=>Be,AI:()=>Ne});var t=e(56568),n=e(13752),i=e(75505),s=e(88483),r=e(64423),f=e(13288),a=e(65474),c=e(20039),o=e(81160),h=e(69862),g=e(59099),l=e(37748),p=e(66847),m=e(67791),y=e(16126),d=e(41560),v=e(69850),u=e(1005),D=e(62938),P=e(26272),x=e(40187),E=e(95344),C=e(32264),M=e(28138),S=e(2913),I=e(92315),T=e(67027),b=e(28676),R=e(74848),A=e(32196),L=e(40845),U=e(17464),W=e(37166),w=e(55852),N=e(88448);const B=Re=>{const Se=(0,L.of)(V),We=(0,L.$j)(),Ke=(0,N.o)(We),Xe=!!Re.maxConcurrentSessions,Je=()=>{window.location.reload()};return(0,R.jsxs)(U.ZL,{children:[(0,R.jsx)("div",{className:Ke.modal,children:(0,R.jsxs)(W.w,{title:"You have been automatically signed out",severity:"warning",className:Se.infobox,children:[(0,R.jsxs)("div",{className:Se.text,children:[(0,R.jsxs)("p",{children:["Your session token was automatically revoked because you have reached",(0,R.jsx)("strong",{children:` the maximum number of ${Xe?Re.maxConcurrentSessions:""} concurrent sessions `}),"for your account."]}),(0,R.jsxs)("p",{children:[(0,R.jsx)("strong",{children:"To resume your session, sign in again."}),"Contact your administrator or visit the license page to review your quota if you are repeatedly signed out automatically."]})]}),(0,R.jsx)(w.$n,{size:"md",variant:"primary",onClick:Je,children:"Sign in"})]})}),(0,R.jsx)("div",{className:(0,A.cx)(Ke.modalBackdrop,Se.backdrop)})]})},V=Re=>({infobox:(0,A.css)`
    margin-bottom: 0;
  `,text:(0,A.css)`
    margin: ${Re.spacing(1,0,2)};
  `,backdrop:(0,A.css)`
    background-color: ${Re.colors.background.canvas};
    opacity: 0.8;
  `});var K=e(28444),H=e(2543);const X=Re=>{const Se=Re.method,We=ne(Re),Ke=oe(We),Xe=z(Re,Ke),Je=ae(Re);return{method:Se,headers:We,body:Xe,credentials:Je}},k={canParse:()=>!0,parse:Re=>(Re.get("accept")||Re.set("accept","application/json, text/plain, */*"),Re)},Y=Re=>({canParse:Se=>(Se?.method?Se?.method.toLowerCase():"")===Re,parse:Se=>(Se.get("content-type")||Se.set("content-type","application/json"),Se)}),Z=Y("post"),se=Y("put"),j=Y("patch"),q=[Z,se,j,k],ne=Re=>{const Se=Re?.headers?new Headers(Re.headers):new Headers;return q.filter(Xe=>Xe.canParse(Re)).reduce((Xe,Je)=>Je.parse(Xe),Se)},oe=Re=>{if(!Re)return!1;const Se=Re.get("content-type");return!!(Se&&Se.toLowerCase()==="application/json")},z=(Re,Se)=>Re&&(!Re.data||typeof Re.data=="string"||Re.data instanceof Blob?Re.data:Se?JSON.stringify(Re.data):new URLSearchParams(Re.data));async function te(Re,Se){if(Se)switch(Se){case"arraybuffer":return Re.arrayBuffer();case"blob":return Re.blob();case"json":return Re.headers.get("Content-Length")==="0"?(console.warn(`${Re.url} returned an invalid JSON`),{}):await Re.json();case"text":return Re.text()}const We=await Re.text();try{return JSON.parse(We)}catch{}return We}function le(Re){return Object.keys(Re).map(Se=>{const We=Re[Se];return Array.isArray(We)?We.map(Ke=>`${encodeURIComponent(Se)}=${encodeURIComponent(Ke)}`).join("&"):`${encodeURIComponent(Se)}=${encodeURIComponent(We)}`}).join("&")}const ie=Re=>{const Se=(0,H.omitBy)(Re.params,Ke=>Ke===void 0||Ke&&Ke.length===0),We=le(Se);return Re.params&&We.length?`${Re.url}?${We}`:Re.url},ae=Re=>Re&&(Re.credentials?Re.credentials:Re.withCredentials?((0,E.l)("BackendSrvRequest","withCredentials","credentials"),"include"):"same-origin");var re=e(21969),ce=(Re=>(Re[Re.Pending=0]="Pending",Re[Re.InProgress=1]="InProgress",Re[Re.Done=2]="Done",Re))(ce||{});class me{constructor(Se=!1){this.state={},this.queue=new n.B,this.updates=new n.B,this.add=(We,Ke)=>this.queue.next({id:We,options:Ke,state:0}),this.setInProgress=We=>this.queue.next({id:We,state:1}),this.setDone=We=>this.queue.next({id:We,state:2}),this.getUpdates=()=>this.updates.asObservable(),this.getUpdate=We=>{const Ke=Object.keys(We).filter(Je=>We[Je].state===1).length;return{noOfPending:Object.keys(We).filter(Je=>We[Je].state===0).length,noOfInProgress:Ke,state:We}},this.publishUpdate=(We,Ke)=>{this.printState(We,Ke),this.updates.next(We)},this.printState=(We,Ke)=>{if(!Ke)return;const Xe=Object.keys(We.state).reduce((Je,st)=>{const pt={id:st,state:We.state[st].state};return Je.push(pt),Je},[]);console.log("FetchQueue noOfStarted",We.noOfInProgress),console.log("FetchQueue noOfNotStarted",We.noOfPending),console.log("FetchQueue state",Xe)},this.queue.subscribe(We=>{const{id:Ke,state:Xe,options:Je}=We;if(this.state[Ke]||(this.state[Ke]={state:0,options:{url:""}}),Xe===2){delete this.state[Ke];const pt=this.getUpdate(this.state);this.publishUpdate(pt,Se);return}this.state[Ke].state=Xe,Je&&(this.state[Ke].options=Je);const st=this.getUpdate(this.state);this.publishUpdate(st,Se)})}}var ee=e(95864);class de{constructor(Se,We,Ke){const Xe=Ke?.http2Enabled?1e3:5;Se.getUpdates().pipe((0,y.p)(({noOfPending:Je})=>Je>0),(0,ee.H)(({state:Je,noOfInProgress:st})=>{const pt=Object.keys(Je).filter(ve=>Je[ve].state===ce.Pending&&!(0,re.dr)(Je[ve].options.url)).reduce((ve,be)=>{const he={id:be,options:Je[be].options};return ve.push(he),ve},[]),xt=Object.keys(Je).filter(ve=>Je[ve].state===ce.Pending&&(0,re.dr)(Je[ve].options.url)).reduce((ve,be)=>{const he={id:be,options:Je[be].options};return ve.push(he),ve},[]),ot=Math.max(Xe-st-pt.length,0),$e=xt.slice(0,ot);return pt.concat($e)})).subscribe(({id:Je,options:st})=>{We.add(Je,st)})}}class De{constructor(Se,We){this.queue=new n.B,this.responses=new n.B,this.add=(Ke,Xe)=>{this.queue.next({id:Ke,options:Xe})},this.getResponses=Ke=>this.responses.asObservable().pipe((0,y.p)(Xe=>Xe.id===Ke)),this.queue.subscribe(Ke=>{const{id:Xe,options:Je}=Ke;Se.setInProgress(Xe),this.responses.next({id:Xe,observable:We(Je)})})}}var fe=e(16233);const Te="cancel_all_requests_request_id",je="grafana-trace-id";class He{constructor(Se){this.inFlightRequests=new n.B,this.HTTP_REQUEST_CANCELED=-1,this.inspectorStream=new n.B,this._tokenRotationInProgress=null,this.deviceID=null,this.dependencies={fromFetch:c.$,appEvents:M.A,contextSrv:fe.TP,logout:()=>{fe.TP.setLoggedOut()}},Se&&(this.dependencies={...this.dependencies,...Se}),this.noBackendCache=!1,this.internalFetch=this.internalFetch.bind(this),this.fetchQueue=new me,this.responseQueue=new De(this.fetchQueue,this.internalFetch),this.initGrafanaDeviceID(),new de(this.fetchQueue,this.responseQueue,(0,S.zj)())}async initGrafanaDeviceID(){try{const We=await(await t.Ay.load()).get();this.deviceID=We.visitorId}catch(Se){console.error(Se)}}async request(Se){return await(0,i.s)(this.fetch(Se).pipe((0,o.T)(We=>We.data)))}fetch(Se){const We=(0,D.A)(),Ke=this.fetchQueue;return new s.c(Xe=>{const Je=new r.yU;return Je.add(this.responseQueue.getResponses(We).subscribe(st=>{Je.add(st.observable.subscribe(Xe))})),this.fetchQueue.add(We,Se),function(){Ke.setDone(We),Je.unsubscribe()}})}internalFetch(Se){Se.requestId&&this.inFlightRequests.next(Se.requestId),Se=this.parseRequestOptions(Se);const We=(0,T.r)();return We!==null&&We!==""&&C.$.jwtUrlLogin&&C.$.jwtHeaderName&&(Se.headers=Se.headers??{},Se.headers[C.$.jwtHeaderName]=`${We}`),this.deviceID&&(Se.headers=Se.headers??{},Se.headers["X-Grafana-Device-Id"]=`${this.deviceID}`),this.getFromFetchStream(Se).pipe(this.handleStreamResponse(Se),this.handleStreamError(Se),this.handleStreamCancellation(Se))}resolveCancelerIfExists(Se){this.inFlightRequests.next(Se)}cancelAllInFlightRequests(){this.inFlightRequests.next(Te)}async datasourceRequest(Se){return(0,i.s)(this.fetch(Se))}parseRequestOptions(Se){const We=this.dependencies.contextSrv.user?.orgId;return Se.retry=Se.retry??0,(0,re.Lr)(Se.url)&&(We&&(Se.headers=Se.headers??{},Se.headers["X-Grafana-Org-Id"]=We),Se.url.startsWith("/")&&(Se.url=Se.url.substring(1)),Se.headers?.Authorization&&(Se.headers["X-DS-Authorization"]=Se.headers.Authorization,delete Se.headers.Authorization),this.noBackendCache&&(Se.headers=Se.headers??{},Se.headers["X-Grafana-NoCache"]="true")),Se.hideFromInspector===void 0&&(Se.hideFromInspector=(0,re.Lr)(Se.url)&&!(0,re.dr)(Se.url)),Se}getFromFetchStream(Se){const We=ie(Se),Ke=X(Se);return this.dependencies.fromFetch(We,Ke).pipe((0,h.Z)(async Xe=>{const{status:Je,statusText:st,ok:pt,headers:xt,url:ot,type:$e,redirected:ve}=Xe,be=Se.responseType??(oe(xt)?"json":void 0),he=await te(Xe,be);return{status:Je,statusText:st,ok:pt,data:he,headers:xt,url:ot,type:$e,redirected:ve,config:Se,traceId:Xe.headers.get(je)??void 0}}))}showApplicationErrorAlert(Se){}showSuccessAlert(Se){const{config:We}=Se;if(We.showSuccessAlert===!1||We.showSuccessAlert===void 0&&(We.method==="GET"||(0,re.dr)(We.url)||!(0,re.Lr)(We.url)))return;const Ke=Se.data;Ke?.message&&this.dependencies.appEvents.emit(P.r1.alertSuccess,[Ke.message])}showErrorAlert(Se,We){if(Se.showErrorAlert===!1||Se.showErrorAlert===void 0&&((0,re.dr)(Se.url)||!(0,re.Lr)(Se.url)))return;let Ke="",Xe=We.data.message;Xe==="Unexpected error"&&We.message&&(Xe=We.message),Xe.length>80&&(Ke=Xe,Xe="Error"),We.status===422&&(Ke=We.data.message,Xe="Validation failed"),this.dependencies.appEvents.emit(We.status<500?P.r1.alertWarning:P.r1.alertError,[Xe,Ke,We.data.traceID])}processRequestError(Se,We){return We.data=We.data??{message:"Unexpected error"},typeof We.data=="string"&&(We.data={message:We.data,error:We.statusText,response:We.data}),We.data&&!We.data.message&&typeof We.data.error=="string"&&(We.data.message=We.data.error),We.data.message&&setTimeout(()=>{We.isHandled||this.showErrorAlert(Se,We)},50),this.inspectorStream.next({response:We,requestId:Se.requestId}),We}handleStreamResponse(Se){return We=>We.pipe((0,o.T)(Ke=>{if(!Ke.ok){const{status:Xe,statusText:Je,data:st}=Ke;throw{status:Xe,statusText:Je,data:st,config:Se,traceId:Ke.headers.get(je)??void 0}}return Ke}),(0,g.M)(Ke=>{this.showSuccessAlert(Ke),this.inspectorStream.next({response:Ke,requestId:Se.requestId})}))}handleStreamError(Se){const{isSignedIn:We}=this.dependencies.contextSrv.user;return Ke=>Ke.pipe((0,l.l)(Xe=>Xe.pipe((0,h.Z)((Je,st)=>{const pt=st===0&&Se.retry===0;if(Je.status===401&&(0,re.Lr)(Se.url)&&pt&&We){if(Je.data?.error?.id==="ERR_TOKEN_REVOKED")return this.dependencies.appEvents.publish(new K.S8({component:B,props:{maxConcurrentSessions:Je.data?.error?.maxConcurrentSessions}})),(0,f.$)(()=>Je);let xt=this.loginPing();return(0,I.m)()&&(0,I.W)()*1e3<Date.now()&&(xt=this.rotateToken()),(0,a.H)(xt).pipe((0,p.W)(ot=>(ot.status===401&&this.dependencies.logout(),(0,f.$)(ot))))}return(0,f.$)(Je)}))),(0,p.W)(Xe=>(0,f.$)(()=>this.processRequestError(Se,Xe))))}handleStreamCancellation(Se){return We=>We.pipe((0,m.Q)(this.inFlightRequests.pipe((0,y.p)(Ke=>{let Xe=!1;return Se&&Se.requestId&&Se.requestId===Ke&&(Xe=!0),Ke===Te&&(Xe=!0),Xe}))),(0,d.v)(()=>({type:x.v2.Cancelled,cancelled:!0,data:null,status:this.HTTP_REQUEST_CANCELED,statusText:"Request was aborted",config:Se})))}getInspectorStream(){return this.inspectorStream}async get(Se,We,Ke,Xe){return this.request({...Xe,method:"GET",url:Se,params:We,requestId:Ke})}async delete(Se,We,Ke){return this.request({...Ke,method:"DELETE",url:Se,data:We})}async post(Se,We,Ke){return this.request({...Ke,method:"POST",url:Se,data:We})}async patch(Se,We,Ke){return this.request({...Ke,method:"PATCH",url:Se,data:We})}async put(Se,We,Ke){return this.request({...Ke,method:"PUT",url:Se,data:We})}withNoBackendCache(Se){return this.noBackendCache=!0,Se().finally(()=>{this.noBackendCache=!1})}rotateToken(){return this._tokenRotationInProgress?this._tokenRotationInProgress:(this._tokenRotationInProgress=this.fetch({url:"/api/user/auth-tokens/rotate",method:"POST",retry:1}).pipe((0,v.j)(()=>{this._tokenRotationInProgress=null}),(0,u.u)()),this._tokenRotationInProgress)}loginPing(){return this.fetch({url:"/api/login/ping",method:"GET",retry:1})}search(Se){return this.get("/api/search",Se)}getDashboardByUid(Se){return(0,E.l)("backend_srv","getDashboardByUid(uid)","getDashboardAPI().getDashboardDTO(uid)"),(0,b.n)().getDashboardDTO(Se)}validateDashboard(Se){return Promise.resolve({isValid:!1,message:"dashboard validation is not supported"})}getPublicDashboardByUid(Se){return this.get(`/api/public/dashboards/${Se}`)}getFolderByUid(Se,We={}){const Ke=new URLSearchParams;return We.withAccessControl&&Ke.set("accesscontrol","true"),this.get(`/api/folders/${Se}?${Ke.toString()}`,void 0,void 0,{showErrorAlert:!1})}}const Be=new He,Ne=()=>Be},16233:(G,O,e)=>{"use strict";e.d(O,{SM:()=>h,TP:()=>p});var t=e(2543),n=e.n(t),i=e(29263),s=e(65879),r=e(17172),f=e(33378),a=e(92315),c=e(31678),o=e(2913);const h="auto";class g{constructor(){this.id=0,this.uid="",this.isGrafanaAdmin=!1,this.isSignedIn=!1,this.orgRole="",this.orgId=0,this.orgName="",this.login="",this.externalUserId="",this.orgCount=0,this.timezone="",this.fiscalYearStartMonth=0,this.helpFlags1=0,this.theme="dark",this.hasEditPermissionInFolders=!1,this.email="",this.name="",this.locale="",this.language="",this.weekStart="",this.gravatarUrl="",this.analytics={identifier:""},this.authenticatedBy="",o.Ay.bootData.user&&(0,t.extend)(this,o.Ay.bootData.user)}}class l{constructor(){this.sidemenuSmallBreakpoint=!1,this.tokenRotationJobId=0,o.Ay.bootData||(o.Ay.bootData={user:{},settings:{},navTree:[]}),this.user=new g,this.isSignedIn=this.user.isSignedIn,this.isGrafanaAdmin=this.user.isGrafanaAdmin,this.isEditor=this.hasRole("Editor")||this.hasRole("Admin"),this.hasEditPermissionInFolders=this.user.hasEditPermissionInFolders,this.minRefreshInterval=o.Ay.minRefreshInterval,this.scheduleTokenRotationJob()}async fetchUserPermissions(){try{this.user.permissions=await(0,r.AI)().get("/api/access-control/user/actions",{reloadcache:!0})}catch(d){console.error(d)}}setLoggedOut(){this.cancelTokenRotationJob(),this.user.isSignedIn=!1,this.isSignedIn=!1,window.location.reload()}hasRole(d){return d==="ServerAdmin"?this.isGrafanaAdmin:this.user.orgRole===d}licensedAccessControlEnabled(){return(0,f.a)("accesscontrol")}hasPermissionInMetadata(d,v){return(0,i.T6)(d,v)}hasPermission(d){return(0,i.ZU)(d,this.user)}isGrafanaVisible(){return document.visibilityState===void 0||document.visibilityState==="visible"}isAllowedInterval(d){return!o.Ay.minRefreshInterval||d===h?!0:s.intervalToMs(d)>=s.intervalToMs(o.Ay.minRefreshInterval)}getValidInterval(d){return this.isAllowedInterval(d)?d:o.Ay.minRefreshInterval}getValidIntervals(d){return this.minRefreshInterval?d.filter(v=>v!=="").filter(this.isAllowedInterval):d}hasAccessToExplore(){return this.hasPermission(c.AccessControlAction.DataSourcesExplore)&&o.Ay.exploreEnabled}evaluatePermission(d){return(0,i.jW)(d,this.user)?[]:["Reject"]}scheduleTokenRotationJob(){if(this.canScheduleRotation()){let d=(0,a.W)(),u=(d-Math.floor(Math.random()*19+1))*1e3-Date.now();this.tokenRotationJobId=setTimeout(()=>{if((0,a.W)()>d){this.scheduleTokenRotationJob();return}this.rotateToken().then()},u)}}canScheduleRotation(){return!(!this.isSignedIn||(0,a.W)()===0)}cancelTokenRotationJob(){this.tokenRotationJobId>0&&clearTimeout(this.tokenRotationJobId)}rotateToken(){return fetch(o.Ay.appSubUrl+"/api/user/auth-tokens/rotate",{method:"POST"}).then(d=>{if(d.status===200){this.scheduleTokenRotationJob();return}if(d.status===401){this.setLoggedOut();return}}).catch(d=>{console.error(d)})}}let p=new l;const m=y=>{throw new Error("contextSrv can be only overridden in test environment")}},42614:(G,O,e)=>{"use strict";e.d(O,{n:()=>n});var t=e(63415);const n=(s,r)=>{(0,t.x$)().addEvent({type:t.on.Performance,payload:{name:s,value:r}})},i=s=>faro?.api?.pushError(s)},62301:(G,O,e)=>{"use strict";e.d(O,{A:()=>c});var t=e(2543),n=e.n(t),i=e(17172),s=e(2913),r=e(33390);class f{constructor(){}addDashboardImpression(h){const g=this.impressionKey();let l=[];r.A.exists(g)&&(l=JSON.parse(r.A.get(g)),(0,t.isArray)(l)||(l=[])),l=l.filter(p=>h!==p),l.unshift(h),l.length>50&&l.pop(),r.A.set(g,JSON.stringify(l))}async convertToUIDs(){let h=this.getImpressions();const g=(0,t.filter)(h,p=>(0,t.isNumber)(p));if(!g.length)return;const l=await(0,i.AI)().get(`/api/dashboards/ids/${g.join(",")}`);r.A.set(this.impressionKey(),JSON.stringify([...(0,t.filter)(h,p=>(0,t.isString)(p)),...l]))}getImpressions(){const h=r.A.get(this.impressionKey())||"[]";return JSON.parse(h)}async getDashboardOpened(){try{await this.convertToUIDs()}catch{}return(0,t.filter)(this.getImpressions(),g=>(0,t.isString)(g))}impressionKey(){return"dashboard_impressions-"+s.Ay.bootData.user.orgId}}const c=new f},4898:(G,O,e)=>{"use strict";e.d(O,{R:()=>u});let t={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},n={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},i={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},s={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},r=null;for(let D=1;D<20;++D)t[111+D]="f"+D;for(let D=0;D<=9;++D)t[D+96]=D.toString();function f(D){if(D.type==="keypress"){let P=String.fromCharCode(D.which);return D.shiftKey||(P=P.toLowerCase()),P}return t[D.which]?t[D.which]:n[D.which]?n[D.which]:String.fromCharCode(D.which).toLowerCase()}function a(D,P){return D.sort().join(",")===P.sort().join(",")}function c(D){let P=[];return D.shiftKey&&P.push("shift"),D.altKey&&P.push("alt"),D.ctrlKey&&P.push("ctrl"),D.metaKey&&P.push("meta"),P}function o(D){if(D.preventDefault){D.preventDefault();return}D.returnValue=!1}function h(D){if(D.stopPropagation){D.stopPropagation();return}D.cancelBubble=!0}function g(D){return D==="shift"||D==="ctrl"||D==="alt"||D==="meta"}function l(){if(!r){r={};for(let D in t){const P=parseInt(D,10);P>95&&P<112||t.hasOwnProperty(D)&&(r[t[D]]=D)}}return r}function p(D,P,x){return x||(x=l()[D]?"keydown":"keypress"),x==="keypress"&&P.length&&(x="keydown"),x}function m(D){return D==="+"?["+"]:(D=D.replace(/\+{2}/g,"+plus"),D.split("+"))}function y(D,P){let x,E,C,M=[];for(x=m(D),C=0;C<x.length;++C)E=x[C],s[E]&&(E=s[E]),P&&P!=="keypress"&&i[E]&&(E=i[E],M.push("shift")),g(E)&&M.push(E);if(!E)throw new Error("Unable to get key");return P=p(E,M,P),{key:E,modifiers:M,action:P}}function d(D,P){return D===null||D===document?!1:D===P?!0:d(D.parentNode,P)}class v{constructor(P){this._callbacks={},this._directMap={},this._sequenceLevels={},this._resetTimer=void 0,this._ignoreNextKeyup=!1,this._ignoreNextKeypress=!1,this._nextExpectedAction=!1,this._globalCallbacks={},this._resetSequences=x=>{x=x||{};let E=!1,C;for(C in this._sequenceLevels){if(x[C]){E=!0;continue}this._sequenceLevels[C]=0}E||(this._nextExpectedAction=!1)},this._getMatches=(x,E,C,M,S,I)=>{let T,b,R=[],A=C.type;if(!this._callbacks[x])return[];for(A==="keyup"&&g(x)&&(E=[x]),T=0;T<this._callbacks[x].length;++T)if(b=this._callbacks[x][T],!(!M&&b.seq&&this._sequenceLevels[b.seq]!==b.level)&&A===b.action&&(A==="keypress"&&!C.metaKey&&!C.ctrlKey||a(E,b.modifiers))){let L=!M&&b.combo===S,U=M&&b.seq===M&&b.level===I;(L||U)&&this._callbacks[x].splice(T,1),R.push(b)}return R},this._fireCallback=(x,E,C,M)=>{const S=E.target||E.srcElement;S&&S instanceof HTMLElement&&this.stopCallback(E,S,C,M)||x(E,C)===!1&&(o(E),h(E))},this._handleKey=(x,E,C)=>{let M=this._getMatches(x,E,C),S,I={},T=0,b=!1;for(S=0;S<M.length;++S)M[S].seq&&(T=Math.max(T,M[S].level??0));for(S=0;S<M.length;++S){const A=M[S].seq;if(A){if(M[S].level!==T)continue;b=!0,I[A]=1,this._fireCallback(M[S].callback,C,M[S].combo,A);const L=A.lastIndexOf(x),U=A.slice(0,L);for(const[W,w]of Object.entries(this._sequenceLevels))w>0&&W.startsWith(U)&&(I[W]=1);continue}b||this._fireCallback(M[S].callback,C,M[S].combo)}for(const A of this._callbacks[x]??[])A.action===C.type&&A.seq&&A.level===0&&(I[A.seq]=1);let R=C.type==="keypress"&&this._ignoreNextKeypress;C.type===this._nextExpectedAction&&!g(x)&&!R&&this._resetSequences(I),this._ignoreNextKeypress=b&&C.type==="keydown"},this._handleKeyEvent=x=>{if(!(x instanceof KeyboardEvent))throw new Error("Didn't get a KeyboardEvent");const E=x;if(E.repeat)return;typeof E.which!="number"&&(E.which=E.keyCode);let C=f(E);if(C){if(E.type==="keyup"&&this._ignoreNextKeyup===C){this._ignoreNextKeyup=!1;return}this.handleKey(C,c(E),E)}},this._resetSequenceTimer=()=>{clearTimeout(this._resetTimer),this._resetTimer=setTimeout(this._resetSequences,1e3)},this._bindSequence=(x,E,C,M)=>{this._sequenceLevels[x]=0;const S=T=>()=>{this._nextExpectedAction=T,++this._sequenceLevels[x],this._resetSequenceTimer()},I=T=>{this._fireCallback(C,T,x),M!=="keyup"&&(this._ignoreNextKeyup=f(T)),this._resetSequenceTimer()};for(let T=0;T<E.length;++T){let R=T+1===E.length?I:S(M||y(E[T+1]).action);this._bindSingle(E[T],R,M,x,T)}},this._bindSingle=(x,E,C,M,S)=>{this._directMap[x+":"+C]=E,x=x.replace(/\s+/g," ");let I=x.split(" "),T;if(I.length>1){this._bindSequence(x,I,E,C);return}T=y(x,C),this._callbacks[T.key]=this._callbacks[T.key]||[];const b={type:T.action,metaKey:!1,ctrlKey:!1};this._getMatches(T.key,T.modifiers,b,M,x,S);const R={callback:E,modifiers:T.modifiers,action:T.action,seq:M,level:S,combo:x};this._callbacks[T.key][M?"unshift":"push"](R)},this._bindMultiple=(x,E,C)=>{for(let M=0;M<x.length;++M)this._bindSingle(x[M],E,C)},this.bind=(x,E,C)=>(x=x instanceof Array?x:[x],this._bindMultiple(x,E,C),self),this.unbind=(x,E)=>this.bind(x,function(){},E),this.bindGlobal=(x,E,C)=>{if(this.bind(x,E,C),x instanceof Array){for(let M=0;M<x.length;M++)this._globalCallbacks[x[M]]=!0;return}this._globalCallbacks[x]=!0},this.unbindGlobal=(x,E)=>{if(this.unbind(x,E),x instanceof Array){for(let C=0;C<x.length;C++)this._globalCallbacks[x[C]]=!1;return}this._globalCallbacks[x]=!1},this.trigger=(x,E)=>{let C=this;return C._directMap[x+":"+E]&&C._directMap[x+":"+E]({},x),C},this.reset=()=>(this._callbacks={},this._directMap={},this),this.stopCallback=(x,E,C,M)=>{if(this._globalCallbacks[C]||M&&this._globalCallbacks[M]||(" "+E.className+" ").indexOf(" mousetrap ")>-1||d(E,this.target))return!1;if("composedPath"in x&&typeof x.composedPath=="function"){let S=x.composedPath()[0];S!==x.target&&S instanceof HTMLElement&&(E=S)}return!!(E.tagName==="INPUT"||E.tagName==="SELECT"||E.tagName==="TEXTAREA"||"isContentEditable"in E&&E.isContentEditable)},this.handleKey=(...x)=>this._handleKey(...x),this.addKeycodes=x=>{for(let E in x)x.hasOwnProperty(E)&&(t[E]=x[E]);r=null},this.target=P,this.target.addEventListener("keypress",x=>{x instanceof KeyboardEvent&&this._handleKeyEvent(x)}),this.target.addEventListener("keydown",x=>{x instanceof KeyboardEvent&&this._handleKeyEvent(x)}),this.target.addEventListener("keyup",x=>{x instanceof KeyboardEvent&&this._handleKeyEvent(x)})}}const u=new v(document)},2769:(G,O,e)=>{"use strict";e.d(O,{K:()=>a,O:()=>c});var t=e(97594),n=e(3591),i=e(28138),s=e(2913),r=e(10096),f=e(65615);async function a(o,h){const g=s.config.theme2,l=(0,t.g)(o);if(i.A.publish(new n.E8(l)),g.colors.mode!==l.colors.mode){const y=document.createElement("link");y.rel="stylesheet",y.href=s.config.bootData.assets[l.colors.mode],y.onload=()=>{const d=document.getElementsByTagName("link");for(let v=0;v<d.length;v++){const u=d[v];u.href&&u.href.includes(`build/grafana.${g.colors.mode}`)&&u.remove()}},document.head.insertBefore(y,document.head.firstChild)}if(h||!r.TP.isSignedIn)return;const p=new f.W("user"),m=await p.load();await p.update({...m,theme:l.colors.mode})}async function c(o){const h=s.config.theme2;a(h.isDark?"light":"dark",o)}},33390:(G,O,e)=>{"use strict";e.d(O,{A:()=>i});class t{get(r){return window.localStorage[r]}set(r,f){window.localStorage[r]=f}getBool(r,f){return f!==void 0&&!this.exists(r)?f:window.localStorage[r]==="true"}getObject(r,f){let a=f;if(this.exists(r)){const c=window.localStorage[r];try{a=JSON.parse(c)}catch(o){console.error(`Error parsing store object: ${r}. Returning default: ${f}. [${o}]`)}}return a}setObject(r,f){let a;try{a=JSON.stringify(f)}catch(c){throw new Error(`Could not stringify object: ${r}. [${c}]`)}try{this.set(r,a)}catch(c){const o=new Error(`Could not save item in localStorage: ${r}. [${c}]`);throw c instanceof Error&&(o.name=c.name),o}return!0}exists(r){return window.localStorage[r]!==void 0}delete(r){window.localStorage.removeItem(r)}}const i=new t},31140:(G,O,e)=>{"use strict";e.d(O,{A:()=>o,r:()=>c});var t=e(2543),n=e.n(t),i=e(54479),s=e(83195);function r(h,g){if(!h)return!1;if(h[0]==="/"){const l=(0,i.dO)(h);return g.match(l)!=null}return h===g}function f(h){return h===0?.001:h/10}function a(h){return h?{colors:[{opacity:0},{opacity:h/10}]}:null}function c(h,g,l){for(let p=0;p<h.length;p++){const m=h[p],y=g.yaxes,d=m.yaxis||1,v=y[d-1],u=(0,s.j_)(v.format);(0,t.isNumber)(g.decimals)?m.updateLegendValues(u,g.decimals):(0,t.isNumber)(v.decimals)?m.updateLegendValues(u,v.decimals+1):m.updateLegendValues(u,null)}}class o{constructor(g){this.datapoints=g.datapoints,this.label=g.alias,this.id=g.alias,this.alias=g.alias,this.aliasEscaped=(0,t.escape)(g.alias),this.color=g.color,this.bars={fillColor:g.color},this.valueFormater=(0,s.j_)("none"),this.stats={},this.legend=!0,this.unit=g.unit,this.dataFrameIndex=g.dataFrameIndex,this.fieldIndex=g.fieldIndex,this.hasMsResolution=this.isMsResolutionNeeded()}applySeriesOverrides(g){this.lines={},this.dashes={dashLength:[]},this.points={},this.yaxis=1,this.zindex=0,this.nullPointMode=null,delete this.stack,delete this.bars.show;for(let l=0;l<g.length;l++){const p=g[l];r(p.alias,this.alias)&&(p.lines!==void 0&&(this.lines.show=p.lines),p.dashes!==void 0&&(this.dashes.show=p.dashes,this.lines.lineWidth=0),p.points!==void 0&&(this.points.show=p.points),p.bars!==void 0&&(this.bars.show=p.bars),p.fill!==void 0&&(this.lines.fill=f(p.fill)),p.fillGradient!==void 0&&(this.lines.fillColor=a(p.fillGradient)),p.stack!==void 0&&(this.stack=p.stack),p.linewidth!==void 0&&(this.lines.lineWidth=this.dashes.show?0:p.linewidth,this.dashes.lineWidth=p.linewidth),p.dashLength!==void 0&&(this.dashes.dashLength[0]=p.dashLength),p.spaceLength!==void 0&&(this.dashes.dashLength[1]=p.spaceLength),p.nullPointMode!==void 0&&(this.nullPointMode=p.nullPointMode),p.pointradius!==void 0&&(this.points.radius=p.pointradius),p.steppedLine!==void 0&&(this.lines.steps=p.steppedLine),p.zindex!==void 0&&(this.zindex=p.zindex),p.fillBelowTo!==void 0&&(this.fillBelowTo=p.fillBelowTo),p.color!==void 0&&this.setColor(p.color),p.transform!==void 0&&(this.transform=p.transform),p.legend!==void 0&&(this.legend=p.legend),p.hideTooltip!==void 0&&(this.hideTooltip=p.hideTooltip),p.yaxis!==void 0&&(this.yaxis=p.yaxis),p.hiddenSeries!==void 0&&(this.hiddenSeries=p.hiddenSeries))}}getFlotPairs(g){const l=[];this.stats.total=0,this.stats.max=-Number.MAX_VALUE,this.stats.min=Number.MAX_VALUE,this.stats.logmin=Number.MAX_VALUE,this.stats.avg=null,this.stats.current=null,this.stats.first=null,this.stats.delta=0,this.stats.diff=null,this.stats.diffperc=0,this.stats.range=null,this.stats.timeStep=Number.MAX_VALUE,this.allIsNull=!0,this.allIsZero=!0;const p=g==="connected",m=g==="null as zero";let y,d,v=0,u,D=0,P=!0;for(let x=0;x<this.datapoints.length;x++){if(d=this.datapoints[x][0],y=this.datapoints[x][1],u!==void 0){const E=y-u;E<this.stats.timeStep&&(this.stats.timeStep=E)}if(u=y,d===null){if(p)continue;m&&(d=0)}d!==null&&((0,t.isNumber)(d)&&(this.stats.total+=d,this.allIsNull=!1,v++),d>this.stats.max&&(this.stats.max=d),d<this.stats.min&&(this.stats.min=d),this.stats.first===null?this.stats.first=d:D>d?(P=!1,x===this.datapoints.length-1&&(this.stats.delta+=d)):(P?this.stats.delta+=d-D:this.stats.delta+=d,P=!0),D=d,d<this.stats.logmin&&d>0&&(this.stats.logmin=d),d!==0&&(this.allIsZero=!1)),l.push([y,d])}return this.stats.max===-Number.MAX_VALUE&&(this.stats.max=null),this.stats.min===Number.MAX_VALUE&&(this.stats.min=null),l.length&&!this.allIsNull&&(this.stats.avg=this.stats.total/v,this.stats.current=l[l.length-1][1],this.stats.current===null&&l.length>1&&(this.stats.current=l[l.length-2][1])),this.stats.max!==null&&this.stats.min!==null&&(this.stats.range=this.stats.max-this.stats.min),this.stats.current!==null&&this.stats.first!==null&&(this.stats.diff=this.stats.current-this.stats.first,this.stats.diffperc=this.stats.diff/this.stats.first),this.stats.count=l.length,l}updateLegendValues(g,l){this.valueFormater=g,this.decimals=l}formatValue(g){return(0,t.isFinite)(g)||(g=null),(0,s.cN)(this.valueFormater(g,this.decimals))}isMsResolutionNeeded(){for(let g=0;g<this.datapoints.length;g++)if(this.datapoints[g][1]!==null&&this.datapoints[g][1]!==void 0){const l=this.datapoints[g][1].toString();if(l.length===13&&l%1e3!==0)return!0}return!1}hideFromLegend(g){return!!(g.hideEmpty&&this.allIsNull||!this.legend||g.hideZero&&this.allIsZero)}setColor(g){this.color=g,this.bars.fillColor=g}}},6262:(G,O,e)=>{"use strict";e.d(O,{G:()=>s});var t=e(80997),n=e(32264);const i=n.$.bootData.settings.cspReportOnlyEnabled,s={createHTML:(r,f,a)=>i?(console.error("[HTML not sanitized with Trusted Types]",r,f,a),r):r.replace(/<script/gi,"&lt;script"),createScript:r=>r,createScriptURL:(r,f,a)=>i?(console.error("[ScriptURL not sanitized with Trusted Types]",r,f,a),r):t.sQ.sanitizeUrl(r)};n.$.bootData.settings.trustedTypesDefaultPolicyEnabled&&window.trustedTypes&&window.trustedTypes.createPolicy&&window.trustedTypes.createPolicy("default",s)},96378:(G,O,e)=>{"use strict";e.d(O,{N:()=>o,e:()=>h});var t=e(74848),n=e(96540),i=e(70255),s=e(60578),r=e(3591),f=e(32264),a=e(10096),c=e(34295);const o=({children:g,value:l})=>{const[p,m]=(0,n.useState)(l);return(0,n.useEffect)(()=>{const y=a.lE.subscribe(r.E8,d=>{f.$.theme2=d.payload,m(d.payload)});return()=>y.unsubscribe()},[]),(0,t.jsx)(s.D.Provider,{value:p,children:(0,t.jsx)(i.z,{baseColor:p.colors.emphasize(p.colors.background.secondary),highlightColor:p.colors.emphasize(p.colors.background.secondary,.1),borderRadius:p.shape.radius.default,children:g})})},h=(g,l)=>function(m){return(0,t.jsx)(o,{value:l,children:n.createElement(g,{...m})})}},67278:(G,O,e)=>{"use strict";e.d(O,{c:()=>t});class t extends window.Worker{constructor(i,s){const r=i.toString(),f=r.split("/");f.pop();const a=`${f.join("/")}/`,c=`importScripts('${r}');`,o=URL.createObjectURL(new Blob([`__webpack_worker_public_path__ = '${a}'; ${c}`],{type:"application/javascript"}));super(o,s),URL.revokeObjectURL(o)}}},80714:(G,O,e)=>{"use strict";e.d(O,{F:()=>t});function t(n={}){return{...n,accesscontrol:!0}}},94041:(G,O,e)=>{"use strict";e.d(O,{b:()=>t});const t=(n,i,s)=>(n.splice(s,0,n.splice(i,1)[0]),n)},92315:(G,O,e)=>{"use strict";e.d(O,{W:()=>t,m:()=>n});function t(){const i=document.cookie.split("; ").find(r=>r.startsWith("grafana_session_expiry="));if(!i)return 0;let s=i.split("=").at(1);return s?parseInt(s,10):0}function n(){return document.cookie.split("; ").findIndex(i=>i.startsWith("grafana_session_expiry="))>-1}},63917:(G,O,e)=>{"use strict";e.d(O,{gn:()=>i});function t(){const s=navigator.userAgent.indexOf("MSIE")>-1,r=navigator.userAgent.indexOf("Edge/")>-1||navigator.userAgent.indexOf("Edg/")>-1,f=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,a=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),c=/Edge\/([0-9.]+)/.exec(navigator.userAgent);return s&&parseFloat(/Trident\/([0-9.]+)/.exec(navigator.userAgent)[1])<=7||r&&(c&&parseFloat(c[1])<=16||parseFloat(/Edg\/([0-9.]+)/.exec(navigator.userAgent)[1])<=16)||f&&parseFloat(/Firefox\/([0-9.]+)/.exec(navigator.userAgent)[1])<=64?!1:!(a&&parseFloat(/Chrome\/([0-9.]+)/.exec(navigator.userAgent)[1])<=54)}function n(){return/(iPhone|iPad|Mac)/.test(navigator.platform)}function i(){return n()?"\u2318":"ctrl"}},34525:(G,O,e)=>{"use strict";e.d(O,{TS:()=>i});class t{_linkTo(a,c){c<=0&&a.inputEdges.push(this),c>=0&&a.outputEdges.push(this),a.edges.push(this)}link(a,c){if(!a)throw Error("inputNode is required");if(!c)throw Error("outputNode is required");return this.unlink(),this.inputNode=a,this.outputNode=c,this._linkTo(a,1),this._linkTo(c,-1),this}unlink(){let a;const c=this.inputNode,o=this.outputNode;c&&o&&(a=c.edges.indexOf(this),a>-1&&c.edges.splice(a,1),a=o.edges.indexOf(this),a>-1&&o.edges.splice(a,1),a=c.outputEdges.indexOf(this),a>-1&&c.outputEdges.splice(a,1),a=o.inputEdges.indexOf(this),a>-1&&o.inputEdges.splice(a,1))}}class n{constructor(a){this.name=a,this.edges=[],this.inputEdges=[],this.outputEdges=[]}getEdgeFrom(a){return a?typeof a=="object"?this.inputEdges.find(c=>c.inputNode?.name===a.name):this.inputEdges.find(c=>c.inputNode?.name===a):null}getEdgeTo(a){return a?typeof a=="object"?this.outputEdges.find(c=>c.outputNode?.name===a.name):this.outputEdges.find(c=>c.outputNode?.name===a):null}getOptimizedInputEdges(){const a=[];return this.inputEdges.forEach(c=>{c.inputNode?.inputEdges.map(h=>h.inputNode)?.forEach(h=>{const g=h?.getEdgeTo(this.name);g&&a.push(g)})}),this.inputEdges.filter(c=>a.indexOf(c)===-1)}}class i{constructor(){this.nodes={}}createNode(a){const c=new n(a);return this.nodes[a]=c,c}createNodes(a){const c=[];return a.forEach(o=>{c.push(this.createNode(o))}),c}link(a,c){let o=[],h=[];const g=[],l=[];a instanceof Array?o=a:o=[a],c instanceof Array?h=c:h=[c];for(let m=0;m<o.length;m++){const y=o[m];if(typeof y=="string"){const d=this.getNode(y);if(!d)throw Error(`cannot link input node named ${y} since it doesn't exist in graph`);g.push(d)}else g.push(y)}for(let m=0;m<h.length;m++){const y=h[m];if(typeof y=="string"){const d=this.getNode(y);if(!d)throw Error(`cannot link output node named ${y} since it doesn't exist in graph`);l.push(d)}else l.push(y)}const p=[];return g.forEach(m=>{l.forEach(y=>{p.push(this.createEdge().link(m,y))})}),p}descendants(a){if(!a.length)return new Set;const c=new Set(r(a)?a.map(o=>this.nodes[o]).filter(o=>o!==void 0):a);return this.descendantsRecursive(c)}descendantsRecursive(a,c=new Set){for(const o of a){const h=new Set;for(const{inputNode:g}of o.inputEdges)g&&!c.has(g)&&(c.add(g),h.add(g));this.descendantsRecursive(h,c)}return c}createEdge(){return new t}getNode(a){return this.nodes[a]}}const s=f=>{Object.keys(f.nodes).forEach(a=>{const c=f.nodes[a];let o=c.outputEdges.map(g=>g.outputNode?.name).join(", ");o||(o="<none>");let h=c.inputEdges.map(g=>g.inputNode?.name).join(", ");h||(h="<none>"),console.log(`${c.name}:
 - links to:   ${o}
 - links from: ${h}`)})};function r(f){return f.length>0&&typeof f[0]=="string"}},94954:(G,O,e)=>{"use strict";e.d(O,{q:()=>n});var t=e(17172);function n(i){if(typeof i=="string")return i;if(i){if(i instanceof Error)return i.message;if((0,t.NF)(i)){if(i.data&&i.data.message)return i.data.message;if(i.statusText)return i.statusText}}return JSON.stringify(i)}},87490:(G,O,e)=>{"use strict";e.d(O,{HQ:()=>u,Ll:()=>T,MA:()=>S,WP:()=>m,Xe:()=>x,_u:()=>N,bI:()=>C,dY:()=>U,di:()=>R,dr:()=>D,eF:()=>b,o$:()=>P,uE:()=>w,uJ:()=>V,uq:()=>E,w4:()=>M,zT:()=>L,zq:()=>W});var t=e(44329),n=e(62938),i=e(52622),s=e(76885),r=e(41987),f=e(43127),a=e(77789),c=e(65879),o=e(19347),h=e(11134),g=e(33390),l=e(66718);const p={dedupStrategy:i.fY.none},m="0123456789abcdefghijklmnopqrstuvwxyz",y=(0,t.d_)(m,3),d="grafana.explore.datasource",v=K=>`${d}.${K}`,u=K=>g.A.getObject(v(K)),D=(K,H)=>g.A.setObject(v(K),H);function P(){for(;;){const K=y(3);if(!/^\d+$/.test(K))return K}}async function x(K){const{queries:H,dsRef:X,timeRange:k,scopedVars:Y,adhocFilters:Z}=K,se=(await Promise.allSettled(H.filter(q=>q.datasource?.uid!==l.Uj).map(async q=>{const ne=await(0,o.l)().get(q.datasource||X);return{...ne.interpolateVariablesInQueries?.([q],Y??{},Z)[0]||q,...!ne.meta.mixed&&{datasource:ne.getRef()}}}))).filter(q=>q.status==="fulfilled").map(q=>q.value),j=JSON.stringify({[P()]:{range:(0,s.sQ)(k.raw),queries:se,datasource:X?.uid}});return s.kM.renderUrl("/explore",{panes:j,schemaVersion:1})}function E(K){return`explore_${K}`}function C(K,H,X,k,Y,Z,se){const j=Number.parseInt(K,36),{interval:q,intervalMs:ne}=B(k,X.minInterval,X.maxDataPoints),oe={app:r.Jk.Explore,timezone:Z||f.lE,startTime:Date.now(),interval:q,intervalMs:ne,panelId:j,targets:H,range:k,requestId:E(K),rangeRaw:k.raw,scopedVars:{__interval:{text:q,value:q},__interval_ms:{text:ne,value:ne},...se},maxDataPoints:X.maxDataPoints,liveStreaming:X.liveStreaming,skipQueryCache:!0};return{queries:H,request:oe,scanning:Y,id:I(),done:!1}}const M=({key:K,...H})=>H,S=(K,H)=>{if(K==null)return"";try{return JSON.stringify(K,null,H)}catch(X){console.error(X)}return""};function I(K=0){return`Q-${(0,n.A)()}-${K}`}async function T(K,H=0,X){let k,Y,Z;return X?Y=X:K.length>0&&K[K.length-1].datasource?Y=K[K.length-1].datasource:(k=await(0,o.l)().get(),Z=k.getDefaultQuery?.(r.Jk.Explore),Y=k.getRef()),k||(k=await(0,o.l)().get(Y),Z=k.getDefaultQuery?.(r.Jk.Explore)),{...Z,refId:(0,a.M)(K),key:I(H),datasource:Y}}const b=(K,H,X=0)=>{const k=I(X),Y=K.refId||(0,a.M)(H);return{...K,refId:Y,key:k}};async function R(K,H){if(K&&typeof K=="object"&&K.length>0){const X=[];for(let k=0;k<K.length;k++){const Y=K[k],Z=I(k);let se=Y.refId;se||(se=(0,a.M)(X));let j=!0;if(Y.datasource)try{await(0,o.l)().get(Y.datasource.uid)}catch{console.error("One of the queries has a datasource that is no longer available and was removed."),j=!1}j&&X.push({...Y,refId:se,key:Z})}return X}try{const X=H??(await(0,o.l)().get()).getRef();return[await T(K??[],void 0,X)]}catch{return[]}}const A=["refId","key","context","datasource"];function L(K){return K&&K.some(H=>Object.entries(H).filter(([k,Y])=>A.indexOf(k)===-1).filter(([k,Y])=>Y).length>0)}const U=K=>K.reduce((X,k,Y)=>{const Z=k.datasource?.uid||k.key;return X.concat(`${Z}-${Y}`)},[]),W=(K,H,X)=>c.convertRawToRange(H,K,X),w=K=>h.cC.isLive(K)?i.uH.Ascending:i.uH.Descending,N=K=>{K&&K.unsubscribe()};function B(K,H,X){return X?c.calculateInterval(K,X,H):{interval:"1s",intervalMs:1e3}}const V=K=>{if(navigator.clipboard&&window.isSecureContext)navigator.clipboard.writeText(K);else{const H=document.createElement("textarea");H.value=K,document.body.appendChild(H),H.select(),document.execCommand("copy"),document.body.removeChild(H)}}},78827:(G,O,e)=>{"use strict";e.r(O),e.d(O,{default:()=>t});function t(n,i){i=i||{};const s=i.delimiter||".";let r=i.maxDepth||3,f=1;const a={};function c(o,h){Object.entries(o).forEach(([g,l])=>{const p=i?.safe&&Array.isArray(l),y=Object.prototype.toString.call(l)==="[object Object]",d=h?h+s+g:g;if(i?.maxDepth||(r=f+1),!p&&y&&Object.keys(l).length&&f<r)return++f,c(l,d);a[d]=l})}return c(n,null),a}},68576:(G,O,e)=>{"use strict";e.d(O,{A:()=>a});var t=e(95344),n=e(54479),i=e(65879),s=e(83195);const f={valueFormats:{},intervalRegex:/(\d+(?:\.\d+)?)(ms|[Mwdhmsy])/,intervalsInSeconds:{y:31536e3,M:2592e3,w:604800,d:86400,h:3600,m:60,s:1,ms:.001},regexEscape:c=>((0,t.l)("kbn.ts","kbn.regexEscape()","escapeRegex from @grafana/data"),(0,n.$f)(c)),roundInterval:c=>((0,t.l)("kbn.ts","kbn.roundInterval()","@grafana/data"),i.roundInterval(c)),secondsToHms:c=>((0,t.l)("kbn.ts","kbn.secondsToHms()","@grafana/data"),i.secondsToHms(c)),secondsToHhmmss:c=>{const o=[],h=Math.floor(c/3600),g=Math.floor(c%3600/60),l=Math.floor(c%3600%60);return h>9?o.push(""+h):o.push("0"+h),g>9?o.push(""+g):o.push("0"+g),l>9?o.push(""+l):o.push("0"+l),o.join(":")},toPercent:(c,o)=>Math.floor(c/o*1e4)/100+"%",addSlashes:c=>c.replace(/[\'\"\\0]/g,"\\$&"),describeInterval:c=>((0,t.l)("kbn.ts","kbn.describeInterval()","@grafana/data"),i.describeInterval(c)),intervalToSeconds:c=>((0,t.l)("kbn.ts","rangeUtil.intervalToSeconds()","@grafana/data"),i.intervalToSeconds(c)),intervalToMs:c=>((0,t.l)("kbn.ts","rangeUtil.intervalToMs()","@grafana/data"),i.intervalToMs(c)),calculateInterval:(c,o,h)=>((0,t.l)("kbn.ts","kbn.calculateInterval()","@grafana/data"),i.calculateInterval(c,o,h)),queryColorDot:(c,o)=>'<div class="icon-circle" style="'+["display:inline-block","color:"+c,"font-size:"+o+"px"].join(";")+'"></div>',slugifyForUrl:c=>c.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-"),stringToJsRegex:c=>((0,t.l)("kbn.ts","kbn.stringToJsRegex()","@grafana/data"),(0,n.dO)(c)),toFixed:(c,o)=>{if(c===null)return"";const h=o?Math.pow(10,Math.max(0,o)):1,g=String(Math.round(c*h)/h);if(g.indexOf("e")!==-1||c===0)return g;if(o!=null){const l=g.indexOf("."),p=l===-1?0:g.length-l-1;if(p<o)return(p?g:g+".")+String(h).slice(1,o-p+1)}return g},toFixedScaled:(c,o,h,g,l)=>h===null?f.toFixed(c,o)+l:f.toFixed(c,h+g)+l,roundValue:(c,o)=>{if(c===null)return null;const h=Math.pow(10,o),g=(h*c).toFixed(o);return Math.round(parseFloat(g))/h},getUnitFormats:s.Ke};typeof Proxy<"u"?f.valueFormats=new Proxy(f.valueFormats,{get(c,o,h){if(typeof o!="string")throw{message:`Value format ${String(o)} is not a string`};const g=(0,s.j_)(o);return g?(l,p,m,y)=>(0,s.cN)(g(l,p,m,y?"utc":"browser")):Reflect.get(c,o,h)}}):f.valueFormats=(0,s.uH)();const a=f},78160:(G,O,e)=>{"use strict";e.d(O,{j:()=>n,z:()=>i});var t=e(42614);function n(s){if(!(!performance||!performance.mark))try{performance.mark(`${s}_started`)}catch(r){console.error(`[Metrics] Failed to startMeasure ${s}`,r)}}function i(s){if(!(!performance||!performance.mark))try{const r=`${s}_started`,f=`${s}_completed`,a=`${s}_measured`;performance.mark(f);const c=performance.measure(a,r,f);return(0,t.n)(`${s}_ms`,c.duration),performance.clearMarks(r),performance.clearMarks(f),performance.clearMeasures(a),c}catch(r){console.error(`[Metrics] Failed to stopMeasure ${s}`,r);return}}},36689:(G,O,e)=>{"use strict";e.d(O,{C:()=>n,o:()=>i});var t=e(8484);function n(s){switch(s){case"home":return(0,t.t)("nav.home.title","Home");case"new":return(0,t.t)("nav.new.title","New");case"create":return(0,t.t)("nav.create.title","Create");case"create-dashboard":return(0,t.t)("nav.create-dashboard.title","Dashboard");case"folder":return(0,t.t)("nav.create-folder.title","Folder");case"import":return(0,t.t)("nav.create-import.title","Import dashboard");case"alert":return(0,t.t)("nav.create-alert.title","New alert rule");case"bookmarks":return(0,t.t)("nav.bookmarks.title","Bookmarks");case"bookmarks-empty":return(0,t.t)("nav.bookmarks-empty.title","Bookmark pages for them to appear here");case"starred":return(0,t.t)("nav.starred.title","Starred");case"starred-empty":return(0,t.t)("nav.starred-empty.title","Your starred dashboards will appear here");case"dashboards":return(0,t.t)("nav.dashboards.title","Dashboards");case"dashboards/browse":return(0,t.t)("nav.dashboards.title","Dashboards");case"dashboards/playlists":return(0,t.t)("nav.playlists.title","Playlists");case"dashboards/snapshots":return(0,t.t)("nav.snapshots.title","Snapshots");case"dashboards/library-panels":return(0,t.t)("nav.library-panels.title","Library panels");case"reports":return(0,t.t)("nav.reporting.title","Reporting");case"dashboards/public":return(0,t.t)("nav.public.title","Public dashboards");case"dashboards/recently-deleted":return(0,t.t)("nav.recently-deleted.title","Recently deleted");case"dashboards/new":return(0,t.t)("nav.new-dashboard.title","New dashboard");case"dashboards/folder/new":return(0,t.t)("nav.new-folder.title","New folder");case"dashboards/import":return(0,t.t)("nav.create-import.title","Import dashboard");case"scenes":return(0,t.t)("nav.scenes.title","Scenes");case"explore":return(0,t.t)("nav.explore.title","Explore");case"alerting":return(0,t.t)("nav.alerting.title","Alerting");case"plugin-page-grafana-oncall-app":return(0,t.t)("nav.oncall.title","OnCall");case"alerting-legacy":return(0,t.t)("nav.alerting-legacy.title","Alerting (legacy)");case"alerting-upgrade":return(0,t.t)("nav.alerting-upgrade.title","Alerting upgrade");case"alert-home":return(0,t.t)("nav.alerting-home.title","Home");case"alert-list":return(0,t.t)("nav.alerting-list.title","Alert rules");case"alert-list-legacy":return(0,t.t)("nav.alert-list-legacy.title","Alert rules");case"receivers":return(0,t.t)("nav.alerting-receivers.title","Contact points");case"am-routes":return(0,t.t)("nav.alerting-am-routes.title","Notification policies");case"channels":return(0,t.t)("nav.alerting-channels.title","Notification channels");case"silences":return(0,t.t)("nav.alerting-silences.title","Silences");case"groups":return(0,t.t)("nav.alerting-groups.title","Active notifications");case"alerting-admin":return(0,t.t)("nav.alerting-admin.title","Settings");case"cfg":return(0,t.t)("nav.config.title","Administration");case"cfg/general":return(0,t.t)("nav.config-general.title","General");case"cfg/plugins":return(0,t.t)("nav.config-plugins.title","Plugins and data");case"cfg/access":return(0,t.t)("nav.config-access.title","Users and access");case"datasources":return(0,t.t)("nav.datasources.title","Data sources");case"authentication":return(0,t.t)("nav.authentication.title","Authentication");case"licensing":return(0,t.t)("nav.statistics-and-licensing.title","Statistics and licensing");case"recordedQueries":return(0,t.t)("nav.recorded-queries.title","Recorded queries");case"correlations":return(0,t.t)("nav.correlations.title","Correlations");case"users":return(0,t.t)("nav.users.title","Users");case"teams":return(0,t.t)("nav.teams.title","Teams");case"plugins":return(0,t.t)("nav.plugins.title","Plugins");case"org-settings":return(0,t.t)("nav.org-settings.title","Default preferences");case"apikeys":return(0,t.t)("nav.api-keys.title","API keys");case"serviceaccounts":return(0,t.t)("nav.service-accounts.title","Service accounts");case"admin":return(0,t.t)("nav.admin.title","Server admin");case"support-bundles":return(0,t.t)("nav.support-bundles.title","Support bundles");case"global-users":return(0,t.t)("nav.global-users.title","Users");case"global-orgs":return(0,t.t)("nav.global-orgs.title","Organizations");case"server-settings":return(0,t.t)("nav.server-settings.title","Settings");case"storage":return(0,t.t)("nav.storage.title","Storage");case"migrate-to-cloud":return(0,t.t)("nav.migrate-to-cloud.title","Migrate to Grafana Cloud");case"upgrading":return(0,t.t)("nav.upgrading.title","Stats and license");case"monitoring":return(0,t.t)("nav.monitoring.title","Observability");case"infrastructure":return(0,t.t)("nav.infrastructure.title","Infrastructure");case"frontend":return(0,t.t)("nav.frontend.title","Frontend");case"apps":return(0,t.t)("nav.apps.title","Apps");case"alerts-and-incidents":return(0,t.t)("nav.alerts-and-incidents.title","Alerts & IRM");case"testing-and-synthetics":return(0,t.t)("nav.testing-and-synthetics.title","Testing & synthetics");case"plugin-page-grafana-incident-app":return(0,t.t)("nav.incidents.title","Incident");case"plugin-page-grafana-ml-app":return(0,t.t)("nav.machine-learning.title","Machine learning");case"plugin-page-grafana-slo-app":return(0,t.t)("nav.slo.title","SLO");case"plugin-page-k6-app":return(0,t.t)("nav.k6.title","Performance");case"monitoring":return(0,t.t)("nav.observability.title","Observability");case"plugin-page-grafana-k8s-app":return(0,t.t)("nav.kubernetes.title","Kubernetes");case"plugin-page-grafana-app-observability-app":return(0,t.t)("nav.application.title","Application");case"plugin-page-grafana-pyroscope-app":return(0,t.t)("nav.profiles.title","Profiles");case"plugin-page-grafana-kowalski-app":return(0,t.t)("nav.frontend-app.title","Frontend");case"plugin-page-grafana-synthetic-monitoring-app":return(0,t.t)("nav.synthetics.title","Synthetics");case"help":return(0,t.t)("nav.help.title","Help");case"profile/settings":return(0,t.t)("nav.profile/settings.title","Profile");case"profile/notifications":return(0,t.t)("nav.profile/notifications.title","Notification history");case"profile/password":return(0,t.t)("nav.profile/password.title","Change password");case"sign-out":return(0,t.t)("nav.sign-out.title","Sign out");case"search":return(0,t.t)("nav.search-dashboards.title","Search dashboards");case"connections":return(0,t.t)("nav.connections.title","Connections");case"connections-add-new-connection":return(0,t.t)("nav.add-new-connections.title","Add new connection");case"standalone-plugin-page-/connections/collector":return(0,t.t)("nav.collector.title","Collector");case"connections-datasources":return(0,t.t)("nav.data-sources.title","Data sources");case"standalone-plugin-page-/connections/infrastructure":return(0,t.t)("nav.integrations.title","Integrations");case"standalone-plugin-page-/connections/connect-data":return(0,t.t)("nav.connect-data.title","Connect data");case"standalone-plugin-page-/connections/private-data-source-connections":return(0,t.t)("nav.private-data-source-connections.title","Private data source connect");case"plugin-page-grafana-detect-app":return(0,t.t)("nav.detect.title","Detect");case"plugin-page-grafana-quaderno-app":return(0,t.t)("nav.grafana-quaderno.title","Grafana Quaderno");default:return}}function i(s){switch(s){case"dashboards":return(0,t.t)("nav.dashboards.subtitle","Create and manage dashboards to visualize your data");case"dashboards/browse":return(0,t.t)("nav.dashboards.subtitle","Create and manage dashboards to visualize your data");case"manage-folder":return(0,t.t)("nav.manage-folder.subtitle","Manage folder dashboards and permissions");case"dashboards/playlists":return(0,t.t)("nav.playlists.subtitle","Groups of dashboards that are displayed in a sequence");case"dashboards/snapshots":return(0,t.t)("nav.snapshots.subtitle","Interactive, publically available, point-in-time representations of dashboards");case"dashboards/library-panels":return(0,t.t)("nav.library-panels.subtitle","Reusable panels that can be added to multiple dashboards");case"dashboards/recently-deleted":return(0,t.t)("nav.recently-deleted.subtitle","Any items listed here for more than 30 days will be automatically deleted.");case"alerting":return(0,t.t)("nav.alerting.subtitle","Learn about problems in your systems moments after they occur");case"alerting-upgrade":return(0,t.t)("nav.alerting-upgrade.subtitle","Upgrade your existing legacy alerts and notification channels to the new Grafana Alerting");case"alerting-admin":return(0,t.t)("nav.alerting-admin.subtitle","Manage Alertmanager configurations");case"alert-list":return(0,t.t)("nav.alerting-list.subtitle","Rules that determine whether an alert will fire");case"receivers":return(0,t.t)("nav.alerting-receivers.subtitle","Choose how to notify your contact points when an alert instance fires");case"am-routes":return(0,t.t)("nav.alerting-am-routes.subtitle","Determine how alerts are routed to contact points");case"silences":return(0,t.t)("nav.alerting-silences.subtitle","Stop notifications from one or more alerting rules");case"groups":return(0,t.t)("nav.alerting-groups.subtitle","See grouped alerts with active notifications");case"datasources":return(0,t.t)("nav.datasources.subtitle","Add and configure data sources");case"correlations":return(0,t.t)("nav.correlations.subtitle","Add and configure correlations");case"users":return(0,t.t)("nav.users.subtitle","Invite and assign roles to users");case"teams":return(0,t.t)("nav.teams.subtitle","Groups of users that have common dashboard and permission needs");case"plugins":return(0,t.t)("nav.plugins.subtitle","Extend the Grafana experience with plugins");case"org-settings":return(0,t.t)("nav.org-settings.subtitle","Manage preferences across an organization");case"apikeys":return(0,t.t)("nav.api-keys.subtitle","Manage and create API keys that are used to interact with Grafana HTTP APIs");case"serviceaccounts":return(0,t.t)("nav.service-accounts.subtitle","Use service accounts to run automated workloads in Grafana");case"global-users":return(0,t.t)("nav.global-users.subtitle","Manage users in Grafana");case"global-orgs":return(0,t.t)("nav.global-orgs.subtitle","Isolated instances of Grafana running on the same server");case"server-settings":return(0,t.t)("nav.server-settings.subtitle","View the settings defined in your Grafana config");case"storage":return(0,t.t)("nav.storage.subtitle","Manage file storage");case"migrate-to-cloud":return(0,t.t)("nav.migrate-to-cloud.subtitle","Copy configuration from your self-managed installation to a cloud stack");case"support-bundles":return(0,t.t)("nav.support-bundles.subtitle","Download support bundles");case"admin":return(0,t.t)("nav.admin.subtitle","Manage server-wide settings and access to resources such as organizations, users, and licenses");case"cfg/general":return(0,t.t)("nav.config-general.subtitle","Manage default preferences and settings across Grafana");case"cfg/plugins":return(0,t.t)("nav.config-plugins.subtitle","Install plugins and define the relationships between data");case"cfg/access":return(0,t.t)("nav.config-access.subtitle","Configure access for individual users, teams, and service accounts");case"apps":return(0,t.t)("nav.apps.subtitle","App plugins that extend the Grafana experience");case"monitoring":return(0,t.t)("nav.monitoring.subtitle","Out-of-the-box observability solutions");case"infrastructure":return(0,t.t)("nav.infrastructure.subtitle","Understand your infrastructure's health");case"frontend":return(0,t.t)("nav.frontend.subtitle","Gain real user monitoring insights");case"alerts-and-incidents":return(0,t.t)("nav.alerts-and-incidents.subtitle","Alerting and incident management apps");case"testing-and-synthetics":return(0,t.t)("nav.testing-and-synthetics.subtitle","Optimize performance with k6 and Synthetic Monitoring insights");case"connections-add-new-connection":return(0,t.t)("nav.connections.subtitle","Browse and create new connections");case"connections-datasources":return(0,t.t)("nav.data-sources.subtitle","View and manage your connected data source connections");case"connections-private-data-source-connections":return(0,t.t)("nav.private-data-source-connections.subtitle","Query data that lives within a secured network without opening the network to inbound traffic from Grafana Cloud. Learn more in our docs.");default:return}}},28874:(G,O,e)=>{"use strict";e.d(O,{v:()=>i});var t=e(2543),n=e.n(t);function i(s){return(0,t.isArray)(s)?s.map(i):(0,t.isPlainObject)(s)?Object.keys(s).sort().reduce((r,f)=>{const a=s[f];return a!=null&&(r[f]=i(a)),r},{}):s}},21969:(G,O,e)=>{"use strict";e.d(O,{Ih:()=>n,Lr:()=>r,U7:()=>i,dr:()=>s,fE:()=>f});var t=e(77789);function n(a){const c=["refId","hide","key","queryType","datasource"];for(const o in a)if(o!=="label"&&!c.includes(o))return!1;return!0}function i(a,c,o){const h={...c,refId:(0,t.M)(a),hide:!1};return!h.datasource&&o&&(h.datasource=o),[...a,h]}function s(a){return a.indexOf("api/datasources/proxy")!==-1||a.indexOf("api/ds/query")!==-1}function r(a){return!a.match(/^http/)}function f(a){return a||void 0}},81523:(G,O,e)=>{"use strict";e.d(O,{Ax:()=>b,DI:()=>d,Gx:()=>u,IA:()=>M,NC:()=>E,TR:()=>A,U3:()=>C,X1:()=>D,cX:()=>x,ev:()=>I,l0:()=>y,oU:()=>P,rs:()=>v,x8:()=>R,xB:()=>m.x});var t=e(2543),n=e.n(t),i=e(76885),s=e(72724),r=e(19347),f=e(82467),a=e(3169),c=e(8484),o=e(99140),h=e(38877),g=e(75533),l=e(11401),p=e(16233),m=e(91650);async function y(U){const{queries:W,localOverride:w,datasource:N,starred:B,comment:V,showNotif:K}=U,H=K?.quotaExceededError??!0,X=K?.limitExceededWarning??!0,k=K?.otherErrors??!0,Y=W&&W.filter(Z=>L(Z));if(Y.length>0){let Z=!1,se=!1,j;try{j=(await(w?(0,l.tU)():(0,l.a)()).addToRichHistory({datasourceUid:N.uid,datasourceName:N.name??"",queries:Y,starred:B,comment:V??""})).warning}catch(q){return q instanceof Error&&(q.name===h.m.StorageFull?(Z=!0,H&&(0,o.JD)((0,f.dx)((0,a.gi)(q.message)))):k&&q.name!==h.m.DuplicatedEntry&&(0,o.JD)((0,f.dx)((0,a.gi)((0,c.t)("explore.rich-history-utils-notification.update-failed","Rich History update failed"),q.message)))),{richHistoryStorageFull:Z,limitExceeded:se}}return j&&j.type===h.C.LimitExceeded&&(se=!0,X&&(0,o.JD)((0,f.dx)((0,a.q8)(j.message)))),{richHistoryStorageFull:Z,limitExceeded:se}}return{}}async function d(U){const W={...U,from:U.to===void 0?U.to:(0,g.wQ)(U.to,{isLastTs:!0,tz:p.TP.user?.timezone}),to:U.from===void 0?U.from:(0,g.wQ)(U.from,{isLastTs:!0,tz:p.TP.user?.timezone})};return await(0,l.a)().getRichHistory(W)}async function v(U){await(0,l.a)().updateSettings(U)}async function u(){return await(0,l.a)().getSettings()}async function D(){return(0,l.a)().deleteAll()}async function P(U,W){try{return await(0,l.a)().updateStarred(U,W)}catch(w){w instanceof Error&&(0,o.JD)((0,f.dx)((0,a.gi)((0,c.t)("explore.rich-history-utils-notification.saving-failed","Saving rich history failed"),w.message)));return}}async function x(U,W){try{return await(0,l.a)().updateComment(U,W)}catch(w){w instanceof Error&&(0,o.JD)((0,f.dx)((0,a.gi)((0,c.t)("explore.rich-history-utils-notification.saving-failed","Saving rich history failed"),w.message)));return}}async function E(U){try{return await(0,l.a)().deleteRichHistory(U),U}catch(W){W instanceof Error&&(0,o.JD)((0,f.dx)((0,a.gi)((0,c.t)("explore.rich-history-utils-notification.saving-failed","Saving rich history failed"),W.message)));return}}const C=U=>{const W={range:{from:(0,c.t)("explore.rich-history-utils.default-from","now-1h"),to:(0,c.t)("explore.rich-history-utils.default-to","now")},datasource:U.datasourceName,queries:U.queries},w=(0,i.Pp)(W),N=/.*(?=\/explore)/.exec(`${window.location.href}`)[0];return i.kM.renderUrl(`${N}/explore`,{left:w})},M=U=>{let W;switch(U){case 0:W=(0,c.t)("explore.rich-history-utils.today","today");break;case 1:W=(0,c.t)("explore.rich-history-utils.yesterday","yesterday");break;case 7:W=(0,c.t)("explore.rich-history-utils.a-week-ago","a week ago");break;case 14:W=(0,c.t)("explore.rich-history-utils.two-weeks-ago","two weeks ago");break;default:W=(0,c.t)("explore.rich-history-utils.days-ago","{{num}} days ago",{num:`${U}`})}return W};function S(U){return(0,s.LE)(U,{format:"MMMM D"})}function I(U){const W=(0,t.omit)(U,["key","refId","datasource"]);return JSON.stringify(W)}function T(U,W){let w="";return W===m.x.DatasourceAZ||W===m.x.DatasourceZA?w=U.datasourceName:w=S(U.createdAt),w}function b(U,W){return W?.getQueryDisplayText?W.getQueryDisplayText(U):I(U)}function R(U,W){let w={};return U.forEach(N=>{let B=T(N,W);B in w?w[B]=[...w[B],N]:w[B]=[N]}),w}function A(){return(0,r.l)().getList({mixed:!0}).map(U=>({name:U.name,uid:U.uid}))}function L(U){const W=(0,t.omit)(U,["key","refId","datasource"]);return Object.keys(W).length>0}},91650:(G,O,e)=>{"use strict";e.d(O,{x:()=>t});var t=(n=>(n.Descending="Descending",n.Ascending="Ascending",n.DatasourceAZ="Datasource A-Z",n.DatasourceZA="Datasource Z-A",n))(t||{})},7030:(G,O,e)=>{"use strict";e.d(O,{$l:()=>u,Sp:()=>d,VN:()=>v,VP:()=>y,fn:()=>m});var t=e(41811),n=e(32264),i=e(17172),s=e(12131),r=e(80943),f=e(82467),a=e(3169),c=e(11982),o=e(99140),h=e(8484),g=e(87490);function l(){return`${window.location.protocol}//${window.location.host}${n.$.appSubUrl}`}function p(D){let P=D.replace(l(),"");return P.startsWith("/")?P.substring(1,P.length):P}const m=(0,t.A)(async function(D){try{return(await(0,i.AI)().post("/api/short-urls",{path:p(D)})).url}catch(P){console.error("Error when creating shortened link: ",P),(0,o.JD)((0,f.dx)((0,a.gi)("Error generating shortened link")))}}),y=async D=>{const P=await m(D);P?((0,g.uJ)(P),(0,o.JD)((0,f.dx)((0,a.tZ)("Shortened link copied to clipboard")))):(0,o.JD)((0,f.dx)((0,a.gi)("Error generating shortened link")))},d=async(D,P,x)=>{const E=v(D,P,x);if(P.useShortUrl)return await y(E);(0,g.uJ)(E),(0,o.JD)((0,f.dx)((0,a.tZ)((0,h.t)("link.share.copy-to-clipboard","Link copied to clipboard"))))},v=(D,P,x)=>{const E=s.Ny.getLocation(),C=r.jh.getTimeRange(x??D),M=u(P,C,x);return(0,c.uZ)({uid:D.state.uid,slug:D.state.meta.slug,currentQueryParams:E.search,updateQuery:M,absolute:!0})},u=(D,P,x)=>{const E={};return x&&(E.viewPanel=x.state.key),D.useAbsoluteTimeRange&&(E.from=P.state.value.from.toISOString(),E.to=P.state.value.to.toISOString()),D.theme!=="current"&&(E.theme=D.theme),E}},92247:(G,O,e)=>{"use strict";e.r(O),e.d(O,{getPrecision:()=>r,getScaledDecimals:()=>n,getStringPrecision:()=>f,grafanaTimeFormat:()=>i,logp:()=>s,tickStep:()=>t});function t(a,c,o){const h=Math.sqrt(50),g=Math.sqrt(10),l=Math.sqrt(2),p=Math.abs(c-a)/Math.max(0,o);let m=Math.pow(10,Math.floor(Math.log(p)/Math.LN10));const y=p/m;return y>=h?m*=10:y>=g?m*=5:y>=l&&(m*=2),c<a?-m:m}function n(a,c){return a-Math.floor(Math.log(c)/Math.LN10)}function i(a,c,o){if(c&&o&&a){const h=o-c,g=h/a/1e3,l=864e5,p=31536e6;return g<=45?"HH:mm:ss":g<=7200||h<=l?"HH:mm":g<=8e4?"MM/DD HH:mm":g<=2419200||h<=p?"MM/DD":"YYYY-MM"}return"HH:mm"}function s(a,c){return Math.log(a)/Math.log(c)}function r(a){const c=a.toString();return f(c)}function f(a){if(isNaN(a))return 0;const c=a.indexOf(".");return c===-1?0:a.length-c-1}},80582:(G,O,e)=>{"use strict";e.d(O,{Wb:()=>n,Zk:()=>i,zG:()=>s});var t=e(47232);const n=(r,f)=>{const a={from:(0,t.yT)(f.from),to:(0,t.yT)(f.to)},c=(a.to.valueOf()-a.from.valueOf())/2;let o,h;return r===-1?(o=a.to.valueOf()-c,h=a.from.valueOf()-c):r===1?(o=a.to.valueOf()+c,h=a.from.valueOf()+c,o>Date.now()&&a.to.valueOf()<Date.now()&&(o=Date.now(),h=a.from.valueOf())):(o=a.to.valueOf(),h=a.from.valueOf()),{from:h,to:o}},i=(r,f)=>{const a=r.to.valueOf()-r.from.valueOf(),c=r.to.valueOf()-a/2,o=a===0?3e4:a*f,h=c+o/2;return{from:c-o/2,to:h}};async function s(){const r=await navigator.clipboard.readText();let f;try{return f=JSON.parse(r),!f.from||!f.to?{range:r,isError:!0}:{range:f,isError:!1}}catch{return{range:r,isError:!0}}}},94515:(G,O,e)=>{"use strict";e.d(O,{iU:()=>n});var t=e(47232);function n(r,f){if(!(r.fromDayOfWeek||r.from)&&!(r.toDayOfWeek||r.to))return[];const a={...r};a.from&&!a.to&&(a.to=a.from),!a.from&&a.to&&(a.from=a.to);const c={from:i(a.from),to:i(a.to)};if(!a.fromDayOfWeek&&a.toDayOfWeek&&(a.fromDayOfWeek=a.toDayOfWeek),!a.toDayOfWeek&&a.fromDayOfWeek&&(a.toDayOfWeek=a.fromDayOfWeek),a.fromDayOfWeek&&(c.from.dayOfWeek=Number(a.fromDayOfWeek)),a.toDayOfWeek&&(c.to.dayOfWeek=Number(a.toDayOfWeek)),c.from.dayOfWeek&&c.from.h==null&&c.from.m==null&&(c.from.h=0,c.from.m=0,c.from.s=0),c.to.dayOfWeek&&c.to.h==null&&c.to.m==null&&(c.to.h=23,c.to.m=59,c.to.s=59),!c.from||!c.to)return[];c.from.h==null&&(c.from.h=0),c.to.h==null&&(c.to.h=23);const o=[],h=(0,t.KQ)(f.from).utc();for(h.set("hour",0),h.set("minute",0),h.set("second",0),h.set("millisecond",0),h.add(c.from.h,"hours"),h.add(c.from.m,"minutes"),h.add(c.from.s,"seconds");h.unix()<=f.to.unix();){for(;c.from.dayOfWeek&&c.from.dayOfWeek!==h.isoWeekday();)h.add(24,"hours");if(h.unix()>f.to.unix())break;const g=(0,t.KQ)(h).utc();if(g.hour)if(c.from.h<=c.to.h)g.add(c.to.h-c.from.h,"hours");else if(c.from.h>c.to.h)for(;g.hour()!==c.to.h;)g.add(1,"hours");else for(g.add(24-c.from.h,"hours");g.hour()!==c.to.h;)g.add(1,"hours");for(g.set("minute",c.to.m??0),g.set("second",c.to.s??0);c.to.dayOfWeek&&c.to.dayOfWeek!==g.isoWeekday();)g.add(24,"hours");h.unix()<f.from.unix()&&g.unix()<f.from.unix()||h.unix()>f.to.unix()&&g.unix()>f.to.unix()||o.push({from:h.valueOf(),to:g.valueOf()}),h.add(24,"hours")}return o}function i(r){const f={};if(!r?.length)return f;const a=r.split(":");return a?.length&&(f.h=Math.min(23,Math.max(0,Number(a[0]))),a.length>1&&(f.m=Math.min(60,Math.max(0,Number(a[1]))),a.length>2&&(f.s=Math.min(60,Math.max(0,Number(a[2])))))),f}function s(r){if(!r||r.h==null&&r.m==null&&r.s==null)return"";let f=String(r.h??0).padStart(2,"0")+":"+String(r.m??0).padStart(2,"0");return r.s!=null&&(f+=String(r.s??0).padStart(2,"0")),f}},67027:(G,O,e)=>{"use strict";e.d(O,{r:()=>n});let t="";const n=()=>{const s=new URLSearchParams(window.location.search).get("auth_token");return s!==null&&s!==""?(t=s,s):t}},5133:(G,O,e)=>{"use strict";e.d(O,{r:()=>f});var t=e(74848),n=e(62625),i=e(90182);const r=Object.values(n.X).filter(a=>a!==n.X.None).map(a=>({label:a,value:a}));function f({value:a,onChange:c,"aria-label":o,inputId:h,autoFocus:g,...l}){return(0,t.jsx)(i.l6,{inputId:h,value:a,options:r,onChange:p=>c(p.value??n.X.None),placeholder:"Choose role...","aria-label":o,autoFocus:g,...l})}},57334:(G,O,e)=>{"use strict";e.d(O,{$u:()=>V,A5:()=>Z,Bc:()=>se,DX:()=>L,JI:()=>R,Jc:()=>U,Kg:()=>A,MV:()=>d,N6:()=>D,P3:()=>E,Pi:()=>C,T$:()=>S,TK:()=>m,VR:()=>I,Vk:()=>H,hG:()=>u,hU:()=>w,is:()=>j,kz:()=>l,ly:()=>y,mI:()=>b,nM:()=>B,nh:()=>x,nr:()=>v,pm:()=>T,xq:()=>k,yd:()=>K});var t=e(2543),n=e.n(t),i=e(72724),s=e(33378),r=e(17172),f=e(12131),a=e(2913),c=e(10096),o=e(80714),h=e(31678),g=e(44672);function l(q){return async ne=>{try{ne((0,g.D1)(!1)),await ne(p(q)),await ne(P(q)),await ne(M(q)),a.Ay.ldapEnabled&&(0,s.a)("ldapsync")&&await ne(T()),ne((0,g.D1)(!0))}catch(oe){if(console.error(oe),(0,r.NF)(oe)){const z={title:oe.data.message,body:oe.data.error};ne((0,g.PV)(z))}}}}function p(q){return async ne=>{const oe=await(0,r.AI)().get(`/api/users/${q}`,(0,o.F)());ne((0,g.G_)(oe))}}function m(q){return async ne=>{await(0,r.AI)().put(`/api/users/${q.id}`,q),ne(l(q.id))}}function y(q,ne){return async oe=>{const z={password:ne};await(0,r.AI)().put(`/api/admin/users/${q}/password`,z),oe(l(q))}}function d(q){return async ne=>{await(0,r.AI)().post(`/api/admin/users/${q}/disable`),f.Ny.push("/admin/users")}}function v(q){return async ne=>{await(0,r.AI)().post(`/api/admin/users/${q}/enable`),ne(l(q))}}function u(q){return async ne=>{await(0,r.AI)().delete(`/api/admin/users/${q}`),f.Ny.push("/admin/users")}}function D(q,ne){return async oe=>{const z={isGrafanaAdmin:ne};await(0,r.AI)().put(`/api/admin/users/${q}/permissions`,z),oe(l(q))}}function P(q){return async ne=>{const oe=await(0,r.AI)().get(`/api/users/${q}/orgs`);ne((0,g.OF)(oe))}}function x(q,ne,oe){return async z=>{const te={loginOrEmail:q.login,role:oe};await(0,r.AI)().post(`/api/orgs/${ne}/users/`,te),z(l(q.id))}}function E(q,ne,oe){return async z=>{const te={role:oe};await(0,r.AI)().patch(`/api/orgs/${ne}/users/${q}`,te),z(l(q))}}function C(q,ne){return async oe=>{await(0,r.AI)().delete(`/api/orgs/${ne}/users/${q}`),oe(l(q))}}function M(q){return async ne=>{if(!c.TP.hasPermission(h.AccessControlAction.UsersAuthTokenList))return;const oe=await(0,r.AI)().get(`/api/admin/users/${q}/auth-tokens`);oe.reverse();const z=oe.map(te=>({id:te.id,isActive:te.isActive,seenAt:(0,i.fq)(te.seenAt),createdAt:te.createdAt,clientIp:te.clientIp,browser:te.browser,browserVersion:te.browserVersion,os:te.os,osVersion:te.osVersion,device:te.device}));ne((0,g.ag)(z))}}function S(q,ne){return async oe=>{const z={authTokenId:q};await(0,r.AI)().post(`/api/admin/users/${ne}/revoke-auth-token`,z),oe(M(ne))}}function I(q){return async ne=>{await(0,r.AI)().post(`/api/admin/users/${q}/logout`),ne(M(q))}}function T(){return async q=>{const ne=c.TP.hasPermission(h.AccessControlAction.LDAPStatusRead);if((0,s.a)("ldapsync")&&ne){const oe=await(0,r.AI)().get("/api/admin/ldap-sync-status");q((0,g.OR)(oe))}}}function b(q){return async ne=>{await(0,r.AI)().post(`/api/admin/ldap/sync/${q}`),ne(l(q))}}function R(){return async q=>{if(c.TP.hasPermission(h.AccessControlAction.LDAPStatusRead))try{const ne=await(0,r.AI)().get("/api/admin/ldap/status");q((0,g.pH)(ne))}catch(ne){if((0,r.NF)(ne)){ne.isHandled=!0;const oe={title:ne.data.message,body:ne.data.error};q((0,g.V$)(oe))}}}}function A(q){return async ne=>{try{const oe=await(0,r.AI)().get(`/api/admin/ldap/${encodeURIComponent(q)}`),{name:z,surname:te,email:le,login:ie,isGrafanaAdmin:ae,isDisabled:re,roles:ce,teams:me}=oe,ee={info:{name:z,surname:te,email:le,login:ie},permissions:{isGrafanaAdmin:ae,isDisabled:re},roles:ce,teams:me};ne((0,g.TW)(ee))}catch(oe){if((0,r.NF)(oe)){oe.isHandled=!0;const z={title:oe.data.message,body:oe.data.error};ne((0,g.Vv)()),ne((0,g.Nf)(z))}}}}function L(){return q=>{q((0,g.zi)())}}function U(){return q=>{q((0,g.zi)()),q((0,g.Vv)())}}const W=q=>q.map(ne=>Array.isArray(ne.value)?ne.value.map(oe=>`${ne.name}=${oe.value}`).join("&"):`${ne.name}=${ne.value}`).join("&");function w(){return async(q,ne)=>{try{const{perPage:oe,page:z,query:te,filters:le,sort:ie}=ne().userListAdmin;let ae=`/api/users/search?perpage=${oe}&page=${z}&query=${te}&${W(le)}`;ie&&(ae+=`&sort=${ie}`);const re=await(0,r.AI)().get(ae);q((0,g.Mb)(re))}catch(oe){(0,g.g4)(),console.error(oe)}}}const N=(0,t.debounce)(q=>q(w()),500);function B(q){return async ne=>{ne((0,g.Cj)()),ne((0,g.L5)(q)),N(ne)}}function V(q){return async ne=>{ne((0,g.Cj)()),ne((0,g.jX)(q)),N(ne)}}function K(q){return async ne=>{ne((0,g.Cj)()),ne((0,g.EC)(q)),ne(w())}}function H({sortBy:q}){const ne=q.length?`${q[0].id}-${q[0].desc?"desc":"asc"}`:void 0;return async(oe,z)=>{z().userListAdmin.sort!==ne&&(oe((0,g.Cj)()),oe((0,g.$u)(ne)),oe(w()))}}const X=q=>q.map(ne=>Array.isArray(ne.value)?ne.value.map(oe=>`${ne.name}=${oe.value}`).join("&"):`${ne.name}=${ne.value}`).join("&");function k(){return async(q,ne)=>{try{const{perPage:oe,page:z,query:te,filters:le,sort:ie}=ne().userListAnonymousDevices;let ae=`/api/anonymous/search?perpage=${oe}&page=${z}&query=${te}&${X(le)}`;ie&&(ae+=`&sort=${ie}`);const re=await(0,r.AI)().get(ae);q((0,g.o3)(re))}catch(oe){console.error(oe)}}}const Y=(0,t.debounce)(q=>q(k()),500);function Z({sortBy:q}){const ne=q.length?`${q[0].id}-${q[0].desc?"desc":"asc"}`:void 0;return async(oe,z)=>{z().userListAnonymousDevices.sort!==ne&&(oe((0,g.kh)(ne)),oe(k()))}}function se(q){return async ne=>{ne((0,g.xx)(q)),Y(ne)}}function j(q){return async ne=>{ne((0,g.iK)(q)),ne(k())}}},44672:(G,O,e)=>{"use strict";e.d(O,{$u:()=>b,Ay:()=>V,Cj:()=>C,D1:()=>v,EC:()=>I,G_:()=>m,L5:()=>S,Mb:()=>E,Nf:()=>o,OF:()=>y,OR:()=>c,PV:()=>u,TW:()=>h,V$:()=>a,Vv:()=>r,ag:()=>d,g4:()=>M,iK:()=>w,jX:()=>T,kh:()=>W,o3:()=>U,pH:()=>f,xx:()=>N,zi:()=>s});var t=e(65307);const n={connectionInfo:[],syncInfo:void 0,user:void 0,connectionError:void 0,userError:void 0},i=(0,t.Z0)({name:"ldap",initialState:n,reducers:{ldapConnectionInfoLoadedAction:(K,H)=>({...K,ldapError:void 0,connectionInfo:H.payload}),ldapFailedAction:(K,H)=>({...K,ldapError:H.payload}),ldapSyncStatusLoadedAction:(K,H)=>({...K,syncInfo:H.payload}),userMappingInfoLoadedAction:(K,H)=>({...K,user:H.payload,userError:void 0}),userMappingInfoFailedAction:(K,H)=>({...K,user:void 0,userError:H.payload}),clearUserMappingInfoAction:(K,H)=>({...K,user:void 0}),clearUserErrorAction:(K,H)=>({...K,userError:void 0})}}),{clearUserErrorAction:s,clearUserMappingInfoAction:r,ldapConnectionInfoLoadedAction:f,ldapFailedAction:a,ldapSyncStatusLoadedAction:c,userMappingInfoFailedAction:o,userMappingInfoLoadedAction:h}=i.actions,g=i.reducer,l={user:void 0,sessions:[],orgs:[],isLoading:!0,error:void 0},p=(0,t.Z0)({name:"userAdmin",initialState:l,reducers:{userProfileLoadedAction:(K,H)=>({...K,user:H.payload}),userOrgsLoadedAction:(K,H)=>({...K,orgs:H.payload}),userSessionsLoadedAction:(K,H)=>({...K,sessions:H.payload}),userAdminPageLoadedAction:(K,H)=>({...K,isLoading:!H.payload}),userAdminPageFailedAction:(K,H)=>({...K,error:H.payload,isLoading:!1})}}),{userProfileLoadedAction:m,userOrgsLoadedAction:y,userSessionsLoadedAction:d,userAdminPageLoadedAction:v,userAdminPageFailedAction:u}=p.actions,D=p.reducer,P={users:[],query:"",page:0,perPage:50,totalPages:1,showPaging:!1,filters:[{name:"activeLast30Days",value:!1}],isLoading:!0},x=(0,t.Z0)({name:"userListAdmin",initialState:P,reducers:{usersFetched:(K,H)=>{const{totalCount:X,perPage:k,...Y}=H.payload,Z=Math.ceil(X/k);return{...K,...Y,totalPages:Z,perPage:k,showPaging:Z>1,isLoading:!1}},usersFetchBegin:K=>({...K,isLoading:!0}),usersFetchEnd:K=>({...K,isLoading:!1}),queryChanged:(K,H)=>({...K,query:H.payload,page:0}),pageChanged:(K,H)=>({...K,page:H.payload}),sortChanged:(K,H)=>({...K,page:0,sort:H.payload}),filterChanged:(K,H)=>{const{name:X,value:k}=H.payload;return K.filters.some(Y=>Y.name===X)?{...K,page:0,filters:K.filters.map(Y=>Y.name===X?{...Y,value:k}:Y)}:{...K,page:0,filters:[...K.filters,H.payload]}}}}),{usersFetched:E,usersFetchBegin:C,usersFetchEnd:M,queryChanged:S,pageChanged:I,filterChanged:T,sortChanged:b}=x.actions,R=x.reducer,A={devices:[],query:"",page:0,perPage:50,totalPages:1,showPaging:!1,filters:[{name:"activeLast30Days",value:!0}]},L=(0,t.Z0)({name:"userListAnonymousDevices",initialState:A,reducers:{usersAnonymousDevicesFetched:(K,H)=>{const{totalCount:X,perPage:k,...Y}=H.payload,Z=Math.ceil(X/k);return{...K,...Y,totalPages:Z,perPage:k,showPaging:Z>1}},anonQueryChanged:(K,H)=>({...K,query:H.payload,page:0}),anonPageChanged:(K,H)=>({...K,page:H.payload}),anonUserSortChanged:(K,H)=>({...K,page:0,sort:H.payload}),filterChanged:(K,H)=>{const{name:X,value:k}=H.payload;return K.filters.some(Y=>Y.name===X)?{...K,page:0,filters:K.filters.map(Y=>Y.name===X?{...Y,value:k}:Y)}:{...K,page:0,filters:[...K.filters,H.payload]}}}}),{usersAnonymousDevicesFetched:U,anonUserSortChanged:W,anonPageChanged:w,anonQueryChanged:N}=L.actions,B=L.reducer,V={ldap:g,userAdmin:D,userListAdmin:R,userListAnonymousDevices:B}},55907:(G,O,e)=>{"use strict";e.d(O,{A:()=>D,p:()=>a});var t=e(2543),n=e.n(t),i=e(1062);const s=new i.tI({type:"query",params:[{name:"queryRefId",type:"string",dynamicLookup:!0},{name:"from",type:"string",options:["10s","1m","5m","10m","15m","1h","2h","6h","12h","24h","48h"]},{name:"to",type:"string",options:["now","now-1m","now-5m","now-10m","now-1h"]}],defaultParams:["#A","15m","now","avg"]}),r=[{text:"Query",value:"query"}],f={alerting:1,firing:1,no_data:2,pending:3,ok:4,paused:5,inactive:5};var a=(P=>(P.IsAbove="gt",P.IsBelow="lt",P.IsOutsideRange="outside_range",P.IsWithinRange="within_range",P.HasNoValue="no_value",P))(a||{});const c=[{value:"gt",text:"IS ABOVE"},{value:"lt",text:"IS BELOW"},{value:"outside_range",text:"IS OUTSIDE RANGE"},{value:"within_range",text:"IS WITHIN RANGE"},{value:"no_value",text:"HAS NO VALUE"}],o=[{text:"OR",value:"or"},{text:"AND",value:"and"}],h=[{text:"avg()",value:"avg"},{text:"min()",value:"min"},{text:"max()",value:"max"},{text:"sum()",value:"sum"},{text:"count()",value:"count"},{text:"last()",value:"last"},{text:"median()",value:"median"},{text:"diff()",value:"diff"},{text:"diff_abs()",value:"diff_abs"},{text:"percent_diff()",value:"percent_diff"},{text:"percent_diff_abs()",value:"percent_diff_abs"},{text:"count_non_null()",value:"count_non_null"}],g=[{text:"Alerting",value:"alerting"},{text:"No Data",value:"no_data"},{text:"Keep Last State",value:"keep_state"},{text:"Ok",value:"ok"}],l=[{text:"Alerting",value:"alerting"},{text:"Keep Last State",value:"keep_state"}];function p(P){const x=new i.tI({type:P.type,defaultParams:[]});return new i.kW(P,x)}function m(P){return P.toLowerCase().replace(/_/g,"").split(" ")[0]}function y(P){switch(m(P)){case"normal":case"ok":return{text:"OK",iconClass:"heart",stateClass:"alert-state-ok"};case"alerting":return{text:"ALERTING",iconClass:"heart-break",stateClass:"alert-state-critical"};case"nodata":return{text:"NO DATA",iconClass:"question-circle",stateClass:"alert-state-warning"};case"paused":return{text:"PAUSED",iconClass:"pause",stateClass:"alert-state-paused"};case"pending":return{text:"PENDING",iconClass:"hourglass",stateClass:"alert-state-warning"};case"firing":return{text:"FIRING",iconClass:"fire",stateClass:""};case"inactive":return{text:"INACTIVE",iconClass:"check",stateClass:""};case"error":return{text:"ERROR",iconClass:"heart-break",stateClass:"alert-state-critical"};case"unknown":default:return{text:"UNKNOWN",iconClass:"question-circle",stateClass:".alert-state-paused"}}}function d(P,x){return(0,t.reduce)(P,(E,C)=>(C.metric!==void 0&&C.value!==void 0&&E.push(C.metric+"="+C.value),C.Metric!==void 0&&C.Value!==void 0&&E.push(C.Metric+"="+C.Value),E),[]).join(x)}function v(P){return(0,t.isArray)(P.data)?d(P.data,", "):(0,t.isArray)(P.data.evalMatches)?d(P.data.evalMatches,", "):P.data.error?"Error: "+P.data.error:""}function u(P){return(0,t.isArray)(P)?d(P,", "):(0,t.isArray)(P.evalMatches)?d(P.evalMatches,", "):P.error?"Error: "+P.error:""}const D={alertQueryDef:s,getStateDisplayModel:y,conditionTypes:r,evalFunctions:c,evalOperators:o,noDataModes:g,executionErrorModes:l,reducerTypes:h,createReducerPart:p,getAlertAnnotationInfo:v,getAlertAnnotationText:u,alertStateSortScore:f}},1062:(G,O,e)=>{"use strict";e.d(O,{Dw:()=>f,Wn:()=>r,kW:()=>s,tI:()=>i});var t=e(2543),n=e.n(t);class i{constructor(h){this.type=h.type,this.params=h.params,this.defaultParams=h.defaultParams,this.renderer=h.renderer,this.category=h.category,this.addStrategy=h.addStrategy}}class s{constructor(h,g){if(this.part=h,this.def=g,!this.def)throw{message:"Could not find query part "+h.type};h.params=h.params||(0,t.clone)(this.def.defaultParams),this.params=h.params,this.text="",this.updateText()}render(h){return this.def.renderer(this,h)}hasMultipleParamsInString(h,g){return h.indexOf(",")===-1?!1:this.def.params[g+1]&&this.def.params[g+1].optional}updateParam(h,g){if(this.hasMultipleParamsInString(h,g)){(0,t.each)(h.split(","),(l,p)=>{this.updateParam(l.trim(),p)});return}h===""&&this.def.params[g].optional?this.params.splice(g,1):this.params[g]=h,this.part.params=this.params,this.updateText()}updateText(){if(this.params.length===0){this.text=this.def.type+"()";return}let h=this.def.type+"(";h+=this.params.join(", "),h+=")",this.text=h}}function r(o,h){const g=o.def.type+"(",l=(0,t.map)(o.params,(p,m)=>{const y=o.def.params[m];return y.type==="time"&&p==="auto"&&(p="$__interval"),y.quote==="single"?"'"+p+"'":y.quote==="double"?'"'+p+'"':p});return h&&l.unshift(h),g+l.join(", ")+")"}function f(o,h){return h+" "+o.params[0]}function a(o,h){return o.params[0]}function c(o,h){return'"'+o.params[0]+'"'}},25027:(G,O,e)=>{"use strict";e.d(O,{AK:()=>I,Cl:()=>B,Fb:()=>U,Hs:()=>H,IR:()=>S,KF:()=>v,Ke:()=>D,P6:()=>V,QA:()=>y,Rk:()=>M,Sn:()=>A,Sq:()=>E,U6:()=>w,U7:()=>d,aL:()=>L,fH:()=>l,hJ:()=>W,iW:()=>K,l$:()=>m,le:()=>g,nf:()=>C,t6:()=>N,vV:()=>p,zs:()=>b});var t=e(2543),n=e.n(t),i=e(47232),s=e(34867),r=e(17172),f=e(32264),a=e(14110),c=e(10096),o=e(28475);const h=7,g={filterByLabel:"filtering alert instances by label",loadedList:"loaded Alert Rules list",leavingRuleGroupEdit:"leaving rule group edit without saving",alertRuleFromPanel:"creating alert rule from panel",alertRuleFromScratch:"creating alert rule from scratch",recordingRuleFromScratch:"creating recording rule from scratch",clickingAlertStateFilters:"clicking alert state filters",cancelSavingAlertRule:"user canceled alert rule creation",successSavingAlertRule:"alert rule saved successfully",unknownMessageFromError:"unknown messageFromError",loadedCentralAlertStateHistory:"loaded central alert state history"},{logInfo:l,logError:p,logMeasurement:m}=(0,s.DW)("features.alerting",{module:"Alerting"});function y(X,k,Y){return async function(...Z){const se=performance.now(),j=await k(...Z),q=performance.now()-se;return m(X,{loadTimesMs:q},Y),j}}function d(X,k,Y){return async(...Z)=>{const se=performance.now(),j=await k(...Z),{namespacesCount:q,groupsCount:ne,rulesCount:oe}=u(j);return m(X,{loadTimeMs:performance.now()-se,namespacesCount:q,groupsCount:ne,rulesCount:oe},Y),j}}function v(X){Object.entries(X).forEach(([k,Y])=>{const Z=Y.message??"unknown error",se=String(Y.type)??"unknown",j=new Error(Z);p(j,{field:k,type:se})})}function u(X){const k=X.length,Y=X.flatMap(j=>j.groups).length,Z=X.flatMap(j=>j.groups).flatMap(j=>j.rules).length;return{namespacesCount:k,groupsCount:Y,rulesCount:Z}}function D(X,k,Y){return async(...Z)=>{const se=performance.now(),j=await k(...Z),{namespacesCount:q,groupsCount:ne,rulesCount:oe}=P(j);return m(X,{namespacesCount:q,groupsCount:ne,rulesCount:oe,loadTimeMs:performance.now()-se},Y),j}}function P(X){const k=Object.keys(X),Y=Object.values(X).flatMap(se=>se),Z=Y.flatMap(se=>se.rules);return{namespacesCount:k.length,groupsCount:Y.length,rulesCount:Z.length}}async function x(){try{const{createdAt:X}=await(0,r.AI)().get("/api/user"),k=(0,i.KQ)().subtract(h,"days"),Y=(0,i.KQ)(X);return k.isBefore(Y)}catch{return!0}}const E=async(X={grafana_version:f.$.buildInfo.version,org_id:c.TP.user.orgId,user_id:c.TP.user.id})=>{await x()||(0,a.rR)("grafana_alerting_navigation",X)},C=X=>{(0,a.rR)("grafana_alerting_rule_creation",X)},M=X=>{(0,a.rR)("grafana_alerting_rule_aborted",X)},S=X=>{(0,a.rR)("grafana_alerting_rule_form_error",X)},I=async X=>{const k={grafana_version:f.$.buildInfo.version,org_id:c.TP.user.orgId,user_id:c.TP.user.id};(0,a.rR)("grafana_alerting_insights",{...k,...X})};function T(X){(0,a.rR)("grafana_alerting_rules_search",{...X})}function b({oldQuery:X,newQuery:k}){try{const Y=(0,o.XY)(X),Z=(0,o.XY)(k),se=R(Y);R(Z).filter(ne=>!se.includes(ne)).forEach(ne=>{T({filter:ne,triggeredBy:"typing"})})}catch(Y){Y instanceof Error&&p(Y)}}function R(X){return Object.entries(X).filter(([k,Y])=>!(0,t.isEmpty)(Y)).map(([k])=>k)}function A(X){T({filter:X,triggeredBy:"component"})}function L(X){(0,a.rR)("grafana_alerting_rules_list_mode",{...X})}function U(){(0,a.rR)("grafana_alerting_switch_to_simplified_routing")}function W(){(0,a.rR)("grafana_alerting_switch_to_policies_routing")}function w(){(0,a.rR)("grafana_alerting_contact_point_form_edit_input_with_template")}function N(){(0,a.rR)("grafana_alerting_contact_point_form_use_custom_input_in_template")}function B(){(0,a.rR)("grafana_alerting_contact_point_form_use_single_template_in_input")}function V(X){(0,a.rR)("grafana_alerting_central_alert_state_history_filter_by_clicking",X)}function K(){(0,a.rR)("grafana_alerting_central_alert_state_history_expand_row")}function H(X){(0,a.rR)("grafana_alerting_central_alert_state_history_max_events_reached",X)}},79741:(G,O,e)=>{"use strict";e.r(O),e.d(O,{default:()=>d,defaultPageNav:()=>m});var t=e(74848),n=e(96540),i=e(17172),s=e(42418),r=e(66602),f=e(7392),a=e(37959),c=e(5179),o=e(39890),h=e(730),g=e(56361),l=e(18461);const p=v=>{const u=(0,l.uE)(v.match.params),[D]=(0,o.P5)(),x=D===o.gQ.Instances?void 0:0,E=(0,n.useMemo)(()=>{if(!u)throw new Error("Rule ID is required");return(0,l.qg)(u,!0)},[u]),{loading:C,error:M,result:S}=(0,h.ZU)({ruleIdentifier:E,limitAlerts:x});return M?(0,t.jsx)(a.d,{pageNav:m,navId:"alert-list",children:(0,t.jsx)(y,{error:M})}):C?(0,t.jsx)(a.d,{pageNav:m,navId:"alert-list",isLoading:!0,children:(0,t.jsx)(t.Fragment,{})}):S?(0,t.jsx)(c.K,{identifier:E,rule:S,children:(0,t.jsx)(o.Ay,{})}):(0,t.jsx)(a.d,{pageNav:m,navId:"alert-list",children:(0,t.jsx)(f.L,{entity:"Rule"})})},m={id:"alert-rule-view",text:""};function y({error:v}){return(0,i.NF)(v)&&v.status===404?(0,t.jsx)(f.L,{entity:"Rule"}):(0,t.jsx)(s.F,{title:"Something went wrong loading the rule",children:(0,g.JZ)(v)})}const d=(0,r.Xc)(p,{style:"page"})},79938:(G,O,e)=>{"use strict";e.d(O,{hK:()=>p});var t=e(2543),n=e.n(t),i=e(8484),s=e(57220),r=e(75214),f=e(23662),a=e(49962),c=e(49498),o=e(28220);const h="/api/v1/rule/test/grafana",g="api/prometheus/grafana/api/v1/rules";var l=(m=>(m.RuleGroup="rule_group",m.Namespace="file",m.FolderUID="folder_uid",m.LimitAlerts="limit_alerts",m))(l||{});const p=a.Hr.injectEndpoints({endpoints:m=>({preview:m.mutation({query:({alertQueries:y,condition:d,customLabels:v,folder:u,alertName:D,alertUid:P})=>({url:h,data:{rule:{grafana_alert:{data:y,condition:d,no_data_state:"Alerting",title:D,uid:P??"N/A"},for:"0s",labels:(0,r.x4)(v),annotations:{}},folderUid:u.uid,folderTitle:u.title},method:"POST"})}),prometheusRulesByNamespace:m.query({query:({limitAlerts:y,identifier:d,filter:v,state:u,matcher:D})=>{const P=new URLSearchParams;y&&P.set("limit_alerts",String(y)),d&&((0,f.Mj)(d)||(0,f.X4)(d))&&(P.set("file",d.namespace),P.set("rule_group",d.groupName));const x=(0,c.bZ)(P,v);return{url:g,params:(0,c.Dj)(x,u,D)}},transformResponse:y=>(0,c.lH)(y.data.groups,s.hY)}),prometheusRuleNamespaces:m.query({query:({ruleSourceName:y,namespace:d,groupName:v,ruleName:u,dashboardUid:D,panelId:P,limitAlerts:x})=>{const E={rule_group:v,rule_name:u,dashboard_uid:D,panel_id:P?.toString()};return d&&((0,s.z2)(y)?(0,t.set)(E,"folder_uid",d):(0,t.set)(E,"file",d)),x!==void 0&&(0,t.set)(E,"limit_alerts",String(x)),{url:`api/prometheus/${(0,s.w5)(y)}/api/v1/rules`,params:E}},transformResponse:(y,d,v)=>(0,c.lH)(y.data.groups,v.ruleSourceName),providesTags:["CombinedAlertRule"]}),rulerRules:m.query({query:({rulerConfig:y,filter:d})=>{const{path:v,params:u}=(0,o.$o)(y).rules(d);return{url:v,params:u}},providesTags:["CombinedAlertRule"]}),rulerNamespace:m.query({query:({rulerConfig:y,namespace:d})=>{const{path:v,params:u}=(0,o.$o)(y).namespace(d);return{url:v,params:u}}}),getRuleGroupForNamespace:m.query({query:({rulerConfig:y,namespace:d,group:v,requestOptions:u})=>{const{path:D,params:P}=(0,o.$o)(y).namespaceGroup(d,v);return(0,a.EB)({url:D,params:P},u)},providesTags:(y,d,{namespace:v,group:u})=>[{type:"RuleGroup",id:`${v}/${u}`},{type:"RuleNamespace",id:v}]}),deleteRuleGroupFromNamespace:m.mutation({query:({rulerConfig:y,namespace:d,group:v,requestOptions:u})=>{const D=(0,i.t)("alerting.rule-groups.delete.success","Successfully deleted rule group"),{path:P,params:x}=(0,o.$o)(y).namespaceGroup(d,v);return(0,a.EB)({url:P,params:x,method:"DELETE"},u,{successMessage:D})},invalidatesTags:(y,d,{namespace:v,group:u})=>[{type:"RuleGroup",id:`${v}/${u}`},{type:"RuleNamespace",id:v}]}),upsertRuleGroupForNamespace:m.mutation({query:({payload:y,namespace:d,rulerConfig:v,requestOptions:u})=>{const{path:D,params:P}=(0,o.$o)(v).namespace(d),x=(0,i.t)("alerting.rule-groups.update.success","Successfully updated rule group");return(0,a.EB)({url:D,params:P,data:y,method:"POST"},u,{successMessage:x})},invalidatesTags:(y,d,{namespace:v})=>[{type:"RuleNamespace",id:v}]}),getAlertRule:m.query({query:({uid:y})=>({url:`/api/ruler/${s.hY}/api/v1/rule/${y}`}),providesTags:(y,d,{uid:v})=>[{type:"GrafanaRulerRule",id:v}]}),exportRules:m.query({query:({format:y,folderUid:d,group:v,ruleUid:u})=>({url:"/api/ruler/grafana/api/v1/export/rules",params:{format:y,folderUid:d,group:v,ruleUid:u},responseType:"text"}),keepUnusedDataFor:0}),exportReceiver:m.query({query:({receiverName:y,decrypt:d,format:v})=>({url:"/api/v1/provisioning/contact-points/export/",params:{format:v,decrypt:d,name:y},responseType:"text"}),keepUnusedDataFor:0}),exportReceivers:m.query({query:({decrypt:y,format:d})=>({url:"/api/v1/provisioning/contact-points/export/",params:{format:d,decrypt:y},responseType:"text"}),keepUnusedDataFor:0}),exportPolicies:m.query({query:({format:y})=>({url:"/api/v1/provisioning/policies/export/",params:{format:y},responseType:"text"}),keepUnusedDataFor:0}),exportModifiedRuleGroup:m.mutation({query:({payload:y,format:d,nameSpaceUID:v})=>({url:`/api/ruler/grafana/api/v1/rules/${v}/export/`,params:{format:d},responseType:"text",data:y,method:"POST"})}),exportMuteTimings:m.query({query:({format:y})=>({url:"/api/v1/provisioning/mute-timings/export/",params:{format:y},responseType:"text"}),keepUnusedDataFor:0}),exportMuteTiming:m.query({query:({format:y,muteTiming:d})=>({url:`/api/v1/provisioning/mute-timings/${d}/export/`,params:{format:y},responseType:"text"}),keepUnusedDataFor:0})})})},91540:(G,O,e)=>{"use strict";e.d(O,{F:()=>s});var t=e(26272),n=e(28138),i=e(49962);const s=i.Hr.injectEndpoints({endpoints:r=>({getSilences:r.query({query:({datasourceUid:f,ruleMetadata:a,accessControl:c})=>({url:`/api/alertmanager/${f}/api/v2/silences`,params:{ruleMetadata:a,accesscontrol:c}}),providesTags:f=>f?f.map(({id:a})=>({type:"AlertmanagerSilences",id:a})):["AlertmanagerSilences"]}),getSilence:r.query({query:({datasourceUid:f,id:a,ruleMetadata:c,accessControl:o})=>({url:`/api/alertmanager/${f}/api/v2/silence/${a}`,showErrorAlert:!1,params:{ruleMetadata:c,accesscontrol:o}}),providesTags:(f,a,{id:c})=>f?[{type:"AlertmanagerSilences",id:c}]:["AlertmanagerSilences"]}),createSilence:r.mutation({query:({datasourceUid:f,payload:a})=>({url:`/api/alertmanager/${f}/api/v2/silences`,method:"POST",data:a}),invalidatesTags:["AlertmanagerSilences","AlertmanagerAlerts"],onQueryStarted:async(f,{queryFulfilled:a})=>{try{await a,n.A.emit(t.r1.alertSuccess,["Silence created"])}catch{n.A.emit(t.r1.alertError,["Could not create silence"])}}}),expireSilence:r.mutation({query:({datasourceUid:f,silenceId:a})=>({url:`/api/alertmanager/${f}/api/v2/silence/${a}`,method:"DELETE"}),invalidatesTags:["AlertmanagerSilences"]})})})},49962:(G,O,e)=>{"use strict";e.d(O,{EB:()=>o,Hr:()=>g});var t=e(75816),n=e(2543),i=e.n(n),s=e(75505),r=e(26272),f=e(17172),a=e(28138),c=e(25027);function o(l,p={},m={}){return{...l,...(0,n.defaultsDeep)(p,m)}}const h=()=>async({successMessage:l,errorMessage:p,...m})=>{try{const y={...m,...l&&{showSuccessAlert:!1},...p&&{showErrorAlert:!1}},d=performance.now(),{data:v,...u}=await(0,s.s)((0,f.AI)().fetch(y));return(0,c.l$)("backendSrvBaseQuery",{loadTimeMs:performance.now()-d},{url:m.url,method:m.method??"GET",responseStatus:u.statusText}),l&&m.showSuccessAlert!==!1&&a.A.emit(r.r1.alertSuccess,[l]),{data:v,meta:u}}catch(y){return p&&m.showErrorAlert!==!1&&a.A.emit(r.r1.alertError,[p]),{error:y}}},g=(0,t.xP)({reducerPath:"alertingApi",baseQuery:h(),tagTypes:["AlertingConfiguration","AlertmanagerConfiguration","AlertmanagerConnectionStatus","AlertmanagerAlerts","AlertmanagerSilences","OnCallIntegrations","OrgMigrationState","DataSourceSettings","GrafanaLabels","CombinedAlertRule","GrafanaRulerRule","GrafanaSlo","RuleGroup","RuleNamespace"],endpoints:()=>({})})},32415:(G,O,e)=>{"use strict";e.d(O,{By:()=>h,VO:()=>o,WS:()=>r,f4:()=>c,nd:()=>a,vk:()=>f});var t=e(75505),n=e(39070),i=e(17172),s=e(57220);async function r(y){try{const d=await(0,t.s)((0,i.AI)().fetch({url:`/api/alertmanager/${(0,s.w5)(y)}/config/api/v1/alerts`,showErrorAlert:!1,showSuccessAlert:!1}));return{template_files:d.data.template_files??{},template_file_provenances:d.data.template_file_provenances??{},alertmanager_config:d.data.alertmanager_config??{},last_applied:d.data.last_applied,id:d.data.id}}catch(d){if(y===s.hY&&(0,i.NF)(d)&&d.data?.message?.includes("could not find an Alertmanager configuration"))return{template_files:{},alertmanager_config:{}};throw d}}async function f(y,d){await(0,t.s)((0,i.AI)().fetch({method:"POST",url:`/api/alertmanager/${(0,s.w5)(y)}/config/api/v1/alerts`,data:d,showErrorAlert:!1,showSuccessAlert:!1}))}async function a(y){await(0,t.s)((0,i.AI)().fetch({method:"DELETE",url:`/api/alertmanager/${(0,s.w5)(y)}/config/api/v1/alerts`,showErrorAlert:!1,showSuccessAlert:!1}))}async function c(y){return(await(0,t.s)((0,i.AI)().fetch({url:`/api/alertmanager/${(0,s.w5)(y)}/api/v2/alerts/groups`,showErrorAlert:!1,showSuccessAlert:!1}))).data}async function o(y){return(await(0,t.s)((0,i.AI)().fetch({url:`/api/alertmanager/${(0,s.w5)(y)}/api/v2/status`,showErrorAlert:!1,showSuccessAlert:!1}))).data}async function h(y,d,v){const u={receivers:d,alert:v};try{const D=await(0,t.s)((0,i.AI)().fetch({method:"POST",data:u,url:`/api/alertmanager/${(0,s.w5)(y)}/config/api/v1/receivers/test`,showErrorAlert:!1,showSuccessAlert:!1}));if(g(D.data))throw new Error(m(D.data))}catch(D){throw(0,i.NF)(D)&&l(D.data)&&g(D.data)?new Error(m(D.data)):D}}function g(y){return y.receivers.some(d=>d.grafana_managed_receiver_configs.some(v=>v.status==="failed"))}function l(y){return(0,n.Gv)(y)&&"receivers"in y&&Array.isArray(y.receivers)?y.receivers.every(p):!1}function p(y){return(0,n.Gv)(y)&&"name"in y&&typeof y.name=="string"&&"grafana_managed_receiver_configs"in y&&Array.isArray(y.grafana_managed_receiver_configs)}function m(y){return y.receivers.flatMap(d=>d.grafana_managed_receiver_configs.filter(v=>v.status==="failed").map(v=>v.error??"Unknown error.")).join("; ")}},82843:(G,O,e)=>{"use strict";e.d(O,{m:()=>m});var t=e(2543),n=e.n(t),i=e(99140),s=e(25027),r=e(98164),f=e(57220),a=e(56361),c=e(88467),o=e(49962),h=e(32415),g=e(77583);const l=30,p=30*1e3,m=o.Hr.injectEndpoints({endpoints:y=>({getAlertmanagerAlerts:y.query({query:({amSourceName:d,filter:v,showErrorAlert:u=!0})=>{const D=v?.matchers?.filter(I=>I.name&&I.value).map(I=>`${I.name}${(0,r.MN)(I)}${(0,a.Y9)(I.value)}`),{silenced:P,inhibited:x,unprocessed:E,active:C}=v||{},M=Object.fromEntries(Object.entries({silenced:P,active:C,inhibited:x,unprocessed:E}).filter(([I,T])=>T!==void 0)),S={filter:D};return M&&Object.keys(M).forEach(I=>{S[I]=M[I]}),{url:`/api/alertmanager/${(0,f.w5)(d)}/api/v2/alerts`,params:S,showErrorAlert:u}},providesTags:["AlertmanagerAlerts"]}),getAlertmanagerAlertGroups:y.query({query:({amSourceName:d})=>({url:`/api/alertmanager/${(0,f.w5)(d)}/api/v2/alerts/groups`})}),grafanaNotifiers:y.query({query:()=>({url:"/api/alert-notifiers"})}),getGrafanaAlertingConfiguration:y.query({query:()=>({url:"/api/v1/ngalert/admin_config",showErrorAlert:!1}),providesTags:["AlertingConfiguration"]}),getGrafanaAlertingConfigurationStatus:y.query({query:()=>({url:"/api/v1/ngalert"}),providesTags:["AlertingConfiguration"]}),getExternalAlertmanagers:y.query({query:()=>({url:"/api/v1/ngalert/alertmanagers"}),transformResponse:d=>d.data,providesTags:["AlertmanagerConnectionStatus"]}),updateGrafanaAlertingConfiguration:y.mutation({query:d=>({url:"/api/v1/ngalert/admin_config",method:"POST",data:d,showSuccessAlert:!1}),invalidatesTags:["AlertingConfiguration","AlertmanagerConfiguration","AlertmanagerConnectionStatus"]}),getAlertmanagerConfigurationHistory:y.query({query:()=>({url:`/api/alertmanager/${(0,f.w5)(f.hY)}/config/history`,params:{limit:l}}),providesTags:["AlertmanagerConfiguration"]}),resetAlertmanagerConfigurationToOldVersion:y.mutation({query:d=>({url:`/api/alertmanager/${(0,f.w5)(f.hY)}/config/history/${d.id}/_activate`,method:"POST"}),invalidatesTags:["AlertmanagerConfiguration"]}),getAlertmanagerConfiguration:y.query({queryFn:async d=>{const v=d===f.hY;if((0,f.AL)(d))return(0,c.$I)((0,h.VO)(d).then(M=>({data:{alertmanager_config:M.config,template_files:{}}})));const{data:D}=await(0,i.JD)(g.L.endpoints.discoverAmFeatures.initiate({amSourceName:d})),P={alertmanager_config:{},template_files:{},template_file_provenances:{}},x=D?.lazyConfigInit??!1,E=(0,s.QA)("unifiedalerting/fetchAmConfig",h.WS,{dataSourceName:d,thunk:"unifiedalerting/fetchAmConfig"}),C=(0,a.i9)(()=>E(d),M=>!!(0,c.CZ)(M)?.includes("alertmanager storage object not found")&&!x,p).then(M=>v?M:(0,t.isEmpty)(M.alertmanager_config)&&(0,t.isEmpty)(M.template_files)?(0,h.VO)(d).then(I=>({alertmanager_config:I.config,template_files:{},template_file_provenances:M.template_file_provenances,last_applied:M.last_applied,id:M.id})):M).then(M=>M??P).then(M=>({data:M})).catch(M=>{if(x&&(0,c.CZ)(M)?.includes("alertmanager storage object not found"))return{data:P};throw M});return(0,c.$I)(C).catch(M=>({error:M,data:void 0}))},providesTags:["AlertmanagerConfiguration"]}),updateAlertmanagerConfiguration:y.mutation({query:({selectedAlertmanager:d,config:v,...u})=>({url:`/api/alertmanager/${(0,f.w5)(d)}/config/api/v1/alerts`,method:"POST",data:v,...u}),invalidatesTags:["AlertmanagerConfiguration"]}),getContactPointsStatus:y.query({query:()=>({url:`/api/alertmanager/${(0,f.w5)(f.hY)}/config/api/v1/receivers`}),transformResponse:d=>{const v=u=>u.startsWith("0001-01-01");return d.map(u=>({...u,integrations:u.integrations.map(D=>{const P=v(D.lastNotifyAttempt);return{...D,lastNotifyAttempt:P?"":D.lastNotifyAttempt,lastNotifyAttemptDuration:P?"":D.lastNotifyAttemptDuration}})}))}}),getContactPointsList:y.query({query:()=>({url:"/api/v1/notifications/receivers"})}),getMuteTimingList:y.query({query:()=>({url:"/api/v1/notifications/time-intervals"})})})})},92240:(G,O,e)=>{"use strict";e.d(O,{O5:()=>g,_y:()=>h,nD:()=>c});var t=e(75505),n=e(17172),i=e(94822),s=e(55740),r=e(57220),f=e(49498),a=e(28220);async function c(v){if(v===r.hY)return{features:{rulerApiEnabled:!0}};const u=(0,r.oh)(v);if(!u)throw new Error(`Cannot find data source configuration for ${v}`);const{url:D,name:P,type:x}=u;if(!D)throw new Error("The data source url cannot be empty.");if(x!=="prometheus"&&x!=="loki")throw new Error(`The build info request is not available for ${x}. Only 'prometheus' and 'loki' are supported`);return o({name:P,url:D,type:x})}async function o(v){const{url:u,name:D,type:P}=v,x=P==="loki"?void 0:await p(u);if(!(x!==void 0)){if(!await m(D))throw new Error(`Unable to fetch alert rules. Is the ${D} data source properly configured?`);const S=await y(D);return{application:i.N1.Cortex,features:{rulerApiEnabled:S}}}const{features:C}=x.data;return C?{application:i.N1.Mimir,features:{rulerApiEnabled:C?.ruler_config_api==="true"}}:{application:i.N1.Prometheus,features:{rulerApiEnabled:!1}}}async function h(v){if(v===r.hY)return{lazyConfigInit:!1};const u=l(v),{url:D,type:P}=u;if(!D)throw new Error("The data source url cannot be empty.");if(P!=="alertmanager")throw new Error(`Alertmanager feature discovery is not available for ${P}. Only 'alertmanager' type is supported`);return await g(D)}async function g(v){try{return{lazyConfigInit:(await p(v))?.data?.application==="Grafana Mimir"}}catch{return{lazyConfigInit:!1}}}function l(v){const u=(0,r.oh)(v);if(!u)throw new Error(`Cannot find data source configuration for ${v}`);return u}async function p(v){return(await(0,t.s)((0,n.AI)().fetch({url:`${v}/api/v1/status/buildinfo`,showErrorAlert:!1,showSuccessAlert:!1})).catch(D=>{if(!("status"in D&&D.status===404))throw D}))?.data}async function m(v){try{return await(0,f.sA)(v),!0}catch{return!1}}async function y(v){try{return await(0,a.Zp)(v),!0}catch(u){if(d(u))return!1;throw u}}function d(v){return(0,n.NF)(v)?v.data.message?.includes("GetRuleGroup unsupported in rule local store")||v.data.message?.includes("page not found")||v.data.message?.includes(s.UU):v instanceof Error&&v.message?.includes("404 from rules config endpoint")}},77583:(G,O,e)=>{"use strict";e.d(O,{L:()=>f});var t=e(94822),n=e(25027),i=e(57220),s=e(49962),r=e(92240);const f=s.Hr.injectEndpoints({endpoints:a=>({discoverAmFeatures:a.query({queryFn:async({amSourceName:c})=>{try{return{data:await(0,r._y)(c)}}catch(o){return{error:o}}}}),discoverDsFeatures:a.query({queryFn:async({rulesSourceName:c})=>{const o=(0,i.Jz)(c);if(!o)return{error:new Error(`Missing data source configuration for ${c}`)};const g=await(0,n.QA)("unifiedalerting/featureDiscoveryApi/discoverDsFeatures",r.nD,{dataSourceName:c,endpoint:"unifiedalerting/featureDiscoveryApi/discoverDsFeatures"})(o.name);return{data:{rulerConfig:g.features.rulerApiEnabled?{dataSourceName:o.name,apiVersion:g.application===t.N1.Cortex?"legacy":"config"}:void 0}}}})})})},68788:(G,O,e)=>{"use strict";e.d(O,{Es:()=>s,pB:()=>c});var t=e(75505),n=e(17172),i=e(57220);function s(){return(0,n.AI)().get("/api/alert-notifiers")}const r=o=>{const h=o.match(/^(\w+)(\[\d+\])?$/);return h?{type:h[1],index:h[2]}:{type:o,index:void 0}},f=o=>{const h={receivers:{},errorCount:0};o.forEach(l=>{h.receivers[l.name]={active:l.active,notifiers:{},errorCount:0};const p=h.receivers[l.name];l.integrations.forEach(m=>{!!m?.lastNotifyAttemptError&&(p.errorCount+=1);const d=a(m.name);d&&(p.notifiers[d]||(p.notifiers[d]=[]),p.notifiers[d].push(m))})});const g=Object.values(h.receivers).reduce((l,p)=>l+p.errorCount,0);return{...h,errorCount:g}},a=o=>r(o)?.type;async function c(o){try{const h=await(0,t.s)((0,n.AI)().fetch({url:`/api/alertmanager/${(0,i.w5)(o)}/config/api/v1/receivers`,showErrorAlert:!1,showSuccessAlert:!1}));return f(h.data)}catch{return f([])}}},26423:(G,O,e)=>{"use strict";e.d(O,{Pc:()=>r,WG:()=>a,uz:()=>h});var t=e(17172),n=e(37534),i=e(99494),s=e(49962);const r="grafana_alerting_v2",f=g=>`/api/plugin-proxy/${i.W.OnCall}${g}`,a=s.Hr.injectEndpoints({endpoints:g=>({grafanaOnCallIntegrations:g.query({query:()=>({url:f("/api/internal/v1/alert_receive_channels/"),params:{filters:!0,integration:[n.FI,"legacy_grafana_alerting"],skip_pagination:!0},showErrorAlert:!1}),transformResponse:l=>c(l)?l.results:l,providesTags:["OnCallIntegrations"]}),validateIntegrationName:g.query({query:l=>({url:f("/api/internal/v1/alert_receive_channels/validate_name/"),params:{verbal_name:l},showErrorAlert:!1})}),createIntegration:g.mutation({query:l=>({url:f("/api/internal/v1/alert_receive_channels/"),data:l,method:"POST",showErrorAlert:!0}),invalidatesTags:["OnCallIntegrations"]}),features:g.query({query:()=>({url:f("/api/internal/v1/features/"),showErrorAlert:!1})}),onCallConfigChecks:g.query({query:()=>({url:f("/api/internal/v1/organization/config-checks/"),showErrorAlert:!1})})})});function c(g){return"results"in g&&Array.isArray(g.results)}const{useGrafanaOnCallIntegrationsQuery:o}=a;function h(g){return(0,t.NF)(g)&&"detail"in g.data}},49498:(G,O,e)=>{"use strict";e.d(O,{Dj:()=>a,Kw:()=>o,bZ:()=>f,lH:()=>c,sA:()=>g});var t=e(75505),n=e(17172),i=e(57220),s=e(23662);function r(l){const{dataSourceName:p,limitAlerts:m,identifier:y}=l;return{rules:(d,v,u)=>{const D=new URLSearchParams;p===i.hY&&m&&D.set("limit_alerts",String(m)),y&&((0,s.Mj)(y)||(0,s.X4)(y))&&(D.set("file",y.namespace),D.set("rule_group",y.groupName));const P=f(D,d);return{url:`/api/prometheus/${(0,i.w5)(p)}/api/v1/rules`,params:a(P,v,u)}}}}function f(l,p){return p?.dashboardUID&&(l.set("dashboard_uid",p.dashboardUID),p?.panelId&&l.set("panel_id",String(p.panelId))),Object.fromEntries(l)}function a(l,p,m){let y={...l};if(p?.length&&(y={...y,state:p}),m?.length){const d=m.map(v=>JSON.stringify(v));y={...y,matcher:d}}return y}const c=(l,p)=>{const m={};return l.forEach(y=>{y.rules.forEach(d=>{d.query=d.query||""}),m[y.file]?m[y.file].groups.push(y):m[y.file]={dataSourceName:p,name:y.file,groups:[y]}}),Object.values(m)},o=(l=[])=>l?.flatMap(p=>p.groups.flatMap(m=>h(m,p.name)));function h(l,p){return{name:l.name,file:p,rules:l.rules,interval:l.interval}}async function g(l,p,m,y,d,v){if(p?.dashboardUID&&l!==i.hY)throw new Error("Filtering by dashboard UID is only supported for Grafana Managed rules.");const{url:u,params:D}=r({dataSourceName:l,limitAlerts:m,identifier:v}).rules(p,d,y),P=await(0,t.s)((0,n.AI)().fetch({url:u,params:D,showErrorAlert:!1,showSuccessAlert:!1})).catch(x=>{throw"status"in x&&x.status===404?new Error("404 from rule state endpoint. Perhaps ruler API is not enabled?"):x});return c(P.data.data.groups,l)}},28220:(G,O,e)=>{"use strict";e.d(O,{$o:()=>a,AJ:()=>p,E8:()=>c,HO:()=>l,Zp:()=>g,iy:()=>o});var t=e(75505),n=e(39070),i=e(17172),s=e(55740),r=e(57220),f=e(49498);function a(D){const x=`${`/api/ruler/${(0,r.w5)(D.dataSourceName)}`}/api/v1/rules`,E=new URLSearchParams;return E.set("subtype",D.apiVersion==="legacy"?"cortex":"mimir"),{rules:C=>{const M=(0,f.bZ)(E,C);return{path:`${x}`,params:M}},namespace:C=>({path:`${x}/${encodeURIComponent(C)}`,params:Object.fromEntries(E)}),namespaceGroup:(C,M)=>({path:`${x}/${encodeURIComponent(C)}/${encodeURIComponent(M)}`,params:Object.fromEntries(E)})}}async function c(D,P,x){const{path:E,params:C}=a(D).namespace(P);await(0,t.s)((0,i.AI)().fetch({method:"POST",url:E,data:x,showErrorAlert:!1,showSuccessAlert:!1,params:C}))}async function o(D,P){if(P?.dashboardUID&&D.dataSourceName!==r.hY)throw new Error("Filtering by dashboard UID is only supported by Grafana.");const{path:x,params:E}=a(D).rules(P);return m(x,{},E)}async function h(D,P){const{path:x,params:E}=a(D).namespace(P);return(await m(x,{},E))[P]||[]}async function g(D){return m(`/api/ruler/${(0,r.w5)(D)}/api/v1/rules/test/test`,null)}async function l(D,P,x){const{path:E,params:C}=a(D).namespaceGroup(P,x);return m(E,null,C)}async function p(D,P,x){const{path:E,params:C}=a(D).namespaceGroup(P,x);await(0,t.s)((0,i.AI)().fetch({url:E,method:"DELETE",showSuccessAlert:!1,showErrorAlert:!1,params:C}))}async function m(D,P,x){try{return(await(0,t.s)((0,i.AI)().fetch({url:D,showErrorAlert:!1,showSuccessAlert:!1,params:x}))).data}catch(E){if(!y(E))throw E;if(v(E))return P;throw d(E)?{...E,data:{...E.data,message:s.UU}}:E}}function y(D){if(!(0,n.Gv)(D))return!1;const P="data"in D&&D.data!==null&&D.data!==void 0;return"status"in D&&Number.isFinite(D.status)&&P}function d(D){return D.status===404||D.status===500&&D.data.message?.includes("unexpected content type from upstream. expected YAML, got text/html")}function v(D){return D.status===404&&(D.data.message?.includes("group does not exist")||D.data.message?.includes("no rule groups found"))}async function u(D,P){const{path:x,params:E}=a(D).namespace(P);await lastValueFrom(getBackendSrv().fetch({method:"DELETE",url:x,showErrorAlert:!1,showSuccessAlert:!1,params:E}))}},15458:(G,O,e)=>{"use strict";e.d(O,{R:()=>r});var t=e(74848),n=e(32196),i=e(40845),s=e(29158);const r=({labelKey:a,value:c,operator:o="=",onRemoveLabel:h})=>{const g=(0,i.of)(f);return(0,t.jsxs)("div",{className:g.wrapper,children:[a,o,c,!!h&&(0,t.jsx)(s.K,{name:"times",size:"xs",onClick:h,tooltip:"Remove label"})]})},f=a=>({wrapper:(0,n.css)({padding:a.spacing(.5,1),borderRadius:a.shape.radius.default,border:`solid 1px ${a.colors.border.medium}`,fontSize:a.typography.bodySmall.fontSize,backgroundColor:a.colors.background.secondary,fontWeight:a.typography.fontWeightBold,color:a.colors.text.primary,display:"inline-block",lineHeight:"1.2"})})},69087:(G,O,e)=>{"use strict";e.d(O,{m:()=>m});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(55127),f=e.n(r),a=e(96540),c=e(40845),o=e(55852),h=e(69613),g=e(8484),l=e(75214),p=e(8406);const m=({labels:v,commonLabels:u={},size:D,onClick:P})=>{const x=(0,c.of)(d,D),[E,C]=(0,a.useState)(!1),M=(0,i.chain)(v).toPairs().reject(l.w0).reject(([b])=>E?!1:b in u).value(),S=Object.keys(u).length,I=S>0,T=(0,g.t)("alert-labels.button.show.tooltip","Show common labels");return(0,t.jsxs)("div",{className:x.wrapper,role:"list","aria-label":"Labels",children:[M.map(([b,R])=>(0,t.jsx)(p.J,{size:D,label:b,value:R,color:y(b),onClick:P},b+R)),!E&&I&&(0,t.jsxs)(o.$n,{variant:"secondary",fill:"text",onClick:()=>C(!0),tooltip:T,tooltipPlacement:"top",size:"sm",children:["+",S," common ",f()("label",S)]}),E&&I&&(0,t.jsx)(o.$n,{variant:"secondary",fill:"text",onClick:()=>C(!1),tooltipPlacement:"top",size:"sm",children:(0,t.jsx)(g.x6,{i18nKey:"alert-labels.button.hide",children:"Hide common labels"})})]})};function y(v){return(0,h.MC)(v).color}const d=(v,u)=>({wrapper:(0,n.css)({display:"flex",flexWrap:"wrap",alignItems:"center",gap:u==="md"?v.spacing():v.spacing(.5)})})},37959:(G,O,e)=>{"use strict";e.d(O,{d:()=>u,y:()=>D});var t=e(74848),n=e(87586),i=e(69444),s=e(70383),r=e(32196),f=e(96540),a=e(40845),c=e(14186),o=e(90182),h=e(57220);function g(E){return E.name===h.hY?"Grafana":E.name.slice(0,37)}const l=({disabled:E=!1})=>{const C=(0,a.of)(p),{selectedAlertmanager:M,availableAlertManagers:S,setSelectedAlertmanager:I}=(0,s.VI)(),T=(0,f.useMemo)(()=>S.map(A=>({label:g(A),value:A.name,imgUrl:A.imgUrl,meta:A.meta})),[S]),b=E||T.length===1,R=b?"Alertmanager":"Choose Alertmanager";return(0,t.jsx)(c.I,{className:C.field,label:R,disabled:b,"data-testid":"alertmanager-picker",children:(0,t.jsx)(o.l6,{"aria-label":R,width:29,className:"ds-picker select-container",backspaceRemovesValue:!1,onChange:A=>{A?.value&&I(A.value)},options:T,maxMenuHeight:500,noOptionsMessage:"No datasources found",value:M,getOptionLabel:A=>A.label})})},p=E=>({field:(0,r.css)({margin:0})});var m=e(42418);const y=()=>(0,t.jsx)(m.F,{title:"No Alertmanager found",severity:"warning",children:"We could not find any external Alertmanagers and you may not have access to the built-in Grafana Alertmanager."}),d=()=>(0,t.jsx)(m.F,{title:"Selected Alertmanager not found.",severity:"warning",children:"The selected Alertmanager no longer exists or you may not have permission to access it. You can select a different Alertmanager from the dropdown."}),v=({availableAlertManagers:E})=>{const C=E.length>0;return(0,t.jsx)("div",{children:C?(0,t.jsx)(d,{}):(0,t.jsx)(y,{})})},u=({children:E,isLoading:C,...M})=>(0,t.jsx)(i.Y,{...M,children:(0,t.jsx)(i.Y.Contents,{isLoading:C,children:E})}),D=({children:E,accessType:C,...M})=>{const S=P();return(0,t.jsx)(s.b9,{accessType:C,children:(0,t.jsx)(u,{...M,actions:(0,t.jsx)(l,{disabled:S}),children:(0,t.jsx)(x,{children:E})})})};function P(){const E=(0,n.A)();return["/edit","/new"].some(M=>E?.pathname?.includes(M))}const x=({children:E})=>{const{availableAlertManagers:C,selectedAlertmanager:M}=(0,s.VI)();return M?(0,t.jsx)(t.Fragment,{children:E}):(0,t.jsx)(v,{availableAlertManagers:C})}},71223:(G,O,e)=>{"use strict";e.d(O,{s:()=>g});var t=e(74848),n=e(32196),i=e(56034),s=e(40845),r=e(72109),f=e(55740),a=e(84396),c=e(16577),o=e(73750);const h=["message","description"],g=({annotationKey:m,value:y,valueLink:d})=>{const v=m,u=f.J3[v]?(0,t.jsx)(i.m,{content:m,placement:"top",theme:"info",children:(0,t.jsx)("span",{children:f.J3[v]})}):m;return(0,t.jsx)(a.X,{label:u,horizontal:!0,children:(0,t.jsx)(l,{annotationKey:m,value:y,valueLink:d})})},l=({annotationKey:m,value:y,valueLink:d})=>{const v=(0,s.of)(p),u=h.includes(m),D=y&&y.startsWith("http"),P=(0,t.jsx)(c.Y,{input:y,delimiter:["{{","}}"]});return d?(0,t.jsx)(r.Y,{href:d,external:!0,children:y}):u?(0,t.jsx)(o.L,{className:v.well,children:P}):D?(0,t.jsx)(r.Y,{href:y,external:!0,children:y}):(0,t.jsx)(t.Fragment,{children:P})},p=m=>({well:(0,n.css)({wordBreak:"break-word"})})},84396:(G,O,e)=>{"use strict";e.d(O,{X:()=>s});var t=e(74848),n=e(32196),i=e(40845);const s=({className:f,label:a,horizontal:c,children:o,childrenWrapperClassName:h})=>{const g=(0,i.of)(r);return(0,t.jsxs)("div",{className:(0,n.cx)(g.field,c?g.fieldHorizontal:g.fieldVertical,f),children:[(0,t.jsx)("div",{children:a}),(0,t.jsx)("div",{className:h,children:o})]})},r=f=>({fieldHorizontal:(0,n.css)({flexDirection:"row",[f.breakpoints.down("md")]:{flexDirection:"column"}}),fieldVertical:(0,n.css)({flexDirection:"column"}),field:(0,n.css)({display:"flex",margin:`${f.spacing(2)} 0`,"& > div:first-child":{width:"110px",paddingRight:f.spacing(1),fontSize:f.typography.size.sm,fontWeight:f.typography.fontWeightBold,lineHeight:1.8},"& > div:nth-child(2)":{flex:1,color:f.colors.text.secondary}})})},75591:(G,O,e)=>{"use strict";e.d(O,{E:()=>h});var t=e(74848),n=e(32196),i=e(96540),s=e(13544),r=e(40845),f=e(29158),a=e(19384),c=e(98439),o=e(22620);const h=({cols:l,items:p,isExpandable:m=!1,onCollapse:y,onExpand:d,isExpanded:v,renderExpandedContent:u,testIdGenerator:D,pagination:P,paginationStyles:x,renderPrefixCell:E,renderPrefixHeader:C,footerRow:M,dataTestId:S})=>{const I=(0,r.of)(o.H);if((y||d||v)&&!(y&&d&&v))throw new Error("either all of onCollapse, onExpand, isExpanded must be provided, or none");if((m||u)&&!(m&&u))throw new Error("either both isExpanded and renderExpandedContent must be provided, or neither");const T=(0,r.of)(g(l,m,!!C)),[b,R]=(0,i.useState)([]),A=B=>{v&&y&&d?v(B)?y(B):d(B):R(b.includes(B.id)?b.filter(V=>V!==B.id):[...b,B.id])},L=P?.itemsPerPage??p.length,{page:U,numberOfPages:W,onPageChange:w,pageItems:N}=(0,c.W)(p,1,L);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:T.container,"data-testid":S??"dynamic-table",children:[(0,t.jsxs)("div",{className:T.row,"data-testid":"header",children:[C&&C(),m&&(0,t.jsx)("div",{className:T.cell}),l.map(B=>(0,t.jsx)("div",{className:T.cell,children:B.label},B.id))]}),N.map((B,V)=>{const K=v?v(B):b.includes(B.id);return(0,t.jsxs)("div",{className:T.row,"data-testid":D?.(B,V)??"row",children:[E&&E(B,V,p),m&&(0,t.jsx)("div",{className:(0,n.cx)(T.cell,T.expandCell),children:(0,t.jsx)(f.K,{tooltip:`${K?"Collapse":"Expand"} row`,"data-testid":s.Tp.components.AlertRules.toggle,name:K?"angle-down":"angle-right",onClick:()=>A(B)})}),l.map(H=>(0,t.jsx)("div",{className:(0,n.cx)(T.cell,T.bodyCell,H.className),"data-column":H.label,children:H.renderCell(B,V)},`${B.id}-${H.id}`)),K&&u&&(0,t.jsx)("div",{className:T.expandedContentRow,"data-testid":s.Tp.components.AlertRules.expandedContent,children:u(B,V,p)})]},`${B.id}-${V}`)}),M&&(0,t.jsx)("div",{className:(0,n.cx)(T.row,T.footerRow),children:M})]}),P&&(0,t.jsx)(a.d,{className:(0,n.cx)(I,x),currentPage:U,numberOfPages:W,onNavigate:w,hideWhenSinglePage:!0})]})},g=(l,p,m)=>{const y=l.map(d=>d.size?typeof d.size=="number"?`${d.size}fr`:d.size:"auto");return p&&y.unshift("calc(1em + 16px)"),m&&y.unshift("0"),d=>({container:(0,n.css)({border:`1px solid ${d.colors.border.weak}`,borderRadius:d.shape.radius.default,color:d.colors.text.secondary}),row:(0,n.css)({display:"grid",gridTemplateColumns:y.join(" "),gridTemplateRows:"1fr auto","&:nth-child(2n + 1)":{backgroundColor:d.colors.background.secondary},"&:nth-child(2n)":{backgroundColor:d.colors.background.primary},[d.breakpoints.down("sm")]:{gridTemplateColumns:"auto 1fr",gridTemplateAreas:"left right",padding:`0 ${d.spacing(.5)}`,"&:first-child":{display:"none"},"& > *:first-child":{display:m?"none":void 0}}}),footerRow:(0,n.css)({display:"flex",padding:d.spacing(1)}),cell:(0,n.css)({display:"flex",alignItems:"center",padding:d.spacing(1),[d.breakpoints.down("sm")]:{padding:`${d.spacing(1)} 0`,gridTemplateColumns:"1fr"}}),bodyCell:(0,n.css)({overflow:"hidden",[d.breakpoints.down("sm")]:{gridColumnEnd:"right",gridColumnStart:"right","&::before":{content:"attr(data-column)",display:"block",color:d.colors.text.primary}}}),expandCell:(0,n.css)({justifyContent:"center",[d.breakpoints.down("sm")]:{alignItems:"start",gridArea:"left"}}),expandedContentRow:(0,n.css)({gridColumnEnd:y.length+1,gridColumnStart:m?3:2,gridRow:2,padding:`0 ${d.spacing(3)} 0 ${d.spacing(1)}`,position:"relative",[d.breakpoints.down("sm")]:{gridColumnStart:2,borderTop:`1px solid ${d.colors.border.strong}`,gridRow:"auto",padding:`${d.spacing(1)} 0 0 0`}})})}},10562:(G,O,e)=>{"use strict";e.d(O,{B:()=>r});var t=e(74848),n=e(32196),i=e(40845),s=e(75591);const r=({renderExpandedContent:a,...c})=>{const o=(0,i.of)(f);return(0,t.jsx)(s.E,{renderExpandedContent:a?(h,g,l)=>(0,t.jsxs)(t.Fragment,{children:[g!==l.length-1&&(0,t.jsx)("div",{className:(0,n.cx)(o.contentGuideline,o.guideline)}),a(h,g,l)]}):void 0,renderPrefixHeader:()=>(0,t.jsx)("div",{className:o.relative,children:(0,t.jsx)("div",{className:(0,n.cx)(o.headerGuideline,o.guideline)})}),renderPrefixCell:(h,g,l)=>(0,t.jsxs)("div",{className:o.relative,children:[(0,t.jsx)("div",{className:(0,n.cx)(o.topGuideline,o.guideline)}),g!==l.length-1&&(0,t.jsx)("div",{className:(0,n.cx)(o.bottomGuideline,o.guideline)})]}),...c})},f=a=>({relative:(0,n.css)({position:"relative",height:"100%"}),guideline:(0,n.css)({left:"-19px",borderLeft:`1px solid ${a.colors.border.weak}`,position:"absolute",[a.breakpoints.down("md")]:{display:"none"}}),topGuideline:(0,n.css)({width:"18px",borderBottom:`1px solid ${a.colors.border.medium}`,top:0,bottom:"50%"}),bottomGuideline:(0,n.css)({top:"50%",bottom:0}),contentGuideline:(0,n.css)({top:0,bottom:0,left:"-49px !important"}),headerGuideline:(0,n.css)({top:"-17px",bottom:0})})},35108:(G,O,e)=>{"use strict";e.d(O,{j:()=>h});var t=e(74848),n=e(32196),i=e(46942),s=e.n(i),r=e(96540),f=e(40845),a=e(67061),c=e(95868),o=e(13840);const h=({children:l,header:p,content:m,footer:y,arrow:d,showAfter:v=300,wrapperClassName:u,disabled:D=!1,...P})=>{const x=(0,r.useRef)(null),E=(0,f.of)(g);if(D)return l;const C=(0,t.jsxs)(a.B,{direction:"column",gap:0,role:"tooltip",children:[p&&(0,t.jsx)("div",{className:E.card.header,children:p}),(0,t.jsx)("div",{className:E.card.body,children:m}),y&&(0,t.jsx)("div",{className:E.card.footer,children:y})]});return(0,t.jsx)(c.I,{content:C,hideAfter:100,children:(M,S,I)=>(0,t.jsxs)(t.Fragment,{children:[x.current&&(0,t.jsx)(o.A,{...I,...P,wrapperClassName:s()(E.popover,u),onMouseLeave:S,onMouseEnter:M,onFocus:M,onBlur:S,referenceElement:x.current,renderArrow:d}),(0,r.cloneElement)(l,{ref:x,onMouseEnter:M,onMouseLeave:S,onFocus:M,onBlur:S,tabIndex:0})]})})},g=l=>({popover:(0,n.css)({borderRadius:l.shape.radius.default,boxShadow:l.shadows.z3,background:l.colors.background.primary,border:`1px solid ${l.colors.border.medium}`}),card:{body:(0,n.css)({padding:l.spacing(1)}),header:(0,n.css)({padding:l.spacing(1),background:l.colors.background.secondary,borderBottom:`solid 1px ${l.colors.border.medium}`}),footer:(0,n.css)({padding:l.spacing(.5,1),background:l.colors.background.secondary,borderTop:`solid 1px ${l.colors.border.medium}`})}})},93810:(G,O,e)=>{"use strict";e.d(O,{A:()=>s});var t=e(74848),n=e(42418);const s=()=>(0,t.jsx)(n.F,{severity:"info",title:"Alert evaluation currently paused",children:"Notifications for this rule will not fire and no alert instances will be created until the rule is un-paused."})},8406:(G,O,e)=>{"use strict";e.d(O,{J:()=>c});var t=e(74848),n=e(32196),i=e(96540),s=e(84140),r=e(40845),f=e(67061),a=e(14578);const c=({label:h,value:g,icon:l,color:p,size:m="md",onClick:y})=>{const d=(0,r.of)(o,p,m),v=`${h}: ${g}`,u=h?.toString()??"",D=g?.toString()??"",P=(0,i.useMemo)(()=>(0,t.jsxs)(f.B,{direction:"row",gap:0,alignItems:"stretch",children:[(0,t.jsx)("div",{className:d.label,children:(0,t.jsxs)(f.B,{direction:"row",gap:.5,alignItems:"center",children:[l&&(0,t.jsx)(a.I,{name:l}),h&&(0,t.jsx)("span",{className:d.labelText,title:h.toString(),children:h??""})]})}),(0,t.jsx)("div",{className:d.value,title:g?.toString(),children:g??"-"})]}),[l,h,g,d]);return(0,t.jsx)("div",{className:d.wrapper,role:"listitem","aria-label":v,"data-testid":"label-value",children:y?(0,t.jsx)("div",{className:d.clickable,role:"button",tabIndex:0,onClick:()=>y(u,D),onKeyDown:x=>{x.key==="Enter"&&(y(u,D),x.preventDefault())},children:P},u+D):P})},o=(h,g,l)=>{const p=g??h.colors.secondary.main,m=h.isDark?(0,s.A)(p).lighten(5).toString():(0,s.A)(p).darken(5).toString(),y=h.isDark?(0,s.A)(p).darken(5).toString():(0,s.A)(p).lighten(5).toString(),d=g?s.A.mostReadable(p,["#000","#fff"]).toString():h.colors.text.primary;let v=h.spacing(.33,1);switch(l){case"sm":v=h.spacing(.2,.6);break;case"xs":v=h.spacing(0,.5);break;default:break}return{wrapper:(0,n.css)({color:d,fontSize:h.typography.bodySmall.fontSize,borderRadius:h.shape.borderRadius(2)}),labelText:(0,n.css)({whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"300px"}),label:(0,n.css)({display:"flex",alignItems:"center",color:"inherit",padding:v,background:p,border:`solid 1px ${m}`,borderTopLeftRadius:h.shape.borderRadius(2),borderBottomLeftRadius:h.shape.borderRadius(2)}),clickable:(0,n.css)({"&:hover":{opacity:.8,cursor:"pointer"}}),value:(0,n.css)({color:"inherit",padding:v,background:y,border:`solid 1px ${m}`,borderLeft:"none",borderTopRightRadius:h.shape.borderRadius(2),borderBottomRightRadius:h.shape.borderRadius(2),whiteSpace:"pre",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"300px"})}}},55196:(G,O,e)=>{"use strict";e.d(O,{P:()=>a});var t=e(74848),n=e(32196),i=e(40845),s=e(94753),r=e(67061),f=e(14578);const a=({children:o,icon:h,color:g="secondary",direction:l="row",...p})=>{const m=(0,i.of)(c),y=typeof p.onClick=="function",d=l==="row",v=d?"center":"flex-start",u=d?.5:0;return(0,t.jsx)("div",{className:(0,n.cx)({[m.interactive]:y}),...p,children:(0,t.jsx)(s.E,{variant:"bodySmall",color:g,children:(0,t.jsxs)(r.B,{direction:l,alignItems:v,gap:u,wrap:"wrap",children:[h&&(0,t.jsx)(f.I,{size:"xs",name:h}),o]})})})},c=()=>({interactive:(0,n.css)({cursor:"pointer"})})},90141:(G,O,e)=>{"use strict";e.d(O,{A:()=>a});var t=e(74848),n=e(96540),i=e(55852),s=e(67061),r=e(14578);const a=(0,n.forwardRef)(function(o,h){return(0,t.jsx)(i.$n,{variant:"secondary",size:"sm",type:"button","aria-label":"More",ref:h,...o,children:(0,t.jsxs)(s.B,{direction:"row",alignItems:"center",gap:0,children:["More ",(0,t.jsx)(r.I,{name:"angle-down"})]})})})},76156:(G,O,e)=>{"use strict";e.d(O,{h:()=>s});var t=e(74848),n=e(12210);const i=({children:r,plugin:f,loadingComponent:a,notInstalledFallback:c})=>{const{loading:o,installed:h}=usePluginBridge(f);return o?a??null:h?jsx(Fragment,{children:r}):c??null};function s(r,f,a){const c=new URLSearchParams(a).toString();return`/a/${r}${f}`+(c?"?"+c:"")}},48205:(G,O,e)=>{"use strict";e.d(O,{Yi:()=>r,hk:()=>s,rS:()=>f});var t=e(74848),n=e(42418),i=e(39938),s=(a=>(a.ContactPoint="contact point",a.Template="template",a.MuteTiming="mute timing",a.AlertRule="alert rule",a.RootNotificationPolicy="root notification policy",a))(s||{});const r=({resource:a,...c})=>(0,t.jsxs)(n.F,{title:`This ${a} cannot be edited through the UI`,severity:"info",...c,children:["This ",a," has been provisioned, that means it was created by config. Please contact your server admin to update this ",a,"."]}),f=()=>(0,t.jsx)(i.E,{text:"Provisioned",color:"purple"})},82437:(G,O,e)=>{"use strict";e.d(O,{c:()=>s});var t=e(74848),n=e(94753),i=e(14578);const s=({namespace:r,group:f})=>f?(0,t.jsxs)(n.E,{element:"h3",variant:"body",children:[r," ",(0,t.jsx)(i.I,{name:"angle-right","aria-label":">"})," ",f]}):(0,t.jsx)(n.E,{element:"h3",variant:"body",children:r})},26058:(G,O,e)=>{"use strict";e.d(O,{h:()=>i});var t=e(74848),n=e(32196);const i=()=>(0,t.jsx)("span",{className:(0,n.css)({flex:1})})},65415:(G,O,e)=>{"use strict";e.d(O,{O:()=>r});var t=e(74848),n=e(32196),i=e(96540),s=e(40845);const r=(0,i.forwardRef)(({children:a,state:c,size:o="md",muted:h=!1},g)=>{const l=(0,s.of)(f);return(0,t.jsx)("span",{className:(0,n.cx)(l.common,l[c],l[o],{[l.muted]:h}),ref:g,children:a||c})});r.displayName="StateTag";const f=a=>({common:(0,n.css)({display:"inline-block",color:"white",borderRadius:a.shape.radius.default,fontSize:a.typography.size.sm,textTransform:"capitalize",lineHeight:"1.2",textAlign:"center",fontWeight:a.typography.fontWeightBold}),good:(0,n.css)({backgroundColor:a.colors.success.main,border:`solid 1px ${a.colors.success.main}`,color:a.colors.success.contrastText}),warning:(0,n.css)({backgroundColor:a.colors.warning.main,border:`solid 1px ${a.colors.warning.main}`,color:a.colors.warning.contrastText}),bad:(0,n.css)({backgroundColor:a.colors.error.main,border:`solid 1px ${a.colors.error.main}`,color:a.colors.error.contrastText}),neutral:(0,n.css)({backgroundColor:a.colors.secondary.main,border:`solid 1px ${a.colors.secondary.main}`,color:a.colors.secondary.contrastText}),info:(0,n.css)({backgroundColor:a.colors.primary.main,border:`solid 1px ${a.colors.primary.main}`,color:a.colors.primary.contrastText}),md:(0,n.css)({padding:a.spacing(.5,1),minWidth:a.spacing(8)}),sm:(0,n.css)({padding:a.spacing(.3,.5),minWidth:"52px"}),muted:(0,n.css)({opacity:"0.5"})})},16577:(G,O,e)=>{"use strict";e.d(O,{Y:()=>c});var t=e(74848),n=e(32196),i=e(40845),s=e(39938),r=e(35108),f=e(83225);const a=["$",".",'"'];function c({input:d,delimiter:v=["{{","}}"]}){const u=(0,i.of)(y),[D,P]=v,x=new RegExp(`(?<before>.*?)(${D}(?<token>.*?)${P}|$)`,"gm"),E=d.split(`
`),C=[];return E.forEach((M,S)=>{Array.from(M.matchAll(x)).forEach((T,b)=>{const R=T.groups?.before,A=T.groups?.token?.trim();if(R&&C.push((0,t.jsx)("span",{children:R},`${S}-${b}-before`)),A){const L=m(A),U=L==="variable"?A:"",W=`${D} ${A} ${P}`;C.push((0,t.jsx)(h,{content:W,type:L,description:U},`${S}-${b}-token`))}}),C.push((0,t.jsx)("br",{},`${S}-newline`))}),(0,t.jsx)("span",{className:u.wrapper,children:C})}var o=(d=>(d.Variable="variable",d.Function="function",d.Keyword="keyword",d.Unknown="unknown",d))(o||{});function h({content:d,description:v,type:u}){const D=(0,i.of)(y),P=!u;return(0,t.jsx)(r.j,{placement:"top-start",disabled:P,content:(0,t.jsxs)("div",{className:D.hoverTokenItem,children:[(0,t.jsx)(s.E,{tabIndex:0,text:(0,t.jsx)(t.Fragment,{children:u}),color:"blue"})," ",v&&(0,t.jsx)("code",{children:v})]}),children:(0,t.jsx)("span",{children:(0,t.jsx)(s.E,{tabIndex:0,className:D.token,text:d,color:"blue"})})})}function g(d){return a.some(v=>d.startsWith(v))}function l(d){return f.keywords.some(v=>d.startsWith(v))}function p(d){return f.builtinFunctions.some(v=>d.startsWith(v))}function m(d){let v;return g(d)?v="variable":l(d)?v="keyword":p(d)?v="function":v="unknown",v}const y=d=>({wrapper:(0,n.css)({whiteSpace:"pre-wrap"}),token:(0,n.css)({cursor:"default",fontFamily:d.typography.fontFamilyMonospace}),popover:(0,n.css)({borderRadius:d.shape.radius.default,boxShadow:d.shadows.z3,background:d.colors.background.primary,border:`1px solid ${d.colors.border.medium}`,padding:d.spacing(1)}),hoverTokenItem:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center",gap:d.spacing(1)})})},73750:(G,O,e)=>{"use strict";e.d(O,{L:()=>s});var t=e(74848),n=e(32196),i=e(40845);const s=({children:f,className:a})=>{const c=(0,i.of)(r);return(0,t.jsx)("div",{className:(0,n.cx)(c.wrapper,a),children:f})},r=f=>({wrapper:(0,n.css)({backgroundColor:f.components.panel.background,border:`solid 1px ${f.components.input.borderColor}`,borderRadius:f.shape.radius.default,padding:f.spacing(.5,1),fontFamily:f.typography.fontFamilyMonospace})})},96636:(G,O,e)=>{"use strict";e.d(O,{d:()=>i});var t=e(96540),n=e(14778);const i=({component:s,title:r="previous page"})=>{const f=(0,n.i)(),a=(0,t.useCallback)(()=>{f(r)},[f,r]);return(0,t.cloneElement)(s,{onClick:a})}},53876:(G,O,e)=>{"use strict";e.d(O,{X:()=>m});var t=e(74848),n=e(32196),i=e(96540),s=e(40996),r=e(40845),f=e(14578),a=e(88575),c=e(60029),o=e(67061),h=e(56034),g=e(10354),l=e(25027),p=e(32642);const m=({onFilterChange:d,defaultQueryString:v})=>{const u=(0,r.of)(y),[D,P]=(0,i.useState)(v??"");(0,s.A)(()=>{(0,l.fH)(l.le.filterByLabel),d(D)},600,[D]);const x=(0,t.jsx)(f.I,{name:"search"});let E=!!(v&&v.length>=3);try{v?(0,p.S6)(v):E=!0}catch{E=!1}return(0,t.jsx)(a.D,{className:u.fixMargin,invalid:!E,error:E?null:"Query must use valid matcher syntax. See the examples in the help tooltip.",label:(0,t.jsx)(c.J,{children:(0,t.jsxs)(o.B,{gap:.5,alignItems:"center",children:[(0,t.jsx)("span",{children:"Search by label"}),(0,t.jsx)(h.m,{content:(0,t.jsxs)("div",{children:["Filter alerts using label querying without spaces, ex:",(0,t.jsx)("pre",{children:'{severity="critical", instance=~"cluster-us-.+"}'}),"Invalid use of spaces:",(0,t.jsx)("pre",{children:'{severity= "critical"}'}),(0,t.jsx)("pre",{children:'{severity ="critical"}'}),"Valid use of spaces:",(0,t.jsx)("pre",{children:'{severity=" critical"}'}),"Filter alerts using label querying without braces, ex:",(0,t.jsx)("pre",{children:'severity="critical", instance=~"cluster-us-.+"'})]}),children:(0,t.jsx)(f.I,{name:"info-circle",size:"sm"})})]})}),children:(0,t.jsx)(g.p,{placeholder:"Search",value:D,onChange:C=>P(C.currentTarget.value),"data-testid":"search-query-input",prefix:x,className:u.inputWidth})})},y=d=>({fixMargin:(0,n.css)({marginBottom:0}),inputWidth:(0,n.css)({width:340,flexGrow:0})})},56528:(G,O,e)=>{"use strict";e.d(O,{GX:()=>U,r4:()=>A});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(96540),f=e(49785),a=e(39070),c=e(19845),o=e(72724),h=e(40845),g=e(42418),l=e(67061),p=e(55852),m=e(51440),y=e(29158),d=e(98808),v=e(71680),u=e(1712),D=e(34263),P=e(18225),x=e(76658),E=e(66718),C=e(94822),M=e(98439),S=e(35108),I=e(26058),T=e(30423),b=e(81875),R=e(99106);const A=({queries:H=[],query:X,data:k,error:Y,warning:Z,isAlertCondition:se,onSetCondition:j,onUpdateRefId:q,onRemoveExpression:ne,onUpdateExpressionType:oe,onChangeQuery:z})=>{const te=(0,h.of)(K),le=X?.type,{setError:ie,clearErrors:ae}=(0,f.xW)(),re=(0,r.useCallback)(Be=>{Be?ie("queries",{type:"custom",message:Be}):ae("queries")},[ie,ae]),ce=k&&Object.values(k).some(Be=>!!Be&&Be.state===a.Gu.Loading),me=Array.isArray(k?.series)&&!ce,ee=k?.series??[],de=se??!1,{seriesCount:De,groupedByState:fe}=w(ee),Te=(0,r.useCallback)(Be=>{const Ne=H.filter(Re=>Be.refId!==Re.refId).map(Re=>({value:Re.refId,label:Re.refId}));switch(Be.type){case E.Tz.math:return(0,t.jsx)(v.z,{onChange:z,query:Be,labelWidth:"auto",onRunQuery:()=>{}});case E.Tz.reduce:return(0,t.jsx)(u.Z,{onChange:z,refIds:Ne,labelWidth:"auto",query:Be});case E.Tz.resample:return(0,t.jsx)(D.C,{onChange:z,query:Be,labelWidth:"auto",refIds:Ne});case E.Tz.classic:return(0,t.jsx)(d.z,{onChange:z,query:Be,refIds:Ne});case E.Tz.threshold:return(0,t.jsx)(x.O,{onChange:z,query:Be,labelWidth:"auto",refIds:Ne,onError:re,useHysteresis:!0});case E.Tz.sql:return(0,t.jsx)(P.k,{onChange:z,query:Be,refIds:Ne});default:return(0,t.jsxs)(t.Fragment,{children:["Expression not supported: ",Be.type]})}},[z,H,re]),He=E.uQ.find(Be=>Be.value===le)?.description??"";return(0,t.jsx)("div",{className:(0,n.cx)(te.expression.wrapper,de&&te.expression.alertCondition,le===E.Tz.classic&&te.expression.classic,le!==E.Tz.classic&&te.expression.nonClassic),children:(0,t.jsxs)("div",{className:te.expression.stack,children:[(0,t.jsx)(N,{refId:X.refId,queryType:le,onRemoveExpression:()=>ne(X.refId),onUpdateRefId:Be=>q(X.refId,Be),onUpdateExpressionType:Be=>oe(X.refId,Be),onSetCondition:j,query:X,alertCondition:de}),(0,t.jsxs)("div",{className:te.expression.body,children:[Y&&(0,t.jsx)(g.F,{title:"Expression failed",severity:"error",children:Y.message}),Z&&(0,t.jsx)(g.F,{title:"Expression warning",severity:"warning",children:Z.message}),(0,t.jsx)("div",{className:te.expression.description,children:He}),Te(X)]}),me&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(U,{series:ee,isAlertCondition:se}),(0,t.jsx)("div",{className:te.footer,children:(0,t.jsxs)(l.B,{direction:"row",alignItems:"center",children:[(0,t.jsx)(I.h,{}),(0,t.jsx)(W,{isCondition:!!se,firing:fe[C.cF.Firing].length,normal:fe[C.cF.Inactive].length,seriesCount:De})]})})]})]})})},L=20,U=({series:H,isAlertCondition:X})=>{const{pageItems:k,previousPage:Y,nextPage:Z,numberOfPages:se,pageStart:j,pageEnd:q}=(0,M.W)(H,1,L),ne=(0,h.of)(K),oe=(0,R.PI)(H),z=!oe&&(0,c.jq)(H),te=se>1;return(0,t.jsxs)("div",{className:ne.expression.results,children:[!oe&&z&&(0,t.jsx)("div",{children:k.map((le,ie)=>(0,t.jsx)(V,{frame:le,index:j+ie,isAlertCondition:X},(0,i.uniqueId)()))}),!oe&&!z&&k.map((le,ie)=>(0,t.jsx)(B,{frame:le,index:j+ie,isAlertCondition:X},(0,i.uniqueId)())),oe&&(0,t.jsx)("div",{className:(0,n.cx)(ne.expression.noData,ne.mutedText),children:"No data"}),te&&(0,t.jsx)("div",{className:ne.pagination.wrapper,"data-testid":"paginate-expression",children:(0,t.jsxs)(l.B,{children:[(0,t.jsx)(p.$n,{variant:"secondary",fill:"outline",onClick:Y,icon:"angle-left",size:"sm","aria-label":"previous-page"}),(0,t.jsx)(I.h,{}),(0,t.jsxs)("span",{className:ne.mutedText,children:[j," - ",q," of ",H.length]}),(0,t.jsx)(I.h,{}),(0,t.jsx)(p.$n,{variant:"secondary",fill:"outline",onClick:Z,icon:"angle-right",size:"sm","aria-label":"next-page"})]})})]})},W=({firing:H,normal:X,isCondition:k,seriesCount:Y})=>{const{mutedText:Z}=(0,h.of)(K);return Y===0?(0,t.jsx)("span",{className:Z,children:"No series"}):k?(0,t.jsx)("span",{className:Z,children:`${Y} series: ${H} firing, ${X} normal`}):(0,t.jsx)("span",{className:Z,children:`${Y} series`})};function w(H){const X=H.filter(Z=>(0,R.Lm)(Z)===void 0).length,k={[C.cF.Firing]:H.filter(Z=>(0,R.Lm)(Z)!==void 0&&(0,R.Lm)(Z)!==0),[C.cF.Inactive]:H.filter(Z=>(0,R.Lm)(Z)===0)},Y=H.length-X;return{groupedByState:k,seriesCount:Y}}const N=({refId:H,queryType:X,onUpdateRefId:k,onRemoveExpression:Y,onSetCondition:Z,alertCondition:se,query:j})=>{const q=(0,h.of)(K),ne=(0,h.of)(p.my),[oe,z]=(0,r.useState)(!1),le=oe!==!1&&oe==="refId";return(0,t.jsx)("header",{className:q.header.wrapper,children:(0,t.jsxs)(l.B,{direction:"row",gap:.5,alignItems:"center",children:[(0,t.jsxs)(l.B,{direction:"row",gap:1,alignItems:"center",children:[!le&&(0,t.jsx)("button",{type:"button",className:(0,n.cx)(ne,q.editable),onClick:()=>z("refId"),children:(0,t.jsx)("div",{className:q.expression.refId,children:H})}),le&&(0,t.jsx)(m.D,{autoFocus:!0,defaultValue:H,minWidth:5,onChange:ie=>{k(ie.currentTarget.value),z(!1)},onFocus:ie=>ie.target.select(),onBlur:ie=>{k(ie.currentTarget.value),z(!1)}}),(0,t.jsx)("div",{children:(0,E.NI)(X)})]}),(0,t.jsx)(I.h,{}),(0,t.jsx)(b.a,{onSetCondition:()=>Z(j.refId),isCondition:se}),(0,t.jsx)(y.K,{name:"trash-alt",variant:"secondary",className:q.mutedIcon,onClick:Y,tooltip:"Remove expression"})]})})},B=({frame:H,index:X,isAlertCondition:k})=>{const Y=(0,h.of)(K),Z=(0,R.Jw)(H)||"Series "+X,se=(0,R.Lm)(H),j=(0,R.JQ)(H),q=Object.entries(j),ne=q.length>0,oe=k&&se!==0,z=k&&se===0,te=`${ne?"":Z}${ne?`{${(0,R.h6)(j)}}`:""}`;return(0,t.jsx)("div",{className:Y.expression.resultsRow,children:(0,t.jsxs)(l.B,{direction:"row",gap:1,alignItems:"center",children:[(0,t.jsxs)("div",{className:Y.expression.resultLabel,title:te,children:[(0,t.jsx)("span",{children:ne?"":Z}),ne&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{children:"{"}),q.map(([le,ie],ae)=>(0,t.jsxs)("span",{children:[(0,t.jsx)("span",{className:Y.expression.labelKey,children:le}),(0,t.jsx)("span",{children:"="}),(0,t.jsx)("span",{children:'"'}),(0,t.jsx)("span",{className:Y.expression.labelValue,children:ie}),(0,t.jsx)("span",{children:'"'}),ae<q.length-1&&(0,t.jsx)("span",{children:", "})]},(0,i.uniqueId)())),(0,t.jsx)("span",{children:"}"})]})]}),(0,t.jsx)("div",{className:Y.expression.resultValue,children:se}),oe&&(0,t.jsx)(T.C,{state:C.cF.Firing,size:"sm"}),z&&(0,t.jsx)(T.C,{state:C.cF.Inactive,size:"sm"})]})})},V=({frame:H,index:X})=>{const k=(0,h.of)(K),Y=H.fields[1],Z=Y.labels,j=Y.config?.displayNameFromDS??(Z?(0,R.h6)(Y.labels??{}):"Series "+X),q=H.fields[0].values,ne=z=>H.fields[0].values[z],oe=z=>H.fields[1].values[z];return(0,t.jsx)("div",{className:k.expression.resultsRow,children:(0,t.jsxs)(l.B,{direction:"row",alignItems:"center",children:[(0,t.jsx)("span",{className:(0,n.cx)(k.mutedText,k.expression.resultLabel),title:j,children:j}),(0,t.jsx)("div",{className:k.expression.resultValue,children:(0,t.jsx)(S.j,{placement:"right",wrapperClassName:k.timeseriesTableWrapper,content:(0,t.jsxs)("table",{className:k.timeseriesTable,children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Timestamp"}),(0,t.jsx)("th",{children:"Value"})]})}),(0,t.jsx)("tbody",{children:q.map((z,te)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:k.mutedText,children:(0,o.LE)(ne(te))}),(0,t.jsx)("td",{className:k.expression.resultValue,children:oe(te)})]},te))})]}),children:(0,t.jsx)("span",{children:"Time series data"})})})]})})},K=H=>({expression:{wrapper:(0,n.css)({display:"flex",border:`solid 1px ${H.colors.border.medium}`,flex:1,flexBasis:"400px",borderRadius:H.shape.radius.default}),stack:(0,n.css)({display:"flex",flexDirection:"column",flexWrap:"nowrap",gap:0,width:"100%",minWidth:"0"}),classic:(0,n.css)({maxWidth:"100%"}),nonClassic:(0,n.css)({maxWidth:"640px"}),alertCondition:(0,n.css)({}),body:(0,n.css)({padding:H.spacing(1),flex:1}),description:(0,n.css)({marginBottom:H.spacing(1),fontSize:H.typography.size.xs,color:H.colors.text.secondary}),refId:(0,n.css)({fontWeight:H.typography.fontWeightBold,color:H.colors.primary.text}),results:(0,n.css)({display:"flex",flexDirection:"column",flexWrap:"nowrap",borderTop:`solid 1px ${H.colors.border.medium}`}),noResults:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"center"}),resultsRow:(0,n.css)({padding:`${H.spacing(.75)} ${H.spacing(1)}`,"&:nth-child(odd)":{backgroundColor:H.colors.background.secondary},"&:hover":{backgroundColor:H.colors.background.canvas}}),labelKey:(0,n.css)({color:H.isDark?"#73bf69":"#56a64b"}),labelValue:(0,n.css)({color:H.isDark?"#ce9178":"#a31515"}),resultValue:(0,n.css)({textAlign:"right"}),resultLabel:(0,n.css)({flex:1,overflowX:"auto",display:"inline-block",whiteSpace:"nowrap"}),noData:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"center",padding:H.spacing()})},mutedText:(0,n.css)({color:H.colors.text.secondary,fontSize:"0.9em",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}),header:{wrapper:(0,n.css)({background:H.colors.background.secondary,padding:`${H.spacing(.5)} ${H.spacing(1)}`,borderBottom:`solid 1px ${H.colors.border.weak}`})},footer:(0,n.css)({background:H.colors.background.secondary,padding:H.spacing(1),borderTop:`solid 1px ${H.colors.border.weak}`}),draggableIcon:(0,n.css)({cursor:"grab"}),mutedIcon:(0,n.css)({color:H.colors.text.secondary}),editable:(0,n.css)({padding:`${H.spacing(.5)} ${H.spacing(1)}`,border:`solid 1px ${H.colors.border.weak}`,borderRadius:H.shape.radius.default,display:"flex",flexDirection:"row",alignItems:"center",gap:H.spacing(1),cursor:"pointer"}),timeseriesTableWrapper:(0,n.css)({maxHeight:"500px",overflowY:"scroll"}),timeseriesTable:(0,n.css)({tableLayout:"auto",width:"100%",height:"100%","td, th":{padding:H.spacing(1)},td:{background:H.colors.background.primary},th:{background:H.colors.background.secondary},tr:{borderBottom:`1px solid ${H.colors.border.medium}`,"&:last-of-type":{borderBottom:"none"}}}),pagination:{wrapper:(0,n.css)({borderTop:`1px solid ${H.colors.border.medium}`,padding:H.spacing()})}})},81875:(G,O,e)=>{"use strict";e.d(O,{a:()=>f});var t=e(74848),n=e(32196),i=e(40845),s=e(39938),r=e(55852);const f=({isCondition:c,onSetCondition:o})=>{const h=(0,i.of)(a);return c?(0,t.jsx)(s.E,{color:"green",icon:"check",text:"Alert condition"},"condition"):(0,t.jsx)("button",{type:"button",className:h.actionLink,onClick:()=>o&&o(),children:"Set as alert condition"},"make-condition")},a=c=>{const o=(0,r.my)(c);return{actionLink:(0,n.css)(o,{color:c.colors.text.link,cursor:"pointer","&:hover":{textDecoration:"underline"}})}}},99106:(G,O,e)=>{"use strict";e.d(O,{EL:()=>o,JQ:()=>a,Jw:()=>r,Lm:()=>f,PI:()=>g,h6:()=>c,wf:()=>h});var t=e(2543),n=e.n(t),i=e(97706),s=e(57220);const r=l=>{const p=l.fields[0];return p?.config?.displayNameFromDS??l.name??p?.labels?.__name__},f=l=>{const p=l.fields[0]?.values[0];return Number.isFinite(p)?(0,i.h)(p,5):p},a=l=>l.fields[0]?.labels??{},c=l=>Object.entries(l).map(([p,m])=>p+"="+m).join(", "),o=l=>{const p=l.name;if((0,s.Eb)(l.rulesSource))return{name:p,parents:[]};try{const m=JSON.parse(p);if(!Array.isArray(m))throw new Error("not a nested Grafana folder");const y=(0,t.last)(m)??p,d=(0,t.dropRight)(m,1);return{name:y,parents:d}}catch{return{name:l.name,parents:[]}}},h=(l,p=[])=>JSON.stringify(p.concat(l)),g=l=>l.every(m=>m.fields.every(y=>y.values.every(d=>d==null)))},83225:(G,O,e)=>{"use strict";e.r(O),e.d(O,{AlertmanagerTemplateFunction:()=>n,availableAlertManagerFunctions:()=>i,builtinFunctions:()=>r,conf:()=>c,keywords:()=>f,language:()=>a});var t=(o=>(o.Delimiter="delimiter",o.Keyword="keyword",o.Function="type.identifier",o.String="string",o.Variable="variable.name",o.Number="number",o.Comment="comment",o.Operator="operator",o.Identifier="idenfifier",o))(t||{}),n=(o=>(o.toUpper="toUpper",o.toLower="toLower",o.title="title",o.join="join",o.match="match",o.safeHtml="safeHtml",o.reReplaceAll="reReplaceAll",o.stringSlice="stringSlice",o))(n||{});const i=Object.values(n),r=["and","call","html","index","slice","js","len","not","or","print","printf","println","urlquery",...["eq","ne","lt","le","gt","ge"]],f=["define","if","else","end","range","break","continue","template","block","with"],a={defaultToken:"",keywords:f,functions:[...r,...i],operators:["|"],tokenizer:{root:[[/"/,"string","@string"],[/`/,"string","@rawstring"],[/\d*\d+[eE]([\-+]?\d+)?/,"number.float"],[/\d*\.\d+([eE][\-+]?\d+)?/,"number.float"],[/0[xX][0-9a-fA-F']*[0-9a-fA-F]/,"number.hex"],[/0[0-7']*[0-7]/,"number.octal"],[/0[bB][0-1']*[0-1]/,"number.binary"],[/\d[\d']*/,"number"],[/\d/,"number"],[/[;,.]/,"delimiter"],[/{{-?/,"delimiter"],[/-?}}/,"delimiter"],[/\.([A-Za-z]+)?/,"variable.name"],[/[a-zA-Z_]\w*/,{cases:{"@keywords":{token:"keyword"},"@functions":{token:"type.identifier"},"@default":"idenfifier"}}],[/\/\*.*\*\//,"comment"]],string:[[/[^\\"]+/,"string"],[/\\./,"string.escape.invalid"],[/"/,"string","@pop"]],rawstring:[[/[^\`]/,"string"],[/`/,"string","@pop"]]}},c={comments:{blockComment:["/*","*/"]},brackets:[["{{","}}"],["(",")"]],autoClosingPairs:[{open:"{{",close:"}}"},{open:"(",close:")"},{open:"`",close:"`"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{{",close:"}}"},{open:"(",close:")"},{open:"`",close:"`"},{open:'"',close:'"'},{open:"'",close:"'"}]}},37534:(G,O,e)=>{"use strict";e.d(O,{FI:()=>t,J4:()=>n,p8:()=>s});const t="grafana_alerting";var n=(r=>(r.OnCall="oncall",r))(n||{});const i=(r,f)=>f.includes(r),s=(r,f)=>{if(!r.grafana_managed_receiver_configs)return!1;const a=r.grafana_managed_receiver_configs.length===1,c=i(r.grafana_managed_receiver_configs[0]?.settings?.url??"",f.map(o=>o.integration_url));return a&&c}},74685:(G,O,e)=>{"use strict";e.d(O,{j:()=>h});var t=e(74848),n=e(32196),i=e(70713),s=e(19845),r=e(40845),f=e(28138),a=e(72519),c=e(56528),o=e(7921);const h=({data:l,thresholds:p,thresholdsType:m})=>{const y=(0,r.of)(g),d=(0,s.jq)(l.series),v=(0,o.yW)(l),u=m?{mode:m}:void 0,D={from:l.timeRange.from.valueOf(),to:l.timeRange.to.valueOf()};return(0,t.jsx)("div",{className:y.wrapper,children:(0,t.jsx)(i.Ay,{disableHeight:!0,children:({width:P})=>(0,t.jsx)("div",{style:{width:P},children:d?(0,t.jsx)(a.y,{statusMessage:v,data:l.series,eventBus:f.A,height:300,width:P,absoluteRange:D,timeZone:"browser",onChangeTime:()=>{},splitOpenFn:()=>{},loadingState:l.state,thresholdsConfig:p,thresholdsStyle:u}):(0,t.jsxs)("div",{className:y.instantVectorResultWrapper,children:[(0,t.jsx)("header",{className:y.title,children:"Table"}),(0,t.jsx)(c.GX,{series:l.series})]})})})})},g=l=>({wrapper:(0,n.css)({width:"100%",position:"relative"}),instantVectorResultWrapper:(0,n.css)({border:`solid 1px ${l.colors.border.medium}`,borderRadius:l.shape.radius.default,padding:0,display:"flex",flexDirection:"column",flexWrap:"nowrap"}),title:(0,n.css)({label:"panel-title",padding:l.spacing(),textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontSize:l.typography.h6.fontSize,fontWeight:l.typography.h6.fontWeight})})},7921:(G,O,e)=>{"use strict";e.d(O,{G0:()=>C,zy:()=>M,lb:()=>S,YG:()=>L,yW:()=>R,an:()=>T,I3:()=>P,xb:()=>E,_u:()=>A,yr:()=>I});var t=e(2543),n=e(19845),i=e(50082),s=e(39070),r=e(52622),f=e(2913),a=e(55907),c=e(69437),o=e(66718),h=e(86590),g=e(41811),l=e(34525);const p=(0,g.A)(m,(U,W)=>D(U[0])===D(W[0]));function m(U){const W=new l.TS,w=U.map(N=>N.refId);return W.createNodes(w),U.forEach(N=>{const B=N.refId;((0,c.f)(N.model)&&N.model.type==="math"?y(N.model.expression??""):[N.model.expression]).forEach(H=>{B&&H&&!(B===H)&&W.link(H,B)})}),W}function y(U){const W=new RegExp(/\$\{(?<var>[a-zA-Z0-9_ ]+?)\}/gm),w=new RegExp(/\$(?<var>[a-zA-Z0-9_]+)/gm),N=Array.from(U.matchAll(W)).map(V=>V.groups?.var),B=Array.from(U.matchAll(w)).map(V=>V.groups?.var);return(0,t.compact)((0,t.uniq)([...N,...B]))}const d=(0,t.memoize)(v,(U,W)=>U+u(W));function v(U,W){const w=W.getNode(U);let N=[];function B(V){const K=V.inputEdges;K.length>0?K.forEach(H=>{H.inputNode&&B(H.inputNode)}):N?.push(V)}return B(w),N.map(V=>V.name)}function u(U){return Object.keys(U.nodes).map(W=>{const w=U.nodes[W];let N=w.outputEdges.map(V=>V.outputNode?.name).join(", "),B=w.inputEdges.map(V=>V.inputNode?.name).join(", ");return`${w.name}:${N}:${B}`}).join(" ")}function D(U){return U.map(W=>{const w=(0,c.f)(W.model)?W.model.type:W.queryType;return W.refId+(W.model.expression??"")+w}).join()}function P(U,W,w){return U.map(N=>{if(W===w||!(0,c.f)(N.model))return N;const B=N.model.type==="math",V=N.model.type==="reduce",K=N.model.type==="resample",H=N.model.type==="classic_conditions",X=N.model.type==="threshold";if(B)return{...N,model:{...N.model,expression:x(N.model.expression??"",W,w)}};if(K||V||X){const k=N.model.expression===W;return{...N,model:{...N.model,expression:k?w:N.model.expression}}}if(H){const k=N.model.conditions?.map(Y=>({...Y,query:{...Y.query,params:Y.query.params.map(Z=>Z===W?w:Z)}}));return{...N,model:{...N.model,conditions:k}}}return N})}function x(U,W,w){const N=new RegExp("(\\$"+W+"\\b)|(\\${"+W+"})","gm"),B="${"+w+"}";return U.replace(N,B)}function E(U,W){return U.find(w=>w.refId===W)!==void 0}function C(U){return U.includes("/")||U.includes("\\")?'Cannot contain "/" or "\\" characters':!0}function M(U){if(U.series.length===0)return;const W=(0,n.jq)(U.series);let w;return W&&(w=new Error("You cannot use time series data as an alert condition, consider adding a reduce expression.")),w}function S(U){if(U.errors?.length)return new Error(U.errors[0].message)}function I(U){const w=(U[0]?.meta?.notices??[]).find(N=>N.severity==="warning")?.text;return w?new Error(w):void 0}function T(U,W){const w={},N=[o.Tz.threshold,o.Tz.classic];if(!W)return w;for(const K of U){if(!(0,c.f)(K.model)||!N.includes(K.model.type)||!Array.isArray(K.model.conditions)||K.model.refId!==W)continue;const H=K.model.conditions.some(b);K.model.conditions.forEach(X=>{const k=X.evaluator.params,Y=X.query?.params[0]??K.model.expression;if(!Y)return;const Z=b(X);try{const se=p(U),j=d(Y,se);U.filter(ne=>j.includes(ne.refId)).forEach(ne=>{const oe=ne.refId,te=!!(!(0,c.f)(ne?.model)&&oe);oe&&!w[oe]&&(w[oe]={config:{mode:i.O.Absolute,steps:[]},mode:r.Ly.Line}),oe&&te&&!Z&&!H?B(oe,k[0]):oe&&te&&Z&&(V(oe,k,X.evaluator.type),w[oe].mode=r.Ly.LineAndArea)})}catch(se){console.error("Failed to parse thresholds",se);return}})}function B(K,H){w[K].config.steps.push({value:-1/0,color:"transparent"},{value:H,color:f.config.theme2.colors.error.main})}function V(K,H,X){X===a.p.IsWithinRange&&w[K].config.steps.push({value:-1/0,color:"transparent"},{value:H[0],color:f.config.theme2.colors.error.main},{value:H[1],color:f.config.theme2.colors.error.main},{value:H[1],color:"transparent"}),X===a.p.IsOutsideRange&&w[K].config.steps.push({value:-1/0,color:f.config.theme2.colors.error.main},{value:H[0],color:f.config.theme2.colors.error.main},{value:H[0],color:"transparent"},{value:H[1],color:f.config.theme2.colors.error.main}),w[K].config.steps.sort((k,Y)=>k.value-Y.value),w[K].config.steps=w[K].config.steps.filter(k=>k.value!==void 0)}return w}function b(U){return U.evaluator.type===a.p.IsWithinRange||U.evaluator.type===a.p.IsOutsideRange}function R(U){const W="Failed to fetch data";if(U.state!==s.Gu.Error)return;const w=U.errors;return w?.length?w.map(N=>N.message??W).join(", "):U.error?.message??W}function A(U=""){return U==="recording"?h.Z.cloudRecording:h.Z.grafana}function L(U,W){const w=W.filter(K=>!(0,c.f)(K.model)).map(K=>K.refId),N=U.filter(K=>!(0,c.f)(K.model)).map(K=>K.refId),[B,V]=(0,t.xor)(N,w);return[B,V]}},13064:(G,O,e)=>{"use strict";e.d(O,{C:()=>a});var t=e(87836),n=e(72880),i=e(70416),s=e(47232),r=e(72724),f=e(25968);function a(o,h){if(!o||!h||!(0,i.vd)(o))return;let g;try{g=(0,f.M9)(h)}catch{return}if((0,f.mo)(o))return;const l=Date.parse(o||""),p=(0,t.A)(l,g);return(0,n.Y)(p,new Date)?{humanized:`within ${h}`,fullDate:`within ${h}`}:{humanized:`in ${(0,s.KQ)(p).locale("en").fromNow(!0)}`,fullDate:(0,r.LE)(p,{format:"YYYY-MM-DD HH:mm:ss"})}}function c(o){if(!o)return null;if(!isNullDate(o))return formatDistanceToNowStrict(new Date(o))}},5179:(G,O,e)=>{"use strict";e.d(O,{K:()=>s,k:()=>r});var t=e(74848),n=e(96540);const i=n.createContext(void 0),s=({children:f,rule:a,identifier:c})=>{const o={rule:a,identifier:c};return(0,t.jsx)(i.Provider,{value:o,children:f})},r=()=>{const f=n.useContext(i);if(f===void 0)throw new Error("useAlertRule must be used within a AlertRuleContext");return f}},39890:(G,O,e)=>{"use strict";e.d(O,{gQ:()=>yt,Ay:()=>$t,lf:()=>Un,P5:()=>Nn});var t=e(74848),n=e(32196),i=e(2543),s=e(96540),r=e(67061),f=e(42418),a=e(40980),c=e(72109),o=e(94753),h=e(40845),g=e(55852),l=e(83277),p=e(93810),m=e(35896),y=e(54317),d=e(94822),v=e(79741),u=e(85244),D=e(55740),P=e(56361),x=e(23662),E=e(3704),C=e(69087),M=e(37959),S=e(48205),I=e(96636),T=e(99106),b=e(51921);function R(){return(0,t.jsx)(f.F,{severity:"info",title:"This rule is part of a federated rule group.",bottomSpacing:0,topSpacing:2,children:(0,t.jsxs)(r.B,{direction:"column",children:["Federated rule groups are currently an experimental feature.",(0,t.jsx)(g.$n,{fill:"text",icon:"book",children:(0,t.jsx)("a",{href:"https://grafana.com/docs/metrics-enterprise/latest/tenant-management/tenant-federation/#cross-tenant-alerting-and-recording-rule-federation",children:"Read documentation"})})]})})}var A=e(14578);function L(){return(0,t.jsx)(o.E,{variant:"bodySmall",color:"warning",children:(0,t.jsxs)(r.B,{direction:"row",alignItems:"center",gap:.25,wrap:"nowrap",flex:"0 0 auto",children:[(0,t.jsx)(A.I,{name:"pause",size:"xs"})," Paused"]})})}var U=e(5179);const W=et=>{const Et=(0,h.of)(w,et);return(0,t.jsx)(r.B,{direction:"row",gap:.5,children:(0,t.jsx)("div",{className:Et.dot})})},w=(et,Et)=>{const It=et.spacing(1.25),Qt=`calc(${It} / 2.5)`,sn=Et.color==="error",ln=Et.color==="success",yn=Et.color==="warning";return{dot:(0,n.css)({width:It,height:It,borderRadius:"100%",backgroundColor:et.colors.secondary.main,outline:`solid ${Qt} ${et.colors.secondary.transparent}`,margin:Qt},ln&&(0,n.css)({backgroundColor:et.colors.success.main,outlineColor:et.colors.success.transparent}),yn&&(0,n.css)({backgroundColor:et.colors.warning.main,outlineColor:et.colors.warning.transparent}),sn&&(0,n.css)({backgroundColor:et.colors.error.main,outlineColor:et.colors.error.transparent}))}},N=({health:et})=>{const Et=Un(et),It=Et?"error":"success",Qt=Et?"Recording error":"Recording";return(0,t.jsx)(V,{color:It,text:Qt})},B=({state:et,health:Et})=>{let It,Qt;switch(et){case d.cF.Inactive:Qt="success",It="Normal";break;case d.cF.Firing:Qt="error",It="Firing";break;case d.cF.Pending:Qt="warning",It="Pending";break}return Un(Et)&&(Qt="error",It="Error"),Et==="nodata"&&(Qt="warning",It="No data"),(0,t.jsx)(V,{color:Qt,text:It})};function V({color:et,text:Et}){return(0,t.jsxs)(r.B,{direction:"row",gap:.5,wrap:"nowrap",flex:"0 0 auto",children:[(0,t.jsx)(W,{color:et}),(0,t.jsx)(o.E,{variant:"bodySmall",color:et,children:Et})]})}var K=e(50509),H=e(32264),X=e(46013);const k=(0,s.lazy)(()=>e.e(7409).then(e.bind(e,87409))),Y=(0,s.lazy)(()=>e.e(285).then(e.bind(e,285))),Z=({rule:et})=>{const Et=H.$.unifiedAlerting.alertStateHistoryBackend,It=H.$.unifiedAlerting.alertStateHistoryPrimary,sn=[Et,It].some(Sn=>Sn===X.Q.Loki)?X.Q.Loki:X.Q.Annotations,ln=et.grafana_alert.id??"",yn=et.grafana_alert.uid;return(0,t.jsxs)(s.Suspense,{fallback:"Loading...",children:[sn===X.Q.Loki&&(0,t.jsx)(Y,{ruleUID:yn}),sn===X.Q.Annotations&&(0,t.jsx)(k,{alertId:ln})]})};var se=e(15054),j=e(99938);const q=({rule:et})=>(0,t.jsx)(j.s,{rule:et,pagination:{itemsPerPage:se.FG},enableFiltering:!0});var ne=e(24120),oe=e(39070),z=e(76885),te=e(65879),le=e(11807),ie=e(66602),ae=e(39938),re=e(69437),ce=e(66718),me=e(55907),ee=e(26058),de=e(56528),De=e(7921),fe=e(74685);function Te({data:et,thresholds:Et}){return et?(0,t.jsx)(fe.j,{data:et,thresholds:Et?.config,thresholdsType:Et?.mode}):null}var je=e(20382),He=e(57220),Be=e(63066),Ne=e(85828);const Re=({expression:et})=>(0,t.jsx)(Ne.m,{options:{readOnly:!0,minimap:{enabled:!1},scrollBeyondLastColumn:0,scrollBeyondLastLine:!1,lineNumbers:"off",cursorWidth:0,overviewRulerLanes:0},defaultLanguage:"sql",height:80,defaultValue:et,width:"100%"});function Se(et){return"rawSql"in et}const We=null,Ke=s.lazy(()=>e.e(8468).then(e.bind(e,58468))),Xe=s.lazy(()=>e.e(7011).then(e.bind(e,67011)));function Je({model:et,dataSource:Et}){return Et.type===He.ol.Prometheus&&(0,Be.Bu)(et)?(0,t.jsx)(Ke,{query:et.expr}):Et.type===He.ol.Loki&&(0,Be.Bu)(et)?(0,t.jsx)(Xe,{query:et.expr??""}):Se(et)?(0,t.jsx)(Re,{expression:et.rawSql}):(0,t.jsx)("pre",{children:(0,t.jsx)("code",{children:(0,je.Bh)(et)})})}var st=e(19073);function pt({rule:et,queries:Et,condition:It,evalDataByQuery:Qt={}}){const sn=(0,i.keyBy)(Object.values(H.$.datasources),wn=>wn.uid),ln=Et.filter(wn=>!(0,re.f)(wn.model)),yn=Et.filter(wn=>(0,re.f)(wn.model)),Sn=(0,h.of)(at),En=(0,De.an)(Et,It);return(0,t.jsxs)(r.B,{gap:1,direction:"column",flex:"1 1 320px",children:[(0,t.jsx)("div",{className:Sn.maxWidthContainer,children:(0,t.jsx)(r.B,{gap:1,wrap:"wrap","data-testid":"queries-container",children:ln.map(({model:wn,relativeTimeRange:On,refId:Rt,datasourceUid:Ot},jt)=>{const rt=sn[Ot];return(0,t.jsx)(xt,{rule:et,refId:Rt,isAlertCondition:It===Rt,model:wn,relativeTimeRange:On,dataSource:rt,thresholds:En[Rt],queryData:Qt[Rt]},jt)})})}),(0,t.jsx)("div",{className:Sn.maxWidthContainer,children:(0,t.jsx)(r.B,{gap:1,wrap:"wrap","data-testid":"expressions-container",children:yn.map(({model:wn,refId:On,datasourceUid:Rt},Ot)=>{const jt=sn[Rt];return(0,re.f)(wn)&&(0,t.jsx)(be,{refId:On,isAlertCondition:It===On,model:wn,dataSource:jt,evalData:Qt[On]},Ot)})})})]})}function xt({refId:et,rule:Et,thresholds:It,model:Qt,dataSource:sn,queryData:ln,relativeTimeRange:yn}){const Sn=(0,h.of)(ve),En=(0,re.f)(Qt),[wn,On]=(0,st.mh)(Et,st.j5.Explore),Rt=wn&&On,Ot=[];if(sn){const rt=sn.name??"[[Data source not found]]",tn=sn.meta.info.logos.small;Ot.push((0,t.jsx)($e,{name:rt,imgUrl:tn},"datasource"))}yn&&Ot.push((0,t.jsxs)(o.E,{color:"secondary",children:[(0,te.secondsToHms)(yn.from)," to now"]},"timerange"));let jt;return!En&&Rt&&(jt=sn&&ot(sn,Qt)),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(he,{refId:et,headerItems:Ot,exploreLink:jt,children:(0,t.jsx)("div",{className:Sn.queryPreviewWrapper,children:(0,t.jsx)(ie.Xw,{children:Qt&&sn&&(0,t.jsx)(Je,{model:Qt,dataSource:sn})})})}),sn&&(0,t.jsx)(Te,{data:ln,thresholds:It})]})}function ot(et,Et){const{uid:It,type:Qt}=et,{refId:sn,...ln}=Et;return z.kM.renderUrl(`${H.$.appSubUrl}/explore`,{left:JSON.stringify({datasource:et.uid,queries:[{refId:"A",...ln,datasource:{type:Qt,uid:It}}],range:{from:"now-1h",to:"now"}})})}function $e({name:et,imgUrl:Et}){const It=(0,h.of)(ve);return(0,t.jsxs)("div",{className:It.dataSource,children:[(0,t.jsx)("img",{src:Et,width:16,alt:et}),et]},"datasource")}const ve=et=>({queryPreviewWrapper:(0,n.css)({margin:et.spacing(1)}),contentBox:(0,n.css)({flex:"1 0 100%"}),visualization:(0,n.css)({padding:et.spacing(1)}),dataSource:(0,n.css)({border:`1px solid ${et.colors.border.weak}`,borderRadius:et.shape.radius.default,padding:et.spacing(.5,1),display:"flex",alignItems:"center",gap:et.spacing(1)})});function be({refId:et,model:Et,evalData:It,isAlertCondition:Qt}){function sn(){switch(Et.type){case ce.Tz.math:return(0,t.jsx)(ft,{model:Et});case ce.Tz.reduce:return(0,t.jsx)(xe,{model:Et});case ce.Tz.resample:return(0,t.jsx)(Ee,{model:Et});case ce.Tz.classic:return(0,t.jsx)(Pe,{model:Et});case ce.Tz.threshold:return(0,t.jsx)(Qe,{model:Et});case ce.Tz.sql:return(0,t.jsx)(le.l,{rawSql:Et.expression||"",datasourceType:Et.datasource?.type});default:return(0,t.jsxs)(t.Fragment,{children:["Expression not supported: ",Et.type]})}}return(0,t.jsxs)(he,{refId:et,headerItems:[(0,t.jsx)(o.E,{color:"secondary",children:(0,i.startCase)(Et.type)},"expression-type")],isAlertCondition:Qt,children:[sn(),(0,t.jsx)(ee.h,{}),It&&(0,t.jsx)(de.GX,{series:It.series,isAlertCondition:Qt})]})}function he({refId:et,headerItems:Et=[],children:It,isAlertCondition:Qt,exploreLink:sn}){const ln=(0,h.of)(ye);return(0,t.jsxs)("div",{className:(0,n.cx)(ln.container),children:[(0,t.jsxs)("header",{className:ln.header,children:[(0,t.jsx)("span",{className:ln.refId,children:et}),Et,(0,t.jsx)(ee.h,{}),Qt&&(0,t.jsx)(ae.E,{color:"green",icon:"check",text:"Alert condition"}),sn&&(0,t.jsx)(I.d,{component:(0,t.jsx)(g.z9,{size:"md",variant:"secondary",icon:"compass",href:sn,children:"View in Explore"})})]}),It]})}const ye=et=>({container:(0,n.css)({flex:"1 0 25%",border:`1px solid ${et.colors.border.weak}`,maxWidth:"100%",borderRadius:et.shape.radius.default,display:"flex",flexDirection:"column"}),header:(0,n.css)({display:"flex",alignItems:"center",gap:et.spacing(1),padding:et.spacing(1),backgroundColor:et.colors.background.secondary}),textBlock:(0,n.css)({border:`1px solid ${et.colors.border.weak}`,padding:et.spacing(.5,1),backgroundColor:et.colors.background.primary,borderRadius:et.shape.radius.default}),refId:(0,n.css)({color:et.colors.text.link,padding:et.spacing(.5,1),border:`1px solid ${et.colors.border.weak}`,borderRadius:et.shape.radius.default})});function Pe({model:et}){const Et=(0,h.of)(ge),It=(0,i.keyBy)(me.A.reducerTypes,ln=>ln.value),Qt=(0,i.keyBy)(me.A.evalOperators,ln=>ln.value),sn=(0,i.keyBy)(me.A.evalFunctions,ln=>ln.value);return(0,t.jsx)("div",{className:Et.container,children:et.conditions?.map(({query:ln,operator:yn,reducer:Sn,evaluator:En},wn)=>{const On=vt(En);return(0,t.jsxs)(s.Fragment,{children:[(0,t.jsx)("div",{className:Et.blue,children:wn===0?"WHEN":!!yn?.type&&Qt[yn?.type]?.text}),(0,t.jsx)("div",{className:Et.bold,children:Sn?.type&&It[Sn.type]?.text}),(0,t.jsx)("div",{className:Et.blue,children:"OF"}),(0,t.jsx)("div",{className:Et.bold,children:ln.params[0]}),(0,t.jsx)("div",{className:Et.blue,children:sn[En.type].text}),(0,t.jsx)("div",{className:Et.bold,children:On?`(${En.params[0]}; ${En.params[1]})`:En.params[0]})]},wn)})})}const ge=et=>({container:(0,n.css)({padding:et.spacing(1),display:"grid",gridTemplateColumns:"repeat(6, max-content)",gap:et.spacing(0,1)}),...ct(et)});function xe({model:et}){const Et=(0,h.of)(Ae),{reducer:It,expression:Qt,settings:sn}=et,ln=ce.Cu.find(En=>En.value===It),yn=sn?.mode??ce.Mt.Strict,Sn=ce.HZ.find(En=>En.value===yn);return(0,t.jsxs)("div",{className:Et.container,children:[(0,t.jsx)("div",{className:Et.label,children:"Function"}),(0,t.jsx)("div",{className:Et.value,children:ln?.label}),(0,t.jsx)("div",{className:Et.label,children:"Input"}),(0,t.jsx)("div",{className:Et.value,children:Qt}),(0,t.jsx)("div",{className:Et.label,children:"Mode"}),(0,t.jsx)("div",{className:Et.value,children:Sn?.label})]})}const Ae=et=>({container:(0,n.css)({padding:et.spacing(1),display:"grid",gap:et.spacing(.5),gridTemplateRows:"1fr 1fr",gridTemplateColumns:"repeat(4, 1fr)","> :nth-child(6)":{gridColumn:"span 3"}}),...ct(et)});function Ee({model:et}){const Et=(0,h.of)(Ie),{expression:It,window:Qt,downsampler:sn,upsampler:ln}=et,yn=ce.PN.find(En=>En.value===sn),Sn=ce.iX.find(En=>En.value===ln);return(0,t.jsxs)("div",{className:Et.container,children:[(0,t.jsx)("div",{className:Et.label,children:"Input"}),(0,t.jsx)("div",{className:Et.value,children:It}),(0,t.jsx)("div",{className:Et.label,children:"Resample to"}),(0,t.jsx)("div",{className:Et.value,children:Qt}),(0,t.jsx)("div",{className:Et.label,children:"Downsample"}),(0,t.jsx)("div",{className:Et.value,children:yn?.label}),(0,t.jsx)("div",{className:Et.label,children:"Upsample"}),(0,t.jsx)("div",{className:Et.value,children:Sn?.label})]})}const Ie=et=>({container:(0,n.css)({padding:et.spacing(1),display:"grid",gap:et.spacing(.5),gridTemplateColumns:"repeat(4, 1fr)",gridTemplateRows:"1fr 1fr"}),...ct(et)});function Qe({model:et}){const Et=(0,h.of)(at),{expression:It,conditions:Qt}=et,sn=Qt&&Qt[0]?.evaluator,ln=ce.zd.find(On=>On.value===sn?.type),yn=sn?vt(sn):!1,Sn=Qt&&Qt[0]?.unloadEvaluator,En=ce.zd.find(On=>On.value===Sn?.type),wn=Sn?vt(Sn):!1;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:Et.container,children:[(0,t.jsx)("div",{className:Et.label,children:"Input"}),(0,t.jsx)("div",{className:Et.value,children:It}),sn&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:Et.blue,children:ln?.label}),(0,t.jsx)("div",{className:Et.bold,children:yn?`(${sn.params[0]}; ${sn.params[1]})`:sn.params[0]})]})]}),(0,t.jsx)("div",{className:Et.container,children:Sn&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:Et.label,children:"Stop alerting when "}),(0,t.jsx)("div",{className:Et.value,children:It}),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:Et.blue,children:En?.label}),(0,t.jsx)("div",{className:Et.bold,children:wn?`(${Sn.params[0]}; ${Sn.params[1]})`:Sn.params[0]})]})]})})]})}const at=et=>{const{blue:Et,bold:It,...Qt}=ct(et);return{...Qt,maxWidthContainer:(0,n.css)({maxWidth:"100%"}),container:(0,n.css)({padding:et.spacing(1),display:"flex",gap:et.spacing(.5)}),blue:(0,n.css)(Et,{margin:"auto 0"}),bold:(0,n.css)(It,{margin:"auto 0"})}};function ft({model:et}){const Et=(0,h.of)(at),{expression:It}=et;return(0,t.jsxs)("div",{className:Et.container,children:[(0,t.jsx)("div",{className:Et.label,children:"Input"}),(0,t.jsx)("div",{className:Et.value,children:It})]})}const ct=et=>({blue:(0,n.css)({color:et.colors.text.link}),bold:(0,n.css)({fontWeight:et.typography.fontWeightBold}),label:(0,n.css)({display:"flex",alignItems:"center",padding:et.spacing(.5,1),backgroundColor:et.colors.background.secondary,fontSize:et.typography.bodySmall.fontSize,lineHeight:et.typography.bodySmall.lineHeight,fontWeight:et.typography.fontWeightBold,borderRadius:et.shape.radius.default}),value:(0,n.css)({padding:et.spacing(.5,1),border:`1px solid ${et.colors.border.weak}`,borderRadius:et.shape.radius.default})});function vt(et){return et.type===me.p.IsWithinRange||et.type===me.p.IsOutsideRange}var Pt=e(36135),Vt=e(28318),Jt=e(1932),wt=e(25968);function zt(et){if(!et)return[];const{namespace:Et,rulerRule:It}=et,{rulesSource:Qt}=Et;if((0,x.lT)(It)){const sn=It.grafana_alert.data;return on(sn,It.for,et.group.interval)}if((0,He.Eb)(Qt)){const sn=_n(Qt,et);return[Pn(sn,Qt.uid)]}return[]}function on(et,Et,It){const Qt=(0,wt.P8)(Et)??(0,wt.P8)(It??"1m"),sn=Math.floor(Qt/1e3);return et.map(ln=>(0,Jt.jM)(ln,yn=>{const Sn=yn.relativeTimeRange?.from??0,En=Math.max(sn*3,Sn+sn*2);yn.relativeTimeRange={from:En,to:0}}))}function Pn(et,Et){return{refId:et.refId,datasourceUid:Et,queryType:"",model:et,relativeTimeRange:{from:360,to:0}}}function _n(et,Et){const It="A";switch(et.type){case"prometheus":return{refId:It,expr:Et.query};case"loki":return{refId:It,expr:Et.query};default:throw new Error(`Query for datasource type ${et.type} is currently not supported by cloud alert rules.`)}}const Cn=({rule:et})=>{const Et=(0,s.useMemo)(()=>new Vt.t,[]),It=(0,ne.A)(Et.get()),Qt=Ye(It),sn=(0,s.useMemo)(()=>zt(et),[et]),{allDataSourcesAvailable:ln}=(0,Pt.g)(sn),yn=(0,s.useCallback)(()=>{if(sn.length>0&&ln){let En;et&&(0,x.lT)(et.rulerRule)&&(En=et.rulerRule.grafana_alert.condition),Et.run(sn,En??"A")}},[sn,ln,et,Et]);(0,s.useEffect)(()=>{ln&&yn()},[ln,yn]),(0,s.useEffect)(()=>()=>Et.destroy(),[Et]);const Sn=(0,x.YN)(et.group);return(0,t.jsx)(t.Fragment,{children:Qt?"Loading...":(0,t.jsxs)(t.Fragment,{children:[(0,x.lT)(et.rulerRule)&&!Sn&&(0,t.jsx)(pt,{rule:et,condition:et.rulerRule.grafana_alert.condition,queries:sn,evalDataByQuery:It}),!(0,x.lT)(et.rulerRule)&&!Sn&&It&&Object.keys(It).length>0&&(0,t.jsx)(r.B,{direction:"column",gap:1,children:sn.map(En=>(0,t.jsx)(xt,{rule:et,refId:En.refId,model:En.model,dataSource:Object.values(H.$.datasources).find(wn=>wn.uid===En.datasourceUid),queryData:It[En.refId],relativeTimeRange:En.relativeTimeRange,isAlertCondition:!1},En.refId))}),!Sn&&!ln&&(0,t.jsx)(f.F,{title:"Query not available",severity:"warning",children:"Cannot display the query preview. Some of the data sources used in the queries are not available."})]})})};function Ye(et){return et?!!Object.values(et).find(Et=>Et.state===oe.Gu.Loading):!0}const Dt=()=>(0,t.jsx)(t.Fragment,{children:"Routing"});var yt=(et=>(et.Query="query",et.Instances="instances",et.History="history",et.Routing="routing",et.Details="details",et))(yt||{});const Ft=()=>{const{rule:et}=(0,U.k)(),{pageNav:Et,activeTab:It}=nn(et),[Qt,sn]=(0,s.useState)(),{annotations:ln,promRule:yn}=et,Sn=Un(et.promRule?.health),En=(0,x.Z8)(yn),wn=(0,x.YN)(et.group),On=(0,x.lT)(et.rulerRule)&&!!et.rulerRule.grafana_alert.provenance,Rt=(0,x.lT)(et.rulerRule)&&(0,x.HH)(et.rulerRule),Ot=Sn&&!Rt,jt=(0,x.uo)(et),rt=ln[D.YH.summary];return(0,t.jsxs)(M.d,{pageNav:Et,navId:"alert-list",isLoading:!1,renderTitle:tn=>(0,t.jsx)(hn,{name:tn,paused:Rt,state:En?yn.state:void 0,health:et.promRule?.health,ruleType:et.promRule?.type,ruleOrigin:jt}),actions:(0,t.jsx)(m.l,{rule:et,showCopyLinkButton:!0,rulesSource:et.namespace.rulesSource}),info:an(et),subTitle:(0,t.jsxs)(r.B,{direction:"column",children:[Rt&&(0,t.jsx)(p.A,{}),rt,wn&&(0,t.jsx)(R,{}),On&&(0,t.jsx)(S.Yi,{resource:S.hk.AlertRule,bottomSpacing:0,topSpacing:2}),Ot&&(0,t.jsx)(f.F,{title:"Something went wrong when evaluating this alert rule",bottomSpacing:0,topSpacing:2,children:(0,t.jsx)("pre",{style:{marginBottom:0},children:(0,t.jsx)("code",{children:et.promRule?.lastError??"No error message"})})})]}),children:[(0,t.jsx)(r.B,{direction:"column",gap:2,children:(0,t.jsxs)(a.J,{children:[It==="query"&&(0,t.jsx)(Cn,{rule:et}),It==="instances"&&(0,t.jsx)(q,{rule:et}),It==="history"&&(0,x.lT)(et.rulerRule)&&(0,t.jsx)(Z,{rule:et.rulerRule}),It==="routing"&&(0,t.jsx)(Dt,{}),It==="details"&&(0,t.jsx)(K.B,{rule:et})]})}),Qt&&(0,t.jsx)(b.Z,{redirectTo:!0,identifier:Qt,isProvisioned:On,onDismiss:()=>sn(void 0)})]})},an=et=>{const{labels:Et,annotations:It,group:Qt}=et,sn=[],ln=It[D.YH.runbookURL],yn=It[D.YH.dashboardUID],Sn=It[D.YH.panelID],En=yn&&Sn,wn=yn,On=!(0,i.isEmpty)(Et),Rt=Qt.interval;if(ln){const Ot=(0,i.truncate)(ln,{length:42}),jt=gt(ln)?(0,t.jsx)(c.Y,{variant:"bodySmall",href:ln,external:!0,children:Ot}):(0,t.jsx)(o.E,{variant:"bodySmall",children:Ot});sn.push({label:"Runbook URL",value:jt})}return En?sn.push({label:"Dashboard and panel",value:(0,t.jsx)(I.d,{title:et.name,component:(0,t.jsx)(c.Y,{variant:"bodySmall",href:(0,P.D2)(yn,Sn),children:"View panel"})})}):wn&&sn.push({label:"Dashboard",value:(0,t.jsx)(I.d,{title:et.name,component:(0,t.jsx)(c.Y,{title:et.name,variant:"bodySmall",href:(0,P.JM)(yn),children:"View dashboard"})})}),Rt&&sn.push({label:"Evaluation interval",value:(0,t.jsxs)(o.E,{color:"primary",children:["Every ",Rt]})}),On&&sn.push({label:"Labels",value:(0,t.jsx)(C.m,{labels:Et,size:"sm"})}),sn},un=et=>{const Et=new URLSearchParams([["search",et.map(([It,Qt])=>`${It}:"${Qt}"`).join(" ")]]);return(0,E.c)("/alerting/list?"+Et.toString())},hn=({name:et,paused:Et=!1,state:It,health:Qt,ruleType:sn,ruleOrigin:ln})=>{const yn=(0,h.of)(lt),[Sn]=(0,l.s)(),En=sn===d.JS.Recording,wn=Sn.returnTo?String(Sn.returnTo):"/alerting/list";return(0,t.jsxs)("div",{className:yn.title,children:[(0,t.jsx)(g.z9,{variant:"secondary",icon:"angle-left",href:wn}),ln&&(0,t.jsx)(u.T,{pluginId:ln.pluginId}),(0,t.jsx)(o.E,{variant:"h1",truncate:!0,children:et}),Et?(0,t.jsx)(L,{}):(0,t.jsxs)(t.Fragment,{children:[It&&(0,t.jsx)(B,{state:It,health:Qt}),En&&(0,t.jsx)(N,{health:Qt})]})]})},Un=et=>et==="error"||et==="err";function Nn(){const[et,Et]=(0,l.s)(),It=et.tab;return[St(It)?It:"query",ln=>{Et({tab:ln})}]}function St(et){return typeof et=="string"&&Object.values(yt).includes(et)}function nn(et){const[Et,It]=Nn(),{annotations:Qt,promRule:sn}=et,ln=Qt[D.YH.summary],yn=(0,x.Z8)(sn),Sn=yn?ht(et.instanceTotals):void 0,En=(0,T.EL)(et.namespace).name,wn=et.group.name,On=(0,x.lT)(et.rulerRule)&&yn,Rt=(0,x.KB)(et.promRule);return{pageNav:{...v.defaultPageNav,text:et.name,subTitle:ln,children:[{text:"Query and conditions",active:Et==="query",onClick:()=>{It("query")}},{text:"Instances",active:Et==="instances",onClick:()=>{It("instances")},tabCounter:Sn,hideFromTabs:Rt},{text:"History",active:Et==="history",onClick:()=>{It("history")},hideFromTabs:!On},{text:"Details",active:Et==="details",onClick:()=>{It("details")}}],parentItem:{text:wn,url:un([["namespace",En],["group",wn]]),parentItem:{text:En,url:un([["namespace",En]])}}},activeTab:Et}}const ht=et=>(0,i.chain)(et).pick([y.$.Alerting,y.$.Pending,y.$.Normal]).values().sum().value(),lt=()=>({title:(0,n.css)({display:"flex",alignItems:"center",gap:8,minWidth:0})});function gt(et){const Et=et.startsWith("/");let It=!1;try{new URL(et),It=!0}catch{return!1}return Et||It}const $t=Ft},50509:(G,O,e)=>{"use strict";e.d(O,{$:()=>y,B:()=>m});var t=e(74848),n=e(32196),i=e(72095),s=e(96540),r=e(40845),f=e(67061),a=e(94753),c=e(10534),o=e(72109),h=e(23662),g=e(55196),l=e(16577),p=(v=>(v.GrafanaManagedAlertRule="Grafana-managed alert rule",v.CloudAlertRule="Cloud alert rule",v.CloudRecordingRule="Cloud recording rule",v))(p||{});const m=({rule:v})=>{const u=(0,r.of)(d);let D;(0,h.lT)(v.rulerRule)?D="Grafana-managed alert rule":(0,h.i7)(v.rulerRule)?D="Cloud recording rule":D="Cloud alert rule";const P=v.promRule?.evaluationTime,x=v.promRule?.lastEvaluation,E=(0,s.useCallback)(()=>(0,h.lT)(v.rulerRule)?v.rulerRule.grafana_alert.uid:"",[v.rulerRule]),C=(0,h.i7)(v.rulerRule)?void 0:v.annotations??[],M=Number.isFinite(P);return(0,t.jsxs)(f.B,{direction:"column",gap:3,children:[(0,t.jsxs)("div",{className:u.metadataWrapper,children:[(0,t.jsxs)(g.P,{direction:"column",children:["Rule type",(0,t.jsx)(a.E,{color:"primary",children:D})]}),(0,t.jsx)(g.P,{direction:"column",children:(0,h.lT)(v.rulerRule)&&(0,t.jsxs)(t.Fragment,{children:["Rule Identifier",(0,t.jsx)(f.B,{direction:"row",alignItems:"center",gap:.5,children:(0,t.jsxs)(a.E,{color:"primary",children:[v.rulerRule.grafana_alert.uid,(0,t.jsx)(c.b,{fill:"text",variant:"secondary",icon:"copy",size:"sm",getText:E})]})})]})}),(0,t.jsx)(g.P,{direction:"column",children:M&&(0,t.jsxs)(t.Fragment,{children:["Last evaluation",x&&P?(0,t.jsxs)("span",{children:[(0,t.jsxs)(a.E,{color:"primary",children:[(0,i.B)(new Date(x))," ago"]}),", took"," ",(0,t.jsxs)(a.E,{color:"primary",children:[P,"ms"]})]}):null]})}),(0,t.jsx)(g.P,{direction:"column",children:!(0,h.i7)(v.rulerRule)&&(0,t.jsxs)(t.Fragment,{children:["Pending period",(0,t.jsx)(a.E,{color:"primary",children:v.rulerRule?.for??"0s"})]})}),(0,h.lT)(v.rulerRule)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(g.P,{direction:"column",children:["Alert state if no data or all values are null",(0,t.jsx)(a.E,{color:"primary",children:v.rulerRule.grafana_alert.no_data_state})]}),(0,t.jsxs)(g.P,{direction:"column",children:["Alert state if execution error or timeout",(0,t.jsx)(a.E,{color:"primary",children:v.rulerRule.grafana_alert.exec_err_state})]})]})]}),C&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.E,{variant:"h4",children:"Annotations"}),Object.keys(C).length===0?(0,t.jsx)(a.E,{variant:"bodySmall",color:"secondary",italic:!0,children:"No annotations"}):(0,t.jsx)("div",{className:u.metadataWrapper,children:Object.entries(C).map(([S,I])=>(0,t.jsxs)(g.P,{direction:"column",children:[S,(0,t.jsx)(y,{value:I})]},S))})]})]})};function y({value:v}){const u=v&&v.startsWith("http"),D=(0,t.jsx)(l.Y,{input:v,delimiter:["{{","}}"]});return u?(0,t.jsx)(o.Y,{variant:"bodySmall",href:v,external:!0,children:v}):(0,t.jsx)(a.E,{color:"primary",children:D})}const d=v=>({metadataWrapper:(0,n.css)({display:"grid",gridTemplateColumns:"auto auto",rowGap:v.spacing(3),columnGap:v.spacing(12)})})},2426:(G,O,e)=>{"use strict";e.d(O,{D:()=>P});var t=e(74848),n=e(96540),i=e(8249),s=e(47232),r=e(74135),f=e(23662),a=e(69087),c=e(75591),o=e(3197),h=e(83122),g=e(29158),l=e(24401),p=e(30973);const m=({rule:E,instance:C,extensionPointId:M})=>{const[S,I]=(0,n.useState)(),T=(0,n.useMemo)(()=>({instance:C,rule:E}),[C,E]),{extensions:b}=(0,o.vl)({context:T,extensionPointId:M,limitPerPlugin:3});if(b.length===0)return null;const R=(0,t.jsx)(p.w,{extensions:b,onSelect:I});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.m,{placement:"bottom-start",overlay:R,children:(0,t.jsx)(g.K,{name:"ellipsis-v","aria-label":"Actions",variant:"secondary"})}),!!S&&!!S.path&&(0,t.jsx)(l.s,{path:S.path,title:S.title,onDismiss:()=>I(void 0)})]})};var y=e(33225),d=e(71223),v=e(84396);const u=({instance:E})=>{const C=(0,y.Hx)(E.annotations),M=(0,y.gO)(C);return(0,t.jsxs)("div",{children:[E.value&&(0,t.jsx)(v.X,{label:"Value",horizontal:!0,children:E.value}),C.map(([S,I])=>(0,t.jsx)(d.s,{annotationKey:S,value:I,valueLink:M.get(S)},S))]})};var D=e(30423);const P=({rule:E,instances:C,pagination:M,footerRow:S})=>{const I=(0,n.useMemo)(()=>C.length>1?(0,i.yO)(C.map(b=>b.labels)):{},[C]),T=(0,n.useMemo)(()=>C.map(b=>({data:{rule:E,alert:{...b,commonLabels:I}},id:(0,f.RI)(b)})),[I,C,E]);return(0,t.jsx)(c.E,{cols:x,isExpandable:!0,items:T,renderExpandedContent:({data:b})=>(0,t.jsx)(u,{instance:b.alert}),pagination:M,footerRow:S})},x=[{id:"state",label:"State",renderCell:({data:{alert:{state:E}}})=>(0,t.jsx)(D.C,{state:E}),size:"80px"},{id:"labels",label:"Labels",renderCell:({data:{alert:{labels:E,commonLabels:C}}})=>(0,t.jsx)(a.m,{labels:E,commonLabels:C,size:"sm"})},{id:"created",label:"Created",renderCell:({data:{alert:{activeAt:E}}})=>(0,t.jsx)(t.Fragment,{children:E.startsWith("0001")?"-":(0,s.KQ)(E).format("YYYY-MM-DD HH:mm:ss")}),size:"150px"},{id:"actions",label:"",renderCell:({data:{alert:E,rule:C}})=>(0,t.jsx)(m,{rule:C,instance:E,extensionPointId:r.S.AlertInstanceAction},"alert-instance-extension-point"),size:"40px"}]},30423:(G,O,e)=>{"use strict";e.d(O,{C:()=>a});var t=e(74848),n=e(96540),i=e(56034),s=e(14578),r=e(23662),f=e(65415);const a=(0,n.memo)(({state:c,isPaused:o=!1,size:h="md",muted:g=!1})=>o?(0,t.jsx)(i.m,{content:"Alert evaluation is currently paused",placement:"top",children:(0,t.jsxs)(f.O,{state:"warning",size:h,muted:g,children:[(0,t.jsx)(s.I,{name:"pause",size:"xs"})," Paused"]})}):(0,t.jsx)(f.O,{state:(0,r.Wy)(c),size:h,muted:g,children:(0,r.XI)(c)}));a.displayName="AlertStateTag"},51921:(G,O,e)=>{"use strict";e.d(O,{Z:()=>a});var t=e(74848),n=e(96540),i=e(24180),s=e(96374),r=e(55852),f=e(18461);function a({identifier:o,isProvisioned:h,redirectTo:g=!1,onDismiss:l}){const p=(0,i.zy)(),[m,y]=(0,n.useState)(h?"confirm":"redirect");if(m==="redirect"){const d=f.$9(o),v=p.pathname+p.search,u=new URLSearchParams({copyFrom:d,returnTo:g?v:""});return(0,t.jsx)(i.rd,{to:"/alerting/new?"+u.toString(),push:!0})}return(0,t.jsx)(s.u,{isOpen:m==="confirm",title:"Copy provisioned alert rule",body:(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{children:["The new rule will ",(0,t.jsx)("strong",{children:"not"})," be marked as a provisioned rule."]}),(0,t.jsx)("p",{children:"You will need to set a new evaluation group for the copied rule because the original one has been provisioned and cannot be used for rules created in the UI."})]}),confirmText:"Copy",onConfirm:()=>y("redirect"),onDismiss:l})}const c=(0,n.forwardRef)(({text:o,ruleIdentifier:h,isProvisioned:g,className:l},p)=>{const[m,y]=(0,n.useState)(!1);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.$n,{title:"Copy",className:l,size:"sm",variant:"secondary",icon:"copy",onClick:()=>y(!0),ref:p,children:o},"clone"),m&&(0,t.jsx)(a,{identifier:h,isProvisioned:g,onDismiss:()=>y(!1)})]})});c.displayName="CloneRuleButton"},35896:(G,O,e)=>{"use strict";e.d(O,{l:()=>fe});var t=e(74848),n=e(32196),i=e(96540),s=e(24180),r=e(40845),f=e(55852),a=e(67061),c=e(26272),o=e(38138),h=e(83122),g=e(28138),l=e(3169),p=e(23662),m=e(72635),y=e(79938),d=e(48070),v=e(6833),u=e(43482);function D(){const[je]=(0,u.D)(),[He]=y.hK.endpoints.upsertRuleGroupForNamespace.useMutation();return(0,v.Yb)(async(Be,Ne,Re)=>{const{namespaceName:Se}=Be,We=(0,d.LH)({uid:Ne,pause:Re}),{newRuleGroupDefinition:Ke,rulerConfig:Xe}=await je(Be,We),Je=(0,m.t)("alerting.rules.pause-rule.success","Rule evaluation paused"),st=(0,m.t)("alerting.rules.resume-rule.success","Rule evaluation resumed");return He({rulerConfig:Xe,namespace:Se,payload:Ke,requestOptions:{successMessage:Re?Je:st}}).unwrap()})}var P=e(56361);const E=({rule:je,onPauseChange:He})=>{const Be=(0,l._2)(),[Ne,Re]=D(),Se=(0,p.lT)(je.rulerRule)&&(0,p.HH)(je.rulerRule),We=Se?"play":"pause",Ke=Se?"Resume evaluation":"Pause evaluation",Xe=async Je=>{if((0,p.lT)(je.rulerRule)){try{const st=(0,p.Uw)(je),pt=je.rulerRule.grafana_alert.uid;await Re.execute(st,pt,Je)}catch(st){Be.error(`Failed to ${Je?"pause":"resume"} the rule: ${(0,P.JZ)(st)}`);return}He?.()}};return(0,t.jsx)(o.W.Item,{label:Ke,icon:We,disabled:(0,v.VP)(Ne),onClick:()=>{Xe(!Se)}})};var C=e(90141),M=e(74135),S=e(3197),I=e(94822);function T(je){const He=b(je),{extensions:Be}=(0,S.vl)(He),Ne=(0,p.uo)(je),Re=je.promRule?.type;if(!Ne||!Re)return[];const{pluginId:Se}=Ne;return Be.filter(We=>We.pluginId===Se)}function b(je){return(0,i.useMemo)(()=>{switch(je.promRule?.type){case I.JS.Alerting:return{extensionPointId:M.S.AlertingAlertingRuleAction,context:{name:je.name,namespace:je.namespace.name,group:je.group.name,expression:je.query,labels:je.labels,annotations:je.annotations}};case I.JS.Recording:return{extensionPointId:M.S.AlertingRecordingRuleAction,context:{name:je.name,namespace:je.namespace.name,group:je.group.name,expression:je.query,labels:je.labels}};default:return{extensionPointId:""}}},[je])}var R=e(19073),A=e(18461),L=e(3704),U=e(56034),W=e(12210),w=e(99494),N=e(76156);const B=({title:je="",severity:He="",url:Be=""})=>{const Ne=createBridgeURL(SupportedPlugin.Incident,"/incidents/declare",{title:je,severity:He,url:Be}),{loading:Re,installed:Se,settings:We}=usePluginBridge(SupportedPlugin.Incident);return jsxs(Fragment,{children:[Re===!0&&jsx(Button,{icon:"fire",size:"sm",type:"button",disabled:!0,children:"Declare Incident"}),Se===!1&&jsx(Tooltip,{content:"Grafana Incident is not installed or is not configured correctly",children:jsx(Button,{icon:"fire",size:"sm",type:"button",disabled:!0,children:"Declare Incident"})}),We&&jsx(LinkButton,{icon:"fire",size:"sm",type:"button",href:Ne,children:"Declare Incident"})]})},V=({title:je="",severity:He="",url:Be=""})=>{const Ne=(0,N.h)(w.W.Incident,"/incidents/declare",{title:je,severity:He,url:Be}),{loading:Re,installed:Se,settings:We}=(0,W._)(w.W.Incident);return(0,t.jsxs)(t.Fragment,{children:[Re===!0&&(0,t.jsx)(o.W.Item,{label:"Declare incident",icon:"fire",disabled:!0}),Se===!1&&(0,t.jsx)(U.m,{content:"Grafana Incident is not installed or is not configured correctly",children:(0,t.jsx)(o.W.Item,{label:"Declare incident",icon:"fire",disabled:!0})}),We&&(0,t.jsx)(o.W.Item,{label:"Declare incident",url:Ne,icon:"fire"})]})},K=({rule:je,identifier:He,showCopyLinkButton:Be,handleSilence:Ne,handleDelete:Re,handleDuplicateRule:Se,onPauseChange:We,buttonSize:Ke})=>{const[Xe,Je]=(0,R.mh)(je,R.j5.Pause),st=Xe&&Je,[pt,xt]=(0,R.mh)(je,R.j5.Delete),ot=pt&&xt,[$e,ve]=(0,R.mh)(je,R.j5.Duplicate),be=$e&&ve,[he,ye]=(0,R.mh)(je,R.j5.Silence),Pe=he&&ye,[ge,xe]=(0,R.mh)(je,R.j5.ModifyExport),Ae=ge&&xe,Ee=T(je),Ie=Ee.length>0,Qe=(!(0,P.y$)()||(0,P.ES)())&&(0,p.Z8)(je.promRule)&&je.promRule.state===I.cF.Firing,at=(0,P.S2)(je.namespace.rulesSource,je),ft=[st,Pe,Qe,be].some(Boolean)&&[Be,Ae].some(Boolean),ct=(0,t.jsxs)(t.Fragment,{children:[st&&(0,t.jsx)(E,{rule:je,onPauseChange:We}),Pe&&(0,t.jsx)(o.W.Item,{label:"Silence notifications",icon:"bell-slash",onClick:Ne}),Qe&&(0,t.jsx)(V,{title:je.name,url:""}),be&&(0,t.jsx)(o.W.Item,{label:"Duplicate",icon:"copy",onClick:()=>Se(He)}),ft&&(0,t.jsx)(o.W.Divider,{}),at&&(0,t.jsx)(o.W.Item,{label:"Copy link",icon:"share-alt",onClick:()=>H(at)}),Ae&&(0,t.jsx)(o.W.Item,{label:"Export",icon:"download-alt",childItems:[(0,t.jsx)(X,{identifier:He},"export-with-modifications")]}),Ie&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.W.Divider,{}),Ee.map(vt=>(0,t.jsx)(o.W.Item,{label:vt.title,icon:vt.icon,onClick:vt.onClick},vt.id))]}),ot&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.W.Divider,{}),(0,t.jsx)(o.W.Item,{label:"Delete",icon:"trash-alt",destructive:!0,onClick:()=>Re(je)})]})]});return(0,t.jsx)(h.m,{overlay:(0,t.jsx)(o.W,{children:ct}),children:(0,t.jsx)(C.A,{size:Ke})})};function H(je){navigator.clipboard?.writeText(je).then(()=>{g.A.emit(c.r1.alertSuccess,["URL copied to clipboard"])})}const X=({identifier:je})=>{const He=location.pathname+location.search,Be=(0,L.c)(`/alerting/${encodeURIComponent(A.$9(je))}/modify-export`,{returnTo:He});return(0,t.jsx)(o.W.Item,{label:"With modifications",icon:"file-edit-alt",url:Be},"with-modifications")},k=K;var Y=e(12131),Z=e(96374),se=e(99140),j=e(96065),q=e(23770);const ne=(je=!1)=>{const[He,Be]=(0,i.useState)(),[Ne,Re]=(0,j.Y)(),Se=(0,i.useCallback)(()=>{Be(void 0)},[]),We=(0,i.useCallback)(Je=>{Be(Je)},[]),Ke=(0,i.useCallback)(async Je=>{if(!Je?.rulerRule)return;const st=(0,p.Uw)(Je);await Re.execute(st,Je.rulerRule),(0,se.JD)((0,q.Lc)({rulesSourceName:st.dataSourceName})),Se(),je&&Y.Ny.replace("/alerting/list")},[Re,Se,je]);return[(0,i.useMemo)(()=>(0,t.jsx)(Z.u,{isOpen:!!He,title:"Delete rule",body:"Deleting this rule will permanently remove it from your alert rule list. Are you sure you want to delete this rule?",confirmText:"Yes, delete",icon:"exclamation-triangle",onConfirm:()=>Ke(He),onDismiss:Se}),[Ke,Se,He]),We,Se]};var oe=e(75648),z=e(87978),te=e(98569),le=e(17272),ie=e(57220);const re=({rulerRule:je,onClose:He})=>{const{uid:Be}=je.grafana_alert,Ne=(0,le.Di)();return(0,t.jsx)(z._,{title:"Silence alert rule",subtitle:"Configure silences to stop notifications from a particular alert rule.",onClose:He,size:"md",children:(0,t.jsx)(a.B,{direction:"column",children:(0,t.jsx)(te.G,{ruleUid:Be,formValues:Ne,alertManagerSourceName:ie.hY,onSilenceCreated:He,onCancel:He})})})};var ce=e(14285),me=e(70383),ee=e(31678),de=e(51921);const De=je=>window.matchMedia(`(max-width: ${je}px)`).matches,fe=({compact:je,showViewButton:He,showCopyLinkButton:Be,rule:Ne,rulesSource:Re})=>{const Se=(0,ee.useDispatch)(),We=(0,s.zy)(),Ke=(0,r.of)(Te),Xe=!je,[Je,st]=ne(Xe),[pt,xt]=(0,i.useState)(!1),[ot,$e]=(0,i.useState)(void 0),{namespace:ve,group:be,rulerRule:he}=Ne,{hasActiveFilters:ye}=(0,ce.dI)(),Pe=We.pathname+We.search,ge=(0,p.lT)(Ne.rulerRule)&&!!Ne.rulerRule.grafana_alert.provenance,[xe,Ae]=(0,R.mh)(Ne,R.j5.Update),Ee=xe&&Ae,Ie=[],Qe=(0,n.cx)({[Ke.compactButton]:je}),at=je?"sm":"md",ft=(0,ie.EV)(Re),ct=A.UP(ft,Ne);if(He&&Ie.push((0,t.jsx)(f.z9,{tooltip:je?"View":void 0,tooltipPlacement:"top",className:Qe,title:"View",size:at,variant:"secondary",icon:"eye",href:(0,P.w$)(Re,Ne,Pe),children:!je&&"View"},"view")),he&&Ee){const vt=A.P1(ft,ve.name,be.name,he),Pt=(0,L.c)(`/alerting/${encodeURIComponent(A.$9(vt))}/edit`,{returnTo:Pe});Ie.push((0,t.jsx)(f.z9,{tooltip:je?"Edit":void 0,tooltipPlacement:"top",title:"Edit",className:Qe,size:at,variant:"secondary",icon:"pen",href:Pt,children:!je&&"Edit"},"edit"))}return(0,t.jsxs)(a.B,{gap:1,children:[Ie,(0,t.jsx)(k,{buttonSize:at,rule:Ne,identifier:ct,showCopyLinkButton:Be,handleDelete:()=>st(Ne),handleSilence:()=>xt(!0),handleDuplicateRule:()=>$e({identifier:ct,isProvisioned:ge}),onPauseChange:()=>{const vt=ye?void 0:oe.Ys+1;Se((0,q.Lc)({rulesSourceName:ie.hY,limitAlerts:vt}))}}),Je,(0,p.lT)(Ne.rulerRule)&&pt&&(0,t.jsx)(me.b9,{accessType:"instance",children:(0,t.jsx)(re,{rulerRule:Ne.rulerRule,onClose:()=>xt(!1)})}),ot?.identifier&&(0,t.jsx)(de.Z,{identifier:ot.identifier,isProvisioned:ot.isProvisioned,onDismiss:()=>$e(void 0)})]})},Te=je=>({compactButton:(0,n.css)({padding:`0 ${je.spacing(2)}`})})},75648:(G,O,e)=>{"use strict";e.d(O,{Ys:()=>j,DI:()=>q});var t=e(74848),n=e(32196),i=e(72724),s=e(47232),r=e(40845),f=e(56034),a=e(97814),c=e(33225),o=e(23662),h=e(25968),g=e(69087),l=e(84396),p=e(71223);function m(z){const te=(0,r.of)(y),{annotations:le}=z,ie=(0,c.gO)(le);return le.length===0?null:(0,t.jsx)("div",{className:te.annotations,children:le.map(([ae,re])=>(0,t.jsx)(p.s,{annotationKey:ae,value:re,valueLink:ie.get(ae)},ae))})}const y=()=>({annotations:(0,n.css)({marginTop:"46px"})});var d=e(96540),v=e(80997),u=e(14778),D=e(55852),P=e(67061),x=e(19073),E=e(46013),C=e(55740),M=e(57220),S=e(56361);const T=({rule:z,rulesSource:te})=>{const{group:le}=z,{StateHistoryModal:ie,showStateHistoryModal:ae}=(0,E.G)(),re=(0,u.i)(),[ce,me]=(0,x.mh)(z,x.j5.Explore),ee=[],de=(0,o.YN)(le);if((0,M.Eb)(te)&&ce&&me&&!de&&ee.push((0,t.jsx)(D.z9,{size:"sm",variant:"primary",icon:"chart-line",target:"_blank",href:(0,S.Yp)(te,z.query),children:"See graph"},"explore")),z.annotations[C.YH.runbookURL]&&ee.push((0,t.jsx)(D.z9,{size:"sm",variant:"primary",icon:"book",target:"_blank",href:v.sQ.sanitizeUrl(z.annotations[C.YH.runbookURL]),children:"View runbook"},"runbook")),z.annotations[C.YH.dashboardUID]){const De=z.annotations[C.YH.dashboardUID];if(De){ee.push((0,t.jsx)(D.z9,{size:"sm",variant:"primary",icon:"apps",href:`d/${encodeURIComponent(De)}`,onClick:()=>{re(z.name)},children:"Go to dashboard"},"dashboard"));const fe=z.annotations[C.YH.panelID];fe&&ee.push((0,t.jsx)(D.z9,{size:"sm",variant:"primary",icon:"apps",href:`d/${encodeURIComponent(De)}?viewPanel=${encodeURIComponent(fe)}`,onClick:()=>{re(z.name)},children:"Go to panel"},"panel"))}}return(0,o.lT)(z.rulerRule)&&ee.push((0,t.jsxs)(d.Fragment,{children:[(0,t.jsx)(D.$n,{size:"sm",icon:"history",onClick:()=>(0,o.lT)(z.rulerRule)&&ae(z.rulerRule),children:"Show state history"}),ie]},"history")),ee.length?(0,t.jsx)(P.B,{children:ee}):null};var b=e(19347),R=e(66718);function A(z){const{rulesSource:te,rule:le}=z,ie=(0,r.of)(L),ae=(0,d.useMemo)(()=>{if((0,M.Eb)(te))return[{name:te.name,icon:te.meta.info.logos.small}];if((0,o.lT)(le.rulerRule)){const{data:re}=le.rulerRule.grafana_alert,ce=re.reduce((me,ee)=>{const de=(0,b.l)().getInstanceSettings(ee.datasourceUid);return!de||de.uid===R.Uj||(me[de.name]={name:de.name,icon:de.meta.info.logos.small}),me},{});return Object.values(ce)}return[]},[le,te]);return ae.length===0?null:(0,t.jsx)(l.X,{label:"Data source",children:ae.map(({name:re,icon:ce},me)=>(0,t.jsxs)("div",{children:[ce&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("img",{alt:`${re} datasource logo`,className:ie.dataSourceIcon,src:ce})," "]}),re]},re))})}function L(z){const te=z.spacing(2);return{dataSourceIcon:(0,n.css)({width:te,height:te})}}var U=e(28848),W=e(29317),w=e(20719),N=e(41781),B=e(72307),V=e(71713),K=e(73750);const H=({language:z,expr:te})=>{const le=(0,d.useMemo)(()=>[(0,N.D)({onlyIn:ae=>"type"in ae&&ae.type==="code_block",getSyntax:()=>z},{...U.languages,[z]:z==="logql"?V.Ay:w.n6})],[z]),ie=(0,d.useMemo)(()=>(0,B.mO)(te),[te]);return(0,t.jsx)(W.KE,{"data-testid":"expression-editor",plugins:le,value:ie})},X=({expression:z,rulesSource:te})=>{const le=(0,r.of)(k);return(0,t.jsx)(K.L,{className:(0,n.cx)(le.well,"slate-query-field"),children:(0,M.Eb)(te)?(0,t.jsx)(H,{expr:z,language:te.type===M.ol.Loki?"logql":"promql"}):z})},k=z=>({well:(0,n.css)({fontFamily:z.typography.fontFamilyMonospace})});function Y(z){const{annotations:te,rulesSource:le,rule:ie}=z,ae=Z();return(0,M.Eb)(le)?(0,t.jsx)(l.X,{label:"Expression",horizontal:!0,className:(0,n.cx)({[ae.exprRow]:!!te.length}),children:(0,t.jsx)(X,{expression:ie.query,rulesSource:le})}):null}const Z=()=>({exprRow:(0,n.css)({marginBottom:"46px"})});var se=e(99938);const j=15,q=({rule:z})=>{const te=(0,r.of)(oe),{namespace:{rulesSource:le}}=z,ie=(0,c.Hx)(z.annotations);return(0,t.jsxs)("div",{children:[(0,t.jsx)(T,{rule:z,rulesSource:le}),(0,t.jsxs)("div",{className:te.wrapper,children:[(0,t.jsxs)("div",{className:te.leftSide,children:[(0,t.jsx)(ne,{rule:z}),!!z.labels&&!!Object.keys(z.labels).length&&(0,t.jsx)(l.X,{label:"Labels",horizontal:!0,children:(0,t.jsx)(g.m,{labels:z.labels})}),(0,t.jsx)(Y,{rulesSource:le,rule:z,annotations:ie}),(0,t.jsx)(m,{annotations:ie})]}),(0,t.jsx)("div",{className:te.rightSide,children:(0,t.jsx)(A,{rulesSource:le,rule:z})})]}),(0,t.jsx)(l.X,{label:"Instances",horizontal:!0,children:(0,t.jsx)(se.s,{rule:z,itemsDisplayLimit:j})})]})},ne=({rule:z})=>{let te,le=z.group.interval,ie=z.promRule?.lastEvaluation,ae=z.promRule?.evaluationTime;return(0,o.i7)(z.rulerRule)||(te=z.rulerRule?.for??"0s"),(0,t.jsxs)(t.Fragment,{children:[le&&(0,t.jsxs)(l.X,{label:"Evaluate",horizontal:!0,children:["Every ",le]}),(0,t.jsx)(l.X,{label:"Pending period",horizontal:!0,children:te}),ie&&!(0,h.mo)(ie)&&(0,t.jsx)(l.X,{label:"Last evaluation",horizontal:!0,children:(0,t.jsx)(f.m,{placement:"top",content:`${(0,i.LE)(ie,{format:"YYYY-MM-DD HH:mm:ss"})}`,theme:"info",children:(0,t.jsx)("span",{children:`${(0,s.KQ)(ie).locale("en").fromNow(!0)} ago`})})}),ie&&!(0,h.mo)(ie)&&ae!==void 0&&(0,t.jsx)(l.X,{label:"Evaluation time",horizontal:!0,children:(0,t.jsx)(f.m,{placement:"top",content:`${ae}s`,theme:"info",children:(0,t.jsx)("span",{children:(0,a.g)({timeInMs:ae*1e3,humanize:!0})})})})]})},oe=z=>({wrapper:(0,n.css)({display:"flex",flexDirection:"row",[z.breakpoints.down("md")]:{flexDirection:"column"}}),leftSide:(0,n.css)({flex:1}),rightSide:(0,n.css)({[z.breakpoints.up("md")]:{paddingLeft:"90px",width:"300px"}})})},99938:(G,O,e)=>{"use strict";e.d(O,{s:()=>C});var t=e(74848),n=e(32196),i=e(2543),s=e(96540),r=e(40845),f=e(55852),a=e(53876),c=e(78369),o=e(60029),h=e(94354),g=e(94822);const l=({className:I,onStateFilterChange:T,stateFilter:b,filterType:R,itemPerStateStats:A})=>{const L=(0,r.of)(p),U=V=>function(){return A&&A[V]?(0,t.jsx)(c.v,{name:A[V].toFixed(0),colorIndex:9,className:L.tag}):null},W=Object.values(g.Gi).map(V=>({label:V,value:V,component:U(V)})),N=[g.cF.Firing,g.cF.Pending].map(V=>({label:(0,i.capitalize)(V),value:V,component:U(V)})),B=R==="grafana"?W:N;return(0,t.jsxs)("div",{className:I,"data-testid":"alert-instance-state-filter",children:[(0,t.jsx)(o.J,{children:"State"}),(0,t.jsx)(h.z,{options:B,value:b,onChange:T,onClick:V=>{V===b&&T(void 0)}})]})};function p(I){return{tag:(0,n.css)({fontSize:"11px",fontWeight:"normal",padding:I.spacing(.25,.5),verticalAlign:"middle",marginLeft:I.spacing(.5)})}}var m=e(98164),y=e(56361),d=e(64861),v=e(57220),u=e(32642),D=e(23662),P=e(2426),x=e(92467);function E({stats:I,onClick:T,href:b}){const R=(0,r.of)(S);return(0,t.jsxs)("div",{className:R.footerRow,children:[(0,t.jsxs)("div",{children:["Showing ",I.visibleItemsCount," out of ",I.totalItemsCount," instances"]}),(0,t.jsxs)(f.z9,{size:"sm",variant:"secondary","data-testid":"show-all",onClick:T,href:b,children:["Show all ",I.totalItemsCount," alert instances"]})]})}function C(I){const{rule:T,itemsDisplayLimit:b=Number.POSITIVE_INFINITY,pagination:R,enableFiltering:A=!1}=I,{promRule:L,namespace:U,instanceTotals:W}=T,[w,N]=(0,s.useState)(),[B,V]=(0,s.useState)(),[K]=(0,s.useState)(Math.floor(Math.random()*100)),H=`queryString-${K}`,X=(0,r.of)(S),k=(0,v.z2)(U.rulesSource)?v.hY:"prometheus",Y=(0,s.useMemo)(()=>(0,D.Z8)(L)&&L.alerts?.length?M(w,B,(0,y.Cp)(d.xB.Importance,L.alerts)):[],[L,B,w]);if(!(0,D.Z8)(L))return null;const Z=Y.slice(0,b),se=(0,i.countBy)(L.alerts,ie=>(0,g.lh)(ie.state)),j=(0,i.sum)([W.alerting,W.inactive,W.pending,W.nodata]),q=j-Z.length,ne={totalItemsCount:j,visibleItemsCount:Z.length},oe=(0,y.w$)(U.rulesSource,I.rule,location.pathname+location.search),z=(0,x.kc)(W),te=()=>V(void 0),le=q?(0,t.jsx)(E,{stats:ne,onClick:A?te:void 0,href:A?void 0:oe}):void 0;return(0,t.jsxs)(t.Fragment,{children:[A&&(0,t.jsx)("div",{className:(0,n.cx)(X.flexRow,X.spaceBetween),children:(0,t.jsxs)("div",{className:X.flexRow,children:[(0,t.jsx)(a.X,{defaultQueryString:w,onFilterChange:ie=>N(ie)},H),(0,t.jsx)(l,{filterType:k,stateFilter:B,onStateFilterChange:V,itemPerStateStats:se})]})}),!A&&(0,t.jsx)("div",{className:X.stats,children:z}),(0,t.jsx)(P.D,{rule:T,instances:Z,pagination:R,footerRow:le})]})}function M(I,T,b){let R=[...b];if(I){const A=I?(0,u.Zc)(I):[];R=R.filter(({labels:L})=>(0,m.Av)(L,A))}return T&&(R=R.filter(A=>(0,g.lh)(A.state)===T)),R}const S=I=>({flexRow:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"flex-end",width:"100%",flexWrap:"wrap",marginBottom:I.spacing(1),gap:I.spacing(1)}),spaceBetween:(0,n.css)({justifyContent:"space-between"}),footerRow:(0,n.css)({display:"flex",flexDirection:"column",gap:I.spacing(1),justifyContent:"space-between",alignItems:"center",width:"100%"}),instancesContainer:(0,n.css)({marginBottom:I.spacing(2)}),stats:(0,n.css)({display:"flex",gap:I.spacing(1),padding:I.spacing(1,0)})})},92467:(G,O,e)=>{"use strict";e.d(O,{M_:()=>l,j7:()=>y,kc:()=>d});var t=e(74848),n=e(2543),i=e.n(n),s=e(55127),r=e.n(s),f=e(96540),a=e(67061),c=e(39938),o=e(54317),h=e(94822);const g={recording:0,alerting:0,[h.cF.Pending]:0,[h.cF.Inactive]:0,paused:0,error:0,nodata:0},l=({namespaces:v})=>{const u=p(v),D=m(u),P=d(u),x=!!P.length;return P.unshift((0,t.jsxs)(f.Fragment,{children:[D," ",r()("rule",D)]},"total")),(0,t.jsx)(a.B,{direction:"row",children:x&&(0,t.jsx)("div",{children:(0,t.jsx)(a.B,{gap:.5,children:P})})})};function p(v){const u={...g};return v.forEach(({groups:D})=>{D.forEach(P=>{const x=(0,n.omitBy)(P.totals,n.isUndefined);for(let E in x)u[E]+=x[E]})}),u}function m(v){const u=(0,n.pick)(v,["alerting","pending","inactive","recording"]);return(0,n.sum)(Object.values(u))}const y=({group:v})=>{const u=v.totals,D=v?.interval,P=d(u),x=!!P.length;return(0,t.jsxs)(a.B,{direction:"row",children:[x&&(0,t.jsx)("div",{children:(0,t.jsx)(a.B,{gap:.5,children:P})}),D&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{children:"|"}),(0,t.jsx)(c.E,{text:D,icon:"clock-nine",color:"blue"})]})]})};function d(v){const u=[];return v[o.$.Alerting]&&u.push((0,t.jsx)(c.E,{color:"red",text:`${v[o.$.Alerting]} firing`},"firing")),v.error&&u.push((0,t.jsx)(c.E,{color:"red",text:`${v.error} errors`},"errors")),v.nodata&&u.push((0,t.jsx)(c.E,{color:"blue",text:`${v.nodata} no data`},"nodata")),v[o.$.Pending]&&u.push((0,t.jsx)(c.E,{color:"orange",text:`${v[o.$.Pending]} pending`},"pending")),v[o.$.Normal]&&v.paused&&u.push((0,t.jsx)(c.E,{color:"green",text:`${v[o.$.Normal]} normal (${v.paused} paused)`},"paused")),v[o.$.Normal]&&!v.paused&&u.push((0,t.jsx)(c.E,{color:"green",text:`${v[o.$.Normal]} normal`},"inactive")),v.recording&&u.push((0,t.jsx)(c.E,{color:"purple",text:`${v.recording} recording`},"recording")),u}},80215:(G,O,e)=>{"use strict";e.d(O,{s:()=>w});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(56034),f=e(15054),a=e(83903),c=e(85244),o=e(55740),h=e(23662),g=e(75591),l=e(10562),p=e(48205),m=e(82437),y=e(16577),d=e(13064),v=e(35896),u=e(32264),D=e(14578),P=e(82775);function x({rule:V}){const K=(0,s.of)(E),H=(0,h.lT)(V.rulerRule);return(0,i.useMemo)(()=>H?(0,P.q)(V.group.interval).exceedsLimit:!1,[V.group.interval,H])?(0,t.jsx)(r.m,{theme:"error",content:(0,t.jsxs)("div",{children:["A minimum evaluation interval of"," ",(0,t.jsx)("span",{className:K.globalLimitValue,children:u.$.unifiedAlerting.minInterval})," has been configured in Grafana and will be used instead of the ",V.group.interval," interval configured for the Rule Group."]}),children:(0,t.jsx)(D.I,{name:"stopwatch-slash",className:K.icon})}):null}function E(V){return{globalLimitValue:(0,n.css)({fontWeight:V.typography.fontWeightBold}),icon:(0,n.css)({fill:V.colors.warning.text})}}var C=e(75648),M=e(39890);const S=({rule:V})=>{const K=(0,s.of)(I);return(0,M.lf)(V.health)?(0,t.jsx)(r.m,{theme:"error",content:V.lastError||"No error message provided.",children:(0,t.jsxs)("div",{className:K.warn,children:[(0,t.jsx)(D.I,{name:"exclamation-triangle"}),(0,t.jsx)("span",{children:"error"})]})}):(0,t.jsx)(t.Fragment,{children:V.health})},I=V=>({warn:(0,n.css)({display:"inline-flex",flexDirection:"row",alignItems:"center",gap:V.spacing(1),color:V.colors.warning.text})});var T=e(70416),b=e(67061),R=e(62930),A=e(94822),L=e(30423);const U=({rule:V,isDeleting:K,isCreating:H,isPaused:X})=>{const k=(0,s.of)(W),{promRule:Y}=V,Z=(0,i.useMemo)(()=>{if(Y&&(0,h.Z8)(Y)&&Y.alerts?.length&&Y.state!==A.cF.Inactive){const se=Y.activeAt?new Date(Y.activeAt):(0,h.Om)(Y);if(se)return(0,t.jsxs)("span",{title:String(se),className:k.for,children:["for"," ",(0,T.dU)({start:se,end:new Date},!1)]})}return null},[Y,k]);return K?(0,t.jsxs)(b.B,{gap:1,children:[(0,t.jsx)(R.y,{}),"Deleting"]}):H?(0,t.jsxs)(b.B,{gap:1,children:[(0,t.jsx)(R.y,{}),"Creating"]}):Y&&(0,h.Z8)(Y)?(0,t.jsxs)(b.B,{gap:1,children:[(0,t.jsx)(L.C,{state:Y.state,isPaused:X}),!X&&Z]}):Y&&(0,h.KB)(Y)?(0,t.jsx)(t.Fragment,{children:"Recording rule"}):(0,t.jsx)(t.Fragment,{children:"n/a"})},W=V=>({for:(0,n.css)({fontSize:V.typography.bodySmall.fontSize,color:V.colors.text.secondary,whiteSpace:"nowrap",paddingTop:"2px"})}),w=({rules:V,className:K,showGuidelines:H=!1,emptyMessage:X="No rules found.",showGroupColumn:k=!1,showSummaryColumn:Y=!1,showNextEvaluationColumn:Z=!1})=>{const se=(0,s.of)(N),j=(0,n.cx)(se.wrapper,K,{[se.wrapperMargin]:H}),q=(0,i.useMemo)(()=>V.map((z,te)=>({id:`${z.namespace.name}-${z.group.name}-${z.name}-${te}`,data:z})),[V]),ne=B(Y,k,Z);if(!V.length)return(0,t.jsx)("div",{className:(0,n.cx)(j,se.emptyMessage),children:X});const oe=H?l.B:g.E;return(0,t.jsx)("div",{className:j,"data-testid":"rules-table",children:(0,t.jsx)(oe,{cols:ne,isExpandable:!0,items:q,renderExpandedContent:({data:z})=>(0,t.jsx)(C.DI,{rule:z}),pagination:{itemsPerPage:f.FG},paginationStyles:se.pagination})})},N=V=>({wrapperMargin:(0,n.css)({[V.breakpoints.up("md")]:{marginLeft:"36px"}}),emptyMessage:(0,n.css)({padding:V.spacing(1)}),wrapper:(0,n.css)({width:"auto",borderRadius:V.shape.radius.default}),pagination:(0,n.css)({display:"flex",margin:0,paddingTop:V.spacing(1),paddingBottom:V.spacing(.25),justifyContent:"center",borderLeft:`1px solid ${V.colors.border.medium}`,borderRight:`1px solid ${V.colors.border.medium}`,borderBottom:`1px solid ${V.colors.border.medium}`})});function B(V,K,H){const{hasRuler:X,rulerRulesLoaded:k}=(0,a.y)();return(0,i.useMemo)(()=>{const Y=j=>{const{namespace:q,promRule:ne,rulerRule:oe}=j,{rulesSource:z}=q;return!!(X(z)&&k(z)&&ne&&!oe)},Z=j=>{const{namespace:q,promRule:ne,rulerRule:oe}=j,{rulesSource:z}=q;return!!(X(z)&&k(z)&&oe&&!ne)},se=[{id:"state",label:"State",renderCell:({data:j})=>{const q=Y(j),ne=Z(j),oe=(0,h.lT)(j.rulerRule)&&(0,h.HH)(j.rulerRule);return(0,t.jsx)(U,{rule:j,isDeleting:q,isCreating:ne,isPaused:oe})},size:"165px"},{id:"name",label:"Name",renderCell:({data:j})=>j.name,size:H?4:5},{id:"metadata",label:"",renderCell:({data:j})=>{const q=j.rulerRule,ne=(0,h.uo)(j);return ne?(0,t.jsx)(c.T,{pluginId:ne.pluginId}):(0,h.lT)(q)&&q.grafana_alert.provenance?(0,t.jsx)(p.rS,{}):null},size:"100px"},{id:"warnings",label:"",renderCell:({data:j})=>(0,t.jsx)(x,{rule:j}),size:"45px"},{id:"health",label:"Health",renderCell:({data:{promRule:j,group:q}})=>j?(0,t.jsx)(S,{rule:j}):null,size:"75px"}];return V&&se.push({id:"summary",label:"Summary",renderCell:({data:j})=>(0,t.jsx)(y.Y,{input:j.annotations[o.YH.summary]??""}),size:H?4:5}),H&&se.push({id:"nextEvaluation",label:"Next evaluation",renderCell:({data:j})=>{const q=(0,d.C)(j.promRule?.lastEvaluation,j.group.interval);return q&&(0,t.jsx)(r.m,{placement:"top",content:`${q?.fullDate}`,theme:"info",children:(0,t.jsx)("span",{children:q?.humanized})})},size:2}),K&&se.push({id:"group",label:"Group",renderCell:({data:j})=>{const{namespace:q,group:ne}=j;return ne.name==="default"?(0,t.jsx)(m.c,{namespace:q.name}):(0,t.jsx)(m.c,{namespace:q.name,group:ne.name})},size:5}),se.push({id:"actions",label:"Actions",renderCell:({data:j})=>{const q=Y(j),ne=Z(j);return(0,t.jsx)(v.l,{compact:!0,showViewButton:!q&&!ne,rule:j,rulesSource:j.namespace.rulesSource})},size:"200px"}),se},[V,K,H,X,k])}},97754:(G,O,e)=>{"use strict";e.d(O,{y:()=>r});var t=e(74848),n=e(60021),i=e(65415);const s={[n.Or.Active]:"bad",[n.Or.Unprocessed]:"neutral",[n.Or.Suppressed]:"info"},r=({state:f})=>(0,t.jsx)(i.O,{state:s[f],children:f})},98569:(G,O,e)=>{"use strict";e.d(O,{G:()=>le,A:()=>ae});var t=e(74848),n=e(32196),i=e(2543),s=e(96540),r=e(49785),f=e(40996),a=e(70416),c=e(47232),o=e(17172),h=e(12131),g=e(32264),l=e(39558),p=e(42418),m=e(40845),y=e(84167),d=e(88575),v=e(10354),u=e(21744),D=e(67061),P=e(55852),x=e(91540),E=e(55740),C=e(57220),M=e(60021),S=e(19073),I=e(98164),T=e(56361),b=e(25994),R=e(90182),A=e(29158),L=e(79938);const U=({className:re,required:ce,ruleUid:me})=>{const ee=(0,m.of)(W),de=(0,r.xW)(),{control:De,register:fe,formState:{errors:Te}}=de,{fields:je=[],append:He,remove:Be}=(0,r.jz)({name:"matchers"}),[Ne,{data:Re}]=L.hK.endpoints.getAlertRule.useLazyQuery();return(0,s.useEffect)(()=>{me&&Ne({uid:me})},[Ne,me]),(0,t.jsx)("div",{className:re,children:(0,t.jsx)(d.D,{label:"Refine affected alerts",required:ce,children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:(0,n.cx)(ee.matchers,ee.indent),children:[Re&&(0,t.jsxs)("div",{children:[(0,t.jsx)(d.D,{label:"Alert rule",disabled:!0,children:(0,t.jsx)(v.p,{id:"alert-rule-name",defaultValue:Re.grafana_alert.title,disabled:!0})}),(0,t.jsx)(b.c,{})]}),je.map((Se,We)=>(0,t.jsxs)("div",{className:ee.row,"data-testid":"matcher",children:[(0,t.jsx)(d.D,{label:"Label",invalid:!!Te?.matchers?.[We]?.name,error:Te?.matchers?.[We]?.name?.message,children:(0,t.jsx)(v.p,{...fe(`matchers.${We}.name`,{required:{value:ce,message:"Required."}}),defaultValue:Se.name,placeholder:"label",id:`matcher-${We}-label`})}),(0,t.jsx)(d.D,{label:"Operator",children:(0,t.jsx)(r.xI,{control:De,render:({field:{onChange:Ke,ref:Xe,...Je}})=>(0,t.jsx)(R.l6,{...Je,onChange:st=>Ke(st.value),className:ee.matcherOptions,options:I.xH,"aria-label":"operator",id:`matcher-${We}-operator`}),defaultValue:Se.operator||I.xH[0].value,name:`matchers.${We}.operator`,rules:{required:{value:ce,message:"Required."}}})}),(0,t.jsx)(d.D,{label:"Value",invalid:!!Te?.matchers?.[We]?.value,error:Te?.matchers?.[We]?.value?.message,children:(0,t.jsx)(v.p,{...fe(`matchers.${We}.value`,{required:{value:ce,message:"Required."}}),defaultValue:Se.value,placeholder:"value",id:`matcher-${We}-value`})}),(je.length>1||!ce)&&(0,t.jsx)(A.K,{"aria-label":"Remove matcher",className:ee.removeButton,name:"trash-alt",onClick:()=>Be(We),children:"Remove"})]},`${Se.id}`))]}),(0,t.jsx)(P.$n,{className:ee.indent,tooltip:"Refine which alert instances are silenced by selecting label matchers",type:"button",icon:"plus",variant:"secondary",onClick:()=>{const Se={name:"",value:"",operator:M.ho.equal};He(Se)},children:"Add matcher"})]})})})},W=re=>({wrapper:(0,n.css)({marginTop:re.spacing(2)}),row:(0,n.css)({marginTop:re.spacing(1),display:"flex",alignItems:"flex-start",flexDirection:"row",backgroundColor:re.colors.background.secondary,padding:`${re.spacing(1)} ${re.spacing(1)} 0 ${re.spacing(1)}`,"& > * + *":{marginLeft:re.spacing(2)}}),removeButton:(0,n.css)({marginLeft:re.spacing(1),marginTop:re.spacing(2.5)}),matcherOptions:(0,n.css)({minWidth:"140px"}),matchers:(0,n.css)({maxWidth:`${re.breakpoints.values.sm}px`,margin:`${re.spacing(1)} 0`,paddingTop:re.spacing(.5)}),indent:(0,n.css)({marginLeft:re.spacing(2)})}),w=U;var N=e(54230);const B=()=>{const{control:re,getValues:ce}=(0,r.xW)(),{field:{onChange:me,value:ee},fieldState:{invalid:de}}=(0,r.as)({name:"startsAt",control:re,rules:{validate:Se=>ce().endsAt>Se}}),{field:{onChange:De,value:fe},fieldState:{invalid:Te}}=(0,r.as)({name:"endsAt",control:re,rules:{validate:Se=>ce().startsAt<Se}}),{field:{onChange:je,value:He}}=(0,r.as)({name:"timeZone",control:re}),Be=de||Te,Ne=(0,c.KQ)(ee),Re=(0,c.KQ)(fe);return(0,t.jsx)(d.D,{className:V.timeRange,label:"Silence start and end",error:Be?"To is before or the same as from":"",invalid:Be,children:(0,t.jsx)(N.b,{value:{from:Ne,to:Re,raw:{from:Ne,to:Re}},timeZone:He,onChange:Se=>{me((0,c.KQ)(Se.from)),De((0,c.KQ)(Se.to))},onChangeTimeZone:Se=>je(Se),hideTimeZone:!1,hideQuickRanges:!0,placeholder:"Select time range"})})},V={timeRange:(0,n.css)({width:"400px"})};var K=e(45214),H=e(39938),X=e(82843),k=e(25968),Y=e(69087),Z=e(75591),se=e(97754);const j=(re,ce,me)=>{const[ee,de]=(0,s.useState)();(0,f.A)(re,ce,[ee]),(0,K.A)(()=>{de(me)},[me])},q=({amSourceName:re,matchers:ce,ruleUid:me})=>{const ee=[...me?[{name:E.kW,value:me,operator:M.ho.equal}]:[],...ce].map(I.Wc),de=X.m.endpoints.getAlertmanagerAlerts.useLazyQuery,De=(0,m.of)(oe),fe=ne(),Te=me||ce.some(Se=>Se.value&&Se.name),[je,{currentData:He=[],isFetching:Be,isError:Ne}]=de();if(j(()=>{Te&&je({amSourceName:re,filter:{matchers:ee}})},500,[re,ee]),Ne)return(0,t.jsx)(p.F,{title:"Preview not available",severity:"error",children:"Error occured when generating preview of affected alerts. Are your matchers valid?"});const Re=He.map(Se=>({id:Se.fingerprint,data:Se}));return(0,t.jsxs)("div",{children:[(0,t.jsxs)("h4",{className:De.title,children:["Affected alert rule instances",Re.length>0?(0,t.jsx)(H.E,{className:De.badge,color:"blue",text:Re.length}):null]}),!Te&&(0,t.jsx)("span",{children:"Add a valid matcher to see affected alerts"}),Be&&(0,t.jsx)(l._,{text:"Loading affected alert rule instances..."}),!Be&&!Ne&&Te&&(0,t.jsx)("div",{className:De.table,children:Re.length>0?(0,t.jsx)(Z.E,{items:Re,isExpandable:!1,cols:fe,pagination:{itemsPerPage:10}}):(0,t.jsx)("span",{children:"No firing alert instances found"})})]})};function ne(){const re=(0,m.of)(oe);return[{id:"state",label:"State",renderCell:function({data:me}){return(0,t.jsx)(se.y,{state:me.status.state})},size:"120px",className:re.stateColumn},{id:"labels",label:"Labels",renderCell:function({data:me}){return(0,t.jsx)(Y.m,{labels:me.labels,size:"sm"})},size:"auto"},{id:"created",label:"Created",renderCell:function({data:me}){return(0,t.jsx)(t.Fragment,{children:(0,k.mo)(me.startsAt)?"-":(0,c.KQ)(me.startsAt).format("YYYY-MM-DD HH:mm:ss")})},size:"180px"}]}const oe=re=>({table:(0,n.css)({maxWidth:`${re.breakpoints.values.lg}px`}),moreMatches:(0,n.css)({marginTop:re.spacing(1)}),title:(0,n.css)({display:"flex",alignItems:"center"}),badge:(0,n.css)({marginLeft:re.spacing(1)}),stateColumn:(0,n.css)({display:"flex",alignItems:"center"})});var z=e(17272);const te=({silenceId:re,alertManagerSourceName:ce})=>{const{data:me,isLoading:ee,error:de}=x.F.endpoints.getSilence.useQuery({id:re,datasourceUid:(0,C.w5)(ce),ruleMetadata:!0,accessControl:!0}),De=me?.matchers?.find(Be=>Be.name===E.kW)?.value,fe=ce===C.hY,Te=(0,s.useMemo)(()=>{if(!me)return;const Be=me.matchers?.filter(Ne=>Ne.name!==E.kW);return(0,z.Ee)({...me,matchers:Be})},[me]);return re&&ee?(0,t.jsx)(l._,{text:"Loading existing silence information..."}):(0,o.NF)(de)&&de.status===404?(0,t.jsx)(p.F,{title:`Existing silence "${re}" not found`,severity:"warning"}):(fe?me?.accessControl?.write:!0)?(0,t.jsx)(le,{ruleUid:De,formValues:Te,alertManagerSourceName:ce}):(0,t.jsx)(p.F,{title:"You do not have permission to edit/recreate this silence",severity:"error"})},le=({formValues:re=(0,z.Di)(),alertManagerSourceName:ce,onSilenceCreated:me,onCancel:ee,ruleUid:de})=>{const[De,fe]=(0,S.L7)(S.QI.PreviewSilencedInstances),Te=De&&fe,[je,{isLoading:He}]=x.F.endpoints.createSilence.useMutation(),Be=(0,r.mN)({defaultValues:re}),Ne=(0,m.of)(ie),{register:Re,handleSubmit:Se,formState:We,watch:Ke,setValue:Xe,clearErrors:Je}=Be,[st,pt,xt,ot]=Ke(["duration","startsAt","endsAt","matchers"]),$e=()=>{h.Ny.push((0,T.nL)("/alerting/silences",ce))},ve=me||$e,be=ee||$e,he=async xe=>{const{id:Ae,startsAt:Ee,endsAt:Ie,comment:Qe,createdBy:at,matchers:ft}=xe;de&&ft.push({name:E.kW,value:de,operator:M.ho.equal});const ct=ft.map(I.Wc).filter(Pt=>Pt.name&&Pt.value),vt=(0,i.pickBy)({id:Ae,startsAt:Ee,endsAt:Ie,comment:Qe,createdBy:at,matchers:ct},Pt=>!!Pt);await je({datasourceUid:(0,C.w5)(ce),payload:vt}).unwrap().then(Pt=>{ve?.(Pt)})},[ye,Pe]=(0,s.useState)(st);(0,f.A)(()=>{if((0,a.vd)(pt)&&(0,a.vd)(xt))if(st!==ye)Xe("endsAt",(0,c.KQ)((0,a.Ri)(new Date(pt),(0,a.E9)(st))).toISOString()),Pe(st);else{const xe=new Date(pt).valueOf();if(new Date(xt).valueOf()>xe){const Ee=(0,a.dU)({start:new Date(pt),end:new Date(xt)});Xe("duration",Ee),Pe(Ee)}}},700,[Je,st,xt,ye,Xe,pt]);const ge=!!(g.$.bootData.user.isSignedIn&&g.$.bootData.user.name);return(0,t.jsx)(r.Op,{...Be,children:(0,t.jsxs)("form",{onSubmit:Se(he),children:[(0,t.jsxs)(y.n,{className:Ne.formContainer,children:[(0,t.jsxs)("div",{className:Ne.silencePeriod,children:[(0,t.jsx)(B,{}),(0,t.jsx)(d.D,{label:"Duration",invalid:!!We.errors.duration,error:We.errors.duration&&(We.errors.duration.type==="required"?"Required field":We.errors.duration.message),children:(0,t.jsx)(v.p,{...Re("duration",{validate:xe=>Object.keys((0,a.E9)(xe)).length===0?"Invalid duration. Valid example: 1d 4h (Available units: y, M, w, d, h, m, s)":void 0}),id:"duration"})})]}),(0,t.jsx)(w,{required:!de,ruleUid:de}),(0,t.jsx)(d.D,{label:"Comment",required:!0,error:We.errors.comment?.message,invalid:!!We.errors.comment,children:(0,t.jsx)(u.f,{...Re("comment",{required:{value:!0,message:"Required."}}),rows:5,placeholder:"Details about the silence",id:"comment"})}),!ge&&(0,t.jsx)(d.D,{label:"Created By",required:!0,error:We.errors.createdBy?.message,invalid:!!We.errors.createdBy,children:(0,t.jsx)(v.p,{...Re("createdBy",{required:{value:!0,message:"Required."}}),placeholder:"Who's creating the silence"})}),Te&&(0,t.jsx)(q,{amSourceName:ce,matchers:ot,ruleUid:de})]}),(0,t.jsxs)(D.B,{gap:1,children:[He&&(0,t.jsx)(P.$n,{disabled:!0,icon:"spinner",variant:"primary",children:"Saving..."}),!He&&(0,t.jsx)(P.$n,{type:"submit",children:"Save silence"}),(0,t.jsx)(P.z9,{onClick:be,variant:"secondary",children:"Cancel"})]})]})})},ie=re=>({formContainer:(0,n.css)({maxWidth:re.breakpoints.values.md}),alertRule:(0,n.css)({paddingBottom:re.spacing(2)}),silencePeriod:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"flex-start",gap:re.spacing(1),maxWidth:re.breakpoints.values.sm,paddingTop:re.spacing(2)})}),ae=te},17272:(G,O,e)=>{"use strict";e.d(O,{Di:()=>h,Ee:()=>o,LP:()=>c});var t=e(70416),n=e(43127),i=e(47232),s=e(32264),r=e(98164),f=e(32642),a=e(60021);const c=g=>{const l={},p=g.get("comment"),m=g.getAll("matcher"),y=(0,f.ou)(m);return y.length&&(l.matchers=y.map(r.MU)),p&&(l.comment=p),l},o=g=>{const l=new Date,m=Date.parse(g.endsAt)<Date.now()?{start:l,end:(0,t.Ri)(l,{hours:2})}:{start:new Date(g.startsAt),end:new Date(g.endsAt)};return{id:g.id,startsAt:m.start.toISOString(),endsAt:m.end.toISOString(),comment:g.comment,createdBy:g.createdBy,duration:(0,t.dU)(m),isRegex:!1,matchers:g.matchers?.map(r.MU)||[],matcherName:"",matcherValue:"",timeZone:n.lE}},h=g=>{const l=new Date,p=(0,t.Ri)(l,{hours:2});return{id:"",startsAt:l.toISOString(),endsAt:p.toISOString(),comment:`created ${(0,i.KQ)().format("YYYY-MM-DD HH:mm")}`,createdBy:s.$.bootData.user.name,duration:"2h",isRegex:!1,matcherName:"",matcherValue:"",timeZone:n.lE,matchers:[{name:"",value:"",operator:a.ho.equal}],...g}}},96065:(G,O,e)=>{"use strict";e.d(O,{Y:()=>f});var t=e(72635),n=e(79938),i=e(48070),s=e(6833),r=e(43482);function f(){const[a]=(0,r.D)(),[c]=n.hK.endpoints.upsertRuleGroupForNamespace.useMutation(),[o]=n.hK.endpoints.deleteRuleGroupFromNamespace.useMutation();return(0,s.Yb)(async(h,g)=>{const{groupName:l,namespaceName:p}=h,m=(0,i.KH)({rule:g}),{newRuleGroupDefinition:y,rulerConfig:d}=await a(h,m),v=(0,t.t)("alerting.rules.delete-rule.success","Rule successfully deleted");return y.rules.length===0?o({rulerConfig:d,namespace:p,group:l,requestOptions:{successMessage:v}}).unwrap():c({rulerConfig:d,namespace:p,payload:y,requestOptions:{successMessage:v}}).unwrap()})}},43482:(G,O,e)=>{"use strict";e.d(O,{D:()=>r});var t=e(99140),n=e(79938),i=e(48070),s=e(23770);function r(){const[f,a]=n.hK.endpoints.getRuleGroupForNamespace.useLazyQuery();return[async(o,h)=>{const{dataSourceName:g,groupName:l,namespaceName:p}=o;await(0,t.JD)((0,s.DC)({rulesSourceName:g}));const m=(0,s.Qt)(t.Gu,g),y=await f({rulerConfig:m,namespace:p,group:l}).unwrap();return{newRuleGroupDefinition:(0,i.i3)(y,h),rulerConfig:m}},a]}},19073:(G,O,e)=>{"use strict";e.d(O,{Ej:()=>D,Hl:()=>S,L7:()=>M,QI:()=>p,RY:()=>y,e2:()=>u,iI:()=>C,j5:()=>m,mh:()=>P});var t=e(96540),n=e(16233),i=e(11167),s=e(60021),r=e(31678),f=e(82843),a=e(70383),c=e(75471),o=e(57220),h=e(56361),g=e(23662),l=e(97009),p=(b=>(b.ViewExternalConfiguration="view-external-configuration",b.UpdateExternalConfiguration="update-external-configuration",b.CreateContactPoint="create-contact-point",b.ViewContactPoint="view-contact-point",b.UpdateContactPoint="edit-contact-points",b.DeleteContactPoint="delete-contact-point",b.ExportContactPoint="export-contact-point",b.CreateNotificationTemplate="create-notification-template",b.ViewNotificationTemplate="view-notification-template",b.UpdateNotificationTemplate="edit-notification-template",b.DeleteNotificationTemplate="delete-notification-template",b.DecryptSecrets="decrypt-secrets",b.CreateNotificationPolicy="create-notification-policy",b.ViewNotificationPolicyTree="view-notification-policy-tree",b.UpdateNotificationPolicyTree="update-notification-policy-tree",b.DeleteNotificationPolicy="delete-notification-policy",b.ExportNotificationPolicies="export-notification-policies",b.ViewAutogeneratedPolicyTree="view-autogenerated-policy-tree",b.CreateSilence="create-silence",b.ViewSilence="view-silence",b.UpdateSilence="update-silence",b.PreviewSilencedInstances="preview-silenced-alerts",b.ViewMuteTiming="view-mute-timing",b.CreateMuteTiming="create-mute-timing",b.UpdateMuteTiming="update-mute-timing",b.DeleteMuteTiming="delete-mute-timing",b.ExportMuteTimings="export-mute-timings",b))(p||{}),m=(b=>(b.Duplicate="duplicate-alert-rule",b.View="view-alert-rule",b.Update="update-alert-rule",b.Delete="delete-alert-rule",b.Explore="explore-alert-rule",b.Silence="silence-alert-rule",b.ModifyExport="modify-export-rule",b.Pause="pause-alert-rule",b))(m||{}),y=(b=>(b.CreateAlertRule="create-alert-rule",b.ViewAlertRule="view-alert-rule",b.UpdateAlertRule="update-alert-rule",b.DeleteAlertRule="delete-alert-rule",b.ExportGrafanaManagedRules="export-grafana-managed-rules",b.ReadConfigurationStatus="read-configuration-status",b.CreateExternalAlertRule="create-external-alert-rule",b.ViewExternalAlertRule="view-external-alert-rule",b.UpdateExternalAlertRule="update-external-alert-rule",b.DeleteExternalAlertRule="delete-external-alert-rule",b))(y||{});const d=!0,v=!1,u=()=>({"create-alert-rule":T(d,r.AccessControlAction.AlertingRuleCreate),"view-alert-rule":T(d,r.AccessControlAction.AlertingRuleRead),"update-alert-rule":T(d,r.AccessControlAction.AlertingRuleUpdate),"delete-alert-rule":T(d,r.AccessControlAction.AlertingRuleDelete),"export-grafana-managed-rules":T(d,r.AccessControlAction.AlertingRuleRead),"read-configuration-status":[d,n.TP.hasPermission(r.AccessControlAction.AlertingInstanceRead)||n.TP.hasPermission(r.AccessControlAction.AlertingNotificationsRead)],"create-external-alert-rule":T(d,r.AccessControlAction.AlertingRuleExternalWrite),"view-external-alert-rule":T(d,r.AccessControlAction.AlertingRuleExternalRead),"update-external-alert-rule":T(d,r.AccessControlAction.AlertingRuleExternalWrite),"delete-external-alert-rule":T(d,r.AccessControlAction.AlertingRuleExternalWrite)}),D=b=>u()[b];function P(b,R){const A=E(b);return(0,t.useMemo)(()=>A[R],[A,R])}function x(b,R){const A=E(b);return useMemo(()=>R.map(L=>A[L]),[A,R])}function E(b){const R=b.namespace.rulesSource,A=typeof R=="string"?R:R.name,L=(0,g.lT)(b.rulerRule)&&!!b.rulerRule.grafana_alert.provenance,U=(0,g.YN)(b.group),W=(0,g.lT)(b.rulerRule),w=(0,g.Tm)(b),N=L||U||w,{isEditable:B,isRemovable:V,isRulerAvailable:K=!1,loading:H}=(0,l.g)(A,b.rulerRule),[X,k]=D("export-grafana-managed-rules"),Y=H?v:K,Z=N?v:Y,se=w?v:Y,j=(0,c.Wd)(A),q=I(b);return{"duplicate-alert-rule":T(se,j.create),"view-alert-rule":T(d,j.read),"update-alert-rule":[Z,B??!1],"delete-alert-rule":[Z,V??!1],"explore-alert-rule":T(d,r.AccessControlAction.DataSourcesExplore),"silence-alert-rule":q,"modify-export-rule":[W,k],"pause-alert-rule":[Z&&W,B??!1]}}function C(){const{selectedAlertmanager:b,hasConfigurationAPI:R,isGrafanaAlertmanager:A}=(0,a.VI)(),L=(0,c.lV)(b),U=(0,c.jy)(b);return{"view-external-configuration":T(d,r.AccessControlAction.AlertingNotificationsExternalRead),"update-external-configuration":T(R,r.AccessControlAction.AlertingNotificationsExternalWrite),"create-contact-point":T(R,L.create),"view-contact-point":T(d,L.read),"edit-contact-points":T(R,L.update),"delete-contact-point":T(R,L.delete),"export-contact-point":T(A,L.read),"create-notification-template":T(R,L.create),"view-notification-template":T(d,L.read),"edit-notification-template":T(R,L.update),"delete-notification-template":T(R,L.delete),"create-notification-policy":T(R,L.create),"view-notification-policy-tree":T(d,L.read),"update-notification-policy-tree":T(R,L.update),"delete-notification-policy":T(R,L.delete),"export-notification-policies":T(A,L.read),"decrypt-secrets":T(A,L.provisioning.readSecrets),"view-autogenerated-policy-tree":[A,(0,h.qc)()],"create-silence":T(d,U.create),"view-silence":T(d,U.read),"update-silence":T(d,U.update),"preview-silenced-alerts":T(d,U.read),"create-mute-timing":T(R,L.create),"view-mute-timing":T(d,L.read),"update-mute-timing":T(R,L.update),"delete-mute-timing":T(R,L.delete),"export-mute-timings":T(A,L.read)}}function M(b){const R=C();return(0,t.useMemo)(()=>R[b],[R,b])}function S(b){const R=C();return(0,t.useMemo)(()=>b.map(A=>R[A]),[R,b])}function I(b){const A=b.namespace.rulesSource===o.hY,{currentData:L,isLoading:U}=f.m.endpoints.getGrafanaAlertingConfigurationStatus.useQuery(void 0,{skip:!A}),W=(0,g.lT)(b.rulerRule)?b.rulerRule.grafana_alert.namespace_uid:void 0,{loading:w,folder:N}=(0,i.a)(W);if(!A||U||w||!N)return[!1,!1];const B=L?.alertmanagersChoice===s.nA.External,V=L?.alertmanagersChoice===s.nA.All,K=!B||V,{accessControl:H={}}=N,X=!!(n.TP.hasPermission(r.AccessControlAction.AlertingInstanceCreate)||H[r.AccessControlAction.AlertingSilenceCreate]);return[K,X]}const T=(b,R)=>[b,n.TP.hasPermission(R)]},62190:(G,O,e)=>{"use strict";e.d(O,{W:()=>i});var t=e(96540),n=e(57220);function i(s){return(0,t.useMemo)(()=>(0,n.sq)(s),[s])}},36135:(G,O,e)=>{"use strict";e.d(O,{g:()=>s});var t=e(96540),n=e(19347),i=e(26657);function s(r){return{allDataSourcesAvailable:(0,t.useMemo)(()=>r.filter(a=>!(0,i.s9)(a.datasourceUid)).every(a=>!!(0,n.l)().getInstanceSettings(a.datasourceUid)),[r])}}},6833:(G,O,e)=>{"use strict";e.d(O,{Gz:()=>h,VP:()=>o,Yb:()=>s});var t=e(74848),n=e(96540),i=e(56361);function s(l,p){const[m,y]=(0,n.useState)({status:"not-executed",error:void 0,result:p}),d=(0,n.useRef)(),v=(0,n.useRef)(),u=r({execute(...D){v.current=D;const P=l(...D);return d.current=P,y(x=>({...x,status:"loading"})),P.then(x=>{P===d.current&&y(E=>({...E,status:"success",error:void 0,result:x}))},x=>{P===d.current&&y(E=>({...E,status:"error",error:x}))}),P},reset(){y({status:"not-executed",error:void 0,result:p}),d.current=void 0,v.current=void 0}});return[m,(0,n.useMemo)(()=>({reset(){u.current.reset()},execute:(...D)=>u.current.execute(...D)}),[]),{promise:d.current,lastArgs:v.current}]}function r(l){const p=(0,n.useRef)(l);return p.current=l,(0,n.useMemo)(()=>Object.freeze({get current(){return p.current}}),[])}function f(l){return l.status==="error"}function a(l){return l.status==="success"}function c(l){return l.status==="not-executed"}function o(l){return l.status==="loading"}function h(...l){return{uninitialized:l.every(c),loading:l.some(o),error:l.find(f)?.error,success:l.some(a)}}function g({state:l}){return jsxs(Fragment,{children:[c(l)&&"uninitialized",o(l)&&"loading",a(l)&&"success",a(l)&&`result: ${JSON.stringify(l.result,null,2)}`,f(l)&&`error: ${stringifyErrorLike(l.error)}`]})}},730:(G,O,e)=>{"use strict";e.d(O,{$q:()=>x,Ll:()=>P,O3:()=>C,ZU:()=>v,we:()=>m});var t=e(96540),n=e(16817),i=e(31678),s=e(79938),r=e(77583),f=e(23770),a=e(57220),c=e(88467),o=e(18461),h=e(23662),g=e(9518),l=e(61410);function p(M,S){const I=y(S),T=useCombinedRuleNamespaces(S),b=useMemo(()=>{if(!M||!S||T.length===0)return[];const R=[];for(const A of T)for(const L of A.groups)for(const U of L.rules)U.name===M&&R.push(U);return R},[M,S,T]);return{...I,result:b}}function m(M,S,I){const T=(0,a.oh)(S),{dsFeatures:b,isLoadingDsFeatures:R}=C(S),{currentData:A,isLoading:L,error:U}=s.hK.endpoints.prometheusRuleNamespaces.useQuery({ruleSourceName:S,ruleName:M,namespace:I?.namespace,groupName:I?.groupName}),[W]=s.hK.endpoints.getRuleGroupForNamespace.useLazyQuery(),{loading:w,error:N,value:B}=(0,n.A)(async()=>{if(!T)throw new Error("Unable to obtain data source settings");if(U)throw new Error("Unable to obtain Prometheus rules");const V=A||[],K=[];if(b?.rulerConfig){const k=b.rulerConfig,Y=V.map(Z=>Z.groups.map(se=>({namespace:Z,group:se}))).flat();await Promise.allSettled(Y.map(async Z=>{const se=await W({rulerConfig:k,namespace:Z.namespace.name,group:Z.group.name}).unwrap();K.push(se)}))}return V.map(k=>(0,g.O6)(T,k,K)).flatMap(k=>k.groups.flatMap(Y=>Y.rules))},[T,b,L,U,A,W]);return{loading:R||w,error:N,rules:B}}function y(M,S){const I=useDispatch(),T=useUnifiedAlertingSelector(U=>U.promRules),b=d(M,T),R=useUnifiedAlertingSelector(U=>U.rulerRules),A=d(M,R),{loading:L}=useAsync(async()=>{M&&await I(fetchPromAndRulerRulesAction({rulesSourceName:M,identifier:S}))},[I,M]);return{loading:L,error:b.error??isRulerNotSupportedResponse(A)?void 0:A.error,dispatched:b.dispatched&&A.dispatched}}function d(M,S){if(!M)return initialAsyncRequestState;const I=S[M];return I||initialAsyncRequestState}function v({ruleIdentifier:M,limitAlerts:S}){const{ruleSourceName:I}=M,T=D(M),{dsFeatures:b,isLoadingDsFeatures:R}=C(I),{loading:A,error:L,result:U}=u(M),{currentData:W,isLoading:w,error:N}=s.hK.endpoints.prometheusRuleNamespaces.useQuery({ruleSourceName:M.ruleSourceName,namespace:U?.namespace,groupName:U?.group,ruleName:U?.ruleName,limitAlerts:S},{skip:!U||A,refetchOnMountOrArgChange:!0}),[B,{currentData:V,isLoading:K,error:H,isUninitialized:X}]=s.hK.endpoints.getRuleGroupForNamespace.useLazyQuery();(0,t.useEffect)(()=>{!b?.rulerConfig||!U||B({rulerConfig:b.rulerConfig,namespace:U.namespace,group:U.group})},[b,B,U]);const k=(0,t.useMemo)(()=>{if(!(!W||!T)&&W.length>0){const Y=W.map(Z=>(0,g.O6)(T,Z,V?[V]:[]));for(const Z of Y)for(const se of Z.groups)for(const j of se.rules){const q=o.UP(I,j);if(o.LC(q,M))return j}}},[M,I,W,V,T]);return{loading:R||w||K||X,error:L??N??H,result:k}}function u(M){const{isLoading:S,currentData:I,error:T,isUninitialized:b}=s.hK.endpoints.getAlertRule.useQuery({uid:(0,h.A4)(M)?M.uid:""},{skip:!(0,h.A4)(M),refetchOnMountOrArgChange:!0});return(0,t.useMemo)(()=>(0,h.Mj)(M)||(0,h.X4)(M)?{result:{namespace:M.namespace,group:M.groupName,ruleName:M.ruleName},loading:!1}:(0,h.A4)(M)?S||b?{loading:!0}:T?{loading:!1,error:T}:I?{result:{namespace:I.grafana_alert.namespace_uid,group:I.grafana_alert.rule_group,ruleName:I.grafana_alert.title},loading:!1}:{loading:!1,error:new Error(`Unable to obtain rule location for rule ${M.uid}`)}:{loading:!1,error:new Error("Unsupported rule identifier")},[M,S,b,T,I])}function D(M){return(0,h.A4)(M)?"grafana":(0,a.oh)(M.ruleSourceName)}function P({ruleIdentifier:M}){const S=D(M),{dsFeatures:I,isLoadingDsFeatures:T}=C(M.ruleSourceName),{loading:b,error:R,result:A}=u(M),[L,{currentData:U,isLoading:W,isUninitialized:w,error:N}]=s.hK.endpoints.getRuleGroupForNamespace.useLazyQuery();(0,t.useEffect)(()=>{!I?.rulerConfig||!A||L({rulerConfig:I.rulerConfig,namespace:A.namespace,group:A.group})},[I,L,A]);const B=(0,t.useMemo)(()=>{const{ruleSourceName:V}=M;if(!U||!S||!A)return;const K=U.rules.find(H=>{const X=o.P1(V,A.namespace,A.group,H);return o.LC(X,M)});if(K)return{ruleSourceName:V,group:U,namespace:A.namespace,rule:K}},[M,U,S,A]);return{loading:b||T||W||w,error:R??N,result:B}}const x={dataSourceName:a.hY,apiVersion:"legacy"},E={rulerConfig:x};function C(M){const S=(0,a.z2)(M),{currentData:I,isLoading:T}=r.L.endpoints.discoverDsFeatures.useQuery({rulesSourceName:M},{skip:S});return S?{isLoadingDsFeatures:!1,dsFeatures:E}:{isLoadingDsFeatures:T,dsFeatures:I}}},9518:(G,O,e)=>{"use strict";e.d(O,{Jr:()=>d,NW:()=>x,O6:()=>m,Tj:()=>E,Ug:()=>P,dy:()=>l,kU:()=>R});var t=e(2543),n=e.n(t),i=e(96540),s=e(54317),r=e(94822),f=e(79938),a=e(55740),c=e(57220),o=e(23662),h=e(730),g=e(61410);function l(A,L){const U=(0,g.$)(B=>B.promRules),W=(0,g.$)(B=>B.rulerRules),w=(0,i.useRef)({}),N=(0,i.useMemo)(()=>{if(A){const B=(0,c.Zw)(A);if(!B)throw new Error(`Unknown rules source: ${A}`);return[B]}return(0,c.lS)()},[A]);return(0,i.useMemo)(()=>N.map(B=>{const V=(0,c.Eb)(B)?B.name:B,K=W[V]?.result;let H=U[V]?.result;V===c.hY&&L&&(H=L);const X=w.current[V];if(X&&X.promRules===H&&X.rulerRules===K)return X.result;const k={};Object.entries(K||{}).forEach(([Z,se])=>{const j={rulesSource:B,name:Z,groups:[]};(0,o.lT)(se[0].rules[0])&&(j.uid=se[0].rules[0].grafana_alert.namespace_uid),k[Z]=j,u(j,se)}),H?.forEach(({name:Z,groups:se})=>{const j=k[Z]=k[Z]||{rulesSource:B,name:Z,groups:[]};D(j,se)});const Y=Object.values(k);return w.current[V]={promRules:H,rulerRules:K,result:Y},Y}).flat(),[U,W,N,L])}function p(A,L,U){const W={};return Object.entries(U||{}).forEach(([w,N])=>{const B={rulesSource:A,name:w,groups:[]};W[w]=B,u(B,N)}),L?.forEach(({name:w,groups:N})=>{const B=W[w]=W[w]||{rulesSource:A,name:w,groups:[]};D(B,N)}),Object.values(W)}function m(A,L,U){const W={rulesSource:A,name:L.name,groups:[]};return u(W,U),D(W,L.groups),W.groups.forEach(w=>{w.rules=w.rules.filter(N=>N.promRule)}),W}function y(A,L,U){return u(A,U),D(A,L),A}function d(A){return A.map(L=>{const U={...L,groups:[]};return U.groups.push({name:"default",rules:v(L.groups.flatMap(W=>W.rules)),totals:C(L.groups)}),U})}function v(A){return A.sort((L,U)=>L.name.localeCompare(U.name))}function u(A,L=[]){A.groups=L.map(U=>{const W=U.rules.filter(B=>(0,o.i7)(B)).length,w=U.rules.filter(B=>(0,o.lT)(B)&&B.grafana_alert.is_paused).length,N={name:U.name,interval:U.interval,source_tenants:U.source_tenants,rules:[],totals:{paused:w,recording:W}};return N.rules=U.rules.map(B=>S(B,A,N)),N})}function D(A,L){const U=new Map;A.groups.forEach(W=>U.set(W.name,W)),L.forEach(W=>{let w=U.get(W.name);w||(w={name:W.name,rules:[],totals:E(W)},A.groups.push(w),U.set(W.name,w)),w.totals={...w.totals,...E(W)};const N=new Map;w.rules.forEach(B=>{const V=N.get(B.name);V?V.push(B):N.set(B.name,[B])}),(W.rules??[]).forEach(B=>{const V=I(B,N,A.rulesSource);V?(V.promRule=B,V.instanceTotals=(0,o.Z8)(B)?P(B):{},V.filteredInstanceTotals=(0,o.Z8)(B)?x(B):{}):w.rules.push(M(B,A,w))})})}function P(A){const L=(0,t.countBy)(A.alerts,"state");if(A.totals){const{normal:U,...W}=A.totals;return{...W,inactive:U}}return{alerting:L[s.$.Alerting]||L.firing,pending:L[s.$.Pending],inactive:L[s.$.Normal],nodata:L[s.$.NoData],error:L[s.$.Error]||L.err||void 0}}function x(A){if(A.totalsFiltered){const{normal:L,...U}=A.totalsFiltered;return{...U,inactive:L}}return{}}function E(A){if(A.totals){const{firing:w,...N}=A.totals;return{...N,alerting:w}}const L=(0,t.countBy)(A.rules,w=>(0,o.Z8)(w)&&w.state),U=(0,t.countBy)(A.rules,w=>w.health),W=A.rules.filter(w=>(0,o.KB)(w)).length;return{alerting:L[r.cF.Firing],error:U.error,nodata:U.nodata,inactive:L[r.cF.Inactive],pending:L[r.cF.Pending],recording:W}}function C(A){const L={};return A.forEach(U=>{const W=U.totals;Object.entries(W).forEach(([w,N])=>{L[w]||(L[w]=0),L[w]+=N})}),L}function M(A,L,U){return{name:A.name,query:A.query,labels:A.labels||{},annotations:(0,o.Z8)(A)?A.annotations||{}:{},promRule:A,namespace:L,group:U,instanceTotals:(0,o.Z8)(A)?P(A):{},filteredInstanceTotals:(0,o.Z8)(A)?x(A):{}}}function S(A,L,U){return(0,o.$y)(A)?{name:A.alert,query:A.expr,labels:A.labels||{},annotations:A.annotations||{},rulerRule:A,namespace:L,group:U,instanceTotals:{},filteredInstanceTotals:{}}:(0,o.i7)(A)?{name:A.record,query:A.expr,labels:A.labels||{},annotations:{},rulerRule:A,namespace:L,group:U,instanceTotals:{},filteredInstanceTotals:{}}:{name:A.grafana_alert.title,query:"",labels:A.labels||{},annotations:A.annotations||{},rulerRule:A,namespace:L,group:U,instanceTotals:{},filteredInstanceTotals:{}}}function I(A,L,U){const W=L.get(A.name);if(!W)return;if((0,c.z2)(U))return W[0];const w=W.find(B=>!B.promRule&&T(B,A,!0));if(w)return w;const N=W.find(B=>!B.promRule&&T(B,A,!1));if(N)return N}function T(A,L,U=!0){return A.name===L.name?(0,t.isEqual)([U?b(A.query):"",A.labels,A.annotations],[U?b(L.query):"",L.labels||{},(0,o.Z8)(L)?L.annotations||{}:{}]):!1}function b(A){return A.length>1&&A[0]==="("&&A[A.length-1]===")"&&(A=A.slice(1,-1)),A=A.replace(/\s|\n/g,""),A.split("").sort().join("")}function R(A,L,U){const{currentData:W,isLoading:w,error:N}=f.hK.endpoints.prometheusRuleNamespaces.useQuery({ruleSourceName:c.hY,dashboardUid:A??void 0,panelId:L},{skip:A===null,pollingInterval:U?a.HH:void 0}),{currentData:B,isLoading:V,error:K}=f.hK.endpoints.rulerRules.useQuery({rulerConfig:h.$q,filter:{dashboardUID:A??void 0,panelId:L}},{pollingInterval:U?a.HH:void 0,skip:A===null}),H=(0,i.useRef)({}),X=(0,c.Zw)(c.hY),k=(0,i.useMemo)(()=>{if(!X)return[];const Y=H.current[c.hY];if(Y&&Y.promRules===W&&Y.rulerRules===B)return Y.result;const Z={};Object.entries(B||{}).forEach(([j,q])=>{const ne={rulesSource:X,name:j,groups:[]};(0,o.lT)(q[0].rules[0])&&(ne.uid=q[0].rules[0].grafana_alert.namespace_uid),Z[j]=ne,u(ne,q)}),W?.forEach(({name:j,groups:q})=>{const ne=Z[j]=Z[j]||{rulesSource:X,name:j,groups:[]};D(ne,q)});const se=Object.values(Z);return H.current[c.hY]={promRules:W,rulerRules:B,result:se},se},[W,B,X]);return{loading:w||V,error:N??K,result:k}}},14285:(G,O,e)=>{"use strict";e.d(O,{dI:()=>D,i7:()=>P});var t=e(53076),n=e(1932),i=e(2543),s=e.n(i),r=e(96540),f=e(19347),a=e(94822),c=e(28475),o=e(98164),h=e(55740),g=e(57220),l=e(32642),p=e(23662),m=e(9518),y=e(39964);const d=25,v=1/0,u=b=>b.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");function D(){const[b,R]=(0,y.l)(),A=b.get("search")??"",L=(0,r.useMemo)(()=>(0,c.XY)(A),[A]),U=(0,r.useMemo)(()=>Object.values(L).some(N=>!(0,i.isEmpty)(N)),[L]),W=(0,r.useCallback)(N=>{const B=(0,c.kL)(A,N);R({search:B})},[A,R]),w=(0,r.useCallback)(N=>{R({search:N})},[R]);return(0,r.useEffect)(()=>{const N={dataSource:b.get("dataSource")??void 0,alertState:b.get("alertState")??void 0,ruleType:b.get("ruleType")??void 0,labels:(0,l.S6)(b.get("queryString")??"").map(o.MU)};Object.values(N).some(V=>!(0,i.isEmpty)(V))&&(R({dataSource:void 0,alertState:void 0,ruleType:void 0,queryString:void 0}),W((0,n.jM)(L,V=>{if(V.dataSourceNames??=N.dataSource?[N.dataSource]:[],N.alertState&&(0,a.Si)(N.alertState)&&(V.ruleState??=N.alertState),N.ruleType&&(0,p.nf)(N.ruleType)&&(V.ruleType??=N.ruleType),V.labels.length===0&&N.labels.length>0){const K=N.labels.map(({name:H,operator:X,value:k})=>`${H}${X}${k}`);V.labels.push(...K)}})))},[b,W,L,R]),{filterState:L,hasActiveFilters:U,searchQuery:A,setSearchQuery:w,updateFilters:W}}const P=(b,R)=>(0,r.useMemo)(()=>{const A=x(b,R);return A.forEach(L=>{L.groups.forEach(U=>{U.rules.forEach(W=>{(0,p.Z8)(W.promRule)&&(W.instanceTotals=(0,m.Ug)(W.promRule),W.filteredInstanceTotals=(0,m.NW)(W.promRule))}),U.totals=(0,m.Tj)({rules:U.rules.map(W=>W.promRule).filter(W=>!!W)})})}),A},[b,R]),x=(b,R={dataSourceNames:[],labels:[],freeFormWords:[]})=>{let A=b;const L=R.dataSourceNames;L.length&&(A=A.filter(({rulesSource:W})=>(0,g.Eb)(W)?L.includes(W.name):!0));const U=R.namespace;if(U){const W=A.map(H=>H.name),w=u(U),N=I(U),[B,V,K]=N.search(W,w,M(U),v);V&&K?A=K.map(H=>A[V.idx[H]]):B&&(A=B.map(H=>A[H]))}return A.reduce(E(R),[])},E=b=>(R,A)=>{const L=b.groupName;let U=A.groups;if(L){const W=U.map(H=>H.name),w=I(L),N=u(L),[B,V,K]=w.search(W,N,M(L),v);V&&K?U=K.map(H=>U[V.idx[H]]):B&&(U=B.map(H=>U[H]))}return U=U.reduce(C(b),[]),U.length&&R.push({...A,groups:U}),R},C=b=>{const R=b.ruleName??b.freeFormWords.join(" ");return(A,L)=>{let U=L.rules;if(R){const W=U.map(H=>H.name),w=I(R),N=u(R),[B,V,K]=w.search(W,N,M(R),v);V&&K?U=K.map(H=>U[V.idx[H]]):B&&(U=B.map(H=>U[H]))}return U=U.filter(W=>{const w=W.promRule,N=(0,i.chain)(b).pick(["ruleType","dataSourceNames","ruleHealth","labels","ruleState","dashboardUid","plugins"]).omitBy(i.isEmpty).mapValues(()=>!1).value();if("ruleType"in N&&b.ruleType===w?.type&&(N.ruleType=!0),"plugins"in N&&b.plugins==="hide"&&(N.plugins=!(0,p.Tm)(W)),"dataSourceNames"in N&&((0,p.lT)(W.rulerRule)?T(W.rulerRule,b)&&(N.dataSourceNames=!0):N.dataSourceNames=!0),"ruleHealth"in b&&w){const B=(0,p.f6)(w.health);b.ruleHealth===B&&(N.ruleHealth=!0)}if("labels"in N){const B=(0,i.compact)(b.labels.map(S)),V=B.length>0&&(0,o.Av)(W.labels,B),K=B.length>0&&w&&w.type===a.JS.Alerting&&w.alerts&&w.alerts.some(H=>(0,o.Av)(H.labels,B));(V||K)&&(N.labels=!0)}if("ruleState"in N){const B=W.promRule;B&&(0,p.Z8)(B)&&B.state===b.ruleState&&(N.ruleState=!0)}return"dashboardUid"in N&&W.annotations[h.YH.dashboardUID]===b.dashboardUid&&(N.dashboardUid=!0),Object.values(N).every(B=>B===!0)}),U.length&&A.push({...L,rules:U}),A}};function M(b){return I(b).split(b).length<5?4:0}function S(b){try{return(0,l.qR)(b)}catch{return{name:b,value:"",isRegex:!0,isEqual:!0}}}function I(b){const R=b.length>d;return new t.A({intraMode:R?0:1,interSplit:"\\s+"})}const T=(b,R)=>R.dataSourceNames?.length?!!b.grafana_alert.data.find(A=>{if(!A.datasourceUid)return!1;const L=(0,f.l)().getInstanceSettings(A.datasourceUid);return L?.name&&R?.dataSourceNames?.includes(L.name)}):!0},11167:(G,O,e)=>{"use strict";e.d(O,{a:()=>f});var t=e(96540),n=e(31678),i=e(23770),s=e(88467),r=e(61410);function f(a){const c=(0,n.useDispatch)(),o=(0,r.$)(h=>h.folders);if((0,t.useEffect)(()=>{a&&c((0,i.Om)(a))},[c,a]),a){const h=o[a]||s.jA;return{folder:h.result,loading:h.loading}}return{loading:!1}}},83903:(G,O,e)=>{"use strict";e.d(O,{y:()=>s});var t=e(96540),n=e(57220),i=e(61410);function s(){const r=(0,i.$)(c=>c.rulerRules),f=(0,t.useCallback)(c=>{const o=typeof c=="string"?c:c.name;return o===n.hY||!!r[o]?.result},[r]),a=(0,t.useCallback)(c=>{const o=(0,n.EV)(c);return!!r[o]?.result},[r]);return{hasRuler:f,rulerRulesLoaded:a}}},97009:(G,O,e)=>{"use strict";e.d(O,{g:()=>a});var t=e(16233),n=e(77583),i=e(75471),s=e(23662),r=e(11167),f=e(61410);function a(c,o){const h=(0,f.$)(P=>P.dataSources),{currentData:g,isLoading:l}=n.L.endpoints.discoverDsFeatures.useQuery({rulesSourceName:c}),p=o&&(0,s.lT)(o)?o.grafana_alert.namespace_uid:void 0,m=(0,i.Wd)(c),{folder:y,loading:d}=(0,r.a)(p);if(!o)return{isEditable:!1,isRemovable:!1,loading:!1};if((0,s.lT)(o)){if(!p)throw new Error(`Rule ${o.grafana_alert.title} does not have a folder uid, cannot determine if it is editable.`);if(!y)return{isRulerAvailable:!0,isEditable:!1,isRemovable:!1,loading:d};const P=t.TP.hasPermissionInMetadata(m.update,y),x=t.TP.hasPermissionInMetadata(m.delete,y);return{isRulerAvailable:!0,isEditable:P,isRemovable:x,loading:d||l}}const v=!!h[c]?.result?.rulerConfig||!!g?.rulerConfig,u=t.TP.hasPermission(m.update),D=t.TP.hasPermission(m.delete);return{isRulerAvailable:v,isEditable:u&&v,isRemovable:D&&v,loading:l||h[c]?.loading}}},98439:(G,O,e)=>{"use strict";e.d(O,{W:()=>s});var t=e(2543),n=e.n(t),i=e(96540);function s(r,f=1,a){const[c,o]=(0,i.useState)(f),h=(0,i.useMemo)(()=>(0,t.chunk)(r,a),[r,a]),g=h.length,l=h[c-1]??[],p=(c-1)*a+1,m=(0,t.clamp)(c*a,r.length),y=(0,i.useCallback)(u=>{o((0,t.clamp)(u,1,h.length))},[o,h]),d=(0,i.useCallback)(()=>y(c+1),[c,y]),v=(0,i.useCallback)(()=>y(c-1),[c,y]);return(0,i.useEffect)(()=>o(1),[g]),{page:c,onPageChange:y,numberOfPages:g,pageItems:l,pageStart:p,pageEnd:m,nextPage:d,previousPage:v}}},27747:(G,O,e)=>{"use strict";e.d(O,{S:()=>n});var t=e(9518);function n({dashboardUID:i,panelId:s,poll:r=!1}){const{result:f,loading:a,error:c}=(0,t.kU)(i,s,r);return{rules:f?f.flatMap(h=>h.groups).flatMap(h=>h.rules):[],errors:c?[c]:[],loading:a}}},12210:(G,O,e)=>{"use strict";e.d(O,{_:()=>i});var t=e(16817),n=e(27716);function i(s){const{loading:r,error:f,value:a}=(0,t.A)(()=>(0,n.x)(s,{showErrorAlert:!1})),c=a&&!f&&!r,o=a?.enabled;return r&&!a?{loading:!0}:!c||!o?{loading:!1,installed:!1}:{loading:r,installed:!0,settings:a}}},46013:(G,O,e)=>{"use strict";e.d(O,{G:()=>h,Q:()=>o});var t=e(74848),n=e(32196),i=e(96540),s=e(32264),r=e(40845),f=e(37390);const a=(0,i.lazy)(()=>e.e(7409).then(e.bind(e,87409))),c=(0,i.lazy)(()=>e.e(285).then(e.bind(e,285)));var o=(l=>(l.Loki="loki",l.Annotations="annotations",l))(o||{});function h(){const[l,p]=(0,i.useState)(!1),[m,y]=(0,i.useState)(),d=(0,r.of)(g),v=s.$.unifiedAlerting.alertStateHistoryBackend,u=s.$.unifiedAlerting.alertStateHistoryPrimary,P=[v,u].some(M=>M==="loki")?"loki":"annotations",x=(0,i.useCallback)(()=>{y(void 0),p(!1)},[]),E=(0,i.useCallback)(M=>{y(M),p(!0)},[]);return{StateHistoryModal:(0,i.useMemo)(()=>m?(0,t.jsx)(f.a,{isOpen:l,onDismiss:x,closeOnBackdropClick:!0,closeOnEscape:!0,title:"State history",className:d.modal,contentClassName:d.modalContent,children:(0,t.jsxs)(i.Suspense,{fallback:"Loading...",children:[P==="loki"&&(0,t.jsx)(c,{ruleUID:m.grafana_alert.uid}),P==="annotations"&&(0,t.jsx)(a,{alertId:m.grafana_alert.id??""})]})}):null,[m,l,x,P,d]),showStateHistoryModal:E,hideStateHistoryModal:x}}const g=l=>({modal:(0,n.css)({width:"80%",height:"80%",minWidth:"800px"}),modalContent:(0,n.css)({height:"100%",width:"100%",padding:l.spacing(2)})})},39964:(G,O,e)=>{"use strict";e.d(O,{l:()=>s});var t=e(96540),n=e(24180),i=e(12131);function s(){const{search:r}=(0,n.zy)(),f=(0,t.useMemo)(()=>new URLSearchParams(r),[r]),a=(0,t.useCallback)((c,o)=>{i.Ny.partial(c,o)},[]);return[f,a]}},61410:(G,O,e)=>{"use strict";e.d(O,{$:()=>i});var t=e(25508),n=e(31678);function i(s,r){return(0,n.useSelector)((0,t.Mz)(f=>f.unifiedAlerting,f=>s(f)),r)}},85244:(G,O,e)=>{"use strict";e.d(O,{T:()=>f});var t=e(74848),n=e(16817),i=e(39938),s=e(56034),r=e(27716);function f({pluginId:a}){const{value:c}=(0,n.A)(()=>(0,r.x)(a)),o=c?.info.logos?.small,h=o?(0,t.jsx)("img",{src:o,alt:c?.name,style:{width:"20px",height:"20px"}}):(0,t.jsx)(i.E,{text:a,color:"orange"}),g=c?`This rule is managed by the ${c?.name} plugin`:"This rule is managed by a plugin";return(0,t.jsx)(s.m,{content:g,children:(0,t.jsx)("div",{children:h})})}},48070:(G,O,e)=>{"use strict";e.d(O,{KH:()=>o,KL:()=>l,LH:()=>c,fO:()=>g,i3:()=>y,lF:()=>h});var t=e(65307),n=e(2543),i=e.n(n),s=e(18461),r=e(23662);const f=(0,t.VP)("ruleGroup/rules/add"),a=(0,t.VP)("ruleGroup/rules/update"),c=(0,t.VP)("ruleGroup/rules/pause"),o=(0,t.VP)("ruleGroup/rules/delete"),h=(0,t.VP)("ruleGroup/update"),g=(0,t.VP)("ruleGroup/move"),l=(0,t.VP)("ruleGroup/rename"),p=(0,t.VP)("ruleGroup/rules/reorder"),m={name:"initial",rules:[]},y=(0,t.vy)(m,d=>{d.addCase(f,()=>{throw new Error("not yet implemented")}).addCase(a,()=>{throw new Error("not yet implemented")}).addCase(o,(v,{payload:u})=>{const{rule:D}=u;if((0,r.lT)(D)){const P=D.grafana_alert.uid;(0,n.remove)(v.rules,x=>(0,r.lT)(x)&&x.grafana_alert.uid===P)}if((0,r.Mt)(D)){const P=(0,s.Ns)(D);(0,n.remove)(v.rules,x=>(0,r.Mt)(x)&&(0,s.Ns)(x)===P)}}).addCase(c,(v,{payload:u})=>{const{uid:D,pause:P}=u;let x=!1;for(const E of v.rules)if((0,r.lT)(E)&&E.grafana_alert.uid===D){x=!0,E.grafana_alert.is_paused=P;break}if(!x)throw new Error(`No rule with UID ${D} found in group ${v.name}`)}).addCase(p,()=>{throw new Error("not yet implemented")}).addMatcher((0,t.i0)(l,g),(v,{payload:u})=>{const{groupName:D}=u;D&&(v.name=D)}).addMatcher((0,t.i0)(h,l,g),(v,{payload:u})=>{const{interval:D}=u;D&&(v.interval=D)}).addDefaultCase((v,u)=>{throw new Error(`Unknown action for rule group reducer: ${u.type}`)})})},28475:(G,O,e)=>{"use strict";e.d(O,{Jc:()=>H,kL:()=>k,XY:()=>X});var t=e(94822),n=e(23662);const i=1,s=2,r=3,f=4,a=5,c=6,o=7,h=8,g=9,l=10,p=11,m=12,y=13,d=14,v=0,u=1,D=2,P=3,x=4,E=5,C=6,M=7,S=8,I=9;var T=e(2543),b=e(48820);const R=b.U1.deserialize({version:14,states:"!vOQOPOOOxOPO'#CjOOOO'#Cj'#CjOQOPO'#CnOOOO'#Ck'#CkQQOPOOO!sOQO'#C^O!xOPO'#ClO!}OPO,59UOOOO,59Y,59YOOOO-E6i-E6iOOOO,58x,58xOOOO,59W,59WOOOO-E6j-E6j",stateData:"$h~ORUOTUOUUOVUOWUOXUOYUOZUO[UO]UOcPOeQO~OdVOR^XT^XU^XV^XW^XX^XY^XZ^X[^X]^Xc^Xe^X~OSZO~Oc[O~OdVOR^aT^aU^aV^aW^aX^aY^aZ^a[^a]^ac^ae^a~OR~T~U~V~W~Y~Z~[~]~R][ZYXWVUTc~",goto:"|cPPdPPPPPPPPPPPdioPuVRORTQTORYTQWPR]WSSOTRXR",nodeNames:"\u26A0 AlertRuleSearch FilterExpression DataSourceToken FilterValue NameSpaceToken LabelToken GroupToken RuleToken StateToken TypeToken HealthToken DashboardToken PluginsToken FreeFormExpression",maxTerm:21,skippedNodes:[0],repeatNodeCount:2,tokenData:"#<RRRsqr#`rs&lst#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]+n!]#W#`#W#X-Q#X#Z#`#Z#[Ig#[#]!$a#]#`#`#`#a!.s#a#b#`#b#c!7m#c#d#`#d#e!Fk#e#f#`#f#g#$g#g#h#+w#h#i#4q#i$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#gcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`Q$wcSQqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rQ&VP;=`<%l$rQ&]P;=`;NQ$rR&cP;=`<%l#`R&iP;=`;NQ#`R&orX^(ypq(yqr(yst(ytu(yuv(yvw(ywx(yxy(yyz(yz{(y{|(y|!P(y!P!Q(y!Q![(y![!](y!]#y(y#y#z(y#z$f(y$f$g(y$g#BY(y#BY#BZ(y#BZ$Ch(y$IS$I_(y$I|$JO(y$JT$JU(y$JU$KV(y$KV$KW(y$KW&FU(y&FU&FV(y&FV;'S(y;'S;(d+b;(d;(e+h<%lO(yR(|sX^(ypq(yqr(yrs+Zst(ytu(yuv(yvw(ywx(yxy(yyz(yz{(y{|(y|!P(y!P!Q(y!Q![(y![!](y!]#y(y#y#z(y#z$f(y$f$g(y$g#BY(y#BY#BZ(y#BZ$Ch(y$IS$I_(y$I|$JO(y$JT$JU(y$JU$KV(y$KV$KW(y$KW&FU(y&FU&FV(y&FV;'S(y;'S;(d+b;(d;(e+h<%lO(yR+bOSQePR+eP;=`<%l(yR+kP;=`;NQ(yR+ucSQdPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR-XeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U.j#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R.qfSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#g#`#g#h0V#h#i<R#i$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R0^eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#[#`#[#]1o#]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R1veSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#U#`#U#V3X#V$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R3`eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#c#`#c#d4q#d$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R4xeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U6Z#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R6beSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#f#`#f#g7s#g$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R7zeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#W#`#W#X9]#X$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R9dcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]:o!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R:vcSQ[Pqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR<YeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U=k#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R=reSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#g#`#g#h?T#h$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R?[eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#c#`#c#d@m#d$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R@teSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#i#`#i#jBV#j$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RB^eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#f#`#f#gCo#g$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RCveSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#V#`#V#WEX#W$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RE`eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#YFq#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RFxcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]HT!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RH[cSQRPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rRIneSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#f#`#f#gKP#g$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RKWeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#c#`#c#dLi#d$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RLpeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#i#`#i#jNR#j$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RNYeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#d#`#d#e! k#e$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R! rcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]!!}!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!#UcSQVPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR!$heSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y!%y#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!&QeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U!'c#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!'jeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#`#`#`#a!({#a$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!)SeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#h#`#h#i!*e#i$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!*leSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#[#`#[#]!+}#]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!,UcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]!-a!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!-hcSQZPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR!.zeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U!0]#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!0deSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#U#`#U#V!1u#V$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!1|eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y!3_#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!3feSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#`#`#`#a!4w#a$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!5OcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]!6Z!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!6bcSQUPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR!7teSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U!9V#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!9^eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#a#`#a#b!:o#b$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!:veSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y!<X#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!<`eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#g#`#g#h!=q#h$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!=xeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#d#`#d#e!?Z#e$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!?beSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U!@s#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!@zeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#V#`#V#W!B]#W$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!BdeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y!Cu#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!C|cSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]!EX!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!E`cSQTPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR!FreSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#`#`#`#a!HT#a$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!H[eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#i#`#i#j!Im#j$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!IteSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#Z#`#Z#[!KV#[$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!K^eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#]#`#]#^!Lo#^$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!LveSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#b#`#b#c!NX#c$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!N`eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#g#`#g#h# q#h$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R# xcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]##T!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R##[cSQ]Pqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR#$neSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#i#`#i#j#&P#j$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#&WeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#`#`#`#a#'i#a$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#'peSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y#)R#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#)YcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]#*e!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#*lcSQWPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR#,OeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#h#`#h#i#-a#i$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#-heSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U#.y#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#/QeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#h#`#h#i#0c#i$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#0jeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y#1{#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#2ScSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]#3_!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#3fcSQXPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR#4xeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#m#`#m#n#6Z#n$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#6beSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#d#`#d#e#7s#e$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#7zeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y#9]#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#9dcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]#:o!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#:vcSQYPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$r",tokenizers:[0,1],topRules:{AlertRuleSearch:[0,1]},dialects:{dataSourceFilter:132,nameSpaceFilter:134,labelFilter:136,groupFilter:138,ruleFilter:140,stateFilter:78,typeFilter:142,healthFilter:144,dashboardFilter:146,pluginsFilter:148},tokenPrec:150}),A={[r]:"datasource",[a]:"namespace",[c]:"label",[h]:"rule",[o]:"group",[g]:"state",[l]:"type",[p]:"health",[m]:"dashboard",[y]:"plugins"};var L=(Z=>(Z.dataSource="dataSourceFilter",Z.nameSpace="nameSpaceFilter",Z.label="labelFilter",Z.group="groupFilter",Z.rule="ruleFilter",Z.state="stateFilter",Z.type="typeFilter",Z.health="healthFilter",Z.dashboard="dashboardFilter",Z.plugins="pluginsFilter",Z))(L||{});function U(Z,se,j){B(Z,se,q=>{if(q.type.id===s){const ne=W(Z,q);if(ne.type&&ne.value){const oe=j[ne.type];oe&&oe(ne.value)}}else if(q.type.id===d){const ne=j[d];ne&&ne(w(Z,q))}})}function W(Z,se){if(se.type.id!==s)throw new Error("Invalid node provided. Only FilterExpression nodes are supported");const j=se.firstChild;if(!j)return{type:void 0,value:void 0};const q=se.getChild(f),ne=q?(0,T.trim)(w(Z,q),'"'):void 0;return{type:j.type.id,value:ne}}function w(Z,se){return Z.slice(se.from,se.to).trim().replace(/\"/g,"")}function N(Z,se,j){const q=[];B(Z,se,oe=>{oe.type.id===s&&oe.firstChild&&q.push(oe.firstChild),oe.type.id===d&&q.push(oe)});let ne=[];return q.forEach(oe=>{const z=j.findIndex(te=>te.type===oe.type.id);if(z!==-1){if(oe.parent?.type.is(s)){const te=A[oe.type.id],le=j.splice(z,1)[0];ne.push(`${te}:${V(le.value)}`)}if(oe.type.is(d)){const te=j.splice(z,1)[0];ne.push(te.value)}}}),j.forEach(oe=>{oe.type===d?ne.push(oe.value):ne.push(`${A[oe.type]}:${V(oe.value)}`)}),ne.join(" ")}function B(Z,se,j){const q=se.join(" ");let oe=R.configure({dialect:q}).parse(Z).cursor();do j(oe.node);while(oe.next())}function V(Z){return/\s/.test(Z)?`"${Z}"`:Z}const K=[L.dataSource,L.nameSpace,L.label,L.group,L.rule,L.state,L.type,L.health,L.dashboard,L.plugins];var H=(Z=>(Z.Ok="ok",Z.Error="error",Z.NoData="nodata",Z.Unknown="unknown",Z))(H||{});function X(Z){const se={labels:[],freeFormWords:[],dataSourceNames:[]},j={[r]:q=>se.dataSourceNames.push(q),[a]:q=>se.namespace=q,[o]:q=>se.groupName=q,[h]:q=>se.ruleName=q,[c]:q=>se.labels.push(q),[g]:q=>se.ruleState=Y(q),[l]:q=>(0,n.nf)(q)?se.ruleType=q:void 0,[p]:q=>se.ruleHealth=(0,n.f6)(q),[m]:q=>se.dashboardUid=q,[y]:q=>se.plugins=q==="hide"?q:void 0,[d]:q=>se.freeFormWords.push(q)};return U(Z,K,j),se}function k(Z,se){const j=[];return se.dataSourceNames&&j.push(...se.dataSourceNames.map(q=>({type:r,value:q}))),se.namespace&&j.push({type:a,value:se.namespace}),se.groupName&&j.push({type:o,value:se.groupName}),se.ruleName&&j.push({type:h,value:se.ruleName}),se.ruleState&&j.push({type:g,value:se.ruleState}),se.ruleType&&j.push({type:l,value:se.ruleType}),se.ruleHealth&&j.push({type:p,value:se.ruleHealth}),se.labels&&j.push(...se.labels.map(q=>({type:c,value:q}))),se.dashboardUid&&j.push({type:m,value:se.dashboardUid}),se.plugins&&j.push({type:y,value:se.plugins}),se.freeFormWords&&j.push(...se.freeFormWords.map(q=>({type:d,value:q}))),N(Z,K,j)}function Y(Z){if(Z==="normal")return t.cF.Inactive;if((0,t.Si)(Z))return Z}},28318:(G,O,e)=>{"use strict";e.d(O,{t:()=>R});var t=e(2543),n=e(39741),i=e(62467),s=e(66847),r=e(1005),f=e(81160),a=e(62938),c=e(39070),o=e(14236),h=e(72495),g=e(65879),l=e(43127),p=e(89667),m=e(19347),y=e(26657),d=e(12091),v=e(27677),u=e(69437),D=e(81583),P=e(72955),x=e(66718);const E={from:21600,to:0},C=(B,V)=>{const K=M(B,V);if(!K)return E;const{from:H,to:X}=I(K,V);return!H.length&&!X.length?E:{from:Math.max(...H),to:Math.min(...X)}},M=(B,V)=>{switch(B.type){case x.Tz.classic:return S(B);case x.Tz.math:case x.Tz.sql:return T(B,V);case x.Tz.resample:case x.Tz.reduce:case x.Tz.threshold:return b(B)}},S=B=>B.conditions?.map(V=>V.query.params[0]),I=(B,V)=>{let K=[],H=[E.to];for(const X of B){const k=V.find(Y=>Y.refId===X);!k||!k.relativeTimeRange||(K.push(k.relativeTimeRange.from),H.push(k.relativeTimeRange.to))}return{from:K,to:H}},T=(B,V)=>V.filter(K=>K.queryType==="query"&&B.expression?.includes(K.refId)).map(K=>K.refId),b=B=>B.expression?[B.expression]:void 0;class R{constructor(V=(0,v.AI)(),K=(0,m.l)()){this.backendSrv=V,this.dataSourceSrv=K,this.subject=new n.m(1),this.lastResult={}}get(){return this.subject.asObservable()}async run(V,K){const H=L(V,c.Gu.Done),X=[];for(const Y of V){const Z=Y.model.refId;if((0,u.f)(Y.model))continue;const se=await this.dataSourceSrv.get(Y.datasourceUid);se instanceof y.iy&&se.filterQuery&&!se.filterQuery(Y.model)&&X.push(Z)}const k=(0,t.reject)(V,Y=>X.includes(Y.model.refId));if(k.length===0)return this.subject.next(H);this.subscription=A(this.backendSrv,k,K).subscribe({next:Y=>{const Z=N(Y,(se,j)=>{const q=this.lastResult[se],ne=(0,o.N$)(j,q);return(0,P.B)(ne,q)});this.lastResult=Z,this.subject.next(this.lastResult)},error:Y=>{this.lastResult=w(this.lastResult,Y),this.subject.next(this.lastResult)}})}cancel(){if(!this.subscription)return;this.subscription.unsubscribe();let V=!1;const K=N(this.lastResult,(H,X)=>(X.state===c.Gu.Loading&&(V=!0),{...X,state:c.Gu.Done}));V&&this.subject.next(K)}destroy(){this.subject&&this.subject.complete(),this.cancel()}}const A=(B,V,K)=>{const H=L(V,c.Gu.Loading),X={data:{data:V,condition:K},url:"/api/v1/eval",method:"POST",requestId:(0,a.A)()};return(0,h.k)({whileLoading:H,source:B.fetch(X).pipe(W(H),(0,s.W)(k=>(0,i.of)(w(H,k))),(0,D.N)(B,X.requestId),(0,r.u)())})},L=(B,V)=>B.reduce((K,H)=>(K[H.refId]={state:V,series:[],timeRange:U(H,B)},K),{}),U=(B,V)=>{if((0,u.f)(B.model)){const K=C(B.model,V);return g.relativeToTimeRange(K)}return B.relativeTimeRange?g.relativeToTimeRange(B.relativeTimeRange):(console.warn(`Query with refId: ${B.refId} did not have any relative time range, using default.`),(0,l.E2)())},W=B=>(0,f.T)(V=>{const{data:K}=V,H={};for(const[X,k]of Object.entries(K.results)){const{error:Y,status:Z,frames:se=[]}=k,j=Y?[{message:Y,refId:X,status:Z}]:[];H[X]={errors:j,timeRange:B[X].timeRange,state:c.Gu.Done,series:se.map(p.or)}}return H}),w=(B,V)=>{const K=(0,d.u)(V);return N(B,(H,X)=>({...X,state:c.Gu.Error,error:K}))},N=(B,V)=>{const K={};for(const[H,X]of Object.entries(B))K[H]=V(H,X);return K}},70383:(G,O,e)=>{"use strict";e.d(O,{Kh:()=>m,VI:()=>g,b9:()=>h});var t=e(74848),n=e(96540),i=e(33390),s=e(60021),r=e(62190),f=e(39964),a=e(55740),c=e(57220);const o=n.createContext(void 0),h=({children:y,accessType:d,alertmanagerSourceName:v})=>{const[u,D]=(0,f.l)(),P=(0,r.W)(d),x=P.availableInternalDataSources.concat(P.availableExternalDataSources),E=n.useCallback(W=>{l(x,W)&&(W===c.hY?(i.A.delete(a.Oq),D({[a.DD]:void 0})):(i.A.set(a.Oq,W),D({[a.DD]:W})))},[x,D]),C=u.get(a.DD),M=i.A.get(a.Oq),S=c.hY;n.useEffect(()=>{C&&C!==M&&i.A.set(a.Oq,C)},[C,M]);const I=v??C??M??S,T=l(x,I)?I:void 0,b=(0,c.r3)(T)?.jsonData,R=T===c.hY,A=b?m(b):!1,U={selectedAlertmanager:T,hasConfigurationAPI:R||A,isGrafanaAlertmanager:R,selectedAlertmanagerConfig:b,availableAlertManagers:x,setSelectedAlertmanager:E};return(0,t.jsx)(o.Provider,{value:U,children:y})};function g(){const y=n.useContext(o);if(y===void 0)throw new Error("useAlertmanager must be used within a AlertmanagerContext");return y}function l(y,d){return y.map(u=>u.name).includes(d)}const p=[s.Oz.mimir,s.Oz.cortex,void 0];function m(y){return p.includes(y.implementation)}},23770:(G,O,e)=>{"use strict";e.d(O,{nO:()=>te,$8:()=>le,g6:()=>H,EY:()=>q,D3:()=>z,yo:()=>V,wE:()=>N,nV:()=>K,Tp:()=>ne,Om:()=>oe,JH:()=>Z,mF:()=>Y,Lc:()=>W,mB:()=>L,eB:()=>U,HB:()=>w,DC:()=>B,Qt:()=>A,uQ:()=>ae,_$:()=>X,bO:()=>ie,RW:()=>se,DN:()=>re});var t=e(65307),n=e(2543),i=e(12131),s=e(34867),r=e(94822),f=e(27677),a=e(25027),c=e(79938),o=e(32415),h=e(82843),g=e(17172);function l(ce){return(0,g.AI)().get("/api/annotations",{alertId:ce}).then(me=>me?.sort(p))}function p(ce,me){const ee=(fe,Te)=>fe>Te?-1:Te>fe?1:0,de=ee(ce.timeEnd,me.timeEnd);if(de)return de;const De=ee(ce.time,me.time);return De||ee(ce.id,me.id)}var m=e(92240),y=e(68788),d=e(49498),v=e(28220),u=e(86590),D=e(98164),P=e(57220),x=e(56361),E=e(88467),C=e(18461),M=e(63066),S=e(23662);function I(ce){const me=async He=>{if((0,S.A4)(He)){const Be=await(0,v.iy)(ce);for(const[Ne,Re]of Object.entries(Be))for(const Se of Re){const We=Se.rules.find(Ke=>(0,S.lT)(Ke)&&Ke.grafana_alert?.uid===He.uid);if(We)return{group:Se,ruleSourceName:P.hY,namespace:Ne,namespace_uid:(0,S.lT)(We)&&We.grafana_alert.namespace_uid||void 0,rule:We}}}if((0,S.X4)(He)){const{ruleSourceName:Be,namespace:Ne,groupName:Re}=He,Se=await(0,v.HO)(ce,Ne,Re);if(!Se)return null;const We=Se.rules.find(Ke=>{const Xe=C.P1(Be,Ne,Se.name,Ke);return C.LC(Xe,He)});return We?{group:Se,ruleSourceName:Be,namespace:Ne,rule:We}:null}if((0,S.Mj)(He))throw new Error("Native prometheus rules can not be edited in grafana.");return null},ee=async He=>{const{namespace:Be,group:Ne,rule:Re,namespace_uid:Se}=He;if(Ne.rules.length===1){await(0,v.AJ)(ce,Se||Be,Ne.name);return}await(0,v.E8)(ce,Se||Be,{...Ne,rules:Ne.rules.filter(We=>We!==Re)})},de=async(He,Be,Ne)=>{const{dataSourceName:Re,group:Se,namespace:We}=He,Ke=(0,M.l1)(He);if(Re&&Se&&We){if(Ne){const st=await me(C.Yd(Ne));if(!st)throw new Error("Rule not found.");if(st.namespace!==We||st.group.name!==Se)await ee(st);else{const pt={...st.group,rules:st.group.rules.map(xt=>xt===st.rule?Ke:xt),evaluateEvery:Be};return await(0,v.E8)(ce,We,pt),C.P1(Re,We,Se,Ke)}}const Xe=await(0,v.HO)(ce,We,Se),Je=Xe?{...Xe,rules:[...Xe.rules,Ke]}:{name:Se,rules:[Ke]};return await(0,v.E8)(ce,We,Je),C.P1(Re,We,Se,Ke)}else throw new Error("Data source and location must be specified")},De=async(He,Be,Ne)=>{const{folder:Re,group:Se}=He;if(!Re)throw new Error("Folder must be specified");const We=(0,M.Z9)(He),Ke=Re.uid,Xe={name:Se,interval:Be};if(!Ne)return fe(Ke,Xe,We);const Je=await me(C.Yd(Ne));if(!Je)throw new Error("Rule not found.");const st=Je.namespace_uid===Ke,pt=Je.group.name===He.group;return st&&pt?je(Je,We,Be):Te(Ke,Xe,Je,We)},fe=async(He,Be,Ne)=>{const Re=await(0,v.HO)(ce,He,Be.name);if(!Re)throw new Error(`No group found with name "${Be.name}"`);const Se={name:Be.name,interval:Be.interval,rules:(Re.rules??[]).concat(Ne)};return await(0,v.E8)(ce,He,Se),{uid:Ne.grafana_alert.uid??"",ruleSourceName:P.hY}},Te=async(He,Be,Ne,Re)=>(T(Ne,Re),await fe(He,Be,Re)),je=async(He,Be,Ne)=>{T(He,Be);const Re=He.group.rules.map(Se=>(0,S.lT)(Se)&&Se.grafana_alert.uid===He.rule.grafana_alert.uid?Be:Se);return await(0,v.E8)(ce,He.namespace_uid??"",{name:He.group.name,interval:Ne,rules:Re}),{uid:He.rule.grafana_alert.uid,ruleSourceName:P.hY}};return{findEditableRule:me,deleteRule:ee,saveLotexRule:de,saveGrafanaRule:De}}function T(ce,me){if(!(0,S.lT)(ce.rule))throw new Error("The rule is not a Grafana managed rule");const ee=ce.rule.grafana_alert.uid;me.grafana_alert.uid=ee}var b=e(25968);function R(ce,me){const ee=ce().unifiedAlerting.dataSources,de=ee[me]?.result,De=ee[me]?.error;if(!de){const fe=new Error(`Data source configuration is not available for "${me}" data source`);throw De&&(fe.cause=De),fe}return de}function A(ce,me){const ee=R(ce,me);if(!ee.rulerConfig)throw new Error(`Ruler API is not available for ${me}`);return ee.rulerConfig}const L=(0,t.zD)("unifiedalerting/fetchPromRules",async({rulesSourceName:ce,filter:me,limitAlerts:ee,matcher:de,state:De,identifier:fe},Te)=>{await Te.dispatch(B({rulesSourceName:ce}));const je=(0,a.U7)("unifiedalerting/fetchPromRules",d.sA,{dataSourceName:ce,thunk:"unifiedalerting/fetchPromRules"});return await(0,E.$I)(je(ce,me,ee,de,De,fe))}),U=(0,t.zD)("unifiedalerting/fetchRulerRules",async({rulesSourceName:ce,filter:me},{dispatch:ee,getState:de})=>{await ee(B({rulesSourceName:ce}));const De=A(de,ce),fe=(0,a.Ke)("unifiedalerting/fetchRulerRules",v.iy,{dataSourceName:ce,thunk:"unifiedalerting/fetchRulerRules"});return await(0,E.$I)(fe(De,me))});function W({rulesSourceName:ce,identifier:me,filter:ee,limitAlerts:de,matcher:De,state:fe}){return async(Te,je)=>{await Te(B({rulesSourceName:ce}));const He=R(je,ce);await Te(L({rulesSourceName:ce,identifier:me,filter:ee,limitAlerts:de,matcher:De,state:fe})),He.rulerConfig&&await Te(U({rulesSourceName:ce}))}}function w(ce){return(me,ee)=>{const{rulerRules:de}=ee().unifiedAlerting,De=de[ce];(0,n.isEmpty)(De?.result)&&!(De&&(0,S.$7)(De))&&!De?.loading&&me(U({rulesSourceName:ce}))}}function N(){return async ce=>{const me=(0,P.gR)().map(ee=>ce(B({rulesSourceName:ee})));await Promise.allSettled(me)}}const B=(0,t.zD)("unifiedalerting/fetchPromBuildinfo",async({rulesSourceName:ce})=>(0,E.$I)((async()=>{if(ce===P.hY)return{name:P.hY,id:P.hY,rulerConfig:{dataSourceName:P.hY,apiVersion:"legacy"}};const me=(0,P.Jz)(ce);if(!me)throw new Error(`Missing data source configuration for ${ce}`);const{id:ee,name:de}=me,fe=await(0,a.QA)("unifiedalerting/fetchPromBuildinfo",m.nD,{dataSourceName:ce,thunk:"unifiedalerting/fetchPromBuildinfo"})(de),Te=fe.features.rulerApiEnabled?{dataSourceName:de,apiVersion:fe.application===r.N1.Cortex?"legacy":"config"}:void 0;return{name:de,id:ee,rulerConfig:Te}})()),{condition:({rulesSourceName:ce},{getState:me})=>{const ee=me().unifiedAlerting.dataSources,de=!!ee[ce]?.result,De=!!ee[ce]?.error;return!(de||De)}});function V(ce=!1,me={}){return async(ee,de)=>{const De=performance.now();await Promise.allSettled((0,P.gR)().map(async fe=>{await ee(B({rulesSourceName:fe}));const{promRules:Te,rulerRules:je,dataSources:He}=de().unifiedAlerting,Be=He[fe].result;if(!Be)return;const Ne=ce||!Te[fe]?.loading,Re=(ce||!je[fe]?.loading)&&!!Be.rulerConfig;await Promise.allSettled([Ne&&ee(L({rulesSourceName:fe,...me})),Re&&ee(U({rulesSourceName:fe}))])})),(0,s.l$)("unifiedalerting/fetchAllPromAndRulerRulesAction",{loadTimeMs:performance.now()-De})}}function K(ce=!1){return async(me,ee)=>{const{promRules:de}=ee().unifiedAlerting;(0,P.gR)().map(De=>{(ce||!de[De]?.loading)&&me(L({rulesSourceName:De}))})}}function H(ce,me){return async(ee,de)=>{(0,E.v5)((async()=>{const De=(0,P.EV)(ce.rulesSource),fe=A(de,De);await(0,v.AJ)(fe,ce.name,me.name),await ee(W({rulesSourceName:De}))})(),{successMessage:"Group deleted"})}}const X=(0,t.zD)("unifiedalerting/saveRuleForm",({values:ce,existing:me,redirectOnSave:ee,evaluateEvery:de},De)=>(0,E.v5)((0,E.$I)((async()=>{const{type:fe}=ce;let Te;if(fe===u.Z.cloudAlerting||fe===u.Z.cloudRecording){if(!ce.dataSourceName)throw new Error("The Data source has not been defined.");const je=A(De.getState,ce.dataSourceName);Te=await I(je).saveLotexRule(ce,de,me),await De.dispatch(U({rulesSourceName:ce.dataSourceName}))}else if(fe===u.Z.grafana){const je=A(De.getState,P.hY);Te=await I(je).saveGrafanaRule(ce,de,me),k(ce,me),De.dispatch(c.hK.util.invalidateTags([{type:"GrafanaRulerRule",id:Te.uid}]))}else throw new Error("Unexpected rule form type");if((0,a.fH)(a.le.successSavingAlertRule,{type:fe,isNew:(!me).toString()}),ee)i.Ny.push(ee);else{const je=C.$9(Te);if(!je){i.Ny.push("/alerting/list");return}const He=`/alerting/${encodeURIComponent(je)}/edit`;i.Ny.getLocation().pathname!==He&&i.Ny.replace(He)}})()),{successMessage:me?`Rule "${ce.name}" updated.`:`Rule "${ce.name}" saved.`,errorMessage:"Failed to save rule"}));function k(ce,me){if((0,S.lT)(me?.rule)){const de=!!me?.rule.grafana_alert?.notification_settings?.receiver,De=ce.manualRouting,fe=!de&&De,Te=de&&!De;fe&&(0,a.Fb)(),Te&&(0,a.hJ)()}}const Y=(0,t.zD)("unifiedalerting/fetchGrafanaNotifiers",()=>(0,E.$I)((0,y.Es)())),Z=(0,t.zD)("unifiedalerting/fetchGrafanaAnnotations",ce=>(0,E.$I)(l(ce))),se=(0,t.zD)("unifiedalerting/updateAMConfig",({alertManagerSourceName:ce,oldConfig:me,newConfig:ee,successMessage:de,redirectPath:De,redirectSearch:fe},Te)=>(0,E.v5)((0,E.$I)((async()=>{const je=await Te.dispatch(h.m.endpoints.getAlertmanagerConfiguration.initiate(ce,{forceRefetch:!0})).unwrap(),He=(0,n.isEmpty)(je.alertmanager_config)&&(0,n.isEmpty)(je.template_files),Be=JSON.stringify(je)!==JSON.stringify(me);if(!He&&Be)throw new Error("A newer Alertmanager configuration is available. Please reload the page and try again to not overwrite recent changes.");if(await(0,o.vk)(ce,(0,D.MZ)(ee)),Te.dispatch(h.m.util.invalidateTags(["AlertmanagerConfiguration"])),De){const Ne=new URLSearchParams(fe??"");i.Ny.push((0,x.nL)(De,ce,Ne))}})()),{successMessage:de})),j=(ce,me)=>async ee=>{const de=await ee(alertmanagerApi.endpoints.getAlertmanagerConfiguration.initiate(me)).unwrap();if(!de)throw new Error(`Config for ${me} not found`);if(!de.alertmanager_config.receivers?.find(fe=>fe.name===ce))throw new Error(`Cannot delete receiver ${ce}: not found in config.`);const De={...de,alertmanager_config:{...de.alertmanager_config,receivers:de.alertmanager_config.receivers.filter(fe=>fe.name!==ce)}};return ee(se({newConfig:De,oldConfig:de,alertManagerSourceName:me,successMessage:"Contact point deleted."}))},q=(ce,me)=>async ee=>{const de=await ee(h.m.endpoints.getAlertmanagerConfiguration.initiate(me)).unwrap();if(!de)throw new Error(`Config for ${me} not found`);if(typeof de.template_files?.[ce]!="string")throw new Error(`Cannot delete template ${ce}: not found in config.`);const De={...de.template_files};delete De[ce];const fe={...de,alertmanager_config:{...de.alertmanager_config,templates:de.alertmanager_config.templates?.filter(Te=>Te!==ce)},template_files:De};return ee(se({newConfig:fe,oldConfig:de,alertManagerSourceName:me,successMessage:"Template deleted."}))},ne=(0,t.zD)("unifiedalerting/fetchFolder",ce=>(0,E.$I)(f.IB.getFolderByUid(ce,{withAccessControl:!0}))),oe=ce=>(me,ee)=>{ee().unifiedAlerting.folders[ce]?.dispatched||me(ne(ce))},z=(0,t.zD)("unifiedalerting/fetchAlertGroups",ce=>(0,E.$I)((0,o.f4)(ce))),te=(0,t.zD)("unifiedalerting/deleteAlertManagerConfig",async(ce,me)=>(0,E.v5)((0,E.$I)((async()=>{await(0,o.nd)(ce),await me.dispatch(h.m.util.invalidateTags(["AlertmanagerConfiguration"]))})()),{errorMessage:"Failed to reset Alertmanager configuration",successMessage:"Alertmanager configuration reset."})),le=(ce,me)=>async ee=>{const de=await ee(h.m.endpoints.getAlertmanagerConfiguration.initiate(ce)).unwrap(),De=ce===P.hY,fe=(de?.alertmanager_config?.mute_time_intervals??[])?.filter(({name:He})=>He!==me)??[],Te=(de?.alertmanager_config?.time_intervals??[])?.filter(({name:He})=>He!==me)??[],je=De?{mute_time_intervals:[...fe,...Te]}:{time_intervals:Te,mute_time_intervals:fe};if(de){const{mute_time_intervals:He,...Be}=de?.alertmanager_config??{};(0,E.v5)(ee(se({alertManagerSourceName:ce,oldConfig:de,newConfig:{...de,alertmanager_config:{...Be,route:de.alertmanager_config.route?(0,D.Dk)(me,de.alertmanager_config?.route):void 0,...je}}})),{successMessage:`Deleted "${me}" from Alertmanager configuration`,errorMessage:"Failed to delete mute timing"})}},ie=(0,t.zD)("unifiedalerting/testReceivers",({alertManagerSourceName:ce,receivers:me,alert:ee})=>(0,E.v5)((0,E.$I)((0,o.By)(ce,me,ee)),{errorMessage:"Failed to send test alert.",successMessage:"Test alert sent."})),ae=(ce,me)=>ce.filter(ee=>{const{forDuration:de}=(0,S.jg)(ee,me),De=(0,b.P8)(de),fe=(0,b.P8)(me);return De!==0&&De<fe}),re=(0,t.zD)("unifiedalerting/updateRulesOrderForGroup",async(ce,me)=>(0,E.v5)((0,E.$I)((async()=>{const{rulesSourceName:ee,namespaceName:de,groupName:De,newRules:fe,folderUid:Te}=ce,je=A(me.getState,ee),Be=(await(0,v.iy)(je))[de].find(Re=>Re.name===De);if(!Be)throw new Error(`Group "${De}" not found.`);if(Be.rules.length!==fe.length){const Re=new Error("Rules count mismatch. Please refresh the page and try again.");throw(0,a.vV)(Re,{namespaceName:de,groupName:De}),Re}const Ne={name:Be.name,interval:Be.interval,rules:fe};await(0,v.E8)(je,Te??de,Ne),await me.dispatch(U({rulesSourceName:ee}))})()),{errorMessage:"Failed to update namespace / group",successMessage:"Update successful"}))},22620:(G,O,e)=>{"use strict";e.d(O,{H:()=>n});var t=e(32196);const n=i=>(0,t.css)({float:"none",display:"flex",justifyContent:"flex-start",margin:i.spacing(2,0)})},99494:(G,O,e)=>{"use strict";e.d(O,{W:()=>t});var t=(n=>(n.Incident="grafana-incident-app",n.OnCall="grafana-oncall-app",n.MachineLearning="grafana-ml-app",n.Labels="grafana-labels-app",n.Slo="grafana-slo-app",n))(t||{})},86590:(G,O,e)=>{"use strict";e.d(O,{Z:()=>t});var t=(n=>(n.grafana="grafana",n.cloudAlerting="cloud-alerting",n.cloudRecording="cloud-recording",n))(t||{})},41068:(G,O,e)=>{"use strict";e.d(O,{y:()=>t});var t=(n=>(n.seconds="s",n.minutes="m",n.hours="h",n.days="d",n.weeks="w",n))(t||{})},75471:(G,O,e)=>{"use strict";e.d(O,{C0:()=>m,HL:()=>f,Q9:()=>y,VQ:()=>a,Wd:()=>p,jy:()=>g,lV:()=>l,nU:()=>c,q0:()=>d});var t=e(2913),n=e(16233),i=e(31678),s=e(57220);function r(v){return(0,s.z2)(v)?"grafana":"external"}const f={read:{grafana:i.AccessControlAction.AlertingInstanceRead,external:i.AccessControlAction.AlertingInstancesExternalRead},create:{grafana:i.AccessControlAction.AlertingInstanceCreate,external:i.AccessControlAction.AlertingInstancesExternalWrite},update:{grafana:i.AccessControlAction.AlertingInstanceUpdate,external:i.AccessControlAction.AlertingInstancesExternalWrite},delete:{grafana:i.AccessControlAction.AlertingInstanceUpdate,external:i.AccessControlAction.AlertingInstancesExternalWrite}},a={read:{grafana:i.AccessControlAction.AlertingNotificationsRead,external:i.AccessControlAction.AlertingNotificationsExternalRead},create:{grafana:i.AccessControlAction.AlertingNotificationsWrite,external:i.AccessControlAction.AlertingNotificationsExternalWrite},update:{grafana:i.AccessControlAction.AlertingNotificationsWrite,external:i.AccessControlAction.AlertingNotificationsExternalWrite},delete:{grafana:i.AccessControlAction.AlertingNotificationsWrite,external:i.AccessControlAction.AlertingNotificationsExternalWrite}},c={read:{grafana:i.AccessControlAction.AlertingSilenceRead,external:i.AccessControlAction.AlertingInstanceRead},create:{grafana:i.AccessControlAction.AlertingSilenceCreate,external:i.AccessControlAction.AlertingInstancesExternalWrite},update:{grafana:i.AccessControlAction.AlertingSilenceUpdate,external:i.AccessControlAction.AlertingInstancesExternalWrite}},o={read:i.AccessControlAction.AlertingProvisioningRead,readSecrets:i.AccessControlAction.AlertingProvisioningReadSecrets,write:i.AccessControlAction.AlertingProvisioningWrite},h={read:{grafana:i.AccessControlAction.AlertingRuleRead,external:i.AccessControlAction.AlertingRuleExternalRead},create:{grafana:i.AccessControlAction.AlertingRuleCreate,external:i.AccessControlAction.AlertingRuleExternalWrite},update:{grafana:i.AccessControlAction.AlertingRuleUpdate,external:i.AccessControlAction.AlertingRuleExternalWrite},delete:{grafana:i.AccessControlAction.AlertingRuleDelete,external:i.AccessControlAction.AlertingRuleExternalWrite}};function g(v){const u=r(v);return{read:f.read[u],create:f.create[u],update:f.update[u],delete:f.delete[u]}}function l(v){const u=r(v);return{read:a.read[u],create:a.create[u],update:a.update[u],delete:a.delete[u],provisioning:o}}function p(v){const u=r(v);return{read:h.read[u],create:h.create[u],update:h.update[u],delete:h.delete[u]}}function m(v){return()=>n.TP.evaluatePermission(v)}function y(){return{canCreateGrafanaRules:n.TP.hasPermission(i.AccessControlAction.FoldersRead)&&n.TP.hasPermission(h.create.grafana),canCreateCloudRules:n.TP.hasPermission(i.AccessControlAction.DataSourcesRead)&&n.TP.hasPermission(h.create.external),canEditRules:v=>n.TP.hasPermission(p(v).update)}}function d(){const{unifiedAlertingEnabled:v}=(0,t.zj)(),u=n.TP.hasPermission(p(s.hY).read),D=n.TP.hasPermission(p(s.hY).update);return v&&u&&D}},98164:(G,O,e)=>{"use strict";e.d(O,{$P:()=>T,Av:()=>u,Dk:()=>c,Dm:()=>M,EU:()=>D,LF:()=>C,Lt:()=>o,MN:()=>g,MU:()=>p,MZ:()=>a,NL:()=>v,UL:()=>I,VE:()=>P,Wc:()=>m,mP:()=>b,uH:()=>S,xH:()=>d});var t=e(2543),n=e.n(t),i=e(60021),s=e(82775),r=e(57220),f=e(32642);function a(R){return R.alertmanager_config.receivers||(R.alertmanager_config.receivers=[{name:"default "}]),R.alertmanager_config.route||(R.alertmanager_config.route={receiver:R.alertmanager_config.receivers[0].name}),R.template_files||(R.template_files={}),R}function c(R,A){return{...A,mute_time_intervals:A.mute_time_intervals?.filter(U=>U!==R)??[],routes:A.routes?.map(U=>c(R,U))}}function o(R,A,L){return{...L,mute_time_intervals:L.mute_time_intervals?.map(U=>U===A?R:U),routes:L.routes?.map(U=>o(R,A,U))}}function h(R){return R.map(([A,L,U])=>[A,L,unquoteWithUnescape(U)])}function g(R){return R.isEqual?R.isRegex?i.ho.regex:i.ho.equal:R.isRegex?i.ho.notRegex:i.ho.notEqual}function l(R){switch(R){case i.ho.equal:return{isEqual:!0,isRegex:!1};case i.ho.notEqual:return{isEqual:!1,isRegex:!1};case i.ho.regex:return{isEqual:!0,isRegex:!0};case i.ho.notRegex:return{isEqual:!1,isRegex:!0}}}function p(R){return{name:R.name,value:R.value,operator:g(R)}}function m(R){return{name:R.name,value:R.value,...l(R.operator)}}function y(R){return`{ ${R.map(p).reduce((U,W)=>{const w=`${W.name}${W.operator}"${W.value}"`;return U?`${U}, ${w}`:w},"")} }`}const d=[{label:i.ho.equal,description:"Equals",value:i.ho.equal},{label:i.ho.notEqual,description:"Does not equal",value:i.ho.notEqual},{label:i.ho.regex,description:"Matches regex",value:i.ho.regex},{label:i.ho.notRegex,description:"Does not match regex",value:i.ho.notRegex}];function v(R){const A=g(R);return[R.name,A,R.value]}function u(R,A){return A.every(({name:L,value:U,isRegex:W,isEqual:w})=>Object.entries(R).some(([N,B])=>{const V=L===N;let K;return w&&!W&&(K=U===B),!w&&!W&&(K=U!==B),w&&W&&(K=new RegExp(U).test(B)),!w&&W&&(K=!new RegExp(U).test(B)),V&&K}))}function D(...R){const A=R.map(f.Zc).flat(),L=(0,t.uniqWith)(A,t.isEqual);return y(L)}function P(R){return R===r.hY?"default":"unquote"}function x(){return getAllDataSources().filter(R=>R.type===DataSourceType.Alertmanager)}function E(R){return x().find(A=>R===A.uid)}function C(R){const{times:A,weekdays:L,days_of_month:U,months:W,years:w,location:N}=R,B=M(A,N),V=S(L),K=I(U),H=T(W),X=b(w);return[B,V,K,H,X].join(", ")}function M(R,A){return"Times: "+(R?R?.map(({start_time:L,end_time:U})=>`${L} - ${U} [${A??"UTC"}]`).join(" and "):"All")}function S(R){return"Weekdays: "+(R?.map(A=>{if(A.includes(":"))return A.split(":").map(L=>{const U=L.slice(0,3);return U[0].toLocaleUpperCase()+U.slice(1)}).join("-");{const L=A.slice(0,3);return L[0].toLocaleUpperCase()+L.slice(1)}}).join(", ")??"All")}function I(R){return"Days of the month: "+(R?.join(", ")??"All")}function T(R){return"Months: "+(R?.join(", ")??"All")}function b(R){return"Years: "+(R?.join(", ")??"All")}},33225:(G,O,e)=>{"use strict";e.d(O,{Hx:()=>r,gO:()=>f});var t=e(96540),n=e(55740),i=e(56361);function s(a){return{dashboardUID:a.find(([c])=>c===n.YH.dashboardUID)?.[1],panelId:a.find(([c])=>c===n.YH.panelID)?.[1]}}function r(a){return(0,t.useMemo)(()=>Object.entries(a||{}).filter(([c,o])=>!!o.trim()),[a])}function f(a){const c=new Map,{panelId:o,dashboardUID:h}=s(a);return h&&c.set(n.YH.dashboardUID,(0,i.JM)(h)),h&&o&&c.set(n.YH.panelID,(0,i.D2)(h,o)),c}},82775:(G,O,e)=>{"use strict";e.d(O,{k:()=>i,q:()=>s});var t=e(32264),n=e(25968);function i(){return Object.values(t.$.datasources)}function s(r){if(!(0,n.TN)(t.$.unifiedAlerting.minInterval))return{globalLimit:0,exceedsLimit:!1};const f=(0,n.P8)(t.$.unifiedAlerting.minInterval);if(!r||!(0,n.TN)(r))return{globalLimit:f,exceedsLimit:!1};const a=(0,n.P8)(r),c=f>a&&a>0;return{globalLimit:f,exceedsLimit:c}}},55740:(G,O,e)=>{"use strict";e.d(O,{DD:()=>i,H8:()=>p,HH:()=>n,J3:()=>l,Oq:()=>s,U3:()=>f,UU:()=>t,YH:()=>g,cB:()=>a,kW:()=>y,kl:()=>m,wG:()=>r});const t="ruler not supported",n=2e4,i="alertmanager",s="alerting-alertmanager",r=2e4,f=2e4,a=2e4,c="timeseries",o="table",h="stat";var g=(d=>(d.description="description",d.summary="summary",d.runbookURL="runbook_url",d.alertId="__alertId__",d.dashboardUID="__dashboardUid__",d.panelID="__panelId__",d))(g||{});const l={description:"Description",summary:"Summary",runbook_url:"Runbook URL",__dashboardUid__:"Dashboard UID",__panelId__:"Panel ID",__alertId__:"Alert ID"},p={description:"Description of what the alert rule does.",summary:"Short summary of what happened and why.",runbook_url:"Webpage where you keep your runbook for the alert.",__dashboardUid__:"",__panelId__:"",__alertId__:""},m=[{key:"summary",value:""},{key:"description",value:""},{key:"runbook_url",value:""}],y="__alert_rule_uid__"},57220:(G,O,e)=>{"use strict";e.d(O,{AL:()=>W,EV:()=>A,Eb:()=>U,Jz:()=>v,Vr:()=>se,Zw:()=>K,bD:()=>P,cy:()=>S,gR:()=>b,hP:()=>Z,hY:()=>g,iV:()=>E,k5:()=>k,lS:()=>R,oh:()=>B,ol:()=>p,qi:()=>y,r3:()=>V,sq:()=>I,v0:()=>L,v8:()=>d,vv:()=>l,w5:()=>X,y9:()=>Y,yc:()=>w,z2:()=>N});var t=e(19347),n=e(16233),i=e(60021),s=e(31678),r=e(94822),f=e(82843),a=e(62190),c=e(70383),o=e(75471),h=e(82775);const g="grafana",l="-- Grafana --";var p=(j=>(j.Alertmanager="alertmanager",j.Loki="loki",j.Prometheus="prometheus",j))(p||{});const m=["loki","prometheus"];function y(){return n.TP.hasPermission(s.AccessControlAction.AlertingRuleExternalRead)?(0,h.k)().filter(j=>m.includes(j.type)&&j.jsonData.manageAlerts!==!1).sort((j,q)=>j.name.localeCompare(q.name)):[]}function d(j){return N(j)?"grafana":j.uid??j.id}function v(j){return y().find(q=>q.name===j)}function u(){return(0,h.k)().filter(D).sort((j,q)=>j.name.localeCompare(q.name))}function D(j){return j.type==="alertmanager"}function P(j){return j.type==="alertmanager"}function x(){return u().filter(j=>j.jsonData.handleGrafanaManagedAlerts)}function E(j){return j.jsonData.handleGrafanaManagedAlerts===!0}const C={name:g,imgUrl:"public/img/grafana_icon.svg",hasConfigurationAPI:!0};function M(){return[C,...u().map(j=>({name:j.name,displayName:j.name,imgUrl:j.meta.info.logos.small,meta:j.meta}))]}function S(j){const q=(0,a.W)(j),ne=q.availableExternalDataSources.filter(le=>le.handleGrafanaManagedAlerts),oe=q.availableInternalDataSources,{currentData:z}=f.m.endpoints.getGrafanaAlertingConfigurationStatus.useQuery();switch(z?.alertmanagersChoice){case i.nA.Internal:return oe;case i.nA.External:return ne;default:return[...oe,...ne]}}function I(j){const q=[],ne=[],oe={instance:o.HL.read,notification:o.VQ.read,silence:o.nU.read};if(Object.values(oe).flatMap(le=>le.grafana).some(le=>n.TP.hasPermission(le))&&q.push(C),n.TP.hasPermission(oe[j].external)){const le=u().map(ie=>({name:ie.name,displayName:ie.name,imgUrl:ie.meta.info.logos.small,meta:ie.meta,hasConfigurationAPI:(0,c.Kh)(ie.jsonData),handleGrafanaManagedAlerts:ie.jsonData.handleGrafanaManagedAlerts}));ne.push(...le)}return{availableInternalDataSources:q,availableExternalDataSources:ne}}function T(j){const q=B(j);if(!q)throw new Error(`Data source ${j} not found`);if(q.type!=="loki"&&q.type!=="prometheus")throw new Error(`Unexpected data source type ${q.type}`);return q}function b(){const j=y().map(q=>q.name);return n.TP.hasPermission(s.AccessControlAction.AlertingRuleRead)&&j.push(g),j}function R(){const j=y();return n.TP.hasPermission(s.AccessControlAction.AlertingRuleRead)&&j.push(g),j}function A(j){return U(j)?j.name:j}function L(j){return U(j)?j.uid:g}function U(j){return j!==g}function W(j){return j!==g&&V(j)?.jsonData?.implementation===i.Oz.prometheus}function w(j){return j.readOnly===!0}function N(j){return j===g}function B(j){return(0,h.k)().find(q=>q.name===j)}function V(j){return(0,h.k)().filter(D).find(q=>q.name===j)}function K(j){return j===g?g:B(j)}function H(j){if(j===g)return g;const q=B(j);if(!q)throw new Error(`Datasource "${j}" not found`);return String(q.id)}function X(j){if(j===g)return g;const q=B(j);if(!q)throw new Error(`Datasource "${j}" not found`);return q.uid}function k(){return(0,t.l)().getList({alerting:!0})[0]}function Y(){const j=(0,t.l)().getInstanceSettings("default");return j?.meta.alerting??!1?j:k()}function Z(j){return j.jsonData.manageAlerts!==!1}function se(j){return N(j)?"grafana":"prometheusType"in j.jsonData?j.jsonData?.prometheusType??r.N1.Prometheus:j.type==="loki"?"loki":r.N1.Prometheus}},75214:(G,O,e)=>{"use strict";e.d(O,{Dd:()=>n,F2:()=>a,M4:()=>t,lL:()=>r,rm:()=>f,w0:()=>c,x4:()=>s,zm:()=>i});function t(o){return Object.entries(o).map(([h,g])=>`${h}=${g}`).sort()}function n(o){return Object.entries(o).map(([h,g])=>[h,g])}function i(o){const h={};return o.forEach(g=>{h[g[0]]=g[1]}),h}function s(o){const h={};return o.forEach(g=>{g.key&&(h[g.key]=g.value)}),h}const r="__grafana_origin";function f(o){return Object.keys(o).filter(h=>!a(h)).length}function a(o){return o.startsWith("__")&&o.endsWith("__")||o===r}const c=([o,h])=>a(o)},32642:(G,O,e)=>{"use strict";e.d(O,{Ig:()=>u,J$:()=>p,J9:()=>l,S6:()=>o,So:()=>a,Zc:()=>h,b2:()=>v,ou:()=>g,qR:()=>f,t8:()=>D});var t=e(2543),n=e.n(t),i=e(60021),s=e(75214);const r=[i.ho.regex,i.ho.notRegex,i.ho.notEqual,i.ho.equal];function f(C){if(C.startsWith("{")&&C.endsWith("}"))throw new Error("this function does not support PromQL-style matcher syntax, call parsePromQLStyleMatcher() instead");const M=r.map(R=>[R,C.indexOf(R)]).filter(([R,A])=>A>-1).sort((R,A)=>R[1]-A[1]);if(!M.length)throw new Error(`Invalid matcher: ${C}`);const[S,I]=M[0],T=C.slice(0,I).trim(),b=C.slice(I+S.length);if(!T)throw new Error(`Invalid matcher: ${C}`);return{name:T,value:b,isRegex:S===i.ho.regex||S===i.ho.notRegex,isEqual:S===i.ho.equal||S===i.ho.regex}}function a(C){return P(C)?c(C):[f(C)]}function c(C){if(!P(C))throw new Error("not a PromQL style matcher");return o(C)}function o(C){const M=/,(?=(?:[^"]*"[^"]*")*[^"]*$)/,S=C.replace(/^\{/,"").replace(/\}$/,"").trim().split(M);return(0,t.compact)(S).flatMap(f).map(I=>({...I,name:u(I.name),value:u(I.value)}))}function h(C){try{return o(C)}catch{return[]}}function g(C){const M=C.filter(S=>!!S.trim()).map(S=>f(S));return(0,t.uniqBy)(M,S=>S.name)}const l=C=>{const M=Object.entries(C).filter(([I])=>!(0,s.F2)(I)),S=new URLSearchParams;return M.forEach(([I,T])=>S.append("matcher",`${I}=${T}`)),S},p=C=>{let M=[];return C.matchers&&C.matchers.forEach(S=>{const I=a(S).map(x);M=M.concat(I)}),C.object_matchers&&M.push(...C.object_matchers),C.match_re&&Object.entries(C.match_re).forEach(([S,I])=>{M.push([S,i.ho.regex,I])}),C.match&&Object.entries(C.match).forEach(([S,I])=>{M.push([S,i.ho.equal,I])}),M};function m(C){return`"${C.replace(/[\\"]/g,S=>`\\${S}`)}"`}const y=/[\{\}\!\=\~\,\\\"\'\`\s]+/;function d(C){return y.test(C)?m(C):C}const v=({name:C,operator:M,value:S})=>{const I=d(C),T=m(S);return`${I}${M}${T}`};function u(C){return/^"(.*)"$/.test(C)?C.replace(/^"(.*)"$/,"$1").replace(/\\"/g,'"').replace(/\\\\/g,"\\"):C}const D={default:([C,M,S])=>`${C} ${M} ${S||""}`,unquote:([C,M,S])=>{const I=u(C),T=u(S)||'""';return`${I} ${M} ${T}`}};function P(C){return C.startsWith("{")&&C.endsWith("}")}function x(C){const M=E(C);return[C.name,M,C.value]}function E(C){return C.isEqual?C.isRegex?i.ho.regex:i.ho.equal:C.isRegex?i.ho.notRegex:i.ho.notEqual}},56361:(G,O,e)=>{"use strict";e.d(O,{BK:()=>b,Cp:()=>V,D2:()=>w,ES:()=>X,GD:()=>R,Ht:()=>x,JM:()=>W,JZ:()=>Y,KT:()=>M,NH:()=>A,S2:()=>D,Sl:()=>P,Y9:()=>T,Yp:()=>d,bg:()=>v,c$:()=>L,i7:()=>u,i9:()=>N,nL:()=>S,qN:()=>U,qc:()=>H,qy:()=>C,u7:()=>k,w$:()=>y,y$:()=>K});var t=e(2543),n=e.n(t),i=e(61268),s=e(32264),r=e(17172),f=e(16233),a=e(18461),c=e(23662),o=e(64861),h=e(94822),g=e(55740),l=e(57220),p=e(32642),m=e(3704);function y(Z,se,j){const q=(0,l.EV)(Z),ne=a.UP(q,se),oe=encodeURIComponent(a.$9(ne)),z=encodeURIComponent(q);return(0,m.c)(`/alerting/${z}/${oe}/view`,j?{returnTo:j}:{})}function d(Z,se){const{uid:j,type:q}=Z;return(0,m.c)("/explore",{left:JSON.stringify({datasource:Z.uid,queries:[{refId:"A",datasource:{uid:j,type:q},expr:se}],range:{from:"now-1h",to:"now"}})})}function v(Z,se=""){return(0,m.c)(`/alerting/notifications/receivers/${encodeURIComponent(Z)}/edit`,{alertmanager:se})}function u(Z,se=""){return(0,m.c)("/alerting/routes/mute-timing/edit",{muteName:Z,alertmanager:se})}function D(Z,se){if((0,l.Eb)(Z))return(0,m.z)(`/alerting/${encodeURIComponent(Z.name)}/${encodeURIComponent((0,a.PH)(se.name))}/find`);if((0,c.lT)(se.rulerRule))return(0,m.z)(`/alerting/grafana/${se.rulerRule.grafana_alert.uid}/view`)}function P(Z){return Z.reduce((se,{key:j,value:q})=>(se[j]=q,se),{})}const x=Z=>{const se=Z.queryString===void 0?void 0:String(Z.queryString),j=Z.alertState===void 0?void 0:String(Z.alertState),q=Z.dataSource===void 0?void 0:String(Z.dataSource),ne=Z.ruleType===void 0?void 0:String(Z.ruleType),oe=Z.groupBy===void 0?void 0:String(Z.groupBy).split(",");return{queryString:se,alertState:j,dataSource:q,groupBy:oe,ruleType:ne}},E=Z=>({queryString:Z.get("queryString")??void 0,contactPoint:Z.get("contactPoint")??void 0}),C=Z=>{const se=Z.queryString===void 0?void 0:String(Z.queryString),j=Z.silenceState===void 0?void 0:String(Z.silenceState);return{queryString:se,silenceState:j}};function M(Z){return Object.entries(Z).map(([se,j])=>({key:se,value:j}))}function S(Z,se,j){const q=new URLSearchParams(j);return se&&q.set(g.DD,se),`${Z}?${q.toString()}`}const I=Z=>Z.replace(/\"/g,'\\"');function T(Z){return Z.startsWith('"')&&Z.endsWith('"')?I(Z):`"${I(Z)}"`}function b(Z,se){const j=new URLSearchParams;return j.append("alertmanager",Z),(0,p.J9)(se).forEach((ne,oe)=>j.append(oe,ne)),(0,m.c)("/alerting/silence/new",j)}function R(Z){return(0,m.c)(`/datasources/edit/${Z}`)}function A(Z){return(0,m.c)(`/dashboards/f/${Z}`)}function L(Z,se){return(0,m.c)(`/dashboards/f/${Z}/${se}/alerting`)}function U(Z){return(0,m.c)(`/dashboards/f/${Z}/settings`)}function W(Z){return(0,m.c)(`/d/${encodeURIComponent(Z)}`)}function w(Z,se){const j=new URLSearchParams({viewPanel:se});return(0,m.c)(`/d/${encodeURIComponent(Z)}`,j)}function N(Z,se,j,q=1e3){const ne=new Date().getTime(),oe=()=>Z().catch(z=>{if(se(z)&&new Date().getTime()-ne<j)return new Promise(te=>setTimeout(te,q)).then(oe);throw z});return oe()}const B={[h.Gi.Alerting]:1,[h.cF.Firing]:1,[h.Gi.Error]:1,[h.Gi.Pending]:2,[h.cF.Pending]:2,[h.cF.Inactive]:2,[h.Gi.NoData]:3,[h.Gi.Normal]:4};function V(Z,se){if(Z===o.xB.Importance)return(0,t.sortBy)(se,q=>[B[(0,h.lh)(q.state)],(0,c.RI)(q).toLocaleLowerCase()]);if(Z===o.xB.TimeAsc)return(0,t.sortBy)(se,q=>[new Date(q.activeAt)||new Date,(0,c.RI)(q).toLocaleLowerCase()]);if(Z===o.xB.TimeDesc)return(0,t.sortBy)(se,q=>[new Date(q.activeAt)||new Date,(0,c.RI)(q).toLocaleLowerCase()]).reverse();const j=(0,t.sortBy)(se,q=>(0,c.RI)(q).toLocaleLowerCase());return Z===o.xB.AlphaDesc&&j.reverse(),j}function K(){return s.$.buildInfo.edition===i.r.OpenSource}function H(){return f.TP.hasRole("Admin")||f.TP.isGrafanaAdmin}function X(){return s.$.buildInfo.env==="development"}function k(Z){return!!(Z&&typeof Z=="object"&&"message"in Z)}function Y(Z){return(0,r.NF)(Z)?Z.message?Z.message:"message"in Z.data&&typeof Z.data.message=="string"?Z.data.message:Z.statusText?Z.statusText:String(Z.status)||"Unknown error":k(Z)?Z.cause?`${Z.message}, cause: ${Y(Z.cause)}`:Z.message:String(Z)}},88467:(G,O,e)=>{"use strict";e.d(O,{$I:()=>g,BU:()=>x,CZ:()=>m,J7:()=>o,ML:()=>E,Vf:()=>D,Xw:()=>h,jA:()=>a,p0:()=>y,t4:()=>P,v5:()=>l});var t=e(65307),n=e(26272),i=e(17172),s=e(10096),r=e(25027),f=e(56361);const a=Object.freeze({loading:!1,result:void 0,error:void 0,dispatched:!1});function c(C,M=a,S){if(C.pending.match(S))return{result:M.result,loading:!0,error:M.error,dispatched:!0,requestId:S.meta.requestId};if(C.fulfilled.match(S)){if(M.requestId===void 0||M.requestId===S.meta.requestId)return{...M,result:S.payload,loading:!1,error:void 0}}else if(C.rejected.match(S)&&M.requestId===S.meta.requestId)return{...M,loading:!1,error:S.error};return M}function o(C,M){return(0,t.Z0)({name:C,initialState:a,reducers:{},extraReducers:S=>S.addDefaultCase((I,T)=>c(M,I,T))})}function h(C,M,S){return(0,t.Z0)({name:C,initialState:{},reducers:{},extraReducers:I=>I.addDefaultCase((T,b)=>{if((0,t.$S)(M)(b)){const R=b,A=S(R.meta.arg);return{...T,[A]:c(M,T[A],R)}}return T})})}function g(C){return C.catch(M=>{throw{message:m(M),code:M.statusCode}})}function l(C,M){return C.then(S=>(M.successMessage&&s.lE.emit(n.r1.alertSuccess,[M.successMessage]),S)).catch(S=>{const I=m(S);throw s.lE.emit(n.r1.alertError,[`${M.errorMessage??"Error"}: ${I}`]),S})}const p="Unknown Error";function m(C){if((0,i.NF)(C))if(C.data?.message){let M=C.data?.message;return typeof C.data?.error=="string"&&(M+=`; ${C.data.error}`),M}else{if(Array.isArray(C.data)&&C.data.length&&C.data[0]?.message)return C.data.map(M=>M?.message).filter(M=>!!M).join(" ");if(C.statusText)return C.statusText}return(0,f.u7)(C)?C.message:((0,r.fH)(r.le.unknownMessageFromError,{error:JSON.stringify(C)}),p)}function y(C){return Object.values(C).every(d)}function d(C){return C.dispatched&&!C.loading}function v(C){return Object.values(C).every(u)}function u(C){return C.dispatched&&!C.loading&&!C.error}function D(C){return Object.values(C).some(E)}function P(C){return Object.values(C).some(M=>M.dispatched)}function x(C){return Object.values(C).some(u)}function E(C){return C?C.dispatched&&C.loading:!1}},63066:(G,O,e)=>{"use strict";e.d(O,{Bu:()=>q,IJ:()=>I,J6:()=>Y,JE:()=>A,Q8:()=>x,QX:()=>w,Qk:()=>N,Rk:()=>ne,T6:()=>S,XI:()=>B,Z9:()=>U,ir:()=>oe,l1:()=>b,mp:()=>k,qO:()=>V});var t=e(2543),n=e.n(t),i=e(43127),s=e(65879),r=e(77789),f=e(32264),a=e(19347),c=e(26657),o=e(80943),h=e(74730),g=e(66718),l=e(94822),p=e(55907),m=e(86590),y=e(75471),d=e(55740),v=e(57220),u=e(56361),D=e(23662),P=e(25968);const x="grafana.alerting.manualRouting",E=(0,P.P8)(f.$.unifiedAlerting?.minInterval??"10s"),C=(0,P.P8)("1m"),S=(0,P.an)((0,t.clamp)(E,C,1/0)),I=()=>{const{canCreateGrafanaRules:z,canCreateCloudRules:te}=(0,y.Q9)();return Object.freeze({name:"",uid:"",labels:[{key:"",value:""}],annotations:d.kl,dataSourceName:null,type:z?m.Z.grafana:te?m.Z.cloudAlerting:void 0,group:"",folder:null,queries:[],recordingRulesQueries:[],condition:"",noDataState:l.Q8.NoData,execErrState:l.Q8.Error,evaluateFor:S,evaluateEvery:S,manualRouting:T(),contactPoints:{},overrideGrouping:!1,overrideTimings:!1,muteTimeIntervals:[],namespace:"",expression:"",forTime:1,forTimeUnit:"m"})},T=()=>f.$.featureToggles.alertingSimplifiedRouting??!1?localStorage.getItem(x)!=="false":!1;function b(z){const{name:te,expression:le,forTime:ie,forTimeUnit:ae,keepFiringForTime:re,keepFiringForTimeUnit:ce,type:me}=z;if(me===m.Z.cloudAlerting){let ee;return re&&ce&&(ee=`${re}${ce}`),{alert:te,for:`${ie}${ae}`,keep_firing_for:ee,annotations:(0,u.Sl)(z.annotations||[]),labels:(0,u.Sl)(z.labels||[]),expr:le}}else if(me===m.Z.cloudRecording)return{record:te,labels:(0,u.Sl)(z.labels||[]),expr:le};throw new Error(`unexpected rule type: ${me}`)}function R(z,te){const le=[...(0,u.KT)(z||{})];return te&&le.push({key:"",value:""}),le}function A(z){const te=[...z];return d.kl.map(ie=>ie.key).forEach((ie,ae)=>{const re=te.findIndex(ce=>ce.key===ie);if(re===-1){const ce={key:ie,value:""};te.splice(ae,0,ce)}else re!==ae&&te.splice(ae,0,te.splice(re,1)[0])}),te}function L(z,te){if(te?.grafana?.selectedContactPoint&&z)return{receiver:te?.grafana?.selectedContactPoint,mute_time_intervals:te?.grafana?.muteTimeIntervals,group_by:te?.grafana?.overrideGrouping?te?.grafana?.groupBy:void 0,group_wait:te?.grafana?.overrideTimings&&te?.grafana?.groupWaitValue?te?.grafana?.groupWaitValue:void 0,group_interval:te?.grafana?.overrideTimings&&te?.grafana?.groupIntervalValue?te?.grafana?.groupIntervalValue:void 0,repeat_interval:te?.grafana?.overrideTimings&&te?.grafana?.repeatIntervalValue?te?.grafana?.repeatIntervalValue:void 0}}function U(z){const{name:te,condition:le,noDataState:ie,execErrState:ae,evaluateFor:re,queries:ce,isPaused:me,contactPoints:ee,manualRouting:de}=z;if(le){const De=L(de,ee);return{grafana_alert:{title:te,condition:le,no_data_state:ie,exec_err_state:ae,data:ce.map(se),is_paused:!!me,notification_settings:De},for:re,annotations:(0,u.Sl)(z.annotations||[]),labels:(0,u.Sl)(z.labels||[])}}throw new Error("Cannot create rule without specifying alert condition")}function W(z){const te=z.notification_settings?{selectedContactPoint:z.notification_settings.receiver,muteTimeIntervals:z.notification_settings.mute_time_intervals??[],overrideGrouping:Array.isArray(z.notification_settings.group_by)&&z.notification_settings.group_by.length>0,overrideTimings:[z.notification_settings.group_wait,z.notification_settings.group_interval,z.notification_settings.repeat_interval].some(Boolean),groupBy:z.notification_settings.group_by||[],groupWaitValue:z.notification_settings.group_wait||"",groupIntervalValue:z.notification_settings.group_interval||"",repeatIntervalValue:z.notification_settings.repeat_interval||""}:void 0;return te?{[v.hY]:te}:void 0}function w(z){const{ruleSourceName:te,namespace:le,group:ie,rule:ae}=z,re=I();if((0,v.z2)(te))if((0,D.lT)(ae)){const ce=ae.grafana_alert,me=W(ce);return{...re,name:ce.title,type:m.Z.grafana,group:ie.name,evaluateEvery:ie.interval||re.evaluateEvery,evaluateFor:ae.for||"0",noDataState:ce.no_data_state,execErrState:ce.exec_err_state,queries:ce.data,condition:ce.condition,annotations:A(R(ae.annotations,!1)),labels:R(ae.labels,!0),folder:{title:le,uid:ce.namespace_uid},isPaused:ce.is_paused,contactPoints:me,manualRouting:!!me}}else throw new Error("Unexpected type of rule for grafana rules source");else if((0,D.$y)(ae)){const me={refId:"A",datasourceUid:(0,a.l)().getInstanceSettings(te)?.uid??"",queryType:"",relativeTimeRange:(0,i.Cn)(),expr:ae.expr,model:{refId:"A",hide:!1,expr:ae.expr}},ee=N(ae);return{...re,...ee,queries:[me],annotations:A(R(ae.annotations,!1)),type:m.Z.cloudAlerting,dataSourceName:te,namespace:le,group:ie.name}}else if((0,D.i7)(ae)){const ce=B(ae);return{...re,...ce,type:m.Z.cloudRecording,dataSourceName:te,namespace:le,group:ie.name}}else throw new Error("Unexpected type of rule for cloud rules source")}function N(z){const te=I(),[le,ie]=z.for?(0,P.P1)(z.for):[0,"s"],[ae,re]=z.keep_firing_for?(0,P.P1)(z.keep_firing_for):[te.keepFiringForTime,te.keepFiringForTimeUnit];return{name:z.alert,expression:z.expr,forTime:le,forTimeUnit:ie,keepFiringForTime:ae,keepFiringForTimeUnit:re,annotations:R(z.annotations,!1),labels:R(z.labels,!0)}}function B(z){return{name:z.record,expression:z.expr,labels:R(z.labels,!0)}}const V=()=>{const z=(0,v.y9)();if(!z)return[...H("A","B")];const te=(0,i.Cn)();return[{refId:"A",datasourceUid:z.uid,queryType:"",relativeTimeRange:te,model:{refId:"A"}},...H("B","C")]},K=z=>{const te=getDefaultRelativeTimeRange();return[{refId:"A",datasourceUid:z[0]?.uid||"",queryType:"",relativeTimeRange:te,model:{refId:"A"}}]},H=(...z)=>{const te=z[0],le=z[1],ie={refId:z[0],type:g.Tz.reduce,datasource:{uid:g.Uj,type:c.dR.type},conditions:[{type:"query",evaluator:{params:[],type:p.p.IsAbove},operator:{type:"and"},query:{params:[te]},reducer:{params:[],type:"last"}}],reducer:"last",expression:"A"},ae={refId:le,type:g.Tz.threshold,datasource:{uid:g.Uj,type:c.dR.type},conditions:[{type:"query",evaluator:{params:[0],type:p.p.IsAbove},operator:{type:"and"},query:{params:[le]},reducer:{params:[],type:"last"}}],expression:te};return[{refId:te,datasourceUid:g.Uj,queryType:"",model:ie},{refId:le,datasourceUid:g.Uj,queryType:"",model:ae}]},X=async(z,te,le,ie,ae,re)=>{const ce=[];for(const me of z){const ee=await(0,a.l)().get(me.datasource?.uid?me.datasource:ie),de={uid:ee.uid,type:ee.type},De=s.relativeToTimeRange(te),{interval:fe,intervalMs:Te}=Z(De,re??ee.interval,ae),je={__interval:{text:fe,value:fe},__interval_ms:{text:Te,value:Te},...le},He=ee.interpolateVariablesInQueries?ee.interpolateVariablesInQueries([me],je)[0]:me;if(de.uid===g.Uj){const Be={refId:He.refId,queryType:"",relativeTimeRange:te,datasourceUid:g.Uj,model:He};ce.push(Be)}else{const Be=(0,a.l)().getInstanceSettings(de);if(Be&&Be.meta.alerting){const Ne={refId:He.refId,queryType:He.queryType??"",relativeTimeRange:te,datasourceUid:Be.uid,model:{...He,maxDataPoints:ae,intervalMs:Te}};ce.push(Ne)}}}return ce},k=async(z,te)=>{const{targets:le}=z;if(!z.id||!te.uid)return;const ie=s.timeRangeToRelative(s.convertRawToRange(te.time)),ae=await X(le,ie,z.scopedVars||{},z.datasource??void 0,z.maxDataPoints??void 0,z.interval??void 0);if(!ae.length||!ae.find(ee=>ee.datasourceUid!==g.Uj))return;if(!ae.find(ee=>ee.datasourceUid===g.Uj)){const[ee,de]=H((0,r.M)(ae),"-");ae.push(ee);const[De,fe]=H(ee.refId,(0,r.M)(ae));ae.push(fe)}const{folderTitle:re,folderUid:ce}=te.meta;return{type:m.Z.grafana,folder:ce&&re?{uid:ce,title:re}:void 0,queries:ae,name:z.title,condition:ae[ae.length-1].refId,annotations:[{key:d.YH.dashboardUID,value:te.uid},{key:d.YH.panelID,value:String(z.id)}]}},Y=async z=>{if(!z.state.key)return;const te=o.jh.getTimeRange(z),le=(0,h.un)(z);if(!le)return;const{queries:ie,datasource:ae,maxDataPoints:re,minInterval:ce}=le.state,me=(0,h.YQ)(z);if(!me||!me.state.uid)return;const ee=await X(ie,s.timeRangeToRelative(s.convertRawToRange(te.state.value.raw)),{__sceneObject:{value:z}},ae,re,ce);if(!ee.length||!ee.find(Te=>Te.datasourceUid!==g.Uj))return;if(!ee.find(Te=>Te.datasourceUid===g.Uj)){const[Te,je]=H((0,r.M)(ee),"-");ee.push(Te);const[He,Be]=H(Te.refId,(0,r.M)(ee));ee.push(Be)}const{folderTitle:de,folderUid:De}=me.state.meta;return{type:m.Z.grafana,folder:De&&de?{uid:De,title:de}:void 0,queries:ee,name:z.state.title,condition:ee[ee.length-1].refId,annotations:[{key:d.YH.dashboardUID,value:me.state.uid},{key:d.YH.panelID,value:String((0,h.Cs)(z))}]}};function Z(z,te,le){return le?s.calculateInterval(z,le,te):te&&s.intervalToMs(te)>1e3?{interval:te,intervalMs:s.intervalToMs(te)}:{interval:"1s",intervalMs:1e3}}function se(z){const te=z.model;return j(te)&&te.instant&&te.range?{...z,model:{...te,range:!0,instant:!1}}:z}function j(z){return"expr"in z&&"instant"in z&&"range"in z}function q(z){return"expr"in z}const ne=z=>({...z,queries:z.queries?.map(te=>(0,t.omit)(te,"model.hide"))});function oe(z){return ne(w(z))}},18461:(G,O,e)=>{"use strict";e.d(O,{$9:()=>D,LC:()=>h,Ns:()=>x,P1:()=>f,PH:()=>y,UP:()=>c,VY:()=>M,Yd:()=>o,c:()=>d,qg:()=>v,uE:()=>S,x6:()=>u});var t=e(2543),n=e.n(t),i=e(12131),s=e(57220),r=e(23662);function f(I,T,b,R){return(0,r.lT)(R)?{uid:R.grafana_alert.uid,ruleSourceName:"grafana"}:{ruleSourceName:I,namespace:T,groupName:b,ruleName:(0,r.$y)(R)?R.alert:R.record,rulerRuleHash:x(R)}}function a(I,T,b,R){return{ruleSourceName:I,namespace:T,groupName:b,ruleName:R.name,ruleHash:E(R)}}function c(I,T){const b=T.namespace.name,R=T.group.name;if(T.rulerRule)return f(I,b,R,T.rulerRule);if(T.promRule)return a(I,b,R,T.promRule);throw new Error("Could not create an id for a rule that is missing both `rulerRule` and `promRule`.")}function o(I){return f(I.ruleSourceName,I.namespace,I.group.name,I.rule)}function h(I,T){return(0,r.A4)(I)&&(0,r.A4)(T)?I.uid===T.uid:(0,r.X4)(I)&&(0,r.X4)(T)?I.groupName===T.groupName&&I.namespace===T.namespace&&I.ruleName===T.ruleName&&I.rulerRuleHash===T.rulerRuleHash&&I.ruleSourceName===T.ruleSourceName:(0,r.Mj)(I)&&(0,r.Mj)(T)?I.groupName===T.groupName&&I.namespace===T.namespace&&I.ruleName===T.ruleName&&I.ruleHash===T.ruleHash&&I.ruleSourceName===T.ruleSourceName:!1}const g="cri",l="pri";function p(I){return I.replace(/\$/g,"_DOLLAR_")}function m(I){return I.replace(/\_DOLLAR\_/g,"$")}function y(I){return I.replace(/\//g,"").replace(/\\/g,"")}function d(I){return I.replace(/\x1f/g,"/").replace(/\x1e/g,"\\")}function v(I,T=!1){const R=(T?decodeURIComponent(I):I).split("$");if(R.length===1)return{uid:I,ruleSourceName:"grafana"};if(R.length===6){const[A,L,U,W,w,N]=R.map(m).map(d);if(A===g)return{ruleSourceName:L,namespace:U,groupName:W,ruleName:w,rulerRuleHash:N};if(A===l)return{ruleSourceName:L,namespace:U,groupName:W,ruleName:w,ruleHash:N}}throw new Error(`Failed to parse rule location: ${I}`)}function u(I,T=!1){if(I)try{return v(I,T)}catch{return}}function D(I){return(0,r.A4)(I)?I.uid:(0,r.X4)(I)?[g,I.ruleSourceName,I.namespace,I.groupName,I.ruleName,I.rulerRuleHash].map(String).map(p).map(y).join("$"):[l,I.ruleSourceName,I.namespace,I.groupName,I.ruleName,I.ruleHash].map(String).map(p).map(y).join("$")}function P(I){let T=0;if(I.length===0)return T;for(let b=0;b<I.length;b++){const R=I.charCodeAt(b);T=(T<<5)-T+R,T=T&T}return T}function x(I){if((0,r.i7)(I))return P(JSON.stringify([I.record,I.expr,C(I.labels)])).toString();if((0,r.$y)(I))return P(JSON.stringify([I.alert,I.expr,C(I.annotations),C(I.labels)])).toString();if((0,r.lT)(I))return I.grafana_alert.uid;throw new Error("only recording and alerting ruler rules can be hashed")}function E(I){if((0,r.KB)(I))return P(JSON.stringify([I.type,I.query,C(I.labels)])).toString();if((0,r.Z8)(I))return P(JSON.stringify([I.type,I.query,C(I.annotations),C(I.labels)])).toString();throw new Error("only recording and alerting rules can be hashed")}function C(I){return JSON.stringify(Object.entries(I||{}).sort((T,b)=>T[0].localeCompare(b[0])))}function M(I){return(0,r.A4)(I)?s.hY:I.ruleSourceName}function S(I){const{pathname:T=""}=i.Ny.getLocation(),{id:b}=I;return b?(0,t.nth)(T.split("/"),-2):void 0}},23662:(G,O,e)=>{"use strict";e.d(O,{$7:()=>D,$y:()=>p,A4:()=>P,HH:()=>v,I2:()=>X,KB:()=>l,Mj:()=>C,Mt:()=>d,Om:()=>w,RI:()=>u,TU:()=>A,Tm:()=>T,Uw:()=>H,Wy:()=>U,X4:()=>x,XI:()=>b,YN:()=>N,Z8:()=>g,dS:()=>L,f6:()=>M,i7:()=>m,jg:()=>V,lT:()=>y,nf:()=>E,qz:()=>B,uo:()=>S});var t=e(2543),n=e.n(t),i=e(43585),s=e(32264),r=e(94822),f=e(28475),a=e(55740),c=e(57220),o=e(75214),h=e(25968);function g(k){return typeof k=="object"&&k.type===r.JS.Alerting}function l(k){return typeof k=="object"&&k.type===r.JS.Recording}function p(k){return typeof k=="object"&&"alert"in k}function m(k){return typeof k=="object"&&"record"in k}function y(k){return typeof k=="object"&&"grafana_alert"in k}function d(k){return typeof k=="object"&&!y(k)}function v(k){return k&&y(k)&&!!k.grafana_alert.is_paused}function u(k){return JSON.stringify(k.labels)}function D(k){return k.error&&k.error?.message?.includes(a.UU)}function P(k){return"uid"in k}function x(k){return"rulerRuleHash"in k}function E(k){return Object.values(r.JS).includes(k)}function C(k){return"ruleHash"in k}function M(k){switch(k){case"ok":return f.Jc.Ok;case"nodata":return f.Jc.NoData;case"error":case"err":return f.Jc.Error;case"unknown":return f.Jc.Unknown;default:return}}function S(k){const Y=k.labels[o.lL];if(!Y)return;const Z=Y.match(/^plugin\/(?<pluginId>.+)$/);if(!Z?.groups)return;const se=Z.groups.pluginId;if(I(se))return{pluginId:se}}function I(k){return!!s.$.apps[k]}function T(k){return!!S(k)}function b(k){return k===r.cF.Inactive?"Normal":(0,t.capitalize)(k)}const R=k=>k.reduce((Y,{dataSourceName:Z,name:se,groups:j})=>(j.forEach(({name:q,rules:ne})=>{ne.forEach(oe=>{g(oe)&&Y.push({dataSourceName:Z,namespaceName:se,groupName:q,rule:oe})})}),Y),[]),A=k=>g(k.promRule)?k.promRule:null,L=k=>k.reduce((Y,{rulesSource:Z,name:se,groups:j})=>(j.forEach(({name:q,rules:ne})=>{ne.forEach(oe=>{oe.promRule&&g(oe.promRule)&&Y.push({dataSourceName:(0,c.EV)(Z),namespaceName:se,groupName:q,...oe})})}),Y),[]);function U(k){let Y;return Object.values(i.O).includes(k)?Y=k:Y=(0,r.lh)(k),W[Y]}const W={[r.cF.Inactive]:"good",[r.cF.Firing]:"bad",[r.cF.Pending]:"warning",[r.Gi.Alerting]:"bad",[r.Gi.Error]:"bad",[r.Gi.NoData]:"info",[r.Gi.Normal]:"good",[r.Gi.Pending]:"warning",[i.O.NoData]:"info",[i.O.Paused]:"warning",[i.O.Alerting]:"bad",[i.O.OK]:"good",[i.O.Unknown]:"info"};function w(k){return k?.alerts?k.alerts.reduce((Y,Z)=>{const se=(0,r.lh)(Z.state)!==r.Gi.Normal;if(Z.activeAt&&se){const j=new Date(Z.activeAt);if(Y===null||Y.getTime()>j.getTime())return j}return Y},null):null}function N(k){return Array.isArray(k.source_tenants)}function B(k){return y(k)?k.grafana_alert.title:p(k)?k.alert:m(k)?k.record:""}const V=(k,Y)=>{const Z={alertName:"",forDuration:"0s",evaluationsToFire:0};return y(k)?{alertName:k.grafana_alert.title,forDuration:k.for,evaluationsToFire:K(k.for,Y)}:p(k)?{alertName:k.alert,forDuration:k.for??"0s",evaluationsToFire:K(k.for??"0s",Y)}:Z},K=(k,Y)=>{const Z=(0,h.P8)(Y),se=(0,h.P8)(k);return se===0&&Z!==0?1:Z===0||se/Z<1?0:Math.ceil(se/Z)+1};function H(k){const Y=(0,c.z2)(k.namespace.rulesSource)?k.namespace.rulesSource:k.namespace.rulesSource.name,Z=y(k.rulerRule)?k.rulerRule.grafana_alert.namespace_uid:k.namespace.name;return{dataSourceName:Y,namespaceName:Z,groupName:k.group.name}}function X(k){const Y=k.ruleSourceName,Z=y(k.rule)?k.rule.grafana_alert.namespace_uid:k.namespace,se=k.group.name;return{dataSourceName:Y,namespaceName:Z,groupName:se}}},25968:(G,O,e)=>{"use strict";e.d(O,{M9:()=>o,P1:()=>n,P8:()=>g,TN:()=>r,an:()=>h,mo:()=>l,sc:()=>s,yl:()=>p});var t=e(41068);function n(m){const y=m.match(/(\d+)(\w+)/);if(y)return[Number(y[1]),y[2]];throw new Error(`Invalid interval description: ${m}`)}function i(m){const{sec:y,count:d}=describeInterval(m);return y*d}const s=Object.entries(t.y).map(([m,y])=>({label:m[0].toUpperCase()+m.slice(1),value:y}));function r(m){try{return o(m),!0}catch{return!1}}const f={ms:1,s:1e3,m:60*1e3,h:60*60*1e3,d:24*60*60*1e3,w:7*24*60*60*1e3,y:365*24*60*60*1e3},a=new RegExp(/^(?:(?<value>\d+)(?<type>ms|s|m|h|d|w|y))|0$/),c=new Error(`Must be of format "(number)(unit)", for example "1m", or just "0". Available units: ${Object.values(t.y).join(", ")}`);function o(m){let y=m,d=[];function v(D){const P=a.exec(D),x=P?.groups?.value&&P?.groups?.type;if(!P||!x)throw c;P&&P.groups?.value&&P.groups?.type&&(y=y.replace(P[0],""),d.push([Number(P.groups.value),P.groups.type])),y&&v(y)}if(v(m),!d.length)throw c;return d.reduce((D,[P,x])=>{const E=P*f[x];return D+E},0)}function h(m){const y=Math.floor(m/1e3),d=Math.floor(y/60),v=Math.floor(d/60),u=Math.floor(v/24),D=Math.floor(u/7),P=Math.floor(u/365);return m===0?"0s":[[P,"y"],[D%52,"w"],[u%365-7*(D%52),"d"],[v%24,"h"],[d%60,"m"],[y%60,"s"],[m%1e3,"ms"]].filter(([E])=>E>0).map(([E,C])=>E+C).join("")}const g=m=>{try{return o(m)}catch{return 0}},l=m=>m.includes("0001-01-01T00");function p(m){return m%(1e3*60*60)===0?m/(1e3*60*60)+"h":m%(1e3*60)===0?m/(1e3*60)+"m":m%1e3===0?m/1e3+"s":m.toFixed()+"ms"}},3704:(G,O,e)=>{"use strict";e.d(O,{c:()=>n,z:()=>i});var t=e(32264);function n(s,r){const a=new URLSearchParams(r).toString();return`${t.$.appSubUrl}${s}${a?`?${a}`:""}`}function i(s,r){const a=new URLSearchParams(r).toString();try{return`${new URL(t.$.appSubUrl+s,t.$.appUrl).href}${a?`?${a}`:""}`}catch{return n(s,r)}}},10154:(G,O,e)=>{"use strict";e.d(O,{Xm:()=>s,rJ:()=>i,vJ:()=>n,vy:()=>r});var t=e(17172);function n(f){return(0,t.AI)().post("/api/annotations",f)}function i(f){return(0,t.AI)().put(`/api/annotations/${f.id}`,f)}function s(f){return(0,t.AI)().delete(`/api/annotations/${f.id}`)}async function r(){return(await(0,t.AI)().get("/api/annotations/tags")).result.tags.map(({tag:a,count:c})=>({term:a,count:c}))}},82241:(G,O,e)=>{"use strict";e.d(O,{A:()=>C});var t=e(74848),n=e(96540),i=e(75505),s=e(39070),r=e(76287),f=e(13544),a=e(68402),c=e(62930),o=e(55852),h=e(42418),g=e(14792),l=e(74856),p=e(34214),m=e(27302),y=e(42493),d=e(28240),v=e(8790),u=e(83195),D=e(56034),P=e(14578),x=e(90182);class E extends n.PureComponent{constructor(S){super(S),this.updateFields=()=>{const I=this.props.response?.panelData,T=I?.series?.[0]??I?.annotations?.[0];if(T&&T.fields){const b=T.fields.map(R=>{const A=(0,d.Ct)(R,T);let L="";for(let U=0;U<T.length;U++){if(U>0&&(L+=", "),U>2){L+="...";break}L+=R.values[U]}return L.length>50&&(L=L.substring(0,50)+"..."),{label:`${A} (${R.type})`,value:A,description:L}});this.setState({fieldNames:b})}},this.onFieldSourceChange=(I,T)=>{const b=this.props.mappings||{},R=b[I]||{};this.props.change({...b,[I]:{...R,source:T.value||v.V.Field}})},this.onFieldNameChange=(I,T)=>{const b=this.props.mappings||{};if(!T){const A={...this.props.mappings};delete A[I],this.props.change(A);return}const R=b[I]||{};this.props.change({...b,[I]:{...R,value:T.value,source:v.V.Field}})},this.state={fieldNames:[]}}componentDidMount(){this.updateFields()}componentDidUpdate(S){S.response!==this.props.response&&this.updateFields()}renderRow(S,I,T){const{fieldNames:b}=this.state;let R=[...b];const A=I.value;let L=b.find(W=>A===W.value);A&&!L&&R.push({label:A,value:A});let U=T?T[S.key]:"";if(U&&S.key.startsWith("time")){const W=(0,u.j_)("dateTimeAsIso");U=(0,u.cN)(W(U))}return U==null&&(U=""),(0,t.jsxs)("tr",{children:[(0,t.jsxs)("td",{children:[S.label||S.key," ",S.help&&(0,t.jsx)(D.m,{content:S.help,children:(0,t.jsx)(P.I,{name:"info-circle"})})]}),(0,t.jsx)("td",{children:(0,t.jsx)(x.l6,{value:L,options:R,placeholder:S.placeholder||S.key,onChange:W=>{this.onFieldNameChange(S.key,W)},noOptionsMessage:"Unknown field names",allowCustomValue:!0,isClearable:!0})}),(0,t.jsx)("td",{children:`${U}`})]},S.key)}render(){const S=this.props.response?.events?.[0],I=this.props.mappings||{};return(0,t.jsxs)("table",{className:"filter-table",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Annotation"}),(0,t.jsx)("th",{children:"From"}),(0,t.jsx)("th",{children:"First Value"})]})}),(0,t.jsx)("tbody",{children:y.kj.map(T=>this.renderRow(T,I[T.key]||{},S))})]})}}class C extends n.PureComponent{constructor(){super(...arguments),this.state={},this.onRunQuery=async()=>{const{datasource:S,annotation:I}=this.props;if((0,y.E7)(S))return;const T=(0,g.UA)().getCurrent();if(!T)return;this.setState({running:!0});const b=await(0,i.s)((0,m.b)({range:(0,l.jG)().timeRange(),panel:new p.a({}),dashboard:T},S,I));this.setState({running:!1,response:b})},this.onQueryChange=S=>{this.props.onChange({...this.props.annotation,target:S})},this.onMappingChange=S=>{this.props.onChange({...this.props.annotation,mappings:S})},this.onAnnotationChange=S=>{this.props.onChange(S)}}componentDidMount(){this.verifyDataSource()}componentDidUpdate(S){this.props.annotation!==S.annotation&&!(0,y.E7)(this.props.datasource)&&this.verifyDataSource()}verifyDataSource(){const{datasource:S,annotation:I}=this.props,b={...y.CU,...S.annotations}.prepareAnnotation(I);b!==I?this.props.onChange(b):this.onRunQuery()}getStatusSeverity(S){const{events:I,panelData:T}=S;return T?.errors||T?.error?"error":I?.length?"success":"warning"}renderStatusText(S,I){const{events:T,panelData:b}=S;if(I||S?.panelData?.state===s.Gu.Loading||!S)return(0,t.jsx)("p",{children:"loading..."});if(b?.errors)return(0,t.jsx)(t.Fragment,{children:b.errors.map((A,L)=>(0,t.jsx)("p",{children:A.message},L))});if(b?.error)return(0,t.jsx)("p",{children:b.error.message??"There was an error fetching data"});if(!T?.length)return(0,t.jsx)("p",{children:"No events found"});const R=b?.series?.[0]??b?.annotations?.[0];return(0,t.jsxs)("p",{children:[T.length," events (from ",R?.fields.length," fields)"]})}renderStatus(){const{response:S,running:I}=this.state;return S?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.$,{v:2}),(0,t.jsx)("div",{children:I?(0,t.jsx)(c.y,{}):(0,t.jsx)(o.$n,{"data-testid":f.Tp.components.Annotations.editor.testButton,variant:"secondary",size:"xs",onClick:this.onRunQuery,children:"Test annotation query"})}),(0,t.jsx)(a.$,{v:2,layout:"block"}),(0,t.jsx)(h.F,{"data-testid":f.Tp.components.Annotations.editor.resultContainer,severity:this.getStatusSeverity(S),title:"Query result",children:this.renderStatusText(S,I)})]}):null}render(){const{datasource:S,annotation:I,datasourceInstanceSettings:T}=this.props,{response:b}=this.state;let R=S.annotations?.QueryEditor||S.components?.QueryEditor;if(!R)return(0,t.jsx)("div",{children:"Annotations are not supported. This datasource needs to export a QueryEditor"});const A={...S.annotations?.getDefaultQuery?.(),...I.target??{refId:"Anno"}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.p,{instanceSettings:T,children:(0,t.jsx)(R,{query:A,datasource:S,onChange:this.onQueryChange,onRunQuery:this.onRunQuery,data:b?.panelData,range:(0,l.jG)().timeRange(),annotation:I,onAnnotationChange:this.onAnnotationChange},S?.name)}),(0,y.JX)(S)&&(0,t.jsxs)(t.Fragment,{children:[this.renderStatus(),(0,t.jsx)(E,{response:b,mappings:I.mappings,change:this.onMappingChange})]})]})}}},27302:(G,O,e)=>{"use strict";e.d(O,{b:()=>h});var t=e(62467),n=e(69862),i=e(81160),s=e(65879),r=e(41987),f=e(39374),a=e(42493);let c=100;function o(){return"AQ"+c++}function h(g,l,p){const m={...a.CU,...l.annotations},y={...m.getDefaultQuery?.(),...p},d=m.prepareAnnotation(y);if(!d)return(0,t.of)({});const v=m.prepareQuery(d);if(!v)return(0,t.of)({});const u=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,D=s.calculateInterval(g.range,u,l.interval),P={__interval:{text:D.interval,value:D.interval},__interval_ms:{text:D.intervalMs.toString(),value:D.intervalMs},__annotation:{text:d.name,value:d}},x={startTime:Date.now(),requestId:o(),range:g.range,maxDataPoints:u,scopedVars:P,...D,app:r.Jk.Dashboard,timezone:g.dashboard.timezone,targets:[{...v,refId:"Anno"}]};return(0,f.BN)(l,x).pipe((0,n.Z)(E=>{const C=E?.series.length?E.series:E.annotations;return C?.length?m.processEvents(d,C).pipe((0,i.T)(M=>({panelData:E,events:M}))):(0,t.of)({panelData:E,events:[]})}))}},42493:(G,O,e)=>{"use strict";e.d(O,{CU:()=>g,E7:()=>D,JX:()=>u,kj:()=>p});var t=e(2543),n=e.n(t),i=e(62467),s=e(69862),r=e(81160),f=e(57934),a=e(11261),c=e(28240),o=e(8790),h=e(2913);const g={prepareAnnotation:P=>{if((0,t.isString)(P?.query)){const{query:x,...E}=P;return{...E,target:{refId:"annotation_query",query:x},mappings:{}}}return P},prepareQuery:P=>P.target,processEvents:(P,x)=>d(x,P.mappings)};function l(){return P=>P.pipe((0,s.Z)(x=>{if(!x?.length)return(0,i.of)(void 0);if(x.length===1)return(0,i.of)(x[0]);const E={interpolate:C=>C};return(0,i.of)(x).pipe(f.c.mergeTransformer.operator({},E),(0,r.T)(C=>C[0]))}))}const p=[{key:"time",field:P=>P.fields.find(x=>x.type===a.PU.time),placeholder:"time, or the first time field"},{key:"timeEnd",label:"end time",help:"When this field is defined, the annotation will be treated as a range"},{key:"title"},{key:"text",field:P=>P.fields.find(x=>x.type===a.PU.string),placeholder:"text, or the first text field"},{key:"tags",split:",",help:"The results will be split on comma (,)"},{key:"id"}],m=[{key:"color"},{key:"isRegion"},{key:"source"}],y=[...h.config.publicDashboardAccessToken?m:[],...p,{key:"userId"},{key:"login"},{key:"email"},{key:"prevState"},{key:"newState"},{key:"data"},{key:"panelId"},{key:"alertId"},{key:"dashboardId"},{key:"dashboardUID"}];function d(P,x){return(0,i.of)(P).pipe(l(),(0,r.T)(E=>{if(!E?.length)return[];let C=!1,M=!1;const S={};for(const b of E.fields){const R=(0,c.Ct)(b,E);S[R.toLowerCase()]=b}x||(x={});const I=[];for(const b of y){const R=x[b.key]||{};if(R.source===o.V.Skip)continue;const A={key:b.key,split:b.split};if(R.source===o.V.Text)A.text=R.value;else{const L=(R.value||b.key).toLowerCase();A.field=S[L],!A.field&&b.field&&(A.field=b.field(E))}(A.field||A.text)&&(I.push(A),A.key==="time"?C=!0:A.key==="text"&&(M=!0))}if(!C||!M)return console.error("Cannot process annotation fields. No time or text present."),[];const T=[];for(let b=0;b<E.length;b++){const R={type:"default",color:"red"};for(const A of I){let L;if(A.text)L=A.text;else if(A.field&&(L=A.field.values[b],L!==void 0&&A.regex)){const U=A.regex.exec(L);U&&(L=U[1]?U[1]:U[0])}L!=null&&(A.split&&typeof L=="string"&&(L=L.split(",")),R[A.key]=L)}T.push(R)}return T}))}const v=["prometheus","loki","elasticsearch","grafana-opensearch-datasource"];function u(P){const{type:x}=P;return!(x==="datasource"||v.includes(x))}function D(P){const{type:x}=P;return v.includes(x)}},93584:(G,O,e)=>{"use strict";e.d(O,{Ay:()=>h,QB:()=>c,Ri:()=>a,Sf:()=>s,cV:()=>r,h8:()=>f});var t=e(65307);const n={hasFetched:!1,includeExpired:!1,keys:[],keysIncludingExpired:[],searchQuery:"",migrationResult:{total:0,migrated:0,failed:0,failedApikeyIDs:[0],failedDetails:[]}},i=(0,t.Z0)({name:"apiKeys",initialState:n,reducers:{apiKeysLoaded:(g,l)=>{const{keys:p,keysIncludingExpired:m}=l.payload,y=l.payload.keys.length===0&&l.payload.keysIncludingExpired.length>0?!0:g.includeExpired;return{...g,hasFetched:!0,keys:p,keysIncludingExpired:m,includeExpired:y}},setSearchQuery:(g,l)=>({...g,searchQuery:l.payload}),includeExpiredToggled:g=>({...g,includeExpired:!g.includeExpired}),isFetching:g=>({...g,hasFetched:!1}),setMigrationResult:(g,l)=>({...g,migrationResult:l.payload})}}),{apiKeysLoaded:s,includeExpiredToggled:r,isFetching:f,setSearchQuery:a,setMigrationResult:c}=i.actions,h={apiKeys:i.reducer}},2468:(G,O,e)=>{"use strict";e.d(O,{H:()=>a,w:()=>r});var t=e(32264),n=e(17172),i=e(10096),s=e(48814);class r{constructor(o,h=!0){const g=h?`namespaces/${t.$.namespace}/`:"";this.url=`/apis/${o.group}/${o.version}/${g}${o.resource}`}async get(o){return(0,n.AI)().get(`${this.url}/${o}`)}async subresource(o,h){return(0,n.AI)().get(`${this.url}/${o}/${h}`)}async list(o){const h=o||{};return h.labelSelector=this.parseListOptionsSelector(h?.labelSelector),h.fieldSelector=this.parseListOptionsSelector(h?.fieldSelector),(0,n.AI)().get(this.url,o)}async create(o){if(!o.metadata.name&&!o.metadata.generateName){const h=i.TP.user.login;o.metadata.generateName=h?h.slice(0,2):"g"}return f(o.metadata),(0,n.AI)().post(this.url,o)}async update(o){return f(o.metadata),(0,n.AI)().put(`${this.url}/${o.metadata.name}`,o)}async delete(o){return(0,n.AI)().delete(`${this.url}/${o}`)}parseListOptionsSelector(o){return Array.isArray(o)?o.map(h=>{const g=String(h.key),l=h.operator;switch(l){case"=":case"!=":return`${g}${l}${h.value}`;case"in":case"notin":return`${g} ${l} (${h.value.join(",")})`;case"":case"!":return`${l}${g}`;default:return null}}).filter(Boolean).join(","):o}}function f(c){c.annotations||(c.annotations={}),c.annotations[s.dc]="UI",c.annotations[s.zv]=window.location.pathname,c.annotations[s.M8]=t.$.buildInfo.versionString}class a{async get(o){if(this.apiVersions)return this.apiVersions[o];const h=await(0,n.AI)().get("/apis"),g={};return h.groups.forEach(l=>{if(l.name.includes("datasource.grafana.app")){const p=l.name.split(".")[0];g[p]=l.preferredVersion.version,p.endsWith("-datasource")||(p.includes("-")?g[`${p}-datasource`]=l.preferredVersion.version:g[`grafana-${p}-datasource`]=l.preferredVersion.version)}}),this.apiVersions=g,g[o]}}},48814:(G,O,e)=>{"use strict";e.d(O,{M8:()=>o,dc:()=>a,ew:()=>s,fY:()=>r,zv:()=>c});const t="grafana.app/createdBy",n="grafana.app/updatedTimestamp",i="grafana.app/updatedBy",s="grafana.app/folder",r="grafana.app/message",f="grafana.app/slug",a="grafana.app/originName",c="grafana.app/originPath",o="grafana.app/originHash",h="grafana.app/originTimestamp"},73399:(G,O,e)=>{"use strict";e.d(O,{getAuthProviderStatus:()=>h,getRegisteredAuthProviders:()=>a,initAuthConfig:()=>g});var t=e(10096),n=e(27677),i=e(31678);const s=[],r={};function f(p,m){s.find(y=>y.id===p.id)||(s.push(p),m&&(r[p.id]=m))}function a(){return s}function c(p){return s.find(m=>m.id===p)}function o(p){const m=[];for(const[y,d]of Object.entries(p)){const v=s.find(u=>`auth.${u.id}`===y);if(v){const u={...d,providerId:v.id,displayName:d.name||v.displayName};m.push(u)}}return m}async function h(p){if(r[p]){const m=r[p];return m()}return{configured:!1,enabled:!1}}function g(){f({id:"ldap",type:"LDAP",protocol:"LDAP",displayName:"LDAP",configPath:"ldap"},l)}async function l(){if(t.TP.hasPermission(i.AccessControlAction.SettingsRead)){const m=(await(0,n.AI)().get("/api/admin/settings"))["auth.ldap"]||{};return{configured:m.enabled==="true",enabled:m.enabled==="true",hide:m.enabled!=="true"}}return{configured:!1,enabled:!1}}},20604:(G,O,e)=>{"use strict";e.d(O,{Ay:()=>m,MH:()=>a,Nh:()=>c,Oy:()=>l,SH:()=>o,TO:()=>r,jA:()=>s,sr:()=>f});var t=e(65307);const n={settings:{},providerStatuses:{},isLoading:!1,providers:[]},i=(0,t.Z0)({name:"authConfig",initialState:n,reducers:{settingsUpdated:(y,d)=>({...y,settings:d.payload}),providerStatusesLoaded:(y,d)=>({...y,providerStatuses:d.payload}),loadingBegin:y=>({...y,isLoading:!0}),loadingEnd:y=>({...y,isLoading:!1}),setError:(y,d)=>({...y,updateError:d.payload}),resetError:y=>({...y,updateError:void 0}),setWarning:(y,d)=>({...y,warning:d.payload}),resetWarning:y=>({...y,warning:void 0}),providersLoaded:(y,d)=>({...y,providers:d.payload})}}),{settingsUpdated:s,providerStatusesLoaded:r,loadingBegin:f,loadingEnd:a,setError:c,resetError:o,setWarning:h,resetWarning:g,providersLoaded:l}=i.actions,m={authConfig:i.reducer}},55314:(G,O,e)=>{"use strict";e.d(O,{D$:()=>L,G2:()=>C,Ko:()=>x,Vc:()=>T,aF:()=>S,cU:()=>D,e8:()=>b,hT:()=>v.hT,iB:()=>R,kH:()=>M,uz:()=>E,vR:()=>A,vZ:()=>P,wt:()=>I});var t=e(75816),n=e(75505),i=e(71733),s=e(39070),r=e(26272),f=e(17172),a=e(12131),c=e(82467),o=e(28138),h=e(3169),g=e(10096),l=e(28676),p=e(6473),m=e(8484),y=e(37690),d=e(92955),v=e(10378);function u({baseURL:U}){async function W(w){try{const{data:N,...B}=await(0,n.s)((0,f.AI)().fetch({...w,url:U+w.url,showErrorAlert:w.showErrorAlert}));return{data:N,meta:B}}catch(N){return w.manageError?w.manageError(N):{error:N}}}return W}const D=(0,t.xP)({tagTypes:["getFolder"],reducerPath:"browseDashboardsAPI",baseQuery:u({baseURL:"/api"}),endpoints:U=>({listFolders:U.query({providesTags:W=>W?.map(w=>({type:"getFolder",id:w.uid}))??[],query:({parentUid:W,limit:w,page:N,permission:B})=>({url:"/folders",params:{parentUid:W,limit:w,page:N,permission:B}})}),getFolder:U.query({providesTags:(W,w,N)=>[{type:"getFolder",id:N}],query:W=>({url:`/folders/${W}`,params:{accesscontrol:!0}})}),newFolder:U.mutation({query:({title:W,parentUid:w})=>({method:"POST",url:"/folders",data:{title:W,parentUid:w}}),onQueryStarted:({parentUid:W},{queryFulfilled:w,dispatch:N})=>{w.then(async({data:B})=>{await g.TP.fetchUserPermissions(),N((0,c.dx)((0,h.tZ)("Folder created"))),N((0,y.bw)({parentUID:W,pageSize:d.md})),a.Ny.push(i.I.stripBaseFromUrl(B.url))})}}),saveFolder:U.mutation({invalidatesTags:["getFolder"],query:({uid:W,title:w,version:N})=>({method:"PUT",url:`/folders/${W}`,data:{title:w,version:N}}),onQueryStarted:({parentUid:W},{queryFulfilled:w,dispatch:N})=>{w.then(()=>{N((0,y.bw)({parentUID:W,pageSize:d.md}))})}}),moveFolder:U.mutation({invalidatesTags:["getFolder"],query:({folder:W,destinationUID:w})=>({url:`/folders/${W.uid}/move`,method:"POST",data:{parentUID:w}}),onQueryStarted:({folder:W,destinationUID:w},{queryFulfilled:N,dispatch:B})=>{const{parentUid:V}=W;N.then(()=>{B((0,y.bw)({parentUID:V,pageSize:d.md})),B((0,y.bw)({parentUID:w,pageSize:d.md}))})}}),deleteFolder:U.mutation({query:({uid:W})=>({url:`/folders/${W}`,method:"DELETE",params:{forceDeleteRules:!1}}),onQueryStarted:({parentUid:W},{queryFulfilled:w,dispatch:N})=>{w.then(()=>{N((0,y.bw)({parentUID:W,pageSize:d.md}))})}}),getAffectedItems:U.query({keepUnusedDataFor:0,queryFn:async W=>{const N=Object.keys(W.folder).filter(K=>W.folder[K]).map(K=>(0,f.AI)().get(`/api/folders/${K}/counts`)),B=await Promise.all(N),V={folder:Object.values(W.folder).filter(s.zz).length,dashboard:Object.values(W.dashboard).filter(s.zz).length,libraryPanel:0,alertRule:0};for(const K of B)V.folder+=K.folder??0,V.dashboard+=K.dashboard,V.alertRule+=K.alertrule,V.libraryPanel+=K.librarypanel;return{data:V}}}),moveItems:U.mutation({invalidatesTags:["getFolder"],queryFn:async({selectedItems:W,destinationUID:w},N,B,V)=>{const K=Object.keys(W.dashboard).filter(X=>W.dashboard[X]),H=Object.keys(W.folder).filter(X=>W.folder[X]);for(const X of H)await V({url:`/folders/${X}/move`,method:"POST",data:{parentUID:w}});for(const X of K){const Y={dashboard:(await(0,l.n)().getDashboardDTO(X)).dashboard,folderUid:w,overwrite:!1,message:""};await V({url:"/dashboards/db",method:"POST",data:Y})}return{data:void 0}},onQueryStarted:({destinationUID:W,selectedItems:w},{queryFulfilled:N,dispatch:B})=>{const V=Object.keys(w.dashboard).filter(H=>w.dashboard[H]),K=Object.keys(w.folder).filter(H=>w.folder[H]);N.then(()=>{B((0,y.bw)({parentUID:W,pageSize:d.md})),B((0,y.Zw)([...K,...V]))})}}),deleteItems:U.mutation({queryFn:async({selectedItems:W},w,N,B)=>{const V=Object.keys(W.dashboard).filter(H=>W.dashboard[H]),K=Object.keys(W.folder).filter(H=>W.folder[H]);for(const H of K)await B({url:`/folders/${H}`,method:"DELETE",params:{forceDeleteRules:!1}});for(const H of V){const k=(await B({url:`/dashboards/uid/${H}`,method:"DELETE",showSuccessAlert:!1}))?.data?.title;k&&o.A.publish({type:r.r1.alertSuccess.name,payload:[(0,m.t)("browse-dashboards.soft-delete.success","Dashboard {{name}} moved to Recently deleted",{name:k})]})}return{data:void 0}},onQueryStarted:({selectedItems:W},{queryFulfilled:w,dispatch:N})=>{const B=Object.keys(W.dashboard).filter(K=>W.dashboard[K]),V=Object.keys(W.folder).filter(K=>W.folder[K]);w.then(()=>{N((0,y.Zw)([...V,...B]))})}}),saveDashboard:U.mutation({queryFn:async W=>{try{return{data:await(0,l.n)().saveDashboard(W)}}catch(w){return{error:w}}},onQueryStarted:({folderUid:W},{queryFulfilled:w,dispatch:N})=>{p.t.ignoreNextSave(),w.then(async()=>{await g.TP.fetchUserPermissions(),N((0,y.bw)({parentUID:W,pageSize:d.md}))})}}),importDashboard:U.mutation({query:({dashboard:W,overwrite:w,inputs:N,folderUid:B})=>({method:"POST",url:"/dashboards/import",data:{dashboard:W,overwrite:w,inputs:N,folderUid:B}}),onQueryStarted:({folderUid:W},{queryFulfilled:w,dispatch:N})=>{w.then(async B=>{N((0,y.bw)({parentUID:W,pageSize:d.md}));const V=i.I.stripBaseFromUrl(B.data.importedUrl);a.Ny.push(V)})}}),restoreDashboard:U.mutation({query:({dashboardUID:W})=>({url:`/dashboards/uid/${W}/trash`,method:"PATCH"})}),hardDeleteDashboard:U.mutation({queryFn:async({dashboardUID:W},w,N,B)=>{const K=(await B({url:`/dashboards/uid/${W}/trash`,method:"DELETE",showSuccessAlert:!1}))?.data?.title;return K&&o.A.publish({type:r.r1.alertSuccess.name,payload:[(0,m.t)("browse-dashboards.hard-delete.success","Dashboard {{name}} deleted",{name:K})]}),{data:void 0}},onQueryStarted:({dashboardUID:W},{queryFulfilled:w,dispatch:N})=>{w.then(()=>{N((0,y.Zw)([W]))})}})})}),{endpoints:P,useDeleteFolderMutation:x,useDeleteItemsMutation:E,useGetAffectedItemsQuery:C,useGetFolderQuery:M,useMoveFolderMutation:S,useMoveItemsMutation:I,useNewFolderMutation:T,useSaveDashboardMutation:b,useSaveFolderMutation:R,useRestoreDashboardMutation:A,useHardDeleteDashboardMutation:L}=D},92955:(G,O,e)=>{"use strict";e.d(O,{aw:()=>g,md:()=>o,uT:()=>h});var t=e(32264),n=e(17172),i=e(53477),s=e(24439),r=e(40957),f=e(10096),a=e(31678),c=e(49952);const o=50;async function h(l,p,m=1,y=o){if(l&&!t.$.featureToggles.nestedFolders)return[];const d=(0,n.AI)();let v=[];f.TP.hasPermission(a.AccessControlAction.FoldersRead)&&(v=await d.get("/api/folders",{parentUid:l,page:m,limit:y}));const u=t.$.appSubUrl??"";return v.map(D=>({kind:"folder",uid:D.uid,title:D.title,parentTitle:p,parentUID:l,url:(0,c.I)(D.uid)?void 0:`${u}/dashboards/f/${D.uid}/`}))}async function g(l,p=1,m=o){const d=await(0,s.getGrafanaSearcher)().search({kind:["dashboard"],query:"*",location:l||"general",from:(p-1)*m,limit:m});return d.view.map(v=>{const u=(0,r.hI)(v,d.view);return u.parentUID===i.TF&&(u.parentUID=void 0),u})}},43907:(G,O,e)=>{"use strict";e.d(O,{x:()=>c});var t=e(74848),n=e(70255),i=e(94753),s=e(42418),r=e(55314),f=e(8484);function a(o,h,g,l){const p=o+h+g+l,m=[];o&&m.push((0,f.t)("browse-dashboards.counts.folder","{{count}} folder",{count:o})),h&&m.push((0,f.t)("browse-dashboards.counts.dashboard","{{count}} dashboard",{count:h})),g&&m.push((0,f.t)("browse-dashboards.counts.libraryPanel","{{count}} library panel",{count:g})),l&&m.push((0,f.t)("browse-dashboards.counts.alertRule","{{count}} alert rule",{count:l}));let y=(0,f.t)("browse-dashboards.counts.total","{{count}} item",{count:p});return m.length>0&&(y+=`: ${m.join(", ")}`),y}const c=({selectedItems:o})=>{const{data:h,isFetching:g,isLoading:l,error:p}=(0,r.G2)(o);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.E,{element:"p",color:"secondary",children:[h&&a(h.folder,h.dashboard,h.libraryPanel,h.alertRule),(g||l)&&(0,t.jsx)(n.A,{width:200})]}),p&&(0,t.jsx)(s.F,{severity:"error",title:"Unable to retrieve descendant information"})]})}},49952:(G,O,e)=>{"use strict";e.d(O,{I:()=>i,e:()=>n});var t=e(32264);function n(s,r){return s+r.uid}function i(s){return s===t.$.sharedWithMeFolderUID}},36141:(G,O,e)=>{"use strict";e.d(O,{Ii:()=>a,Zw:()=>r,bw:()=>f});var t=e(53477),n=e(31678),i=e(92955),s=e(93519);const r=(0,n.createAsyncThunk)("browseDashboards/refreshParents",async(c,{getState:o,dispatch:h})=>{const{browseDashboards:g}=o(),{rootItems:l,childrenByParentUID:p}=g,m=new Set;for(const y of c){const d=(0,s.R)(l?.items??[],p,y);m.add(d?.parentUID)}for(const y of m)h(f({parentUID:y,pageSize:i.md}))}),f=(0,n.createAsyncThunk)("browseDashboards/refetchChildren",async({parentUID:c,pageSize:o})=>{const h=c===t.TF?void 0:c;let g=1,l="folder",p=await(0,i.uT)(h,void 0,g,o),m=p.length<o;if(l==="folder"&&m){l="dashboard",g=1;const y=await(0,i.aw)(h,g,o);m=y.length<o,p=p.concat(y)}return{children:p,lastPageOfKind:m,page:g,kind:l}}),a=(0,n.createAsyncThunk)("browseDashboards/fetchNextChildrenPage",async({parentUID:c,excludeKinds:o=[],pageSize:h},g)=>{const l=!o.includes("dashboard"),p=c===t.TF?void 0:c,m=g.getState().browseDashboards,y=p?m.childrenByParentUID[p]:m.rootItems;let d=1,v;if(y?y.lastFetchedKind==="dashboard"&&!y.lastKindHasMoreItems?console.warn(`fetchNextChildrenPage called for ${p} but that collection is fully loaded`):y.lastFetchedKind==="folder"&&y.lastKindHasMoreItems?(d=y.lastFetchedPage+1,v="folder"):l&&(d=y.lastFetchedKind==="folder"?1:y.lastFetchedPage+1,v="dashboard"):(d=1,v="folder"),!v)return;let u=v==="folder"?await(0,i.uT)(p,void 0,d,h):await(0,i.aw)(p,d,h),D=u.length<h;if(v==="folder"&&D&&l){v="dashboard",d=1;const P=await(0,i.aw)(p,d,h);D=P.length<h,u=u.concat(P)}return{children:u,lastPageOfKind:D,page:d,kind:v}})},37690:(G,O,e)=>{"use strict";e.d(O,{Am:()=>h,xN:()=>t.xN,Ii:()=>n.Ii,bw:()=>n.bw,Zw:()=>n.Zw,ku:()=>o,cT:()=>t.cT,wn:()=>t.wn,t$:()=>t.t$,xK:()=>x,eC:()=>d,Ms:()=>D,V6:()=>P,q0:()=>v,QE:()=>u,Zg:()=>E});var t=e(79763),n=e(36141),i=e(96540),s=e(25508),r=e(31678),f=e(92955),a=e(49952),c=e(93519);const o=M=>M.browseDashboards.rootItems,h=M=>M.browseDashboards.childrenByParentUID,g=M=>M.browseDashboards.openFolders,l=M=>M.browseDashboards.selectedItems,p=(0,s.Mz)(o,h,g,(M,S)=>S,(M,S,I,T)=>C(T,M,S,I)),m=(0,s.Mz)(l,M=>Object.values(M).some(S=>Object.values(S).some(I=>I))),y=(0,s.Mz)(l,h,(M,S)=>{const I={dashboard:{...M.dashboard},folder:{...M.folder}};for(const T of Object.keys(M.folder))if(M.folder[T]){const R=S[T];if(R)for(const A of R.items)A.kind==="dashboard"&&(I.dashboard[A.uid]=!1),A.kind==="folder"&&(I.folder[A.uid]=!1)}return I});function d(M){return(0,r.useSelector)(S=>(M?S.browseDashboards.childrenByParentUID[M]:S.browseDashboards.rootItems)?"fulfilled":"pending")}function v(M){return(0,r.useSelector)(S=>p(S,M))}function u(){return(0,r.useSelector)(M=>m(M))}function D(){return(0,r.useSelector)(l)}function P(){return(0,r.useSelector)(M=>M.browseDashboards.childrenByParentUID)}function x(){return(0,r.useSelector)(M=>y(M))}function E(M=[]){const S=(0,r.useDispatch)(),I=(0,i.useRef)(!1);return(0,i.useCallback)(b=>{if(I.current)return Promise.resolve();I.current=!0;const R=S((0,n.Ii)({parentUID:b,excludeKinds:M,pageSize:f.md}));return R.finally(()=>I.current=!1),R},[S,M])}function C(M,S,I,T,b=0,R=[],A=[]){function L(K,H,X){if(R.includes(K.kind)||A.includes(K.uid))return[];const k=C(K.uid,S,I,T,X+1,R,A),Y=!!T[K.uid],Z=I[K.uid]?.items.length===0;Y&&Z&&!R.includes("empty-folder")&&k.push({isOpen:!1,level:X+1,item:{kind:"ui",uiKind:"empty-folder",uid:K.uid+"empty-folder"},parentUID:H});const se={item:K,parentUID:H,level:X,isOpen:Y},j=[se,...k];return(0,a.I)(se.item.uid)&&j.push({item:{kind:"ui",uiKind:"divider",uid:"shared-with-me-divider"},parentUID:H,level:X+1,isOpen:!1}),j}const U=M&&T[M]||b===0,W=M?I[M]:S;let N=((M?U&&W?.items:W?.items)||[]).flatMap(K=>L(K,M,b));const B=R.includes("dashboard")&&W?.lastFetchedKind==="dashboard";return(b===0&&!W||U&&W&&!(W.isFullyLoaded||B))&&(N=N.concat((0,c.T)(f.md,M,b))),N}},79763:(G,O,e)=>{"use strict";e.d(O,{xN:()=>x,Ay:()=>E,cT:()=>P,wn:()=>u,t$:()=>D});var t={};e.r(t),e.d(t,{clearFolders:()=>g,fetchNextChildrenPageFulfilled:()=>a,refetchChildrenFulfilled:()=>f,setAllSelection:()=>h,setFolderOpenState:()=>c,setItemSelectionState:()=>o});var n=e(65307),i=e(36141),s=e(49952),r=e(93519);function f(C,M){const{children:S,page:I,kind:T,lastPageOfKind:b}=M.payload,{parentUID:R}=M.meta.arg,A={items:S,lastFetchedKind:T,lastFetchedPage:I,lastKindHasMoreItems:!b,isFullyLoaded:T==="dashboard"&&b};R?C.childrenByParentUID[R]=A:C.rootItems=A}function a(C,M){const S=M.payload;if(!S)return;const{children:I,page:T,kind:b,lastPageOfKind:R}=S,{parentUID:A,excludeKinds:L=[]}=M.meta.arg,w={items:((A?C.childrenByParentUID[A]:C.rootItems)?.items??[]).concat(I),lastFetchedKind:b,lastFetchedPage:T,lastKindHasMoreItems:!R,isFullyLoaded:(L.includes("dashboard")||b==="dashboard")&&R};if(!A){C.rootItems=w;return}if(C.childrenByParentUID[A]=w,C.selectedItems.folder[A])for(const B of I)C.selectedItems[B.kind][B.uid]=!0}function c(C,M){const{folderUID:S,isOpen:I}=M.payload;C.openFolders[S]=I}function o(C,M){const{item:S,isSelected:I}=M.payload;if((0,s.I)(S.uid))return;function T(b,R){if(C.selectedItems[b][R]=I,b!=="folder")return;let A=C.childrenByParentUID[R];for(const L of A?.items??[])T(L.kind,L.uid)}if(T(S.kind,S.uid),!I){let b=S.parentUID;for(;b;){const R=(0,r.R)(C.rootItems?.items??[],C.childrenByParentUID,b);if(!R)break;C.selectedItems[R.kind][R.uid]=!1,b=R.parentUID}}C.selectedItems.$all=C.rootItems?.items?.every(b=>C.selectedItems[b.kind][b.uid])??!1}function h(C,M){const{isSelected:S,folderUID:I}=M.payload;if(!(I&&(0,s.I)(I)))if(C.selectedItems.$all=S,S){let b=function(R){if(R&&(0,s.I)(R))return;const A=R?C.childrenByParentUID[R]:C.rootItems;if(A)for(const L of A.items)(0,s.I)(L.uid)||(C.selectedItems[L.kind][L.uid]=S,L.kind==="folder"&&b(L.uid))};var T=b;b(I)}else for(const b in C.selectedItems){if(!(b==="dashboard"||b==="panel"||b==="folder"))continue;const R=C.selectedItems[b];for(const A in R)R[A]=S}}function g(C,M){const S=Array.isArray(M.payload)?M.payload:[M.payload];for(const I of S)I?(C.childrenByParentUID[I]=void 0,C.openFolders[I]=!1):C.rootItems=void 0}const{fetchNextChildrenPageFulfilled:l,refetchChildrenFulfilled:p,...m}=t,y={rootItems:void 0,childrenByParentUID:{},openFolders:{},selectedItems:{dashboard:{},folder:{},panel:{},$all:!1}},d=(0,n.Z0)({name:"browseDashboards",initialState:y,reducers:m,extraReducers:C=>{C.addCase(i.Ii.fulfilled,l),C.addCase(i.bw.fulfilled,p)}}),v=d.reducer,{setFolderOpenState:u,setItemSelectionState:D,setAllSelection:P,clearFolders:x}=d.actions,E={browseDashboards:v}},93519:(G,O,e)=>{"use strict";e.d(O,{R:()=>t,T:()=>n});function t(i,s,r){for(const f of i)if(f.uid===r)return f;for(const f in s){const a=s[f];if(a){for(const c of a.items)if(c.uid===r)return c}}}function n(i,s,r){return new Array(i).fill(null).map((f,a)=>({parentUID:s,level:r,isOpen:!1,item:{kind:"ui",uiKind:"pagination-placeholder",uid:`${s}-pagination-${a}`}}))}},6320:(G,O,e)=>{"use strict";e.d(O,{b:()=>n,q:()=>t});const t="connections",n={Base:`/${t}`,DataSources:`/${t}/datasources`,DataSourcesNew:`/${t}/datasources/new`,DataSourcesEdit:`/${t}/datasources/edit/:uid`,DataSourcesDashboards:`/${t}/datasources/edit/:uid/dashboards`,AddNewConnection:`/${t}/add-new-connection`,DataSourcesDetails:`/${t}/datasources/:id`,ConnectDataOutdated:`/${t}/connect-data`,YourConnectionsOutdated:`/${t}/your-connections`}},67023:(G,O,e)=>{"use strict";e.d(O,{k:()=>r});var t=e(60455),n=e.n(t),i=e(91890),s=e(87490);const r=(f,a,c)=>{let o={},h={};if(f.type===i.CC.Regex&&f.expression){const g=new RegExp(f.expression,"gi"),p=(typeof a=="string"?a:(0,s.MA)(a)).matchAll(g);for(const m of p)m.groups?h=m.groups:h[f.mapValue||c]=m[1]||m[0]}else f.type===i.CC.Logfmt&&(h=n().parse(a));return Object.keys(h).forEach(g=>{const l=typeof h[g]=="string"?h[g]:(0,s.MA)(h[g]);o[g]={value:l}}),o}},40511:(G,O,e)=>{"use strict";e.d(O,{F0:()=>c,bQ:()=>o,lW:()=>h});var t=e(41053),n=e(75505),i=e(19347),s=e(76888),r=e(18380);const f=({sourceUID:g,targetUID:l,...p})=>{const m=(0,i.l)().getInstanceSettings(g),y=(0,i.l)().getInstanceSettings(l);if((p?.orgId===void 0||p?.orgId===null||p?.orgId===0)&&r.kb.logWarning("Invalid correlation config: Missing org id."),m&&m?.uid!==void 0&&y&&y.uid!==void 0)return{...p,source:m,target:y};r.kb.logWarning("Invalid correlation config: Missing source or target.",{source:JSON.stringify(m),target:JSON.stringify(y)})},a=g=>!!g,c=g=>({...g,correlations:g.correlations.map(f).filter(a)});function o(g){return g.data}const h=()=>{const{backend:g}=(0,s.Il)(),[l,p]=(0,t.A)(P=>(0,n.s)(g.fetch({url:"/api/datasources/correlations",params:{page:P.page},method:"GET",showErrorAlert:!1})).then(o).then(c),[g]),[m,y]=(0,t.A)(({sourceUID:P,...x})=>g.post(`/api/datasources/uid/${P}/correlations`,x).then(E=>{const C=f(E.result);if(C!==void 0)return C;throw new Error("invalid sourceUID")}),[g]),[d,v]=(0,t.A)(({sourceUID:P,uid:x})=>g.delete(`/api/datasources/uid/${P}/correlations/${x}`),[g]),[u,D]=(0,t.A)(({sourceUID:P,uid:x,...E})=>g.patch(`/api/datasources/uid/${P}/correlations/${x}`,E).then(C=>{const M=f(C.result);if(M!==void 0)return M;throw new Error("invalid sourceUID")}),[g]);return{create:{execute:y,...m},update:{execute:D,...u},get:{execute:p,...l},remove:{execute:v,...d}}}},18380:(G,O,e)=>{"use strict";e.d(O,{$q:()=>g,J6:()=>h,cA:()=>c,kb:()=>m,tZ:()=>p});var t=e(75505),n=e(91890),i=e(17172),s=e(19347),r=e(34867),f=e(9651),a=e(40511);const c=(y,d,v)=>(y.forEach(u=>{const D=u.refId;if(!D)return;let P=v[D];if(P===void 0&&u.meta?.preferredVisualisationType==="rawPrometheus"){const E=(0,f.a)(D);P=v[E]}const x=d.filter(E=>E.source.uid===P);o(u,x)}),y),o=(y,d)=>{y.fields.forEach(v=>{v.config.links=v.config.links?.filter(u=>u.origin!==n.x0.Correlations)||[],d.map(u=>{if(u.config?.field===v.name){const D=u.config?.target||{};v.config.links.push({internal:{query:{...D,datasource:{uid:u.target.uid}},datasourceUid:u.target.uid,datasourceName:u.target.name,transformations:u.config?.transformations},url:"",title:u.label||u.target.name,origin:n.x0.Correlations})}})})},h=async y=>(0,t.s)((0,i.AI)().fetch({url:"/api/datasources/correlations",method:"GET",showErrorAlert:!1,params:{sourceUID:y}})).then(a.bQ).then(a.F0),g=async(y,d)=>(0,i.AI)().post(`/api/datasources/uid/${y}/correlations`,d),l=async y=>y.datasourceInstance?.meta.mixed?await(0,s.l)().get(y.queries[0].datasource):y.datasourceInstance,p=async(y,d)=>Promise.all([l(y),l(d)]).then(v=>v[0]?.name!==void 0&&v[1]?.name!==void 0?`${v[0]?.name} to ${v[1]?.name}`:""),m=(0,r.DW)("features.correlations")},41524:(G,O,e)=>{"use strict";e.d(O,{W:()=>i});var t=e(11261);function n(){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZ",r="abcdefghijklmnopqrstuvwxyz",f=s.length,a=new Map;return c=>{const o=a.get(c);if(o!=null)return o;const h=[...c].map(g=>g.toLowerCase()&&g!==g.toUpperCase()?r.charAt(Math.floor(Math.random()*f)):g.toUpperCase()&&g!==g.toUpperCase()?s.charAt(Math.floor(Math.random()*f)):g).join("");return a.set(c,h),h}}function i(s,r){if(!(r.labels||r.names||r.values))return s;const f=new Set(["time","value","exemplar","traceid","id","uid","uuid","__name__","le","name"]),a=n();return s.map(c=>{let{schema:o,data:h}=c;if(o&&h){if(r.labels){for(const g of o.fields)if(g.labels){const l={};for(const[p,m]of Object.entries(g.labels))l[p]=a(m);g.labels=l}}if(r.names)for(const g of o.fields)g.name?.length&&!f.has(g.name.toLowerCase())&&(g.name=a(g.name));r.values&&o.fields.forEach((g,l)=>{if(g.type===t.PU.string&&h){const p=h.values[l].map(m=>a(String(m)));h.values[l]=p}})}return{schema:o,data:h}})}},72255:(G,O,e)=>{"use strict";e.d(O,{m6:()=>M,sP:()=>T});var t=e(71733),n=e(17172),i=e(12131),s=e(32264),r=e(79422),f=e(2619),a=e(33390),c=e(94954),o=e(78160),h=e(17493),g=e(14792),l=e(34214),p=e(41176),m=e(20470),y=e(16833),d=e(31678),v=e(61642),u=e(71176),D=e(85445),P=e(27734),x=e(77431);const E=500,C="loadDashboardScene",M="__grafana_home_uid__";class S extends f.Q{constructor(){super(...arguments),this.cache={}}async fetchDashboard({uid:A,route:L,urlFolderUid:U,keepDashboardFromExploreInLocalStorage:W}){const w=a.A.getObject(m.us);if(w)return W||(0,m.yZ)(),w;const N=L===d.DashboardRoutes.Home?M:A,B=this.getDashboardFromCache(N);if(B)return B;let V;try{switch(L){case d.DashboardRoutes.New:V=await(0,u.X)(U);break;case d.DashboardRoutes.Home:if(V=await(0,n.AI)().get("/api/dashboards/home"),V.redirectUri)return V;V?.meta&&(V.meta.canSave=!1,V.meta.canShare=!1,V.meta.canStar=!1);break;case d.DashboardRoutes.Public:return await h.np.loadDashboard("public","",A);default:V=await h.np.loadDashboard("db","",A),L===d.DashboardRoutes.Embedded&&(V.meta.isEmbedded=!0)}if(V.meta.url&&L===d.DashboardRoutes.Normal){const K=t.I.stripBaseFromUrl(V.meta.url),H=i.Ny.getLocation().pathname;K!==H&&(i.Ny.replace({...i.Ny.getLocation(),pathname:K}),console.log("not correct url correcting",K,H))}V.meta.folderUid&&await(0,x.Q)(V.meta.folderUid),this.setDashboardCache(N,V)}catch(K){if((0,n.NF)(K)&&K.cancelled)return null;throw K}return V}async loadSnapshot(A){try{const L=await this.loadSnapshotScene(A);this.setState({dashboard:L,isLoading:!1})}catch(L){this.setState({isLoading:!1,loadError:String(L)})}}async loadSnapshotScene(A){const L=await h.np.loadDashboard("snapshot",A,"");if(L?.dashboard)return(0,D.wM)(L);throw new Error("Snapshot not found")}async loadDashboard(A){try{(0,o.j)(C);const L=await this.loadScene(A);if(!L)return;s.$.featureToggles.preserveDashboardStateWhenNavigating&&A.uid&&(0,P.Gq)(L),this.setState({dashboard:L,isLoading:!1});const U=(0,o.z)(C);(0,y.D)(L,U?.duration),A.route!==d.DashboardRoutes.New&&(0,p.B)({meta:L.state.meta,uid:L.state.uid,title:L.state.title,id:L.state.id})}catch(L){const U=(0,c.q)(L);this.setState({isLoading:!1,loadError:U,dashboard:b(U)})}}async loadScene(A){const L=!!(a.A.getObject(m.us)&&A.keepDashboardFromExploreInLocalStorage===!1);this.setState({isLoading:!0});const U=await this.fetchDashboard(A),W=this.getSceneFromCache(A.uid);if(!L&&W&&W.state.version===U?.dashboard.version)return W;if(U?.dashboard){const w=(0,D.wM)(U);return A.uid&&!L&&this.setSceneCache(A.uid,w),w}if(U?.redirectUri){const w=t.I.stripBaseFromUrl(U.redirectUri);return i.Ny.replace(w),null}throw new Error("Dashboard not found")}getDashboardFromCache(A){const L=this.dashboardCache;return A=this.getCacheKey(A),L&&L.cacheKey===A&&Date.now()-L?.ts<E?L.dashboard:null}clearState(){(0,g.UA)().setCurrent(void 0),this.setState({dashboard:void 0,loadError:void 0,isLoading:!1,panelEditor:void 0})}setDashboardCache(A,L){A=this.getCacheKey(A),this.dashboardCache={dashboard:L,ts:Date.now(),cacheKey:A}}clearDashboardCache(){this.dashboardCache=void 0}getSceneFromCache(A){return A=this.getCacheKey(A),this.cache[A]}setSceneCache(A,L){A=this.getCacheKey(A),this.cache[A]=L}getCacheKey(A){const L=(0,v.X)();return L?.has("scopes")?(L.sort(),`${A}__scp__${L.toString()}`):A}}let I=null;function T(){return I||(I=new S({})),I}function b(R){const A={dashboard:{...r.Ye,uid:"error-dash",title:R,annotations:{list:[{builtIn:1,datasource:{type:"grafana",uid:"-- Grafana --"},enable:!1,hide:!0,iconColor:"rgba(0, 211, 255, 1)",name:"Annotations & Alerts",type:"dashboard"}]},panels:[{fieldConfig:{defaults:{},overrides:[]},gridPos:{h:6,w:12,x:7,y:0},id:1,options:{code:{language:"plaintext",showLineNumbers:!1,showMiniMap:!1},content:`<br/><br/><center><h1>${R}</h1></center>`,mode:"html"},title:"",transparent:!0,type:"text"}]},meta:{canSave:!1,canEdit:!1}};return(0,D.EH)(new l.G(A.dashboard,A.meta),A.dashboard)}},77431:(G,O,e)=>{"use strict";e.d(O,{Q:()=>r});var t=e(82467),n=e(27677),i=e(71101),s=e(99140);async function r(f){try{const a=await n.IB.getFolderByUid(f);s.M_.dispatch((0,t.Vz)((0,i.R4)(a)))}catch(a){console.warn("Error fetching parent folder",f,"for dashboard",a)}}},79280:(G,O,e)=>{"use strict";e.d(O,{p:()=>c});var t=e(74848),n=e(13544),i=e(90613),s=e(67061),r=e(94753),f=e(55852),a=e(8484);function c(o){return(0,t.jsx)(i.a,{alignItems:"center",padding:4,children:(0,t.jsxs)(s.B,{direction:"column",alignItems:"center",gap:2,children:[(0,t.jsx)(r.E,{element:"h3",textAlignment:"center",children:(0,t.jsx)(a.x6,{children:"Start transforming data"},"transformations.empty.add-transformation-header")}),(0,t.jsx)(r.E,{element:"p",textAlignment:"center","data-testid":n.Tp.components.Transforms.noTransformationsMessage,children:(0,t.jsxs)(a.x6,{children:["Transformations allow data to be changed in various ways before your visualization is shown.",(0,t.jsx)("br",{}),"This includes joining data together, renaming fields, making calculations, formatting data for display, and more."]},"transformations.empty.add-transformation-body")}),(0,t.jsx)(f.$n,{icon:"plus",variant:"primary",size:"md",onClick:o.onShowPicker,"data-testid":n.Tp.components.Transforms.addTransformationButton,children:"Add transformation"})]})})}},19293:(G,O,e)=>{"use strict";e.d(O,{i:()=>wn,L:()=>On});var t=e(12131),n=e(32264),i=e(80943),s=e(41507),r=e(60656),f=e(74730),a=e(74848),c=e(32196),o=e(13544),h=e(40845),g=e(63021),l=e(40276),p=e(40980),m=e(66864),y=e(2913),d=e(10096),v=e(75471),u=e(57220),D=e(42418),P=e(39558),x=e(40675),E=e(80215),C=e(27747),M=e(56361),S=e(24180),I=e(16817),T=e(76885),b=e(34867),R=e(55852),A=e(25027),L=e(63066);const U=({panel:Rt,className:Ot})=>{const jt=(0,S.zy)(),{loading:rt,value:tn}=(0,I.A)(()=>(0,L.J6)(Rt),[Rt]);if(rt)return(0,a.jsx)(R.$n,{disabled:!0,children:"New alert rule"});if(!tn)return(0,a.jsx)(D.F,{severity:"info",title:"No alerting capable query found",children:"Cannot create alerts from this panel because no query to an alerting capable datasource is found."});const Mn=async()=>{(0,b.fH)(A.le.alertRuleFromPanel);const kn=await(0,L.J6)(Rt),Yn=T.kM.renderUrl("/alerting/new",{defaults:JSON.stringify(kn),returnTo:jt.pathname+jt.search});t.Ny.push(Yn)};return(0,a.jsx)(R.$n,{icon:"bell",onClick:Mn,className:Ot,"data-testid":"create-alert-rule-button",children:"New alert rule"})};var W=(Rt=>(Rt.Queries="queries",Rt.Transformations="transformations",Rt.Alert="alert",Rt))(W||{});class w extends i.Bs{constructor(Ot){super({}),this.tabId=W.Alert,this.TabComponent=jt=>V({...jt,model:this}),this._panelManager=Ot}static{this.Component=N}getTabLabel(){return"Alert"}getDashboardUID(){return this.getDashboard().state.uid}getDashboard(){return(0,f.YQ)(this._panelManager)}getLegacyPanelId(){return(0,f.Cs)(this._panelManager.state.panel)}getCanCreateRules(){const Ot=(0,v.Wd)("grafana");return this.getDashboard().state.meta.canSave&&d.TP.hasPermission(Ot.create)}get panelManager(){return this._panelManager}get panel(){return this._panelManager.state.panel}}function N(Rt){const{model:Ot}=Rt,jt=(0,h.of)(B),{errors:rt,loading:tn,rules:Mn}=(0,C.S)({dashboardUID:Ot.getDashboardUID(),panelId:Ot.getLegacyPanelId()}),kn=rt.length?(0,a.jsx)(D.F,{title:"Errors loading rules",severity:"error",children:rt.map((Jn,Ls)=>(0,a.jsxs)("div",{children:["Failed to load Grafana rules state: ",(0,M.JZ)(Jn)]},Ls))}):null;if(tn&&!Mn.length)return(0,a.jsxs)(a.Fragment,{children:[kn,(0,a.jsx)(P._,{text:"Loading rules..."})]});const{panel:Yn}=Ot,Wn=Ot.getCanCreateRules();return Mn.length?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(E.s,{rules:Mn}),Wn&&(0,a.jsx)(U,{className:jt.newButton,panel:Yn})]}):(0,a.jsxs)("div",{className:jt.noRulesWrapper,children:[(0,a.jsx)("p",{children:"There are no alert rules linked to this panel."}),Wn&&(0,a.jsx)(U,{panel:Yn})]})}const B=Rt=>({newButton:(0,c.css)({marginTop:Rt.spacing(3)}),noRulesWrapper:(0,c.css)({margin:Rt.spacing(2),backgroundColor:Rt.colors.background.secondary,padding:Rt.spacing(3)})});function V(Rt){const{model:Ot}=Rt,{rules:jt}=(0,C.S)({dashboardUID:Ot.getDashboardUID(),panelId:Ot.getLegacyPanelId(),poll:!1});return(0,a.jsx)(x.o,{label:Ot.getTabLabel(),icon:"bell",counter:jt.length,active:Rt.active,onChangeTab:Rt.onChangeTab},Rt.key)}var K=e(22391),H=e(41987),X=e(19347),k=e(67061),Y=e(21969),Z=e(53478),se=e(64152),j=e(44932),q=e(37464),ne=e(14348),oe=e(7928);class z extends i.Bs{constructor(Ot){super({}),this.tabId=W.Queries,this.icon="database",this.onOpenInspector=()=>{this._panelManager.inspectPanel()},this.onChangeDataSource=async(jt,rt)=>{this._panelManager.changePanelDataSource(jt,rt)},this.onQueryOptionsChange=jt=>{this._panelManager.changeQueryOptions(jt)},this.onQueriesChange=jt=>{this._panelManager.changeQueries(jt)},this.onRunQueries=()=>{this._panelManager.queryRunner.runQueries()},this.addQueryClick=()=>{const jt=this.getQueries();this.onQueriesChange((0,Y.U7)(jt,this.newQuery()))},this.onAddQuery=jt=>{const rt=this.getQueries(),tn=this._panelManager.state.dsSettings;this.onQueriesChange((0,Y.U7)(rt,jt,tn?(0,K.p$)(tn):{type:void 0,uid:void 0}))},this.onAddExpressionClick=()=>{const jt=this.getQueries();this.onQueriesChange((0,Y.U7)(jt,Z.Ex.newQuery()))},this.TabComponent=jt=>le({...jt,model:this}),this._panelManager=Ot}static{this.Component=te}getTabLabel(){return"Queries"}getItemsCount(){return this.getQueries().length}buildQueryOptions(){const Ot=this._panelManager,jt=this._panelManager.state.panel,rt=this._panelManager.queryRunner,tn=i.jh.getTimeRange(jt);let Mn={from:void 0,shift:void 0,hide:void 0};tn instanceof oe.v&&(Mn={from:tn.state.timeFrom,shift:tn.state.timeShift,hide:tn.state.hideTimeOverride});let kn=rt.state.queries;return{cacheTimeout:Ot.state.dsSettings?.meta.queryOptions?.cacheTimeout?rt.state.cacheTimeout:void 0,queryCachingTTL:Ot.state.dsSettings?.cachingConfig?.enabled?rt.state.queryCachingTTL:void 0,dataSource:{default:Ot.state.dsSettings?.isDefault,...Ot.state.dsSettings?(0,K.p$)(Ot.state.dsSettings):{type:void 0,uid:void 0}},queries:kn,maxDataPoints:rt.state.maxDataPoints,minInterval:rt.state.minInterval,timeRange:Mn}}getQueries(){return this._panelManager.queryRunner.state.queries}newQuery(){const{dsSettings:Ot,datasource:jt}=this._panelManager.state;let rt;return Ot?.meta.mixed?jt?.meta.mixed?rt=(0,X.l)().getInstanceSettings(n.$.defaultDatasource):rt=jt:rt=Ot,{...jt?.getDefaultQuery?.(H.Jk.PanelEditor),datasource:{uid:rt?.uid,type:rt?.type}}}isExpressionsSupported(Ot){return(Ot.meta.alerting||Ot.meta.mixed)===!0}renderExtraActions(){return se.m.getAllExtraRenderAction().map((Ot,jt)=>Ot({onAddQuery:this.onAddQuery,onChangeDataSource:this.onChangeDataSource,key:jt})).filter(Boolean)}get queryRunner(){return this._panelManager.queryRunner}get panelManager(){return this._panelManager}}function te({model:Rt}){const{datasource:Ot,dsSettings:jt}=Rt.panelManager.useState(),{data:rt,queries:tn}=Rt.panelManager.queryRunner.useState();if(!Ot||!jt||!rt)return null;const Mn=!(0,ne.kN)(jt.name);return(0,a.jsxs)("div",{"data-testid":o.Tp.components.QueryTab.content,children:[(0,a.jsx)(q.K,{data:rt,dsSettings:jt,dataSource:Ot,options:Rt.buildQueryOptions(),onDataSourceChange:Rt.onChangeDataSource,onOptionsChange:Rt.onQueryOptionsChange,onOpenQueryInspector:Rt.onOpenInspector}),(0,a.jsx)(j.L,{data:rt,queries:tn,dsSettings:jt,onAddQuery:Rt.onAddQuery,onQueriesChange:Rt.onQueriesChange,onRunQueries:Rt.onRunQueries}),(0,a.jsxs)(k.B,{gap:2,children:[Mn&&(0,a.jsx)(R.$n,{icon:"plus",onClick:Rt.addQueryClick,variant:"secondary","data-testid":o.Tp.components.QueryTab.addQuery,children:"Add query"}),n.$.expressionsEnabled&&Rt.isExpressionsSupported(jt)&&(0,a.jsx)(R.$n,{icon:"plus",onClick:Rt.onAddExpressionClick,variant:"secondary","data-testid":o.Tp.components.QueryTab.addExpression,children:(0,a.jsx)("span",{children:"Expression\xA0"})}),Rt.renderExtraActions()]})]})}function le(Rt){const{model:Ot}=Rt,jt=Ot.queryRunner.useState();return(0,a.jsx)(x.o,{label:Ot.getTabLabel(),icon:"database",counter:jt.queries.length,active:Rt.active,onChangeTab:Rt.onChangeTab},Rt.key)}var ie=e(38127),ae=e(96540),re=e(19727),ce=e(96374),me=e(57650),ee=e(79280),de=e(97497),De=e(29158),fe=e(21427),Te=e(66879);function je(Rt){const{isOpen:Ot,series:jt,onClose:rt,onTransformationAdd:tn}=Rt,[Mn,kn]=(0,ae.useState)({search:"",showIllustrations:!0}),Yn=Xn=>kn({...Mn,search:Xn.currentTarget.value}),Wn=Xn=>kn({...Mn,showIllustrations:Xn}),Jn=Xn=>kn({...Mn,selectedFilter:Xn}),Ls=(0,ae.useMemo)(()=>de.h.list().sort((Xn,Ps)=>Xn.name>Ps.name?1:Ps.name>Xn.name?-1:0),[]),fs=Ls.filter(Xn=>Mn.selectedFilter&&Mn.selectedFilter!==Te.e&&!Xn.categories?.has(Mn.selectedFilter)?!1:Xn.name.toLocaleLowerCase().includes(Mn.search.toLocaleLowerCase())),ys=(0,a.jsxs)(a.Fragment,{children:[fs.length," / ",Ls.length," \xA0\xA0",(0,a.jsx)(De.K,{name:"times",onClick:()=>{kn({...Mn,search:""})},tooltip:"Clear search"})]});if(Ot)return(0,a.jsx)(fe.R,{data:jt,onTransformationAdd:tn,xforms:fs,search:Mn.search,noTransforms:!1,suffix:Mn.search!==""?ys:(0,a.jsx)(a.Fragment,{}),selectedFilter:Mn.selectedFilter,onSearchChange:Yn,onSearchKeyDown:()=>{},showIllustrations:Mn.showIllustrations,onShowIllustrationsChange:Wn,onSelectedFilterChange:Jn,onClose:rt})}class He extends i.Bs{constructor(Ot){super({}),this.tabId=W.Transformations,this.icon="process",this.TabComponent=jt=>Se({...jt,model:this}),this._panelManager=Ot}static{this.Component=Be}getTabLabel(){return"Transformations"}getQueryRunner(){return this._panelManager.queryRunner}getDataTransformer(){return this._panelManager.dataTransformer}onChangeTransformations(Ot){this._panelManager.changeTransformations(Ot)}get panelManager(){return this._panelManager}}function Be({model:Rt}){const Ot=(0,h.of)(Re),jt=Rt.getQueryRunner().useState(),{data:rt,transformations:tn}=Rt.getDataTransformer().useState(),Mn=tn,[kn,Yn]=(0,ae.useState)(!1),[Wn,Jn]=(0,ae.useState)(!1),Ls=()=>Yn(!0),fs=()=>Yn(!1);if(!rt||!jt.data)return;const ys=(0,a.jsx)(je,{onClose:fs,onTransformationAdd:Xn=>{Xn.value!==void 0&&(Rt.onChangeTransformations([...Mn,{id:Xn.value,options:{}}]),fs())},isOpen:kn,series:rt.series});return Mn.length<1?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ee.p,{onShowPicker:Ls}),ys]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Ne,{data:jt.data,transformations:Mn,model:Rt}),(0,a.jsxs)(re.e,{children:[(0,a.jsx)(R.$n,{icon:"plus",variant:"secondary",onClick:Ls,"data-testid":o.Tp.components.Transforms.addTransformationButton,children:"Add another transformation"}),(0,a.jsx)(R.$n,{"data-testid":o.Tp.components.Transforms.removeAllTransformationsButton,className:Ot.removeAll,icon:"times",variant:"secondary",onClick:()=>Jn(!0),children:"Delete all transformations"})]}),(0,a.jsx)(ce.u,{isOpen:Wn,title:"Delete all transformations?",body:"By deleting all transformations, you will go back to the main selection screen.",confirmText:"Delete all",onConfirm:()=>{Rt.onChangeTransformations([]),Jn(!1)},onDismiss:()=>Jn(!1)}),ys]})}function Ne({transformations:Rt,model:Ot,data:jt}){const rt=Rt.map((Mn,kn)=>({id:`${kn} - ${Mn.id}`,transformation:Mn})),tn=Mn=>{if(!Mn||!Mn.destination)return;const kn=Mn.source.index,Yn=Mn.destination.index;if(kn===Yn)return;const Wn=Array.from(rt),[Jn]=Wn.splice(kn,1);Wn.splice(Yn,0,Jn),Ot.onChangeTransformations(Wn.map(Ls=>Ls.transformation))};return(0,a.jsx)(ie.JY,{onDragEnd:tn,children:(0,a.jsx)(ie.gL,{droppableId:"transformations-list",direction:"vertical",children:Mn=>(0,a.jsxs)("div",{ref:Mn.innerRef,...Mn.droppableProps,children:[(0,a.jsx)(me.A,{onChange:(kn,Yn)=>{const Wn=Rt.slice();Wn[kn]=Yn,Ot.onChangeTransformations(Wn)},onRemove:kn=>{const Yn=Rt.slice();Yn.splice(kn,1),Ot.onChangeTransformations(Yn)},configs:rt,data:jt}),Mn.placeholder]})})})}const Re=Rt=>({removeAll:(0,c.css)({marginLeft:Rt.spacing(2)})});function Se(Rt){const{model:Ot}=Rt,jt=Ot.getDataTransformer().useState();return(0,a.jsx)(x.o,{label:Ot.getTabLabel(),icon:"process",counter:jt.transformations.length,active:Rt.active,onChangeTab:Rt.onChangeTab},Rt.key)}class We extends i.Bs{constructor(Ot){super({tab:W.Queries,tabs:[]}),this._urlSync=new i.So(this,{keys:["tab"]}),this.onChangeTab=jt=>{this.setState({tab:jt.tabId})},this.panelManager=Ot,this.addActivationHandler(()=>this.onActivate())}static{this.Component=Ke}getUrlState(){return{tab:this.state.tab}}updateFromUrl(Ot){Ot.tab&&typeof Ot.tab=="string"&&this.setState({tab:Ot.tab})}onActivate(){return this.buildTabs(),this._subs.add(this.panelManager.subscribeToState((Ot,jt)=>{Ot.pluginId!==jt.pluginId&&this.buildTabs()})),()=>{this.panelSubscription&&(this.panelSubscription.unsubscribe(),this.panelSubscription=void 0)}}buildTabs(){const Ot=this.panelManager,jt=Ot.state.panel,rt=Ot.state.pluginId,tn=this.panelManager.queryRunner,Mn=[];if(jt)if(y.config.panels[rt]?.skipDataQuery){this.setState({tabs:Mn});return}else tn&&Mn.push(new z(this.panelManager)),Mn.push(new He(this.panelManager)),Xe(Ot.state.pluginId)&&Mn.push(new w(this.panelManager));this.setState({tabs:Mn})}}function Ke({model:Rt}){const{tab:Ot,tabs:jt}=Rt.useState(),rt=(0,h.of)(Je);if(!jt||!jt.length)return;const tn=jt.find(Mn=>Mn.tabId===Ot);return(0,a.jsxs)("div",{className:rt.dataPane,"data-testid":o.Tp.components.PanelEditor.DataPane.content,children:[(0,a.jsx)(g.U,{hideBorder:!0,className:rt.tabsBar,children:jt.map((Mn,kn)=>(0,a.jsx)(Mn.TabComponent,{active:Mn.tabId===Ot,onChangeTab:()=>Rt.onChangeTab(Mn)},`${Mn.getTabLabel()}-${kn}`))}),(0,a.jsx)(l.E,{className:rt.scroll,children:(0,a.jsx)(p.J,{className:rt.tabContent,children:(0,a.jsx)(m.mc,{children:tn&&(0,a.jsx)(tn.Component,{model:tn})})})})]})}function Xe(Rt){const{unifiedAlertingEnabled:Ot=!1}=(0,y.zj)(),jt=d.TP.hasPermission((0,v.Wd)(u.hY).read);return Ot&&jt?Rt==="graph"||Rt==="timeseries":!1}function Je(Rt){return{dataPane:(0,c.css)({display:"flex",flexDirection:"column",flexGrow:1,minHeight:0,height:"100%",width:"100%"}),tabContent:(0,c.css)({padding:Rt.spacing(2),border:`1px solid ${Rt.colors.border.weak}`,borderLeft:"none",borderBottom:"none",borderTopRightRadius:Rt.shape.radius.default,flexGrow:1}),tabsBar:(0,c.css)({flexShrink:0,paddingLeft:Rt.spacing(2)}),scroll:(0,c.css)({background:Rt.colors.background.primary})}}var st=e(27746),pt=e(47150),xt=e(54174),ot=e(40996),$e=e(37390),ve=e(10354),be=e(14578),he=e(57767),ye=e(43535);const Pe=({libraryPanel:Rt,isUnsavedPrompt:Ot,onDismiss:jt,onConfirm:rt,onDiscard:tn})=>{const[Mn,kn]=(0,ae.useState)(""),Yn=(0,I.A)(async()=>{const Xn=await(0,he.xV)(Rt.state.uid);return Xn.length>0?Xn.map(Ps=>Ps.title):[]},[Rt.state.uid]),[Wn,Jn]=(0,ae.useState)([]);(0,ot.A)(()=>Yn.value?Jn(Yn.value.filter(Xn=>Xn.toLowerCase().includes(Mn.toLowerCase()))):Jn([]),300,[Yn.value,Mn]);const Ls=(0,h.of)(ye.o),fs=(0,ae.useCallback)(()=>{tn()},[tn]),ys=Ot?"Unsaved library panel changes":"Save library panel";return(0,a.jsx)($e.a,{title:ys,icon:"save",onDismiss:jt,isOpen:!0,children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:Ls.textInfo,children:["This update will affect ",(0,a.jsxs)("strong",{children:[Rt.state._loadedPanel?.meta?.connectedDashboards," ",Rt.state._loadedPanel?.meta?.connectedDashboards===1?"dashboard":"dashboards","."]}),"The following dashboards using the panel will be affected:"]}),(0,a.jsx)(ve.p,{className:Ls.dashboardSearch,prefix:(0,a.jsx)(be.I,{name:"search"}),placeholder:"Search affected dashboards",value:Mn,onChange:Xn=>kn(Xn.currentTarget.value)}),Yn.loading?(0,a.jsx)("p",{children:"Loading connected dashboards..."}):(0,a.jsxs)("table",{className:Ls.myTable,children:[(0,a.jsx)("thead",{children:(0,a.jsx)("tr",{children:(0,a.jsx)("th",{children:"Dashboard name"})})}),(0,a.jsx)("tbody",{children:Wn.map((Xn,Ps)=>(0,a.jsx)("tr",{children:(0,a.jsx)("td",{children:Xn})},`dashrow-${Ps}`))})]}),(0,a.jsxs)($e.a.ButtonRow,{children:[(0,a.jsx)(R.$n,{variant:"secondary",onClick:jt,fill:"outline",children:"Cancel"}),Ot&&(0,a.jsx)(R.$n,{variant:"destructive",onClick:fs,children:"Discard"}),(0,a.jsx)(R.$n,{onClick:()=>{rt()},children:"Update all"})]})]})})};var ge=e(21633);function xe(Rt){const{paneOptions:Ot}=Rt,[jt,rt]=(0,ae.useState)({collapsed:!1}),tn=(0,ae.useCallback)((fs,ys)=>{if(fs<=0&&ys<=0)return;const Xn=ys/fs*(1-fs);jt.collapsed&&Xn>Ot.collapseBelowPixels&&rt({collapsed:!1}),!jt.collapsed&&Xn<Ot.collapseBelowPixels&&rt({collapsed:!0})},[jt,Ot.collapseBelowPixels]),Mn=(0,ae.useCallback)((fs,ys)=>{if(fs<=0&&ys<=0)return;const Xn=1-fs,Ps=jt.snapSize===0,Zs=ys/fs,ks=(Ot.snapOpenToPixels??Zs/2)/Zs;jt.collapsed?rt(Ps?{snapSize:Math.max(Xn,ks),collapsed:!1}:{snapSize:0,collapsed:!0}):Ps&&rt({snapSize:Xn,collapsed:!1})},[jt,Ot.snapOpenToPixels]),kn=(0,ae.useCallback)(()=>{rt({collapsed:!jt.collapsed})},[jt.collapsed]),{containerProps:Yn,primaryProps:Wn,secondaryProps:Jn,splitterProps:Ls}=(0,ge.h)({...Rt,onResizing:tn,onSizeChanged:Mn});return Jn.style.overflow="hidden",Jn.style.minWidth="unset",Jn.style.minHeight="unset",jt.snapSize?(Wn.style={...Wn.style,flexGrow:1-jt.snapSize},Jn.style.flexGrow=jt.snapSize):jt.snapSize===0&&(Wn.style.flexGrow=1,Jn.style.flexGrow=0,Jn.style.minWidth="unset",Jn.style.minHeight="unset",Jn.style.overflow="unset"),{containerProps:Yn,primaryProps:Wn,secondaryProps:Jn,splitterProps:Ls,splitterState:jt,onToggleCollapse:kn}}function Ae({model:Rt}){const Ot=(0,f.YQ)(Rt),{optionsPane:jt}=Rt.useState(),rt=(0,h.of)(Ie),{containerProps:tn,primaryProps:Mn,secondaryProps:kn,splitterProps:Yn,splitterState:Wn,onToggleCollapse:Jn}=xe({direction:"row",dragPosition:"end",initialSize:.75,paneOptions:{collapseBelowPixels:250,snapOpenToPixels:400}});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(pt.c,{dashboard:Ot}),(0,a.jsxs)("div",{...tn,className:(0,c.cx)(tn.className,{[rt.content]:n.$.featureToggles.bodyScrolling}),"data-testid":o.Tp.components.PanelEditor.General.content,children:[(0,a.jsx)("div",{...Mn,className:(0,c.cx)(Mn.className,rt.body),children:(0,a.jsx)(Ee,{model:Rt})}),(0,a.jsx)("div",{...Yn}),(0,a.jsxs)("div",{...kn,className:(0,c.cx)(kn.className,rt.optionsPane),children:[Wn.collapsed&&(0,a.jsx)("div",{className:rt.expandOptionsWrapper,children:(0,a.jsx)(st.I,{tooltip:"Open options pane",icon:"arrow-to-right",onClick:Jn,variant:"canvas",className:rt.rotate180,"aria-label":"Open options pane"})}),!Wn.collapsed&&(0,a.jsx)(jt.Component,{model:jt})]})]})]})}function Ee({model:Rt}){const Ot=(0,f.YQ)(Rt),{vizManager:jt,dataPane:rt,showLibraryPanelSaveModal:tn,showLibraryPanelUnlinkModal:Mn}=Rt.useState(),{sourcePanel:kn}=jt.useState(),Yn=(0,f.Yr)(kn.resolve()),{controls:Wn,scopes:Jn}=Ot.useState(),Ls=(0,h.of)(Ie),{containerProps:fs,primaryProps:ys,secondaryProps:Xn,splitterProps:Ps,splitterState:Zs,onToggleCollapse:Ms}=xe({direction:"column",dragPosition:"start",initialSize:.5,paneOptions:{collapseBelowPixels:150}});return fs.className=(0,c.cx)(fs.className,Ls.container),rt||(ys.style.flexGrow=1),(0,a.jsxs)("div",{className:(0,c.cx)(Ls.pageContainer,Wn&&!Jn&&Ls.pageContainerWithControls,Jn&&Ls.pageContainerWithScopes),children:[Jn&&(0,a.jsx)(Jn.Component,{model:Jn}),Wn&&(0,a.jsx)("div",{className:(0,c.cx)(Ls.controlsWrapper,Jn&&Ls.controlsWrapperWithScopes),children:(0,a.jsx)(Wn.Component,{model:Wn})}),(0,a.jsxs)("div",{...fs,children:[(0,a.jsx)("div",{...ys,children:(0,a.jsx)(jt.Component,{model:jt})}),tn&&Yn&&(0,a.jsx)(Pe,{libraryPanel:Yn,onDismiss:Rt.onDismissLibraryPanelSaveModal,onConfirm:Rt.onConfirmSaveLibraryPanel,onDiscard:Rt.onDiscard}),Mn&&Yn&&(0,a.jsx)(xt.l,{onDismiss:Rt.onDismissUnlinkLibraryPanelModal,onConfirm:Rt.onConfirmUnlinkLibraryPanel,isOpen:!0}),rt&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{...Ps}),(0,a.jsxs)("div",{...Xn,children:[Zs.collapsed&&(0,a.jsx)("div",{className:Ls.expandDataPane,children:(0,a.jsx)(R.$n,{tooltip:"Open query pane",icon:"arrow-to-right",onClick:Ms,variant:"secondary",size:"sm",className:Ls.openDataPaneButton,"aria-label":"Open query pane"})}),!Zs.collapsed&&(0,a.jsx)(rt.Component,{model:rt})]})]})]})]})}function Ie(Rt){return{pageContainer:(0,c.css)({display:"grid",gridTemplateAreas:`
        "panels"`,gridTemplateColumns:"1fr",gridTemplateRows:"1fr",height:"100%"}),pageContainerWithControls:(0,c.css)({gridTemplateAreas:`
        "controls"
        "panels"`,gridTemplateRows:"auto 1fr"}),pageContainerWithScopes:(0,c.css)({gridTemplateAreas:`
        "scopes controls"
        "panels panels"`,gridTemplateColumns:`${Rt.spacing(32)} 1fr`,gridTemplateRows:"auto 1fr"}),container:(0,c.css)({gridArea:"panels",height:"100%"}),canvasContent:(0,c.css)({label:"canvas-content",display:"flex",flexDirection:"column",flexBasis:"100%",flexGrow:1,minHeight:0,width:"100%"}),content:(0,c.css)({position:"absolute",width:"100%",height:"100%"}),body:(0,c.css)({label:"body",flexGrow:1,display:"flex",flexDirection:"column",minHeight:0}),optionsPane:(0,c.css)({flexDirection:"column",borderLeft:`1px solid ${Rt.colors.border.weak}`,background:Rt.colors.background.primary}),expandOptionsWrapper:(0,c.css)({display:"flex",flexDirection:"column",padding:Rt.spacing(2,1)}),expandDataPane:(0,c.css)({display:"flex",flexDirection:"row",padding:Rt.spacing(1),borderTop:`1px solid ${Rt.colors.border.weak}`,borderRight:`1px solid ${Rt.colors.border.weak}`,background:Rt.colors.background.primary,flexGrow:1,justifyContent:"space-around"}),rotate180:(0,c.css)({rotate:"180deg"}),controlsWrapper:(0,c.css)({display:"flex",flexDirection:"column",flexGrow:0,gridArea:"controls",padding:Rt.spacing(2,0,2,2)}),controlsWrapperWithScopes:(0,c.css)({padding:Rt.spacing(2,0)}),openDataPaneButton:(0,c.css)({width:Rt.spacing(8),justifyContent:"center",svg:{rotate:"-90deg"}})}}var Qe=e(67647),at=e(26443),ft=e(41394),ct=e(17706),vt=e(22290),Pt=e(66211),Vt=e(15292),Jt=e(94354),wt=e(90182),zt=e(64919),on=e(21744),Pn=e(20214),_n=e(74410),Cn=e(48192),Ye=e(74097),Dt=e(92378),yt=e(6923),Ft=e(20455),an=e(32023);function un(Rt,Ot,jt){const rt=new Cn.C({title:"Panel options",id:"Panel options",isOpenDefault:!0}),tn=an.b4.getPanelLinks(Ot),Mn=tn?.state.rawLinks??[],kn=(0,f.YQ)(Ot);return rt.addItem(new Ye.v({title:"Title",value:Ot.state.title,popularRank:1,render:function(){return(0,a.jsx)(Un,{vizManager:Rt})},addon:n.$.featureToggles.dashgpt&&(0,a.jsx)(_n.h,{onGenerate:Yn=>Rt.setPanelTitle(Yn),panel:(0,Ft.Z6)(Ot),dashboard:(0,Ft.Uy)(kn)})})).addItem(new Ye.v({title:"Description",value:Ot.state.description,render:function(){return(0,a.jsx)(Nn,{panel:Ot})},addon:n.$.featureToggles.dashgpt&&(0,a.jsx)(Pn.t,{onGenerate:Yn=>Ot.setState({description:Yn}),panel:(0,Ft.Z6)(Ot)})})).addItem(new Ye.v({title:"Transparent background",render:function(){return(0,a.jsx)(Vt.d,{value:Ot.state.displayMode==="transparent",id:"transparent-background",onChange:()=>{Ot.setState({displayMode:Ot.state.displayMode==="transparent"?"default":"transparent"})}})}})).addCategory(new Cn.C({title:"Panel links",id:"Panel links",isOpenDefault:!1,itemsCount:Mn?.length}).addItem(new Ye.v({title:"Panel links",render:()=>(0,a.jsx)(hn,{panelLinks:tn??void 0})}))).addCategory(new Cn.C({title:"Repeat options",id:"Repeat options",isOpenDefault:!1}).addItem(new Ye.v({title:"Repeat by variable",description:"Repeat this panel for each value in the selected variable. This is not visible while in edit mode. You need to go back to dashboard and then update the variable or reload the dashboard.",render:function(){return(0,a.jsx)(Dt.U,{id:"repeat-by-variable-select",parent:Ot,repeat:jt,onChange:Wn=>{const Jn={repeat:Wn};Wn&&!Rt.state.repeatDirection&&(Jn.repeatDirection="h"),Rt.setState(Jn)}})}})).addItem(new Ye.v({title:"Repeat direction",showIf:()=>!!Rt.state.repeat,render:function(){const Wn=[{label:"Horizontal",value:"h"},{label:"Vertical",value:"v"}];return(0,a.jsx)(Jt.z,{options:Wn,value:Rt.state.repeatDirection??"h",onChange:Jn=>Rt.setState({repeatDirection:Jn})})}})).addItem(new Ye.v({title:"Max per row",showIf:()=>!!(Rt.state.repeat&&Rt.state.repeatDirection==="h"),render:function(){const Wn=[2,3,4,6,8,12].map(Jn=>({label:Jn.toString(),value:Jn}));return(0,a.jsx)(wt.l6,{options:Wn,value:Rt.state.maxPerRow,onChange:Jn=>Rt.setState({maxPerRow:Jn.value})})}})))}function hn({panelLinks:Rt}){const{rawLinks:Ot}=Rt?Rt.useState():{rawLinks:[]};return(0,a.jsx)(zt.e,{links:Ot,onChange:jt=>Rt?.setState({rawLinks:jt}),getSuggestions:yt.Fq,data:[]})}function Un({vizManager:Rt}){const{title:Ot}=Rt.state.panel.useState();return(0,a.jsx)(ve.p,{"data-testid":o.Tp.components.PanelEditor.OptionsPane.fieldInput("Title"),value:Ot,onChange:jt=>Rt.setPanelTitle(jt.currentTarget.value)})}function Nn({panel:Rt}){const{description:Ot}=Rt.useState();return(0,a.jsx)(on.f,{id:"description-text-area",value:Ot,onChange:jt=>Rt.setState({description:jt.currentTarget.value})})}const St=ae.memo(({vizManager:Rt,searchQuery:Ot,listMode:jt,data:rt})=>{const{panel:tn,sourcePanel:Mn,repeat:kn}=Rt.useState(),Yn=Mn.resolve().parent,{options:Wn,fieldConfig:Jn,_pluginInstanceState:Ls}=tn.useState(),fs=(0,ae.useMemo)(()=>un(Rt,tn,kn),[Rt,tn,kn]),ys=(0,ae.useMemo)(()=>{const ks=tn.getPlugin();if(ks)return(0,Pt.Z4)({panel:tn,data:rt,plugin:ks,eventBus:tn.getPanelContext().eventBus,instanceState:Ls})},[tn,Wn,Jn,Ls]),Xn=(0,ae.useMemo)(()=>{if(Yn instanceof r.F)return(0,Pt.tN)(Yn)},[Yn]),Ps=(0,ae.useMemo)(()=>(0,vt.v)(Jn,tn.getPlugin()?.fieldConfigRegistry,rt?.series??[],Ot,ks=>{tn.onFieldConfigChange(ks,!0)}),[Ot,tn,Jn]),Zs=Ot.length>0,Ms=[];if(Zs)Ms.push((0,at.Po)([fs,...Xn?[Xn]:[],...ys??[]],Ps,Ot));else switch(jt){case at.gs.All:Xn&&Ms.push(Xn.render()),Ms.push(fs.render());for(const ks of ys??[])Ms.push(ks.render());for(const ks of Ps)Ms.push(ks.render());break;case at.gs.Overrides:for(const ks of Ps)Ms.push(ks.render());default:break}return Ms});St.displayName="PanelOptions";var nn=e(78685),ht=e(88575),lt=e(15054),gt=e(32696),$t=e(56707),et=e(86292),Et=e(53543);function It({vizManager:Rt,data:Ot,onChange:jt}){const{panel:rt}=Rt.useState(),tn=(0,h.of)(Qt),[Mn,kn]=(0,ae.useState)(""),Yn=!1,Wn=Yn?lt.MM:lt.wV,Jn=Yn?gt.__.Widgets:gt.__.Visualizations,Ls=(0,ae.useMemo)(()=>new Et.R(rt),[rt]),fs=(0,ae.useMemo)(()=>new Set([gt.__.Widgets,gt.__.Visualizations,gt.__.Suggestions]),[]),[ys,Xn]=(0,nn.A)(Wn,Jn);(0,ae.useEffect)(()=>{ys&&!fs.has(ys)&&Xn(Jn)},[Jn,ys,Xn,fs]);const Ps=[{label:"Visualizations",value:gt.__.Visualizations},{label:"Suggestions",value:gt.__.Suggestions}],Zs=Ms=>{Rt.changePluginType(Ms.pluginId),jt()};return(0,a.jsxs)("div",{className:tn.wrapper,children:[(0,a.jsx)(Qe.Z,{className:tn.filter,value:Mn,onChange:kn,autoFocus:!0,placeholder:"Search for..."}),(0,a.jsx)(ht.D,{className:tn.customFieldMargin,children:(0,a.jsx)(Jt.z,{options:Ps,value:ys,onChange:Xn,fullWidth:!0})}),(0,a.jsxs)(l.E,{children:[ys===gt.__.Visualizations&&(0,a.jsx)(et.G,{pluginId:rt.state.pluginId,searchQuery:Mn,onChange:Zs}),ys===gt.__.Suggestions&&(0,a.jsx)($t.a,{onChange:Zs,searchQuery:Mn,panel:Ls,data:Ot})]})]})}const Qt=Rt=>({wrapper:(0,c.css)({display:"flex",flexDirection:"column",flexGrow:1,padding:Rt.spacing(2,1),height:"100%",gap:Rt.spacing(2),border:`1px solid ${Rt.colors.border.weak}`,borderRight:"none",borderBottom:"none",borderTopLeftRadius:Rt.shape.radius.default}),customFieldMargin:(0,c.css)({marginBottom:Rt.spacing(1)}),filter:(0,c.css)({minHeight:Rt.spacing(4)})});class sn extends i.Bs{constructor(Ot){super({searchQuery:"",listMode:at.gs.All,...Ot}),this.onToggleVizPicker=()=>{this.setState({isVizPickerOpen:!this.state.isVizPickerOpen})},this.onSetSearchQuery=jt=>{this.setState({searchQuery:jt})},this.onSetListMode=jt=>{this.setState({listMode:jt})}}static{this.Component=({model:Ot})=>{const{isVizPickerOpen:jt,searchQuery:rt,listMode:tn}=Ot.useState(),Mn=i.jh.getAncestor(Ot,wn).state.vizManager,{pluginId:kn}=Mn.useState(),{data:Yn}=i.jh.getData(Mn.state.panel).useState(),Wn=(0,h.of)(ln);return(0,a.jsxs)(a.Fragment,{children:[!jt&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:Wn.top,children:[(0,a.jsx)(yn,{pluginId:kn,onOpen:Ot.onToggleVizPicker}),(0,a.jsx)(Qe.Z,{className:Wn.searchOptions,value:rt,placeholder:"Search options",onChange:Ot.onSetSearchQuery})]}),(0,a.jsx)("div",{className:Wn.listOfOptions,children:(0,a.jsx)(St,{vizManager:Mn,searchQuery:rt,listMode:tn,data:Yn})})]}),jt&&(0,a.jsx)(It,{vizManager:Mn,onChange:Ot.onToggleVizPicker,data:Yn})]})}}}function ln(Rt){return{top:(0,c.css)({display:"flex",flexDirection:"column",padding:Rt.spacing(2,1),gap:Rt.spacing(2)}),listOfOptions:(0,c.css)({display:"flex",flexDirection:"column",flexGrow:"1",overflow:"auto"}),searchOptions:(0,c.css)({minHeight:Rt.spacing(4)}),searchWrapper:(0,c.css)({padding:Rt.spacing(2,2,2,0)}),vizField:(0,c.css)({marginBottom:Rt.spacing(1)}),rotateIcon:(0,c.css)({rotate:"180deg"})}}function yn({pluginId:Rt,onOpen:Ot}){const jt=(0,h.of)(Sn);let rt=(0,ae.useMemo)(()=>(0,ct.A4)().filter(tn=>tn.id===Rt)[0],[Rt]);return rt||(rt=(0,ft.$)(`Panel plugin not found (${Rt})`,!0).meta),(0,a.jsx)(k.B,{gap:1,children:(0,a.jsx)(st.I,{className:jt.vizButton,tooltip:"Click to change visualization",imgSrc:rt.info.logos.small,onClick:Ot,"data-testid":o.Tp.components.PanelEditor.toggleVizPicker,"aria-label":"Change Visualization",variant:"canvas",isOpen:!1,fullWidth:!0,children:rt.name})})}function Sn(Rt){return{vizButton:(0,c.css)({textAlign:"left"})}}var En=e(89681);class wn extends i.Bs{constructor(Ot){super(Ot),this._initialRepeatOptions={},this._discardChanges=!1,this.onDiscard=()=>{this._discardChanges=!0,t.Ny.partial({editPanel:null})},this.onSaveLibraryPanel=()=>{this.setState({showLibraryPanelSaveModal:!0})},this.onConfirmSaveLibraryPanel=()=>{this.state.vizManager.commitChanges(),t.Ny.partial({editPanel:null})},this.onDismissLibraryPanelSaveModal=()=>{this.setState({showLibraryPanelSaveModal:!1})},this.onUnlinkLibraryPanel=()=>{this.setState({showLibraryPanelUnlinkModal:!0})},this.onDismissUnlinkLibraryPanelModal=()=>{this.setState({showLibraryPanelUnlinkModal:!1})},this.onConfirmUnlinkLibraryPanel=()=>{this.state.vizManager.unlinkLibraryPanel(),this.setState({showLibraryPanelUnlinkModal:!1})};const{repeat:jt,repeatDirection:rt,maxPerRow:tn}=Ot.vizManager.state;this._initialRepeatOptions={repeat:jt,repeatDirection:rt,maxPerRow:tn},this.addActivationHandler(this._activationHandler.bind(this))}static{this.Component=Ae}_activationHandler(){const Ot=this.state.vizManager,jt=Ot.state.panel;return this._subs.add(Ot.subscribeToState((rt,tn)=>{rt.pluginId!==tn.pluginId&&this._initDataPane(rt.pluginId)})),this._initDataPane(jt.state.pluginId),()=>{this._discardChanges?this.state.isNewPanel&&(0,f.YQ)(this).removePanel(Ot.state.sourcePanel.resolve()):this.commitChanges()}}_initDataPane(Ot){const jt=n.$.panels[Ot]?.skipDataQuery;jt&&this.state.dataPane&&(t.Ny.partial({tab:null},!0),this.setState({dataPane:void 0})),!jt&&!this.state.dataPane&&this.setState({dataPane:new We(this.state.vizManager)})}getUrlKey(){return this.state.panelId.toString()}getPageNav(Ot,jt){return{text:"Edit panel",parentItem:(0,f.YQ)(this).getPageNav(Ot,jt)}}commitChanges(){const Ot=(0,f.YQ)(this);Ot.state.isEditing||Ot.onEnterEditMode();const tn=this.state.vizManager.state.sourcePanel.resolve().parent,Mn=tn instanceof r.F,kn=Mn?tn.parent:tn;if(!Mn){if(!(kn instanceof s.U)){console.error("Unsupported scene object type");return}this.commitChangesToSource(kn)}}commitChangesToSource(Ot){let jt=Ot.state.width??1,rt=Ot.state.height;const tn=this.state.vizManager,Mn=this._initialRepeatOptions.repeatDirection==="h"&&tn.state.repeatDirection==="v",kn=this._initialRepeatOptions.repeatDirection==="v"&&tn.state.repeatDirection==="h";Mn?jt=Math.floor(jt/(Ot.state.maxPerRow??1)):kn&&(jt=24),Ot.setState({body:tn.state.panel.clone(),repeatDirection:tn.state.repeatDirection,variableName:tn.state.repeat,maxPerRow:tn.state.maxPerRow,width:jt,height:rt})}}function On(Rt,Ot=!1){return new wn({panelId:(0,f.Cs)(Rt),optionsPane:new sn({}),vizManager:En.j.createFor(Rt),isNewPanel:Ot})}},89681:(G,O,e)=>{"use strict";e.d(O,{j:()=>S});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(96540),f=e(22391),a=e(581),c=e(19347),o=e(32264),h=e(12131),g=e(80943),l=e(40845),p=e(36974),m=e(47311),y=e(57767),d=e(93117),v=e(13530),u=e(45429),D=e(41507),P=e(60656),x=e(7928),E=e(20455),C=e(74730),M=(T=>(T[T.Fill=0]="Fill",T[T.Fit=1]="Fit",T[T.Exact=2]="Exact",T))(M||{});class S extends g.Bs{constructor(b){super(b),this._cachedPluginOptions={},this._detectPanelModelChanges=(0,i.debounce)(()=>{const{hasChanges:R}=(0,u.yO)((0,E.Z6)(this.state.sourcePanel.resolve()),(0,E.Z6)(this.state.panel));this.setState({isDirty:R})},250),this._handleStateChange=R=>{v.l.isUpdatingPersistedState(R)&&this._detectPanelModelChanges()},this.addActivationHandler(()=>this._onActivate())}static createFor(b){let R={};const A=b.parent instanceof P.F?b.parent.parent:b.parent;if(!(A instanceof D.U))throw console.error("VizPanel is not a child of a dashboard grid item"),new Error("VizPanel is not a child of a dashboard grid item");const{variableName:L,repeatDirection:U,maxPerRow:W}=A.state;R={repeat:L,repeatDirection:U,maxPerRow:W};let w;return A.parent?.state.$variables&&(w=A.parent.state.$variables.clone()),new S({$variables:w,panel:b.clone(),sourcePanel:b.getRef(),pluginId:b.state.pluginId,...R})}_onActivate(){this.loadDataSource();const b=this.subscribeToEvent(g.bZ,this._handleStateChange);return()=>{b.unsubscribe()}}async loadDataSource(){if(!this.state.panel.state.$data)return;let R=this.queryRunner.state.datasource;try{let A,L;if(R)A=await(0,c.l)().get(R),L=(0,c.l)().getInstanceSettings(R);else{const W=(0,C.YQ)(this).state.uid??"",w=(0,p.CW)(W);w?.datasourceUid!==null&&(L=(0,c.l)().getInstanceSettings({uid:w?.datasourceUid}),L&&(A=await(0,c.l)().get({uid:w?.datasourceUid,type:L.type}),this.queryRunner.setState({datasource:{...(0,f.p$)(L),uid:w?.datasourceUid}})))}A&&L&&(this.setState({datasource:A,dsSettings:L}),(0,m.tw)((0,f.p$)(L)||{default:!0}))}catch(A){const L=await(0,c.l)().get(o.$.defaultDatasource),U=(0,c.l)().getInstanceSettings(o.$.defaultDatasource);L&&U&&(this.setState({datasource:L,dsSettings:U}),this.queryRunner.setState({datasource:(0,f.p$)(U)})),console.error(A)}}changePluginType(b){const{options:R,fieldConfig:A,pluginId:L}=this.state.panel.state;let U={defaults:{...A.defaults,custom:{}},overrides:(0,a.aW)(A.overrides,a.nx)};this._cachedPluginOptions[L]={options:R,fieldConfig:A};const W=this._cachedPluginOptions[b]?.options,w=this._cachedPluginOptions[b]?.fieldConfig;if(w&&(U=(0,a.H9)(U,w)),!this.state.panel.state.$data&&!o.$.panels[b].skipDataQuery){let N=(0,p.CW)((0,C.YQ)(this).state.uid)?.datasourceUid;N||(N=o.$.defaultDatasource),this.state.panel.setState({$data:new g.Es({$data:new g.dt({datasource:{uid:N},queries:[{refId:"A"}]}),transformations:[]})})}this.setState({pluginId:b}),this.state.panel.changePluginType(b,W,U),this.loadDataSource()}async changePanelDataSource(b,R){const{dsSettings:A}=this.state,L=this.queryRunner,U=A?await(0,c.l)().get({uid:A.uid}):void 0,W=await(0,c.l)().get({uid:b.uid}),w=L.state.queries,N=R||await(0,d.y)(W,b.uid,w,U);L.setState({datasource:(0,f.p$)(b),queries:N}),R&&L.runQueries(),this.loadDataSource()}changeQueryOptions(b){const R=this.state.panel,A=this.queryRunner,L=R.state.$timeRange,U={},W={};b.maxDataPoints!==A.state.maxDataPoints&&(U.maxDataPoints=b.maxDataPoints??void 0),b.minInterval!==A.state.minInterval&&b.minInterval!==null&&(U.minInterval=b.minInterval),b.timeRange&&(W.timeFrom=b.timeRange.from??void 0,W.timeShift=b.timeRange.shift??void 0,W.hideTimeOverride=b.timeRange.hide),L instanceof x.v?W.timeFrom!==void 0||W.timeShift!==void 0?L.setState(W):R.setState({$timeRange:void 0}):R.setState({$timeRange:new x.v(W)}),b.cacheTimeout!==A?.state.cacheTimeout&&(U.cacheTimeout=b.cacheTimeout),b.queryCachingTTL!==A?.state.queryCachingTTL&&(U.queryCachingTTL=b.queryCachingTTL),A.setState(U),A.runQueries()}changeQueries(b){this.queryRunner.setState({queries:b})}changeTransformations(b){const R=this.dataTransformer;R.setState({transformations:b}),R.reprocessTransformations()}inspectPanel(){const b=this.state.panel,R=(0,C.Cs)(b);h.Ny.partial({inspect:R,inspectTab:"query"})}get queryRunner(){const b=(0,C.un)(this.state.panel);if(!b)throw new Error("Query runner not found");return b}get dataTransformer(){const b=this.state.panel.state.$data;if(!b||!(b instanceof g.Es))throw new Error("Could not find SceneDataTransformer for panel");return b}toggleTableView(){if(this.state.tableView){this.setState({tableView:void 0});return}this.setState({tableView:g.d0.table().setTitle("").setOption("showTypeIcons",!0).setOption("showHeader",!0).setData(this.dataTransformer).build()})}unlinkLibraryPanel(){const b=this.state.sourcePanel.resolve();if(!(b.parent instanceof P.F))throw new Error("VizPanel is not a child of a library panel");const R=b.parent.parent;if(!(R instanceof D.U))throw new Error("Library panel not a child of a grid item");const A=this.state.panel.clone({$data:this.state.$data?.clone()});R.setState({body:A}),this.setState({sourcePanel:A.getRef()})}commitChanges(){const b=this.state.sourcePanel.resolve();this.commitChangesTo(b)}commitChangesTo(b){const R={variableName:this.state.repeat,repeatDirection:this.state.repeatDirection,maxPerRow:this.state.maxPerRow};if(b.parent instanceof D.U&&b.parent.setState({...R,body:this.state.panel.clone()}),b.parent instanceof P.F&&b.parent.parent instanceof D.U){const A=b.parent.clone({panel:this.state.panel.clone()});b.parent.parent.setState({body:A,...R}),(0,y.GX)(A).then(L=>{b.parent instanceof P.F&&A.setPanelFromLibPanel(L)})}}getPanelSaveModel(){const b=this.state.sourcePanel.resolve(),A=b.parent instanceof P.F?b.parent.parent:b.parent;if(!(A instanceof D.U))return{error:"Unsupported panel parent"};const L=A.clone({body:this.state.panel.clone()});return(0,E.ZB)(L)}setPanelTitle(b){this.state.panel.setState({title:b,hoverHeader:b===""})}static{this.Component=({model:b})=>{const{panel:R,tableView:A}=b.useState(),L=(0,l.of)(I),U=A??R,W=U.state.$data;return(0,r.useEffect)(()=>W?.activate(),[W]),(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("div",{className:L.wrapper,children:(0,t.jsx)(U.Component,{model:U})})})}}}function I(T){return{wrapper:(0,n.css)({height:"100%",width:"100%",paddingLeft:T.spacing(2)})}}},13530:(G,O,e)=>{"use strict";e.d(O,{l:()=>m});var t=e(80943),n=e(67278);const i=()=>new n.c(new URL(e.p+e.u(9666),e.b));var s=e(89681),r=e(38477),f=e(33278),a=e(41507),c=e(34842),o=e(60656),h=e(42397),g=e(7928),l=e(20455),p=e(17663);class m{constructor(d){this._dashboard=d}static isUpdatingPersistedState({payload:d}){return Object.keys(d.partialUpdate).length===0?!1:!!(d.changedObject instanceof t.Eb||d.changedObject instanceof a.U||d.changedObject instanceof g.v||d.changedObject instanceof s.j&&(Object.prototype.hasOwnProperty.call(d.partialUpdate,"repeat")||Object.prototype.hasOwnProperty.call(d.partialUpdate,"repeatDirection")||Object.prototype.hasOwnProperty.call(d.partialUpdate,"maxPerRow"))||d.changedObject instanceof t.dt&&!Object.prototype.hasOwnProperty.call(d.partialUpdate,"data")||d.changedObject instanceof t.Es&&!Object.prototype.hasOwnProperty.call(d.partialUpdate,"data")||d.changedObject instanceof h.$||d.changedObject instanceof o.F&&Object.prototype.hasOwnProperty.call(d.partialUpdate,"name")||d.changedObject instanceof t.WM&&(Object.prototype.hasOwnProperty.call(d.partialUpdate,"intervals")||Object.prototype.hasOwnProperty.call(d.partialUpdate,"refresh"))||d.changedObject instanceof t.Gg.K2||d.changedObject instanceof t.kh||d.changedObject instanceof a.U||d.changedObject instanceof t.hy||d.changedObject instanceof c.H$&&Object.keys(d.partialUpdate).some(v=>c.vk.includes(v))||d.changedObject instanceof t.JZ||d.changedObject instanceof f.x&&Object.prototype.hasOwnProperty.call(d.partialUpdate,"hideTimeControls")||d.changedObject instanceof t.Pj||d.changedObject instanceof r.g&&!Object.prototype.hasOwnProperty.call(d.partialUpdate,"data")||d.changedObject instanceof t.Gg.en||(0,p.c7)(d.changedObject))}onStateChanged(d){m.isUpdatingPersistedState(d)&&this.detectSaveModelChanges()}detectSaveModelChanges(){this._changesWorker?.postMessage({changed:(0,l.Uy)(this._dashboard),initial:this._dashboard.getInitialSaveModel()})}hasMetadataChanges(){return this._dashboard.state.meta.folderUid!==this._dashboard.getInitialState()?.meta.folderUid}updateIsDirty(d){const{hasChanges:v}=d;v||this.hasMetadataChanges()?this._dashboard.state.isDirty||this._dashboard.setState({isDirty:!0}):this._dashboard.state.isDirty&&this._dashboard.setState({isDirty:!1})}init(){this._changesWorker=i()}startTrackingChanges(){this._changesWorker||this.init(),this._changesWorker.onmessage=d=>{this.updateIsDirty(d.data)},this._changeTrackerSub=this._dashboard.subscribeToEvent(t.bZ,this.onStateChanged.bind(this))}stopTrackingChanges(){this._changeTrackerSub?.unsubscribe()}terminate(){this.stopTrackingChanges(),this._changesWorker?.terminate(),this._changesWorker=void 0}}},45429:(G,O,e)=>{"use strict";e.d(O,{Yy:()=>r,yO:()=>o});var t=e(56596);function n(h,g){try{let l=h;for(const p of g)l=l[p];return l}catch{return}}function i(h,g){return typeof h==typeof g&&(typeof h=="string"&&h===g||Array.isArray(h)&&h.length===g.length&&h.every((l,p)=>l===g[p]))}function s(h,g){return h===g||h&&g&&h.selected===g.selected&&i(h.text,g.text)&&i(h.value,g.value)}function r(h,g,l,p,m){const y=h,d=g,v=f(d,y),u=c(d,y,p),D=d.refresh!==y.refresh;l||(d.time=y.time),m||(d.refresh=y.refresh);const P=(0,t.G4)(y,d),x=Object.values(P).reduce((E,C)=>E+C.length,0);return{changedSaveModel:d,initialSaveModel:y,diffs:P,diffCount:x,hasChanges:x>0,hasTimeChanges:v,isNew:d.version===0,hasVariableValueChanges:u,hasRefreshChange:D}}function f(h,g){return h.time?.from!==g.time?.from||h.time?.to!==g.time?.to}function a(h,g){if(h.filters===void 0&&g.filters===void 0)return console.warn("Adhoc variable filter property is undefined"),!0;if(h.filters===void 0&&g.filters!==void 0||g.filters===void 0&&h.filters!==void 0)return console.warn("Adhoc variable filter property is undefined"),!1;if(h.filters.length!==g.filters.length)return!1;for(let l=0;l<h.filters.length;l++){const p=h.filters[l],m=g.filters[l];if(p.key!==m.key||p.operator!==m.operator||p.value!==m.value)return!1}return!0}function c(h,g,l){const p=g.templating?.list??[],m=h.templating?.list??[];let y=!1;for(const d of m){const v=p.find(({name:u,type:D})=>u===d.name&&D===d.type);if(v&&(v.current&&delete v.current.selected,s(d.current,v.current)?d.type==="adhoc"&&!a(d,v)&&(y=!0):y=!0,!l)){const u=d;u.type==="adhoc"?u.filters=v.filters:(d.current=v.current,d.options=v.options)}}return y}function o(h,g){const l=(0,t.G4)(g,h),p=Object.values(l).reduce((m,y)=>m+y.length,0);return{changedSaveModel:h,initialSaveModel:g,diffs:l,diffCount:p,hasChanges:p>0}}},57109:(G,O,e)=>{"use strict";e.d(O,{o:()=>h});var t=e(74848),n=e(80943),i=e(87978),s=e(8484),r=e(16678),f=e(32023),a=e(74730),c=e(41507),o=e(60656);class h extends n.Bs{constructor(){super(...arguments),this.onClose=()=>{(0,a.YQ)(this).closeModal()},this.onAddLibraryPanel=l=>{const p=(0,a.YQ)(this),m=p.state.body;if(!(m instanceof n.hy))throw new Error("Trying to add a library panel in a layout that is not SceneGridLayout");const y=f.b4.getNextPanelId(p),d=new o.F({title:"Panel Title",uid:l.uid,name:l.name,panelKey:(0,a.XA)(y)}),v=this.state.panelToReplaceRef?.resolve();if(v){const u=v.parent;if(!(u instanceof c.U))throw new Error("Trying to replace a panel that does not have a DashboardGridItem");u.setState({body:d})}else{const u=new c.U({height:a.sw,width:a.vm,x:0,y:0,body:d,key:`grid-item-${y}`});m.setState({children:[u,...m.state.children]})}this.onClose()}}static{this.Component=({model:l})=>{const p=(0,s.t)("library-panel.add-widget.title","Add panel from panel library");return(0,t.jsx)(i._,{title:p,onClose:l.onClose,children:(0,t.jsx)(r.j,{onClick:l.onAddLibraryPanel,variant:r.s.Tight,showPanelFilter:!0})})}}}},91309:(G,O,e)=>{"use strict";e.d(O,{C:()=>E,S:()=>C});var t=e(65474),n=e(81160),i=e(52622),s=e(43585),r=e(14236),f=e(39070),a=e(32264),c=e(80943),o=e(82467),h=e(3169),g=e(10096),l=e(94954),p=e(79938),m=e(49498),y=e(55740),d=e(57220),v=e(23662),u=e(99140),D=e(31678),P=e(94822),x=e(74730);class E extends c.VE{constructor(S){super({isEnabled:!0,...S,isHidden:!0}),this.hasAlertRules=!0,this.topic=i.QR.AlertStates,this.handleError=I=>{const T=(0,h.gi)("AlertStatesDataLayer",(0,l.q)(I));(0,u.JD)((0,o.dx)(T))}}onEnable(){const S=c.jh.getTimeRange(this);this._timeRangeSub=S.subscribeToState(()=>{this.runWithTimeRange(S)})}onDisable(){this._timeRangeSub?.unsubscribe()}runLayer(){const S=c.jh.getTimeRange(this);this.runWithTimeRange(S)}async runWithTimeRange(S){const I=(0,x.YQ)(this),{uid:T,id:b}=I.state;if(this.querySub&&this.querySub.unsubscribe(),!this.canWork(S))return;const R=async()=>{const U=await(0,u.JD)(p.hK.endpoints.prometheusRuleNamespaces.initiate({ruleSourceName:d.hY,dashboardUid:T}));if(U.error)throw new Error("Unexpected alert rules response.");return U.data},L=(0,t.H)(R()).pipe((0,n.T)(U=>(0,m.Kw)(U))).pipe((0,n.T)(U=>{this.hasAlertRules=!1;const W={};return U.forEach(w=>w.rules.forEach(N=>{if((0,v.Z8)(N)&&N.annotations&&N.annotations[y.YH.panelID]){this.hasAlertRules=!0;const B=Number(N.annotations[y.YH.panelID]),V=C(N.state);W[B]?V===s.O.Alerting&&W[B].state!==s.O.Alerting?W[B].state=s.O.Alerting:V===s.O.Pending&&W[B].state!==s.O.Alerting&&W[B].state!==s.O.Pending&&(W[B].state=s.O.Pending):W[B]={state:V,id:Object.keys(W).length,panelId:B,dashboardId:b}}})),Object.values(W)}));this.querySub=L.subscribe({next:U=>{const W=(0,r.Vc)(U);this.publishResults({state:f.Gu.Done,series:[{...W,meta:{...W.meta,dataTopic:i.QR.AlertStates}}],timeRange:S.state.value})},error:U=>{this.handleError(U),this.publishResults({state:f.Gu.Error,series:[],errors:[{message:(0,l.q)(U)}],timeRange:S.state.value})}})}canWork(S){const I=(0,x.YQ)(this),{uid:T}=I.state;return!(!T||a.$.publicDashboardAccessToken||S.state.value.raw.to!=="now"||this.hasAlertRules===!1||!(g.TP.hasPermission(D.AccessControlAction.AlertingRuleRead)&&g.TP.hasPermission(D.AccessControlAction.AlertingRuleExternalRead)))}}function C(M){return M===P.cF.Firing?s.O.Alerting:M===P.cF.Pending?s.O.Pending:s.O.OK}},38477:(G,O,e)=>{"use strict";e.d(O,{g:()=>a});var t=e(43127),n=e(33948),i=e(52622),s=e(32264),r=e(80943),f=e(90569);class a extends r.tV.g{async resolveDataSource(o){return s.$.publicDashboardAccessToken?new f.X:super.resolveDataSource(o)}processEvents(o,h){if(s.$.publicDashboardAccessToken){const g={series:[],timeRange:(0,t.E2)(),state:h.state},l=(0,n.I)(h.events);return l.meta={...l.meta,dataTopic:i.QR.Annotations},g.annotations=[l],g}else return super.processEvents(o,h)}}},33278:(G,O,e)=>{"use strict";e.d(O,{x:()=>D});var t=e(74848),n=e(32196),i=e(12470),s=e(13544),r=e(80943),f=e(40845),a=e(67061),c=e(90613),o=e(32264),h=e(15292);function g({panelEditor:E}){const C=E.state.vizManager,{panel:M,tableView:S}=C.useState(),I=o.$.panels[M.state.pluginId]?.skipDataQuery;return(0,t.jsx)(t.Fragment,{children:!I&&(0,t.jsx)(h.K,{label:"Table view",showLabel:!0,id:"table-view",value:!!S,onClick:()=>C.toggleTableView(),"aria-label":"toggle-table-view","data-testid":s.Tp.components.PanelEditor.toggleTableView})})}var l=e(74730),p=e(80997),m=e(56034),y=e(52424),d=e(6923),v=e(4588);function u({links:E,uid:C}){return!E||!C?null:(0,t.jsx)(t.Fragment,{children:E.map((M,S)=>{const I=(0,d.mQ)().getAnchorInfo(M),T=`${M.title}-$${S}`;if(M.type==="dashboards")return(0,t.jsx)(y.aK,{link:M,linkInfo:I,dashboardUID:C},T);const b=v.G[M.icon],R=(0,t.jsx)(y.Zx,{icon:b,href:(0,p.Jf)(I.href),target:M.targetBlank?"_blank":void 0,rel:"noreferrer","data-testid":s.Tp.components.DashboardLinks.link,children:I.title});return(0,t.jsx)("div",{"data-testid":s.Tp.components.DashboardLinks.container,children:M.tooltip?(0,t.jsx)(m.m,{content:I.tooltip,children:R}):R},T)})})}class D extends r.Bs{constructor(C){super({variableControls:[],timePicker:C.timePicker??new r.KE({}),refreshPicker:C.refreshPicker??new r.WM({}),...C}),this._variableDependency=new r.Sh(this,{onAnyVariableChanged:this._onAnyVariableChanged.bind(this)}),this._urlSync=new r.So(this,{keys:["_dash.hideTimePicker","_dash.hideVariables","_dash.hideLinks"]}),this.addActivationHandler(()=>{let M;return this.state.hideTimeControls&&(M=this.state.refreshPicker.activate()),()=>{M&&M()}})}static{this.Component=P}getUrlState(){return{"_dash.hideTimePicker":this.state.hideTimeControls?"true":void 0,"_dash.hideVariables":this.state.hideVariableControls?"true":void 0,"_dash.hideLinks":this.state.hideLinksControls?"true":void 0}}updateFromUrl(C){const M={};M.hideTimeControls=C["_dash.hideTimePicker"]==="true"||C["_dash.hideTimePicker"]===""||this.state.hideTimeControls,M.hideVariableControls=C["_dash.hideVariables"]==="true"||C["_dash.hideVariables"]===""||this.state.hideVariableControls,M.hideLinksControls=C["_dash.hideLinks"]==="true"||C["_dash.hideLinks"]===""||this.state.hideLinksControls,Object.entries(M).some(([S,I])=>I!==this.state[S])&&this.setState(M)}_onAnyVariableChanged(){(0,l.YQ)(this).state.links?.length>0&&this.forceRender()}hasControls(){const C=r.jh.getVariables(this)?.state.variables.some(R=>R.state.hide!==i.zL.hideVariable),M=r.jh.getDataLayers(this).some(R=>R.state.isEnabled&&!R.state.isHidden),S=(0,l.YQ)(this).state.links?.length>0,I=this.state.hideLinksControls||!S,T=this.state.hideVariableControls||!M&&!C,b=this.state.hideTimeControls;return!(T&&I&&b)}}function P({model:E}){const{variableControls:C,refreshPicker:M,timePicker:S,hideTimeControls:I,hideVariableControls:T,hideLinksControls:b}=E.useState(),R=(0,l.YQ)(E),{links:A,meta:L,editPanel:U}=R.useState(),W=(0,f.of)(x),w=location.search.includes("scene-debugger");return E.hasControls()?(0,t.jsxs)("div",{"data-testid":s.Tp.pages.Dashboard.Controls,className:(0,n.cx)(W.controls,L.isEmbedded&&W.embedded),children:[(0,t.jsxs)(a.B,{grow:1,wrap:"wrap",children:[!T&&C.map(N=>(0,t.jsx)(N.Component,{model:N},N.state.key)),(0,t.jsx)(c.a,{grow:1}),!b&&!U&&(0,t.jsx)(u,{links:A,uid:R.state.uid}),U&&(0,t.jsx)(g,{panelEditor:U})]}),!I&&(0,t.jsxs)(a.B,{justifyContent:"flex-end",children:[(0,t.jsx)(S.Component,{model:S}),(0,t.jsx)(M.Component,{model:M})]}),w&&(0,t.jsx)(r.or,{scene:E},"scene-debugger")]}):null}function x(E){return{controls:(0,n.css)({display:"flex",alignItems:"flex-start",flex:"100%",gap:E.spacing(1),flexDirection:"row",flexWrap:"nowrap",position:"relative",background:E.colors.background.canvas,zIndex:E.zIndex.activePanel,width:"100%",marginLeft:"auto",[E.breakpoints.down("sm")]:{flexDirection:"column-reverse",alignItems:"stretch"},[E.breakpoints.up("sm")]:{position:"sticky",top:0}}),embedded:(0,n.css)({background:"unset",position:"unset"})}}},16279:(G,O,e)=>{"use strict";e.d(O,{s:()=>i});var t=e(74848),n=e(80943);class i extends n.ps{constructor(r){super({...r,name:r.name??"Data layers",annotationLayers:r.annotationLayers??[]}),this.addActivationHandler(()=>this._onActivate())}_onActivate(){return this._subs.add(this.subscribeToState((r,f)=>{r.annotationLayers!==f.annotationLayers&&(this.querySub?.unsubscribe(),this.subscribeToAllLayers(this.getAllLayers()))})),this.subscribeToAllLayers(this.getAllLayers()),()=>{this.querySub?.unsubscribe()}}addAnnotationLayer(r){this.setState({annotationLayers:[...this.state.annotationLayers,r]})}getAllLayers(){const r=[...this.state.annotationLayers];return this.state.alertStatesLayer&&r.push(this.state.alertStatesLayer),r}static{this.Component=({model:r})=>{const{annotationLayers:f}=r.useState();return(0,t.jsx)(t.Fragment,{children:f.map(a=>(0,t.jsx)(a.Component,{model:a},a.state.key))})}}}},39820:(G,O,e)=>{"use strict";e.d(O,{L:()=>r});var t=e(80943),n=e(14348),i=e(74730),s=e(60656);class r extends t.Bs{constructor(a){super(a),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){const a=this.parent;let c,o;if(!(a instanceof t.dt))throw new Error("DashboardDatasourceBehaviour must be attached to a SceneQueryRunner");if(a.state.datasource?.uid!==n.K)return;try{c=(0,i.YQ)(a)}catch{return}const h=a.state.queries.find(d=>d.panelId!==void 0);if(!h)return;const g=h.panelId,l=(0,i.XA)(g),p=(0,i.vL)(c,l);if(!(p instanceof t.Eb))return;const m=(0,i.un)(p);let y;if(m)this.prevRequestId&&this.prevRequestId!==m.state.data?.request?.requestId&&a.runQueries();else if(p.parent instanceof s.F)p.parent.isActive||(y=p.parent.activate()),o=p.parent.subscribeToState((d,v)=>{this.handleLibPanelStateUpdates(d,v,a)});else throw new Error("Could not find SceneQueryRunner for panel");return()=>{this.prevRequestId=m?.state.data?.request?.requestId,o&&o.unsubscribe(),y&&y()}}handleLibPanelStateUpdates(a,c,o){if(a.panel&&a.panel!==c.panel){if(!((0,i.un)(a.panel)instanceof t.dt))throw new Error("Could not find SceneQueryRunner for panel");o.runQueries()}}}},41507:(G,O,e)=>{"use strict";e.d(O,{U:()=>m});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(96540),f=e(32264),a=e(80943),c=e(15054),o=e(74730),h=e(57109),g=e(60656),l=e(7196),p=e(30195);class m extends a.Bs{constructor(u){super(u),this._variableDependency=new a.Sh(this,{variableNames:this.state.variableName?[this.state.variableName]:[],onVariableUpdateCompleted:this._onVariableUpdateCompleted.bind(this)}),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){return this.state.variableName&&(this._subs.add(this.subscribeToState((u,D)=>this._handleGridResize(u,D))),this._performRepeat()),this._subs.add(this.subscribeToState((u,D)=>{u.body!==D.body&&u.body instanceof g.F&&this.setupLibraryPanelChangeSubscription(u.body)})),this.state.body instanceof g.F&&this.setupLibraryPanelChangeSubscription(this.state.body),()=>{this._libPanelSubscription?.unsubscribe(),this._libPanelSubscription=void 0}}setupLibraryPanelChangeSubscription(u){this._libPanelSubscription&&(this._libPanelSubscription.unsubscribe(),this._libPanelSubscription=void 0),this._libPanelSubscription=u.subscribeToState(D=>{D._loadedPanel?.model.repeat&&(this._variableDependency.setVariableNames([D._loadedPanel.model.repeat]),this.setState({variableName:D._loadedPanel.model.repeat,repeatDirection:D._loadedPanel.model.repeatDirection,maxPerRow:D._loadedPanel.model.maxPerRow}),this._performRepeat())})}_onVariableUpdateCompleted(){this.state.variableName&&this._performRepeat()}_handleGridResize(u,D){const P=this.state.repeatedPanels?.length??1,x={};if(u.height!==D.height){if(this.getRepeatDirection()==="v"){const E=Math.ceil(u.height/P);x.itemHeight=E}else{const E=Math.ceil(P/this.getMaxPerRow());x.itemHeight=Math.ceil(u.height/E)}x.itemHeight!==this.state.itemHeight&&this.setState(x)}}_performRepeat(){if(this.state.body instanceof h.o||!this.state.variableName||this._variableDependency.hasDependencyInLoadingState())return;const u=a.jh.lookupVariable(this.state.variableName,this)??new a.yP({name:"_____default_sys_repeat_var_____",options:[],value:"",text:"",query:"A"});if(!(u instanceof a.n8)){console.error("DashboardGridItem: Variable is not a MultiValueVariable");return}const{values:D,texts:P}=(0,o.a7)(u);if((0,i.isEqual)(this._prevRepeatValues,D))return;this._prevRepeatValues=D;const x=this.state.body instanceof g.F?this.state.body.state.panel:this.state.body,E=[];for(let b=0;b<D.length;b++){const R={$variables:new a.Pj({variables:[new a.xc({name:u.state.name,value:D[b],text:String(P[b])})]}),key:`${x.state.key}-clone-${b}`};b>0&&(R.menu=new a.Lw({$behaviors:[l.t0]}));const A=x.clone(R);E.push(A)}const C=this.getRepeatDirection(),M={repeatedPanels:E},S=this.state.itemHeight??10,I=this.state.height,T=this.getMaxPerRow();if(C==="h"){const b=Math.ceil(E.length/T);M.height=b*S}else M.height=E.length*S;if(this.setState(M),I!==this.state.height){const b=a.jh.getLayout(this);b instanceof a.hy&&b.forceRender()}this.publishEvent(new p.d({source:this}),!0)}getMaxPerRow(){return this.state.maxPerRow??4}getRepeatDirection(){return this.state.repeatDirection==="v"?"v":"h"}getClassName(){return this.state.variableName?"panel-repeater-grid-item":""}isRepeated(){return this.state.variableName!==void 0}static{this.Component=({model:u})=>{const{repeatedPanels:D,itemHeight:P,variableName:x,body:E}=u.useState(),C=D?.length??0,M=y(u.getRepeatDirection(),C,u.getMaxPerRow(),P??10);if(!x){if(E instanceof a.Eb)return(0,t.jsx)(E.Component,{model:E},E.state.key);if(E instanceof g.F)return(0,t.jsx)(E.Component,{model:E},E.state.key);if(E instanceof h.o)return(0,t.jsx)(E.Component,{model:E},E.state.key)}return D?(0,t.jsx)("div",{className:M,children:D.map(S=>(0,t.jsx)("div",{className:d,children:(0,t.jsx)(S.Component,{model:S},S.state.key)},S.state.key))}):null}}}function y(v,u,D,P){return(0,r.useMemo)(()=>{const x=f.$.theme2,E=P*c.sD*u+(u-1)*c.dU;if(v==="h"){const C=Math.ceil(u/D),M=Math.min(u,D);return(0,n.css)({display:"grid",height:"100%",width:"100%",gridTemplateColumns:`repeat(${M}, 1fr)`,gridTemplateRows:`repeat(${C}, 1fr)`,gridColumnGap:x.spacing(1),gridRowGap:x.spacing(1),[x.breakpoints.down("md")]:{display:"flex",flexDirection:"column",height:E}})}return(0,n.css)({display:"flex",height:"100%",width:"100%",flexDirection:"column",gap:x.spacing(1),[x.breakpoints.down("md")]:{height:E}})},[v,u,D,P])}const d=(0,n.css)({display:"flex",flexGrow:1,position:"relative"})},34842:(G,O,e)=>{"use strict";e.d(O,{H$:()=>Ds,vk:()=>ws});var t=e(71733),n=e(26272),i=e(41987),s=e(32264),r=e(12131),f=e(80943),a=e(28138),c=e(15054),o=e(17422),h=e(33390),g=e(14792),l=e(34214),p=e(6473),m=e(11230),y=e(80484),d=e(28444),v=e(13530),u=e(74848),D=e(63021),P=e(40675),x=e(87978),E=e(54943),C=e(76459),M=e.n(C),S=e(49785),I=e(13544),T=e(55852),b=e(42418),R=e(67061),A=e(88575),L=e(10354),U=e(21744),W=e(15292),w=e(90613),N=e(60029),B=e(36607),V=e(71500),K=e(17172);function H(Ge){return(0,K.NF)(Ge)&&Ge.data&&Ge.data.status==="version-mismatch"}function X(Ge){return(0,K.NF)(Ge)&&Ge.data&&Ge.data.status==="name-exists"}function k(Ge){return(0,K.NF)(Ge)&&Ge.data&&Ge.data.status==="plugin-dashboard"}function Y({cancelButton:Ge,saveButton:Le}){return(0,u.jsxs)(b.F,{title:"Name already exists",severity:"error",children:[(0,u.jsx)("p",{children:"A dashboard with the same name in selected folder already exists. Would you still like to save this dashboard?"}),(0,u.jsx)(w.a,{paddingTop:2,children:(0,u.jsxs)(R.B,{alignItems:"center",children:[Ge,Le(!0)]})})]})}function Z({overwrite:Ge,isLoading:Le,isValid:_e,onSave:nt}){return(0,u.jsx)(T.$n,{disabled:!_e||Le,icon:Le?"spinner":void 0,onClick:()=>nt(Ge),variant:Ge?"destructive":"primary","data-testid":I.Tp.components.Drawer.DashboardSaveDrawer.saveButton,children:Le?"Saving...":Ge?"Save and overwrite":"Save"})}var se=e(41053),j=e(14110),q=e(3169),ne=e(91219),oe=e(55314),z=e(31678),te=e(36974);function le(Ge=!1){const Le=(0,z.useDispatch)(),_e=(0,q._2)(),[nt]=(0,oe.e8)(),[At,kt]=(0,se.A)(async(qt,gn,Bn)=>{{const xn=await nt({dashboard:gn,folderUid:Bn.folderUid,message:Bn.message,overwrite:Bn.overwrite,showErrorAlert:!1,k8s:void 0});if("error"in xn)throw xn.error;const gs=xn.data;qt.saveCompleted(gn,gs,Bn.folderUid),a.A.publish(new d.Eu),_e.success("Dashboard saved"),(0,te.ko)(gs.uid),Ge?(0,j.rR)("grafana_dashboard_copied",{name:gn.title,url:gs.url}):(0,j.rR)(`grafana_dashboard_${gs.uid?"saved":"created"}`,{name:gn.title,url:gs.url});const as=r.Ny.getLocation(),$s=t.I.stripBaseFromUrl(gs.url);return $s!==as.pathname&&setTimeout(()=>{r.Ny.push({pathname:$s,search:as.search})}),qt.state.meta.isStarred&&Le((0,ne.TU)({id:gs.uid,title:qt.state.title,url:$s})),xn.data}},[Le,_e]);return{state:At,onSaveDashboard:kt}}function ie({dashboard:Ge,changeInfo:Le}){const{changedSaveModel:_e}=Le,{register:nt,handleSubmit:At,setValue:kt,formState:qt,getValues:gn,watch:Bn}=(0,S.mN)({mode:"onBlur",defaultValues:{title:Le.isNew?_e.title:`${_e.title} Copy`,description:_e.description??"",folder:{uid:Ge.state.meta.folderUid,title:Ge.state.meta.folderTitle},copyTags:!1}}),{errors:xn,isValid:gs,defaultValues:as}=qt,$s=Bn(),{state:Us,onSaveDashboard:Ta}=le(!1),Xs=async Ua=>{const va=gn(),lr=me(_e,va,Le.isNew);(await Ta(Ge,lr,{overwrite:Ua,folderUid:va.folder.uid})).status==="success"&&Ge.closeModal()},fa=(0,u.jsx)(T.$n,{variant:"secondary",onClick:()=>Ge.closeModal(),fill:"outline",children:"Cancel"}),ma=Ua=>(0,u.jsx)(Z,{isValid:gs,isLoading:Us.loading,onSave:Xs,overwrite:Ua});function Ma(Ua){return X(Ua)?(0,u.jsx)(Y,{cancelButton:fa,saveButton:ma}):(0,u.jsxs)(u.Fragment,{children:[Ua&&(0,u.jsx)(b.F,{title:"Failed to save dashboard",severity:"error",children:(0,u.jsx)("p",{children:Ua.message})}),(0,u.jsxs)(R.B,{alignItems:"center",children:[fa,ma(!1)]})]})}return(0,u.jsxs)("form",{onSubmit:At(()=>Xs(!1)),children:[(0,u.jsx)(A.D,{label:(0,u.jsx)(ae,{dashboard:_e,onChange:kt}),invalid:!!xn.title,error:xn.title?.message,children:(0,u.jsx)(L.p,{...nt("title",{required:"Required",validate:ce}),"aria-label":"Save dashboard title field","data-testid":I.Tp.components.Drawer.DashboardSaveDrawer.saveAsTitleInput,onChange:M()(async Ua=>{kt("title",Ua.target.value,{shouldValidate:!0})},400)})}),(0,u.jsx)(A.D,{label:(0,u.jsx)(re,{dashboard:_e,onChange:kt}),invalid:!!xn.description,error:xn.description?.message,children:(0,u.jsx)(U.f,{...nt("description",{required:!1}),"aria-label":"Save dashboard description field",autoFocus:!0})}),(0,u.jsx)(A.D,{label:"Folder",children:(0,u.jsx)(B.d,{onChange:(Ua,va)=>kt("folder",{uid:Ua,title:va}),value:$s.folder?.uid,initialTitle:as.folder.title,dashboardId:_e.id??void 0,enableCreateNew:!0})}),!Le.isNew&&(0,u.jsx)(A.D,{label:"Copy tags",children:(0,u.jsx)(W.d,{...nt("copyTags")})}),(0,u.jsx)(w.a,{paddingTop:2,children:Ma(Us.error)})]})}function ae(Ge){return(0,u.jsx)(R.B,{justifyContent:"space-between",children:(0,u.jsx)(N.J,{htmlFor:"description",children:"Title"})})}function re(Ge){return(0,u.jsx)(R.B,{justifyContent:"space-between",children:(0,u.jsx)(N.J,{htmlFor:"description",children:"Description"})})}async function ce(Ge,Le){if(Ge===Le.folder.title?.trim())return"Dashboard name cannot be the same as folder name";try{return await V.P.validateNewDashboardName(Le.folder.uid??"general",Ge),!0}catch(_e){return _e instanceof Error?_e.message:"Dashboard name is invalid"}}function me(Ge,Le,_e){return{...Ge,id:null,uid:"",title:Le.title,description:Le.description,tags:_e||Le.copyTags?Ge.tags:[]}}var ee=e(96540),de=e(10880);function De({dashboard:Ge,drawer:Le,changeInfo:_e}){const{changedSaveModel:nt,hasChanges:At}=_e,{state:kt,onSaveDashboard:qt}=le(!1),[gn,Bn]=(0,ee.useState)({folderUid:Ge.state.meta.folderUid}),xn=async Us=>{(await qt(Ge,nt,{...gn,overwrite:Us})).status==="success"&&(Ge.closeModal(),Le.state.onSaveSuccess?.())},gs=(0,u.jsx)(T.$n,{variant:"secondary",onClick:()=>Ge.closeModal(),fill:"outline",children:"Cancel"}),as=Us=>(0,u.jsx)(Z,{isValid:At,isLoading:kt.loading,onSave:xn,overwrite:Us});function $s(Us){return H(Us)?(0,u.jsxs)(b.F,{title:"Someone else has updated this dashboard",severity:"error",children:[(0,u.jsx)("p",{children:"Would you still like to save this dashboard?"}),(0,u.jsx)(w.a,{paddingTop:2,children:(0,u.jsxs)(R.B,{alignItems:"center",children:[gs,as(!0)]})})]}):X(Us)?(0,u.jsx)(Y,{cancelButton:gs,saveButton:as}):k(Us)?(0,u.jsxs)(b.F,{title:"Plugin dashboard",severity:"error",children:[(0,u.jsxs)("p",{children:["Your changes will be lost when you update the plugin. Use ",(0,u.jsx)("strong",{children:"Save As"})," to create custom version."]}),(0,u.jsx)(w.a,{paddingTop:2,children:(0,u.jsxs)(R.B,{alignItems:"center",children:[gs,as(!0)]})})]}):(0,u.jsxs)(u.Fragment,{children:[Us&&(0,u.jsx)(b.F,{title:"Failed to save dashboard",severity:"error",children:(0,u.jsx)("p",{children:Us.message})}),(0,u.jsxs)(R.B,{alignItems:"center",children:[gs,as(!1),!At&&(0,u.jsx)("div",{children:"No changes to save"})]})]})}return(0,u.jsxs)(R.B,{gap:2,direction:"column",children:[(0,u.jsx)(fe,{drawer:Le,changeInfo:_e}),(0,u.jsx)(A.D,{label:"Message",children:(0,u.jsx)(U.f,{"aria-label":"message",value:gn.message??"",onChange:Us=>{Bn({...gn,message:Us.currentTarget.value})},placeholder:"Add a note to describe your changes (optional).",autoFocus:!0,rows:5})}),$s(kt.error)]})}function fe({drawer:Ge,changeInfo:Le}){const{saveVariables:_e=!1,saveTimeRange:nt=!1,saveRefresh:At=!1}=Ge.useState(),{hasTimeChanges:kt,hasVariableValueChanges:qt,hasRefreshChange:gn}=Le;return(0,u.jsxs)(R.B,{direction:"column",alignItems:"flex-start",children:[kt&&(0,u.jsx)(de.S,{id:"save-timerange",checked:nt,onChange:Ge.onToggleSaveTimeRange,label:"Update default time range",description:"Will make current time range the new default","data-testid":I.Tp.pages.SaveDashboardModal.saveTimerange}),gn&&(0,u.jsx)(de.S,{id:"save-refresh",label:"Update default refresh value",description:"Will make the current refresh the new default",checked:At,onChange:Ge.onToggleSaveRefresh,"data-testid":I.Tp.pages.SaveDashboardModal.saveRefresh}),qt&&(0,u.jsx)(de.S,{id:"save-variables",label:"Update default variable values",description:"Will make the current values the new default",checked:_e,onChange:Ge.onToggleSaveVariables,"data-testid":I.Tp.pages.SaveDashboardModal.saveVariables})]})}var Te=e(32196),je=e(4213),He=e.n(je),Be=e(70713),Ne=e(32372),Re=e(10534);function Se({dashboard:Ge,drawer:Le,changeInfo:_e}){const nt=(0,ee.useMemo)(()=>JSON.stringify(_e.changedSaveModel,null,2),[_e]),At=(0,ee.useCallback)(()=>{const kt=new Blob([nt],{type:"application/json;charset=utf-8"});(0,je.saveAs)(kt,_e.changedSaveModel.title+"-"+new Date().getTime()+".json")},[_e.changedSaveModel,nt]);return(0,u.jsx)("div",{className:We.container,children:(0,u.jsxs)(R.B,{direction:"column",gap:2,grow:1,children:[(0,u.jsxs)("div",{children:["This dashboard cannot be saved from the Grafana UI because it has been provisioned from another source. Copy the JSON or save it to a file below, then you can update your dashboard in the provisioning source.",(0,u.jsx)("br",{}),(0,u.jsxs)("i",{children:["See"," ",(0,u.jsx)("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",target:"_blank",rel:"noreferrer",children:"documentation"})," ","for more information about provisioning."]}),(0,u.jsx)("br",{})," ",(0,u.jsx)("br",{}),(0,u.jsx)("strong",{children:"File path: "})," ",Ge.state.meta.provisionedExternalId]}),(0,u.jsx)(fe,{drawer:Le,changeInfo:_e}),(0,u.jsx)("div",{className:We.json,children:(0,u.jsx)(Be.Ay,{disableWidth:!0,children:({height:kt})=>(0,u.jsx)(Ne.B,{width:"100%",height:kt,language:"json",showLineNumbers:!0,showMiniMap:nt.length>100,value:nt,readOnly:!0})})}),(0,u.jsx)(w.a,{paddingTop:2,children:(0,u.jsxs)(R.B,{gap:2,children:[(0,u.jsx)(T.$n,{variant:"secondary",onClick:Le.onClose,fill:"outline",children:"Cancel"}),(0,u.jsx)(Re.b,{icon:"copy",getText:()=>nt,children:"Copy JSON to clipboard"}),(0,u.jsx)(T.$n,{type:"submit",onClick:At,children:"Save JSON to file"})]})})]})})}const We={container:(0,Te.css)({height:"100%",display:"flex"}),json:(0,Te.css)({flexGrow:1,maxHeight:"800px"})};var Ke=e(20455),Xe=e(45429);function Je(Ge,Le,_e,nt){const At=(0,Xe.Yy)(Ge.getInitialSaveModel(),(0,Ke.Uy)(Ge),Le,_e,nt),kt=Ge.getInitialState()?.meta.folderUid!==Ge.state.meta.folderUid;return{...At,hasFolderChanges:kt,hasChanges:At.hasChanges||kt}}class st extends f.Bs{constructor(){super(...arguments),this.onClose=()=>{this.state.dashboardRef.resolve().setState({overlay:void 0})},this.onToggleSaveTimeRange=()=>{this.setState({saveTimeRange:!this.state.saveTimeRange})},this.onToggleSaveVariables=()=>{this.setState({saveVariables:!this.state.saveVariables})},this.onToggleSaveRefresh=()=>{this.setState({saveRefresh:!this.state.saveRefresh})}}static{this.Component=({model:Le})=>{const{showDiff:_e,saveAsCopy:nt,saveTimeRange:At,saveVariables:kt,saveRefresh:qt}=Le.useState(),gn=Je(Le.state.dashboardRef.resolve(),At,kt,qt),{changedSaveModel:Bn,initialSaveModel:xn,diffs:gs,diffCount:as,hasFolderChanges:$s}=gn,Us=as+($s?1:0),Ta=Le.state.dashboardRef.resolve(),{meta:Xs}=Ta.useState(),{provisioned:fa,folderTitle:ma}=Xs,Ma=(0,u.jsxs)(D.U,{children:[(0,u.jsx)(P.o,{label:"Details",active:!_e,onChangeTab:()=>Le.setState({showDiff:!1})}),Us>0&&(0,u.jsx)(P.o,{label:"Changes",active:_e,onChangeTab:()=>Le.setState({showDiff:!0}),counter:Us})]});let Ua="Save dashboard";nt?Ua="Save dashboard copy":fa&&(Ua="Provisioned dashboard");const va=()=>_e?(0,u.jsx)(E.l,{diff:gs,oldValue:xn,newValue:Bn,hasFolderChanges:$s,oldFolder:Ta.getInitialState()?.meta.folderTitle,newFolder:ma}):nt||gn.isNew?(0,u.jsx)(ie,{dashboard:Ta,changeInfo:gn}):fa?(0,u.jsx)(Se,{dashboard:Ta,changeInfo:gn,drawer:Le}):(0,u.jsx)(De,{dashboard:Ta,changeInfo:gn,drawer:Le});return(0,u.jsx)(x._,{title:Ua,subtitle:Ta.state.title,onClose:Le.onClose,tabs:Ma,children:va()})}}}var pt=e(85445),xt=e(57714),ot=e(64423),$e=e(18226),ve=e(94624),be=e(72724),he=e(3591),ye=e(41507),Pe=e(13989),ge=e(53543),xe=e(74730);class Ae{constructor(Le){this._scene=Le,this.events=new $e.o,this._subs=new ot.yU;const _e=f.jh.getTimeRange(Le);this.formatDate=this.formatDate.bind(this),this._subs.add(_e.subscribeToState((nt,At)=>{nt.value!==At.value&&this.events.publish(new he.sR(nt.value))}))}get id(){return this._scene.state.id??null}get uid(){return this._scene.state.uid??null}get title(){return this._scene.state.title}get description(){return this._scene.state.description}get editable(){return this._scene.state.editable}get graphTooltip(){return this._getSyncMode()}get timepicker(){return{refresh_intervals:this._scene.state.controls.state.refreshPicker.state.intervals,hidden:this._scene.state.controls.state.hideTimeControls??!1}}get timezone(){return this.getTimezone()}get weekStart(){return f.jh.getTimeRange(this._scene).state.weekStart}get tags(){return this._scene.state.tags}get links(){return this._scene.state.links}get meta(){return this._scene.state.meta}get time(){const Le=f.jh.getTimeRange(this._scene);return{from:Le.state.from,to:Le.state.to}}get panels(){return Ee(this._scene,_e=>_e instanceof f.Eb).map(_e=>new ge.R(_e))}get annotations(){const Le={list:[]};return this._scene.state.$data instanceof f.kh&&(Le.list=(0,Pe.O)(this._scene.state.$data.state.layers)),Le}getTimezone(){return f.jh.getTimeRange(this._scene).getTimeZone()}sharedTooltipModeEnabled(){return this._getSyncMode()>0}sharedCrosshairModeOnly(){return this._getSyncMode()===1}_getSyncMode(){if(this._scene.state.$behaviors){for(const Le of this._scene.state.$behaviors)if(Le instanceof f.Gg.K2)return Le.state.sync}return ve.y.Off}otherPanelInFullscreen(Le){return!1}formatDate(Le,_e){return(0,be.LE)(Le,{format:_e,timeZone:this.getTimezone()})}getPanelById(Le){const _e=(0,xe.vL)(this._scene,(0,xe.XA)(Le));return _e?new ge.R(_e):null}removePanel(Le){const _e=(0,xe.vL)(this._scene,(0,xe.XA)(Le.id));if(!_e){console.error("Trying to remove a panel that was not found in scene",Le);return}const nt=_e.parent;if(!(nt instanceof ye.U)){console.error("Trying to remove a panel that is not wrapped in DashboardGridItem");return}const At=f.jh.getLayout(_e);if(!(At instanceof f.hy)){console.error("Trying to remove a panel in a layout that is not SceneGridLayout ");return}if(At===nt.parent&&At.setState({children:At.state.children.filter(kt=>kt!==nt)}),nt.parent instanceof f.tI){const kt=At.clone({children:At.state.children.filter(qt=>qt!==nt)});At.parent instanceof f.hy&&At.parent.setState({children:At.parent.state.children.map(qt=>qt===At?kt:qt)})}}canEditAnnotations(Le){return this._scene.canEditDashboard()?Le?!!this._scene.state.meta.annotationsPermissions?.dashboard.canEdit:!!this._scene.state.meta.annotationsPermissions?.organization.canEdit:!1}panelInitialized(){}destroy(){this.events.removeAllListeners(),this._subs.unsubscribe()}hasUnsavedChanges(){return this._scene.state.isDirty}}function Ee(Ge,Le){let _e=[];return Ge.forEachChild(nt=>{Le(nt)?_e.push(nt):_e=_e.concat(Ee(nt,Le))}),_e}var Ie=e(32023);function Qe(Ge){let Le=5381;for(let _e=0;_e<Ge.length;_e++)Le=Le*33^Ge.charCodeAt(_e);return Le>>>0}var at=e(11982),ft=e(57109),ct=e(24180),vt=e(49045),Pt=e(64388),Vt=e(40845),Jt=e(40276),wt=e(69444),zt=e(7392),on=e(68064),Pn=e(47150);function _n({model:Ge}){const{controls:Le,overlay:_e,editview:nt,editPanel:At,isEmpty:kt,scopes:qt,meta:gn}=Ge.useState(),{isExpanded:Bn}=qt?.useState()??{},xn=(0,Vt.of)(Cn),gs=(0,ct.zy)(),as=(0,z.useSelector)(va=>va.navIndex),$s=Ge.getPageNav(gs,as),Us=Ge.getBodyToRender(),Ta=(0,o.tc)(as,"dashboards/browse"),Xs=Le?.hasControls();if(nt)return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(nt.Component,{model:nt}),_e&&(0,u.jsx)(_e.Component,{model:_e})]});const fa=(0,u.jsx)(on.A,{dashboard:Ge,canCreate:!!Ge.state.meta.canEdit},"dashboard-empty-state"),ma=(0,u.jsx)("div",{className:(0,Te.cx)(xn.body,!Xs&&xn.bodyWithoutControls),children:(0,u.jsx)(Us.Component,{model:Us})},"dashboard-panels"),Ma=gn.dashboardNotFound&&(0,u.jsx)(zt.L,{entity:"Dashboard"},"dashboard-not-found");let Ua=[ma];return Ma?Ua=[Ma]:kt&&(Ua=[fa,ma]),(0,u.jsxs)(wt.Y,{navModel:Ta,pageNav:$s,layout:Pt.k.Custom,children:[At&&(0,u.jsx)(At.Component,{model:At}),!At&&(0,u.jsxs)("div",{className:(0,Te.cx)(xn.pageContainer,Xs&&!qt&&xn.pageContainerWithControls,qt&&xn.pageContainerWithScopes,qt&&Bn&&xn.pageContainerWithScopesExpanded),children:[qt&&!gn.dashboardNotFound&&(0,u.jsx)(qt.Component,{model:qt}),(0,u.jsx)(Pn.c,{dashboard:Ge}),Le&&(0,u.jsx)("div",{className:(0,Te.cx)(xn.controlsWrapper,qt&&!Bn&&xn.controlsWrapperWithScopes),children:(0,u.jsx)(Le.Component,{model:Le})}),(0,u.jsx)(Ye,{id:"page-scrollbar",className:xn.panelsContainer,testId:I.Tp.pages.Dashboard.DashNav.scrollContainer,children:(0,u.jsx)("div",{className:(0,Te.cx)(xn.canvasContent),children:Ua})})]}),_e&&(0,u.jsx)(_e.Component,{model:_e})]})}function Cn(Ge){return{pageContainer:(0,Te.css)({display:"grid",gridTemplateAreas:`
        "panels"`,gridTemplateColumns:"1fr",gridTemplateRows:"1fr",height:"100%",[Ge.breakpoints.down("sm")]:{display:"flex",flexDirection:"column"}}),pageContainerWithControls:(0,Te.css)({gridTemplateAreas:`
        "controls"
        "panels"`,gridTemplateRows:"auto 1fr"}),pageContainerWithScopes:(0,Te.css)({gridTemplateAreas:`
        "scopes controls"
        "panels panels"`,gridTemplateColumns:`${Ge.spacing(32)} 1fr`,gridTemplateRows:"auto 1fr"}),pageContainerWithScopesExpanded:(0,Te.css)({gridTemplateAreas:`
        "scopes controls"
        "scopes panels"`}),panelsContainer:(0,Te.css)({gridArea:"panels"}),controlsWrapper:(0,Te.css)({display:"flex",flexDirection:"column",flexGrow:0,gridArea:"controls",padding:Ge.spacing(2),":empty":{display:"none"}}),controlsWrapperWithScopes:(0,Te.css)({padding:Ge.spacing(2,2,2,0)}),canvasContent:(0,Te.css)({label:"canvas-content",display:"flex",flexDirection:"column",padding:Ge.spacing(0,2),flexBasis:"100%",flexGrow:1}),body:(0,Te.css)({label:"body",flexGrow:1,display:"flex",gap:"8px",paddingBottom:Ge.spacing(2),boxSizing:"border-box"}),bodyWithoutControls:(0,Te.css)({paddingTop:Ge.spacing(2)})}}const Ye=({id:Ge,children:Le,className:_e,testId:nt})=>{const At=(0,Vt.$j)(),kt=(0,vt.A)(`(max-width: ${At.breakpoints.values.sm}px)`),qt=(0,Vt.of)(()=>({nonScrollable:(0,Te.css)({height:"100%",display:"flex",flexDirection:"column"})}));return kt?(0,u.jsx)("div",{id:Ge,className:(0,Te.cx)(_e,qt.nonScrollable),"data-testid":nt,children:Le}):(0,u.jsx)(Jt.E,{divId:Ge,autoHeightMin:"100%",className:_e,testId:nt,children:Le})};var Dt=e(65123),yt=e(54612),Ft=e(16560),an=e(29678),un=e(14578),hn=e(62930),Un=e(90182),Nn=e(16233),St=e(83195),nn=e(2619),ht=e(2543),lt=e(89667),gt=e(52622),$t=e(39070),et=e(68706),Et=e(60656),It=e(41524);function Qt(Ge){const Le=[];if(Ge?.series)for(const _e of Ge.series)Le.push((0,lt.Nw)(_e));if(Ge?.annotations)for(const _e of Ge.annotations){const nt=(0,lt.Nw)(_e);nt.schema?.meta||(nt.schema.meta={}),nt.schema.meta.dataTopic=gt.QR.Annotations,Le.push(nt)}return Le}function sn(Ge,Le){const _e={panelType:Ge.state.pluginId,datasource:"??"},nt=s.$.buildInfo.versionString;let At=`| Key | Value |
|--|--|
| Panel | ${_e.panelType} @ ${Ge.state.pluginVersion??nt} |
| Grafana | ${nt} // ${s.$.buildInfo.edition} |
`;return Le&&(At+="<details><summary>Panel debug snapshot dashboard</summary>\n\n```json\n"+Le+"\n```\n</details>"),At}async function ln(Ge,Le,_e){let nt={type:""};const At=Ge.parent instanceof Et.F,kt=At?Ge.parent.parent:Ge.parent,qt=Ge.getRoot();if(At)nt={...(0,Ke.ZB)(kt),...(0,Ke.Z6)(Ge)};else if(qt.state.editPanel){const ma=qt.state.editPanel.state.vizManager.state.sourcePanel.resolve(),Ma=ma.parent instanceof Et.F?ma.parent.parent:ma.parent;Ma instanceof ye.U&&(nt={...(0,Ke.ZB)(Ma),...(0,Ke.Z6)(qt.state.editPanel.state.vizManager.state.panel.clone())})}else nt=(0,Ke.ZB)(kt);const gn=(0,ht.cloneDeep)(wn),Bn={panelType:Ge.state.pluginId,datasource:"??"},xn=(0,xe.un)(Ge);if(!xn.state.data)return;const gs=xn.state.data,as=xn?.state.datasource,$s=(0,It.W)(Qt(gs),Le),Us=s.$.buildInfo.versionString,Ta=xn.state.queries??[],Xs=gs.annotations?gs.annotations.reduce((ma,Ma)=>Ma.length+ma,0):0,fa=`<table width="100%">
    <tr>
      <th width="2%">Panel</th>
      <td >${Bn.panelType} @ ${nt.pluginVersion??Us}</td>
    </tr>
    <tr>
      <th>Queries</th>
      <td>${Ta.map(ma=>{const Ma=ma.datasource??as;return`${ma.refId}[${Ma?.type}]`}).join(", ")}</td>
    </tr>
    ${yn(nt)}
    ${Sn(gs,$s)}
    ${En(gs)}
    <tr>
      <th>Grafana</th>
      <td>${Us} // ${s.$.buildInfo.edition}</td>
    </tr>
  </table>`.trim();if(gn.panels[0]={...nt,...gn.panels[0],targets:[{refId:"A",datasource:{type:"grafana",uid:"grafana"},queryType:et.nj.Snapshot,snapshot:$s}]},delete gn.panels[0].libraryPanel,nt.transformations?.length){const ma=gn.panels[gn.panels.length-1];ma.title=ma.title+" (after transformations)";const Ma=(0,ht.cloneDeep)(ma);Ma.id=100,Ma.title="Data (before transformations)",Ma.gridPos.w=24,Ma.targets[0].withTransforms=!1,gn.panels.push(Ma)}return Xs>0&&gn.panels.push({id:7,gridPos:{h:6,w:24,x:0,y:20},type:"table",title:"Annotations",datasource:{type:"datasource",uid:"-- Dashboard --"},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,topic:gt.QR.Annotations,refId:"A"}]}),gn.panels[1].options.content=fa,gn.panels[2].options.content=JSON.stringify(nt,null,2),gn.title=`Debug: ${nt.title} // ${(0,be.LE)(new Date)}`,gn.tags=["debug",`debug-${Bn.panelType}`],gn.time={from:_e.from.toISOString(),to:_e.to.toISOString()},gn}function yn(Ge){return Ge.transformations?`<tr>
      <th>Transform</th>
      <td>${Ge.transformations.map(Le=>Le.id).join(", ")}</td>
  </tr>`:""}function Sn(Ge,Le){let _e=Ge.series.length??0,nt=0,At=0;for(const kt of Ge.series)nt+=kt.fields.length,At+=kt.length;return`<tr><th>Data</th><td>${Ge.state!==$t.Gu.Done?Ge.state:""} ${_e} frames, ${nt} fields, ${At} rows </td></tr>`}function En(Ge){return Ge.annotations?.length?`<tr>
  <th>Annotations</th>
  <td>${Ge.annotations.reduce((Le,_e)=>_e.length+Le,0)}</td>
</tr>`:""}const wn={panels:[{id:2,title:"Reproduced with embedded data",datasource:{type:"grafana",uid:"grafana"},gridPos:{h:13,w:15,x:0,y:0}},{gridPos:{h:7,w:9,x:15,y:0},id:5,options:{content:"...",mode:"html"},title:"Debug info",type:"text"},{id:6,title:"Original Panel JSON",type:"text",gridPos:{h:13,w:9,x:15,y:7},options:{content:"...",mode:"code",code:{language:"json",showLineNumbers:!0,showMiniMap:!0}}},{id:3,title:"Data from panel above",type:"table",datasource:{type:"datasource",uid:"-- Dashboard --"},gridPos:{h:7,w:15,x:0,y:13},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,refId:"A"}]}],schemaVersion:37};var On=(Ge=>(Ge[Ge.Support=0]="Support",Ge[Ge.Data=1]="Data",Ge))(On||{}),Rt=(Ge=>(Ge[Ge.PanelSnapshot=0]="PanelSnapshot",Ge[Ge.GithubComment=1]="GithubComment",Ge))(Rt||{});class Ot extends nn.Q{constructor(Le){super({panel:Le,panelTitle:f.jh.interpolate(Le,Le.state.title,{},"text"),currentTab:0,showMessage:1,snapshotText:"",markdownText:"",randomize:{},snapshotUpdate:0,options:[{label:"GitHub comment",description:"Copy and paste this message into a GitHub issue or comment",value:1},{label:"Panel support snapshot",description:"Dashboard JSON used to help troubleshoot visualization issues",value:0}]}),this.onCurrentTabChange=_e=>{this.setState({currentTab:_e})},this.onShowMessageChange=_e=>{this.setState({showMessage:_e.value})},this.onGetMarkdownForClipboard=()=>{const{markdownText:_e}=this.state,nt=Math.pow(1024,2)*1.5;return _e.length>nt?(this.setState({error:{title:"Copy to clipboard failed",message:"Snapshot is too large, consider download and attaching a file instead"}}),""):_e},this.onDownloadDashboard=()=>{const{snapshotText:_e,panelTitle:nt}=this.state,At=new Blob([_e],{type:"text/plain"}),kt=`debug-${nt}-${(0,be.LE)(new Date)}.json.txt`;He()(At,kt)},this.onSetSnapshotText=_e=>{this.setState({snapshotText:_e})},this.onToggleRandomize=_e=>{const{randomize:nt}=this.state;this.setState({randomize:{...nt,[_e]:!nt[_e]}})}}async buildDebugDashboard(){const{panel:Le,randomize:_e,snapshotUpdate:nt}=this.state,At=await ln(Le,_e,f.jh.getTimeRange(Le).state.value),kt=JSON.stringify(At,null,2),qt=sn(Le,kt),gn=(0,St.cN)((0,St.j_)("bytes")(kt?.length??0));let Bn;if(At)try{Bn=(0,pt.wM)({dashboard:At,meta:{isEmbedded:!0}}).state.body}catch(xn){console.log("Error creating scene:",xn)}this.setState({snapshot:At,snapshotText:kt,markdownText:qt,snapshotSize:gn,snapshotUpdate:nt+1,scene:Bn})}}function jt({panel:Ge,onClose:Le}){const _e=(0,Vt.of)(rt),nt=(0,ee.useMemo)(()=>new Ot(Ge),[Ge]),At=Ge.getPlugin(),{currentTab:kt,loading:qt,error:gn,options:Bn,showMessage:xn,snapshotSize:gs,markdownText:as,snapshotText:$s,randomize:Us,panelTitle:Ta,scene:Xs}=nt.useState();if((0,ee.useEffect)(()=>{nt.buildDebugDashboard()},[nt,At,Us]),!At)return null;const fa=[{label:"Snapshot",value:On.Support},{label:"Data",value:On.Data}],ma=s.$.supportBundlesEnabled&&Nn.TP.hasPermission(z.AccessControlAction.ActionSupportBundlesCreate);return(0,u.jsxs)(x._,{title:"Get help with this panel",size:"lg",onClose:Le,subtitle:(0,u.jsxs)(R.B,{direction:"column",gap:1,children:[(0,u.jsxs)(R.B,{direction:"row",gap:1,children:[(0,u.jsx)(an.y,{featureState:i.Ay.beta}),(0,u.jsxs)("a",{href:"https://grafana.com/docs/grafana/latest/troubleshooting/",target:"blank",className:"external-link",rel:"noopener noreferrer",children:["Troubleshooting docs ",(0,u.jsx)(un.I,{name:"external-link-alt"})]})]}),(0,u.jsx)("span",{className:"muted",children:"To request troubleshooting help, send a snapshot of this panel to Grafana Labs Technical Support. The snapshot contains query response data and panel settings."}),ma&&(0,u.jsxs)("span",{className:"muted",children:["You can also retrieve a support bundle containing information concerning your Grafana instance and configured datasources in the ",(0,u.jsx)("a",{href:"/support-bundles",children:"support bundles section"}),"."]})]}),tabs:(0,u.jsx)(D.U,{children:fa.map((Ma,Ua)=>(0,u.jsx)(P.o,{label:Ma.label,active:Ma.value===kt,onChangeTab:()=>nt.onCurrentTabChange(Ma.value)},`${Ma.value}-${Ua}`))}),children:[qt&&(0,u.jsx)(hn.y,{}),gn&&(0,u.jsx)(b.F,{title:gn.title,children:gn.message}),kt===On.Data&&(0,u.jsxs)("div",{className:_e.code,children:[(0,u.jsxs)("div",{className:_e.opts,children:[(0,u.jsx)(A.D,{label:"Template",className:_e.field,children:(0,u.jsx)(Un.l6,{options:Bn,value:xn,onChange:nt.onShowMessageChange})}),xn===Rt.GithubComment?(0,u.jsx)(Re.b,{icon:"copy",getText:nt.onGetMarkdownForClipboard,children:"Copy to clipboard"}):(0,u.jsxs)(T.$n,{icon:"download-alt",onClick:nt.onDownloadDashboard,children:["Download (",gs,")"]})]}),(0,u.jsx)(Be.Ay,{disableWidth:!0,children:({height:Ma})=>(0,u.jsx)(Ne.B,{width:"100%",height:Ma,language:xn===Rt.GithubComment?"markdown":"json",showLineNumbers:!0,showMiniMap:!0,value:xn===Rt.GithubComment?as:$s,readOnly:!1,onBlur:nt.onSetSnapshotText})})]}),kt===On.Support&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(A.D,{label:"Randomize data",description:"Modify the original data to hide sensitve information.  Note the lengths will stay the same, and duplicate values will be equal.",children:(0,u.jsxs)(R.B,{children:[(0,u.jsx)(W.K,{label:"Labels",id:"randomize-labels",showLabel:!0,value:!!Us.labels,onChange:()=>nt.onToggleRandomize("labels")}),(0,u.jsx)(W.K,{label:"Field names",id:"randomize-field-names",showLabel:!0,value:!!Us.names,onChange:()=>nt.onToggleRandomize("names")}),(0,u.jsx)(W.K,{label:"String values",id:"randomize-string-values",showLabel:!0,value:!!Us.values,onChange:()=>nt.onToggleRandomize("values")})]})}),(0,u.jsx)(A.D,{label:"Support snapshot",description:`Panel: ${Ta}`,children:(0,u.jsxs)(R.B,{children:[(0,u.jsxs)(T.$n,{icon:"download-alt",onClick:nt.onDownloadDashboard,children:["Dashboard (",gs,")"]}),(0,u.jsx)(Re.b,{icon:"github",getText:nt.onGetMarkdownForClipboard,title:"Copy a complete GitHub comment to the clipboard",children:"Copy to clipboard"})]})}),(0,u.jsx)(Be.Ay,{disableWidth:!0,children:({height:Ma})=>(0,u.jsx)("div",{style:{height:Ma,overflow:"auto"},children:Xs&&(0,u.jsx)(Xs.Component,{model:Xs})})})]})]})}const rt=Ge=>({code:(0,Te.css)({flexGrow:1,height:"100%",overflow:"scroll"}),field:(0,Te.css)({width:"100%"}),opts:(0,Te.css)({display:"flex",width:"100%",flexGrow:0,alignItems:"center",justifyContent:"flex-end","& button":{marginLeft:Ge.spacing(1)}})});var tn=e(8484),Mn=e(61453);class kn extends f.Bs{constructor(Le){super({...Le,options:{withTransforms:!1,withFieldConfig:!0}}),this.onOptionsChange=_e=>{this.setState({options:_e})}}getTabLabel(){return(0,tn.t)("dashboard.inspect.data-tab","Data")}getTabValue(){return Ft.q.Data}static{this.Component=({model:Le})=>{const{options:_e}=Le.useState(),nt=Le.state.panelRef.resolve(),At=f.jh.getData(nt),{data:kt}=Wn(At,_e.withTransforms).useState(),qt=f.jh.getTimeRange(nt);return(0,u.jsx)(Mn.q,{isLoading:kt?.state===$t.Gu.Loading,data:kt?.series,options:_e,hasTransformations:Yn(At),timeZone:qt.getTimeZone(),panelPluginId:nt.state.pluginId,dataName:nt.state.title,fieldConfig:nt.state.fieldConfig,onOptionsChange:Le.onOptionsChange})}}}function Yn(Ge){return Ge instanceof f.Es?Ge.state.transformations.length>0:!1}function Wn(Ge,Le){return!Le&&Ge instanceof f.Es&&Ge.state.$data?Ge.state.$data:Ge}var Jn=e(18803),Ls=e(26323),fs=e(77938),ys=e(6204),Xn=e(89681);class Ps extends f.Bs{constructor(Le){super({...Le,source:"panel-json",jsonText:Zs("panel-json",Le.panelRef.resolve())}),this.onChangeSource=_e=>{this.setState({source:_e.value,jsonText:Zs(_e.value,this.state.panelRef.resolve())})},this.onApplyChange=()=>{const _e=this.state.panelRef.resolve(),nt=(0,xe.YQ)(_e),At=JSON.parse(this.state.jsonText),kt=new l.a(At),qt=(0,pt.tt)(kt),gn=f.Go.cloneSceneObjectState(qt.state);if(!(_e.parent instanceof ye.U)){console.error("Cannot update state of panel",_e,qt);return}this.state.onClose(),nt.state.isEditing||nt.onEnterEditMode(),_e.parent.setState(gn),(0,ys.B9)(Ft.q.JSON,"apply",{panel_type_changed:_e.state.pluginId!==kt.type,panel_id_changed:(0,xe.Cs)(_e)!==kt.id,panel_grid_pos_changed:wa(_e.parent.state,gn),panel_targets_changed:Xa((0,xe.un)(_e),(0,xe.un)(gn.$data))})},this.onCodeEditorBlur=_e=>{this.setState({jsonText:_e})}}getTabLabel(){return(0,tn.t)("dashboard.inspect.json-tab","JSON")}getTabValue(){return Ft.q.JSON}getOptions(){const Le=this.state.panelRef.resolve(),_e=Le.state.$data??Le.parent?.state.$data,nt=[{label:(0,tn.t)("dashboard.inspect-json.panel-json-label","Panel JSON"),description:(0,tn.t)("dashboard.inspect-json.panel-json-description","The model saved in the dashboard JSON that configures how everything works."),value:"panel-json"}];return _e&&(nt.push({label:(0,tn.t)("dashboard.inspect-json.panel-data-label","Panel data"),description:(0,tn.t)("dashboard.inspect-json.panel-data-description","The raw model passed to the panel visualization"),value:"panel-data"}),nt.push({label:(0,tn.t)("dashboard.inspect-json.dataframe-label","DataFrame JSON (from Query)"),description:(0,tn.t)("dashboard.inspect-json.dataframe-description","Raw data without transformations and field config applied. "),value:"data-frames"})),nt}isEditable(){if(this.state.source!=="panel-json")return!1;const Le=this.state.panelRef.resolve();return Le.parent instanceof Et.F||Le.parent instanceof ye.U&&Le.parent.isRepeated()?!1:(0,xe.YQ)(Le).state.meta.canEdit}static{this.Component=({model:Le})=>{const{source:_e,jsonText:nt}=Le.useState(),At=(0,Vt.of)(Ls.A),kt=Le.getOptions();return(0,u.jsxs)("div",{className:At.wrap,children:[(0,u.jsxs)("div",{className:At.toolbar,"data-testid":I.Tp.components.PanelInspector.Json.content,children:[(0,u.jsx)(A.D,{label:(0,tn.t)("dashboard.inspect-json.select-source","Select source"),className:"flex-grow-1",children:(0,u.jsx)(Un.l6,{inputId:"select-source-dropdown",options:kt,value:kt.find(qt=>qt.value===_e)??kt[0].value,onChange:Le.onChangeSource})}),Le.isEditable()&&(0,u.jsx)(T.$n,{className:At.toolbarItem,onClick:Le.onApplyChange,children:"Apply"})]}),(0,u.jsx)("div",{className:At.content,children:(0,u.jsx)(Be.Ay,{disableWidth:!0,children:({height:qt})=>(0,u.jsx)(Ne.B,{width:"100%",height:qt,language:"json",showLineNumbers:!0,showMiniMap:nt.length>100,value:nt,readOnly:!Le.isEditable(),onBlur:Le.onCodeEditorBlur})})})]})}}}function Zs(Ge,Le){let _e={};switch(Ge){case"panel-json":{(0,ys.B9)(Ft.q.JSON,"panelData");const nt=Le.parent instanceof Et.F,At=nt?Le.parent.parent:Le.parent;if(nt){_e=Ms(Le);break}if(Le.parent instanceof Xn.j){_e=Le.parent.getPanelSaveModel();break}At instanceof ye.U&&(_e=(0,Ke.ZB)(At));break}case"panel-data":{(0,ys.B9)(Ft.q.JSON,"panelJSON");const nt=f.jh.getData(Le);nt.state.data&&(_e=Le.applyFieldConfig(nt.state.data));break}case"data-frames":{(0,ys.B9)(Ft.q.JSON,"dataFrame");const nt=f.jh.getData(Le);nt.state.data&&(nt instanceof f.Es&&nt.state.$data?.state.data?_e=(0,Jn.B6)(nt.state.$data.state.data):_e=(0,Jn.B6)(nt.state.data))}}return(0,fs.p)(_e)}function Ms(Ge){if(!(Ge.parent instanceof Et.F))throw"Panel not child of LibraryVizPanel";if(!(Ge.parent.parent instanceof ye.U))throw"LibraryPanel not child of DashboardGridItem";const Le=Ge.parent.parent,_e={x:Le.state.x||0,y:Le.state.y||0,h:Le.state.height||0,w:Le.state.width||0},nt=ks(Ge),At=(0,Ke.Z6)(Ge,_e,!1,Le);return{libraryPanel:{...nt},...At}}function ks(Ge){if(!(Ge.parent instanceof Et.F))throw new Error("Panel not a child of LibraryVizPanel");if(!Ge.parent.state._loadedPanel)throw new Error("Library panel not loaded");return Ge.parent.state._loadedPanel}function wa(Ge,Le){return Ge.x!==Le.x||Ge.y!==Le.y||Ge.width!==Le.width||Ge.height!==Le.height}function Xa(Ge,Le){return Ge===void 0||Le===void 0?!1:!(0,ht.isEqual)(Ge.state.queries,Le.state.queries)}class pa extends f.Bs{getTabLabel(){return(0,tn.t)("dashboard.inspect.meta-tab","Meta data")}getTabValue(){return Ft.q.Meta}static{this.Component=({model:Le})=>{const{panelRef:_e,dataSource:nt}=Le.state,At=f.jh.getData(_e.resolve()),kt=nt.components?.MetadataInspector;return!At.state.data||!kt?null:(0,u.jsx)(kt,{datasource:nt,data:At.state.data.series})}}}var Ba=e(90820);class _a extends f.Bs{constructor(){super(...arguments),this.onRefreshQuery=()=>{const Le=(0,xe.un)(this.state.panelRef.resolve());Le&&Le.runQueries()}}getTabLabel(){return(0,tn.t)("dashboard.inspect.query-tab","Query")}getTabValue(){return Ft.q.Query}static{this.Component=({model:Le})=>{const _e=f.jh.getData(Le.state.panelRef.resolve()).useState();return _e.data?(0,u.jsx)(Ba.e,{data:_e.data,onRefreshQuery:Le.onRefreshQuery}):null}}}var dr=e(32067);class Wa extends f.Bs{getTabLabel(){return(0,tn.t)("dashboard.inspect.stats-tab","Stats")}getTabValue(){return Ft.q.Stats}static{this.Component=({model:Le})=>{const _e=f.jh.getData(Le.state.panelRef.resolve()).useState(),nt=f.jh.getTimeRange(Le.state.panelRef.resolve());return _e.data?(0,u.jsx)(dr.N,{data:_e.data,timeZone:nt.getTimeZone()}):null}}}class en extends f.Bs{constructor(Le){super(Le),this.onClose=()=>{const _e=(0,xe.YQ)(this);r.Ny.push((0,at.uZ)({uid:_e.state.uid,slug:_e.state.meta.slug,currentQueryParams:r.Ny.getLocation().search,updateQuery:{inspect:null,inspectTab:null}}))},this.addActivationHandler(()=>this._activationHandler())}static{this.Component=$n}_activationHandler(){this.buildTabs(0)}async buildTabs(Le){const _e=this.state.panelRef,nt=_e?.resolve()?.getPlugin(),At=[];if(nt||(Le<2e3?setTimeout(()=>this.buildTabs(Le+100),100):this.setState({pluginNotLoaded:!0})),_e){if((0,yt.$)(nt)){const kt=f.jh.getData(_e.resolve());At.push(new kn({panelRef:_e})),At.push(new Wa({panelRef:_e})),At.push(new _a({panelRef:_e}));const qt=await(0,Dt.BN)(kt.state.data);qt&&At.push(new pa({panelRef:_e,dataSource:qt}))}At.push(new Ps({panelRef:_e,onClose:this.onClose}))}this.setState({tabs:At})}getDrawerTitle(){const Le=this.state.panelRef?.resolve();return Le?f.jh.interpolate(Le,`Inspect: ${Le.state.title}`):"Inspect panel"}}function $n({model:Ge}){const{tabs:Le,pluginNotLoaded:_e,panelRef:nt}=Ge.useState(),At=(0,ct.zy)(),kt=new URLSearchParams(At.search);if(!Le)return null;const qt=kt.get("inspectTab"),gn=Le.find(xn=>xn.getTabValue()===qt)??Le[0],Bn=nt.resolve();return qt===Ft.q.Help?(0,u.jsx)(jt,{panel:Bn,onClose:Ge.onClose}):(0,u.jsxs)(x._,{title:Ge.getDrawerTitle(),onClose:Ge.onClose,size:"md",tabs:(0,u.jsx)(D.U,{children:Le.map(xn=>(0,u.jsx)(P.o,{label:xn.getTabLabel(),active:xn===gn,href:t.I.getUrlForPartial(At,{inspectTab:xn.getTabValue()})},xn.state.key))}),children:[_e&&(0,u.jsx)(b.F,{title:"Panel plugin not loaded",children:"Make sure the panel you want to inspect is visible and has been displayed before opening inspect."}),gn&&gn.Component&&(0,u.jsx)(gn.Component,{model:gn})]})}var Qn=e(19293),Gn=e(10096),qn=e(22391),es=e(19347),Ss=e(38477);class _s{constructor(Le){this._scene=Le}getKeys(){return["editIndex"]}getUrlState(){const Le=this._scene.state;return{editIndex:Le.editIndex!==void 0?String(Le.editIndex):void 0}}updateFromUrl(Le){let _e={};typeof Le.editIndex=="string"?_e={editIndex:Number(Le.editIndex)}:_e={editIndex:void 0},Object.keys(_e).length>0&&this._scene.setState(_e)}}var Pa=e(16817),Ea=e(84167),Ys=e(77268),ha=e(82241),ja=e(51612),ua=e(46502);const za="New annotation",Ja=({annotation:Ge,editIndex:Le,panels:_e,onUpdate:nt,onBackToList:At,onDelete:kt})=>{const qt=(0,Vt.of)(pr),gn=(0,ee.useMemo)(()=>Ge.filter?Ge.filter.exclude?2:1:0,[Ge.filter]),{value:Bn}=(0,Pa.A)(()=>(0,es.l)().get(Ge.datasource),[Ge.datasource]),xn=(0,es.l)().getInstanceSettings(Ge.datasource),gs=va=>{nt({...Ge,name:va.currentTarget.value},Le)},as=va=>{const lr=(0,qn.p$)(va);Ge.datasource?.type!==lr.type?nt({datasource:lr,builtIn:Ge.builtIn,enable:Ge.enable,iconColor:Ge.iconColor,name:Ge.name,hide:Ge.hide,filter:Ge.filter,mappings:Ge.mappings,type:Ge.type},Le):nt({...Ge,datasource:lr},Le)},$s=va=>{const lr=va.currentTarget;nt({...Ge,[lr.name]:lr.type==="checkbox"?lr.checked:lr.value},Le)},Us=va=>{nt({...Ge,iconColor:va},Le)},Ta=va=>{let lr=va.value===0?void 0:{exclude:va.value===2,ids:Ge.filter?.ids??[]};nt({...Ge,filter:lr},Le)},Xs=va=>{if(!Array.isArray(va))return;const lr={exclude:gn===2,ids:[]};va.forEach(rr=>rr.value&&lr.ids.push(rr.value)),nt({...Ge,filter:lr},Le)},fa=()=>{kt(Le),At()},ma=Ge.name===za,Ma=(va,lr)=>va.label&&lr.label?va.label.toLowerCase().localeCompare(lr.label.toLowerCase()):-1,Ua=(0,ee.useMemo)(()=>_e.filter(va=>s.$.panels[va.state.pluginId]).map(va=>({value:(0,xe.Cs)(va),label:va.state.title??`Panel ${(0,xe.Cs)(va)}`,description:va.state.description,imgUrl:s.$.panels[va.state.pluginId].info.logos.small})).sort(Ma)??[],[_e]);return(0,u.jsxs)("div",{children:[(0,u.jsxs)(Ea.n,{className:qt.settingsForm,children:[(0,u.jsx)(A.D,{label:"Name",children:(0,u.jsx)(L.p,{"data-testid":I.Tp.pages.Dashboard.Settings.Annotations.Settings.name,name:"name",id:"name",autoFocus:ma,value:Ge.name,onChange:gs})}),(0,u.jsx)(A.D,{label:"Data source",htmlFor:"data-source-picker",children:(0,u.jsx)(ja.s,{annotations:!0,variables:!0,current:Ge.datasource,onChange:as})}),(0,u.jsx)(A.D,{label:"Enabled",description:"When enabled the annotation query is issued every dashboard refresh",children:(0,u.jsx)(de.S,{name:"enable",id:"enable",value:Ge.enable,onChange:$s,"data-testid":I.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.enable})}),(0,u.jsx)(A.D,{label:"Hidden",description:"Annotation queries can be toggled on or off at the top of the dashboard. With this option checked this toggle will be hidden.",children:(0,u.jsx)(de.S,{name:"hide",id:"hide",value:Ge.hide,onChange:$s,"data-testid":I.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.hide})}),(0,u.jsx)(A.D,{label:"Color",description:"Color to use for the annotation event markers",children:(0,u.jsx)(R.B,{children:(0,u.jsx)(Ys.a,{value:Ge?.iconColor,onChange:Us})})}),(0,u.jsx)(A.D,{label:"Show in","data-testid":I.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.showInLabel,children:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(Un.l6,{options:Fr,value:gn,onChange:Ta,"data-testid":I.Tp.components.Annotations.annotationsTypeInput}),gn!==0&&(0,u.jsx)(Un.KF,{options:Ua,value:Ua.filter(va=>Ge.filter?.ids.includes(va.value)),onChange:Xs,isClearable:!0,placeholder:"Choose panels",width:100,closeMenuOnSelect:!1,className:qt.select,"data-testid":I.Tp.components.Annotations.annotationsChoosePanelInput})]})})]}),(0,u.jsxs)(Ea.n,{children:[(0,u.jsx)("h3",{className:"page-heading",children:"Query"}),Bn?.annotations&&xn&&(0,u.jsx)(ha.A,{datasource:Bn,datasourceInstanceSettings:xn,annotation:Ge,onChange:va=>nt(va,Le)}),Bn&&!Bn.annotations&&(0,u.jsx)(ua.F,{datasource:Bn,annotation:Ge,onChange:va=>nt(va,Le)})]}),(0,u.jsxs)(R.B,{children:[!Ge.builtIn&&(0,u.jsx)(T.$n,{variant:"destructive",onClick:fa,"data-testid":I.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.delete,children:"Delete"}),(0,u.jsx)(T.$n,{variant:"secondary",onClick:At,"data-testid":I.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.apply,children:"Back to list"})]})]})},pr=Ge=>({settingsForm:(0,Te.css)({maxWidth:Ge.spacing(60),marginBottom:Ge.spacing(2)}),select:(0,Te.css)({marginTop:"8px"})});var Wr=(Ge=>(Ge[Ge.AllPanels=0]="AllPanels",Ge[Ge.IncludePanels=1]="IncludePanels",Ge[Ge.ExcludePanels=2]="ExcludePanels",Ge))(Wr||{});const Fr=[{label:"All panels",value:0,description:"Send the annotation data to all panels that support annotations"},{label:"Selected panels",value:1,description:"Send the annotations to the explicitly listed panels"},{label:"All panels except",value:2,description:"Do not send annotation data to the following panels"}];var Kr=e(29158),Ar=e(91605),$r=e(69529),so=e(72109),Zr=e(46991);const mo="Add annotation query",ao=({annotations:Ge,onNew:Le,onEdit:_e,onMove:nt,onDelete:At})=>{const kt=(0,Vt.of)(Fa),qt=Ge.length===0||Ge.length===1&&Ge[0].builtIn,gn=xn=>xn.enable===!1?(0,u.jsxs)("em",{className:"muted",children:["(Disabled) \xA0 ",xn.name]}):xn.builtIn?(0,u.jsxs)("em",{className:"muted",children:[xn.name," \xA0 (Built-in)"]}):(0,u.jsx)(u.Fragment,{children:xn.name}),Bn=(0,es.l)();return(0,u.jsxs)(R.B,{direction:"column",children:[Ge.length>0&&(0,u.jsx)("div",{className:kt.table,children:(0,u.jsxs)("table",{role:"grid",className:"filter-table filter-table--hover",children:[(0,u.jsx)("thead",{children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{children:"Query name"}),(0,u.jsx)("th",{children:"Data source"}),(0,u.jsx)("th",{colSpan:3})]})}),(0,u.jsx)("tbody",{"data-testid":I.Tp.pages.Dashboard.Settings.Annotations.List.annotations,children:Ge.map((xn,gs)=>(0,u.jsxs)("tr",{children:[xn.builtIn?(0,u.jsx)("td",{role:"gridcell",style:{width:"90%"},className:"pointer",onClick:()=>_e(gs),children:(0,u.jsx)(T.$n,{size:"sm",fill:"text",variant:"secondary",children:gn(xn)})}):(0,u.jsx)("td",{role:"gridcell",className:"pointer",onClick:()=>_e(gs),children:(0,u.jsx)(T.$n,{size:"sm",fill:"text",variant:"secondary",children:gn(xn)})}),(0,u.jsx)("td",{role:"gridcell",className:"pointer",onClick:()=>_e(gs),children:Bn.getInstanceSettings(xn.datasource)?.name||xn.datasource?.uid}),(0,u.jsx)("td",{role:"gridcell",style:{width:"1%"},children:gs!==0&&(0,u.jsx)(Kr.K,{name:"arrow-up",onClick:()=>nt(gs,fo.UP),tooltip:"Move up"})}),(0,u.jsx)("td",{role:"gridcell",style:{width:"1%"},children:Ge.length>1&&gs!==Ge.length-1?(0,u.jsx)(Kr.K,{name:"arrow-down",onClick:()=>nt(gs,fo.DOWN),tooltip:"Move down"}):null}),(0,u.jsx)("td",{role:"gridcell",style:{width:"1%"},children:!xn.builtIn&&(0,u.jsx)(Ar.e,{size:"sm",onConfirm:()=>At(gs),"aria-label":`Delete query with title "${xn.name}"`})})]},`${xn.name}-${gs}`))})]})}),qt&&(0,u.jsx)(R.B,{direction:"column",children:(0,u.jsxs)($r.p,{variant:"call-to-action",button:(0,u.jsx)(T.$n,{"data-testid":I.Tp.components.CallToActionCard.buttonV2("Add annotation query"),icon:"comment-alt",onClick:Le,size:"lg",children:(0,u.jsx)(tn.x6,{i18nKey:"annotations.empty-state.button-title",children:"Add annotation query"})}),message:(0,tn.t)("annotations.empty-state.title","There are no custom annotation queries added yet"),children:[(0,u.jsx)(tn.x6,{i18nKey:"annotations.empty-state.info-box-content",children:(0,u.jsx)("p",{children:"Annotations provide a way to integrate event data into your graphs. They are visualized as vertical lines and icons on all graph panels. When you hover over an annotation icon you can get event text & tags for the event. You can add annotation events directly from grafana by holding CTRL or CMD + click on graph (or drag region). These will be stored in Grafana's annotation database."})}),(0,u.jsxs)(tn.x6,{i18nKey:"annotations.empty-state.info-box-content-2",children:["Checkout the"," ",(0,u.jsx)(so.Y,{external:!0,href:"http://docs.grafana.org/reference/annotations/",children:"Annotations documentation"})," ","for more information."]})]})}),!qt&&(0,u.jsx)(Zr.d,{"data-testid":I.Tp.pages.Dashboard.Settings.Annotations.List.addAnnotationCTAV2,onClick:Le,children:"New query"})]})},Fa=()=>({table:(0,Te.css)({width:"100%",overflowX:"auto"})});var fo=(Ge=>(Ge[Ge.UP=-1]="UP",Ge[Ge.DOWN=1]="DOWN",Ge))(fo||{});class ko extends f.Bs{constructor(){super(...arguments),this._urlSync=new _s(this),this.onNew=()=>{const Le={name:za,enable:!0,datasource:(0,qn.p$)((0,es.l)().getInstanceSettings(null)),iconColor:"red"},_e=new Ss.g({query:Le,name:Le.name,isEnabled:!!Le.enable,isHidden:!!Le.hide}),nt=Ie.b4.getDataLayers(this._dashboard);nt.addAnnotationLayer(_e),this.setState({editIndex:nt.state.annotationLayers.length-1})},this.onEdit=Le=>{this.setState({editIndex:Le})},this.onBackToList=()=>{this.setState({editIndex:void 0})},this.onMove=(Le,_e)=>{const nt=Ie.b4.getDataLayers(this._dashboard),At=[...nt.state.annotationLayers],[kt]=At.splice(Le,1);At.splice(Le+_e,0,kt),nt.setState({annotationLayers:At})},this.onDelete=Le=>{const _e=Ie.b4.getDataLayers(this._dashboard),nt=[..._e.state.annotationLayers];nt.splice(Le,1),_e.setState({annotationLayers:nt})},this.onUpdate=(Le,_e)=>{const nt=this.getDataLayer(_e);nt.setState({name:Le.name,isEnabled:!!Le.enable,isHidden:!!Le.hide,query:Le}),nt.runLayer()}}static{this.Component=Go}getUrlKey(){return"annotations"}get _dashboard(){return(0,xe.YQ)(this)}getDataLayer(Le){const nt=Ie.b4.getDataLayers(this._dashboard).state.annotationLayers[Le];if(!(nt instanceof f.tV.g))throw new Error("AnnotationsDataLayer not found at index "+Le);return nt}getDashboard(){return this._dashboard}}function Go({model:Ge}){const Le=Ge.getDashboard(),{annotationLayers:_e}=Ie.b4.getDataLayers(Le).useState(),{navModel:nt,pageNav:At}=go(Le,Ge.getUrlKey()),{editIndex:kt}=Ge.useState(),qt=Ie.b4.getVizPanels(Le),gn=(0,Pe.O)(_e);return kt!=null&&kt<_e.length?(0,u.jsx)(Ut,{annotationLayer:Ge.getDataLayer(kt),pageNav:At,panels:qt,editIndex:kt,navModel:nt,dashboard:Le,onUpdate:Ge.onUpdate,onBackToList:Ge.onBackToList,onDelete:Ge.onDelete}):(0,u.jsxs)(wt.Y,{navModel:nt,pageNav:At,layout:Pt.k.Standard,children:[(0,u.jsx)(Pn.c,{dashboard:Le}),(0,u.jsx)(ao,{annotations:gn,onNew:Ge.onNew,onEdit:Ge.onEdit,onDelete:Ge.onDelete,onMove:Ge.onMove})]})}function Ut({annotationLayer:Ge,pageNav:Le,navModel:_e,panels:nt,editIndex:At,dashboard:kt,onUpdate:qt,onBackToList:gn,onDelete:Bn}){const{name:xn,query:gs}=Ge.useState(),as={text:xn,parentItem:Le};return(0,u.jsxs)(wt.Y,{navModel:_e,pageNav:as,layout:Pt.k.Standard,children:[(0,u.jsx)(Pn.c,{dashboard:kt}),(0,u.jsx)(Ja,{annotation:gs,editIndex:At,panels:nt,onUpdate:qt,onBackToList:gn,onDelete:Bn})]})}var Yt=e(14588),Tn=e(65857),rn=e(6199),In=e(4588);class cs extends f.Bs{constructor(){super(...arguments),this._urlSync=new _s(this),this.onNewLink=()=>{this.links=[...this.links,In.q],this.setState({editIndex:this.links.length-1})},this.onDelete=Le=>{this.links=[...this.links.slice(0,Le),...this.links.slice(Le+1)],this.setState({editIndex:void 0})},this.onDuplicate=Le=>{this.links=[...this.links,{...Le}]},this.onOrderChange=(Le,_e)=>{this.links=Yt.moveItemImmutably(this.links,Le,Le+_e)},this.onEdit=Le=>{this.setState({editIndex:Le})},this.onUpdateLink=Le=>{const _e=this.state.editIndex;_e!==void 0&&(this.links=[...this.links.slice(0,_e),Le,...this.links.slice(_e+1)])},this.onGoBack=()=>{this.setState({editIndex:void 0})}}static{this.Component=ds}getUrlKey(){return"links"}get dashboard(){return(0,xe.YQ)(this)}get links(){return this.dashboard.state.links}set links(Le){this.dashboard.setState({links:Le})}}function ds({model:Ge}){const{editIndex:Le}=Ge.useState(),_e=(0,xe.YQ)(Ge),{links:nt}=_e.useState(),{navModel:At,pageNav:kt}=go(_e,Ge.getUrlKey()),qt=Le!==void 0?nt[Le]:void 0;return qt?(0,u.jsx)(Gs,{pageNav:kt,navModel:At,link:qt,dashboard:_e,onChange:Ge.onUpdateLink,onGoBack:Ge.onGoBack}):(0,u.jsxs)(wt.Y,{navModel:At,pageNav:kt,layout:Pt.k.Standard,children:[(0,u.jsx)(Pn.c,{dashboard:_e}),(0,u.jsx)(rn.X,{links:nt,onNew:Ge.onNewLink,onEdit:Ge.onEdit,onDelete:Ge.onDelete,onDuplicate:Ge.onDuplicate,onOrderChange:Ge.onOrderChange})]})}function Gs({pageNav:Ge,link:Le,navModel:_e,dashboard:nt,onChange:At,onGoBack:kt}){const qt={text:"Edit link",parentItem:Ge};return(0,u.jsxs)(wt.Y,{navModel:_e,pageNav:qt,layout:Pt.k.Standard,children:[(0,u.jsx)(Pn.c,{dashboard:nt}),(0,u.jsx)(Tn.d,{link:Le,onUpdate:At,onGoBack:kt})]})}var js=e(79924),Ca=e(94354),Aa=e(57418),qs=e(75590),xs=e(81394),Er=e(27966),fr=e(77431),gr=e(42941),Rr=e(96374),Dr=e(37390);function Mo({dashboard:Ge}){const[Le,_e]=(0,gr.A)(!1);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(T.$n,{variant:"destructive",onClick:_e,"data-testid":I.Tp.pages.Dashboard.Settings.General.deleteDashBoard,children:(0,u.jsx)(tn.x6,{i18nKey:"dashboard-settings.dashboard-delete-button",children:"Delete dashboard"})}),Le&&(0,u.jsx)(So,{dashboard:Ge,onClose:_e})]})}function So({dashboard:Ge,onClose:Le}){const[,_e]=(0,se.A)(async()=>{(0,j.rR)("grafana_manage_dashboards_delete_clicked",{item_counts:{dashboard:1},source:"dashboard_scene_settings",restore_enabled:s.$.featureToggles.dashboardRestoreUI}),Le(),await Ge.deleteDashboard()},[Ge,Le]);return Ge.state.meta.provisioned?(0,u.jsx)(Ka,{dashboard:Ge,onClose:Le}):(0,u.jsx)(Rr.u,{isOpen:!0,body:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("p",{children:"Do you want to delete this dashboard?"}),(0,u.jsx)("p",{children:Ge.state.title})]}),onConfirm:_e,onDismiss:Le,title:"Delete",icon:"trash-alt",confirmText:"Delete"})}function Ka({dashboard:Ge,onClose:Le}){return(0,u.jsxs)(Dr.a,{isOpen:!0,title:"Cannot delete provisioned dashboard",icon:"trash-alt",onDismiss:Le,children:[(0,u.jsx)("p",{children:"This dashboard is managed by Grafana provisioning and cannot be deleted. Remove the dashboard from the config file to delete it."}),(0,u.jsxs)("p",{children:[(0,u.jsxs)("i",{children:["See"," ",(0,u.jsx)("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",target:"_blank",rel:"noreferrer",children:"documentation"})," ","for more information about provisioning."]}),(0,u.jsx)("br",{}),"File path: ",Ge.state.meta.provisionedExternalId]}),(0,u.jsx)(Dr.a.ButtonRow,{children:(0,u.jsx)(T.$n,{variant:"primary",onClick:Le,children:"OK"})})]})}const Sa=[{label:"Editable",value:!0},{label:"Read-only",value:!1}],Za=[{value:0,label:"Default"},{value:1,label:"Shared crosshair"},{value:2,label:"Shared Tooltip"}];class ur extends f.Bs{constructor(){super(...arguments),this.onTitleChange=Le=>{this._dashboard.setState({title:Le})},this.onDescriptionChange=Le=>{this._dashboard.setState({description:Le})},this.onTagsChange=Le=>{this._dashboard.setState({tags:Le})},this.onFolderChange=async(Le,_e)=>{const nt={...this._dashboard.state.meta,folderUid:Le||this._dashboard.state.meta.folderUid,folderTitle:_e||this._dashboard.state.meta.folderTitle};nt.folderUid&&await(0,fr.Q)(nt.folderUid),this._dashboard.setState({meta:nt})},this.onEditableChange=Le=>{this._dashboard.setState({editable:Le})},this.onTimeZoneChange=Le=>{this.getTimeRange().setState({timeZone:Le})},this.onWeekStartChange=Le=>{this.getTimeRange().setState({weekStart:Le})},this.onRefreshIntervalChange=Le=>{this.getRefreshPicker()?.setState({intervals:Le})},this.onNowDelayChange=Le=>{this.getTimeRange()?.setState({UNSAFE_nowDelay:Le})},this.onHideTimePickerChange=Le=>{this.getDashboardControls()?.setState({hideTimeControls:Le})},this.onLiveNowChange=Le=>{try{const _e=this.getLiveNowTimer();Le?_e.enable():_e.disable()}catch(_e){console.error(_e)}},this.onTooltipChange=Le=>{this.getCursorSync()?.setState({sync:Le})},this.onPreloadChange=Le=>{this._dashboard.setState({preload:Le})},this.onDeleteDashboard=()=>{}}get _dashboard(){return(0,xe.YQ)(this)}getUrlKey(){return"settings"}getDashboard(){return this._dashboard}getTimeRange(){return f.jh.getTimeRange(this._dashboard)}getRefreshPicker(){return this.getDashboardControls().state.refreshPicker}getCursorSync(){return Ie.b4.getCursorSync(this._dashboard)}getLiveNowTimer(){const Le=f.jh.findObject(this._dashboard,_e=>_e instanceof f.Gg.en);if(Le instanceof f.Gg.en)return Le;throw new Error("LiveNowTimer could not be found")}getDashboardControls(){return this._dashboard.state.controls}static{this.Component=({model:Le})=>{const _e=Le.getDashboard(),{navModel:nt,pageNav:At}=go(_e,Le.getUrlKey()),{title:kt,description:qt,tags:gn,meta:Bn,editable:xn}=_e.useState(),{sync:gs}=Le.getCursorSync()?.useState()||{},{timeZone:as,weekStart:$s,UNSAFE_nowDelay:Us}=Le.getTimeRange().useState(),{intervals:Ta}=Le.getRefreshPicker().useState(),{hideTimeControls:Xs}=Le.getDashboardControls().useState(),{enabled:fa}=Le.getLiveNowTimer().useState();return(0,u.jsxs)(wt.Y,{navModel:nt,pageNav:At,layout:Pt.k.Standard,children:[(0,u.jsx)(Pn.c,{dashboard:_e}),(0,u.jsxs)("div",{style:{maxWidth:"600px"},children:[(0,u.jsxs)(w.a,{marginBottom:5,children:[(0,u.jsx)(A.D,{label:(0,u.jsxs)(R.B,{justifyContent:"space-between",children:[(0,u.jsx)(N.J,{htmlFor:"title-input",children:(0,u.jsx)(tn.x6,{i18nKey:"dashboard-settings.general.title-label",children:"Title"})}),s.$.featureToggles.dashgpt&&(0,u.jsx)(Er.Z,{onGenerate:ma=>Le.onTitleChange(ma)})]}),children:(0,u.jsx)(L.p,{id:"title-input",name:"title",value:kt,onChange:ma=>Le.onTitleChange(ma.target.value)})}),(0,u.jsx)(A.D,{label:(0,u.jsxs)(R.B,{justifyContent:"space-between",children:[(0,u.jsx)(N.J,{htmlFor:"description-input",children:(0,tn.t)("dashboard-settings.general.description-label","Description")}),s.$.featureToggles.dashgpt&&(0,u.jsx)(xs.V,{onGenerate:ma=>Le.onDescriptionChange(ma)})]}),children:(0,u.jsx)(U.f,{id:"description-input",name:"description",value:qt,onChange:ma=>Le.onDescriptionChange(ma.target.value)})}),(0,u.jsx)(A.D,{label:(0,tn.t)("dashboard-settings.general.tags-label","Tags"),children:(0,u.jsx)(js.u,{id:"tags-input",tags:gn,onChange:Le.onTagsChange,width:40})}),(0,u.jsx)(A.D,{label:(0,tn.t)("dashboard-settings.general.folder-label","Folder"),children:(0,u.jsx)(B.d,{value:Bn.folderUid,onChange:Le.onFolderChange,initialTitle:Bn.folderTitle,inputId:"dashboard-folder-input",enableCreateNew:!0,skipInitialLoad:!0})}),(0,u.jsx)(A.D,{label:(0,tn.t)("dashboard-settings.general.editable-label","Editable"),description:(0,tn.t)("dashboard-settings.general.editable-description","Set to read-only to disable all editing. Reload the dashboard for changes to take effect"),children:(0,u.jsx)(Ca.z,{value:xn,options:Sa,onChange:Le.onEditableChange})})]}),(0,u.jsx)(qs.p,{onTimeZoneChange:Le.onTimeZoneChange,onWeekStartChange:Le.onWeekStartChange,onRefreshIntervalChange:Le.onRefreshIntervalChange,onNowDelayChange:Le.onNowDelayChange,onHideTimePickerChange:Le.onHideTimePickerChange,onLiveNowChange:Le.onLiveNowChange,refreshIntervals:Ta,timePickerHidden:Xs,nowDelay:Us||"",liveNow:fa,timezone:as||"",weekStart:$s||""}),(0,u.jsxs)(Aa.M,{label:(0,tn.t)("dashboard-settings.general.panel-options-label","Panel options"),isOpen:!0,children:[(0,u.jsx)(A.D,{label:(0,tn.t)("dashboard-settings.general.panel-options-graph-tooltip-label","Graph tooltip"),description:(0,tn.t)("dashboard-settings.general.panel-options-graph-tooltip-description","Controls tooltip and hover highlight behavior across different panels. Reload the dashboard for changes to take effect"),children:(0,u.jsx)(Ca.z,{onChange:Le.onTooltipChange,options:Za,value:gs})}),(0,u.jsx)(A.D,{label:(0,tn.t)("dashboard-settings.general.panels-preload-label","Preload panels"),description:(0,tn.t)("dashboard-settings.general.panels-preload-description","When enabled all panels will start loading as soon as the dashboard has been loaded."),children:(0,u.jsx)(W.d,{id:"preload-panels-dashboards-toggle",value:_e.state.preload,onChange:ma=>Le.onPreloadChange(ma.currentTarget.checked)})})]}),(0,u.jsx)(w.a,{marginTop:3,children:Bn.canDelete&&(0,u.jsx)(Mo,{dashboard:_e})})]})]})}}}class da extends f.Bs{constructor(Le){super({...Le,jsonText:""}),this.onCodeEditorBlur=_e=>{this.setState({jsonText:_e})},this.onSaveSuccess=_e=>{const nt=JSON.parse(this.state.jsonText),At=this.getDashboard();nt.version=_e.version;const kt={dashboard:nt,meta:At.state.meta},qt=(0,pt.wM)(kt),gn=f.Go.cloneSceneObjectState(qt.state);At.pauseTrackingChanges(),At.setInitialSaveModel(kt.dashboard),At.setState(gn),this.setState({jsonText:this.getJsonText()})},this.addActivationHandler(()=>this.setState({jsonText:this.getJsonText()}))}getUrlKey(){return"json-model"}getDashboard(){return(0,xe.YQ)(this)}getSaveModel(){const Le=this.getDashboard();return(0,Ke.Uy)(Le)}getJsonText(){const Le=this.getSaveModel();return(0,fs.p)(Le)}static{this.Component=({model:Le})=>{const{state:_e,onSaveDashboard:nt}=le(!1),[At,kt]=(0,ee.useState)(!1),qt=Le.getDashboard(),{navModel:gn,pageNav:Bn}=go(qt,Le.getUrlKey()),xn=qt.useState().meta.canSave,{jsonText:gs}=Le.useState(),as=async fa=>{const ma=await nt(qt,JSON.parse(Le.state.jsonText),{folderUid:qt.state.meta.folderUid,overwrite:fa});kt(!0),ma.status==="success"?(Le.onSaveSuccess(ma),kt(!1)):kt(!0)},$s=fa=>(0,u.jsx)(T.$n,{type:"submit",onClick:()=>{as(fa)},variant:fa?"destructive":"primary",children:fa?"Save and overwrite":(0,u.jsx)(tn.x6,{i18nKey:"dashboard-settings.json-editor.save-button",children:"Save changes"})}),Us=(0,u.jsx)(T.$n,{variant:"secondary",onClick:()=>kt(!1),fill:"outline",children:"Cancel"}),Ta=(0,Vt.of)(ro);function Xs(fa){if(fa&&At){if(H(fa))return(0,u.jsxs)(b.F,{title:"Someone else has updated this dashboard",severity:"error",children:[(0,u.jsx)("p",{children:"Would you still like to save this dashboard?"}),(0,u.jsx)(w.a,{paddingTop:2,children:(0,u.jsxs)(R.B,{alignItems:"center",children:[Us,$s(!0)]})})]});if(X(fa))return(0,u.jsx)(Y,{saveButton:$s,cancelButton:Us});if(k(fa))return(0,u.jsxs)(b.F,{title:"Plugin dashboard",severity:"error",children:[(0,u.jsxs)("p",{children:["Your changes will be lost when you update the plugin. Use ",(0,u.jsx)("strong",{children:"Save As"})," to create custom version."]}),(0,u.jsx)(w.a,{paddingTop:2,children:(0,u.jsx)(R.B,{alignItems:"center",children:$s(!0)})})]})}return(0,u.jsxs)(u.Fragment,{children:[fa&&At&&(0,u.jsx)(b.F,{title:"Failed to save dashboard",severity:"error",children:(0,u.jsx)("p",{children:fa.message})}),(0,u.jsx)(R.B,{alignItems:"center",children:$s(!1)})]})}return(0,u.jsxs)(wt.Y,{navModel:gn,pageNav:Bn,layout:Pt.k.Standard,children:[(0,u.jsx)(Pn.c,{dashboard:qt}),(0,u.jsxs)("div",{className:Ta.wrapper,children:[(0,u.jsx)(tn.x6,{i18nKey:"dashboard-settings.json-editor.subtitle",children:"The JSON model below is the data structure that defines the dashboard. This includes dashboard settings, panel settings, layout, queries, and so on."}),(0,u.jsx)(Ne.B,{width:"100%",value:gs,language:"json",showLineNumbers:!0,showMiniMap:!0,containerStyles:Ta.codeEditor,onBlur:Le.onCodeEditorBlur}),xn&&(0,u.jsx)(w.a,{paddingTop:2,children:Xs(_e.error)})]})]})}}}const ro=Ge=>({wrapper:(0,Te.css)({display:"flex",height:"100%",flexDirection:"column",gap:Ge.spacing(2)}),codeEditor:(0,Te.css)({flexGrow:1})});var Uo=e(5108);class No extends f.Bs{static{this.Component=wo}get _dashboard(){return(0,xe.YQ)(this)}getUrlKey(){return"permissions"}getDashboard(){return this._dashboard}}function wo({model:Ge}){const Le=Ge.getDashboard(),{uid:_e}=Le.useState(),{navModel:nt,pageNav:At}=go(Le,Ge.getUrlKey()),kt=Gn.TP.hasPermission(z.AccessControlAction.DashboardsPermissionsWrite);return(0,u.jsxs)(wt.Y,{navModel:nt,pageNav:At,layout:Pt.k.Standard,children:[(0,u.jsx)(Pn.c,{dashboard:Le}),(0,u.jsx)(Uo.x,{resource:"dashboards",resourceId:_e??"",canSetPermissions:kt})]})}var Di=e(75505),ii=e(79422),Wo=e(71678),li=e(39558),nl=e(8964),Mr=e(58975),Fi=e(85140),Pi=e(14329),mr=e(41820),ci=e(85830),Qo=e(89458),Vr=e(17663);function Ki({onChange:Ge,type:Le}){const _e=(0,ee.useMemo)(()=>(0,Vr.B$)(),[]),nt=(0,ee.useMemo)(()=>_e.find(At=>At.value===Le)??_e[0],[_e,Le]);return(0,u.jsx)(Qo.v,{name:"Select variable type",value:nt,options:_e,onChange:Ge,testId:I.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalTypeSelectV2})}function $i({variable:Ge,onTypeChange:Le,onGoBack:_e,onDelete:nt,onValidateVariableName:At}){const kt=(0,Vt.of)(vo),[qt,gn]=(0,ee.useState)(null),{name:Bn,type:xn,label:gs,description:as,hide:$s,key:Us}=Ge.useState(),Ta=(0,Vr.bZ)(xn)?(0,Vr.CD)(xn):void 0,[Xs,fa]=(0,se.A)(async()=>{await(0,Di.s)(Ge.validateAndUpdate())},[Ge]),ma=jr=>{jr.value&&Le(jr.value)},Ma=(0,ee.useCallback)(jr=>{const[,xr]=At(jr.currentTarget.value,Us);qt!==xr&&gn(xr)},[Us,qt,At]),Ua=jr=>{qt||Ge.setState({name:jr.currentTarget.value})},va=jr=>Ge.setState({label:jr.currentTarget.value}),lr=jr=>Ge.setState({description:jr.currentTarget.value}),rr=jr=>Ge.setState({hide:jr}),co=(0,Vr.n_)(Ge),yr=jr=>()=>{(0,j.rR)("Delete variable"),nt(Bn),jr()};return(0,u.jsxs)("form",{"aria-label":"Variable editor Form",children:[(0,u.jsx)(Ki,{onChange:ma,type:xn}),(0,u.jsx)(Mr.Y,{children:"General"}),(0,u.jsx)(Pi._,{name:"Name",description:"The name of the template variable. (Max. 50 characters)",placeholder:"Variable name",defaultValue:Bn??"",onChange:Ma,onBlur:Ua,testId:I.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalNameInputV2,maxLength:ci.M.MaxSize,required:!0,invalid:!!qt,error:qt}),(0,u.jsx)(Pi._,{name:"Label",description:"Optional display name",placeholder:"Label name",defaultValue:gs??"",onBlur:va,testId:I.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalLabelInputV2}),(0,u.jsx)(Fi.Z,{name:"Description",defaultValue:as??"",placeholder:"Descriptive text",onBlur:lr,width:52}),(0,u.jsx)(nl.D,{onChange:rr,hide:$s||ii.rw.hide,type:xn}),Ta&&(0,u.jsx)(Ta,{variable:Ge,onRunQuery:fa}),co&&(0,u.jsx)(mr.j,{options:Ge.getOptionsForSelect()}),(0,u.jsx)("div",{className:kt.buttonContainer,children:(0,u.jsxs)(R.B,{gap:2,children:[(0,u.jsx)(Wo.$s,{children:({showModal:jr,hideModal:xr})=>(0,u.jsx)(T.$n,{variant:"destructive",fill:"outline",onClick:()=>{jr(Rr.u,{title:"Delete variable",body:`Are you sure you want to delete: ${Bn}?`,confirmText:"Delete variable",onConfirm:yr(xr),onDismiss:xr,isOpen:!0})},children:"Delete"})}),(0,u.jsx)(T.$n,{variant:"secondary","data-testid":I.Tp.pages.Dashboard.Settings.Variables.Edit.General.applyButton,onClick:_e,children:"Back to list"}),co&&(0,u.jsx)(T.$n,{disabled:Xs.loading,variant:"secondary","data-testid":I.Tp.pages.Dashboard.Settings.Variables.Edit.General.submitButton,onClick:fa,children:Xs.loading?(0,u.jsx)(li._,{className:kt.loadingPlaceHolder,text:"Running query..."}):"Run query"})]})})]})}const vo=Ge=>({buttonContainer:(0,Te.css)({marginTop:Ge.spacing(2)}),loadingPlaceHolder:(0,Te.css)({marginBottom:0})});var oo=e(38127),sr=e(2223);function di(Ge){return Ge.map(Le=>({id:Le.state.name,label:`${Le.state.name}`}))}function sl(Ge,Le){return Ge.filter(_e=>Le.some(nt=>nt.from===_e.id||nt.to===_e.id))}const Vi=Ge=>{const Le=[];for(const _e of Ge)for(const nt of Ge){if(_e===nt)continue;_e.variableDependency?.hasDependencyOn(nt.state.name)&&Le.push({from:_e.state.name,to:nt.state.name})}return Le},al=({variables:Ge})=>{const Le=(0,ee.useMemo)(()=>di(Ge),[Ge]),_e=(0,ee.useMemo)(()=>Vi(Ge),[Ge]);return _e.length?(0,u.jsx)(sr.i,{show:!1,title:(0,tn.t)("dashboards.settings.variables.dependencies.title","Dependencies"),nodes:sl(Le,_e),edges:_e,children:({showModal:nt})=>(0,u.jsx)(T.$n,{onClick:()=>{(0,j.rR)("Show variable dependencies"),nt()},icon:"channel-add",variant:"secondary",children:(0,u.jsx)(tn.x6,{i18nKey:"dashboards.settings.variables.dependencies.button",children:"Show dependencies"})})}):null};function _i({index:Ge,variable:Le,onEdit:_e,onDuplicate:nt,onDelete:At}){const kt=(0,Vt.$j)(),qt=(0,Vt.of)(rl),gn=(0,Vr.Ao)(Le),Bn=Le.state,xn=Bn.name,[gs,as]=(0,ee.useState)(!1),$s=Ta=>()=>{as(Ta)},Us=()=>{(0,j.rR)("Delete variable"),At(xn)};return(0,u.jsx)(oo.sx,{draggableId:JSON.stringify(xn),index:Ge,children:(Ta,Xs)=>(0,u.jsxs)("tr",{ref:Ta.innerRef,...Ta.draggableProps,style:{userSelect:Xs.isDragging?"none":"auto",background:Xs.isDragging?kt.colors.background.secondary:void 0,...Ta.draggableProps.style},children:[(0,u.jsx)("td",{role:"gridcell",className:qt.column,children:(0,u.jsx)(T.$n,{size:"xs",fill:"text",onClick:fa=>{fa.preventDefault(),_e(xn)},className:qt.nameLink,"data-testid":I.Tp.pages.Dashboard.Settings.Variables.List.tableRowNameFields(Bn.name),children:Bn.name})}),(0,u.jsx)("td",{role:"gridcell",className:qt.definitionColumn,onClick:fa=>{fa.preventDefault(),_e(xn)},"data-testid":I.Tp.pages.Dashboard.Settings.Variables.List.tableRowDefinitionFields(Bn.name),children:gn}),(0,u.jsx)("td",{role:"gridcell",className:qt.column,children:(0,u.jsxs)("div",{className:qt.icons,children:[(0,u.jsx)(Kr.K,{onClick:fa=>{fa.preventDefault(),(0,j.rR)("Duplicate variable"),nt(xn)},name:"copy",tooltip:"Duplicate variable","data-testid":I.Tp.pages.Dashboard.Settings.Variables.List.tableRowDuplicateButtons(Bn.name)}),(0,u.jsx)(Kr.K,{onClick:fa=>{fa.preventDefault(),as(!0)},name:"trash-alt",tooltip:"Remove variable","data-testid":I.Tp.pages.Dashboard.Settings.Variables.List.tableRowRemoveButtons(Bn.name)}),(0,u.jsx)(Rr.u,{isOpen:gs,title:"Delete variable",body:`Are you sure you want to delete: ${Bn.name}?`,confirmText:"Delete variable",onConfirm:Us,onDismiss:$s(!1)}),(0,u.jsx)("div",{...Ta.dragHandleProps,className:qt.dragHandle,children:(0,u.jsx)(un.I,{name:"draggabledots",size:"lg"})})]})})]})})}function rl(Ge){return{dragHandle:(0,Te.css)({cursor:"grab",marginLeft:Ge.spacing(1)}),column:(0,Te.css)({width:"1%"}),nameLink:(0,Te.css)({cursor:"pointer",color:Ge.colors.primary.text}),definitionColumn:(0,Te.css)({width:"100%",maxWidth:"200px",cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),iconPassed:(0,Te.css)({color:Ge.v1.palette.greenBase,marginRight:Ge.spacing(2)}),iconFailed:(0,Te.css)({color:Ge.v1.palette.orange,marginRight:Ge.spacing(2)}),icons:(0,Te.css)({display:"flex",gap:Ge.spacing(2),alignItems:"center"})}}function zi({variables:Ge,onChangeOrder:Le,onDelete:_e,onDuplicate:nt,onAdd:At,onEdit:kt}){const qt=(0,Vt.of)(Hi),gn=Bn=>{!Bn.destination||!Bn.source||((0,j.rR)("Variable drag and drop"),Le(Bn.source.index,Bn.destination.index))};return(0,u.jsx)("div",{children:(0,u.jsxs)("div",{children:[Ge.length===0&&(0,u.jsx)(ol,{onAdd:At}),Ge.length>0&&(0,u.jsxs)(R.B,{direction:"column",gap:3,children:[(0,u.jsx)("div",{className:qt.tableContainer,children:(0,u.jsxs)("table",{className:"filter-table filter-table--hover","data-testid":I.Tp.pages.Dashboard.Settings.Variables.List.table,role:"grid",children:[(0,u.jsx)("thead",{children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{children:"Variable"}),(0,u.jsx)("th",{children:"Definition"}),(0,u.jsx)("th",{colSpan:5})]})}),(0,u.jsx)(oo.JY,{onDragEnd:gn,children:(0,u.jsx)(oo.gL,{droppableId:"variables-list",direction:"vertical",children:Bn=>(0,u.jsxs)("tbody",{ref:Bn.innerRef,...Bn.droppableProps,children:[Ge.map((xn,gs)=>{const as=xn.state;return(0,u.jsx)(_i,{index:gs,variable:xn,onDelete:_e,onDuplicate:nt,onEdit:kt},`${as.name}-${gs}`)}),Bn.placeholder]})})})]})}),(0,u.jsxs)(R.B,{children:[(0,u.jsx)(al,{variables:Ge}),(0,u.jsx)(T.$n,{"data-testid":I.Tp.pages.Dashboard.Settings.Variables.List.newButton,onClick:At,icon:"plus",children:"New variable"})]})]})]})})}function ol({onAdd:Ge}){return(0,u.jsx)(R.B,{direction:"column",children:(0,u.jsxs)($r.p,{variant:"call-to-action",button:(0,u.jsx)(T.$n,{"data-testid":I.Tp.components.CallToActionCard.buttonV2("Add variable"),icon:"calculator-alt",onClick:Ge,size:"lg",children:(0,u.jsx)(tn.x6,{i18nKey:"variables.empty-state.button-title",children:"Add variable"})}),message:(0,tn.t)("variables.empty-state.title","There are no variables added yet"),children:[(0,u.jsx)("p",{children:(0,u.jsx)(tn.x6,{i18nKey:"variables.empty-state.info-box-content",children:"Variables enable more interactive and dynamic dashboards. Instead of hard-coding things like server or sensor names in your metric queries you can use variables in their place. Variables are shown as list boxes at the top of the dashboard. These drop-down lists make it easy to change the data being displayed in your dashboard."})}),(0,u.jsxs)(tn.x6,{i18nKey:"variables.empty-state.info-box-content-2",children:["Check out the"," ",(0,u.jsx)(so.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/variables/",children:"Templates and variables documentation"})," ","for more information."]})]})})}const Hi=()=>({tableContainer:(0,Te.css)({overflow:"scroll",width:"100%"})});class ki extends f.Bs{constructor(){super(...arguments),this._urlSync=new _s(this),this.getVariableIndex=Le=>this.getVariables().findIndex(nt=>nt.state.name===Le),this.replaceEditVariable=Le=>{const _e=this.state.editIndex??-1,{variables:nt}=this.getVariableSet().state;if(!nt[_e]){console.error("Variable not found");return}const kt=[...nt.slice(0,_e),Le,...nt.slice(_e+1)];this.getVariableSet().setState({variables:kt})},this.onDelete=Le=>{const _e=this.getVariableIndex(Le),{variables:nt}=this.getVariableSet().state;if(_e===-1){console.error("Variable not found");return}const At=[...nt.slice(0,_e),...nt.slice(_e+1)];this.getVariableSet().setState({variables:At}),this.setState({editIndex:void 0})},this.onDuplicated=Le=>{const _e=this.getVariableIndex(Le),nt=this.getVariableSet().state.variables;if(_e===-1){console.error("Variable not found");return}const At=nt[_e];let kt=0,qt=`copy_of_${At.state.name}`;for(;nt.some(xn=>xn.state.name===qt);)kt++,qt=`copy_of_${At.state.name}_${kt}`;const gn=At.clone(At.state);gn.setState({name:qt});const Bn=[...nt.slice(0,_e+1),gn,...nt.slice(_e+1)];this.getVariableSet().setState({variables:Bn})},this.onOrderChanged=(Le,_e)=>{const nt=this.getVariableSet().state.variables;if(!this.getVariableSet())return;if(Le<0||Le>=nt.length||_e<0||_e>=nt.length){console.error("Invalid index");return}const At=[...nt],kt=At.splice(Le,1);At.splice(_e,0,kt[0]),this.getVariableSet().setState({variables:At})},this.onEdit=Le=>{const _e=this.getVariableIndex(Le);if(_e===-1){console.error("Variable not found");return}this.setState({editIndex:_e})},this.onAdd=()=>{const Le=this.getVariables(),_e=Le.length,nt=(0,Vr.kh)(Le);this.getVariableSet().setState({variables:[...this.getVariables(),nt]}),this.setState({editIndex:_e})},this.onTypeChange=Le=>{const _e=this.state.editIndex??-1,{variables:nt}=this.getVariableSet().state,At=nt[_e];if(!At){console.error("Variable not found");return}const{name:kt,label:qt}=At.state,gn=(0,Vr.No)(Le,{name:kt,label:qt});this.replaceEditVariable(gn)},this.onGoBack=()=>{this.setState({editIndex:void 0})},this.onValidateVariableName=(Le,_e)=>{let nt=null;Vr.cH.test(Le)||(nt="Template names cannot begin with '__', that's reserved for Grafana's global variables"),Vr.mJ.test(Le)||(nt="Only word characters are allowed in variable names");const At=this.getVariableSet().getByName(Le)?.state;return At&&At.key!==_e&&(nt="Variable with the same name already exists"),nt?[!0,nt]:[!1,null]}}static{this.Component=Fo}getUrlKey(){return"variables"}getDashboard(){return(0,xe.YQ)(this)}getVariableSet(){return f.jh.getVariables(this.getDashboard())}getVariables(){return this.getVariableSet().state.variables}}function Fo({model:Ge}){const Le=Ge.getDashboard(),{navModel:_e,pageNav:nt}=go(Le,Ge.getUrlKey()),{onDelete:At,onDuplicated:kt,onOrderChanged:qt,onEdit:gn,onTypeChange:Bn,onGoBack:xn,onAdd:gs}=Ge,{variables:as}=Ge.getVariableSet().useState(),{editIndex:$s}=Ge.useState();if($s!==void 0&&as[$s]){const Us=as[$s];if(Us)return(0,u.jsx)(Ko,{variable:Us,onTypeChange:Bn,onGoBack:xn,pageNav:nt,navModel:_e,dashboard:Le,onDelete:At,onValidateVariableName:Ge.onValidateVariableName})}return(0,u.jsxs)(wt.Y,{navModel:_e,pageNav:nt,layout:Pt.k.Standard,children:[(0,u.jsx)(Pn.c,{dashboard:Le}),(0,u.jsx)(zi,{variables:as,onDelete:At,onDuplicate:kt,onChangeOrder:qt,onAdd:gs,onEdit:gn})]})}function Ko({variable:Ge,pageNav:Le,navModel:_e,dashboard:nt,onTypeChange:At,onGoBack:kt,onDelete:qt,onValidateVariableName:gn}){const{name:Bn}=Ge.useState(),xn={text:Bn,parentItem:Le};return(0,u.jsxs)(wt.Y,{navModel:_e,pageNav:xn,layout:Pt.k.Standard,children:[(0,u.jsx)(Pn.c,{dashboard:nt}),(0,u.jsx)($i,{variable:Ge,onTypeChange:At,onGoBack:kt,onDelete:qt,onValidateVariableName:gn},Ge.state.key)]})}const yo=10;class Oo extends f.Bs{constructor(Le){super({...Le,versions:[],isLoading:!0,isAppending:!0,viewMode:"list",isNewLatest:!1,diffData:{lhs:"",rhs:""}}),this._limit=yo,this._start=0,this.fetchVersions=(_e=!1)=>{const nt=this._dashboard.state.uid;nt&&(this.setState({isAppending:_e}),xt.wL.getHistoryList(nt,{limit:this._limit,start:this._start}).then(At=>{this.setState({isLoading:!1,versions:[...this.state.versions??[],...this.decorateVersions(At)]}),this._start+=this._limit}).catch(At=>console.log(At)).finally(()=>this.setState({isAppending:!1})))},this.getDiff=async()=>{const _e=this.versions.filter(Bn=>Bn.checked),[nt,At]=_e,kt=nt.version===this._dashboard.state.version;if(this.setState({isLoading:!0}),!this._dashboard.state.uid)return;const qt=await xt.wL.getDashboardVersion(this._dashboard.state.uid,At.version),gn=await xt.wL.getDashboardVersion(this._dashboard.state.uid,nt.version);this.setState({baseInfo:At,isLoading:!1,isNewLatest:kt,newInfo:nt,viewMode:"compare",diffData:{lhs:qt.data,rhs:gn.data}})},this.reset=()=>{this.setState({baseInfo:void 0,diffData:{lhs:"",rhs:""},isNewLatest:!1,newInfo:void 0,versions:this.versions.map(_e=>({..._e,checked:!1})),viewMode:"list"})},this.onCheck=(_e,nt)=>{this.setState({versions:this.versions.map(At=>At.id===nt?{...At,checked:_e.currentTarget.checked}:At)})},this.addActivationHandler(()=>{this.fetchVersions()})}static{this.Component=il}get _dashboard(){return(0,xe.YQ)(this)}get diffData(){return this.state.diffData??{lhs:"",rhs:""}}get versions(){return this.state.versions??[]}get limit(){return this._limit}get start(){return this._start}getUrlKey(){return"versions"}getDashboard(){return this._dashboard}getTimeRange(){return f.jh.getTimeRange(this._dashboard)}decorateVersions(Le){const _e=this.getTimeRange().getTimeZone();return Le.map(nt=>({...nt,createdDateString:(0,be.LE)(nt.created,{timeZone:_e}),ageString:(0,be.fq)(nt.created,{timeZone:_e}),checked:!1}))}}function il({model:Ge}){const Le=Ge.getDashboard(),{isLoading:_e,isAppending:nt,viewMode:At,baseInfo:kt,newInfo:qt,isNewLatest:gn}=Ge.useState(),{navModel:Bn,pageNav:xn}=go(Le,Ge.getUrlKey()),gs=Ge.versions.filter(fa=>fa.checked).length===2,as=Ge.versions.length>1,$s=Ge.versions.length>=Ge.limit,Us=Ge.versions.find(fa=>fa.version===1),Ta=(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(xt.me,{onClick:Ge.reset,baseVersion:kt?.version,newVersion:qt?.version,isNewLatest:gn}),_e?(0,u.jsx)(bi,{msg:"Fetching changes\u2026"}):(0,u.jsx)(xt.Cc,{newInfo:qt,baseInfo:kt,isNewLatest:gn,diffData:Ge.diffData,onRestore:Le.onRestore})]}),Xs=(0,u.jsxs)(u.Fragment,{children:[_e?(0,u.jsx)(bi,{msg:"Fetching history list\u2026"}):(0,u.jsx)(xt.bS,{versions:Ge.versions,onCheck:Ge.onCheck,canCompare:gs,onRestore:Le.onRestore}),nt&&(0,u.jsx)(bi,{msg:"Fetching more entries\u2026"}),as&&(0,u.jsx)(xt.rJ,{hasMore:$s,canCompare:gs,getVersions:Ge.fetchVersions,getDiff:Ge.getDiff,isLastPage:!!Us})]});return(0,u.jsxs)(wt.Y,{navModel:Bn,pageNav:xn,layout:Pt.k.Standard,children:[(0,u.jsx)(Pn.c,{dashboard:Le}),At==="compare"?Ta:Xs]})}const bi=({msg:Ge})=>(0,u.jsxs)(R.B,{children:[(0,u.jsx)(hn.y,{}),(0,u.jsx)("em",{children:Ge})]});function go(Ge,Le){const _e=(0,ct.zy)(),nt=(0,z.useSelector)(gn=>gn.navIndex),At=(0,o.tc)(nt,"dashboards/browse"),kt=Ge.getPageNav(_e,nt),qt={text:"Settings",url:t.I.getUrlForPartial(_e,{editview:"settings",editIndex:null}),children:[],parentItem:kt};return Ge.state.meta.canEdit&&(qt.children.push({text:(0,tn.t)("dashboard-settings.general.title","General"),url:t.I.getUrlForPartial(_e,{editview:"settings",editIndex:null}),active:Le==="settings"}),qt.children.push({text:(0,tn.t)("dashboard-settings.annotations.title","Annotations"),url:t.I.getUrlForPartial(_e,{editview:"annotations",editIndex:null}),active:Le==="annotations"}),qt.children.push({text:(0,tn.t)("dashboard-settings.variables.title","Variables"),url:t.I.getUrlForPartial(_e,{editview:"variables",editIndex:null}),active:Le==="variables"}),qt.children.push({text:(0,tn.t)("dashboard-settings.links.title","Links"),url:t.I.getUrlForPartial(_e,{editview:"links",editIndex:null}),active:Le==="links"})),Ge.state.id&&Ge.state.meta.canSave&&qt.children.push({text:(0,tn.t)("dashboard-settings.versions.title","Versions"),url:t.I.getUrlForPartial(_e,{editview:"versions",editIndex:null}),active:Le==="versions"}),Ge.state.id&&Ge.state.meta.canAdmin&&Gn.TP.hasPermission(z.AccessControlAction.DashboardsPermissionsRead)&&qt.children.push({text:(0,tn.t)("dashboard-settings.permissions.title","Permissions"),url:t.I.getUrlForPartial(_e,{editview:"permissions",editIndex:null}),active:Le==="permissions"}),qt.children.push({text:(0,tn.t)("dashboard-settings.json-editor.title","JSON Model"),url:t.I.getUrlForPartial(_e,{editview:"json-model",editIndex:null}),active:Le==="json-model"}),{navModel:At,pageNav:qt}}function $o(Ge){switch(Ge){case"annotations":return new ko({});case"variables":return new ki({});case"links":return new cs({});case"versions":return new Oo({});case"json-model":return new da({});case"permissions":return new No({});case"settings":default:return new ur({})}}class Yo extends f.Bs{constructor(Le){super(Le),this.addActivationHandler(this._activationHandler.bind(this))}_activationHandler(){const Le=this.state.panelRef.resolve(),_e=f.Go.cloneSceneObjectState(Le.state,{key:Le.state.key+"-view",$variables:this.getScopedVariables(Le)}),nt=new f.Eb(_e);return this.setState({body:nt}),()=>{nt.state.$data&&Le.setState({$data:nt.state.$data.clone()})}}getScopedVariables(Le){const _e=Sr(Le),nt=[];if(_e&&_e.state.$variables)for(const At of _e.state.$variables.state.variables)nt.push(At.clone());if(Le.state.$variables)for(const At of Le.state.$variables.state.variables)nt.push(At.clone());if(nt.length>0)return new f.Pj({variables:nt})}getUrlKey(){return this.state.panelRef.resolve().state.key}static{this.Component=({model:Le})=>{const{body:_e}=Le.useState();return _e?(0,u.jsx)(_e.Component,{model:_e}):null}}}function Sr(Ge){try{return f.jh.getAncestor(Ge,f.tI)}catch{return}}var Jo=e(30195);class xo{constructor(Le){this._scene=Le}getKeys(){return["inspect","viewPanel","editPanel","editview","autofitpanels","kiosk"]}getUrlState(){const Le=this._scene.state;return{inspect:Le.inspectPanelKey,autofitpanels:Le.body instanceof f.hy&&Le.body.state.UNSAFE_fitPanels?"true":void 0,viewPanel:Le.viewPanelScene?.getUrlKey(),editview:Le.editview?.getUrlKey(),editPanel:Le.editPanel?.getUrlKey()||void 0,kiosk:Le.kioskMode===z.KioskMode.Full?"":Le.kioskMode===z.KioskMode.TV?"tv":void 0}}updateFromUrl(Le){const{inspectPanelKey:_e,viewPanelScene:nt,isEditing:At,editPanel:kt}=this._scene.state,qt={};if(typeof Le.editview=="string"&&this._scene.canEditDashboard()?(qt.editview=$o(Le.editview),At||(this._scene.state.editable?setTimeout(()=>this._scene.onEnterEditMode()):qt.editview=void 0)):Le.hasOwnProperty("editview")&&(qt.editview=void 0),typeof Le.inspect=="string"){let gn=(0,xe.vL)(this._scene,Le.inspect);if(!gn){a.A.emit(n.r1.alertError,["Panel not found"]),r.Ny.partial({inspect:null});return}if((0,xe.Yr)(gn)){this._handleLibraryPanel(gn,Bn=>{if(Bn.state.key===void 0)throw new Error("library panel key is undefined");const xn=new en({$behaviors:[new Xo({panelKey:Bn.state.key})]});this._scene.setState({overlay:xn,inspectPanelKey:Bn.state.key})});return}qt.inspectPanelKey=Le.inspect,qt.overlay=new en({$behaviors:[new Xo({panelKey:Le.inspect})]})}else _e&&(qt.inspectPanelKey=void 0,qt.overlay=void 0);if(typeof Le.viewPanel=="string"){const gn=(0,xe.vL)(this._scene,Le.viewPanel);if(!gn){if((0,xe.SN)(Le.viewPanel)){this._handleViewRepeatClone(Le.viewPanel);return}a.A.emit(n.r1.alertError,["Panel not found"]),r.Ny.partial({viewPanel:null});return}if((0,xe.Yr)(gn)){this._handleLibraryPanel(gn,Bn=>this._buildLibraryPanelViewScene(Bn));return}qt.viewPanelScene=new Yo({panelRef:gn.getRef()})}else nt&&Le.viewPanel===null&&(qt.viewPanelScene=void 0);if(typeof Le.editPanel=="string"){const gn=(0,xe.vL)(this._scene,Le.editPanel);if(!gn){console.warn(`Panel ${Le.editPanel} not found`);return}if(this._scene.state.viewPanelScene&&this._scene.setState({viewPanelScene:void 0}),At||this._scene.onEnterEditMode(),(0,xe.Yr)(gn)){this._handleLibraryPanel(gn,Bn=>{this._scene.setState({editPanel:(0,Qn.L)(Bn)})});return}qt.editPanel=(0,Qn.L)(gn)}else kt&&Le.editPanel===null&&(qt.editPanel=void 0);if(this._scene.state.body instanceof f.hy){const gn=typeof Le.autofitpanels=="string";!!this._scene.state.body.state.UNSAFE_fitPanels!==gn&&this._scene.state.body.setState({UNSAFE_fitPanels:gn})}typeof Le.kiosk=="string"&&(Le.kiosk==="true"||Le.kiosk===""?qt.kioskMode=z.KioskMode.Full:Le.kiosk==="tv"&&(qt.kioskMode=z.KioskMode.TV)),Object.keys(qt).length>0&&this._scene.setState(qt)}_buildLibraryPanelViewScene(Le){this._scene.setState({viewPanelScene:new Yo({panelRef:Le.getRef()})})}_handleLibraryPanel(Le,_e){if(!(Le.parent instanceof Et.F))throw new Error("Panel is not a child of a LibraryVizPanel");const nt=Le.parent;nt.state.isLoaded?_e(Le):(nt.subscribeToState(At=>{_e(At.panel)}),nt.activate())}_handleViewRepeatClone(Le){this._eventSub||(this._eventSub=this._scene.subscribeToEvent(Jo.d,()=>{const _e=(0,xe.vL)(this._scene,Le);_e&&(this._eventSub?.unsubscribe(),this._scene.setState({viewPanelScene:new Yo({panelRef:_e.getRef()})}))}))}}class Xo extends f.Bs{constructor(Le){super(Le),this._onActivate=()=>{const _e=this.parent;if(!_e||!(_e instanceof en))throw new Error("ResolveInspectPanelByKey must be attached to a PanelInspectDrawer");const nt=(0,xe.YQ)(_e);if(!nt)return;const At=this.state.panelKey;let kt=(0,xe.vL)(nt,At);nt.state.editPanel&&(kt=nt.state.editPanel.state.vizManager.state.panel),nt.state.viewPanelScene&&nt.state.viewPanelScene.state.body&&(kt=nt.state.viewPanelScene.state.body),kt&&_e.setState({panelRef:kt.getRef()})},this.addActivationHandler(this._onActivate)}}var Bl=e(79284),po=e(54625),zr=e(76885),Ci=e(67647),Zo=e(83277),Gi=e(2468),Io=(Ge=>(Ge[Ge.Persisted=0]="Persisted",Ge[Ge.Result=1]="Result",Ge))(Io||{});function qr(Ge){return{metadata:{name:Ge},spec:{filters:[],title:Ge,type:"",category:"",description:""}}}function Eo(Ge,Le){return{...Ge,metadata:{...Ge.metadata,...Le.metadata},spec:{...Ge.spec,...Le.spec}}}const vr="scope.grafana.app",ui="v0alpha1",Ti=s.$.namespace??"default",ll=`/apis/${vr}/${ui}/namespaces/${Ti}/find/scope_node_children`,hi=`/apis/${vr}/${ui}/namespaces/${Ti}/find/scope_dashboard_bindings`,cl=new Gi.w({group:vr,version:ui,resource:"scopes"}),Mi=new Map;async function Si(Ge,Le){try{return(await(0,K.AI)().get(ll,{parent:Ge,query:Le}))?.items??[]}catch{return[]}}async function Qi(Ge,Le){return(await Si(Ge,Le)).reduce((_e,{metadata:{name:nt},spec:At})=>(_e[nt]={name:nt,...At,isExpandable:At.nodeType==="container",isSelectable:At.linkType==="scope",isExpanded:!1,query:"",reason:Io.Result,nodes:{}},_e),{})}async function Oi(Ge){if(Mi.has(Ge))return Mi.get(Ge);const Le=new Promise(async _e=>{const nt=qr(Ge);try{const At=await cl.get(Ge),kt=Eo(nt,At);_e(kt)}catch{Mi.delete(Ge),_e(nt)}});return Mi.set(Ge,Le),Le}async function qo(Ge){return await Promise.all(Ge.map(Oi))}async function Yi(Ge){return(await qo(Ge.map(({scopeName:_e})=>_e))).reduce((_e,nt,At)=>(_e.push({scope:nt,path:Ge[At].path}),_e),[])}async function Fe(Ge){try{return(await(0,K.AI)().get(hi,{scope:Ge.map(({metadata:{name:_e}})=>_e)}))?.items??[]}catch{return[]}}async function Ve(Ge){const Le=await Fe(Ge);return Object.values(Le.reduce((_e,nt)=>(_e[nt.spec.dashboard]||(_e[nt.spec.dashboard]={dashboard:nt.spec.dashboard,dashboardTitle:nt.spec.dashboardTitle,items:[]}),_e[nt.spec.dashboard].items.push(nt),_e),{}))}class qe extends f.Bs{static{this.Component=ut}constructor(){super({dashboards:[],filteredDashboards:[],isLoading:!1,scopesSelected:!1,searchQuery:""})}async fetchDashboards(Le){if(Le.length===0)return this.setState({dashboards:[],filteredDashboards:[],isLoading:!1,scopesSelected:!1});this.setState({isLoading:!0});const _e=await Ve(Le);this.setState({dashboards:_e,filteredDashboards:this.filterDashboards(_e,this.state.searchQuery),isLoading:!1,scopesSelected:Le.length>0})}changeSearchQuery(Le){this.setState({filteredDashboards:Le?this.filterDashboards(this.state.dashboards,Le):this.state.dashboards,searchQuery:Le??""})}filterDashboards(Le,_e){const nt=_e.toLowerCase();return Le.filter(({dashboardTitle:At})=>At.toLowerCase().includes(nt))}}function ut({model:Ge}){const{dashboards:Le,filteredDashboards:_e,isLoading:nt,searchQuery:At,scopesSelected:kt}=Ge.useState(),qt=(0,Vt.of)(Tt),[gn]=(0,Zo.s)();if(!nt)if(kt){if(Le.length===0)return(0,u.jsx)("p",{className:qt.noResultsContainer,"data-testid":"scopes-dashboards-notFoundForScope",children:(0,u.jsx)(tn.x6,{i18nKey:"scopes.suggestedDashboards.noResultsForScopes",children:"No dashboards found for the selected scopes"})})}else return(0,u.jsx)("p",{className:qt.noResultsContainer,"data-testid":"scopes-dashboards-notFoundNoScopes",children:(0,u.jsx)(tn.x6,{i18nKey:"scopes.suggestedDashboards.noResultsNoScopes",children:"No scopes selected"})});return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:qt.searchInputContainer,children:(0,u.jsx)(Ci.Z,{disabled:nt,placeholder:(0,tn.t)("scopes.suggestedDashboards.search","Search"),value:At,"data-testid":"scopes-dashboards-search",onChange:Bn=>Ge.changeSearchQuery(Bn)})}),nt?(0,u.jsx)(li._,{className:qt.loadingIndicator,text:(0,tn.t)("scopes.suggestedDashboards.loading","Loading dashboards"),"data-testid":"scopes-dashboards-loading"}):_e.length>0?(0,u.jsx)(Jt.E,{children:_e.map(({dashboard:Bn,dashboardTitle:xn})=>(0,u.jsx)(po.Link,{to:zr.kM.renderUrl(`/d/${Bn}/`,gn),className:qt.dashboardItem,"data-testid":`scopes-dashboards-${Bn}`,children:xn},Bn))}):(0,u.jsxs)("p",{className:qt.noResultsContainer,"data-testid":"scopes-dashboards-notFoundForFilter",children:[(0,u.jsx)(tn.x6,{i18nKey:"scopes.suggestedDashboards.noResultsForFilter",children:"No results found for your query"}),(0,u.jsx)(T.$n,{variant:"secondary",onClick:()=>Ge.changeSearchQuery(""),"data-testid":"scopes-dashboards-notFoundForFilter-clear",children:(0,u.jsx)(tn.x6,{i18nKey:"scopes.suggestedDashboards.noResultsForFilterClear",children:"Clear search"})})]})]})}const Tt=Ge=>({noResultsContainer:(0,Te.css)({alignItems:"center",display:"flex",flexDirection:"column",gap:Ge.spacing(1),justifyContent:"center",textAlign:"center"}),searchInputContainer:(0,Te.css)({flex:"0 1 auto"}),loadingIndicator:(0,Te.css)({alignSelf:"center"}),dashboardItem:(0,Te.css)({padding:Ge.spacing(1,0),borderBottom:`1px solid ${Ge.colors.border.weak}`,"& :is(:first-child)":{paddingTop:0}})});var _t=e(65474),Zt=e(69850),dn=e(56034);function Dn({nodes:Ge,scopes:Le,isDisabled:_e,isLoading:nt,onInputClick:At,onRemoveAllClick:kt}){const qt=(0,Vt.of)(An),[gn,Bn]=(0,ee.useState)(!1);(0,ee.useEffect)(()=>{Bn(!1)},[Le]);const xn=(0,ee.useMemo)(()=>{const $s=Le.map(({scope:Xs,path:fa})=>{let ma=Ge,Ma;fa.length>0?(Ma=fa.map(va=>{const lr=ma[va];if(!lr)return null;const{title:rr,nodes:co}=lr;return ma=co,rr}).filter(va=>va!==null),Ma[0]===""&&Ma.splice(0,1)):Ma=[Xs.spec.title];const Ua=Ma.pop();return[Ma.join(" > "),Ua]}),Us=(0,ht.groupBy)($s,([Xs])=>Xs),Ta=Object.entries(Us).map(([Xs,fa])=>{const ma=fa.map(([,Ma])=>Ma).join(", ");return(Xs?[Xs,ma]:[ma]).join(" > ")}).map(Xs=>(0,u.jsx)("p",{className:qt.scopePath,children:Xs},Xs));return(0,u.jsx)(u.Fragment,{children:Ta})},[Ge,Le,qt]),gs=(0,ee.useMemo)(()=>Le.map(({scope:$s})=>$s.spec.title).join(", "),[Le]),as=(0,ee.useMemo)(()=>(0,u.jsx)(L.p,{readOnly:!0,placeholder:(0,tn.t)("scopes.filters.input.placeholder","Select scopes..."),loading:nt,value:gs,"aria-label":(0,tn.t)("scopes.filters.input.placeholder","Select scopes..."),"data-testid":"scopes-filters-input",suffix:Le.length>0&&!_e?(0,u.jsx)(Kr.K,{"aria-label":(0,tn.t)("scopes.filters.input.removeAll","Remove all scopes"),name:"times",onClick:()=>kt()}):void 0,onMouseOver:()=>Bn(!0),onMouseOut:()=>Bn(!1),onClick:()=>{_e||At()}}),[_e,nt,At,kt,Le,gs]);return(0,u.jsx)(dn.m,{content:xn,show:Le.length===0?!1:gn,children:as})}const An=Ge=>({scopePath:(0,Te.css)({color:Ge.colors.text.primary,fontSize:Ge.typography.pxToRem(14),margin:Ge.spacing(1,0)})});function rs({anyChildExpanded:Ge,query:Le,resultsNodes:_e}){const nt=(0,Vt.of)(os);return Ge?null:(0,u.jsx)("h6",{className:nt.container,"data-testid":"scopes-tree-headline",children:Le?_e.length===0?(0,u.jsx)(tn.x6,{i18nKey:"scopes.tree.headline.noResults",children:"No results found for your query"}):(0,u.jsx)(tn.x6,{i18nKey:"scopes.tree.headline.results",children:"Results"}):(0,u.jsx)(tn.x6,{i18nKey:"scopes.tree.headline.recommended",children:"Recommended"})})}const os=Ge=>({container:(0,Te.css)({color:Ge.colors.text.secondary,margin:Ge.spacing(1,0)})});var us=e(79569);function hs({anyChildExpanded:Ge,loadingNodeName:Le,node:_e,nodePath:nt,nodes:At,scopeNames:kt,scopes:qt,type:gn,onNodeSelectToggle:Bn,onNodeUpdate:xn}){const gs=(0,Vt.of)(Js);return(0,u.jsx)("div",{role:"tree",children:At.map(as=>{const $s=as.isSelectable&&kt.includes(as.linkId);if(Ge&&!as.isExpanded)return null;const Us=[...nt,as.name],Ta=Us.join(".");return(0,u.jsxs)("div",{role:"treeitem","aria-selected":as.isExpanded,children:[(0,u.jsxs)("div",{className:gs.title,children:[as.isSelectable&&!as.isExpanded?_e.disableMultiSelect?(0,u.jsx)(us.J,{id:Ta,name:Ta,checked:$s,label:"","data-testid":`scopes-tree-${gn}-${as.name}-radio`,onClick:()=>{Bn(Us)}}):(0,u.jsx)(de.S,{checked:$s,"data-testid":`scopes-tree-${gn}-${as.name}-checkbox`,onChange:()=>{Bn(Us)}}):null,as.isExpandable?(0,u.jsxs)("button",{className:gs.expand,"data-testid":`scopes-tree-${gn}-${as.name}-expand`,"aria-label":as.isExpanded?(0,tn.t)("scopes.tree.collapse","Collapse"):(0,tn.t)("scopes.tree.expand","Expand"),onClick:()=>{xn(Us,!as.isExpanded,as.query)},children:[(0,u.jsx)(un.I,{name:as.isExpanded?"angle-down":"angle-right"}),as.title]}):(0,u.jsx)("span",{"data-testid":`scopes-tree-${gn}-${as.name}-title`,children:as.title})]}),(0,u.jsx)("div",{className:gs.children,children:as.isExpanded&&(0,u.jsx)(ta,{nodes:_e.nodes,nodePath:Us,loadingNodeName:Le,scopes:qt,onNodeUpdate:xn,onNodeSelectToggle:Bn})})]},as.name)})})}const Js=Ge=>({title:(0,Te.css)({alignItems:"center",display:"flex",gap:Ge.spacing(1),fontSize:Ge.typography.pxToRem(14),lineHeight:Ge.typography.pxToRem(22),padding:Ge.spacing(.5,0),"& > label":(0,Te.css)({gap:0})}),expand:(0,Te.css)({alignItems:"center",background:"none",border:0,display:"flex",gap:Ge.spacing(1),margin:0,padding:0}),children:(0,Te.css)({paddingLeft:Ge.spacing(4)})});var Os=e(70255);function vs({children:Ge,isNodeLoading:Le}){const _e=(0,Vt.of)(Cs);return Le?(0,u.jsx)(Os.A,{count:5,className:_e.loader}):Ge}const Cs=Ge=>({loader:(0,Te.css)({margin:Ge.spacing(.5,0)})});var ea=e(40996);function oa({anyChildExpanded:Ge,nodePath:Le,query:_e,onNodeUpdate:nt}){const At=(0,Vt.of)(As),[kt,qt]=(0,ee.useState)({value:_e,isDirty:!1});return(0,ee.useEffect)(()=>{!kt.isDirty&&kt.value!==_e&&qt({value:_e,isDirty:!1})},[kt,_e]),(0,ea.A)(()=>{kt.isDirty&&nt(Le,!0,kt.value)},500,[kt.isDirty,kt.value]),Ge?null:(0,u.jsx)(Ci.Z,{placeholder:(0,tn.t)("scopes.tree.search","Search"),value:kt.value,className:At.input,"data-testid":"scopes-tree-search",onChange:gn=>{qt({value:gn,isDirty:!0})}})}const As=Ge=>({input:(0,Te.css)({margin:Ge.spacing(1,0)})});function ta({nodes:Ge,nodePath:Le,loadingNodeName:_e,scopes:nt,onNodeUpdate:At,onNodeSelectToggle:kt}){const qt=Le[Le.length-1],gn=Ge[qt],Bn=Object.values(gn.nodes),xn=_e===qt,gs=nt.map(({scopeName:Us})=>Us),as=Bn.some(({isExpanded:Us})=>Us),$s=(0,ee.useMemo)(()=>(0,ht.groupBy)(Bn,"reason"),[Bn]);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(oa,{anyChildExpanded:as,nodePath:Le,query:gn.query,onNodeUpdate:At}),(0,u.jsxs)(vs,{isNodeLoading:xn,children:[(0,u.jsx)(hs,{anyChildExpanded:as,isNodeLoading:xn,loadingNodeName:_e,node:gn,nodePath:Le,nodes:$s[Io.Persisted]??[],scopes:nt,scopeNames:gs,type:"persisted",onNodeSelectToggle:kt,onNodeUpdate:At}),(0,u.jsx)(rs,{anyChildExpanded:as,query:gn.query,resultsNodes:$s[Io.Result]??[]}),(0,u.jsx)(hs,{anyChildExpanded:as,isNodeLoading:xn,loadingNodeName:_e,node:gn,nodePath:Le,nodes:$s[Io.Result]??[],scopes:nt,scopeNames:gs,type:"result",onNodeSelectToggle:kt,onNodeUpdate:At})]})]})}class Ra extends f.Bs{constructor(){super({nodes:{"":{name:"",reason:Io.Result,nodeType:"container",title:"",isExpandable:!0,isSelectable:!1,isExpanded:!0,query:"",nodes:{}}},loadingNodeName:void 0,scopes:[],treeScopes:[],isLoadingScopes:!1,isOpened:!1}),this._urlSync=new f.So(this,{keys:["scopes"]}),this.addActivationHandler(()=>(this.fetchBaseNodes(),()=>{this.nodesFetchingSub?.unsubscribe()}))}static{this.Component=Ga}get scopesParent(){return f.jh.getAncestor(this,La)}getUrlState(){return{scopes:this.state.scopes.map(({scope:Le})=>Le.metadata.name)}}updateFromUrl(Le){let _e=Le.scopes??[];_e=Array.isArray(_e)?_e:[_e],this.updateScopes(_e.map(nt=>({scopeName:nt,path:[]})))}fetchBaseNodes(){return this.updateNode([""],!0,"")}async updateNode(Le,_e,nt){this.nodesFetchingSub?.unsubscribe();let At={...this.state.nodes},kt=At;for(let xn=0;xn<Le.length-1;xn++)kt=kt[Le[xn]].nodes;const qt=Le[Le.length-1],gn=kt[qt],Bn=gn.query!==nt;gn.isExpanded=_e,gn.query=nt,_e||Bn?(this.setState({nodes:At,loadingNodeName:qt}),this.nodesFetchingSub=(0,_t.H)(Qi(qt,nt)).pipe((0,Zt.j)(()=>{this.setState({loadingNodeName:void 0})})).subscribe(xn=>{const gs=this.state.treeScopes.map(({path:as})=>as[as.length-1]).filter(as=>as in gn.nodes&&!(as in xn)).reduce((as,$s)=>(as[$s]={...gn.nodes[$s],reason:Io.Persisted},as),{});gn.nodes={...gs,...xn},this.setState({nodes:At}),this.nodesFetchingSub?.unsubscribe()})):this.setState({nodes:At,loadingNodeName:void 0})}toggleNodeSelect(Le){let _e=[...this.state.treeScopes],nt=this.state.nodes[""];for(let gn=1;gn<Le.length-1;gn++)nt=nt.nodes[Le[gn]];const At=Le[Le.length-1],{linkId:kt}=nt.nodes[At],qt=_e.findIndex(({scopeName:gn})=>gn===kt);if(qt===-1){Oi(kt);const gn=_e.length===0||Object.values(nt.nodes).some(({linkId:xn})=>xn===_e[0].scopeName),Bn={scopeName:kt,path:Le};this.setState({treeScopes:nt?.disableMultiSelect||!gn?[Bn]:[..._e,Bn]})}else _e.splice(qt,1),this.setState({treeScopes:_e})}open(){if(!this.scopesParent.state.isViewing){let Le={...this.state.nodes};Le=this.closeNodes(Le);let _e=[...this.state.scopes[0]?.path??["",""]];_e.splice(_e.length-1,1),Le=this.expandNodes(Le,_e),this.setState({isOpened:!0,nodes:Le})}}close(){this.setState({isOpened:!1})}getSelectedScopes(){return this.state.scopes.map(({scope:Le})=>Le)}async updateScopes(Le=this.state.treeScopes){if((0,ht.isEqual)(Le,this.getTreeScopes()))return;this.setState({scopes:Le.map(({scopeName:nt,path:At})=>({scope:qr(nt),path:At})),treeScopes:Le,isLoadingScopes:!0});const _e=await Yi(Le);this.setState({scopes:_e,isLoadingScopes:!1})}resetDirtyScopeNames(){this.setState({treeScopes:this.getTreeScopes()})}removeAllScopes(){this.setState({scopes:[],treeScopes:[],isLoadingScopes:!1})}enterViewMode(){this.setState({isOpened:!1})}closeNodes(Le){return Object.entries(Le).reduce((_e,[nt,At])=>(_e[nt]={...At,isExpanded:!1,nodes:this.closeNodes(At.nodes)},_e),{})}expandNodes(Le,_e){Le={...Le};let nt=Le;for(let At=0;At<_e.length;At++){const kt=_e[At];nt[kt]={...nt[kt],isExpanded:!0},nt=nt[kt].nodes}return Le}getTreeScopes(){return this.state.scopes.map(({scope:Le,path:_e})=>({scopeName:Le.metadata.name,path:_e}))}}function Ga({model:Ge}){const Le=(0,Vt.of)(ar),{nodes:_e,loadingNodeName:nt,treeScopes:At,isLoadingScopes:kt,isOpened:qt,scopes:gn}=Ge.useState(),{isViewing:Bn}=Ge.scopesParent.useState();return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(Dn,{nodes:_e,scopes:gn,isDisabled:Bn,isLoading:kt,onInputClick:()=>Ge.open(),onRemoveAllClick:()=>Ge.removeAllScopes()}),qt&&(0,u.jsxs)(x._,{title:(0,tn.t)("scopes.filters.title","Select scopes"),size:"sm",onClose:()=>{Ge.close(),Ge.resetDirtyScopeNames()},children:[kt?(0,u.jsx)(hn.y,{"data-testid":"scopes-filters-loading"}):(0,u.jsx)(ta,{nodes:_e,nodePath:[""],loadingNodeName:nt,scopes:At,onNodeUpdate:(xn,gs,as)=>Ge.updateNode(xn,gs,as),onNodeSelectToggle:xn=>Ge.toggleNodeSelect(xn)}),(0,u.jsxs)("div",{className:Le.buttonGroup,children:[(0,u.jsx)(T.$n,{variant:"primary","data-testid":"scopes-filters-apply",onClick:()=>{Ge.close(),Ge.updateScopes()},children:(0,u.jsx)(tn.x6,{i18nKey:"scopes.filters.apply",children:"Apply"})}),(0,u.jsx)(T.$n,{variant:"secondary","data-testid":"scopes-filters-cancel",onClick:()=>{Ge.close(),Ge.resetDirtyScopeNames()},children:(0,u.jsx)(tn.x6,{i18nKey:"scopes.filters.cancel",children:"Cancel"})})]})]})]})}const ar=Ge=>({buttonGroup:(0,Te.css)({display:"flex",gap:Ge.spacing(1),marginTop:Ge.spacing(8)})});class La extends f.Bs{static{this.Component=na}constructor(){super({dashboards:new qe,filters:new Ra,isExpanded:!1,isViewing:!1}),this.addActivationHandler(()=>{this._subs.add(this.state.filters.subscribeToState((Le,_e)=>{!Le.isLoadingScopes&&Le.scopes!==_e.scopes&&(this.state.isExpanded&&this.state.dashboards.fetchDashboards(this.state.filters.getSelectedScopes()),f.jh.getTimeRange(this.parent).onRefresh())})),this._subs.add(this.parent?.subscribeToState(Le=>{const _e="isEditing"in Le?!!Le.isEditing:!1;_e!==this.state.isViewing&&(_e?this.enterViewMode():this.exitViewMode())}))})}getSelectedScopes(){return this.state.filters.getSelectedScopes()}toggleIsExpanded(){const Le=!this.state.isExpanded;Le&&this.state.dashboards.fetchDashboards(this.getSelectedScopes()),this.setState({isExpanded:Le})}enterViewMode(){this.setState({isExpanded:!1,isViewing:!0}),this.state.filters.enterViewMode()}exitViewMode(){this.setState({isViewing:!1})}}function na({model:Ge}){const{filters:Le,dashboards:_e,isExpanded:nt,isViewing:At}=Ge.useState(),kt=(0,Vt.of)(Or);return(0,u.jsxs)("div",{className:(0,Te.cx)(kt.container,nt&&kt.containerExpanded),children:[(0,u.jsxs)("div",{className:(0,Te.cx)(kt.filtersContainer,nt&&kt.filtersContainerExpanded),children:[!At&&(0,u.jsx)(Kr.K,{name:"arrow-to-right",className:(0,Te.cx)(!nt&&kt.iconNotExpanded),"aria-label":nt?(0,tn.t)("scopes.suggestedDashboards.toggle.collapse","Collapse scope filters"):(0,tn.t)("scopes.suggestedDashboards.toggle..expand","Expand scope filters"),"data-testid":"scopes-dashboards-expand",onClick:()=>Ge.toggleIsExpanded()}),(0,u.jsx)(Le.Component,{model:Le})]}),nt&&!At&&(0,u.jsx)("div",{className:kt.dashboardsContainer,"data-testid":"scopes-dashboards-container",children:(0,u.jsx)(_e.Component,{model:_e})})]})}const Or=Ge=>({container:(0,Te.css)({display:"flex",flexDirection:"column",gridArea:"scopes"}),containerExpanded:(0,Te.css)({backgroundColor:Ge.colors.background.primary,height:"100%"}),filtersContainer:(0,Te.css)({display:"flex",flex:"0 1 auto",flexDirection:"row",padding:Ge.spacing(2,2,2,2)}),filtersContainerExpanded:(0,Te.css)({borderBottom:`1px solid ${Ge.colors.border.weak}`,padding:Ge.spacing(2)}),iconNotExpanded:(0,Te.css)({transform:"scaleX(-1)"}),dashboardsContainer:(0,Te.css)({display:"flex",flex:"1 1 auto",flexDirection:"column",gap:Ge.spacing(3),overflow:"hidden",padding:Ge.spacing(2)})});var Lr=e(69129),qa=e(4898);class _r{constructor(){this._binds=[]}addBinding(Le){qa.R.bind(Le.key,_e=>{_e.preventDefault(),_e.stopPropagation(),_e.returnValue=!1,Le.onTrigger()},"keydown"),this._binds.push(Le)}removeAll(){this._binds.forEach(Le=>{qa.R.unbind(Le.key,Le.type)}),this._binds=[]}}var io=e(85174),Pr=e(7196);function lo(Ge){const Le=new _r;let _e=null;const nt=Ge.canEditDashboard(),At=a.A.subscribe(Lr.Tp,qt=>{typeof qt.payload.panelId=="string"&&(_e=qt.payload.panelId)});function kt(qt,gn){return()=>{const Bn=f.jh.findObject(qt,xn=>xn.state.key===_e);if(Bn&&Bn instanceof f.Eb){gn(Bn);return}}}return Le.addBinding({key:"v",onTrigger:kt(Ge,qt=>{Ge.state.viewPanelScene||r.Ny.push((0,at.r7)(qt))})}),Le.addBinding({key:"p s",onTrigger:kt(Ge,async qt=>{Ge.showModal(new io.Z({panelRef:qt.getRef()}))})}),Le.addBinding({key:"i",onTrigger:kt(Ge,async qt=>{r.Ny.push((0,at.Uu)(qt))})}),Le.addBinding({key:"p x",onTrigger:kt(Ge,async qt=>{const gn=await(0,at.Lp)(qt);gn&&r.Ny.push(gn)})}),Le.addBinding({key:"p l",onTrigger:kt(Ge,Pr.vR)}),Le.addBinding({key:"d r",onTrigger:()=>f.jh.getTimeRange(Ge).onRefresh()}),Le.addBinding({key:"t z",onTrigger:()=>{ir(Ge)}}),Le.addBinding({key:"ctrl+z",onTrigger:()=>{ir(Ge)}}),Le.addBinding({key:"t a",onTrigger:()=>{Ie.b4.getTimePicker(Ge)?.toAbsolute()}}),Le.addBinding({key:"t left",onTrigger:()=>{ss(Ge,"left")}}),Le.addBinding({key:"t right",onTrigger:()=>{ss(Ge,"right")}}),nt&&(Le.addBinding({key:"e",onTrigger:kt(Ge,async qt=>{if(qt.getRoot()instanceof Ds){const Bn=(0,xe.Cs)(qt);Ge.state.editPanel||r.Ny.push((0,at.e0)(Bn))}})}),Le.addBinding({key:"d s",onTrigger:Ge.onOpenSettings}),Le.addBinding({key:"mod+s",onTrigger:()=>Ge.openSaveDrawer({})}),Le.addBinding({key:"p r",onTrigger:kt(Ge,qt=>{Ge.state.isEditing&&(0,Pr.MI)(Ge,qt)})}),Le.addBinding({key:"p d",onTrigger:kt(Ge,qt=>{Ge.state.isEditing&&Ge.duplicatePanel(qt)})}),Le.addBinding({key:"d shift+c",onTrigger:()=>{Ge.collapseAllRows()}}),Le.addBinding({key:"d shift+e",onTrigger:()=>{Ge.expandAllRows()}})),()=>{Le.removeAll(),At.unsubscribe()}}function ir(Ge){Ie.b4.getTimePicker(Ge)?.onZoom()}function ss(Ge,Le){const _e=Ie.b4.getTimePicker(Ge);_e&&(Le==="left"&&_e.onMoveBackward(),Le==="right"&&_e.onMoveForward())}const ws=["title","description","tags","editable","graphTooltip","links","meta","preload"];class Ds extends f.Bs{constructor(Le){super({title:"Dashboard",meta:{},editable:!0,body:Le.body??new f.G1({children:[]}),links:Le.links??[],scopes:Le.uid&&s.$.featureToggles.scopeFilters?new La:void 0,...Le}),this._urlSync=new xo(this),this._variableDependency=new Ws(this),this._fromExplore=!1,this.onEnterEditMode=(_e=!1)=>{this._fromExplore=_e,this._initialState=f.Go.cloneSceneObjectState(this.state),this._initialUrlState=r.Ny.getLocation(),this.setState({isEditing:!0}),this.propagateEditModeChange(),this._changeTracker.startTrackingChanges()},this.onRestore=async _e=>{const nt=await xt.wL.restoreDashboard(_e.uid,_e.version);if(!Number.isInteger(nt.version))return!1;const At={dashboard:new l.G(_e.data),meta:this.state.meta},kt=(0,pt.wM)(At),qt=f.Go.cloneSceneObjectState(kt.state);return qt.version=nt.version,this.setState(qt),this.exitEditMode({skipConfirm:!0,restoreInitialState:!1}),!0},this.onOpenSettings=()=>{r.Ny.partial({editview:"settings"})},this._changeTracker=new v.l(this),this.addActivationHandler(()=>this._activationHandler())}static{this.Component=_n}_activationHandler(){let Le=window.__grafanaSceneContext;window.__grafanaSceneContext=this,this.state.isEditing&&(this._initialUrlState=r.Ny.getLocation(),this._changeTracker.startTrackingChanges()),this.state.meta.isNew&&(this.onEnterEditMode(),this.setState({isDirty:!0})),!this.state.meta.isEmbedded&&this.state.uid&&p.t.watch(this.state.uid);let _e=()=>{};s.$.publicDashboardAccessToken||(_e=lo(this));const nt=new Ae(this);return(0,g.UA)().setCurrent(nt),()=>{window.__grafanaSceneContext=Le,_e(),this._changeTracker.terminate(),nt.destroy(),p.t.leave()}}saveCompleted(Le,_e,nt){this._initialSaveModel={...Le,id:_e.id,uid:_e.uid,version:_e.version},this._changeTracker.stopTrackingChanges(),this.setState({version:_e.version,isDirty:!1,uid:_e.uid,id:_e.id,meta:{...this.state.meta,uid:_e.uid,url:_e.url,slug:_e.slug,folderUid:nt,isNew:!1}}),this._changeTracker.startTrackingChanges()}propagateEditModeChange(){this.state.body instanceof f.hy&&(this.state.body.setState({isDraggable:this.state.isEditing,isResizable:this.state.isEditing}),(0,xe.X0)(this.state.body,!0))}exitEditMode({skipConfirm:Le,restoreInitialState:_e}){if(!this.canDiscard()){console.error("Trying to discard back to a state that does not exist, initialState undefined");return}if(!this.state.isDirty||Le){this.exitEditModeConfirmed(_e||this.state.isDirty);return}a.A.publish(new d.bY({title:"Discard changes to dashboard?",text:"You have unsaved changes to this dashboard. Are you sure you want to discard them?",icon:"trash-alt",yesText:"Discard",onConfirm:this.exitEditModeConfirmed.bind(this)}))}exitEditModeConfirmed(Le=!0){this._changeTracker.stopTrackingChanges(),r.Ny.replace(t.I.getUrlForPartial(this._initialUrlState,{editPanel:null,editview:null,inspect:null,inspectTab:null})),this._fromExplore&&this.cleanupStateFromExplore(),Le?this.setState({...this._initialState,isEditing:!1}):this.setState({isEditing:!1}),this.state.editPanel&&this.state.editPanel.onDiscard(),this.propagateEditModeChange()}cleanupStateFromExplore(){this._fromExplore=!1,this._initialSaveModel?.panels&&(this._initialSaveModel.panels=this._initialSaveModel.panels.slice(1)),this._initialState&&this._initialState.body instanceof f.hy&&this._initialState.body.setState({children:this._initialState.body.state.children.slice(1)})}canDiscard(){return this._initialState!==void 0}pauseTrackingChanges(){this._changeTracker.stopTrackingChanges()}resumeTrackingChanges(){this._changeTracker.startTrackingChanges()}openSaveDrawer({saveAsCopy:Le,onSaveSuccess:_e}){this.state.isEditing&&this.setState({overlay:new st({dashboardRef:this.getRef(),saveAsCopy:Le,onSaveSuccess:_e})})}getPageNav(Le,_e){const{meta:nt,viewPanelScene:At,editPanel:kt}=this.state;if(nt.dashboardNotFound)return{text:"Not found"};let qt={text:this.state.title,url:(0,at.uZ)({uid:this.state.uid,slug:nt.slug,currentQueryParams:Le.search,updateQuery:{viewPanel:null,inspect:null,editview:null,editPanel:null,tab:null},isHomeDashboard:!nt.url&&!nt.slug&&!nt.isNew})};const{folderUid:gn}=nt;if(gn){const Bn=(0,o.tc)(_e,`folder-dashboards-${gn}`).main;Bn.id!=="not-found"&&(qt={...qt,parentItem:Bn})}return At&&(qt={text:"View panel",parentItem:qt,url:(0,at.r7)(At.state.panelRef.resolve())}),kt&&(qt={text:"Edit panel",parentItem:qt}),qt}getBodyToRender(){return this.state.viewPanelScene??this.state.body}getInitialState(){return this._initialState}addRow(Le){if(!(this.state.body instanceof f.hy))throw new Error("Trying to add a panel in a layout that is not SceneGridLayout");const _e=this.state.body,nt=_e.state.children.findIndex(kt=>kt instanceof f.tI),At=_e.state.children.splice(0,nt===-1?_e.state.children.length:nt).map(kt=>kt.clone());At&&Le.setState({children:At}),_e.setState({children:[Le,..._e.state.children]})}removeRow(Le,_e=!1){if(!(this.state.body instanceof f.hy))throw new Error("Trying to add a panel in a layout that is not SceneGridLayout");const nt=this.state.body,At=nt.state.children.filter(kt=>kt.state.key!==Le.state.key);if(!_e){const kt=Le.state.children.map(gn=>gn.clone()),qt=nt.state.children.findIndex(gn=>gn.state.key===Le.state.key);At.splice(qt,0,...kt)}nt.setState({children:At})}addPanel(Le){if(!(this.state.body instanceof f.hy))throw new Error("Trying to add a panel in a layout that is not SceneGridLayout");const _e=this.state.body,nt=(0,xe.Cs)(Le),At=new ye.U({height:xe.sw,width:xe.vm,x:0,y:0,body:Le,key:`grid-item-${nt}`});_e.setState({children:[At,..._e.state.children]})}createLibraryPanel(Le,_e){if(!(this.state.body instanceof f.hy))throw new Error("Trying to add a panel in a layout that is not SceneGridLayout");const At=Le.state.key,kt=new Et.F({title:_e.model?.title??"Panel",uid:_e.uid,name:_e.name,panelKey:At??(0,xe.XA)(Ie.b4.getNextPanelId(this))}),qt=Le.parent;if(!(qt instanceof ye.U))throw new Error("Trying to replace a panel that doesn't have a parent grid item");qt.setState({body:kt})}duplicatePanel(Le){if(!Le.parent)return;const _e=(0,Ie.WZ)(Le),nt=_e?_e.parent:Le.parent;if(!(nt instanceof ye.U)){console.error("Trying to duplicate a panel in a layout that is not DashboardGridItem");return}let At,kt,qt;const gn=Ie.b4.getNextPanelId(this);if(_e){const xn=f.Go.cloneSceneObjectState(nt.state);qt=new ye.U({x:xn.x,y:xn.y,width:xn.width,height:xn.height,body:new Et.F({title:_e.state.title,uid:_e.state.uid,name:_e.state.name,panelKey:(0,xe.XA)(gn)})})}else nt instanceof ye.U?(At=f.Go.cloneSceneObjectState(nt.state.body.state),kt=f.jh.getData(nt.state.body).clone()):(At=f.Go.cloneSceneObjectState(Le.state),kt=f.jh.getData(Le).clone()),delete kt.state.data?.alertState,qt=new ye.U({x:nt.state.x,y:nt.state.y,height:nt.state.height,width:nt.state.width,body:new f.Eb({...At,$data:kt,key:(0,xe.XA)(gn)})});if(!(this.state.body instanceof f.hy)){console.error("Trying to duplicate a panel in a layout that is not SceneGridLayout ");return}const Bn=this.state.body;if(nt.parent instanceof f.tI){const xn=nt.parent;xn.setState({children:[...xn.state.children,qt]}),Bn.forceRender();return}Bn.setState({children:[...Bn.state.children,qt]})}copyPanel(Le){if(!Le.parent)return;let _e=Le.parent;if(Le.parent instanceof Et.F){const At=Le.parent;if(!At.parent)return;_e=At.parent}if(!(_e instanceof ye.U))throw console.error("Trying to copy a panel that is not DashboardGridItem child"),new Error("Trying to copy a panel that is not DashboardGridItem child");const nt=(0,Ke.ZB)(_e);h.A.set(c.tH,JSON.stringify(nt)),a.A.emit(n.r1.alertSuccess,["Panel copied. Use **Paste panel** toolbar action to paste."])}pastePanel(){if(!(this.state.body instanceof f.hy))throw new Error("Trying to add a panel in a layout that is not SceneGridLayout");const Le=h.A.get(c.tH),_e=JSON.parse(Le),nt=new l.a(_e),At=nt.libraryPanel?(0,pt.Al)(nt):(0,pt.tt)(nt),kt=this.state.body;if(!(At instanceof ye.U))throw new Error("Cannot paste invalid grid item");const qt=Ie.b4.getNextPanelId(this);if(At instanceof ye.U&&At.state.body instanceof Et.F){const gn=(0,xe.XA)(qt);At.state.body.setState({panelKey:gn});const Bn=At.state.body.state.panel;Bn instanceof f.Eb&&Bn.setState({key:gn})}else At instanceof ye.U&&At.state.body?At.state.body.setState({key:(0,xe.XA)(qt)}):At instanceof ye.U&&At.state.body.setState({key:(0,xe.XA)(qt)});At.setState({height:xe.sw,width:xe.vm,x:0,y:0,key:`grid-item-${qt}`}),kt.setState({children:[At,...kt.state.children]}),h.A.delete(c.tH)}removePanel(Le){const _e=[],nt=Le.parent instanceof Et.F?Le.parent.parent?.state.key:Le.parent?.state.key;if(!nt)return;let At;try{At=f.jh.getAncestor(Le,f.tI)}catch{At=void 0}if(At){At.state.children.forEach(qt=>{qt.state.key!==nt&&_e.push(qt)}),At.setState({children:_e}),this.state.body.forceRender();return}this.state.body.forEachChild(qt=>{qt.state.key!==nt&&_e.push(qt)});const kt=this.state.body;(kt instanceof f.hy||kt instanceof f.G1)&&kt.setState({children:_e})}unlinkLibraryPanel(Le){if(!Le.parent)return;const _e=Le.parent;if(!(_e instanceof ye.U)){console.error("Trying to unlinka a lib panel in a layout that is not DashboardGridItem");return}_e?.setState({body:Le.state.panel?.clone()})}showModal(Le){this.setState({overlay:Le})}closeModal(){this.setState({overlay:void 0})}async onStarDashboard(){const{meta:Le,uid:_e}=this.state;if(_e)try{const nt=await(0,g.UA)().starDashboard(_e,!!Le.isStarred);this.setState({meta:{...Le,isStarred:nt}})}catch(nt){console.error("Failed to star dashboard",nt)}}onShowAddLibraryPanelDrawer(Le){this.setState({overlay:new ft.o({panelToReplaceRef:Le})})}onCreateNewRow(){const Le=(0,xe.Ws)(this);return this.addRow(Le),(0,xe.Cs)(Le)}onCreateNewPanel(){this.state.isEditing||this.onEnterEditMode();const Le=(0,xe.O8)(this);return this.addPanel(Le),Le}enrichDataRequest(Le){const _e=(0,xe.YQ)(Le);let nt=(0,xe.xz)(Le);_e.state.isEditing&&_e.state.editPanel&&(nt=_e.state.editPanel.state.vizManager.state.panel);let At=0;return nt&&nt.state.key&&((0,xe.SN)(nt.state.key)?At=Qe(nt?.state.key):At=(0,xe.Cs)(nt)),{app:i.Jk.Dashboard,dashboardUID:this.state.uid,panelId:At,panelPluginId:nt?.state.pluginId,scopes:this.state.scopes?.getSelectedScopes()}}enrichFiltersRequest(){return{scopes:this.state.scopes?.getSelectedScopes()}}canEditDashboard(){const{meta:Le}=this.state;return!!(Le.canEdit||Le.canMakeEditable)}getInitialSaveModel(){return this._initialSaveModel}setInitialSaveModel(Le){this._initialSaveModel=Le}async deleteDashboard(){await(0,m.A_)(this.state.uid,!0),this.setState({isDirty:!1}),r.Ny.replace("/")}collapseAllRows(){if(!(this.state.body instanceof f.hy))throw new Error("Dashboard scene layout is not SceneGridLayout");const Le=this.state.body;Le.state.children.forEach(_e=>{_e instanceof f.tI&&(_e.state.isCollapsed||Le.toggleRow(_e))})}expandAllRows(){if(!(this.state.body instanceof f.hy))throw new Error("Dashboard scene layout is not SceneGridLayout");const Le=this.state.body;Le.state.children.forEach(_e=>{_e instanceof f.tI&&_e.state.isCollapsed&&Le.toggleRow(_e)})}}class Ws{constructor(Le){this._dashboard=Le,this._emptySet=new Set}getNames(){return this._emptySet}hasDependencyOn(){return!1}variableUpdateCompleted(Le,_e){_e&&a.A.publish(new y.og({refreshAll:!0,panelIds:[]}));const nt=this._dashboard.state.body;if(nt instanceof f.hy){for(const At of nt.state.children)if(!(!(At instanceof f.tI)||!At.state.$behaviors))for(const kt of At.state.$behaviors)kt instanceof Bl.L&&(kt.isWaitingForVariables||kt.state.variableName===Le.state.name&&_e)&&kt.performRepeat()}}}},60656:(G,O,e)=>{"use strict";e.d(O,{F:()=>h});var t=e(74848),n=e(80943),i=e(34214),s=e(57767),r=e(96556),f=e(41507),a=e(42397),c=e(7196),o=e(99589);class h extends n.Bs{constructor(m){super({panel:m.panel??g(m.title,m.panelKey),isLoaded:m.isLoaded??!1,...m}),this._onActivate=()=>{this.state.isLoaded||this.loadLibraryPanelFromPanelModel()},this.addActivationHandler(this._onActivate)}static{this.Component=l}setPanelFromLibPanel(m){if(this.state._loadedPanel?.version===m.version)return;const y=new i.a(m.model),d={title:y.title,key:this.state.panelKey,options:y.options??{},fieldConfig:y.fieldConfig,pluginId:y.type,pluginVersion:y.pluginVersion,displayMode:y.transparent?"transparent":void 0,description:y.description,hoverHeader:!y.title&&!y.timeFrom&&!y.timeShift,hoverHeaderOffset:0,$data:(0,r.w)(y),menu:new n.Lw({$behaviors:[c._i]}),titleItems:[new a.$({rawLinks:y.links,menu:new a.m({$behaviors:[c.oV]})}),new o.W]},v=new n.Eb(d);this.setState({panel:v,_loadedPanel:m,isLoaded:!0,name:m.name})}async loadLibraryPanelFromPanelModel(){let m=this.state.panel;try{const y=await(0,s.Yr)(this.state.uid,!0);this.setPanelFromLibPanel(y),this.parent instanceof f.U&&this.parent.setState({variableName:y.model.repeat,repeatDirection:y.model.repeatDirection==="h"?"h":"v",maxPerRow:y.model.maxPerRow})}catch{m.setState({_pluginLoadError:`Unable to load library panel: ${this.state.uid}`})}}}function g(p,m){return new n.Eb({key:m,title:p,menu:new n.Lw({$behaviors:[c._i]})})}function l({model:p}){const{panel:m}=p.useState();return m?(0,t.jsx)(m.Component,{model:m}):null}},47150:(G,O,e)=>{"use strict";e.d(O,{c:()=>Xa});var t=e(74848),n=e(96540),i=e(32196),s=e(68941),r=e(13544),f=e(32264),a=e(12131),c=e(40845),o=e(27746),h=e(14578),g=e(39938),l=e(83122),p=e(38138),m=e(55852),y=e(19727),d=e(15068),v=e(75269),u=e(10804),D=e(15054),P=e(10096),x=e(8484),E=e(14792),C=e(2609),M=e(19293),S=e(22699),I=e(7758),T=e(80943),b=e(87978),R=e(74730);const A=(0,n.createContext)(void 0),L=()=>{const en=(0,n.useContext)(A);if(en===void 0)throw new Error("useShareDrawerContext must be used within a DrawerContext");return en};class U extends T.Bs{constructor(){super(...arguments),this.onDismiss=()=>{(0,R.YQ)(this).closeModal()}}static{this.Component=W}}function W({model:en}){const{title:$n,body:Qn}=en.useState(),Gn=(0,R.YQ)(en);return(0,t.jsx)(b._,{title:$n,onClose:en.onDismiss,size:"md",children:(0,t.jsx)(A.Provider,{value:{dashboard:Gn},children:(0,t.jsx)(Qn.Component,{model:Qn})})})}var w=e(16817),N=e(70713),B=e(67061),V=e(15292),K=e(60029),H=e(32372),X=e(62930),k=e(10534),Y=e(82467),Z=e(3169),se=e(99140),j=e(50056);const q=r.Tp.pages.ExportDashboardDrawer.ExportAsJson;class ne extends j.N{static{this.Component=oe}}function oe({model:en}){const $n=(0,R.YQ)(en),Qn=(0,c.of)(z),{isSharingExternally:Gn}=en.useState(),qn=(0,w.A)(async()=>{const _s=await en.getExportableDashboardJson();return JSON.stringify(_s,null,2)},[Gn]),es=async()=>{await en.onSaveAsFile();const _s=(0,x.t)("export.json.download-successful_toast_message","Your JSON has been downloaded");(0,se.JD)((0,Y.dx)((0,Z.tZ)(_s)))},Ss=(0,x.t)("export.json.export-externally-label","Export the dashboard to use in another instance");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{children:(0,t.jsx)(x.x6,{i18nKey:"export.json.info-text",children:"Copy or download a JSON file containing the JSON of your dashboard"})}),(0,t.jsxs)(B.B,{gap:1,alignItems:"center",children:[(0,t.jsx)(V.d,{label:Ss,"data-testid":q.exportExternallyToggle,id:"export-externally-toggle",value:Gn,onChange:en.onShareExternallyChange}),(0,t.jsx)(K.J,{children:Ss})]}),(0,t.jsx)(N.Ay,{disableHeight:!0,className:Qn.codeEditorBox,"data-testid":q.codeEditor,children:({width:_s})=>qn.value?(0,t.jsx)(H.B,{value:qn.value,language:"json",showMiniMap:!1,height:"500px",width:_s,readOnly:!0}):qn.loading&&(0,t.jsx)(X.y,{})}),(0,t.jsx)("div",{className:Qn.container,children:(0,t.jsxs)(B.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:[(0,t.jsx)(m.$n,{"data-testid":q.saveToFileButton,variant:"primary",icon:"download-alt",onClick:es,children:(0,t.jsx)(x.x6,{i18nKey:"export.json.download-button",children:"Download file"})}),(0,t.jsx)(k.b,{"data-testid":q.copyToClipboardButton,variant:"secondary",icon:"copy",disabled:qn.loading,getText:()=>qn.value??"",children:(0,t.jsx)(x.x6,{i18nKey:"export.json.copy-button",children:"Copy to clipboard"})}),(0,t.jsx)(m.$n,{"data-testid":q.cancelButton,variant:"secondary",onClick:()=>$n.closeModal(),fill:"outline",children:(0,t.jsx)(x.x6,{i18nKey:"export.json.cancel-button",children:"Cancel"})})]})})]})}function z(en){return{codeEditorBox:(0,i.css)({margin:`${en.spacing(2)} 0`}),container:(0,i.css)({paddingBottom:en.spacing(2)})}}const te=r.Tp.pages.Dashboard.DashNav.NewExportButton.Menu,le=[];function ie(en){le.push(en)}function ae({dashboard:en}){const $n=(0,n.useCallback)((qn,es)=>{const Ss=new U({title:qn,body:new es});en.showModal(Ss)},[en]),Qn=(0,n.useCallback)(()=>{const qn=[];return le.forEach(es=>qn.push(es)),qn.push({shareId:S.wr.export,testId:te.exportAsJson,icon:"arrow",label:(0,x.t)("share-dashboard.menu.export-json-title","Export as JSON"),renderCondition:!0,onClick:()=>$n((0,x.t)("export.json.title","Save dashboard JSON"),ne)}),qn.filter(es=>es.renderCondition)},[$n]),Gn=qn=>{I.c.sharingCategoryClicked({item:qn.shareId,shareResource:(0,S.hD)()}),qn.onClick(en)};return(0,t.jsx)(p.W,{"data-testid":te.container,children:Qn().map(qn=>(0,t.jsx)(p.W.Item,{testId:qn.testId,label:qn.label,icon:qn.icon,description:qn.description,onClick:()=>Gn(qn)},qn.label))})}const re=r.Tp.pages.Dashboard.DashNav.NewExportButton;function ce({dashboard:en}){const[$n,Qn]=(0,n.useState)(!1),Gn=(0,n.useCallback)(es=>{Qn(es)},[]),qn=()=>(0,t.jsx)(ae,{dashboard:en});return(0,t.jsx)(y.e,{"data-testid":re.container,children:(0,t.jsx)(l.m,{overlay:qn,placement:"bottom-end",onVisibleChange:Gn,children:(0,t.jsxs)(m.$n,{"data-testid":re.arrowMenu,size:"sm",variant:"secondary",fill:"solid",tooltip:(0,x.t)("export.menu.export-as-json-tooltip","Export"),children:[(0,t.jsx)(x.x6,{i18nKey:"export.menu.export-as-json-label",children:"Export"}),"\xA0",(0,t.jsx)(h.I,{name:$n?"angle-up":"angle-down",size:"lg"})]})})})}var me=e(41053),ee=e(72254),de=e(25994),De=e(72686),fe=e(4785),Te=e(31678),je=e(94753),He=e(29158),Be=e(45014);function Ne({onConfirm:en,onDismiss:$n,description:Qn,confirmButtonLabel:Gn,title:qn,isActionLoading:es}){const Ss=(0,c.of)(Re),_s=()=>(0,t.jsx)("div",{className:Ss.bodyContainer,children:(0,t.jsxs)(B.B,{justifyContent:"space-between",children:[(0,t.jsxs)(B.B,{gap:1,alignItems:"center",children:[(0,t.jsx)(He.K,{size:"xl",name:"angle-left","aria-label":(0,x.t)("share-drawer.confirm-action.back-arrow-button","Back button"),onClick:$n}),(0,t.jsx)(je.E,{variant:"h4",children:qn})]}),es&&(0,t.jsx)(X.y,{})]})});return(0,t.jsx)(Be.k,{body:(0,t.jsx)(_s,{}),description:Qn,confirmButtonLabel:Gn,confirmButtonVariant:"destructive",dismissButtonLabel:"Cancel",dismissButtonVariant:"secondary",justifyButtons:"flex-start",onConfirm:en,onDismiss:$n})}const Re=en=>({bodyContainer:(0,i.css)({marginBottom:en.spacing(2)})});var Se=e(49785),We=e(84167),Ke=e(88575),Xe=e(56034),Je=e(10354),st=e(54230);const pt=r.Tp.pages.ShareDashboardModal.PublicDashboard;function xt(){const{dashboard:en}=L(),[$n,{isLoading:Qn}]=(0,De.T2)(),{data:Gn}=De.Sm.endpoints?.getPublicDashboard.useQueryState(en.state.uid),qn=P.TP.hasPermission(Te.AccessControlAction.DashboardsPublicWrite),es=Qn||!qn,_s=T.jh.getTimeRange(en).useState(),{handleSubmit:Pa,setValue:Ea,control:Ys}=(0,Se.mN)({defaultValues:{isAnnotationsEnabled:Gn?.annotationsEnabled,isTimeSelectionEnabled:Gn?.timeSelectionEnabled}}),ha=async(ua,za)=>{Ea(ua,za),await Pa(Ja=>ja({...Ja,[ua]:za}))()},ja=ua=>{const{isAnnotationsEnabled:za,isTimeSelectionEnabled:Ja}=ua;$n({dashboard:en,payload:{...Gn,annotationsEnabled:za,timeSelectionEnabled:Ja}})};return(0,t.jsxs)(B.B,{direction:"column",gap:2,children:[(0,t.jsx)(je.E,{element:"p",children:(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.configuration.settings-label",children:"Settings"})}),(0,t.jsxs)(B.B,{justifyContent:"space-between",children:[(0,t.jsx)("form",{onSubmit:Pa(ja),children:(0,t.jsx)(We.n,{disabled:es,children:(0,t.jsxs)(B.B,{direction:"column",gap:2,children:[(0,t.jsxs)(B.B,{gap:1,children:[(0,t.jsx)(Se.xI,{render:({field:{ref:ua,...za}})=>(0,t.jsx)(V.d,{...za,"data-testid":pt.EnableTimeRangeSwitch,onChange:Ja=>{I.c.publicDashboardTimeSelectionChanged({enabled:Ja.currentTarget.checked}),ha("isTimeSelectionEnabled",Ja.currentTarget.checked)},label:(0,x.t)("public-dashboard.configuration.enable-time-range-label","Enable time range")}),control:Ys,name:"isTimeSelectionEnabled"}),(0,t.jsx)(K.J,{description:"Allow people to change time range",children:(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.configuration.enable-time-range-label",children:"Enable time range"})})]}),(0,t.jsxs)(B.B,{gap:1,children:[(0,t.jsx)(Se.xI,{render:({field:{ref:ua,...za}})=>(0,t.jsx)(V.d,{...za,"data-testid":pt.EnableAnnotationsSwitch,onChange:Ja=>{I.c.publicDashboardAnnotationsSelectionChanged({enabled:Ja.currentTarget.checked}),ha("isAnnotationsEnabled",Ja.currentTarget.checked)},label:(0,x.t)("public-dashboard.configuration.display-annotations-label","Display annotations")}),control:Ys,name:"isAnnotationsEnabled"}),(0,t.jsx)(K.J,{style:{flex:1},description:"Present annotations on this Dashboard",children:(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.configuration.display-annotations-label",children:"Display annotations"})})]}),(0,t.jsxs)(B.B,{gap:1,alignItems:"center",children:[(0,t.jsx)(st.b,{value:_s.value,showIcon:!0,disabled:!0,onChange:()=>{}}),(0,t.jsx)(Xe.m,{placement:"right",content:(0,x.t)("public-dashboard.configuration.time-range-tooltip","The shared dashboard uses the default time range settings of the dashboard"),children:(0,t.jsx)(h.I,{name:"info-circle",size:"sm"})})]})]})})}),Qn&&(0,t.jsx)(X.y,{})]})]})}const ot=r.Tp.pages.ShareDashboardModal.PublicDashboard.EmailSharingConfiguration,$e=({onDelete:en,onReshare:$n})=>(0,t.jsxs)(p.W,{children:[(0,t.jsx)(p.W.Item,{label:(0,x.t)("public-dashboard.email-sharing.resend-invite-label","Resend invite"),onClick:$n}),(0,t.jsx)(p.W.Item,{label:(0,x.t)("public-dashboard.email-sharing.revoke-access-label","Revoke access"),destructive:!0,onClick:en})]}),ve=({recipients:en,dashboardUid:$n,publicDashboard:Qn})=>{const Gn=(0,c.of)(he),[qn,{isLoading:es}]=(0,De.$L)(),[Ss,{isLoading:_s}]=(0,De.NA)(),Pa=es||_s,Ea=(ha,ja)=>{I.c.revokePublicDashboardEmailClicked(),qn({recipientUid:ha,recipientEmail:ja,dashboardUid:$n,uid:Qn.uid})},Ys=ha=>{I.c.resendPublicDashboardEmailClicked(),Ss({recipientUid:ha,uid:Qn.uid})};return(0,t.jsx)("table",{"data-testid":ot.EmailSharingList,className:Gn.table,children:(0,t.jsx)("tbody",{children:en.map((ha,ja)=>(0,t.jsxs)("tr",{className:Gn.listItem,children:[(0,t.jsx)("td",{className:Gn.user,children:(0,t.jsxs)(B.B,{direction:"row",gap:1,alignItems:"center",children:[(0,t.jsx)("div",{className:Gn.icon,children:(0,t.jsx)(h.I,{name:"user"})}),(0,t.jsx)(je.E,{children:ha.recipient})]})}),(0,t.jsx)("td",{children:Pa&&(0,t.jsx)(X.y,{})}),(0,t.jsx)("td",{children:(0,t.jsx)(l.m,{overlay:(0,t.jsx)($e,{onDelete:()=>Ea(ha.uid,ha.recipient),onReshare:()=>Ys(ha.uid)}),children:(0,t.jsx)(He.K,{name:"ellipsis-v","aria-label":"email-menu",variant:"secondary",size:"lg"})})})]},ha.uid))})})},be=({dashboard:en})=>{const $n=(0,c.of)(he),{data:Qn}=De.Sm.endpoints?.getPublicDashboard.useQueryState(en.state.uid);return(0,t.jsx)(Ke.D,{label:(0,x.t)("public-dashboard.email-sharing.recipient-list-title","People with access"),description:(0,x.t)("public-dashboard.email-sharing.recipient-list-description","Only people you've directly invited can access this dashboard"),className:$n.listField,children:Qn?.recipients?.length?(0,t.jsx)("div",{className:$n.listContainer,children:(0,t.jsx)(ve,{recipients:Qn.recipients,dashboardUid:en.state.uid,publicDashboard:Qn})}):(0,t.jsx)(t.Fragment,{})})},he=en=>({listField:(0,i.css)({marginBottom:0}),listContainer:(0,i.css)({maxHeight:"140px",overflowY:"auto"}),table:(0,i.css)({width:"100%"}),listItem:(0,i.css)({display:"flex",alignItems:"center",gap:en.spacing(.5),padding:en.spacing(.75,1),color:en.colors.text.secondary}),user:(0,i.css)({flex:1}),icon:(0,i.css)({border:`${en.spacing(.25)} solid ${en.colors.text.secondary}`,padding:en.spacing(.125,.5),borderRadius:en.shape.radius.circle,color:en.colors.text.secondary})}),ye=r.Tp.pages.ShareDashboardModal.PublicDashboard.EmailSharingConfiguration,Pe=()=>{const{dashboard:en}=L(),{data:$n,isError:Qn}=De.Sm.endpoints?.getPublicDashboard.useQueryState(en.state.uid),[Gn,{isLoading:qn}]=(0,De.NY)(),es=P.TP.hasPermission(Te.AccessControlAction.DashboardsPublicWrite),{register:Ss,handleSubmit:_s,formState:{errors:Pa,isValid:Ea},reset:Ys}=(0,Se.mN)({defaultValues:{email:""},mode:"onSubmit"}),ha=async ja=>{I.c.publicDashboardEmailInviteClicked(),await Gn({recipient:ja.email,uid:$n.uid,dashboardUid:en.state.uid}).unwrap(),Ys({email:""})};return(0,t.jsxs)("div",{children:[(0,t.jsx)("form",{onSubmit:_s(ha),children:(0,t.jsx)(We.n,{disabled:!es||Qn,children:(0,t.jsx)(Ke.D,{label:(0,t.jsxs)(B.B,{gap:1,alignItems:"center",children:[(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.email-sharing.recipient-invitation-button",children:"Invite"}),(0,t.jsx)(Xe.m,{placement:"right",content:(0,x.t)("public-dashboard.email-sharing.recipient-invitation-tooltip","This dashboard contains sensitive data. By using this feature you will be sharing with external people."),children:(0,t.jsx)(h.I,{name:"info-circle",size:"sm"})})]}),description:(0,x.t)("public-dashboard.email-sharing.recipient-invitation-description","Invite someone by email"),error:Pa.email?.message,invalid:!!Pa.email?.message,children:(0,t.jsxs)(B.B,{direction:"row",children:[(0,t.jsx)(Je.p,{placeholder:(0,x.t)("public-dashboard.email-sharing.recipient-email-placeholder","Email"),autoCapitalize:"none",loading:qn,...Ss("email",{required:(0,x.t)("public-dashboard.email-sharing.recipient-required-email-text","Email is required"),pattern:{value:ee._l,message:(0,x.t)("public-dashboard.email-sharing.recipient-invalid-email-text","Invalid email")}}),"data-testid":ye.EmailSharingInput}),(0,t.jsx)(m.$n,{type:"submit",variant:"primary",disabled:qn||!Ea,"data-testid":ye.EmailSharingInviteButton,children:(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.email-sharing.recipient-invitation-button",children:"Invite"})})]})})})}),(0,t.jsx)(be,{dashboard:en}),(0,t.jsx)(de.c,{}),(0,t.jsx)(xt,{})]})};var ge=e(10880),xe=e(42418);const Ae="https://grafana.com/docs/grafana/latest/dashboards/dashboard-public/#email-sharing";function Ee(){return(0,t.jsx)(xe.F,{title:"",severity:"info",bottomSpacing:0,children:(0,t.jsxs)(B.B,{justifyContent:"space-between",gap:2,alignItems:"center",children:[(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.email-sharing.alert-text",children:"Sharing dashboards by email is billed per user for the duration of the 30-day token, regardless of how many dashboards are shared. Billing stops after 30 days unless you renew the token."}),(0,t.jsx)(m.$n,{variant:"secondary",onClick:()=>window.open(Ae,"_blank"),type:"button",children:(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.email-sharing.learn-more-button",children:"Learn more"})})]})})}const Ie=({hasError:en})=>{const{dashboard:$n}=L(),Qn=(0,c.of)(Qe),[Gn,{isLoading:qn,isError:es}]=(0,De.U9)(),Ss=P.TP.hasPermission(Te.AccessControlAction.DashboardsPublicWrite),_s=!Ss||qn||es||en,{handleSubmit:Pa,register:Ea,formState:{isValid:Ys}}=(0,Se.mN)({mode:"onChange"}),ha=()=>{I.c.generatePublicDashboardUrlClicked({share:ee.Xo.EMAIL}),Gn({dashboard:$n,payload:{share:ee.Xo.EMAIL,isEnabled:!0}})};return(0,t.jsxs)(t.Fragment,{children:[Ss&&(0,t.jsx)(Ee,{}),(0,t.jsx)("form",{onSubmit:Pa(ha),children:(0,t.jsxs)(We.n,{disabled:_s,children:[(0,t.jsx)("div",{className:Qn.checkbox,children:(0,t.jsx)(ge.S,{...Ea("billAcknowledgment",{required:!0}),label:(0,x.t)("public-dashboard.email-sharing.bill-ack","I understand that adding users requires payment.*")})}),(0,t.jsxs)(B.B,{direction:"row",gap:1,alignItems:"center",children:[(0,t.jsx)(m.$n,{type:"submit",disabled:!Ys,children:(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.email-sharing.accept-button",children:"Accept"})}),(0,t.jsx)(m.$n,{variant:"secondary",onClick:()=>$n.closeModal(),children:(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.email-sharing.cancel-button",children:"Cancel"})}),qn&&(0,t.jsx)(X.y,{})]})]})})]})},Qe=en=>({checkbox:(0,i.css)({marginBottom:en.spacing(2)})}),at=()=>{const{dashboard:en}=L(),{data:$n,isError:Qn}=De.Sm.endpoints?.getPublicDashboard.useQueryState(en.state.uid);return(0,t.jsx)(t.Fragment,{children:$n?(0,t.jsx)(Pe,{}):(0,t.jsx)(Ie,{hasError:Qn})})},ft="https://grafana.com/docs/grafana/latest/dashboards/dashboard-public/",ct=()=>(0,t.jsx)(xe.F,{title:"",severity:"info",bottomSpacing:0,children:(0,t.jsxs)(B.B,{justifyContent:"space-between",gap:2,alignItems:"center",children:[(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.public-sharing.alert-text",children:"Sharing this dashboard externally makes it entirely accessible to anyone with the link."}),(0,t.jsx)(m.$n,{variant:"secondary",onClick:()=>window.open(ft,"_blank"),type:"button",children:(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.public-sharing.learn-more-button",children:"Learn more"})})]})});function vt({hasError:en}){const{dashboard:$n}=L(),Qn=(0,c.of)(Pt),Gn=P.TP.hasPermission(Te.AccessControlAction.DashboardsPublicWrite),{handleSubmit:qn,register:es,formState:{isValid:Ss}}=(0,Se.mN)({mode:"onChange"}),[_s,{isLoading:Pa,isError:Ea}]=(0,De.U9)(),Ys=()=>{I.c.generatePublicDashboardUrlClicked({share:ee.Xo.PUBLIC}),_s({dashboard:$n,payload:{share:ee.Xo.PUBLIC,isEnabled:!0}})},ha=!Gn||Pa||Ea||en;return(0,t.jsxs)(t.Fragment,{children:[Gn&&(0,t.jsx)(ct,{}),(0,t.jsx)("form",{onSubmit:qn(Ys),children:(0,t.jsxs)(We.n,{disabled:ha,children:[(0,t.jsx)("div",{className:Qn.checkbox,children:(0,t.jsx)(ge.S,{...es("publicAcknowledgment",{required:!0}),label:(0,x.t)("public-dashboard.public-sharing.public-ack","I understand that this entire dashboard will be public.*")})}),(0,t.jsxs)(B.B,{direction:"row",gap:1,alignItems:"center",children:[(0,t.jsx)(m.$n,{type:"submit",disabled:!Ss,children:(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.public-sharing.accept-button",children:"Accept"})}),(0,t.jsx)(m.$n,{variant:"secondary",onClick:()=>$n.closeModal(),children:(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.public-sharing.cancel-button",children:"Cancel"})}),Pa&&(0,t.jsx)(X.y,{})]})]})})]})}const Pt=en=>({checkbox:(0,i.css)({marginBottom:en.spacing(2)})});function Vt(){const{dashboard:en}=L(),{data:$n,isError:Qn}=De.Sm.endpoints?.getPublicDashboard.useQueryState(en.state.uid);return(0,t.jsx)(t.Fragment,{children:$n?(0,t.jsx)(xt,{}):(0,t.jsx)(vt,{hasError:Qn})})}var Jt=e(12257),wt=e(10872),zt=e(29304),on=e(59995);function Pn({publicDashboard:en}){const{dashboard:$n}=L(),Qn=P.TP.hasPermission(Te.AccessControlAction.DashboardsPublicWrite),Gn=(0,on.b)($n),qn=($n.state.$variables?.state.variables.length??0)>0;return(0,t.jsxs)(t.Fragment,{children:[Qn&&qn&&(0,t.jsx)(wt.D,{showDescription:!1}),!Qn&&(0,t.jsx)(zt.t,{mode:en?"edit":"create"}),Qn&&!!Gn?.length&&(0,t.jsx)(Jt.s,{unsupportedDataSources:Gn.join(", ")}),en?.share===ee.Xo.EMAIL&&(0,ee.AY)()&&(0,t.jsx)(Ee,{})]})}var _n=e(8887),Cn=e(90182);const Ye=r.Tp.pages.ShareDashboardDrawer.ShareExternally;function Dt({setShareType:en,options:$n,value:Qn}){const{dashboard:Gn}=L(),qn=(0,c.of)(yt),{data:es}=De.Sm.endpoints?.getPublicDashboard.useQueryState(Gn.state.uid),[Ss,{isLoading:_s}]=(0,De.ft)(),Pa=P.TP.hasPermission(Te.AccessControlAction.DashboardsPublicWrite),Ea=an(),Ys=ha=>{if(!es)return;I.c.publicDashboardShareTypeChange({shareType:ha===ee.Xo.EMAIL?"email":"public"});const ja={dashboard:Gn,payload:{...es,share:ha}};Ss(ja)};return(0,t.jsxs)("div",{children:[(0,t.jsxs)(B.B,{justifyContent:"space-between",children:[(0,t.jsx)(K.J,{description:Qn.description,children:(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.share-configuration.share-type-label",children:"Link access"})}),_s&&(0,t.jsx)(X.y,{})]}),(0,ee.AY)()?(0,t.jsx)(Cn.l6,{"data-testid":Ye.shareTypeSelect,options:$n,value:Qn,disabled:!Pa,onChange:ha=>{en(ha),Ys(ha.value)},className:qn.select}):(0,t.jsxs)(t.Fragment,{children:[(0,_n.Uo)(Ea.icon)&&(0,t.jsx)(h.I,{name:(0,_n.Uo)(Ea.icon)}),(0,t.jsx)(je.E,{children:Ea.label})]})]})}const yt=()=>({select:(0,i.css)({flex:1})}),Ft=r.Tp.pages.ShareDashboardDrawer.ShareExternally,an=()=>({label:(0,x.t)("public-dashboard.share-externally.public-share-type-option-label","Anyone with the link"),description:(0,x.t)("public-dashboard.share-externally.public-share-type-option-description","Anyone with the link can access dashboard"),value:ee.Xo.PUBLIC,icon:"globe"}),un=()=>({label:(0,x.t)("public-dashboard.share-externally.email-share-type-option-label","Only specific people"),description:(0,x.t)("public-dashboard.share-externally.email-share-type-option-description","Only people with the link can access dashboard"),value:ee.Xo.EMAIL,icon:"users-alt"}),hn=()=>(0,ee.AY)()?[un(),an()]:[an()];class Un extends T.Bs{static{this.Component=Nn}}function Nn({model:en}){const[$n,Qn]=(0,n.useState)(!1),Gn=(0,c.of)(ht),qn=(0,R.YQ)(en),{data:es,isLoading:Ss}=(0,De.Bs)(qn.state.uid),[_s,{isLoading:Pa}]=(0,De.bN)(),Ea=()=>{Qn(!0)},Ys=async()=>{I.c.revokePublicDashboardClicked(),await _s({dashboard:qn,uid:es.uid,dashboardUid:qn.state.uid}).unwrap(),Qn(!1)};return Ss?(0,t.jsx)(fe.a,{}):$n?(0,t.jsx)(Ne,{title:(0,x.t)("public-dashboard.share-externally.revoke-access-button","Revoke access"),confirmButtonLabel:(0,x.t)("public-dashboard.share-externally.revoke-access-button","Revoke access"),onConfirm:Ys,onDismiss:()=>Qn(!1),description:(0,x.t)("public-dashboard.share-externally.revoke-access-description","Are you sure you want to revoke this access? The dashboard can no longer be shared."),isActionLoading:Pa}):(0,t.jsx)("div",{className:Gn.container,children:(0,t.jsx)(St,{publicDashboard:es,onRevokeClick:Ea})})}function St({publicDashboard:en,onRevokeClick:$n}){const Qn=hn(),Gn=(0,n.useMemo)(()=>en&&(0,ee.AY)()?Qn.find(Pa=>Pa.value===en?.share)??Qn[0]:Qn[0],[en,Qn]),[qn,es]=(0,n.useState)(Gn),Ss=(0,n.useMemo)(()=>qn.value===ee.Xo.EMAIL&&(0,ee.AY)()?(0,t.jsx)(at,{}):(0,t.jsx)(Vt,{}),[qn]);return(0,t.jsxs)(B.B,{direction:"column",gap:2,"data-testid":Ft.container,children:[(0,t.jsx)(Pn,{publicDashboard:en}),(0,t.jsx)(Dt,{setShareType:es,value:qn,options:Qn}),Ss,en&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(de.c,{spacing:0}),(0,t.jsx)(nn,{publicDashboard:en,onRevokeClick:$n})]})]})}function nn({publicDashboard:en,onRevokeClick:$n}){const{dashboard:Qn}=L(),[Gn,{isLoading:qn}]=(0,De.eq)(),es=(0,c.of)(ht),Ss=P.TP.hasPermission(Te.AccessControlAction.DashboardsPublicWrite);function _s(){I.c.publicDashboardUrlCopied()}const Pa=async()=>{I.c.publicDashboardPauseSharingClicked({paused:!en.isEnabled}),Gn({dashboard:Qn,payload:{...en,isEnabled:!en.isEnabled}})};return(0,t.jsxs)(B.B,{alignItems:"center",direction:{xs:"column",sm:"row"},children:[(0,t.jsx)("div",{className:es.actionsContainer,children:(0,t.jsxs)(B.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:[(0,t.jsx)(k.b,{"data-testid":Ft.copyUrlButton,variant:"primary",fill:"outline",icon:"link",getText:()=>(0,ee.mL)(en.accessToken),onClipboardCopy:_s,children:(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.share-externally.copy-link-button",children:"Copy external link"})}),(0,t.jsx)(m.$n,{icon:"trash-alt",variant:"destructive",fill:"outline",disabled:qn||!Ss,onClick:$n,children:(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.share-externally.revoke-access-button",children:"Revoke access"})}),(0,t.jsx)(m.$n,{icon:en.isEnabled?"pause":"play",variant:"secondary",fill:"outline",tooltip:en.isEnabled?(0,x.t)("public-dashboard.share-externally.pause-access-tooltip","Pausing will temporarily disable access to this dashboard for all users"):"",onClick:Pa,disabled:qn||!Ss,children:en.isEnabled?(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.share-externally.pause-access-button",children:"Pause access"}):(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.share-externally.resume-access-button",children:"Resume access"})})]})}),qn&&(0,t.jsx)(X.y,{})]})}const ht=en=>({container:(0,i.css)({paddingBottom:en.spacing(2)}),actionsContainer:(0,i.css)({width:"100%"})});var lt=e(87895),gt=e(58398),$t=e(70439);class et extends gt.R{static{this.Component=Et}constructor($n){const{useAbsoluteTimeRange:Qn,useShortUrl:Gn,theme:qn}=(0,$t.yk)();super({...$n,useLockedTime:Qn,useShortUrl:Gn,selectedTheme:qn})}}function Et({model:en}){const $n=(0,c.of)(It),{useLockedTime:Qn,useShortUrl:Gn,selectedTheme:qn,isBuildUrlLoading:es}=en.useState();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(xe.F,{severity:"info",title:(0,x.t)("link.share.config-alert-title","Link configuration"),children:(0,t.jsx)(x.x6,{i18nKey:"link.share.config-alert-description",children:"Updating your settings will modify the default copy link to include these changes."})}),(0,t.jsx)("div",{className:$n.configDescription,children:(0,t.jsx)(je.E,{variant:"body",children:(0,t.jsx)(x.x6,{i18nKey:"link.share.config-description",children:"Create a personalized, direct link to share your dashboard within your organization, with the following customization settings:"})})}),(0,t.jsxs)(B.B,{justifyContent:"space-between",children:[(0,t.jsxs)(B.B,{gap:2,direction:"column",children:[(0,t.jsxs)(B.B,{gap:1,direction:"column",children:[(0,t.jsxs)(B.B,{gap:1,alignItems:"start",children:[(0,t.jsx)(V.d,{label:(0,x.t)("link.share.time-range-label","Lock time range"),id:"share-current-time-range",value:Qn,onChange:en.onToggleLockedTime}),(0,t.jsx)(K.J,{description:(0,x.t)("link.share.time-range-description","Change the current relative time range to an absolute time range"),children:(0,t.jsx)(x.x6,{i18nKey:"link.share.time-range-label",children:"Lock time range"})})]}),(0,t.jsxs)(B.B,{gap:1,alignItems:"start",children:[(0,t.jsx)(V.d,{id:"share-short-url",value:Gn,label:(0,x.t)("link.share.short-url-label","Shorten link"),onChange:en.onUrlShorten}),(0,t.jsx)(K.J,{children:(0,t.jsx)(x.x6,{i18nKey:"link.share.short-url-label",children:"Shorten link"})})]})]}),(0,t.jsx)(lt.w,{selectedTheme:qn,onChange:en.onThemeChange})]}),es&&(0,t.jsx)(X.y,{})]}),(0,t.jsx)(de.c,{spacing:1}),(0,t.jsx)(k.b,{icon:"link",variant:"primary",fill:"outline",disabled:es,getText:en.getShareUrl,onClipboardCopy:en.onCopy,className:$n.copyButtonContainer,children:(0,t.jsx)(x.x6,{i18nKey:"link.share.copy-link-button",children:"Copy link"})})]})}const It=en=>({configDescription:(0,i.css)({marginBottom:en.spacing(2)}),copyButtonContainer:(0,i.css)({marginTop:en.spacing(2)})});var Qt=e(5805),sn=e(12962),ln=e(94354),yn=e(72109),Sn=e(76412);const En="https://grafana.com/docs/grafana/latest/dashboards/share-dashboards-panels/#publish-a-snapshot";function wn({name:en,onNameChange:$n,onExpireChange:Qn,selectedExpireOption:Gn,sharingOptions:qn,onCancelClick:es,onCreateClick:Ss,isLoading:_s}){const Pa=(0,c.of)(On);return(0,t.jsxs)("div",{className:Pa.container,children:[(0,t.jsx)(xe.F,{severity:"info",title:"",children:(0,t.jsxs)(B.B,{justifyContent:"space-between",gap:2,alignItems:"center",children:[(0,t.jsx)(je.E,{children:(0,t.jsx)(x.x6,{i18nKey:"snapshot.share.info-alert",children:"A Grafana dashboard snapshot publicly shares a dashboard while removing sensitive data such as queries and panel links, leaving only visible metrics and series names. Anyone with the link can access the snapshot."})}),(0,t.jsx)(m.$n,{variant:"secondary",onClick:()=>window.open(En,"_blank"),type:"button",children:(0,t.jsx)(x.x6,{i18nKey:"snapshot.share.learn-more-button",children:"Learn more"})})]})}),(0,t.jsx)(Ke.D,{label:(0,Sn.t)("snapshot.share.name-label","Snapshot name*"),children:(0,t.jsx)(Je.p,{id:"snapshot-name-input",defaultValue:en,onBlur:Ea=>$n(Ea.target.value)})}),(0,t.jsx)(Ke.D,{label:(0,Sn.t)("snapshot.share.expiration-label","Expires in"),children:(0,t.jsx)(ln.z,{id:"expire-select-input",options:(0,sn.u)(),value:Gn?.value,onChange:Qn})}),(0,t.jsx)(de.c,{}),(0,t.jsxs)(B.B,{justifyContent:"space-between",direction:{xs:"column",xl:"row"},children:[(0,t.jsxs)(B.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:[(0,t.jsx)(m.$n,{variant:"primary",disabled:_s,onClick:()=>Ss(),children:(0,t.jsx)(x.x6,{i18nKey:"snapshot.share.local-button",children:"Publish snapshot"})}),qn?.externalEnabled&&(0,t.jsx)(m.$n,{variant:"secondary",disabled:_s,onClick:()=>Ss(!0),children:qn?.externalSnapshotName}),(0,t.jsx)(m.$n,{variant:"secondary",fill:"outline",onClick:es,children:(0,t.jsx)(x.x6,{i18nKey:"snapshot.share.cancel-button",children:"Cancel"})}),_s&&(0,t.jsx)(X.y,{})]}),(0,t.jsx)(yn.Y,{icon:"external-link-alt",href:"/dashboard/snapshots",children:(0,Sn.t)("snapshot.share.view-all-button","View all snapshots")})]})]})}const On=en=>({container:(0,i.css)({paddingBottom:en.spacing(2)})}),Rt=({url:en,onDeleteClick:$n,onNewSnapshotClick:Qn})=>(0,t.jsxs)(B.B,{justifyContent:"flex-start",gap:1,direction:{xs:"column",sm:"row"},children:[(0,t.jsx)(k.b,{icon:"link",variant:"primary",fill:"outline",getText:()=>en,children:(0,t.jsx)(x.x6,{i18nKey:"snapshot.share.copy-link-button",children:"Copy link"})}),(0,t.jsx)(m.$n,{icon:"trash-alt",variant:"destructive",fill:"outline",onClick:$n,children:(0,t.jsx)(x.x6,{i18nKey:"snapshot.share.delete-button",children:"Delete snapshot"})}),(0,t.jsx)(m.$n,{variant:"secondary",fill:"solid",onClick:Qn,children:(0,t.jsx)(x.x6,{i18nKey:"snapshot.share.new-snapshot-button",children:"New snapshot"})})]}),Ot=r.Tp.pages.ShareDashboardDrawer.ShareSnapshot;class jt extends sn.l{static{this.Component=rt}}function rt({model:en}){const[$n,Qn]=(0,n.useState)(!1),[Gn,qn]=(0,n.useState)(!1),[es,Ss]=(0,n.useState)(1),{snapshotName:_s,snapshotSharingOptions:Pa,selectedExpireOption:Ea,dashboardRef:Ys}=en.useState(),[ha,ja]=(0,Qt.default)(async(pr=!1)=>{const Wr=await en.onSnapshotCreate(pr);return Ss(2),Wr}),[ua,za]=(0,Qt.default)(async pr=>{const Wr=await en.onSnapshotDelete(pr);return Ss(1),Qn(!1),qn(!0),Wr}),Ja=()=>{Ys.resolve().closeModal()};return $n?(0,t.jsx)(Ne,{title:(0,x.t)("snapshot.share.delete-title","Delete snapshot"),confirmButtonLabel:(0,x.t)("snapshot.share.delete-button","Delete snapshot"),onConfirm:()=>za(ha.value?.deleteUrl),onDismiss:()=>Qn(!1),description:(0,x.t)("snapshot.share.delete-description","Are you sure you want to delete this snapshot?"),isActionLoading:ua.loading}):(0,t.jsxs)("div",{"data-testid":Ot.container,children:[es===1&&(0,t.jsxs)(t.Fragment,{children:[Gn&&(0,t.jsx)(xe.F,{severity:"info",title:"",onRemove:()=>qn(!1),children:(0,t.jsx)(x.x6,{i18nKey:"snapshot.share.deleted-alert",children:"Your snapshot has been deleted. It might take up to an hour before the snapshot is cleared from any CDN caches."})}),(0,t.jsx)(wn,{name:_s??"",selectedExpireOption:Ea,sharingOptions:Pa,onNameChange:en.onSnasphotNameChange,onCancelClick:Ja,onExpireChange:en.onExpireChange,onCreateClick:ja,isLoading:ha.loading})]}),es===2&&(0,t.jsx)(Rt,{url:ha.value.url,onDeleteClick:()=>Qn(!0),onNewSnapshotClick:()=>Ss(1)})]})}const tn=r.Tp.pages.Dashboard.DashNav.newShareButton.menu,Mn=[];function kn(en){Mn.push(en)}function Yn({dashboard:en,panel:$n}){const Qn=(0,n.useCallback)((es,Ss)=>{const _s=new U({title:es,body:new Ss({dashboardRef:en.getRef(),panelRef:$n?.getRef()})});en.showModal(_s)},[en,$n]),Gn=(0,n.useCallback)(()=>{const es=[];return es.push({shareId:S.wr.link,testId:tn.shareInternally,icon:"building",label:(0,x.t)("share-dashboard.menu.share-internally-title","Share internally"),description:(0,x.t)("share-dashboard.menu.share-internally-description","Advanced settings"),renderCondition:!0,onClick:()=>Qn((0,x.t)("share-dashboard.menu.share-internally-title","Share internally"),et)}),es.push({shareId:S.wr.publicDashboard,testId:tn.shareExternally,icon:"share-alt",label:(0,x.t)("share-dashboard.menu.share-externally-title","Share externally"),renderCondition:!$n&&(0,ee.iR)(),onClick:()=>{Qn((0,x.t)("share-dashboard.menu.share-externally-title","Share externally"),Un)}}),Mn.forEach(Ss=>es.push(Ss)),es.push({shareId:S.wr.snapshot,testId:tn.shareSnapshot,icon:"camera",label:(0,x.t)("share-dashboard.menu.share-snapshot-title","Share snapshot"),renderCondition:P.TP.isSignedIn&&f.$.snapshotEnabled&&en.canEditDashboard(),onClick:()=>{Qn((0,x.t)("share-dashboard.menu.share-snapshot-title","Share snapshot"),jt)}}),es.filter(Ss=>Ss.renderCondition)},[Qn,en,$n]),qn=es=>{I.c.sharingCategoryClicked({item:es.shareId,shareResource:(0,S.hD)($n?.getRef())}),es.onClick(en)};return(0,t.jsx)(p.W,{"data-testid":tn.container,children:Gn().map(es=>(0,t.jsx)(p.W.Item,{testId:es.testId,label:es.label,icon:es.icon,description:es.description,onClick:()=>qn(es)},es.label))})}const Wn=r.Tp.pages.Dashboard.DashNav.newShareButton;function Jn({dashboard:en,panel:$n}){const[Qn,Gn]=(0,n.useState)(!1),[qn,es]=(0,me.A)(async()=>await(0,$t.Xe)(en,$n),[en]),Ss=(0,n.useCallback)(Pa=>{Pa&&I.c.toolbarShareClick(),Gn(Pa)},[]),_s=()=>(0,t.jsx)(Yn,{dashboard:en});return(0,t.jsxs)(y.e,{"data-testid":Wn.container,children:[(0,t.jsx)(m.$n,{"data-testid":Wn.shareLink,size:"sm",tooltip:(0,x.t)("share-dashboard.share-button-tooltip","Copy shortened link"),onClick:es,children:(0,t.jsx)(x.x6,{i18nKey:"share-dashboard.share-button",children:"Share"})}),(0,t.jsx)(l.m,{overlay:_s,placement:"bottom-end",onVisibleChange:Ss,children:(0,t.jsx)(m.$n,{"data-testid":Wn.arrowMenu,size:"sm",icon:Qn?"angle-up":"angle-down"})})]})}var Ls=e(85174),fs=e(99246),ys=e(80997),Xn=e(96374),Ps=e(28138),Zs=e(28444);function Ms(en){return(0,t.jsx)(o.I,{"data-testid":"button-snapshot",tooltip:(0,x.t)("dashboard.toolbar.open-original","Open original dashboard"),icon:"link",onClick:()=>ks(en.originalURL)},"button-snapshot")}const ks=en=>{const $n=en??"",Qn=ys.sQ.sanitizeUrl($n);try{const Gn=new URL(Qn,f.$.appUrl),qn=new URL(f.$.appUrl);Gn.host!==qn.host?Ps.A.publish(new Zs.S8({component:Xn.u,props:{title:"Proceed to external site?",modalClass:(0,i.css)({width:"max-content",maxWidth:"80vw"}),body:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("p",{children:["This link connects to an external website at"," ",(0,t.jsx)("code",{children:$n})]}),(0,t.jsx)("p",{children:"Are you sure you'd like to proceed?"})]}),confirmVariant:"primary",confirmText:"Proceed",onConfirm:()=>{window.location.href=Gn.href}}})):a.Ny.push(Qn)}catch(Gn){console.error("Failed to open original dashboard",Gn)}};var wa=e(60656);const Xa=n.memo(({dashboard:en})=>{const $n=(0,n.useId)(),Qn=(0,t.jsx)(pa,{dashboard:en},$n);return(0,t.jsx)(v.H,{actions:Qn})});Xa.displayName="NavToolbarActions";function pa({dashboard:en}){const{isEditing:$n,viewPanelScene:Qn,isDirty:Gn,uid:qn,meta:es,editview:Ss,editPanel:_s,editable:Pa}=en.useState(),{isPlaying:Ea}=C._o.useState(),[Ys,ha]=(0,n.useState)(!1),ja=P.TP.hasEditPermissionInFolders,ua=[],za=(0,c.of)(Wa),Ja=!!_s,pr=!!Qn,Wr=dr(_s),Fr=_a(_s),Kr=s.M.exists(D.tH),Ar=!Ss&&!pr&&!Ja,$r=$n&&Ar;Ja||Ba(ua,fs.C.left,"left-actions"),ua.push({group:"icon-actions",condition:qn&&!!es.canStar&&Ar&&!$n,render:()=>{let Fa=es.isStarred?(0,x.t)("dashboard.toolbar.unmark-favorite","Unmark as favorite"):(0,x.t)("dashboard.toolbar.mark-favorite","Mark as favorite");return(0,t.jsx)(o.I,{tooltip:Fa,icon:(0,t.jsx)(h.I,{name:es.isStarred?"favorite":"star",size:"lg",type:es.isStarred?"mono":"default"}),"data-testid":r.Tp.components.NavToolbar.markAsFavorite,onClick:()=>{I.c.toolbarFavoritesClick(),en.onStarDashboard()}},"star-dashboard-button")}}),es.publicDashboardEnabled&&ua.push({group:"icon-actions",condition:qn&&!!es.canStar&&Ar&&!$n,render:()=>(0,t.jsx)(g.E,{color:"blue",text:"Public",className:za.publicBadge,"data-testid":r.Tp.pages.Dashboard.DashNav.publicDashboardTag},"public-dashboard-button-badge")});const so=f.$.buildInfo.env==="development";ua.push({group:"icon-actions",condition:so&&qn&&Ar&&!$n,render:()=>(0,t.jsx)(o.I,{tooltip:"Switch to old dashboard page",icon:"apps",onClick:()=>{a.Ny.partial({scenes:!1})}},"view-in-old-dashboard-button")}),ua.push({group:"icon-actions",condition:es.isSnapshot&&!es.dashboardNotFound&&!$n,render:()=>(0,t.jsx)(Ms,{originalURL:en.getInitialSaveModel()?.snapshot?.originalUrl??""},"go-to-snapshot-origin")}),!Ja&&!$n&&Ba(ua,fs.C.right,"icon-actions"),ua.push({group:"add-panel",condition:$r,render:()=>(0,t.jsx)(l.m,{onVisibleChange:Fa=>{ha(Fa),I.c.toolbarAddClick()},overlay:()=>(0,t.jsxs)(p.W,{children:[(0,t.jsx)(p.W.Item,{testId:r.Tp.pages.AddDashboard.itemButton("Add new visualization menu item"),label:(0,x.t)("dashboard.add-menu.visualization","Visualization"),onClick:()=>{const Fa=en.onCreateNewPanel();I.c.toolbarAddButtonClicked({item:"add_visualization"}),en.setState({editPanel:(0,M.L)(Fa,!0)})}},"add-visualization"),(0,t.jsx)(p.W.Item,{testId:r.Tp.pages.AddDashboard.itemButton("Add new panel from panel library menu item"),label:(0,x.t)("dashboard.add-menu.import","Import from library"),onClick:()=>{en.onShowAddLibraryPanelDrawer(),I.c.toolbarAddButtonClicked({item:"add_library_panel"})}},"add-panel-lib"),(0,t.jsx)(p.W.Item,{testId:r.Tp.pages.AddDashboard.itemButton("Add new row menu item"),label:(0,x.t)("dashboard.add-menu.row","Row"),onClick:()=>{en.onCreateNewRow(),I.c.toolbarAddButtonClicked({item:"add_row"})}},"add-row"),(0,t.jsx)(p.W.Item,{disabled:!Kr,testId:r.Tp.pages.AddDashboard.itemButton("Add new panel from clipboard menu item"),label:(0,x.t)("dashboard.add-menu.paste-panel","Paste panel"),onClick:()=>{en.pastePanel(),I.c.toolbarAddButtonClicked({item:"paste_panel"})}},"paste-panel")]}),placement:"bottom",offset:[0,6],children:(0,t.jsxs)(m.$n,{variant:"primary",size:"sm",fill:"outline","data-testid":r.Tp.components.PageToolbar.itemButton("Add button"),children:[(0,t.jsx)(x.x6,{i18nKey:"dashboard.toolbar.add",children:"Add"}),(0,t.jsx)(h.I,{name:Ys?"angle-up":"angle-down",size:"lg"})]},"add-panel-button")},"add-panel-dropdown")}),ua.push({group:"playlist-actions",condition:Ea&&Ar&&!$n,render:()=>(0,t.jsx)(o.I,{"data-testid":r.Tp.pages.Dashboard.DashNav.playlistControls.prev,tooltip:(0,x.t)("dashboard.toolbar.playlist-previous","Go to previous dashboard"),icon:"backward",onClick:()=>C._o.prev()},"play-list-prev")}),ua.push({group:"playlist-actions",condition:Ea&&Ar&&!$n,render:()=>(0,t.jsx)(o.I,{onClick:()=>C._o.stop(),"data-testid":r.Tp.pages.Dashboard.DashNav.playlistControls.stop,children:(0,t.jsx)(x.x6,{i18nKey:"dashboard.toolbar.playlist-stop",children:"Stop playlist"})},"play-list-stop")}),ua.push({group:"playlist-actions",condition:Ea&&Ar&&!$n,render:()=>(0,t.jsx)(o.I,{"data-testid":r.Tp.pages.Dashboard.DashNav.playlistControls.next,tooltip:(0,x.t)("dashboard.toolbar.playlist-next","Go to next dashboard"),icon:"forward",onClick:()=>C._o.next(),narrow:!0},"play-list-next")}),ua.push({group:"back-button",condition:(pr||Ja)&&!Fr,render:()=>(0,t.jsx)(m.$n,{onClick:()=>{a.Ny.partial({viewPanel:null,editPanel:null})},tooltip:"",variant:"secondary",size:"sm",icon:"arrow-left","data-testid":r.Tp.components.NavToolbar.editDashboard.backToDashboardButton,children:"Back to dashboard"},"back")}),ua.push({group:"back-button",condition:!!Ss,render:()=>(0,t.jsx)(m.$n,{onClick:()=>{a.Ny.partial({editview:null})},tooltip:"",fill:"text",variant:"secondary",size:"sm",icon:"arrow-left","data-testid":r.Tp.components.NavToolbar.editDashboard.backToDashboardButton,children:"Back to dashboard"},"back")});const Zr=qn&&!$n&&!es.isSnapshot&&!Ea;ua.push({group:"main-buttons",condition:!f.$.featureToggles.newDashboardSharingComponent&&Zr,render:()=>(0,t.jsx)(m.$n,{tooltip:(0,x.t)("dashboard.toolbar.share","Share dashboard"),size:"sm",className:za.buttonWithExtraMargin,fill:"outline",onClick:()=>{I.c.toolbarShareClick(),en.showModal(new Ls.Z({}))},"data-testid":r.Tp.components.NavToolbar.shareDashboard,children:"Share"},"share-dashboard-button")}),ua.push({group:"main-buttons",condition:!$n&&en.canEditDashboard()&&!pr&&!Ea&&Pa,render:()=>(0,t.jsx)(m.$n,{onClick:()=>{en.onEnterEditMode()},tooltip:"Enter edit mode",className:za.buttonWithExtraMargin,variant:f.$.featureToggles.newDashboardSharingComponent?"secondary":"primary",size:"sm","data-testid":r.Tp.components.NavToolbar.editDashboard.editButton,children:"Edit"},"edit")}),ua.push({group:"main-buttons",condition:!$n&&en.canEditDashboard()&&!pr&&!Ea&&!Pa,render:()=>(0,t.jsx)(m.$n,{onClick:()=>{en.onEnterEditMode(),en.setState({editable:!0,meta:{...es,canEdit:!0}})},tooltip:"This dashboard was marked as read only",className:za.buttonWithExtraMargin,variant:"secondary",size:"sm","data-testid":r.Tp.components.NavToolbar.editDashboard.editButton,children:"Make editable"},"edit")}),ua.push({group:"new-share-dashboard-buttons",condition:f.$.featureToggles.newDashboardSharingComponent&&Zr,render:()=>(0,t.jsx)(ce,{dashboard:en},"new-export-dashboard-button")}),ua.push({group:"new-share-dashboard-buttons",condition:f.$.featureToggles.newDashboardSharingComponent&&Zr,render:()=>(0,t.jsx)(Jn,{dashboard:en},"new-share-dashboard-button")}),ua.push({group:"settings",condition:$n&&en.canEditDashboard()&&Ar,render:()=>(0,t.jsx)(m.$n,{onClick:()=>{en.onOpenSettings()},tooltip:"Dashboard settings",fill:"text",size:"sm",variant:"secondary","data-testid":r.Tp.components.NavToolbar.editDashboard.settingsButton,children:"Settings"},"settings")}),ua.push({group:"main-buttons",condition:$n&&!es.isNew&&Ar,render:()=>(0,t.jsx)(m.$n,{onClick:()=>en.exitEditMode({skipConfirm:!1}),tooltip:"Exits edit mode and discards unsaved changes",size:"sm",fill:"text",variant:"primary","data-testid":r.Tp.components.NavToolbar.editDashboard.exitButton,children:"Exit edit"},"discard")}),ua.push({group:"main-buttons",condition:Ja&&!Fr&&!Ss&&!pr,render:()=>(0,t.jsx)(m.$n,{onClick:_s?.onDiscard,tooltip:_s?.state.isNewPanel?"Discard panel":"Discard panel changes",size:"sm",disabled:!Wr||!Gn,fill:"outline",variant:"destructive","data-testid":r.Tp.components.NavToolbar.editDashboard.discardChangesButton,children:_s?.state.isNewPanel?"Discard panel":"Discard panel changes"},"discard")}),ua.push({group:"main-buttons",condition:Ja&&Fr&&!Ss&&!pr,render:()=>(0,t.jsx)(m.$n,{onClick:_s?.onDiscard,tooltip:"Discard library panel changes",size:"sm",fill:"outline",variant:"destructive","data-testid":r.Tp.components.NavToolbar.editDashboard.discardChangesButton,children:"Discard library panel changes"},"discardLibraryPanel")}),ua.push({group:"main-buttons",condition:Ja&&Fr&&!Ss&&!pr,render:()=>(0,t.jsx)(m.$n,{onClick:_s?.onUnlinkLibraryPanel,tooltip:"Unlink library panel",size:"sm",fill:"outline",variant:"secondary","data-testid":r.Tp.components.NavToolbar.editDashboard.unlinkLibraryPanelButton,children:"Unlink library panel"},"unlinkLibraryPanel")}),ua.push({group:"main-buttons",condition:Ja&&Fr&&!Ss&&!pr,render:()=>(0,t.jsx)(m.$n,{onClick:_s?.onSaveLibraryPanel,tooltip:"Save library panel",size:"sm",fill:"outline",variant:"primary","data-testid":r.Tp.components.NavToolbar.editDashboard.saveLibraryPanelButton,children:"Save library panel"},"saveLibraryPanel")}),ua.push({group:"main-buttons",condition:$n&&!Fr&&(es.canSave||ja),render:()=>{if(es.isNew)return(0,t.jsx)(m.$n,{onClick:()=>{I.c.toolbarSaveClick(),en.openSaveDrawer({})},className:za.buttonWithExtraMargin,tooltip:"Save changes",size:"sm",variant:"primary","data-testid":r.Tp.components.NavToolbar.editDashboard.saveButton,children:"Save dashboard"},"save");if(ja&&!es.canSave&&!es.canMakeEditable)return(0,t.jsx)(m.$n,{onClick:()=>{I.c.toolbarSaveClick(),en.openSaveDrawer({saveAsCopy:!0})},className:za.buttonWithExtraMargin,tooltip:"Save as copy",size:"sm",variant:Gn?"primary":"secondary",children:"Save as copy"},"save");const Fa=(0,t.jsxs)(p.W,{children:[(0,t.jsx)(p.W.Item,{label:"Save",icon:"save",onClick:()=>{I.c.toolbarSaveClick(),en.openSaveDrawer({})}}),(0,t.jsx)(p.W.Item,{label:"Save as copy",icon:"copy",onClick:()=>{I.c.toolbarSaveAsClick(),en.openSaveDrawer({saveAsCopy:!0})}})]});return(0,t.jsxs)(y.e,{className:za.buttonWithExtraMargin,children:[(0,t.jsx)(m.$n,{onClick:()=>{I.c.toolbarSaveClick(),en.openSaveDrawer({})},tooltip:"Save changes",size:"sm","data-testid":r.Tp.components.NavToolbar.editDashboard.saveButton,variant:Gn?"primary":"secondary",children:"Save dashboard"}),(0,t.jsx)(l.m,{overlay:Fa,children:(0,t.jsx)(m.$n,{"aria-label":"More save options",icon:"angle-down",variant:Gn?"primary":"secondary",size:"sm"})})]},"save")}});const mo=[];let ao="";for(const Fa of ua)Fa.condition&&(ao&&ao!==Fa.group&&ao&&mo.push((0,t.jsx)(u.K,{},`${Fa.group}-separator`)),mo.push(Fa.render()),ao=Fa.group);return(0,t.jsx)(d.U,{alignment:"right",children:mo})}function Ba(en,$n,Qn){if($n.length>0)for(const Gn of $n){const qn={dashboard:(0,E.UA)().getCurrent()};if(Gn.show(qn)){const es=Gn.component;en.push({group:Qn,condition:!0,render:()=>(0,n.createElement)(es,{...qn,key:en.length})})}}}function _a(en){const[$n,Qn]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{if(en){const Gn=en.state.vizManager.subscribeToState(qn=>Qn(qn.sourcePanel.resolve().parent instanceof wa.F));return()=>{Gn.unsubscribe()}}Qn(!1)},[en]),$n}function dr(en){const[$n,Qn]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{if(en){const Gn=en.state.vizManager.subscribeToState(qn=>Qn(qn.isDirty||!1));return()=>{Gn.unsubscribe()}}Qn(!1)},[en]),$n}function Wa(en){return{buttonWithExtraMargin:(0,i.css)({margin:en.spacing(0,.5)}),publicBadge:(0,i.css)({color:"grey",backgroundColor:"transparent",border:"1px solid"})}}},42397:(G,O,e)=>{"use strict";e.d(O,{$:()=>o,m:()=>g});var t=e(74848),n=e(80943),i=e(91052),s=e(14578),r=e(83122),f=e(27746),a=e(38138),c=e(7196);class o extends n.Bs{static{this.Component=h}}function h({model:p}){const{menu:m,rawLinks:y}=p.useState();if(!(p.parent instanceof n.Eb))throw new Error("VizPanelLinks must be a child of VizPanel");if(!y||y.length===0)return null;if(y.length===1){const d=(0,c.eQ)(p.parent)[0];return(0,t.jsx)(i.NR.TitleItem,{href:d.href,onClick:d.onClick,target:d.target,title:d.title,children:(0,t.jsx)(s.I,{name:"external-link-alt",size:"md"})})}return(0,t.jsx)(r.m,{overlay:()=>(0,t.jsx)(m.Component,{model:m},m.state.key),children:(0,t.jsx)(f.I,{icon:"external-link-alt",iconSize:"md","aria-label":"panel links"})})}class g extends n.Bs{static{this.Component=l}}function l({model:p}){const{links:m}=p.useState();return m?(0,t.jsx)(a.W,{children:m?.map((y,d)=>(0,t.jsx)(a.W.Item,{label:y.title,url:y.href,target:y.target,onClick:y.onClick},d))}):null}},7196:(G,O,e)=>{"use strict";e.d(O,{eQ:()=>de,MI:()=>fe,oV:()=>ee,_i:()=>ae,t0:()=>re,vR:()=>je});var t=e(74135),n=e(1933),i=e(76885),s=e(32264),r=e(4402),f=e(12131),a=e(80943),c=e(28138),o=e(8484),h=e(63066),g=e(22699),l=e(16560),p=e(32349),m=e(75462),y=e(19347),d=e(74730),v=e(94383),u=e(40588),D=e(74848),P=e(56833);class x extends a.Bs{static{this.Component=E}constructor(Re){super(Re),this.trail=C(Re)}}function E({model:Ne}){return(0,D.jsx)(Ne.trail.Component,{model:Ne.trail})}function C({metric:Ne,filters:Re,dataSourceUid:Se,timeRange:We}){return new P.b({$timeRange:We,metric:Ne,initialDS:Se,initialFilters:Re,embedded:!0})}var M=e(32196),S=e(40845),I=e(87978),T=e(28444);function b(Ne){const{scene:Re,title:Se,onDismiss:We}=Ne,Ke=(0,S.of)(L);return(0,D.jsx)(I._,{title:Se,onClose:We,size:"lg",children:(0,D.jsx)("div",{className:Ke.drawerInnerWrapper,children:(0,D.jsx)(Re.Component,{model:Re})})})}class R extends a.Bs{constructor(Re){super(Re)}static Component({model:Re}){const Se=Re.useState();return(0,D.jsx)(b,{...Se})}}function A(Ne){const Re={component:b,props:Ne};appEvents.publish(new ShowModalReactEvent(Re))}function L(Ne){return{drawerInnerWrapper:(0,M.css)({display:"flex",padding:Ne.spacing(2),background:Ne.isDark?Ne.colors.background.canvas:Ne.colors.background.primary,position:"absolute",left:0,right:0,top:0})}}var U=e(76040);function W(Ne){return Ne.op==="="}function w(Ne){return Ne.state.$timeRange.clone()}function N({metric:Ne,labelFilters:Re}){if(Re.length===0)return Ne;const Se=`{${Re.map(({label:We,op:Ke,value:Xe})=>`${We}${Ke}"${Xe}"`)}}`;return`${Ne}${Se}`}function B(Ne){return Ne?.map(Re=>({key:Re.label,value:Re.value,operator:Re.op}))}function V(Ne){const Re=[];return Ne.forEach(Se=>{const We=(0,U.u)(Se);if(We.errors.length>0)return;const{metric:Ke,labels:Xe}=We.query;Re.push({metric:Ke,labelFilters:Xe.filter(W),query:Se}),We.query.binaryQueries?.forEach(({query:{metric:Je,labels:st}})=>{Re.push({metric:Je,labelFilters:st.filter(W),query:Se})})}),Re}async function K(Ne,Re,Se){if(Re.state.pluginId!=="timeseries")return;const We=(0,d.un)(Re);if(We==null)return;const{queries:Ke,datasource:Xe,data:Je}=We.state;if(Xe==null||Xe.type!=="prometheus")return;const st=await(0,y.l)().get(Xe);if(st.interpolateVariablesInQueries==null)return;const pt=st.interpolateVariablesInQueries(Ke,{__sceneObject:{value:Re}},Je?.request?.filters).filter(Z),ot=V(pt.map($e=>$e.expr)).map($e=>({text:N($e),onClick:Y($e,Ne,st)}));ot.length>0&&Se.push({text:"Explore metrics",iconClassName:"code-branch",subMenu:H(ot)})}function H(Ne){const Re=new Set;function Se({text:We}){const Ke=Re.size;return Re.add(We),Re.size>Ke}return Ne.filter(Se)}function X({metric:Ne,labelFilters:Re,query:Se},We,Ke){return{metric:Ne,filters:B(Re),dataSourceUid:Ke,timeRange:We}}function k(Ne,Re,Se){const We=w(Re),Ke=X(Ne,We,Se.uid),Xe=new x(Ke);return Xe.trail.addActivationHandler(()=>{Xe.trail.state.topScene instanceof v.R&&Xe.trail.state.topScene.setActionView("breakdown")}),{scene:Xe,title:"Explore metrics"}}function Y(Ne,Re,Se){return()=>{const We=k(Ne,Re,Se),Ke=new R({...We,onDismiss:()=>Re.closeModal()});(0,u.z)("exploration_started",{cause:"dashboard_panel"}),Re.showModal(Ke)}}function Z(Ne){return"expr"in Ne}var se=e(85174),j=e(7758),q=e(11982),ne=e(34842),oe=e(60656),z=e(42397),te=e(54174);class le extends a.Bs{constructor(){super(...arguments),this.onDismiss=()=>{(0,d.YQ)(this).closeModal()},this.onConfirm=()=>{const Re=(0,d.YQ)(this);Re.unlinkLibraryPanel(this.state.panelRef.resolve()),Re.closeModal()}}static{this.Component=ie}}function ie({model:Ne}){return(0,D.jsx)(te.l,{isOpen:!0,onConfirm:()=>{Ne.onConfirm(),Ne.onDismiss()},onDismiss:Ne.onDismiss})}function ae(Ne,Re=!1){(async()=>{const We=Ne.parent,Ke=We.parent,Xe=We.getPlugin(),Je=[],st=[],pt=(0,d.YQ)(We),{isEmbedded:xt}=pt.state.meta,ot=await ce(We);if(xt){ot&&Ne.setState({items:[ot]});return}const $e=!!pt.state.editPanel;$e||Je.push({text:(0,o.t)("panel.header-menu.view","View"),iconClassName:"eye",shortcut:"v",onClick:()=>j.c.panelMenuItemClicked("view"),href:(0,q.r7)(We)}),pt.canEditDashboard()&&pt.state.editable&&!Re&&!$e&&Je.push({text:(0,o.t)("panel.header-menu.edit","Edit"),iconClassName:"edit",shortcut:"e",onClick:()=>j.c.panelMenuItemClicked("edit"),href:(0,q.e0)((0,d.Cs)(We))}),Je.push({text:(0,o.t)("panel.header-menu.share","Share"),iconClassName:"share-alt",onClick:()=>{j.c.panelMenuItemClicked("share"),pt.showModal(new se.Z({panelRef:We.getRef()}))},shortcut:"p s"}),pt.state.isEditing&&!Re&&!$e&&st.push({text:(0,o.t)("panel.header-menu.duplicate","Duplicate"),onClick:()=>{j.c.panelMenuItemClicked("duplicate"),pt.duplicatePanel(We)},shortcut:"p d"}),$e||st.push({text:(0,o.t)("panel.header-menu.copy","Copy"),onClick:()=>{j.c.panelMenuItemClicked("copy"),pt.copyPanel(We)}}),pt.state.isEditing&&!Re&&!$e&&(Ke instanceof oe.F?(st.push({text:(0,o.t)("panel.header-menu.unlink-library-panel","Unlink library panel"),onClick:()=>{j.c.panelMenuItemClicked("unlinkLibraryPanel"),pt.showModal(new le({panelRef:Ke.getRef()}))}}),st.push({text:(0,o.t)("panel.header-menu.replace-library-panel","Replace library panel"),onClick:()=>{j.c.panelMenuItemClicked("replaceLibraryPanel"),pt.onShowAddLibraryPanelDrawer(Ke.getRef())}})):st.push({text:(0,o.t)("panel.header-menu.create-library-panel","Create library panel"),onClick:()=>{j.c.panelMenuItemClicked("createLibraryPanel"),pt.showModal(new se.Z({panelRef:We.getRef(),activeTab:g.wr.libraryPanel}))}})),st.push({text:(0,o.t)("panel.header-menu.new-alert-rule","New alert rule"),onClick:be=>Te(We)}),He(We.state.options)&&!$e&&st.push({text:We.state.options.legend.showLegend?(0,o.t)("panel.header-menu.hide-legend","Hide legend"):(0,o.t)("panel.header-menu.show-legend","Show legend"),onClick:be=>{be.preventDefault(),je(We)},shortcut:"p l"}),pt.canEditDashboard()&&Xe&&!Xe.meta.skipDataQuery&&!Re&&st.push({text:(0,o.t)("panel.header-menu.get-help","Get help"),onClick:be=>{be.preventDefault(),Be(We,l.q.Help)}}),s.$.featureToggles.exploreMetrics&&await K(pt,We,Je),ot&&Je.push(ot),Je.push(me(Xe,We,pt));const{extensions:ve}=(0,r.Kf)({extensionPointId:t.S.DashboardPanelMenu,context:De(We,pt),limitPerPlugin:3});ve.length>0&&!pt.state.isEditing&&Je.push({text:"Extensions",iconClassName:"plug",type:"submenu",subMenu:(0,m.N9)(ve)}),st.length&&Je.push({type:"submenu",text:(0,o.t)("panel.header-menu.more","More..."),iconClassName:"cube",subMenu:st,onClick:be=>{be.preventDefault()}}),pt.state.isEditing&&!Re&&!$e&&(Je.push({text:"",type:"divider"}),Je.push({text:(0,o.t)("panel.header-menu.remove","Remove"),iconClassName:"trash-alt",onClick:()=>{j.c.panelMenuItemClicked("remove"),fe(pt,We)},shortcut:"p r"})),Ne.setState({items:Je})})()}const re=Ne=>ae(Ne,!0);async function ce(Ne){const Re=await(0,q.Lp)(Ne);if(Re)return{text:(0,o.t)("panel.header-menu.explore","Explore"),iconClassName:"compass",shortcut:"p x",onClick:()=>j.c.panelMenuItemClicked("explore"),href:Re}}function me(Ne,Re,Se){const We=[];return Ne&&!Ne.meta.skipDataQuery&&(We.push({text:(0,o.t)("panel.header-menu.inspect-data","Data"),href:(0,q.Uu)(Re,l.q.Data),onClick:Ke=>{Ke.preventDefault(),f.Ny.partial({inspect:Re.state.key,inspectTab:l.q.Data}),j.c.panelMenuInspectClicked(l.q.Data)}}),Se instanceof ne.H$&&Se.state.meta.canEdit&&We.push({text:(0,o.t)("panel.header-menu.query","Query"),href:(0,q.Uu)(Re,l.q.Query),onClick:Ke=>{Ke.preventDefault(),f.Ny.partial({inspect:Re.state.key,inspectTab:l.q.Query}),j.c.panelMenuInspectClicked(l.q.Query)}})),We.push({text:(0,o.t)("panel.header-menu.inspect-json","Panel JSON"),href:(0,q.Uu)(Re,l.q.JSON),onClick:Ke=>{Ke.preventDefault(),f.Ny.partial({inspect:Re.state.key,inspectTab:l.q.JSON}),j.c.panelMenuInspectClicked(l.q.JSON)}}),{text:(0,o.t)("panel.header-menu.inspect","Inspect"),iconClassName:"info-circle",shortcut:"i",href:(0,q.Uu)(Re),onClick:Ke=>{Ke.isDefaultPrevented()||(f.Ny.partial({inspect:Re.state.key,inspectTab:l.q.Data}),j.c.panelMenuInspectClicked(l.q.Data))},subMenu:We.length>0?We:void 0}}function ee(Ne){if(!(Ne.parent instanceof z.$))throw new Error("parent of VizPanelLinksMenu must be VizPanelLinks");const Re=Ne.parent.parent;if(!(Re instanceof a.Eb))throw new Error("parent of VizPanelLinks must be VizPanel");Ne.setState({links:de(Re)})}function de(Ne){const Re=(Ke,Xe)=>a.jh.interpolate(Ne,Ke,Xe),Se=(0,p.CH)(Ne,Re);if(!Se)return[];const We=Se.getLinks(Re);return We.map(Ke=>({...Ke,onClick:(Je,st)=>{j.c.panelLinkClicked({has_multiple_links:We.length>1}),Ke.onClick?.(Je,st)}}))}function De(Ne,Re){const Se=a.jh.getTimeRange(Ne);let We=(0,d.un)(Ne);const Ke=We?.state.queries,Xe=(0,d.Cs)(Ne);let Je={};if(Ne.state.$variables&&Ne.state.$variables.state.variables.forEach(st=>{st instanceof a.xc&&(Je={...Je,[st.state.name]:{value:st.getValue(),text:st.getValueText()}})}),Ne.parent?.parent instanceof a.tI){const st=Ne.parent.parent;st.state.$variables&&st.state.$variables.state.variables.forEach(pt=>{pt instanceof a.xc&&(Je={...Je,[pt.state.name]:{value:pt.getValue(),text:pt.getValueText()}})})}return{id:Xe,pluginId:Ne.state.pluginId,title:Ne.state.title,timeRange:Se.state.value.raw,timeZone:(0,n.O)({timeZone:Se.getTimeZone()}),dashboard:{uid:Re.state.uid,title:Re.state.title,tags:Re.state.tags||[]},targets:Ke,scopedVars:Je,data:We?.state.data}}function fe(Ne,Re){c.A.publish(new T.bY({title:"Remove panel",text:"Are you sure you want to remove this panel?",icon:"trash-alt",yesText:"Remove",onConfirm:()=>Ne.removePanel(Re)}))}const Te=async Ne=>{j.c.panelMenuItemClicked("create-alert");const Re=await(0,h.J6)(Ne),Se=i.kM.renderUrl("/alerting/new",{defaults:JSON.stringify(Re),returnTo:location.pathname+location.search});f.Ny.push(Se),j.c.panelMenuItemClicked("create-alert")};function je(Ne){const Re=Ne.state.options;He(Re)&&typeof Re.legend.showLegend=="boolean"&&Ne.onOptionsChange({legend:{showLegend:!Re.legend.showLegend}}),j.c.panelMenuItemClicked("toggleLegend")}function He(Ne){return Ne!=null&&typeof Ne=="object"&&"legend"in Ne}const Be=(Ne,Re)=>{f.Ny.partial({inspect:Ne.state.key,inspectTab:Re}),j.c.panelMenuInspectClicked(Re??l.q.Data)}},99589:(G,O,e)=>{"use strict";e.d(O,{W:()=>r});var t=e(74848),n=e(80943),i=e(2038),s=e(74730);class r extends n.Bs{constructor(){super({}),this.onActivate=()=>{const c=this.parent;if(!c||!(c instanceof n.Eb))throw new Error("PanelNotices can be used only as title items for VizPanel")},this.addActivationHandler(this.onActivate)}static{this.Component=f}getPanel(){const c=this.parent;return c&&c instanceof n.Eb?c:null}}function f({model:a}){const c=a.getPanel(),h=n.jh.getData(a).useState();if(!c)return null;const g=(0,s.Cs)(c);return h.data?.series?(0,t.jsx)(i.Z,{frames:h.data?.series,panelId:g}):null}},7928:(G,O,e)=>{"use strict";e.d(O,{v:()=>l});var t=e(74848),n=e(32196),i=e(43127),s=e(65879),r=e(85858),f=e(80943),a=e(40845),c=e(56034),o=e(15666),h=e(91052),g=e(14578);class l extends f.XQ{static{this.Component=p}constructor(d={}){super({...d,from:"now-6h",to:"now",value:(0,i.E2)()}),this.addActivationHandler(()=>this._onActivate())}_onActivate(){this._subs.add(this.subscribeToState((d,v)=>{if(d.timeFrom!==v.timeFrom||d.timeShift!==v.timeShift){const{timeInfo:u,timeRange:D}=this.getTimeOverride(this.getAncestorTimeRange().state.value);this.setState({timeInfo:u,value:D})}}))}ancestorTimeRangeChanged(d){const v=this.getTimeOverride(d.value);this.setState({value:v.timeRange,timeInfo:v.timeInfo})}getTimeOverride(d){const{timeFrom:v,timeShift:u}=this.state,D={timeInfo:"",timeRange:d};if(v){const P=f.jh.interpolate(this,this.state.timeFrom),x=s.describeTextRange(P);if(x.invalid)return D.timeInfo="invalid time override",D;s.isRelativeTimeRange(d.raw)&&(D.timeInfo=x.display,D.timeRange={from:r.parse(x.from),to:r.parse(x.to),raw:{from:x.from,to:x.to}})}if(u){const P=f.jh.interpolate(this,this.state.timeShift);if(s.describeTextRange(P).invalid)return D.timeInfo="invalid timeshift",D;const E="-"+P;D.timeInfo+=" timeshift "+E;const C=r.parseDateMath(E,D.timeRange.from,!1),M=r.parseDateMath(E,D.timeRange.to,!0);D.timeRange={from:C,to:M,raw:{from:C,to:M}}}return D}}function p({model:y}){const{timeInfo:d,hideTimeOverride:v}=y.useState(),u=(0,a.of)(m);return!d||v?null:(0,t.jsx)(c.m,{content:(0,t.jsx)(o.xS,{timeRange:y.state.value,timeZone:y.getTimeZone()}),children:(0,t.jsxs)(h.NR.TitleItem,{className:u.timeshift,children:[(0,t.jsx)(g.I,{name:"clock-nine",size:"sm"})," ",d]})})}const m=y=>({timeshift:(0,n.css)({color:y.colors.text.link,gap:y.spacing(.5),whiteSpace:"nowrap"})})},79284:(G,O,e)=>{"use strict";e.d(O,{L:()=>f});var t=e(2543),n=e.n(t),i=e(80943),s=e(74730),r=e(30195);class f extends i.Bs{constructor(l){super(l),this._variableDependency=new i.Sh(this,{variableNames:[this.state.variableName],onVariableUpdateCompleted:()=>{}}),this.isWaitingForVariables=!1,this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){this.performRepeat()}_getRow(){if(!(this.parent instanceof i.tI))throw new Error("RepeatedRowBehavior: Parent is not a SceneGridRow");return this.parent}_getLayout(){const l=i.jh.getLayout(this);if(!(l instanceof i.hy))throw new Error("RepeatedRowBehavior: Layout is not a SceneGridLayout");return l}performRepeat(){if(this.isWaitingForVariables=this._variableDependency.hasDependencyInLoadingState(),this.isWaitingForVariables)return;const l=i.jh.lookupVariable(this.state.variableName,this.parent?.parent);if(!l){console.error("RepeatedRowBehavior: Variable not found");return}if(l instanceof i.n8){if(!l.state.isMulti)return}else{console.error("RepeatedRowBehavior: Variable is not a MultiValueVariable");return}const p=this._getRow(),m=this._getLayout(),{values:y,texts:d}=(0,s.a7)(l);if((0,t.isEqual)(this._prevRepeatValues,y))return;this._prevRepeatValues=y;const v=[],u=p.state.children,D=a(u);let P=0;const x={values:["placeholder"],texts:l.hasAllValue()?["All"]:["None"]},E=y.length?y:x.values,C=d.length?d:x.texts;for(let M=0;M<E.length;M++){const S=[],I=E[M];for(const b of u){const A=(b.state.y??0)+(D+1)*M,L=M>0?`${b.state.key}-clone-${I}`:b.state.key,U=b.clone({key:L,y:A});M>0&&h(U,I),S.push(U),P<A+U.state.height&&(P=A+U.state.height)}const T=this.getRowClone(p,M,I,C[M],D,S);v.push(T)}c(m,v,P,p),this.publishEvent(new r.d({source:this}),!0)}getRowClone(l,p,m,y,d,v){if(p===0)return l.setState({$variables:new i.Pj({variables:[new i.xc({name:this.state.variableName,value:m,text:String(y)})]}),children:v}),l;const u=l.state.y??0;return l.clone({key:`${l.state.key}-clone-${m}`,$variables:new i.Pj({variables:[new i.xc({name:this.state.variableName,value:m,text:String(y)})]}),$behaviors:[],children:v,y:u+d*p+p,actions:void 0})}removeBehavior(){const l=this._getRow(),p=this._getLayout(),m=o(this._getLayout(),this._getRow());p.setState({children:m}),l.setState({$behaviors:l.state.$behaviors.filter(y=>y!==this),$variables:void 0})}}function a(g){let l=0,p=Number.MAX_VALUE;if(g.length===0)return 0;for(const m of g)m.state.y+m.state.height>l&&(l=m.state.y+m.state.height),m.state.y<p&&(p=m.state.y);return l-p}function c(g,l,p,m){const y=o(g,m),d=y.indexOf(m);if(d===-1)throw new Error("RowRepeaterBehavior: Parent row not found in layout children");const v=[...y.slice(0,d),...l,...y.slice(d+1)];if(y.length>d+1){const u=y.slice(d+1),D=u[0].state.y,P=p-D;for(const x of u)if(x.setState({y:x.state.y+P}),x instanceof i.tI)for(const E of x.state.children)E.setState({y:E.state.y+P})}g.setState({children:v})}function o(g,l){return g.state.children.filter(p=>!p.state.key?.startsWith(`${l.state.key}-clone-`))}function h(g,l){g.forEachChild(p=>{p.setState({key:`${p.state.key}-clone-${l}`}),h(p,l)})}},54174:(G,O,e)=>{"use strict";e.d(O,{l:()=>i});var t=e(74848),n=e(96374);const i=({isOpen:s,onConfirm:r,onDismiss:f})=>(0,t.jsx)(n.u,{title:"Do you really want to unlink this panel?",icon:"question-circle",body:`If you unlink this panel, you will be able to edit it without affecting any other dashboards.
            However, once you make a change you will not be able to revert to its original reusable panel.`,confirmText:"Yes, unlink",onConfirm:()=>{r(),f()},onDismiss:f,isOpen:s})},58029:(G,O,e)=>{"use strict";e.d(O,{u:()=>T});var t=e(74848),n=e(32196),i=e(80943),s=e(72109),r=e(40845),f=e(14578),a=e(28138),c=e(14348),o=e(28444),h=e(74730),g=e(41507),l=e(79284),p=e(71678),m=e(37390),y=e(96540),d=e(49785),v=e(13544),u=e(88575),D=e(10354),P=e(42418),x=e(55852),E=e(92378);const C=({repeat:R,title:A,parent:L,warning:U,onUpdate:W,onCancel:w})=>{const[N,B]=(0,y.useState)(R),V=(0,y.useCallback)(k=>B(k),[B]),{handleSubmit:K,register:H}=(0,d.mN)({defaultValues:{title:A}}),X=k=>{W(k.title,N)};return(0,t.jsxs)("form",{onSubmit:K(X),children:[(0,t.jsx)(u.D,{label:"Title",children:(0,t.jsx)(D.p,{...H("title"),type:"text"})}),(0,t.jsx)(u.D,{label:"Repeat for",children:(0,t.jsx)(E.U,{parent:L,repeat:N,onChange:V})}),U&&(0,t.jsx)(P.F,{"data-testid":v.Tp.pages.Dashboard.Rows.Repeated.ConfigSection.warningMessage,severity:"warning",title:"",topSpacing:3,bottomSpacing:0,children:U}),(0,t.jsxs)(m.a.ButtonRow,{children:[(0,t.jsx)(x.$n,{type:"button",variant:"secondary",onClick:w,fill:"outline",children:"Cancel"}),(0,t.jsx)(x.$n,{type:"submit",children:"Update"})]})]})},M=({repeat:R,title:A,parent:L,onDismiss:U,onUpdate:W,warning:w})=>{const N=(0,r.of)(S);return(0,t.jsx)(m.a,{isOpen:!0,title:"Row options",onDismiss:U,className:N.modal,children:(0,t.jsx)(C,{parent:L,repeat:R,title:A,onCancel:U,onUpdate:W,warning:w})})},S=()=>({modal:(0,n.css)({label:"RowOptionsModal",width:"500px"})}),I=({repeat:R,title:A,parent:L,onUpdate:U,warning:W})=>{const w=N=>(B,V)=>{U(B,V),N()};return(0,t.jsx)(p.$s,{children:({showModal:N,hideModal:B})=>(0,t.jsx)("button",{type:"button",className:"pointer","aria-label":"Row options",onClick:()=>{N(M,{title:A,repeat:R,parent:L,onDismiss:B,onUpdate:w(B),warning:W})},children:(0,t.jsx)(f.I,{name:"cog"})})})};I.displayName="RowOptionsButton";class T extends i.Bs{constructor(){super(...arguments),this.onUpdate=(A,L)=>{const U=this.getParent();let W;if(U.state.$behaviors)for(let w of U.state.$behaviors)w instanceof l.L&&(W=w);if(L&&!W){const w=new l.L({variableName:L});U.setState({$behaviors:[...U.state.$behaviors??[],w]})}else W&&W.removeBehavior();A!==U.state.title&&U.setState({title:A})},this.onDelete=()=>{a.A.publish(new o.bY({title:"Delete row",text:"Are you sure you want to remove this row and all its panels?",altActionText:"Delete row only",icon:"trash-alt",onConfirm:()=>{this.getDashboard().removeRow(this.getParent(),!0)},onAltAction:()=>{this.getDashboard().removeRow(this.getParent())}}))},this.getWarning=()=>{if(this.getParent().state.children.some(W=>{if(!(W instanceof g.U))return!1;const w=W.state.body;return w instanceof i.Eb?(0,h.un)(w)?.state.datasource?.uid===c.K:!1}))return(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{children:["Panels in this row use the ",c.K," data source. These panels will reference the panel in the original row, not the ones in the repeated rows."]}),(0,t.jsx)(s.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/create-dashboard/#configure-repeating-rows",children:"Learn more"})]})}}getParent(){if(!(this.parent instanceof i.tI))throw new Error("RowActions must have a SceneGridRow parent");return this.parent}getDashboard(){return(0,h.YQ)(this)}static{this.Component=({model:A})=>{const L=A.getDashboard(),U=A.getParent(),{title:W}=U.useState(),{meta:w,isEditing:N}=L.useState(),B=(0,r.of)(b),V=U.state.$behaviors?.find(K=>K instanceof l.L);return(0,t.jsx)(t.Fragment,{children:w.canEdit&&N&&(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:B.rowActions,children:[(0,t.jsx)(I,{title:W,repeat:V instanceof l.L?V.state.variableName:void 0,parent:L,onUpdate:A.onUpdate,warning:A.getWarning()}),(0,t.jsx)("button",{type:"button",onClick:A.onDelete,"aria-label":"Delete row",children:(0,t.jsx)(f.I,{name:"trash-alt"})})]})})})}}}const b=R=>({rowActions:(0,n.css)({color:R.colors.text.secondary,lineHeight:"27px",button:{color:R.colors.text.secondary,paddingLeft:R.spacing(2),background:"transparent",border:"none","&:hover":{color:R.colors.text.maxContrast}}})})},30195:(G,O,e)=>{"use strict";e.d(O,{d:()=>n});var t=e(65463);class n extends t.x{static{this.type="dashboard-repeats-processed"}}},71176:(G,O,e)=>{"use strict";e.d(O,{X:()=>s});var t=e(32264),n=e(79422),i=e(31193);async function s(r){let f=n.Ye.templating?.list;if(t.$.featureToggles.newDashboardWithFiltersAndGroupBy){const c=await(0,i.tR)().get();if(c.getTagKeys){const o={type:c.meta.id,uid:c.uid},h={datasource:o,filters:[],name:"Filter",type:"adhoc"},g={datasource:o,name:"Group by",type:"groupby"};f=(f||[]).concat([h,g])}}const a={meta:{canStar:!1,canShare:!1,canDelete:!1,isNew:!0,folderUid:""},dashboard:{...n.Ye,uid:"",title:"New dashboard",panels:[],timezone:t.$.bootData.user?.timezone||n.Ye.timezone}};return f&&(a.dashboard.templating={list:f}),r&&(a.meta.folderUid=r),a}},70665:(G,O,e)=>{"use strict";e.d(O,{x:()=>t});const t={name:"grafana",uid:"grafana"}},13989:(G,O,e)=>{"use strict";e.d(O,{O:()=>n});var t=e(80943);function n(i){const s=[];for(const r of i){if(!(r instanceof t.tV.g))continue;const f={...r.state.query,enable:!!r.state.isEnabled,hide:!!r.state.isHidden};s.push(f)}return s}},53287:(G,O,e)=>{"use strict";e.d(O,{C:()=>f});var t=e(32264),n=e(80943),i=e(79422),s=e(73134),r=e(74730);function f(c){const o=[];for(const h of c.state.variables){const g={name:h.state.name,label:h.state.label,description:h.state.description??void 0,skipUrlSync:!!h.state.skipUrlSync,hide:h.state.hide||i.zL.dontHide,type:h.state.type};if(n.Go.isQueryVariable(h)){let l=[];h.state.refresh===s.CO.never&&(l=a(h.state)),o.push({...g,current:{value:h.state.value,text:h.state.text},options:l,query:h.state.query,definition:h.state.definition,datasource:h.state.datasource,sort:h.state.sort,refresh:h.state.refresh,regex:h.state.regex,allValue:h.state.allValue,includeAll:h.state.includeAll,multi:h.state.isMulti,skipUrlSync:h.state.skipUrlSync})}else if(n.Go.isCustomVariable(h))o.push({...g,current:{text:h.state.value,value:h.state.value},options:a(h.state),query:h.state.query,multi:h.state.isMulti,allValue:h.state.allValue,includeAll:h.state.includeAll});else if(n.Go.isDataSourceVariable(h))o.push({...g,current:{value:h.state.value,text:h.state.text},options:[],regex:h.state.regex,refresh:s.CO.onDashboardLoad,query:h.state.pluginId,multi:h.state.isMulti,allValue:h.state.allValue,includeAll:h.state.includeAll});else if(n.Go.isConstantVariable(h))o.push({...g,current:{value:h.state.value,text:h.state.value},query:h.state.value,hide:i.zL.hideVariable});else if(n.Go.isIntervalVariable(h)){const l=(0,r.bx)(h.state.intervals);o.push({...g,current:{text:h.state.value,value:h.state.value},query:l,refresh:h.state.refresh,options:h.state.intervals.map(p=>({value:p,text:p,selected:p===h.state.value})),auto:h.state.autoEnabled,auto_min:h.state.autoMinInterval,auto_count:h.state.autoStepCount})}else if(n.Go.isTextBoxVariable(h)){const l={text:h.state.value,value:h.state.value};o.push({...g,current:l,options:[{...l,selected:!0}],query:h.state.value})}else if(n.Go.isGroupByVariable(h)&&t.$.featureToggles.groupByVariable)o.push({...g,datasource:h.state.datasource,options:h.state.defaultOptions?.map(l=>({text:l.text,value:String(l.value)})),current:{text:h.state.text,value:h.state.value}});else if(n.Go.isAdHocVariable(h))o.push({...g,name:h.state.name,type:"adhoc",datasource:h.state.datasource,baseFilters:h.state.baseFilters,filters:h.state.filters,defaultKeys:h.state.defaultKeys});else throw new Error("Unsupported variable type")}for(const h of o)h.hide===i.zL.dontHide&&delete h.hide,h.skipUrlSync||delete h.skipUrlSync,h.label===""&&delete h.label,h.multi||delete h.multi,h.sort===s.ZG.disabled&&delete h.sort;return o}function a(c){return c.options.map(o=>({value:String(o.value),text:o.label,selected:Array.isArray(c.value)?c.value.includes(o.value):c.value===o.value}))}},85445:(G,O,e)=>{"use strict";e.d(O,{Al:()=>k,tt:()=>Y,EH:()=>H,wM:()=>B});var t=e(2543),n=e(32264),i=e(80943),s=e(34214),r=e(91309),f=e(38477),a=e(33278),c=e(16279),o=e(41507),h=e(74730);class g{constructor(oe,z){this._sceneObject=z,this.state={name:oe,type:"dashboard_macro"}}getValue(oe){const z=(0,h.YQ)(this._sceneObject);switch(oe){case"uid":return z.state.uid||"";case"title":case"name":case"id":default:return z.state.title}}getValueText(){return""}}function l(){const ne=i.Go.registerVariableMacro("__dashboard",g);return()=>ne()}var p=e(34842),m=e(60656),y=e(42397),d=e(7196),v=e(99589),u=e(7928),D=e(79284),P=e(58029),x=e(41987),E=e(69129),C=e(10154),M=e(32023);function S(ne,oe){oe.app=x.Jk.Dashboard,oe.canAddAnnotations=()=>{const z=(0,h.YQ)(ne);return!I(z)||!z.canEditDashboard()?!1:!!z.state.meta.annotationsPermissions?.dashboard.canAdd},oe.canEditAnnotations=z=>{const te=(0,h.YQ)(ne);return te.canEditDashboard()?z?!!te.state.meta.annotationsPermissions?.dashboard.canEdit:!!te.state.meta.annotationsPermissions?.organization.canEdit:!1},oe.canDeleteAnnotations=z=>{const te=(0,h.YQ)(ne);return te.canEditDashboard()?z?!!te.state.meta.annotationsPermissions?.dashboard.canDelete:!!te.state.meta.annotationsPermissions?.organization.canDelete:!1},oe.onAnnotationCreate=async z=>{const te=(0,h.YQ)(ne),le=z.from!==z.to,ie={dashboardUID:te.state.uid,panelId:(0,h.Cs)(ne),isRegion:le,time:z.from,timeEnd:le?z.to:0,tags:z.tags,text:z.description};await(0,C.vJ)(ie),T(te),oe.eventBus.publish(new E.We(ie))},oe.onAnnotationUpdate=async z=>{const te=(0,h.YQ)(ne),le=z.from!==z.to,ie={id:z.id,dashboardUID:te.state.uid,panelId:(0,h.Cs)(ne),isRegion:le,time:z.from,timeEnd:le?z.to:0,tags:z.tags,text:z.description};await(0,C.rJ)(ie),T(te),oe.eventBus.publish(new E.We(ie))},oe.onAnnotationDelete=async z=>{await(0,C.Xm)({id:z}),T((0,h.YQ)(ne)),oe.eventBus.publish(new E.We({id:z}))},oe.onAddAdHocFilter=z=>{const te=(0,h.YQ)(ne),le=(0,h.un)(ne);if(!le)return;const ie=b(te,le.state.datasource);R(ie,z)},oe.onUpdateData=z=>Promise.resolve(!0)}function I(ne){const oe=M.b4.getDataLayers(ne);for(const z of oe.state.annotationLayers)if(z instanceof i.tV.g&&z.state.isEnabled&&z.state.query.builtIn)return z}function T(ne){const oe=I(ne);oe&&oe.runLayer()}function b(ne,oe){const z=i.jh.getVariables(ne);for(const le of z.state.variables)if(i.Go.isAdHocVariable(le)){const ie=le.state.datasource;if(ie===oe||ie?.uid===oe?.uid)return le}const te=new i.H9({name:"Filters",datasource:oe,useQueriesAsFilterForOptions:!0});return z.setState({variables:[...z.state.variables,te]}),te}function R(ne,oe){for(const z of ne.state.filters)if(z.key===oe.key){ne.setState({filters:ne.state.filters.map(te=>te.key===oe.key?oe:te)});return}ne.setState({filters:[...ne.state.filters,oe]})}var A=e(96556),L=e(27734),U=e(7758),W=e(84423);function w(ne){return function(z,te){if(te.angularPanelCtrl){z.options={angularOptions:ne.getOptionsToRemember()};return}if((!ne.options||Object.keys(ne.options).length===0)&&(0,t.defaults)(z,ne.getOptionsToRemember()),ne.autoMigrateFrom){const le=W.NB[ne.autoMigrateFrom]!=null,ie=ne.getOptionsToRemember(),ae=ne.autoMigrateFrom;if(te.onPanelTypeChanged){const re=le?{angular:ie}:ie.options;Object.assign(z.options,te.onPanelTypeChanged(z,ae,re,z.fieldConfig))}}}}var N=e(70665);function B(ne){const oe=new s.G(ne.dashboard,ne.meta),z=H(oe,ne.dashboard);return z.setInitialSaveModel(ne.dashboard),z}function V(ne){const oe=[];let z=null,te=[];for(const le of ne)if(le.type==="row")z?z.id!==le.id&&(oe.push(K(z,te)),z=le,te=[]):le.collapsed?oe.push(K(le,[])):z=le;else if(le.libraryPanel?.uid&&!("model"in le.libraryPanel)){const ie=k(le);if(!ie)continue;z?te.push(ie):oe.push(ie)}else{le.snapshotData&&j(le);const ie=Y(le);z?te.push(ie):oe.push(ie)}return z&&oe.push(K(z,te)),oe}function K(ne,oe){ne.collapsed&&ne.panels&&(oe=ne.panels.map(le=>{if(le instanceof s.a||(le=new s.a(le)),le.libraryPanel?.uid&&!("model"in le.libraryPanel)){const ie=k(le);if(!ie)throw new Error("Failed to build grid item for library panel");return ie}return Y(le)}));let z,te=oe;return ne.repeat&&(z=[new D.L({variableName:ne.repeat})]),new i.tI({key:(0,h.XA)(ne.id),title:ne.title,y:ne.gridPos.y,isCollapsed:ne.collapsed,children:te,$behaviors:z,actions:new P.u({})})}function H(ne,oe){let z,te=[],le;if(ne.templating?.list?.length){const re=ne.templating.list.map(ce=>{try{return X(ce)}catch(me){return console.error(me),null}}).filter(ce=>!!ce);z=new i.Pj({variables:re})}else z=new i.Pj({variables:[]});ne.annotations?.list?.length&&!ne.isSnapshot()&&(te=ne.annotations?.list.map(re=>new f.g({key:(0,t.uniqueId)("annotations-"),query:re,name:re.name,isEnabled:!!re.enable,isHidden:!!re.hide})));let ie=n.$.unifiedAlertingEnabled;return ie||ne.panels.find(re=>!!re.alert)&&(ie=!0),ie&&(le=new r.C({key:"alert-states",name:"Alert States"})),new p.H$({description:ne.description,editable:ne.editable,preload:oe.preload??!1,id:ne.id,isDirty:!1,links:ne.links||[],meta:ne.meta,tags:ne.tags||[],title:ne.title,uid:ne.uid,version:ne.version,body:new i.hy({isLazy:!oe.preload,children:V(ne.panels),$behaviors:[q]}),$timeRange:new i.JZ({from:ne.time.from,to:ne.time.to,fiscalYearStartMonth:ne.fiscalYearStartMonth,timeZone:ne.timezone,weekStart:ne.weekStart,UNSAFE_nowDelay:ne.timepicker?.nowDelay}),$variables:z,$behaviors:[new i.Gg.K2({sync:ne.graphTooltip}),new i.Gg.Hf,l,Z,new i.Gg.en({enabled:ne.liveNow}),L.zf],$data:new c.s({annotationLayers:te,alertStatesLayer:le}),controls:new a.x({variableControls:[new i.K8({}),new i.i7],timePicker:new i.KE({}),refreshPicker:new i.WM({refresh:ne.refresh,intervals:ne.timepicker.refresh_intervals,withText:!0}),hideTimeControls:ne.timepicker.hidden})})}function X(ne){const oe={name:ne.name,label:ne.label,description:ne.description};if(ne.type==="adhoc")return new i.H9({...oe,description:ne.description,skipUrlSync:ne.skipUrlSync,hide:ne.hide,datasource:ne.datasource,applyMode:"auto",filters:ne.filters??[],baseFilters:ne.baseFilters??[],defaultKeys:ne.defaultKeys,useQueriesAsFilterForOptions:!0});if(ne.type==="custom")return new i.yP({...oe,value:ne.current?.value??"",text:ne.current?.text??"",query:ne.query,isMulti:ne.multi,allValue:ne.allValue||void 0,includeAll:ne.includeAll,defaultToAll:!!ne.includeAll,skipUrlSync:ne.skipUrlSync,hide:ne.hide});if(ne.type==="query")return new i.fS({...oe,value:ne.current?.value??"",text:ne.current?.text??"",query:ne.query,datasource:ne.datasource,sort:ne.sort,refresh:ne.refresh,regex:ne.regex,allValue:ne.allValue||void 0,includeAll:ne.includeAll,defaultToAll:!!ne.includeAll,isMulti:ne.multi,skipUrlSync:ne.skipUrlSync,hide:ne.hide,definition:ne.definition});if(ne.type==="datasource")return new i.mI({...oe,value:ne.current?.value??"",text:ne.current?.text??"",regex:ne.regex,pluginId:ne.query,allValue:ne.allValue||void 0,includeAll:ne.includeAll,defaultToAll:!!ne.includeAll,skipUrlSync:ne.skipUrlSync,isMulti:ne.multi,hide:ne.hide});if(ne.type==="interval"){const z=(0,h.Sm)(ne.query),te=(0,h.pk)(ne,z);return new i.Yj({...oe,value:te,intervals:z,autoEnabled:ne.auto,autoStepCount:ne.auto_count,autoMinInterval:ne.auto_min,refresh:ne.refresh,skipUrlSync:ne.skipUrlSync,hide:ne.hide})}else{if(ne.type==="constant")return new i.x0({...oe,value:ne.query,skipUrlSync:ne.skipUrlSync,hide:ne.hide});if(ne.type==="textbox"){let z;return ne?.current?.value?typeof ne.current.value=="string"?z=ne.current.value:z=ne.current.value[0]:z=ne.query,new i.TS({...oe,value:z,skipUrlSync:ne.skipUrlSync,hide:ne.hide})}else{if(n.$.featureToggles.groupByVariable&&ne.type==="groupby")return new i.ZG({...oe,datasource:ne.datasource,value:ne.current?.value||[],text:ne.current?.text||[],skipUrlSync:ne.skipUrlSync,hide:ne.hide,defaultOptions:ne.options});throw new Error(`Scenes: Unsupported variable type ${ne.type}`)}}}function k(ne){if(!ne.libraryPanel)return null;const oe=new m.F({title:ne.title,uid:ne.libraryPanel.uid,name:ne.libraryPanel.name,panelKey:(0,h.XA)(ne.id)});return new o.U({key:`grid-item-${ne.id}`,y:ne.gridPos.y,x:ne.gridPos.x,width:ne.gridPos.w,height:ne.gridPos.h,itemHeight:ne.gridPos.h,body:oe})}function Y(ne){const oe=ne.repeat?{variableName:ne.repeat,repeatDirection:ne.repeatDirection==="h"?"h":"v"}:{},z=[];z.push(new y.$({rawLinks:ne.links,menu:new y.m({$behaviors:[d.oV]})})),z.push(new v.W);const te={key:(0,h.XA)(ne.id),title:ne.title,description:ne.description,pluginId:ne.type,options:ne.options??{},fieldConfig:ne.fieldConfig,pluginVersion:ne.pluginVersion,displayMode:ne.transparent?"transparent":void 0,hoverHeader:!ne.title&&!ne.timeFrom&&!ne.timeShift,hoverHeaderOffset:0,$data:(0,A.w)(ne),titleItems:z,extendPanelContext:S,_UNSAFE_customMigrationHandler:w(ne)};n.$.publicDashboardAccessToken||(te.menu=new i.Lw({$behaviors:[d._i]})),(ne.timeFrom||ne.timeShift)&&(te.$timeRange=new u.v({timeFrom:ne.timeFrom,timeShift:ne.timeShift,hideTimeOverride:ne.hideTimeOverride}));const le=new i.Eb(te);return new o.U({key:`grid-item-${ne.id}`,x:ne.gridPos.x,y:ne.gridPos.y,width:oe.repeatDirection==="h"?24:ne.gridPos.w,height:ne.gridPos.h,itemHeight:ne.gridPos.h,body:le,maxPerRow:ne.maxPerRow,...oe})}function Z(ne){ne.subscribeToEvent(i.Kw,oe=>{const{interaction:z}=oe.payload;switch(z){case"panel-status-message-clicked":U.c.panelStatusMessageClicked();break;case"panel-cancel-query-clicked":U.c.panelCancelQueryClicked();break;case"panel-menu-shown":U.c.panelMenuShown();break}})}const se=ne=>ne.map(oe=>({data:{values:oe.fields.map(z=>z.values).filter(z=>z!==void 0)},schema:{fields:oe.fields.map(z=>({name:z.name,type:z.type,config:z.config}))}})),j=ne=>{ne.snapshotData&&(ne.datasource=N.x,ne.targets=[{refId:ne.snapshotData[0]?.refId??"",datasource:ne.datasource,queryType:"snapshot",snapshot:se(ne.snapshotData)}],ne.snapshotData=[])};function q(ne){(0,h.YQ)(ne).setState({isEmpty:ne.state.children.length===0});const oe=ne.subscribeToState((z,te)=>{(z.children.length!==te.children.length||z.children!==te.children)&&(0,h.YQ)(ne).setState({isEmpty:z.children.length===0})});return()=>{oe.unsubscribe()}}},20455:(G,O,e)=>{"use strict";e.d(O,{Uy:()=>x,Z6:()=>M,ZB:()=>C,c:()=>b});var t=e(2543),n=e.n(t),i=e(92041),s=e(80943),r=e(79422),f=e(73134),a=e(28874),c=e(18803),o=e(79056),h=e(68706),g=e(16279),l=e(41507),p=e(60656),m=e(7928),y=e(79284),d=e(32023),v=e(74730),u=e(70665),D=e(13989),P=e(53287);function x(A,L=!1){const U=A.state,W=U.$timeRange.state,w=U.$data,N=U.$variables,B=U.body;let V=[],K=[];if(B instanceof s.hy){for(const q of B.state.children)if(q instanceof l.U&&(q.state.variableName?V=V.concat(I(q,U,L)):V.push(C(q,U,L))),q instanceof s.tI){if(q.state.key.indexOf("-clone-")>0&&!L)continue;T(q,V,U,L)}}let H=[];w instanceof g.s&&(H=(0,D.O)(w.state.annotationLayers)),N instanceof s.Pj&&(K=(0,P.C)(N));const X=U.controls?.state,k=X?.refreshPicker,Y=R({refresh_intervals:k?.state.intervals,hidden:X?.hideTimeControls,nowDelay:W.UNSAFE_nowDelay},r.lt),Z=U.$behaviors?.find(q=>q instanceof s.Gg.K2)?.state.sync??r.Ye.graphTooltip,se=U.$behaviors?.find(q=>q instanceof s.Gg.en)?.isEnabled||void 0,j={...r.Ye,title:U.title,description:U.description||void 0,uid:U.uid,id:U.id,editable:U.editable,preload:U.preload,time:{from:W.from,to:W.to},timepicker:Y,panels:V,annotations:{list:H},templating:{list:K},version:U.version,timezone:W.timeZone,fiscalYearStartMonth:W.fiscalYearStartMonth,weekStart:W.weekStart,tags:U.tags,links:U.links,graphTooltip:Z,liveNow:se,schemaVersion:o.O2,refresh:k?.state.refresh};return(0,a.v)(j)}function E(A,L){if(!A.state.panel)throw new Error("Library panel has no panel");return{id:(0,v.Cs)(A.state.panel),title:A.state.title,gridPos:L,libraryPanel:{name:A.state.name,uid:A.state.uid}}}function C(A,L,U=!1){let W,w=0,N=0,B=0,V=0;if(A.state.body instanceof p.F)return w=A.state.x??0,N=A.state.y??0,B=A.state.width??0,V=A.state.itemHeight??A.state.height??0,E(A.state.body,{x:w,y:N,w:B,h:V});let K=A;if(L&&L.editPanel?.state.vizManager&&L.editPanel.state.vizManager.state.sourcePanel.resolve()===A.state.body){const X=A.clone();X.state.body instanceof s.Eb&&(L.editPanel.state.vizManager.commitChangesTo(X.state.body),K=X)}if(!(K.state.body instanceof s.Eb))throw new Error("DashboardGridItem body expected to be VizPanel");if(W=K.state.body,w=K.state.x??0,N=K.state.y??0,B=K.state.width??0,V=K.state.itemHeight??K.state.height??0,!W)throw new Error("Unsupported grid item type");return M(W,{x:w,y:N,h:V,w:B},U,K)}function M(A,L,U=!1,W){const w={id:(0,v.Cs)(A),type:A.state.pluginId,title:A.state.title,description:A.state.description??void 0,gridPos:L,fieldConfig:A.state.fieldConfig??{defaults:{},overrides:[]},transformations:[],transparent:A.state.displayMode==="transparent",pluginVersion:A.state.pluginVersion,...S(A,U)};if(A.state.options){const{angularOptions:V,...K}=A.state.options;w.options=K,V&&(0,t.defaults)(w,V)}const N=A.state.$timeRange;N instanceof m.v&&(w.timeFrom=N.state.timeFrom,w.timeShift=N.state.timeShift,w.hideTimeOverride=N.state.hideTimeOverride),W instanceof l.U&&(W.state.variableName&&(w.repeat=W.state.variableName),W.state.maxPerRow&&(w.maxPerRow=W.state.maxPerRow),W.state.repeatDirection&&(w.repeatDirection=W.getRepeatDirection()));const B=d.b4.getPanelLinks(A);return w.links=B?.state.rawLinks??[],w.links.length===0&&delete w.links,w.transformations?.length===0&&delete w.transformations,w.transparent||delete w.transparent,w}function S(A,L=!1){const U=A.state.$data,W={},w=(0,v.un)(A);if(w&&(W.targets=w.state.queries,W.maxDataPoints=w.state.maxDataPoints,W.datasource=w.state.datasource,w.state.cacheTimeout&&(W.cacheTimeout=w.state.cacheTimeout),w.state.queryCachingTTL&&(W.queryCachingTTL=w.state.queryCachingTTL),w.state.minInterval&&(W.interval=w.state.minInterval)),U instanceof s.Es&&(W.transformations=U.state.transformations),U&&L){W.datasource=u.x;let N=(0,c.B6)(U.state.data);U instanceof s.Es&&(N=(0,c.B6)(U.state.$data.state.data)),W.targets=[{refId:"A",datasource:W.datasource,queryType:h.nj.Snapshot,snapshot:N}]}return W}function I(A,L,U=!1){if(U){if(A.state.body instanceof p.F){const{x:W=0,y:w=0,width:N=0,height:B=0}=A.state;return[E(A.state.body,{x:W,y:w,w:N,h:B})]}if(A.state.repeatedPanels){const W=A.state.itemHeight??10,w=Math.ceil(A.state.repeatedPanels.length/A.getMaxPerRow()),N=Math.ceil(A.state.repeatedPanels.length/w),B=24/N,V=W;return A.state.repeatedPanels.map((H,X)=>{let k=0,Y=0;A.state.repeatDirection==="v"?(k=A.state.x,Y=X*V):(k=X%N*B,Y=A.state.y+Math.floor(X/N)*V);const Z={x:k,y:Y,w:B,h:V},se=H.state.$variables.getByName(A.state.variableName);return{id:(0,v.Cs)(H),type:H.state.pluginId,title:H.state.title,gridPos:Z,options:H.state.options,fieldConfig:H.state.fieldConfig??{defaults:{},overrides:[]},transformations:[],transparent:H.state.displayMode==="transparent",scopedVars:{[A.state.variableName]:{text:se?.state.text,value:se?.state.value}},...S(H,U)}})}return[]}else return[C(A,L)]}function T(A,L,U,W=!1){const w=!!A.state.isCollapsed,N={type:"row",id:(0,v.Cs)(A),title:A.state.title,gridPos:{x:A.state.x??0,y:A.state.y??0,w:A.state.width??24,h:A.state.height??1},collapsed:w,panels:[]};if(A.state.$behaviors?.length){const V=A.state.$behaviors[0];V instanceof y.L&&(N.repeat=V.state.variableName)}if(W&&A.state.$variables){const K=A.state.$variables.state.variables.reduce((H,X)=>({...H,[X.state.name]:{text:X.state.text,value:X.state.value}}),{});N.scopedVars=K}L.push(N);let B=[];W?A.state.children.forEach(V=>{V instanceof l.U&&(V.state.variableName?B=B.concat(I(V,U,!w)):B.push(C(V,U,!w)))}):B=A.state.children.map(V=>{if(!(V instanceof l.U))throw new Error("Row child expected to be DashboardGridItem");return C(V,U)}),A.state.isCollapsed?N.panels=B:L.push(...B)}function b(A,L,U,W){let w={...U,title:A,time:{from:L.from.toISOString(),to:L.to.toISOString()},links:[]};if(W){const N=U.panels?.find(B=>B.id===(0,v.Cs)(W));N&&(N.gridPos={w:24,x:0,y:0,h:20},w={...w,panels:[N]})}if(w.panels?.forEach(N=>{"links"in N&&(N.links=[])}),w.annotations){const B=(w.annotations.list?.filter(V=>V.enable)||[]).map(V=>({name:V.name,enable:V.enable,iconColor:V.iconColor,type:V.type,builtIn:V.builtIn,hide:V.hide,snapshotData:[]}));w.annotations.list=B}return w.templating&&w.templating.list?.forEach(N=>{"query"in N&&(N.query=""),"options"in N&&(N.options=N.current&&!(0,i.R)(N.current)?[N.current]:[]),"refresh"in N&&(N.refresh=f.CO.never)}),w}function R(A,L){const U={...A};for(const W in L)(0,t.isEqual)(U[W],L[W])&&delete U[W];return U}},46502:(G,O,e)=>{"use strict";e.d(O,{F:()=>s});var t=e(74848),n=e(96540),i=e(7376);class s extends n.PureComponent{constructor(){super(...arguments),this.ref=null}componentWillUnmount(){this.angularComponent&&this.angularComponent.destroy()}componentDidMount(){this.ref&&this.loadAngular()}componentDidUpdate(f){f.datasource!==this.props.datasource&&this.loadAngular(),this.scopeProps&&this.scopeProps.ctrl.currentAnnotation!==this.props.annotation&&(this.scopeProps.ctrl.ignoreNextWatcherFiring=!0,this.scopeProps.ctrl.currentAnnotation=this.props.annotation,this.angularComponent?.digest())}loadAngular(){this.angularComponent&&(this.angularComponent.destroy(),this.scopeProps=void 0);const f=(0,i.E)(),a='<plugin-component type="annotations-query-ctrl"> </plugin-component>',c={ctrl:{currentDatasource:this.props.datasource,currentAnnotation:this.props.annotation,ignoreNextWatcherFiring:!1}};this.angularComponent=f.load(this.ref,c,a),this.angularComponent.digest(),this.angularComponent.getScope().$watch(()=>{if(c.ctrl.ignoreNextWatcherFiring){c.ctrl.ignoreNextWatcherFiring=!1;return}this.props.onChange(c.ctrl.currentAnnotation)}),this.scopeProps=c}render(){return(0,t.jsx)("div",{ref:f=>this.ref=f})}}},65857:(G,O,e)=>{"use strict";e.d(O,{d:()=>l});var t=e(74848),n=e(88575),i=e(10354),s=e(90182),r=e(79924),f=e(57418),a=e(10880),c=e(55852),o=e(4588);const h=[{value:"dashboards",label:"Dashboards"},{value:"link",label:"Link"}],g=Object.keys(o.G).map(p=>({label:p,value:p}));function l({link:p,onUpdate:m,onGoBack:y}){const d=x=>{m({...p,tags:x})},v=x=>{const E={...p,type:x.value};E.type==="dashboards"?(E.url="",E.tooltip=""):E.tags=[],m(E)},u=x=>{m({...p,icon:x.value})},D=x=>{const E=x.currentTarget;m({...p,[E.name]:E.type==="checkbox"?E.checked:E.value})},P=p.title===o.q.title;return(0,t.jsxs)("div",{style:{maxWidth:"600px"},children:[(0,t.jsx)(n.D,{label:"Title",children:(0,t.jsx)(i.p,{name:"title",id:"title",value:p.title,onChange:D,autoFocus:P})}),(0,t.jsx)(n.D,{label:"Type",children:(0,t.jsx)(s.l6,{inputId:"link-type-input",value:p.type,options:h,onChange:v})}),p.type==="dashboards"&&(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.D,{label:"With tags",children:(0,t.jsx)(r.u,{tags:p.tags,onChange:d})})}),p.type==="link"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.D,{label:"URL",children:(0,t.jsx)(i.p,{name:"url",value:p.url,onChange:D})}),(0,t.jsx)(n.D,{label:"Tooltip",children:(0,t.jsx)(i.p,{name:"tooltip",value:p.tooltip,onChange:D,placeholder:"Open dashboard"})}),(0,t.jsx)(n.D,{label:"Icon",children:(0,t.jsx)(s.l6,{value:p.icon,options:g,onChange:u})})]}),(0,t.jsxs)(f.M,{label:"Options",isOpen:!0,children:[p.type==="dashboards"&&(0,t.jsx)(n.D,{children:(0,t.jsx)(a.S,{label:"Show as dropdown",name:"asDropdown",value:p.asDropdown,onChange:D})}),(0,t.jsx)(n.D,{children:(0,t.jsx)(a.S,{label:"Include current time range",name:"keepTime",value:p.keepTime,onChange:D})}),(0,t.jsx)(n.D,{children:(0,t.jsx)(a.S,{label:"Include current template variable values",name:"includeVars",value:p.includeVars,onChange:D})}),(0,t.jsx)(n.D,{children:(0,t.jsx)(a.S,{label:"Open link in new tab",name:"targetBlank",value:p.targetBlank,onChange:D})})]}),(0,t.jsx)(c.$n,{variant:"secondary",onClick:y,children:"Back to list"})]})}},6199:(G,O,e)=>{"use strict";e.d(O,{X:()=>p});var t=e(74848),n=e(32196),i=e(40845),s=e(67061),r=e(69529),f=e(55852),a=e(72109),c=e(14578),o=e(64149),h=e(29158),g=e(91605),l=e(8484);function p({links:y,onNew:d,onOrderChange:v,onEdit:u,onDuplicate:D,onDelete:P}){const x=(0,i.of)(m);return y.length===0?(0,t.jsx)(s.B,{direction:"column",children:(0,t.jsx)(r.p,{variant:"call-to-action",button:(0,t.jsx)(f.$n,{onClick:d,size:"lg",children:(0,t.jsx)(l.x6,{i18nKey:"dashboard-links.empty-state.button-title",children:"Add dashboard link"})}),message:(0,l.t)("dashboard-links.empty-state.title","There are no dashboard links added yet"),children:(0,t.jsxs)(l.x6,{i18nKey:"dashboard-links.empty-state.info-box-content",children:["Dashboard links allow you to place links to other dashboards and web sites directly below the dashboard header."," ",(0,t.jsx)(a.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/manage-dashboard-links/",children:"Learn more"})]})})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("table",{role:"grid",className:"filter-table filter-table--hover",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Type"}),(0,t.jsx)("th",{children:"Info"}),(0,t.jsx)("th",{colSpan:3})]})}),(0,t.jsx)("tbody",{children:y.map((C,M)=>(0,t.jsxs)("tr",{children:[(0,t.jsxs)("td",{role:"gridcell",className:"pointer",onClick:()=>u(M),children:[(0,t.jsx)(c.I,{name:"external-link-alt"})," \xA0 ",C.type]}),(0,t.jsx)("td",{role:"gridcell",className:"pointer",onClick:()=>u(M),children:(0,t.jsxs)(s.B,{children:[C.title&&(0,t.jsx)("span",{className:x.titleWrapper,children:C.title}),C.type==="link"&&(0,t.jsx)("span",{className:x.urlWrapper,children:C.url}),C.type==="dashboards"&&(0,t.jsx)(o.L,{tags:C.tags??[]})]})}),(0,t.jsx)("td",{style:{width:"1%"},role:"gridcell",children:M!==0&&(0,t.jsx)(h.K,{name:"arrow-up",onClick:()=>v(M,-1),tooltip:"Move link up"})}),(0,t.jsx)("td",{style:{width:"1%"},role:"gridcell",children:y.length>1&&M!==y.length-1?(0,t.jsx)(h.K,{name:"arrow-down",onClick:()=>v(M,1),tooltip:"Move link down"}):null}),(0,t.jsx)("td",{style:{width:"1%"},role:"gridcell",children:(0,t.jsx)(h.K,{name:"copy",onClick:()=>D(C),tooltip:"Copy link"})}),(0,t.jsx)("td",{style:{width:"1%"},role:"gridcell",children:(0,t.jsx)(g.e,{"aria-label":`Delete link with title "${C.title}"`,size:"sm",onConfirm:()=>P(M)})})]},`${C.title}-${M}`))})]}),(0,t.jsx)(f.$n,{className:x.newLinkButton,icon:"plus",onClick:d,children:"New link"})]})}const m=y=>({titleWrapper:(0,n.css)({width:"20vw",textOverflow:"ellipsis",overflow:"hidden"}),urlWrapper:(0,n.css)({width:"40vw",textOverflow:"ellipsis",overflow:"hidden"}),newLinkButton:(0,n.css)({marginTop:y.spacing(3)})})},4588:(G,O,e)=>{"use strict";e.d(O,{G:()=>n,q:()=>t});const t={icon:"external link",title:"New link",tooltip:"",type:"dashboards",url:"",asDropdown:!1,tags:[],targetBlank:!1,keepTime:!1,includeVars:!1},n={"external link":"external-link-alt",dashboard:"apps",question:"question-circle",info:"info-circle",bolt:"bolt",doc:"file-alt",cloud:"cloud"}},27803:(G,O,e)=>{"use strict";e.d(O,{Q:()=>g});var t=e(74848),n=e(96540),i=e(72436),s=e(13544),r=e(88575),f=e(42418),a=e(15292),c=e(32372),o=e(51612),h=e(58975);function g({datasource:l,infoText:p,onDataSourceChange:m,onDefaultKeysChange:y,defaultKeys:d}){const v=(0,n.useCallback)(u=>{const D=(0,i.Jh)(`key,value
`+u)[0],P=[];for(let x=0;x<D.length;x++)P.push({text:D.fields[0].values[x],value:D.fields[1].values[x]});y?.(P)},[y]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.Y,{children:"Ad-hoc options"}),(0,t.jsx)(r.D,{label:"Data source",htmlFor:"data-source-picker",children:(0,t.jsx)(o.s,{current:l,onChange:m,width:30,variables:!0,noDefault:!0})}),p?(0,t.jsx)(f.F,{title:p,severity:"info","data-testid":s.Tp.pages.Dashboard.Settings.Variables.Edit.AdHocFiltersVariable.infoText}):null,y&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.D,{label:"Use static key dimensions",description:"Provide dimensions as CSV: dimensionName, dimensionId",children:(0,t.jsx)(a.d,{"data-testid":s.Tp.pages.Dashboard.Settings.Variables.Edit.AdHocFiltersVariable.modeToggle,value:d!==void 0,onChange:u=>{y(d===void 0?[]:void 0)}})}),d!==void 0&&(0,t.jsx)(c.B,{height:300,language:"csv",value:d.map(u=>`${u.text},${u.value}`).join(`
`),onBlur:v,onSave:v,showMiniMap:!1,showLineNumbers:!0})]})]})}},95802:(G,O,e)=>{"use strict";e.d(O,{d:()=>r});var t=e(74848),n=e(13544),i=e(58975),s=e(14329);function r({onChange:f,constantValue:a}){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.Y,{children:"Constant options"}),(0,t.jsx)(s._,{defaultValue:a,name:"Value",placeholder:"your metric prefix",onBlur:f,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.ConstantVariable.constantOptionsQueryInputV2,width:30})]})}},58711:(G,O,e)=>{"use strict";e.d(O,{w:()=>f});var t=e(74848),n=e(13544),i=e(58975),s=e(85140),r=e(94618);function f({query:a,multi:c,allValue:o,includeAll:h,onQueryChange:g,onMultiChange:l,onIncludeAllChange:p,onAllValueChange:m}){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.Y,{children:"Custom options"}),(0,t.jsx)(s.Z,{name:"Values separated by comma",defaultValue:a,placeholder:"1, 10, mykey : myvalue, myvalue, escaped\\,value",onBlur:g,required:!0,width:52,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.CustomVariable.customValueInput}),(0,t.jsx)(i.Y,{children:"Selection options"}),(0,t.jsx)(r.B,{multi:c,includeAll:h,allValue:o,onMultiChange:l,onIncludeAllChange:p,onAllValueChange:m})]})}},98917:(G,O,e)=>{"use strict";e.d(O,{y:()=>a});var t=e(74848),n=e(13544),i=e(94618),s=e(58975),r=e(89458),f=e(14329);function a({query:c,regex:o,optionTypes:h,onChange:g,onRegExBlur:l,multi:p,includeAll:m,allValue:y,onMultiChange:d,onIncludeAllChange:v,onAllValueChange:u}){const D=h.find(P=>P.value===c)??h[0];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.Y,{children:"Data source options"}),(0,t.jsx)(r.v,{name:"Type",value:D,options:h,onChange:g,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.DatasourceVariable.datasourceSelect}),(0,t.jsx)(f._,{defaultValue:o,name:"Instance name filter",placeholder:"/.*-(.*)-.*/",onBlur:l,description:(0,t.jsxs)("div",{children:["Regex filter for which data source instances to choose from in the variable value list. Leave empty for all.",(0,t.jsx)("br",{}),(0,t.jsx)("br",{}),"Example: ",(0,t.jsx)("code",{children:"/^prod/"})]})}),(0,t.jsx)(s.Y,{children:"Selection options"}),(0,t.jsx)(i.B,{multi:p,includeAll:m,allValue:y,onMultiChange:d,onIncludeAllChange:v,onAllValueChange:u})]})}},49317:(G,O,e)=>{"use strict";e.d(O,{s:()=>o});var t=e(74848),n=e(32196),i=e(13544),s=e(40845),r=e(99615),f=e(58975),a=e(89458),c=e(14329);function o({intervals:g,onIntervalsChange:l,onAutoEnabledChange:p,onAutoMinIntervalChanged:m,onAutoCountChanged:y,autoEnabled:d,autoMinInterval:v,autoStepCount:u}){const D=[1,2,3,4,5,10,20,30,40,50,100,200,300,400,500].map(E=>({label:`${E}`,value:E})),P=(0,s.of)(h),x=D.find(E=>E.value===u)??D[0];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.Y,{children:"Interval options"}),(0,t.jsx)(c._,{defaultValue:g,name:"Values",placeholder:"1m,10m,1h,6h,1d,7d",onBlur:l,testId:i.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.intervalsValueInput,width:32,required:!0}),(0,t.jsx)(r.c,{value:d,name:"Auto option",description:"Dynamically calculates interval by dividing time range by the count specified",onChange:p,testId:i.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.autoEnabledCheckbox}),d&&(0,t.jsxs)("div",{className:P.autoFields,children:[(0,t.jsx)(a.v,{name:"Step count",description:"How many times the current time range should be divided to calculate the value",value:x,options:D,onChange:y,width:9,testId:i.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.stepCountIntervalSelect}),(0,t.jsx)(c._,{value:v,name:"Min interval",description:"The calculated value will not go below this threshold",placeholder:"10s",onChange:m,width:11,testId:i.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.minIntervalInput})]})]})}const h=g=>({autoFields:(0,n.css)({marginTop:g.spacing(2),display:"flex",flexDirection:"column"})})},44890:(G,O,e)=>{"use strict";e.d(O,{u:()=>T});var t=e(74848),n=e(16817),i=e(13544),s=e(19347),r=e(88575),f=e(39070),a=e(72574),c=e(90613),o=e(94753),h=e(24240);function g({query:b,datasource:R,VariableQueryEditor:A,onLegacyQueryChange:L,onQueryChange:U,timeRange:W}){let w;return typeof b=="string"?w=b||(R.variables?.getDefaultQuery?.()??""):w={...R.variables?.getDefaultQuery?.(),...b},A&&(0,h.VN)(A,R)?(0,t.jsxs)(c.a,{marginBottom:2,children:[(0,t.jsx)(o.E,{element:"h4",children:"Query"}),(0,t.jsx)(c.a,{marginTop:1,children:(0,t.jsx)(A,{datasource:R,query:w,templateSrv:(0,a.w)(),onChange:L},R.uid)})]}):A&&(0,h.CH)(A,R)?(0,t.jsxs)(c.a,{marginBottom:2,children:[(0,t.jsx)(o.E,{element:"h4",children:"Query"}),(0,t.jsx)(c.a,{marginTop:1,children:(0,t.jsx)(A,{datasource:R,query:w,onChange:U,onRunQuery:()=>{},data:{series:[],state:f.Gu.Done,timeRange:W},range:W,onBlur:()=>{},history:[]},R.uid)})]}):null}var l=e(94618),p=e(51612),m=e(70766),y=e(96540),d=e(12470),v=e(40845),u=e(94354),D=e(60619);const P=[{label:"On dashboard load",value:d.CO.onDashboardLoad},{label:"On time range change",value:d.CO.onTimeRangeChanged}];function x({onChange:b,refresh:R,testId:A}){const L=(0,v.$j)(),[U,W]=(0,y.useState)(!1);(0,D.Y)({breakpoint:L.breakpoints.values.sm,onChange:N=>{W(!N.matches)}});const w=(0,y.useMemo)(()=>P.find(N=>N.value===R)?.value??P[0].value,[R]);return(0,t.jsx)(r.D,{label:"Refresh",description:"When to update the values of this variable","data-testid":A,children:(0,t.jsx)(u.z,{options:P,onChange:b,value:w,size:U?"sm":"md"})})}var E=e(89458);const C=[{label:"Disabled",value:d.ZG.disabled},{label:"Alphabetical (asc)",value:d.ZG.alphabeticalAsc},{label:"Alphabetical (desc)",value:d.ZG.alphabeticalDesc},{label:"Numerical (asc)",value:d.ZG.numericalAsc},{label:"Numerical (desc)",value:d.ZG.numericalDesc},{label:"Alphabetical (case-insensitive, asc)",value:d.ZG.alphabeticalCaseInsensitiveAsc},{label:"Alphabetical (case-insensitive, desc)",value:d.ZG.alphabeticalCaseInsensitiveDesc},{label:"Natural (asc)",value:d.ZG.naturalAsc},{label:"Natural (desc)",value:d.ZG.naturalDesc}];function M({onChange:b,sort:R,testId:A}){const L=(0,y.useMemo)(()=>C.find(U=>U.value===R)??C[0],[R]);return(0,t.jsx)(E.v,{name:"Sort",description:"How to sort the values of this variable",value:L,options:C,onChange:b,testId:A,width:25})}var S=e(58975),I=e(85140);function T({datasource:b,onDataSourceChange:R,query:A,onQueryChange:L,onLegacyQueryChange:U,timeRange:W,regex:w,onRegExChange:N,sort:B,onSortChange:V,refresh:K,onRefreshChange:H,isMulti:X,onMultiChange:k,includeAll:Y,onIncludeAllChange:Z,allValue:se,onAllValueChange:j}){const{value:q}=(0,n.A)(async()=>{const z=await(0,s.l)().get(b??""),te=await(0,m.y)(z);return{datasource:z,VariableQueryEditor:te}},[b]),{datasource:ne,VariableQueryEditor:oe}=q??{};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(S.Y,{children:"Query options"}),(0,t.jsx)(r.D,{label:"Data source",htmlFor:"data-source-picker",children:(0,t.jsx)(p.s,{current:b,onChange:R,variables:!0,width:30})}),ne&&oe&&(0,t.jsx)(g,{onQueryChange:L,onLegacyQueryChange:U,datasource:ne,query:A,VariableQueryEditor:oe,timeRange:W}),(0,t.jsx)(I.Z,{defaultValue:w??"",name:"Regex",description:(0,t.jsxs)("div",{children:["Optional, if you want to extract part of a series name or metric node segment.",(0,t.jsx)("br",{}),"Named capture groups can be used to separate the display text and value (",(0,t.jsx)("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/variables/filter-variables-with-regex#filter-and-modify-using-named-text-and-value-capture-groups",target:"__blank",children:"see examples"}),")."]}),placeholder:"/.*-(?<text>.*)-(?<value>.*)-.*/",onBlur:N,testId:i.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsRegExInputV2,width:52}),(0,t.jsx)(M,{testId:i.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsSortSelectV2,onChange:V,sort:B}),(0,t.jsx)(x,{testId:i.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsRefreshSelectV2,onChange:H,refresh:K}),(0,t.jsx)(S.Y,{children:"Selection options"}),(0,t.jsx)(l.B,{multi:!!X,includeAll:!!Y,allValue:se,onMultiChange:k,onIncludeAllChange:Z,onAllValueChange:j})]})}},94618:(G,O,e)=>{"use strict";e.d(O,{B:()=>f});var t=e(74848),n=e(13544),i=e(67061),s=e(99615),r=e(14329);function f({multi:a,includeAll:c,allValue:o,onMultiChange:h,onIncludeAllChange:g,onAllValueChange:l}){return(0,t.jsxs)(i.B,{direction:"column",gap:2,height:"inherit",alignItems:"start",children:[(0,t.jsx)(s.c,{value:a,name:"Multi-value",description:"Enables multiple values to be selected at the same time",onChange:h,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsMultiSwitch}),(0,t.jsx)(s.c,{value:c,name:"Include All option",description:"Enables an option to include all variables",onChange:g,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsIncludeAllSwitch}),c&&(0,t.jsx)(r._,{defaultValue:o??"",onBlur:l,name:"Custom all value",placeholder:"blank = auto",testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsCustomAllInput})]})}},99615:(G,O,e)=>{"use strict";e.d(O,{c:()=>s});var t=e(74848),n=e(92145),i=e(10880);function s({value:r,name:f,description:a,onChange:c,ariaLabel:o,testId:h}){const g=(0,n.Bi)();return(0,t.jsx)(i.S,{id:g,label:f,description:a,value:r,onChange:c,"aria-label":o,"data-testid":h})}},8964:(G,O,e)=>{"use strict";e.d(O,{D:()=>a});var t=e(74848),n=e(96540),i=e(12470),s=e(88575),r=e(94354);const f=[{label:"Label and value",value:i.zL.dontHide},{label:"Value",value:i.zL.hideLabel},{label:"Nothing",value:i.zL.hideVariable}];function a({onChange:c,hide:o,type:h}){const g=(0,n.useMemo)(()=>f.find(l=>l.value===o)?.value??f[0].value,[o]);return h==="constant"?null:(0,t.jsx)(s.D,{label:"Show on dashboard",children:(0,t.jsx)(r.z,{options:f,onChange:c,value:g})})}},58975:(G,O,e)=>{"use strict";e.d(O,{Y:()=>r});var t=e(74848),n=e(32196),i=e(40845),s=e(17408);function r({className:a,...c}){const o=(0,i.of)(f);return(0,t.jsx)(s.s,{...c,className:(0,n.cx)(o.legend,a)})}function f(a){return{legend:(0,n.css)({marginTop:a.spacing(3),marginBottom:a.spacing(1)})}}},89458:(G,O,e)=>{"use strict";e.d(O,{v:()=>a});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(88575),f=e(90182);function a({name:o,description:h,value:g,options:l,onChange:p,testId:m,width:y}){const d=(0,s.of)(c),v=(0,i.useId)(),u=`variable-select-input-${o}-${v}`;return(0,t.jsx)(r.D,{label:o,description:h,htmlFor:u,children:(0,t.jsx)(f.l6,{"data-testid":m,inputId:u,onChange:p,value:g,width:y??30,options:l,className:d.selectContainer})})}function c(o){return{selectContainer:(0,n.css)({marginRight:o.spacing(.5)})}}},85140:(G,O,e)=>{"use strict";e.d(O,{$:()=>c,Z:()=>a});var t=e(74848),n=e(32196),i=e(92145),s=e(40845),r=e(88575),f=e(21744);function a({value:o,defaultValue:h,name:g,description:l,placeholder:p,onChange:m,onBlur:y,ariaLabel:d,required:v,width:u,testId:D}){const P=(0,s.of)(c),x=(0,i.Bi)();return(0,t.jsx)(r.D,{label:g,description:l,htmlFor:x,children:(0,t.jsx)(f.f,{id:x,rows:2,value:o,defaultValue:h,onChange:m,onBlur:y,placeholder:p,required:v,"aria-label":d,cols:u,className:P.textarea,"data-testid":D})})}function c(o){return{textarea:(0,n.css)({whiteSpace:"pre-wrap",minHeight:o.spacing(4),height:"auto",overflow:"auto",padding:`${o.spacing(.75)} ${o.spacing(1)}`,width:"inherit",[o.breakpoints.down("sm")]:{width:"100%"}})}}},14329:(G,O,e)=>{"use strict";e.d(O,{_:()=>r});var t=e(74848),n=e(92145),i=e(88575),s=e(10354);function r({value:f,defaultValue:a,name:c,placeholder:o="",onChange:h,testId:g,width:l,required:p,onBlur:m,grow:y,description:d,invalid:v,error:u,maxLength:D}){const P=(0,n.Bi)(c);return(0,t.jsx)(i.D,{label:c,description:d,invalid:v,error:u,htmlFor:P,children:(0,t.jsx)(s.p,{type:"text",id:P,placeholder:o,value:f,defaultValue:a,onChange:h,onBlur:m,width:y?void 0:l??30,"data-testid":g,maxLength:D,required:p})})}},41820:(G,O,e)=>{"use strict";e.d(O,{j:()=>o});var t=e(74848),n=e(32196),i=e(96540),s=e(13544),r=e(40845),f=e(39268),a=e(76892),c=e(55852);const o=({options:g})=>{const[l,p]=(0,i.useState)(20),[m,y]=(0,i.useState)([]),d=(0,i.useCallback)(u=>{u.preventDefault(),p(l+20)},[l,p]),v=(0,r.of)(h);return(0,i.useEffect)(()=>y(g.slice(0,l)),[l,g]),m.length?(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",marginTop:"16px"},children:[(0,t.jsx)("h5",{children:"Preview of values"}),(0,t.jsx)(f.C,{children:m.map((u,D)=>(0,t.jsx)(f.C,{className:v.optionContainer,children:(0,t.jsx)(a.c,{"data-testid":s.Tp.pages.Dashboard.Settings.Variables.Edit.General.previewOfValuesOption,children:(0,t.jsx)("div",{className:v.label,children:u.label})})},`${u.value}-${D}`))}),g.length>l&&(0,t.jsx)(f.C,{className:v.optionContainer,children:(0,t.jsx)(c.$n,{onClick:d,variant:"secondary",size:"sm","aria-label":"Variable editor Preview of Values Show More link",children:"Show more"})})]}):null};o.displayName="VariableValuesPreview";function h(g){return{wrapper:(0,n.css)({display:"flex",flexDirection:"column",marginTop:g.spacing(2)}),optionContainer:(0,n.css)({marginLeft:g.spacing(.5),marginBottom:g.spacing(.5)}),label:(0,n.css)({whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"50vw"})}}},17663:(G,O,e)=>{"use strict";e.d(O,{cH:()=>z,mJ:()=>te,Ao:()=>j,e4:()=>q,kh:()=>Y,CD:()=>X,No:()=>k,B$:()=>H,n_:()=>se,bZ:()=>B,c7:()=>oe});var t=e(2543),n=e(32264),i=e(19347),s=e(80943),r=e(79422),f=e(74730),a=e(74848),c=e(16817),o=e(22391),h=e(27803);function g(le){const{variable:ie}=le,{datasource:ae,defaultKeys:re}=ie.useState(),{value:ce}=(0,c.A)(async()=>await(0,i.l)().get(ae),[ae]),me=ce?.getTagKeys?"Ad hoc filters are applied automatically to all queries that target this data source":"This data source does not support ad hoc filters yet.",ee=De=>{const fe=(0,o.p$)(De);ie.setState({datasource:fe})},de=De=>{ie.setState({defaultKeys:De})};return(0,a.jsx)(h.Q,{datasource:ae??void 0,infoText:me,onDataSourceChange:ee,defaultKeys:re,onDefaultKeysChange:de})}var l=e(95802);function p({variable:le}){const{value:ie}=le.useState(),ae=re=>{le.setState({value:re.currentTarget.value})};return(0,a.jsx)(l.d,{constantValue:String(ie),onChange:ae})}var m=e(58711);function y({variable:le,onRunQuery:ie}){const{query:ae,isMulti:re,allValue:ce,includeAll:me}=le.useState(),ee=Te=>{le.setState({isMulti:Te.currentTarget.checked})},de=Te=>{le.setState({includeAll:Te.currentTarget.checked})},De=Te=>{le.setState({query:Te.currentTarget.value}),ie()},fe=Te=>{le.setState({allValue:Te.currentTarget.value})};return(0,a.jsx)(m.w,{query:ae??"",multi:!!re,allValue:ce??"",includeAll:!!me,onMultiChange:ee,onIncludeAllChange:de,onQueryChange:De,onAllValueChange:fe})}var d=e(98917);function v({variable:le,onRunQuery:ie}){const{pluginId:ae,regex:re,isMulti:ce,allValue:me,includeAll:ee}=le.useState(),de=q(),De=Be=>{le.setState({pluginId:Be.value}),ie()},fe=Be=>{le.setState({regex:Be.currentTarget.value}),ie()},Te=Be=>{le.setState({isMulti:Be.currentTarget.checked})},je=Be=>{le.setState({includeAll:Be.currentTarget.checked})},He=Be=>{le.setState({allValue:Be.currentTarget.value})};return(0,a.jsx)(d.y,{query:ae,regex:re,multi:ce||!1,allValue:me,includeAll:ee||!1,optionTypes:de,onChange:De,onRegExBlur:fe,onMultiChange:Te,onIncludeAllChange:je,onAllValueChange:He})}var u=e(96540),D=e(72436),P=e(13544),x=e(88575),E=e(42418),C=e(15292),M=e(32372),S=e(51612),I=e(58975);function T({datasource:le,defaultOptions:ie,infoText:ae,onDataSourceChange:re,onDefaultOptionsChange:ce}){const me=(0,u.useCallback)(ee=>{const de=(0,D.Jh)(`key,value
`+ee)[0],De=[];for(let fe=0;fe<de.length;fe++)De.push({text:de.fields[0].values[fe],value:de.fields[1].values[fe]});ce(De)},[ce]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(I.Y,{children:"Group by options"}),(0,a.jsx)(x.D,{label:"Data source",htmlFor:"data-source-picker",children:(0,a.jsx)(S.s,{current:le,onChange:re,width:30,variables:!0,noDefault:!0})}),ae?(0,a.jsx)(E.F,{title:ae,severity:"info","data-testid":P.Tp.pages.Dashboard.Settings.Variables.Edit.GroupByVariable.infoText}):null,(0,a.jsx)(x.D,{label:"Use static Group By dimensions",description:"Provide dimensions as CSV: dimensionName, dimensionId",children:(0,a.jsx)(C.d,{"data-testid":P.Tp.pages.Dashboard.Settings.Variables.Edit.GroupByVariable.modeToggle,value:ie!==void 0,onChange:ee=>{ce(ie===void 0?[]:void 0)}})}),ie!==void 0&&(0,a.jsx)(M.B,{height:300,language:"csv",value:ie.map(ee=>`${ee.text},${ee.value}`).join(`
`),onBlur:me,onSave:me,showMiniMap:!1,showLineNumbers:!0})]})}function b(le){const{variable:ie,onRunQuery:ae}=le,{datasource:re,defaultOptions:ce}=ie.useState(),{value:me}=(0,c.A)(async()=>await(0,i.l)().get(re),[ie.state]),ee=me?.getTagKeys?"Group by dimensions are applied automatically to all queries that target this data source":"This data source does not support group by variable yet.",de=async fe=>{const Te=(0,o.p$)(fe);ie.setState({datasource:Te}),ae()},De=async fe=>{ie.setState({defaultOptions:fe}),ae()};return(0,a.jsx)(T,{defaultOptions:ce,datasource:re??void 0,infoText:re?ee:void 0,onDataSourceChange:de,onDefaultOptionsChange:De})}var R=e(49317);function A({variable:le,onRunQuery:ie}){const{intervals:ae,autoStepCount:re,autoEnabled:ce,autoMinInterval:me,value:ee}=le.useState(),de=(0,f.bx)(ae),De=He=>{const Be=(0,f.Sm)(He.currentTarget.value),Ne=Be.includes(ee)?ee:Be[0];le.setState({intervals:Be,value:Ne}),ie()},fe=He=>{le.setState({autoStepCount:He.value})},Te=He=>{le.setState({autoEnabled:He.target.checked})},je=He=>{le.setState({autoMinInterval:He.currentTarget.value})};return(0,a.jsx)(R.s,{intervals:de,autoStepCount:re,autoEnabled:ce,onAutoCountChanged:fe,onIntervalsChange:De,onAutoEnabledChange:Te,onAutoMinIntervalChanged:je,autoMinInterval:me})}var L=e(44890);function U({variable:le,onRunQuery:ie}){const{datasource:ae,regex:re,sort:ce,refresh:me,isMulti:ee,includeAll:de,allValue:De,query:fe}=le.useState(),{value:Te}=s.jh.getTimeRange(le).useState(),je=Xe=>{le.setState({regex:Xe.currentTarget.value})},He=Xe=>{le.setState({sort:Xe.value})},Be=Xe=>{le.setState({refresh:Xe})},Ne=Xe=>{le.setState({isMulti:Xe.currentTarget.checked})},Re=Xe=>{le.setState({includeAll:Xe.currentTarget.checked})},Se=Xe=>{le.setState({allValue:Xe.currentTarget.value})},We=Xe=>{const Je=(0,o.p$)(Xe);if(le.state.datasource&&le.state.datasource.type!==Je.type){le.setState({datasource:Je,query:"",definition:""});return}le.setState({datasource:Je})},Ke=Xe=>{let Je;typeof Xe=="string"?Je=Xe:Xe.hasOwnProperty("query")&&typeof Xe.query=="string"?Je=Xe.query:Je="",le.setState({query:Xe,definition:Je}),ie()};return(0,a.jsx)(L.u,{datasource:ae??void 0,onDataSourceChange:We,query:fe,onQueryChange:Ke,onLegacyQueryChange:Ke,timeRange:Te,regex:re,onRegExChange:je,sort:ce,onSortChange:He,refresh:me,onRefreshChange:Be,isMulti:!!ee,onMultiChange:Ne,includeAll:!!de,onIncludeAllChange:Re,allValue:De??"",onAllValueChange:Se})}var W=e(14329);function w({defaultValue:le,value:ie,onChange:ae,onBlur:re}){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(I.Y,{children:"Text options"}),(0,a.jsx)(W._,{value:ie,defaultValue:le,name:"Default value",placeholder:"default value, if any",onChange:ae,onBlur:re,width:30,testId:P.Tp.pages.Dashboard.Settings.Variables.Edit.TextBoxVariable.textBoxOptionsQueryInputV2})]})}function N({variable:le}){const{value:ie}=le.useState(),ae=re=>{le.setState({value:re.currentTarget.value})};return(0,a.jsx)(w,{defaultValue:ie,onBlur:ae})}function B(le){return le!=="system"}const V={custom:{name:"Custom",description:"Define variable values manually",editor:y},query:{name:"Query",description:"Variable values are fetched from a datasource query",editor:U},constant:{name:"Constant",description:"Define a hidden constant variable, useful for metric prefixes in dashboards you want to share",editor:p},interval:{name:"Interval",description:"Define a timespan interval (ex 1m, 1h, 1d)",editor:A},datasource:{name:"Data source",description:"Enables you to dynamically switch the data source for multiple panels",editor:v},adhoc:{name:"Ad hoc filters",description:"Add key/value filters on the fly",editor:g},groupby:{name:"Group by",description:"Add keys to group by on the fly",editor:b},textbox:{name:"Textbox",description:"Define a textbox variable, where users can enter any arbitrary string",editor:N}},K=["query","custom","textbox","constant","datasource","interval","adhoc","groupby"];function H(){const le=K.map(ie=>({label:V[ie].name,value:ie,description:V[ie].description}));return n.$.featureToggles.groupByVariable?le:le.filter(ie=>ie.value!=="groupby")}function X(le){return V[le].editor}function k(le,ie){switch(le){case"custom":return new s.yP(ie);case"query":return new s.fS(ie);case"constant":return new s.x0({...ie,hide:r.zL.hideVariable});case"interval":return new s.Yj(ie);case"datasource":return new s.mI(ie);case"adhoc":return new s.H9(ie);case"groupby":return new s.ZG(ie);case"textbox":return new s.TS(ie)}}function Y(le){const ae=Z("query",le);return new s.fS({name:ae})}function Z(le,ie){let ae=0,re=`${le}${ae}`;for(;ie.find(ce=>ce.state.name===re);)re=`${le}${++ae}`;return re}function se(le){return"options"in le.state||"intervals"in le.state}function j(le){let ie="";return le instanceof s.fS?ie=le.state.definition||(typeof le.state.query=="string"?le.state.query:""):le instanceof s.mI?ie=String(le.state.pluginId):le instanceof s.yP?ie=le.state.query:le instanceof s.Yj?ie=(0,f.bx)(le.state.intervals):(le instanceof s.TS||le instanceof s.x0)&&(ie=String(le.state.value)),ie}function q(){const le=(0,i.l)().getList({metrics:!0,variables:!0}),ie=(0,t.chain)(le).uniqBy("meta.id").map(ae=>({label:ae.meta.name,value:ae.meta.id})).value();return ie.unshift({label:"",value:""}),ie}function ne(le){return"type"in le.state&&"getValue"in le}function oe(le){return ne(le)?s.Go.isAdHocVariable(le)||s.Go.isConstantVariable(le)||s.Go.isCustomVariable(le)||s.Go.isDataSourceVariable(le)||s.Go.isIntervalVariable(le)||s.Go.isQueryVariable(le)||s.Go.isTextBoxVariable(le)||s.Go.isGroupByVariable(le):!1}const z=/^(?!__).*$/,te=/^\w+$/},19626:(G,O,e)=>{"use strict";e.d(O,{D:()=>l});var t=e(74848),n=e(32196),i=e(2543),s=e(40845),r=e(14578);const f=({diff:m})=>{const y=(0,s.of)(a),d=!(0,i.isUndefined)(m.originalValue)&&!(0,i.isArray)(m.originalValue)&&!(0,i.isObject)(m.originalValue),v=!(0,i.isUndefined)(m.value)&&!(0,i.isArray)(m.value)&&!(0,i.isObject)(m.value);return(0,t.jsxs)(t.Fragment,{children:[d&&(0,t.jsx)("span",{className:y,children:String(m.originalValue)}),d&&v?(0,t.jsx)(r.I,{name:"arrow-right"}):null,v&&(0,t.jsx)("span",{className:y,children:String(m.value)})]})},a=m=>(0,n.css)({backgroundColor:m.colors.action.hover,borderRadius:m.shape.radius.default,color:m.colors.text.primary,fontSize:m.typography.body.fontSize,margin:m.spacing(0,.5),padding:m.spacing(.25,.5)});var c=e(56596);const o={op:"replace",originalValue:void 0,path:[""],value:void 0,startLineNumber:0,endLineNumber:0},h=({diff:m,title:y})=>{const d=(0,s.of)(g);return m?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.I,{type:"mono",name:"circle",className:d[m.op],size:"xs"})," ",(0,t.jsx)("span",{className:d.embolden,children:y})," ",(0,t.jsx)("span",{children:(0,c.Fl)(m,m.path.length>1)})," ",(0,t.jsx)(f,{diff:m})]}):(0,t.jsxs)("div",{className:d.withoutDiff,children:[(0,t.jsx)(r.I,{type:"mono",name:"circle",className:d.replace,size:"xs"})," ",(0,t.jsx)("span",{className:d.embolden,children:y})," ",(0,t.jsx)("span",{children:(0,c.Fl)(o,!1)})]})},g=m=>({embolden:(0,n.css)({fontWeight:m.typography.fontWeightBold}),add:(0,n.css)({color:m.colors.success.main}),replace:(0,n.css)({color:m.colors.success.main}),move:(0,n.css)({color:m.colors.success.main}),copy:(0,n.css)({color:m.colors.success.main}),_get:(0,n.css)({color:m.colors.success.main}),test:(0,n.css)({color:m.colors.success.main}),remove:(0,n.css)({color:m.colors.success.main}),withoutDiff:(0,n.css)({marginBottom:m.spacing(1)})}),l=({diffs:m,title:y})=>{const d=(0,s.of)(p);return m.length===1?(0,t.jsx)("div",{className:d.container,"data-testid":"diffGroup",children:(0,t.jsx)(h,{title:y,diff:m[0]})}):(0,t.jsxs)("div",{className:d.container,"data-testid":"diffGroup",children:[(0,t.jsx)(h,{title:y}),(0,t.jsx)("ul",{className:d.list,children:m.map((v,u)=>(0,t.jsxs)("li",{className:d.listItem,children:[(0,t.jsx)("span",{children:(0,c.Fl)(v)})," ",(0,t.jsx)(f,{diff:v})]},`${(0,i.last)(v.path)}__${u}`))})]})},p=m=>({container:(0,n.css)({}),list:(0,n.css)({marginLeft:m.spacing(4)}),listItem:(0,n.css)({marginBottom:m.spacing(1),"&:last-child":{marginBottom:0}})})},22764:(G,O,e)=>{"use strict";e.d(O,{M:()=>a});var t=e(74848),n=e(32196),i=e(24773),s=e.n(i),r=e(84140),f=e(40845);const a=({oldValue:c,newValue:o,...h})=>{const g=(0,f.$j)(),l={variables:{dark:{diffViewerBackground:g.colors.background.canvas,diffViewerColor:g.colors.text.primary,addedBackground:(0,r.A)(g.v1.palette.greenShade).setAlpha(.3).toString(),addedColor:"white",removedBackground:(0,r.A)(g.v1.palette.redShade).setAlpha(.3).toString(),removedColor:"white",wordAddedBackground:(0,r.A)(g.v1.palette.greenBase).setAlpha(.4).toString(),wordRemovedBackground:(0,r.A)(g.v1.palette.redBase).setAlpha(.4).toString(),addedGutterBackground:(0,r.A)(g.v1.palette.greenShade).setAlpha(.2).toString(),removedGutterBackground:(0,r.A)(g.v1.palette.redShade).setAlpha(.2).toString(),gutterBackground:g.colors.background.primary,gutterBackgroundDark:g.colors.background.primary,highlightBackground:(0,r.A)(g.colors.primary.main).setAlpha(.4).toString(),highlightGutterBackground:(0,r.A)(g.colors.primary.shade).setAlpha(.2).toString(),codeFoldGutterBackground:g.colors.background.secondary,codeFoldBackground:g.colors.background.secondary,emptyLineBackground:g.colors.background.secondary,gutterColor:g.colors.text.disabled,addedGutterColor:g.colors.text.primary,removedGutterColor:g.colors.text.primary,codeFoldContentColor:g.colors.text.disabled,diffViewerTitleBackground:g.colors.background.secondary,diffViewerTitleColor:g.colors.text.disabled,diffViewerTitleBorderColor:g.colors.border.strong}},codeFold:{fontSize:g.typography.bodySmall.fontSize},gutter:{pre:{color:(0,r.A)(g.colors.text.disabled).setAlpha(1).toString(),opacity:.61}}};return(0,t.jsx)("div",{className:(0,n.css)({fontSize:g.typography.bodySmall.fontSize,pre:{all:"revert"}}),children:(0,t.jsx)(s(),{styles:l,oldValue:c,newValue:o,splitView:!1,compareMethod:i.DiffMethod.CSS,useDarkTheme:g.isDark,...h})})}},57714:(G,O,e)=>{"use strict";e.d(O,{Cc:()=>R,me:()=>D,bS:()=>m,rJ:()=>C,wL:()=>i});var t=e(17172);class n{getHistoryList(U,W){return typeof U!="string"?Promise.resolve([]):(0,t.AI)().get(`api/dashboards/uid/${U}/versions`,W)}getDashboardVersion(U,W){return typeof U!="string"?Promise.resolve({}):(0,t.AI)().get(`api/dashboards/uid/${U}/versions/${W}`)}restoreDashboard(U,W){if(typeof U!="string")return Promise.resolve({});const w=`api/dashboards/uid/${U}/restore`;return(0,t.AI)().post(w,{version:W})}}const i=new n;var s=e(74848),r=e(32196),f=e(40845),a=e(10880),c=e(78369),o=e(71678),h=e(55852),g=e(96374),l=e(3169);const p=({hideModal:L,onRestore:U,version:W})=>{const w=(0,l._2)(),N=async()=>{await U(W)?w.success("Dashboard restored",`Restored from version ${W.version}`):w.error("Dashboard restore failed",`Failed to restore from version ${W.version}`),L()};return(0,s.jsx)(g.u,{isOpen:!0,title:"Restore Version",icon:"history",onDismiss:L,onConfirm:N,body:(0,s.jsxs)("p",{children:["Are you sure you want to restore the dashboard to version ",W.version,"? All unsaved changes will be lost."]}),confirmText:`Yes, restore to version ${W.version}`})},m=({versions:L,canCompare:U,onCheck:W,onRestore:w})=>{const N=(0,f.of)(y);return(0,s.jsx)("div",{className:N.margin,children:(0,s.jsxs)("table",{className:"filter-table",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"width-4"}),(0,s.jsx)("th",{className:"width-4",children:"Version"}),(0,s.jsx)("th",{className:"width-14",children:"Date"}),(0,s.jsx)("th",{className:"width-10",children:"Updated by"}),(0,s.jsx)("th",{children:"Notes"}),(0,s.jsx)("th",{})]})}),(0,s.jsx)("tbody",{children:L.map((B,V)=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:(0,s.jsx)(a.S,{"aria-label":`Toggle selection of version ${B.version}`,className:(0,r.css)({display:"inline"}),checked:B.checked,onChange:K=>W(K,B.id),disabled:!B.checked&&U})}),(0,s.jsx)("td",{children:B.version}),(0,s.jsx)("td",{children:B.createdDateString}),(0,s.jsx)("td",{children:B.createdBy}),(0,s.jsx)("td",{children:B.message}),(0,s.jsx)("td",{className:"text-right",children:V===0?(0,s.jsx)(c.v,{name:"Latest",colorIndex:17}):(0,s.jsx)(o.$s,{children:({showModal:K,hideModal:H})=>(0,s.jsx)(h.$n,{variant:"secondary",size:"sm",icon:"history",onClick:()=>{K(p,{version:B,hideModal:H,onRestore:w})},children:"Restore"})})})]},B.id))})]})})};function y(L){return{margin:(0,r.css)({marginBottom:L.spacing(4)})}}var d=e(2543),v=e(29158),u=e(14578);const D=({onClick:L=d.noop,baseVersion:U=0,newVersion:W=0,isNewLatest:w=!1})=>{const N=(0,f.of)(P);return(0,s.jsxs)("h3",{className:N.header,children:[(0,s.jsx)(v.K,{name:"arrow-left",size:"xl",onClick:L,tooltip:"Reset version"}),(0,s.jsxs)("span",{children:["Comparing ",U," ",(0,s.jsx)(u.I,{name:"arrows-h"})," ",W," ",w&&(0,s.jsx)("cite",{className:"muted",children:"(Latest)"})]})]})},P=L=>({header:(0,r.css)({fontSize:L.typography.h3.fontSize,display:"flex",gap:L.spacing(2),marginBottom:L.spacing(2)})});var x=e(67061),E=e(56034);const C=({hasMore:L,canCompare:U,getVersions:W,getDiff:w,isLastPage:N})=>(0,s.jsxs)(x.B,{children:[L&&(0,s.jsx)(h.$n,{type:"button",onClick:()=>W(!0),variant:"secondary",disabled:N,children:"Show more versions"}),(0,s.jsx)(E.m,{content:"Select two versions to start comparing",placement:"bottom",children:(0,s.jsx)(h.$n,{type:"button",disabled:!U,onClick:w,icon:"code-branch",children:"Compare versions"})})]});var M=e(90613),S=e(57418),I=e(19626),T=e(22764),b=e(56596);const R=({baseInfo:L,newInfo:U,diffData:W,isNewLatest:w,onRestore:N})=>{const B=(0,b.G4)(W.lhs,W.rhs),V=(0,f.of)(A);return(0,s.jsxs)(x.B,{direction:"column",gap:1,children:[(0,s.jsxs)(x.B,{justifyContent:"space-between",alignItems:"center",children:[(0,s.jsxs)(x.B,{alignItems:"center",children:[(0,s.jsxs)("span",{className:(0,r.cx)(V.versionInfo,V.noMarginBottom),children:[(0,s.jsxs)("strong",{children:["Version ",L.version]})," updated by ",L.createdBy," ",L.ageString,L.message]}),(0,s.jsx)(u.I,{name:"arrow-right",size:"sm"}),(0,s.jsxs)("span",{className:V.versionInfo,children:[(0,s.jsxs)("strong",{children:["Version ",U.version]})," updated by ",U.createdBy," ",U.ageString,U.message]})]}),w&&(0,s.jsx)(o.$s,{children:({showModal:K,hideModal:H})=>(0,s.jsxs)(h.$n,{variant:"destructive",icon:"history",onClick:()=>{K(p,{version:L,onRestore:N,hideModal:H})},children:["Restore to version ",L.version]})})]}),Object.entries(B).map(([K,H])=>(0,s.jsx)(I.D,{diffs:H,title:K},K)),(0,s.jsx)(M.a,{paddingTop:2,children:(0,s.jsx)(S.M,{isOpen:!1,label:"View JSON Diff",children:(0,s.jsx)(T.M,{oldValue:JSON.stringify(W.lhs,null,2),newValue:JSON.stringify(W.rhs,null,2)})})})]})},A=L=>({versionInfo:(0,r.css)({color:L.colors.text.secondary,fontSize:L.typography.bodySmall.fontSize}),noMarginBottom:(0,r.css)({marginBottom:0})})},56596:(G,O,e)=>{"use strict";e.d(O,{Fl:()=>f,G4:()=>r});var t=e(16111),n=e(25504),i=e(2543),s=e.n(i);const r=(o,h)=>{const g=(0,t.UD)(o,h),l=n.stringify(o,null,2),p=n.stringify(h,null,2),m=v=>v.map(u=>{let D,P,x=0,E=0;const C=(0,i.tail)(u.path.split("/"));return u.op==="replace"&&p.pointers[u.path]&&(D=(0,i.get)(o,C),P=u.value,x=p.pointers[u.path].value.line,E=p.pointers[u.path].valueEnd.line),u.op==="add"&&p.pointers[u.path]&&(P=u.value,x=p.pointers[u.path].value.line,E=p.pointers[u.path].valueEnd.line),u.op==="remove"&&l.pointers[u.path]&&(D=(0,i.get)(o,C),x=l.pointers[u.path].value.line,E=l.pointers[u.path].valueEnd.line),{op:u.op,value:P,path:C,originalValue:D,startLineNumber:x,endLineNumber:E}}),y=v=>(0,i.sortBy)(v,"startLineNumber"),d=v=>v.reduce((u,D)=>{const P=D.path[0];return u[P]||(u[P]=[]),u[P].push(D),u},{});return(0,i.flow)([m,y,d])(g)},f=(o,h=!0)=>{const g=(0,i.last)(o.path),l=a(g),p=o.op==="remove"?o.originalValue:o.value;let m=c(o.op);return h&&(l?m+=` item ${g}`:(0,i.isArray)(p)&&!(0,i.isEmpty)(p)?m+=` ${p.length} ${g}`:m+=` ${g}`),m},a=o=>!(0,i.isNaN)((0,i.toNumber)(o)),c=o=>o==="add"?"added":o==="remove"?"deleted":"changed"},70439:(G,O,e)=>{"use strict";e.d(O,{F7:()=>o,Xe:()=>f,yk:()=>c});var t=e(7030),n=e(22699),i=e(33390),s=e(7758);const r={useAbsoluteTimeRange:!0,useShortUrl:!0,theme:"current"},f=async(h,g)=>{const{useAbsoluteTimeRange:l,useShortUrl:p,theme:m}=c();return s.c.shareLinkCopied({currentTimeRange:l,theme:m,shortenURL:p,shareResource:(0,n.hD)(g?.getRef())}),await(0,t.Sp)(h,{useAbsoluteTimeRange:l,theme:m,useShortUrl:p})},a="grafana.dashboard.link.shareConfiguration";function c(){return i.A.exists(a)&&i.A.getObject(a)||r}function o(h){i.A.setObject(a,h)}},50056:(G,O,e)=>{"use strict";e.d(O,{N:()=>E});var t=e(74848),n=e(4213),i=e.n(n),s=e(16817),r=e(70713),f=e(80943),a=e(67061),c=e(88575),o=e(15292),h=e(37390),g=e(55852),l=e(32372),p=e(10534),m=e(8484),y=e(15858),d=e(22699),v=e(34214),u=e(20455),D=e(73788),P=e(7758),x=e(74730);class E extends f.Bs{constructor(S){super({isSharingExternally:!1,isViewingJSON:!1,...S}),this.tabId=d.wr.export,this._exporter=new y.M,this.onShareExternallyChange=()=>{this.setState({isSharingExternally:!this.state.isSharingExternally})},this.onViewJSON=()=>{this.setState({isViewingJSON:!this.state.isViewingJSON})},this.getExportableDashboardJson=async()=>{const{isSharingExternally:I}=this.state,T=(0,u.Uy)((0,x.YQ)(this));return I?await this._exporter.makeExportable(new v.G(T,void 0,{getVariablesFromState:()=>(0,D.E)(window.__grafanaSceneContext)})):T},this.onSaveAsFile=async()=>{const I=await this.getExportableDashboardJson(),T=JSON.stringify(I,null,2),{isSharingExternally:b}=this.state,R=new Blob([T],{type:"application/json;charset=utf-8"}),A=new Date().getTime();let L="dashboard";"title"in I&&I.title&&(L=I.title),i()(R,`${L}-${A}.json`),P.c.exportDownloadJsonClicked({externally:b})}}static{this.Component=C}getTabLabel(){return(0,m.t)("share-modal.tab-title.export","Export")}getClipboardText(){}}function C({model:M}){const{isSharingExternally:S,isViewingJSON:I,modalRef:T}=M.useState(),b=(0,s.A)(async()=>{if(I){const A=await M.getExportableDashboardJson();return JSON.stringify(A,null,2)}return""},[I]),R=(0,m.t)("share-modal.export.share-externally-label","Export for sharing externally");return(0,t.jsxs)(t.Fragment,{children:[!I&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"share-modal-info-text",children:(0,t.jsx)(m.x6,{i18nKey:"share-modal.export.info-text",children:"Export this dashboard."})}),(0,t.jsx)(a.B,{gap:2,direction:"column",children:(0,t.jsx)(c.D,{label:R,children:(0,t.jsx)(o.d,{id:"share-externally-toggle",value:S,onChange:M.onShareExternallyChange})})}),(0,t.jsxs)(h.a.ButtonRow,{children:[(0,t.jsx)(g.$n,{variant:"secondary",onClick:()=>{T?.resolve().onDismiss()},fill:"outline",children:(0,t.jsx)(m.x6,{i18nKey:"share-modal.export.cancel-button",children:"Cancel"})}),(0,t.jsx)(g.$n,{variant:"secondary",icon:"brackets-curly",onClick:M.onViewJSON,children:(0,t.jsx)(m.x6,{i18nKey:"share-modal.export.view-button",children:"View JSON"})}),(0,t.jsx)(g.$n,{variant:"primary",icon:"save",onClick:()=>M.onSaveAsFile(),children:(0,t.jsx)(m.x6,{i18nKey:"share-modal.export.save-button",children:"Save to file"})})]})]}),I&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.Ay,{disableHeight:!0,children:({width:A})=>b.value?(0,t.jsx)(l.B,{value:b.value??"",language:"json",showMiniMap:!1,height:"500px",width:A}):b.loading?(0,t.jsx)("div",{children:"Loading..."}):null}),(0,t.jsxs)(h.a.ButtonRow,{children:[(0,t.jsx)(g.$n,{variant:"secondary",fill:"outline",onClick:M.onViewJSON,icon:"arrow-left",children:(0,t.jsx)(m.x6,{i18nKey:"share-modal.export.back-button",children:"Back to export config"})}),(0,t.jsx)(p.b,{variant:"secondary",icon:"copy",disabled:b.loading,getText:()=>b.value??"",children:(0,t.jsx)(m.x6,{i18nKey:"share-modal.view-json.copy-button",children:"Copy to Clipboard"})}),(0,t.jsx)(g.$n,{variant:"primary",icon:"save",disabled:b.loading,onClick:()=>M.onSaveAsFile(),children:(0,t.jsx)(m.x6,{i18nKey:"share-modal.export.save-button",children:"Save to file"})})]})]})]})}},58398:(G,O,e)=>{"use strict";e.d(O,{R:()=>x});var t=e(74848),n=e(47232),i=e(13544),s=e(32264),r=e(80943),f=e(84167),a=e(88575),c=e(15292),o=e(10354),h=e(10534),g=e(14578),l=e(42418),p=e(8484),m=e(7030),y=e(87895),d=e(22699),v=e(7758),u=e(11982),D=e(74730),P=e(70439);class x extends r.Bs{constructor(S){super({...S,useLockedTime:S.useLockedTime??!0,useShortUrl:S.useShortUrl??!1,selectedTheme:S.selectedTheme??"current",shareUrl:"",imageUrl:"",isBuildUrlLoading:!1}),this.tabId=d.wr.link,this.onToggleLockedTime=async()=>{const I=!this.state.useLockedTime;(0,P.F7)({useAbsoluteTimeRange:I,useShortUrl:this.state.useShortUrl,theme:this.state.selectedTheme}),this.setState({useLockedTime:I}),await this.buildUrl()},this.onUrlShorten=async()=>{const I=!this.state.useShortUrl;this.setState({useShortUrl:I}),(0,P.F7)({useShortUrl:I,useAbsoluteTimeRange:this.state.useLockedTime,theme:this.state.selectedTheme}),await this.buildUrl()},this.onThemeChange=async I=>{this.setState({selectedTheme:I}),(0,P.F7)({theme:I,useShortUrl:this.state.useShortUrl,useAbsoluteTimeRange:this.state.useLockedTime}),await this.buildUrl()},this.getShareUrl=()=>this.state.shareUrl,this.onCopy=()=>{v.c.shareLinkCopied({currentTimeRange:this.state.useLockedTime,theme:this.state.selectedTheme,shortenURL:this.state.useShortUrl,shareResource:(0,d.hD)(this.state.panelRef)})},this.addActivationHandler(()=>{this.buildUrl()})}static{this.Component=E}async buildUrl(){this.setState({isBuildUrlLoading:!0});const{panelRef:S,useLockedTime:I,useShortUrl:T,selectedTheme:b}=this.state,R=(0,D.YQ)(this),A=S?.resolve(),L={useAbsoluteTimeRange:I,theme:b,useShortUrl:T};let U=(0,m.VN)(R,L,A);T&&(U=await(0,m.fn)(U));const W=r.jh.getTimeRange(A??R),w=(0,m.$l)(L,W,A);let N=w;A&&(delete N.viewPanel,N.panelId=A.state.key,N["__feature.dashboardSceneSolo"]=!0);const B=(0,u.uZ)({uid:R.state.uid,currentQueryParams:location.search,updateQuery:{...w,panelId:A?.state.key},absolute:!0,soloRoute:!0,render:!0,timeZone:C(W.getTimeZone())});this.setState({shareUrl:U,imageUrl:B,isBuildUrlLoading:!1})}getTabLabel(){return(0,p.t)("share-modal.tab-title.link","Link")}}function E({model:M}){const S=M.useState(),{panelRef:I}=S,T=(0,D.YQ)(M),b=I?.resolve(),A=r.jh.getTimeRange(b??T).state.to==="now",{useLockedTime:L,useShortUrl:U,selectedTheme:W,shareUrl:w,imageUrl:N}=S,B=i.Tp.pages.SharePanelModal,V=!!T.state.uid,K=(0,p.t)("share-modal.link.time-range-label","Lock time range"),H=(0,p.t)("share-modal.link.time-range-description","Transforms the current relative time range to an absolute time range"),X=(0,p.t)("share-modal.link.shorten-url","Shorten URL"),k=(0,p.t)("share-modal.link.link-url","Link URL");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"share-modal-info-text",children:(0,t.jsx)(p.x6,{i18nKey:"share-modal.link.info-text",children:"Create a direct link to this dashboard or panel, customized with the options below."})}),(0,t.jsxs)(f.n,{children:[(0,t.jsx)(a.D,{label:K,description:A?H:"",children:(0,t.jsx)(c.d,{id:"share-current-time-range",value:L,onChange:M.onToggleLockedTime})}),(0,t.jsx)(y.w,{selectedTheme:W,onChange:M.onThemeChange}),(0,t.jsx)(a.D,{label:X,children:(0,t.jsx)(c.d,{id:"share-shorten-url",value:U,onChange:M.onUrlShorten})}),(0,t.jsx)(a.D,{label:k,children:(0,t.jsx)(o.p,{id:"link-url-input",value:w,readOnly:!0,addonAfter:(0,t.jsx)(h.b,{icon:"copy",variant:"primary",getText:M.getShareUrl,onClipboardCopy:M.onCopy,children:(0,t.jsx)(p.x6,{i18nKey:"share-modal.link.copy-link-button",children:"Copy"})})})})]}),b&&s.$.rendererAvailable&&(0,t.jsxs)(t.Fragment,{children:[V&&(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsxs)("a",{href:N,target:"_blank",rel:"noreferrer","aria-label":B.linkToRenderedImage,children:[(0,t.jsx)(g.I,{name:"camera"}),"\xA0",(0,t.jsx)(p.x6,{i18nKey:"share-modal.link.rendered-image",children:"Direct link rendered image"})]})}),!V&&(0,t.jsx)(l.F,{severity:"info",title:(0,p.t)("share-modal.link.save-alert","Dashboard is not saved"),bottomSpacing:0,children:(0,t.jsx)(p.x6,{i18nKey:"share-modal.link.save-dashboard",children:"To render a panel image, you must save the dashboard first."})})]}),b&&!s.$.rendererAvailable&&(0,t.jsx)(l.F,{severity:"info",title:(0,p.t)("share-modal.link.render-alert","Image renderer plugin not installed"),bottomSpacing:0,children:(0,t.jsxs)(p.x6,{i18nKey:"share-modal.link.render-instructions",children:["To render a panel image, you must install the"," ",(0,t.jsx)("a",{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",target:"_blank",rel:"noopener noreferrer",className:"external-link",children:"Grafana image renderer plugin"}),". Please contact your Grafana administrator to install the plugin."]})})]})}function C(M){const S="UTC"+encodeURIComponent((0,n.KQ)().format("Z"));if(M==="utc")return"UTC";if(M==="browser"){if(!window.Intl)return S;const T=window.Intl.DateTimeFormat().resolvedOptions();return T.timeZone?T.timeZone:S}return M}},85174:(G,O,e)=>{"use strict";e.d(O,{Z:()=>ne});var t=e(74848),n=e(32264),i=e(80943),s=e(25897),r=e(37390),f=e(40980),a=e(10096),c=e(8484),o=e(72254),h=e(22699),g=e(60656),l=e(7758),p=e(74730),m=e(50056),y=e(86394),d=e(34214),v=e(41507),u=e(20455);class D extends i.Bs{constructor(){super(...arguments),this.tabId=h.wr.libraryPanel}static{this.Component=P}getTabLabel(){return(0,c.t)("share-modal.tab-title.library-panel","Library panel")}}function P({model:z}){const{panelRef:te,modalRef:le}=z.useState();if(!te)return null;const ie=te.resolve(),ae=ie.parent;if(ae instanceof v.U){const re=(0,p.YQ)(z),ce=(0,u.ZB)(ae),me=new d.a(ce),ee=(0,u.Uy)(re),de=new d.G(ee);return(0,t.jsx)(y.j,{initialFolderUid:re.state.meta.folderUid,dashboard:de,panel:me,onDismiss:()=>{le?.resolve().onDismiss()},onCreateLibraryPanel:De=>re.createLibraryPanel(ie,De)})}return null}var x=e(58398),E=e(35280),C=e(7928),M=e(11982);class S extends i.Bs{constructor(te){super(te),this.tabId=h.wr.embed}static{this.Component=I}getTabLabel(){return(0,c.t)("share-modal.tab-title.panel-embed","Embed")}}function I({model:z}){const{panelRef:te}=z.useState(),le=te.resolve(),ie=(0,p.YQ)(z),{uid:ae}=ie.useState(),re=(0,p.Cs)(le),ce=i.jh.getTimeRange(le),me=ce instanceof C.v?ce.state.timeFrom:void 0;return(0,t.jsx)(E.D,{panel:{id:re,timeFrom:me},range:ce.state.value,dashboard:{uid:ae??"",time:ce.state.value},buildIframe:T(ie)})}const T=z=>(te,le,ie,ae,re)=>{const ce=(0,h.XV)({useCurrentTimeRange:te,selectedTheme:ie,panel:ae,range:re}),me=ce.get("editPanel")??ce.get("viewPanel")??"";return ce.set("panelId",me),ce.delete("editPanel"),ce.delete("viewPanel"),ce.set("__feature.dashboardSceneSolo","true"),`<iframe src="${(0,M.uZ)({absolute:!0,soloRoute:!0,uid:z.state.uid,slug:z.state.meta.slug,currentQueryParams:ce.toString()})}" width="450" height="200" frameborder="0"></iframe>`};var b=e(12962),R=e(72686),A=e(4785),L=e(32196),U=e(40845),W=e(59037),w=e(31678),N=e(96374);class B extends i.Bs{static{this.Component=V}constructor(te){super({confirmVariant:"destructive",dismissText:"Cancel",dismissVariant:"secondary",icon:"exclamation-triangle",confirmButtonVariant:"destructive",...te})}onDismiss(){}}function V({model:z}){const te=z.useState();return(0,t.jsx)(N.u,{...te})}var K=e(59995);function H({model:z,publicDashboard:te,isGetLoading:le}){const ie=(0,U.of)(X),ae=a.TP.hasPermission(w.AccessControlAction.DashboardsPublicWrite),re=(0,p.YQ)(z),{isDirty:ce}=re.useState(),[me]=(0,R.bN)(),ee=(re.state.$variables?.state.variables.length??0)>0,de=(0,K.b)(re),fe=i.jh.getTimeRange(z).useState();return(0,t.jsx)(W.b,{dashboard:re,publicDashboard:te,unsupportedDatasources:de,onRevoke:()=>{re.showModal(new B({isOpen:!0,title:"Revoke public URL",icon:"trash-alt",confirmText:"Revoke public URL",body:(0,t.jsx)("p",{className:ie.description,children:"Are you sure you want to revoke this URL? The dashboard will no longer be public."}),onDismiss:()=>{re.showModal(new ne({activeTab:h.wr.publicDashboard}))},onConfirm:()=>{me({dashboard:re,dashboardUid:re.state.uid,uid:te.uid}),re.closeModal()}}))},timeRange:fe.value,showSaveChangesAlert:ae&&ce,hasTemplateVariables:ee})}const X=z=>({description:(0,L.css)({fontSize:z.typography.body.fontSize})});var k=e(22234);function Y({model:z}){const te=(0,p.YQ)(z),le=(0,K.b)(te),ie=(te.state.$variables?.state.variables.length??0)>0;return(0,t.jsx)(k.D,{dashboard:te,unsupportedDatasources:le,unsupportedTemplateVariables:ie})}class Z extends i.Bs{constructor(){super(...arguments),this.tabId=h.wr.publicDashboard}static{this.Component=se}getTabLabel(){return(0,c.t)("share-modal.tab-title.public-dashboard","Public Dashboard")}}function se({model:z}){const{data:te,isLoading:le}=(0,R.Bs)((0,p.YQ)(z).state.uid);return(0,t.jsx)(t.Fragment,{children:le?(0,t.jsx)(A.a,{}):(0,o.lI)(te)?(0,t.jsx)(H,{model:z,publicDashboard:te,isGetLoading:le}):(0,t.jsx)(Y,{model:z})})}const j=[];function q(z){j.push(z)}class ne extends i.Bs{constructor(te){super({activeTab:"link",...te}),this.onDismiss=()=>{(0,p.YQ)(this).closeModal()},this.onChangeTab=le=>{l.c.sharingCategoryClicked({item:le.value,shareResource:(0,h.hD)(this.state.panelRef)}),this.setState({activeTab:le.value})},this.addActivationHandler(()=>this.buildTabs())}static{this.Component=oe}buildTabs(){const{panelRef:te}=this.state,le=this.getRef(),ie=[new x.R({panelRef:te,modalRef:le})],ae=(0,p.YQ)(this);if(te||ie.push(new m.N({modalRef:le})),a.TP.isSignedIn&&n.$.snapshotEnabled&&ae.canEditDashboard()&&ie.push(new b.l({panelRef:te,dashboardRef:ae.getRef(),modalRef:le})),te){ie.push(new S({panelRef:te}));const re=te.resolve(),ce=re.parent instanceof g.F;re instanceof i.Eb&&(ce||ie.push(new D({panelRef:te,modalRef:le})))}te||(ie.push(...j.map(re=>new re({modalRef:le}))),(0,o.iR)()&&ie.push(new Z({modalRef:le}))),this.setState({tabs:ie})}}function oe({model:z}){const{panelRef:te,tabs:le,activeTab:ie}=z.useState(),ae=te?(0,c.t)("share-modal.panel.title","Share Panel"):(0,c.t)("share-modal.dashboard.title","Share");if(!le)return;const re=le?.map(ee=>({label:ee.getTabLabel(),value:ee.tabId})),ce=(0,t.jsx)(s.J,{title:ae,icon:"share-alt",tabs:re,activeTab:ie,onChangeTab:z.onChangeTab}),me=le.find(ee=>ee.tabId===ie);return(0,t.jsx)(r.a,{isOpen:!0,title:ce,onDismiss:z.onDismiss,children:(0,t.jsx)(f.J,{children:me&&(0,t.jsx)(me.Component,{model:me})})})}},12962:(G,O,e)=>{"use strict";e.d(O,{l:()=>M,u:()=>E});var t=e(74848),n=e(5805),i=e(13544),s=e(17172),r=e(80943),f=e(88575),a=e(10354),c=e(94354),o=e(37390),h=e(55852),g=e(67061),l=e(10534),p=e(82467),m=e(3169),y=e(8484),d=e(22699),v=e(69064),u=e(99140),D=e(20455),P=e(7758);const x=i.Tp.pages.ShareDashboardModal.SnapshotScene,E=()=>{const I={label:(0,y.t)("share-modal.snapshot.expire-week","1 Week"),value:604800};return[{label:(0,y.t)("share-modal.snapshot.expire-hour","1 Hour"),value:60*60},{label:(0,y.t)("share-modal.snapshot.expire-day","1 Day"),value:60*60*24},I,{label:(0,y.t)("share-modal.snapshot.expire-never","Never"),value:0}]},C=()=>E()[2];class M extends r.Bs{constructor(T){super({...T,snapshotName:T.dashboardRef.resolve().state.title,selectedExpireOption:C()}),this.tabId=d.wr.snapshot,this.onSnasphotNameChange=b=>{this.setState({snapshotName:b.trim()})},this.onExpireChange=b=>{this.setState({selectedExpireOption:E().find(R=>R.value===b)})},this.onSnapshotCreate=async(b=!1)=>{const{selectedExpireOption:R}=this.state,A=this.prepareSnapshot(),L={dashboard:A,name:A.title,expires:R?.value,external:b};try{const U=await(0,v.s)().create(L);return(0,u.JD)((0,p.dx)((0,m.tZ)((0,y.t)("snapshot.share.success-creation","Your snapshot has been created")))),U}finally{b?P.c.publishSnapshotClicked({expires:L.expires,shareResource:(0,d.hD)(this.state.panelRef)}):P.c.publishSnapshotLocalClicked({expires:L.expires,shareResource:(0,d.hD)(this.state.panelRef)})}},this.onSnapshotDelete=async b=>{const R=await(0,s.AI)().get(b);return(0,u.JD)((0,p.dx)((0,m.tZ)((0,y.t)("snapshot.share.success-delete","Your snapshot has been deleted")))),R},this.addActivationHandler(()=>{this._onActivate()})}static{this.Component=S}_onActivate(){(0,v.s)().getSharingOptions().then(T=>{this.isActive&&this.setState({snapshotSharingOptions:T})})}getTabLabel(){return(0,y.t)("share-modal.tab-title.snapshot","Snapshot")}prepareSnapshot(){const T=r.jh.getTimeRange(this),{dashboardRef:b,panelRef:R}=this.state,A=(0,D.Uy)(b.resolve(),!0);return(0,D.c)(this.state.snapshotName||"",T.state.value,A,R?.resolve())}}function S({model:I}){const{snapshotName:T,selectedExpireOption:b,modalRef:R,snapshotSharingOptions:A}=I.useState(),[L,U]=(0,n.default)(async(N=!1)=>I.onSnapshotCreate(N)),[W,w]=(0,n.default)(async N=>await(0,s.AI)().get(N));return W.value?(0,t.jsx)(y.x6,{i18nKey:"share-modal.snapshot.deleted-message",children:"The snapshot has been deleted. If you have already accessed it once, then it might take up to an hour before before it is removed from browser caches or CDN caches."}):(0,t.jsxs)(t.Fragment,{children:[!L.value&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"share-modal-info-text",children:(0,t.jsx)(y.x6,{i18nKey:"share-modal.snapshot.info-text-1",children:"A snapshot is an instant way to share an interactive dashboard publicly. When created, we strip sensitive data like queries (metric, template, and annotation) and panel links, leaving only the visible metric data and series names embedded in your dashboard."})}),(0,t.jsx)("p",{className:"share-modal-info-text",children:(0,t.jsxs)(y.x6,{i18nKey:"share-modal.snapshot.info-text-2",children:["Keep in mind, your snapshot ",(0,t.jsx)("em",{children:"can be viewed by anyone"})," that has the link and can access the URL. Share wisely."]})})]}),(0,t.jsx)(f.D,{label:(0,y.t)("share-modal.snapshot.name","Snapshot name"),children:(0,t.jsx)(a.p,{id:"snapshot-name-input",width:30,defaultValue:T,onBlur:N=>I.onSnasphotNameChange(N.target.value)})}),(0,t.jsx)(f.D,{label:(0,y.t)("share-modal.snapshot.expire","Expire"),children:(0,t.jsx)(c.z,{id:"expire-select-input",options:E(),value:b?.value,onChange:I.onExpireChange})}),(0,t.jsxs)(o.a.ButtonRow,{children:[(0,t.jsx)(h.$n,{variant:"secondary",onClick:()=>{R?.resolve().onDismiss()},fill:"outline",children:(0,t.jsx)(y.x6,{i18nKey:"share-modal.snapshot.cancel-button",children:"Cancel"})}),A?.externalEnabled&&(0,t.jsx)(h.$n,{variant:"secondary",disabled:L.loading,onClick:()=>U(!0),children:A?.externalSnapshotName}),(0,t.jsx)(h.$n,{variant:"primary",disabled:L.loading,onClick:()=>U(),"data-testid":x.PublishSnapshot,children:(0,t.jsx)(y.x6,{i18nKey:"share-modal.snapshot.local-button",children:"Publish Snapshot"})})]})]}),L.value&&(0,t.jsxs)(g.B,{direction:"column",gap:0,children:[(0,t.jsx)(f.D,{label:(0,y.t)("share-modal.snapshot.url-label","Snapshot URL"),children:(0,t.jsx)(a.p,{"data-testid":x.CopyUrlInput,id:"snapshot-url-input",value:L.value.url,readOnly:!0,addonAfter:(0,t.jsx)(l.b,{"data-testid":x.CopyUrlButton,icon:"copy",variant:"primary",getText:()=>L.value.url,children:(0,t.jsx)(y.x6,{i18nKey:"share-modal.snapshot.copy-link-button",children:"Copy"})})})}),(0,t.jsxs)("div",{style:{alignSelf:"flex-end",padding:"5px"},children:[(0,t.jsx)(y.x6,{i18nKey:"share-modal.snapshot.mistake-message",children:"Did you make a mistake? "}),"\xA0",(0,t.jsx)(h.$n,{fill:"outline",size:"md",variant:"destructive",onClick:()=>{w(L.value.deleteUrl)},children:(0,t.jsx)(y.x6,{i18nKey:"share-modal.snapshot.delete-button",children:"Delete snapshot."})})]})]})]})}},59995:(G,O,e)=>{"use strict";e.d(O,{b:()=>l});var t=e(16817),n=e(26657),i=e(80943),s=e(31204),r=e(31193),f=e(41507),a=e(60656);const c=async p=>{let m=new Set;for(const y of p)s.z.has(y)&&await(0,r.tR)().get(y)instanceof n.iy||m.add(y);return Array.from(m)};function o(p){const m=new Set,y=p.state.body;if(!(y instanceof i.hy))return[];for(const d of y.state.children){if(d instanceof f.U){const v=g(d);for(const u of v)m.add(u)}if(d instanceof i.tI){const v=h(d);for(const u of v)m.add(u)}}return Array.from(m).sort()}function h(p){return new Set(p.state.children.map(y=>g(y)).flat())}function g(p){let m;if(p instanceof f.U)if(p.state.body instanceof a.F)m=p.state.body.state.panel;else if(p.state.body instanceof i.Eb)m=p.state.body;else throw new Error("DashboardGridItem body expected to be VizPanel");if(!m)throw new Error("Unsupported grid item type");const y=m.state.$data,d=new Set;if(y instanceof i.dt)for(const v of y.state.queries)d.add(v.datasource?.type??"");if(y instanceof i.Es){const v=y.state.$data;if(v instanceof i.dt)for(const u of v.state.queries)d.add(u.datasource?.type??"")}return Array.from(d)}function l(p){const{value:m}=(0,t.A)(async()=>{const y=o(p);return c(y)},[]);return m}},53543:(G,O,e)=>{"use strict";e.d(O,{R:()=>i});var t=e(80943),n=e(74730);class i{constructor(r){this._vizPanel=r}get id(){const r=(0,n.Cs)(this._vizPanel);return isNaN(r)?(console.error("VizPanel key could not be translated to a legacy numeric panel id",this._vizPanel),0):r}get description(){return this._vizPanel.state.description}get type(){return this._vizPanel.state.pluginId}get title(){return this._vizPanel.state.title}get transformations(){return this._vizPanel.state.$data instanceof t.Es?this._vizPanel.state.$data.state.transformations:[]}get targets(){const r=(0,n.un)(this._vizPanel);return r?r.state.queries:[]}get datasource(){return(0,n.un)(this._vizPanel)?.state.datasource}get options(){return this._vizPanel.state.options}get fieldConfig(){return this._vizPanel.state.fieldConfig}get pluginVersion(){return this._vizPanel.state.pluginVersion}}},96556:(G,O,e)=>{"use strict";e.d(O,{w:()=>s});var t=e(32264),n=e(80943),i=e(39820);function s(r){if(!r.targets?.length||t.$.panels[r.type]?.skipDataQuery)return;let f;return f=new n.dt({datasource:r.datasource??void 0,queries:r.targets,maxDataPoints:r.maxDataPoints??void 0,maxDataPointsFromWidth:!0,cacheTimeout:r.cacheTimeout,queryCachingTTL:r.queryCachingTTL,minInterval:r.interval??void 0,dataLayerFilter:{panelId:r.id},$behaviors:[new i.L({})]}),new n.Es({$data:f,transformations:r.transformations||[]})}},32023:(G,O,e)=>{"use strict";e.d(O,{WZ:()=>m,b4:()=>y});var t=e(80943),n=e(16279),i=e(41507),s=e(60656),r=e(42397),f=e(74730);function a(d){return d.state.controls?.state.timePicker}function c(d){return d.state.controls?.state.refreshPicker}function o(d){return d.state.titleItems&&Array.isArray(d.state.titleItems)&&d.state.titleItems[0]instanceof r.$?d.state.titleItems[0]:null}function h(d){const v=[];return d.state.body.forEachChild(u=>{if(!(u instanceof i.U)&&!(u instanceof t.tI))throw new Error("Child is not a DashboardGridItem or SceneGridRow, invalid scene");u instanceof i.U?u.state.body instanceof t.Eb&&v.push(u.state.body):u instanceof t.tI&&u.forEachChild(D=>{D instanceof i.U&&D.state.body instanceof t.Eb&&v.push(D.state.body)})}),v}function g(d){const v=t.jh.getData(d);if(!(v instanceof n.s))throw new Error("DashboardDataLayerSet not found");return v}function l(d){const v=d.state.$behaviors?.find(u=>u instanceof t.Gg.K2);if(v instanceof t.Gg.K2)return v}function p(d){let v=0;const u=d.state.body;if(!(u instanceof t.hy))throw new Error("Dashboard body is not a SceneGridLayout");for(const D of u.state.children){if(D instanceof i.U){const P=D.state.body;if(P){const x=P instanceof s.F?(0,f.RQ)(P):(0,f.Cs)(P);x>v&&(v=x)}}if(D instanceof t.tI){const P=(0,f.Cs)(D);P>v&&(v=P);for(const x of D.state.children)if(x instanceof i.U){const E=x.state.body;if(E){const C=E instanceof s.F?(0,f.RQ)(E):(0,f.Cs)(E);C>v&&(v=C)}}}}return v+1}const m=d=>d.parent instanceof s.F?d.parent:d.parent instanceof i.U&&d.parent.state.body instanceof s.F?d.parent.state.body:null,y={getTimePicker:a,getRefreshPicker:c,getPanelLinks:o,getVizPanels:h,getDataLayers:g,getNextPanelId:p,getCursorSync:l}},27734:(G,O,e)=>{"use strict";e.d(O,{Gq:()=>f,zf:()=>a});var t=e(76885),n=e(12131),i=e(32264),s=e(80943);const r="grafana.dashboard.preservedUrlFiltersState";function f(c){const o=window.sessionStorage.getItem(r);if(o){const h=new URLSearchParams(o),g=n.Ny.getSearch();h.forEach((p,m)=>{g.has(m)||g.append(m,p)});for(const p of Array.from(g.keys()))p.startsWith("var-")&&(c.state.$variables?.getByName(p.replace("var-",""))||g.delete(p));const l=g.toString();l&&n.Ny.replace({search:l})}}function a(c){if(i.$.featureToggles.preserveDashboardStateWhenNavigating)return()=>{if(!c.state.uid)return;const o=Object.fromEntries(Object.entries(new s.g5().getUrlState(c)).filter(([g])=>g.startsWith("var-")||g==="from"||g==="to"||g==="timezone")),h=Object.fromEntries(Object.entries(o).filter(([g,l])=>!(Array.isArray(l)&&l.length===0)));Object.keys(h).length>0?window.sessionStorage.setItem(r,t.kM.renderUrl("",h)):window.sessionStorage.removeItem(r)}}},73788:(G,O,e)=>{"use strict";e.d(O,{E:()=>i});var t=e(80943),n=e(53287);function i(s){const r=t.jh.getVariables(s);return(0,n.C)(r)}},7758:(G,O,e)=>{"use strict";e.d(O,{c:()=>i});var t=e(14110);let n=!1;const i={dashboardInitialized:r=>{s("init_dashboard_completed",{...r})},panelMenuShown:r=>{s("panelheader_menu",{...r,item:"menu"})},panelMenuItemClicked:r=>{s("panelheader_menu",{item:r})},panelMenuInspectClicked(r){s("panelheader_menu",{item:"inspect",tab:r})},panelLinkClicked:r=>{s("panelheader_datalink_clicked",r)},panelStatusMessageClicked:r=>{s("panelheader_statusmessage_clicked",r)},panelCancelQueryClicked:r=>{s("panelheader_cancelquery_clicked",r)},sharingCategoryClicked:r=>{s("sharing_category_clicked",r)},shareLinkCopied:r=>{s("sharing_link_copy_clicked",r)},embedSnippetCopy:r=>{s("sharing_embed_copy_clicked",r)},publishSnapshotClicked:r=>{s("sharing_snapshot_publish_clicked",r)},publishSnapshotLocalClicked:r=>{s("sharing_snapshot_local_clicked",r)},exportDownloadJsonClicked:r=>{s("sharing_export_download_json_clicked",r)},exportCopyJsonClicked:r=>{s("sharing_export_copy_json_clicked",r)},exportSaveJsonClicked:r=>{s("sharing_export_save_json_clicked",r)},exportViewJsonClicked:r=>{s("sharing_export_view_json_clicked",r)},generatePublicDashboardUrlClicked:r=>{s("sharing_public_generate_url_clicked",r)},revokePublicDashboardEmailClicked:r=>{s("sharing_public_email_revoke_clicked",r)},resendPublicDashboardEmailClicked:r=>{s("sharing_public_email_resend_clicked",r)},publicDashboardEmailInviteClicked:r=>{s("sharing_public_email_invite_clicked",r)},publicDashboardShareTypeChange:r=>{s("sharing_public_can_view_clicked",r)},publicDashboardTimeSelectionChanged:r=>{s("sharing_public_time_picker_clicked",r)},publicDashboardAnnotationsSelectionChanged:r=>{s("sharing_public_annotations_clicked",r)},publicDashboardUrlCopied:r=>{s("sharing_public_copy_url_clicked",r)},publicDashboardPauseSharingClicked:r=>{s("sharing_public_pause_clicked",r)},revokePublicDashboardClicked:r=>{s("sharing_public_revoke_clicked",r)},emptyDashboardButtonClicked:r=>{s("emptydashboard_clicked",r)},toolbarAddButtonClicked:r=>{s("toolbar_add_clicked",r)},toolbarFavoritesClick:()=>{s("toolbar_actions_clicked",{item:"favorites"})},toolbarSettingsClick:()=>{s("toolbar_actions_clicked",{item:"settings"})},toolbarRefreshClick:()=>{s("toolbar_actions_clicked",{item:"refresh"})},toolbarTimePickerClick:()=>{s("toolbar_actions_clicked",{item:"time_picker"})},toolbarZoomClick:()=>{s("toolbar_actions_clicked",{item:"zoom_out_time_range"})},toolbarShareClick:()=>{s("toolbar_actions_clicked",{item:"share"})},toolbarSaveClick:()=>{s("toolbar_actions_clicked",{item:"save"})},toolbarSaveAsClick:()=>{s("toolbar_actions_clicked",{item:"save_as"})},toolbarAddClick:()=>{s("toolbar_actions_clicked",{item:"add"})},setScenesContext:()=>(n=!0,()=>{n=!1})},s=(r,f)=>{const a=n?{scenesView:!0}:{};f?(0,t.rR)(`dashboards_${r}`,{...f,...a}):(0,t.rR)(`dashboards_${r}`)}},99246:(G,O,e)=>{"use strict";e.d(O,{C:()=>t,Y:()=>n});const t={left:[],right:[]};function n(i,s){t[i].push(s)}},11982:(G,O,e)=>{"use strict";e.d(O,{Lp:()=>p,Uu:()=>l,e0:()=>g,r7:()=>h,uZ:()=>o});var t=e(76885),n=e(71733),i=e(12131),s=e(32264),r=e(80943),f=e(10096),a=e(87490),c=e(74730);function o(m){let y=`/d/${m.uid}`;m.uid||(y="/dashboard/new"),m.soloRoute&&(y=`/d-solo/${m.uid}`),m.slug&&(y+=`/${m.slug}`),m.subPath&&(y+=m.subPath),m.render&&(y="/render"+y,m.updateQuery={...m.updateQuery,width:1e3,height:500,tz:m.timeZone}),m.isHomeDashboard&&(y="/");const d=m.currentQueryParams?(0,i.SE)(m.currentQueryParams):{};if(m.updateQuery)for(const u in m.updateQuery)m.updateQuery[u]===null||m.updateQuery[u]===void 0?delete d[u]:d[u]=m.updateQuery[u];const v=t.kM.renderUrl(y,d);return m.absolute?s.$.appUrl+v.slice(1):v}function h(m){return n.I.getUrlForPartial(i.Ny.getLocation(),{viewPanel:m.state.key,editPanel:void 0})}function g(m){return n.I.getUrlForPartial(i.Ny.getLocation(),{editPanel:m,viewPanel:void 0})}function l(m,y){const d=m.state.key?.replace("-view","");return n.I.getUrlForPartial(i.Ny.getLocation(),{inspect:d,inspectTab:y})}function p(m){const y=m.getPlugin(),d=(0,c.un)(m);if(!f.TP.hasAccessToExplore()||y?.meta.skipDataQuery||!d)return Promise.resolve(void 0);const v=r.jh.getTimeRange(m);return(0,a.Xe)({queries:d.state.queries,dsRef:d.state.datasource,timeRange:v.state.value,scopedVars:{__sceneObject:{value:m}},adhocFilters:d.state.data?.request?.filters})}},74730:(G,O,e)=>{"use strict";e.d(O,{Cs:()=>y,O8:()=>b,RQ:()=>d,SN:()=>T,Sm:()=>x,Ws:()=>R,X0:()=>D,XA:()=>m,YQ:()=>S,Yr:()=>A,a7:()=>P,bx:()=>E,pk:()=>C,sw:()=>l,un:()=>M,vL:()=>v,vm:()=>p,xz:()=>I});var t=e(22391),n=e(19347),i=e(80943),s=e(81515),r=e(39820),f=e(34842),a=e(60656),c=e(42397),o=e(7196),h=e(58029),g=e(32023);const l=8,p=12;function m(L){return`panel-${L}`}function y(L){return parseInt(L.state.key.replace("panel-",""),10)}function d(L){return parseInt(L.state.panelKey.replace("panel-",""),10)}function v(L,U){if(!U)return null;const W=u(L,U);if(W)return W;const w=parseInt(U,10);return isNaN(w)?null:u(L,m(w))}function u(L,U){if(!U)return null;const W=i.jh.findObject(L,w=>w.state.key===U?!0:(w instanceof i.Eb,!1));if(W){if(W instanceof i.Eb)return W;throw new Error(`Found panel with key ${U} but it was not a VizPanel`)}return null}function D(L,U){L.forEachChild(W=>{W.isActive&&(W.forceRender(),D(W,U))})}function P(L){const{value:U,text:W,options:w}=L.state;return L.hasAllValue()?{values:w.map(N=>N.value),texts:w.map(N=>N.label)}:{values:Array.isArray(U)?U:[U],texts:Array.isArray(W)?W:[W]}}function x(L){const U=L.match(/(["'])(.*?)\1|\w+/g);if(!U)return s.Ez.query?.split(",")??[];const W=new Set,w=U.reduce((N,B)=>{const V=B.replace(/["']+/g,"");return V.startsWith("$__auto_interval_")||N.add(V),N},W);return Array.from(w)}function E(L){return Array.isArray(L)?L.join(","):""}function C(L,U){const W=Array.isArray(L.current.value)?L.current.value[0]:L.current.value;return W.startsWith("$__auto_interval_")?"$__auto":U.includes(W)?W:U[0]}function M(L){if(!L)return;const U=L.state.$data??L.parent?.state.$data;if(U instanceof i.dt)return U;if(U instanceof i.Es)return M(U)}function S(L){const U=L.getRoot();if(U instanceof f.H$)return U;throw new Error("SceneObject root is not a DashboardScene")}function I(L){return L instanceof i.Eb?L:L.parent?I(L.parent):null}function T(L){return L.includes("clone")}function b(L){const U=g.b4.getNextPanelId(L);return new i.Eb({title:"Panel Title",key:m(U),pluginId:"timeseries",titleItems:[new c.$({menu:new c.m({})})],hoverHeaderOffset:0,menu:new i.Lw({$behaviors:[o._i]}),$data:new i.Es({$data:new i.dt({queries:[{refId:"A"}],datasource:(0,t.p$)((0,n.l)().getInstanceSettings(null)),$behaviors:[new r.L({})]}),transformations:[]})})}function R(L){const U=g.b4.getNextPanelId(L);return new i.tI({key:m(U),title:"Row title",actions:new h.u({}),y:0})}function A(L){if(L.parent instanceof a.F)return L.parent}},28676:(G,O,e)=>{"use strict";e.d(O,{n:()=>h});var t=e(17172),n=e(32264),i=e(2468),s=e(48814),r=e(6473),f=e(61642);class a{constructor(){}saveDashboard(p){return r.t.ignoreNextSave(),(0,t.AI)().post("/api/dashboards/db/",{dashboard:p.dashboard,message:p.message??"",overwrite:p.overwrite??!1,folderUid:p.folderUid})}deleteDashboard(p,m){return(0,t.AI)().delete(`/api/dashboards/uid/${p}`,{showSuccessAlert:m})}getDashboardDTO(p){const y=(0,f.X)()?.getAll("scopes")??[],d=y.length>0?{scopes:y}:void 0;return(0,t.AI)().get(`/api/dashboards/uid/${p}`,d)}}class c{constructor(){this.client=new i.w({group:"dashboard.grafana.app",version:"v0alpha1",resource:"dashboards"})}saveDashboard(p){const m=p.dashboard,y={metadata:{...p?.k8s},spec:{...m}};return p.message?y.metadata.annotations={...y.metadata.annotations,[s.fY]:p.message}:y.metadata.annotations&&delete y.metadata.annotations[s.fY],p.folderUid&&(y.metadata.annotations={...y.metadata.annotations,[s.ew]:p.folderUid}),m.uid?(y.metadata.name=m.uid,this.client.update(y).then(d=>this.asSaveDashboardResponseDTO(d))):this.client.create(y).then(d=>this.asSaveDashboardResponseDTO(d))}asSaveDashboardResponseDTO(p){return{uid:p.metadata.name,version:p.spec.version??0,id:p.spec.id??0,status:"success",slug:"",url:""}}deleteDashboard(p,m){return this.client.delete(p).then(y=>({id:0,message:y.message,title:"deleted"}))}async getDashboardDTO(p){const m=await this.client.subresource(p,"dto");return{meta:{...m.access,isNew:!1,isFolder:!1,uid:m.metadata.name,k8s:m.metadata},dashboard:m.spec}}}let o;function h(){return o||(o=n.$.featureToggles.kubernetesDashboards?new c:new a),o}function g(l){throw new Error("dashboardAPI can be only overridden in test environment")}},72686:(G,O,e)=>{"use strict";e.d(O,{$L:()=>P,AK:()=>E,Bs:()=>m,NA:()=>x,NY:()=>D,Sm:()=>p,T2:()=>d,U9:()=>y,_e:()=>u,bN:()=>v,eq:()=>S,ft:()=>I,g9:()=>M,kd:()=>C});var t=e(75816),n=e(75505),i=e(17172),s=e(32264),r=e(82467),f=e(3169),a=e(8484),c=e(72254),o=e(34842);function h(T){return typeof T=="object"&&T!=null&&"error"in T}const g=({baseUrl:T})=>async b=>{try{const{data:R,...A}=await(0,n.s)((0,i.AI)().fetch({...b,url:T+b.url,showErrorAlert:b.showErrorAlert}));return{data:R,meta:A}}catch(R){return b.manageError?b.manageError(R):{error:R}}},l=T=>({error:(0,i.NF)(T)&&T.data.messageId!=="publicdashboards.notFound"?T:null}),p=(0,t.xP)({reducerPath:"publicDashboardApi",baseQuery:g({baseUrl:"/api"}),tagTypes:["PublicDashboard","AuditTablePublicDashboard","UsersWithActiveSessions","ActiveUserDashboards"],refetchOnMountOrArgChange:!0,endpoints:T=>({getPublicDashboard:T.query({query:b=>({url:`/dashboards/uid/${b}/public-dashboards`,manageError:l,showErrorAlert:!1}),async onQueryStarted(b,{dispatch:R,queryFulfilled:A}){try{await A}catch(L){h(L)&&(0,i.NF)(L.error)&&R((0,r.dx)((0,f.gi)(L.error.data.message)))}},providesTags:(b,R,A)=>[{type:"PublicDashboard",id:A}]}),createPublicDashboard:T.mutation({query:b=>({url:`/dashboards/uid/${b.dashboard instanceof o.H$?b.dashboard.state.uid:b.dashboard.uid}/public-dashboards`,method:"POST",data:b.payload}),async onQueryStarted({dashboard:b,payload:{share:R}},{dispatch:A,queryFulfilled:L}){const{data:U}=await L;let W=(0,a.t)("public-dashboard.sharing.success-creation","Dashboard is public!");s.$.featureToggles.newDashboardSharingComponent&&(W=R===c.Xo.PUBLIC?(0,a.t)("public-dashboard.public-sharing.success-creation","Your dashboard is now publicly accessible"):(0,a.t)("public-dashboard.email-sharing.success-creation","Your dashboard is ready for external sharing")),A((0,r.dx)((0,f.tZ)(W))),b instanceof o.H$?b.setState({meta:{...b.state.meta,publicDashboardEnabled:U.isEnabled}}):b.updateMeta({publicDashboardEnabled:U.isEnabled})},invalidatesTags:(b,R,{dashboard:A})=>[{type:"PublicDashboard",id:A instanceof o.H$?A.state.uid:A.uid}]}),updatePublicDashboard:T.mutation({query:({payload:b,dashboard:R})=>({url:`/dashboards/uid/${R instanceof o.H$?R.state.uid:R.uid}/public-dashboards/${b.uid}`,method:"PATCH",data:b}),async onQueryStarted({dashboard:b},{dispatch:R,queryFulfilled:A}){await A,R((0,r.dx)((0,f.tZ)(s.$.featureToggles.newDashboardSharingComponent?(0,a.t)("public-dashboard.configuration.success-update","Settings have been successfully updated"):(0,a.t)("public-dashboard.configuration.success-update-old","Public dashboard updated!"))))},invalidatesTags:(b,R,{payload:A})=>[{type:"PublicDashboard",id:A.dashboardUid},"AuditTablePublicDashboard"]}),pauseOrResumePublicDashboard:T.mutation({query:({payload:b,dashboard:R})=>({url:`/dashboards/uid/${R instanceof o.H$?R.state.uid:R.uid}/public-dashboards/${b.uid}`,method:"PATCH",data:b}),async onQueryStarted({dashboard:b,payload:{isEnabled:R}},{dispatch:A,queryFulfilled:L}){const{data:U}=await L;let W=(0,a.t)("public-dashboard.configuration.success-update-old","Public dashboard updated!");s.$.featureToggles.newDashboardSharingComponent&&(W=R?(0,a.t)("public-dashboard.configuration.success-resume","Your dashboard access has been resumed"):(0,a.t)("public-dashboard.configuration.success-pause","Your dashboard access has been paused")),A((0,r.dx)((0,f.tZ)(W))),b instanceof o.H$?b.setState({meta:{...b.state.meta,publicDashboardEnabled:U.isEnabled}}):b.updateMeta?.({publicDashboardEnabled:U.isEnabled})},invalidatesTags:(b,R,{payload:A})=>[{type:"PublicDashboard",id:A.dashboardUid},"AuditTablePublicDashboard"]}),updatePublicDashboardAccess:T.mutation({query:({payload:b,dashboard:R})=>({url:`/dashboards/uid/${R instanceof o.H$?R.state.uid:R.uid}/public-dashboards/${b.uid}`,method:"PATCH",data:b}),async onQueryStarted({dashboard:b,payload:{share:R}},{dispatch:A,queryFulfilled:L}){await L;let U=(0,a.t)("public-dashboard.configuration.success-update-old","Public dashboard updated!");s.$.featureToggles.newDashboardSharingComponent&&(U=R===c.Xo.PUBLIC?(0,a.t)("public-dashboard.public-sharing.success-share-type-change","Dashboard access updated: Anyone with the link can now access"):(0,a.t)("public-dashboard.email-sharing.success-share-type-change","Dashboard access restricted: Only specific people can now access with the link")),A((0,r.dx)((0,f.tZ)(U)))},invalidatesTags:(b,R,{payload:A})=>[{type:"PublicDashboard",id:A.dashboardUid},"AuditTablePublicDashboard"]}),addRecipient:T.mutation({query:()=>({url:""})}),deleteRecipient:T.mutation({query:()=>({url:""})}),reshareAccessToRecipient:T.mutation({query:()=>({url:""})}),getActiveUsers:T.query({query:()=>({url:"/"}),providesTags:["UsersWithActiveSessions"]}),getActiveUserDashboards:T.query({query:()=>({url:""}),providesTags:(b,R,A)=>[{type:"ActiveUserDashboards",id:A}]}),listPublicDashboards:T.query({query:(b=1)=>({url:`/dashboards/public-dashboards?page=${b}&perpage=8`}),transformResponse:b=>({...b,totalPages:Math.ceil(b.totalCount/b.perPage)}),providesTags:["AuditTablePublicDashboard"]}),deletePublicDashboard:T.mutation({query:b=>({url:`/dashboards/uid/${b.dashboardUid}/public-dashboards/${b.uid}`,method:"DELETE"}),async onQueryStarted({dashboard:b},{dispatch:R,queryFulfilled:A}){await A,R((0,r.dx)((0,f.tZ)(s.$.featureToggles.newDashboardSharingComponent?(0,a.t)("public-dashboard.share.success-delete","Your dashboard is no longer shareable"):(0,a.t)("public-dashboard.share.success-delete-old","Public dashboard deleted!")))),R(p.util?.resetApiState()),b instanceof o.H$?b.setState({meta:{...b.state.meta,publicDashboardEnabled:!1}}):b?.updateMeta({publicDashboardEnabled:!1})},invalidatesTags:(b,R,{dashboardUid:A})=>[{type:"PublicDashboard",id:A},"AuditTablePublicDashboard","UsersWithActiveSessions","ActiveUserDashboards"]}),revokeAllAccess:T.mutation({query:()=>({url:""})})})}),{useGetPublicDashboardQuery:m,useCreatePublicDashboardMutation:y,useUpdatePublicDashboardMutation:d,useDeletePublicDashboardMutation:v,useListPublicDashboardsQuery:u,useAddRecipientMutation:D,useDeleteRecipientMutation:P,useReshareAccessToRecipientMutation:x,useGetActiveUsersQuery:E,useGetActiveUserDashboardsQuery:C,useRevokeAllAccessMutation:M,usePauseOrResumePublicDashboardMutation:S,useUpdatePublicDashboardAccessMutation:I}=p},15858:(G,O,e)=>{"use strict";e.d(O,{M:()=>g});var t=e(2543),n=e(12470),i=e(19347),s=e(2913),r=e(57767),f=e(75096),a=e(82792),c=e(98796),o=e(24240);function h(l){return!!(l.libraryPanel?.name&&l.libraryPanel?.uid)}class g{async makeExportable(p){p.cleanUpRepeats();const m=p.getSaveModelCloneOld();m.id=null,p.processRepeats();const y=[],d={},v={},u={},D=new Map;for(const C of m.getVariables())u[C.name]=C;const P=(C,M)=>{if(C.datasource===void 0){C.datasource=M;return}let S=C.datasource,I=null;const T=S?.uid,b=T&&f.SY.exec(T);if(b){const R=b[1]||b[2]||b[4];I=u[R],I&&I.current&&(S=I.current.value)}return(0,i.l)().get(S).then(R=>{if(R.meta?.builtIn||(d["datasource"+R.meta?.id]={type:"datasource",id:R.meta.id,name:R.meta.name,version:R.meta.info.version||"1.0.0"},I))return;const A=C.libraryPanel,L=A?"-for-library-panel":"";let U="DS_"+R.name.replace(" ","_").toUpperCase()+L.toUpperCase();if(v[U]={name:U,label:R.name,description:"",type:"datasource",pluginId:R.meta?.id,pluginName:R.meta?.name,usage:v[U]?.usage},A){const W=v[U]?.usage?.libraryPanels||[];W.push({name:A.name,uid:A.uid}),v[U].usage={libraryPanels:W}}C.datasource={type:R.meta.id,uid:"${"+U+"}"}})},x=async C=>{if(C.type!=="row"){if(await P(C),C.targets)for(const S of C.targets)await P(S,C.datasource);const M=s.Ay.panels[C.type];M&&(d["panel"+M.id]={type:"panel",id:M.id,name:M.name,version:M.info.version})}},E=async C=>{if((0,a.X)(C)){const{name:M,uid:S}=C.libraryPanel;let I=C.libraryPanel.model;I||(I=(await(0,r.Yr)(S,!0)).model),await P(I);const{gridPos:T,id:b,...R}=I;D.has(S)||D.set(S,{name:M,uid:S,kind:c.i.Panel,model:R})}};try{for(const S of m.panels)if(await x(S),S.collapsed!==void 0&&S.collapsed===!0&&S.panels)for(const I of S.panels)await x(I);for(const S of m.getVariables())S.type==="query"?(await P(S),S.options=[],S.current={},S.refresh=S.refresh!==n.CO.never?S.refresh:n.CO.onDashboardLoad):S.type==="datasource"&&(S.current={});for(const S of m.annotations.list)await P(S);d.grafana={type:"grafana",id:"grafana",name:"Grafana",version:s.Ay.buildInfo.version};for(const S of m.panels)if(await E(S),S.collapsed!==void 0&&S.collapsed===!0&&S.panels)for(const I of S.panels)await E(I);(0,t.each)(v,S=>{y.push(S)});for(const S of m.getVariables())if((0,o.VO)(S)){const I="VAR_"+S.name.replace(" ","_").toUpperCase();y.push({name:I,type:"constant",label:S.label||S.name,value:S.query,description:""}),S.query="${"+I+"}",S.current={value:S.query,text:S.query,selected:!1},S.options=[S.current]}const C=[...D.entries()].reduce((S,[I,T])=>(S[I]=T,S),{}),M=(0,t.defaults)({__inputs:y,__elements:C,__requires:(0,t.sortBy)(d,["id"])},m);for(let S=0;S<M.panels.length;S++){const I=M.panels[S];h(I)&&(M.panels[S]={gridPos:I.gridPos,id:I.id,libraryPanel:{uid:I.libraryPanel.uid,name:I.libraryPanel.name}})}return M}catch(C){return console.error("Export failed:",C),{error:C}}}}},20120:(G,O,e)=>{"use strict";e.d(O,{fP:()=>ae,Ay:()=>ce});var t=e(74848),n=e(96540),i=e(32196),s=e(71468),r=e(24180),f=e(80997),a=e(13544),c=e(12131),o=e(69731),h=e(96374),g=e(39938),l=e(19727),p=e(27746),m=e(71678),y=e(15068),d=e(82467),v=e(75269),u=e(10804),D=e(2913),P=e(3169),x=e(10096),E=e(16021),C=e(8484),M=e(91219),S=e(28215),I=e(83122),T=e(55852),b=e(14578),R=e(32264),A=e(38138),L=e(36974),U=e(7758),W=e(31678),w=e(28601);const B=({dashboard:de})=>{const De=(0,n.useMemo)(()=>(0,L._u)(),[]),fe=(0,W.useDispatch)(),Te=(0,W.useSelector)(je=>je.dashboard.initialDatasource);return(0,t.jsxs)(A.W,{children:[(0,t.jsx)(A.W.Item,{testId:a.Tp.pages.AddDashboard.itemButton("Add new visualization menu item"),label:(0,C.t)("dashboard.add-menu.visualization","Visualization"),onClick:()=>{const je=(0,L.OK)(de,Te);U.c.toolbarAddButtonClicked({item:"add_visualization"}),c.Ny.partial({editPanel:je}),fe((0,w.Ub)(void 0))}},"add-visualisation"),R.$.featureToggles.vizAndWidgetSplit&&(0,t.jsx)(A.W.Item,{testId:a.Tp.pages.AddDashboard.itemButton("Add new widget menu item"),label:(0,C.t)("dashboard.add-menu.widget","Widget"),onClick:()=>{U.c.toolbarAddButtonClicked({item:"add_widget"}),c.Ny.partial({addWidget:!0})}},"add-widget"),(0,t.jsx)(A.W.Item,{testId:a.Tp.pages.AddDashboard.itemButton("Add new row menu item"),label:(0,C.t)("dashboard.add-menu.row","Row"),onClick:()=>{U.c.toolbarAddButtonClicked({item:"add_row"}),(0,L.SD)(de)}},"add-row"),(0,t.jsx)(A.W.Item,{testId:a.Tp.pages.AddDashboard.itemButton("Add new panel from panel library menu item"),label:(0,C.t)("dashboard.add-menu.import","Import from library"),onClick:()=>{U.c.toolbarAddButtonClicked({item:"import_from_library"}),(0,L.s3)(de)}},"add-panel-lib"),(0,t.jsx)(A.W.Item,{testId:a.Tp.pages.AddDashboard.itemButton("Add new panel from clipboard menu item"),label:(0,C.t)("dashboard.add-menu.paste-panel","Paste panel"),onClick:()=>{U.c.toolbarAddButtonClicked({item:"paste_panel"}),(0,L.no)(de,De)},disabled:!De},"add-panel-clipboard")]})},K=({dashboard:de,onToolbarAddMenuOpen:De})=>{const[fe,Te]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{fe&&De&&De()},[fe,De]),(0,t.jsx)(I.m,{overlay:()=>(0,t.jsx)(B,{dashboard:de}),placement:"bottom",offset:[0,6],onVisibleChange:Te,children:(0,t.jsxs)(T.$n,{variant:"secondary",size:"sm",fill:"outline","data-testid":a.Tp.components.PageToolbar.itemButton("Add button"),children:[(0,t.jsx)(C.x6,{i18nKey:"dashboard.toolbar.add",children:"Add"}),(0,t.jsx)(b.I,{name:fe?"angle-up":"angle-down",size:"lg"})]})})};var H=e(70497),X=e(14792),k=e(2609),Y=e(81862),Z=e(28444),se=e(99246),j=e(93030),q=e(62367);const ne=({dashboard:de})=>(0,t.jsx)(T.$n,{"data-testid":a.Tp.pages.Dashboard.DashNav.shareButton,variant:"primary",size:"sm",onClick:()=>{U.c.toolbarShareClick(),c.Ny.partial({shareView:"link"})},children:(0,t.jsx)(C.x6,{i18nKey:"dashboard.toolbar.share-button",children:"Share"})}),oe={removeNavIndex:S.Im,setStarred:M.ci,updateTimeZoneForSession:Y.Cj,updateNavIndex:d.Vz},z=de=>({navIndex:de.navIndex}),te=(0,s.connect)(z,oe),le=a.Tp.pages.Dashboard.DashNav;function ie(de){registerDynamicDashNavAction("left",de)}function ae(de){(0,se.Y)("right",de)}const re=(0,n.memo)(de=>{(0,r.zy)();const De=(0,o.C)();(0,E.u)(de.dashboard.events,Z.Cf);const fe=de.dashboard.snapshot?.originalUrl??"",Te=()=>{window.location.href=f.sQ.sanitizeUrl(de.dashboard.snapshot.originalUrl)},je=(0,P._2)(),He=()=>{try{const ot=new URL(f.sQ.sanitizeUrl(fe),D.Ay.appUrl),$e=new URL(D.Ay.appUrl);ot.host!==$e.host?x.lE.publish(new Z.S8({component:h.u,props:{title:"Proceed to external site?",modalClass:me,body:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("p",{children:["This link connects to an external website at"," ",(0,t.jsx)("code",{children:fe})]}),(0,t.jsx)("p",{children:"Are you sure you'd like to proceed?"})]}),confirmVariant:"primary",confirmText:"Proceed",onConfirm:Te}})):Te()}catch(ot){je.error("Invalid URL",ot instanceof Error?ot.message:void 0)}},Be=()=>{U.c.toolbarFavoritesClick();const ot=(0,X.UA)(),{dashboard:$e,navIndex:ve,removeNavIndex:be,setStarred:he,updateNavIndex:ye}=de;ot.starDashboard($e.uid,!!$e.meta.isStarred).then(Pe=>{he({id:$e.uid,title:$e.title,url:$e.meta.url??"",isStarred:Pe});const ge=ve.starred;if(Pe)ge.children?.push({id:M.L1+$e.uid,text:$e.title,url:$e.meta.url??"",parentItem:ge});else{be(M.L1+$e.uid);const xe=ge.children?.findIndex(Ae=>Ae.id===M.L1+$e.uid);xe&&ge.children?.splice(xe,1)}ye(ge),$e.meta.isStarred=Pe,De()})},Ne=()=>{U.c.toolbarSettingsClick(),c.Ny.partial({editview:"settings"})},Re=()=>{k._o.prev()},Se=()=>{k._o.next()},We=()=>{k._o.stop(),De()},Ke=(ot,$e)=>{ot.map((ve,be)=>{const he=ve.component,ye=(0,n.createElement)(he,{...de,key:`button-custom-${be}`});typeof ve.index=="number"?$e.splice(ve.index,0,ye):$e.push(ye)})},Xe=()=>k._o.state.isPlaying,Je=()=>{const ot=D.Ay.buildInfo.env==="development",{dashboard:$e,kioskMode:ve}=de,{canStar:be,isStarred:he}=$e.meta,ye=[];if(ve||Xe())return[];if(be){let Pe=he?(0,C.t)("dashboard.toolbar.unmark-favorite","Unmark as favorite"):(0,C.t)("dashboard.toolbar.mark-favorite","Mark as favorite");ye.push((0,t.jsx)(j._,{tooltip:Pe,icon:he?"favorite":"star",iconType:he?"mono":"default",iconSize:"lg",onClick:Be},"button-star"))}return $e.meta.publicDashboardEnabled&&ye.push((0,t.jsx)(g.E,{color:"blue",text:"Public",className:ee,"data-testid":le.publicDashboardTag},"public-dashboard-button-badge")),ot&&D.Ay.featureToggles.dashboardScene&&ye.push((0,t.jsx)(j._,{tooltip:"View as Scene",icon:"apps",onClick:()=>{c.Ny.partial({scenes:!0})}},"button-scenes")),Ke(se.C.left,ye),ye},st=()=>(0,t.jsxs)(l.e,{children:[(0,t.jsx)(p.I,{tooltip:(0,C.t)("dashboard.toolbar.playlist-previous","Go to previous dashboard"),icon:"backward",onClick:Re,narrow:!0}),(0,t.jsx)(p.I,{onClick:We,children:(0,t.jsx)(C.x6,{i18nKey:"dashboard.toolbar.playlist-stop",children:"Stop playlist"})}),(0,t.jsx)(p.I,{tooltip:(0,C.t)("dashboard.toolbar.playlist-next","Go to next dashboard"),icon:"forward",onClick:Se,narrow:!0})]},"playlist-buttons"),pt=()=>{const{dashboard:ot,updateTimeZoneForSession:$e,hideTimePicker:ve}=de;return ve?null:(0,t.jsx)(q.$,{dashboard:ot,onChangeTimeZone:$e,onToolbarRefreshClick:U.c.toolbarRefreshClick,onToolbarZoomClick:U.c.toolbarZoomClick,onToolbarTimePickerClick:U.c.toolbarTimePickerClick},"time-controls")},xt=()=>{const{dashboard:ot,isFullscreen:$e,kioskMode:ve,hideTimePicker:be}=de,{canSave:he,canEdit:ye,showSettings:Pe,canShare:ge}=ot.meta,{snapshot:xe}=ot,Ae=xe&&xe.originalUrl,Ee=[];return Xe()?[st(),pt()]:ve===W.KioskMode.TV?[pt()]:(Ae&&Ee.push((0,t.jsx)(p.I,{tooltip:(0,C.t)("dashboard.toolbar.open-original","Open original dashboard"),onClick:He,icon:"link"},"button-snapshot")),he&&!$e&&Ee.push((0,t.jsx)(m.$s,{children:({showModal:Ie,hideModal:Qe})=>(0,t.jsx)(p.I,{tooltip:(0,C.t)("dashboard.toolbar.save","Save dashboard"),icon:"save",onClick:()=>{U.c.toolbarSaveClick(),Ie(H.$,{dashboard:ot,onDismiss:Qe})}})},"button-save")),Ke(se.C.right,Ee),Pe&&Ee.push((0,t.jsx)(p.I,{tooltip:(0,C.t)("dashboard.toolbar.settings","Dashboard settings"),icon:"cog",onClick:Ne},"button-settings")),ye&&!$e&&Ee.push((0,t.jsx)(K,{dashboard:ot,onToolbarAddMenuOpen:U.c.toolbarAddClick},"panel-add-dropdown")),ge&&Ee.push((0,t.jsx)(ne,{dashboard:ot},"button-share")),be||Ee.push((0,t.jsx)(u.K,{},"toolbar-separator")),Ee.push(pt()),Ee)};return(0,t.jsx)(v.H,{actions:(0,t.jsxs)(t.Fragment,{children:[Je(),(0,t.jsx)(u.K,{leftActionsSeparator:!0}),(0,t.jsx)(y.U,{alignment:"right",children:xt()})]})})});re.displayName="DashNav";const ce=te(re),me=(0,i.css)({width:"max-content",maxWidth:"80vw"}),ee=(0,i.css)({color:"grey",backgroundColor:"transparent",border:"1px solid"})},93030:(G,O,e)=>{"use strict";e.d(O,{_:()=>r});var t=e(74848),n=e(32196),i=e(40845),s=e(29158);const r=({icon:a,iconType:c,iconSize:o,tooltip:h,onClick:g,children:l})=>{const p=(0,i.of)(f);return(0,t.jsxs)("div",{className:p.noBorderContainer,children:[a&&(0,t.jsx)(s.K,{name:a,size:o,iconType:c,tooltip:h,tooltipPlacement:"bottom",onClick:g}),l]})},f=a=>({noBorderContainer:(0,n.css)({padding:`0 ${a.spacing(.5)}`,display:"flex"})})},62367:(G,O,e)=>{"use strict";e.d(O,{$:()=>m});var t=e(74848),n=e(96540),i=e(85858),s=e(3591),r=e(32264),f=e(11134),a=e(15648),c=e(25573),o=e(10096),h=e(8484),g=e(16233),l=e(74856),p=e(28444);class m extends n.Component{constructor(){super(...arguments),this.onChangeRefreshInterval=d=>{(0,l.jG)().setAutoRefresh(d),this.forceUpdate()},this.onRefresh=()=>((0,l.jG)().refreshTimeModel(),Promise.resolve()),this.onMoveBack=()=>{o.lE.publish(new p.Io({direction:p.xL.Left}))},this.onMoveForward=()=>{o.lE.publish(new p.Io({direction:p.xL.Right}))},this.onChangeTimePicker=d=>{const{dashboard:v}=this.props,u=v.timepicker,D=u.nowDelay&&d.raw.to==="now",P=i.isMathString(d.raw.from)?d.raw.from:d.from,x=i.isMathString(d.raw.to)?d.raw.to:d.to,E={from:P,to:D?"now-"+u.nowDelay:x};(0,l.jG)().setTime(E)},this.onChangeTimeZone=d=>{this.props.dashboard.timezone=d,this.props.onChangeTimeZone(d),this.onRefresh()},this.onChangeFiscalYearStartMonth=d=>{this.props.dashboard.fiscalYearStartMonth=d,this.onRefresh()},this.onZoom=()=>{this.props.onToolbarZoomClick&&this.props.onToolbarZoomClick(),o.lE.publish(new p.U0({scale:2}))},this.onRefreshClick=()=>{this.props.onToolbarRefreshClick&&this.props.onToolbarRefreshClick(),this.onRefresh()}}componentDidMount(){this.sub=this.props.dashboard.events.subscribe(s.sR,()=>this.forceUpdate())}componentWillUnmount(){this.sub?.unsubscribe()}render(){const{dashboard:d,isOnCanvas:v}=this.props,{refresh_intervals:u}=d.timepicker,D=(0,l.jG)().getValidIntervals(u||f.cb),P=(0,l.jG)().timeRange(),x=d.getTimezone(),E=d.fiscalYearStartMonth,C=d.panelInEdit?.isEditing,M=d.weekStart||(0,a.r)(r.$.bootData.user.weekStart);let S;return d.refresh===g.SM&&(S=(0,l.jG)().getAutoRefreshInteval().interval),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.m,{value:P,onChange:this.onChangeTimePicker,timeZone:x,fiscalYearStartMonth:E,onMoveBackward:this.onMoveBack,onMoveForward:this.onMoveForward,onZoom:this.onZoom,onChangeTimeZone:this.onChangeTimeZone,onChangeFiscalYearStartMonth:this.onChangeFiscalYearStartMonth,isOnCanvas:v,onToolbarTimePickerClick:this.props.onToolbarTimePickerClick,weekStart:M}),(0,t.jsx)(f.cC,{onIntervalChanged:this.onChangeRefreshInterval,onRefresh:this.onRefreshClick,value:d.refresh,intervals:D,isOnCanvas:v,tooltip:(0,h.t)("dashboard.toolbar.refresh","Refresh dashboard"),noIntervalPicker:C,showAutoInterval:!0,text:S})]})}}},16495:(G,O,e)=>{"use strict";e.d(O,{U:()=>t.Ay});var t=e(20120)},46991:(G,O,e)=>{"use strict";e.d(O,{d:()=>r});var t=e(74848),n=e(32196),i=e(40845),s=e(55852);const r=({children:a,...c})=>{const o=(0,i.of)(f);return(0,t.jsx)("div",{className:o.buttonWrapper,children:(0,t.jsx)(s.$n,{icon:"plus",...c,children:a})})},f=a=>({buttonWrapper:(0,n.css)({padding:`${a.spacing(3)} 0`})})},75590:(G,O,e)=>{"use strict";e.d(O,{p:()=>u});var t=e(74848),n=e(2543),i=e(96540),s=e(65879),r=e(13544),f=e(57418),a=e(88575),c=e(20333),o=e(15648),h=e(10354),g=e(15292),l=e(8484),p=e(11134),m=e(74856);const y=({refreshIntervals:D,onRefreshIntervalChange:P,getIntervalsFunc:x=v,validateIntervalsFunc:E=d})=>{const[C,M]=(0,i.useState)(x(D??p.cb)),[S,I]=(0,i.useState)(null);(0,i.useEffect)(()=>{const A=x(D??p.cb);M(A)},[x,D]);const T=(0,i.useMemo)(()=>Array.isArray(C)?C.join(","):"",[C]),b=(0,i.useCallback)(A=>{const L=A.currentTarget.value?A.currentTarget.value.split(","):[];M(L)},[M]),R=(0,i.useCallback)(A=>{const L=E(C);L===null&&P(x(C)),I(L)},[x,C,P,E]);return(0,t.jsx)(a.D,{label:(0,l.t)("dashboard-settings.general.auto-refresh-label","Auto refresh"),description:(0,l.t)("dashboard-settings.general.auto-refresh-description","Define the auto refresh intervals that should be available in the auto refresh list. Use the format '5s' for seconds, '1m' for minutes, '1h' for hours, and '1d' for days (e.g.: '5s,10s,30s,1m,5m,15m,30m,1h,2h,1d')."),error:S,invalid:!!S,children:(0,t.jsx)(h.p,{id:"auto-refresh-input",invalid:!!S,value:T,onChange:b,onBlur:R})})},d=(D,P={getTimeSrv:m.jG})=>{try{return v(D,P),null}catch(x){return x instanceof Error?x.message:"Invalid intervals"}},v=(D,P={getTimeSrv:m.jG})=>{const x=D.filter(E=>E.trim()!=="").map(E=>E.replace(/\s+/g,""));return[...new Set(P.getTimeSrv().getValidIntervals(x))]};class u extends i.PureComponent{constructor(){super(...arguments),this.state={isNowDelayValid:!0},this.onNowDelayChange=P=>{const x=P.currentTarget.value;if((0,n.isEmpty)(x))return this.setState({isNowDelayValid:!0}),this.props.onNowDelayChange(x);if(s.isValidTimeSpan(x))return this.setState({isNowDelayValid:!0}),this.props.onNowDelayChange(x);this.setState({isNowDelayValid:!1})},this.onHideTimePickerChange=()=>{this.props.onHideTimePickerChange(!this.props.timePickerHidden)},this.onLiveNowChange=()=>{this.props.onLiveNowChange(!this.props.liveNow)},this.onTimeZoneChange=P=>{typeof P=="string"&&this.props.onTimeZoneChange(P)},this.onWeekStartChange=P=>{this.props.onWeekStartChange(P)}}render(){return(0,t.jsxs)(f.M,{label:(0,l.t)("dashboard-settings.time-picker.time-options-label","Time options"),isOpen:!0,children:[(0,t.jsx)(a.D,{label:(0,l.t)("dashboard-settings.time-picker.time-zone-label","Time zone"),"data-testid":r.Tp.components.TimeZonePicker.containerV2,children:(0,t.jsx)(c.U,{inputId:"time-options-input",includeInternal:!0,value:this.props.timezone,onChange:this.onTimeZoneChange,width:40})}),(0,t.jsx)(a.D,{label:(0,l.t)("dashboard-settings.time-picker.week-start-label","Week start"),"data-testid":r.Tp.components.WeekStartPicker.containerV2,children:(0,t.jsx)(o.l,{inputId:"week-start-input",width:40,value:this.props.weekStart,onChange:this.onWeekStartChange})}),(0,t.jsx)(y,{refreshIntervals:this.props.refreshIntervals,onRefreshIntervalChange:this.props.onRefreshIntervalChange}),(0,t.jsx)(a.D,{label:(0,l.t)("dashboard-settings.time-picker.now-delay-label","Now delay"),description:(0,l.t)("dashboard-settings.time-picker.now-delay-description","Exclude recent data that may be incomplete."),children:(0,t.jsx)(h.p,{id:"now-delay-input",invalid:!this.state.isNowDelayValid,placeholder:"0m",onChange:this.onNowDelayChange,defaultValue:this.props.nowDelay})}),(0,t.jsx)(a.D,{label:(0,l.t)("dashboard-settings.time-picker.hide-time-picker","Hide time picker"),children:(0,t.jsx)(g.d,{id:"hide-time-picker-toggle",value:!!this.props.timePickerHidden,onChange:this.onHideTimePickerChange})}),(0,t.jsx)(a.D,{label:(0,l.t)("dashboard-settings.time-picker.refresh-live-dashboards-label","Refresh live dashboards"),description:(0,l.t)("dashboard-settings.time-picker.refresh-live-dashboards-description","Continuously re-draw panels where the time range references 'now'"),children:(0,t.jsx)(g.d,{id:"refresh-live-dashboards-toggle",value:!!this.props.liveNow,onChange:this.onLiveNowChange})})]})}}},62639:(G,O,e)=>{"use strict";e.d(O,{s:()=>mo});var t=e(74848),n=e(96540),i=e(24180),s=e(71733),r=e(13544),f=e(12131),a=e(55852),c=e(15068),o=e(67061),h=e(94753),g=e(75269),l=e(69444),p=e(8484),m=e(16233),y=e(31678),d=e(28444),v=e(71468),u=e(14644),D=e(32196),P=e(16817),x=e(14110),E=e(40845),C=e(57418),M=e(66864),S=e(62930),I=e(56034),T=e(14578),b=e(29158),R=e(2223);const A=({id:Ut,usages:Yt})=>{const Tn=(0,n.useMemo)(()=>Yt.find(In=>In.variable.id===Ut),[Ut,Yt]);if(!Tn)return null;const rn=Tn.nodes.map(In=>In.label.includes(`$${Ut}`)?{...In,color:"#FB7E81"}:In);return(0,t.jsx)(R.i,{show:!1,title:`Showing usages for: $${Ut}`,nodes:rn,edges:Tn.edges,children:({showModal:In})=>(0,t.jsx)(b.K,{onClick:()=>In(),name:"code-branch",tooltip:"Show usages","data-testid":"VariablesUnknownButton"})})};var L=e(12846);const U=1e3;function W({variables:Ut,dashboard:Yt}){const[Tn,rn]=(0,n.useState)(!1),[In,cs]=(0,n.useState)(0),[ds,Gs]=(0,n.useState)([]),js=(0,E.of)(V);(0,n.useEffect)(()=>cs(qs=>qs+1),[Ut,Yt]);const{loading:Ca}=(0,P.A)(async()=>{if(Tn&&In>0){const qs=Date.now(),xs=await(0,L.g0)(Ut,Yt),fr=Date.now()-qs;return fr>=U&&(0,x.rR)("Slow unknown variables expansion",{elapsed:fr}),cs(0),Gs(xs),xs}return[]},[Ut,Yt,Tn,In]),Aa=qs=>{qs&&(0,x.rR)("Unknown variables section expanded"),rn(qs)};return(0,t.jsx)("div",{className:js.container,children:(0,t.jsxs)(C.M,{label:(0,t.jsx)(w,{}),isOpen:Tn,onToggle:Aa,children:[Ca&&(0,t.jsx)(M.gW,{justify:"center",children:(0,t.jsxs)(M.Gy,{justify:"center",children:[(0,t.jsx)("span",{children:"Loading..."}),(0,t.jsx)(S.y,{})]})}),!Ca&&ds&&(0,t.jsxs)(t.Fragment,{children:[ds.length===0&&(0,t.jsx)(N,{}),ds.length>0&&(0,t.jsx)(B,{usages:ds})]})]})})}function w(){const Ut=(0,E.of)(V);return(0,t.jsxs)("h5",{children:["Renamed or missing variables",(0,t.jsx)(I.m,{content:"Click to expand a list with all variable references that have been renamed or are missing from the dashboard.",children:(0,t.jsx)(T.I,{name:"info-circle",className:Ut.infoIcon})})]})}function N(){return(0,t.jsx)("span",{children:"No renamed or missing variables found."})}function B({usages:Ut}){const Yt=(0,E.of)(V);return(0,t.jsxs)("table",{className:"filter-table filter-table--hover",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Variable"}),(0,t.jsx)("th",{colSpan:5})]})}),(0,t.jsx)("tbody",{children:Ut.map(Tn=>{const{variable:rn}=Tn,{id:In,name:cs}=rn;return(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:Yt.firstColumn,children:(0,t.jsx)("span",{children:cs})}),(0,t.jsx)("td",{className:Yt.defaultColumn}),(0,t.jsx)("td",{className:Yt.defaultColumn}),(0,t.jsx)("td",{className:Yt.defaultColumn}),(0,t.jsx)("td",{className:Yt.lastColumn,children:(0,t.jsx)(A,{id:rn.id,usages:Ut})})]},In)})})]})}const V=Ut=>({container:(0,D.css)`
    margin-top: ${Ut.spacing(4)};
    padding-top: ${Ut.spacing(4)};
  `,infoIcon:(0,D.css)`
    margin-left: ${Ut.spacing(1)};
  `,defaultColumn:(0,D.css)`
    width: 1%;
  `,firstColumn:(0,D.css)`
    width: 1%;
    vertical-align: top;
    color: ${Ut.colors.text.maxContrast};
  `,lastColumn:(0,D.css)`
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    width: 100%;
    text-align: right;
  `});var K=e(48594),H=e(87421),X=e(56968),k=e(75096),Y=e(96374);function Z({varName:Ut,isOpen:Yt=!1,onConfirm:Tn,onDismiss:rn}){return(0,t.jsx)(Y.u,{title:"Delete variable",isOpen:Yt,onConfirm:Tn,onDismiss:rn,body:`
      Are you sure you want to delete variable "${Ut}"?
    `,modalClass:se.modal,confirmText:"Delete"})}const se={modal:(0,D.css)({width:"max-content",maxWidth:"80vw"})};var j=e(39070),q=e(8964),ne=e(58975),oe=e(85140),z=e(14329),te=e(41820),le=e(20601),ie=e(24240),ae=e(72401),re=e(89458);function ce({onChange:Ut,type:Yt}){const Tn=(0,n.useMemo)(()=>(0,k.AX)(),[]),rn=(0,n.useMemo)(()=>Tn.find(In=>In.value===Yt)??Tn[0],[Tn,Yt]);return(0,t.jsx)(re.v,{name:"Select variable type",value:rn,options:Tn,onChange:Ut,testId:r.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalTypeSelectV2})}var me=e(2543),ee=e(27238),de=e(3843);const De=Ut=>async Yt=>{const{rootStateKey:Tn}=Ut;Yt((0,K.kb)(Tn,(0,de.sJ)({name:(0,H.dn)(Ut).name,id:Ut.id})))},fe=Ut=>async(Yt,Tn)=>{const{rootStateKey:rn}=Ut;Yt((0,K.kb)(rn,(0,de.T7)((0,k.qD)(Ut))))},Te=(Ut,Yt)=>(Tn,rn)=>{const{id:In,rootStateKey:cs}=Ut;let ds=null;if(Yt.match(/^(?!__).*$/)||(ds="Template names cannot begin with '__', that's reserved for Grafana's global variables"),Yt.match(/^\w+$/)||(ds="Only word characters are allowed in variable names"),(0,H.SS)(cs,rn()).filter(Ca=>Ca.name===Yt&&Ca.id!==In).length&&(ds="Variable with the same name already exists"),ds){Tn((0,K.kb)(cs,(0,de.DW)({newName:Yt,errorText:ds})));return}Tn(je(Ut,Yt))},je=(Ut,Yt)=>(Tn,rn)=>{const{rootStateKey:In}=Ut,cs=(0,H.dn)(Ut,rn());if(cs.name===Yt){Tn((0,K.kb)(In,(0,de.FN)((0,k.qD)(Ut,{newName:Yt}))));return}const ds={...(0,me.cloneDeep)(cs),name:Yt,id:Yt},Gs=cs.global,js=cs.index,Ca=(0,k.jX)(ds);Tn((0,K.kb)(In,(0,X.QV)((0,k.qD)(Ca,{global:Gs,index:js,model:ds})))),Tn((0,K.kb)(In,(0,de.FN)((0,k.qD)(Ca,{newName:Yt})))),Tn((0,K.kb)(In,(0,X.Hr)((0,k.qD)(Ut,{reIndex:!1}))))},He=(Ut,Yt="query")=>(Tn,rn)=>{const In=(0,k.q4)(Ut),cs=(0,H.SS)(In,rn()),ds=Ne(Yt,cs),Gs={type:Yt,id:ds},js=!1,Ca=(0,H.hk)(In,rn()),Aa=(0,me.cloneDeep)(le.B.get(Yt).initialState);Aa.id=ds,Aa.name=ds,Aa.rootStateKey=In,Tn((0,K.kb)(In,(0,X.QV)((0,k.qD)(Gs,{global:js,model:Aa,index:Ca})))),f.Ny.partial({editIndex:cs.length})},Be=Ut=>(Yt,Tn)=>{const rn=(0,k.q4)(Ut),In=Tn(),cs=(0,H.nS)(rn,In),ds=In.dashboard.getModel(),{usages:Gs}=(0,L.hM)(cs,ds),js=(0,L.Ow)(Gs);Yt((0,K.kb)(rn,(0,ee.bX)({usages:Gs,usagesNetwork:js})))};function Ne(Ut,Yt){let Tn=0,rn=`${Ut}${Tn}`;for(;Yt.find(In=>In.id===rn);)rn=`${Ut}${++Tn}`;return rn}var Re=e(85830);const Se=(Ut,Yt)=>({editor:(0,H.nx)(Yt.identifier.rootStateKey,Ut).editor,variable:(0,H.dn)(Yt.identifier,Ut)}),We=Ut=>({...(0,u.bindActionCreators)({variableEditorMount:De,variableEditorUnMount:fe,changeVariableName:Te,updateOptions:ae.mZ},Ut),changeVariableProp:(Yt,Tn,rn)=>Ut((0,K.kb)(Yt.rootStateKey,(0,X.QP)((0,k.qD)(Yt,{propName:Tn,propValue:rn})))),changeVariableType:(Yt,Tn)=>Ut((0,K.kb)(Yt.rootStateKey,(0,X.l_)((0,k.qD)(Yt,{newType:Tn})))),removeVariable:Yt=>{Ut((0,K.kb)(Yt.rootStateKey,(0,X.Hr)((0,k.qD)(Yt,{reIndex:!0}))))}}),Ke=(0,v.connect)(Se,We);class Xe extends n.PureComponent{constructor(){super(...arguments),this.state={showDeleteModal:!1},this.onNameChange=Yt=>{Yt.preventDefault(),this.props.changeVariableName(this.props.identifier,Yt.currentTarget.value)},this.onTypeChange=Yt=>{Yt.value&&this.props.changeVariableType(this.props.identifier,Yt.value)},this.onLabelChange=Yt=>{Yt.preventDefault(),this.props.changeVariableProp(this.props.identifier,"label",Yt.currentTarget.value)},this.onDescriptionChange=Yt=>{this.props.changeVariableProp(this.props.identifier,"description",Yt.currentTarget.value)},this.onHideChange=Yt=>{this.props.changeVariableProp(this.props.identifier,"hide",Yt)},this.onPropChanged=({propName:Yt,propValue:Tn,updateOptions:rn=!1})=>{this.props.changeVariableProp(this.props.identifier,Yt,Tn),rn&&this.props.updateOptions((0,k.jX)(this.props.variable))},this.onHandleSubmit=async Yt=>{Yt.preventDefault(),this.props.editor.isValid&&this.props.updateOptions((0,k.jX)(this.props.variable))},this.onModalOpen=()=>{this.setState({showDeleteModal:!0})},this.onModalClose=()=>{this.setState({showDeleteModal:!1})},this.onDelete=()=>{this.props.removeVariable(this.props.identifier),this.onModalClose(),f.Ny.partial({editIndex:null})},this.onApply=()=>{f.Ny.partial({editIndex:null})},this.getVariableOptions=()=>{const{variable:Yt}=this.props;return(0,ie.SP)(Yt)?Yt.options.map(Tn=>({label:String(Tn.text),value:String(Tn.value)})):[]}}componentDidMount(){this.props.variableEditorMount(this.props.identifier)}componentWillUnmount(){this.props.variableEditorUnMount(this.props.identifier)}render(){const{theme:Yt,variable:Tn}=this.props,rn=le.B.get(this.props.variable.type).editor;if(!rn)return null;const In=Tn.state===j.Gu.Loading,cs=window.matchMedia("(prefers-reduced-motion: reduce)").matches,ds=pt(Yt);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("form",{"aria-label":"Variable editor Form",onSubmit:this.onHandleSubmit,children:[(0,t.jsx)(ce,{onChange:this.onTypeChange,type:this.props.variable.type}),(0,t.jsx)(ne.Y,{children:"General"}),(0,t.jsx)(z._,{value:this.props.editor.name,onChange:this.onNameChange,name:"Name",placeholder:"Variable name",description:"The name of the template variable. (Max. 50 characters)",invalid:!!this.props.editor.errors.name,error:this.props.editor.errors.name,testId:r.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalNameInputV2,maxLength:Re.M.MaxSize,required:!0}),(0,t.jsx)(z._,{name:"Label",description:"Optional display name",value:this.props.variable.label??"",placeholder:"Label name",onChange:this.onLabelChange,testId:r.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalLabelInputV2}),(0,t.jsx)(oe.Z,{name:"Description",value:Tn.description??"",placeholder:"Descriptive text",onChange:this.onDescriptionChange,width:52}),(0,t.jsx)(q.D,{onChange:this.onHideChange,hide:this.props.variable.hide,type:this.props.variable.type}),rn&&(0,t.jsx)(rn,{variable:this.props.variable,onPropChange:this.onPropChanged}),(0,ie.SP)(this.props.variable)?(0,t.jsx)(te.j,{options:this.getVariableOptions()}):null,(0,t.jsx)("div",{style:{marginTop:"16px"},children:(0,t.jsxs)(M.Gy,{spacing:"md",height:"inherit",children:[(0,t.jsx)(a.$n,{variant:"destructive",fill:"outline",onClick:this.onModalOpen,children:"Delete"}),(0,t.jsxs)(a.$n,{type:"submit","data-testid":r.Tp.pages.Dashboard.Settings.Variables.Edit.General.submitButton,disabled:In,variant:"secondary",children:["Run query",In&&(0,t.jsx)(T.I,{className:ds.spin,name:cs?"hourglass":"sync",size:"sm",style:{marginLeft:"2px"}})]}),(0,t.jsx)(a.$n,{variant:"primary",onClick:this.onApply,"data-testid":r.Tp.pages.Dashboard.Settings.Variables.Edit.General.applyButton,children:"Apply"})]})})]}),(0,t.jsx)(Z,{isOpen:this.state.showDeleteModal,varName:this.props.editor.name,onConfirm:this.onDelete,onDismiss:this.onModalClose})]})}}const Je=(0,E.cV)(Ke(Xe)),st=(0,D.keyframes)({"0%":{transform:"rotate(0deg) scaleX(-1)"},"100%":{transform:"rotate(359deg) scaleX(-1)"}}),pt=Ut=>({spin:(0,D.css)({[Ut.transitions.handleMotion("no-preference")]:{animation:`${st} 3s linear infinite`}})});var xt=e(38127),ot=e(69529),$e=e(72109);const ve=({variables:Ut})=>{const Yt=(0,n.useMemo)(()=>(0,L.hI)(Ut),[Ut]),Tn=(0,n.useMemo)(()=>(0,L.qJ)(Ut),[Ut]);return Tn.length?(0,t.jsx)(R.i,{show:!1,title:"Dependencies",nodes:(0,L.H7)(Yt,Tn),edges:Tn,children:({showModal:rn})=>(0,t.jsx)(a.$n,{onClick:()=>{(0,x.rR)("Show variable dependencies"),rn()},icon:"channel-add",variant:"secondary",children:"Show dependencies"})}):null},be=({id:Ut,usages:Yt,isAdhoc:Tn})=>{const rn=(0,n.useMemo)(()=>Yt.find(cs=>cs.variable.id===Ut),[Yt,Ut]);if(Yt.length===0||Tn||!rn)return null;const In=rn.nodes.map(cs=>cs.label.includes(`$${Ut}`)?{...cs,color:"#FB7E81"}:cs);return(0,t.jsx)(R.i,{show:!1,title:`Showing usages for: $${Ut}`,nodes:In,edges:rn.edges,children:({showModal:cs})=>(0,t.jsx)(b.K,{onClick:()=>{(0,x.rR)("Show variable usages"),cs()},name:"code-branch",tooltip:"Show usages"})})};function he({index:Ut,variable:Yt,usageTree:Tn,usagesNetwork:rn,onEdit:In,onDuplicate:cs,onDelete:ds}){const Gs=(0,E.$j)(),js=(0,E.of)(ge),Ca=ye(Yt),qs=(0,L.PK)(Yt.id,Tn)>0||Yt.type==="adhoc",xs=(0,k.jX)(Yt);return(0,t.jsx)(xt.sx,{draggableId:JSON.stringify(xs),index:Ut,children:(Er,fr)=>(0,t.jsxs)("tr",{ref:Er.innerRef,...Er.draggableProps,style:{userSelect:fr.isDragging?"none":"auto",background:fr.isDragging?Gs.colors.background.secondary:void 0,...Er.draggableProps.style},children:[(0,t.jsx)("td",{role:"gridcell",className:js.column,children:(0,t.jsx)(a.$n,{size:"xs",fill:"text",onClick:gr=>{gr.preventDefault(),In(xs)},className:js.nameLink,"aria-label":r.Tp.pages.Dashboard.Settings.Variables.List.tableRowNameFields(Yt.name),children:Yt.name})}),(0,t.jsx)("td",{role:"gridcell",className:js.definitionColumn,onClick:gr=>{gr.preventDefault(),In(xs)},"aria-label":r.Tp.pages.Dashboard.Settings.Variables.List.tableRowDefinitionFields(Yt.name),children:Ca}),(0,t.jsx)("td",{role:"gridcell",className:js.column,children:(0,t.jsxs)("div",{className:js.icons,children:[(0,t.jsx)(Pe,{passed:qs}),(0,t.jsx)(be,{id:Yt.id,isAdhoc:Yt.type==="adhoc",usages:rn}),(0,t.jsx)(b.K,{onClick:gr=>{gr.preventDefault(),(0,x.rR)("Duplicate variable"),cs(xs)},name:"copy",tooltip:"Duplicate variable","aria-label":r.Tp.pages.Dashboard.Settings.Variables.List.tableRowDuplicateButtons(Yt.name)}),(0,t.jsx)(b.K,{onClick:gr=>{gr.preventDefault(),(0,x.rR)("Delete variable"),ds(xs)},name:"trash-alt",tooltip:"Remove variable","aria-label":r.Tp.pages.Dashboard.Settings.Variables.List.tableRowRemoveButtons(Yt.name)}),(0,t.jsx)("div",{...Er.dragHandleProps,className:js.dragHandle,children:(0,t.jsx)(T.I,{name:"draggabledots",size:"lg"})})]})})]})})}function ye(Ut){let Yt="";return Ut.type==="query"?Ut.definition?Yt=Ut.definition:typeof Ut.query=="string"&&(Yt=Ut.query):(0,ie.SP)(Ut)&&(Yt=Ut.query),Yt}function Pe({passed:Ut}){const Yt=(0,E.of)(ge);return Ut?(0,t.jsx)(T.I,{name:"check",className:Yt.iconPassed,title:"This variable is referenced by other variables or dashboard."}):(0,t.jsx)(T.I,{name:"exclamation-triangle",className:Yt.iconFailed,title:"This variable is not referenced by any variable or dashboard."})}function ge(Ut){return{dragHandle:(0,D.css)`
      cursor: grab;
      margin-left: ${Ut.spacing(1)};
    `,column:(0,D.css)`
      width: 1%;
    `,nameLink:(0,D.css)`
      cursor: pointer;
      color: ${Ut.colors.primary.text};
    `,definitionColumn:(0,D.css)`
      width: 100%;
      max-width: 200px;
      cursor: pointer;
      overflow: hidden;
      text-overflow: ellipsis;
      -o-text-overflow: ellipsis;
      white-space: nowrap;
    `,iconPassed:(0,D.css)`
      color: ${Ut.v1.palette.greenBase};
      margin-right: ${Ut.spacing(2)};
    `,iconFailed:(0,D.css)`
      color: ${Ut.v1.palette.orange};
      margin-right: ${Ut.spacing(2)};
    `,icons:(0,D.css)`
      display: flex;
      gap: ${Ut.spacing(2)};
      align-items: center;
    `}}function xe({variables:Ut,usages:Yt,usagesNetwork:Tn,onChangeOrder:rn,onAdd:In,onEdit:cs,onDelete:ds,onDuplicate:Gs}){const js=(0,E.of)(Ee),Ca=Aa=>{if(!Aa.destination||!Aa.source)return;(0,x.rR)("Variable drag and drop");const qs=JSON.parse(Aa.draggableId);rn(qs,Ut[Aa.source.index].index,Ut[Aa.destination.index].index)};return(0,t.jsx)("div",{children:(0,t.jsxs)("div",{children:[Ut.length===0&&(0,t.jsx)(Ae,{onAdd:In}),Ut.length>0&&(0,t.jsxs)(o.B,{direction:"column",gap:4,children:[(0,t.jsx)("div",{className:js.tableContainer,children:(0,t.jsxs)("table",{className:"filter-table filter-table--hover","aria-label":r.Tp.pages.Dashboard.Settings.Variables.List.table,role:"grid",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Variable"}),(0,t.jsx)("th",{children:"Definition"}),(0,t.jsx)("th",{colSpan:5})]})}),(0,t.jsx)(xt.JY,{onDragEnd:Ca,children:(0,t.jsx)(xt.gL,{droppableId:"variables-list",direction:"vertical",children:Aa=>(0,t.jsxs)("tbody",{ref:Aa.innerRef,...Aa.droppableProps,children:[Ut.map((qs,xs)=>(0,t.jsx)(he,{index:xs,variable:qs,usageTree:Yt,usagesNetwork:Tn,onDelete:ds,onDuplicate:Gs,onEdit:cs},`${qs.name}-${xs}`)),Aa.placeholder]})})})]})}),(0,t.jsxs)(o.B,{children:[(0,t.jsx)(ve,{variables:Ut}),(0,t.jsx)(a.$n,{"aria-label":r.Tp.pages.Dashboard.Settings.Variables.List.newButton,onClick:In,icon:"plus",children:"New variable"})]})]})]})})}function Ae({onAdd:Ut}){return(0,t.jsx)(o.B,{direction:"column",children:(0,t.jsxs)(ot.p,{variant:"call-to-action",button:(0,t.jsx)(a.$n,{"data-testid":r.Tp.components.CallToActionCard.buttonV2("Add variable"),icon:"calculator-alt",onClick:Ut,size:"lg",children:(0,t.jsx)(p.x6,{i18nKey:"variables.empty-state.button-title",children:"Add variable"})}),message:(0,p.t)("variables.empty-state.title","There are no variables added yet"),children:[(0,t.jsx)("p",{children:(0,t.jsx)(p.x6,{i18nKey:"variables.empty-state.info-box-content",children:"Variables enable more interactive and dynamic dashboards. Instead of hard-coding things like server or sensor names in your metric queries you can use variables in their place. Variables are shown as list boxes at the top of the dashboard. These drop-down lists make it easy to change the data being displayed in your dashboard."})}),(0,t.jsxs)(p.x6,{i18nKey:"variables.empty-state.info-box-content-2",children:["Check out the"," ",(0,t.jsx)($e.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/variables/",children:"Templates and variables documentation"})," ","for more information."]})]})})}const Ee=()=>({tableContainer:(0,D.css)`
    overflow: scroll;
    width: 100%;
  `}),Ie=(Ut,Yt)=>{const{uid:Tn}=Yt.dashboard,rn=(0,H.nx)(Tn,Ut);return{variables:(0,H.nS)(Tn,Ut),idInEditor:rn.editor.id,usagesNetwork:rn.inspect.usagesNetwork,usages:rn.inspect.usages}},Qe=Ut=>({...(0,u.bindActionCreators)({createNewVariable:He,initListMode:Be},Ut),changeVariableOrder:(Yt,Tn,rn)=>Ut((0,K.kb)(Yt.rootStateKey,(0,X.hj)((0,k.qD)(Yt,{fromIndex:Tn,toIndex:rn})))),duplicateVariable:Yt=>Ut((0,K.kb)(Yt.rootStateKey,(0,X.ut)((0,k.qD)(Yt,{newId:void 0})))),removeVariable:Yt=>{Ut((0,K.kb)(Yt.rootStateKey,(0,X.Hr)((0,k.qD)(Yt,{reIndex:!0}))))}}),at=(0,v.connect)(Ie,Qe);class ft extends n.PureComponent{constructor(){super(...arguments),this.state={variableId:void 0},this.onEditVariable=Yt=>{const Tn=this.props.variables.findIndex(rn=>rn.id===Yt.id);f.Ny.partial({editIndex:Tn})},this.onNewVariable=()=>{this.props.createNewVariable(this.props.dashboard.uid)},this.onChangeVariableOrder=(Yt,Tn,rn)=>{this.props.changeVariableOrder(Yt,Tn,rn)},this.onDuplicateVariable=Yt=>{this.props.duplicateVariable(Yt)},this.onModalOpen=Yt=>{this.setState({variableId:Yt})},this.onModalClose=()=>{this.setState({variableId:void 0})},this.onRemoveVariable=()=>{this.props.removeVariable(this.state.variableId),this.onModalClose()}}componentDidMount(){this.props.initListMode(this.props.dashboard.uid)}render(){const{editIndex:Yt,variables:Tn,sectionNav:rn}=this.props,In=Yt!=null?Tn[Yt]:void 0,ds=rn.node.parentItem,Gs=In?{text:In.name,parentItem:ds}:ds;return(0,t.jsxs)(l.Y,{navModel:this.props.sectionNav,pageNav:Gs,children:[!In&&(0,t.jsx)(xe,{variables:this.props.variables,onAdd:this.onNewVariable,onEdit:this.onEditVariable,onChangeOrder:this.onChangeVariableOrder,onDuplicate:this.onDuplicateVariable,onDelete:this.onModalOpen,usages:this.props.usages,usagesNetwork:this.props.usagesNetwork}),!In&&this.props.variables.length>0&&(0,t.jsx)(W,{variables:this.props.variables,dashboard:this.props.dashboard}),In&&(0,t.jsx)(Je,{identifier:(0,k.jX)(In)}),(0,t.jsx)(Z,{isOpen:this.state.variableId!==void 0,varName:this.state.variableId?.id??"",onConfirm:this.onRemoveVariable,onDismiss:this.onModalClose})]})}}const ct=at(ft);var vt=e(5108),Pt=e(10096);const Vt=({dashboard:Ut,sectionNav:Yt})=>{const Tn=Pt.TP.hasPermission(y.AccessControlAction.DashboardsPermissionsWrite),rn=Yt.node.parentItem;return(0,t.jsx)(l.Y,{navModel:Yt,pageNav:rn,children:(0,t.jsx)(vt.x,{resource:"dashboards",resourceId:Ut.uid,canSetPermissions:Tn})})};var Jt=e(78050),wt=e(22391),zt=e(19347),on=e(84167),Pn=e(88575),_n=e(10354),Cn=e(10880),Ye=e(90182),Dt=e(77268),yt=e(2913),Ft=e(82241),an=e(46502),un=e(51612);const hn="New annotation",Un=({editIdx:Ut,dashboard:Yt})=>{const Tn=(0,E.of)(Nn),[rn,In]=(0,n.useState)(Yt.annotations.list[Ut]),cs=(0,n.useMemo)(()=>rn.filter?rn.filter.exclude?2:1:0,[rn.filter]),{value:ds}=(0,P.A)(()=>(0,zt.l)().get(rn.datasource),[rn.datasource]),Gs=(0,zt.l)().getInstanceSettings(rn.datasource),js=Sa=>{const Za=[...Yt.annotations.list];Za.splice(Ut,1,Sa),In(Sa),Yt.annotations.list=Za},Ca=Sa=>{js({...rn,name:Sa.currentTarget.value})},Aa=Sa=>{const Za=(0,wt.p$)(Sa);rn.datasource?.type!==Za.type?js({datasource:Za,builtIn:rn.builtIn,enable:rn.enable,iconColor:rn.iconColor,name:rn.name,hide:rn.hide,filter:rn.filter,mappings:rn.mappings,type:rn.type}):js({...rn,datasource:Za})},qs=Sa=>{const Za=Sa.currentTarget;js({...rn,[Za.name]:Za.type==="checkbox"?Za.checked:Za.value})},xs=Sa=>{js({...rn,iconColor:Sa})},Er=Sa=>{let Za=Sa.value===0?void 0:{exclude:Sa.value===2,ids:rn.filter?.ids??[]};js({...rn,filter:Za})},fr=Sa=>{if(!Array.isArray(Sa))return;const Za={exclude:cs===2,ids:[]};Sa.forEach(ur=>ur.value&&Za.ids.push(ur.value)),js({...rn,filter:Za})},gr=St,Rr=()=>{f.Ny.partial({editview:null,editIndex:null})},Dr=()=>{const Sa=Yt.annotations.list;Yt.annotations.list=[...Sa.slice(0,Ut),...Sa.slice(Ut+1)],St()},Mo=rn.name===hn,So=(Sa,Za)=>Sa.label&&Za.label?Sa.label.toLowerCase().localeCompare(Za.label.toLowerCase()):-1,Ka=(0,n.useMemo)(()=>Yt?.panels.filter(Sa=>yt.Ay.panels[Sa.type]).map(Sa=>({value:Sa.id,label:Sa.title??`Panel ${Sa.id}`,description:Sa.description,imgUrl:yt.Ay.panels[Sa.type].info.logos.small})).sort(So)??[],[Yt]);return(0,t.jsxs)("div",{children:[(0,t.jsxs)(on.n,{className:Tn.settingsForm,children:[(0,t.jsx)(Pn.D,{label:"Name",children:(0,t.jsx)(_n.p,{"data-testid":r.Tp.pages.Dashboard.Settings.Annotations.Settings.name,name:"name",id:"name",autoFocus:Mo,value:rn.name,onChange:Ca})}),(0,t.jsx)(Pn.D,{label:"Data source",htmlFor:"data-source-picker",children:(0,t.jsx)(un.s,{annotations:!0,variables:!0,current:rn.datasource,onChange:Aa})}),(0,t.jsx)(Pn.D,{label:"Enabled",description:"When enabled the annotation query is issued every dashboard refresh",children:(0,t.jsx)(Cn.S,{name:"enable",id:"enable",value:rn.enable,onChange:qs})}),(0,t.jsx)(Pn.D,{label:"Hidden",description:"Annotation queries can be toggled on or off at the top of the dashboard. With this option checked this toggle will be hidden.",children:(0,t.jsx)(Cn.S,{name:"hide",id:"hide",value:rn.hide,onChange:qs})}),(0,t.jsx)(Pn.D,{label:"Color",description:"Color to use for the annotation event markers",children:(0,t.jsx)(M.Gy,{children:(0,t.jsx)(Dt.a,{value:rn?.iconColor,onChange:xs})})}),(0,t.jsx)(Pn.D,{label:"Show in","data-testid":r.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.showInLabel,children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Ye.l6,{options:ht,value:cs,onChange:Er,"data-testid":r.Tp.components.Annotations.annotationsTypeInput}),cs!==0&&(0,t.jsx)(Ye.KF,{options:Ka,value:Ka.filter(Sa=>rn.filter?.ids.includes(Sa.value)),onChange:fr,isClearable:!0,placeholder:"Choose panels",width:100,closeMenuOnSelect:!1,className:Tn.select,"data-testid":r.Tp.components.Annotations.annotationsChoosePanelInput})]})})]}),(0,t.jsxs)(on.n,{children:[(0,t.jsx)("h3",{className:"page-heading",children:"Query"}),ds?.annotations&&Gs&&(0,t.jsx)(Ft.A,{datasource:ds,datasourceInstanceSettings:Gs,annotation:rn,onChange:js}),ds&&!ds.annotations&&(0,t.jsx)(an.F,{datasource:ds,annotation:rn,onChange:js})]}),(0,t.jsxs)(o.B,{children:[!rn.builtIn&&(0,t.jsx)(a.$n,{variant:"destructive",onClick:Dr,children:"Delete"}),(0,t.jsx)(a.$n,{variant:"secondary",onClick:Rr,"data-testid":r.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.previewInDashboard,children:"Preview in dashboard"}),(0,t.jsx)(a.$n,{variant:"primary",onClick:gr,children:"Apply"})]})]})},Nn=Ut=>({settingsForm:(0,D.css)({maxWidth:Ut.spacing(60),marginBottom:Ut.spacing(2)}),select:(0,D.css)({marginTop:"8px"})});function St(){f.Ny.partial({editIndex:null})}var nn=(Ut=>(Ut[Ut.AllPanels=0]="AllPanels",Ut[Ut.IncludePanels=1]="IncludePanels",Ut[Ut.ExcludePanels=2]="ExcludePanels",Ut))(nn||{});const ht=[{label:"All panels",value:0,description:"Send the annotation data to all panels that support annotations"},{label:"Selected panels",value:1,description:"Send the annotations to the explicitly listed panels"},{label:"All panels except",value:2,description:"Do not send annotation data to the following panels"}];var lt=e(14588),gt=e(91605),$t=e(46991);const et=({dashboard:Ut,onNew:Yt,onEdit:Tn})=>{const rn=(0,E.of)(Et),[In,cs]=(0,n.useState)(Ut.annotations.list),ds=(qs,xs)=>{Ut.annotations.list=lt.moveItemImmutably(In,qs,qs+xs),cs(Ut.annotations.list)},Gs=qs=>{Ut.annotations.list=[...In.slice(0,qs),...In.slice(qs+1)],cs(Ut.annotations.list)},js=In.length===0||In.length===1&&In[0].builtIn,Ca=qs=>qs.enable===!1?(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("em",{className:"muted",children:["(Disabled) \xA0 ",qs.name]})}):qs.builtIn?(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("em",{className:"muted",children:[qs.name," \xA0 (Built-in)"]})}):(0,t.jsx)(t.Fragment,{children:qs.name}),Aa=(0,zt.l)();return(0,t.jsxs)(o.B,{direction:"column",children:[In.length>0&&(0,t.jsx)("div",{className:rn.table,children:(0,t.jsxs)("table",{role:"grid",className:"filter-table filter-table--hover",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Query name"}),(0,t.jsx)("th",{children:"Data source"}),(0,t.jsx)("th",{colSpan:3})]})}),(0,t.jsx)("tbody",{children:Ut.annotations.list.map((qs,xs)=>(0,t.jsxs)("tr",{children:[qs.builtIn?(0,t.jsx)("td",{role:"gridcell",style:{width:"90%"},className:"pointer",onClick:()=>Tn(xs),children:(0,t.jsx)(a.$n,{size:"sm",fill:"text",variant:"secondary",children:Ca(qs)})}):(0,t.jsx)("td",{role:"gridcell",className:"pointer",onClick:()=>Tn(xs),children:(0,t.jsx)(a.$n,{size:"sm",fill:"text",variant:"secondary",children:Ca(qs)})}),(0,t.jsx)("td",{role:"gridcell",className:"pointer",onClick:()=>Tn(xs),children:Aa.getInstanceSettings(qs.datasource)?.name||qs.datasource?.uid}),(0,t.jsx)("td",{role:"gridcell",style:{width:"1%"},children:xs!==0&&(0,t.jsx)(b.K,{name:"arrow-up",onClick:()=>ds(xs,-1),tooltip:"Move up"})}),(0,t.jsx)("td",{role:"gridcell",style:{width:"1%"},children:Ut.annotations.list.length>1&&xs!==Ut.annotations.list.length-1?(0,t.jsx)(b.K,{name:"arrow-down",onClick:()=>ds(xs,1),tooltip:"Move down"}):null}),(0,t.jsx)("td",{role:"gridcell",style:{width:"1%"},children:!qs.builtIn&&(0,t.jsx)(gt.e,{size:"sm",onConfirm:()=>Gs(xs),"aria-label":`Delete query with title "${qs.name}"`})})]},`${qs.name}-${xs}`))})]})}),js&&(0,t.jsx)(o.B,{direction:"column",children:(0,t.jsxs)(ot.p,{variant:"call-to-action",button:(0,t.jsx)(a.$n,{"data-testid":r.Tp.components.CallToActionCard.buttonV2("Add annotation query"),icon:"comment-alt",onClick:Yt,size:"lg",children:(0,t.jsx)(p.x6,{i18nKey:"annotations.empty-state.button-title",children:"Add annotation query"})}),message:(0,p.t)("annotations.empty-state.title","There are no custom annotation queries added yet"),children:[(0,t.jsx)(p.x6,{i18nKey:"annotations.empty-state.info-box-content",children:(0,t.jsx)("p",{children:"Annotations provide a way to integrate event data into your graphs. They are visualized as vertical lines and icons on all graph panels. When you hover over an annotation icon you can get event text & tags for the event. You can add annotation events directly from grafana by holding CTRL or CMD + click on graph (or drag region). These will be stored in Grafana's annotation database."})}),(0,t.jsxs)(p.x6,{i18nKey:"annotations.empty-state.info-box-content-2",children:["Checkout the"," ",(0,t.jsx)($e.Y,{external:!0,href:"http://docs.grafana.org/reference/annotations/",children:"Annotations documentation"})," ","for more information."]})]})}),!js&&(0,t.jsx)($t.d,{"data-testid":r.Tp.pages.Dashboard.Settings.Annotations.List.addAnnotationCTAV2,onClick:Yt,children:"New query"})]})},Et=()=>({table:(0,D.css)({width:"100%",overflowX:"scroll"})});function It({dashboard:Ut,editIndex:Yt,sectionNav:Tn}){const rn=()=>{const ds={name:hn,enable:!0,datasource:(0,wt.p$)((0,zt.l)().getInstanceSettings(null)),iconColor:"red"};Ut.annotations.list=[...Ut.annotations.list,{...ds}],f.Ny.partial({editIndex:Ut.annotations.list.length-1})},In=ds=>{f.Ny.partial({editIndex:ds})},cs=Yt!=null&&Yt<Ut.annotations.list.length;return(0,t.jsxs)(l.Y,{navModel:Tn,pageNav:Qt(Ut,Yt,Tn.node),children:[!cs&&(0,t.jsx)(et,{dashboard:Ut,onNew:rn,onEdit:In}),cs&&(0,t.jsx)(Un,{dashboard:Ut,editIdx:Yt})]})}function Qt(Ut,Yt,Tn){const rn=Tn.parentItem;if(Yt==null)return rn;const In=Ut.annotations.list[Yt];if(In)return{text:In.name,parentItem:rn}}var sn=e(32264),ln=e(90613),yn=e(60029),Sn=e(21744),En=e(79924),wn=e(94354),On=e(36607),Rt=e(3673),Ot=e(71678),jt=e(14792),rt=e(5805),tn=e(68402),Mn=e(37390),kn=e(11230);const Yn={cleanUpDashboardAndVariables:Rt.Bz},Wn=(0,v.connect)(null,Yn),Jn=({hideModal:Ut,cleanUpDashboardAndVariables:Yt,dashboard:Tn})=>{const rn=Tn.meta.provisioned,[,In]=(0,rt.default)(async()=>{(0,x.rR)("grafana_manage_dashboards_delete_clicked",{item_counts:{dashboard:1},source:"dashboard_settings",restore_enabled:sn.$.featureToggles.dashboardRestoreUI}),await(0,kn.A_)(Tn.uid,!0),Yt(),Ut(),f.Ny.replace("/")},[Ut]);return rn?(0,t.jsx)(Ls,{hideModal:Ut,provisionedId:Tn.meta.provisionedExternalId}):(0,t.jsx)(Y.u,{isOpen:!0,body:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.E,{element:"p",children:(0,t.jsx)(p.x6,{i18nKey:"dashboard-settings.dashboard-delete-modal.text",children:"Do you want to delete this dashboard?"})}),(0,t.jsx)(tn.$,{v:1}),(0,t.jsx)(h.E,{element:"p",children:Tn.title}),(0,t.jsx)(tn.$,{v:2})]}),onConfirm:In,onDismiss:Ut,title:(0,p.t)("dashboard-settings.dashboard-delete-modal.title","Delete"),icon:"trash-alt",confirmText:(0,p.t)("dashboard-settings.dashboard-delete-modal.delete-button","Delete"),confirmationText:(0,p.t)("dashboard-settings.dashboard-delete-modal.confirmation-text","Delete")})},Ls=({hideModal:Ut,provisionedId:Yt})=>(0,t.jsxs)(Mn.a,{isOpen:!0,title:(0,p.t)("dashboard-settings.provisioned-delete-modal.title","Cannot delete provisioned dashboard"),icon:"trash-alt",onDismiss:Ut,className:(0,D.css)({width:"500px"}),children:[(0,t.jsx)(h.E,{element:"p",children:(0,t.jsx)(p.x6,{i18nKey:"dashboard-settings.provisioned-delete-modal.text-1",children:"This dashboard is managed by Grafana provisioning and cannot be deleted. Remove the dashboard from the config file to delete it."})}),(0,t.jsx)(tn.$,{v:1}),(0,t.jsxs)(h.E,{element:"p",children:[(0,t.jsx)(p.x6,{i18nKey:"dashboard-settings.provisioned-delete-modal.text-2",children:"See grafana documentation for more information about provisioning.\xA0"}),(0,t.jsx)($e.Y,{href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",external:!0,children:(0,p.t)("dashboard-settings.provisioned-delete-modal.text-link","Go to docs page")})]}),(0,t.jsx)(tn.$,{v:2}),(0,t.jsx)(h.E,{element:"p",children:(0,t.jsxs)(p.x6,{i18nKey:"dashboard-settings.provisioned-delete-modal.text-3",children:["File path: ",{provisionedId:Yt}]})}),(0,t.jsx)(Mn.a.ButtonRow,{children:(0,t.jsx)(a.$n,{variant:"primary",onClick:Ut,children:(0,t.jsx)(p.x6,{i18nKey:"dashboard-settings.provisioned-delete-modal.confirm-button",children:"OK"})})})]}),fs=Wn(Jn),ys=()=>{const Ut=(0,jt.UA)().getCurrent();return(0,t.jsx)(Ot.$s,{children:({showModal:Yt,hideModal:Tn})=>(0,t.jsx)(a.$n,{variant:"destructive",onClick:()=>{Yt(fs,{dashboard:Ut,hideModal:Tn})},"data-testid":r.Tp.pages.Dashboard.Settings.General.deleteDashBoard,children:(0,t.jsx)(p.x6,{i18nKey:"dashboard-settings.dashboard-delete-button",children:"Delete dashboard"})})})};var Xn=e(81394),Ps=e(27966),Zs=e(75590);const Ms=[{value:0,label:"Default"},{value:1,label:"Shared crosshair"},{value:2,label:"Shared Tooltip"}];function ks({dashboard:Ut,updateTimeZone:Yt,updateWeekStart:Tn,sectionNav:rn}){const[In,cs]=(0,n.useState)(0),[ds,Gs]=(0,n.useState)(Ut.title),[js,Ca]=(0,n.useState)(Ut.description),Aa=rn.node.parentItem,qs=(da,ro)=>{Ut.meta.folderUid=da,Ut.meta.folderTitle=ro,Ut.meta.hasUnsavedFolderChange=!0,cs(In+1)},xs=(0,n.useCallback)(da=>{Ut.title=da,Gs(da)},[Gs,Ut]),Er=(0,n.useCallback)(da=>{Ut.description=da,Ca(da)},[Ca,Ut]),fr=da=>{Ut.graphTooltip=da,cs(In+1)},gr=da=>{Ut.timepicker.refresh_intervals=da.filter(ro=>ro.trim()!=="")},Rr=da=>{Ut.timepicker.nowDelay=da},Dr=da=>{Ut.timepicker.hidden=da,cs(In+1)},Mo=da=>{Ut.liveNow=da,cs(In+1)},So=da=>{Ut.timezone=da,cs(In+1),Yt(da)},Ka=da=>{Ut.weekStart=da,cs(In+1),Tn(da)},Sa=da=>{Ut.tags=da,cs(In+1)},Za=da=>{Ut.editable=da,cs(In+1)},ur=[{label:"Editable",value:!0},{label:"Read-only",value:!1}];return(0,t.jsx)(l.Y,{navModel:rn,pageNav:Aa,children:(0,t.jsxs)("div",{style:{maxWidth:"600px"},children:[(0,t.jsxs)(ln.a,{marginBottom:5,children:[(0,t.jsx)(Pn.D,{label:(0,t.jsxs)(o.B,{justifyContent:"space-between",children:[(0,t.jsx)(yn.J,{htmlFor:"title-input",children:(0,t.jsx)(p.x6,{i18nKey:"dashboard-settings.general.title-label",children:"Title"})}),sn.$.featureToggles.dashgpt&&(0,t.jsx)(Ps.Z,{onGenerate:xs})]}),children:(0,t.jsx)(_n.p,{id:"title-input",name:"title",value:ds,onChange:da=>xs(da.target.value)})}),(0,t.jsx)(Pn.D,{label:(0,t.jsxs)(o.B,{justifyContent:"space-between",children:[(0,t.jsx)(yn.J,{htmlFor:"description-input",children:(0,p.t)("dashboard-settings.general.description-label","Description")}),sn.$.featureToggles.dashgpt&&(0,t.jsx)(Xn.V,{onGenerate:Er})]}),children:(0,t.jsx)(Sn.f,{id:"description-input",name:"description",value:js,onChange:da=>Er(da.target.value)})}),(0,t.jsx)(Pn.D,{label:(0,p.t)("dashboard-settings.general.tags-label","Tags"),children:(0,t.jsx)(En.u,{id:"tags-input",tags:Ut.tags,onChange:Sa,width:40})}),(0,t.jsx)(Pn.D,{label:(0,p.t)("dashboard-settings.general.folder-label","Folder"),children:(0,t.jsx)(On.d,{value:Ut.meta.folderUid,onChange:qs,initialTitle:Ut.meta.folderTitle,inputId:"dashboard-folder-input",enableCreateNew:!0,dashboardId:Ut.id,skipInitialLoad:!0})}),(0,t.jsx)(Pn.D,{label:(0,p.t)("dashboard-settings.general.editable-label","Editable"),description:(0,p.t)("dashboard-settings.general.editable-description","Set to read-only to disable all editing. Reload the dashboard for changes to take effect"),children:(0,t.jsx)(wn.z,{value:Ut.editable,options:ur,onChange:Za})})]}),(0,t.jsx)(Zs.p,{onTimeZoneChange:So,onWeekStartChange:Ka,onRefreshIntervalChange:gr,onNowDelayChange:Rr,onHideTimePickerChange:Dr,onLiveNowChange:Mo,refreshIntervals:Ut.timepicker.refresh_intervals,timePickerHidden:Ut.timepicker.hidden,nowDelay:Ut.timepicker.nowDelay,timezone:Ut.timezone,weekStart:Ut.weekStart,liveNow:Ut.liveNow}),(0,t.jsx)(C.M,{label:(0,p.t)("dashboard-settings.general.panel-options-label","Panel options"),isOpen:!0,children:(0,t.jsx)(Pn.D,{label:(0,p.t)("dashboard-settings.general.panel-options-graph-tooltip-label","Graph tooltip"),description:(0,p.t)("dashboard-settings.general.panel-options-graph-tooltip-description","Controls tooltip and hover highlight behavior across different panels. Reload the dashboard for changes to take effect"),children:(0,t.jsx)(wn.z,{onChange:fr,options:Ms,value:Ut.graphTooltip})})}),(0,t.jsx)(ln.a,{marginTop:3,children:Ut.meta.canDelete&&(0,t.jsx)(ys,{})})]})})}const wa={updateTimeZone:Rt.lC,updateWeekStart:Rt.Ss},pa=(0,v.connect)(null,wa)(ks);var Ba=e(32372),_a=e(6473);function dr({dashboard:Ut,sectionNav:Yt}){const Tn=Ut.getSaveModelClone(),[rn,In]=(0,n.useState)(JSON.stringify(Tn,null,2)),cs=Yt.node.parentItem,ds=async()=>{await(0,jt.UA)().saveJSONDashboard(rn),_a.t.reloadPage()},Gs=(0,E.of)(Wa);return(0,t.jsx)(l.Y,{navModel:Yt,pageNav:cs,children:(0,t.jsxs)("div",{className:Gs.wrapper,children:[(0,t.jsx)(p.x6,{i18nKey:"dashboard-settings.json-editor.subtitle",children:"The JSON model below is the data structure that defines the dashboard. This includes dashboard settings, panel settings, layout, queries, and so on."}),(0,t.jsx)(Ba.B,{value:rn,language:"json",showMiniMap:!0,showLineNumbers:!0,onBlur:In,containerStyles:Gs.codeEditor}),Ut.meta.canSave&&(0,t.jsx)("div",{children:(0,t.jsx)(a.$n,{type:"submit",onClick:ds,children:(0,t.jsx)(p.x6,{i18nKey:"dashboard-settings.json-editor.save-button",children:"Save changes"})})})]})})}const Wa=Ut=>({wrapper:(0,D.css)({display:"flex",height:"100%",flexDirection:"column",gap:Ut.spacing(2)}),codeEditor:(0,D.css)({flexGrow:1})});var en=e(4588),$n=e(65857);const Qn=({editLinkIdx:Ut,dashboard:Yt,onGoBack:Tn})=>{const[rn,In]=(0,n.useState)(Ut!==null?Yt.links[Ut]:en.q),cs=ds=>{const Gs=[...Yt.links];Gs.splice(Ut,1,ds),Yt.links=Gs,In(ds)};return(0,t.jsx)($n.d,{link:rn,onUpdate:cs,onGoBack:Tn})};var Gn=e(6199);const qn=({dashboard:Ut,onNew:Yt,onEdit:Tn})=>{const[rn,In]=(0,n.useState)(Ut.links),cs=(js,Ca)=>{Ut.links=lt.moveItemImmutably(rn,js,js+Ca),In(Ut.links)},ds=js=>{Ut.links=[...rn,{...js}],In(Ut.links)},Gs=js=>{Ut.links=[...rn.slice(0,js),...rn.slice(js+1)],In(Ut.links)};return(0,t.jsx)(Gn.X,{links:rn,onNew:Yt,onEdit:Tn,onDuplicate:ds,onDelete:Gs,onOrderChange:cs})};function es({dashboard:Ut,sectionNav:Yt,editIndex:Tn}){const[rn,In]=(0,n.useState)(!1),cs=()=>{In(!1),f.Ny.partial({editIndex:void 0})},ds=()=>{Ut.links=[...Ut.links,{...en.q}],In(!0),f.Ny.partial({editIndex:Ut.links.length-1})},Gs=Aa=>{In(!1),f.Ny.partial({editIndex:Aa})},js=Tn!==void 0;let Ca=Yt.node.parentItem;return js&&(Ca={text:rn?"New link":"Edit link",subTitle:rn?"Create a new link on your dashboard":"Edit a specific link of your dashboard",parentItem:Yt.node.parentItem}),(0,t.jsxs)(l.Y,{navModel:Yt,pageNav:Ca,children:[!js&&(0,t.jsx)(qn,{dashboard:Ut,onNew:ds,onEdit:Gs}),js&&(0,t.jsx)(Qn,{dashboard:Ut,editLinkIdx:Tn,onGoBack:cs})]})}var Ss=e(57714),_s=e(19626),Pa=e(22764),Ea=e(56596),Ys=e(41053),ha=e(3169);const ja=async(Ut,Yt)=>(_a.t.ignoreNextSave(),await Ss.wL.restoreDashboard(Yt.uid,Ut)),ua=Ut=>{const Yt=(0,y.useSelector)(cs=>cs.dashboard.getModel()),[Tn,rn]=(0,Ys.A)(async()=>await ja(Ut,Yt),[]),In=(0,ha._2)();return(0,n.useEffect)(()=>{if(Tn.value){const cs=f.Ny.getLocation(),ds=s.I.stripBaseFromUrl(Tn.value.url),Gs=cs.state?.routeReloadCounter;f.Ny.replace({...cs,pathname:ds,state:{routeReloadCounter:Gs?Gs+1:1}}),In.success("Dashboard restored",`Restored from version ${Ut}`)}},[Tn,Ut,In]),{state:Tn,onRestoreDashboard:rn}},za=({hideModal:Ut,version:Yt})=>{const{state:Tn,onRestoreDashboard:rn}=ua(Yt);return(0,n.useEffect)(()=>{!Tn.loading&&Tn.value&&Ut()},[Tn,Ut]),(0,t.jsx)(Y.u,{isOpen:!0,title:"Restore Version",icon:"history",onDismiss:Ut,onConfirm:rn,body:(0,t.jsxs)("p",{children:["Are you sure you want to restore the dashboard to version ",Yt,"? All unsaved changes will be lost."]}),confirmText:`Yes, restore to version ${Yt}`})},Ja=({baseInfo:Ut,newInfo:Yt,diffData:Tn,isNewLatest:rn})=>{const In=(0,Ea.G4)(Tn.lhs,Tn.rhs),cs=(0,E.of)(pr);return(0,t.jsxs)(o.B,{direction:"column",gap:1,children:[(0,t.jsxs)(o.B,{justifyContent:"space-between",alignItems:"center",children:[(0,t.jsxs)(o.B,{alignItems:"center",children:[(0,t.jsxs)("span",{className:(0,D.cx)(cs.versionInfo,cs.noMarginBottom),children:[(0,t.jsxs)("strong",{children:["Version ",Ut.version]})," updated by ",Ut.createdBy," ",Ut.ageString,Ut.message]}),(0,t.jsx)(T.I,{name:"arrow-right",size:"sm"}),(0,t.jsxs)("span",{className:cs.versionInfo,children:[(0,t.jsxs)("strong",{children:["Version ",Yt.version]})," updated by ",Yt.createdBy," ",Yt.ageString,Yt.message]})]}),rn&&(0,t.jsx)(Ot.$s,{children:({showModal:ds,hideModal:Gs})=>(0,t.jsxs)(a.$n,{variant:"destructive",icon:"history",onClick:()=>{ds(za,{version:Ut.version,hideModal:Gs})},children:["Restore to version ",Ut.version]})})]}),Object.entries(In).map(([ds,Gs])=>(0,t.jsx)(_s.D,{diffs:Gs,title:ds},ds)),(0,t.jsx)(ln.a,{paddingTop:2,children:(0,t.jsx)(C.M,{isOpen:!1,label:"View JSON Diff",children:(0,t.jsx)(Pa.M,{oldValue:JSON.stringify(Tn.lhs,null,2),newValue:JSON.stringify(Tn.rhs,null,2)})})})]})},pr=Ut=>({versionInfo:(0,D.css)({color:Ut.colors.text.secondary,fontSize:Ut.typography.bodySmall.fontSize}),noMarginBottom:(0,D.css)({marginBottom:0})});var Wr=e(78369);const Fr=({versions:Ut,canCompare:Yt,onCheck:Tn})=>{const rn=(0,E.of)(Kr);return(0,t.jsx)("div",{className:rn.margin,children:(0,t.jsxs)("table",{className:"filter-table",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"width-4"}),(0,t.jsx)("th",{className:"width-4",children:"Version"}),(0,t.jsx)("th",{className:"width-14",children:"Date"}),(0,t.jsx)("th",{className:"width-10",children:"Updated by"}),(0,t.jsx)("th",{children:"Notes"}),(0,t.jsx)("th",{})]})}),(0,t.jsx)("tbody",{children:Ut.map((In,cs)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:(0,t.jsx)(Cn.S,{"aria-label":`Toggle selection of version ${In.version}`,className:(0,D.css)({display:"inline"}),checked:In.checked,onChange:ds=>Tn(ds,In.id),disabled:!In.checked&&Yt})}),(0,t.jsx)("td",{children:In.version}),(0,t.jsx)("td",{children:In.createdDateString}),(0,t.jsx)("td",{children:In.createdBy}),(0,t.jsx)("td",{children:In.message}),(0,t.jsx)("td",{className:"text-right",children:cs===0?(0,t.jsx)(Wr.v,{name:"Latest",colorIndex:17}):(0,t.jsx)(Ot.$s,{children:({showModal:ds,hideModal:Gs})=>(0,t.jsx)(a.$n,{variant:"secondary",size:"sm",icon:"history",onClick:()=>{ds(za,{version:In.version,hideModal:Gs})},children:"Restore"})})})]},In.id))})]})})};function Kr(Ut){return{margin:(0,D.css)({marginBottom:Ut.spacing(4)})}}const Ar=10;class $r extends n.PureComponent{constructor(Yt){super(Yt),this.getVersions=(Tn=!1)=>{this.setState({isAppending:Tn}),Ss.wL.getHistoryList(this.props.dashboard.uid,{limit:this.limit,start:this.start}).then(rn=>{this.setState({isLoading:!1,versions:[...this.state.versions,...this.decorateVersions(rn)]}),this.start+=this.limit}).catch(rn=>console.log(rn)).finally(()=>this.setState({isAppending:!1}))},this.getDiff=async()=>{const Tn=this.state.versions.filter(js=>js.checked),[rn,In]=Tn,cs=rn.version===this.props.dashboard.version;this.setState({isLoading:!0});const ds=await Ss.wL.getDashboardVersion(this.props.dashboard.uid,In.version),Gs=await Ss.wL.getDashboardVersion(this.props.dashboard.uid,rn.version);this.setState({baseInfo:In,isLoading:!1,isNewLatest:cs,newInfo:rn,viewMode:"compare",diffData:{lhs:ds.data,rhs:Gs.data}})},this.decorateVersions=Tn=>Tn.map(rn=>({...rn,createdDateString:this.props.dashboard.formatDate(rn.created),ageString:this.props.dashboard.getRelativeTime(rn.created),checked:!1})),this.onCheck=(Tn,rn)=>{this.setState({versions:this.state.versions.map(In=>In.id===rn?{...In,checked:Tn.currentTarget.checked}:In)})},this.reset=()=>{this.setState({baseInfo:void 0,diffData:{lhs:"",rhs:""},isNewLatest:!1,newInfo:void 0,versions:this.state.versions.map(Tn=>({...Tn,checked:!1})),viewMode:"list"})},this.limit=Ar,this.start=0,this.state={isAppending:!0,isLoading:!0,versions:[],viewMode:"list",isNewLatest:!1,diffData:{lhs:"",rhs:""}}}componentDidMount(){this.getVersions()}isLastPage(){return this.state.versions.find(Yt=>Yt.version===1)}render(){const{versions:Yt,viewMode:Tn,baseInfo:rn,newInfo:In,isNewLatest:cs,isLoading:ds,diffData:Gs}=this.state,js=Yt.filter(xs=>xs.checked).length===2,Ca=Yt.length>1,Aa=Yt.length>=this.limit,qs=this.props.sectionNav.node.parentItem;return Tn==="compare"?(0,t.jsxs)(l.Y,{navModel:this.props.sectionNav,pageNav:qs,children:[(0,t.jsx)(Ss.me,{onClick:this.reset,baseVersion:rn?.version,newVersion:In?.version,isNewLatest:cs}),ds?(0,t.jsx)(so,{msg:"Fetching changes\u2026"}):(0,t.jsx)(Ja,{newInfo:In,baseInfo:rn,isNewLatest:cs,diffData:Gs})]}):(0,t.jsxs)(l.Y,{navModel:this.props.sectionNav,pageNav:qs,children:[ds?(0,t.jsx)(so,{msg:"Fetching history list\u2026"}):(0,t.jsx)(Fr,{versions:Yt,onCheck:this.onCheck,canCompare:js}),this.state.isAppending&&(0,t.jsx)(so,{msg:"Fetching more entries\u2026"}),Ca&&(0,t.jsx)(Ss.rJ,{hasMore:Aa,canCompare:js,getVersions:this.getVersions,getDiff:this.getDiff,isLastPage:!!this.isLastPage()})]})}}const so=({msg:Ut})=>(0,t.jsxs)(M.Gy,{children:[(0,t.jsx)(S.y,{}),(0,t.jsx)("em",{children:Ut})]}),Zr=()=>f.Ny.partial({editview:null,editIndex:null});function mo({dashboard:Ut,editview:Yt,pageNav:Tn,sectionNav:rn}){const[In,cs]=(0,n.useState)(0);(0,n.useEffect)(()=>{Ut.events.subscribe(d.Cf,()=>cs(Rr=>Rr+1))},[Ut]);const ds=(0,n.useMemo)(()=>ao(Ut),[Ut,In]),Gs=()=>{Ut.meta.hasUnsavedFolderChange=!1},js=ds.find(Rr=>Rr.id===Yt)??ds[0],Ca=m.TP.hasEditPermissionInFolders,Aa=Ut.meta.canSave,qs=(0,i.zy)(),xs=Go(qs),Er=fo(Tn,rn,ds,js,qs,Ut.uid),fr="sm",gr=[(0,t.jsx)(a.$n,{"data-testid":r.Tp.pages.Dashboard.Settings.Actions.close,variant:"secondary",fill:"outline",size:fr,onClick:Zr,children:"Close"},"close"),Ca&&(0,t.jsx)(Jt.m,{dashboard:Ut,onSaveSuccess:Gs,variant:"secondary",size:fr},"save as"),Aa&&(0,t.jsx)(Jt.C,{dashboard:Ut,onSaveSuccess:Gs,size:fr},"Save")];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.H,{actions:(0,t.jsx)(c.U,{alignment:"right",children:gr})}),(0,t.jsx)(js.component,{sectionNav:Er,dashboard:Ut,editIndex:xs})]})}function ao(Ut){const Yt=[],Tn=(0,p.t)("dashboard-settings.general.title","General");Ut.meta.canEdit&&(Yt.push({title:Tn,id:"settings",icon:"sliders-v-alt",component:pa}),Yt.push({title:(0,p.t)("dashboard-settings.annotations.title","Annotations"),id:"annotations",icon:"comment-alt",component:It,subTitle:"Annotation queries return events that can be visualized as event markers in graphs across the dashboard."}),Yt.push({title:(0,p.t)("dashboard-settings.variables.title","Variables"),id:"templating",icon:"calculator-alt",component:ct,subTitle:"Variables can make your dashboard more dynamic and act as global filters."}),Yt.push({title:(0,p.t)("dashboard-settings.links.title","Links"),id:"links",icon:"link",component:es})),Ut.meta.canMakeEditable&&Yt.push({title:Tn,icon:"sliders-v-alt",id:"settings",component:ko}),Ut.id&&Ut.meta.canSave&&Yt.push({title:(0,p.t)("dashboard-settings.versions.title","Versions"),id:"versions",icon:"history",component:$r});const rn=(0,p.t)("dashboard-settings.permissions.title","Permissions");return Ut.id&&Ut.meta.canAdmin&&m.TP.hasPermission(y.AccessControlAction.DashboardsPermissionsRead)&&Yt.push({title:rn,id:"permissions",icon:"lock",component:Vt}),Yt.push({title:(0,p.t)("dashboard-settings.json-editor.title","JSON Model"),id:"dashboard_json",icon:"arrow",component:dr}),Yt}function Fa(Ut,Yt){return{...Ut,parentItem:Ut.parentItem?Fa(Ut.parentItem,Yt):Yt}}function fo(Ut,Yt,Tn,rn,In,cs){const ds={text:(0,p.t)("dashboard-settings.settings.title","Settings"),children:[],icon:"apps",hideFromBreadcrumbs:!1,url:s.I.getUrlForPartial(In,{editview:"settings",editIndex:null})};ds.children=Tn.map(js=>({text:js.title,icon:js.icon,id:`${cs}/${js.id}`,url:s.I.getUrlForPartial(In,{editview:js.id,editIndex:null}),active:js===rn,parentItem:ds,subTitle:js.subTitle}));const Gs=Fa(Ut,Yt.main);return ds.parentItem=Gs,{main:ds,node:ds.children.find(js=>js.active)}}function ko({dashboard:Ut,sectionNav:Yt}){return(0,t.jsx)(l.Y,{navModel:Yt,children:(0,t.jsxs)(o.B,{direction:"column",gap:2,alignItems:"flex-start",children:[(0,t.jsx)(h.E,{variant:"h3",children:"Dashboard not editable"}),(0,t.jsx)(a.$n,{type:"submit",onClick:()=>Ut.makeEditable(),children:"Make editable"})]})})}function Go(Ut){const Yt=new URLSearchParams(Ut.search).get("editIndex");if(Yt!=null)return parseInt(Yt,10)}},10740:(G,O,e)=>{"use strict";e.d(O,{n:()=>B,C:()=>N});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(55852),f=e(94753),a=e(60782),c=e(62930),o=e(56034),h=e(42418),g=e(67061),l=e(10354),p=e(14578),m=e(72109),y=e(29158);const d=({currentPage:K,numberOfPages:H,onNavigate:X,hideWhenSinglePage:k,className:Y})=>{const Z=(0,s.of)(v);return k&&H<=1?null:(0,t.jsxs)("div",{className:(0,n.cx)(Z.wrapper,Y),children:[(0,t.jsx)(y.K,{name:"angle-left",size:"md",tooltip:"Previous",onClick:()=>X(K-1),disabled:K===1}),K," of ",H,(0,t.jsx)(y.K,{name:"angle-right",size:"md",tooltip:"Next",onClick:()=>X(K+1),disabled:K===H})]})},v=K=>({wrapper:(0,n.css)({display:"flex",flexDirection:"row",gap:16,userSelect:"none"})});var u=e(16817),D=e(65418),P=e(34867),x=e(3169),E=e(3363);const C=(0,P.DW)("features.dashboards.genai");var M=(K=>(K.IDLE="idle",K.GENERATING="generating",K.COMPLETED="completed",K))(M||{});const S=1e4;function I(K=E.C4,H=1){const[X,k]=(0,i.useState)([]),[Y,Z]=(0,i.useState)(!1),[se,j]=(0,i.useState)(""),[q,ne]=(0,i.useState)("idle"),[oe,z]=(0,i.useState)(),{error:te}=(0,x._2)();let le="";const ie=(0,i.useCallback)(ee=>{ne("idle"),k([]),Z(!1),z(ee),te("Failed to generate content using OpenAI","Please try again or if the problem persists, contact your organization admin."),console.error(ee),C.logError(ee,{messages:JSON.stringify(X),model:K,temperature:String(H)})},[X,K,H,te]);(0,i.useEffect)(()=>{X.length>0&&j("")},[X]);const{error:ae,value:re}=(0,u.A)(async()=>await(0,E.QX)(),[E.QX]),{error:ce,value:me}=(0,u.A)(async()=>{if(!re||!X.length)return{enabled:re};ne("generating"),z(void 0);const ee=D.qH({model:K,temperature:H,messages:X}).pipe(D.qA());return{enabled:re,stream:ee.subscribe({next:de=>{le=de},error:ie,complete:()=>{j(le),ne("completed"),setTimeout(()=>{ne("idle")}),k([]),Z(!1),z(void 0)}})}},[X,re]);return(0,i.useEffect)(()=>()=>{me?.stream&&me.stream.unsubscribe()},[me]),(0,i.useEffect)(()=>{Y&&(me?.stream?.unsubscribe(),ne("idle"),Z(!1),z(void 0),k([]))},[Y,me?.stream]),(0,i.useEffect)(()=>{let ee;return q==="generating"&&se===""&&(ee=setTimeout(()=>{ie(new Error(`OpenAI stream timed out after ${S}ms`))},S)),()=>{ee&&clearTimeout(ee)}},[q,se,ie]),(ce||ae)&&z(ce||ae),{setMessages:k,setStopGeneration:Z,messages:X,reply:se,streamStatus:q,error:oe,value:me}}const T=({history:K,index:H,reply:X,streamStatus:k,onNavigate:Y})=>{const Z=(0,s.of)(b),se=K.length,j=()=>X&&k!==M.IDLE?X:K[H-1];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:Z.contentWrapper,children:(0,t.jsx)(f.E,{element:"p",color:"secondary",children:j()})}),(0,t.jsx)(d,{currentPage:H,numberOfPages:se,onNavigate:Y,hideWhenSinglePage:!1,className:Z.paginationWrapper})]})},b=K=>({paginationWrapper:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"flex-end",marginTop:15}),contentWrapper:(0,n.css)({display:"flex",flexBasis:"100%",flexGrow:3,whiteSpace:"pre-wrap",maxHeight:110,overflowY:"scroll",backgroundColor:K.colors.background.secondary,border:`1px solid ${K.colors.border.weak}`,padding:K.spacing(1),minHeight:60})}),R=({onSuggestionClick:K,isGenerating:H})=>{const X=(0,s.of)(A);return(0,t.jsxs)("div",{className:X.quickSuggestionsWrapper,children:[(0,t.jsx)(r.$n,{onClick:()=>K(E.HG.Shorter),size:"sm",variant:"secondary",icon:"paragraph",disabled:H,children:E.HG.Shorter}),(0,t.jsx)(r.$n,{onClick:()=>K(E.HG.MoreDescriptive),size:"sm",variant:"secondary",icon:"document-layout-left",disabled:H,children:E.HG.MoreDescriptive}),(0,t.jsx)(r.$n,{onClick:()=>K(E.HG.Regenerate),icon:"sync",size:"sm",variant:"secondary",disabled:H,children:E.HG.Regenerate})]})},A=K=>({quickSuggestionsWrapper:(0,n.css)({display:"flex",flexDirection:"row",gap:8})});var L=e(57725);const U=.5,W=({eventTrackingSrc:K,history:H,messages:X,onApplySuggestion:k,updateHistory:Y})=>{const Z=(0,s.of)(w),[se,j]=(0,i.useState)(1),[q,ne]=(0,i.useState)(!1),[oe,z]=(0,i.useState)(""),{setMessages:te,setStopGeneration:le,reply:ie,streamStatus:ae,error:re}=I(E.C4,U),ce=ae===M.GENERATING,me=(Ne,Re)=>(0,L.XX)(K,Ne,Re);(0,i.useEffect)(()=>{!ce&&ie!==""&&j(1)},[ce,ie]),(0,i.useEffect)(()=>{ae===M.COMPLETED&&Y((0,E.Kb)(ie))},[ae,ie,Y]),(0,i.useEffect)(()=>{re&&ne(!0),ae===M.GENERATING&&ne(!1)},[re,ae]);const ee=Ne=>{fe(Ne),me(L.KR.customFeedback,{customFeedback:Ne})},de=()=>{ce?(le(!0),ie!==""&&Y((0,E.Kb)(ie))):k(H[se-1])},De=Ne=>{j(Ne),me(Ne>se?L.KR.backHistoryItem:L.KR.forwardHistoryItem)},fe=Ne=>{Ne!==E.HG.Regenerate?X=[...X,...(0,E.To)(H[se-1],Ne)]:X=[...X,...(0,E.To)(H[se-1],"Please, regenerate")],te(X),Ne in E.HG&&me(L.KR.quickFeedback,{quickFeedbackItem:Ne})},Te=Ne=>Ne.key==="Enter"&&ee(oe),je=Ne=>z(Ne.currentTarget.value),He=()=>ee(oe),Be=()=>me(L.KR.linkToDocs);return(0,t.jsxs)("div",{className:Z.container,children:[q&&(0,t.jsx)(h.F,{title:"",children:(0,t.jsx)(g.B,{direction:"column",children:(0,t.jsx)("p",{children:"Sorry, I was unable to complete your request. Please try again."})})}),(0,t.jsx)(T,{history:H,index:se,onNavigate:De,reply:(0,E.Kb)(ie),streamStatus:ae}),(0,t.jsx)("div",{className:Z.actionButtons,children:(0,t.jsx)(R,{onSuggestionClick:fe,isGenerating:ce})}),(0,t.jsx)(l.p,{placeholder:"Tell AI what to do next...",suffix:(0,t.jsx)(r.$n,{icon:"enter",variant:"secondary",fill:"text","aria-label":"Send custom feedback",onClick:He,disabled:oe==="",children:"Send"}),value:oe,onChange:je,onKeyDown:Te}),(0,t.jsx)("div",{className:Z.applySuggestion,children:(0,t.jsx)(g.B,{justifyContent:"flex-end",direction:"row",children:(0,t.jsx)(r.$n,{icon:ce?"fa fa-spinner":"check",onClick:de,children:ce?N:"Apply"})})}),(0,t.jsxs)("div",{className:Z.footer,children:[(0,t.jsx)(p.I,{name:"exclamation-circle","aria-label":"exclamation-circle",className:Z.infoColor}),(0,t.jsxs)(f.E,{variant:"bodySmall",color:"secondary",children:["This content is AI-generated using the"," ",(0,t.jsx)(m.Y,{variant:"bodySmall",inline:!0,href:"https://grafana.com/docs/grafana-cloud/alerting-and-irm/machine-learning/llm-plugin/",external:!0,onClick:Be,children:"Grafana LLM plugin"})]})]})]})},w=K=>({container:(0,n.css)({display:"flex",flexDirection:"column",width:520,maxHeight:350,paddingBottom:25}),applySuggestion:(0,n.css)({paddingTop:K.spacing(2)}),actions:(0,n.css)({display:"flex",flexDirection:"row",flexWrap:"wrap"}),footer:(0,n.css)({position:"absolute",bottom:0,left:0,width:"100%",display:"flex",flexDirection:"row",margin:0,padding:K.spacing(1),paddingLeft:K.spacing(2),alignItems:"center",gap:K.spacing(1),borderTop:`1px solid ${K.colors.border.weak}`,marginTop:K.spacing(2)}),infoColor:(0,n.css)({color:K.colors.info.main}),actionButtons:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",padding:"24px 0 8px 0"})}),N="Stop generating",B=({text:K="Auto-generate",toggleTipTitle:H="",onClick:X,model:k=E.C4,messages:Y,onGenerate:Z,temperature:se=1,eventTrackingSrc:j,disabled:q,tooltip:ne})=>{const oe=(0,s.of)(V),{setMessages:z,setStopGeneration:te,reply:le,value:ie,error:ae,streamStatus:re}=I(k,se),[ce,me]=(0,i.useState)([]),[ee,de]=(0,i.useState)(!1),De=ce.length>0,fe=re===M.GENERATING,Te=!De,je=q||ie&&!ie.enabled&&!ae,He=xt=>(0,L.XX)(j,xt),Be=ae||ne?void 0:!1,Ne=ae?"Failed to generate content using OpenAI. Please try again or if the problem persists, contact your organization admin.":ne||"",Re=xt=>{re===M.GENERATING?te(!0):De?de(!0):(X?.(xt),z(st()));const ot=ae?L.KR.erroredRetryButton:fe?L.KR.stopGenerationButton:Te?L.KR.autoGenerateButton:L.KR.improveButton;He(ot)},Se=(0,i.useCallback)(xt=>{ce.indexOf(xt)===-1&&me([xt,...ce])},[ce]);if((0,i.useEffect)(()=>{re===M.COMPLETED&&le&&Z((0,E.Kb)(le))},[re,le,Z]),(0,i.useEffect)(()=>{re===M.COMPLETED&&Se((0,E.Kb)(le))},[ce,re,le,Se]),!ie?.enabled)return null;const We=xt=>{He(L.KR.applySuggestion),Z(xt),de(!1)},Ke=()=>{if(!fe)return ae||ie&&!ie?.enabled?"exclamation-circle":"ai"},Xe=()=>{let xt=K;return ae&&(xt="Retry"),fe&&(xt=N),De&&(xt="Improve"),xt},Je=(0,t.jsx)(r.$n,{icon:Ke(),onClick:Re,fill:"text",size:"sm",disabled:je,variant:ae?"destructive":"primary",children:Xe()}),st=()=>typeof Y=="function"?Y():Y,pt=()=>{if(De){const xt=(0,t.jsx)(f.E,{element:"p",children:H});return(0,t.jsx)(a.G,{title:xt,content:(0,t.jsx)(W,{history:ce,messages:st(),onApplySuggestion:We,updateHistory:Se,eventTrackingSrc:j}),placement:"left-start",fitContent:!0,show:ee,onClose:()=>de(!1),onOpen:()=>de(!0),children:Je})}return Je};return(0,t.jsxs)("div",{className:oe.wrapper,children:[fe&&(0,t.jsx)(c.y,{size:"sm",className:oe.spinner}),Te?(0,t.jsx)(o.m,{show:Be,interactive:!0,content:Ne,children:Je}):pt()]})},V=K=>({wrapper:(0,n.css)({display:"flex"}),spinner:(0,n.css)({color:K.colors.text.link})})},81394:(G,O,e)=>{"use strict";e.d(O,{V:()=>c});var t=e(74848),n=e(14792),i=e(10740),s=e(57725),r=e(3363);const a=`You are an expert in creating Grafana Dashboards.
Your goal is to write a descriptive and concise dashboard description.
You will be given the title and description of the dashboard's panels.
The dashboard description is meant to explain the purpose of the dashboard and what its panels show.
If the dashboard has no panels, the description should be "Empty dashboard"
There should be no numbers in the description except where they are important.
The dashboard description should not have the dashboard title or any quotation marks in it.
The description should be, at most, 300 characters.
Respond with only the description of the dashboard.`,c=({onGenerate:h})=>{const g=(0,n.UA)().getCurrent(),l=(0,r.N3)(g);return(0,t.jsx)(i.n,{messages:o(g),onGenerate:h,eventTrackingSrc:s.ec.dashboardDescription,toggleTipTitle:"Improve your dashboard description",disabled:l.length===0,tooltip:l.length===0?r.ZN:void 0})};function o(h){return[{content:a,role:r.Xh.system},{content:`The title of the dashboard is "${h.title}"
${(0,r.BB)(h)}`,role:r.Xh.user}]}},27966:(G,O,e)=>{"use strict";e.d(O,{Z:()=>c});var t=e(74848),n=e(14792),i=e(10740),s=e(57725),r=e(3363);const a=`You are an expert in creating Grafana Dashboards.
Your goal is to write a concise dashboard title.
You will be given the title and description of the dashboard's panels.
The dashboard title is meant to say what it shows on one line for users to navigate to it.
If the dashboard has no panels, the title should be "Empty dashboard"
There should be no numbers in the title.
The dashboard title should not have quotation marks in it.
The title should be, at most, 50 characters.
Respond with only the title of the dashboard.`,c=({onGenerate:h})=>{const g=(0,n.UA)().getCurrent(),l=(0,r.N3)(g);return(0,t.jsx)(i.n,{messages:o(g),onGenerate:h,eventTrackingSrc:s.ec.dashboardTitle,toggleTipTitle:"Improve your dashboard title",disabled:l.length===0,tooltip:l.length===0?r.ZN:void 0})};function o(h){return[{content:a,role:r.Xh.system},{content:`The panels in the dashboard are: ${(0,r.BB)(h)}`,role:r.Xh.user}]}},20214:(G,O,e)=>{"use strict";e.d(O,{t:()=>c});var t=e(74848),n=e(14792),i=e(10740),s=e(57725),r=e(3363);const a=`You are an expert in creating Grafana Panels.
You will be given the title and description of the dashboard the panel is in as well as the JSON for the panel.
Your goal is to write a descriptive and concise panel description.
The panel description is meant to explain the purpose of the panel, not just its attributes.
Do not refer to the panel; simply describe its purpose.
There should be no numbers in the description except for thresholds.
The description should be, at most, 200 characters.`,c=({onGenerate:h,panel:g})=>(0,t.jsx)(i.n,{messages:()=>o(g),onGenerate:h,eventTrackingSrc:s.ec.panelDescription,toggleTipTitle:"Improve your panel description"});function o(h){const g=(0,n.UA)().getCurrent(),l=(0,r.hn)(h);return[{content:a,role:r.Xh.system},{content:`The panel is part of a dashboard with the title: ${g.title}
The panel is part of a dashboard with the description: ${g.description}
This is the JSON which defines the panel: ${l}`,role:r.Xh.user}]}},74410:(G,O,e)=>{"use strict";e.d(O,{h:()=>a});var t=e(74848),n=e(10740),i=e(57725),s=e(3363);const f="You are an expert in creating Grafana Panels.Your goal is to write short, descriptive, and concise panel title.The title should be shorter than 50 characters.",a=({onGenerate:o,panel:h,dashboard:g})=>(0,t.jsx)(n.n,{messages:()=>c(h,g),onGenerate:o,eventTrackingSrc:i.ec.panelTitle,toggleTipTitle:"Improve your panel title"});function c(o,h){const g=(0,s.hn)(o);return[{content:f,role:s.Xh.system},{content:`The panel is part of a dashboard with the title: ${h.title}
The panel is part of a dashboard with the description: ${h.description}
Use this JSON object which defines the panel: ${g}`,role:s.Xh.user}]}},57725:(G,O,e)=>{"use strict";e.d(O,{KR:()=>s,XX:()=>r,ec:()=>i});var t=e(14110);const n="dashboards_autogenerate_clicked";var i=(f=>(f.panelDescription="panel-description",f.panelTitle="panel-title",f.dashboardChanges="dashboard-changes",f.dashboardTitle="dashboard-title",f.dashboardDescription="dashboard-description",f.unknown="unknown",f))(i||{}),s=(f=>(f.autoGenerateButton="auto-generate-button",f.erroredRetryButton="errored-retry-button",f.stopGenerationButton="stop-generating-button",f.improveButton="improve-button",f.backHistoryItem="back-history-item",f.forwardHistoryItem="forward-history-item",f.quickFeedback="quick-feedback",f.linkToDocs="link-to-docs",f.customFeedback="custom-feedback",f.applySuggestion="apply-suggestion",f))(s||{});function r(f,a,c){(0,t.rR)(n,{src:f,item:a,...c})}},3363:(G,O,e)=>{"use strict";e.d(O,{ZN:()=>I,C4:()=>u,HG:()=>v,Xh:()=>d,Yy:()=>P,BB:()=>M,To:()=>C,hn:()=>S,N3:()=>T,QX:()=>E,Kb:()=>D});var t=e(2543),n=e(65418),i=e(32264),s=e(36974),r=e(90254),f=e(34214);function a(R,A){return R===A?A:Array.isArray(R)&&Array.isArray(A)?h(R,A):c(R)&&c(A)?o(R,A):A}function c(R){return typeof R=="object"&&!Array.isArray(R)&&R!==null}function o(R,A){const L=Object.keys(R),U={};for(const W of L)A.hasOwnProperty(W)&&(Array.isArray(R[W])&&Array.isArray(A[W])||typeof R[W]=="object"&&typeof A[W]=="object"?U[W]=a(R[W],A[W]):U[W]=A[W]);return U}function h(R,A){const L=new Array(R.length).fill(void 0),U=new Set([...Array(R.length).keys()]),W=new Set([...Array(A.length).keys()]);for(let w=0;w<R.length&&W.size!==0;w++){let N=R[w];for(let B=0;B<A.length;B++){if(!W.has(B))continue;let V=A[B];V=a(N,V),JSON.stringify(N)===JSON.stringify(V)&&(U.delete(w),W.delete(B),L[w]=V)}}return g(R,A,L,U,W),L.filter(w=>w!==void 0)}function g(R,A,L,U,W){let w={};W.forEach(B=>{let V=A[B];if(typeof V!="object"||Array.isArray(V)){L.push(V),W.delete(B);return}U.forEach(K=>{let H=R[K];if(typeof H!="object"||Array.isArray(H)){U.delete(K);return}let X=0;for(const k in H){let Y=H[k];if(!V.hasOwnProperty(k))continue;let Z=V[k];typeof Y!="string"&&typeof Y!="number"||typeof Y!=typeof Z||Y===Z&&(k==="id"&&(X+=1e3),X++)}X!==0&&(w[X]===void 0&&(w[X]=[]),w[X].push([K,B]))})});const N=Object.keys(w).map(Number);N.sort((B,V)=>V-B);for(const B of N){let V=w[B];for(const K of V){const[H,X]=K;U.has(H)&&W.has(X)&&(L[H]=A[X],U.delete(H),W.delete(X))}}for(const B of W)L.push(A[B])}function l(R){const A=R.split(`
`);let L=R[0].startsWith("Index")?4:3,U=A.slice(0,L);const W=/("title"|Title|\{|\}|\[|\])/i;for(let w=L;w<A.length;w++){let N=A[w];(W.test(N)||N.startsWith("+")||N.startsWith("-"))&&U.push(N)}return U.join(`
`)+`
`}function p(R){if(R===null||R==="")return null;if(Array.isArray(R)){const L=R.map(U=>p(U)).filter(U=>U!==null);return L.length>0?L:null}if(typeof R!="object")return R;const A={};for(const L in R){const U=p(R[L]);if(U!==null){if(Array.isArray(U)&&U.length===0||typeof U=="object"&&Object.keys(U).length===0)continue;A[L]=U}}return Object.keys(A).length>0?A:null}function m(R){return JSON.parse(JSON.stringify(R,null,2))}function y(R){let A=m(R.getOriginalDashboard()),L=m(new f.G(A).getSaveModelClone()),U=m(R.getSaveModelClone());L=p(a(A,L)),U=p(a(L,U)),A=p(A);let W=(0,r.ss)("Before migration changes","After migration changes",JSON.stringify(A,null,2),JSON.stringify(L,null,2),"","",{context:20}),w=(0,r.ss)("Before user changes","After user changes",JSON.stringify(L,null,2),JSON.stringify(U,null,2),"","",{context:20});return W=l(W),w=l(w),{migrationDiff:W,userDiff:w}}var d=(R=>(R.system="system",R.user="user",R))(d||{}),v=(R=>(R.Shorter="Even shorter",R.MoreDescriptive="More descriptive",R.Regenerate="Regenerate",R))(v||{});const u="gpt-4",D=R=>R.replace(/^"|"$/g,"");function P(R){const{migrationDiff:A,userDiff:L}=y(R);return{userChanges:L,migrationChanges:A}}let x;async function E(){return i.$.apps["grafana-llm-app"]?x||(x=new Promise(R=>{n.vK().then(A=>{A.ok||(x=void 0),R(A.ok)})}),x):!1}const C=(R,A)=>[{role:"system",content:`Your previous response was: ${R}. The user has provided the following feedback: ${A}. Re-generate your response according to the provided feedback.`}];function M(R){const A=T(R);let L;if(A.length<=10)L=`The panels in the dashboard are:
${A.join(`
`)}`;else{const U=R.panels.filter(N=>N.description),W=R.panels.filter(N=>!N.description);let w;U.length>=10?w=U.slice(10).map(b).join(`
`):(w=U.map(b).join(`
`),w+=`
`,w+=W.slice(10-U.length).map(b).join("n")),L=`There are ${A.length} panels.
Due to space constraints, only the information for ten of them is presented.
These ten are not necessarily the first ten, but prioritized to those with descriptions.
The panels in the dashboard are:
${w}`}return L}function S(R){const A=["datasource","title","description","targets","type"],L={...(0,t.pick)(R,A),options:(0,t.pick)(R.options,["content"])};return JSON.stringify(L,null,2)}const I="To generate this content your dashboard must contain at least one panel with a valid title or description.";function T(R){return R.panels.filter(L=>L.title.length>0&&L.title!==s.LH||L.description&&L.description.length>0).map(b)}const b=(R,A)=>`- Panel ${A}
- Title: ${R.title}${R.description?`
- Description: ${R.description}`:""}`},18803:(G,O,e)=>{"use strict";e.d(O,{B6:()=>g,E_:()=>p,jD:()=>l});var t=e(2543),n=e.n(t),i=e(72985),s=e(89667),r=e(52622),f=e(72724),a=e(39070),c=e(32264),o=e(41524),h=e(68706);function g(u){const D=[];if(u?.series)for(const P of u.series)D.push((0,s.Nw)(P));if(u?.annotations)for(const P of u.annotations){const x=(0,s.Nw)(P);x.schema?.meta||(x.schema.meta={}),x.schema.meta.dataTopic=r.QR.Annotations,D.push(x)}return D}function l(u,D){const P=u.getSaveModel(),x={panelType:P.type,datasource:"??"},E=c.$.buildInfo.versionString;let C=`| Key | Value |
|--|--|
| Panel | ${x.panelType} @ ${P.pluginVersion??E} |
| Grafana | ${E} // ${c.$.buildInfo.edition} |
`;return D&&(C+="<details><summary>Panel debug snapshot dashboard</summary>\n\n```json\n"+D+"\n```\n</details>"),C}async function p(u,D,P){const x=u.getSaveModel(),E=(0,t.cloneDeep)(v),C={panelType:x.type,datasource:"??"},M=await(0,i._)(u.getQueryRunner().getData({withFieldConfig:!1,withTransforms:!1})),S=u.datasource,I=(0,o.W)(g(M),D),T=c.$.buildInfo.versionString,b=x?.targets??[],R=`<table width="100%">
    <tr>
      <th width="2%">Panel</th>
      <td >${C.panelType} @ ${x.pluginVersion??T}</td>
    </tr>
    <tr>
      <th>Queries</th>
      <td>${b.map(A=>{const L=A.datasource??S;return`${A.refId}[${L?.type}]`}).join(", ")}</td>
    </tr>
    ${m(x)}
    ${y(M,I)}
    ${d(M)}
    <tr>
      <th>Grafana</th>
      <td>${T} // ${c.$.buildInfo.edition}</td>
    </tr>
  </table>`.trim();if(E.panels[0]={...x,...E.panels[0],targets:[{refId:"A",datasource:{type:"grafana",uid:"grafana"},queryType:h.nj.Snapshot,snapshot:I}]},x.transformations?.length){const A=E.panels[E.panels.length-1];A.title=A.title+" (after transformations)";const L=(0,t.cloneDeep)(A);L.id=100,L.title="Data (before transformations)",L.gridPos.w=24,L.targets[0].withTransforms=!1,E.panels.push(L)}return M.annotations?.length&&E.panels.push({id:7,gridPos:{h:6,w:24,x:0,y:20},type:"table",title:"Annotations",datasource:{type:"datasource",uid:"-- Dashboard --"},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,topic:r.QR.Annotations,refId:"A"}]}),E.panels[1].options.content=R,E.panels[2].options.content=JSON.stringify(x,null,2),E.title=`Debug: ${x.title} // ${(0,f.LE)(new Date)}`,E.tags=["debug",`debug-${C.panelType}`],E.time={from:P.from.toISOString(),to:P.to.toISOString()},E}function m(u){return u.transformations?`<tr>
      <th>Transform</th>
      <td>${u.transformations.map(D=>D.id).join(", ")}</td>
  </tr>`:""}function y(u,D){let P=u.series.length??0,x=0,E=0;for(const C of u.series)x+=C.fields.length,E+=C.length;return`<tr><th>Data</th><td>${u.state!==a.Gu.Done?u.state:""} ${P} frames, ${x} fields, ${E} rows </td></tr>`}function d(u){return u.annotations?.length?`<tr>
  <th>Annotations</th>
  <td>${u.annotations.map((D,P)=>`<span>${D.length}</span>`)}</td>
</tr>`:""}const v={panels:[{id:2,title:"Reproduced with embedded data",datasource:{type:"grafana",uid:"grafana"},gridPos:{h:13,w:15,x:0,y:0}},{gridPos:{h:7,w:9,x:15,y:0},id:5,options:{content:"...",mode:"html"},title:"Debug info",type:"text"},{id:6,title:"Original Panel JSON",type:"text",gridPos:{h:13,w:9,x:15,y:7},options:{content:"...",mode:"code",code:{language:"json",showLineNumbers:!0,showMiniMap:!0}}},{id:3,title:"Data from panel above",type:"table",datasource:{type:"datasource",uid:"-- Dashboard --"},gridPos:{h:7,w:15,x:0,y:13},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,refId:"A"}]}],schemaVersion:37}},65123:(G,O,e)=>{"use strict";e.d(O,{BN:()=>c,kx:()=>o,sd:()=>a});var t=e(96540),n=e(24705),i=e(19347),s=e(8484),r=e(16560),f=e(54612);const a=h=>(0,n.A)(async()=>c(h),[h]).value;async function c(h){const g=h?.request?.targets||[];if(h&&h.series&&g.length){for(const l of h.series)if(l.meta&&l.meta.custom){const p=await(0,i.l)().get(g[0].datasource);if(p&&p.components?.MetadataInspector)return p}}}const o=(h,g,l,p,m)=>(0,t.useMemo)(()=>{const y=[];return(0,f.$)(l)&&(y.push({label:(0,s.t)("dashboard.inspect.data-tab","Data"),value:r.q.Data}),y.push({label:(0,s.t)("dashboard.inspect.stats-tab","Stats"),value:r.q.Stats})),m&&y.push({label:(0,s.t)("dashboard.inspect.meta-tab","Meta data"),value:r.q.Meta}),y.push({label:(0,s.t)("dashboard.inspect.json-tab","JSON"),value:r.q.JSON}),p&&y.push({label:(0,s.t)("dashboard.inspect.error-tab","Error"),value:r.q.Error}),g.meta.canEdit&&(0,f.$)(l)&&y.push({label:(0,s.t)("dashboard.inspect.query-tab","Query"),value:r.q.Query}),y},[l,m,g,p])},57755:(G,O,e)=>{"use strict";e.d(O,{D:()=>l});var t=e(74848),n=e(32196),i=e(96540),s=e(78685),r=e(13544),f=e(53402),a=e(40845),c=e(55852),o=e(83277),h=e(53466);const g="showCategory",l=i.memo(({id:y,title:d,children:v,forceOpen:u,isOpenDefault:D=!0,renderTitle:P,className:x,itemsCount:E,isNested:C=!1,sandboxId:M})=>{const[S,I]=(0,s.A)(m(y),{isExpanded:D}),[T,b]=(0,i.useState)(S?.isExpanded??D),R=(0,i.useRef)(0),A=(0,i.useRef)(null),[L,U]=(0,o.s)(),W=L[g]===y;(0,i.useEffect)(()=>{R.current&&Date.now()-R.current<200||(W||u)&&(T||b(!0),W&&A.current?.scrollIntoView())},[u,T,W]);const w=(0,i.useCallback)(()=>{R.current=Date.now(),U({[g]:T?void 0:y},!0),I({isExpanded:!T}),b(!T)},[I,b,U,T,y]);P||(P=function(X){return X||E===void 0||E===0?d:(0,t.jsxs)("span",{children:[d," ",(0,t.jsx)(f.p,{value:E})]})});const N=(0,a.of)(p),B=(0,n.cx)({[N.box]:!0,[N.boxNestedExpanded]:C&&T},x),V=(0,n.cx)(N.header,{[N.headerExpanded]:T,[N.headerNested]:C}),K=(0,n.cx)(N.body,{[N.bodyNested]:C});return(0,t.jsxs)("div",{className:B,"data-plugin-sandbox":M,"data-testid":r.Tp.components.OptionsGroup.group(y),ref:A,children:[(0,t.jsxs)("div",{className:V,onClick:w,children:[(0,t.jsx)(c.$n,{"data-testid":r.Tp.components.OptionsGroup.toggle(y),type:"button",fill:"text",size:"sm",variant:"secondary","aria-expanded":T,className:N.toggleButton,icon:T?"angle-down":"angle-right",onClick:w}),(0,t.jsx)("h6",{id:`button-${y}`,className:N.title,children:P(T)})]}),T&&(0,t.jsx)("div",{className:K,id:y,"aria-labelledby":`button-${y}`,children:v})]})});l.displayName="OptionsPaneCategory";const p=y=>({box:(0,n.css)({borderTop:`1px solid ${y.colors.border.weak}`}),boxNestedExpanded:(0,n.css)({marginBottom:y.spacing(2)}),title:(0,n.css)({flexGrow:1,overflow:"hidden",lineHeight:1.5,fontSize:"1rem",paddingLeft:"6px",fontWeight:y.typography.fontWeightMedium,margin:0}),header:(0,n.css)({display:"flex",cursor:"pointer",alignItems:"center",padding:y.spacing(.5),color:y.colors.text.primary,fontWeight:y.typography.fontWeightMedium,"&:hover":{background:y.colors.emphasize(y.colors.background.primary,.03)}}),toggleButton:(0,n.css)({alignSelf:"baseline"}),headerExpanded:(0,n.css)({color:y.colors.text.primary}),headerNested:(0,n.css)({padding:y.spacing(.5,0,.5,0)}),body:(0,n.css)({padding:y.spacing(1,2,1,4)}),bodyNested:(0,n.css)({position:"relative",paddingRight:0,"&:before":{content:"''",position:"absolute",top:0,left:"8px",width:"1px",height:"100%",background:y.colors.border.weak}})}),m=y=>`${h.wi}.optionGroup[${y}]`},48192:(G,O,e)=>{"use strict";e.d(O,{C:()=>i});var t=e(74848),n=e(57755);class i{constructor(r){this.props=r,this.items=[],this.categories=[]}addItem(r){return r.parent=this,this.items.push(r),this}addCategory(r){return r.props.isNested=!0,r.parent=this,this.categories.push(r),this}getCategory(r){let f=this.categories.find(a=>a.props.id===r);return f||(f=new i({title:r,id:r}),this.addCategory(f)),f}render(r){return this.props.customRender?this.props.customRender():(0,t.jsxs)(n.D,{...this.props,children:[this.items.map(f=>f.render(r)),this.categories.map(f=>f.render(r))]},this.props.title)}}},74097:(G,O,e)=>{"use strict";e.d(O,{v:()=>l});var t=e(74848),n=e(32196),i=e(23257),s=e.n(i),r=e(13544),f=e(60029),a=e(88575),c=e(40845),o=e(56034);function h({overrides:y}){const d=(0,c.of)(g);return(0,t.jsx)("div",{className:d.wrapper,children:y.map((v,u)=>(0,t.jsx)(o.m,{content:v.tooltip,placement:"top",children:(0,t.jsx)("div",{"aria-label":v.description,className:d[v.type]})},u.toString()))})}const g=y=>{const d={width:8,height:8,borderRadius:y.shape.radius.circle,marginLeft:y.spacing(1),top:"-1px"};return{wrapper:(0,n.css)({display:"flex"}),rule:(0,n.css)({...d,position:"relative",backgroundColor:y.colors.primary.main}),data:(0,n.css)({...d,position:"relative",backgroundColor:y.colors.warning.main})}};class l{constructor(d){this.props=d}getLabel(d){const{title:v,description:u,overrides:D,addon:P}=this.props;if(!d)return this.parent.props.title===v&&!D?.length?null:(0,t.jsx)(p,{title:v,description:u,overrides:D,addon:P});const x=[];return this.parent.parent&&x.push(this.highlightWord(this.parent.parent.props.title,d)),this.parent.props.title!==v&&x.push(this.highlightWord(this.parent.props.title,d)),(0,t.jsxs)(f.J,{description:u&&this.highlightWord(u,d),category:x,children:[this.highlightWord(v,d),D&&D.length>0&&(0,t.jsx)(h,{overrides:D})]})}highlightWord(d,v){return(0,t.jsx)(s(),{textToHighlight:d,searchWords:[v],highlightClassName:"search-fragment-highlight"})}renderOverrides(){const{overrides:d}=this.props;!d||d.length}render(d){const{title:v,description:u,render:D,showIf:P,skipField:x}=this.props,E=`${this.parent.props.id} ${v}`;return P&&!P()?null:x?D():(0,t.jsx)(a.D,{label:this.getLabel(d),description:u,"aria-label":r.Tp.components.PanelEditor.OptionsPane.fieldLabel(E),children:D()},E)}}function p({title:y,description:d,overrides:v,addon:u}){const D=(0,c.of)(m);return(0,t.jsxs)("div",{className:D.container,children:[(0,t.jsxs)(f.J,{description:d,children:[y,v&&v.length>0&&(0,t.jsx)(h,{overrides:v})]}),u]})}function m(y){return{container:(0,n.css)({display:"flex",justifyContent:"space-between"})}}},26443:(G,O,e)=>{"use strict";e.d(O,{gs:()=>ne,Ff:()=>j,Po:()=>oe});var t=e(74848),n=e(32196),i=e(96540),s=e(32264),r=e(40845),f=e(67647),a=e(94354),c=e(40276),o=e(74106),h=e(82792),g=e(71468),l=e(7376),p=e(79971),m=e(40334),y=e(33390);function d(te,le){y.A.set(`panel-edit-section-${te}`,le?"true":"false")}function v(te,le){return y.A.getBool(`panel-edit-section-${te}`,le)}const u=(te,le)=>({angularPanelComponent:(0,m.U)(te,le.panel)?.angularComponent}),D={changePanelPlugin:p.gW},P=(0,g.connect)(u,D);class x extends i.PureComponent{constructor(le){super(le)}componentDidMount(){this.loadAngularOptions()}componentDidUpdate(le){(this.props.plugin!==le.plugin||this.props.angularPanelComponent!==le.angularPanelComponent)&&this.cleanUpAngularOptions(),this.loadAngularOptions()}componentWillUnmount(){this.cleanUpAngularOptions()}cleanUpAngularOptions(){this.angularOptions&&(this.angularOptions.destroy(),this.angularOptions=null)}loadAngularOptions(){const{panel:le,angularPanelComponent:ie,changePanelPlugin:ae}=this.props;if(!this.element||!ie||this.angularOptions)return;const re=ie.getScope();if(!re.$$childHead){setTimeout(()=>{this.forceUpdate()});return}const ce=re.$$childHead.ctrl;ce.initEditMode(),ce.onPluginTypeChange=De=>{ae({panel:le,pluginId:De.id})};let me="";for(let De=0;De<ce.editorTabs.length;De++){const fe=ce.editorTabs[De];fe.isOpen=v(fe.title,De===0),me+=`
      <div class="panel-options-group" ng-cloak>
        <div class="panel-options-group__header" ng-click="toggleOptionGroup(${De})" aria-label="${fe.title} section">
          <div class="panel-options-group__icon">
            <icon name="ctrl.editorTabs[${De}].isOpen ? 'angle-down' : 'angle-right'"></icon>
          </div>
          <div class="panel-options-group__title">${fe.title}</div>
        </div>
        <div class="panel-options-group__body" ng-if="ctrl.editorTabs[${De}].isOpen">
          <panel-editor-tab editor-tab="ctrl.editorTabs[${De}]" ctrl="ctrl"></panel-editor-tab>
        </div>
      </div>
      `}const ee=(0,l.E)(),de={ctrl:ce,toggleOptionGroup:De=>{const fe=ce.editorTabs[De];fe.isOpen=!fe.isOpen,d(fe.title,!!fe.isOpen)}};this.angularOptions=ee.load(this.element,de,me),this.angularOptions.digest()}render(){return(0,t.jsx)("div",{ref:le=>this.element=le})}}const E=(0,g.connect)(u,D)(x);var C=e(57755),M=e(22290),S=e(10354);const I=({panel:te,formatDate:le})=>{const ie=(0,r.of)(T),ae=te.libraryPanel?.meta;return ae?(0,t.jsxs)("div",{className:ie.info,children:[(0,t.jsxs)("div",{className:ie.libraryPanelInfo,children:[`Used on ${ae.connectedDashboards} `,ae.connectedDashboards===1?"dashboard":"dashboards"]}),(0,t.jsxs)("div",{className:ie.libraryPanelInfo,children:["Last edited on ",le?.(ae.updated,"L")??ae.updated," by",ae.updatedBy.avatarUrl&&(0,t.jsx)("img",{width:"22",height:"22",className:ie.userAvatar,src:ae.updatedBy.avatarUrl,alt:`Avatar for ${ae.updatedBy.name}`}),ae.updatedBy.name]})]}):null},T=te=>({info:(0,n.css)`
      line-height: 1;
    `,libraryPanelInfo:(0,n.css)`
      color: ${te.colors.text.secondary};
      font-size: ${te.typography.bodySmall.fontSize};
    `,userAvatar:(0,n.css)`
      border-radius: ${te.shape.radius.circle};
      box-sizing: content-box;
      width: 22px;
      height: 22px;
      padding-left: ${te.spacing(1)};
      padding-right: ${te.spacing(1)};
    `});var b=e(48192),R=e(74097);function A(te){const{panel:le,onPanelConfigChange:ie,dashboard:ae}=te,re=new b.C({title:"Library panel options",id:"Library panel options",isOpenDefault:!0});return(0,h.X)(le)&&re.addItem(new R.v({title:"Name",value:le.libraryPanel.name,popularRank:1,render:function(){return(0,t.jsx)(S.p,{id:"LibraryPanelFrameName",defaultValue:le.libraryPanel.name,onBlur:me=>ie("libraryPanel",{...le.libraryPanel,name:me.currentTarget.value})})}})).addItem(new R.v({title:"Information",render:function(){return(0,t.jsx)(I,{panel:le,formatDate:ae.formatDate})}})),re}var L=e(13544),U=e(21744),W=e(15292),w=e(64919),N=e(90182),B=e(6923),V=e(20214),K=e(74410),H=e(92378);function X(te){const{dashboard:le,panel:ie,onPanelConfigChange:ae}=te,re=new b.C({title:"Panel options",id:"Panel options",isOpenDefault:!0}),ce=ee=>{const de=document.getElementById("PanelFrameTitle");de instanceof HTMLInputElement&&(de.value=ee,ae("title",ee))},me=ee=>{const de=document.getElementById("description-text-area");de instanceof HTMLTextAreaElement&&(de.value=ee,ae("description",ee))};return re.addItem(new R.v({title:"Title",value:ie.title,popularRank:1,render:function(){return(0,t.jsx)(S.p,{"data-testid":L.Tp.components.PanelEditor.OptionsPane.fieldInput("Title"),id:"PanelFrameTitle",defaultValue:ie.title,onBlur:de=>ae("title",de.currentTarget.value)})},addon:s.$.featureToggles.dashgpt&&(0,t.jsx)(K.h,{onGenerate:ce,panel:ie.getSaveModel(),dashboard:le.getSaveModelClone()})})).addItem(new R.v({title:"Description",description:ie.description,value:ie.description,render:function(){return(0,t.jsx)(U.f,{"data-testid":L.Tp.components.PanelEditor.OptionsPane.fieldInput("Description"),id:"description-text-area",defaultValue:ie.description,onBlur:de=>ae("description",de.currentTarget.value)})},addon:s.$.featureToggles.dashgpt&&(0,t.jsx)(V.t,{onGenerate:me,panel:ie.getSaveModel()})})).addItem(new R.v({title:"Transparent background",render:function(){return(0,t.jsx)(W.d,{"data-testid":L.Tp.components.PanelEditor.OptionsPane.fieldInput("Transparent background"),value:ie.transparent,id:"transparent-background",onChange:de=>ae("transparent",de.currentTarget.checked)})}})).addCategory(new b.C({title:"Panel links",id:"Panel links",isOpenDefault:!1,itemsCount:ie.links?.length}).addItem(new R.v({title:"Panel links",render:function(){return(0,t.jsx)(w.e,{links:ie.links,onChange:de=>ae("links",de),getSuggestions:B.Fq,data:[]})}}))).addCategory(new b.C({title:"Repeat options",id:"Repeat options",isOpenDefault:!1}).addItem(new R.v({title:"Repeat by variable",description:"Repeat this panel for each value in the selected variable. This is not visible while in edit mode. You need to go back to dashboard and then update the variable or reload the dashboard.",render:function(){return(0,t.jsx)(H.G,{id:"repeat-by-variable-select",repeat:ie.repeat,onChange:de=>{ae("repeat",de)}})}})).addItem(new R.v({title:"Repeat direction",showIf:()=>!!ie.repeat,render:function(){const de=[{label:"Horizontal",value:"h"},{label:"Vertical",value:"v"}];return(0,t.jsx)(a.z,{options:de,value:ie.repeatDirection||"h",onChange:De=>ae("repeatDirection",De)})}})).addItem(new R.v({title:"Max per row",showIf:()=>!!(ie.repeat&&ie.repeatDirection==="h"),render:function(){const de=[2,3,4,6,8,12].map(De=>({label:De.toString(),value:De}));return(0,t.jsx)(N.l6,{options:de,value:ie.maxPerRow,onChange:De=>ae("maxPerRow",De.value)})}})))}var k=e(66211);class Y{constructor(le,ie){this.categories=le,this.overrides=ie}search(le){const ie=new RegExp(le,"i"),re=this.collectHits(this.categories,ie,[]).sort(Z).map(ee=>ee.item),me=this.collectHits(this.overrides,ie,[]).sort(Z).map(ee=>ee.item);return{optionHits:re,overrideHits:this.buildOverrideHitCategories(me),totalCount:this.getAllOptionsCount(this.categories)}}collectHits(le,ie,ae){for(const re of le){const ce=ie.test(re.props.title);for(const me of re.items){if(ie.test(me.props.title)){ae.push({item:me,rank:1});continue}if(me.props.description&&ie.test(me.props.description)){ae.push({item:me,rank:2});continue}ce&&ae.push({item:me,rank:3})}re.categories.length>0&&this.collectHits(re.categories,ie,ae)}return ae}getAllOptionsCount(le){let ie=0;for(const ae of le)ie+=ae.items.length,ae.categories.length>0&&(ie+=this.getAllOptionsCount(ae.categories));return ie}buildOverrideHitCategories(le){const ie={};for(const ae of le){let re=ie[ae.parent.props.title];re||(re=ie[ae.parent.props.title]=new b.C(ae.parent.props),re.addItem(ae.parent.items[0])),re.items[0].props.title!==ae.props.title&&re.addItem(ae)}return Object.values(ie)}}function Z(te,le){return te.rank-le.rank}function se(te){const le=[];for(const ie of te)for(const ae of ie.items)ae.props.title==="Unit"&&(ae.props.popularRank=2),ae.props.title==="Min"&&(ae.props.popularRank=3),ae.props.title==="Max"&&(ae.props.popularRank=4),ae.props.title==="Display name"&&(ae.props.popularRank=5),ae.props.popularRank&&le.push(ae);return le.sort((ie,ae)=>ie.props.popularRank-ae.props.popularRank)}const j=te=>{const{plugin:le,dashboard:ie,panel:ae}=te,[re,ce]=(0,i.useState)(""),[me,ee]=(0,i.useState)("All"),de=(0,r.of)(z),[De,fe,Te]=(0,i.useMemo)(()=>[X(te),(0,k.Zm)(te),A(te)],[ae.configRev,te.data,te.instanceState,re]),je=(0,i.useMemo)(()=>(0,M.v)(te.panel.fieldConfig,te.plugin.fieldConfigRegistry,te.data?.series??[],re,te.onFieldConfigsChange),[ae.configRev,te.data,te.instanceState,re]),He=[],Be=re.length>0,Ne=(0,i.useMemo)(q,[]),Re=(0,h.X)(ae)?[Te,De,...fe]:[De,...fe];if(Be)He.push(oe(Re,je,re)),te.plugin.angularPanelCtrl&&He.push((0,t.jsx)("div",{className:de.searchNotice,children:"This is an old visualization type that does not support searching all options."},"Search notice"));else switch(me){case"All":(0,h.X)(ae)&&He.push(Te.render()),He.push(De.render()),te.plugin.angularPanelCtrl&&He.push((0,t.jsx)(E,{plugin:le,dashboard:ie,panel:ae},"AngularOptions"));for(const We of fe)He.push(We.render());for(const We of je)He.push(We.render());break;case"Overrides":for(const We of je)He.push(We.render());break;case"Recent":He.push((0,t.jsx)(C.D,{id:"Recent options",title:"Recent options",forceOpen:1,children:se(Re).map(We=>We.render())},"Recent options"));break}const Se=!Be&&!le.fieldConfigRegistry.isEmpty();return(0,t.jsxs)("div",{className:de.wrapper,children:[(0,t.jsxs)("div",{className:de.formBox,children:[ae.isAngularPlugin()&&!le.meta.angular?.hideDeprecation&&(0,t.jsx)(o.c,{className:de.angularDeprecationWrapper,showPluginDetailsLink:!0,pluginId:le.meta.id,pluginType:le.meta.type,angularSupportEnabled:s.$?.angularSupportEnabled,interactionElementId:"panel-options"}),(0,t.jsx)("div",{className:de.formRow,children:(0,t.jsx)(f.Z,{width:0,value:re,onChange:ce,placeholder:"Search options"})}),Se&&(0,t.jsx)("div",{className:de.formRow,children:(0,t.jsx)(a.z,{options:Ne,value:me,fullWidth:!0,onChange:ee})})]}),(0,t.jsx)("div",{className:de.scrollWrapper,children:(0,t.jsx)(c.E,{autoHeightMin:"100%",children:(0,t.jsx)("div",{className:de.mainBox,children:He})})})]})};function q(){return[{label:"All",value:"All"},{label:"Overrides",value:"Overrides"}]}var ne=(te=>(te.All="All",te.Overrides="Overrides",te.Recent="Recent",te))(ne||{});function oe(te,le,ie){const ae=new Y(te,le),{optionHits:re,totalCount:ce,overrideHits:me}=ae.search(ie);return(0,t.jsxs)("div",{children:[(0,t.jsx)(C.D,{id:"Found options",title:`Matched ${re.length}/${ce} options`,forceOpen:1,children:re.map(ee=>ee.render(ie))},"Normal options"),me.map(ee=>ee.render(ie))]},"search results")}const z=te=>({wrapper:(0,n.css)({height:"100%",display:"flex",flexDirection:"column",flex:"1 1 0",".search-fragment-highlight":{color:te.colors.warning.text,background:"transparent"}}),searchBox:(0,n.css)({display:"flex",flexDirection:"column",minHeight:0}),formRow:(0,n.css)({marginBottom:te.spacing(1)}),formBox:(0,n.css)({padding:te.spacing(1),background:te.colors.background.primary,border:`1px solid ${te.components.panel.borderColor}`,borderTopLeftRadius:te.shape.borderRadius(1.5),borderBottom:"none"}),closeButton:(0,n.css)({marginLeft:te.spacing(1)}),searchHits:(0,n.css)({padding:te.spacing(1,1,0,1)}),scrollWrapper:(0,n.css)({flexGrow:1,minHeight:0}),searchNotice:(0,n.css)({fontSize:te.typography.size.sm,color:te.colors.text.secondary,padding:te.spacing(1),textAlign:"center"}),mainBox:(0,n.css)({background:te.colors.background.primary,border:`1px solid ${te.components.panel.borderColor}`,borderTop:"none",flexGrow:1}),angularDeprecationWrapper:(0,n.css)({padding:te.spacing(1)})})},22290:(G,O,e)=>{"use strict";e.d(O,{v:()=>I});var t=e(74848),n=e(32196),i=e(2543),s=e(85200),r=e(37055),f=e(84349),a=e(51986),c=e(40845),o=e(6923),h=e(96540),g=e(23257),l=e.n(g),p=e(66864),m=e(60029),y=e(53402),d=e(29158),v=e(88575),u=e(57755);const D=({property:A,context:L,registry:U,onChange:W,onRemove:w,isSystemOverride:N,searchQuery:B})=>{const V=(0,c.of)(P),K=U?.getIfExists(A.id),H=(0,h.useId)();if(!K)return null;const X=Array.isArray(A.value)||A.id===r.uo.Thresholds||A.id===r.uo.Links||A.id===r.uo.Mappings,k=K.category?.filter(se=>se!==K.name);let Y;const Z=(se=!0,j=!1)=>(q=!1)=>(0,t.jsxs)(p.Gy,{justify:"space-between",children:[(0,t.jsxs)(m.J,{category:k,description:se?K.description:void 0,htmlFor:H,children:[(0,t.jsx)(l(),{textToHighlight:K.name,searchWords:[B],highlightClassName:"search-fragment-highlight"}),!q&&j&&K.getItemsCount&&(0,t.jsx)(y.p,{value:K.getItemsCount(A.value)})]}),!N&&(0,t.jsx)("div",{children:(0,t.jsx)(d.K,{name:"times",onClick:w,tooltip:"Remove label"})})]});return X?Y=(0,t.jsx)(u.D,{id:K.name,renderTitle:Z(!1,!0),className:(0,n.css)({paddingLeft:0,paddingRight:0}),isNested:!0,isOpenDefault:A.value!==void 0,children:(0,t.jsx)(K.override,{value:A.value,onChange:se=>{W(se)},item:K,context:L})}):Y=(0,t.jsx)("div",{children:(0,t.jsx)(v.D,{label:Z()(),description:K.description,children:(0,t.jsx)(K.override,{value:A.value,onChange:se=>{W(se)},item:K,context:L,id:H})})}),(0,t.jsx)("div",{className:(0,n.cx)(X&&V.collapsibleOverrideEditor,!X&&"dynamicConfigValueEditor--nonCollapsible"),children:Y})},P=A=>({collapsibleOverrideEditor:(0,n.css)({label:"collapsibleOverrideEditor","& + .dynamicConfigValueEditor--nonCollapsible":{marginTop:A.spacing(1)}})});var x=e(48192),E=e(74097),C=e(14578);const M=({isExpanded:A,registry:L,matcherUi:U,overrideName:W,override:w,onOverrideRemove:N})=>{const B=(0,c.of)(S),K=w.properties.map(X=>L.getIfExists(X.id)).filter(X=>!!X).map(X=>X?.name).join(", "),H=U.optionsToLabel(w.matcher.options);return(0,t.jsxs)("div",{children:[(0,t.jsxs)(p.Gy,{justify:"space-between",children:[(0,t.jsx)("div",{children:W}),(0,t.jsx)(d.K,{name:"trash-alt",onClick:N,tooltip:"Remove override"})]}),!A&&(0,t.jsx)("div",{className:B.overrideDetails,children:(0,t.jsxs)("div",{className:B.options,title:H,children:[H," ",(0,t.jsx)(C.I,{name:"angle-right"})," ",K]})})]})};M.displayName="OverrideTitle";const S=A=>({matcherUi:(0,n.css)({padding:A.spacing(1)}),propertyPickerWrapper:(0,n.css)({marginTop:A.spacing(2)}),overrideDetails:(0,n.css)({fontSize:A.typography.bodySmall.fontSize,color:A.colors.text.secondary,fontWeight:A.typography.fontWeightRegular}),options:(0,n.css)({overflow:"hidden",paddingRight:A.spacing(4)}),unknownLabel:(0,n.css)({marginBottom:0})});function I(A,L,U,W,w){const N=[],B=A;if(!L||L.isEmpty())return[];const V=(k,Y)=>{let Z=(0,i.cloneDeep)(B.overrides);Z[k]=Y,w({...B,overrides:Z})},K=k=>{let Y=(0,i.cloneDeep)(B.overrides);Y.splice(k,1),w({...B,overrides:Y})},H=k=>{const Y=s.sJ.get(k.value);Y&&w({...B,overrides:[...B.overrides,{matcher:{id:Y.id,options:Y.defaultOptions},properties:[]}]})},X={data:U,getSuggestions:k=>(0,o.Hf)(U,k),isOverride:!0};for(let k=0;k<B.overrides.length;k++){const Y=B.overrides[k],Z=`Override ${k+1}`,se=f.g.get(Y.matcher.id),j=T(L),q=(0,r.Ow)(Y),ne=Y.properties.length===0?1:0,oe=new x.C({title:Z,id:Z,forceOpen:ne,renderTitle:function(ie){return(0,t.jsx)(M,{override:Y,isExpanded:ie,registry:L,overrideName:Z,matcherUi:se,onOverrideRemove:()=>K(k)})}}),z=le=>{Y.matcher.options=le,V(k,Y)},te=(le,ie)=>{const ae=L.get(ie.value),re={id:ae.id,value:ae.defaultValue};Y.properties?le.properties.push(re):le.properties=[re],V(k,le)};oe.addItem(new E.v({title:se.name,render:function(){return(0,t.jsx)(se.component,{id:`${se.matcher.id}-${k}`,matcher:se.matcher,data:U??[],options:Y.matcher.options,onChange:z})}}));for(let le=0;le<Y.properties.length;le++){const ie=Y.properties[le],ae=L.getIfExists(ie.id);if(!ae)continue;const re=me=>{Y.properties[le].value=me,V(k,Y)},ce=()=>{Y.properties.splice(le,1),V(k,Y)};oe.addItem(new E.v({title:ae.name,skipField:!0,render:function(){return(0,t.jsx)(D,{isSystemOverride:q,onChange:re,onRemove:ce,property:ie,registry:L,context:X,searchQuery:W},`${ie.id}/${le}`)}}))}!q&&Y.matcher.options&&oe.addItem(new E.v({title:"----------",skipField:!0,render:function(){return(0,t.jsx)(a.i,{label:"Add override property",variant:"secondary",isFullWidth:!0,icon:"plus",menuPlacement:"auto",options:j,onChange:ie=>te(Y,ie)},"Add override property")}})),N.push(oe)}return N.push(new x.C({title:"add button",id:"add button",customRender:function(){return(0,t.jsx)(b,{children:(0,t.jsx)(a.i,{icon:"plus",label:"Add field override",variant:"secondary",menuPlacement:"auto",isFullWidth:!0,size:"md",options:f.g.list().filter(Y=>!Y.excludeFromPicker).map(Y=>({label:Y.name,value:Y.id,description:Y.description})),onChange:Y=>H(Y)})},"Add override")}})),N}function T(A){return A.list().filter(L=>!L.hideFromOverrides).map(L=>{let U=L.name;return L.category&&(U=[...L.category,L.name].join(" > ")),{label:U,value:L.id,description:L.description}})}function b({children:A}){const L=(0,c.of)(R);return(0,t.jsx)("div",{className:L,children:A})}function R(A){return(0,n.css)({borderTop:`1px solid ${A.colors.border.weak}`,padding:`${A.spacing(2)}`,display:"flex"})}},66211:(G,O,e)=>{"use strict";e.d(O,{g5:()=>x,tN:()=>D,Zm:()=>u,Z4:()=>P});var t=e(74848),n=e(2543),i=e(60264),s=e(10354),r=e(32196),f=e(72724),a=e(40845);const c=({libraryPanel:E})=>{const C=(0,a.of)(o),M=E.useState(),S=M.$timeRange?.getTimeZone(),I=M._loadedPanel?.meta;return I?(0,t.jsxs)("div",{className:C.info,children:[(0,t.jsxs)("div",{className:C.libraryPanelInfo,children:[`Used on ${I.connectedDashboards} `,I.connectedDashboards===1?"dashboard":"dashboards"]}),(0,t.jsxs)("div",{className:C.libraryPanelInfo,children:[(0,f.LE)(I.updated,{format:"L",timeZone:S})," by",I.updatedBy.avatarUrl&&(0,t.jsx)("img",{className:C.userAvatar,src:I.updatedBy.avatarUrl,alt:`Avatar for ${I.updatedBy.name}`}),I.updatedBy.name]})]}):null},o=E=>({info:(0,r.css)({lineHeight:1}),libraryPanelInfo:(0,r.css)({color:E.colors.text.secondary,fontSize:E.typography.bodySmall.fontSize}),userAvatar:(0,r.css)({borderRadius:E.shape.radius.circle,boxSizing:"content-box",width:"22px",height:"22px",paddingLeft:E.spacing(1),paddingRight:E.spacing(1)})});var h=e(6923),g=e(48192),l=e(74097);const p="Some data fields have this option pre-configured. Add a field override rule to override the pre-configured value.",m="An override rule exists for this property";function y(E,C,M){const S=[];if(M){for(const T of M)for(const b of T.fields)if((0,n.get)(b.config,E.path)!=null){S.push({type:"data",description:p,tooltip:p});break}}return C.overrides.some(T=>T.properties.some(b=>b.id===E.id))&&S.push({type:"rule",description:m,tooltip:m}),S}var d=e(54612);function v({data:E,replaceVariables:C,options:M,eventBus:S,instanceState:I}){const T=E?.series??[];return{data:T,replaceVariables:C,options:M,eventBus:S,getSuggestions:R=>(0,h.Hf)(T,R),instanceState:I}}function u(E){const{plugin:C,panel:M,onPanelOptionsChanged:S,onFieldConfigsChange:I,data:T,dashboard:b,instanceState:R}=E,A=M.getOptions(),L=M.fieldConfig,U={},W=v({data:T,replaceVariables:M.replaceVariables,options:A,eventBus:b.events,instanceState:R}),w=B=>{const V=(B&&B[0])??`${C.meta.name}`,K=U[V];return K||(U[V]=new g.C({title:V,id:V,sandboxId:C.meta.id}))},N={getValue:B=>(0,n.get)(A,B),onChange:(B,V)=>{const K=(0,d.Sf)(A,B,V);S(K)}};x(C.getPanelOptionsSupplier(),N,w,W);for(const B of C.fieldConfigRegistry.list()){if(B.isCustom){if(B.showIf&&!B.showIf(L.defaults.custom,T?.series))continue}else if(B.showIf&&!B.showIf(L.defaults,T?.series))continue;if(B.hideFromDefaults)continue;const V=w(B.category),K=B.editor,H=L.defaults,X=B.isCustom?H.custom?(0,n.get)(H.custom,B.path):void 0:(0,n.get)(H,B.path);B.getItemsCount&&(V.props.itemsCount=B.getItemsCount(X)),V.addItem(new l.v({title:B.name,description:B.description,overrides:y(B,L,T?.series),render:function(){const Y=Z=>{I((0,d.EQ)(L,B.path,Z,B.isCustom))};return(0,t.jsx)(K,{value:X,onChange:Y,item:B,context:W,id:B.id})}}))}return Object.values(U)}function D(E){const C=new g.C({title:"Library panel options",id:"Library panel options",isOpenDefault:!0});return C.addItem(new l.v({title:"Name",value:E,popularRank:1,render:function(){return(0,t.jsx)(s.p,{id:"LibraryPanelFrameName","data-testid":"library panel name input",defaultValue:E.state.name,onBlur:S=>E.setState({name:S.currentTarget.value})})}})).addItem(new l.v({title:"Information",render:function(){return(0,t.jsx)(c,{libraryPanel:E})}})),C}function P(E){const{plugin:C,panel:M,data:S,eventBus:I,instanceState:T}=E,b={},R=w=>{const N=w?.[0]??C.meta.name,B=b[N];return B||(b[N]=new g.C({title:N,id:N,sandboxId:C.meta.id}))},A=M.state.options,L={getValue:w=>(0,n.get)(A,w),onChange:(w,N)=>{const B=(0,d.Sf)(A,w,N);M.onOptionsChange(B)}},U=v({data:S,replaceVariables:M.interpolate,options:A,eventBus:I,instanceState:T});x(C.getPanelOptionsSupplier(),L,R,U);const W=M.state.fieldConfig;for(const w of C.fieldConfigRegistry.list()){const N=w.showIf&&(w.isCustom?!w.showIf(W.defaults.custom,S?.series):!w.showIf(W.defaults,S?.series));if(w.hideFromDefaults||N)continue;const B=R(w.category),V=w.editor,K=W.defaults,H=w.isCustom?K.custom?(0,n.get)(K.custom,w.path):void 0:(0,n.get)(K,w.path);w.getItemsCount&&(B.props.itemsCount=w.getItemsCount(H)),B.addItem(new l.v({title:w.name,description:w.description,overrides:y(w,W,S?.series),render:function(){const k=Y=>{M.onFieldConfigChange((0,d.EQ)(W,w.path,Y,w.isCustom),!0)};return(0,t.jsx)(V,{value:H,onChange:k,item:w,context:U,id:w.id})}}))}return Object.values(b)}function x(E,C,M,S,I){const T=new i.pv;E(T,S);for(const b of T.getItems()){if(b.showIf&&!b.showIf(S.options,S.data))continue;let R=I;if(R?b.category?.[0]?.length&&(R=R.getCategory(b.category[0])):R=M(b.category),(0,i.iF)(b)){const L=b.getNestedValueAccess(C),U=L.getContext?L.getContext(S):{...S,options:C.getValue(b.path)};x(b.getBuilder(),L,M,U,R);continue}const A=b.editor;R.addItem(new l.v({title:b.name,description:b.description,render:function(){return(0,t.jsx)(A,{value:C.getValue(b.path),onChange:U=>{C.onChange(b.path,U)},item:b,context:S,id:b.id})}}))}}},53466:(G,O,e)=>{"use strict";e.d(O,{Ay:()=>D,GU:()=>g,MJ:()=>p,Ox:()=>m,eK:()=>d,fR:()=>y,kw:()=>v,wi:()=>a});var t=e(65307),n=e(39070),i=e(43127),s=e(33390),r=e(84423),f=e(32696);const a="grafana.dashboard.editor.ui",c={isPanelOptionsVisible:!0,rightPaneSize:400,topPaneSize:.45,mode:f.q5.Fill},o=()=>{const P=s.A.getObject(a,c);let x={...P};return typeof P.topPaneSize=="string"&&(x={...P,topPaneSize:parseFloat(P.topPaneSize)/100}),{getPanel:()=>new r.a9({}),getSourcePanel:()=>new r.a9({}),getData:()=>({state:n.Gu.NotStarted,series:[],timeRange:(0,i.E2)()}),initDone:!1,shouldDiscardChanges:!1,isOpen:!1,isVizPickerOpen:!1,tableViewEnabled:!1,ui:{...c,...x}}},h=(0,t.Z0)({name:"panelEditor",initialState:o(),reducers:{updateEditorInitState:(P,x)=>{P.getPanel=()=>x.payload.panel,P.getSourcePanel=()=>x.payload.sourcePanel,P.initDone=!0,P.isOpen=!0,P.shouldDiscardChanges=!1},setEditorPanelData:(P,x)=>{P.getData=()=>x.payload},setDiscardChanges:(P,x)=>{P.shouldDiscardChanges=x.payload},setPanelEditorUIState:(P,x)=>{P.ui={...P.ui,...x.payload},!P.ui.isPanelOptionsVisible&&P.isVizPickerOpen&&(P.isVizPickerOpen=!1)},toggleVizPicker:(P,x)=>{P.isVizPickerOpen=x.payload,P.isVizPickerOpen&&(P.ui.isPanelOptionsVisible=!0)},toggleTableView(P){P.tableViewEnabled=!P.tableViewEnabled},closeEditor:P=>{P.getPanel=()=>new r.a9({}),P.getSourcePanel=()=>new r.a9({}),P.isOpen=!1,P.initDone=!1,P.isVizPickerOpen=!1,P.tableViewEnabled=!1}}}),{updateEditorInitState:g,setEditorPanelData:l,setDiscardChanges:p,closeEditor:m,setPanelEditorUIState:y,toggleVizPicker:d,toggleTableView:v}=h.actions,D={panelEditor:h.reducer}},32696:(G,O,e)=>{"use strict";e.d(O,{M8:()=>t,Nt:()=>s,__:()=>f,q5:()=>n});var t=(a=>(a.Query="query",a.Transform="transform",a.Visualize="visualize",a.Alert="alert",a))(t||{}),n=(a=>(a[a.Fill=0]="Fill",a[a.Fit=1]="Fit",a[a.Exact=2]="Exact",a))(n||{}),i=(a=>(a[a.Off=0]="Off",a[a.Table=1]="Table",a))(i||{});const s=[{value:0,label:"Fill",description:"Use all available space"},{value:2,label:"Actual",description:"Make same size as on the dashboard"}],r=[{value:0,label:"Visualization",description:"Show using selected visualization"},{value:1,label:"Table",description:"Show raw data in table form"}];var f=(a=>(a[a.Visualizations=0]="Visualizations",a[a.LibraryPanels=1]="LibraryPanels",a[a.Suggestions=2]="Suggestions",a[a.Widgets=3]="Widgets",a))(f||{})},54612:(G,O,e)=>{"use strict";e.d(O,{$:()=>f,A:()=>r,EQ:()=>a,Sf:()=>c});var t=e(2543),n=e.n(t),i=e(15054),s=e(32696);function r(o,h,g,l){if(o===s.q5.Fill)return{width:h,height:g};const p=8*6,d=(window.innerWidth-60-i.dU*4)/i.cV*l.gridPos.w,v=i.sD*l.gridPos.h+p,u=Math.min(h/d,g/v);return d<=h&&v<=g?{width:d,height:v}:{width:d*u,height:v*u}}function f(o){return o?.meta.skipDataQuery===!1}const a=(o,h,g,l)=>{let p={...o.defaults};const m=g==null||g==="";return l?p.custom?m?p.custom=(0,t.omit)(p.custom,h):p.custom=c(p.custom,h,g):m||(p.custom=c(p.custom,h,g)):m?p=(0,t.omit)(p,h):p=c(p,h,g),{...o,defaults:p}};function c(o,h,g){const l=Array.isArray(h)?h:h.split("."),p=l.shift();if(p.endsWith("]")){const y=p.lastIndexOf("["),d=+p.substring(y+1,p.length-1),v=p.substring(0,y);let u=o[v];const D=Array.isArray(u)?[...u]:[];return l.length&&(u=D[d],(u==null||typeof u!="object")&&(u={}),g=c(u,l,g)),D[d]=g,{...o,[v]:D}}if(!l.length)return{...o,[p]:g};let m=o[p];return(m==null||typeof m!="object")&&(m={}),{...o,[p]:c(m,l,g)}}},92378:(G,O,e)=>{"use strict";e.d(O,{G:()=>a,U:()=>c});var t=e(74848),n=e(96540),i=e(80943),s=e(90182),r=e(31678),f=e(87421);const a=({repeat:o,onChange:h,id:g})=>{const l=(0,r.useSelector)(y=>(0,f.SS)((0,f.y7)(y),y)),p=(0,n.useMemo)(()=>{const y=l.map(d=>({label:d.name,value:d.name}));return y.length===0&&y.unshift({label:"No template variables found",value:null}),y.unshift({label:"Disable repeating",value:null}),y},[l]),m=(0,n.useCallback)(y=>h(y.value),[h]);return(0,t.jsx)(s.l6,{inputId:g,value:o,onChange:m,options:p})},c=({parent:o,repeat:h,id:g,onChange:l})=>{const m=(0,n.useMemo)(()=>i.jh.getVariables(o),[o]).useState().variables,y=(0,n.useMemo)(()=>{const v=m.map(u=>({label:u.state.name,value:u.state.name}));return v.length===0&&v.unshift({label:"No template variables found",value:null}),v.unshift({label:"Disable repeating",value:null}),v},[m]),d=(0,n.useCallback)(v=>l(v.value),[l]);return(0,t.jsx)(s.l6,{inputId:g,value:h,onChange:d,options:y})}},78050:(G,O,e)=>{"use strict";e.d(O,{C:()=>a,m:()=>c});var t=e(74848),n=e(13544),i=e(14110),s=e(71678),r=e(55852),f=e(70497);const a=({dashboard:o,onSaveSuccess:h,size:g})=>(0,t.jsx)(s.$s,{children:({showModal:l,hideModal:p})=>(0,t.jsx)(r.$n,{size:g,onClick:()=>{l(f.$,{dashboard:o,onSaveSuccess:h,onDismiss:p})},"aria-label":n.Tp.pages.Dashboard.Settings.General.saveDashBoard,children:"Save dashboard"})}),c=({dashboard:o,onClick:h,onSaveSuccess:g,variant:l,size:p})=>(0,t.jsx)(s.$s,{children:({showModal:m,hideModal:y})=>(0,t.jsx)(r.$n,{size:p,onClick:()=>{(0,i.rR)("grafana_dashboard_save_as_clicked"),h?.(),m(f.$,{dashboard:o,onSaveSuccess:g,onDismiss:y,isCopy:!0})},variant:l,"aria-label":n.Tp.pages.Dashboard.Settings.General.saveAsDashBoard,children:"Save as"})})},54943:(G,O,e)=>{"use strict";e.d(O,{l:()=>c});var t=e(74848),n=e(16817),i=e(67061),s=e(62930),r=e(90613),f=e(19626),a=e(22764);const c=({diff:o,oldValue:h,newValue:g,hasFolderChanges:l,oldFolder:p,newFolder:m})=>{const y=(0,n.A)(async()=>{const v=JSON.stringify(h??{},null,2),u=JSON.stringify(g??{},null,2);let D;const P=[];let x=0;if(o)for(const[E,C]of Object.entries(o)){const M=(0,t.jsx)(f.D,{diffs:C,title:E},E);E==="schemaVersion"?D=M:P.push(M),x+=C.length}return{schemaChange:D,diffs:P,count:x,showDiffs:x<15,jsonView:(0,t.jsx)(a.M,{oldValue:v,newValue:u})}},[o,h,g]),{value:d}=y;return(0,t.jsxs)(i.B,{direction:"column",gap:1,children:[l&&(0,t.jsx)(f.D,{diffs:[{op:"replace",value:m,originalValue:p,path:[],startLineNumber:0,endLineNumber:0}],title:"folder"},"folder"),(!d||!h)&&(0,t.jsx)(s.y,{}),d&&d.count>=1?(0,t.jsxs)(t.Fragment,{children:[d&&d.schemaChange&&d.schemaChange,d&&d.showDiffs&&d.diffs,(0,t.jsxs)(r.a,{paddingTop:1,children:[(0,t.jsx)("h4",{children:"Full JSON diff"}),d.jsonView]})]}):(0,t.jsx)(r.a,{paddingTop:1,children:"No changes in the dashboard JSON"})]})}},70497:(G,O,e)=>{"use strict";e.d(O,{$:()=>Ke});var t=e(74848),n=e(96540),i=e(17172),s=e(32264),r=e(87978),f=e(63021),a=e(40675),c=e(56596),o=e(32196),h=e(16817),g=e(40845),l=e(42418),p=e(27677);function m({dashboard:Xe}){const Je=(0,g.of)(y),{loading:st,value:pt,error:xt}=(0,h.A)(async()=>{const $e=Xe.getSaveModelCloneOld();return p.IB.validateDashboard($e).catch(be=>{if(be.status>=500)throw be;return be.data})},[Xe]);let ot;if(st)ot=(0,t.jsx)(l.F,{severity:"info",title:"Checking dashboard validity"});else if(pt)pt.isValid||(ot=(0,t.jsxs)(l.F,{severity:"warning",title:"Dashboard failed schema validation",children:[(0,t.jsx)("p",{children:"Validation is provided for development purposes and should be safe to ignore. If you are a Grafana developer, consider checking and updating the dashboard schema"}),(0,t.jsx)("div",{className:Je.error,children:pt.message})]}));else{const $e=xt?.message??"Unknown error";ot=(0,t.jsx)(l.F,{severity:"info",title:"Error checking dashboard validity",children:(0,t.jsx)("p",{className:Je.error,children:$e})})}return ot?(0,t.jsx)("div",{className:Je.root,children:ot}):null}const y=Xe=>({root:(0,o.css)({marginTop:Xe.spacing(1)}),error:(0,o.css)({fontFamily:Xe.typography.fontFamilyMonospace,whiteSpace:"pre-wrap",overflowX:"auto",maxWidth:"100%"})}),d=m;var v=e(54943),u=e(96374),D=e(37390),P=e(55852),x=e(78050),E=e(41053),C=e(71733),M=e(14110),S=e(12131),I=e(28138),T=e(3169),b=e(91219),R=e(55314),A=e(31678),L=e(28444),U=e(36974);const W=async(Xe,Je,st,pt)=>{const xt=await pt({dashboard:Xe,folderUid:Je.folderUid??st.meta.folderUid??Xe.meta?.folderUid,message:Je.message,overwrite:Je.overwrite,k8s:st.meta.k8s});if("error"in xt)throw xt.error;return xt.data},w=(Xe=!1)=>{const Je=(0,A.useDispatch)(),st=(0,T._2)(),[pt]=(0,R.e8)(),[xt,ot]=(0,E.A)(async($e,ve,be)=>{try{const he=await W($e,ve,be,pt);be.version=he.version,$e.version=he.version,be.clearUnsavedChanges($e,ve),I.A.publish(new L.Eu),st.success("Dashboard saved"),(0,U.ko)(he.uid),Xe?(0,M.rR)("grafana_dashboard_copied",{name:be.title,url:he.url}):(0,M.rR)(`grafana_dashboard_${be.id?"saved":"created"}`,{name:be.title,url:he.url});const ye=S.Ny.getLocation().pathname,Pe=C.I.stripBaseFromUrl(he.url);return Pe!==ye&&he.url&&setTimeout(()=>S.Ny.replace(Pe)),be.meta.isStarred&&Je((0,b.TU)({id:be.uid,title:be.title,url:Pe})),he}catch(he){throw he instanceof Error&&st.error(he.message??"Error saving dashboard"),he}},[Je,st]);return{state:xt,onDashboardSave:ot}},N=({dashboard:Xe,dashboardSaveModel:Je,error:st,onDismiss:pt,setErrorIsHandled:xt})=>{const{onDashboardSave:ot}=w();return(0,t.jsxs)(t.Fragment,{children:[st.data&&st.data.status==="version-mismatch"&&(0,t.jsx)(u.u,{isOpen:!0,title:"Conflict",body:(0,t.jsxs)("div",{children:["Someone else has updated this dashboard ",(0,t.jsx)("br",{})," ",(0,t.jsx)("small",{children:"Would you still like to save this dashboard?"})]}),confirmText:"Save and overwrite",onConfirm:async()=>{await ot(Je,{overwrite:!0},Xe),pt()},onDismiss:pt}),st.data&&st.data.status==="name-exists"&&(0,t.jsx)(u.u,{isOpen:!0,title:"Conflict",body:(0,t.jsxs)("div",{children:["A dashboard with the same name in selected folder already exists. ",(0,t.jsx)("br",{}),(0,t.jsx)("small",{children:"Would you still like to save this dashboard?"})]}),confirmText:"Save and overwrite",onConfirm:async()=>{await ot(Je,{overwrite:!0},Xe),pt()},onDismiss:pt}),st.data&&st.data.status==="plugin-dashboard"&&(0,t.jsx)(B,{dashboard:Xe,onDismiss:()=>{xt(!0),pt()}})]})},B=({onDismiss:Xe,dashboard:Je})=>{const{onDashboardSave:st}=w(),pt=(0,g.of)(K);return(0,t.jsxs)(D.a,{className:pt.modal,title:"Plugin dashboard",icon:"copy",isOpen:!0,onDismiss:Xe,children:[(0,t.jsxs)("div",{className:pt.modalText,children:["Your changes will be lost when you update the plugin.",(0,t.jsx)("br",{}),(0,t.jsxs)("small",{children:["Use ",(0,t.jsx)("strong",{children:"Save As"})," to create custom version."]})]}),(0,t.jsxs)(D.a.ButtonRow,{children:[(0,t.jsx)(P.$n,{variant:"secondary",onClick:Xe,fill:"outline",children:"Cancel"}),(0,t.jsx)(x.m,{onClick:Xe,dashboard:Je,onSaveSuccess:Xe}),(0,t.jsx)(P.$n,{variant:"destructive",onClick:async()=>{await st(Je.getSaveModelClone(),{overwrite:!0},Je),Xe()},children:"Overwrite"})]})]})},V=Xe=>{switch(Xe){case"version-mismatch":case"name-exists":case"plugin-dashboard":return!0;default:return!1}},K=Xe=>({modal:(0,o.css)({width:"500px"}),modalText:(0,o.css)({fontSize:Xe.typography.h4.fontSize,color:Xe.colors.text.primary,marginBottom:Xe.spacing(4),paddingTop:Xe.spacing(2)}),modalButtonRow:(0,o.css)({marginBottom:"14px","a, button":{marginRight:Xe.spacing(2)}})});var H=e(51253),X=e(16504),k=e(88575),Y=e(67061),Z=e(60029),se=e(10354),j=e(21744),q=e(15292),ne=e(36607),oe=e(71500),z=e(81394),te=e(27966);const le=Xe=>{const Je=Xe.getSaveModelClone();return Je.id=null,Je.uid="",Je.title+=" Copy",Je.editable=!0,Xe.id>0&&Je.panels&&Je.panels.forEach(st=>{st.type==="graph"&&st.alert&&delete st.thresholds,delete st.alert}),Je},ie=({dashboard:Xe,isLoading:Je,isNew:st,onSubmit:pt,onCancel:xt,onSuccess:ot})=>{const $e={title:st?Xe.title:`${Xe.title} Copy`,description:Xe.description,$folder:{uid:Xe.meta.folderUid,title:Xe.meta.folderTitle},copyTags:!1},ve=be=>async he=>{if(he&&he===be().$folder.title?.trim())return"Dashboard name cannot be the same as folder name";try{return await oe.P.validateNewDashboardName(be().$folder.uid??"general",he),!0}catch(ye){return ye instanceof Error?ye.message:"Dashboard name is invalid"}};return(0,t.jsx)(H.l,{defaultValues:$e,onSubmit:async be=>{if(!pt)return;const he=le(Xe);he.title=be.title,he.description=be.description,!st&&!be.copyTags&&(he.tags=[]),(await pt(he,{folderUid:be.$folder.uid},Xe)).status==="success"&&ot()},children:({register:be,control:he,errors:ye,getValues:Pe})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(X.e,{render:({field:{ref:ge,...xe}})=>(0,t.jsx)(k.D,{label:(0,t.jsxs)(Y.B,{justifyContent:"space-between",children:[(0,t.jsx)(Z.J,{htmlFor:"title",children:"Title"}),s.$.featureToggles.dashgpt&&st&&(0,t.jsx)(te.Z,{onGenerate:Ae=>xe.onChange(Ae)})]}),invalid:!!ye.title,error:ye.title?.message,children:(0,t.jsx)(se.p,{...xe,onChange:Ae=>xe.onChange(Ae.target.value),"aria-label":"Save dashboard title field",autoFocus:!0})}),control:he,name:"title",rules:{validate:ve(Pe)}}),(0,t.jsx)(X.e,{render:({field:{ref:ge,...xe}})=>(0,t.jsx)(k.D,{label:(0,t.jsxs)(Y.B,{justifyContent:"space-between",children:[(0,t.jsx)(Z.J,{htmlFor:"description",children:"Description"}),s.$.featureToggles.dashgpt&&st&&(0,t.jsx)(z.V,{onGenerate:Ae=>xe.onChange(Ae)})]}),invalid:!!ye.description,error:ye.description?.message,children:(0,t.jsx)(j.f,{...xe,onChange:Ae=>xe.onChange(Ae.target.value),"aria-label":"Save dashboard description field",autoFocus:!0})}),control:he,name:"description"}),(0,t.jsx)(k.D,{label:"Folder",children:(0,t.jsx)(X.e,{render:({field:{ref:ge,...xe}})=>(0,t.jsx)(ne.d,{...xe,onChange:(Ae,Ee)=>xe.onChange({uid:Ae,title:Ee}),value:xe.value?.uid,initialTitle:Xe.meta.folderTitle,dashboardId:Xe.id,enableCreateNew:!0}),control:he,name:"$folder"})}),!st&&(0,t.jsx)(k.D,{label:"Copy tags",children:(0,t.jsx)(q.d,{...be("copyTags")})}),(0,t.jsxs)(Y.B,{children:[(0,t.jsx)(P.$n,{type:"button",variant:"secondary",onClick:xt,fill:"outline",children:"Cancel"}),(0,t.jsx)(P.$n,{disabled:Je,type:"submit","aria-label":"Save dashboard button",children:Je?"Saving...":"Save"})]})]})})};var ae=e(13544),re=e(10880),ce=e(10740),me=e(57725),ee=e(3363);const de=["You are an expert in Grafana Dashboards","Your goal is to write a description of the changes for a dashboard to display to the user","You will be given human-readable diffs with most irrelevant lines filtered out"].join(`.
`),De=["Respond only with the diff description, which is meant to be loaded directly into the application for the user.",'If there are no substantial user or migration changes, the correct description is "Minor changes only"',`If there are too many changes of either kind, and those changes have a message saying 'too long', the correct response for that section is "Too many changes to auto-summarize"`,"In a diff, lines beginning with - are removed, and lines beginning with + are added.","Lines with neither + nor - are included for context. Be careful not to mark them as added or removed if they do not start with + or -.","If a line is changed, it will show a previous version removed and a new version added","When referring to panel changes, use the panel title","When using panel title, wrap it with double quotes","When the panel changes position, just mention that the panel has changed position","When an entire panel is added or removed, use the panel title and only say it was added or removed and disregard the rest of the changes for that panel","Group together similar changes into one line when multiple panels are affected","Refer to templating elements as variables","Try to make the response as short as possible"].join(`.
`),fe=({dashboard:Xe,onGenerate:Je,disabled:st})=>{const pt=(0,n.useCallback)(()=>Te(Xe),[Xe]);return(0,t.jsx)(ce.n,{messages:pt,onGenerate:Je,temperature:0,model:"gpt-3.5-turbo-16k",eventTrackingSrc:me.ec.dashboardChanges,toggleTipTitle:"Improve your dashboard changes summary",disabled:st})};function Te(Xe){let{userChanges:Je,migrationChanges:st}=(0,ee.Yy)(Xe);return Je.length>8e3&&(Je="User changes were too long, fill in the user changes section with 'User changes too long to auto-summarize'"),st.split(`
`).length<10?st="No significant migration changes":st.length>8e3&&(st="Migration changes were too long, fill in the migration changes section with 'Migration changes too long to auto-summarize'"),[{content:de,role:ee.Xh.system},{content:`Summarize the following user changes diff under "User changes":
${Je}`,role:ee.Xh.system},{content:`Be sure to only include substantial user changes, such as adding or removing entire panels, changing panel titles or descriptions, etc.
Do not include "User Changes" section if there are no substantial user changes to report.`,role:ee.Xh.system},{content:`Summarize the following migration changes diff under "Migration changes":
${st}`,role:ee.Xh.system},{content:`Be sure to only include substantial migration changes, such as adding or removing entire panels, changing panel titles or descriptions, etc.
Ignore any threshold step changes or templating list changes.
Ignore other changes and do not include them in the summary. Do not include "Migration Changes" section if there are no substantial migration changes to report.
If there are substantial migration changes, add "Some autogenerated changes are included to update the dashboard to the latest valid schema version" at the end.`,role:ee.Xh.system},{content:De,role:ee.Xh.system}]}const je=({dashboard:Xe,isLoading:Je,saveModel:st,options:pt,onSubmit:xt,onCancel:ot,onSuccess:$e,onOptionsChange:ve})=>{const be=(0,n.useMemo)(()=>Xe.hasTimeChanged(),[Xe]),he=(0,n.useMemo)(()=>Xe.hasVariablesChanged(),[Xe]),[ye,Pe]=(0,n.useState)(!1),[ge,xe]=(0,n.useState)(pt.message),Ae=(0,g.of)(He);return(0,t.jsx)("form",{onSubmit:async Ee=>{if(Ee.preventDefault(),!xt)return;Pe(!0),pt={...pt,message:ge},(await xt(st.clone,pt,Xe)).status==="success"?$e():Pe(!1)},style:{maxWidth:600},children:(0,t.jsxs)(Y.B,{gap:2,direction:"column",alignItems:"flex-start",children:[be&&(0,t.jsx)(re.S,{checked:!!pt.saveTimerange,onChange:()=>ve({...pt,saveTimerange:!pt.saveTimerange}),label:"Save current time range as dashboard default","aria-label":ae.Tp.pages.SaveDashboardModal.saveTimerange}),he&&(0,t.jsx)(re.S,{checked:!!pt.saveVariables,onChange:()=>ve({...pt,saveVariables:!pt.saveVariables}),label:"Save current variable values as dashboard default","aria-label":ae.Tp.pages.SaveDashboardModal.saveVariables}),(0,t.jsxs)("div",{className:Ae.message,children:[s.$.featureToggles.aiGeneratedDashboardChanges&&(0,t.jsx)(fe,{dashboard:Xe,onGenerate:Ee=>{ve({...pt,message:Ee}),xe(Ee)},disabled:!st.hasChanges}),(0,t.jsx)(j.f,{"aria-label":"message",value:ge,onChange:Ee=>{ve({...pt,message:Ee.currentTarget.value}),xe(Ee.currentTarget.value)},placeholder:"Add a note to describe your changes.",autoFocus:!0,rows:5})]}),(0,t.jsxs)(Y.B,{alignItems:"center",children:[(0,t.jsx)(P.$n,{variant:"secondary",onClick:ot,fill:"outline",children:"Cancel"}),(0,t.jsx)(P.$n,{type:"submit",disabled:!st.hasChanges||Je,icon:ye?"spinner":void 0,"aria-label":ae.Tp.pages.SaveDashboardModal.save,children:Je?"Saving...":"Save"}),!st.hasChanges&&(0,t.jsx)("div",{children:"No changes to save"})]})]})})};function He(Xe){return{message:(0,o.css)({display:"flex",alignItems:"end",flexDirection:"column",width:"100%"})}}var Be=e(4213),Ne=e(66864),Re=e(10534);const Se=({dashboard:Xe,onCancel:Je})=>{const[st,pt]=(0,n.useState)(()=>{const ot=Xe.getSaveModelClone();return delete ot.id,JSON.stringify(ot,null,2)}),xt=(0,n.useCallback)(()=>{const ot=new Blob([st],{type:"application/json;charset=utf-8"});(0,Be.saveAs)(ot,Xe.title+"-"+new Date().getTime()+".json")},[Xe.title,st]);return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(Y.B,{direction:"column",gap:2,children:[(0,t.jsxs)("div",{children:["This dashboard cannot be saved from the Grafana UI because it has been provisioned from another source. Copy the JSON or save it to a file below, then you can update your dashboard in the provisioning source.",(0,t.jsx)("br",{}),(0,t.jsxs)("i",{children:["See"," ",(0,t.jsx)("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",target:"_blank",rel:"noreferrer",children:"documentation"})," ","for more information about provisioning."]}),(0,t.jsx)("br",{})," ",(0,t.jsx)("br",{}),(0,t.jsx)("strong",{children:"File path: "})," ",Xe.meta.provisionedExternalId]}),(0,t.jsx)(j.f,{spellCheck:!1,value:st,onChange:ot=>{pt(ot.currentTarget.value)},className:We.json}),(0,t.jsxs)(Ne.Gy,{children:[(0,t.jsx)(P.$n,{variant:"secondary",onClick:Je,fill:"outline",children:"Cancel"}),(0,t.jsx)(Re.b,{icon:"copy",getText:()=>st,children:"Copy JSON to clipboard"}),(0,t.jsx)(P.$n,{type:"submit",onClick:xt,children:"Save JSON to file"})]})]})})},We={json:(0,o.css)({height:"400px",width:"100%",overflow:"auto",resize:"none",fontFamily:"monospace"})},Ke=({dashboard:Xe,onDismiss:Je,onSaveSuccess:st,isCopy:pt})=>{const[xt,ot]=(0,n.useState)({}),$e=Xe.getOriginalDashboard(),ve=Xe.meta.provisioned,be=Xe.version===0,he=!!Xe.meta.hasUnsavedFolderChange,[ye,Pe]=(0,n.useState)(!1),ge=(0,n.useMemo)(()=>{const ct=Xe.getSaveModelClone({saveTimerange:!!xt.saveTimerange,saveVariables:!!xt.saveVariables});if(!$e)return{clone:ct,diff:{},diffCount:0,hasChanges:!1};const vt=(0,c.G4)($e,ct);let Pt=0;for(const Vt of Object.values(vt))Pt+=Vt.length;return{clone:ct,diff:vt,diffCount:Pt,hasChanges:(Pt>0||he)&&!be}},[Xe,$e,xt,be,he]),[xe,Ae]=(0,n.useState)(!1),{state:Ee,onDashboardSave:Ie}=w(pt),Qe=st?()=>{Je(),st()}:Je,at=()=>xe?(0,t.jsx)(v.l,{diff:ge.diff,oldValue:$e,newValue:ge.clone}):be||pt?(0,t.jsx)(ie,{dashboard:Xe,isLoading:Ee.loading,onCancel:Je,onSuccess:Qe,onSubmit:Ie,isNew:be}):ve?(0,t.jsx)(Se,{dashboard:Xe,onCancel:Je,onSuccess:Qe}):(0,t.jsx)(je,{dashboard:Xe,isLoading:Ee.loading,saveModel:ge,onCancel:Je,onSuccess:Qe,onSubmit:Ie,options:xt,onOptionsChange:ot});if(Ee.error&&!ye&&(0,i.NF)(Ee.error)&&V(Ee.error.data.status))return(0,t.jsx)(N,{error:Ee.error,dashboard:Xe,dashboardSaveModel:ge.clone,onDismiss:Je,setErrorIsHandled:Pe});let ft="Save dashboard";return pt?ft="Save dashboard copy":ve&&(ft="Provisioned dashboard"),(0,t.jsxs)(r._,{title:ft,onClose:Je,subtitle:Xe.title,tabs:(0,t.jsxs)(f.U,{children:[(0,t.jsx)(a.o,{label:"Details",active:!xe,onChangeTab:()=>Ae(!1)}),ge.hasChanges&&(0,t.jsx)(a.o,{label:"Changes",active:xe,onChangeTab:()=>Ae(!0),counter:ge.diffCount})]}),children:[at(),s.$.featureToggles.showDashboardValidationWarnings&&(0,t.jsx)(d,{dashboard:Xe})]})}},35280:(G,O,e)=>{"use strict";e.d(O,{D:()=>m});var t=e(74848),n=e(96540),i=e(94701),s=e(14110),r=e(88575),f=e(15292),a=e(21744),c=e(37390),o=e(10534),h=e(8484),g=e(7758),l=e(87895),p=e(22699);function m({panel:y,dashboard:d,range:v,buildIframe:u=p.CF}){const[D,P]=(0,n.useState)(!0),[x,E]=(0,n.useState)("current"),[C,M]=(0,n.useState)("");(0,i.A)(()=>{(0,s.rR)("grafana_dashboards_embed_share_viewed",{shareResource:(0,p.hD)(y)})}),(0,n.useEffect)(()=>{const A=u(D,d.uid,x,y,v);M(A)},[x,D,d,y,v,u]);const S=A=>{M(A.currentTarget.value)},I=()=>{P(A=>!A)},T=A=>{E(A)},R=d.time.to==="now"?(0,h.t)("share-modal.embed.time-range-description","Transforms the current relative time range to an absolute time range"):"";return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"share-modal-info-text",children:(0,t.jsx)(h.x6,{i18nKey:"share-modal.embed.info",children:"Generate HTML for embedding an iframe with this panel."})}),(0,t.jsx)(r.D,{label:(0,h.t)("share-modal.embed.time-range","Current time range"),description:R,children:(0,t.jsx)(f.d,{id:"share-current-time-range",value:D,onChange:I})}),(0,t.jsx)(l.w,{selectedTheme:x,onChange:T}),(0,t.jsx)(r.D,{label:(0,h.t)("share-modal.embed.html","Embed HTML"),description:(0,h.t)("share-modal.embed.html-description","The HTML code below can be pasted and included in another web page. Unless anonymous access is enabled, the user viewing that page need to be signed into Grafana for the graph to load."),children:(0,t.jsx)(a.f,{"data-testid":"share-embed-html",id:"share-panel-embed-embed-html-textarea",rows:5,value:C,onChange:S})}),(0,t.jsx)(c.a.ButtonRow,{children:(0,t.jsx)(o.b,{icon:"copy",variant:"primary",getText:()=>C,onClipboardCopy:()=>{g.c.embedSnippetCopy({currentTimeRange:D,theme:x,shareResource:(0,p.hD)(y)})},children:(0,t.jsx)(h.x6,{i18nKey:"share-modal.embed.copy",children:"Copy to clipboard"})})})]})}},86394:(G,O,e)=>{"use strict";e.d(O,{j:()=>a});var t=e(74848),n=e(96540),i=e(14110),s=e(8484),r=e(96227),f=e(22699);const a=({panel:c,initialFolderUid:o,onCreateLibraryPanel:h,onDismiss:g})=>((0,n.useEffect)(()=>{(0,i.rR)("grafana_dashboards_library_panel_share_viewed",{shareResource:(0,f.hD)(c)})},[c]),c?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"share-modal-info-text",children:(0,t.jsx)(s.x6,{i18nKey:"share-modal.library.info",children:"Create library panel."})}),(0,t.jsx)(r.b,{panel:c,initialFolderUid:o,onCreateLibraryPanel:h,onDismiss:g})]}):null)},7686:(G,O,e)=>{"use strict";e.d(O,{Zy:()=>le});var t=e(74848),n=e(96540),i=e(25897),s=e(37390),r=e(40980),f=e(40845),a=e(2913),c=e(10096),o=e(8484),h=e(4785),g=e(72254),l=e(7758),p=e(82792),m=e(35280),y=e(4213),d=e(88575),v=e(15292),u=e(55852),D=e(15858),P=e(28444),x=e(70713),E=e(32372),C=e(10534);function M({json:ie,onDismiss:ae}){const re=(0,n.useCallback)(()=>ie,[ie]);return(0,t.jsxs)(s.a,{title:"JSON",onDismiss:ae,onClickBackdrop:ae,isOpen:!0,children:[(0,t.jsx)(x.Ay,{disableHeight:!0,children:({width:ce})=>(0,t.jsx)(E.B,{value:ie,language:"json",showMiniMap:!1,height:"500px",width:ce})}),(0,t.jsx)(s.a.ButtonRow,{children:(0,t.jsx)(C.b,{icon:"copy",getText:re,onClipboardCopy:()=>{l.c.exportCopyJsonClicked()},children:(0,t.jsx)(o.x6,{i18nKey:"share-modal.view-json.copy-button",children:"Copy to Clipboard"})})})]})}var S=e(22699);class I extends n.PureComponent{constructor(ae){super(ae),this.onShareExternallyChange=()=>{this.setState({shareExternally:!this.state.shareExternally})},this.onSaveAsFile=()=>{const{dashboard:re}=this.props,{shareExternally:ce}=this.state;l.c.exportSaveJsonClicked({externally:ce,shareResource:(0,S.hD)(this.props.panel)}),ce?this.exporter.makeExportable(re).then(me=>{this.openSaveAsDialog(me)}):this.openSaveAsDialog(re.getSaveModelClone())},this.onViewJson=()=>{const{dashboard:re}=this.props,{shareExternally:ce}=this.state;l.c.exportViewJsonClicked({externally:ce,shareResource:(0,S.hD)(this.props.panel)}),ce?this.exporter.makeExportable(re).then(me=>{this.openJsonModal(me)}):this.openJsonModal(re.getSaveModelClone())},this.openSaveAsDialog=re=>{const ce=JSON.stringify(re,null,2),me=new Blob([ce],{type:"application/json;charset=utf-8"}),ee=new Date().getTime();(0,y.saveAs)(me,`${re.title}-${ee}.json`)},this.openJsonModal=re=>{c.lE.publish(new P.S8({props:{json:JSON.stringify(re,null,2)},component:M})),this.props.onDismiss?.()},this.state={shareExternally:!1},this.exporter=new D.M}render(){const{onDismiss:ae}=this.props,{shareExternally:re}=this.state,ce=(0,o.t)("share-modal.export.share-externally-label","Export for sharing externally");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"share-modal-info-text",children:(0,t.jsx)(o.x6,{i18nKey:"share-modal.export.info-text",children:"Export this dashboard."})}),(0,t.jsx)(d.D,{label:ce,children:(0,t.jsx)(v.d,{id:"share-externally-toggle",value:re,onChange:this.onShareExternallyChange})}),(0,t.jsxs)(s.a.ButtonRow,{children:[(0,t.jsx)(u.$n,{variant:"secondary",onClick:ae,fill:"outline",children:(0,t.jsx)(o.x6,{i18nKey:"share-modal.export.cancel-button",children:"Cancel"})}),(0,t.jsx)(u.$n,{variant:"secondary",onClick:this.onViewJson,children:(0,t.jsx)(o.x6,{i18nKey:"share-modal.export.view-button",children:"View JSON"})}),(0,t.jsx)(u.$n,{variant:"primary",onClick:this.onSaveAsFile,children:(0,t.jsx)(o.x6,{i18nKey:"share-modal.export.save-button",children:"Save to file"})})]})]})}}var T=e(86394),b=e(13544),R=e(84167),A=e(10354),L=e(72109),U=e(42418),W=e(87895);class w extends n.PureComponent{constructor(ae){super(ae),this.buildUrl=async()=>{const{panel:re,dashboard:ce}=this.props,{useCurrentTimeRange:me,useShortUrl:ee,selectedTheme:de}=this.state,De=await(0,S.Xe)(me,de,re,ee),fe=(0,S.Lb)(me,ce.uid,de,re);this.setState({shareUrl:De,imageUrl:fe})},this.onUseCurrentTimeRangeChange=()=>{this.setState({useCurrentTimeRange:!this.state.useCurrentTimeRange})},this.onUrlShorten=()=>{this.setState({useShortUrl:!this.state.useShortUrl})},this.onThemeChange=re=>{this.setState({selectedTheme:re})},this.getShareUrl=()=>this.state.shareUrl,this.onCopy=()=>{l.c.shareLinkCopied({currentTimeRange:this.state.useCurrentTimeRange,theme:this.state.selectedTheme,shortenURL:this.state.useShortUrl,shareResource:(0,S.hD)(this.props.panel)})},this.state={useCurrentTimeRange:!0,useShortUrl:!1,selectedTheme:"current",shareUrl:"",imageUrl:""}}componentDidMount(){this.buildUrl()}componentDidUpdate(ae,re){const{useCurrentTimeRange:ce,useShortUrl:me,selectedTheme:ee}=this.state;(re.useCurrentTimeRange!==ce||re.selectedTheme!==ee||re.useShortUrl!==me)&&this.buildUrl()}render(){const{panel:ae,dashboard:re}=this.props,ce=re?re.time.to==="now":!1,{useCurrentTimeRange:me,useShortUrl:ee,selectedTheme:de,shareUrl:De,imageUrl:fe}=this.state,Te=b.Tp.pages.SharePanelModal,je=!!re.id,He=(0,o.t)("share-modal.link.time-range-label","Lock time range"),Be=(0,o.t)("share-modal.link.time-range-description","Transforms the current relative time range to an absolute time range"),Ne=(0,o.t)("share-modal.link.shorten-url","Shorten URL"),Re=(0,o.t)("share-modal.link.link-url","Link URL");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"share-modal-info-text",children:(0,t.jsx)(o.x6,{i18nKey:"share-modal.link.info-text",children:"Create a direct link to this dashboard or panel, customized with the options below."})}),(0,t.jsxs)(R.n,{children:[(0,t.jsx)(d.D,{label:He,description:ce?Be:"",children:(0,t.jsx)(v.d,{id:"share-current-time-range",value:me,onChange:this.onUseCurrentTimeRangeChange})}),(0,t.jsx)(W.w,{selectedTheme:de,onChange:this.onThemeChange}),(0,t.jsx)(d.D,{label:Ne,children:(0,t.jsx)(v.d,{id:"share-shorten-url",value:ee,onChange:this.onUrlShorten})}),(0,t.jsx)(d.D,{label:Re,children:(0,t.jsx)(A.p,{id:"link-url-input",value:De,readOnly:!0,addonAfter:(0,t.jsx)(C.b,{icon:"copy",variant:"primary",getText:this.getShareUrl,onClipboardCopy:this.onCopy,children:(0,t.jsx)(o.x6,{i18nKey:"share-modal.link.copy-link-button",children:"Copy"})})})})]}),ae&&a.Ay.rendererAvailable&&(0,t.jsxs)(t.Fragment,{children:[je&&(0,t.jsx)(L.Y,{href:fe,external:!0,icon:"camera","aria-label":Te.linkToRenderedImage,children:(0,o.t)("share-modal.link.rendered-image","Direct link rendered image")}),!je&&(0,t.jsx)(U.F,{severity:"info",title:(0,o.t)("share-modal.link.save-alert","Dashboard is not saved"),bottomSpacing:0,children:(0,t.jsx)(o.x6,{i18nKey:"share-modal.link.save-dashboard",children:"To render a panel image, you must save the dashboard first."})})]}),ae&&!a.Ay.rendererAvailable&&(0,t.jsx)(U.F,{severity:"info",title:(0,o.t)("share-modal.link.render-alert","Image renderer plugin not installed"),bottomSpacing:0,children:(0,t.jsxs)(o.x6,{i18nKey:"share-modal.link.render-instructions",children:["To render a panel image, you must install the"," ",(0,t.jsx)(L.Y,{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",external:!0,children:"Grafana image renderer plugin"}),". Please contact your Grafana administrator to install the plugin."]})})]})}}var N=e(92041),B=e(12470),V=e(17172),K=e(90182),H=e(67061),X=e(62930),k=e(74856),Y=e(69064);class Z extends n.PureComponent{constructor(ae){super(ae),this.createSnapshot=re=>()=>{const{timeoutSeconds:ce}=this.state;this.dashboard.snapshot={timestamp:new Date},this.setState({isLoading:!0}),this.dashboard.startRefresh(),setTimeout(()=>{this.saveSnapshot(this.dashboard,re)},ce*1e3)},this.saveSnapshot=async(re,ce)=>{const{snapshotExpires:me,timeoutSeconds:ee}=this.state,de=this.dashboard.getSaveModelCloneOld();this.scrubDashboard(de);const De={dashboard:de,name:de.title,expires:me,external:ce};try{const fe=await(0,Y.s)().create(De);this.setState({deleteUrl:fe.deleteUrl,snapshotUrl:fe.url,step:2})}finally{ce?l.c.publishSnapshotClicked({expires:me,timeout:ee,shareResource:(0,S.hD)(this.props.panel)}):l.c.publishSnapshotLocalClicked({expires:me,timeout:ee,shareResource:(0,S.hD)(this.props.panel)}),this.setState({isLoading:!1})}},this.scrubDashboard=re=>{const{panel:ce}=this.props,{snapshotName:me}=this.state;re.title=me,re.time=(0,k.jG)().timeRange(),re.links=[],re.panels.forEach(de=>{de.targets=[],de.links=[],de.datasource=null});const ee=re.annotations.list.filter(de=>de.enable);if(re.annotations.list=ee.map(de=>({name:de.name,enable:de.enable,iconColor:de.iconColor,snapshotData:de.snapshotData,type:de.type,builtIn:de.builtIn,hide:de.hide})),re.getVariables().forEach(de=>{"query"in de&&(de.query=""),"options"in de&&(de.options=de.current&&!(0,N.R)(de.current)?[de.current]:[]),"refresh"in de&&(de.refresh=B.CO.never)}),ce){const de=ce.getSaveModel();de.gridPos.w=24,de.gridPos.x=0,de.gridPos.y=0,de.gridPos.h=20,re.panels=[de]}delete this.dashboard.snapshot,this.dashboard.forEachPanel(de=>{delete de.snapshotData}),this.dashboard.annotations.list.forEach(de=>{delete de.snapshotData})},this.deleteSnapshot=async()=>{const{deleteUrl:re}=this.state;await(0,V.AI)().get(re),this.setState({step:3})},this.getSnapshotUrl=()=>this.state.snapshotUrl,this.onSnapshotNameChange=re=>{this.setState({snapshotName:re.target.value})},this.onTimeoutChange=re=>{this.setState({timeoutSeconds:Number(re.target.value)})},this.onExpireChange=re=>{this.setState({selectedExpireOption:re,snapshotExpires:re.value})},this.dashboard=ae.dashboard,this.expireOptions=[{label:(0,o.t)("share-modal.snapshot.expire-hour","1 Hour"),value:60*60},{label:(0,o.t)("share-modal.snapshot.expire-day","1 Day"),value:60*60*24},{label:(0,o.t)("share-modal.snapshot.expire-week","1 Week"),value:60*60*24*7},{label:(0,o.t)("share-modal.snapshot.expire-never","Never"),value:0}],this.state={isLoading:!1,step:1,selectedExpireOption:this.expireOptions[2],snapshotExpires:this.expireOptions[2].value,snapshotName:ae.dashboard.title,timeoutSeconds:4,snapshotUrl:"",deleteUrl:"",externalEnabled:!1,sharingButtonText:""}}componentDidMount(){this.getSnaphotShareOptions()}async getSnaphotShareOptions(){const ae=await(0,Y.s)().getSharingOptions();this.setState({sharingButtonText:ae.externalSnapshotName,externalEnabled:ae.externalEnabled})}renderStep1(){const{onDismiss:ae}=this.props,{snapshotName:re,selectedExpireOption:ce,timeoutSeconds:me,isLoading:ee,sharingButtonText:de,externalEnabled:De}=this.state,fe=(0,o.t)("share-modal.snapshot.name","Snapshot name"),Te=(0,o.t)("share-modal.snapshot.expire","Expire"),je=(0,o.t)("share-modal.snapshot.timeout","Timeout (seconds)"),He=(0,o.t)("share-modal.snapshot.timeout-description","You might need to configure the timeout value if it takes a long time to collect your dashboard metrics.");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"share-modal-info-text",children:(0,t.jsx)(o.x6,{i18nKey:"share-modal.snapshot.info-text-1",children:"A snapshot is an instant way to share an interactive dashboard publicly. When created, we strip sensitive data like queries (metric, template, and annotation) and panel links, leaving only the visible metric data and series names embedded in your dashboard."})}),(0,t.jsx)("p",{className:"share-modal-info-text",children:(0,t.jsxs)(o.x6,{i18nKey:"share-modal.snapshot.info-text-2",children:["Keep in mind, your snapshot ",(0,t.jsx)("em",{children:"can be viewed by anyone"})," that has the link and can access the URL. Share wisely."]})})]}),(0,t.jsx)(d.D,{label:fe,children:(0,t.jsx)(A.p,{id:"snapshot-name-input",width:30,value:re,onChange:this.onSnapshotNameChange})}),(0,t.jsx)(d.D,{label:Te,children:(0,t.jsx)(K.l6,{inputId:"expire-select-input",width:30,options:this.expireOptions,value:ce,onChange:this.onExpireChange})}),(0,t.jsx)(d.D,{label:je,description:He,children:(0,t.jsx)(A.p,{id:"timeout-input",type:"number",width:21,value:me,onChange:this.onTimeoutChange})}),(0,t.jsxs)(s.a.ButtonRow,{children:[(0,t.jsx)(u.$n,{variant:"secondary",onClick:ae,fill:"outline",children:(0,t.jsx)(o.x6,{i18nKey:"share-modal.snapshot.cancel-button",children:"Cancel"})}),De&&(0,t.jsx)(u.$n,{variant:"secondary",disabled:ee,onClick:this.createSnapshot(!0),children:de}),(0,t.jsx)(u.$n,{variant:"primary",disabled:ee,onClick:this.createSnapshot(),children:(0,t.jsx)(o.x6,{i18nKey:"share-modal.snapshot.local-button",children:"Publish Snapshot"})})]})]})}renderStep2(){const{snapshotUrl:ae}=this.state;return(0,t.jsxs)(H.B,{direction:"column",gap:0,children:[(0,t.jsx)(d.D,{label:(0,o.t)("share-modal.snapshot.url-label","Snapshot URL"),children:(0,t.jsx)(A.p,{id:"snapshot-url-input",value:ae,readOnly:!0,addonAfter:(0,t.jsx)(C.b,{icon:"copy",variant:"primary",getText:this.getSnapshotUrl,children:(0,t.jsx)(o.x6,{i18nKey:"share-modal.snapshot.copy-link-button",children:"Copy"})})})}),(0,t.jsxs)("div",{style:{alignSelf:"flex-end",padding:"5px"},children:[(0,t.jsx)(o.x6,{i18nKey:"share-modal.snapshot.mistake-message",children:"Did you make a mistake? "}),"\xA0",(0,t.jsx)(u.z9,{fill:"text",target:"_blank",onClick:this.deleteSnapshot,children:(0,t.jsx)(o.x6,{i18nKey:"share-modal.snapshot.delete-button",children:"Delete snapshot."})})]})]})}renderStep3(){return(0,t.jsx)("div",{className:"share-modal-header",children:(0,t.jsx)("p",{className:"share-modal-info-text",children:(0,t.jsx)(o.x6,{i18nKey:"share-modal.snapshot.deleted-message",children:"The snapshot has been deleted. If you have already accessed it once, then it might take up to an hour before before it is removed from browser caches or CDN caches."})})})}render(){const{isLoading:ae,step:re}=this.state;return(0,t.jsxs)(t.Fragment,{children:[re===1&&this.renderStep1(),re===2&&this.renderStep2(),re===3&&this.renderStep3(),ae&&(0,t.jsx)(X.y,{inline:!0})]})}}const se=[],j=[];function q(ie){se.push(ie)}function ne(ie){j.push(ie)}function oe(ie,ae,re){const me=[{label:(0,o.t)("share-modal.tab-title.link","Link"),value:S.wr.link,component:w}];if(c.TP.isSignedIn&&a.config.snapshotEnabled&&ie){const de=(0,o.t)("share-modal.tab-title.snapshot","Snapshot");me.push({label:de,value:S.wr.snapshot,component:Z})}if(ae){const de=(0,o.t)("share-modal.tab-title.embed","Embed");if(me.push({label:de,value:S.wr.embed,component:m.D}),!(0,p.X)(ae)){const De=(0,o.t)("share-modal.tab-title.library-panel","Library panel");me.push({label:De,value:S.wr.libraryPanel,component:T.j})}me.push(...j)}else{const de=(0,o.t)("share-modal.tab-title.export","Export");me.push({label:de,value:S.wr.export,component:I}),me.push(...se),(0,g.iR)()&&me.push({label:(0,o.t)("share-modal.tab-title.public-dashboard-title","Public dashboard"),value:S.wr.publicDashboard,component:h.b})}const ee=me.find(de=>de.value===re);return{tabs:me,activeTab:ee?.value??me[0].value}}function z(ie){const{tabs:ae,activeTab:re}=oe(ie.dashboard.canEditDashboard(),ie.panel,ie.activeTab);return{tabs:ae,activeTab:re}}class te extends n.Component{constructor(ae){super(ae),this.onSelectTab=re=>{this.setState(ce=>({...ce,activeTab:re.value})),l.c.sharingCategoryClicked({item:re.value,shareResource:(0,S.hD)(this.props.panel)})},this.state=z(ae)}getActiveTab(){const{tabs:ae,activeTab:re}=this.state;return ae.find(ce=>ce.value===re)}renderTitle(){const{panel:ae}=this.props,{activeTab:re}=this.state,ce=ae?(0,o.t)("share-modal.panel.title","Share Panel"):(0,o.t)("share-modal.dashboard.title","Share"),me=this.props.dashboard.canEditDashboard(),ee=oe(me,this.props.panel,this.state.activeTab).tabs;return(0,t.jsx)(i.J,{title:ce,icon:"share-alt",tabs:ee,activeTab:re,onChangeTab:this.onSelectTab})}render(){const{dashboard:ae,panel:re}=this.props,me=this.getActiveTab().component;return(0,t.jsx)(s.a,{isOpen:!0,title:this.renderTitle(),onDismiss:this.props.onDismiss,children:(0,t.jsx)(r.J,{children:(0,t.jsx)(me,{dashboard:ae,panel:re,onDismiss:this.props.onDismiss})})})}}const le=(0,f.cV)(te)},59037:(G,O,e)=>{"use strict";e.d(O,{K:()=>ce,b:()=>re});var t=e(74848),n=e(32196),i=e(49785),s=e(13544),r=e(40845),f=e(88575),a=e(10354),c=e(10534),o=e(15292),h=e(60029),g=e(66864),l=e(55852),p=e(71678),m=e(8484),y=e(72686),d=e(21380),v=e(7758),u=e(90591),D=e(16233),P=e(31678),x=e(52908);const E=()=>{const{width:ee}=(0,x.A)();return ee>1024};var C=e(7686),M=e(22699),S=e(29304),I=e(42418);const T=()=>(0,t.jsx)(I.F,{title:(0,m.t)("public-dashboard.modal-alerts.save-dashboard-changes-alert-title","Please save your dashboard changes before updating the public configuration"),severity:"warning",bottomSpacing:0});var b=e(12257),R=e(10872),A=e(72254),L=e(84167),U=e(54230);const W=s.Tp.pages.ShareDashboardModal.PublicDashboard,w=({disabled:ee,onChange:de,register:De,timeRange:fe})=>(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(L.n,{disabled:ee,children:(0,t.jsxs)(g.gW,{spacing:"md",children:[(0,t.jsxs)(g.PE,{orientation:1,spacing:"xs",justify:"space-between",children:[(0,t.jsx)(h.J,{description:(0,m.t)("public-dashboard.settings-configuration.default-time-range-label-desc","The public dashboard uses the default time range settings of the dashboard"),children:(0,t.jsx)(m.x6,{i18nKey:"public-dashboard.settings-configuration.default-time-range-label",children:"Default time range"})}),(0,t.jsx)(U.b,{value:fe,disabled:!0,onChange:()=>{}})]}),(0,t.jsxs)(g.PE,{orientation:0,spacing:"sm",children:[(0,t.jsx)(o.d,{...De("isTimeSelectionEnabled"),"data-testid":W.EnableTimeRangeSwitch,onChange:Te=>{de("isTimeSelectionEnabled",Te.currentTarget.checked),v.c.publicDashboardTimeSelectionChanged({enabled:Te.currentTarget.checked})}}),(0,t.jsx)(h.J,{description:(0,m.t)("public-dashboard.settings-configuration.time-range-picker-label-desc","Allow viewers to change time range"),children:(0,t.jsx)(m.x6,{i18nKey:"public-dashboard.settings-configuration.time-range-picker-label",children:"Time range picker enabled"})})]}),(0,t.jsxs)(g.PE,{orientation:0,spacing:"sm",children:[(0,t.jsx)(o.d,{...De("isAnnotationsEnabled"),onChange:Te=>{de("isAnnotationsEnabled",Te.currentTarget.checked),v.c.publicDashboardAnnotationsSelectionChanged({enabled:Te.currentTarget.checked})},"data-testid":W.EnableAnnotationsSwitch}),(0,t.jsx)(h.J,{description:(0,m.t)("public-dashboard.settings-configuration.show-annotations-label-desc","Show annotations on public dashboard"),children:(0,t.jsx)(m.x6,{i18nKey:"public-dashboard.settings-configuration.show-annotations-label",children:"Show annotations"})})]})]})})});var N=e(19727),B=e(94354),V=e(62930),K=e(34842);const H=s.Tp.pages.ShareDashboardModal.PublicDashboard.EmailSharingConfiguration,X=({recipients:ee,dashboardUid:de,publicDashboardUid:De})=>{const fe=(0,r.of)(Y),[Te,{isLoading:je}]=(0,y.$L)(),[He,{isLoading:Be}]=(0,y.NA)(),Ne=je||Be,Re=(We,Ke)=>{v.c.revokePublicDashboardEmailClicked(),Te({recipientUid:We,recipientEmail:Ke,dashboardUid:de,uid:De})},Se=We=>{v.c.resendPublicDashboardEmailClicked(),He({recipientUid:We,uid:De})};return(0,t.jsx)("table",{className:fe.table,"data-testid":H.EmailSharingList,children:(0,t.jsx)("tbody",{children:ee.map((We,Ke)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:We.recipient}),(0,t.jsx)("td",{children:(0,t.jsxs)(N.e,{className:fe.tableButtonsContainer,children:[(0,t.jsx)(l.$n,{type:"button",variant:"destructive",fill:"text",title:(0,m.t)("public-dashboard.email-sharing.revoke-button-title","Revoke"),size:"sm",disabled:Ne,onClick:()=>Re(We.uid,We.recipient),"data-testid":`${H.DeleteEmail}-${Ke}`,children:(0,t.jsx)(m.x6,{i18nKey:"public-dashboard.email-sharing.revoke-button",children:"Revoke"})}),(0,t.jsx)(l.$n,{type:"button",variant:"primary",fill:"text",title:(0,m.t)("public-dashboard.email-sharing.resend-button-title","Resend"),size:"sm",disabled:Ne,onClick:()=>Se(We.uid),"data-testid":`${H.ReshareLink}-${Ke}`,children:(0,t.jsx)(m.x6,{i18nKey:"public-dashboard.email-sharing.resend-button",children:"Resend"})})]})})]},We.uid))})})},k=({dashboard:ee})=>{const{width:de}=(0,x.A)(),De=(0,r.of)(Y),fe=ee instanceof K.H$?ee.state.uid:ee.uid,{data:Te}=(0,y.Bs)(fe),[je]=(0,y.ft)(),[He,{isLoading:Be}]=(0,y.NY)(),Ne=D.TP.hasPermission(P.AccessControlAction.DashboardsPublicWrite),{register:Re,setValue:Se,control:We,watch:Ke,handleSubmit:Xe,formState:{errors:Je},reset:st}=(0,i.mN)({defaultValues:{shareType:Te?.share||A.Xo.PUBLIC,email:""},mode:"onSubmit"}),pt=ot=>{const $e={dashboard:ee,payload:{...Te,share:ot}};je($e)},xt=async ot=>{v.c.publicDashboardEmailInviteClicked(),await He({recipient:ot.email,uid:Te.uid,dashboardUid:fe}).unwrap(),st({email:"",shareType:A.Xo.EMAIL})};return(0,t.jsx)("form",{onSubmit:Xe(xt),children:(0,t.jsxs)(L.n,{disabled:!Ne,"data-testid":H.Container,className:De.container,children:[(0,t.jsx)(f.D,{label:(0,m.t)("public-dashboard.config.can-view-dashboard-radio-button-label","Can view dashboard"),className:De.field,children:(0,t.jsx)(i.xI,{name:"shareType",control:We,render:({field:ot})=>{const{ref:$e,...ve}=ot,be=[{label:(0,m.t)("public-dashboard.config.public-share-type-option-label","Anyone with a link"),value:A.Xo.PUBLIC},{label:(0,m.t)("public-dashboard.config.email-share-type-option-label","Only specified people"),value:A.Xo.EMAIL}];return(0,t.jsx)(B.z,{...ve,size:de<480?"sm":"md",options:be,onChange:he=>{v.c.publicDashboardShareTypeChange({shareType:he===A.Xo.EMAIL?"email":"public"}),Se("shareType",he),pt(he)}})}})}),Ke("shareType")===A.Xo.EMAIL&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.D,{label:(0,m.t)("public-dashboard.email-sharing.invite-field-label","Invite"),description:(0,m.t)("public-dashboard.email-sharing.invite-field-desc","Invite people by email"),error:Je.email?.message,invalid:!!Je.email?.message||void 0,className:De.field,children:(0,t.jsxs)("div",{className:De.emailContainer,children:[(0,t.jsx)(a.p,{className:De.emailInput,placeholder:"email",autoCapitalize:"none",...Re("email",{required:(0,m.t)("public-dashboard.email-sharing.input-required-email-text","Email is required"),pattern:{value:A._l,message:(0,m.t)("public-dashboard.email-sharing.input-invalid-email-text","Invalid email")}}),"data-testid":H.EmailSharingInput}),(0,t.jsxs)(l.$n,{type:"submit",variant:"primary",disabled:Be,"data-testid":H.EmailSharingInviteButton,children:[(0,t.jsx)(m.x6,{i18nKey:"public-dashboard.email-sharing.invite-button",children:"Invite"}),Be&&(0,t.jsx)(V.y,{})]})]})}),!!Te?.recipients?.length&&(0,t.jsx)(X,{recipients:Te.recipients,dashboardUid:fe,publicDashboardUid:Te.uid})]})]})})},Y=ee=>({container:(0,n.css)({label:"emailConfigContainer",display:"flex",flexDirection:"column",flexWrap:"wrap",gap:ee.spacing(3)}),field:(0,n.css)({label:"field-noMargin",marginBottom:0}),emailContainer:(0,n.css)({label:"emailContainer",display:"flex",gap:ee.spacing(1)}),emailInput:(0,n.css)({label:"emailInput",flexGrow:1}),table:(0,n.css)({label:"table",display:"flex",maxHeight:"220px",overflowY:"scroll","& tbody":{display:"flex",flexDirection:"column",flexGrow:1},"& tr":{minHeight:"40px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:ee.spacing(.5,1),":nth-child(odd)":{background:ee.colors.background.secondary}}}),tableButtonsContainer:(0,n.css)({display:"flex",justifyContent:"end"})});var Z=e(96540),se=e(67892),j=e(29158);function q({headerElement:ee,isContentVisible:de=!1,onRowToggle:De,title:fe,...Te}){const je=(0,r.of)(ne),He=ee&&se.renderOrCallToRender(ee,{className:je.summaryWrapper});return(0,t.jsx)("div",{className:je.wrapper,children:(0,t.jsxs)("div",{className:je.header,children:[(0,t.jsx)(j.K,{name:de?"angle-down":"angle-right",tooltip:de?(0,m.t)("public-dashboard.settings-bar-header.collapse-settings-tooltip","Collapse settings"):(0,m.t)("public-dashboard.settings-bar-header.expand-settings-tooltip","Expand settings"),className:je.collapseIcon,onClick:De,"aria-expanded":de,...Te}),fe&&(0,t.jsx)("div",{className:je.titleWrapper,onClick:De,children:(0,t.jsx)("span",{className:je.title,children:fe})}),He]})})}q.displayName="SettingsBarHeader";function ne(ee){return{wrapper:(0,n.css)({label:"header",padding:ee.spacing(.5,.5),borderRadius:ee.shape.radius.default,background:ee.colors.background.secondary,minHeight:ee.spacing(4),"&:focus":{outline:"none"}}),header:(0,n.css)({label:"column",display:"flex",alignItems:"center",whiteSpace:"nowrap"}),collapseIcon:(0,n.css)({marginLeft:ee.spacing(.5),color:ee.colors.text.disabled}),titleWrapper:(0,n.css)({display:"flex",alignItems:"center",cursor:"pointer",overflow:"hidden",marginRight:`${ee.spacing(.5)}`,[ee.breakpoints.down("sm")]:{flex:"1 1"}}),title:(0,n.css)({fontWeight:ee.typography.fontWeightBold,marginLeft:ee.spacing(.5),overflow:"hidden",textOverflow:"ellipsis"}),summaryWrapper:(0,n.css)({display:"flex",flexWrap:"wrap",[ee.breakpoints.down("sm")]:{flex:"2 2"}})}}function oe({children:ee,title:de,headerElement:De,...fe}){const Te=(0,r.of)(z),[je,He]=(0,Z.useState)(!1);function Be(){He(Ne=>!Ne)}return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(q,{onRowToggle:Be,isContentVisible:je,title:de,headerElement:De,...fe}),je&&(0,t.jsx)("div",{className:Te.content,children:ee})]})}oe.displayName="SettingsBar";const z=ee=>({content:(0,n.css)({marginTop:ee.spacing(1),marginLeft:ee.spacing(4)})});var te=e(3799);function le({className:ee,isDataLoading:de=!1,timeRange:De,timeSelectionEnabled:fe,annotationsEnabled:Te}){const je=(0,r.of)(ie),He=(0,m.t)("public-dashboard.settings-summary.time-range-picker-enabled-text","Time range picker = enabled"),Be=(0,m.t)("public-dashboard.settings-summary.time-range-picker-disabled-text","Time range picker = disabled"),Ne=(0,m.t)("public-dashboard.settings-summary.annotations-show-text","Annotations = show"),Re=(0,m.t)("public-dashboard.settings-summary.annotations-hide-text","Annotations = hide");return de?(0,t.jsx)("div",{className:(0,n.cx)(je.summaryWrapper,ee),children:(0,t.jsx)(V.y,{className:je.summary,inline:!0,size:"sm"})}):(0,t.jsxs)("div",{className:(0,n.cx)(je.summaryWrapper,ee),children:[(0,t.jsxs)("span",{className:je.summary,children:[(0,t.jsx)(m.x6,{i18nKey:"public-dashboard.settings-summary.time-range-text",children:"Time range = "}),(0,t.jsx)(te.f,{className:je.timeRange,value:De})]}),(0,t.jsx)("span",{className:je.summary,children:fe?He:Be}),(0,t.jsx)("span",{className:je.summary,children:Te?Ne:Re})]})}le.displayName="SettingsSummary";const ie=ee=>({summaryWrapper:(0,n.css)({display:"flex"}),summary:(0,n.css)({label:"collapsedText",marginLeft:`${ee.spacing.gridSize*2}px`,fontSize:ee.typography.bodySmall.fontSize,color:ee.colors.text.secondary}),timeRange:(0,n.css)({display:"inline-block"})}),ae=s.Tp.pages.ShareDashboardModal.PublicDashboard;function re({onRevoke:ee,timeRange:de,hasTemplateVariables:De=!1,showSaveChangesAlert:fe=!1,unsupportedDatasources:Te=[],publicDashboard:je,dashboard:He}){const Be=(0,r.of)(me),Ne=E(),[Re,{isLoading:Se}]=(0,y.T2)(),[We,{isLoading:Ke}]=(0,y.eq)(),Xe=D.TP.hasPermission(P.AccessControlAction.DashboardsPublicWrite),Je=!Xe||Se||Ke,{handleSubmit:st,setValue:pt,register:xt}=(0,i.mN)({defaultValues:{isAnnotationsEnabled:je?.annotationsEnabled,isTimeSelectionEnabled:je?.timeSelectionEnabled,isPaused:!je?.isEnabled}}),ot=async ye=>{const{isAnnotationsEnabled:Pe,isTimeSelectionEnabled:ge,isPaused:xe}=ye;Re({dashboard:He,payload:{...je,annotationsEnabled:Pe,timeSelectionEnabled:ge,isEnabled:!xe}})},$e=async ye=>{const{isAnnotationsEnabled:Pe,isTimeSelectionEnabled:ge,isPaused:xe}=ye;We({dashboard:He,payload:{...je,annotationsEnabled:Pe,timeSelectionEnabled:ge,isEnabled:!xe}})},ve=async(ye,Pe)=>{pt(ye,Pe),await st(ge=>ot(ge))()},be=async ye=>{pt("isPaused",ye),await st(Pe=>$e(Pe))()};function he(){v.c.publicDashboardUrlCopied()}return(0,t.jsxs)("div",{className:Be.configContainer,children:[fe&&(0,t.jsx)(T,{}),!Xe&&(0,t.jsx)(S.t,{mode:"edit"}),De&&(0,t.jsx)(R.D,{}),Te.length>0&&(0,t.jsx)(b.s,{unsupportedDataSources:Te.join(", ")}),(0,A.AY)()&&(0,t.jsx)(k,{dashboard:He}),(0,t.jsx)(f.D,{label:(0,m.t)("public-dashboard.config.dashboard-url-field-label","Dashboard URL"),className:Be.fieldSpace,children:(0,t.jsx)(a.p,{value:(0,A.mL)(je.accessToken),readOnly:!0,disabled:!je?.isEnabled,"data-testid":ae.CopyUrlInput,addonAfter:(0,t.jsx)(c.b,{"data-testid":ae.CopyUrlButton,variant:"primary",disabled:!je?.isEnabled,getText:()=>(0,A.mL)(je.accessToken),onClipboardCopy:he,children:(0,t.jsx)(m.x6,{i18nKey:"public-dashboard.config.copy-button",children:"Copy"})})})}),(0,t.jsx)(f.D,{className:Be.fieldSpace,children:(0,t.jsxs)(g.PE,{children:[(0,t.jsx)(o.d,{...xt("isPaused"),disabled:Je,onChange:ye=>{v.c.publicDashboardPauseSharingClicked({paused:ye.currentTarget.checked}),be(ye.currentTarget.checked)},"data-testid":ae.PauseSwitch}),(0,t.jsx)(h.J,{className:(0,n.css)({marginBottom:0}),children:(0,t.jsx)(m.x6,{i18nKey:"public-dashboard.config.pause-sharing-dashboard-label",children:"Pause sharing dashboard"})})]})}),(0,t.jsx)(f.D,{className:Be.fieldSpace,children:(0,t.jsx)(oe,{title:(0,m.t)("public-dashboard.config.settings-title","Settings"),headerElement:({className:ye})=>(0,t.jsx)(le,{className:ye,isDataLoading:Se,timeRange:de,timeSelectionEnabled:je?.timeSelectionEnabled,annotationsEnabled:je?.annotationsEnabled}),"data-testid":ae.SettingsDropdown,children:(0,t.jsx)(w,{disabled:Je,onChange:ve,register:xt,timeRange:de})})}),(0,t.jsx)(g.PE,{orientation:Ne?0:1,justify:Ne?"flex-end":"flex-start",align:Ne?"center":"normal",children:(0,t.jsx)(g.Gy,{justify:"flex-end",children:(0,t.jsx)(l.$n,{title:(0,m.t)("public-dashboard.config.revoke-public-URL-button-title","Revoke public URL"),onClick:ee,type:"button",disabled:Je,"data-testid":ae.DeleteButton,variant:"destructive",fill:"outline",children:(0,t.jsx)(m.x6,{i18nKey:"public-dashboard.config.revoke-public-URL-button",children:"Revoke public URL"})})})})]})}function ce({publicDashboard:ee,unsupportedDatasources:de}){const fe=(0,P.useSelector)(Re=>Re.dashboard).getModel(),Te=(0,d.z)(fe.getDefaultTime(),fe),je=D.TP.hasPermission(P.AccessControlAction.DashboardsPublicWrite),He=(0,A.kD)(fe.getVariables()),[Be]=(0,y.bN)(),Ne=Re=>{Be({dashboard:fe,uid:ee.uid,dashboardUid:fe.uid}),Re()};return(0,t.jsx)(p.$s,{children:({showModal:Re,hideModal:Se})=>(0,t.jsx)(re,{publicDashboard:ee,dashboard:fe,unsupportedDatasources:de,timeRange:Te,showSaveChangesAlert:je&&fe.hasUnsavedChanges(),hasTemplateVariables:He,onRevoke:()=>{v.c.revokePublicDashboardClicked(),Re(u.m,{dashboardTitle:fe.title,onConfirm:()=>Ne(Se),onDismiss:()=>{Re(C.Zy,{dashboard:fe,onDismiss:Se,activeTab:M.wr.publicDashboard})}})}})})}const me=ee=>({configContainer:(0,n.css)({label:"config container",display:"flex",flexDirection:"column",flexWrap:"wrap",gap:ee.spacing(3)}),fieldSpace:(0,n.css)({label:"field space",width:"100%",marginBottom:0}),timeRange:(0,n.css)({display:"inline-block"})})},22234:(G,O,e)=>{"use strict";e.d(O,{M:()=>I,D:()=>S});var t=e(74848),n=e(32196),i=e(49785),s=e(13544),r=e(40845),f=e(55852),a=e(62930),c=e(8484),o=e(16233),h=e(72686),g=e(7758),l=e(31678),p=e(29304),m=e(12257),y=e(10872),d=e(72254),v=e(71415),u=e(84167),D=e(66864),P=e(10880);const x=s.Tp.pages.ShareDashboardModal.PublicDashboard,E=({disabled:b,register:R})=>{const A=(0,r.of)(C),L=[{type:"publicAcknowledgment",description:(0,c.t)("public-dashboard.acknowledgment-checkboxes.public-ack-desc","Your entire dashboard will be public*"),testId:x.WillBePublicCheckbox,info:{href:"https://grafana.com/docs/grafana/latest/dashboards/dashboard-public/",tooltip:(0,c.t)("public-dashboard.acknowledgment-checkboxes.public-ack-tooltip","Learn more about public dashboards")}},{type:"dataSourcesAcknowledgment",description:(0,c.t)("public-dashboard.acknowledgment-checkboxes.data-src-ack-desc","Publishing currently only works with a subset of data sources*"),testId:x.LimitedDSCheckbox,info:{href:"https://grafana.com/docs/grafana/latest/datasources/",tooltip:(0,c.t)("public-dashboard.acknowledgment-checkboxes.data-src-ack-tooltip","Learn more about public datasources")}},{type:"usageAcknowledgment",description:(0,c.t)("public-dashboard.acknowledgment-checkboxes.usage-ack-desc","Making a dashboard public will cause queries to run each time it is viewed, which may increase costs*"),testId:x.CostIncreaseCheckbox,info:{href:"https://grafana.com/docs/grafana/latest/enterprise/query-caching/",tooltip:(0,c.t)("public-dashboard.acknowledgment-checkboxes.usage-ack-desc-tooltip","Learn more about query caching")}}];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:A.title,children:(0,t.jsx)(c.x6,{i18nKey:"public-dashboard.acknowledgment-checkboxes.ack-title",children:"Before you make the dashboard public, acknowledge the following:"})}),(0,t.jsx)(u.n,{disabled:b,children:(0,t.jsx)(D.gW,{spacing:"md",children:L.map(U=>(0,t.jsxs)(D.Gy,{spacing:"none",align:"center",children:[(0,t.jsx)(P.S,{...R(U.type,{required:!0}),label:U.description,"data-testid":U.testId}),(0,t.jsx)(f.z9,{variant:"primary",href:U.info.href,target:"_blank",fill:"text",icon:"info-circle",rel:"noopener noreferrer",tooltip:U.info.tooltip})]},U.type))})})]})},C=b=>({title:(0,n.css)({fontWeight:b.typography.fontWeightBold})}),M=s.Tp.pages.ShareDashboardModal.PublicDashboard,S=({unsupportedDatasources:b=[],unsupportedTemplateVariables:R=!1,dashboard:A,hasError:L=!1})=>{const U=(0,r.of)(T),W=o.TP.hasPermission(l.AccessControlAction.DashboardsPublicWrite),[w,{isLoading:N,isError:B}]=(0,h.U9)(),V=()=>{w({dashboard:A,payload:{isEnabled:!0}}),g.c.generatePublicDashboardUrlClicked({})},{handleSubmit:K,register:H,formState:{isValid:X}}=(0,i.mN)({mode:"onChange"}),k=!W||N||B||L;return(0,t.jsxs)("div",{className:U.container,children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:U.title,children:(0,t.jsx)(c.x6,{i18nKey:"public-dashboard.create-page.welcome-title",children:"Welcome to public dashboards!"})}),(0,t.jsx)("p",{className:U.description,children:(0,t.jsx)(c.x6,{i18nKey:"public-dashboard.create-page.unsupported-features-desc",children:"Currently, we don\u2019t support template variables or frontend data sources"})})]}),!W&&(0,t.jsx)(p.t,{mode:"create"}),R&&(0,t.jsx)(y.D,{}),b.length>0&&(0,t.jsx)(m.s,{unsupportedDataSources:b.join(", ")}),(0,t.jsxs)("form",{onSubmit:K(V),children:[(0,t.jsx)("div",{className:U.checkboxes,children:(0,t.jsx)(E,{disabled:k,register:H})}),(0,t.jsx)("div",{className:U.buttonContainer,children:(0,t.jsxs)(f.$n,{type:"submit",disabled:k||!X,"data-testid":M.CreateButton,children:[(0,t.jsx)(c.x6,{i18nKey:"public-dashboard.create-page.generate-public-url-button",children:"Generate public URL"}),N&&(0,t.jsx)(a.y,{className:U.loadingSpinner})]})})]})]})};function I({hasError:b}){const A=(0,l.useSelector)(W=>W.dashboard).getModel(),{unsupportedDataSources:L}=(0,v.Z)(A),U=(0,d.kD)(A.getVariables());return(0,t.jsx)(S,{dashboard:A,unsupportedDatasources:L,unsupportedTemplateVariables:U,hasError:b})}const T=b=>({container:(0,n.css)({display:"flex",flexDirection:"column",gap:b.spacing(4)}),title:(0,n.css)({fontSize:b.typography.h4.fontSize,margin:b.spacing(0,0,2)}),description:(0,n.css)({color:b.colors.text.secondary,marginBottom:b.spacing(0)}),checkboxes:(0,n.css)({margin:b.spacing(0,0,4)}),buttonContainer:(0,n.css)({display:"flex",justifyContent:"end"}),loadingSpinner:(0,n.css)({marginLeft:b.spacing(1)})})},29304:(G,O,e)=>{"use strict";e.d(O,{t:()=>f});var t=e(74848),n=e(13544),i=e(42418),s=e(8484);const r=n.Tp.pages.ShareDashboardModal.PublicDashboard,f=({mode:a})=>(0,t.jsx)(i.F,{severity:"warning",title:(0,s.t)("public-dashboard.modal-alerts.no-upsert-perm-alert-title","You don\u2019t have permission to {{ mode }} a public dashboard",{mode:a}),"data-testid":r.NoUpsertPermissionsWarningAlert,bottomSpacing:0,children:(0,t.jsxs)(s.x6,{i18nKey:"public-dashboard.modal-alerts.no-upsert-perm-alert-desc",children:["Contact your admin to get permission to ",{mode:a}," public dashboards"]})})},12257:(G,O,e)=>{"use strict";e.d(O,{s:()=>h});var t=e(74848),n=e(32196),i=e(46942),s=e.n(i),r=e(13544),f=e(40845),a=e(42418),c=e(8484);const o=r.Tp.pages.ShareDashboardModal.PublicDashboard,h=({unsupportedDataSources:l})=>{const p=(0,f.of)(g);return(0,t.jsxs)(a.F,{severity:"warning",title:(0,c.t)("public-dashboard.modal-alerts.unsupported-data-source-alert-title","Unsupported data sources"),"data-testid":o.UnsupportedDataSourcesWarningAlert,bottomSpacing:0,children:[(0,t.jsx)("p",{className:p.unsupportedDataSourceDescription,children:(0,t.jsxs)(c.x6,{i18nKey:"public-dashboard.modal-alerts.unsupported-data-source-alert-desc",children:["There are data sources in this dashboard that are unsupported for public dashboards. Panels that use these data sources may not function properly: ",{unsupportedDataSources:l},"."]})}),(0,t.jsx)("a",{href:"https://grafana.com/docs/grafana/next/dashboards/dashboard-public/",target:"blank",className:s()("text-link",p.unsupportedDataSourceDescription),children:(0,t.jsx)(c.x6,{i18nKey:"public-dashboard.modal-alerts.unsupport-data-source-alert-readmore-link",children:"Read more about supported data sources"})})]})},g=l=>({unsupportedDataSourceDescription:(0,n.css)({color:l.colors.text.secondary,marginBottom:l.spacing(1)})})},10872:(G,O,e)=>{"use strict";e.d(O,{D:()=>f});var t=e(74848),n=e(13544),i=e(42418),s=e(8484);const r=n.Tp.pages.ShareDashboardModal.PublicDashboard,f=({showDescription:a=!0})=>(0,t.jsx)(i.F,{severity:"warning",title:(0,s.t)("public-dashboard.modal-alerts.unsupported-template-variable-alert-title","Template variables are not supported"),"data-testid":r.TemplateVariablesWarningAlert,bottomSpacing:0,children:a&&(0,t.jsx)(s.x6,{i18nKey:"public-dashboard.modal-alerts.unsupported-template-variable-alert-desc",children:"This public dashboard may not work since it uses template variables"})})},4785:(G,O,e)=>{"use strict";e.d(O,{a:()=>l,b:()=>p});var t=e(74848),n=e(32196),i=e(40845),s=e(62930),r=e(72686),f=e(72254),a=e(31678),c=e(42930),o=e(59037),h=e(22234),g=e(71415);const l=()=>{const y=(0,i.of)(m);return(0,t.jsx)(c.G,{className:y.loadingContainer,children:(0,t.jsxs)(t.Fragment,{children:["Loading configuration",(0,t.jsx)(s.y,{size:"lg",className:y.spinner})]})})},p=y=>{const{data:d,isLoading:v,isError:u}=(0,r.Bs)(y.dashboard.uid),P=(0,a.useSelector)(E=>E.dashboard).getModel(),{unsupportedDataSources:x}=(0,g.Z)(P);return(0,t.jsx)(t.Fragment,{children:v?(0,t.jsx)(l,{}):(0,f.lI)(d)?(0,t.jsx)(o.K,{publicDashboard:d,unsupportedDatasources:x}):(0,t.jsx)(h.M,{hasError:u})})},m=y=>({loadingContainer:(0,n.css)({height:"280px",alignItems:"center",justifyContent:"center",gap:y.spacing(1)}),spinner:(0,n.css)({marginBottom:y.spacing(0)})})},72254:(G,O,e)=>{"use strict";e.d(O,{AY:()=>d,Xo:()=>c,_A:()=>g,_l:()=>m,gN:()=>p,iR:()=>y,kD:()=>o,lI:()=>h,mL:()=>l});var t=e(26657),n=e(32264),i=e(33378),s=e(2913),r=e(31193),f=e(22699),a=e(31204),c=(v=>(v.PUBLIC="public",v.EMAIL="email",v))(c||{});const o=v=>v.length>0,h=v=>v?.uid!==""&&v?.uid!==void 0,g=async v=>{let u=new Set;for(const D of v)for(const P of D.targets){const x=P?.datasource?.type;x&&(a.z.has(x)&&await(0,r.tR)().get(P.datasource)instanceof t.iy||u.add(x))}return Array.from(u).sort()},l=v=>`${(0,s.zj)().appUrl}public-dashboards/${v}`,p=(v,u)=>`/d/${v}/${u}?shareView=${f.wr.publicDashboard}`,m=/^[A-Z\d._%+-]+@[A-Z\d.-]+\.[A-Z]{2,}$/i,y=()=>!!n.$.featureToggles.publicDashboards&&n.$.publicDashboardsEnabled,d=()=>y()&&!!n.$.featureToggles.publicDashboardsEmailSharing&&(0,i.a)("publicDashboardsEmailSharing")},31204:(G,O,e)=>{"use strict";e.d(O,{z:()=>t});const t=new Set(["__expr__","aggregations-io-datasource","apache-iotdb-datasource","aquaqanalytics-kdbbackend-datasource","axiomhq-axiom-datasource","cloudwatch","cnos-cnosdb-datasource","datasource","dlopes7-appdynamics-datasource","dvelop-odata-datasource","elasticsearch","factry-historian-datasource","fiskaly-surrealdb-datasource","frser-sqlite-datasource","grafadruid-druid-datasource","grafana-athena-datasource","grafana-azure-data-explorer-datasource","grafana-azure-monitor-datasource","grafana-azurecosmosdb-datasource","grafana-bigquery-datasource","grafana-catchpoint-datasource","grafana-clickhouse-datasource","grafana-databricks-datasource","grafana-datadog-datasource","grafana-dynamodb-datasource","grafana-dynatrace-datasource","grafana-falconlogscale-datasource","grafana-github-datasource","grafana-gitlab-datasource","grafana-honeycomb-datasource","grafana-iot-sitewise-datasource","grafana-jira-datasource","grafana-looker-datasource","grafana-mock-datasource","grafana-mongodb-datasource","grafana-newrelic-datasource","grafana-odbc-datasource","grafana-opensearch-datasource","grafana-oracle-datasource","grafana-orbit-datasource","grafana-pagerduty-datasource","grafana-redshift-datasource","grafana-salesforce-datasource","grafana-saphana-datasource","grafana-sentry-datasource","grafana-servicenow-datasource","grafana-snowflake-datasource","grafana-splunk-datasource","grafana-splunk-monitoring-datasource","grafana-sumologic-datasource","grafana-surrealdb-datasource","grafana-testdata-datasource","grafana-timestream-datasource","grafana-wavefront-datasource","grafana-x-ray-datasource","graphite","hadesarchitect-cassandra-datasource","highlightinc-highlight-datasource","ibm-aql-datasource","ibm-kql-datasource","influxdata-flightsql-datasource","influxdb","innius-grpc-datasource","kniepdennis-neo4j-datasource","loki","manassehzhou-maxcompute-datasource","marcusolsson-csv-datasource","mssql","mysql","nagasudhirpulla-api-datasource","needleinajaystack-haystack-datasource","oci-metrics-datasource","opentsdb","parseable-parseable-datasource","postgres","prometheus","questdb-questdb-datasource","quickwit-quickwit-datasource","redis-datasource","retrodaredevil-wildgraphql-datasource","stackdriver","tdengine-datasource","timeplus-proton-datasource","trino-datasource","vertamedia-clickhouse-datasource","vertica-grafana-datasource","ydbtech-ydb-datasource","yesoreyeram-infinity-datasource"])},71415:(G,O,e)=>{"use strict";e.d(O,{Z:()=>i});var t=e(96540),n=e(72254);const i=s=>{const[r,f]=(0,t.useState)([]);return(0,t.useEffect)(()=>{(async()=>await(0,n._A)(s.panels))().then(c=>{f(c)})},[s.panels]),{unsupportedDataSources:r}}},87895:(G,O,e)=>{"use strict";e.d(O,{w:()=>r});var t=e(74848),n=e(88575),i=e(94354),s=e(8484);const r=({selectedTheme:f="current",onChange:a})=>{const c=[{label:(0,s.t)("share-modal.theme-picker.current","Current"),value:"current"},{label:(0,s.t)("share-modal.theme-picker.dark","Dark"),value:"dark"},{label:(0,s.t)("share-modal.theme-picker.light","Light"),value:"light"}];return(0,t.jsx)(n.D,{label:(0,s.t)("share-modal.theme-picker.field-name","Theme"),children:(0,t.jsx)(i.z,{options:c,value:f,onChange:a})})}},1702:(G,O,e)=>{"use strict";e.d(O,{ShareModal:()=>t.Zy});var t=e(7686)},22699:(G,O,e)=>{"use strict";e.d(O,{CF:()=>p,Lb:()=>l,P_:()=>o,XV:()=>c,Xe:()=>h,hD:()=>y,wr:()=>d});var t=e(65879),n=e(76885),i=e(71733),s=e(47232),r=e(32264),f=e(7030),a=e(74856);function c({useCurrentTimeRange:v,selectedTheme:u,panel:D,search:P=window.location.search,range:x=(0,a.jG)().timeRange(),orgId:E=r.$.bootData.user.orgId}){const C=new URLSearchParams(P),M=D?.timeFrom;if(M){const{from:S,to:I}=t.describeTextRange(M);C.set("from",S),C.set("to",I)}else C.set("from",String(x.from.valueOf())),C.set("to",String(x.to.valueOf()));return C.set("orgId",String(E)),v||(C.delete("from"),C.delete("to")),u!=="current"&&C.set("theme",u),D&&!C.has("editPanel")&&C.set("viewPanel",String(D.id)),C.delete("auth_token"),C.delete("shareView"),C}function o(){let v=window.location.href;const u=v.indexOf("?");return u!==-1&&(v=v.substring(0,u)),v}async function h(v,u,D,P){const x=o(),E=c({useCurrentTimeRange:v,selectedTheme:u,panel:D}),C=n.kM.appendQueryToUrl(x,E.toString());return P?await(0,f.fn)(C):C}function g(v,u,D,P,x){const E=o(),C=c({useCurrentTimeRange:v,selectedTheme:D,panel:P,range:x});let M=E.replace(r.$.appSubUrl+"/dashboard/",r.$.appSubUrl+"/dashboard-solo/");M=M.replace(r.$.appSubUrl+"/d/",r.$.appSubUrl+"/d-solo/"),i.I.stripBaseFromUrl(E)==="/"&&(M=`${r.$.appUrl}d-solo/${u}`);const I=C.get("editPanel")??C.get("viewPanel")??"";return C.set("panelId",I),C.delete("editPanel"),C.delete("viewPanel"),n.kM.appendQueryToUrl(M,C.toString())}function l(v,u,D,P){let E=g(v,u,D,P).replace(r.$.appSubUrl+"/dashboard-solo/",r.$.appSubUrl+"/render/dashboard-solo/");return E=E.replace(r.$.appSubUrl+"/d-solo/",r.$.appSubUrl+"/render/d-solo/"),E+=`&width=${r.$.rendererDefaultImageWidth}&height=${r.$.rendererDefaultImageHeight}&scale=${r.$.rendererDefaultImageScale}`+m(),E}function p(v,u,D,P,x){return`<iframe src="${g(v,u,D,P,x)}" width="450" height="200" frameborder="0"></iframe>`}function m(){const v="&tz=UTC"+encodeURIComponent((0,s.KQ)().format("Z"));if(!window.Intl)return v;const u=window.Intl.DateTimeFormat();if(!u.resolvedOptions)return v;const D=u.resolvedOptions();return D.timeZone?"&tz="+encodeURIComponent(D.timeZone):v}const y=v=>v?"panel":"dashboard",d={link:"link",snapshot:"snapshot",export:"export",embed:"embed",libraryPanel:"library_panel",pdf:"pdf",report:"report",publicDashboard:"public_dashboard"}},52424:(G,O,e)=>{"use strict";e.d(O,{Zx:()=>x,aK:()=>d});var t=e(74848),n=e(32196),i=e(96540),s=e(16817),r=e(80997),f=e(13544),a=e(40845),c=e(38138),o=e(40276),h=e(83122),g=e(14578),l=e(55852),p=e(27677),m=e(6923);function y({dashboardUID:E,link:C}){const M=(0,a.of)(P),S=v({dashboardUID:E,link:C});return!S||D.length===0?null:(0,t.jsx)(c.W,{children:(0,t.jsx)("div",{className:M.dropdown,children:(0,t.jsx)(o.E,{children:S.map((I,T)=>(0,t.jsx)(c.W.Item,{url:I.url,target:C.targetBlank?"_blank":void 0,label:I.title,testId:f.Tp.components.DashboardLinks.link,"aria-label":`${I.title} dashboard`},`dashlinks-dropdown-item-${I.uid}-${T}`))})})})}const d=E=>{const{link:C,linkInfo:M,dashboardUID:S}=E,I=v(E),T=(0,a.of)(P);return C.asDropdown?(0,t.jsx)(h.m,{overlay:(0,t.jsx)(y,{link:C,dashboardUID:S}),children:(0,t.jsxs)(x,{"data-placement":"bottom","data-toggle":"dropdown","aria-controls":"dropdown-list","aria-haspopup":"menu",fill:"outline",variant:"secondary","data-testid":f.Tp.components.DashboardLinks.dropDown,children:[(0,t.jsx)(g.I,{"aria-hidden":!0,name:"bars",className:T.iconMargin}),(0,t.jsx)("span",{children:M.title})]})}):(0,t.jsx)(t.Fragment,{children:I.length>0&&I.map((b,R)=>(0,t.jsx)(x,{icon:"apps",variant:"secondary",fill:"outline",href:b.url,target:C.targetBlank?"_blank":void 0,rel:"noreferrer","data-testid":f.Tp.components.DashboardLinks.link,children:b.title},`dashlinks-list-item-${b.uid}-${R}`))})},v=({link:E,dashboardUID:C})=>{const{tags:M}=E,S=(0,s.A)(()=>u(M),[M]);return S.value?D(C,E,S.value):[]};async function u(E,C={getBackendSrv:p.AI}){return await C.getBackendSrv().search({tag:E,limit:100})}function D(E,C,M,S={getLinkSrv:m.mQ,sanitize:r.aj,sanitizeUrl:r.Jf}){return M.filter(I=>I.uid!==E).map(I=>{const T=I.uid,b=S.sanitize(I.title),R=S.getLinkSrv().getLinkUrl({...C,url:I.url}),A=S.sanitizeUrl(R);return{uid:T,title:b,url:A}})}function P(E){return{iconMargin:(0,n.css)({marginRight:E.spacing(.5)}),dropdown:(0,n.css)({maxWidth:"max(30vw, 300px)",maxHeight:"70vh",overflowY:"auto"}),button:(0,n.css)({color:E.colors.text.primary}),dashButton:(0,n.css)({fontSize:E.typography.bodySmall.fontSize,paddingLeft:E.spacing(1),paddingRight:E.spacing(1)})}}const x=(0,i.forwardRef)(({className:E,...C},M)=>{const S=(0,a.of)(P),I=C.href?l.z9:l.$n;return(0,t.jsx)(I,{...C,variant:"secondary",fill:"outline",className:(0,n.cx)(E,S.dashButton),ref:M})});x.displayName="DashboardLinkButton"},57650:(G,O,e)=>{"use strict";e.d(O,{A:()=>w});var t=e(74848),n=e(97497),i=e(96540),s=e(42941),r=e(1173),f=e(52622),a=e(13544),c=e(14110),o=e(96374),h=e(10343),g=e(7788),l=e(2913),p=e(10803),m=e(32196),y=e(69862),d=e(85200),v=e(2514),u=e(72574),D=e(40845),P=e(87978),x=e(24022),E=e(14578);const C=({debugMode:N,index:B,data:V,uiConfig:K,configs:H,onChange:X,toggleShowDebug:k})=>{const Y=(0,D.of)(M),[Z,se]=(0,i.useState)([]),[j,q]=(0,i.useState)([]),ne=(0,i.useMemo)(()=>H[B],[H,B]);(0,i.useEffect)(()=>{const z=H[B].transformation,te=z.filter?.options?(0,d.Dq)(z.filter):void 0,le=H.slice(0,B).map(me=>me.transformation),ie=H.slice(B,B+1).map(me=>me.transformation),ae={interpolate:me=>(0,u.w)().replace(me)},re=(0,v.m)(le,V,ae).subscribe(me=>{te&&(me=V.filter(ee=>te(ee))),se(me)}),ce=(0,v.m)(le,V,ae).pipe((0,y.Z)(me=>(0,v.m)(ie,me,ae))).subscribe(q);return function(){re.unsubscribe(),ce.unsubscribe()}},[B,V,H]);const oe=(0,i.useMemo)(()=>(0,i.createElement)(K.editor,{options:{...K.transformation.defaultOptions,...ne.transformation.options},input:Z,onChange:z=>{X(B,{...ne.transformation,options:z})}}),[K.editor,K.transformation.defaultOptions,ne.transformation,Z,X,B]);return(0,t.jsxs)("div",{"data-testid":a.Tp.components.TransformTab.transformationEditor(K.name),children:[oe,N&&(0,t.jsx)(P._,{title:"Debug transformation",subtitle:K.name,onClose:k,children:(0,t.jsxs)("div",{className:Y.debugWrapper,"data-testid":a.Tp.components.TransformTab.transformationEditorDebugger(K.name),children:[(0,t.jsxs)("div",{className:Y.debug,children:[(0,t.jsx)("div",{className:Y.debugTitle,children:"Input data"}),(0,t.jsx)("div",{className:Y.debugJson,children:(0,t.jsx)(x.B,{json:Z})})]}),(0,t.jsx)("div",{className:Y.debugSeparator,children:(0,t.jsx)(E.I,{name:"arrow-right"})}),(0,t.jsxs)("div",{className:Y.debug,children:[(0,t.jsx)("div",{className:Y.debugTitle,children:"Output data"}),(0,t.jsx)("div",{className:Y.debugJson,children:j&&(0,t.jsx)(x.B,{json:j})})]})]})})]})},M=N=>({title:(0,m.css)({display:"flex",padding:"4px 8px 4px 8px",position:"relative",height:"35px",borderRadius:"4px 4px 0 0",flexWrap:"nowrap",justifyContent:"space-between",alignItems:"center"}),name:(0,m.css)({fontWeight:N.typography.fontWeightMedium,color:N.colors.primary.text}),iconRow:(0,m.css)({display:"flex"}),icon:(0,m.css)({background:"transparent",border:"none",boxShadow:"none",cursor:"pointer",color:N.colors.text.secondary,marginLeft:N.spacing(1),"&:hover":{color:N.colors.text.primary}}),debugWrapper:(0,m.css)({display:"flex",flexDirection:"row"}),debugSeparator:(0,m.css)({width:"48px",minHeight:"300px",display:"flex",alignItems:"center",alignSelf:"stretch",justifyContent:"center",margin:`0 ${N.spacing(.5)}`,color:N.colors.primary.text}),debugTitle:(0,m.css)({padding:`${N.spacing(1)} ${N.spacing(.25)}`,fontFamily:N.typography.fontFamilyMonospace,fontSize:N.typography.bodySmall.fontSize,color:N.colors.text.primary,borderBottom:`1px solid ${N.colors.border.weak}`,flexGrow:0,flexShrink:1}),debug:(0,m.css)({marginTop:N.spacing(1),padding:`0 ${N.spacing(1,1,1)}`,border:`1px solid ${N.colors.border.weak}`,background:`${N.isLight?N.v1.palette.white:N.v1.palette.gray05}`,borderRadius:N.shape.radius.default,width:"100%",minHeight:"300px",display:"flex",flexDirection:"column",alignSelf:"stretch"}),debugJson:(0,m.css)({flexGrow:1,height:"100%",overflow:"hidden",padding:N.spacing(.5)})});var S=e(22214),I=e(91847);const T=({isOpen:N,onCloseClick:B,transformer:V})=>{const{transformation:{name:K},help:H}=V,X=H||(0,I.$n)(),k=(0,t.jsx)(P._,{title:K,subtitle:"Transformation help",onClose:()=>B(!1),children:(0,t.jsx)(S.j,{markdown:X,styleOverrides:{borderTop:"2px solid"}})});return N?k:null};var b=e(88575),R=e(90182),A=e(19743);const L=({index:N,data:B,config:V,onChange:K})=>{const H=(0,D.of)(U),X=(0,i.useMemo)(()=>({context:{data:B.series},showTopic:!0,showFilter:V.topic!==f.QR.Annotations,source:[{value:f.QR.Series,label:"Query results"},{value:f.QR.Annotations,label:"Annotation data"}]}),[B,V.topic]);return(0,t.jsx)("div",{className:H.wrapper,children:(0,t.jsx)(b.D,{label:"Apply transformation to",children:(0,t.jsxs)(t.Fragment,{children:[X.showTopic&&(0,t.jsx)(R.l6,{isClearable:!0,options:X.source,value:X.source.find(k=>k.value===V.topic),placeholder:X.source[0].label,className:H.padded,onChange:k=>{K(N,{...V,topic:k?.value})}}),X.showFilter&&(0,t.jsx)(A.x,{value:V.filter,context:X.context,item:{},onChange:k=>K(N,{...V,filter:k})})]})})})},U=N=>{const B=N.shape.radius.default;return{wrapper:(0,m.css)({padding:N.spacing(2),border:`2px solid ${N.colors.background.secondary}`,borderTop:"none",borderRadius:`0 0 ${B} ${B}`,position:"relative",top:"-4px"}),padded:(0,m.css)({marginBottom:N.spacing(1)})}},W=({onRemove:N,index:B,id:V,data:K,configs:H,uiConfig:X,onChange:k})=>{const[Y,Z]=(0,s.A)(!1),[se,j]=(0,s.A)(!1),[q,ne]=(0,s.A)(!1),oe=!!H[B].transformation.disabled,z=H[B].transformation.topic,te=H[B].transformation.filter!=null||z!=null,le=te||K.series.length>1||(K.annotations?.length??0)>0,ie=(0,i.useCallback)(me=>{const ee=H[me].transformation;k(me,{...ee,disabled:ee.disabled?void 0:!0})},[k,H]),ae=(0,i.useCallback)(()=>{let me={...H[B].transformation};me.filter?delete me.filter:me.filter={id:r.jR.byRefId,options:""},k(B,me)},[k,B,H]),re=(0,i.useCallback)((me,ee,de)=>De=>{let fe="panel_editor_tabs_transformations_toggle";l.Ay.featureToggles.transformationsRedesign&&(fe="transformations_redesign_"+fe),(0,c.rR)(fe,{action:de?"off":"on",toggleId:ee,transformationId:H[B].transformation.id}),me(De)},[H,B]),ce=()=>(0,t.jsxs)(t.Fragment,{children:[X.state&&(0,t.jsx)(p.p,{state:X.state}),(0,t.jsx)(h.A,{title:"Show transform help",icon:"info-circle",onClick:re(ne,"help",q),active:q}),le&&(0,t.jsx)(h.A,{title:"Filter",icon:"filter",onClick:re(ae,"filter",te),active:te}),(0,t.jsx)(h.A,{title:"Debug",icon:"bug",onClick:re(j,"debug",se),active:se}),(0,t.jsx)(h.A,{title:"Disable transformation",icon:oe?"eye-slash":"eye",onClick:re(()=>ie(B),"disabled",oe),active:oe,dataTestId:a.Tp.components.Transforms.disableTransformationButton}),(0,t.jsx)(h.q,{title:"Remove",icon:"trash-alt",onClick:()=>l.Ay.featureToggles.transformationsRedesign?Z(!0):N(B)}),l.Ay.featureToggles.transformationsRedesign&&(0,t.jsx)(o.u,{isOpen:Y,title:`Delete ${X.name}?`,body:"Note that removing one transformation may break others. If there is only a single transformation, you will go back to the main selection screen.",confirmText:"Delete",onConfirm:()=>{Z(!1),N(B)},onDismiss:()=>Z(!1)})]});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(g.u,{id:V,index:B,title:`${B+1} - ${X.name}`,draggable:!0,actions:ce,disabled:oe,expanderMessages:{close:"Collapse transformation row",open:"Expand transformation row"},children:[te&&(0,t.jsx)(L,{index:B,config:H[B].transformation,data:K,onChange:k}),(0,t.jsx)(C,{debugMode:se,index:B,data:z===f.QR.Annotations?K.annotations??[]:K.series,configs:H,uiConfig:X,onChange:k,toggleShowDebug:j})]}),(0,t.jsx)(T,{transformer:X,isOpen:q,onCloseClick:ne})]})},w=({data:N,onChange:B,onRemove:V,configs:K})=>(0,t.jsx)(t.Fragment,{children:K.map((H,X)=>{const k=n.h.getIfExists(H.transformation.id);return k?(0,t.jsx)(W,{index:X,id:`${H.id}`,data:N,configs:K,uiConfig:k,onRemove:V,onChange:B},`${H.id}`):null})})},21427:(G,O,e)=>{"use strict";e.d(O,{R:()=>x});var t=e(74848),n=e(32196),i=e(96540),s=e(81010),r=e(18282),f=e(97497),a=e(13544),c=e(40845),o=e(87978),h=e(10354),g=e(15292),l=e(92174),p=e(10860),m=e(29158),y=e(2913),d=e(10803),v=e(94397);const P=[["viewAll","View all"],...Object.entries(v.eJ)];function x(b){const R=(0,c.of)(E),{suffix:A,xforms:L,search:U,onSearchChange:W,onSearchKeyDown:w,showIllustrations:N,onTransformationAdd:B,selectedFilter:V,data:K,onClose:H,onShowIllustrationsChange:X,onSelectedFilterChange:k}=b,Y=(0,i.useCallback)(Z=>{Z?.click()},[]);return(0,t.jsxs)(o._,{size:"md",onClose:()=>{H&&H()},title:"Add another transformation",children:[(0,t.jsxs)("div",{className:R.searchWrapper,children:[(0,t.jsx)(h.p,{"data-testid":a.Tp.components.Transforms.searchInput,className:R.searchInput,value:U??"",placeholder:"Search for transformation",onChange:W,onKeyDown:w,suffix:A,ref:Y}),(0,t.jsxs)("div",{className:R.showImages,children:[(0,t.jsx)("span",{className:R.illustationSwitchLabel,children:"Show images"})," ",(0,t.jsx)(g.d,{value:N,onChange:()=>X&&X(!N)})]})]}),(0,t.jsx)("div",{className:R.filterWrapper,children:P.map(([Z,se])=>(0,t.jsx)(l.m,{onClick:()=>k&&k(Z),label:se,selected:V===Z},Z))}),(0,t.jsx)(C,{showIllustrations:N,transformations:L,data:K,onClick:Z=>{B({value:Z})}})]})}function E(b){return{showImages:(0,n.css)({flexBasis:"0",display:"flex",gap:"8px",alignItems:"center"}),pickerInformationLine:(0,n.css)({fontSize:"16px",marginBottom:`${b.spacing(2)}`}),pickerInformationLineHighlight:(0,n.css)({verticalAlign:"middle"}),searchWrapper:(0,n.css)({display:"flex",flexWrap:"wrap",columnGap:"27px",rowGap:"16px",width:"100%"}),searchInput:(0,n.css)({flexGrow:"1",width:"initial"}),illustationSwitchLabel:(0,n.css)({whiteSpace:"nowrap"}),filterWrapper:(0,n.css)({padding:`${b.spacing(1)} 0`,display:"flex",flexWrap:"wrap",rowGap:`${b.spacing(1)}`,columnGap:`${b.spacing(.5)}`})}}function C({showIllustrations:b,transformations:R,onClick:A,data:L}){const U=(0,c.of)(M);return(0,t.jsx)("div",{className:U.grid,children:R.map(W=>{let w=s.M.Applicable;W.transformation.isApplicable!==void 0&&(w=W.transformation.isApplicable(L));const N=w>0;let B=null;W.transformation.isApplicableDescription!==void 0&&(typeof W.transformation.isApplicableDescription=="function"?B=W.transformation.isApplicableDescription(L):B=W.transformation.isApplicableDescription);let V=U.newCard;return N||(V=(0,n.cx)(U.newCard,U.cardDisabled)),(0,t.jsxs)(p.Z,{className:V,"data-testid":a.Tp.components.TransformTab.newTransform(W.name),onClick:()=>A(W.id),children:[(0,t.jsxs)(p.Z.Heading,{className:U.heading,children:[(0,t.jsx)("span",{children:W.name}),(0,t.jsx)("span",{className:U.pluginStateInfoWrapper,children:(0,t.jsx)(d.p,{state:W.state})})]}),(0,t.jsxs)(p.Z.Description,{className:U.description,children:[(0,t.jsx)("span",{children:T(W.id)}),b&&(0,t.jsx)("span",{children:(0,t.jsx)("img",{className:U.image,src:S(W.id,!N),alt:W.name})}),!N&&B!==null&&(0,t.jsx)(m.K,{className:U.cardApplicableInfo,name:"info-circle",tooltip:B})]})]},W.id)})})}function M(b){return{heading:(0,n.css)({fontWeight:400,"> button":{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"nowrap"}}),description:(0,n.css)({fontSize:"12px",display:"flex",flexDirection:"column",justifyContent:"space-between"}),image:(0,n.css)({display:"block",maxEidth:"100%`",marginTop:`${b.spacing(2)}`}),grid:(0,n.css)({display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))",gridAutoRows:"1fr",gap:`${b.spacing(2)} ${b.spacing(1)}`,width:"100%"}),cardDisabled:(0,n.css)({backgroundColor:"rgb(204, 204, 220, 0.045)",color:`${b.colors.text.disabled} !important`,img:{filter:"grayscale(100%)",opacity:.33}}),cardApplicableInfo:(0,n.css)({position:"absolute",bottom:`${b.spacing(1)}`,right:`${b.spacing(1)}`}),newCard:(0,n.css)({gridTemplateRows:"min-content 0 1fr 0"}),pluginStateInfoWrapper:(0,n.css)({marginLeft:"5px"})}}const S=(b,R)=>`public/img/transformations/${y.Ay.theme2.isDark?"dark":"light"}/${b}.svg`,I={[r.F.concatenate]:"Combine all fields into a single frame.",[r.F.configFromData]:"Set unit, min, max and more.",[r.F.fieldLookup]:"Use a field value to lookup countries, states, or airports.",[r.F.filterFieldsByName]:"Remove parts of the query results using a regex pattern.",[r.F.filterByRefId]:"Remove rows from the data based on origin query",[r.F.filterByValue]:"Remove rows from the query results using user-defined filters.",[r.F.groupBy]:"Group data by a field value and create aggregate data.",[r.F.groupingToMatrix]:"Summarize and reorganize data based on three fields.",[r.F.joinByField]:"Combine rows from 2+ tables, based on a related field.",[r.F.labelsToFields]:"Group series by time and return labels or tags as fields.",[r.F.merge]:"Merge multiple series. Values will be combined into one row.",[r.F.organize]:"Re-order, hide, or rename fields.",[r.F.partitionByValues]:"Split a one-frame dataset into multiple series.",[r.F.prepareTimeSeries]:"Stretch data frames from the wide format into the long format.",[r.F.reduce]:"Reduce all rows or data points to a single value (ex. max, mean).",[r.F.renameByRegex]:"Rename parts of the query results using a regular expression and replacement pattern.",[r.F.seriesToRows]:"Merge multiple series. Return time, metric and values as a row."},T=b=>I[b]||f.h.getIfExists(b)?.description||""},66879:(G,O,e)=>{"use strict";e.d(O,{o:()=>B,e:()=>w});var t=e(74848),n=e(38127),i=e(96540),s=e(97497),r=e(13544),f=e(14110),a=e(29158),c=e(55852),o=e(96374),h=e(19727),g=e(40276),l=e(66864),p=e(40845),m=e(2913),y=e(79280),d=e(12131),v=e(32696);function u({message:V}){const K=(0,i.useCallback)(()=>{d.Ny.partial({tab:v.M8.Query})},[]);return(0,t.jsx)(l.PE,{justify:"center",style:{marginTop:"100px"},children:(0,t.jsxs)(l.gW,{spacing:"md",children:[(0,t.jsx)("h2",{children:V}),(0,t.jsx)("div",{children:(0,t.jsx)(c.$n,{size:"md",variant:"secondary",icon:"arrow-left",onClick:K,children:"Go back to Queries"})})]})})}var D=e(57650),P=e(32196),x=e(87885),E=e(42418),C=e(10354),M=e(10860),S=e(61680);const I={[x.f.Transformations]:"https://grafana.com/docs/grafana/latest/panels/transformations",[x.f.FieldConfig]:"https://grafana.com/docs/grafana/latest/panels/field-configuration-options/",[x.f.FieldConfigOverrides]:"https://grafana.com/docs/grafana/latest/panels/field-configuration-options/#override-a-field"},T=V=>I[V];var b=e(10803);const R="dashboard.components.TransformationEditor.featureInfoBox.isDismissed";function A(V){const{noTransforms:K,search:H,xforms:X,onSearchChange:k,onSearchKeyDown:Y,onTransformationAdd:Z,suffix:se}=V;return(0,t.jsxs)(l.gW,{children:[K&&(0,t.jsx)(l.mc,{grow:1,children:(0,t.jsx)(S.b,{storageKey:R,defaultValue:!1,children:(j,q)=>j?null:(0,t.jsxs)(E.F,{title:"Transformations",severity:"info",onRemove:()=>{q(!0)},children:[(0,t.jsxs)("p",{children:["Transformations allow you to join, calculate, re-order, hide, and rename your query results before they are visualized. ",(0,t.jsx)("br",{}),"Many transforms are not suitable if you're using the Graph visualization, as it currently only supports time series data. ",(0,t.jsx)("br",{}),"It can help to switch to the Table visualization to understand what a transformation is doing."," "]}),(0,t.jsx)("a",{href:T(x.f.Transformations),className:"external-link",target:"_blank",rel:"noreferrer",children:"Read more"})]})})}),(0,t.jsx)(C.p,{"data-testid":r.Tp.components.Transforms.searchInput,value:H??"",autoFocus:!K,placeholder:"Search for transformation",onChange:k,onKeyDown:Y,suffix:se}),X.map(j=>(0,t.jsx)(L,{transform:j,onClick:()=>{Z({value:j.id})}},j.name))]})}function L({transform:V,onClick:K}){const H=(0,p.of)(U);return(0,t.jsxs)(M.Z,{className:H.card,"data-testid":r.Tp.components.TransformTab.newTransform(V.name),onClick:K,children:[(0,t.jsx)(M.Z.Heading,{children:V.name}),(0,t.jsx)(M.Z.Description,{children:V.description}),V.state&&(0,t.jsx)(M.Z.Tags,{children:(0,t.jsx)(b.p,{state:V.state})})]})}function U(V){return{card:(0,P.css)({margin:"0",padding:`${V.spacing(1)}`})}}var W=e(21427);const w="viewAll";class N extends i.PureComponent{constructor(K){super(K),this.onSearchChange=k=>{this.setState({search:k.target.value})},this.onSearchKeyDown=k=>{if(k.key==="Enter"){const{search:Y}=this.state;if(Y){const Z=Y.toLowerCase(),se=s.h.list().filter(j=>(j.name+j.description).toLowerCase().indexOf(Z)>=0);se.length>0&&this.onTransformationAdd({value:se[0].id})}}else k.keyCode===27&&(this.setState({search:"",showPicker:!1}),k.stopPropagation())},this.getTransformationNextId=k=>{const{transformations:Y}=this.state;let Z=0;const se=Y.filter(j=>j.id.startsWith(k)).map(j=>j.id);return se.length!==0&&(Z=Math.max(...se.map(j=>parseInt(j.match(/\d+/)[0],10)))+1),`${k}-${Z}`},this.onTransformationAdd=k=>{let Y="panel_editor_tabs_transformations_management";m.Ay.featureToggles.transformationsRedesign&&(Y="transformations_redesign_"+Y),(0,f.rR)(Y,{action:"add",transformationId:k.value});const{transformations:Z}=this.state,se=this.getTransformationNextId(k.value);this.setState({search:"",showPicker:!1}),this.onChange([...Z,{id:se,transformation:{id:k.value,options:{}}}])},this.onTransformationChange=(k,Y)=>{const{transformations:Z}=this.state,se=Array.from(Z);let j="panel_editor_tabs_transformations_management";m.Ay.featureToggles.transformationsRedesign&&(j="transformations_redesign_"+j),(0,f.rR)(j,{action:"change",transformationId:se[k].transformation.id}),se[k].transformation=Y,this.onChange(se)},this.onTransformationRemove=k=>{const{transformations:Y}=this.state,Z=Array.from(Y);let se="panel_editor_tabs_transformations_management";m.Ay.featureToggles.transformationsRedesign&&(se="transformations_redesign_"+se),(0,f.rR)(se,{action:"remove",transformationId:Z[k].transformation.id}),Z.splice(k,1),this.onChange(Z)},this.onTransformationRemoveAll=()=>{this.onChange([]),this.setState({showRemoveAllModal:!1})},this.onDragEnd=k=>{const{transformations:Y}=this.state;if(!k||!k.destination)return;const Z=k.source.index,se=k.destination.index;if(Z===se)return;const j=Array.from(Y),[q]=j.splice(Z,1);j.splice(se,0,q),this.onChange(j)},this.renderEmptyMessage=()=>(0,t.jsx)(y.p,{onShowPicker:()=>{this.setState({showPicker:!0})}}),this.renderTransformationEditors=()=>{const{data:k,transformations:Y}=this.state;return(0,t.jsx)(n.JY,{onDragEnd:this.onDragEnd,children:(0,t.jsx)(n.gL,{droppableId:"transformations-list",direction:"vertical",children:Z=>(0,t.jsxs)("div",{ref:Z.innerRef,...Z.droppableProps,children:[(0,t.jsx)(D.A,{configs:Y,data:k,onRemove:this.onTransformationRemove,onChange:this.onTransformationChange}),Z.placeholder]})})})};const H=K.panel.transformations||[],X=this.buildTransformationIds(H);this.state={transformations:H.map((k,Y)=>({transformation:k,id:X[Y]})),data:{series:[]},search:"",selectedFilter:w,showIllustrations:!0}}buildTransformationIds(K){const H={},X=[];for(let k=0;k<K.length;k++){const Y=K[k];H[Y.id]===void 0?H[Y.id]=0:H[Y.id]+=1,X.push(`${K[k].id}-${H[K[k].id]}`)}return X}componentDidMount(){this.subscription=this.props.panel.getQueryRunner().getData({withTransforms:!1,withFieldConfig:!1}).subscribe({next:K=>this.setState({data:K})})}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe()}componentDidUpdate(K,H){if(m.Ay.featureToggles.transformationsRedesign){const k=!(H.transformations.length>0)||H.showPicker,Z=!(this.state.transformations.length>0)||this.state.showPicker;if(k!==Z){const se=Math.random()/2;this.setState({scrollTop:Z?se:Number.MAX_SAFE_INTEGER})}}}onChange(K){this.setState({transformations:K}),this.props.panel.setTransformations(K.map(H=>H.transformation))}renderTransformsPicker(){let{showPicker:K}=this.state;const{transformations:H,search:X}=this.state,{transformationsRedesign:k}=m.Ay.featureToggles,Y=!H?.length,Z=H.length>0;let se=null,j=s.h.list().sort((z,te)=>z.name>te.name?1:te.name>z.name?-1:0);if(!k&&Y&&(K=!0),this.state.selectedFilter!==w&&(j=j.filter(z=>z.categories&&this.state.selectedFilter&&z.categories.has(this.state.selectedFilter))),X){const z=X.toLowerCase(),te=j.filter(le=>(le.name+le.description).toLowerCase().indexOf(z)>=0);se=(0,t.jsxs)(t.Fragment,{children:[te.length," / ",j.length," \xA0\xA0",(0,t.jsx)(a.K,{name:"times",onClick:()=>{this.setState({search:""})},tooltip:"Clear search"})]}),j=te}!se&&K&&!Y&&(se=(0,t.jsx)(a.K,{name:"times",onClick:()=>{this.setState({showPicker:!1})},tooltip:"Close picker"}));let q=null,ne=null;k?(q=(0,t.jsx)(W.R,{noTransforms:Y,search:X,suffix:se,xforms:j,onClose:()=>this.setState({showPicker:!1}),onSelectedFilterChange:z=>this.setState({selectedFilter:z}),onShowIllustrationsChange:z=>this.setState({showIllustrations:z}),onSearchChange:this.onSearchChange,onSearchKeyDown:this.onSearchKeyDown,onTransformationAdd:this.onTransformationAdd,data:this.state.data.series,selectedFilter:this.state.selectedFilter,showIllustrations:this.state.showIllustrations}),ne=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.$n,{icon:"times",variant:"secondary",onClick:()=>this.setState({showRemoveAllModal:!0}),style:{marginLeft:this.props.theme.spacing.md},children:"Delete all transformations"}),(0,t.jsx)(o.u,{isOpen:!!this.state.showRemoveAllModal,title:"Delete all transformations?",body:"By deleting all transformations, you will go back to the main selection screen.",confirmText:"Delete all",onConfirm:()=>this.onTransformationRemoveAll(),onDismiss:()=>this.setState({showRemoveAllModal:!1})})]})):q=(0,t.jsx)(A,{noTransforms:Y,search:X,suffix:se,xforms:j,onSearchChange:this.onSearchChange,onSearchKeyDown:this.onSearchKeyDown,onTransformationAdd:this.onTransformationAdd});const oe=(0,t.jsxs)(h.e,{children:[(0,t.jsx)(c.$n,{icon:"plus",variant:"secondary",onClick:()=>{this.setState({showPicker:!0})},"data-testid":r.Tp.components.Transforms.addTransformationButton,children:"Add another transformation"}),ne]});return(0,t.jsxs)(t.Fragment,{children:[K&&q,k&&Z&&oe||!k&&!K&&Z&&oe]})}render(){const{panel:{alert:K}}=this.props,{transformations:H}=this.state,X=H.length>0;if(K){const k=X?"Transformations can't be used on a panel with alerts":"Transformations can't be used on a panel with existing alerts";return(0,t.jsx)(u,{message:k})}return(0,t.jsx)(g.E,{scrollTop:this.state.scrollTop,autoHeightMin:"100%",children:(0,t.jsx)(l.mc,{padding:"lg",children:(0,t.jsxs)("div",{"data-testid":r.Tp.components.TransformTab.content,children:[!X&&m.Ay.featureToggles.transformationsRedesign&&this.renderEmptyMessage(),X&&this.renderTransformationEditors(),this.renderTransformsPicker()]})})})}}const B=(0,p.SL)(N)},68064:(G,O,e)=>{"use strict";e.d(O,{A:()=>D});var t=e(74848),n=e(32196),i=e(13544),s=e(12131),r=e(32264),f=e(40845),a=e(67061),c=e(90613),o=e(94753),h=e(55852),g=e(8484),l=e(36974),p=e(19293),m=e(34842),y=e(7758),d=e(31678),v=e(28601);const D=({dashboard:x,canCreate:E})=>{const C=(0,f.of)(P),M=(0,d.useDispatch)(),S=(0,d.useSelector)(b=>b.dashboard.initialDatasource),I=()=>{let b;if(x instanceof m.H$){const R=x.onCreateNewPanel();x.setState({editPanel:(0,p.L)(R,!0)}),s.Ny.partial({firstPanel:!0})}else b=(0,l.OK)(x,S),M((0,v.Ub)(void 0)),s.Ny.partial({editPanel:b,firstPanel:!0});y.c.emptyDashboardButtonClicked({item:"add_visualization"})},T=()=>{y.c.emptyDashboardButtonClicked({item:"import_from_library"}),x instanceof m.H$?x.onShowAddLibraryPanelDrawer():(0,l.s3)(x)};return(0,t.jsx)(a.B,{alignItems:"center",justifyContent:"center",children:(0,t.jsx)("div",{className:C.wrapper,children:(0,t.jsxs)(a.B,{alignItems:"stretch",justifyContent:"center",gap:4,direction:"column",children:[(0,t.jsx)(c.a,{borderColor:"strong",borderStyle:"dashed",padding:4,children:(0,t.jsxs)(a.B,{direction:"column",alignItems:"center",gap:2,children:[(0,t.jsx)(o.E,{element:"h1",textAlignment:"center",weight:"medium",children:(0,t.jsx)(g.x6,{i18nKey:"dashboard.empty.add-visualization-header",children:"Start your new dashboard by adding a visualization"})}),(0,t.jsx)(c.a,{marginBottom:2,paddingX:4,children:(0,t.jsx)(o.E,{element:"p",textAlignment:"center",color:"secondary",children:(0,t.jsx)(g.x6,{i18nKey:"dashboard.empty.add-visualization-body",children:"Select a data source and then query and visualize your data with charts, stats and tables or create lists, markdowns and other widgets."})})}),(0,t.jsx)(h.$n,{size:"lg",icon:"plus","data-testid":i.Tp.pages.AddDashboard.itemButton("Create new panel button"),onClick:I,disabled:!E,children:(0,t.jsx)(g.x6,{i18nKey:"dashboard.empty.add-visualization-button",children:"Add visualization"})})]})}),(0,t.jsxs)(a.B,{direction:{xs:"column",md:"row"},wrap:"wrap",gap:4,children:[r.$.featureToggles.vizAndWidgetSplit&&(0,t.jsx)(c.a,{borderColor:"strong",borderStyle:"dashed",padding:3,flex:1,children:(0,t.jsxs)(a.B,{direction:"column",alignItems:"center",gap:1,children:[(0,t.jsx)(o.E,{element:"h3",textAlignment:"center",weight:"medium",children:(0,t.jsx)(g.x6,{i18nKey:"dashboard.empty.add-widget-header",children:"Add a widget"})}),(0,t.jsx)(c.a,{marginBottom:2,children:(0,t.jsx)(o.E,{element:"p",textAlignment:"center",color:"secondary",children:(0,t.jsx)(g.x6,{i18nKey:"dashboard.empty.add-widget-body",children:"Create lists, markdowns and other widgets"})})}),(0,t.jsx)(h.$n,{icon:"plus",fill:"outline","data-testid":i.Tp.pages.AddDashboard.itemButton("Create new widget button"),onClick:()=>{y.c.emptyDashboardButtonClicked({item:"add_widget"}),s.Ny.partial({addWidget:!0})},disabled:!E,children:(0,t.jsx)(g.x6,{i18nKey:"dashboard.empty.add-widget-button",children:"Add widget"})})]})}),(0,t.jsx)(c.a,{borderColor:"strong",borderStyle:"dashed",padding:3,flex:1,children:(0,t.jsxs)(a.B,{direction:"column",alignItems:"center",gap:1,children:[(0,t.jsx)(o.E,{element:"h3",textAlignment:"center",weight:"medium",children:(0,t.jsx)(g.x6,{i18nKey:"dashboard.empty.add-library-panel-header",children:"Import panel"})}),(0,t.jsx)(c.a,{marginBottom:2,children:(0,t.jsx)(o.E,{element:"p",textAlignment:"center",color:"secondary",children:(0,t.jsx)(g.x6,{i18nKey:"dashboard.empty.add-library-panel-body",children:"Add visualizations that are shared with other dashboards."})})}),(0,t.jsx)(h.$n,{icon:"plus",fill:"outline","data-testid":i.Tp.pages.AddDashboard.itemButton("Add a panel from the panel library button"),onClick:T,disabled:!E,children:(0,t.jsx)(g.x6,{i18nKey:"dashboard.empty.add-library-panel-button",children:"Add library panel"})})]})}),(0,t.jsx)(c.a,{borderColor:"strong",borderStyle:"dashed",padding:3,flex:1,children:(0,t.jsxs)(a.B,{direction:"column",alignItems:"center",gap:1,children:[(0,t.jsx)(o.E,{element:"h3",textAlignment:"center",weight:"medium",children:(0,t.jsx)(g.x6,{i18nKey:"dashboard.empty.import-a-dashboard-header",children:"Import a dashboard"})}),(0,t.jsx)(c.a,{marginBottom:2,children:(0,t.jsx)(o.E,{element:"p",textAlignment:"center",color:"secondary",children:(0,t.jsxs)(g.x6,{i18nKey:"dashboard.empty.import-a-dashboard-body",children:["Import dashboards from files or ",(0,t.jsx)("a",{href:"https://grafana.com/grafana/dashboards/",children:"grafana.com"}),"."]})})}),(0,t.jsx)(h.$n,{icon:"upload",fill:"outline","data-testid":i.Tp.pages.AddDashboard.itemButton("Import dashboard button"),onClick:()=>{y.c.emptyDashboardButtonClicked({item:"import_dashboard"}),(0,l.VF)()},disabled:!E,children:(0,t.jsx)(g.x6,{i18nKey:"dashboard.empty.import-dashboard-button",children:"Import dashboard"})})]})})]})]})})})};function P(x){return{wrapper:(0,n.css)({label:"dashboard-empty-wrapper",flexDirection:"column",maxWidth:"890px",gap:x.spacing.gridSize*4,paddingTop:x.spacing(2),[x.breakpoints.up("sm")]:{paddingTop:x.spacing(12)}})}}},2038:(G,O,e)=>{"use strict";e.d(O,{Z:()=>l});var t=e(74848),n=e(96540),i=e(12131),s=e(32196),r=e(40845),f=e(27746),a=e(14578),c=e(56034),o=e(16797);const h=({notice:p,onClick:m})=>{const y=(0,r.of)(g),d=p.severity==="error"||p.severity==="warning"?"exclamation-triangle":"file-landscape-alt";return p.inspect&&m?(0,t.jsx)(f.I,{className:y.notice,icon:d,iconSize:"md",tooltip:p.text,onClick:v=>m(v,p.inspect)},p.severity):p.link?(0,t.jsx)("a",{className:y.notice,"aria-label":p.text,href:p.link,target:"_blank",rel:"noreferrer",children:(0,t.jsx)(a.I,{name:d,style:{marginRight:"8px"},size:"md"})}):(0,t.jsx)(c.m,{content:p.text,children:(0,t.jsx)("span",{className:y.iconTooltip,children:(0,t.jsx)(a.I,{name:d,size:"md"})})},p.severity)},g=p=>({notice:(0,s.css)({background:"inherit",border:"none",borderRadius:p.shape.radius.default}),iconTooltip:(0,s.css)({color:`${p.colors.text.secondary}`,backgroundColor:"inherit",cursor:"auto",border:"none",borderRadius:`${p.shape.radius.default}`,padding:`${p.spacing(0,1)}`,height:` ${p.spacing(p.components.height.md)}`,display:"flex",alignItems:"center",justifyContent:"center","&:focus, &:focus-visible":{...(0,o.getFocusStyles)(p),zIndex:1},"&: focus:not(:focus-visible)":(0,o.getMouseFocusStyles)(p),"&:hover ":{boxShadow:`${p.shadows.z1}`,color:`${p.colors.text.primary}`,background:`${p.colors.background.secondary}`}})}),l=({frames:p,panelId:m})=>{const y=(0,n.useCallback)((v,u)=>{v.stopPropagation(),i.Ny.partial({inspect:m,inspectTab:u})},[m]),d={};for(const v of p)if(!(!v.meta||!v.meta.notices))for(const u of v.meta.notices)d[u.severity]=u;return(0,t.jsx)(t.Fragment,{children:Object.values(d).map(v=>(0,t.jsx)(h,{notice:v,onClick:y},v.severity))})}},91126:(G,O,e)=>{"use strict";e.d(O,{M:()=>h});var t=e(37055),n=e(58972),i=e(1173),s=e(11261),r=e(28240),f=e(85200),a=e(88895);const c="hideSeriesFrom",o=(0,t.ZW)(c);function h(v,u,D,P){const{overrides:x}=D,E=v,C=x.findIndex(o);if(C<0){if(u===a.B.ToggleSelection){const R=g([E,...d(x,P)]);return{...D,overrides:[...D.overrides,R]}}const T=y(P,E),b=g(T);return{...D,overrides:[...D.overrides,b]}}const M=Array.from(x),[S]=M.splice(C,1);if(u===a.B.ToggleSelection){let T=p(S);const b=d(M,P);if(b.length>0&&(T=T.filter(A=>b.indexOf(A)<0)),T[0]===E&&T.length===1)return{...D,overrides:M};const R=g([E,...b]);return{...D,overrides:[...M,R]}}const I=l(S,E);return m(I,P)?{...D,overrides:M}:{...D,overrides:[...M,I]}}function g(v,u=n.PP.exclude,D){return D=D??{id:"custom.hideFrom",value:{viz:!0,legend:!1,tooltip:!1}},{__systemRef:c,matcher:{id:i.Ct.byNames,options:{mode:u,names:v,prefix:u===n.PP.exclude?"All except:":void 0,readOnly:!0}},properties:[{...D,value:{viz:!0,legend:!1,tooltip:!1}}]}}const l=(v,u,D=n.PP.exclude)=>{const P=v.properties.find(C=>C.id==="custom.hideFrom"),x=p(v),E=x.findIndex(C=>C===u);return E<0?x.push(u):x.splice(E,1),g(x,D,P)},p=v=>{const u=v.matcher.options?.names;return Array.isArray(u)?[...u]:[]},m=(v,u)=>p(v).length===y(u).length,y=(v,u)=>{const D=new Set;for(const P of v)for(const x of P.fields){if(x.type!==s.PU.number)continue;const E=(0,r.Ct)(x,P,v);E!==u&&D.add(E)}return Array.from(D)},d=(v,u)=>{let D=[];for(const P of v){const x=P.properties.find(E=>E.id==="custom.hideFrom");if(x!==void 0&&x.value?.legend===!0){const C=f.sJ.get(P.matcher.id).get(P.matcher.options);for(const M of u)for(const S of M.fields){if(S.type!==s.PU.number)continue;const I=(0,r.Ct)(S,M,u);C(S,M,u)&&D.push(I)}}}return D}},61582:(G,O,e)=>{"use strict";e.d(O,{a:()=>c});var t=e(49426),n=e(47232),i=e(85858);const s=100;class r{constructor(){this.listeners=[],this.budget=1,this.threshold=1.5,this.ok=new t.t(!0),this.lastUpdate=Date.now(),this.isLive=!1,this.liveTimeOffset=0,this.measure=()=>{const h=Date.now();this.budget=(h-this.lastUpdate)/s;const g=this.ok.getValue(),l=this.budget<=this.threshold;if(g!==l&&this.ok.next(l),this.lastUpdate=h,this.isLive&&this.ok.getValue()&&this.timeRange){let p;for(const m of this.listeners){if(!m.panel.props.isInView)continue;if(h-m.last>=m.intervalMs){if(!p){const{raw:d}=this.timeRange;p={raw:d,from:(0,n.KQ)(h-this.liveTimeOffset),to:(0,n.KQ)(h)}}m.panel.liveTimeChanged(p),m.last=h}}}}}setLiveTimeRange(h){if(this.timeRange=h,this.isLive=h?.raw?.to==="now",this.isLive){const g=i.parse(h.raw.from,!1)?.valueOf(),l=i.parse(h.raw.to,!0)?.valueOf();this.liveTimeOffset=l-g;for(const p of this.listeners)p.intervalMs=a(this.liveTimeOffset,p.panel.props.width)}}listen(h){this.listeners.push({last:this.lastUpdate,panel:h,intervalMs:a(6e4,h.props.width)})}remove(h){this.listeners=this.listeners.filter(g=>g.panel!==h)}updateInterval(h){if(!(!this.timeRange||!this.isLive)){for(const g of this.listeners)if(g.panel===h){g.intervalMs=a(this.liveTimeOffset,g.panel.props.width);return}}}}const f=5*60*1e3;function a(o,h){const g=Math.ceil(o/h/100)*100;return g>f?f:g}const c=new r;setInterval(c.measure,s)},17493:(G,O,e)=>{"use strict";e.d(O,{Fu:()=>P,np:()=>x});var t=e(34796),n=e.n(t),i=e(2543),s=e.n(i),r=e(95093),f=e.n(r),a=e(26272),c=e(85858),o=e(17172),h=e(12131),g=e(27677),l=e(62301),p=e(68576),m=e(72255),y=e(31193),d=e(10096),v=e(28676),u=e(14792),D=e(69064);class P{constructor(){}_dashboardLoadFailed(M,S){return S=S||!1,{meta:{canStar:!1,isSnapshot:S,canDelete:!1,canSave:!1,canEdit:!1,canShare:!1,dashboardNotFound:!0},dashboard:{title:M,uid:M,schemaVersion:0}}}loadDashboard(M,S,I){const T=(0,m.sP)();let b;if(M==="script"&&S)b=this._loadScriptedDashboard(S);else if(M==="snapshot"&&S)b=(0,D.s)().getSnapshot(S).catch(()=>this._dashboardLoadFailed("Snapshot not found",!0));else if(M==="ds"&&S)b=this._loadFromDatasource(S);else if(M==="public"&&I)b=g.IB.getPublicDashboardByUid(I).then(R=>R).catch(R=>{const A=R.data.statusCode===403&&R.data.messageId==="publicdashboards.notEnabled",L=R.data.statusCode===404&&R.data.messageId==="publicdashboards.notFound",U=R.data.statusCode===404&&R.data.messageId==="publicdashboards.dashboardNotFound",W=this._dashboardLoadFailed(A?"Public Dashboard paused":"Public Dashboard Not found",!0);return{...W,meta:{...W.meta,publicDashboardEnabled:L?void 0:!A,dashboardNotFound:L||U}}});else if(I){const R=T.getDashboardFromCache(I);if(R)return Promise.resolve(R);b=(0,v.n)().getDashboardDTO(I).then(A=>{if(A.meta.isFolder)throw d.lE.emit(a.r1.alertError,["Dashboard not found"]),new Error("Dashboard not found");return A}).catch(()=>{const A=this._dashboardLoadFailed("Not found",!0);return A.dashboard.uid=I,A})}else throw new Error("Dashboard uid or slug required");return b.then(R=>(R.meta.dashboardNotFound!==!0&&l.A.addDashboardImpression(R.dashboard.uid),R)),b}_loadScriptedDashboard(M){const S="public/dashboards/"+M.replace(/\.(?!js)/,"/")+"?"+new Date().getTime();return(0,o.AI)().get(S).then(this._executeScript.bind(this)).then(I=>({meta:{fromScript:!0,canDelete:!1,canSave:!1,canStar:!1},dashboard:I.data}),I=>(console.error("Script dashboard error "+I),d.lE.emit(a.r1.alertError,["Script Error","Please make sure it exists and returns a valid dashboard"]),this._dashboardLoadFailed("Scripted dashboard")))}async _loadFromDatasource(M){const S=await(0,y.tR)().get(M);if(!S)return Promise.reject("can not find datasource: "+M);const I=new URLSearchParams(window.location.search),T=I.get("path");if(!T)return Promise.reject("expecting path parameter");const b={};return I.forEach((R,A)=>{b[A]=R}),(0,o.AI)().get(`/api/datasources/uid/${S.uid}/resources/${T}`,b).then(R=>({meta:{fromScript:!0,canDelete:!1,canSave:!1,canStar:!1},dashboard:R}))}_executeScript(M){const S={dashboardSrv:(0,u.UA)(),datasourceSrv:(0,y.tR)()},T=new Function("ARGS","kbn","dateMath","_","moment","window","document","$","jQuery","services",M)(h.Ny.getSearchObject(),p.A,c,s(),f(),window,document,n(),n(),S);return(0,i.isFunction)(T)?new Promise(b=>{T(R=>{b({data:R})})}):{data:T}}}let x=new P;const E=C=>{throw new Error("dashboardLoaderSrv can be only overriden in test environment")}},14792:(G,O,e)=>{"use strict";e.d(O,{UA:()=>l});var t=e(26272),n=e(28138),i=e(8484),s=e(27677),r=e(28676),f=e(28444),a=e(98365),c=e(19752);class o{constructor(){this.onRemovePanel=m=>{const y=this.getCurrent();y&&(0,c.FC)(y,y.getPanelById(m),!0)},n.l.subscribe(f.Vz,m=>this.onRemovePanel(m.payload))}create(m,y){return new a.G(m,y)}setCurrent(m){this.dashboard=m}getCurrent(){return this.dashboard}saveJSONDashboard(m){const y=JSON.parse(m);return(0,r.n)().saveDashboard({dashboard:y,folderUid:this.dashboard?.meta.folderUid||y.folderUid})}saveDashboard(m,y){return(0,r.n)().saveDashboard({message:m.message,folderUid:m.folderUid,dashboard:m.dashboard.getSaveModelClone(),showErrorAlert:y?.showErrorAlert})}starDashboard(m,y){const d=(0,s.AI)(),v={showSuccessAlert:!1,url:"/api/user/stars/dashboard/uid/"+m,method:y?"DELETE":"POST"};return d.request(v).then(()=>{const u=!y;this.dashboard?.uid===m&&(this.dashboard.meta.isStarred=u);const D=u?(0,i.t)("notifications.starred-dashboard","Dashboard starred"):(0,i.t)("notifications.unstarred-dashboard","Dashboard unstarred");return n.l.emit(t.r1.alertSuccess,[D]),u})}}let h;function g(p){h=p}function l(){return h||(h=new o),h}},69064:(G,O,e)=>{"use strict";e.d(O,{s:()=>c});var t=e(75505),n=e(81160),i=e(17172),s=e(32264),r=e(10096);const f={create:o=>(0,i.AI)().post("/api/snapshots",o),getSnapshots:()=>(0,i.AI)().get("/api/dashboard/snapshots"),getSharingOptions:()=>(0,i.AI)().get("/api/snapshot/shared-options"),deleteSnapshot:o=>(0,i.AI)().delete("/api/snapshots/"+o),getSnapshot:async o=>{const h=await(0,i.AI)().get("/api/snapshots/"+o);return h.meta.canShare=!1,h}};class a{constructor(){this.apiVersion="dashboardsnapshot.grafana.app/v0alpha1",this.url=`/apis/${this.apiVersion}/namespaces/${s.$.namespace}/dashboardsnapshots`}async create(h){return(0,i.AI)().post(this.url+"/create",h)}async getSnapshots(){return(await(0,i.AI)().get(this.url)).items.map(g=>({key:g.metadata.name,name:g.spec.title,external:g.spec.externalUrl!=null,externalUrl:g.spec.externalUrl}))}deleteSnapshot(h){return(0,i.AI)().delete(this.url+"/"+h)}async getSharingOptions(){return(0,i.AI)().get("/api/snapshot/shared-options")}async getSnapshot(h){const g={};if(!r.TP.isSignedIn){alert("TODO... need a barer token for anonymous use case");const l=`??? TODO, get anon token for snapshots (${r.TP.user?.name}) ???`;g.Authorization=`Bearer ${l}`}return(0,t.s)((0,i.AI)().fetch({url:this.url+"/"+h+"/body",method:"GET",headers:g}).pipe((0,n.T)(l=>({dashboard:l.data.dashboard,meta:{isSnapshot:!0,canSave:!1,canEdit:!1,canAdmin:!1,canStar:!1,canShare:!1,canDelete:!1,isFolder:!1,provisioned:!1}}))))}}function c(){return s.$.featureToggles.kubernetesSnapshots?new a:f}},74856:(G,O,e)=>{"use strict";e.d(O,{jG:()=>x});var t=e(2543),n=e(47232),i=e(43127),s=e(65879),r=e(26272),f=e(85858),a=e(12131),c=e(80943),o=e(76412),h=e(28138),g=e(2913),l=e(16233),p=e(80582),m=e(21380),y=e(28444),d=e(11134);function v({urlRefresh:E,currentRefresh:C,isAllowedIntervalFn:M,minRefreshInterval:S,refreshIntervals:I=d.cb}){if(!E)return C;const T=M(E),b=I.find(R=>R===E);if(!T||!b){const R=S?I.find(L=>L===S):void 0,A=I?.length?I[0]:void 0;return R??A??C}return E||C}class u{constructor(C){this.contextSrv=C,this.timeRangeForUrl=()=>{const M=this.timeRange().raw;return(0,n.Ar)(M.from)&&(M.from=M.from.valueOf().toString()),(0,n.Ar)(M.to)&&(M.to=M.to.valueOf().toString()),M},this.time=(0,i.E2)().raw,this.timeAtLoad=(0,i.E2)().raw,this.refreshTimeModel=this.refreshTimeModel.bind(this),h.A.subscribe(y.U0,M=>{this.zoomOut(M.payload.scale,M.payload.updateUrl)}),h.A.subscribe(y.Io,M=>{this.shiftTime(M.payload.direction,M.payload.updateUrl)}),h.A.subscribe(y.Rh,M=>{this.makeAbsoluteTime(M.payload.updateUrl)}),h.A.subscribe(y.Bt,()=>{this.copyTimeRangeToClipboard()}),h.A.subscribe(y.VZ,M=>{this.pasteTimeRangeFromClipboard(M.payload.updateUrl)}),document.addEventListener("visibilitychange",()=>{this.autoRefreshBlocked&&document.visibilityState==="visible"&&(this.autoRefreshBlocked=!1,this.refreshTimeModel())})}init(C){this.timeModel=C,this.time=C.time,this.refresh=C.refresh,this.initTimeFromUrl(),this.parseTime(),this.timeAtLoad=(0,t.cloneDeep)(this.time),this.refresh&&this.setAutoRefresh(this.refresh)}getValidIntervals(C){return this.contextSrv.getValidIntervals(C)}parseTime(){(0,t.isString)(this.time.from)&&this.time.from.indexOf("Z")>=0&&(this.time.from=(0,n.KQ)(this.time.from).utc()),(0,t.isString)(this.time.to)&&this.time.to.indexOf("Z")>=0&&(this.time.to=(0,n.KQ)(this.time.to).utc())}parseUrlParam(C,M){if(C.indexOf("now")!==-1)return C;if(C.length===8){const S=(0,n.yT)(C,"YYYYMMDD");if(S.isValid())return S}else if(C.length===15){const S=(0,n.yT)(C,"YYYYMMDDTHHmmss");if(S.isValid())return S}if(!isNaN(Number(C))){const S=parseInt(C,10);return M?(0,n.oZ)(M,S):(0,n.yT)(S)}return null}getTimeWindow(C,M){const S=parseInt(C,10);let I;return M.match(/^\d+$/)&&parseInt(M,10)?I=parseInt(M,10):I=s.intervalToMs(M),{from:(0,n.yT)(S-I/2),to:(0,n.yT)(S+I/2)}}initTimeFromUrl(){if(g.config.publicDashboardAccessToken&&this.timeModel?.timepicker?.hidden)return;const C=a.Ny.getSearch();C.get("time")&&C.get("time.window")&&(this.time=this.getTimeWindow(C.get("time"),C.get("time.window")));const M=this.timeModel?.getTimezone();C.get("from")&&(this.time.from=this.parseUrlParam(C.get("from"),M)||this.time.from),C.get("to")&&(this.time.to=this.parseUrlParam(C.get("to"),M)||this.time.to),C.get("to")&&C.get("to").indexOf("now")===-1&&(this.refresh=!1,this.timeModel&&(this.timeModel.refresh=void 0)),this.refresh=v({urlRefresh:C.get("refresh"),currentRefresh:this.refresh,refreshIntervals:Array.isArray(this.timeModel?.timepicker?.refresh_intervals)?this.timeModel?.timepicker?.refresh_intervals:void 0,isAllowedIntervalFn:this.contextSrv.isAllowedInterval,minRefreshInterval:g.config.minRefreshInterval})}updateTimeRangeFromUrl(){const C=a.Ny.getSearch();if(C.get("left"))return;const M=this.timeRangeForUrl(),S=C.get("from"),I=C.get("to");S&&I?(S!==M.from||I!==M.to)&&(this.initTimeFromUrl(),this.setTime(this.time,!1)):this.timeHasChangedSinceLoad()&&this.setTime(this.timeAtLoad,!0)}timeHasChangedSinceLoad(){return this.timeAtLoad&&(this.timeAtLoad.from!==this.time.from||this.timeAtLoad.to!==this.time.to)}setAutoRefresh(C){this.timeModel&&(this.timeModel.refresh=C),this.stopAutoRefresh();const M=a.Ny.getSearchObject();if(!C){M.refresh&&a.Ny.partial({refresh:null},!0);return}let S=C,I=60*1e3;C===l.SM?I=this.getAutoRefreshInteval().intervalMs:(S=this.contextSrv.getValidInterval(C),I=s.intervalToMs(S)),this.refreshMS=I,this.refreshTimer=window.setTimeout(()=>{this.startNextRefreshTimer(I),this.refreshTimeModel()},I),M.refresh!==S&&a.Ny.partial({refresh:S},!0)}getAutoRefreshInteval(){const C=window?.innerWidth??2e3;return s.calculateInterval(this.timeRange(),C,g.config.minRefreshInterval)}refreshTimeModel(){this.timeModel?.timeRangeUpdated(this.timeRange())}startNextRefreshTimer(C){this.refreshTimer=window.setTimeout(()=>{this.startNextRefreshTimer(C),this.contextSrv.isGrafanaVisible()?this.refreshTimeModel():this.autoRefreshBlocked=!0},C)}stopAutoRefresh(){clearTimeout(this.refreshTimer),this.refreshTimer=void 0,this.refreshMS=void 0}resumeAutoRefresh(){this.timeModel?.refresh&&this.setAutoRefresh(this.timeModel.refresh)}setTime(C,M=!0){if((0,t.extend)(this.time,C),(0,n.Ar)(C.to)?(this.oldRefresh=this.timeModel?.refresh||this.oldRefresh,this.setAutoRefresh("")):this.oldRefresh&&this.oldRefresh!==this.timeModel?.refresh&&(this.setAutoRefresh(this.oldRefresh),this.oldRefresh=void 0),M===!0){const S=this.timeRangeForUrl(),I=a.Ny.getSearchObject();if(I.from===S.from.toString()&&I.to===S.to.toString())return;I.from=S.from.toString(),I.to=S.to.toString(),a.Ny.partial(I)}this.timeModel?.refresh===l.SM&&this.getAutoRefreshInteval().intervalMs!==this.refreshMS&&this.setAutoRefresh(l.SM),this.refreshTimeModel()}timeRange(){return window.__grafanaSceneContext&&window.__grafanaSceneContext.isActive?c.jh.getTimeRange(window.__grafanaSceneContext).state.value:(0,m.z)(this.time,this.timeModel)}zoomOut(C,M=!0){const S=this.timeRange(),{from:I,to:T}=(0,p.Zk)(S,C);this.setTime({from:(0,n.yT)(I),to:(0,n.yT)(T)},M)}shiftTime(C,M=!0){const S=this.timeRange(),{from:I,to:T}=(0,p.Wb)(C,S);this.setTime({from:(0,n.yT)(I),to:(0,n.yT)(T)},M)}makeAbsoluteTime(C){const{from:M,to:S}=this.timeRange();this.setTime({from:M,to:S},C)}copyTimeRangeToClipboard(){const{raw:C}=this.timeRange();navigator.clipboard.writeText(JSON.stringify({from:C.from,to:C.to})),h.A.emit(r.r1.alertSuccess,[(0,o.t)("time-picker.copy-paste.copy-success-message","Time range copied to clipboard")])}async pasteTimeRangeFromClipboard(C=!0){const{range:M,isError:S}=await(0,p.zG)();if(S===!0){h.A.emit(r.r1.alertError,[(0,o.t)("time-picker.copy-paste.default-error-title","Invalid time range"),(0,o.t)("time-picker.copy-paste.default-error-message","{{error}} is not a valid time range",{error:M})]);return}const{from:I,to:T}=M;this.setTime({from:I,to:T},C)}isRefreshOutsideThreshold(C,M=.05){const S=this.timeRange();if(f.isMathString(S.raw.from)){const I=S.to.diff(S.from),T=Date.now()-C,b=I*M;return T>=b}return!1}}let D;function P(E){D=E}function x(){return D||(D=new u(l.TP)),D}},79056:(G,O,e)=>{"use strict";e.d(O,{O2:()=>w,SW:()=>N,og:()=>k});var t=e(2543),n=e(69550),i=e(92041),s=e(12470),r=e(22391),f=e(76885),a=e(6709),c=e(25019),o=e(47737),h=e(1173),g=e(11261),l=e(6829),p=e(58140),m=e(19347),y=e(52622),d=e(57021),v=e(33919),u=e(2913),D=e(15054);function P(z){return Array.from(new Array(z+1),(te,le)=>le).filter(te=>z%te===0)}var x=e(68576),E=e(31193),C=e(24240),M=e(86886),S=e(14678),I=e(14738),T=e(36373),b=e(77789),R=e(25640);function A(z,te){const le=[];if(z?.statistics&&z?.statistics.length){z.statistic=z.statistics[0];for(const ie of z.statistics.splice(1))le.push({...z,statistic:ie})}for(const ie of le)ie.refId=(0,b.M)(te),delete ie.statistics,te.push(ie);return delete z.statistics,le}function L(z){const te=[];if(z&&"statistics"in z&&z?.statistics?.length){for(const le of z.statistics.splice(1)){const{statistics:ie,name:ae,...re}=z;te.push({...re,statistic:le,name:`${ae} - ${le}`})}z.statistic=z.statistics[0],te.length!==0&&(z.name=`${z.name} - ${z.statistic}`),delete z.statistics}return te}function U(z){z.hasOwnProperty("metricQueryType")||(z.metricQueryType=R.d$.Search),z.hasOwnProperty("metricEditorMode")||(z.metricQueryType===R.d$.Insights?z.metricEditorMode=R.Rx.Code:z.metricEditorMode=z.expression?R.Rx.Code:R.Rx.Builder)}var W=e(84423);n.D.setInit(v.H),n.G.setInit(v.u);const w=39;class N{constructor(te){this.dashboard=te,(0,m.l)()||(0,m.h)(new E.xq)}updateSchema(te){let le,ie,ae,re;const ce=this.dashboard.schemaVersion,me=[];if(this.dashboard.schemaVersion=w,ce!==this.dashboard.schemaVersion){if(ce<2&&(te.services&&te.services.filter&&(this.dashboard.time=te.services.filter.time,this.dashboard.templating.list=te.services.filter.list||[]),me.push(ee=>(ee.type==="graphite"&&(ee.type="graph"),ee.type!=="graph"||((0,t.isBoolean)(ee.legend)&&(ee.legend={show:ee.legend}),ee.grid&&(ee.grid.min&&(ee.grid.leftMin=ee.grid.min,delete ee.grid.min),ee.grid.max&&(ee.grid.leftMax=ee.grid.max,delete ee.grid.max)),ee.y_format&&(ee.y_formats||(ee.y_formats=[]),ee.y_formats[0]=ee.y_format,delete ee.y_format),ee.y2_format&&(ee.y_formats||(ee.y_formats=[]),ee.y_formats[1]=ee.y2_format,delete ee.y2_format)),ee))),ce<3){let ee=this.dashboard.getNextPanelId();me.push(de=>(de.id||(de.id=ee,ee+=1),de))}if(ce<4&&me.push(ee=>(ee.type!=="graph"||((0,t.each)(ee.aliasYAxis,(de,De)=>{ee.seriesOverrides=[{alias:De,yaxis:de}]}),delete ee.aliasYAxis),ee)),ce<6){const ee=(0,t.find)(te.pulldowns,{type:"annotations"});for(ee&&(this.dashboard.annotations={list:ee.annotations||[]}),le=0;le<this.dashboard.templating.list.length;le++){const de=this.dashboard.templating.list[le];de.datasource===void 0&&(de.datasource=null),de.type==="filter"&&(de.type="query"),de.type===void 0&&(de.type="query"),de.allFormat===void 0&&delete de.allFormat}}if(ce<7&&(te.nav&&te.nav.length&&(this.dashboard.timepicker=te.nav[0]),me.push(ee=>((0,t.each)(ee.targets,de=>{de.refId||(de.refId=ee.getNextQueryLetter&&ee.getNextQueryLetter())}),ee))),ce<8&&me.push(ee=>((0,t.each)(ee.targets,de=>{de.fields&&de.tags&&de.groupBy&&(de.rawQuery?(delete de.fields,delete de.fill):(de.select=(0,t.map)(de.fields,De=>{const fe=[];return fe.push({type:"field",params:[De.name]}),fe.push({type:De.func,params:[]}),De.mathExpr&&fe.push({type:"math",params:[De.mathExpr]}),De.asExpr&&fe.push({type:"alias",params:[De.asExpr]}),fe}),delete de.fields,(0,t.each)(de.groupBy,De=>{De.type==="time"&&De.interval&&(De.params=[De.interval],delete De.interval),De.type==="tag"&&De.key&&(De.params=[De.key],delete De.key)}),de.fill&&(de.groupBy.push({type:"fill",params:[de.fill]}),delete de.fill)))}),ee)),ce<9&&me.push(ee=>{if(ee.type!=="singlestat"&&ee.thresholds!=="")return ee;if(ee.thresholds){const de=ee.thresholds.split(",");de.length>=3&&(de.shift(),ee.thresholds=de.join(","))}return ee}),ce<10&&me.push(ee=>(ee.type!=="table"||(0,t.each)(ee.styles,de=>{if(de.thresholds&&de.thresholds.length>=3){const De=de.thresholds;De.shift(),de.thresholds=De}}),ee)),ce<12&&(0,t.each)(this.dashboard.getVariables(),ee=>{"refresh"in ee&&(ee.refresh&&(ee.refresh=1),ee.refresh||(ee.refresh=0)),"hideVariable"in ee&&ee.hideVariable?ee.hide=2:"hideLabel"in ee&&ee.hideLabel&&(ee.hide=1)}),ce<12&&me.push(ee=>(ee.type!=="graph"||!ee.grid||ee.yaxes||(ee.yaxes=[{show:ee["y-axis"],min:ee.grid.leftMin,max:ee.grid.leftMax,logBase:ee.grid.leftLogBase,format:ee.y_formats[0],label:ee.leftYAxisLabel},{show:ee["y-axis"],min:ee.grid.rightMin,max:ee.grid.rightMax,logBase:ee.grid.rightLogBase,format:ee.y_formats[1],label:ee.rightYAxisLabel}],ee.xaxis={show:ee["x-axis"]},delete ee.grid.leftMin,delete ee.grid.leftMax,delete ee.grid.leftLogBase,delete ee.grid.rightMin,delete ee.grid.rightMax,delete ee.grid.rightLogBase,delete ee.y_formats,delete ee.leftYAxisLabel,delete ee.rightYAxisLabel,delete ee["y-axis"],delete ee["x-axis"]),ee)),ce<13&&me.push(ee=>{if(ee.type!=="graph"||!ee.grid)return ee;ee.thresholds||(ee.thresholds=[]);const de={},De={};return ee.grid.threshold1!==null&&(de.value=ee.grid.threshold1,ee.grid.thresholdLine?(de.line=!0,de.lineColor=ee.grid.threshold1Color,de.colorMode="custom"):(de.fill=!0,de.fillColor=ee.grid.threshold1Color,de.colorMode="custom")),ee.grid.threshold2!==null&&(De.value=ee.grid.threshold2,ee.grid.thresholdLine?(De.line=!0,De.lineColor=ee.grid.threshold2Color,De.colorMode="custom"):(De.fill=!0,De.fillColor=ee.grid.threshold2Color,De.colorMode="custom")),(0,t.isNumber)(de.value)&&((0,t.isNumber)(De.value)?de.value>De.value?(de.op=De.op="lt",ee.thresholds.push(de),ee.thresholds.push(De)):(de.op=De.op="gt",ee.thresholds.push(de),ee.thresholds.push(De)):(de.op="gt",ee.thresholds.push(de))),delete ee.grid.threshold1,delete ee.grid.threshold1Color,delete ee.grid.threshold2,delete ee.grid.threshold2Color,delete ee.grid.thresholdLine,ee}),ce<14&&(this.dashboard.graphTooltip=te.sharedCrosshair?1:0),ce<16&&this.upgradeToGridLayout(te),ce<17&&me.push(ee=>{if(ee.minSpan){const de=D.cV/ee.minSpan,De=P(D.cV);ee.maxPerRow=De[(0,t.findIndex)(De,fe=>fe>de)-1]}return delete ee.minSpan,ee}),ce<18&&me.push(ee=>(ee["options-gauge"]&&(ee.options=ee["options-gauge"],ee.options.valueOptions={unit:ee.options.unit,stat:ee.options.stat,decimals:ee.options.decimals,prefix:ee.options.prefix,suffix:ee.options.suffix},ee.options.thresholds&&ee.options.thresholds.reverse(),delete ee.options.options,delete ee.options.unit,delete ee.options.stat,delete ee.options.decimals,delete ee.options.prefix,delete ee.options.suffix,delete ee["options-gauge"]),ee)),ce<19&&me.push(ee=>(ee.links&&(0,t.isArray)(ee.links)&&(ee.links=ee.links.map(K)),ee)),ce<20){const ee=de=>({...de,url:H(de.url)});me.push(de=>(de.options&&de.options.dataLinks&&(0,t.isArray)(de.options.dataLinks)&&(de.options.dataLinks=de.options.dataLinks.map(ee)),de.options&&de.options.fieldOptions&&de.options.fieldOptions.defaults&&(de.options.fieldOptions.defaults.links&&(0,t.isArray)(de.options.fieldOptions.defaults.links)&&(de.options.fieldOptions.defaults.links=de.options.fieldOptions.defaults.links.map(ee)),de.options.fieldOptions.defaults.title&&(de.options.fieldOptions.defaults.title=H(de.options.fieldOptions.defaults.title))),de))}if(ce<21){const ee=de=>({...de,url:de.url.replace(/__series.labels/g,"__field.labels")});me.push(de=>(de.options&&de.options.dataLinks&&(0,t.isArray)(de.options.dataLinks)&&(de.options.dataLinks=de.options.dataLinks.map(ee)),de.options&&de.options.fieldOptions&&de.options.fieldOptions.defaults&&de.options.fieldOptions.defaults.links&&(0,t.isArray)(de.options.fieldOptions.defaults.links)&&(de.options.fieldOptions.defaults.links=de.options.fieldOptions.defaults.links.map(ee)),de))}if(ce<22&&me.push(ee=>(ee.type!=="table"||(0,t.each)(ee.styles,de=>{de.align="auto"}),ee)),ce<23)for(const ee of this.dashboard.templating.list){if(!(0,C.iv)(ee))continue;const{multi:de,current:De}=ee;(0,i.R)(De)||(ee.current=(0,M.C)(De,de))}if(ce<24&&me.push(ee=>{const de=ee.type==="table";if(de&&!ee.styles)return ee;const De=ee.table==="table2";return!de||De||(ee.type=de?"table-old":"table"),ee}),ce<25,ce<26&&me.push(ee=>(ee.type==="text2"&&(ee.type="text",delete ee.options.angular),ee)),ce<27&&(this.removeRepeatedPanels(),this.dashboard.templating.list=this.dashboard.templating.list.map(ee=>{if(!(0,C.VO)(ee))return ee;const de={...ee};return de.current={selected:!0,text:de.query??"",value:de.query??""},de.options=[de.current],de.hide===s.zL.dontHide||de.hide===s.zL.hideLabel?{...de,type:"textbox"}:de})),ce<28){me.push(ee=>ee.type==="singlestat"?X(ee):ee);for(const ee of this.dashboard.templating.list)ee.tags&&delete ee.tags,ee.tagsQuery&&delete ee.tagsQuery,ee.tagValuesQuery&&delete ee.tagValuesQuery,ee.useTags&&delete ee.useTags}if(ce<29)for(const ee of this.dashboard.templating.list)ee.type==="query"&&(ee.refresh!==1&&ee.refresh!==2&&(ee.refresh=1),ee.options?.length&&(ee.options=[]));if(ce<30&&(me.push(Z),me.push(ne)),ce<31&&me.push(ee=>{if(ee.transformations){for(const de of ee.transformations)if(de.id===l.V.id)return Y(ee,l.V.id,{id:p.o.id,options:{}})}return ee}),ce<32,ce<33&&me.push(ee=>{if(ee.datasource=k(ee.datasource,{returnDefaultAsNull:!0}),!ee.targets)return ee;for(const de of ee.targets){const De=k(de.datasource,{returnDefaultAsNull:!0});De!=null&&(de.datasource=De)}return ee}),ce<34&&(me.push(ee=>(this.migrateCloudWatchQueries(ee),ee)),this.migrateCloudWatchAnnotationQuery()),ce<35&&me.push(oe),ce<36){for(const de of this.dashboard.annotations.list)de.datasource=k(de.datasource,{returnDefaultAsNull:!1});const ee=(0,m.l)().getInstanceSettings(null);if(ee){for(const de of this.dashboard.templating.list)de.type==="query"&&de.datasource===null&&(de.datasource=(0,r.p$)(ee));me.push(de=>{if(de.targets){let De=!1;de.datasource==null&&de.targets.length>0&&(de.datasource=(0,r.p$)(ee),De=!0);for(const fe of de.targets)(fe.datasource==null||fe.datasource.uid==null)&&(de.datasource?.uid!==S.uv?fe.datasource={...de.datasource}:fe.datasource=k(fe.datasource,{returnDefaultAsNull:!1})),De&&fe.datasource?.uid!=="__expr__"&&(de.datasource=fe.datasource)}return de})}}if(ce<37&&me.push(ee=>(ee.options?.legend&&(ee.options.legend.displayMode==="hidden"||ee.options.legend.showLegend===!1)?(ee.options.legend.displayMode="list",ee.options.legend.showLegend=!1):ee.options?.legend&&(ee.options.legend={...ee.options?.legend,showLegend:!0}),ee)),ce<38&&me.push(ee=>{if(ee.type==="table"&&ee.fieldConfig!==void 0){const de=ee.fieldConfig.defaults?.custom?.displayMode;if(de!==void 0&&(ee.fieldConfig.defaults.custom.cellOptions=(0,d.o7)(de),delete ee.fieldConfig.defaults.custom.displayMode),ee.fieldConfig?.overrides)for(const De of ee.fieldConfig.overrides)for(let fe=0;fe<De.properties?.length;fe++){let Te=De.properties[fe].value;De.properties[fe].id==="custom.displayMode"&&(De.properties[fe].id="custom.cellOptions",De.properties[fe].value=(0,d.o7)(Te))}}return ee}),ce<39&&me.push(ee=>(ee.transformations?.forEach(de=>{if(de.id==="timeSeriesTable"&&de.options!==void 0&&de.options.refIdToStat!==void 0){let De={};for(const[fe,Te]of Object.entries(de.options.refIdToStat)){let je={};je.stat=Te,De[fe]=je}de.options=De}}),ee)),me.length!==0)for(ie=0;ie<this.dashboard.panels.length;ie++)for(ae=0;ae<me.length;ae++){this.dashboard.panels[ie]=me[ae].call(this,this.dashboard.panels[ie]);const ee=this.dashboard.panels[ie].panels;if(ee)for(re=0;re<ee.length;re++)ee[re]=me[ae].call(this,ee[re])}}}removeRepeatedPanels(){const te=[];for(const le of this.dashboard.panels)le.repeatPanelId||le.repeatByRow||(le.type==="row"&&Array.isArray(le.panels)&&(le.panels=le.panels.filter(ie=>!ie.repeatPanelId)),te.push(le));this.dashboard.panels=te}migrateCloudWatchQueries(te){for(const le of te.targets||[])if(se(le)&&(U(le),le.hasOwnProperty("statistics"))){const ie=A(le,[...te.targets]);for(const ae of ie)te.targets.push(ae)}}migrateCloudWatchAnnotationQuery(){for(const te of this.dashboard.annotations.list)if(j(te)){const le=L(te);for(const ie of le)this.dashboard.annotations.list.push(ie)}}upgradeToGridLayout(te){let le=0;const ie=D.cV/12;let re=(0,t.max)((0,t.flattenDeep)((0,t.map)(te.rows,me=>(0,t.map)(me.panels,"id"))))+1;if(!te.rows)return;const ce=(0,t.some)(te.rows,me=>me.collapse||me.showTitle||me.repeat);for(const me of te.rows){if(me.repeatIteration)continue;const ee=me.height||D.bJ,de=B(ee),De={};let fe;ce&&(De.id=re,De.type="row",De.title=me.title,De.collapsed=me.collapse,De.repeat=me.repeat,De.panels=[],De.gridPos={x:0,y:le,w:D.cV,h:de},fe=new W.a9(De),re++,le++);const Te=new V(de,D.cV,le);for(const je of me.panels){je.span=je.span||D.o9,je.minSpan&&(je.minSpan=Math.min(D.cV,D.cV/12*je.minSpan));const He=Math.floor(je.span)*ie,Be=je.height?B(je.height):de,Ne=Te.getPanelPosition(Be,He);le=Te.yPos,je.gridPos={x:Ne.x,y:le+Ne.y,w:He,h:Be},Te.addPanel(je.gridPos),delete je.span,fe&&De.collapsed?fe.panels?.push(je):this.dashboard.panels.push(new W.a9(je))}fe&&this.dashboard.panels.push(fe),fe&&De.collapsed||(le+=de)}}}function B(z){return(0,t.isString)(z)&&(z=parseInt(z.replace("px",""),10)),z<D.cx&&(z=D.cx),Math.ceil(z/(D.sD+D.dU))}class V{constructor(te,le=D.cV,ie=0){this.area=new Array(le).fill(0),this.yPos=ie,this.height=te}reset(){this.area.fill(0)}addPanel(te){for(let le=te.x;le<te.x+te.w;le++)(!this.area[le]||te.y+te.h-this.yPos>this.area[le])&&(this.area[le]=te.y+te.h-this.yPos);return this.area}getPanelPosition(te,le,ie=!1){let ae,re,ce;for(let me=this.area.length-1;me>=0&&this.height-this.area[me]>0;me--)if(re===void 0)re=me;else if(me<this.area.length-1&&this.area[me]<=this.area[me+1])ae=me;else break;if(ae!==void 0&&re!==void 0&&re-ae>=le-1){const me=(0,t.max)(this.area.slice(ae));ce={x:ae,y:me}}else return ie?null:(this.yPos+=this.height,this.reset(),this.getPanelPosition(te,le,!0));return ce}}function K(z){let te=z.url;return!te&&z.dashboard&&(te=`dashboard/db/${x.A.slugifyForUrl(z.dashboard)}`),!te&&z.dashUri&&(te=`dashboard/${z.dashUri}`),te||(te="/"),z.keepTime&&(te=f.kM.appendQueryToUrl(te,`$${a.c.keepTime}`)),z.includeVars&&(te=f.kM.appendQueryToUrl(te,`$${a.c.includeVars}`)),z.params&&(te=f.kM.appendQueryToUrl(te,z.params)),{url:te,title:z.title,targetBlank:z.targetBlank}}function H(z){const te=/(__series_name)|(\$__series_name)|(__value_time)|(__field_name)|(\$__field_name)/g;return z.replace(te,(le,ie,ae,re,ce,me)=>ie?"__series.name":ae?"${__series.name}":re?"__value.time":ce?"__field.name":me?"${__field.name}":le)}function X(z){if(u.config.panels["grafana-singlestat-panel"])return z.type="grafana-singlestat-panel",z;let te=!1;return z.changePlugin||(te=!0,z=new W.a9(z)),z.plugin={angularPanelCtrl:{}},z.gauge?.show?(I.plugin.meta=u.config.panels.gauge,z.changePlugin(I.plugin)):(T.plugin.meta=u.config.panels.stat,z.changePlugin(T.plugin)),te?z.getSaveModel():z}function k(z,te){if(te.returnDefaultAsNull&&(z==null||z==="default"))return null;if((0,r.fN)(z))return z;const le=(0,m.l)().getInstanceSettings(z);return le?(0,r.p$)(le):{uid:z||void 0}}function Y(z,te,le){if(z.transformations){const ie=[];for(const ae of z.transformations)ie.push(ae),ae.id===te&&ie.push({...le});z.transformations=ie}return z}function Z(z){const te=z.fieldConfig;if(!te)return z;if(te.defaults&&te.defaults.mappings&&(te.defaults.mappings=q(te.defaults.mappings,te.defaults.thresholds)),Array.isArray(te.overrides))for(const le of te.overrides)for(const ie of le.properties)ie.id==="mappings"&&(ie.value=q(ie.value));return z}function se(z){return z.hasOwnProperty("dimensions")&&z.hasOwnProperty("namespace")&&z.hasOwnProperty("region")&&z.hasOwnProperty("metricName")}function j(z){return z.hasOwnProperty("dimensions")&&z.hasOwnProperty("namespace")&&z.hasOwnProperty("region")&&z.hasOwnProperty("prefixMatching")&&z.hasOwnProperty("statistics")}function q(z,te){if(!z)return;const le={type:c.d.ValueToText,options:{}},ie=[];for(const ae of z){if(ae.type&&ae.options){ae.type===c.d.ValueToText?le.options={...le.options,...ae.options}:ie.push(ae);continue}let re;const ce=parseFloat(ae.text);if(te&&!isNaN(ce)){const me=(0,o.yQ)(ce,te.steps);me&&me.color&&(re=me.color)}switch(ae.type){case 1:ae.value!=null&&(ae.value==="null"?ie.push({type:c.d.SpecialValue,options:{match:c.W.Null,result:{text:ae.text,color:re}}}):le.options[String(ae.value)]={text:ae.text,color:re});break;case 2:ie.push({type:c.d.RangeToText,options:{from:+ae.from,to:+ae.to,result:{text:ae.text,color:re}}});break}}return Object.keys(le.options).length>0&&ie.unshift(le),ie}function ne(z){return(z.type==="timeseries"||z.type==="xychart"||z.type==="xychart2")&&z.options.tooltipOptions&&(z.options={...z.options,tooltip:z.options.tooltipOptions},delete z.options.tooltipOptions),z}function oe(z){return z.type==="timeseries"&&z.fieldConfig?.defaults.custom?.axisPlacement===y.vM.Hidden&&(z.fieldConfig={...z.fieldConfig,overrides:[...z.fieldConfig.overrides,{matcher:{id:h.Ct.byType,options:g.PU.time},properties:[{id:"custom.axisPlacement",value:y.vM.Auto}]}]}),z}},98365:(G,O,e)=>{"use strict";e.d(O,{G:()=>U});var t=e(2543),n=e(64423),i=e(18226),s=e(72724),r=e(47232),f=e(3591),a=e(32264),c=e(24284),o=e(15054),h=e(16233),g=e(28874),l=e(8480),p=e(20601),m=e(72401),y=e(87421),d=e(31678),v=e(28444),u=e(10096),D=e(99140),P=e(80484),x=e(75096),E=e(74856),C=e(34214);const M=new Set(["gridPos","title","description","transparent"]);function S(N,B){const V=[],K={changed:!1,actions:{add:[],remove:[],replace:[],update:[],noop:[]},panels:V};let H=0;const X=new Map;for(let k of B){let{id:Y}=k;Y||(H||(H=T([N,B])),Y=H++,k={...k,id:Y}),X.set(Y,k)}for(const k of N){const Y=X.get(k.id);if(!Y){K.changed=!0,K.actions.remove.push(k.id),k.destroy();continue}if(X.delete(k.id),Y===k){V.push(k),K.actions.noop.push(k.id);continue}if(k.type===Y.type){const se=k.getSaveModel();let j=!0,q=!1;for(const[ne,oe]of Object.entries(Y))if(!(0,t.isEqualWith)(oe,se[ne],I))if(K.changed=!0,j=!1,M.has(ne))k[ne]=oe,q=!0;else{q=!1;break}if(j){V.push(k),K.actions.noop.push(k.id);continue}if(q){V.push(k),K.actions.update.push(k.id);continue}}k.destroy();const Z=new C.a(Y);Z.key=`${Z.id}-update-${Date.now()}`,V.push(Z),K.changed=!0,K.actions.replace.push(k.id)}for(const k of X.values())V.push(new C.a(k)),K.changed=!0,K.actions.add.push(k.id);return K}function I(N,B){if(N==null&&(B===1/0||B===-1/0||B==null)||B==null&&(N===1/0||N===-1/0||N==null))return!0}function T(N){let B=0;for(const V of N)for(const K of V)K.id>B&&(B=K.id);return B+1}var b=e(79056),R=e(84423);function A(N,B){return N.repeatDirection===o.HG?!1:B.gridPos.x>=N.gridPos.x+N.gridPos.w&&B.gridPos.y===N.gridPos.y}function L(N){for(const B of N)if(delete B.scopedVars,B.panels?.length)for(const V of B.panels)delete V.scopedVars}class U{constructor(B,V,K){this.timeRangeUpdatedDuringEditOrView=!1,this.originalDashboard=null,this.getVariablesFromState=K?.getVariablesFromState??y.SS,this.events=new i.o,this.id=B.id||null,this.uid=B.uid||null,this.revision=B.revision??void 0,this.title=B.title??"No Title",this.description=B.description,this.tags=B.tags??[],this.timezone=B.timezone??"",this.weekStart=B.weekStart??"",this.editable=B.editable!==!1,this.graphTooltip=B.graphTooltip||0,this.time=B.time??{from:"now-6h",to:"now"},this.timepicker=B.timepicker??{},this.liveNow=B.liveNow,this.templating=this.ensureListExist(B.templating),this.annotations=this.ensureListExist(B.annotations),this.refresh=B.refresh,this.snapshot=B.snapshot,this.schemaVersion=B.schemaVersion??0,this.fiscalYearStartMonth=B.fiscalYearStartMonth??0,this.version=B.version??0,this.links=B.links??[],this.gnetId=B.gnetId||null,this.panels=(0,t.map)(B.panels??[],H=>new R.a9(H)),this.originalDashboard=(0,t.cloneDeep)(B),this.originalTemplating=(0,t.cloneDeep)(this.templating),this.originalTime=(0,t.cloneDeep)(this.time),this.ensurePanelsHaveUniqueIds(),this.formatDate=this.formatDate.bind(this),this.initMeta(V),this.updateSchema(B),this.addBuiltInAnnotationQuery(),this.sortPanelsByGridPos(),this.panelsAffectedByVariableChange=null,this.appEventsSubscription=new n.yU,this.lastRefresh=Date.now(),this.appEventsSubscription.add(u.lE.subscribe(P.og,this.variablesChangedHandler.bind(this))),this.appEventsSubscription.add(u.lE.subscribe(P.BS,this.variablesTimeRangeProcessDoneHandler.bind(this))),this.appEventsSubscription.add(u.lE.subscribe(P.eF,this.variablesChangedInUrlHandler.bind(this)))}static{this.nonPersistedProperties={events:!0,meta:!0,panels:!0,templating:!0,originalTime:!0,originalTemplating:!0,originalLibraryPanels:!0,panelInEdit:!0,panelInView:!0,getVariablesFromState:!0,formatDate:!0,appEventsSubscription:!0,panelsAffectedByVariableChange:!0,lastRefresh:!0,timeRangeUpdatedDuringEditOrView:!0,originalDashboard:!0}}addBuiltInAnnotationQuery(){this.annotations.list.some(V=>V.builtIn===1)||this.annotations.list.unshift({datasource:{uid:"-- Grafana --",type:"grafana"},name:"Annotations & Alerts",type:"dashboard",iconColor:c.Mk,enable:!0,hide:!0,builtIn:1})}initMeta(B){B=B||{},B.canShare=B.canShare!==!1,B.canSave=B.canSave!==!1,B.canStar=B.canStar!==!1,B.canEdit=B.canEdit!==!1,B.canDelete=B.canDelete!==!1,B.showSettings=B.canEdit,B.canMakeEditable=B.canSave&&!this.editable,B.hasUnsavedFolderChange=!1,this.editable||(B.canEdit=!1,B.canDelete=!1,B.canSave=!1),this.meta=B}getSaveModelCloneOld(B){const V=(0,t.defaults)(B||{},{saveVariables:!0,saveTimerange:!0});let K={};for(const H in this)U.nonPersistedProperties[H]||!this.hasOwnProperty(H)||(K[H]=(0,t.cloneDeep)(this[H]));return K.templating=this.getTemplatingSaveModel(V),V.saveTimerange||(K.time=this.originalTime),K.panels=this.getPanelSaveModels(),K=(0,g.v)(K),K.getVariables=()=>K.templating.list,K}getSaveModelClone(B){const V=this.getSaveModelCloneOld(B),K=JSON.stringify(V);return JSON.parse(K)}updatePanels(B){const V=S(this.panels,B??[]);return V.changed&&(this.panels=V.panels??[],this.sortPanelsByGridPos(),this.events.publish(new v.Q$)),V}getPanelSaveModels(){return this.panels.filter(B=>this.isSnapshotTruthy()||!(B.repeatPanelId||B.repeatedByRow)).map(B=>{if(B.libraryPanel){const{id:V,title:K,libraryPanel:H,gridPos:X}=B;return{id:V,title:K,gridPos:X,libraryPanel:{uid:H.uid,name:H.name}}}return this.panelInEdit&&this.panelInEdit.id===B.id?this.panelInEdit.getSaveModel():B.getSaveModel()}).map(B=>(this.isSnapshotTruthy()||(delete B.scopedVars,B.type==="row"&&B.panels&&B.panels.length>0&&(B.panels=B.panels.filter(V=>!V.repeatPanelId).map(V=>(delete V.scopedVars,V)))),B))}getTemplatingSaveModel(B){const V=this.originalTemplating?.list??[],H=this.getVariablesFromState(this.uid).map(k=>{const Y=p.B.get(k.type).getSaveModel(k,B.saveVariables);if(!B.saveVariables){const Z=V.find(({name:se,type:j})=>se===k.name&&j===k.type);if(!Z)return Y;k.type==="adhoc"?Y.filters=Z.filters:(Y.current=Z.current,Y.options=Z.options)}return Y});return{list:(0,g.v)(H)}}timeRangeUpdated(B){this.events.publish(new f.sR(B)),(0,D.JD)((0,m.RK)(this.uid,B)),(this.panelInEdit||this.panelInView)&&(this.timeRangeUpdatedDuringEditOrView=!0)}startRefresh(B={refreshAll:!0,panelIds:[]}){if(this.events.publish(new f._),this.lastRefresh=Date.now(),this.panelInEdit&&(B.refreshAll||B.panelIds.includes(this.panelInEdit.id))){this.panelInEdit.refresh();return}const V=this.panels.filter(K=>!this.otherPanelInFullscreen(K)&&(B.refreshAll||B.panelIds.includes(K.id)));if(!this.isSnapshot())for(const K of V)K.refreshWhenInView=!0;for(const K of V)K.refresh()}render(){this.events.publish(new v.XM);for(const B of this.panels)B.render()}panelInitialized(B){const V=B.getQueryRunner().getLastResult();!this.otherPanelInFullscreen(B)&&!V&&B.refresh()}otherPanelInFullscreen(B){return(this.panelInEdit||this.panelInView)&&!(B.isViewing||B.isEditing)}initEditPanel(B){return(0,E.jG)().stopAutoRefresh(),this.panelInEdit=B.getEditClone(),this.timeRangeUpdatedDuringEditOrView=!1,this.panelInEdit}exitPanelEditor(){this.panelInEdit.destroy(),this.panelInEdit=void 0,(0,E.jG)().resumeAutoRefresh(),this.refreshIfPanelsAffectedByVariableChangeOrTimeRangeChanged()}initViewPanel(B){this.panelInView=B,this.timeRangeUpdatedDuringEditOrView=!1,B.setIsViewing(!0)}exitViewPanel(B){this.panelInView=void 0,B.setIsViewing(!1),this.refreshIfPanelsAffectedByVariableChangeOrTimeRangeChanged()}refreshIfPanelsAffectedByVariableChangeOrTimeRangeChanged(){(this.panelsAffectedByVariableChange||this.timeRangeUpdatedDuringEditOrView)&&(this.startRefresh({panelIds:this.panelsAffectedByVariableChange??[],refreshAll:this.timeRangeUpdatedDuringEditOrView}),this.panelsAffectedByVariableChange=null,this.timeRangeUpdatedDuringEditOrView=!1)}ensurePanelsHaveUniqueIds(){const B=new Set;let V=this.getNextPanelId();for(const K of this.panelIterator())(!K.id||B.has(K.id))&&(K.id=V++),B.add(K.id)}ensureListExist(B={}){return B.list??=[],B}getNextPanelId(){let B=0;for(const V of this.panelIterator())V.id>B&&(B=V.id);return B+1}*panelIterator(){for(const B of this.panels){yield B;const V=B.panels??[];for(const K of V)yield K}}forEachPanel(B){for(let V=0;V<this.panels.length;V++)B(this.panels[V],V)}getPanelById(B,V=!1){if(this.panelInEdit&&this.panelInEdit.id===B)return this.panelInEdit;if(V){for(const K of this.panelIterator())if(K.id===B)return K;return null}else return this.panels.find(K=>K.id===B)??null}canEditPanel(B){return!!(this.meta.canEdit&&B&&!B.repeatPanelId&&B.type!=="row")}canEditPanelById(B){return this.canEditPanel(this.getPanelById(B))}addPanel(B){B.id=this.getNextPanelId(),this.panels.unshift(new R.a9(B)),this.sortPanelsByGridPos(),this.events.publish(new v.Q$)}updateMeta(B){this.meta={...this.meta,...B},this.events.publish(new v.Cf)}makeEditable(){this.editable=!0,this.updateMeta({canMakeEditable:!1,canEdit:!0,canSave:!0})}sortPanelsByGridPos(){this.panels.sort((B,V)=>B.gridPos.y===V.gridPos.y?B.gridPos.x-V.gridPos.x:B.gridPos.y-V.gridPos.y)}clearUnsavedChanges(B,V){for(const K of this.panels)K.configRev=0;this.panelInEdit&&(this.panelInEdit.hasSavedPanelEditChange=this.panelInEdit.configRev>0,this.panelInEdit.configRev=0),this.originalDashboard=B,this.originalTemplating=B.templating,V.saveTimerange&&(this.originalTime=B.time)}hasUnsavedChanges(){return!!this.panels.find(V=>V.hasChanged)}cleanUpRepeats(){if(this.isSnapshotTruthy()||!this.hasVariables())return;L(this.panels);const B=this.panels.filter(V=>(!V.repeat||V.repeatedByRow)&&V.repeatPanelId);(0,t.pull)(this.panels,...B),B.map(V=>V.destroy()),this.sortPanelsByGridPos()}processRepeats(){if(!(this.isSnapshotTruthy()||!this.hasVariables()||this.panelInView)){this.cleanUpRepeats();for(let B=0;B<this.panels.length;B++){const V=this.panels[B];V.repeat&&this.repeatPanel(V,B)}this.sortPanelsByGridPos(),this.events.publish(new v.Q$)}}cleanUpRowRepeats(B){const V=B.map(H=>H.id),K=B.filter(H=>!H.repeat&&H.repeatPanelId&&V.includes(H.repeatPanelId));(0,t.pull)(B,...K),(0,t.pull)(this.panels,...K)}processRowRepeats(B){if(this.isSnapshotTruthy()||!this.hasVariables())return;let V=B.panels??[];if(!B.collapsed){const K=this.panels.findIndex(H=>H.id===B.id);V=this.getRowPanels(K)}this.cleanUpRowRepeats(V);for(const K of V)if(K.repeat){const H=this.panels.findIndex(X=>X.id===K.id);this.repeatPanel(K,H)}}getPanelRepeatClone(B,V,K){if(V===0)return B;const H=B.getSaveModel();H.id=this.getNextPanelId();const X=new R.a9(H);return this.panels.splice(K+V,0,X),X.repeatPanelId=B.id,X.repeat=void 0,this.panelInView?.id===X.id&&(X.setIsViewing(!0),this.panelInView=X),X}getRowRepeatClone(B,V,K){if(V===0){if(!B.collapsed){const Y=this.getRowPanels(K);B.panels=Y}return B}const H=new R.a9(B.getSaveModel());let X,k;return B.collapsed?(X=(0,t.cloneDeep)(B.panels)??[],H.panels=X,k=K+V):(X=this.getRowPanels(K),H.panels=X.map(Y=>Y.getSaveModel()),k=K+(X.length+1)*V),this.panels.splice(k,0,H),this.updateRepeatedPanelIds(H),H}repeatPanel(B,V){const K=this.getPanelRepeatVariable(B);if(!K)return;if(B.type==="row"){this.repeatRow(B,V,K);return}const H=this.getSelectedVariableOptions(K),X=B.maxPerRow||4;let k=0,Y=B.gridPos.y;for(let se=0;se<H.length;se++){const j=H[se];let q;q=this.getPanelRepeatClone(B,se,V),q.scopedVars??={},q.scopedVars[K.name]=j,B.repeatDirection===o.Pz?(se>0&&(Y+=q.gridPos.h),q.gridPos.y=Y):(q.gridPos.w=Math.max(o.cV/H.length,o.cV/X),q.gridPos.x=k,q.gridPos.y=Y,k+=q.gridPos.w,k+q.gridPos.w>o.cV&&(k=0,Y+=q.gridPos.h))}const Z=Y-B.gridPos.y;if(Z>0){const se=V+H.length;for(const j of this.panels.slice(se))A(B,j)||(j.gridPos.y+=Z)}}repeatRow(B,V,K){const H=this.getSelectedVariableOptions(K);for(let X=0;X<H.length;X++){const k=H[X],Y=this.getRowRepeatClone(B,X,V);w(Y,K,k);const Z=this.getRowHeight(Y),se=Y.panels||[];let j;if(B.collapsed){for(const q of se)w(q,K,k),X>0&&this.updateRepeatedPanelIds(q,!0);Y.gridPos.y+=X,j=V+X+1}else{const q=V+(se.length+1)*X+1;se.forEach((ne,oe)=>{if(w(ne,K,k),X>0){const z=new R.a9(ne);this.updateRepeatedPanelIds(z,!0),z.gridPos.y+=Z*X,this.panels.splice(q+oe,0,z)}}),Y.panels=[],Y.gridPos.y+=Z*X,j=q+se.length}if(H.length>1)for(const q of this.panels.slice(j))q.gridPos.y+=Z}}updateRepeatedPanelIds(B,V){return B.repeatPanelId=B.id,B.id=this.getNextPanelId(),V?B.repeatedByRow=!0:B.repeat=void 0,B}getSelectedVariableOptions(B){let V;return(0,x.ML)(B)?V=B.options.slice(1,B.options.length):V=(0,t.filter)(B.options,{selected:!0}),V}getRowHeight(B){if(!B.panels||B.panels.length===0)return 0;if(B.collapsed)return 1;const V=(0,t.maxBy)(B.panels,({gridPos:K})=>K.y+K.h).gridPos;return V.y+V.h-B.gridPos.y}removePanel(B){this.panels=this.panels.filter(V=>V!==B),B.destroy(),this.events.publish(new v.Q$)}removeRow(B,V){(!V&&B.collapsed||V&&!B.collapsed)&&this.toggleRow(B),this.removePanel(B)}expandRows(){const B=this.panels.filter(V=>V.type==="row"&&V.collapsed);for(const V of B)this.toggleRow(V)}collapseRows(){const B=this.panels.filter(V=>V.type==="row"&&!V.collapsed);for(const V of B)this.toggleRow(V)}isSubMenuVisible(){return this.links.length>0||this.getVariables().some(B=>B.hide!==2)||this.annotations.list.some(B=>!B.hide)}getPanelInfoById(B){const V=this.panels.findIndex(K=>K.id===B);return V>=0?{panel:this.panels[V],index:V}:null}duplicatePanel(B){const V=B.getSaveModel();return V.id=this.getNextPanelId(),delete V.repeat,delete V.repeatIteration,delete V.repeatPanelId,delete V.scopedVars,V.alert&&delete V.thresholds,delete V.alert,B.gridPos.x+B.gridPos.w*2<=o.cV?V.gridPos.x+=B.gridPos.w:V.gridPos.y+=B.gridPos.h,this.addPanel(V),V}formatDate(B,V){return(0,s.LE)(B,{format:V,timeZone:this.getTimezone()})}destroy(){this.appEventsSubscription.unsubscribe(),this.events.removeAllListeners();for(const B of this.panels)B.destroy()}toggleRow(B){const V=(0,t.indexOf)(this.panels,B);if(!B.collapsed){const k=this.getRowPanels(V);(0,t.pull)(this.panels,...k),B.panels=k.map(Y=>Y.getSaveModel()),B.collapsed=!0,k.some(Y=>Y.hasChanged)&&B.configRev++,this.events.publish(new v.Q$);return}B.collapsed=!1;const K=B.panels??[],H=K.some(k=>k.repeat),X=B.repeat;if(K.length>0){const Y=(K[0].gridPos.y??B.gridPos.y)-(B.gridPos.y+B.gridPos.h);let Z=V+1,se=B.gridPos.y;for(const q of K){if(X){const ne=this.getPanelRepeatVariable(B);if(q.scopedVars??={},ne){const oe=this.getSelectedVariableOptions(ne);q.scopedVars={...q.scopedVars,[ne.name]:oe[0]}}}q.gridPos.y??(q.gridPos.y=B.gridPos.y),q.gridPos.y-=Y,this.panels.splice(Z,0,new R.a9(q)),Z+=1,se=Math.max(se,q.gridPos.y+q.gridPos.h)}const j=se-B.gridPos.y-1;for(const q of this.panels.slice(Z))q.gridPos.y+=j;B.panels=[],H&&this.processRowRepeats(B)}this.sortPanelsByGridPos(),this.events.publish(new v.Q$)}getRowPanels(B){const V=this.panels.slice(B+1),K=V.findIndex(X=>X.type==="row");return V.slice(0,K>=0?K:this.panels.length)}on(B,V){console.log("DashboardModel.on is deprecated use events.subscribe"),this.events.on(B,V)}off(B,V){console.log("DashboardModel.off is deprecated"),this.events.off(B,V)}cycleGraphTooltip(){this.graphTooltip=(this.graphTooltip+1)%3}sharedTooltipModeEnabled(){return this.graphTooltip>0}sharedCrosshairModeOnly(){return this.graphTooltip===1}getRelativeTime(B){return(0,s.fq)(B,{timeZone:this.getTimezone()})}isSnapshot(){return this.snapshot!==void 0}getTimezone(){return this.timezone?this.timezone:h.TP?.user?.timezone}updateSchema(B){new b.SW(this).updateSchema(B)}hasTimeChanged(){const{time:B,originalTime:V}=this;return!((0,t.isEqual)(B,V)||(0,t.isEqual)((0,r.KQ)(B?.from),(0,r.KQ)(V?.from))&&(0,t.isEqual)((0,r.KQ)(B?.to),(0,r.KQ)(V?.to)))}autoFitPanels(B,V){const K=Math.max(...this.panels.map(se=>se.gridPos.h+se.gridPos.y)),H=55;let k=B-H-20;V&&V!==d.KioskMode.TV&&(k+=H);const Y=Math.floor(k/(o.sD+o.dU)),Z=K/Y;for(const se of this.panels)se.gridPos.y=Math.round(se.gridPos.y/Z)||1,se.gridPos.h=Math.round(se.gridPos.h/Z)||1}templateVariableValueUpdated(){this.processRepeats(),this.events.emit(d.CoreEvents.bG)}getPanelByUrlId(B){const V=parseInt(B??"0",10),K=this.panels.filter(H=>H.collapsed);for(const H of K)H.panels?.some(k=>k.id===V)&&this.toggleRow(H);return this.getPanelById(V)}toggleLegendsForAll(){const B=this.panels.filter(W),V=B.filter(X=>X.legend.show).length,K=B.length-V,H=V>=K;for(const X of B)X.legend.show=!H,X.render()}toggleExemplarsForAll(){for(const B of this.panels)for(const V of B.targets){if(!(V.datasource&&V.datasource.type==="prometheus"))continue;const K=V;K.exemplar=!K.exemplar}this.startRefresh()}getVariables(){return this.getVariablesFromState(this.uid)}canEditAnnotations(B){let V=!0;return B?V=!!this.meta.annotationsPermissions?.dashboard.canEdit:V=!!this.meta.annotationsPermissions?.organization.canEdit,(a.$.featureToggles.annotationPermissionUpdate||this.canEditDashboard())&&V}canDeleteAnnotations(B){let V=!0;return B?V=!!this.meta.annotationsPermissions?.dashboard.canDelete:V=!!this.meta.annotationsPermissions?.organization.canDelete,a.$.featureToggles.annotationPermissionUpdate?V:V&&this.canEditDashboard()}canAddAnnotations(){return this.annotations.list.find(V=>V.builtIn===1)?.enable===!1?!1:a.$.featureToggles.annotationPermissionUpdate?!!this.meta.annotationsPermissions?.dashboard.canAdd:!!this.meta.annotationsPermissions?.dashboard.canAdd&&this.canEditDashboard()}canEditDashboard(){return!!(this.meta.canEdit||this.meta.canMakeEditable)}shouldUpdateDashboardPanelFromJSON(B,V){!(0,t.isEqual)(B?.gridPos,V?.gridPos)&&this.events.publish(new v.Q$)}getDefaultTime(){return this.originalTime}getPanelRepeatVariable(B){return this.getVariablesFromState(this.uid).find(V=>V.name===B.repeat)}isSnapshotTruthy(){return this.snapshot}hasVariables(){return this.getVariablesFromState(this.uid).length>0}hasVariablesChanged(){const B=this.originalTemplating?.list??[],V=this.getTemplatingSaveModel({saveVariables:!0}).list;return B.length!==V.length?!1:!(0,t.isEqual)(V,B)}variablesTimeRangeProcessDoneHandler(B){const V=B.payload.variableIds.length>0;this.variablesChangedHandler(new P.og({panelIds:[],refreshAll:!0}),V)}variablesChangedHandler(B,V=!0){if(V&&this.processRepeats(),B.payload.refreshAll||(0,E.jG)().isRefreshOutsideThreshold(this.lastRefresh)){this.startRefresh({refreshAll:!0,panelIds:[]});return}(this.panelInEdit||this.panelInView)&&(this.panelsAffectedByVariableChange=B.payload.panelIds.filter(K=>K!==(this.panelInEdit?.id??this.panelInView?.id))),this.startRefresh(B.payload)}variablesChangedInUrlHandler(B){this.templateVariableValueUpdated(),this.startRefresh(B.payload)}getOriginalDashboard(){return this.originalDashboard}hasAngularPlugins(){return this.panels.some(B=>{const V=(a.$.panels[B.type]?.angular?.detected||R.vI.includes(B.type))&&!a.$.panels[B.type]?.angular?.hideDeprecation;let K=!1;return B.datasource?.uid&&(K=(0,l.Hv)(B.datasource?.uid)),V||K})}}function W(N){return!!N.legend}function w(N,B,V){N.scopedVars??={},N.scopedVars[B.name]=V}},84423:(G,O,e)=>{"use strict";e.d(O,{NB:()=>D,a9:()=>x,tD:()=>P,tw:()=>C,vI:()=>u});var t=e(2543),n=e.n(t),i=e(62938),s=e(18226),r=e(77789),f=e(41987),a=e(581),c=e(3591),o=e(72574),h=e(2913),g=e(87490),l=e(28444),p=e(80924),m=e(96382);const y={events:!0,isViewing:!0,isEditing:!0,isInView:!0,hasRefreshed:!0,cachedPluginOptions:!0,plugin:!0,queryRunner:!0,replaceVariables:!0,configRev:!0,hasSavedPanelEditChange:!0,getDisplayTitle:!0,dataSupport:!0,key:!0,isNew:!0,refreshWhenInView:!0},d={id:!0,gridPos:!0,type:!0,title:!0,scopedVars:!0,repeat:!0,repeatPanelId:!0,repeatDirection:!0,repeatedByRow:!0,minSpan:!0,collapsed:!0,panels:!0,targets:!0,datasource:!0,timeFrom:!0,timeShift:!0,hideTimeOverride:!0,description:!0,links:!0,fullscreen:!0,isEditing:!0,isViewing:!0,hasRefreshed:!0,events:!0,cacheTimeout:!0,queryCachingTTL:!0,cachedPluginOptions:!0,transparent:!0,pluginVersion:!0,queryRunner:!0,transformations:!0,fieldConfig:!0,maxDataPoints:!0,interval:!0,replaceVariables:!0,libraryPanel:!0,getDisplayTitle:!0,configRev:!0,key:!0},v={gridPos:{x:0,y:0,h:3,w:6},targets:[{refId:"A"}],cachedPluginOptions:{},transparent:!1,options:{},links:[],transformations:[],fieldConfig:{defaults:{},overrides:[]},title:""},u=["graph","table-old","grafana-piechart-panel","grafana-worldmap-panel","singlestat","grafana-singlestat-panel"],D={graph:"timeseries","table-old":"table",singlestat:"stat","grafana-singlestat-panel":"stat","grafana-piechart-panel":"piechart","grafana-worldmap-panel":"geomap"},P={"heatmap-new":"heatmap"};class x{constructor(S){this.datasource=null,this.isViewing=!1,this.isEditing=!1,this.isInView=!1,this.configRev=0,this.refreshWhenInView=!0,this.cachedPluginOptions={},this.events=new s.o,this.restoreModel(S),this.replaceVariables=this.replaceVariables.bind(this),this.key=(0,i.A)()}restoreModel(S){for(const T in this)y[T]||!this.hasOwnProperty(T)||S[T]||typeof this[T]!="function"&&typeof this[T]!="symbol"&&delete this[T];for(const T in S)this[T]=S[T];const I=(0,m.p)(this);I&&(this.autoMigrateFrom=this.type,this.type=I),(0,t.defaultsDeep)(this,(0,t.cloneDeep)(v)),this.ensureQueryIds()}generateNewKey(){this.key=(0,i.A)()}ensureQueryIds(){if(this.targets&&(0,t.isArray)(this.targets))for(const S of this.targets)S.refId||(S.refId=(0,r.M)(this.targets))}getOptions(){return this.options}get hasChanged(){return this.configRev>0}updateOptions(S){this.options=S,this.configRev++,this.events.publish(new l.PR),this.render()}updateFieldConfig(S){this.fieldConfig=S,this.configRev++,this.events.publish(new l.PR),this.resendLastResult(),this.render()}getSaveModel(){const S={};for(const I in this)y[I]||!this.hasOwnProperty(I)||(0,t.isEqual)(this[I],v[I])||(S[I]=(0,t.cloneDeep)(this[I]));return this.type==="row"&&this.panels&&this.panels.length>0&&(S.panels=this.panels.map(I=>{if(I.libraryPanel){const{id:T,title:b,libraryPanel:R,gridPos:A}=I;return{id:T,title:b,gridPos:A,libraryPanel:{uid:R.uid,name:R.name}}}return I})),S}setIsViewing(S){this.isViewing=S}updateGridPos(S,I=!0){S.x===this.gridPos.x&&S.y===this.gridPos.y&&S.h===this.gridPos.h&&S.w===this.gridPos.w||(this.gridPos.x=S.x,this.gridPos.y=S.y,this.gridPos.w=S.w,this.gridPos.h=S.h,I&&this.configRev++,this.render())}runAllPanelQueries({dashboardUID:S,dashboardTimezone:I,timeData:T,width:b}){this.getQueryRunner().run({datasource:this.datasource,queries:this.targets,panelId:this.id,panelPluginId:this.type,dashboardUID:S,timezone:I,timeRange:T.timeRange,timeInfo:T.timeInfo,maxDataPoints:this.maxDataPoints||Math.floor(b),minInterval:this.interval,scopedVars:this.scopedVars,cacheTimeout:this.cacheTimeout,queryCachingTTL:this.queryCachingTTL,transformations:this.transformations,app:this.isEditing?f.Jk.PanelEditor:this.isViewing?f.Jk.PanelViewer:f.Jk.Dashboard})}refresh(){this.hasRefreshed=!0,this.events.publish(new c._)}render(){this.hasRefreshed?this.events.publish(new l.XM):this.refresh()}getOptionsToRemember(){return Object.keys(this).reduce((S,I)=>y[I]||d[I]?S:{...S,[I]:this[I]},{})}restorePanelOptions(S){const I=this.cachedPluginOptions[S];I&&(Object.keys(I.properties).map(T=>{this[T]=I.properties[T]}),this.fieldConfig=(0,a.H9)(this.fieldConfig,I.fieldConfig))}applyPluginOptionDefaults(S,I){const T=(0,a.F)({plugin:S,currentOptions:this.options,currentFieldConfig:this.fieldConfig,isAfterPluginChange:I});this.fieldConfig=T.fieldConfig,this.options=T.options}async pluginLoaded(S){this.plugin=S;const I=E(S);if(this.autoMigrateFrom){const T=D[this.autoMigrateFrom]!=null,b=this.getOptionsToRemember(),R=this.autoMigrateFrom,A=this.type;this.clearPropertiesBeforePluginChange(),this.type=A,this.plugin=S,this.callPanelTypeChangeHandler(S,R,b,T)}if(S.onPanelMigration&&I!==this.pluginVersion){const T=S.onPanelMigration(this);this.options=await T,this.pluginVersion=I}this.applyPluginOptionDefaults(S,!1),this.resendLastResult()}clearPropertiesBeforePluginChange(){for(const S in this)d[S]||delete this[S];this.options={},this.fieldConfig={defaults:{...this.fieldConfig.defaults,custom:{}},overrides:(0,a.aW)(this.fieldConfig.overrides,a.nx)}}callPanelTypeChangeHandler(S,I,T,b){if(S.onPanelTypeChanged){const R=b?{angular:T}:T.options;Object.assign(this.options,S.onPanelTypeChanged(this,I,R,this.fieldConfig))}}changePlugin(S){const I=S.meta.id,T=this.getOptionsToRemember(),b=this.fieldConfig,R=this.type,A=this.isAngularPlugin()||!!D[R];this.cachedPluginOptions[R]={properties:T,fieldConfig:b},this.clearPropertiesBeforePluginChange(),this.restorePanelOptions(I),this.callPanelTypeChangeHandler(S,R,T,A),this.type=I,this.plugin=S,this.configRev++,this.applyPluginOptionDefaults(S,!0),S.onPanelMigration&&(this.pluginVersion=E(S))}updateQueries(S){const{dataSource:I}=S;this.datasource=I,this.cacheTimeout=S.cacheTimeout,this.queryCachingTTL=S.queryCachingTTL,this.timeFrom=S.timeRange?.from,this.timeShift=S.timeRange?.shift,this.hideTimeOverride=S.timeRange?.hide,this.interval=S.minInterval,this.maxDataPoints=S.maxDataPoints,this.targets=S.queries,this.configRev++,this.events.publish(new l.zq)}addQuery(S){S=S||{refId:"A"},S.refId=(0,r.M)(this.targets),this.targets.push(S),this.configRev++}changeQuery(S,I){S.refId=this.targets[I].refId,this.configRev++,this.targets=this.targets.map((T,b)=>b===I?S:T)}getEditClone(){const S=this.getSaveModel(),I=new x(S);I.isEditing=!0,I.plugin=this.plugin;const T=this.getQueryRunner();return I.getQueryRunner().useLastResultFrom(T),I}getTransformations(){return this.transformations}getFieldOverrideOptions(){if(this.plugin)return{fieldConfig:this.fieldConfig,replaceVariables:this.replaceVariables,fieldConfigRegistry:this.plugin.fieldConfigRegistry,theme:h.Ay.theme2}}getDataSupport(){return this.plugin?.dataSupport??{annotations:!1,alertStates:!1}}getQueryRunner(){return this.queryRunner||(this.queryRunner=new p.Z(this)),this.queryRunner}hasTitle(){return this.title&&this.title.length>0}isAngularPlugin(){return(this.plugin&&this.plugin.angularPanelCtrl)!==void 0||(this.plugin?.meta?.angular?.detected??!1)}destroy(){this.events.removeAllListeners(),this.queryRunner&&this.queryRunner.destroy()}setTransformations(S){this.transformations=S,this.resendLastResult(),this.configRev++,this.events.publish(new l.JI)}setProperty(S,I){this[S]=I,this.configRev++,S==="repeat"&&(this.repeat&&!this.repeatDirection?this.repeatDirection="h":this.repeat||(delete this.repeatDirection,delete this.maxPerRow))}replaceVariables(S,I,T){const b=this.getQueryRunner().getLastRequest(),R=Object.assign({},this.scopedVars,b?.scopedVars,I);return(0,o.w)().replace(S,R,T)}resendLastResult(){this.plugin&&this.getQueryRunner().resendLastResult()}getDisplayTitle(){return this.replaceVariables(this.title,void 0,"text")}initLibraryPanel(S){for(const[I,T]of Object.entries(S.model)){switch(I){case"id":case"gridPos":case"libraryPanel":continue}this[I]=T}this.libraryPanel=S}unlinkLibraryPanel(){delete this.libraryPanel,this.configRev++,this.render()}}function E(M){return M&&M.meta.info.version?M.meta.info.version:h.Ay.buildInfo.version}function C(M){const S={};return Object.entries(M).filter(([I,T])=>!y[I]&&M.hasOwnProperty(I)&&!(0,t.isEqual)(T,v[I])).forEach(([I,T])=>{S[I]=T}),(0,g.MA)(S)}},3673:(G,O,e)=>{"use strict";e.d(O,{Bz:()=>y,Q9:()=>p,Ss:()=>v,TA:()=>m,lC:()=>d});var t=e(17172),n=e(82467),i=e(3169),s=e(28676),r=e(6473),f=e(80095),a=e(81862),c=e(20701),o=e(72401),h=e(14792),g=e(74856),l=e(28601);function p(u,D){return async P=>{await(0,t.AI)().post("/api/dashboards/import",u),P((0,n.dx)((0,i.tZ)("Dashboard Imported",D))),P((0,c.h9)())}}function m(u){return async D=>{await(0,s.n)().deleteDashboard(u,!1),D((0,c.h9)())}}const y=()=>(u,D)=>{const x=D().dashboard.getModel();x&&(x.destroy(),u((0,o.Y7)(x.uid))),(0,g.jG)().stopAutoRefresh(),u((0,l.p0)()),u((0,f.rG)()),r.t.leave(),(0,h.UA)().setCurrent(void 0)},d=u=>D=>{D((0,a.Cj)(u)),(0,g.jG)().refreshTimeModel()},v=u=>D=>{D((0,a.xu)(u)),(0,g.jG)().refreshTimeModel()}},41176:(G,O,e)=>{"use strict";e.d(O,{B:()=>i});var t=e(61298),n=e(14110);function i(s){const r={dashboardId:s.id,dashboardName:s.title,dashboardUid:s.uid,folderName:s.meta.folderTitle,eventName:t.n_.DashboardView};(0,n.G$)(r)}},96382:(G,O,e)=>{"use strict";e.d(O,{p:()=>i});var t=e(2913),n=e(84423);function i(s,r){if(n.tD[s.type])return n.tD[s.type];const f=c=>{const o="__feature."+c,g=new URLSearchParams(window.location.search).get(o);return g==="true"||g===""},a=r||!t.Ay.angularSupportEnabled||t.Ay.featureToggles.autoMigrateOldPanels||f("autoMigrateOldPanels")||f("disableAngular");if(s.type==="graph"&&(a||t.Ay.featureToggles.autoMigrateGraphPanel||f("autoMigrateGraphPanel")))return s.xaxis?.mode==="series"?"barchart":s.xaxis?.mode==="histogram"?"histogram":"timeseries";if(a)return n.NB[s.type];if(s.type==="table-old"&&(t.Ay.featureToggles.autoMigrateTablePanel||f("autoMigrateTablePanel")))return"table";if(s.type==="grafana-piechart-panel"&&(t.Ay.featureToggles.autoMigratePiechartPanel||f("autoMigratePiechartPanel")))return"piechart";if(s.type==="grafana-worldmap-panel"&&(t.Ay.featureToggles.autoMigrateWorldmapPanel||f("autoMigrateWorldmapPanel")))return"geomap";if((s.type==="singlestat"||s.type==="grafana-singlestat-panel")&&t.Ay.featureToggles.autoMigrateStatPanel||f("autoMigrateStatPanel"))return"stat"}},34214:(G,O,e)=>{"use strict";e.d(O,{G:()=>t.G,a:()=>n.a9});var t=e(98365),n=e(84423)},20470:(G,O,e)=>{"use strict";e.d(O,{us:()=>B,vR:()=>N,yZ:()=>K,OI:()=>V});var t=e(71733),n=e(47232),i=e(69129),s=e(12131),r=e(17172),f=e(32264),a=e(82467),c=e(28138),o=e(3169),h=e(27677),g=e(33390),l=e(78160),p=e(17493),m=e(14792),y=e(74856),d=e(72255),v=e(71176),u=e(71101),D=e(54650);function P(H){return async X=>{const k=await h.IB.getFolderByUid(H);return X((0,D.jl)(k)),X((0,a.Vz)((0,u.R4)(k))),k}}var x=e(6473),E=e(2609),C=e(75096),M=e(31678),S=e(42972),I=e(72401),T=e(87421),b=e(16833),R=e(98365),A=e(41176),L=e(28601);const U="initDashboard";async function W(H,X,k){const Y=g.A.getObject(B);if(Y)return K(),Y;try{switch(H.routeName){case M.DashboardRoutes.Home:{const se=(0,d.sP)().getDashboardFromCache(d.m6);if(se)return se;const j=await h.IB.get("/api/dashboards/home");if(j.redirectUri){const q=t.I.stripBaseFromUrl(j.redirectUri);return s.Ny.replace(q),null}return j.meta.canSave=!1,j.meta.canShare=!1,j.meta.canStar=!1,j}case M.DashboardRoutes.Public:return await p.np.loadDashboard("public",H.urlSlug,H.accessToken);case M.DashboardRoutes.Normal:{const Z=await p.np.loadDashboard(H.urlType,H.urlSlug,H.urlUid);if(Z.meta.folderUid)try{await X(P(Z.meta.folderUid))}catch(se){console.warn("Error fetching parent folder",Z.meta.folderUid,"for dashboard",se)}if(H.fixUrl&&Z.meta.url&&!E._o.state.isPlaying){const se=t.I.stripBaseFromUrl(Z.meta.url),j=s.Ny.getLocation().pathname;se!==j&&(s.Ny.replace({...s.Ny.getLocation(),pathname:se}),console.log("not correct url correcting",se,j))}return Z}case M.DashboardRoutes.New:return H.urlFolderUid&&await X(P(H.urlFolderUid)),await(0,v.X)(H.urlFolderUid);case M.DashboardRoutes.Path:{const Z=H.urlSlug??"";return await p.np.loadDashboard(M.DashboardRoutes.Path,Z,Z)}default:throw{message:"Unknown route "+H.routeName}}}catch(Z){return(0,r.NF)(Z)&&Z.cancelled||(X((0,L.ig)({message:"Failed to fetch dashboard",error:Z})),console.error(Z)),null}}const w=(H,X={})=>(H.forEach(k=>{k.panels?w(k.panels,X):k.targets&&k.targets.forEach(Y=>{Y.datasource?.type&&(X[Y.datasource.type]?X[Y.datasource.type].push(Y):X[Y.datasource.type]=[Y])})}),X);function N(H){return async(X,k)=>{(0,l.j)(U),X((0,L.xS)());const Y=await W(H,X,k),Z=Y?.dashboard?.version;if(!Y)return;X((0,L.X1)());let se;try{se=new R.G(Y.dashboard,Y.meta)}catch(ie){X((0,L.ig)({message:"Failed create dashboard model",error:ie})),console.error(ie);return}const j=k(),q=s.Ny.getSearchObject();q.orgId||s.Ny.partial({orgId:j.user.orgId},!0);const ne=(0,y.jG)();(0,m.UA)().setCurrent(se),ne.init(se);const z=(0,C.q4)(H.urlUid??se.uid);if(await X((0,I._q)(z,se)),(0,S.nm)({dashboard:se,timeSrv:ne}).run({dashboard:se,range:ne.timeRange()}),(0,T.Tk)(k())!==z||k().dashboard.initPhase!==M.DashboardInitPhase.Services)return;try{se.processRepeats(),q.autofitpanels&&se.autoFitPanels(window.innerHeight,q.kiosk),f.$.publicDashboardAccessToken||H.keybindingSrv.setupDashboardBindings(se)}catch(ie){ie instanceof Error&&X((0,a.dx)((0,o.gi)("Dashboard init failed",ie))),console.error(ie)}H.routeName!==M.DashboardRoutes.New?((0,A.B)(se),x.t.watch(se.uid)):x.t.leave(),se.weekStart!==""?(0,n.$D)(se.weekStart):(0,n.$D)(f.$.bootData.user.weekStart),c.A.publish(new i.gc({dashboardId:se.uid,orgId:j.user.orgId,userId:j.user.user?.id,grafanaVersion:f.$.buildInfo.version,queries:w(se.panels)}));const le=(0,l.z)(U);(0,b.d)(se,le?.duration,Z),X((0,L.O9)(se))}}const B="DASHBOARD_FROM_LS_KEY";function V(H){g.A.setObject(B,H)}function K(){g.A.delete(B)}},28601:(G,O,e)=>{"use strict";e.d(O,{Ay:()=>y,O9:()=>o,Ub:()=>p,X1:()=>h,ig:()=>c,p0:()=>g,xS:()=>a});var t=e(65307),n=e(79422),i=e(31678),s=e(98365);const r={initPhase:i.DashboardInitPhase.NotStarted,getModel:()=>null,initError:null,initialDatasource:void 0},f=(0,t.Z0)({name:"dashboard",initialState:r,reducers:{dashboardInitFetching:d=>{d.initPhase=i.DashboardInitPhase.Fetching},dashboardInitServices:d=>{d.initPhase=i.DashboardInitPhase.Services},dashboardInitCompleted:(d,v)=>{d.getModel=()=>v.payload,d.initPhase=i.DashboardInitPhase.Completed},dashboardInitFailed:(d,v)=>{d.initPhase=i.DashboardInitPhase.Failed,d.initError=v.payload,d.getModel=()=>new s.G({...n.Ye,title:"Dashboard init failed"},{canSave:!1,canEdit:!1})},cleanUpDashboard:d=>{d.initPhase=i.DashboardInitPhase.NotStarted,d.initError=null,d.getModel=()=>null},addPanel:(d,v)=>{},setInitialDatasource:(d,v)=>{d.initialDatasource=v.payload}}}),{dashboardInitFetching:a,dashboardInitFailed:c,dashboardInitCompleted:o,dashboardInitServices:h,cleanUpDashboard:g,addPanel:l,setInitialDatasource:p}=f.actions,y={dashboard:f.reducer}},36974:(G,O,e)=>{"use strict";e.d(O,{B1:()=>D,CW:()=>v,LH:()=>c,OK:()=>o,SD:()=>g,VF:()=>l,_u:()=>y,dH:()=>P,ko:()=>u,no:()=>m,ob:()=>h,s3:()=>p});var t=e(2543),n=e.n(t),i=e(12131),s=e(2913),r=e(15054),f=e(33390),a=e(19752);const c="Panel Title";function o(E,C){const M={type:"timeseries",title:c,gridPos:(0,a.Ft)(E),datasource:C?{uid:C}:null,isNew:!0};return E.addPanel(M),M.id}function h(E,C){const M={type:C,title:"Widget title",gridPos:(0,a.Ft)(E),datasource:null,isNew:!0};return E.addPanel(M),M.id}function g(E){const C={type:"row",title:"Row title",gridPos:{x:0,y:0}};E.addPanel(C)}function l(){i.Ny.push("/dashboard/import")}function p(E){const C={type:"add-library-panel",gridPos:(0,a.Ft)(E)};E.addPanel(C)}function m(E,C){if(!C)return;const M=(0,a.Ft)(E),S={type:C.id,title:c,gridPos:{x:M.x,y:M.y,w:C.defaults.gridPos.w,h:C.defaults.gridPos.h}};C.defaults&&((0,t.defaults)(S,C.defaults),S.title=C.defaults.title,f.A.delete(r.tH)),E.addPanel(S)}function y(){const E=(0,t.chain)(s.Ay.panels).filter({hideFromList:!1}).map(M=>M).value(),C=f.A.get(r.tH);if(C){const M=JSON.parse(C),S=(0,t.find)(E,{id:M.type});if(S){const I=(0,t.cloneDeep)(S);return I.name=M.title,I.sort=-1,{...I,defaults:{...M}}}}}const d="grafana.dashboards.panelEdit.lastUsedDatasource";function v(E){if(f.A.exists(d)){const C=f.A.getObject(d);if(C?.dashboardUid===E)return C}}function u(E){if(!f.A.exists(d))return;const M=f.A.getObject(d)?.datasourceUid??"";x(E,M)}function D(E){f.A.setObject(d,{dashboardUid:E,datasourceUid:""})}function P(E,C){const M=v(E);if(!M)x(E,C);else{const S=M?.dashboardUid??"";x(S,C)}}function x(E,C){f.A.setObject(d,{dashboardUid:E,datasourceUid:C})}},61642:(G,O,e)=>{"use strict";e.d(O,{X:()=>i});var t=e(32264),n=e(12131);function i(){if(!t.$.featureToggles.scopeFilters||!t.$.featureToggles.passScopeToDashboardApi)return;const r=n.Ny.getSearchObject().scopes??[],f=Array.isArray(r)?r:[r];return new URLSearchParams(f.map(a=>["scopes",String(a)]))}},19752:(G,O,e)=>{"use strict";e.d(O,{ET:()=>I,FC:()=>D,Ft:()=>A,KJ:()=>x,Mc:()=>E,ZY:()=>M,d7:()=>C,iU:()=>P,nk:()=>T});var t=e(2543),n=e.n(t),i=e(26272),s=e(65879),r=e(47232),f=e(85858),a=e(72574),c=e(28138),o=e(2913),h=e(15054),g=e(33390),l=e(1702),p=e(84423),m=e(54174),y=e(96227),d=e(79971),v=e(99140),u=e(28444);const D=(L,U,W)=>{if(W!==!1){const w=U.alert?"YES":void 0;c.A.publish(new u.bY({title:"Remove panel",text:"Are you sure you want to remove this panel?",icon:"trash-alt",confirmText:w,yesText:"Remove",onConfirm:()=>D(L,U,!1)}));return}L.removePanel(U),(0,v.JD)((0,d.O6)(U.key))},P=(L,U)=>{L.duplicatePanel(U)},x=L=>{let U=L;L instanceof p.a9&&(U=L.getSaveModel()),g.A.set(h.tH,JSON.stringify(U)),c.A.emit(i.r1.alertSuccess,["Panel copied. Click **Add panel** icon to paste."])},E=(L,U)=>{c.A.publish(new u.S8({component:l.ShareModal,props:{dashboard:L,panel:U}}))},C=(L,U)=>{c.A.publish(new u.S8({component:y.o,props:{panel:U,initialFolderUid:L.meta.folderUid,isOpen:!0}}))},M=L=>{c.A.publish(new u.S8({component:m.l,props:{onConfirm:()=>L.unlinkLibraryPanel(),isOpen:!0}}))},S=L=>{L.refresh()},I=L=>{const U={...L.options};U.legend.showLegend===!0?U.legend.showLegend=!1:U.legend.showLegend=!0,L.updateOptions(U)};function T(L,U){const W={timeInfo:"",timeRange:U};if(L.timeFrom){const w=(0,a.w)().replace(L.timeFrom,L.scopedVars),N=s.describeTextRange(w);if(N.invalid)return W.timeInfo="invalid time override",W;if((0,t.isString)(U.raw.from)){const B=(0,r.AN)(U.from).tz(),V=(0,r.AN)(U.to).tz(),K=f.parse(N.from,void 0,B);W.timeInfo=N.display,W.timeRange={from:K,to:f.parse(N.to,void 0,V),raw:{from:N.from,to:N.to}}}}if(L.timeShift){const w=(0,a.w)().replace(L.timeShift,L.scopedVars);if(s.describeTextRange(w).invalid)return W.timeInfo="invalid timeshift",W;const B="-"+w;W.timeInfo+=" timeshift "+B;const V=f.parseDateMath(B,W.timeRange.from,!1),K=f.parseDateMath(B,W.timeRange.to,!0);W.timeRange={from:V,to:K,raw:{from:V,to:K}}}return L.hideTimeOverride&&(W.timeInfo=""),W}function b(L){const W=document.getElementsByTagName("html")[0].getBoundingClientRect().width;return L.maxDataPoints?L.maxDataPoints:Math.ceil(W*(L.gridPos.w/24))}function R(L,U){const W=L.plugin&&L.plugin.noPadding?0:config.theme.panelPadding*2,w=L.hasTitle()?config.theme.panelHeaderHeight:0;return U-w-W-PANEL_BORDER}function A(L){for(const W of L.panelIterator())W.gridPos.y+=8;return{x:0,y:0,w:12,h:8}}},21380:(G,O,e)=>{"use strict";e.d(O,{z:()=>i});var t=e(47232),n=e(85858);const i=(s,r)=>{const f={from:(0,t.Ar)(s.from)?(0,t.KQ)(s.from):s.from,to:(0,t.Ar)(s.to)?(0,t.KQ)(s.to):s.to},a=r?r.getTimezone():void 0;return{from:n.parse(f.from,!1,a,r?.fiscalYearStartMonth),to:n.parse(f.to,!0,a,r?.fiscalYearStartMonth),raw:f}}},16833:(G,O,e)=>{"use strict";e.d(O,{D:()=>i,d:()=>n});var t=e(7758);function n(c,o,h){const g=r(c.templating.list),l=s(c.panels);t.c.dashboardInitialized({uid:c.uid,title:c.title,theme:c.style,schemaVersion:c.schemaVersion,version_before_migration:h,panels_count:c.panels.length,...l,...g,settings_nowdelay:c.timepicker.nowDelay,settings_livenow:!!c.liveNow,duration:o,isScene:!1})}function i(c,o){const h=c.getInitialSaveModel();if(h){const g=s(h.panels||[]),l=r(h.templating?.list||[]);t.c.dashboardInitialized({uid:h.uid,title:h.title,theme:void 0,schemaVersion:h.schemaVersion,version_before_migration:h.version,panels_count:h.panels?.length||0,...g,...l,settings_nowdelay:void 0,settings_livenow:!!h.liveNow,duration:o,isScene:!0})}}function s(c){return c.map(o=>o.type).reduce((o,h)=>(o[a(h)]=1+o[a(h)]||1,o),{})}function r(c){return c.map(o=>o.type).reduce((o,h)=>(o[f(h)]=1+o[f(h)]||1,o),{})}const f=c=>`variable_type_${c}_count`,a=c=>`panel_type_${c}_count`},40489:(G,O,e)=>{"use strict";e.d(O,{ZF:()=>f,vI:()=>r,o2:()=>a});var t=e(88483),n=e(14236);function i(c){const o=new Set;return Object.keys(c).forEach(h=>{c[h].forEach(g=>{o.add(g)})}),o}function s(c){const o=Array.from(i(c));return o.length===1?o[0]:`${o.slice(0,-1).join(", ")} or ${o.slice(-1)}`}function r(c){return new t.c(o=>{let h=0;Promise.all([e.e(2136),e.e(3686)]).then(e.bind(e,22136)).then(g=>{c.forEach(l=>{const p=new FileReader;p.readAsArrayBuffer(l),p.onload=()=>{const m=p.result;if(m&&m instanceof ArrayBuffer){if(l.type==="application/json"){const y=new TextDecoder("utf-8"),d=JSON.parse(y.decode(m));o.next({dataFrames:[(0,n.Vc)(d)],file:l})}else o.next({dataFrames:g.readSpreadsheet(m),file:l});++h>=c.length&&o.complete()}}})}).catch(()=>{throw"Failed to load sheets module"})})}const f={"text/plain":[".csv",".txt"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel":[".xls"],"application/vnd.apple.numbers":[".numbers"],"application/vnd.oasis.opendocument.spreadsheet":[".ods"],"application/json":[".json"]},a=5e5},32738:(G,O,e)=>{"use strict";e.d(O,{r:()=>c});var t=e(74848),n=e(71733),i=e(55852),s=e(10096),r=e(8484),f=e(6320),a=e(31678);function c({variant:o,onClick:h}){const g=s.TP.hasPermission(a.AccessControlAction.DataSourcesCreate),l=n.I.assureBaseUrl(f.b.DataSourcesNew);return(0,t.jsx)(i.z9,{variant:o||"primary",href:l,disabled:!g,tooltip:g?void 0:"You do not have permission to configure new data sources",onClick:h,target:"_blank",children:(0,t.jsx)(r.x6,{i18nKey:"data-source-picker.add-new-data-source",children:"Configure a new data source"})})}},2221:(G,O,e)=>{"use strict";e.d(O,{A:()=>f});var t=e(74848),n=e(32196),i=e(40845),s=e(10860),r=e(64149);function f({ds:c,onClick:o,selected:h,description:g,...l}){const p=(0,i.$j)(),m=a(p,c.meta.builtIn);return(0,t.jsxs)(s.Z,{onClick:o,className:(0,n.cx)(m.card,h?m.selected:void 0),...l,children:[(0,t.jsx)(s.Z.Heading,{className:m.heading,children:(0,t.jsxs)("div",{className:m.headingContent,children:[(0,t.jsxs)("span",{className:m.name,children:[c.name," ",c.isDefault?(0,t.jsx)(r.L,{tags:["default"]}):null]}),(0,t.jsx)("small",{className:m.type,children:g||c.meta.name})]})}),(0,t.jsx)(s.Z.Figure,{className:m.logo,children:(0,t.jsx)("img",{src:c.meta.info.logos.small,alt:`${c.meta.name} Logo`})})]},c.uid)}function a(c,o=!1){return{card:(0,n.css)`
      cursor: pointer;
      background-color: ${c.colors.background.primary};
      border-bottom: 1px solid ${c.colors.border.weak};
      // Move to list component
      margin-bottom: 0;
      border-radius: 0;
      padding: ${c.spacing(1)};
    `,heading:(0,n.css)`
      width: 100%;
      overflow: hidden;
      // This is needed to enable ellipsis when text overlfows
      > button {
        width: 100%;
      }
    `,headingContent:(0,n.css)`
      color: ${c.colors.text.secondary};
      width: 100%;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      display: flex;
      justify-content: space-between;
    `,logo:(0,n.css)`
      width: 32px;
      height: 32px;
      padding: ${c.spacing(0,1)};
      display: flex;
      align-items: center;

      > img {
        max-height: 100%;
        min-width: 24px;
        filter: invert(${o&&c.isLight?1:0});
      }
    `,name:(0,n.css)`
      color: ${c.colors.text.primary};
      display: flex;
      gap: ${c.spacing(2)};
    `,type:(0,n.css)`
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      display: flex;
      align-items: center;
    `,separator:(0,n.css)`
      margin: 0 ${c.spacing(1)};
      color: ${c.colors.border.weak};
    `,selected:(0,n.css)`
      background-color: ${c.colors.background.secondary};
    `,meta:(0,n.css)`
      display: block;
      overflow-wrap: unset;
      white-space: nowrap;
      width: 100%;
      overflow: hidden;
      text-overflow: ellipsis;
    `}}},11219:(G,O,e)=>{"use strict";e.d(O,{S:()=>l});var t=e(74848),n=e(32196),i=e(96540),s=e(13544),r=e(72574),f=e(40845),a=e(8484),c=e(87282),o=e(32738),h=e(2221),g=e(47311);function l(v){const u=(0,i.useRef)(null),[D,P]=(0,c.dR)({keyboardEvents:v.keyboardEvents,containerRef:u}),x=(0,f.$j)(),E=d(x,P),{className:C,current:M,onChange:S,enableKeyboardNavigation:I,onClickEmptyStateCTA:T}=v,b=(0,c.Kr)({alerting:v.alerting,annotations:v.annotations,dashboard:v.dashboard,logs:v.logs,metrics:v.metrics,mixed:v.mixed,pluginId:v.pluginId,tracing:v.tracing,type:v.type,variables:v.variables}),[R,A]=(0,c.TX)(),L=v.filter?b.filter(v.filter):b;return(0,t.jsxs)("div",{ref:u,className:(0,n.cx)(C,E.container),"data-testid":s.Tp.components.DataSourcePicker.dataSourceList,children:[L.length===0&&(0,t.jsx)(p,{className:E.emptyState,onClickCTA:T}),L.sort((0,g.Tj)(M,R,y())).map(U=>(0,t.jsx)(h.A,{"data-testid":"data-source-card",ds:U,onClick:()=>{A(U),S(U)},selected:(0,g.Df)(U,M),...I?D:{}},U.uid))]})}function p({className:v,onClickCTA:u}){const D=(0,f.of)(m);return(0,t.jsxs)("div",{className:(0,n.cx)(v,D.container),children:[(0,t.jsx)("p",{className:D.message,children:(0,t.jsx)(a.x6,{i18nKey:"data-source-picker.list.no-data-source-message",children:"No data sources found"})}),(0,t.jsx)(o.r,{onClick:u})]})}function m(v){return{container:(0,n.css)`
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    `,message:(0,n.css)`
      margin-bottom: ${v.spacing(3)};
    `}}function y(){return(0,r.w)().getVariables().filter(u=>u.type==="datasource").map(u=>`\${${u.id}}`)}function d(v,u){return{container:(0,n.css)`
      display: flex;
      flex-direction: column;
      ${u} {
        background-color: ${v.colors.background.secondary};
      }
    `,emptyState:(0,n.css)`
      height: 100%;
      flex: 1;
    `}}},50481:(G,O,e)=>{"use strict";e.d(O,{p:()=>I});var t=e(74848),n=e(32196),i=e(2543),s=e(96540),r=e(14110),f=e(32264),a=e(40845),c=e(37390),o=e(10354),h=e(14578),g=e(40276),l=e(37270),p=e(8484),m=e(40489),y=e(90478),d=e(87282),v=e(32738),u=e(13544),D=e(2221),P=e(47311);function x(b){switch(b){case"grafana":return(0,p.t)("data-source-picker.built-in-list.description-grafana","Discover visualizations using mock data");case"-- Mixed --":return(0,p.t)("data-source-picker.built-in-list.description-mixed","Use multiple data sources");case"-- Dashboard --":return(0,p.t)("data-source-picker.built-in-list.description-dashboard","Reuse query results from other visualizations");default:return""}}function E({className:b,current:R,onChange:A,tracing:L,dashboard:U,mixed:W,metrics:w,type:N,annotations:B,variables:V,alerting:K,pluginId:H,logs:X,filter:k}){const Z=(0,d.Kr)({tracing:L,dashboard:U,mixed:W,metrics:w,type:N,annotations:B,variables:V,alerting:K,pluginId:H,logs:X}).filter(se=>(k?k?.(se):!0)&&!!se.meta.builtIn);return(0,t.jsx)("div",{className:b,"data-testid":u.Tp.components.DataSourcePicker.advancedModal.builtInDataSourceList,children:Z.map(se=>(0,t.jsx)(D.A,{ds:se,description:x(se.uid),selected:(0,P.Df)(se,R),onClick:()=>A(se)},se.uid))})}var C=e(11219);const M="dashboards_dspickermodal_clicked",S={SELECT_DS:"select_ds",UPLOAD_FILE:"upload_file",CONFIG_NEW_DS:"config_new_ds",CONFIG_NEW_DS_EMPTY_STATE:"config_new_ds_empty_state",SEARCH:"search",DISMISS:"dismiss"};function I({tracing:b,dashboard:R,mixed:A,metrics:L,type:U,annotations:W,variables:w,alerting:N,pluginId:B,logs:V,uploadFile:K,filter:H,onChange:X,current:k,onDismiss:Y,reportedInteractionFrom:Z}){const se=(0,a.of)(T),[j,q]=(0,s.useState)(""),ne=Z||"modal",oe=()=>{Y(),(0,r.rR)(M,{item:S.DISMISS,src:ne})},z=re=>{X(re),(0,r.rR)(M,{item:S.SELECT_DS,ds_type:re.type,src:ne})},te=(0,s.useMemo)(()=>(0,i.once)(()=>{(0,r.rR)(M,{item:"search",src:ne})}),[ne]),le=(0,d.ps)("-- Grafana --"),ie=(0,y.j)((re,ce)=>{le&&(X(le,[re]),(0,r.rR)(M,{item:S.UPLOAD_FILE,src:ne}),ce.length<1&&Y())}),ae=({className:re})=>(0,t.jsx)(E,{className:re,onChange:z,current:k,filter:H,variables:w,tracing:b,metrics:L,type:U,annotations:W,alerting:N,pluginId:B,logs:V,dashboard:R,mixed:A});return(0,t.jsxs)(c.a,{title:(0,p.t)("data-source-picker.modal.title","Select data source"),closeOnEscape:!0,closeOnBackdropClick:!0,isOpen:!0,className:se.modal,contentClassName:se.modalContent,onClickBackdrop:oe,onDismiss:oe,children:[(0,t.jsxs)("div",{className:se.leftColumn,children:[(0,t.jsx)(o.p,{type:"search",autoFocus:!0,className:se.searchInput,value:j,prefix:(0,t.jsx)(h.I,{name:"search"}),placeholder:(0,p.t)("data-source-picker.modal.input-placeholder","Select data source"),onChange:re=>{q(re.currentTarget.value),te()}}),(0,t.jsxs)(g.E,{children:[(0,t.jsx)(C.S,{onChange:z,current:k,onClickEmptyStateCTA:()=>(0,r.rR)(M,{item:S.CONFIG_NEW_DS_EMPTY_STATE,src:ne}),filter:re=>(H?H?.(re):!0)&&(0,P.Zn)(re,j)&&!re.meta.builtIn,variables:w,tracing:b,metrics:L,type:U,annotations:W,alerting:N,pluginId:B,logs:V,dashboard:R,mixed:A}),(0,t.jsx)(ae,{className:se.appendBuiltInDataSourcesList})]})]}),(0,t.jsxs)("div",{className:se.rightColumn,children:[(0,t.jsxs)("div",{className:se.builtInDataSources,children:[(0,t.jsx)(g.E,{className:se.builtInDataSourcesList,children:(0,t.jsx)(ae,{})}),K&&f.$.featureToggles.editPanelCSVDragAndDrop&&(0,t.jsx)(l.gH,{readAs:"readAsArrayBuffer",fileListRenderer:()=>{},options:{maxSize:m.o2,multiple:!1,accept:m.ZF,onDrop:ie},children:(0,t.jsx)(l.wI,{})})]}),(0,t.jsxs)("div",{className:se.newDSSection,children:[(0,t.jsx)("span",{className:se.newDSDescription,children:(0,t.jsx)(p.x6,{i18nKey:"data-source-picker.modal.configure-new-data-source",children:"Open a new tab and configure a data source"})}),(0,t.jsx)(v.r,{variant:"secondary",onClick:()=>{(0,r.rR)(M,{item:S.CONFIG_NEW_DS,src:ne}),Y()}})]})]})]})}function T(b){return{modal:(0,n.css)`
      width: 80%;
      height: 80%;
      max-width: 1200px;
      max-height: 900px;

      ${b.breakpoints.down("md")} {
        width: 100%;
      }
    `,modalContent:(0,n.css)`
      display: flex;
      flex-direction: row;
      height: 100%;

      ${b.breakpoints.down("md")} {
        flex-direction: column;
      }
    `,leftColumn:(0,n.css)`
      display: flex;
      flex-direction: column;
      width: 50%;
      height: 100%;
      padding-right: ${b.spacing(4)};
      border-right: 1px solid ${b.colors.border.weak};

      ${b.breakpoints.down("md")} {
        width: 100%;
        border-right: 0;
        padding-right: 0;
        flex: 1;
        overflow-y: auto;
      }
    `,rightColumn:(0,n.css)`
      display: flex;
      flex-direction: column;
      width: 50%;
      height: 100%;
      justify-items: space-evenly;
      align-items: stretch;
      padding-left: ${b.spacing(4)};

      ${b.breakpoints.down("md")} {
        width: 100%;
        padding-left: 0;
        flex: 0;
      }
    `,builtInDataSources:(0,n.css)`
      flex: 1 1;
      margin-bottom: ${b.spacing(4)};

      ${b.breakpoints.down("md")} {
        flex: 0;
      }
    `,builtInDataSourcesList:(0,n.css)`
      ${b.breakpoints.down("md")} {
        display: none;
        margin-bottom: 0;
      }

      margin-bottom: ${b.spacing(4)};
    `,appendBuiltInDataSourcesList:(0,n.css)`
      ${b.breakpoints.up("md")} {
        display: none;
      }
    `,newDSSection:(0,n.css)`
      display: flex;
      flex-direction: row;
      width: 100%;
      justify-content: space-between;
      align-items: center;
    `,newDSDescription:(0,n.css)`
      flex: 1 0;
      text-overflow: ellipsis;
      overflow: hidden;
      white-space: nowrap;
      color: ${b.colors.text.secondary};
    `,searchInput:(0,n.css)`
      width: 100%;
      min-height: 32px;
      margin-bottom: ${b.spacing(1)};
    `}}},51612:(G,O,e)=>{"use strict";e.d(O,{s:()=>U});var t=e(74848),n=e(32196),i=e(34743),s=e(36376),r=e(7315),f=e(18828),a=e(85690),c=e(93225),o=e(96540),h=e(13544),g=e(14110),l=e(40845),p=e(10354),m=e(14578),y=e(17464),d=e(40276),v=e(71678),u=e(55852),D=e(2913),P=e(8484),x=e(97427),E=e(68706),C=e(87282),M=e(11219);function S(K){const{dataSource:H}=K,X=(0,l.$j)(),k=T(X,H?.meta.builtIn);return H?(0,t.jsx)("img",{className:k.pickerDSLogo,alt:`${H.meta.name} logo`,src:H.meta.info.logos.small}):I()}function I(){const K=(0,l.of)(T);return(0,t.jsx)("div",{className:K.pickerDSLogo})}function T(K,H=!1){return{pickerDSLogo:(0,n.css)`
      height: 20px;
      width: 20px;
      filter: invert(${H&&K.isLight?1:0});
    `}}var b=e(50481),R=e(47311);const A="dashboards_dspicker_clicked",L={OPEN_DROPDOWN:"open_dspicker",SELECT_DS:"select_ds",ADD_FILE:"add_file",OPEN_ADVANCED_DS_PICKER:"open_advanced_ds_picker",CONFIG_NEW_DS_EMPTY_STATE:"config_new_ds_empty_state"};function U(K){const{current:H,onChange:X,hideTextValue:k=!1,width:Y,inputId:Z,noDefault:se=!1,disabled:j=!1,placeholder:q="Select data source",...ne}=K,oe=(0,l.of)(W,K),[z,te]=(0,o.useState)(!1),[le,ie]=(0,o.useState)(!1),[ae,re]=(0,o.useState)(""),{onKeyDown:ce,keyboardEvents:me}=(0,x.d)(),ee=(0,o.useRef)(null),[de,De]=(0,o.useState)(),[fe,Te]=(0,o.useState)(),je=(0,C.ps)(H),He=(0,C.ps)("-- Grafana --"),Be=!H&&se?void 0:je,Ne=ae&&z?(0,t.jsx)(I,{}):(0,t.jsx)(S,{dataSource:Be}),Re=[(0,i.cY)(4),(0,i.Ej)({apply({availableHeight:be,elements:he}){he.floating.style.maxHeight=`${Math.max(200,be-20)}px`,he.floating.style.minHeight="200px"}}),(0,i.UU)({fallbackStrategy:"initialPlacement",crossAxis:!1,boundary:document.body}),(0,i.BN)()],{refs:Se,floatingStyles:We}=(0,s.we)({open:z,placement:"bottom-start",onOpenChange:te,middleware:Re,whileElementsMounted:r.ll,strategy:"fixed"}),Ke=(0,o.useCallback)(be=>{Se.setReference(be),De(be)},[Se]),Xe=(0,o.useCallback)(()=>{re(""),te(!1),de?.focus()},[te,de]),{overlayProps:Je,underlayProps:st}=(0,c.e)({onClose:Xe,isDismissable:!0,isOpen:z,shouldCloseOnInteractOutside:be=>de?!de.isSameNode(be):!1},ee),{dialogProps:pt}=(0,f.s)({"aria-label":"Opened data source picker list"},ee);function xt(){(0,g.rR)(A,{item:L.OPEN_DROPDOWN}),te(!0),de?.focus()}function ot(){He&&X(He,[E.dx])}function $e(be){be.key==="Tab"&&!be.shiftKey&&z&&(be.preventDefault(),fe?.focus()),be.key==="Tab"&&be.shiftKey&&z&&Xe(),ce(be)}function ve(be){be.shiftKey?(be.preventDefault(),de?.focus()):Xe()}return(0,o.useEffect)(()=>{const be=me.subscribe({next:he=>{switch(he?.code){case"ArrowDown":xt(),he.preventDefault();break;case"ArrowUp":xt(),he.preventDefault();break;case"Escape":Xe(),he.preventDefault();break}}});return()=>be.unsubscribe()}),(0,t.jsxs)("div",{className:oe.container,"data-testid":h.Tp.components.DataSourcePicker.container,children:[(0,t.jsx)("div",{className:oe.trigger,onClick:xt,children:(0,t.jsx)(p.p,{id:Z||"data-source-picker",className:le?void 0:oe.input,"data-testid":h.Tp.components.DataSourcePicker.inputV2,"aria-label":"Select a data source",autoComplete:"off",prefix:Be?Ne:void 0,suffix:(0,t.jsx)(m.I,{name:z?"search":"angle-down"}),placeholder:k?"":(0,R.q7)(Be)||q,onFocus:()=>{ie(!0)},onBlur:()=>{ie(!1)},onKeyDown:$e,value:ae,onChange:be=>{xt(),re(be.currentTarget.value)},ref:Ke,disabled:j})}),z?(0,t.jsxs)(y.ZL,{children:[(0,t.jsx)("div",{...st}),(0,t.jsx)("div",{ref:ee,...Je,...pt,children:(0,t.jsx)(w,{...ne,style:We,ref:Se.setFloating,footerRef:Te,current:Be,filterTerm:ae,keyboardEvents:me,onChange:(be,he)=>{Xe(),be.uid!==Be?.uid&&(X(be,he),(0,g.rR)(A,{item:L.SELECT_DS,ds_type:be.type}))},onClose:Xe,onClickAddCSV:ot,onDismiss:Xe,onNavigateOutsiteFooter:ve})})]}):null]})}function W(K,H){return{container:(0,n.css)({position:"relative",cursor:H.disabled?"not-allowed":"pointer",width:K.spacing(H.width||"auto")}),trigger:(0,n.css)({cursor:"pointer",pointerEvents:H.disabled?"none":"auto"}),input:(0,n.css)({"input::placeholder":{color:H.disabled?K.colors.action.disabledText:K.colors.text.primary}})}}const w=o.forwardRef((K,H)=>{const{filterTerm:X,onChange:k,onClose:Y,onClickAddCSV:Z,current:se,filter:j}=K,q=(0,o.useCallback)(z=>{k(z)},[k]),ne=(0,o.useCallback)(()=>{Z?.(),Y(),(0,g.rR)(A,{item:L.ADD_FILE})},[Z,Y]),oe=(0,l.of)(N);return(0,t.jsxs)("div",{style:K.style,ref:H,className:oe.container,children:[(0,t.jsx)(d.E,{children:(0,t.jsx)(M.S,{...K,enableKeyboardNavigation:!0,className:oe.dataSourceList,current:se,onChange:q,filter:z=>(j?j?.(z):!0)&&(0,R.Zn)(z,X),onClickEmptyStateCTA:()=>(0,g.rR)(A,{item:L.CONFIG_NEW_DS_EMPTY_STATE})})}),(0,t.jsx)(a.n1,{children:(0,t.jsx)(B,{...K,onClickAddCSV:ne,onChange:q,onNavigateOutsiteFooter:K.onNavigateOutsiteFooter})})]})});w.displayName="PickerContent";function N(K){return{container:(0,n.css)({display:"flex",flexDirection:"column",background:K.colors.background.primary,boxShadow:K.shadows.z3}),picker:(0,n.css)({background:K.colors.background.secondary}),dataSourceList:(0,n.css)({flex:1}),footer:(0,n.css)({flex:0,display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",padding:K.spacing(1.5),borderTop:`1px solid ${K.colors.border.weak}`,backgroundColor:K.colors.background.secondary})}}function B({onClose:K,onChange:H,onClickAddCSV:X,...k}){const Y=(0,l.of)(V),Z=k.uploadFile&&D.Ay.featureToggles.editPanelCSVDragAndDrop,se=q=>{q.key==="Tab"&&k.onNavigateOutsiteFooter(q)},j=q=>{q.key==="Tab"&&q.shiftKey&&k.onNavigateOutsiteFooter(q)};return(0,t.jsxs)("div",{className:Y.footer,children:[(0,t.jsx)(v.$s,{children:({showModal:q,hideModal:ne})=>(0,t.jsxs)(u.$n,{size:"sm",variant:"secondary",fill:"text",onClick:()=>{K(),q(b.p,{reportedInteractionFrom:"ds_picker",tracing:k.tracing,dashboard:k.dashboard,mixed:k.mixed,metrics:k.metrics,type:k.type,annotations:k.annotations,variables:k.variables,alerting:k.alerting,pluginId:k.pluginId,logs:k.logs,filter:k.filter,uploadFile:k.uploadFile,current:k.current,onDismiss:ne,onChange:(oe,z)=>{H(oe,z),ne()}}),(0,g.rR)(A,{item:L.OPEN_ADVANCED_DS_PICKER})},ref:k.footerRef,onKeyDown:Z?j:se,children:[(0,t.jsx)(P.x6,{i18nKey:"data-source-picker.open-advanced-button",children:"Open advanced data source picker"}),(0,t.jsx)(m.I,{name:"arrow-right"})]})}),Z&&(0,t.jsx)(u.$n,{variant:"secondary",size:"sm",onClick:X,onKeyDown:se,children:"Add csv or spreadsheet"})]})}function V(K){return{footer:(0,n.css)({flex:0,display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",padding:K.spacing(1.5),borderTop:`1px solid ${K.colors.border.weak}`,backgroundColor:K.colors.background.secondary})}}},47311:(G,O,e)=>{"use strict";e.d(O,{Df:()=>s,Tj:()=>f,Zn:()=>a,q7:()=>r,tw:()=>c});var t=e(14792),n=e(36974),i=e(14678);function s(o,h){return!o||!h?!1:typeof h=="string"?o.uid===h:o.uid===h.uid}function r(o){if(o){if(typeof o=="string")return`${o} - not found`;if("name"in o)return o.name;if(o.uid)return`${o.uid} - not found`}}function f(o,h,g){return(p,m)=>{const y=p.name.toUpperCase(),d=m.name.toUpperCase();if(o&&s(p,o))return-1;if(o&&s(m,o))return 1;const v=h.indexOf(p.uid),u=h.indexOf(m.uid);if(v>-1&&v>u)return-1;if(u>-1&&u>v)return 1;const D=g.includes(p.uid),P=g.includes(m.uid);return D&&!P?-1:P&&!D||p.meta.builtIn&&!m.meta.builtIn?1:m.meta.builtIn&&!p.meta.builtIn||y<d?-1:1}}function a(o,h=""){return o.name.toLowerCase().includes(h.toLowerCase())}function c(o){if(!o.uid)return;const h=(0,t.UA)().getCurrent()?.uid??"";if(o.uid===i.uv)return(0,n.B1)(h);(0,n.dH)(h,o.uid)}},83883:(G,O,e)=>{"use strict";e.d(O,{I:()=>t});const t={List:"/datasources",Edit:"/datasources/edit/:uid",Dashboards:"/datasources/edit/:uid/dashboards",New:"/datasources/new"}},87282:(G,O,e)=>{"use strict";e.d(O,{Kr:()=>f,TX:()=>r,dR:()=>c,ps:()=>a});var t=e(96540),n=e(78685),i=e(19347);const s="grafana.features.datasources.components.picker.DataSourceDropDown.history";function r(){const[o=[],h]=(0,n.A)(s,[]),g=(0,t.useCallback)(l=>{l.meta.builtIn||(o.includes(l.uid)?(o.splice(o.findIndex(p=>l.uid===p),1),h([...o,l.uid])):h([...o,l.uid].slice(1,6)))},[o,h]);return[o,g]}function f(o){return(0,i.l)().getList(o)}function a(o){const h=(0,i.l)();return h.getInstanceSettings(o)}function c(o){const{keyboardEvents:h,containerRef:g}=o,l=(0,t.useRef)(0),p="data-role",m="keyboardSelectableItem",y={[p]:m},d=`[${p}="${m}"`,v="data-selectedItem",u=`[${v}="true"]`,D=(0,t.useCallback)(x=>{const E=g?.current?.querySelectorAll(d),C=E?.item(x%E?.length);E?.forEach(M=>M.setAttribute(v,"false")),C&&(C.scrollIntoView({block:"center"}),C.setAttribute(v,"true"))},[g,d]),P=(0,t.useCallback)(()=>{g?.current?.querySelector(u)?.querySelector("button")?.click()},[g,u]);return(0,t.useEffect)(()=>{if(!h)return;const x=h.subscribe({next:E=>{switch(E?.code){case"ArrowDown":{D(++l.current),E.preventDefault();break}case"ArrowUp":l.current=l.current>0?l.current-1:l.current,D(l.current),E.preventDefault();break;case"Enter":P();break}}});return()=>x.unsubscribe()},[h,D,P]),(0,t.useEffect)(()=>{const x=new MutationObserver(E=>{E.some(M=>M.addedNodes&&M.addedNodes.length>0||M.removedNodes&&M.removedNodes.length>0)&&D(0)});return g.current&&x.observe(g.current,{childList:!0}),()=>{x.disconnect()}},[g,d,D]),[y,u]}},36227:(G,O,e)=>{"use strict";e.d(O,{Ay:()=>M,Bs:()=>h,C_:()=>m,E1:()=>f,Gc:()=>c,IJ:()=>v,Ks:()=>u,QZ:()=>P,TN:()=>r,Tk:()=>y,UP:()=>E,eB:()=>l,f$:()=>o,gZ:()=>a,jz:()=>s,lg:()=>x,qR:()=>D,rb:()=>p});var t=e(65307),n=e(19484);const i={dataSources:[],plugins:[],categories:[],dataSource:{},layoutMode:n.R.List,searchQuery:"",dataSourcesCount:0,dataSourceTypeSearchQuery:"",isLoadingDataSources:!1,isLoadingDataSourcePlugins:!1,dataSourceMeta:{},isSortAscending:!0},s=(0,t.VP)("dataSources/dataSourceLoaded"),r=(0,t.VP)("dataSources/dataSourcesLoad"),f=(0,t.VP)("dataSources/dataSourcesLoaded"),a=(0,t.VP)("dataSources/dataSourceMetaLoaded"),c=(0,t.VP)("dataSources/dataSourcePluginsLoad"),o=(0,t.VP)("dataSources/dataSourcePluginsLoaded"),h=(0,t.VP)("dataSources/setDataSourcesSearchQuery"),g=(0,t.VP)("dataSources/setDataSourcesLayoutMode"),l=(0,t.VP)("dataSources/setDataSourceTypeSearchQuery"),p=(0,t.VP)("dataSources/setDataSourceName"),m=(0,t.VP)("dataSources/setIsDefault"),y=(0,t.VP)("dataSources/setIsSortAscending"),d=(S=i,I)=>r.match(I)?{...S,isLoadingDataSources:!0}:f.match(I)?{...S,isLoadingDataSources:!1,dataSources:I.payload,dataSourcesCount:I.payload.length}:s.match(I)?{...S,dataSource:I.payload}:h.match(I)?{...S,searchQuery:I.payload}:g.match(I)?{...S,layoutMode:I.payload}:c.match(I)?{...S,plugins:[],isLoadingDataSourcePlugins:!0}:o.match(I)?{...S,plugins:I.payload.plugins,categories:I.payload.categories,isLoadingDataSourcePlugins:!1}:l.match(I)?{...S,dataSourceTypeSearchQuery:I.payload}:a.match(I)?{...S,dataSourceMeta:I.payload}:p.match(I)?{...S,dataSource:{...S.dataSource,name:I.payload}}:m.match(I)?{...S,dataSource:{...S.dataSource,isDefault:I.payload}}:y.match(I)?{...S,isSortAscending:I.payload}:S,v={testingStatus:{},loadError:null,loading:!0,plugin:null},u=(0,t.VP)("dataSourceSettings/initDataSourceSettingsSucceeded"),D=(0,t.VP)("dataSourceSettings/initDataSourceSettingsFailed"),P=(0,t.VP)("dataSourceSettings/testDataSourceStarting"),x=(0,t.VP)("dataSourceSettings/testDataSourceSucceeded"),E=(0,t.VP)("dataSourceSettings/testDataSourceFailed"),M={dataSources:d,dataSourceSettings:(S=v,I)=>u.match(I)?{...S,plugin:I.payload,loadError:null,loading:!1}:D.match(I)?{...S,plugin:null,loadError:I.payload.message,loading:!1}:P.match(I)?{...S,testingStatus:{message:"Testing... this could take up to a couple of minutes",status:"info"}}:x.match(I)?{...S,testingStatus:{status:I.payload?.status,message:I.payload?.message,details:I.payload?.details}}:E.match(I)?{...S,testingStatus:{status:"error",message:I.payload?.message,details:I.payload?.details}}:S}},38074:()=>{"use strict"},25148:(G,O,e)=>{"use strict";e.d(O,{n:()=>d});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(55852),f=e(39268),a=e(14186),c=e(10354),o=e(95868),h=e(13840),g=e(40321),l=e(47694),p=e(21813),m=e(80744),y=e(19448);const d=D=>{const{value:P,src:x,name:E,placeholder:C,onChange:M,onClear:S,mediaType:I,folderName:T,size:b,color:R,maxFiles:A}=D,L=(0,s.of)(u),U=(0,s.$j)(),W=(0,i.createRef)(),w=(0,t.jsx)(y.i,{onChange:M,value:P,mediaType:I,folderName:T,maxFiles:A});let N=x;!N&&P&&(N=(0,p.D)(P));const B=R&&{fill:U.visualization.getColorByName(R)},V=()=>P&&N?(0,t.jsx)(l.y,{src:N,className:L.icon,style:{...B}}):(0,t.jsx)(r.z9,{variant:"primary",fill:"text",size:"sm",children:"Set icon"}),K=()=>(0,t.jsx)(f.C,{children:(0,t.jsx)(a.I,{label:null,grow:!0,children:(0,t.jsx)(c.p,{value:v(x,E),placeholder:C,readOnly:!0,prefix:N&&(0,t.jsx)(l.y,{src:N,className:L.icon,style:{...B}}),suffix:(0,t.jsx)(r.$n,{icon:"times",variant:"secondary",fill:"text",size:"sm",onClick:S})})})});return(0,t.jsx)(o.I,{content:w,children:(H,X,k)=>(0,t.jsxs)(t.Fragment,{children:[W.current&&(0,t.jsx)(h.A,{...k,referenceElement:W.current,onMouseEnter:H,onKeyDown:Y=>{(0,g.Q)(Y,X)}}),(0,t.jsxs)("div",{ref:W,className:L.pointer,onClick:H,onKeyDown:Y=>{Y.key==="Enter"&&H()},role:"button",tabIndex:0,children:[b===m.Iy.SMALL&&V(),b===m.Iy.NORMAL&&K()]})]})})};function v(D,P){if(D?.startsWith("public/img/icons")){const x=P?.lastIndexOf(".svg")??0;if(x>0)return P.substring(0,x)}return P}const u=D=>({pointer:(0,n.css)`
    cursor: pointer;
    input[readonly] {
      cursor: pointer;
    }
  `,icon:(0,n.css)`
    vertical-align: middle;
    display: inline-block;
    fill: currentColor;
    width: 25px;
  `})},19448:(G,O,e)=>{"use strict";e.d(O,{i:()=>N});var t=e(74848),n=e(32196),i=e(18828),s=e(85690),r=e(93225),f=e(96540),a=e(17172),c=e(40845),o=e(55852),h=e(2913),g=e(80744),l=e(88575),p=e(37270),m=e(47694);function y({secondaryText:V="Drag and drop here or browse"}){const K=(0,c.of)(v);return(0,t.jsxs)("div",{className:K.iconWrapper,children:[(0,t.jsx)("small",{className:K.small,children:V}),(0,t.jsx)(o.$n,{type:"button",icon:"upload",children:"Upload"})]})}const d=({mediaType:V,setFormData:K,setUpload:H,error:X})=>{const k=(0,c.of)(v),[Y,Z]=(0,f.useState)(!1),[se,j]=(0,f.useState)(""),q=()=>(0,t.jsx)(l.D,{label:"Preview",children:(0,t.jsxs)("div",{className:k.iconPreview,children:[V===g.zu.Icon&&(0,t.jsx)(m.y,{src:se,className:k.img}),V===g.zu.Image&&(0,t.jsx)("img",{src:se,alt:"Preview of the uploaded file",className:k.img})]})}),ne=z=>{fetch(`/api/storage/delete/upload/${z.file.name}`,{method:"DELETE"}).catch(te=>console.error("cannot delete file",te))},oe=V==="icon"?{"image/*":[".svg",".xml"]}:{"image/*":[".jpeg",".png",".gif",".webp"]};return(0,t.jsx)(p.gH,{readAs:"readAsBinaryString",onFileRemove:ne,options:{accept:oe,multiple:!1,onDrop:z=>{let te=new FormData;te.append("file",z[0]),j(URL.createObjectURL(z[0])),Z(!0),K(te),H(!0)}},children:X.message!==""&&Y?(0,t.jsx)("p",{children:X.message}):Y?(0,t.jsx)(q,{}):(0,t.jsx)(y,{})})};function v(V,K){return{container:(0,n.css)`
      display: flex;
      flex-direction: column;
      width: 100%;
    `,dropzone:(0,n.css)`
      display: flex;
      flex: 1;
      flex-direction: column;
      align-items: center;
      padding: ${V.spacing(6)};
      border-radius: 2px;
      border: 2px dashed ${V.colors.border.medium};
      background-color: ${K?V.colors.background.secondary:V.colors.background.primary};
      cursor: pointer;
    `,iconWrapper:(0,n.css)`
      display: flex;
      flex-direction: column;
      align-items: center;
    `,acceptMargin:(0,n.css)`
      margin: ${V.spacing(2,0,1)};
    `,small:(0,n.css)`
      color: ${V.colors.text.secondary};
      margin-bottom: ${V.spacing(2)};
    `,iconContainer:(0,n.css)`
      display: flex;
      flex-direction: column;
      width: 80%;
      align-items: center;
      align-self: center;
    `,iconPreview:(0,n.css)`
      width: 238px;
      height: 198px;
      border: 1px solid ${V.colors.border.medium};
      display: flex;
      align-items: center;
      justify-content: center;
    `,img:(0,n.css)`
      width: 147px;
      height: 147px;
      fill: ${V.colors.text.primary};
    `}}var u=e(90182),D=e(67647),P=e(31193),x=e(70713),E=e(91793);const C=(0,f.memo)(function(K){const{columnIndex:H,rowIndex:X,style:k,data:Y}=K,{cards:Z,columnCount:se,onChange:j,selected:q}=Y,ne=H+X*se,oe=Z[ne],z=(0,c.of)(S);return(0,t.jsx)("div",{style:k,children:oe&&(0,t.jsxs)("div",{className:q===oe.value?(0,n.cx)(z.card,z.selected):z.card,onClick:()=>j(oe.value),onKeyDown:te=>{te.key==="Enter"&&j(oe.value)},role:"button",tabIndex:0,children:[oe.imgUrl.endsWith(".svg")?(0,t.jsx)(m.y,{src:oe.imgUrl,className:z.img}):(0,t.jsx)("img",{src:oe.imgUrl,alt:"",className:z.img}),(0,t.jsx)("h6",{className:z.text,children:oe.label.slice(0,-4)})]},oe.value)})},E.t7),M=V=>{const{onChange:K,cards:H,value:X}=V,k=(0,c.of)(S);return(0,t.jsx)(x.Ay,{defaultWidth:680,children:({width:Y,height:Z})=>{const q=Math.floor(Y/90),ne=Math.ceil(H.length/q);return(0,t.jsx)(E.yi,{width:Y,height:Z,columnCount:q,columnWidth:90,rowCount:ne,rowHeight:90,itemData:{cards:H,columnCount:q,onChange:K,selected:X},className:k.grid,children:C})}})},S=V=>({card:(0,n.css)`
    display: inline-block;
    width: 90px;
    height: 90px;
    margin: 0.75rem;
    margin-left: 15px;
    text-align: center;
    cursor: pointer;
    position: relative;
    background-color: transparent;
    border: 1px solid transparent;
    border-radius: 8px;
    padding-top: 6px;
    :hover {
      border-color: ${V.colors.action.hover};
      box-shadow: ${V.shadows.z2};
    }
  `,selected:(0,n.css)`
    border: 2px solid ${V.colors.primary.main};
    :hover {
      border-color: ${V.colors.primary.main};
    }
  `,img:(0,n.css)`
    width: 40px;
    height: 40px;
    object-fit: cover;
    vertical-align: middle;
    fill: ${V.colors.text.primary};
  `,text:(0,n.css)`
    color: ${V.colors.text.primary};
    white-space: nowrap;
    font-size: 12px;
    text-overflow: ellipsis;
    display: block;
    overflow: hidden;
  `,grid:(0,n.css)`
    border: 1px solid ${V.colors.border.medium};
  `}),I=V=>V===g.zu.Icon?[g.Iu.Icon,g.Iu.IOT,g.Iu.Marker]:[g.Iu.BG],T=(V,K)=>V.find(H=>K.startsWith(H.value))??V[0],b=V=>{const{value:K,mediaType:H,folderName:X,newValue:k,setNewValue:Y,maxFiles:Z}=V,se=(0,c.of)(R),j=I(H).map(ce=>({label:ce,value:ce})),[q,ne]=(0,f.useState)(),[oe,z]=(0,f.useState)(T(j,K?.length?K:X)),[te,le]=(0,f.useState)([]),[ie,ae]=(0,f.useState)([]),re=ce=>{ce?(ce=ce.toLowerCase(),ae(te.filter(me=>me.search.includes(ce)))):ae(te)};return(0,f.useEffect)(()=>{const ce=oe?.value;if(ce){const me=H===g.zu.Icon?ee=>ee.name.endsWith(".svg"):ee=>ee.name.endsWith(".png")||ee.name.endsWith(".gif");(0,P.tR)().get("-- Grafana --").then(ee=>{ee.listFiles(ce,Z).subscribe({next:de=>{const De=[];de.forEach(fe=>{if(me(fe)){const Te=fe.name.lastIndexOf(".");De.push({value:`${ce}/${fe.name}`,label:fe.name,search:(Te?fe.name.substring(0,Te):fe.name).toLowerCase(),imgUrl:`public/${ce}/${fe.name}`})}}),le(De),ae(De)}})})}},[H,oe,Z]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.D,{children:(0,t.jsx)(u.l6,{options:j,onChange:z,value:oe,menuShouldPortal:!1})}),(0,t.jsx)(l.D,{children:(0,t.jsx)(D.Z,{value:q??"",placeholder:"Search",onChange:ce=>{re(ce),ne(ce)}})}),ie&&(0,t.jsx)("div",{className:se.cardsWrapper,children:(0,t.jsx)(M,{cards:ie,onChange:ce=>Y(ce),value:k})})]})},R=V=>({cardsWrapper:(0,n.css)`
    height: 30vh;
    min-height: 50px;
    margin-top: 5px;
    max-width: 680px;
  `});var A=e(10354),L=e(60029),U=e(21813);const W=V=>{const{newValue:K,setNewValue:H,mediaType:X}=V,k=(0,c.of)(w),Y=(0,U.D)(K);let Z=K?.substring(K.lastIndexOf("/")+1,K.lastIndexOf("."));return Z.length>20&&(Z=Z.substring(0,20)+"..."),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.D,{children:(0,t.jsx)(A.p,{onChange:se=>H(se.currentTarget.value),value:K})}),(0,t.jsxs)("div",{className:k.iconContainer,children:[(0,t.jsx)(l.D,{label:"Preview",children:(0,t.jsxs)("div",{className:k.iconPreview,children:[X===g.zu.Icon&&(0,t.jsx)(m.y,{src:Y,className:k.img}),X===g.zu.Image&&K&&(0,t.jsx)("img",{src:Y,alt:"Preview of the selected URL",className:k.img})]})}),(0,t.jsx)(L.J,{children:Z})]})]})},w=V=>({iconContainer:(0,n.css)`
    display: flex;
    flex-direction: column;
    width: 80%;
    align-items: center;
    align-self: center;
  `,iconPreview:(0,n.css)`
    width: 238px;
    height: 198px;
    border: 1px solid ${V.colors.border.medium};
    display: flex;
    align-items: center;
    justify-content: center;
  `,img:(0,n.css)`
    width: 147px;
    height: 147px;
    fill: ${V.colors.text.primary};
  `}),N=V=>{const{value:K,onChange:H,mediaType:X,folderName:k,maxFiles:Y}=V,Z=(0,c.of)(B),se=()=>{H(K)},j=(0,f.createRef)(),{dialogProps:q}=(0,i.s)({},j),{overlayProps:ne}=(0,r.e)({onClose:se,isDismissable:!0,isOpen:!0},j),oe=K&&K.includes("://"),[z,te]=(0,f.useState)(K??""),[le,ie]=(0,f.useState)(oe?g.QC.URL:g.QC.Folder),[ae,re]=(0,f.useState)(new FormData),[ce,me]=(0,f.useState)(!1),[ee,de]=(0,f.useState)({message:""}),De=Be=>`${Z.resourcePickerPopoverTab} ${le===Be&&Z.resourcePickerPopoverActiveTab}`,fe=()=>(0,t.jsx)(b,{value:K,mediaType:X,folderName:k,newValue:z,setNewValue:te,maxFiles:Y}),Te=()=>(0,t.jsx)(W,{newValue:z,setNewValue:te,mediaType:X}),je=()=>(0,t.jsx)(d,{mediaType:X,setFormData:re,setUpload:me,newValue:z,error:ee}),He=()=>{switch(le){case g.QC.Folder:return fe();case g.QC.URL:return Te();case g.QC.Upload:return je();default:return fe()}};return(0,t.jsx)(s.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("section",{ref:j,...ne,...q,children:(0,t.jsxs)("div",{className:Z.resourcePickerPopover,children:[(0,t.jsxs)("div",{className:Z.resourcePickerPopoverTabs,children:[(0,t.jsx)("button",{className:De(g.QC.Folder),onClick:()=>ie(g.QC.Folder),children:"Folder"}),(0,t.jsx)("button",{className:De(g.QC.URL),onClick:()=>ie(g.QC.URL),children:"URL"})]}),(0,t.jsxs)("div",{className:Z.resourcePickerPopoverContent,children:[He(),(0,t.jsxs)("div",{className:Z.buttonRow,children:[(0,t.jsx)(o.$n,{variant:"secondary",onClick:()=>se(),fill:"outline",children:"Cancel"}),(0,t.jsx)(o.$n,{variant:z&&z!==K?"primary":"secondary",onClick:()=>{ce?fetch("/api/storage/upload",{method:"POST",body:ae}).then(Be=>{if(Be.status>=400){Be.json().then(Ne=>de(Ne));return}else return Be.json()}).then(Be=>{(0,a.AI)().get(`api/storage/read/${Be.path}`).then(()=>te(`${h.config.appUrl}api/storage/read/${Be.path}`)).then(()=>H(`${h.config.appUrl}api/storage/read/${Be.path}`))}).catch(Be=>console.error(Be)):H(z)},children:"Select"})]})]})]})})})},B=V=>({resourcePickerPopover:(0,n.css)`
    border-radius: ${V.shape.radius.default};
    box-shadow: ${V.shadows.z3};
    background: ${V.colors.background.primary};
    border: 1px solid ${V.colors.border.weak};
  `,resourcePickerPopoverTab:(0,n.css)`
    width: 50%;
    text-align: center;
    padding: ${V.spacing(1,0)};
    background: ${V.colors.background.secondary};
    color: ${V.colors.text.secondary};
    font-size: ${V.typography.bodySmall.fontSize};
    cursor: pointer;
    border: none;

    &:focus:not(:focus-visible) {
      outline: none;
      box-shadow: none;
    }

    :focus-visible {
      position: relative;
    }
  `,resourcePickerPopoverActiveTab:(0,n.css)`
    color: ${V.colors.text.primary};
    font-weight: ${V.typography.fontWeightMedium};
    background: ${V.colors.background.primary};
  `,resourcePickerPopoverContent:(0,n.css)`
    width: 315px;
    font-size: ${V.typography.bodySmall.fontSize};
    min-height: 184px;
    padding: ${V.spacing(1)};
    display: flex;
    flex-direction: column;
  `,resourcePickerPopoverTabs:(0,n.css)`
    display: flex;
    width: 100%;
    border-radius: ${V.shape.radius.default} ${V.shape.radius.default} 0 0;
  `,buttonRow:(0,n.css)({display:"flex",justifyContent:"center",gap:V.spacing(2),padding:V.spacing(1)})})},63577:(G,O,e)=>{"use strict";e.d(O,{MediaType:()=>t.zu,ResourceFolderName:()=>t.Iu,findField:()=>r.UI,findFieldIndex:()=>r.gG,getColorDimension:()=>f,getPublicOrAbsoluteUrl:()=>m.D,getResourceDimension:()=>m.$,getScalarDimension:()=>d.H,getScaledDimension:()=>c.hX,getScaledDimensionForField:()=>c.qx,getTextDimension:()=>l});var t=e(80744),n=e(8066),i=e(58563),s=e(57875),r=e(33924);function f(v,u,D){return a((0,r.UI)(v,u.field),u,D)}function a(v,u,D){if(!v){const E=D.visualization.getColorByName(u.fixed??"grey");return{isAssumed:!!u.field?.length||!u.fixed,fixed:E,value:()=>E,get:C=>E}}const P=(0,n.Qi)(v);if(P.isByValue||v.config.mappings?.length){const E=(0,i.xg)(v,!0);E!==v.config&&(v={...v,config:E},v.state=void 0);const C=(0,s.J)({field:v,theme:D}),M=S=>C(S).color??"#ccc";return{field:v,get:S=>M(v.values[S]),value:()=>M((0,r.sB)(v))}}const x=P.getCalculator(v,D)(0,0);return{fixed:x,value:()=>x,get:E=>x,field:v}}var c=e(18379),o=e(11261),h=e(83195),g=e(52622);function l(v,u){const D=u.field?(0,r.UI)(v,u.field):v?.fields.find(P=>P.type===o.PU.string);return p(D,u)}function p(v,u){let D=u.fixed;const P=u.mode??g.RU.Fixed;if(P===g.RU.Fixed)return{isAssumed:!D,fixed:D,value:()=>D,get:E=>D};if(P===g.RU.Template){const E=C=>`TEMPLATE[${u.fixed} // ${C}]`;return v?{field:v,get:C=>E(v.values[C]),value:()=>E((0,r.sB)(v))}:(D=E(""),{isAssumed:!0,fixed:D,value:()=>D,get:C=>D})}if(!v)return{isAssumed:!0,fixed:D,value:()=>D,get:E=>D};let x=E=>(0,h.cN)(v.display(E));return{field:v,get:E=>x(v.values[E]),value:()=>x((0,r.sB)(v))}}var m=e(21813),y=e(38074),d=e(26781)},21813:(G,O,e)=>{"use strict";e.d(O,{$:()=>s,D:()=>i});var t=e(52622),n=e(33924);function i(r){return r?r.indexOf(":/")>0?r:window.__grafana_public_path__+r:""}function s(r,f){const a=f.mode??t.q_.Fixed;if(a===t.q_.Fixed){const h=i(f.fixed);return{isAssumed:!h,fixed:h,value:()=>h,get:g=>h}}const c=(0,n.UI)(r,f.field);if(!c){const h="";return{isAssumed:!0,fixed:h,value:()=>h,get:g=>h}}if(a===t.q_.Mapping){const h=g=>i(`${g}`);return{field:c,get:g=>h(c.values[g]),value:()=>h((0,n.sB)(c))}}const o=h=>{if(c&&c.display){const g=c.display(h).icon;return i(g??"")}return""};return{field:c,get:h=>o(c.values[h]),value:()=>o((0,n.sB)(c))}}},26781:(G,O,e)=>{"use strict";e.d(O,{H:()=>i});var t=e(52622),n=e(33924);function i(r,f){return s((0,n.UI)(r,f?.field),f)}function s(r,f){if(!r){const o=f.fixed??0;return{isAssumed:!!f.field?.length||!f.fixed,fixed:o,value:()=>o,get:()=>o}}let a=o=>o%f.max;return f.mode===t.WQ.Clamped&&(a=o=>o<f.min?f.min:o>f.max?f.max:o),{field:r,get:o=>{const h=r.values[o];return h===null||typeof h!="number"?0:a(h)},value:()=>(0,n.sB)(r)}}},18379:(G,O,e)=>{"use strict";e.d(O,{Nn:()=>f,Ru:()=>a,hX:()=>s,qx:()=>r});var t=e(58563),n=e(52622),i=e(33924);function s(c,o){return r((0,i.UI)(c,o?.field),o)}function r(c,o,h){if(!c){const d=o.fixed??0;return{isAssumed:!!o.field?.length||!o.fixed,fixed:d,value:()=>d,get:()=>d}}const g=(0,t.AP)(c),l=o.max-o.min;if(c.values.length<1||l<=0||g.delta<=0)return{fixed:o.min,value:()=>o.min,get:()=>o.min};let m=d=>o.min+d*l;if(h===n.QH.Quad){const d=Math.PI*(o.max/2)**2,v=Math.PI*(o.min/2)**2,u=d-v;m=D=>{let P=v+u*D;return Math.sqrt(P/Math.PI)*2}}const y=d=>{const v=c.values[d];let u=0;return v!==-1/0&&(u=(v-g.min)/g.delta),u>1?u=1:u<0&&(u=0),m(u)};return{get:y,value:()=>y((0,i.sB)(c)),field:c}}function f(c){return c||(c={min:0,max:1}),c.min==null&&(c.min=0),c.max==null&&(c.max=1),c}function a(c,o){let{min:h,max:g}=f(o);if(c||(c={}),c.max==null&&(c.max=g),c.min==null&&(c.min=h),c.min>c.max){const l=c.max;c.max=c.min,c.min=l}return c.min<h&&(c.min=h),c.max>g&&(c.max=g),c.fixed==null&&(c.fixed=c.min+(c.max-c.min)/2),c.field||(c.fixed>g?c.fixed=g:c.fixed<h&&(c.fixed=h)),c}},80744:(G,O,e)=>{"use strict";e.d(O,{Iu:()=>i,Iy:()=>f,QC:()=>r,nG:()=>n,zu:()=>s});var t=e(52622);const n=Object.freeze({fixed:"",mode:t.RU.Field,field:""});var i=(a=>(a.Icon="img/icons/unicons",a.IOT="img/icons/iot",a.Marker="img/icons/marker",a.BG="img/bg",a))(i||{}),s=(a=>(a.Icon="icon",a.Image="image",a))(s||{}),r=(a=>(a.Folder="folder",a.URL="url",a.Upload="upload",a))(r||{}),f=(a=>(a.SMALL="small",a.NORMAL="normal",a))(f||{})},33924:(G,O,e)=>{"use strict";e.d(O,{B_:()=>o,UI:()=>g,Wb:()=>f,XV:()=>a,b5:()=>c,gG:()=>l,sB:()=>p,wv:()=>h});var t=e(28240),n=e(75059),i=e(32264),s=e(63577),r=e(26781);function f(m,y){if(m?.series&&y.field)for(const d of m.series){const v=(0,s.getColorDimension)(d,y,i.$.theme2);if(!v.isAssumed||m.series.length===1)return v}return(0,s.getColorDimension)(void 0,y,i.$.theme2)}function a(m,y){if(m?.series&&y.field)for(const d of m.series){const v=(0,s.getScaledDimension)(d,y);if(!v.isAssumed||m.series.length===1)return v}return(0,s.getScaledDimension)(void 0,y)}function c(m,y){if(m?.series&&y.field)for(const d of m.series){const v=(0,r.H)(d,y);if(!v.isAssumed||m.series.length===1)return v}return(0,r.H)(void 0,y)}function o(m,y){if(m?.series&&y.field)for(const d of m.series){const v=(0,s.getResourceDimension)(d,y);if(!v.isAssumed||m.series.length===1)return v}return(0,s.getResourceDimension)(void 0,y)}function h(m,y){if(m?.series&&y.field)for(const d of m.series){const v=(0,s.getTextDimension)(d,y);if(!v.isAssumed||m.series.length===1)return v}return(0,s.getTextDimension)(void 0,y)}function g(m,y){const d=l(y,m);return d==null?void 0:m.fields[d]}function l(m,y,d){if(!(!y||!m?.length))for(let v=0;v<y.fields.length;v++){const u=y.fields[v];if(m===u.name)return v;const D=(0,t.Ct)(u,y,d);if(m===D)return v}}function p(m){const y=m.state?.calcs;if(y){const u=y[n.gy.lastNotNull];if(u!=null)return u}const d=m.values;let v=d.length-1;for(;v>=0;){const u=d[v--];if(u!=null)return u}}},9791:(G,O,e)=>{"use strict";e.d(O,{k:()=>S});var t=e(74848),n=e(2543),i=e(96540),s=e(84596),r=e(39070),f=e(47232),a=e(28528),c=e(24293),o=e(90708),h=e(28240),g=e(94624),l=e(24308),p=e(52622),m=e(40845),y=e(79041),d=e(41706),v=e(91126),u=e(33368),D=e(1932);function P(I,T,b){return(0,D.jM)(I,R=>{R.defaults.custom===void 0&&(R.defaults.custom={}),R.defaults.max=b;const{custom:A}=R.defaults;switch(A.stacking===void 0&&(A.stacking={group:"A"}),T){case"lines":A.drawStyle=p.GR.Line,A.stacking.mode=p.gs.None,A.fillOpacity=0;break;case"bars":A.drawStyle=p.GR.Bars,A.stacking.mode=p.gs.None,A.fillOpacity=100;break;case"points":A.drawStyle=p.GR.Points,A.stacking.mode=p.gs.None,A.fillOpacity=0;break;case"stacked_lines":A.drawStyle=p.GR.Line,A.stacking.mode=p.gs.Normal,A.fillOpacity=100,A.axisSoftMin=0;break;case"stacked_bars":A.drawStyle=p.GR.Bars,A.stacking.mode=p.gs.Normal,A.fillOpacity=100,A.axisSoftMin=0;break;default:{const L=T;throw new Error(`Invalid graph-style: ${L}`)}}})}function x(I,T,b){return(0,D.jM)(I,R=>{R.defaults.thresholds=b,R.defaults.custom=R.defaults.custom??{},R.defaults.custom.thresholdsStyle=T})}var E=e(56737),C=e(21423);function M(I){const[T,{inc:b}]=(0,E.A)(1),R=(0,s.A)(I);return(0,i.useMemo)(()=>{R&&!(0,C.J3)(I,R,C.bW)&&b()},[I,R,b]),T}function S({data:I,height:T,width:b,timeZone:R,absoluteRange:A,onChangeTime:L,loadingState:U,annotations:W,onHiddenSeriesChanged:w,splitOpenFn:N,graphStyle:B,tooltipDisplayMode:V=p.$N.Single,anchorToZero:K=!1,yAxisMaximum:H,thresholdsConfig:X,thresholdsStyle:k,eventBus:Y,vizLegendOverrides:Z,toggleLegendRef:se}){const j=(0,m.$j)(),q=(0,s.A)(A),ne=U===r.Gu.Loading&&q?q:A,oe=(0,i.useMemo)(()=>({from:(0,f.KQ)(ne.from),to:(0,f.KQ)(ne.to),raw:{from:(0,f.KQ)(ne.from),to:(0,f.KQ)(ne.to)}}),[ne.from,ne.to]),z=(0,i.useMemo)(()=>(0,a.O)((0,d.V)(d.S),"Explore"),[]),[te,le]=(0,i.useState)({defaults:{min:K?0:void 0,max:H||void 0,unit:"short",color:{mode:c.Y.PaletteClassic},custom:{drawStyle:p.GR.Line,fillOpacity:0,pointSize:5}},overrides:[]}),ie=(0,i.useMemo)(()=>{const Te=P(te,B,H);return x(Te,k,X)},[te,B,H,X,k]),ae=(0,u.h)(N,oe),re=(0,i.useMemo)(()=>(0,o.we)({fieldConfig:ie,data:I,timeZone:R,replaceVariables:Te=>Te,theme:j,fieldConfigRegistry:z,dataLinkPostProcessor:ae}),[z,I,R,j,ie,ae]),ce=(0,i.useMemo)(()=>(0,o.we)({fieldConfig:{defaults:{},overrides:[]},data:W,timeZone:R,replaceVariables:Te=>Te,theme:j,dataLinkPostProcessor:ae}),[W,R,j,ae]),me=M(re),ee=(0,i.useRef)(w);(0,i.useEffect)(()=>{if(ee.current){const Te=[];re.forEach(je=>{je.fields.map(Be=>Be.config?.custom?.hideFrom?.viz).every(n.identity)&&Te.push((0,h.Ri)(je))}),ee.current(Te)}},[re]);const de={eventsScope:"explore",eventBus:Y,sync:()=>g.y.Off,onToggleSeriesVisibility(Te,je){le((0,v.M)(Te,je,te,I))},dataLinkPostProcessor:ae};function De(Te,je){le((0,v.M)(Te,je,te,I))}se&&(se.current=De);const fe=(0,i.useMemo)(()=>({tooltip:{mode:V,sort:p.xB.None},legend:{displayMode:p.lm.List,showLegend:!0,placement:"bottom",calcs:[],...Z}}),[V,Z]);return(0,t.jsx)(y.XF,{value:de,children:(0,t.jsx)(l.m,{data:{series:re,timeRange:oe,state:U,annotations:ce,structureRev:me},pluginId:"timeseries",title:"",width:b,height:T,onChangeTimeRange:L,timeZone:R,options:fe})})}},72519:(G,O,e)=>{"use strict";e.d(O,{y:()=>M});var t=e(74848),n=e(32196),i=e(96540),s=e(42941),r=e(40845),f=e(91052),a=e(14578),c=e(56034),o=e(55852),h=e(8484),g=e(34028),l=e(9791),p=e(94354),m=e(31678);const y=m.EXPLORE_GRAPH_STYLES.map(I=>({value:I,label:I[0].toUpperCase()+I.slice(1).replace(/_/," ")}));function d(I){const{graphStyle:T,onChangeGraphStyle:b}=I;return(0,t.jsx)(p.z,{size:"sm",options:y,value:T,onChange:b})}var v=e(33390);const u="grafana.explore.style.graph",D=I=>{store.set(u,I)},P=()=>E(v.A.get(u)),x="lines",E=I=>m.EXPLORE_GRAPH_STYLES.find(b=>b===I)??x,C=20,M=({data:I,eventBus:T,height:b,width:R,absoluteRange:A,timeZone:L,annotations:U,onChangeTime:W,splitOpenFn:w,thresholdsConfig:N,thresholdsStyle:B,loadingState:V,statusMessage:K})=>{const[H,X]=(0,s.A)(!1),[k,Y]=(0,i.useState)(P),Z=(0,r.of)(S),se=(0,i.useCallback)(q=>{(0,g.ng)(q),Y(q)},[]),j=(0,i.useMemo)(()=>H?I:I.slice(0,C),[I,H]);return(0,t.jsx)(f.NR,{title:(0,h.t)("graph.container.title","Graph"),titleItems:[!H&&C<I.length&&(0,t.jsxs)("div",{className:Z.timeSeriesDisclaimer,children:[(0,t.jsxs)("span",{className:Z.warningMessage,children:[(0,t.jsx)(a.I,{name:"exclamation-triangle","aria-hidden":"true"}),(0,t.jsxs)(h.x6,{i18nKey:"graph.container.show-only-series",children:["Showing only ",{MAX_NUMBER_OF_TIME_SERIES:C}," series"]})]}),(0,t.jsx)(c.m,{content:(0,h.t)("graph.container.content","Rendering too many series in a single panel may impact performance and make data harder to read. Consider refining your queries."),children:(0,t.jsx)(o.$n,{variant:"secondary",size:"sm",onClick:X,children:(0,t.jsxs)(h.x6,{i18nKey:"graph.container.show-all-series",children:["Show all ",{length:I.length}]})})})]},"disclaimer")].filter(Boolean),width:R,height:b,loadingState:V,statusMessage:K,actions:(0,t.jsx)(d,{graphStyle:k,onChangeGraphStyle:se}),children:(q,ne)=>(0,t.jsx)(l.k,{graphStyle:k,data:j,height:ne,width:q,absoluteRange:A,onChangeTime:W,timeZone:L,annotations:U,splitOpenFn:w,loadingState:V,thresholdsConfig:N,thresholdsStyle:B,eventBus:T})})},S=I=>({timeSeriesDisclaimer:(0,n.css)({label:"time-series-disclaimer",display:"flex",alignItems:"center",gap:I.spacing(1)}),warningMessage:(0,n.css)({display:"flex",alignItems:"center",gap:I.spacing(.5),color:I.colors.warning.main,fontSize:I.typography.bodySmall.fontSize})})},97186:(G,O,e)=>{"use strict";e.d(O,{$:()=>t,r:()=>n});const t={showLabels:"grafana.explore.logs.showLabels",showTime:"grafana.explore.logs.showTime",wrapLogMessage:"grafana.explore.logs.wrapLogMessage",prettifyLogMessage:"grafana.explore.logs.prettifyLogMessage",logsSortOrder:"grafana.explore.logs.sortOrder",logContextWrapLogMessage:"grafana.explore.logs.logContext.wrapLogMessage"},n="grafana.explore.logs.visualisationType"},9651:(G,O,e)=>{"use strict";e.d(O,{a:()=>a,d:()=>c});var t=e(74848),n=e(32196),i=e(75212),s=e(40845),r=e(9663);const f=(o,h)=>({valueNavigation:(0,n.css)`
      width: ${r.QH};
      font-weight: bold;
    `,valueNavigationWrapper:(0,n.css)`
      display: flex;
      justify-content: flex-end;
    `,itemLabelsWrap:(0,n.css)`
      ${h?"":`border-bottom: 1px solid ${o.colors.border.medium}`};
    `}),a=o=>o.includes(i.gs)?o.replace(i.gs,""):o,c=({valueLabels:o,expanded:h})=>{const g=(0,s.of)(f,h);return(0,t.jsx)("div",{className:g.itemLabelsWrap,children:(0,t.jsx)("div",{className:g.valueNavigationWrapper,children:o.map((l,p)=>(0,t.jsx)("span",{className:g.valueNavigation,children:a(l.name)},l.name))})})}},9663:(G,O,e)=>{"use strict";e.d(O,{Ay:()=>P,QH:()=>y,Jd:()=>d});var t=e(74848),n=e(32196),i=e(73287),s=e(14110),r=e(40845),f=e(29158),a=e(9651),c=e(57408);const o=(x,E)=>({rowWrapper:(0,n.css)`
    position: relative;
    min-width: ${y};
    padding-right: 5px;
  `,rowValue:(0,n.css)`
    white-space: nowrap;
    overflow-x: auto;
    -ms-overflow-style: none; /* IE and Edge */
    scrollbar-width: none; /* Firefox */
    display: block;
    padding-right: 10px;

    &::-webkit-scrollbar {
      display: none; /* Chrome, Safari and Opera */
    }

    &:before {
      pointer-events: none;
      content: '';
      width: 100%;
      height: 100%;
      position: absolute;
      left: 0;
      top: 0;
      background: linear-gradient(to right, transparent calc(100% - 25px), ${x.colors.background.primary});
    }
  `,rowValuesWrap:(0,n.css)`
    padding-left: ${d};
    width: calc(${E} * ${y});
    display: flex;
  `}),h=({totalNumberOfValues:x,values:E,hideFieldsWithoutValues:C})=>{const M=(0,r.of)(o,x);return(0,t.jsx)("div",{role:"cell",className:M.rowValuesWrap,children:E?.map(S=>C&&(S.value===void 0||S.value===c.M)?null:(0,t.jsx)("span",{className:M.rowWrapper,children:(0,t.jsx)("span",{className:M.rowValue,children:S.value})},S.key))})},g=x=>{const E=x.isDark?"#ce9178":"#a31515",C=x.isDark?"#73bf69":"#56a64b";return{metricName:(0,n.css)`
      color: ${C};
    `,metricValue:(0,n.css)`
      color: ${E};
    `,expanded:(0,n.css)`
      display: block;
      text-indent: 1em;
    `}},p=({value:x,index:E,length:C,isExpandedView:M})=>{const S=(0,r.of)(g),I=x.key,T=x.value;return(0,t.jsxs)("span",{className:M?S.expanded:"",children:[(0,t.jsx)("span",{className:S.metricName,children:I}),(0,t.jsx)("span",{children:"="}),(0,t.jsx)("span",{children:'"'}),(0,t.jsx)("span",{className:S.metricValue,children:T}),(0,t.jsx)("span",{children:'"'}),E<C-1&&(0,t.jsx)("span",{children:", "})]},E)},m="20px",y="80px",d="25px",v=(x,E,C)=>({rowWrapper:(0,n.css)`
    border-bottom: 1px solid ${x.colors.border.medium};
    display: flex;
    position: relative;
    padding-left: 22px;
    ${C?"":"align-items: center;"}
    ${C?"":"height: 100%;"}
  `,copyToClipboardWrapper:(0,n.css)`
    position: absolute;
    left: 0;
    ${C?"":"bottom: 0;"}
    ${C?"top: 4px;":"top: 0;"}
    margin: auto;
    z-index: 1;
    height: 16px;
    width: 16px;
  `,rowLabelWrapWrap:(0,n.css)`
    position: relative;
    width: calc(100% - (${E} * ${y}) - ${d});
  `,rowLabelWrap:(0,n.css)`
    white-space: nowrap;
    overflow-x: auto;
    -ms-overflow-style: none; /* IE and Edge */
    scrollbar-width: none; /* Firefox */
    padding-right: ${m};

    &::-webkit-scrollbar {
      display: none; /* Chrome, Safari and Opera */
    }

    &:after {
      pointer-events: none;
      content: '';
      width: 100%;
      height: 100%;
      position: absolute;
      left: 0;
      top: 0;
      background: linear-gradient(
        to right,
        transparent calc(100% - ${m}),
        ${x.colors.background.primary}
      );
    }
  `});function u(x){let E=[],C=[];for(const M in x)M in x&&x[M]&&!M.includes("Value")?E.push({key:M,value:x[M]}):M in x&&x[M]&&M.includes("Value")&&C.push({key:M,value:x[M]});return{values:C,attributeValues:E}}const P=({listItemData:x,listKey:E,totalNumberOfValues:C,valueLabels:M,isExpandedView:S})=>{const{__name__:I,...T}=x,[b,R]=(0,i.A)(),A=M?.length??C,L=(0,r.of)(v,A,S),{values:U,attributeValues:W}=u(T),w=V=>V==="\u221E"||V==="Infinity"?"+Inf":V,N=`${I}{${W.map(V=>`${V.key}="${w(V.value)}"`)}}`,B=!!(M&&M?.length);return(0,t.jsxs)(t.Fragment,{children:[M!==void 0&&S&&(0,t.jsx)(a.d,{valueLabels:M,expanded:S}),(0,t.jsxs)("div",{className:L.rowWrapper,children:[(0,t.jsx)("span",{className:L.copyToClipboardWrapper,children:(0,t.jsx)(f.K,{tooltip:"Copy to clipboard",onClick:()=>{(0,s.rR)("grafana_explore_prometheus_instant_query_ui_raw_toggle_expand"),R(N)},name:"copy"})}),(0,t.jsx)("span",{role:"cell",className:L.rowLabelWrapWrap,children:(0,t.jsxs)("div",{className:L.rowLabelWrap,children:[(0,t.jsx)("span",{children:I}),(0,t.jsx)("span",{children:"{"}),(0,t.jsx)("span",{children:W.map((V,K)=>(0,t.jsx)(p,{isExpandedView:S,value:V,index:K,length:W.length},K))}),(0,t.jsx)("span",{children:"}"})]})}),(0,t.jsx)(h,{hideFieldsWithoutValues:B,totalNumberOfValues:A,values:U})]},E)]})}},57408:(G,O,e)=>{"use strict";e.d(O,{E:()=>i,M:()=>n});var t=e(83195);const n=" ",i=s=>{const r={},f=[],a=s.fields.filter(h=>!["Time"].includes(h.name));let c=a.find(h=>h.name==="__name__")?.values??[];!c.length&&a.length&&a[0].values.length&&(c=Array(a[0].values.length).fill(""));const o=s.fields.filter(h=>!["__name__"].includes(h.name));return c.forEach(function(h,g){r[h]={};const l=r[h][g]??{};for(const p of o){const m=p.name;if(m!=="Time")if(typeof p?.display=="function"){const y=p?.display(p.values[g]);if(!isNaN(y.numeric))l[m]=y.numeric.toString(10);else{const d=(0,t.cN)(y);d?l[m]=d:m.includes("Value #")&&(l[m]=n)}}else console.warn("Field display method is missing!")}f.push({...l,__name__:h})}),f}},97814:(G,O,e)=>{"use strict";e.d(O,{g:()=>i});var t=e(74848),n=e(47232);const i=({timeInMs:r,className:f,humanize:a})=>(0,t.jsx)("span",{className:f,children:s(r,a)}),s=(r,f=!1)=>{const a=r/1e3;if(!f)return`${a.toFixed(1)}s`;const c=(0,n.Ah)(a,"seconds"),o=c.hours(),h=c.minutes(),g=c.seconds();return o?`${o}h ${h}m ${g}s`:h?`${h}m ${g}s`:`${g}s`}},92599:(G,O,e)=>{"use strict";e.d(O,{V:()=>ve});var t=e(74848),n=e(32196),i=e(96540),s=e(42941),r=e(41987),f=e(6709);function a(he){if(he?.tracesToLogsV2)return he.tracesToLogsV2;if(!he?.tracesToLogs)return;const ye={customQuery:!1};return ye.datasourceUid=he.tracesToLogs.datasourceUid,ye.tags=he.tracesToLogs.mapTagNamesEnabled?he.tracesToLogs.mappedTags:he.tracesToLogs.tags?.map(Pe=>({key:Pe})),ye.filterByTraceID=he.tracesToLogs.filterByTraceID,ye.filterBySpanID=he.tracesToLogs.filterBySpanID,ye.spanStartTimeShift=he.tracesToLogs.spanStartTimeShift,ye.spanEndTimeShift=he.tracesToLogs.spanEndTimeShift,ye}function c({options:he,onOptionsChange:ye}){const Pe=["loki","elasticsearch","grafana-splunk-datasource","grafana-opensearch-datasource","grafana-falconlogscale-datasource","googlecloud-logging-datasource"],ge=useMemo(()=>a(he.jsonData)||{customQuery:!1},[he.jsonData]),{query:xe="",tags:Ae,customQuery:Ee}=ge,Ie=useCallback(Qe=>{ye({...he,jsonData:{...he.jsonData,tracesToLogsV2:{...ge,...Qe},tracesToLogs:void 0}})},[ye,he,ge]);return jsxs("div",{className:css({width:"100%"}),children:[jsx(InlineFieldRow,{children:jsx(InlineField,{tooltip:"The logs data source the trace is going to navigate to",label:"Data source",labelWidth:26,children:jsx(DataSourcePicker,{inputId:"trace-to-logs-data-source-picker",filter:Qe=>Pe.includes(Qe.type),current:ge.datasourceUid,noDefault:!0,width:40,onChange:Qe=>Ie({datasourceUid:Qe.uid})})})}),jsx(InlineFieldRow,{children:jsx(IntervalInput,{label:h("start"),tooltip:g("start","0"),value:ge.spanStartTimeShift||"",onChange:Qe=>{Ie({spanStartTimeShift:Qe})},isInvalidError:l})}),jsx(InlineFieldRow,{children:jsx(IntervalInput,{label:h("end"),tooltip:g("end","0"),value:ge.spanEndTimeShift||"",onChange:Qe=>{Ie({spanEndTimeShift:Qe})},isInvalidError:l})}),jsx(InlineFieldRow,{children:jsx(InlineField,{tooltip:"Tags that will be used in the query. Default tags: 'cluster', 'hostname', 'namespace', 'pod', 'service.name', 'service.namespace'",label:"Tags",labelWidth:26,children:jsx(TagMappingInput,{values:Ae??[],onChange:Qe=>Ie({tags:Qe})})})}),jsx(o,{disabled:Ee,type:"trace",id:"filterByTraceID",value:!!ge.filterByTraceID,onChange:Qe=>Ie({filterByTraceID:Qe})}),jsx(o,{disabled:Ee,type:"span",id:"filterBySpanID",value:!!ge.filterBySpanID,onChange:Qe=>Ie({filterBySpanID:Qe})}),jsx(InlineFieldRow,{children:jsx(InlineField,{tooltip:"Use a custom query with the possibility to interpolate variables from the trace or span",label:"Use custom query",labelWidth:26,children:jsx(InlineSwitch,{id:"customQuerySwitch",value:Ee,onChange:Qe=>Ie({customQuery:Qe.currentTarget.checked})})})}),Ee&&jsx(InlineField,{label:"Query",labelWidth:26,tooltip:"The query that will run when navigating from a trace to logs data source. Interpolate tags using the `$__tags` keyword",grow:!0,children:jsx(Input,{label:"Query",type:"text",allowFullScreen:!0,value:xe,onChange:Qe=>Ie({query:Qe.currentTarget.value})})})]})}function o(he){return jsx(InlineFieldRow,{children:jsx(InlineField,{disabled:he.disabled,label:`Filter by ${he.type} ID`,labelWidth:26,grow:!0,tooltip:`Filters logs by ${he.type} ID, where the ${he.type} ID should be part of the log line`,children:jsx(InlineSwitch,{id:he.id,value:he.value,onChange:ye=>he.onChange(ye.currentTarget.checked)})})})}const h=he=>`Span ${he} time shift`,g=(he,ye)=>`Shifts the ${he} time of the span. Default: ${ye} (Time units can be used here, for example: 5s, -1m, 3h)`,l="Invalid time shift. See tooltip for examples.",p=({options:he,onOptionsChange:ye})=>{let Pe=he.type;return Pe+=he.type==="tempo"?"/configure-tempo-data-source/#trace-to-logs":"/#trace-to-logs",jsx(ConfigSection,{title:"Trace to logs",description:jsx(ConfigDescriptionLink,{description:"Navigate from a trace span to the selected data source's logs.",suffix:Pe,feature:"trace to logs"}),isCollapsible:!0,isInitiallyOpen:!0,children:jsx(c,{options:he,onOptionsChange:ye})})};var m=e(72574),y=e(40845),d=e(31193),v=e(32901),u=e(31678),D=e(62256),P=e(56271),x=e(41811);const C=(he,ye,Pe)=>{let ge;return Pe?ge=ye?.childSpanIds.find(xe=>he.has(xe)&&he.get(xe).startTime+he.get(xe).duration<Pe):ge=ye.childSpanIds[0],ge?he.get(ge):void 0},S=he=>{const ye=[],Pe=[];he.forEach(Ae=>{if(Ae.references[0]?.refType==="FOLLOWS_FROM"){ye.push(Ae.spanID);const Ee=he.get(Ae.references[0].spanID);Ee.childSpanIds=Ee.childSpanIds.filter(Ie=>Ie!==Ae.spanID),he.set(Ee.spanID,{...Ee})}});const ge=Ae=>{Ae.forEach(Ee=>{const Ie=he.get(Ee);Ie.hasChildren&&(Pe.push(...Ie.childSpanIds),ge(Ie.childSpanIds))})};return ge(ye),[...ye,...Pe].forEach(Ae=>he.delete(Ae)),he},T=he=>{let ye=[...he.keys()];return ye.forEach(Pe=>{const ge=he.get(Pe);if(!(ge&&ge.references.length&&ge.depth))return;const xe=he.get(ge.references[0].spanID);if(!xe){he.delete(ge.spanID);return}const Ae=ge.startTime+ge.duration,Ee=xe.startTime+xe.duration;if(ge.startTime>=xe.startTime){if(ge.startTime>=Ee){he.delete(ge.spanID),xe.childSpanIds=xe.childSpanIds.filter(Ie=>Ie!==ge.spanID);return}if(Ae>Ee){he.set(ge.spanID,{...ge,duration:Ee-ge.startTime});return}return}Ae<=xe.startTime?(he.delete(ge.spanID),xe.childSpanIds=xe.childSpanIds.filter(Ie=>Ie!==ge.spanID)):Ae<=Ee?he.set(ge.spanID,{...ge,startTime:xe.startTime,duration:Ae-xe.startTime}):he.set(ge.spanID,{...ge,startTime:xe.startTime,duration:Ee-xe.startTime})}),ye=[...he.keys()],ye.forEach(Pe=>{const ge=he.get(Pe);if(ge.references.length){const xe=he.get(ge.references[0].spanID);ge.references[0].span=xe,he.set(Pe,{...ge})}}),he},b=(he,ye,Pe,ge)=>{const xe=he.get(ye);if(!xe)return Pe;const Ae=C(he,xe,ge);let Ee;if(Ae)Ee={spanId:xe.spanID,section_start:Ae.startTime+Ae.duration,section_end:ge||xe.startTime+xe.duration},Ee.section_start!==Ee.section_end&&Pe.push(Ee),b(he,Ae.spanID,Pe);else if(Ee={spanId:xe.spanID,section_start:xe.startTime,section_end:ge||xe.startTime+xe.duration},Ee.section_start!==Ee.section_end&&Pe.push(Ee),xe.references.length){const Ie=xe.references.filter(Qe=>Qe.refType==="CHILD_OF")[0].spanID;b(he,Ie,Pe,xe.startTime)}return Pe};function R(he){let ye=[];const Pe=he?.spans[0].spanID;if(Pe){const ge=he.spans.reduce((xe,Ae)=>(xe.set(Ae.spanID,Ae),xe),new Map);try{const xe=S(ge),Ae=T(xe);ye=b(Ae,Pe,ye)}catch(xe){console.log("error while computing critical path for a trace",xe)}}return ye}const L=(0,x.A)(R);var U=e(3911),W=e(71656),w=e(30700);const N=.8,B=2,V=200,K=10,H=60,X=6;function k(he,ye,Pe,ge,xe){const Ae=new Map,Ee=ye.length<H?H:Math.min(ye.length,V),Ie=window.innerWidth*2;he.width=Ie,he.height=Ee;const Qe=Math.min(X,Math.max(B,Ee/ye.length)),at=Ee/ye.length,ft=he.getContext("2d",{alpha:!1});if(ft){ft.fillStyle=xe,ft.fillRect(0,0,Ie,Ee);for(let ct=0;ct<ye.length;ct++){const{valueWidth:vt,valueOffset:Pt,serviceName:Vt}=ye[ct],Jt=Pt/Pe*Ie;let wt=vt/Pe*Ie;wt<K&&(wt=K);let zt=Ae.get(Vt);zt||(zt=`rgba(${ge(Vt).concat(N).join()})`,Ae.set(Vt,zt)),ft.fillStyle=zt,ft.fillRect(Jt,ct*at,wt,Qe)}}}const Y=(0,U.N)(he=>({CanvasSpanGraph:(0,n.css)`
      label: CanvasSpanGraph;
      background: ${(0,W.R)(he,"#fafafa")};
      height: 60px;
      position: absolute;
      width: 100%;
    `}));class Z extends i.PureComponent{constructor(ye){super(ye),this.getColor=Pe=>(0,w.rY)(Pe,this.props.theme),this._setCanvasRef=Pe=>{this._canvasElm=Pe},this._canvasElm=void 0}componentDidMount(){this._draw()}componentDidUpdate(){this._draw()}_draw(){if(this._canvasElm){const{valueWidth:ye,items:Pe}=this.props;k(this._canvasElm,Pe,ye,this.getColor,(0,W.R)(this.props.theme,"#fff"))}}render(){return(0,t.jsx)("canvas",{className:Y(this.props.theme).CanvasSpanGraph,ref:this._setCanvasRef,"data-testid":"CanvasSpanGraph"})}}const se=(0,y.cV)(Z);var j=e(6389);const q=()=>({TickLabels:(0,n.css)`
      label: TickLabels;
      height: 1rem;
      position: relative;
    `,TickLabelsLabel:(0,n.css)`
      label: TickLabelsLabel;
      color: #717171;
      font-size: 0.7rem;
      position: absolute;
      user-select: none;
    `});function ne(he){const{numTicks:ye,duration:Pe}=he,ge=(0,y.of)(q),xe=[];for(let Ae=0;Ae<ye+1;Ae++){const Ee=Ae/ye,Ie=Ee===1?{right:"0%"}:{left:`${Ee*100}%`};xe.push((0,t.jsx)("div",{className:ge.TickLabelsLabel,style:Ie,"data-testid":"tick",children:(0,j.a3)(Pe*Ee)},Ee))}return(0,t.jsx)("div",{className:ge.TickLabels,"data-testid":"TickLabels",children:xe})}var oe=e(46942),z=e.n(oe),te=e(55852),le=e(92151);const ie=()=>({GraphTick:(0,n.css)`
      label: GraphTick;
      stroke: #aaa;
      stroke-width: 1px;
    `});function ae(he){const{numTicks:ye}=he,Pe=(0,y.of)(ie),ge=[];for(let xe=1;xe<ye;xe++){const Ae=`${xe/ye*100}%`;ge.push((0,t.jsx)("line",{className:Pe.GraphTick,x1:Ae,y1:"0%",x2:Ae,y2:"100%"},xe/ye))}return(0,t.jsx)("g",{"data-testid":"ticks","aria-hidden":"true",children:ge})}const re=()=>({ScrubberHandleExpansion:z()((0,n.css)`
        label: ScrubberHandleExpansion;
        cursor: col-resize;
        fill-opacity: 0;
        fill: #44f;
      `,"scrubber-handle-expansion"),ScrubberHandle:z()((0,n.css)`
        label: ScrubberHandle;
        cursor: col-resize;
        fill: #555;
      `,"scrubber-handle"),ScrubberLine:z()((0,n.css)`
        label: ScrubberLine;
        pointer-events: none;
        stroke: #555;
      `,"scrubber-line"),ScrubberDragging:(0,n.css)`
      label: ScrubberDragging;
      & .scrubber-handle-expansion {
        fill-opacity: 1;
      }
      & .scrubber-handle {
        fill: #44f;
      }
      & > .scrubber-line {
        stroke: #44f;
      }
    `,ScrubberHandles:(0,n.css)`
      label: ScrubberHandles;
      &:hover > .scrubber-handle-expansion {
        fill-opacity: 1;
      }
      &:hover > .scrubber-handle {
        fill: #44f;
      }
      &:hover + .scrubber.line {
        stroke: #44f;
      }
    `});function ce({isDragging:he,onMouseDown:ye,onMouseEnter:Pe,onMouseLeave:ge,position:xe}){const Ae=`${xe*100}%`,Ee=(0,y.of)(re),Ie=z()({[Ee.ScrubberDragging]:he});return(0,t.jsxs)("g",{className:Ie,"data-testid":"scrubber-component",children:[(0,t.jsxs)("g",{"data-testid":"scrubber-component-g",className:Ee.ScrubberHandles,onMouseDown:ye,onMouseEnter:Pe,onMouseLeave:ge,children:[(0,t.jsx)("rect",{"data-testid":"scrubber-component-rect-1",x:Ae,className:Ee.ScrubberHandleExpansion,style:{transform:"translate(-4.5px)"},width:"9",height:"20"}),(0,t.jsx)("rect",{"data-testid":"scrubber-component-rect-2",x:Ae,className:Ee.ScrubberHandle,style:{transform:"translate(-1.5px)"},width:"3",height:"20"})]}),(0,t.jsx)("line",{className:Ee.ScrubberLine,y2:"100%",x1:Ae,x2:Ae,"data-testid":"scrubber-component-line"})]})}const me=(0,U.N)(he=>{const ye="JaegerUiComponents__ViewingLayerResetZoomHoverClassName",Pe=(0,n.css)`
    label: ViewingLayerResetZoom;
    display: none;
    position: absolute;
    right: 1%;
    top: 10%;
    z-index: 1;
  `;return{ViewingLayer:(0,n.css)`
      label: ViewingLayer;
      cursor: vertical-text;
      position: relative;
      z-index: 1;
      &:hover > .${ye} {
        display: unset;
      }
    `,ViewingLayerGraph:(0,n.css)`
      label: ViewingLayerGraph;
      border: 1px solid ${(0,W.R)(he,"#999")};
      /* need !important here to overcome something from semantic UI */
      overflow: visible !important;
      position: relative;
      transform-origin: 0 0;
      width: 100%;
    `,ViewingLayerInactive:(0,n.css)`
      label: ViewingLayerInactive;
      fill: ${(0,W.R)(he,"rgba(214, 214, 214, 0.5)")};
    `,ViewingLayerCursorGuide:(0,n.css)`
      label: ViewingLayerCursorGuide;
      stroke: ${(0,W.R)(he,"#f44")};
      stroke-width: 1;
    `,ViewingLayerDraggedShift:(0,n.css)`
      label: ViewingLayerDraggedShift;
      fill-opacity: 0.2;
    `,ViewingLayerDrag:(0,n.css)`
      label: ViewingLayerDrag;
      fill: ${(0,W.R)(he,"#44f")};
    `,ViewingLayerFullOverlay:(0,n.css)`
      label: ViewingLayerFullOverlay;
      bottom: 0;
      cursor: col-resize;
      left: 0;
      position: fixed;
      right: 0;
      top: 0;
      user-select: none;
    `,ViewingLayerResetZoom:Pe,ViewingLayerResetZoomHoverClassName:ye}}),ee={SHIFT_END:"SHIFT_END",SHIFT_START:"SHIFT_START",REFRAME:"REFRAME"};function de(he,ye){const[Pe,ge]=he<ye?[he,ye]:[ye,he];return{x:`${Pe*100}%`,width:`${(ge-Pe)*100}%`,leadingX:`${ye*100}%`}}class De extends i.PureComponent{constructor(ye){super(ye),this._setRoot=Pe=>{this._root=Pe},this._getDraggingBounds=Pe=>{if(!this._root)throw new Error("invalid state");const{left:ge,width:xe}=this._root.getBoundingClientRect(),[Ae,Ee]=this.props.viewRange.time.current;let Ie=1,Qe=0;return Pe===ee.SHIFT_START?Ie=Ee:Pe===ee.SHIFT_END&&(Qe=Ae),{clientXLeft:ge,maxValue:Ie,minValue:Qe,width:xe}},this._handleReframeMouseMove=({value:Pe})=>{this.props.updateNextViewRangeTime({cursor:Pe})},this._handleReframeMouseLeave=()=>{this._draggerReframe.resetBounds(),this.props.updateNextViewRangeTime({cursor:null})},this._handleReframeDragUpdate=({value:Pe})=>{const ge=Pe,{time:xe}=this.props.viewRange,Ee={reframe:{anchor:xe.reframe?xe.reframe.anchor:ge,shift:ge}};this.props.updateNextViewRangeTime(Ee)},this._handleReframeDragEnd=({manager:Pe,value:ge})=>{const{time:xe}=this.props.viewRange,Ae=xe.reframe?xe.reframe.anchor:ge,[Ee,Ie]=ge<Ae?[ge,Ae]:[Ae,ge];Pe.resetBounds(),this.props.updateViewRangeTime(Ee,Ie,"minimap")},this._handleScrubberEnterLeave=({type:Pe})=>{const ge=Pe===le.EUpdateTypes.MouseEnter;this.setState({preventCursorLine:ge})},this._handleScrubberDragUpdate=({event:Pe,tag:ge,type:xe,value:Ae})=>{xe===le.EUpdateTypes.DragStart&&Pe.stopPropagation(),ge===ee.SHIFT_START?this.props.updateNextViewRangeTime({shiftStart:Ae}):ge===ee.SHIFT_END&&this.props.updateNextViewRangeTime({shiftEnd:Ae})},this._handleScrubberDragEnd=({manager:Pe,tag:ge,value:xe})=>{const[Ae,Ee]=this.props.viewRange.time.current;let Ie;if(ge===ee.SHIFT_START)Ie=[xe,Ee];else if(ge===ee.SHIFT_END)Ie=[Ae,xe];else throw new Error("bad state");Pe.resetBounds(),this.setState({preventCursorLine:!1}),this.props.updateViewRangeTime(Ie[0],Ie[1],"minimap")},this._resetTimeZoomClickHandler=()=>{this.props.updateViewRangeTime(0,1)},this._draggerReframe=new le.default({getBounds:this._getDraggingBounds,onDragEnd:this._handleReframeDragEnd,onDragMove:this._handleReframeDragUpdate,onDragStart:this._handleReframeDragUpdate,onMouseMove:this._handleReframeMouseMove,onMouseLeave:this._handleReframeMouseLeave,tag:ee.REFRAME}),this._draggerStart=new le.default({getBounds:this._getDraggingBounds,onDragEnd:this._handleScrubberDragEnd,onDragMove:this._handleScrubberDragUpdate,onDragStart:this._handleScrubberDragUpdate,onMouseEnter:this._handleScrubberEnterLeave,onMouseLeave:this._handleScrubberEnterLeave,tag:ee.SHIFT_START}),this._draggerEnd=new le.default({getBounds:this._getDraggingBounds,onDragEnd:this._handleScrubberDragEnd,onDragMove:this._handleScrubberDragUpdate,onDragStart:this._handleScrubberDragUpdate,onMouseEnter:this._handleScrubberEnterLeave,onMouseLeave:this._handleScrubberEnterLeave,tag:ee.SHIFT_END}),this._root=void 0,this.state={preventCursorLine:!1}}componentWillUnmount(){this._draggerReframe.dispose(),this._draggerEnd.dispose(),this._draggerStart.dispose()}_getMarkers(ye,Pe){const ge=me(this.props.theme),xe=de(ye,Pe);return[(0,t.jsx)("rect",{className:z()(ge.ViewingLayerDraggedShift,ge.ViewingLayerDrag),x:xe.x,y:"0",width:xe.width,height:this.props.height-2},"fill"),(0,t.jsx)("rect",{className:z()(ge.ViewingLayerDrag),x:xe.leadingX,y:"0",width:"1",height:this.props.height-2},"edge")]}render(){const{height:ye,viewRange:Pe,numTicks:ge,theme:xe}=this.props,{preventCursorLine:Ae}=this.state,{current:Ee,cursor:Ie,shiftStart:Qe,shiftEnd:at,reframe:ft}=Pe.time,ct=Qe!=null||at!=null||ft!=null,[vt,Pt]=Ee;let Vt=0;vt&&(Vt=vt*100);let Jt=100;Pt&&(Jt=100-Pt*100);let wt;!ct&&Ie!=null&&!Ae&&(wt=`${Ie*100}%`);const zt=me(xe);return(0,t.jsxs)("div",{"aria-hidden":!0,className:zt.ViewingLayer,style:{height:ye},children:[(vt!==0||Pt!==1)&&(0,t.jsx)(te.$n,{onClick:this._resetTimeZoomClickHandler,className:z()(zt.ViewingLayerResetZoom,zt.ViewingLayerResetZoomHoverClassName),type:"button",variant:"secondary",children:"Reset Selection"}),(0,t.jsxs)("svg",{height:ye,className:zt.ViewingLayerGraph,ref:this._setRoot,onMouseDown:this._draggerReframe.handleMouseDown,onMouseLeave:this._draggerReframe.handleMouseLeave,onMouseMove:this._draggerReframe.handleMouseMove,children:[Vt>0&&(0,t.jsx)("rect",{x:0,y:0,height:"100%",width:`${Vt}%`,className:zt.ViewingLayerInactive,"data-testid":"left-ViewingLayerInactive"}),Jt>0&&(0,t.jsx)("rect",{x:`${100-Jt}%`,y:0,height:"100%",width:`${Jt}%`,className:zt.ViewingLayerInactive,"data-testid":"right-ViewingLayerInactive"}),(0,t.jsx)(ae,{numTicks:ge}),wt&&(0,t.jsx)("line",{className:zt.ViewingLayerCursorGuide,x1:wt,y1:"0",x2:wt,y2:ye-2,strokeWidth:"1","data-testid":"ViewingLayerCursorGuide"}),Qe!=null&&this._getMarkers(vt,Qe),at!=null&&this._getMarkers(Pt,at),(0,t.jsx)(ce,{isDragging:Qe!=null,onMouseDown:this._draggerStart.handleMouseDown,onMouseEnter:this._draggerStart.handleMouseEnter,onMouseLeave:this._draggerStart.handleMouseLeave,position:vt||0}),(0,t.jsx)(ce,{isDragging:at!=null,position:Pt||1,onMouseDown:this._draggerEnd.handleMouseDown,onMouseEnter:this._draggerEnd.handleMouseEnter,onMouseLeave:this._draggerEnd.handleMouseLeave}),ft!=null&&this._getMarkers(ft.anchor,ft.shift)]}),ct&&(0,t.jsx)("div",{className:zt.ViewingLayerFullOverlay})]})}}const fe=(0,y.cV)(De),Te=()=>({container:(0,n.css)({padding:"0 0.5rem 0.5rem 0.5rem"}),canvasContainer:(0,n.css)({position:"relative"})}),je=60,He=4;function Be(he){return{valueOffset:he.relativeStartTime,valueWidth:he.duration,serviceName:he.process.serviceName}}function Ne(he){return he.spans.map(Be)}const Re=(0,x.A)(Ne);class Se extends i.PureComponent{static{this.defaultProps={height:je}}render(){const{height:ye,trace:Pe,viewRange:ge,updateNextViewRangeTime:xe,updateViewRangeTime:Ae}=this.props,Ee=Te();if(!Pe)return(0,t.jsx)("div",{});const Ie=Re(Pe);return(0,t.jsxs)("div",{className:Ee.container,children:[(0,t.jsx)(ne,{numTicks:He,duration:Pe.duration}),(0,t.jsxs)("div",{className:Ee.canvasContainer,children:[(0,t.jsx)(se,{valueWidth:Pe.duration,items:Ie}),(0,t.jsx)(fe,{viewRange:ge,numTicks:He,height:ye||je,updateViewRangeTime:Ae,updateNextViewRangeTime:xe})]})]})}}var We=e(28114);function Ke(){const[he,ye]=(0,i.useState)(new Set),Pe=(0,i.useCallback)(function(Qe){if(he.size===0)return;let at=-1,ft=!0;const ct=Qe.reduce((vt,Pt)=>(Pt.depth<=at&&(ft=!0),ft&&vt.has(Pt.spanID)&&(vt.delete(Pt.spanID),ft=!1,at=Pt.depth),vt),new Set(he));ye(ct)},[he]),ge=(0,i.useCallback)(function(Qe){if(Xe(Qe,he))return;let at;const ft=Qe.reduce((ct,vt)=>(at&&vt.depth<=at.depth?(ct.add(at.spanID),vt.hasChildren&&(at=vt)):vt.hasChildren&&!ct.has(vt.spanID)&&(at=vt),ct),new Set(he));at&&ft.add(at.spanID),ye(ft)},[he]),xe=(0,i.useCallback)(function(){ye(new Set)},[]),Ae=(0,i.useCallback)(function(Qe){if(Xe(Qe,he))return;const at=Qe.reduce((ft,ct)=>(ct.hasChildren&&ft.add(ct.spanID),ft),new Set);ye(at)},[he]),Ee=(0,i.useCallback)(function(Qe){const at=new Set(he);he.has(Qe)?at.delete(Qe):at.add(Qe),ye(at)},[he]);return{childrenHiddenIDs:he,expandOne:Pe,collapseOne:ge,expandAll:xe,collapseAll:Ae,childrenToggle:Ee}}function Xe(he,ye){return he.filter(ge=>ge.hasChildren).length===ye.size}function Je(he){const[ye,Pe]=(0,i.useState)(new Map);(0,i.useEffect)(()=>{Pe(new Map)},[he,Pe]);const ge=(0,i.useCallback)(function(Ie){const Qe=new Map(ye);Qe.has(Ie)?Qe.delete(Ie):Qe.set(Ie,new P.DetailState),Pe(Qe)},[ye]),xe=(0,i.useCallback)(function(Ie,Qe){const at=ye.get(Ie);if(!at)return;const ft=at.toggleLogItem(Qe),ct=new Map(ye);return ct.set(Ie,ft),Pe(ct)},[ye]),Ae=(0,i.useCallback)(function(Ie,Qe){const at=ye.get(Ie);if(!at)return;const ft=at.toggleReferenceItem(Qe),ct=new Map(ye);return ct.set(Ie,ft),Pe(ct)},[ye]);return{detailStates:ye,toggleDetail:ge,detailLogItemToggle:xe,detailLogsToggle:(0,i.useCallback)(Ee=>st("logs",ye,Pe)(Ee),[ye]),detailWarningsToggle:(0,i.useCallback)(Ee=>st("warnings",ye,Pe)(Ee),[ye]),detailStackTracesToggle:(0,i.useCallback)(Ee=>st("stackTraces",ye,Pe)(Ee),[ye]),detailReferenceItemToggle:Ae,detailReferencesToggle:(0,i.useCallback)(Ee=>st("references",ye,Pe)(Ee),[ye]),detailProcessToggle:(0,i.useCallback)(Ee=>st("process",ye,Pe)(Ee),[ye]),detailTagsToggle:(0,i.useCallback)(Ee=>st("tags",ye,Pe)(Ee),[ye])}}function st(he,ye,Pe){return ge=>{const xe=ye.get(ge);if(!xe)return;let Ae;he==="tags"?Ae=xe.toggleTags():he==="process"?Ae=xe.toggleProcess():he==="warnings"?Ae=xe.toggleWarnings():he==="references"?Ae=xe.toggleReferences():he==="stackTraces"?Ae=xe.toggleStackTraces():Ae=xe.toggleLogs();const Ee=new Map(ye);Ee.set(ge,Ae),Pe(Ee)}}function pt(){const[he,ye]=(0,i.useState)(new Set),Pe=(0,i.useCallback)(function(Ae){ye(Ee=>{const Ie=new Set(Ee);return Ie.add(Ae),Ie})},[]),ge=(0,i.useCallback)(function(Ae){ye(Ee=>{const Ie=new Set(Ee);return Ie.delete(Ae),Ie})},[]);return{hoverIndentGuideIds:he,addHoverIndentGuideId:Pe,removeHoverIndentGuideId:ge}}var xt=e(15583);function ot(){const[he,ye]=(0,i.useState)({time:{current:[0,1]}}),Pe=(0,i.useCallback)(function(Ae){ye(Ee=>{const Ie={...Ee.time,...Ae};return{...Ee,time:Ie}})},[]),ge=(0,i.useCallback)(function(Ae,Ee){const Qe={current:[Ae,Ee]};ye(at=>({...at,time:Qe}))},[]);return{viewRange:he,updateViewRangeTime:ge,updateNextViewRangeTime:Pe}}const $e=he=>({noDataMsg:(0,n.css)`
    height: 100%;
    width: 100%;
    display: grid;
    place-items: center;
    font-size: ${he.typography.h4.fontSize};
    color: ${he.colors.text.secondary};
  `});function ve(he){const{traceProp:ye,datasource:Pe,topOfViewRef:ge,exploreId:xe,createSpanLink:Ae,focusedSpanId:Ee,createFocusSpanLink:Ie}=he,{detailStates:Qe,toggleDetail:at,detailLogItemToggle:ft,detailLogsToggle:ct,detailProcessToggle:vt,detailReferencesToggle:Pt,detailReferenceItemToggle:Vt,detailTagsToggle:Jt,detailWarningsToggle:wt,detailStackTracesToggle:zt}=Je(he.dataFrames[0]),{removeHoverIndentGuideId:on,addHoverIndentGuideId:Pn,hoverIndentGuideIds:_n}=pt(),{viewRange:Cn,updateViewRangeTime:Ye,updateNextViewRangeTime:Dt}=ot(),{expandOne:yt,collapseOne:Ft,childrenToggle:an,collapseAll:un,childrenHiddenIDs:hn,expandAll:Un}=Ke(),{search:Nn,setSearch:St,spanFilterMatches:nn}=(0,xt.SQ)(ye?.spans),[ht,lt]=(0,i.useState)(""),[gt,$t]=(0,s.A)(!1),[et,Et]=(0,i.useState)(!1),[It,Qt]=(0,i.useState)(!1),[sn,ln]=(0,i.useState)(100),[yn,Sn]=(0,i.useState)({}),[En,wn]=(0,i.useState)({}),On=(0,y.of)($e),[Rt,Ot]=(0,i.useState)(.4),[jt,rt]=be({refId:he.dataFrames[0]?.refId,exploreId:he.exploreId,datasource:Pe,splitOpenFn:he.splitOpenFn}),tn=Ee??jt,Mn=Ie??rt,kn=(0,i.useMemo)(()=>({childrenHiddenIDs:hn,detailStates:Qe,hoverIndentGuideIds:_n,spanNameColumnWidth:Rt,traceID:he.traceProp?.traceID}),[hn,Qe,_n,Rt,he.traceProp?.traceID]),Yn=(0,d.tR)().getInstanceSettings(Pe?.name),Wn=a(Yn?.jsonData),Ls=Yn?.jsonData?.tracesToMetrics,ys=Yn?.jsonData?.tracesToProfiles,Xn=Yn?.jsonData,Ps=(0,i.useMemo)(()=>Ae??(0,We.lU)({splitOpenFn:he.splitOpenFn,traceToLogsOptions:Wn,traceToMetricsOptions:Ls,traceToProfilesOptions:ys,dataFrame:he.dataFrames[0],createFocusSpanLink:Mn,trace:ye}),[he.splitOpenFn,Wn,Ls,ys,he.dataFrames,Mn,ye,Ae]),Zs=(0,u.useSelector)(Xa=>(0,v.O)(Xa.user)),Ms=Pe?Pe?.type:"unknown",ks=he.scrollElement?he.scrollElement:document.getElementsByClassName(he.scrollElementClass??"")[0],wa=L(ye);return(0,t.jsx)(t.Fragment,{children:he.dataFrames?.length&&ye?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(P.TracePageHeader,{trace:ye,data:he.dataFrames[0],timeZone:Zs,search:Nn,setSearch:St,showSpanFilters:gt,setShowSpanFilters:$t,showSpanFilterMatchesOnly:et,setShowSpanFilterMatchesOnly:Et,showCriticalPathSpansOnly:It,setShowCriticalPathSpansOnly:Qt,setFocusedSpanIdForSearch:lt,spanFilterMatches:nn,datasourceType:Ms,setHeaderHeight:ln,app:xe?r.Jk.Explore:r.Jk.Unknown}),(0,t.jsx)(Se,{trace:ye,viewRange:Cn,updateNextViewRangeTime:Dt,updateViewRangeTime:Ye}),(0,t.jsx)(P.TraceTimelineViewer,{findMatchesIDs:nn,trace:ye,traceToProfilesOptions:ys,datasourceType:Ms,spanBarOptions:Xn?.spanBar,traceTimeline:kn,updateNextViewRangeTime:Dt,updateViewRangeTime:Ye,viewRange:Cn,timeZone:Zs,setSpanNameColumnWidth:Ot,collapseAll:un,collapseOne:Ft,expandAll:Un,expandOne:yt,childrenToggle:an,detailLogItemToggle:ft,detailLogsToggle:ct,detailWarningsToggle:wt,detailStackTracesToggle:zt,detailReferencesToggle:Pt,detailReferenceItemToggle:Vt,detailProcessToggle:vt,detailTagsToggle:Jt,detailToggle:at,addHoverIndentGuideId:Pn,removeHoverIndentGuideId:on,linksGetter:()=>[],createSpanLink:Ps,scrollElement:ks,focusedSpanId:tn,focusedSpanIdForSearch:ht,showSpanFilterMatchesOnly:et,showCriticalPathSpansOnly:It,createFocusSpanLink:Mn,topOfViewRef:ge,headerHeight:sn,criticalPath:wa,traceFlameGraphs:yn,setTraceFlameGraphs:Sn,redrawListView:En,setRedrawListView:wn})]}):(0,t.jsx)("div",{className:On.noDataMsg,children:"No data"})})}function be(he){const ye=(0,u.useSelector)(Ie=>Ie.explore.panes[he.exploreId]?.panelsState.trace),Pe=ye?.spanId,ge=(0,u.useDispatch)(),xe=Ie=>ge((0,D.EA)(he.exploreId,"trace",{...ye,spanId:Ie})),Ae=(0,u.useSelector)(Ie=>Ie.explore.panes[he.exploreId]?.queries.find(Qe=>Qe.refId===he.refId));return[Pe,(Ie,Qe)=>{const at={title:"Deep link to this span",url:"",internal:{datasourceUid:he.datasource?.uid,datasourceName:he.datasource?.name,query:{...Ae,query:Ie},panelsState:{trace:{spanId:Qe}}}},ft=Ae?.queryType==="traceql"&&Ae.query===Ie;return(0,f.u)({link:at,internalLink:at.internal,scopedVars:{},field:{},onClickFn:ft?()=>xe(Pe===Qe?void 0:Qe):he.splitOpenFn?()=>he.splitOpenFn({datasourceUid:he.datasource?.uid,queries:[{...Ae,query:Ie}],panelsState:{trace:{spanId:Qe}}}):void 0,replaceVariables:(0,m.w)().replace.bind((0,m.w)())})}]}},71656:(G,O,e)=>{"use strict";e.d(O,{R:()=>n});var t=e(84140);function n(i,s,r){if(i.isLight)return s;{if(r){const c=(0,t.A)(s);return t.A.mostReadable(r,[c.clone().lighten(25),c.clone().lighten(10),c,c.clone().darken(10),c.clone().darken(25)],{includeFallbackColors:!1}).toHex8String()}const f=(0,t.A)(s).toHsl();f.l=1-f.l;const a=(0,t.A)(f);return a.isLight()?a.darken(5).toHex8String():a.lighten(5).toHex8String()}}},56271:(G,O,e)=>{"use strict";e.d(O,{DetailState:()=>qr,TracePageHeader:()=>Xo,TraceTimelineViewer:()=>Fa,filterSpans:()=>rl,transformTraceData:()=>Yi});var t=e(74848),n=e(32196),i=e(96540),s=e(14110),r=e(32264),f=e(3911),a=e(40845),c=e(71656),o=e(75888),h=e.n(o);const l={scrollPageDown:{binding:"s",label:"Scroll down"},scrollPageUp:{binding:"w",label:"Scroll up"},scrollToNextVisibleSpan:{binding:"f",label:"Scroll to the next visible span"},scrollToPrevVisibleSpan:{binding:"b",label:"Scroll to the previous visible span"},panLeft:{binding:["a","left"],label:"Pan left"},panLeftFast:{binding:["shift+a","shift+left"],label:"Pan left \u2014 Large"},panRight:{binding:["d","right"],label:"Pan right"},panRightFast:{binding:["shift+d","shift+right"],label:"Pan right \u2014 Large"},zoomIn:{binding:"up",label:"Zoom in"},zoomInFast:{binding:"shift+up",label:"Zoom in \u2014 Large"},zoomOut:{binding:"down",label:"Zoom out"},zoomOutFast:{binding:"shift+down",label:"Zoom out \u2014 Large"},collapseAll:{binding:"]",label:"Collapse All"},expandAll:{binding:"[",label:"Expand All"},collapseOne:{binding:"p",label:"Collapse One Level"},expandOne:{binding:"o",label:"Expand One Level"},searchSpans:{binding:"ctrl+b",label:"Search Spans"},clearSearch:{binding:"escape",label:"Clear Search"}};let p;function m(){if(p)return p;const Fe=new(h())(document.body);return p=Fe,Fe}function y(Fe){const Ve=m();Object.keys(Fe).forEach(qe=>{const ut=Fe[qe];ut&&Ve.bind(l[qe].binding,ut)})}function d(){m().reset()}var v=e(46942),u=e.n(v),D=e(6389);function P(Fe){const{min:Ve,max:qe,viewStart:ut,viewEnd:Tt}=Fe,_t=qe-Ve,Zt=Ve+ut*_t,Dn=qe-(1-Tt)*_t-Zt;return(An,rs)=>({start:(An-Zt)/Dn,end:(rs-Zt)/Dn})}function x(Fe,Ve,qe){return!Array.isArray(qe.tags)||!qe.tags.length?!1:qe.tags.some(ut=>ut.key===Fe&&ut.value===Ve)}const E=Fe=>Fe.kind==="client",C=x.bind(null,"span.kind","client"),M=Fe=>E(Fe)||C(Fe),S=Fe=>Fe.kind==="server",I=x.bind(null,"span.kind","server"),T=Fe=>S(Fe)||I(Fe),b=Fe=>Fe.statusCode===2,R=x.bind(null,"error",!0),A=x.bind(null,"error","true"),L=Fe=>b(Fe)||R(Fe)||A(Fe);function U(Fe,Ve){const{depth:qe}=Fe[Ve];let ut=Ve+1;for(;ut<Fe.length&&Fe[ut].depth>qe;ut++)if(L(Fe[ut]))return!0;return!1}function W(Fe){if(Fe.length<=1||!M(Fe[0]))return!1;const qe=Fe[0].depth+1;let ut=1;for(;ut<Fe.length&&Fe[ut].depth===qe;){if(T(Fe[ut]))return Fe[ut];ut++}return null}const w=Fe=>Fe.kind?Fe.kind==="client":Fe.tags.some(({key:Ve,value:qe})=>Ve==="span.kind"&&qe==="client"),N=Fe=>({Ticks:(0,n.css)`
      label: Ticks;
      pointer-events: none;
    `,TicksTick:(0,n.css)`
      label: TicksTick;
      position: absolute;
      height: 100%;
      width: 1px;
      background: ${(0,c.R)(Fe,"#d8d8d8")};
      &:last-child {
        width: 0;
      }
    `,TicksTickLabel:(0,n.css)`
      label: TicksTickLabel;
      left: 0.25rem;
      position: absolute;
    `,TicksTickLabelEndAnchor:(0,n.css)`
      label: TicksTickLabelEndAnchor;
      left: initial;
      right: 0.25rem;
    `});function B({endTime:Fe=null,numTicks:Ve,showLabels:qe=null,startTime:ut=null}){let Tt;if(qe){Tt=[];const dn=(Fe||0)-(ut||0);for(let Dn=0;Dn<Ve;Dn++){const An=(ut||0)+Dn/(Ve-1)*dn;Tt.push((0,D.a3)(An))}}const _t=(0,a.of)(N),Zt=[];for(let dn=0;dn<Ve;dn++){const Dn=dn/(Ve-1);Zt.push((0,t.jsx)("div",{"data-testid":"TicksID",className:_t.TicksTick,style:{left:`${Dn*100}%`},children:Tt&&(0,t.jsx)("span",{className:u()(_t.TicksTickLabel,{[_t.TicksTickLabelEndAnchor]:Dn>=1}),children:Tt[dn]})},Dn))}return(0,t.jsx)("div",{className:_t.Ticks,children:Zt})}const V=()=>({row:(0,n.css)({display:"flex",flex:"0 1 auto",flexDirection:"row"}),rowCell:(0,n.css)({position:"relative"})});function K({children:Fe,className:Ve="",...qe}){const ut=(0,a.of)(V);return(0,t.jsx)("div",{className:u()(ut.row,Ve),...qe,children:Fe})}function H({children:Fe,className:Ve="",width:qe,style:ut={},...Tt}){const _t=`${qe*100}%`,Zt={...ut,flexBasis:_t,maxWidth:_t},dn=(0,a.of)(V);return(0,t.jsx)("div",{className:u()(dn.rowCell,Ve),style:Zt,"data-testid":"TimelineRowCell",...Tt,children:Fe})}K.Cell=H;var X=e(29158);const k=()=>({TimelineCollapser:(0,n.css)`
      align-items: center;
      display: flex;
      flex: none;
      justify-content: center;
      margin-right: 0.5rem;
    `});function Y(Fe){const{onExpandAll:Ve,onExpandOne:qe,onCollapseAll:ut,onCollapseOne:Tt}=Fe,_t=(0,a.of)(k);return(0,t.jsxs)("div",{className:_t.TimelineCollapser,"data-testid":"TimelineCollapser",children:[(0,t.jsx)(X.K,{tooltip:"Expand +1",size:"xl",tooltipPlacement:"top",name:"angle-down",onClick:qe}),(0,t.jsx)(X.K,{tooltip:"Collapse +1",size:"xl",tooltipPlacement:"top",name:"angle-right",onClick:Tt}),(0,t.jsx)(X.K,{tooltip:"Expand All",size:"xl",tooltipPlacement:"top",name:"angle-double-down",onClick:Ve}),(0,t.jsx)(X.K,{tooltip:"Collapse All",size:"xl",tooltipPlacement:"top",name:"angle-double-right",onClick:ut})]})}var Z=e(92151);const se=()=>({TimelineColumnResizer:(0,n.css)`
      left: 0;
      position: absolute;
      right: 0;
      top: 0;
    `,wrapper:(0,n.css)`
      bottom: 0;
      position: absolute;
      top: 0;
    `,dragger:(0,n.css)`
      border-left: 2px solid transparent;
      cursor: col-resize;
      height: 5000px;
      margin-left: -1px;
      position: absolute;
      top: 0;
      width: 1px;
      z-index: 10;
      &:hover {
        border-left: 2px solid rgba(0, 0, 0, 0.3);
      }
      &::before {
        position: absolute;
        top: 0;
        bottom: 0;
        left: -8px;
        right: 0;
        content: ' ';
      }
    `,draggerDragging:(0,n.css)`
      background: rgba(136, 0, 136, 0.05);
      width: unset;
      &::before {
        left: -2000px;
        right: -2000px;
      }
    `,draggerDraggingLeft:(0,n.css)`
      border-left: 2px solid #808;
      border-right: 1px solid #999;
    `,draggerDraggingRight:(0,n.css)`
      border-left: 1px solid #999;
      border-right: 2px solid #808;
    `,gripIcon:(0,n.css)`
      position: absolute;
      top: 0;
      bottom: 0;
      &::before,
      &::after {
        border-right: 1px solid #ccc;
        content: ' ';
        height: 9px;
        position: absolute;
        right: 9px;
        top: 25px;
      }
      &::after {
        right: 5px;
      }
    `,gripIconDragging:(0,n.css)`
      &::before,
      &::after {
        border-right: 1px solid rgba(136, 0, 136, 0.5);
      }
    `});class j extends i.PureComponent{constructor(Ve){super(Ve),this._setRootElm=qe=>{this._rootElm=qe},this._getDraggingBounds=()=>{if(!this._rootElm)throw new Error("invalid state");const{left:qe,width:ut}=this._rootElm.getBoundingClientRect(),{min:Tt,max:_t}=this.props;return{clientXLeft:qe,width:ut,maxValue:_t,minValue:Tt}},this._handleDragUpdate=({value:qe})=>{this.setState({dragPosition:qe})},this._handleDragEnd=({manager:qe,value:ut})=>{qe.resetBounds(),this.setState({dragPosition:null}),this.props.onChange(ut)},this._dragManager=new Z.default({getBounds:this._getDraggingBounds,onDragEnd:this._handleDragEnd,onDragMove:this._handleDragUpdate,onDragStart:this._handleDragUpdate}),this._rootElm=void 0,this.state={dragPosition:null}}componentWillUnmount(){this._dragManager.dispose()}render(){let Ve,qe;const{position:ut,columnResizeHandleHeight:Tt}=this.props,{dragPosition:_t}=this.state;Ve=`${ut*100}%`;const Zt={left:Ve};let dn=!1,Dn=!1;const An=se();if(this._dragManager.isDragging()&&this._rootElm&&_t!=null){dn=_t<ut,Dn=_t>ut;const os=`${Math.min(ut,_t)*100}%`,us=`calc(${(1-Math.max(ut,_t))*100}% - 1px)`;qe={left:os,right:us}}else qe=Zt;qe.height=Tt;const rs=dn||Dn;return(0,t.jsxs)("div",{className:An.TimelineColumnResizer,ref:this._setRootElm,"data-testid":"TimelineColumnResizer",children:[(0,t.jsx)("div",{className:u()(An.gripIcon,rs&&An.gripIconDragging),style:Zt,"data-testid":"TimelineColumnResizer--gripIcon"}),(0,t.jsx)("div",{"aria-hidden":!0,className:u()(An.dragger,rs&&An.draggerDragging,Dn&&An.draggerDraggingRight,dn&&An.draggerDraggingLeft),onMouseDown:this._dragManager.handleMouseDown,style:qe,"data-testid":"TimelineColumnResizer--dragger"})]})}}const q=(0,f.N)(()=>({TimelineViewingLayer:(0,n.css)`
      label: TimelineViewingLayer;
      bottom: 0;
      cursor: vertical-text;
      left: 0;
      position: absolute;
      right: 0;
      top: 0;
    `,TimelineViewingLayerCursorGuide:(0,n.css)`
      label: TimelineViewingLayerCursorGuide;
      position: absolute;
      top: 0;
      bottom: 0;
      left: 0;
      width: 1px;
      background-color: red;
    `,TimelineViewingLayerDragged:(0,n.css)`
      label: TimelineViewingLayerDragged;
      position: absolute;
      top: 0;
      bottom: 0;
    `,TimelineViewingLayerDraggedDraggingLeft:(0,n.css)`
      label: TimelineViewingLayerDraggedDraggingLeft;
      border-left: 1px solid;
    `,TimelineViewingLayerDraggedDraggingRight:(0,n.css)`
      label: TimelineViewingLayerDraggedDraggingRight;
      border-right: 1px solid;
    `,TimelineViewingLayerDraggedShiftDrag:(0,n.css)`
      label: TimelineViewingLayerDraggedShiftDrag;
      background-color: rgba(68, 68, 255, 0.2);
      border-color: #44f;
    `,TimelineViewingLayerDraggedReframeDrag:(0,n.css)`
      label: TimelineViewingLayerDraggedReframeDrag;
      background-color: rgba(255, 68, 68, 0.2);
      border-color: #f44;
    `,TimelineViewingLayerFullOverlay:(0,n.css)`
      label: TimelineViewingLayerFullOverlay;
      bottom: 0;
      cursor: col-resize;
      left: 0;
      position: fixed;
      right: 0;
      top: 0;
      user-select: none;
    `}));function ne(Fe){return Reflect.has(Fe,"isOutOfView")}function oe(Fe,Ve,qe){return Fe+qe*(Ve-Fe)}function z(Fe,Ve,qe){return(qe-Fe)/(Ve-Fe)}function te(Fe,Ve){let[qe,ut]=Fe<Ve?[Fe,Ve]:[Ve,Fe];return qe>=1||ut<=0?{isOutOfView:!0}:(qe<0&&(qe=0),ut>1&&(ut=1),{isDraggingLeft:Fe>Ve,left:`${qe*100}%`,width:`${(ut-qe)*100}%`})}function le(Fe,Ve,qe,ut,Tt){const _t=z(Fe,Ve,qe),Zt=z(Fe,Ve,ut),dn=te(_t,Zt);if(ne(dn))return null;const{isDraggingLeft:Dn,left:An,width:rs}=dn,os=q(),us=(0,n.cx)({[os.TimelineViewingLayerDraggedDraggingRight]:!Dn,[os.TimelineViewingLayerDraggedReframeDrag]:!Tt,[os.TimelineViewingLayerDraggedShiftDrag]:Tt});return(0,t.jsx)("div",{className:(0,n.cx)(os.TimelineViewingLayerDragged,os.TimelineViewingLayerDraggedDraggingLeft,us),style:{left:An,width:rs},"data-testid":"Dragged"})}class ie extends i.PureComponent{constructor(Ve){super(Ve),this._setRoot=qe=>{this._root=qe},this._getDraggingBounds=()=>{if(!this._root)throw new Error("invalid state");const{left:qe,width:ut}=this._root.getBoundingClientRect();return{clientXLeft:qe,width:ut}},this._handleReframeMouseMove=({value:qe})=>{const[ut,Tt]=this.props.viewRangeTime.current,_t=oe(ut,Tt,qe);this.props.updateNextViewRangeTime({cursor:_t})},this._handleReframeMouseLeave=()=>{this.props.updateNextViewRangeTime({cursor:void 0})},this._handleReframeDragUpdate=({value:qe})=>{const{current:ut,reframe:Tt}=this.props.viewRangeTime,[_t,Zt]=ut,dn=oe(_t,Zt,qe),An={reframe:{anchor:Tt?Tt.anchor:dn,shift:dn}};this.props.updateNextViewRangeTime(An)},this._handleReframeDragEnd=({manager:qe,value:ut})=>{const{current:Tt,reframe:_t}=this.props.viewRangeTime,[Zt,dn]=Tt,Dn=oe(Zt,dn,ut),An=_t?_t.anchor:Dn,[rs,os]=Dn<An?[Dn,An]:[An,Dn];qe.resetBounds(),this.props.updateViewRangeTime(rs,os,"timeline-header")},this._draggerReframe=new Z.default({getBounds:this._getDraggingBounds,onDragEnd:this._handleReframeDragEnd,onDragMove:this._handleReframeDragUpdate,onDragStart:this._handleReframeDragUpdate,onMouseLeave:this._handleReframeMouseLeave,onMouseMove:this._handleReframeMouseMove}),this._root=void 0}UNSAFE_componentWillReceiveProps(Ve){const{boundsInvalidator:qe}=this.props;qe!==Ve.boundsInvalidator&&this._draggerReframe.resetBounds()}componentWillUnmount(){this._draggerReframe.dispose()}render(){const{viewRangeTime:Ve}=this.props,{current:qe,cursor:ut,reframe:Tt,shiftEnd:_t,shiftStart:Zt}=Ve,[dn,Dn]=qe,An=Tt!=null||_t!=null||Zt!=null;let rs;!An&&ut!=null&&ut>=dn&&ut<=Dn&&(rs=`${z(dn,Dn,ut)*100}%`);const os=q();return(0,t.jsxs)("div",{"aria-hidden":!0,className:os.TimelineViewingLayer,ref:this._setRoot,onMouseDown:this._draggerReframe.handleMouseDown,onMouseLeave:this._draggerReframe.handleMouseLeave,onMouseMove:this._draggerReframe.handleMouseMove,"data-testid":"TimelineViewingLayer",children:[rs!=null&&(0,t.jsx)("div",{className:os.TimelineViewingLayerCursorGuide,style:{left:rs},"data-testid":"TimelineViewingLayer--cursorGuide"}),Tt!=null&&le(dn,Dn,Tt.anchor,Tt.shift,!1),_t!=null&&le(dn,Dn,Dn,_t,!0),Zt!=null&&le(dn,Dn,dn,Zt,!0)]})}}const ae=Fe=>({TimelineHeaderRow:(0,n.css)`
      label: TimelineHeaderRow;
      background: ${(0,c.R)(Fe,"#ececec")};
      border-bottom: 1px solid ${(0,c.R)(Fe,"#ccc")};
      height: 38px;
      line-height: 38px;
      width: 100%;
      z-index: 4;
      position: relative;
    `,TimelineHeaderRowTitle:(0,n.css)`
      label: TimelineHeaderRowTitle;
      flex: 1;
      overflow: hidden;
      margin: 0;
      text-overflow: ellipsis;
      white-space: nowrap;
    `,TimelineHeaderWrapper:(0,n.css)`
      label: TimelineHeaderWrapper;
      align-items: center;
      display: flex;
      padding-left: ${Fe.spacing(1)};
      padding-right: ${Fe.spacing(1)};
    `});function re(Fe){const{duration:Ve,nameColumnWidth:qe,numTicks:ut,onCollapseAll:Tt,onCollapseOne:_t,onColummWidthChange:Zt,onExpandAll:dn,onExpandOne:Dn,updateViewRangeTime:An,updateNextViewRangeTime:rs,viewRangeTime:os,columnResizeHandleHeight:us}=Fe,[hs,Js]=os.current,Os=(0,a.of)(ae);return(0,t.jsxs)(K,{className:Os.TimelineHeaderRow,"data-testid":"TimelineHeaderRow",children:[(0,t.jsxs)(K.Cell,{className:Os.TimelineHeaderWrapper,width:qe,children:[(0,t.jsx)("h4",{className:Os.TimelineHeaderRowTitle,children:"Service & Operation"}),(0,t.jsx)(Y,{onCollapseAll:Tt,onExpandAll:dn,onCollapseOne:_t,onExpandOne:Dn})]}),(0,t.jsxs)(K.Cell,{width:1-qe,children:[(0,t.jsx)(ie,{boundsInvalidator:qe,updateNextViewRangeTime:rs,updateViewRangeTime:An,viewRangeTime:os}),(0,t.jsx)(B,{numTicks:ut,startTime:hs*Ve,endTime:Js*Ve,showLabels:!0})]}),(0,t.jsx)(j,{columnResizeHandleHeight:us,position:qe,onChange:Zt,min:.2,max:.85})]})}var ce=e(2543),me=e(41811),ee=e(27746);const de="peer.service";var De=e(30700);class fe{constructor(Ve){this.ys=[],this.heights=[],this.bufferLen=Ve,this.dataLen=-1,this.lastI=-1}profileData(Ve){Ve!==this.dataLen&&(this.dataLen=Ve,this.ys.length=Ve,this.heights.length=Ve,this.lastI>=Ve&&(this.lastI=Ve-1))}calcHeights(Ve,qe,ut){ut!=null&&(this.lastI=ut);let Tt=Ve+this.bufferLen;if(Tt<=this.lastI)return;Tt>=this.heights.length&&(Tt=this.heights.length-1);let _t=this.lastI;for(this.lastI===-1&&(_t=0,this.ys[0]=0);_t<=Tt;){const Zt=this.heights[_t]=qe(_t);this.ys[_t+1]=this.ys[_t]+Zt,_t++}this.lastI=Tt}calcYs(Ve,qe){for(;(this.ys[this.lastI]==null||Ve>this.ys[this.lastI])&&this.lastI<this.dataLen-1;)this.calcHeights(this.lastI,qe)}confirmHeight(Ve,qe){let ut=Ve;if(ut>this.lastI){this.calcHeights(ut,qe);return}const Tt=qe(ut);if(Tt===this.heights[ut])return;const _t=Tt-this.heights[ut];for(this.heights[ut]=Tt;++ut<=this.lastI;)this.ys[ut]+=_t;this.ys[this.lastI+1]!=null&&(this.ys[this.lastI+1]+=_t)}findFloorIndex(Ve,qe){this.calcYs(Ve,qe);let ut=0,Tt=this.lastI;if(this.ys.length<2||Ve<this.ys[1])return 0;if(Ve>this.ys[Tt])return Tt;let _t;for(;ut<Tt;)if(_t=ut+.5*(Tt-ut)|0,Ve>this.ys[_t]){if(Ve<=this.ys[_t+1])return _t;ut=_t}else if(Ve<this.ys[_t]){if(Ve>=this.ys[_t-1])return _t-1;Tt=_t}else return _t;throw new Error(`unable to find floor index for y=${Ve}`)}getRowPosition(Ve,qe){return this.confirmHeight(Ve,qe),{height:this.heights[Ve],y:this.ys[Ve]}}getEstimatedHeight(){const Ve=this.ys[this.lastI]+this.heights[this.lastI];return this.lastI>=this.dataLen-1?Ve|0:Ve/(this.lastI+1)*this.heights.length|0}}const Te=100;class je extends i.Component{constructor(Ve){super(Ve),this.getViewHeight=()=>this._viewHeight,this.getBottomVisibleIndex=()=>{const qe=this._scrollTop+this._viewHeight;return this._yPositions.findFloorIndex(qe,this._getHeight)},this.getTopVisibleIndex=()=>this._yPositions.findFloorIndex(this._scrollTop,this._getHeight),this.getRowPosition=qe=>this._yPositions.getRowPosition(qe,this._getHeight),this.scrollToIndex=(qe,ut)=>{const{scrollElement:Tt}=this.props,_t=Tt?.getBoundingClientRect().top||0,dn=(Tt?.scrollTop||0)+(this._itemHolderElm?.getBoundingClientRect().top||0)-_t,Dn=this.getRowPosition(qe).y;this.props.scrollElement?.scrollTo({top:Dn+dn-ut-80})},this._onScroll=()=>{this._isScrolledOrResized||(this._isScrolledOrResized=!0,window.requestAnimationFrame(this._positionList))},this._positionList=()=>{if(this._isScrolledOrResized=!1,!this._wrapperElm)return;this._calcViewIndexes();const qe=this.props.viewBufferMin>this._startIndex?0:this._startIndex-this.props.viewBufferMin,ut=this.props.viewBufferMin<this.props.dataLength-this._endIndex?this._endIndex+this.props.viewBufferMin:this.props.dataLength-1;(qe<this._startIndexDrawn||ut>this._endIndexDrawn)&&this.forceUpdate()},this._initWrapper=qe=>{this.props.windowScroller&&(this._wrapperElm=qe,qe&&(this._viewHeight=qe.clientHeight))},this._initItemHolder=qe=>{this._itemHolderElm=qe,this._scanItemHeights()},this._scanItemHeights=()=>{const qe=this.props.getIndexFromKey;if(!this._itemHolderElm)return;let ut=null,Tt=null,_t=!1;const Zt=this._itemHolderElm.childNodes,dn=Zt.length;for(let Dn=0;Dn<dn;Dn++){const An=Zt[Dn];if(An instanceof HTMLElement){const rs=An.getAttribute("data-item-key");if(!rs){console.warn("itemKey not found");continue}const us=(An.firstElementChild||An).clientHeight,hs=this._knownHeights.get(rs);us!==hs&&(this._knownHeights.set(rs,us),_t?Tt=rs:(_t=!0,ut=Tt=rs))}}if(ut!=null&&Tt!=null){const Dn=qe(ut),An=Tt===ut?Dn:qe(Tt);this._yPositions.calcHeights(An,this._getHeight,Dn),this.forceUpdate()}},this._getHeight=qe=>{const ut=this.props.getKeyFromIndex(qe),Tt=this._knownHeights.get(ut);return Tt!=null&&Tt===Tt?Tt:this.props.itemHeightGetter(qe,ut)},this._yPositions=new fe(200),this._knownHeights=new Map,this._startIndexDrawn=2**20,this._endIndexDrawn=-(2**20),this._startIndex=0,this._endIndex=0,this._viewHeight=-1,this._scrollTop=-1,this._isScrolledOrResized=!1,this._htmlTopOffset=-1,this._windowScrollListenerAdded=!1,this._htmlElm=document.documentElement,this._wrapperElm=void 0,this._itemHolderElm=void 0}static{this.defaultProps={initialDraw:Te,itemsWrapperClassName:"",windowScroller:!1}}componentDidMount(){if(this.props.windowScroller){if(this._wrapperElm){const{top:Ve}=this._wrapperElm.getBoundingClientRect();this._htmlTopOffset=Ve+this._htmlElm.scrollTop}window.addEventListener("scroll",this._onScroll),this._windowScrollListenerAdded=!0}else this._wrapperElm=this.props.scrollElement,this._wrapperElm?.addEventListener("scroll",this._onScroll)}componentDidUpdate(Ve){this._itemHolderElm&&this._scanItemHeights(),!this.props.windowScroller&&Ve.scrollElement!==this.props.scrollElement&&(Ve.scrollElement?.removeEventListener("scroll",this._onScroll),this._wrapperElm=this.props.scrollElement,this._wrapperElm?.addEventListener("scroll",this._onScroll))}componentWillUnmount(){this._windowScrollListenerAdded?window.removeEventListener("scroll",this._onScroll):this._wrapperElm?.removeEventListener("scroll",this._onScroll)}_isViewChanged(){if(!this._wrapperElm)return!1;const Ve=this.props.windowScroller,qe=Ve?this._htmlElm.clientHeight:this._wrapperElm.clientHeight,ut=Ve?this._htmlElm.scrollTop:this._wrapperElm.scrollTop;return qe!==this._viewHeight||ut!==this._scrollTop}_calcViewIndexes(){if(this.props.windowScroller)this._viewHeight=window.innerHeight-this._htmlTopOffset,this._scrollTop=window.scrollY;else{if(!this._wrapperElm){this._viewHeight=-1,this._startIndex=0,this._endIndex=0;return}this._viewHeight=this._wrapperElm.clientHeight,this._scrollTop=this._wrapperElm.scrollTop}const qe=this._scrollTop,ut=this._scrollTop+this._viewHeight;this._startIndex=this._yPositions.findFloorIndex(qe,this._getHeight),this._endIndex=this._yPositions.findFloorIndex(ut,this._getHeight)}render(){const{dataLength:Ve,getKeyFromIndex:qe,initialDraw:ut=Te,itemRenderer:Tt,viewBuffer:_t,viewBufferMin:Zt}=this.props,dn=this._getHeight,Dn=[];let An,rs;if(this._yPositions.profileData(Ve),!this._wrapperElm)An=0,rs=(ut<Ve?ut:Ve)-1;else{this._isViewChanged()&&this._calcViewIndexes();const hs=Zt>this._startIndex?0:this._startIndex-Zt,Js=Zt<Ve-this._endIndex?this._endIndex+Zt:Ve-1;hs<this._startIndexDrawn||Js>this._endIndexDrawn?(An=_t>this._startIndex?0:this._startIndex-_t,rs=this._endIndex+_t,rs>=Ve&&(rs=Ve-1)):(An=this._startIndexDrawn>Ve-1?0:this._startIndexDrawn,rs=this._endIndexDrawn>Ve-1?Ve-1:this._endIndexDrawn)}this._yPositions.calcHeights(rs,dn,An||-1),this._startIndexDrawn=An,this._endIndexDrawn=rs,Dn.length=rs-An+1;for(let hs=An;hs<=rs;hs++){const{y:Js,height:Os}=this._yPositions.getRowPosition(hs,dn),vs={height:Os,top:Js,position:"absolute"},Cs=qe(hs),ea={"data-item-key":Cs};Dn.push(Tt(Cs,vs,hs,ea))}const os={style:{position:"relative"},ref:this._initWrapper};this.props.windowScroller||(os.onScroll=this._onScroll,os.style.height="100%",os.style.overflowY="auto");const us={position:"relative",height:this._yPositions.getEstimatedHeight()};return(0,t.jsx)("div",{...os,"data-testid":"ListView",children:(0,t.jsx)("div",{style:us,children:(0,t.jsx)("div",{style:{position:"absolute",top:0,margin:0,padding:0},className:this.props.itemsWrapperClassName,ref:this._initItemHolder,children:Dn})})})}}const He="None",Be="Duration",Ne="Tag";function Re({options:Fe,onOptionsChange:Ve}){const qe=useStyles2(We),ut=[He,Be,Ne].map(toOption);return jsxs("div",{className:css({width:"100%"}),children:[jsx(InlineFieldRow,{className:qe.row,children:jsx(InlineField,{label:"Label",labelWidth:26,tooltip:"Default: duration",grow:!0,children:jsx(Select,{inputId:"label",options:ut,value:Fe.jsonData.spanBar?.type||"",onChange:Tt=>{updateDatasourcePluginJsonDataOption({onOptionsChange:Ve,options:Fe},"spanBar",{...Fe.jsonData.spanBar,type:Tt?.value??""})},placeholder:"Duration",isClearable:!0,"aria-label":"select-label-name",width:40})})}),Fe.jsonData.spanBar?.type===Ne&&jsx(InlineFieldRow,{className:qe.row,children:jsx(InlineField,{label:"Tag key",labelWidth:26,tooltip:"Tag key which will be used to get the tag value. A span's attributes and resources will be searched for the tag key",children:jsx(Input,{type:"text",placeholder:"Enter tag key",onChange:Tt=>updateDatasourcePluginJsonDataOption({onOptionsChange:Ve,options:Fe},"spanBar",{...Fe.jsonData.spanBar,tag:Tt.currentTarget.value}),value:Fe.jsonData.spanBar?.tag||"",width:40})})})]})}const Se=({options:Fe,onOptionsChange:Ve})=>{let qe=Fe.type;return qe+=Fe.type==="tempo"?"/configure-tempo-data-source/#span-bar":"/#span-bar",jsx(ConfigSubSection,{title:"Span bar",description:jsx(ConfigDescriptionLink,{description:"Add additional info next to the service and operation on a span bar row in the trace view.",suffix:qe,feature:"the span bar"}),children:jsx(Re,{options:Fe,onOptionsChange:Ve})})},We=Fe=>({infoText:css({label:"infoText",paddingBottom:Fe.spacing(2),color:Fe.colors.text.secondary}),row:css({label:"row",alignItems:"baseline"})});var Ke=e(14578),Xe=e(13544),Je=e(56034),st=e(95868),pt=e(13840);function xt({children:Fe,content:Ve,overlayClassName:qe}){const ut=(0,i.useRef)(null);return(0,t.jsx)(st.I,{content:Ve,hideAfter:300,children:(Tt,_t,Zt)=>(0,t.jsxs)(t.Fragment,{children:[ut.current&&(0,t.jsx)(pt.A,{...Zt,referenceElement:ut.current,wrapperClassName:qe,onMouseLeave:_t,onMouseEnter:Tt}),(0,i.cloneElement)(Fe,{ref:ut,onMouseEnter:Tt,onMouseLeave:_t})]})})}const ot="label";var $e=e(55852);const ve=()=>({CopyIcon:(0,n.css)`
      background-color: transparent;
      border: none;
      color: inherit;
      height: 100%;
      overflow: hidden;
      &:focus {
        background-color: rgba(255, 255, 255, 0.25);
        color: inherit;
      }
    `});function be({copyText:Fe,icon:Ve="copy",tooltipTitle:qe}){const ut=(0,a.of)(ve),[Tt,_t]=(0,i.useState)(!1),Zt=()=>{navigator.clipboard.writeText(Fe),_t(!0)};return(0,t.jsx)(Je.m,{content:Tt?"Copied":qe,children:(0,t.jsx)($e.$n,{className:u()(ut.CopyIcon),type:"button",icon:Ve,onClick:Zt})})}var he=e(72834),ye=e.n(he);const Pe="copyIcon",ge=Fe=>({KeyValueTable:(0,n.css)`
      label: KeyValueTable;
      background: ${(0,c.R)(Fe,"#fff")};
      border: 1px solid ${(0,c.R)(Fe,"#ddd")};
      margin-bottom: 0.5rem;
      max-height: 450px;
      overflow: auto;
    `,table:(0,n.css)({width:"100%"}),body:(0,n.css)`
      label: body;
      vertical-align: baseline;
    `,row:(0,n.css)`
      label: row;
      & > td {
        padding: 0rem 0.5rem;
        height: 30px;
      }
      &:nth-child(2n) > td {
        background: ${(0,c.R)(Fe,"#f5f5f5")};
      }
      &:not(:hover) .${Pe} {
        visibility: hidden;
      }
    `,keyColumn:(0,n.css)`
      label: keyColumn;
      color: ${(0,c.R)(Fe,"#888")};
      white-space: pre;
      width: 125px;
    `,copyColumn:(0,n.css)`
      label: copyColumn;
      text-align: right;
    `,linkIcon:(0,n.css)`
      label: linkIcon;
      vertical-align: middle;
      font-weight: bold;
    `,jsonTable:(0,n.css)({display:"inline-block"})}),xe=/^(\[|\{)/;function Ae(Fe){if(typeof Fe=="string"&&xe.test(Fe))try{return JSON.parse(Fe)}catch{}return Fe}const Ee=({href:Fe,title:Ve="",children:qe})=>(0,t.jsxs)("a",{href:Fe,title:Ve,target:"_blank",rel:"noopener noreferrer",children:[qe," ",(0,t.jsx)(Ke.I,{name:"external-link-alt"})]});function Ie(Fe){const{data:Ve,linksGetter:qe}=Fe,ut=(0,a.of)(ge);return(0,t.jsx)("div",{className:u()(ut.KeyValueTable),"data-testid":"KeyValueTable",children:(0,t.jsx)("table",{className:ut.table,children:(0,t.jsx)("tbody",{className:ut.body,children:Ve.map((Tt,_t)=>{const Zt={__html:ye()(Ae(Tt.value))},dn=(0,t.jsx)("div",{className:ut.jsonTable,dangerouslySetInnerHTML:Zt}),Dn=qe?qe(Ve,_t):null;let An;return Dn&&Dn.length?An=(0,t.jsx)("div",{children:(0,t.jsx)(Ee,{href:Dn[0].url,title:Dn[0].text,children:dn})}):An=dn,(0,t.jsxs)("tr",{className:ut.row,children:[(0,t.jsx)("td",{className:ut.keyColumn,"data-testid":"KeyValueTable--keyColumn",children:Tt.key}),(0,t.jsx)("td",{children:An}),(0,t.jsx)("td",{className:ut.copyColumn,children:(0,t.jsx)(be,{className:Pe,copyText:JSON.stringify(Tt,null,2),tooltipTitle:"Copy JSON"})})]},`${Tt.key}-${_t}`)})})})})}var Qe=e(11908),at=e(72724),ft=e(12131),ct=e(14689),vt=e(25994),Pt=e(21744),Vt=e(19071),Jt=e(28114);const wt=Fe=>Ve=>({LabeledList:(0,n.css)`
      label: LabeledList;
      list-style: none;
      margin: 0;
      padding: 0;
      ${Fe&&`
        margin-right: -8px;
        display: flex;
        flex-wrap: wrap;
        justify-content: flex-end;
      `}
    `,LabeledListItem:(0,n.css)`
      label: LabeledListItem;
      display: inline-block;
      ${Fe&&`
        border-right: 1px solid ${(0,c.R)(Ve,"#ddd")};
        padding: 0 8px;
      `}
    `,LabeledListLabel:(0,n.css)`
      label: LabeledListLabel;
      color: ${Ve.isLight?"#999":"#666"};
      margin-right: 0.25rem;
    `,LabeledListValue:(0,n.css)`
      label: LabeledListValue;
      ${!Fe&&"margin-right: 0.55rem;"}
    `});function zt(Fe){const{className:Ve,divider:qe=!1,items:ut}=Fe,Tt=(0,a.of)(wt(qe));return(0,t.jsx)("ul",{className:u()(Tt.LabeledList,Ve),children:ut.map(({key:_t,label:Zt,value:dn})=>(0,t.jsxs)("li",{className:Tt.LabeledListItem,children:[(0,t.jsx)("span",{className:Tt.LabeledListLabel,children:Zt}),(0,t.jsx)("strong",{className:Tt.LabeledListValue,children:dn})]},`${_t}`))})}const on="kind",Pn="status",_n="status.message",Cn="library.name",Ye="library.version",Dt="trace.state",yt="id";var Ft=e(92102);function an(Fe){const{reference:Ve,children:qe,createFocusSpanLink:ut}=Fe,Tt=ut(Ve.traceID,Ve.spanID);return(0,t.jsx)("a",{href:Tt.href,target:Tt.target,rel:"noopener noreferrer",onClick:Tt.onClick?_t=>{_t.preventDefault(),Tt.onClick(_t)}:void 0,children:qe})}const un=Fe=>({AccordianReferenceItem:(0,n.css)`
      border-bottom: 1px solid ${(0,c.R)(Fe,"#d8d8d8")};
    `,AccordianKeyValues:(0,n.css)`
      margin-left: 10px;
    `,AccordianReferences:(0,n.css)`
      label: AccordianReferences;
      border: 1px solid ${(0,c.R)(Fe,"#d8d8d8")};
      position: relative;
      margin-bottom: 0.25rem;
    `,AccordianReferencesHeader:(0,n.css)`
      label: AccordianReferencesHeader;
      background: ${(0,c.R)(Fe,"#e4e4e4")};
      color: inherit;
      display: block;
      padding: 0.25rem 0.5rem;
      &:hover {
        background: ${(0,c.R)(Fe,"#dadada")};
      }
    `,AccordianReferencesContent:(0,n.css)`
      label: AccordianReferencesContent;
      background: ${(0,c.R)(Fe,"#f0f0f0")};
      border-top: 1px solid ${(0,c.R)(Fe,"#d8d8d8")};
      padding: 0.5rem 0.5rem 0.25rem 0.5rem;
    `,AccordianReferencesFooter:(0,n.css)`
      label: AccordianReferencesFooter;
      color: ${(0,c.R)(Fe,"#999")};
    `,AccordianKeyValuesItem:(0,n.css)({marginBottom:Fe.spacing(.5)}),ReferencesList:(0,n.css)`
      background: #fff;
      border: 1px solid #ddd;
      margin-bottom: 0.7em;
      max-height: 450px;
      overflow: auto;
    `,list:(0,n.css)`
      width: 100%;
      list-style: none;
      padding: 0;
      margin: 0;
      background: #fff;
    `,itemContent:(0,n.css)`
      padding: 0.25rem 0.5rem;
      display: flex;
      width: 100%;
      justify-content: space-between;
    `,item:(0,n.css)`
      &:nth-child(2n) {
        background: #f5f5f5;
      }
    `,debugInfo:(0,n.css)`
      letter-spacing: 0.25px;
      margin: 0.5em 0 0;
      flex-wrap: wrap;
      display: flex;
      justify-content: flex-end;
    `,debugLabel:(0,n.css)`
      margin: 0 5px 0 5px;
      &::before {
        color: #bbb;
        content: attr(data-label);
      }
    `,serviceName:(0,n.css)`
      margin-right: 8px;
    `,title:(0,n.css)`
      display: flex;
      align-items: center;
      gap: 4px;
    `});function hn(Fe){const{data:Ve,createFocusSpanLink:qe,openedItems:ut,onItemToggle:Tt,interactive:_t}=Fe,Zt=(0,a.of)(un);return(0,t.jsx)("div",{className:Zt.AccordianReferencesContent,children:Ve.map((dn,Dn)=>(0,t.jsxs)("div",{className:Dn<Ve.length-1?Zt.AccordianReferenceItem:void 0,children:[(0,t.jsx)("div",{className:Zt.item,children:(0,t.jsx)(an,{reference:dn,createFocusSpanLink:qe,children:(0,t.jsxs)("span",{className:Zt.itemContent,children:[dn.span?(0,t.jsxs)("span",{children:[(0,t.jsx)("span",{className:(0,n.cx)("span-svc-name",Zt.serviceName),children:dn.span.process.serviceName}),(0,t.jsx)("small",{className:"endpoint-name",children:dn.span.operationName})]}):(0,t.jsxs)("span",{className:(0,n.cx)("span-svc-name",Zt.title),children:["View Linked Span ",(0,t.jsx)(Ke.I,{name:"external-link-alt"})]}),(0,t.jsxs)("small",{className:Zt.debugInfo,children:[(0,t.jsx)("span",{className:Zt.debugLabel,"data-label":"TraceID:",children:dn.traceID}),(0,t.jsx)("span",{className:Zt.debugLabel,"data-label":"SpanID:",children:dn.spanID})]})]})})},`${dn.spanID}`),!!dn.tags?.length&&(0,t.jsx)("div",{className:Zt.AccordianKeyValues,children:(0,t.jsx)(tn,{className:Dn<Ve.length-1?Zt.AccordianKeyValuesItem:null,data:dn.tags||[],highContrast:!0,interactive:_t,isOpen:ut?ut.has(dn):!1,label:"attributes",linksGetter:null,onToggle:_t&&Tt?()=>Tt(dn):null})})]},Dn))})}const Un=({data:Fe,interactive:Ve=!0,isOpen:qe,onToggle:ut,onItemToggle:Tt,openedItems:_t,createFocusSpanLink:Zt})=>{const dn=!Array.isArray(Fe)||!Fe.length;let Dn=null,An="span",rs=null;Ve&&(Dn=qe?(0,t.jsx)(Ke.I,{name:"angle-down",className:On}):(0,t.jsx)(Ke.I,{name:"angle-right",className:On}),An="a",rs={"aria-checked":qe,onClick:dn?null:ut,role:"switch"});const os=(0,a.of)(un);return(0,t.jsxs)("div",{className:os.AccordianReferences,children:[(0,t.jsxs)(An,{className:os.AccordianReferencesHeader,...rs,children:[Dn,(0,t.jsx)("strong",{children:(0,t.jsx)("span",{children:"References"})})," ","(",Fe.length,")"]}),qe&&(0,t.jsx)(hn,{data:Fe,openedItems:_t,createFocusSpanLink:Zt,onItemToggle:Tt,interactive:Ve})]})},Nn=i.memo(Un),St=()=>({TextList:(0,n.css)`
      max-height: 450px;
      overflow: auto;
    `,List:(0,n.css)`
      width: 100%;
      list-style: none;
      padding: 0;
      margin: 0;
    `,item:(0,n.css)`
      padding: 0.25rem 0.5rem;
      vertical-align: top;
      &:nth-child(2n) {
        background: #f5f5f5;
      }
    `});function nn(Fe){const{data:Ve}=Fe,qe=(0,a.of)(St);return(0,t.jsx)("div",{className:u()(qe.TextList),"data-testid":"TextList",children:(0,t.jsx)("ul",{className:qe.List,children:Ve.map((ut,Tt)=>(0,t.jsx)("li",{className:qe.item,children:ut},`${Tt}`))})})}const ht=Fe=>({header:(0,n.css)`
      cursor: pointer;
      overflow: hidden;
      padding: 0.25em 0.1em;
      text-overflow: ellipsis;
      white-space: nowrap;
      &:hover {
        background: ${(0,c.R)(Fe,"#e8e8e8")};
      }
    `});function lt({data:Fe}){return(0,t.jsx)(nn,{data:Fe})}function gt({className:Fe=null,data:Ve,headerClassName:qe,highContrast:ut=!1,interactive:Tt=!0,isOpen:_t,label:Zt,onToggle:dn=null,TextComponent:Dn=lt}){const An=!Array.isArray(Ve)||!Ve.length,rs=(0,a.of)(jt),os=u()(On,{[rs.emptyIcon]:An});let us=null,hs=null;Tt&&(us=_t?(0,t.jsx)(Ke.I,{name:"angle-down",className:os}):(0,t.jsx)(Ke.I,{name:"angle-right",className:os}),hs={"aria-checked":_t,onClick:An?null:dn,role:"switch"});const Js=(0,a.of)(ht);return(0,t.jsxs)("div",{className:Fe||"",children:[(0,t.jsxs)("div",{className:u()(Js.header,qe),...hs,"data-testid":"AccordianText--header",children:[us,(0,t.jsx)("strong",{children:Zt})," (",Ve.length,")"]}),_t&&(0,t.jsx)(Dn,{data:Ve})]})}var $t=e(49185),et=e(75505),Et=e(47232),It=e(41987),Qt=e(85194),sn=e(26657),ln=e(72574),yn=e(31193);function Sn(Fe){const{span:Ve,traceToProfilesOptions:qe,timeZone:ut,traceFlameGraphs:Tt,setTraceFlameGraphs:_t,setRedrawListView:Zt,traceDuration:dn,traceName:Dn}=Fe,[An,{height:rs}]=(0,$t.A)(),os=(0,a.of)(En),us=Ve.tags.filter(Cs=>Cs.key===Jt.QW),hs=us.length>0?us[0].value:void 0,Js=(0,i.useCallback)(()=>{const Cs=Math.floor(Ve.startTime/1e3)-3e4,ea=(Ve.startTime+Ve.duration)/1e3+3e4,oa=(0,Et.KQ)(ea),As=(0,Et.KQ)(Cs);return{from:As,to:oa,raw:{from:As,to:oa}}},[Ve.duration,Ve.startTime]),Os=async(Cs,ea)=>{const oa=await(0,yn.tR)().get(ea);if(oa instanceof sn.iy){const ta=(await(0,et.s)(oa.query(Cs))).data.find(Ra=>Ra.name==="response");if(ta&&ta.length>1)return ta}},vs=(0,i.useCallback)(async(Cs,ea,oa)=>{let As="{}";if(ea.customQuery&&ea.query){const Ga={...(0,Jt.gt)(dn,Dn,oa.traceID),...(0,Jt.hv)(oa),...(0,Jt.Cr)(oa,ea)};As=(0,ln.w)().replace(ea.query,Ga)}else{const Ga=ea.tags&&ea.tags.length>0?ea.tags:Jt.i0;As=`{${(0,Jt._o)(oa,Ga)}}`}const ta={requestId:"span-flamegraph-requestId",interval:"2s",intervalMs:2e3,range:Js(),scopedVars:{},app:It.Jk.Unknown,timezone:ut,startTime:oa.startTime,targets:[{labelSelector:As,groupBy:[],profileTypeId:ea.profileTypeId??"",queryType:"profile",spanSelector:[hs],refId:"span-flamegraph-refId",datasource:{type:Cs.type,uid:Cs.uid}}]},Ra=await Os(ta,Cs.uid);Ra&&Ra.length>0&&_t({...Tt,[hs]:Ra})},[Js,hs,_t,ut,dn,Tt,Dn]);return(0,i.useEffect)(()=>{if(!Object.keys(Tt).includes(hs)){let Cs;qe&&qe?.datasourceUid&&(Cs=(0,yn.tR)().getInstanceSettings(qe.datasourceUid)),qe&&Cs&&vs(Cs,qe,Ve)}},[_t,Ve,Tt,qe,Js,ut,vs,hs]),(0,i.useEffect)(()=>{Zt({})},[rs,Zt]),Tt[hs]?(0,t.jsxs)("div",{className:os.flameGraph,ref:An,children:[(0,t.jsx)("div",{className:os.flameGraphTitle,children:"Flame graph"}),(0,t.jsx)(Qt.A,{data:Tt[hs],getTheme:()=>r.$.theme2,showFlameGraphOnly:!0,disableCollapsing:!0})]}):(0,t.jsx)(t.Fragment,{})}const En=()=>({flameGraph:(0,n.css)({label:"flameGraphInSpan",margin:"5px"}),flameGraphTitle:(0,n.css)({label:"flameGraphTitleInSpan",marginBottom:"5px",fontWeight:"bold"})}),wn=Fe=>({header:(0,n.css)`
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 0 1rem;
      margin-bottom: 0.25rem;
    `,listWrapper:(0,n.css)`
      overflow: hidden;
    `,list:(0,n.css)({textAlign:"right"}),operationName:(0,n.css)({margin:0}),debugInfo:(0,n.css)`
      label: debugInfo;
      display: block;
      letter-spacing: 0.25px;
      margin: 0.5em 0 -0.75em;
      text-align: right;
    `,debugLabel:(0,n.css)`
      label: debugLabel;
      &::before {
        color: ${(0,c.R)(Fe,"#bbb")};
        content: attr(data-label);
      }
    `,debugValue:(0,n.css)`
      label: debugValue;
      background-color: inherit;
      border: none;
      color: ${(0,c.R)(Fe,"#888")};
      cursor: pointer;
      &:hover {
        color: ${(0,c.R)(Fe,"#333")};
      }
    `,AccordianWarnings:(0,n.css)`
      label: AccordianWarnings;
      background: ${(0,c.R)(Fe,"#fafafa")};
      border: 1px solid ${(0,c.R)(Fe,"#e4e4e4")};
      margin-bottom: 0.25rem;
    `,AccordianWarningsHeader:(0,n.css)`
      label: AccordianWarningsHeader;
      background: ${(0,c.R)(Fe,"#fff7e6")};
      padding: 0.25rem 0.5rem;
      &:hover {
        background: ${(0,c.R)(Fe,"#ffe7ba")};
      }
    `,AccordianWarningsHeaderOpen:(0,n.css)`
      label: AccordianWarningsHeaderOpen;
      border-bottom: 1px solid ${(0,c.R)(Fe,"#e8e8e8")};
    `,AccordianWarningsLabel:(0,n.css)`
      label: AccordianWarningsLabel;
      color: ${(0,c.R)(Fe,"#d36c08")};
    `,AccordianKeyValuesItem:(0,n.css)({marginBottom:Fe.spacing(.5)}),Textarea:(0,n.css)`
      word-break: break-all;
      white-space: pre;
    `,LinkIcon:(0,n.css)`
      font-size: 1.5em;
    `,linkList:(0,n.css)({display:"flex",flexWrap:"wrap",gap:"10px"})}),On=(0,n.css)({margin:"-0.2rem 0.25rem 0 0"});function Rt(Fe){const{detailState:Ve,linksGetter:qe,logItemToggle:ut,logsToggle:Tt,processToggle:_t,span:Zt,tagsToggle:dn,traceStartTime:Dn,traceDuration:An,traceName:rs,warningsToggle:os,stackTracesToggle:us,referencesToggle:hs,referenceItemToggle:Js,createSpanLink:Os,createFocusSpanLink:vs,datasourceType:Cs,traceFlameGraphs:ea,setTraceFlameGraphs:oa,traceToProfilesOptions:As,setRedrawListView:ta}=Fe,{isTagsOpen:Ra,isProcessOpen:Ga,logs:ar,isWarningsOpen:La,references:na,isStackTracesOpen:Or}=Ve,{operationName:Lr,process:qa,duration:_r,relativeStartTime:io,startTime:Pr,traceID:lo,spanID:ir,logs:ss,tags:ws,warnings:Ds,references:Ws,stackTraces:Ge}=Zt,{timeZone:Le}=Fe;let _e=[{key:"svc",label:"Service:",value:qa.serviceName},{key:"duration",label:"Duration:",value:(0,D.a3)(_r)},{key:"start",label:"Start Time:",value:(0,D.a3)(io)+Ot(Pr,Le)},...Zt.childSpanCount>0?[{key:"child_count",label:"Child Count:",value:Zt.childSpanCount}]:[]];const nt=(0,a.of)(wn);Zt.kind&&_e.push({key:on,label:"Kind:",value:Zt.kind}),Zt.statusCode!==void 0&&_e.push({key:Pn,label:"Status:",value:Qe.s[Zt.statusCode].toLowerCase()}),Zt.statusMessage&&_e.push({key:_n,label:"Status Message:",value:Zt.statusMessage}),Zt.instrumentationLibraryName&&_e.push({key:Cn,label:"Library Name:",value:Zt.instrumentationLibraryName}),Zt.instrumentationLibraryVersion&&_e.push({key:Ye,label:"Library Version:",value:Zt.instrumentationLibraryVersion}),Zt.traceState&&_e.push({key:Dt,label:"Trace State:",value:Zt.traceState});const At=(xn,gs,as,$s)=>(0,t.jsx)(ct.R,{link:{...xn,title:as,target:"_blank",origin:xn.field,onClick:Us=>{(0,s.rR)("grafana_traces_trace_view_span_link_clicked",{datasourceType:Cs,grafana_version:r.$.buildInfo.version,type:gs,location:"spanDetails"}),xn.onClick?xn.onClick?.(Us):ft.Ny.push(xn.href)}},buttonProps:{icon:$s}});let kt=null,qt=null,gn=null;if(Os){const xn=Os(Zt),gs=xn?.filter(Us=>Us.type===Ft.N.Logs);xn&&gs&&gs.length>0&&(kt=At(gs[0],Ft.N.Logs,"Logs for this span","gf-logs"));const as=xn?.filter(Us=>Us.type===Ft.N.Profiles&&Us.title===Vt.cd);xn&&as&&as.length>0&&(qt=At(as[0],Ft.N.Profiles,"Profiles for this span","link"));const $s=xn?.filter(Us=>Us.type===Ft.N.Session);xn&&$s&&$s.length>0&&(gn=At($s[0],Ft.N.Session,"Session for this span","frontend-observability"))}const Bn=vs(lo,ir);return(0,t.jsxs)("div",{"data-testid":"span-detail-component",children:[(0,t.jsxs)("div",{className:nt.header,children:[(0,t.jsx)("h2",{className:nt.operationName,children:Lr}),(0,t.jsx)("div",{className:nt.listWrapper,children:(0,t.jsx)(zt,{className:nt.list,divider:!0,items:_e})})]}),(0,t.jsxs)("div",{className:nt.linkList,children:[kt,qt,gn]}),(0,t.jsx)(vt.c,{spacing:1}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(tn,{data:ws,label:"Span Attributes",linksGetter:qe,isOpen:Ra,onToggle:()=>dn(ir)}),qa.tags&&(0,t.jsx)(tn,{className:nt.AccordianKeyValuesItem,data:qa.tags,label:"Resource Attributes",linksGetter:qe,isOpen:Ga,onToggle:()=>_t(ir)})]}),ss&&ss.length>0&&(0,t.jsx)(kn,{linksGetter:qe,logs:ss,isOpen:ar.isOpen,openedItems:ar.openedItems,onToggle:()=>Tt(ir),onItemToggle:xn=>ut(ir,xn),timestamp:Dn}),Ds&&Ds.length>0&&(0,t.jsx)(gt,{className:nt.AccordianWarnings,headerClassName:nt.AccordianWarningsHeader,label:(0,t.jsx)("span",{className:nt.AccordianWarningsLabel,children:"Warnings"}),data:Ds,isOpen:La,onToggle:()=>os(ir)}),Ge?.length?(0,t.jsx)(gt,{label:"Stack trace",data:Ge,isOpen:Or,TextComponent:xn=>{let gs;return xn.data?.length>1?gs=xn.data.map((as,$s)=>`StackTrace ${$s+1}:
${as}`).join(`
`):gs=xn.data?.[0],(0,t.jsx)(Pt.f,{className:nt.Textarea,style:{cursor:"unset"},readOnly:!0,cols:10,rows:10,value:gs})},onToggle:()=>us(ir)}):null,Ws&&Ws.length>0&&(Ws.length>1||Ws[0].refType!=="CHILD_OF")&&(0,t.jsx)(Nn,{data:Ws,isOpen:na.isOpen,openedItems:na.openedItems,onToggle:()=>hs(ir),onItemToggle:xn=>Js(ir,xn),createFocusSpanLink:vs}),Zt.tags.some(xn=>xn.key===Jt.QW)&&(0,t.jsx)(Sn,{span:Zt,timeZone:Le,traceFlameGraphs:ea,setTraceFlameGraphs:oa,traceToProfilesOptions:As,setRedrawListView:ta,traceDuration:An,traceName:rs}),(0,t.jsxs)("small",{className:nt.debugInfo,children:[(0,t.jsx)("a",{...Bn,onClick:xn=>{Bn.onClick&&xn.button===0&&(!xn.currentTarget.target||xn.currentTarget.target==="_self")&&!(xn.metaKey||xn.altKey||xn.ctrlKey||xn.shiftKey)&&(xn.preventDefault(),Bn.onClick(xn))},children:(0,t.jsx)(Ke.I,{name:"link",className:u()(On,nt.LinkIcon)})}),(0,t.jsx)("span",{className:nt.debugLabel,"data-label":"SpanID:"})," ",ir]})]})]})}const Ot=(Fe,Ve)=>{const qe=(0,at.LE)(Fe/1e3,{timeZone:Ve,defaultWithMS:!0}),ut=qe.split(" ");return` (${ut[1]?ut[1]:qe})`},jt=Fe=>({container:(0,n.css)({textOverflow:"ellipsis"}),header:(0,n.css)`
      label: header;
      cursor: pointer;
      overflow: hidden;
      padding: 0.25em 0.1em;
      text-overflow: ellipsis;
      white-space: nowrap;
      &:hover {
        background: ${(0,c.R)(Fe,"#e8e8e8")};
      }
    `,headerEmpty:(0,n.css)`
      label: headerEmpty;
      background: none;
      cursor: initial;
    `,headerHighContrast:(0,n.css)`
      label: headerHighContrast;
      &:hover {
        background: ${(0,c.R)(Fe,"#ddd")};
      }
    `,emptyIcon:(0,n.css)`
      label: emptyIcon;
      color: ${(0,c.R)(Fe,"#aaa")};
    `,summary:(0,n.css)`
      label: summary;
      display: inline;
      list-style: none;
      padding: 0;
    `,summaryItem:(0,n.css)`
      label: summaryItem;
      display: inline;
      margin-left: 0.7em;
      padding-right: 0.5rem;
      border-right: 1px solid ${(0,c.R)(Fe,"#ddd")};
      &:last-child {
        padding-right: 0;
        border-right: none;
      }
    `,summaryLabel:(0,n.css)`
      label: summaryLabel;
      color: ${(0,c.R)(Fe,"#777")};
    `,summaryDelim:(0,n.css)`
      label: summaryDelim;
      color: ${(0,c.R)(Fe,"#bbb")};
      padding: 0 0.2em;
    `});function rt({data:Fe=null}){const Ve=(0,a.of)(jt);return!Array.isArray(Fe)||!Fe.length?null:(0,t.jsx)("ul",{className:Ve.summary,children:Fe.map((qe,ut)=>(0,t.jsxs)("li",{className:Ve.summaryItem,children:[(0,t.jsx)("span",{className:Ve.summaryLabel,children:qe.key}),(0,t.jsx)("span",{className:Ve.summaryDelim,children:"="}),String(qe.value)]},`${qe.key}-${ut}`))})}function tn({className:Fe=null,data:Ve,highContrast:qe=!1,interactive:ut=!0,isOpen:Tt,label:_t,linksGetter:Zt,onToggle:dn=null}){const Dn=!Array.isArray(Ve)||!Ve.length,An=(0,a.of)(jt),rs=u()(On,{[An.emptyIcon]:Dn});let os=null,us=null;return ut&&(os=Tt?(0,t.jsx)(Ke.I,{name:"angle-down",className:rs}):(0,t.jsx)(Ke.I,{name:"angle-right",className:rs}),us={"aria-checked":Tt,onClick:Dn?null:dn,role:"switch"}),(0,t.jsxs)("div",{className:u()(Fe,An.container),children:[(0,t.jsxs)("div",{className:u()(An.header,{[An.headerEmpty]:Dn,[An.headerHighContrast]:qe&&!Dn}),...us,"data-testid":"AccordianKeyValues--header",children:[os,(0,t.jsxs)("strong",{"data-test":ot,children:[_t,Tt||":"]}),!Tt&&(0,t.jsx)(rt,{data:Ve})]}),Tt&&(0,t.jsx)(Ie,{data:Ve,linksGetter:Zt})]})}const Mn=Fe=>({AccordianLogs:(0,n.css)`
      label: AccordianLogs;
      border: 1px solid ${(0,c.R)(Fe,"#d8d8d8")};
      position: relative;
      margin-bottom: 0.25rem;
    `,AccordianLogsHeader:(0,n.css)`
      label: AccordianLogsHeader;
      background: ${(0,c.R)(Fe,"#e4e4e4")};
      color: inherit;
      display: block;
      padding: 0.25rem 0.5rem;
      &:hover {
        background: ${(0,c.R)(Fe,"#dadada")};
      }
    `,AccordianLogsContent:(0,n.css)`
      label: AccordianLogsContent;
      background: ${(0,c.R)(Fe,"#f0f0f0")};
      border-top: 1px solid ${(0,c.R)(Fe,"#d8d8d8")};
      padding: 0.5rem 0.5rem 0.25rem 0.5rem;
    `,AccordianLogsFooter:(0,n.css)`
      label: AccordianLogsFooter;
      color: ${(0,c.R)(Fe,"#999")};
    `,AccordianKeyValuesItem:(0,n.css)({marginBottom:Fe.spacing(.5)})});function kn({interactive:Fe=!0,isOpen:Ve,linksGetter:qe,logs:ut,openedItems:Tt,onItemToggle:_t,onToggle:Zt,timestamp:dn}){let Dn=null,An="span",rs=null;Fe&&(Dn=Ve?(0,t.jsx)(Ke.I,{name:"angle-down",className:On}):(0,t.jsx)(Ke.I,{name:"angle-right",className:"u-align-icon"}),An="a",rs={"aria-checked":Ve,onClick:Zt,role:"switch"});const os=(0,a.of)(Mn);return(0,t.jsxs)("div",{className:os.AccordianLogs,children:[(0,t.jsxs)(An,{className:os.AccordianLogsHeader,...rs,children:[Dn," ",(0,t.jsx)("strong",{children:"Events"})," (",ut.length,")"]}),Ve&&(0,t.jsxs)("div",{className:os.AccordianLogsContent,children:[(0,ce.sortBy)(ut,"timestamp").map((us,hs)=>(0,t.jsx)(tn,{className:hs<ut.length-1?os.AccordianKeyValuesItem:null,data:us.fields||[],highContrast:!0,interactive:Fe,isOpen:Tt?Tt.has(us):!1,label:`${(0,D.a3)(us.timestamp-dn)}`,linksGetter:qe,onToggle:Fe&&_t?()=>_t(us):null},`${us.timestamp}-${hs}`)),(0,t.jsx)("small",{className:os.AccordianLogsFooter,children:"Log timestamps are relative to the start time of the full trace."})]})]})}const Yn=Fe=>({wrapper:(0,n.css)({label:"wrapper",bottom:0,left:0,position:"absolute",right:0,top:0,overflow:"hidden",zIndex:0}),bar:(0,n.css)({label:"bar",borderRadius:Fe.shape.radius.default,minWidth:"2px",position:"absolute",height:"36%",top:"32%"}),rpc:(0,n.css)({label:"rpc",position:"absolute",top:"35%",bottom:"35%",zIndex:1}),label:(0,n.css)({label:"label",color:"#aaa",fontSize:"12px",fontFamily:"'Helvetica Neue', Helvetica, Arial, sans - serif",lineHeight:"1em",whiteSpace:"nowrap",padding:"0 0.5em",position:"absolute"}),logMarker:(0,n.css)({label:"logMarker",backgroundColor:(0,c.R)(Fe,"#2c3235"),cursor:"pointer",height:"60%",minWidth:"1px",position:"absolute",top:"20%","&:hover":{backgroundColor:(0,c.R)(Fe,"#464c54")},"&::before, &::after":{content:"''",position:"absolute",top:0,bottom:0,right:0,border:"1px solid transparent"},"&::after":{left:0}}),criticalPath:(0,n.css)({position:"absolute",top:"45%",height:"11%",zIndex:2,overflow:"hidden",background:(0,c.R)(Fe,"#f1f1f1"),borderLeft:`1px solid ${(0,c.R)(Fe,"#2c3235")}`,borderRight:`1px solid ${(0,c.R)(Fe,"#2c3235")}`})});function Wn(Fe){return`${(Fe*100).toFixed(1)}%`}function Jn(Fe){return`${Fe*100}%`}function Ls({criticalPath:Fe,viewEnd:Ve,viewStart:qe,getViewedBounds:ut,color:Tt,shortLabel:_t,longLabel:Zt,onClick:dn,rpc:Dn,traceStartTime:An,span:rs,className:os,labelClassName:us}){const[hs,Js]=(0,i.useState)(_t),Os=()=>Js(_t),vs=()=>Js(Zt),Cs=(0,ce.groupBy)(rs.logs,oa=>{const As=ut(oa.timestamp,oa.timestamp).start;return Wn(Math.round(As*500)/500)}),ea=(0,a.of)(Yn);return(0,t.jsxs)("div",{className:u()(ea.wrapper,os),onBlur:Os,onClick:dn,onFocus:vs,onMouseOut:Os,onMouseOver:vs,"aria-hidden":!0,"data-testid":Xe.Tp.components.TraceViewer.spanBar,children:[(0,t.jsx)("div",{"aria-label":hs,className:u()(ea.bar),style:{background:Tt,left:Wn(qe),width:Wn(Ve-qe)},children:(0,t.jsx)("div",{className:u()(ea.label,us),"data-testid":"SpanBar--label",children:hs})}),(0,t.jsx)("div",{children:Object.keys(Cs).map(oa=>(0,t.jsx)(xt,{content:(0,t.jsx)(kn,{interactive:!1,isOpen:!0,logs:Cs[oa],timestamp:An}),children:(0,t.jsx)("div",{"data-testid":"SpanBar--logMarker",className:u()(ea.logMarker),style:{left:oa}})},oa))}),Dn&&(0,t.jsx)("div",{className:u()(ea.rpc),style:{background:Dn.color,left:Wn(Dn.viewStart),width:Wn(Dn.viewEnd-Dn.viewStart)}}),Fe?.map((oa,As)=>{const ta=ut(oa.section_start,oa.section_end),Ra=ta.start,Ga=ta.end,ar=`${oa.spanId}-${As}`;return(0,t.jsx)(Je.m,{placement:"top",content:(0,t.jsxs)("div",{children:["A segment on the ",(0,t.jsx)("em",{children:"critical path"})," of the overall trace / request / workflow."]}),children:(0,t.jsx)("div",{"data-testid":"SpanBar--criticalPath",className:ea.criticalPath,style:{left:Jn(Ra),width:Jn(Ga-Ra)}})},ar)})]})}const fs=i.memo(Ls);var ys=e(64539),Xn=e(28122);const Ps=(Fe,Ve,qe,ut)=>(Fe.sort(function(Tt,_t){return(Tt.title||"link").toLowerCase().localeCompare((_t.title||"link").toLowerCase())}),Fe.map((Tt,_t)=>(0,t.jsx)(ys.D,{label:Tt.title||"Link",onClick:Tt.onClick?Zt=>{(0,s.rR)("grafana_traces_trace_view_span_link_clicked",{datasourceType:ut,grafana_version:r.$.buildInfo.version,type:Tt.type,location:"menu"}),Zt?.preventDefault(),Tt.onClick(Zt),qe()}:void 0,url:Tt.href,className:Ve.menuItem},_t))),Zs=({links:Fe,datasourceType:Ve,color:qe})=>{const ut=(0,a.of)(()=>Ms(qe)),[Tt,_t]=(0,i.useState)(!1),[Zt,dn]=(0,i.useState)({x:0,y:0}),Dn=()=>_t(!1);return(0,t.jsxs)("div",{"data-testid":"SpanLinksMenu",className:ut.wrapper,children:[(0,t.jsx)("button",{onClick:An=>{_t(!0),dn({x:An.pageX,y:An.pageY})},className:ut.button,children:(0,t.jsx)(Ke.I,{name:"link",className:ut.icon})}),Tt?(0,t.jsx)(Xn.t,{onClose:()=>_t(!1),renderMenuItems:()=>Ps(Fe,ut,Dn,Ve),focusOnOpen:!1,x:Zt.x,y:Zt.y}):null]})},Ms=Fe=>({wrapper:(0,n.css)`
      border: none;
      background: ${Fe}10;
      border-bottom: 1px solid ${Fe}CF;
      padding-right: 4px;
    `,button:(0,n.css)`
      background: transparent;
      border: none;
      padding: 0;
    `,icon:(0,n.css)`
      background: transparent;
      border: none;
      padding: 0;
    `,menuItem:(0,n.css)`
      max-width: 60ch;
      overflow: hidden;
    `});function ks(Fe){return(0,ce.get)((0,ce.find)(Fe.references,({span:Ve,refType:qe})=>Ve&&Ve.spanID&&(qe==="CHILD_OF"||qe==="FOLLOWS_FROM")),"span")}function wa(Fe){const Ve=[];if(!Fe)return Ve;let qe=ks(Fe);for(;qe;)Ve.push(qe.spanID),qe=ks(qe);return Ve}const Xa=(0,f.N)(Fe=>({SpanTreeOffset:(0,n.css)`
      label: SpanTreeOffset;
      color: ${(0,c.R)(Fe,"#000")};
      position: relative;
    `,SpanTreeOffsetParent:(0,n.css)`
      label: SpanTreeOffsetParent;
      &:hover {
        cursor: pointer;
      }
    `,indentGuide:(0,n.css)`
      label: indentGuide;
      /* The size of the indentGuide is based off of the iconWrapper */
      padding-right: 1rem;
      height: 100%;
      display: inline-flex;
      transition: padding 300ms ease-out;
      &::before {
        content: '';
        padding-left: 1px;
        background-color: ${(0,c.R)(Fe,"lightgrey")};
      }
    `,indentGuideActive:(0,n.css)`
      label: indentGuideActive;
      &::before {
        background-color: ${(0,c.R)(Fe,"#777")};
      }
    `,indentGuideThin:(0,n.css)`
      padding-right: 0.3rem;
    `,iconWrapper:(0,n.css)`
      label: iconWrapper;
      position: absolute;
      right: 0;
    `}));class pa extends i.PureComponent{constructor(Ve){super(Ve),this.handleMouseLeave=(qe,ut)=>{(!(qe.relatedTarget instanceof HTMLSpanElement)||(0,ce.get)(qe,"relatedTarget.dataset.ancestorId")!==ut)&&this.props.removeHoverIndentGuideId(ut)},this.handleMouseEnter=(qe,ut)=>{(!(qe.relatedTarget instanceof HTMLSpanElement)||(0,ce.get)(qe,"relatedTarget.dataset.ancestorId")!==ut)&&this.props.addHoverIndentGuideId(ut)},this.ancestorIds=wa(Ve.span),this.ancestorIds.push("root"),this.ancestorIds.reverse()}static{this.displayName="UnthemedSpanTreeOffset"}static{this.defaultProps={childrenVisible:!1,showChildrenIcon:!0}}render(){const{childrenVisible:Ve,onClick:qe,showChildrenIcon:ut,span:Tt,theme:_t,visibleSpanIds:Zt}=this.props,{hasChildren:dn,spanID:Dn}=Tt,An=dn?{onClick:qe,role:"switch","aria-checked":Ve}:null,rs=ut&&dn&&(Ve?(0,t.jsx)(Ke.I,{name:"angle-down","data-testid":"icon-arrow-down",size:"sm"}):(0,t.jsx)(Ke.I,{name:"angle-right","data-testid":"icon-arrow-right",size:"sm"})),os=Xa(_t);return(0,t.jsxs)("span",{className:u()(os.SpanTreeOffset,{[os.SpanTreeOffsetParent]:dn}),...An,children:[this.ancestorIds.map((us,hs)=>(0,t.jsx)("span",{className:u()(os.indentGuide,{[os.indentGuideActive]:this.props.hoverIndentGuideIds.has(us),[os.indentGuideThin]:hs!==this.ancestorIds.length-1&&us!=="root"&&!Zt.includes(us)}),"data-ancestor-id":us,"data-testid":"SpanTreeOffset--indentGuide",onMouseEnter:Js=>this.handleMouseEnter(Js,us),onMouseLeave:Js=>this.handleMouseLeave(Js,us)},us)),rs&&(0,t.jsx)("span",{className:os.iconWrapper,onMouseEnter:us=>this.handleMouseEnter(us,Dn),onMouseLeave:us=>this.handleMouseLeave(us,Dn),"data-testid":"icon-wrapper",children:rs})]})}}const Ba=(0,a.cV)(pa),_a="spanBar",dr="spanBarLabel",Wa="nameWrapper",en="nameWrapperMatchingFilter",$n="jaegerView",Qn="nameColumn",Gn=(0,f.N)((Fe,Ve)=>{const qe={label:"flash",flash:(0,n.keyframes)`
    from {
      background-color: ${(0,c.R)(Fe,"#68b9ff")};
    }
    to {
      background-color: 'default';
    }
  `},ut=Ve?"":(0,c.R)(Fe,"#fffce4");return{nameWrapper:(0,n.css)`
      label: nameWrapper;
      line-height: 27px;
      overflow: hidden;
      display: flex;
    `,nameWrapperMatchingFilter:(0,n.css)`
      label: nameWrapperMatchingFilter;
      background-color: ${ut};
    `,nameColumn:(0,n.css)`
      label: nameColumn;
      position: relative;
      white-space: nowrap;
      z-index: 1;
      &:hover {
        z-index: 1;
      }
    `,endpointName:(0,n.css)`
      label: endpointName;
      color: ${(0,c.R)(Fe,"#484848")};
      font-size: 0.9em;
    `,view:(0,n.css)`
      label: view;
      position: relative;
    `,viewExpanded:(0,n.css)`
      label: viewExpanded;
      background: ${(0,c.R)(Fe,"#f8f8f8")};
      outline: 1px solid ${(0,c.R)(Fe,"#ddd")};
    `,viewExpandedAndMatchingFilter:(0,n.css)`
      label: viewExpandedAndMatchingFilter;
      background: ${(0,c.R)(Fe,"#fff3d7")};
      outline: 1px solid ${(0,c.R)(Fe,"#ddd")};
    `,row:(0,n.css)`
      label: row;
      font-size: 0.9em;
      &:hover .${_a} {
        opacity: 1;
      }
      &:hover .${dr} {
        color: ${(0,c.R)(Fe,"#000")};
      }
      &:hover .${Wa} {
        background: #f8f8f8;
        background: linear-gradient(
          90deg,
          ${(0,c.R)(Fe,"#fafafa")},
          ${(0,c.R)(Fe,"#f8f8f8")} 75%,
          ${(0,c.R)(Fe,"#eee")}
        );
      }
      &:hover .${$n} {
        background-color: ${(0,c.R)(Fe,"#f5f5f5")};
        outline: 1px solid ${(0,c.R)(Fe,"#ddd")};
      }
    `,rowClippingLeft:(0,n.css)`
      label: rowClippingLeft;
      & .${Qn}::before {
        content: ' ';
        height: 100%;
        position: absolute;
        width: 6px;
        background-image: linear-gradient(
          to right,
          ${(0,c.R)(Fe,"rgba(25, 25, 25, 0.25)")},
          ${(0,c.R)(Fe,"rgba(32, 32, 32, 0)")}
        );
        left: 100%;
        z-index: -1;
      }
    `,rowClippingRight:(0,n.css)`
      label: rowClippingRight;
      & .${$n}::before {
        content: ' ';
        height: 100%;
        position: absolute;
        width: 6px;
        background-image: linear-gradient(
          to left,
          ${(0,c.R)(Fe,"rgba(25, 25, 25, 0.25)")},
          ${(0,c.R)(Fe,"rgba(25, 25, 25, 0.25)")}
        );
        right: 0%;
        z-index: 1;
      }
    `,rowExpanded:(0,n.css)`
      label: rowExpanded;
      & .${_a} {
        opacity: 1;
      }
      & .${dr} {
        color: ${(0,c.R)(Fe,"#000")};
      }
      & .${Wa}, &:hover .${Wa} {
        background: ${(0,c.R)(Fe,"#f0f0f0")};
        box-shadow: 0 1px 0 ${(0,c.R)(Fe,"#ddd")};
      }
      & .${en} {
        background: ${(0,c.R)(Fe,"#fff3d7")};
      }
      &:hover .${$n} {
        background: ${(0,c.R)(Fe,"#eee")};
      }
    `,rowMatchingFilter:(0,n.css)`
      label: rowMatchingFilter;
      // background-color: ${(0,c.R)(Fe,"#fffbde")};
      &:hover .${Wa} {
        background: linear-gradient(
          90deg,
          ${(0,c.R)(Fe,"#fffbde")},
          ${(0,c.R)(Fe,"#fffbde")} 75%,
          ${(0,c.R)(Fe,"#f7f1c6")}
        );
      }
      &:hover .${$n} {
        background-color: ${(0,c.R)(Fe,"#f7f1c6")};
        outline: 1px solid ${(0,c.R)(Fe,"#ddd")};
      }
    `,rowFocused:(0,n.css)`
      label: rowFocused;
      background-color: ${(0,c.R)(Fe,"#cbe7ff")};
      animation: ${qe.flash} 1s cubic-bezier(0.12, 0, 0.39, 0);
      & .${Wa}, .${$n}, .${en} {
        background-color: ${(0,c.R)(Fe,"#cbe7ff")};
        animation: ${qe.flash} 1s cubic-bezier(0.12, 0, 0.39, 0);
      }
      & .${_a} {
        opacity: 1;
      }
      & .${dr} {
        color: ${(0,c.R)(Fe,"#000")};
      }
      &:hover .${Wa}, :hover .${$n} {
        background: ${(0,c.R)(Fe,"#d5ebff")};
        box-shadow: 0 1px 0 ${(0,c.R)(Fe,"#ddd")};
      }
    `,rowExpandedAndMatchingFilter:(0,n.css)`
      label: rowExpandedAndMatchingFilter;
      &:hover .${$n} {
        background: ${(0,c.R)(Fe,"#ffeccf")};
      }
    `,name:(0,n.css)`
      label: name;
      color: ${(0,c.R)(Fe,"#000")};
      cursor: pointer;
      flex: 1 1 auto;
      outline: none;
      overflow-y: hidden;
      overflow-x: auto;
      padding-left: 4px;
      padding-right: 0.25em;
      position: relative;
      -ms-overflow-style: none;
      scrollbar-width: none;
      &::-webkit-scrollbar {
        display: none;
      }
      &:focus {
        text-decoration: none;
      }
      &:hover > span {
        color: ${(0,c.R)(Fe,"#000")};
      }
      text-align: left;
      background: transparent;
      border: none;
      border-bottom-width: 1px;
      border-bottom-style: solid;
    `,nameDetailExpanded:(0,n.css)`
      label: nameDetailExpanded;
      &::before {
        bottom: 0;
      }
    `,svcName:(0,n.css)`
      label: svcName;
      font-size: 0.9em;
      font-weight: bold;
      margin-right: 0.25rem;
    `,svcNameChildrenCollapsed:(0,n.css)`
      label: svcNameChildrenCollapsed;
      font-weight: bold;
      font-style: italic;
    `,errorIcon:(0,n.css)`
      label: errorIcon;
      border-radius: 6.5px;
      color: ${(0,c.R)(Fe,"#fff")};
      font-size: 0.85em;
      margin-right: 0.25rem;
      padding: 1px;
    `,rpcColorMarker:(0,n.css)`
      label: rpcColorMarker;
      border-radius: 6.5px;
      display: inline-block;
      font-size: 0.85em;
      height: 1em;
      margin-right: 0.25rem;
      padding: 1px;
      width: 1em;
      vertical-align: middle;
    `,labelRight:(0,n.css)`
      label: labelRight;
      left: 100%;
    `,labelLeft:(0,n.css)`
      label: labelLeft;
      right: 100%;
    `}});class qn extends i.PureComponent{constructor(){super(...arguments),this._detailToggle=()=>{this.props.onDetailToggled(this.props.span.spanID)},this._childrenToggle=()=>{this.props.onChildrenToggled(this.props.span.spanID)},this.getSpanBarLabel=(Ve,qe,ut)=>{const Tt=qe?.type??"";if(Tt===He)return"";if(Tt===""||Tt===Be)return`(${ut})`;if(Tt===Ne){const _t=qe?.tag?.trim()??"";if(_t!==""&&Ve.tags){const Zt=Ve.tags?.find(Dn=>Dn.key===_t);if(Zt)return`(${Zt.value})`;const dn=Ve.process?.tags?.find(Dn=>Dn.key===_t);if(dn)return`(${dn.value})`}}return""}}static{this.displayName="UnthemedSpanBarRow"}static{this.defaultProps={className:"",rpc:null}}render(){const{className:Ve,color:qe,spanBarOptions:ut,columnDivision:Tt,isChildrenExpanded:_t,isDetailExpanded:Zt,isMatchingFilter:dn,showSpanFilterMatchesOnly:Dn,isFocused:An,numTicks:rs,rpc:os,noInstrumentedServer:us,showErrorIcon:hs,getViewedBounds:Js,traceStartTime:Os,span:vs,hoverIndentGuideIds:Cs,addHoverIndentGuideId:ea,removeHoverIndentGuideId:oa,clippingLeft:As,clippingRight:ta,theme:Ra,createSpanLink:Ga,datasourceType:ar,showServiceName:La,visibleSpanIds:na,criticalPath:Or}=this.props,{duration:Lr,hasChildren:qa,operationName:_r,process:{serviceName:io}}=vs,Pr=(0,D.a3)(Lr),lo=Js(vs.startTime,vs.startTime+vs.duration),ir=lo.start,ss=lo.end,ws=Gn(Ra,Dn),Ds=`${io}::${_r}`;let Ws,Ge;return ir>1-ss?(Ws=`${Ds} | ${Pr}`,Ge=ws.labelLeft):(Ws=`${Pr} | ${Ds}`,Ge=ws.labelRight),(0,t.jsxs)(K,{className:u()(ws.row,{[ws.rowExpanded]:Zt,[ws.rowMatchingFilter]:dn,[ws.rowExpandedAndMatchingFilter]:dn&&Zt,[ws.rowFocused]:An,[ws.rowClippingLeft]:As,[ws.rowClippingRight]:ta},Ve),children:[(0,t.jsx)(K.Cell,{className:u()(ws.nameColumn,Qn),width:Tt,children:(0,t.jsxs)("div",{className:u()(ws.nameWrapper,Wa,{[ws.nameWrapperMatchingFilter]:dn,nameWrapperMatchingFilter:dn}),children:[(0,t.jsx)(Ba,{onClick:qa?this._childrenToggle:void 0,childrenVisible:_t,span:vs,hoverIndentGuideIds:Cs,addHoverIndentGuideId:ea,removeHoverIndentGuideId:oa,visibleSpanIds:na}),(0,t.jsxs)("button",{type:"button",className:u()(ws.name,{[ws.nameDetailExpanded]:Zt}),"aria-checked":Zt,title:Ds,onClick:this._detailToggle,role:"switch",style:{background:`${qe}10`,borderBottomColor:`${qe}CF`},tabIndex:0,children:[hs&&(0,t.jsx)(Ke.I,{name:"exclamation-circle",style:{backgroundColor:vs.errorIconColor?(0,c.R)(Ra,vs.errorIconColor):(0,c.R)(Ra,"#db2828")},className:ws.errorIcon}),La&&(0,t.jsx)("span",{className:u()(ws.svcName,{[ws.svcNameChildrenCollapsed]:qa&&!_t}),children:`${io} `}),os&&(0,t.jsxs)("span",{children:[(0,t.jsx)(Ke.I,{name:"arrow-right"})," ",(0,t.jsx)("i",{className:ws.rpcColorMarker,style:{background:os.color}}),os.serviceName]}),us&&(0,t.jsxs)("span",{children:[(0,t.jsx)(Ke.I,{name:"arrow-right"})," ",(0,t.jsx)("i",{className:ws.rpcColorMarker,style:{background:us.color}}),us.serviceName]}),(0,t.jsx)("span",{className:ws.endpointName,children:os?os.operationName:_r}),(0,t.jsxs)("span",{className:ws.endpointName,children:[" ",this.getSpanBarLabel(vs,ut,Pr)]})]}),Ga&&(()=>{const Le=Ga(vs),_e=Le?.length||0;return Le&&_e===1?Le[0]?(0,t.jsx)("a",{href:Le[0].href,target:"_blank",style:{background:`${qe}10`,borderBottom:`1px solid ${qe}CF`,paddingRight:"4px"},rel:"noopener noreferrer",onClick:Le[0].onClick?nt=>{!(nt.ctrlKey||nt.metaKey||nt.shiftKey)&&Le[0].onClick&&(nt.preventDefault(),Le[0].onClick(nt))}:void 0,children:Le[0].content}):null:Le&&_e>1?(0,t.jsx)(Zs,{links:Le,datasourceType:ar,color:qe}):null})()]})}),(0,t.jsxs)(K.Cell,{className:u()(ws.view,$n,{[ws.viewExpanded]:Zt,[ws.viewExpandedAndMatchingFilter]:dn&&Zt}),"data-testid":"span-view",style:{cursor:"pointer"},width:1-Tt,onClick:this._detailToggle,children:[(0,t.jsx)(B,{numTicks:rs}),(0,t.jsx)(fs,{criticalPath:Or,rpc:os,viewStart:ir,viewEnd:ss,getViewedBounds:Js,color:qe,shortLabel:Pr,longLabel:Ws,traceStartTime:Os,span:vs,labelClassName:`${dr} ${Ge}`,className:_a})]})]})}}const es=(0,a.cV)(qn),Ss=(0,f.N)(Fe=>({expandedAccent:(0,n.css)`
      cursor: pointer;
      height: 100%;
      overflow: hidden;
      position: absolute;
      width: 100%;
      &::before {
        border-left: 1px solid;
        pointer-events: none;
        width: 1000px;
      }
      &::after {
        border-right: 1000px solid;
        border-color: inherit;
        cursor: pointer;
        opacity: 0.2;
      }

      /* border-color inherit must come AFTER other border declarations for accent */
      &::before,
      &::after {
        border-color: inherit;
        content: ' ';
        position: absolute;
        height: 100%;
      }

      &:hover::after {
        opacity: 0.35;
      }
    `,infoWrapper:(0,n.css)`
      label: infoWrapper;
      border: 1px solid ${(0,c.R)(Fe,"#d3d3d3")};
      border-top: 3px solid;
      padding: 0.75rem;
    `}));class _s extends i.PureComponent{constructor(){super(...arguments),this._detailToggle=()=>{this.props.onDetailToggled(this.props.span.spanID)},this._linksGetter=(Ve,qe)=>{const{linksGetter:ut,span:Tt}=this.props;return ut(Tt,Ve,qe)}}render(){const{color:Ve,columnDivision:qe,detailState:ut,logItemToggle:Tt,logsToggle:_t,processToggle:Zt,referenceItemToggle:dn,referencesToggle:Dn,warningsToggle:An,stackTracesToggle:rs,span:os,traceToProfilesOptions:us,timeZone:hs,tagsToggle:Js,traceStartTime:Os,traceDuration:vs,traceName:Cs,hoverIndentGuideIds:ea,addHoverIndentGuideId:oa,removeHoverIndentGuideId:As,theme:ta,createSpanLink:Ra,focusedSpanId:Ga,createFocusSpanLink:ar,datasourceType:La,visibleSpanIds:na,traceFlameGraphs:Or,setTraceFlameGraphs:Lr,setRedrawListView:qa}=this.props,_r=Ss(ta);return(0,t.jsxs)(K,{children:[(0,t.jsxs)(K.Cell,{width:qe,style:{overflow:"hidden"},children:[(0,t.jsx)(Ba,{span:os,showChildrenIcon:!1,hoverIndentGuideIds:ea,addHoverIndentGuideId:oa,removeHoverIndentGuideId:As,visibleSpanIds:na}),(0,t.jsx)($e.$n,{fill:"text",onClick:this._detailToggle,className:u()(_r.expandedAccent,(0,$e.my)(ta)),style:{borderColor:Ve},"data-testid":"detail-row-expanded-accent"})]}),(0,t.jsx)(K.Cell,{width:1-qe,children:(0,t.jsx)("div",{className:_r.infoWrapper,style:{borderTopColor:Ve},children:(0,t.jsx)(Rt,{detailState:ut,linksGetter:this._linksGetter,logItemToggle:Tt,logsToggle:_t,processToggle:Zt,referenceItemToggle:dn,referencesToggle:Dn,warningsToggle:An,stackTracesToggle:rs,span:os,traceToProfilesOptions:us,timeZone:hs,tagsToggle:Js,traceStartTime:Os,traceDuration:vs,traceName:Cs,createSpanLink:Ra,focusedSpanId:Ga,createFocusSpanLink:ar,datasourceType:La,traceFlameGraphs:Or,setTraceFlameGraphs:Lr,setRedrawListView:qa})})})]})}}const Pa=(0,a.cV)(_s),Ea=(0,f.N)(()=>({rowsWrapper:(0,n.css)`
      width: 100%;
    `,row:(0,n.css)`
      width: 100%;
    `,scrollToTopButton:(0,n.css)`
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      width: 40px;
      height: 40px;
      position: absolute;
      bottom: 30px;
      right: 30px;
      z-index: 1;
    `})),Ys={bar:28,detail:161,detailWithLogs:197},ha=5,ja=33;function ua(Fe,Ve,qe,ut,Tt,_t,Zt){if(!Fe)return[];Tt&&ut&&(Fe=Fe.filter(An=>ut.has(An.spanID))),_t&&Zt&&(Fe=Fe.filter(An=>Zt.find(rs=>rs.spanId===An.spanID)));let dn=null;const Dn=[];for(let An=0;An<Fe.length;An++){const rs=Fe[An],{spanID:os,depth:us}=rs;let hs=!1;dn!=null&&(us>=dn?hs=!0:dn=null),!hs&&(Ve.has(os)&&(dn=us+1),Dn.push({span:rs,isDetail:!1,spanIndex:An}),qe.has(os)&&Dn.push({span:rs,isDetail:!0,spanIndex:An}))}return Dn}function za(Fe){const[Ve,qe]=Fe;return{left:Ve>0,right:qe<1}}function Ja(Fe,Ve,qe,ut,Tt,_t,Zt){return Fe?ua(Fe.spans,Ve,qe,ut,Tt,_t,Zt):[]}function pr(Fe){const Ve=new Map;return Fe&&Fe.spans.forEach(qe=>{qe.childSpanIds.length&&Ve.set(qe.spanID,qe.childSpanIds)}),Ve}const Wr=(0,me.A)(Ja),Fr=(0,me.A)(P,ce.isEqual),Kr=(0,me.A)(za,ce.isEqual),Ar=(0,me.A)(pr);class $r extends i.Component{constructor(){super(...arguments),this.hasScrolledToSpan=!1,this.getViewRange=()=>this.props.currentViewRangeTime,this.getSearchedSpanIDs=()=>this.props.findMatchesIDs,this.getCollapsedChildren=()=>this.props.childrenHiddenIDs,this.mapRowIndexToSpanIndex=Ve=>this.getRowStates()[Ve].spanIndex,this.mapSpanIndexToRowIndex=Ve=>{const qe=this.getRowStates().length;for(let ut=0;ut<qe;ut++){const{spanIndex:Tt}=this.getRowStates()[ut];if(Tt===Ve)return ut}throw new Error(`unable to find row for span index: ${Ve}`)},this.setListView=Ve=>{this.listView=Ve},this.getKeyFromIndex=Ve=>{const{isDetail:qe,span:ut}=this.getRowStates()[Ve];return`${ut.traceID}--${ut.spanID}--${qe?"detail":"bar"}`},this.getIndexFromKey=Ve=>{const qe=Ve.split("--"),ut=qe[0],Tt=qe[1],_t=qe[2]==="detail",Zt=this.getRowStates().length;for(let dn=0;dn<Zt;dn++){const{span:Dn,isDetail:An}=this.getRowStates()[dn];if(Dn.spanID===Tt&&Dn.traceID===ut&&An===_t)return dn}return-1},this.getRowHeight=Ve=>{const{span:qe,isDetail:ut}=this.getRowStates()[Ve];return ut?Array.isArray(qe.logs)&&qe.logs.length?Ys.detailWithLogs:Ys.detail:Ys.bar},this.renderRow=(Ve,qe,ut,Tt)=>{const{isDetail:_t,span:Zt,spanIndex:dn}=this.getRowStates()[ut],Dn=Math.max((this.listView?.getTopVisibleIndex()||0)-ja,0),An=(this.listView?.getBottomVisibleIndex()||0)+ja,rs=this.getVisibleSpanIds(Dn,An);return _t?this.renderSpanDetailRow(Zt,Ve,qe,Tt,rs):this.renderSpanBarRow(Zt,dn,Ve,qe,Tt,rs)},this.scrollToSpan=(Ve,qe)=>{if(qe==null)return;const ut=this.getRowStates().findIndex(Tt=>Tt.span.spanID===qe);ut>=0&&this.listView?.scrollToIndex(ut,Ve)},this.scrollToTop=()=>{const{topOfViewRef:Ve,datasourceType:qe,trace:ut}=this.props;Ve?.current?.scrollIntoView({behavior:"smooth"}),(0,s.rR)("grafana_traces_trace_view_scroll_to_top_clicked",{datasourceType:qe,grafana_version:r.$.buildInfo.version,numServices:ut.services.length,numSpans:ut.spans.length})},this.getVisibleSpanIds=(0,me.A)((Ve,qe)=>{const ut=[];for(let Tt=Ve;Tt<qe;Tt++){const _t=this.getRowStates()[Tt];_t?.span&&ut.push(_t.span.spanID)}return ut})}componentDidMount(){this.scrollToSpan(this.props.headerHeight,this.props.focusedSpanId)}shouldComponentUpdate(Ve){let qe;for(qe in Ve)if(Ve[qe]!==this.props[qe])return!0;return!1}componentDidUpdate(Ve){const{headerHeight:qe,focusedSpanId:ut,focusedSpanIdForSearch:Tt}=this.props;this.hasScrolledToSpan||(this.scrollToSpan(qe,ut),this.hasScrolledToSpan=!0),ut!==Ve.focusedSpanId&&this.scrollToSpan(qe,ut),Tt!==Ve.focusedSpanIdForSearch&&this.scrollToSpan(qe,Tt)}getRowStates(){const{childrenHiddenIDs:Ve,detailStates:qe,trace:ut,findMatchesIDs:Tt,showSpanFilterMatchesOnly:_t,showCriticalPathSpansOnly:Zt,criticalPath:dn}=this.props;return Wr(ut,Ve,qe,Tt,_t,Zt,dn)}getClipping(){const{currentViewRangeTime:Ve}=this.props;return Kr(Ve)}getViewedBounds(){const{currentViewRangeTime:Ve,trace:qe}=this.props,[ut,Tt]=Ve;return Fr({min:qe.startTime,max:qe.endTime,viewStart:ut,viewEnd:Tt})}getChildSpansMap(){return Ar(this.props.trace)}getAccessors(){const Ve=this.listView;if(!Ve)throw new Error("ListView unavailable");return{getViewRange:this.getViewRange,getSearchedSpanIDs:this.getSearchedSpanIDs,getCollapsedChildren:this.getCollapsedChildren,getViewHeight:Ve.getViewHeight,getBottomRowIndexVisible:Ve.getBottomVisibleIndex,getTopRowIndexVisible:Ve.getTopVisibleIndex,getRowPosition:Ve.getRowPosition,mapRowIndexToSpanIndex:this.mapRowIndexToSpanIndex,mapSpanIndexToRowIndex:this.mapSpanIndexToRowIndex}}renderSpanBarRow(Ve,qe,ut,Tt,_t,Zt){const{spanID:dn,childSpanIds:Dn}=Ve,{serviceName:An}=Ve.process,{childrenHiddenIDs:rs,childrenToggle:os,detailStates:us,detailToggle:hs,findMatchesIDs:Js,spanNameColumnWidth:Os,trace:vs,spanBarOptions:Cs,hoverIndentGuideIds:ea,addHoverIndentGuideId:oa,removeHoverIndentGuideId:As,createSpanLink:ta,focusedSpanId:Ra,focusedSpanIdForSearch:Ga,showSpanFilterMatchesOnly:ar,theme:La,datasourceType:na,criticalPath:Or}=this.props;if(!vs)return null;const Lr=(0,De.Kv)(An,La),qa=rs.has(dn),_r=us.has(dn),io=Js?Js.has(dn):!1,Pr=dn===Ra||dn===Ga,lo=L(Ve)||qa&&U(vs.spans,qe);let ir=null;if(qa){const nt=W(vs.spans.slice(qe));if(nt){const At=this.getViewedBounds()(nt.startTime,nt.startTime+nt.duration);ir={color:(0,De.Kv)(nt.process.serviceName,La),operationName:nt.operationName,serviceName:nt.process.serviceName,viewEnd:At.end,viewStart:At.start}}}const ss=Ve.tags.find(nt=>nt.key===de);let ws=null;!Ve.hasChildren&&ss&&w(Ve)&&(ws={serviceName:ss.value,color:(0,De.Kv)(ss.value,La)});const Ds=qe>0?vs.spans[qe-1]:null,Ws=[dn,...Dn],Ge=nt=>{nt.forEach(At=>{const kt=this.getChildSpansMap().get(At);kt?.length&&(Ws.push(...kt),Ge(kt))})};Ge(Dn);const Le=Or?.filter(nt=>qa?Ws.includes(nt.spanId):nt.spanId===dn),_e=Ea();return(0,t.jsx)("div",{className:_e.row,style:Tt,..._t,children:(0,t.jsx)(es,{clippingLeft:this.getClipping().left,clippingRight:this.getClipping().right,color:Lr,spanBarOptions:Cs,columnDivision:Os,isChildrenExpanded:!qa,isDetailExpanded:_r,isMatchingFilter:io,isFocused:Pr,showSpanFilterMatchesOnly:ar,numTicks:ha,onDetailToggled:hs,onChildrenToggled:os,rpc:ir,noInstrumentedServer:ws,showErrorIcon:lo,getViewedBounds:this.getViewedBounds(),traceStartTime:vs.startTime,span:Ve,hoverIndentGuideIds:ea,addHoverIndentGuideId:oa,removeHoverIndentGuideId:As,createSpanLink:ta,datasourceType:na,showServiceName:Ds===null||Ds.process.serviceName!==Ve.process.serviceName,visibleSpanIds:Zt,criticalPath:Le})},ut)}renderSpanDetailRow(Ve,qe,ut,Tt,_t){const{spanID:Zt}=Ve,{serviceName:dn}=Ve.process,{detailLogItemToggle:Dn,detailLogsToggle:An,detailProcessToggle:rs,detailReferencesToggle:os,detailReferenceItemToggle:us,detailWarningsToggle:hs,detailStackTracesToggle:Js,detailStates:Os,detailTagsToggle:vs,detailToggle:Cs,spanNameColumnWidth:ea,trace:oa,traceToProfilesOptions:As,timeZone:ta,hoverIndentGuideIds:Ra,addHoverIndentGuideId:Ga,removeHoverIndentGuideId:ar,linksGetter:La,createSpanLink:na,focusedSpanId:Or,createFocusSpanLink:Lr,theme:qa,datasourceType:_r,traceFlameGraphs:io,setTraceFlameGraphs:Pr,setRedrawListView:lo}=this.props,ir=Os.get(Zt);if(!oa||!ir)return null;const ss=(0,De.Kv)(dn,qa),ws=Ea();return(0,t.jsx)("div",{className:ws.row,style:{...ut,zIndex:1},...Tt,children:(0,t.jsx)(Pa,{color:ss,columnDivision:ea,onDetailToggled:Cs,detailState:ir,linksGetter:La,logItemToggle:Dn,logsToggle:An,processToggle:rs,referenceItemToggle:us,referencesToggle:os,warningsToggle:hs,stackTracesToggle:Js,span:Ve,traceToProfilesOptions:As,timeZone:ta,tagsToggle:vs,traceStartTime:oa.startTime,traceDuration:oa.duration,traceName:oa.traceName,hoverIndentGuideIds:Ra,addHoverIndentGuideId:Ga,removeHoverIndentGuideId:ar,createSpanLink:na,focusedSpanId:Or,createFocusSpanLink:Lr,datasourceType:_r,visibleSpanIds:_t,traceFlameGraphs:io,setTraceFlameGraphs:Pr,setRedrawListView:lo})},qe)}render(){const Ve=Ea(),{scrollElement:qe,redrawListView:ut}=this.props;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(je,{ref:this.setListView,dataLength:this.getRowStates().length,itemHeightGetter:this.getRowHeight,itemRenderer:this.renderRow,viewBuffer:ja,viewBufferMin:ja,itemsWrapperClassName:Ve.rowsWrapper,getKeyFromIndex:this.getKeyFromIndex,getIndexFromKey:this.getIndexFromKey,windowScroller:!1,scrollElement:qe,redraw:ut}),this.props.topOfViewRef&&(0,t.jsx)(ee.I,{className:Ve.scrollToTopButton,onClick:this.scrollToTop,title:"Scroll to top",icon:"arrow-up"})]})}}const so=(0,a.cV)($r),Zr=(0,f.N)(Fe=>({TraceTimelineViewer:(0,n.css)`
      label: TraceTimelineViewer;
      border-bottom: 1px solid ${(0,c.R)(Fe,"#bbb")};

      & .json-markup {
        line-height: 17px;
        font-size: 13px;
        font-family: monospace;
        white-space: pre-wrap;
      }

      & .json-markup-key {
        font-weight: bold;
      }

      & .json-markup-bool {
        color: ${(0,c.R)(Fe,"firebrick")};
      }

      & .json-markup-string {
        color: ${(0,c.R)(Fe,"teal")};
      }

      & .json-markup-null {
        color: ${(0,c.R)(Fe,"teal")};
      }

      & .json-markup-number {
        color: ${(0,c.R)(Fe,"blue","black")};
      }
    `})),mo=5;class ao extends i.PureComponent{constructor(Ve){super(Ve),this.collapseAll=()=>{this.props.collapseAll(this.props.trace.spans),(0,s.rR)("grafana_traces_traceID_expand_collapse_clicked",{datasourceType:this.props.datasourceType,grafana_version:r.$.buildInfo.version,type:"collapseAll"})},this.collapseOne=()=>{this.props.collapseOne(this.props.trace.spans),(0,s.rR)("grafana_traces_traceID_expand_collapse_clicked",{datasourceType:this.props.datasourceType,grafana_version:r.$.buildInfo.version,type:"collapseOne"})},this.expandAll=()=>{this.props.expandAll(),(0,s.rR)("grafana_traces_traceID_expand_collapse_clicked",{datasourceType:this.props.datasourceType,grafana_version:r.$.buildInfo.version,type:"expandAll"})},this.expandOne=()=>{this.props.expandOne(this.props.trace.spans),(0,s.rR)("grafana_traces_traceID_expand_collapse_clicked",{datasourceType:this.props.datasourceType,grafana_version:r.$.buildInfo.version,type:"expandOne"})},this.state={height:0}}componentDidMount(){y({collapseAll:this.collapseAll,expandAll:this.expandAll,collapseOne:this.collapseOne,expandOne:this.expandOne})}render(){const{setSpanNameColumnWidth:Ve,updateNextViewRangeTime:qe,updateViewRangeTime:ut,viewRange:Tt,traceTimeline:_t,theme:Zt,topOfViewRef:dn,focusedSpanIdForSearch:Dn,...An}=this.props,{trace:rs}=An,os=Zr(Zt);return(0,t.jsxs)("div",{className:os.TraceTimelineViewer,ref:us=>us&&this.setState({height:us.getBoundingClientRect().height}),children:[(0,t.jsx)(re,{duration:rs.duration,nameColumnWidth:_t.spanNameColumnWidth,numTicks:mo,onCollapseAll:this.collapseAll,onCollapseOne:this.collapseOne,onColummWidthChange:Ve,onExpandAll:this.expandAll,onExpandOne:this.expandOne,viewRangeTime:Tt.time,updateNextViewRangeTime:qe,updateViewRangeTime:ut,columnResizeHandleHeight:this.state.height}),(0,t.jsx)(so,{...An,..._t,setSpanNameColumnWidth:Ve,currentViewRangeTime:Tt.time.current,topOfViewRef:dn,focusedSpanIdForSearch:Dn,datasourceType:this.props.datasourceType})]})}}const Fa=(0,a.cV)(ao);var fo=e(39938);const ko=()=>({NewWindowIconLarge:(0,n.css)`
      label: NewWindowIconLarge;
      font-size: 1.5em;
    `});function Go({isLarge:Fe=!1,className:Ve}){const qe=(0,a.of)(ko),ut=u()({[qe.NewWindowIconLarge]:Fe},Ve);return(0,t.jsx)(Ke.I,{className:ut,name:"anchor"})}const Ut=Fe=>(0,t.jsxs)("a",{href:Fe.href,title:Fe.title,target:"_blank",rel:"noopener noreferrer",className:Fe.className,children:[Fe.children," ",(0,t.jsx)(Go,{})]});function Yt(Fe){const{links:Ve}=Fe;return(0,t.jsx)(Ut,{href:Ve[0].url,title:Ve[0].text,className:Fe.className})}const Tn=100,rn="<trace-without-root-span>",In=()=>({BreakableText:(0,n.css)`
      label: BreakableText;
      display: inline-block;
      white-space: pre;
    `}),cs=/\W*\w+\W*/g;function ds({text:Fe,className:Ve,wordRegexp:qe=cs}){const ut=(0,a.of)(In);if(!Fe)return null;const Tt=[];qe.exec("");let _t=qe.exec(Fe)||[Fe];for(;_t;)Tt.push((0,t.jsx)("span",{className:Ve||ut.BreakableText,children:_t[0]},`${Fe}-${Tt.length}`)),_t=qe.exec(Fe);return(0,t.jsx)(t.Fragment,{children:Tt})}const Gs=Fe=>({TraceName:(0,n.css)`
      label: TraceName;
      font-size: ${Fe.typography.size.lg};
    `});function js(Fe){const{className:Ve,traceName:qe}=Fe,ut=(0,a.of)(Gs),Tt=String(qe||rn),_t=(0,t.jsx)(ds,{text:Tt});return(0,t.jsx)("span",{className:u()(ut.TraceName,Ve),children:_t})}var Ca=e(40784);const Aa=Object.defineProperty({archiveEnabled:!1,dependencies:{dagMaxNumServices:Tn,menuEnabled:!0},linkPatterns:[],search:{maxLookback:{label:"2 Days",value:"2d"},maxLimit:1500},tracking:{gaID:null,trackErrors:!0}},"__mergeFields",{value:["dependencies","search","tracking"]});function qs(){return Aa}function xs(Fe){return(0,ce.get)(qs(),Fe)}const Er=/#\{([^{}]*)\}/g;function fr(Fe){const Ve=new Set;return Fe.replace(Er,(qe,ut)=>(Ve.add(ut),qe)),Array.from(Ve)}function gr(Fe,Ve,qe){return Fe.replace(Er,(ut,Tt)=>{const _t=qe[Tt];return _t==null?"":Ve(_t)})}function Rr(Fe,Ve){if(typeof Fe!="string")throw new Error("Invalid template");return{parameters:fr(Fe),template:gr.bind(null,Fe,Ve)}}function Dr(Fe){if(typeof Fe=="string")return Ve=>Ve===Fe;if(Array.isArray(Fe))return Ve=>Fe.indexOf(Ve)>-1;if(Fe==null)return()=>!0;throw new Error(`Invalid value: ${Fe}`)}const Mo=Fe=>Fe;function So(Fe){try{const Ve=Rr(Fe.url,encodeURIComponent),qe=Rr(Fe.text,Mo);return{object:Fe,type:Dr(Fe.type),key:Dr(Fe.key),value:Dr(Fe.value),url:Ve,text:qe,parameters:(0,ce.uniq)(Ve.parameters.concat(qe.parameters))}}catch(Ve){return console.error(`Ignoring invalid link pattern: ${Ve}`,Fe),null}}function Ka(Fe,Ve){return Fe.template(Ve)}function Sa(Fe,Ve){const qe=[],ut=Object.keys(Ve).filter(Tt=>typeof Ve[Tt]=="string"||Ve[Tt]==="number");return Fe?.filter(Tt=>Tt?.type("traces")).forEach(Tt=>{const _t={};Tt?.parameters.every(dn=>{const Dn=dn;return ut.includes(Dn)?(_t[dn]=Ve[Dn],!0):!1})&&qe.push({url:Ka(Tt.url,_t),text:Ka(Tt.text,_t)})}),qe}const Za=(xs("linkPatterns")||[]).map(So).filter(Fe=>!!Fe),ur=(0,Ca.A)(10)(Fe=>{const Ve=[];return Fe?Sa(Za,Fe):Ve});function da(Fe){let Ve;const qe=new Set(Fe.map(({spanID:ut})=>ut));for(let ut=0;ut<Fe.length;ut++){if(Fe[ut].references&&Fe[ut].references.some(({traceID:dn,spanID:Dn})=>dn===Fe[ut].traceID&&qe.has(Dn)))continue;if(!Ve){Ve=Fe[ut];continue}const _t=Fe[ut].references&&Fe[ut].references.length||0,Zt=Ve.references&&Ve.references.length||0;(_t<Zt||_t===Zt&&Fe[ut].startTime<Ve.startTime)&&(Ve=Fe[ut])}return Ve?`${Ve.process.serviceName}: ${Ve.operationName}`:""}const ro=(0,ce.memoize)(da,Fe=>Fe.length?Fe[0].traceID:0);function Uo(Fe){for(let Ve=0;Ve<Fe.length;Ve++){const qe=Fe[Ve].tags.filter(_t=>_t.key==="http.request.method"),ut=Fe[Ve].tags.filter(_t=>_t.key==="http.response.status_code"),Tt=Fe[Ve].tags.filter(_t=>_t.key==="http.route");if(qe.length>0||ut.length>0||Tt.length>0)return{method:qe,status:ut,url:Tt}}for(let Ve=0;Ve<Fe.length;Ve++){const qe=Fe[Ve].tags.filter(_t=>_t.key==="http.method"),ut=Fe[Ve].tags.filter(_t=>_t.key==="http.status_code"),Tt=Fe[Ve].tags.filter(_t=>_t.key==="http.url"||_t.key==="http.target"||_t.key==="http.path");if(qe.length>0||ut.length>0||Tt.length>0)return{method:qe,status:ut,url:Tt}}return{}}const No=(0,ce.memoize)(Uo,Fe=>Fe.length?Fe[0].traceID:0);var wo=e(2913),Di=e(18358);const ii=Fe=>({ActionButton:(0,n.css)`
      label: ActionButton;
      overflow: hidden;
      position: relative;
      &:after {
        content: '';
        background: ${Fe.colors.primary.main};
        display: block;
        position: absolute;
        right: 0;
        width: 100%;
        height: 100%;
        opacity: 0;
        transition: all 0.8s;
      }
      &:active:after {
        margin: 0;
        opacity: 0.3;
        transition: 0s;
      }
    `});function Wo(Fe){const{onClick:Ve,ariaLabel:qe,label:ut,icon:Tt}=Fe,_t=(0,a.of)(ii);return(0,t.jsx)($e.$n,{className:_t.ActionButton,size:"sm",variant:"secondary",fill:"outline",type:"button",icon:Tt,"aria-label":qe,onClick:Ve,children:ut})}const li=Fe=>({TracePageActions:(0,n.css)({label:"TracePageActions",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",marginBottom:"10px"}),feedback:(0,n.css)({margin:"6px 6px 6px 0",color:Fe.colors.text.secondary,fontSize:Fe.typography.bodySmall.fontSize,"&:hover":{color:Fe.colors.text.link}})});function nl(Fe){const{traceId:Ve,data:qe,app:ut}=Fe,Tt=(0,a.$j)(),_t=li(Tt),[Zt,dn]=(0,i.useState)(!1),Dn=()=>{navigator.clipboard.writeText(Ve),dn(!0),setTimeout(()=>{dn(!1)},5e3)},An=()=>{const rs=(0,Di.ek)(qe,"Trace-"+Ve.substring(Ve.length-6));(0,s.rR)("grafana_traces_download_traces_clicked",{app:ut,grafana_version:wo.config.buildInfo.version,trace_format:rs,location:"trace-view"})};return(0,t.jsxs)("div",{className:_t.TracePageActions,children:[(0,t.jsxs)("a",{href:"https://forms.gle/RZDEx8ScyZNguDoC8",className:_t.feedback,title:"Share your thoughts about tracing in Grafana.",target:"_blank",rel:"noreferrer noopener",children:[(0,t.jsx)(Ke.I,{name:"comment-alt-message"})," Give feedback"]}),(0,t.jsx)(Wo,{onClick:Dn,ariaLabel:"Copy Trace ID",label:Zt?"Copied!":"Trace ID",icon:"copy"}),(0,t.jsx)(Wo,{onClick:An,ariaLabel:"Export Trace",label:"Export",icon:"save"})]})}var Mr=e(50877),Fi=e(3721),Pi=e(40996),mr=e(14186),ci=e(10354);const Qo=/^(-?\d+(?:\.\d+)?)(ms|[Mwdhmsy])$/,Vr=(Fe,Ve)=>!(Fe.match(Ve)||!Fe),Ki=Fe=>{const Ve=Fe.validationRegex||Qo,[qe,ut]=(0,i.useState)(()=>Fe.value?Vr(Fe.value,Ve):!1);(0,Pi.A)(()=>{ut(Vr(Fe.value,Ve))},500,[Fe.value]);const Tt={labelWidth:26,disabled:Fe.disabled??!1,invalid:qe,error:Fe.isInvalidError};return Fe.label&&(Tt.label=Fe.label,Tt.tooltip=Fe.tooltip||""),(0,t.jsx)(mr.I,{...Tt,children:(0,t.jsx)(ci.p,{type:"text",placeholder:Fe.placeholder||"0",width:Fe.width||40,onChange:_t=>{Fe.onChange(_t.currentTarget.value)},value:Fe.value,"aria-label":Fe.ariaLabel||"interval input"})})};var $i=e(82762),vo=e(39268),oo=e(66864),sr=e(90182),di=e(15583);class sl extends i.PureComponent{constructor(){super(...arguments),this.clearUiFind=()=>{this.props.onChange("")}}static{this.defaultProps={value:void 0}}render(){const{value:Ve}=this.props,qe=(0,t.jsx)(t.Fragment,{children:Ve&&Ve.length&&(0,t.jsx)(X.K,{name:"times",onClick:this.clearUiFind,tooltip:"Clear input"})});return(0,t.jsx)("div",{style:{width:"200px"},children:(0,t.jsx)(ci.p,{placeholder:"Find...",onChange:ut=>this.props.onChange(ut.currentTarget.value),suffix:qe,value:Ve})})}}const Vi=(0,i.memo)(function(Ve){const{trace:qe,spanFilterMatches:ut,setFocusedSpanIdForSearch:Tt,focusedSpanIndexForSearch:_t,setFocusedSpanIndexForSearch:Zt,datasourceType:dn,showSpanFilters:Dn}=Ve,An=al((0,a.$j)(),Dn);(0,i.useEffect)(()=>{if(ut&&_t!==-1){const As=Array.from(ut);Tt(As[_t])}},[_t,Tt,ut]);const rs=(As,ta)=>{if(As.preventDefault(),As.stopPropagation(),ta){if((0,s.rR)("grafana_traces_trace_view_find_next_prev_clicked",{datasourceType:dn,grafana_version:r.$.buildInfo.version,direction:"next"}),_t===-1||ut&&_t===ut.size-1){Zt(0);return}Zt(_t+1)}},os=(As,ta)=>{if(As.preventDefault(),As.stopPropagation(),ta){if((0,s.rR)("grafana_traces_trace_view_find_next_prev_clicked",{datasourceType:dn,grafana_version:r.$.buildInfo.version,direction:"prev"}),ut&&(_t===-1||_t===0)){Zt(ut.size-1);return}Zt(_t-1)}},us=(As,ta)=>{As.key==="Enter"&&rs(As,ta)},hs=(As,ta)=>{As.key==="Enter"&&os(As,ta)},Js=(ut&&ut?.size>0)??!1,Os=Js?An.button:(0,n.cx)(An.button,An.buttonDisabled),vs=(0,i.useCallback)(As=>(0,t.jsx)(Je.m,{content:As,placement:"top",children:(0,t.jsx)("span",{className:An.tooltip,children:(0,t.jsx)(Ke.I,{name:"info-circle",size:"md"})})}),[An.tooltip]),Cs=(0,i.useCallback)((As,ta)=>{let Ra=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{children:`${qe.spans.length} spans`}),vs((0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:["Services: ",ta]}),(0,t.jsxs)("div",{children:["Depth: ",As]})]}))]});if(ut)if(ut.size===0)Ra=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{children:"0 matches"}),vs("There are 0 span matches for the filters selected. Please try removing some of the selected filters.")]});else{const Ga=ut.size===1?"match":"matches",ar=_t!==-1?`${_t+1}/${ut.size} ${Ga}`:`${ut.size} ${Ga}`,La=[];ut.forEach(na=>{qe.processes[na]&&La.push(qe.processes[na].serviceName)}),Ra=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{children:ar}),vs((0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:["Services: ",new Set(La).size,"/",ta]}),(0,t.jsxs)("div",{children:["Depth: ",As]})]}))]})}return Ra},[_t,vs,ut,qe.processes,qe.spans]),ea=new Set((0,ce.values)(qe.processes).map(As=>As.serviceName)).size,oa=(0,ce.get)((0,ce.maxBy)(qe.spans,"depth"),"depth",0)+1;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:An.matches,children:Cs(oa,ea)}),(0,t.jsxs)("div",{className:Js?An.buttons:(0,n.cx)(An.buttons,An.buttonsDisabled),children:[(0,t.jsx)("div",{"aria-label":"Prev result button",className:Os,onClick:As=>os(As,Js),onKeyDown:As=>hs(As,Js),role:"button",tabIndex:Js?0:-1,children:"Prev"}),(0,t.jsx)("div",{"aria-label":"Next result button",className:Os,onClick:As=>rs(As,Js),onKeyDown:As=>us(As,Js),role:"button",tabIndex:Js?0:-1,children:"Next"})]})]})}),al=(Fe,Ve)=>{const qe=(0,$e.hs)({theme:Fe,variant:"secondary",size:Ve?"md":"sm",iconOnly:!1,fill:"outline"});return{buttons:(0,n.css)`
      display: inline-flex;
      gap: 4px;
    `,buttonsDisabled:(0,n.css)`
      cursor: not-allowed;
    `,button:(0,n.css)`
      ${qe.button};
    `,buttonDisabled:(0,n.css)`
      ${qe.disabled};
      pointer-events: none;
    `,matches:(0,n.css)`
      margin-right: ${Fe.spacing(2)};
      text-wrap: nowrap;
    `,tooltip:(0,n.css)`
      color: #aaa;
      margin: 0 0 0 5px;
    `}};var _i=e(15292);function rl(Fe,Ve){if(!Ve)return;let qe=!1;Fe.serviceName&&(Ve=il(Ve,Fe),qe=!0),Fe.spanName&&(Ve=bi(Ve,Fe),qe=!0),(Fe.from||Fe.to)&&(Ve=go(Ve,Fe),qe=!0);const ut=ol(Ve,Fe.tags);if(ut&&(Ve=ut,qe=!0),Fe.query){const Tt=zi(Fe.query,Ve);Tt&&(Ve=Tt,qe=!0)}return qe?new Set(Ve.map(Tt=>Tt.spanID)):void 0}function zi(Fe,Ve){if(!Ve)return;const qe=[];Fe.split(/\s+/).filter(Boolean).forEach(Zt=>{qe.push(Zt.toLowerCase())});const ut=(Zt,dn)=>Zt.some(Dn=>dn.toLowerCase().includes(Dn)),Tt=Zt=>Zt?Zt.some(dn=>ut(qe,dn.key)||ut(qe,dn.value.toString())):!1,_t=Zt=>ut(qe,Zt.operationName)||ut(qe,Zt.process.serviceName)||Tt(Zt.tags)||Zt.kind&&ut(qe,Zt.kind)||Zt.statusCode!==void 0&&ut(qe,Qe.s[Zt.statusCode])||Zt.statusMessage&&ut(qe,Zt.statusMessage)||Zt.instrumentationLibraryName&&ut(qe,Zt.instrumentationLibraryName)||Zt.instrumentationLibraryVersion&&ut(qe,Zt.instrumentationLibraryVersion)||Zt.traceState&&ut(qe,Zt.traceState)||Zt.logs!==null&&Zt.logs.some(dn=>Tt(dn.fields))||Tt(Zt.process.tags)||qe.some(dn=>dn===Zt.spanID);return Ve.filter(_t)}const ol=(Fe,Ve)=>{if(Ve=Ve.filter(qe=>qe.key&&qe.key!==""||qe.value),Ve.length>0)return Fe.filter(qe=>Ve.every(ut=>ut.key&&ut.value?ut.operator==="="&&ki(ut,qe)?Oo(ut.operator,!0):ut.operator==="=~"&&Hi(ut,qe)||ut.operator==="!="&&!ki(ut,qe)||ut.operator==="!~"&&!Hi(ut,qe)?Oo(ut.operator,!1):!1:ut.key&&(qe.tags.some(Tt=>Fo(ut.key,Tt.key))||qe.process.tags.some(Tt=>Fo(ut.key,Tt.key))||qe.logs&&qe.logs.some(Tt=>Tt.fields.some(_t=>Fo(ut.key,_t.key)))||qe.kind&&ut.key===on||qe.statusCode!==void 0&&ut.key===Pn||qe.statusMessage&&ut.key===_n||qe.instrumentationLibraryName&&ut.key===Cn||qe.instrumentationLibraryVersion&&ut.key===Ye||qe.traceState&&ut.key===Dt||ut.key===yt)?Oo(ut.operator,!0):Oo(ut.operator,!1)))},Hi=(Fe,Ve)=>Ve.tags.some(qe=>yo(Fe,qe))||Ve.process.tags.some(qe=>yo(Fe,qe))||Ve.logs&&Ve.logs.some(qe=>qe.fields.some(ut=>yo(Fe,ut)))||Ve.kind&&Fe.key===on&&Fe.value?.includes(Ve.kind)||Ve.statusCode!==void 0&&Fe.key===Pn&&Fe.value?.includes(Qe.s[Ve.statusCode].toLowerCase())||Ve.statusMessage&&Fe.key===_n&&Fe.value?.includes(Ve.statusMessage)||Ve.instrumentationLibraryName&&Fe.key===Cn&&Fe.value?.includes(Ve.instrumentationLibraryName)||Ve.instrumentationLibraryVersion&&Fe.key===Ye&&Fe.value?.includes(Ve.instrumentationLibraryVersion)||Ve.traceState&&Fe.key===Dt&&Fe.value?.includes(Ve.traceState)||Fe.key===yt&&Fe.value?.includes(Ve.spanID),ki=(Fe,Ve)=>Ve.tags.some(qe=>Ko(Fe,qe))||Ve.process.tags.some(qe=>Ko(Fe,qe))||Ve.logs&&Ve.logs.some(qe=>qe.fields.some(ut=>Ko(Fe,ut)))||Ve.kind&&Fe.key===on&&Fe.value===Ve.kind||Ve.statusCode!==void 0&&Fe.key===Pn&&Fe.value===Qe.s[Ve.statusCode].toLowerCase()||Ve.statusMessage&&Fe.key===_n&&Fe.value===Ve.statusMessage||Ve.instrumentationLibraryName&&Fe.key===Cn&&Fe.value===Ve.instrumentationLibraryName||Ve.instrumentationLibraryVersion&&Fe.key===Ye&&Fe.value===Ve.instrumentationLibraryVersion||Ve.traceState&&Fe.key===Dt&&Fe.value===Ve.traceState||Fe.key===yt&&Fe.value===Ve.spanID,Fo=(Fe,Ve)=>Fe===Ve.toString(),Ko=(Fe,Ve)=>Fe.key===Ve.key.toString()&&Fe.value===Ve.value.toString(),yo=(Fe,Ve)=>!!(Ve.key.toString().includes(Fe.key||"")&&Ve.value.toString().includes(Fe.value||"")),Oo=(Fe,Ve)=>{switch(Fe){case"=":return Ve;case"!=":return!Ve;case"~=":return!Ve;case"!~":return!Ve;default:return!Ve}},il=(Fe,Ve)=>Fe.filter(qe=>Ve.serviceNameOperator==="="?qe.process.serviceName===Ve.serviceName:qe.process.serviceName!==Ve.serviceName),bi=(Fe,Ve)=>Fe.filter(qe=>Ve.spanNameOperator==="="?qe.operationName===Ve.spanName:qe.operationName!==Ve.spanName),go=(Fe,Ve)=>{const qe=$o(Ve?.from||""),ut=$o(Ve?.to||"");let Tt=[];if(qe&&(Tt=Fe.filter(_t=>Ve.fromOperator===">"?_t.duration>qe:_t.duration>=qe)),ut){const _t=Zt=>Ve.toOperator==="<"?Zt.duration<ut:Zt.duration<=ut;Tt=Tt.length>0?Tt.filter(Zt=>_t(Zt)):Fe.filter(Zt=>_t(Zt))}return Tt},$o=Fe=>{if(Fe.includes("ns"))return parseFloat(Fe.split("ns")[0])/1e3;if(Fe.includes("us"))return parseFloat(Fe.split("us")[0]);if(Fe.includes("\xB5s"))return parseFloat(Fe.split("\xB5s")[0]);if(Fe.includes("ms"))return parseFloat(Fe.split("ms")[0])*1e3;if(Fe.includes("s"))return parseFloat(Fe.split("s")[0])*1e3*1e3;if(Fe.includes("m"))return parseFloat(Fe.split("m")[0])*1e3*1e3*60;if(Fe.includes("h"))return parseFloat(Fe.split("h")[0])*1e3*1e3*60*60},Yo=(0,i.memo)(function(Ve){const{trace:qe,search:ut,spanFilterMatches:Tt,showSpanFilterMatchesOnly:_t,setShowSpanFilterMatchesOnly:Zt,showCriticalPathSpansOnly:dn,setShowCriticalPathSpansOnly:Dn,focusedSpanIndexForSearch:An,setFocusedSpanIndexForSearch:rs,setFocusedSpanIdForSearch:os,datasourceType:us,clear:hs,showSpanFilters:Js}=Ve,Os=(0,a.of)(Sr),vs=(0,i.useMemo)(()=>ut.serviceName&&ut.serviceName!==""||ut.spanName&&ut.spanName!==""||$o(ut.from||"")||$o(ut.to||"")||ut.tags.length>1||ut.tags.some(Cs=>Cs.key)||ut.query&&ut.query!==""||_t,[ut.serviceName,ut.spanName,ut.from,ut.to,ut.tags,ut.query,_t]);return(0,t.jsx)("div",{className:Os.container,children:(0,t.jsx)("div",{className:Os.controls,children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)($e.$n,{variant:"destructive",disabled:!vs,type:"button",fill:"outline","aria-label":"Clear filters button",onClick:hs,children:"Clear"}),(0,t.jsxs)("div",{className:Os.matchesOnly,children:[(0,t.jsx)(_i.d,{value:_t,onChange:Cs=>Zt(Cs.currentTarget.checked??!1),label:"Show matches only switch",disabled:!Tt?.size}),(0,t.jsx)($e.$n,{onClick:()=>Zt(!_t),className:Os.clearMatchesButton,variant:"secondary",fill:"text",disabled:!Tt?.size,children:"Show matches only"})]}),(0,t.jsxs)("div",{className:Os.matchesOnly,children:[(0,t.jsx)(_i.d,{value:dn,onChange:Cs=>Dn(Cs.currentTarget.checked??!1),label:"Show critical path only switch"}),(0,t.jsx)($e.$n,{onClick:()=>Dn(!dn),className:Os.clearMatchesButton,variant:"secondary",fill:"text",children:"Show critical path only"})]})]}),(0,t.jsx)("div",{className:Os.nextPrevResult,children:(0,t.jsx)(Vi,{trace:qe,spanFilterMatches:Tt,setFocusedSpanIdForSearch:os,focusedSpanIndexForSearch:An,setFocusedSpanIndexForSearch:rs,datasourceType:us,showSpanFilters:Js})})]})})})}),Sr=Fe=>{const Ve=(0,$e.hs)({theme:Fe,variant:"secondary",size:"md",iconOnly:!1,fill:"outline"});return{button:(0,n.css)(Ve.button),buttonDisabled:(0,n.css)(Ve.disabled,{pointerEvents:"none",cursor:"not-allowed"}),container:(0,n.css)`
      display: inline;
    `,controls:(0,n.css)`
      display: flex;
      justify-content: flex-end;
      margin: 5px 0 0 0;
    `,matchesOnly:(0,n.css)`
      display: inline-flex;
      margin: 0 0 0 25px;
      vertical-align: middle;
      align-items: center;
    `,clearMatchesButton:(0,n.css)`
      color: ${Fe.colors.text.primary};

      &:hover {
        background: inherit;
      }
    `,nextPrevResult:(0,n.css)`
      margin-left: auto;
      display: flex;
      align-items: center;
    `}},Jo=(0,i.memo)(Fe=>{const{trace:Ve,search:qe,setSearch:ut,showSpanFilters:Tt,setShowSpanFilters:_t,showSpanFilterMatchesOnly:Zt,setShowSpanFilterMatchesOnly:dn,showCriticalPathSpansOnly:Dn,setShowCriticalPathSpansOnly:An,setFocusedSpanIdForSearch:rs,spanFilterMatches:os,datasourceType:us}=Fe,hs={...(0,a.of)(xo)},[Js,Os]=(0,i.useState)(),[vs,Cs]=(0,i.useState)(),[ea,oa]=(0,i.useState)(),[As,ta]=(0,i.useState)({}),[Ra,Ga]=(0,i.useState)(-1),ar=/^\d+(?:\.\d)?\d*(?:ns|us|µs|ms|s|m|h)$/,La=(0,i.useCallback)(()=>{Os(void 0),Cs(void 0),oa(void 0),ta({}),ut(di.Ji),dn(!1)},[ut,dn]);if((0,i.useEffect)(()=>{La()},[La,Ve]),!Ve)return null;const na=ss=>{Ga(-1),rs(""),ut(ss)},Or=()=>{if(!Js){const ss=Ve.spans.map(ws=>ws.process.serviceName);Os((0,ce.uniq)(ss).sort().map(Mr.z))}},Lr=()=>{if(!vs){const ss=Ve.spans.map(ws=>ws.operationName);Cs((0,ce.uniq)(ss).sort().map(Mr.z))}},qa=()=>{if(!ea){let ss=[],ws=[];Ve.spans.forEach(Ds=>{Ds.tags.forEach(Ws=>{ss.push(Ws.key)}),Ds.process.tags.forEach(Ws=>{ss.push(Ws.key)}),Ds.logs!==null&&Ds.logs.forEach(Ws=>{Ws.fields.forEach(Ge=>{ws.push(Ge.key)})}),Ds.kind&&ss.push(on),Ds.statusCode!==void 0&&ss.push(Pn),Ds.statusMessage&&ss.push(_n),Ds.instrumentationLibraryName&&ss.push(Cn),Ds.instrumentationLibraryVersion&&ss.push(Ye),Ds.traceState&&ss.push(Dt),ss.push(yt)}),ss=(0,ce.uniq)(ss).sort(),ws=(0,ce.uniq)(ws).sort(),oa([...ss,...ws].map(Mr.z))}},_r=async ss=>{const ws=[];return Ve.spans.forEach(Ds=>{const Ws=Ds.tags.find(Le=>Le.key===ss)?.value;Ws&&ws.push(Ws.toString());const Ge=Ds.process.tags.find(Le=>Le.key===ss)?.value;switch(Ge&&ws.push(Ge.toString()),Ds.logs!==null&&Ds.logs.forEach(Le=>{const _e=Le.fields.find(nt=>nt.key===ss)?.value;_e&&ws.push(_e.toString())}),ss){case on:Ds.kind&&ws.push(Ds.kind);break;case Pn:Ds.statusCode!==void 0&&ws.push(Qe.s[Ds.statusCode].toLowerCase());break;case _n:Ds.statusMessage&&ws.push(Ds.statusMessage);break;case Cn:Ds.instrumentationLibraryName&&ws.push(Ds.instrumentationLibraryName);break;case Ye:Ds.instrumentationLibraryVersion&&ws.push(Ds.instrumentationLibraryVersion);break;case Dt:Ds.traceState&&ws.push(Ds.traceState);break;case yt:ws.push(Ds.spanID);break;default:break}}),(0,ce.uniq)(ws).sort().map(Mr.z)},io=(ss,ws)=>{ut({...qe,tags:qe.tags?.map(Ws=>Ws.id===ss.id?{...Ws,key:ws?.value||"",value:void 0}:Ws)}),(async()=>{if(ws?.value)ta({...As,[ss.id]:await _r(ws.value)});else{const Ws={...As};Ws[ss.id]&&delete Ws[ss.id],ta(Ws)}})()},Pr=()=>{const ss={id:(0,di.zE)(),operator:"="};ut({...qe,tags:[...qe.tags,ss]})},lo=ss=>{let ws=qe.tags.filter(Ds=>Ds.id!==ss);ws.length===0&&(ws=[{id:(0,di.zE)(),operator:"="}]),ut({...qe,tags:ws})},ir=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Je.m,{content:"Filter your spans below. You can continue to apply filters until you have narrowed down your resulting spans to the select few you are most interested in.",placement:"right",children:(0,t.jsxs)("span",{className:hs.collapseLabel,children:["Span Filters",(0,t.jsx)(Ke.I,{size:"md",name:"info-circle"})]})}),!Tt&&(0,t.jsx)("div",{className:hs.nextPrevResult,children:(0,t.jsx)(Vi,{trace:Ve,spanFilterMatches:os,setFocusedSpanIdForSearch:rs,focusedSpanIndexForSearch:Ra,setFocusedSpanIndexForSearch:Ga,datasourceType:us,showSpanFilters:Tt})})]});return(0,t.jsx)("div",{className:hs.container,children:(0,t.jsxs)($i.S,{label:ir,collapsible:!0,isOpen:Tt,onToggle:_t,children:[(0,t.jsxs)(vo.C,{className:hs.flexContainer,children:[(0,t.jsx)(mr.I,{label:"Service Name",labelWidth:16,children:(0,t.jsxs)(oo.Gy,{spacing:"xs",children:[(0,t.jsx)(sr.l6,{"aria-label":"Select service name operator",onChange:ss=>na({...qe,serviceNameOperator:ss.value}),options:[(0,Mr.z)("="),(0,Mr.z)("!=")],value:qe.serviceNameOperator}),(0,t.jsx)(sr.l6,{"aria-label":"Select service name",isClearable:!0,onChange:ss=>na({...qe,serviceName:ss?.value||""}),onOpenMenu:Or,options:Js,placeholder:"All service names",value:qe.serviceName||null})]})}),(0,t.jsx)(sl,{onChange:ss=>{na({...qe,query:ss}),ss===""&&dn(!1)},value:qe.query||""})]}),(0,t.jsx)(vo.C,{children:(0,t.jsx)(mr.I,{label:"Span Name",labelWidth:16,children:(0,t.jsxs)(oo.Gy,{spacing:"xs",children:[(0,t.jsx)(sr.l6,{"aria-label":"Select span name operator",onChange:ss=>na({...qe,spanNameOperator:ss.value}),options:[(0,Mr.z)("="),(0,Mr.z)("!=")],value:qe.spanNameOperator}),(0,t.jsx)(sr.l6,{"aria-label":"Select span name",isClearable:!0,onChange:ss=>na({...qe,spanName:ss?.value||""}),onOpenMenu:Lr,options:vs,placeholder:"All span names",value:qe.spanName||null})]})})}),(0,t.jsx)(vo.C,{children:(0,t.jsx)(mr.I,{label:"Duration",labelWidth:16,tooltip:"Filter by duration. Accepted units are ns, us, ms, s, m, h",children:(0,t.jsxs)(oo.Gy,{spacing:"xs",align:"flex-start",children:[(0,t.jsx)(sr.l6,{"aria-label":"Select min span operator",onChange:ss=>na({...qe,fromOperator:ss.value}),options:[(0,Mr.z)(">"),(0,Mr.z)(">=")],value:qe.fromOperator}),(0,t.jsx)("div",{className:hs.intervalInput,children:(0,t.jsx)(Ki,{ariaLabel:"Select min span duration",onChange:ss=>na({...qe,from:ss}),isInvalidError:"Invalid duration",placeholder:"e.g. 100ms, 1.2s",width:18,value:qe.from||"",validationRegex:ar})}),(0,t.jsx)(sr.l6,{"aria-label":"Select max span operator",onChange:ss=>na({...qe,toOperator:ss.value}),options:[(0,Mr.z)("<"),(0,Mr.z)("<=")],value:qe.toOperator}),(0,t.jsx)(Ki,{ariaLabel:"Select max span duration",onChange:ss=>na({...qe,to:ss}),isInvalidError:"Invalid duration",placeholder:"e.g. 100ms, 1.2s",width:18,value:qe.to||"",validationRegex:ar})]})})}),(0,t.jsx)(vo.C,{className:hs.tagsRow,children:(0,t.jsx)(mr.I,{label:"Tags",labelWidth:16,tooltip:"Filter by tags, process tags or log fields in your spans.",children:(0,t.jsx)("div",{children:qe.tags.map((ss,ws)=>(0,t.jsx)("div",{children:(0,t.jsxs)(oo.Gy,{spacing:"xs",width:"auto",children:[(0,t.jsx)(sr.l6,{"aria-label":"Select tag key",isClearable:!0,onChange:Ds=>io(ss,Ds),onOpenMenu:qa,options:ea,placeholder:"Select tag",value:ss.key||null},ss.key),(0,t.jsx)(sr.l6,{"aria-label":"Select tag operator",onChange:Ds=>{na({...qe,tags:qe.tags?.map(Ws=>Ws.id===ss.id?{...Ws,operator:Ds.value}:Ws)})},options:[(0,Mr.z)("="),(0,Mr.z)("!="),(0,Mr.z)("=~"),(0,Mr.z)("!~")],value:ss.operator}),(0,t.jsxs)("span",{className:hs.tagValues,children:[(ss.operator==="="||ss.operator==="!=")&&(0,t.jsx)(sr.l6,{"aria-label":"Select tag value",isClearable:!0,onChange:Ds=>{na({...qe,tags:qe.tags?.map(Ws=>Ws.id===ss.id?{...Ws,value:Ds?.value||""}:Ws)})},options:As[ss.id]?As[ss.id]:[],placeholder:"Select value",value:ss.value},ss.value),(ss.operator==="=~"||ss.operator==="!~")&&(0,t.jsx)(ci.p,{"aria-label":"Input tag value",onChange:Ds=>{na({...qe,tags:qe.tags?.map(Ws=>Ws.id===ss.id?{...Ws,value:Ds?.currentTarget?.value||""}:Ws)})},placeholder:"Tag value",width:18,value:ss.value||""})]}),(ss.key||ss.value||qe.tags.length>1)&&(0,t.jsx)(Fi.Z,{"aria-label":"Remove tag",variant:"secondary",icon:"times",onClick:()=>lo(ss.id),tooltip:"Remove tag"}),(ss.key||ss.value)&&ws===qe.tags.length-1&&(0,t.jsx)("span",{className:hs.addTag,children:(0,t.jsx)(Fi.Z,{"aria-label":"Add tag",variant:"secondary",icon:"plus",onClick:Pr,tooltip:"Add tag"})})]})},ws))})})}),(0,t.jsx)(Yo,{trace:Ve,search:qe,spanFilterMatches:os,showSpanFilterMatchesOnly:Zt,setShowSpanFilterMatchesOnly:dn,showCriticalPathSpansOnly:Dn,setShowCriticalPathSpansOnly:An,setFocusedSpanIdForSearch:rs,focusedSpanIndexForSearch:Ra,setFocusedSpanIndexForSearch:Ga,datasourceType:us,clear:La,showSpanFilters:Tt})]})})});Jo.displayName="SpanFilters";const xo=Fe=>({container:(0,n.css)`
      label: SpanFilters;
      margin: 0.5em 0 -${Fe.spacing(1)} 0;
      z-index: 5;

      & > div {
        border-left: none;
        border-right: none;
      }
    `,collapseLabel:(0,n.css)`
      svg {
        color: #aaa;
        margin: -2px 0 0 10px;
      }
    `,flexContainer:(0,n.css)({display:"flex",justifyContent:"space-between"}),addTag:(0,n.css)({marginLeft:Fe.spacing(1)}),intervalInput:(0,n.css)`
      margin: 0 -4px 0 0;
    `,tagsRow:(0,n.css)`
      margin: -4px 0 0 0;
    `,tagValues:(0,n.css)`
      max-width: 200px;
    `,nextPrevResult:(0,n.css)`
      flex: 1;
      align-items: center;
      display: flex;
      justify-content: flex-end;
      margin-right: ${Fe.spacing(1)};
    `}),Xo=(0,i.memo)(Fe=>{const{trace:Ve,data:qe,app:ut,timeZone:Tt,search:_t,setSearch:Zt,showSpanFilters:dn,setShowSpanFilters:Dn,showSpanFilterMatchesOnly:An,setShowSpanFilterMatchesOnly:rs,showCriticalPathSpansOnly:os,setShowCriticalPathSpansOnly:us,setFocusedSpanIdForSearch:hs,spanFilterMatches:Js,datasourceType:Os,setHeaderHeight:vs}=Fe,Cs=(0,a.of)(Bl);(0,i.useEffect)(()=>{vs(document.querySelector("."+Cs.header)?.scrollHeight??0)},[vs,dn,Cs.header]);const ea=(0,i.useMemo)(()=>Ve?ur(Ve):[],[Ve]);if(!Ve)return null;const oa=(na,Or)=>{const Lr=(0,at.LE)(na.startTime/1e3,{timeZone:Or,defaultWithMS:!0}),qa=Lr.match(/^(.+)(:\d\d\.\d+)$/);return qa?(0,t.jsxs)("span",{className:Cs.TracePageHeaderOverviewItemValue,children:[qa[1],(0,t.jsx)("span",{className:Cs.TracePageHeaderOverviewItemValueDetail,children:qa[2]})]}):Lr},As=(0,t.jsxs)("h1",{className:u()(Cs.title),children:[(0,t.jsx)(js,{traceName:ro(Ve.spans)}),(0,t.jsx)("small",{className:Cs.duration,children:(0,D.a3)(Ve.duration)})]}),{method:ta,status:Ra,url:Ga}=No(Ve.spans);let ar="green";Ra&&Ra.length>0&&(Ra[0].value.toString().charAt(0)==="4"?ar="orange":Ra[0].value.toString().charAt(0)==="5"&&(ar="red"));const La=na=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{children:"http.url or http.target or http.path"}),(0,t.jsxs)("div",{children:["(",na,")"]})]});return(0,t.jsxs)("header",{className:Cs.header,children:[(0,t.jsxs)("div",{className:Cs.titleRow,children:[ea&&ea.length>0&&(0,t.jsx)(Yt,{links:ea,className:Cs.TracePageHeaderBack}),As,(0,t.jsx)(nl,{traceId:Ve.traceID,data:qe,app:ut})]}),(0,t.jsxs)("div",{className:Cs.subtitle,children:[(0,t.jsx)("span",{className:Cs.timestamp,children:oa(Ve,Tt)}),(0,t.jsxs)("span",{className:Cs.tagMeta,children:[ta&&ta.length>0&&(0,t.jsx)(Je.m,{content:"http.method",interactive:!0,children:(0,t.jsx)("span",{className:Cs.tag,children:(0,t.jsx)(fo.E,{text:ta[0].value,color:"blue"})})}),Ra&&Ra.length>0&&(0,t.jsx)(Je.m,{content:"http.status_code",interactive:!0,children:(0,t.jsx)("span",{className:Cs.tag,children:(0,t.jsx)(fo.E,{text:Ra[0].value,color:ar})})}),Ga&&Ga.length>0&&(0,t.jsx)(Je.m,{content:La(Ga[0].value),interactive:!0,children:(0,t.jsx)("span",{className:Cs.url,children:Ga[0].value})})]})]}),(0,t.jsx)(Jo,{trace:Ve,showSpanFilters:dn,setShowSpanFilters:Dn,showSpanFilterMatchesOnly:An,setShowSpanFilterMatchesOnly:rs,showCriticalPathSpansOnly:os,setShowCriticalPathSpansOnly:us,search:_t,setSearch:Zt,spanFilterMatches:Js,setFocusedSpanIdForSearch:hs,datasourceType:Os})]})});Xo.displayName="TracePageHeader";const Bl=Fe=>({TracePageHeaderBack:(0,n.css)`
      label: TracePageHeaderBack;
      align-items: center;
      align-self: stretch;
      background-color: #fafafa;
      border-bottom: 1px solid #ddd;
      border-right: 1px solid #ddd;
      color: inherit;
      display: flex;
      font-size: 1.4rem;
      padding: 0 1rem;
      margin-bottom: -1px;
      &:hover {
        background-color: #f0f0f0;
        border-color: #ccc;
      }
    `,TracePageHeaderOverviewItemValueDetail:u()((0,n.css)`
        label: TracePageHeaderOverviewItemValueDetail;
        color: #aaa;
      `,"trace-item-value-detail"),TracePageHeaderOverviewItemValue:(0,n.css)`
      label: TracePageHeaderOverviewItemValue;
      &:hover > .trace-item-value-detail {
        color: unset;
      }
    `,header:(0,n.css)({label:"TracePageHeader",backgroundColor:Fe.colors.background.primary,padding:"0.5em 0 0 0",position:"sticky",top:0,zIndex:5,textAlign:"left"}),titleRow:(0,n.css)({alignItems:"flex-start",display:"flex",padding:"0 8px",flexWrap:"wrap"}),title:(0,n.css)({color:"inherit",flex:1,fontSize:"1.7em",lineHeight:"1em",marginBottom:0,minWidth:"200px"}),subtitle:(0,n.css)({flex:1,lineHeight:"1em",margin:"-0.5em 0.5em 0.75em 0.5em"}),tag:(0,n.css)({margin:"0 0.5em 0 0"}),duration:(0,n.css)({color:"#aaa",margin:"0 0.75em"}),timestamp:(0,n.css)({verticalAlign:"middle"}),tagMeta:(0,n.css)({margin:"0 0.75em",verticalAlign:"text-top"}),url:(0,n.css)({margin:"-2.5px 0.3em",height:"15px",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"700px",display:"inline-block"}),TracePageHeaderTraceId:(0,n.css)({label:"TracePageHeaderTraceId",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"30%",display:"inline-block"})}),po="None",zr="Duration",Ci="Tag";function Zo({options:Fe,onOptionsChange:Ve}){const qe=useStyles2(Io),ut=[po,zr,Ci].map(toOption);return jsxs("div",{className:css({width:"100%"}),children:[jsx(InlineFieldRow,{className:qe.row,children:jsx(InlineField,{label:"Label",labelWidth:26,tooltip:"Default: duration",grow:!0,children:jsx(Select,{inputId:"label",options:ut,value:Fe.jsonData.spanBar?.type||"",onChange:Tt=>{updateDatasourcePluginJsonDataOption({onOptionsChange:Ve,options:Fe},"spanBar",{...Fe.jsonData.spanBar,type:Tt?.value??""})},placeholder:"Duration",isClearable:!0,"aria-label":"select-label-name",width:40})})}),Fe.jsonData.spanBar?.type===Ci&&jsx(InlineFieldRow,{className:qe.row,children:jsx(InlineField,{label:"Tag key",labelWidth:26,tooltip:"Tag key which will be used to get the tag value. A span's attributes and resources will be searched for the tag key",children:jsx(Input,{type:"text",placeholder:"Enter tag key",onChange:Tt=>updateDatasourcePluginJsonDataOption({onOptionsChange:Ve,options:Fe},"spanBar",{...Fe.jsonData.spanBar,tag:Tt.currentTarget.value}),value:Fe.jsonData.spanBar?.tag||"",width:40})})})]})}const Gi=({options:Fe,onOptionsChange:Ve})=>{let qe=Fe.type;return qe+=Fe.type==="tempo"?"/configure-tempo-data-source/#span-bar":"/#span-bar",jsx(ConfigSubSection,{title:"Span bar",description:jsx(ConfigDescriptionLink,{description:"Add additional info next to the service and operation on a span bar row in the trace view.",suffix:qe,feature:"the span bar"}),children:jsx(Zo,{options:Fe,onOptionsChange:Ve})})},Io=Fe=>({infoText:css`
    label: infoText;
    padding-bottom: ${Fe.spacing(2)};
    color: ${Fe.colors.text.secondary};
  `,row:css`
    label: row;
    align-items: baseline;
  `});class qr{constructor(Ve){const{isTagsOpen:qe,isProcessOpen:ut,isReferencesOpen:Tt,isWarningsOpen:_t,isStackTracesOpen:Zt,logs:dn,references:Dn}=Ve||{};this.isTagsOpen=!!qe,this.isProcessOpen=!!ut,this.isReferencesOpen=!!Tt,this.isWarningsOpen=!!_t,this.isStackTracesOpen=!!Zt,this.logs={isOpen:!!(dn&&dn.isOpen),openedItems:dn&&dn.openedItems?new Set(dn.openedItems):new Set},this.references={isOpen:!!(Dn&&Dn.isOpen),openedItems:Dn&&Dn.openedItems?new Set(Dn.openedItems):new Set}}toggleTags(){const Ve=new qr(this);return Ve.isTagsOpen=!this.isTagsOpen,Ve}toggleProcess(){const Ve=new qr(this);return Ve.isProcessOpen=!this.isProcessOpen,Ve}toggleReferences(){const Ve=new qr(this);return Ve.references.isOpen=!this.references.isOpen,Ve}toggleReferenceItem(Ve){const qe=new qr(this);return qe.references.openedItems.has(Ve)?qe.references.openedItems.delete(Ve):qe.references.openedItems.add(Ve),qe}toggleWarnings(){const Ve=new qr(this);return Ve.isWarningsOpen=!this.isWarningsOpen,Ve}toggleStackTraces(){const Ve=new qr(this);return Ve.isStackTracesOpen=!this.isStackTracesOpen,Ve}toggleLogs(){const Ve=new qr(this);return Ve.logs.isOpen=!this.logs.isOpen,Ve}toggleLogItem(Ve){const qe=new qr(this);return qe.logs.openedItems.has(Ve)?qe.logs.openedItems.delete(Ve):qe.logs.openedItems.add(Ve),qe}}var Eo=e(25508);class vr{static iterFunction(Ve,qe=0){return ut=>Ve(ut.value,ut,qe)}static searchFunction(Ve){return typeof Ve=="function"?Ve:(qe,ut)=>Ve instanceof vr?ut===Ve:qe===Ve}constructor(Ve,qe=[]){this.value=Ve,this.children=qe}get depth(){return this.children.reduce((Ve,qe)=>Math.max(qe.depth+1,Ve),1)}get size(){let Ve=0;return this.walk(()=>Ve++),Ve}addChild(Ve){return this.children.push(Ve instanceof vr?Ve:new vr(Ve)),this}find(Ve){if(vr.iterFunction(vr.searchFunction(Ve))(this))return this;for(let ut=0;ut<this.children.length;ut++){const Tt=this.children[ut].find(Ve);if(Tt)return Tt}return null}getPath(Ve){const qe=vr.iterFunction(vr.searchFunction(Ve)),ut=(Tt,_t)=>{const Zt=_t.concat([Tt]);if(qe(Tt))return Zt;for(let dn=0;dn<Tt.children.length;dn++){const Dn=Tt.children[dn],An=ut(Dn,Zt);if(An)return An}return null};return ut(this,[])}walk(Ve,qe=0){const ut=[];let Tt=qe;for(ut.push({node:this,depth:Tt});ut.length;){const _t=ut[ut.length-1];ut.pop();const{node:Zt,depth:dn}=_t;Ve(Zt.value,Zt,dn),Tt=dn+1;let Dn=Zt.children.length-1;for(;Dn>=0;)ut.push({node:Zt.children[Dn],depth:Tt}),Dn--}}paths(Ve){const qe=[];qe.push({node:this,childIndex:0});const ut=[];for(;qe.length;){const{node:Tt,childIndex:_t}=qe[qe.length-1];if(Tt.children.length>=_t+1)qe[qe.length-1].childIndex++,qe.push({node:Tt.children[_t],childIndex:0});else{if(Tt.children.length===0){const Zt=qe.map(dn=>dn.node.value);Ve(Zt)}qe.pop()}}return ut}}const ui=Fe=>Fe.spanID,Ti=Fe=>Fe.references||[],ll=(0,Eo.Mz)((0,Eo.Mz)(({span:Fe})=>Fe,Ti),({type:Fe})=>Fe,(Fe,Ve)=>Fe.find(qe=>qe.refType===Ve)),hi=(0,Eo.Mz)(Fe=>ll({span:Fe,type:"CHILD_OF"}),Fe=>Fe?Fe.spanID:null),cl=Fe=>Fe.spans,Mi=(0,Eo.Mz)(cl,Fe=>Fe.reduce((Ve,qe)=>Ve.set(ui(qe),qe),new Map)),Si="__root__";function Qi(Fe,Ve=null){const qe=new Map(Fe.spans.map(Zt=>[Zt.spanID,new vr(Zt.spanID)])),ut=Ve??new Map(Fe.spans.map(Zt=>[Zt.spanID,Zt])),Tt=new vr(Si);Fe.spans.forEach(Zt=>{const dn=qe.get(Zt.spanID);if(Array.isArray(Zt.references)&&Zt.references.length){const{refType:Dn,spanID:An}=Zt.references[0];if(Dn==="CHILD_OF"||Dn==="FOLLOWS_FROM")(qe.get(An)||Tt).children?.push(dn);else throw new Error(`Unrecognized ref type: ${Dn}`)}else Tt.children.push(dn)});const _t=(Zt,dn)=>{const Dn=Zt?.value?ut.get(Zt.value.toString()):void 0,An=dn?.value?ut.get(dn.value.toString()):void 0;return+(Dn?.startTime>An?.startTime)||+(Dn?.startTime===An?.startTime)-1};return Fe.spans.forEach(Zt=>{const dn=qe.get(Zt.spanID);dn.children.length>1&&dn?.children.sort(_t)}),Tt.children.sort(_t),Tt}function Oi(Fe){const Ve=new Map,qe=Fe.reduce((Tt,_t)=>(Tt.some(Zt=>Zt.key===_t.key&&Zt.value===_t.value)?Ve.set(`${_t.key}:${_t.value}`,`Duplicate tag "${_t.key}:${_t.value}"`):Tt.push(_t),Tt),[]),ut=Array.from(Ve.values());return{dedupedTags:qe,warnings:ut}}function qo(Fe,Ve){const qe=Fe?.slice()??[],ut=(Ve||[]).map(Tt=>Tt.toLowerCase());return qe.sort((Tt,_t)=>{const Zt=Tt.key.toLowerCase(),dn=_t.key.toLowerCase();for(let Dn=0;Dn<ut.length;Dn++){const An=ut[Dn];if(Zt.startsWith(An)&&!dn.startsWith(An))return-1;if(!Zt.startsWith(An)&&dn.startsWith(An))return 1}return Zt>dn?1:Zt<dn?-1:0}),qe}function Yi(Fe){if(!Fe?.traceID)return null;const Ve=Fe.traceID.toLowerCase();let qe=0,ut=Number.MAX_SAFE_INTEGER;const Tt=new Map,_t=new Map;Fe.spans=Fe.spans.filter(us=>!!us.startTime),Fe.processes=Object.entries(Fe.processes).reduce((us,[hs,Js])=>(us[hs]={...Js,tags:qo(Js.tags)},us),{});const Zt=Fe.spans.length;for(let us=0;us<Zt;us++){const hs=Fe.spans[us],{startTime:Js,duration:Os,processID:vs}=hs;let Cs=hs.spanID;Js<ut&&(ut=Js),Js+Os>qe&&(qe=Js+Os);const ea=Tt.get(Cs);ea!=null?(console.warn(`Dupe spanID, ${ea+1} x ${Cs}`,hs,_t.get(Cs)),(0,ce.isEqual)(hs,_t.get(Cs))&&console.warn("	 two spans with same ID have `isEqual(...) === true`"),Tt.set(Cs,ea+1),Cs=`${Cs}_${ea}`,hs.spanID=Cs):Tt.set(Cs,1),hs.process=Fe.processes[vs],_t.set(Cs,hs)}const dn=Qi(Fe,_t),Dn=[],An={};dn.walk((us,hs,Js=0)=>{if(us==="__root__"||typeof us!="string")return;const Os=_t.get(us);if(!Os)return;const{serviceName:vs}=Os.process;An[vs]=(An[vs]||0)+1,Os.relativeStartTime=Os.startTime-ut,Os.depth=Js-1,Os.hasChildren=hs.children.length>0,Os.childSpanCount=hs.children.length,Os.warnings=Os.warnings||[],Os.tags=Os.tags||[],Os.references=Os.references||[],Os.childSpanIds=hs.children.slice().sort((ea,oa)=>{const As=_t.get(ea.value),ta=_t.get(oa.value);return ta.startTime+ta.duration-(As.startTime+As.duration)}).map(ea=>ea.value);const Cs=Oi(Os.tags);Os.tags=qo(Cs.dedupedTags,xs("topTagPrefixes")),Os.warnings=Os.warnings.concat(Cs.warnings),Os.references.forEach((ea,oa)=>{const As=_t.get(ea.spanID);As&&(ea.span=As,oa>0&&(As.subsidiarilyReferencedBy=As.subsidiarilyReferencedBy||[],As.subsidiarilyReferencedBy.push({spanID:us,traceID:Ve,span:Os,refType:ea.refType})))}),Dn.push(Os)});const rs=ro(Dn);return{services:Object.keys(An).map(us=>({name:us,numberOfSpans:An[us]})),spans:Dn,traceID:Ve,traceName:rs,processes:Fe.processes,duration:qe-ut,startTime:ut,endTime:qe}}},92102:(G,O,e)=>{"use strict";e.d(O,{N:()=>t});var t=(n=>(n.Logs="log",n.Traces="trace",n.Metrics="metric",n.Profiles="profile",n.Session="session",n.Unknown="unknown",n))(t||{})},92151:(G,O,e)=>{"use strict";e.d(O,{EUpdateTypes:()=>n,default:()=>r});var t=(f=>(f.DragEnd="DragEnd",f.DragMove="DragMove",f.DragStart="DragStart",f.MouseEnter="MouseEnter",f.MouseLeave="MouseLeave",f.MouseMove="MouseMove",f))(t||{});const n=t;var i=e(2543);const s=0;class r{constructor({getBounds:a,tag:c,resetBoundsOnResize:o=!0,...h}){this.resetBounds=()=>{this._bounds=void 0},this._handleMinorMouseEvent=g=>{const{button:l,clientX:p,type:m}=g;if(this._isDragging||l!==s)return;let y=null,d;if(m==="mouseenter")y=n.MouseEnter,d=this._onMouseEnter;else if(m==="mouseleave")y=n.MouseLeave,d=this._onMouseLeave;else if(m==="mousemove")y=n.MouseMove,d=this._onMouseMove;else throw new Error(`invalid event type: ${m}`);if(!d)return;const{value:v,x:u}=this._getPosition(p);d({event:g,type:y,value:v,x:u,manager:this,tag:this.tag})},this._handleDragEvent=g=>{const{button:l,clientX:p,type:m}=g;let y=null,d;if(m==="mousedown"){if(this._isDragging||l!==s)return;window.addEventListener("mousemove",this._handleDragEvent),window.addEventListener("mouseup",this._handleDragEvent);const D=(0,i.get)(document,"body.style");D&&(D.userSelect="none"),this._isDragging=!0,y=n.DragStart,d=this._onDragStart}else if(m==="mousemove"){if(!this._isDragging)return;y=n.DragMove,d=this._onDragMove}else if(m==="mouseup"){if(!this._isDragging)return;this._stopDragging(),y=n.DragEnd,d=this._onDragEnd}else throw new Error(`invalid event type: ${m}`);if(!d)return;const{value:v,x:u}=this._getPosition(p);d({event:g,type:y,value:v,x:u,manager:this,tag:this.tag})},this.handleMouseDown=this._handleDragEvent,this.handleMouseEnter=this._handleMinorMouseEvent,this.handleMouseMove=this._handleMinorMouseEvent,this.handleMouseLeave=this._handleMinorMouseEvent,this.getBounds=a,this.tag=c,this._isDragging=!1,this._bounds=void 0,this._resetBoundsOnResize=!!o,this._resetBoundsOnResize&&window.addEventListener("resize",this.resetBounds),this._onMouseEnter=h.onMouseEnter,this._onMouseLeave=h.onMouseLeave,this._onMouseMove=h.onMouseMove,this._onDragStart=h.onDragStart,this._onDragMove=h.onDragMove,this._onDragEnd=h.onDragEnd}_getBounds(){return this._bounds||(this._bounds=this.getBounds(this.tag)),this._bounds}_getPosition(a){const{clientXLeft:c,maxValue:o,minValue:h,width:g}=this._getBounds();let l=a-c,p=l/g;return h!=null&&p<h?(p=h,l=h*g):o!=null&&p>o&&(p=o,l=o*g),{value:p,x:l}}_stopDragging(){window.removeEventListener("mousemove",this._handleDragEvent),window.removeEventListener("mouseup",this._handleDragEvent);const a=(0,i.get)(document,"body.style");a&&(a.userSelect="auto"),this._isDragging=!1}isDragging(){return this._isDragging}dispose(){this._isDragging&&this._stopDragging(),this._resetBoundsOnResize&&window.removeEventListener("resize",this.resetBounds),this._bounds=void 0,this._onMouseEnter=void 0,this._onMouseLeave=void 0,this._onMouseMove=void 0,this._onDragStart=void 0,this._onDragMove=void 0,this._onDragEnd=void 0}}},30700:(G,O,e)=>{"use strict";e.d(O,{Kv:()=>c,rY:()=>o});var t=e(41811),n=e(84140),i=e(24284);function s(g){if(g.length!==7)return[0,0,0];const l=g.slice(1,3),p=g.slice(3,5),m=g.slice(5);return[parseInt(l,16),parseInt(p,16),parseInt(m,16)]}class r{constructor(l,p){const m=h(l,p);this.colorsHex=m,this.colorsRgb=m.map(s),this.cache=new Map,this.prevColorIndex=void 0}_getColorIndex(l){let p=this.cache.get(l);if(p==null){const m=this.hashCode(l?l.toLowerCase():"");if(p=Math.abs(m%this.colorsHex.length),this.prevColorIndex!==void 0){this.prevColorIndex===p&&(p=this.getNextIndex(p));const y=this.colorsHex[this.prevColorIndex];if(n.A.readability(y,this.colorsHex[p])<1.5){let d=p;for(let v=0;v<this.colorsHex.length;v++)if(d=this.getNextIndex(d),n.A.readability(y,this.colorsHex[d])>1.5){p=d;break}}}this.cache.set(l,p),this.prevColorIndex=p}return p}getNextIndex(l){return l+1<this.colorsHex.length?l+1:0}hashCode(l){let p=0,m,y;for(m=0;m<l.length;m++)y=l.charCodeAt(m),p=(p<<5)-p+y;return p}getColorByKey(l){const p=this._getColorIndex(l);return this.colorsHex[p]}getRgbColorByKey(l){const p=this._getColorIndex(l);return this.colorsRgb[p]}clear(){this.cache.clear()}}const f=(0,t.A)((g,l)=>new r(g,l));function a(g){f([],g)}function c(g,l){return f(i.Tj,l).getColorByKey(g)}function o(g,l){return f(i.Tj,l).getRgbColorByKey(g)}function h(g,l){const p=[...g],m=p.indexOf("#E24D42");m>-1&&p.splice(m,1);const y=g.indexOf("#BF1B00");y>-1&&p.splice(y,1);let d=[];for(const v of p)n.A.readability(l.colors.background.primary,v)>=3&&d.push(v);return d}},6389:(G,O,e)=>{"use strict";e.d(O,{a3:()=>D});var t=e(2543),n=e.n(t),i=e(84743),s=e.n(i);const r="YYYY-MM-DD",f="HH:mm",a=1e3,c=1e3*a,o=60*c,h=60*o,g=24*h,l=Math.log10(a),p=[{unit:"d",microseconds:g,ofPrevious:24},{unit:"h",microseconds:h,ofPrevious:60},{unit:"m",microseconds:o,ofPrevious:60},{unit:"s",microseconds:c,ofPrevious:1e3},{unit:"ms",microseconds:a,ofPrevious:1e3},{unit:"\u03BCs",microseconds:1,ofPrevious:1e3}],m=(P,x,E)=>toFloatPrecision(P/E,x)*E;function y(P){return moment(P/a).format(r)}function d(P){return moment(P/a).format(f)}function v(P){const x=m(P,l,a);return`${moment.duration(x/a).asMilliseconds()}ms`}function u(P){const x=m(P,l,c);return`${moment.duration(x/a).asSeconds()}s`}function D(P){const[x,E]=(0,t.dropWhile)(p,({microseconds:T},b)=>b<p.length-1&&T>P);if(x.ofPrevious===1e3)return`${(0,t.round)(P/x.microseconds,2)}${x.unit}`;const M=`${Math.floor(P/x.microseconds)}${x.unit}`,S=Math.round(P/E.microseconds%x.ofPrevious),I=`${S}${E.unit}`;return S===0?M:`${M} ${I}`}},28114:(G,O,e)=>{"use strict";e.d(O,{Cr:()=>T,QW:()=>m,_o:()=>C,gt:()=>S,hv:()=>I,i0:()=>p,lU:()=>h});var t=e(74848),n=e(6709),i=e(65879),s=e(47232),r=e(72574),f=e(14578),a=e(31193),c=e(96192),o=e(92102);function h({splitOpenFn:b,traceToLogsOptions:R,traceToMetricsOptions:A,traceToProfilesOptions:L,dataFrame:U,createFocusSpanLink:W,trace:w}){if(!U)return;let N=S(w.duration,w.traceName,w.traceID);const B=U.fields.some(K=>!!K.config.links?.length),V=d(b,U.fields[0],R,A,W,N);return function(H){let X=V(H);if(B){N={...N,...I(H),...T(H,L)};const k=U.fields.filter(Y=>!!Y.config.links?.length);try{let Y;L?.datasourceUid&&(Y=(0,a.tR)().getInstanceSettings(L.datasourceUid));const Z=Y?.type==="grafana-pyroscope-datasource",se=H.tags.some(oe=>oe.key===m),j=Z&&se;let q=[];k.forEach(oe=>{const z=(0,c.QL)({field:oe,rowIndex:H.dataFrameRowIndex,splitOpenFn:b,range:M(H,void 0,void 0,j),dataFrame:U,vars:N});q=q.concat(z)});const ne=q.map(oe=>({title:oe.title,href:oe.href,onClick:oe.onClick,content:(0,t.jsx)(f.I,{name:"link",title:oe.title||"Link"}),field:oe.origin,type:j?o.N.Profiles:o.N.Unknown}));X.push.apply(X,ne)}catch(Y){return console.error(Y),X}}return X}}const g=b=>b.map(R=>({key:R,value:R.includes(".")?R.replace(".","_"):void 0})),l=g(["cluster","hostname","namespace","pod","service.name","service.namespace"]),p=g(["service.name","service.namespace"]),m="pyroscope.profile.id",y="gf.feo11y.app.id";function d(b,R,A,L,U,W){let w;A?.datasourceUid&&(w=(0,a.tR)().getInstanceSettings(A.datasourceUid));const N=w?.type==="grafana-splunk-datasource";let B;return L?.datasourceUid&&(B=(0,a.tR)().getInstanceSettings(L.datasourceUid)),function(K){W={...W,...I(K)};const H=[];let X,k="";if(w&&A){const Z=A.customQuery?A.query:void 0,se=A.tags&&A.tags.length>0?A.tags:l;switch(w?.type){case"loki":k=C(K,se),X=v(K,A,k,Z);break;case"grafana-splunk-datasource":k=C(K,se,{joinBy:" "}),X=P(K,A,k,Z);break;case"elasticsearch":case"grafana-opensearch-datasource":k=C(K,se,{labelValueSign:":",joinBy:" AND "}),X=D(K,A,k,Z);break;case"grafana-falconlogscale-datasource":k=C(K,se,{joinBy:" OR "}),X=E(K,A,k,Z);break;case"googlecloud-logging-datasource":k=C(K,se,{joinBy:" AND "}),X=x(K,A,k,Z)}if(X){const j={title:w.name,url:"",internal:{datasourceUid:w.uid,datasourceName:w.name,query:X}};if(W={...W,__tags:{text:"Tags",value:k}},(0,c.O1)(j.internal.query,W).allVariablesDefined){const q=(0,n.u)({link:j,internalLink:j.internal,scopedVars:W,range:M(K,{startMs:A.spanStartTimeShift?i.intervalToMs(A.spanStartTimeShift):0,endMs:A.spanEndTimeShift?i.intervalToMs(A.spanEndTimeShift):0},N),field:{},onClickFn:b,replaceVariables:(0,r.w)().replace.bind((0,r.w)())});H.push({href:q.href,title:"Related logs",onClick:q.onClick,content:(0,t.jsx)(f.I,{name:"gf-logs",title:"Explore the logs for this in split view"}),field:R,type:o.N.Logs})}}}if(B&&L?.queries)for(const Z of L.queries){const se=Z.query||`histogram_quantile(0.5, sum(rate(traces_spanmetrics_latency_bucket{service="${K.process.serviceName}"}[5m])) by (le))`,j={title:B.name,url:"",internal:{datasourceUid:B.uid,datasourceName:B.name,query:{expr:se,refId:"A"}}},q=L.tags&&L.tags.length>0?L.tags:l;W={...W,__tags:{text:"Tags",value:C(K,q)}};const ne=(0,n.u)({link:j,internalLink:j.internal,scopedVars:W,range:M(K,{startMs:L.spanStartTimeShift?i.intervalToMs(L.spanStartTimeShift):-12e4,endMs:L.spanEndTimeShift?i.intervalToMs(L.spanEndTimeShift):12e4}),field:{},onClickFn:b,replaceVariables:(0,r.w)().replace.bind((0,r.w)())});H.push({title:Z?.name,href:ne.href,onClick:ne.onClick,content:(0,t.jsx)(f.I,{name:"chart-line",title:"Explore metrics for this span"}),field:R,type:o.N.Metrics})}if(K.references&&U)for(const Z of K.references){if(Z.refType==="CHILD_OF")continue;const se=U(Z.traceID,Z.spanID);H.push({href:se.href,title:Z.span?Z.span.operationName:"View linked span",content:(0,t.jsx)(f.I,{name:"link",title:"View linked span"}),onClick:se.onClick,field:se.origin,type:o.N.Traces})}if(K.subsidiarilyReferencedBy&&U)for(const Z of K.subsidiarilyReferencedBy){const se=U(Z.traceID,Z.spanID);H.push({href:se.href,title:Z.span?Z.span.operationName:"View linked span",content:(0,t.jsx)(f.I,{name:"link",title:"View linked span"}),onClick:se.onClick,field:se.origin,type:o.N.Traces})}const Y=u(K);return Y&&H.push({title:"Session for this span",href:Y,content:(0,t.jsx)(f.I,{name:"frontend-observability",title:"Session for this span"}),field:R,type:o.N.Session}),H}}function v(b,R,A,L){const{filterByTraceID:U,filterBySpanID:W}=R;if(L)return{expr:L,refId:""};if(!A)return;let w="{${__tags}}";return U&&b.traceID&&(w+=' |="${__span.traceId}"'),W&&b.spanID&&(w+=' |="${__span.spanId}"'),{expr:w,refId:""}}function u(b){const R=b.process.tags.find(L=>L.key===y)?.value,A=b.tags.find(L=>L.key==="session_id"||L.key==="session.id")?.value;return R&&A?`/a/grafana-kowalski-app/apps/${R}/sessions/${A}`:void 0}function D(b,R,A,L){const{filterByTraceID:U,filterBySpanID:W}=R;if(L)return{query:L,refId:"",metrics:[{id:"1",type:"logs"}]};let w=[];return W&&b.spanID&&w.push('"${__span.spanId}"'),U&&b.traceID&&w.push('"${__span.traceId}"'),A&&w.push("${__tags}"),{query:w.join(" AND "),refId:"",metrics:[{id:"1",type:"logs"}]}}function P(b,R,A,L){const{filterByTraceID:U,filterBySpanID:W}=R;if(L)return{query:L,refId:""};let w="";return A&&(w+="${__tags}"),U&&b.traceID&&(w+=' "${__span.traceId}"'),W&&b.spanID&&(w+=' "${__span.spanId}"'),{query:w,refId:""}}function x(b,R,A,L){const{filterByTraceID:U,filterBySpanID:W}=R;if(L)return{query:L,refId:""};let w=[];return W&&b.spanID&&w.push('"${__span.spanId}"'),U&&b.traceID&&w.push('"${__span.traceId}"'),A&&w.push("${__tags}"),{query:w.join(" AND "),refId:""}}function E(b,R,A,L){const{filterByTraceID:U,filterBySpanID:W}=R;if(L)return{lsql:L,refId:""};if(!A)return;let w="${__tags}";return U&&b.traceID&&(w+=' or "${__span.traceId}"'),W&&b.spanID&&(w+=' or "${__span.spanId}"'),{lsql:w,refId:""}}function C(b,R,{labelValueSign:A="=",joinBy:L=", "}={}){return[...b.process.tags,...b.tags,{key:"spanId",value:b.spanID},{key:"traceId",value:b.traceID},{key:"name",value:b.operationName},{key:"duration",value:b.duration}].map(U=>{const W=R.find(w=>w.key===U.key);if(W)return`${W.value?W.value:W.key}${A}"${U.value}"`}).filter(U=>!!U).join(L)}function M(b,R={startMs:0,endMs:0},A=!1,L=!1){let U=Math.floor(b.startTime/1e3+R.startMs);const W=(b.startTime+b.duration)/1e3;let w=Math.floor(W+R.endMs);A&&w-U<1e3?w=U+1e3:L?(U=U-6e4,w=w+6e4):U===w&&w++;const N=(0,s.KQ)(w),B=(0,s.KQ)(U);return{from:B,to:N,raw:{from:B,to:N}}}function S(b,R,A){return{__trace:{text:"Trace",value:{duration:b,name:R,traceId:A}}}}function I(b){const R={};for(const A of b.process.tags)R[A.key]=A.value;for(const A of b.tags)R[A.key]=A.value;return{__span:{text:"Span",value:{spanId:b.spanID,traceId:b.traceID,duration:b.duration,name:b.operationName,tags:R}}}}function T(b,R){let A={};if(R){const L=R.tags&&R.tags.length>0?R.tags:p;A={__tags:{text:"Tags",value:C(b,L)}}}return A}},15583:(G,O,e)=>{"use strict";e.d(O,{Ji:()=>f,SQ:()=>a,zE:()=>s});var t=e(96540),n=e(62938),i=e(56271);const s=()=>(0,n.A)().slice(0,12),f={spanNameOperator:"=",serviceNameOperator:"=",fromOperator:">",toOperator:"<",tags:[{id:s(),operator:"="}]};function a(c){const[o,h]=(0,t.useState)(f),g=(0,t.useMemo)(()=>c&&(0,i.filterSpans)(o,c),[o,c]);return{search:o,setSearch:h,spanFilterMatches:g}}},35090:(G,O,e)=>{"use strict";e.d(O,{L:()=>i});var t=e(78368),n=e(56271);function i(r){if(!r)return null;let f=r.fields.length===1?r.fields[0].values[0]:s(r);return f?(0,n.transformTraceData)(f):null}function s(r){const f=new t.R(r),a={};for(let c=0;c<f.length;c++){const o=f.get(c);if(!o.spanID)return null;a[o.spanID]||(a[o.spanID]={serviceName:o.serviceName,tags:o.serviceTags})}return{traceID:f.get(0).traceID,processes:a,spans:f.toArray().map((c,o)=>{const h=[];return c.parentSpanID&&h.push({refType:"CHILD_OF",spanID:c.parentSpanID,traceID:c.traceID}),c.references&&h.push(...c.references.map(g=>({refType:"FOLLOWS_FROM",...g}))),{...c,duration:c.duration*1e3,startTime:c.startTime*1e3,processID:c.spanID,flags:0,references:h,logs:c.logs?.map(g=>({...g,timestamp:g.timestamp*1e3}))||[],dataFrameRowIndex:o}})}}},11140:(G,O,e)=>{"use strict";e.d(O,{v:()=>L});var t=e(74848),n=e(2543),i=e(96540),s=e(49785),r=e(71733),f=e(14110),a=e(12131),c=e(32264),o=e(88575),h=e(94354),g=e(42418),l=e(37390),p=e(55852),m=e(59429),y=e(16233),d=e(20470),v=e(31678),u=e(9955),D=e(28676),P=e(71176),x=(U=>(U.FETCH_DASHBOARD="fetch-dashboard",U.SET_DASHBOARD_LS="set-dashboard-ls-error",U))(x||{});function E(U,W){let w=[];return U==="table"&&W.panelState?.logs?.columns&&(W.panelState.logs?.labelFieldName&&w.push({id:"extractFields",options:{source:W.panelState.logs.labelFieldName}}),w.push({id:"organize",options:{indexByName:Object.values(W.panelState.logs.columns).reduce((N,B,V)=>({...N,[B]:V}),{}),includeByName:Object.values(W.panelState.logs.columns).reduce((N,B)=>({...N,[B]:!0}),{})}})),w}async function C(U){const W=I(U.queries,U.queryResponse,U?.panelState),w={targets:U.queries,type:W,title:"New Panel",gridPos:{x:0,y:0,w:12,h:8},datasource:U.datasource,transformations:E(W,U)};let N;if(U.dashboardUid)try{N=await(0,D.n)().getDashboardDTO(U.dashboardUid)}catch{throw"fetch-dashboard"}else N=await(0,P.X)();N.dashboard.panels=[w,...N.dashboard.panels??[]],N.dashboard.time=U.time;try{(0,d.OI)(N)}catch{throw"set-dashboard-ls-error"}}const M=U=>!U.hide,S=U=>W=>W.refId===U;function I(U,W,w){for(const{refId:N}of U.filter(M)){const B=S(N);if(W.flameGraphFrames.some(B))return"flamegraph";if(W.graphFrames.some(B))return"timeseries";if(W.logsFrames.some(B))return w?.logs?.visualisationType?w.logs.visualisationType:"logs";if(W.nodeGraphFrames.some(B))return"nodeGraph";if(W.traceFrames.some(B))return"traces";if(W.customFrames.some(B))return W.customFrames.find(B)?.meta?.preferredVisualisationPluginId??"table"}return"table"}var T=(U=>(U.NewDashboard="new-dashboard",U.ExistingDashboard="existing-dashboard",U))(T||{});function b(U){}function R(U){return U?`d/${U}`:"dashboard/new"}var A=(U=>(U.UNKNOWN="unknown-error",U.NAVIGATION="navigation-error",U))(A||{});function L(U){const{exploreId:W,onClose:w}=U,N=(0,v.useSelector)((0,u.qq)(W)),[B,V]=(0,i.useState)(),{handleSubmit:K,control:H,formState:{errors:X},watch:k}=(0,s.mN)({defaultValues:{saveTarget:"new-dashboard"}}),Y=y.TP.hasPermission(v.AccessControlAction.DashboardsCreate),Z=y.TP.hasPermission(v.AccessControlAction.DashboardsWrite),se=[];Y&&se.push({label:"New dashboard",value:"new-dashboard"}),Z&&se.push({label:"Existing dashboard",value:"existing-dashboard"});const j=se.length>1?k("saveTarget"):se[0].value,q=async(ne,oe)=>{V(void 0);const z=oe.saveTarget==="existing-dashboard"?oe.dashboardUid:void 0;(0,f.rR)("e_2_d_submit",{newTab:ne,saveTarget:oe.saveTarget,queries:N.queries.length});const{from:te,to:le}=N.range.raw;try{await C({dashboardUid:z,datasource:N.datasourceInstance?.getRef(),queries:N.queries,queryResponse:N.queryResponse,panelState:N?.panelsState,time:{from:typeof te=="string"?te:te.toISOString(),to:typeof le=="string"?le:le.toISOString()}})}catch(re){switch(re){case x.FETCH_DASHBOARD:V({error:re,message:"Could not fetch dashboard information. Please try again."});break;case x.SET_DASHBOARD_LS:V({error:re,message:"Could not add panel to dashboard. Please try again."});break;default:V({error:"unknown-error",message:"Something went wrong. Please try again."})}return}const ie=R(z);if(!ne){w(),a.Ny.push(r.I.stripBaseFromUrl(ie));return}if(!!!e.g.open(c.$.appUrl+ie,"_blank")){V({error:"navigation-error",message:"Could not navigate to the selected dashboard. Please try again."}),(0,d.yZ)();return}w()};return(0,i.useEffect)(()=>{(0,f.rR)("e_2_d_open")},[]),(0,t.jsxs)("form",{children:[se.length>1&&(0,t.jsx)(s.xI,{control:H,render:({field:{ref:ne,...oe}})=>(0,t.jsx)(o.D,{label:"Target dashboard",description:"Choose where to add the panel.",children:(0,t.jsx)(h.z,{options:se,...oe,id:"e2d-save-target"})}),name:"saveTarget"}),j==="existing-dashboard"&&(0,t.jsx)(s.xI,{render:({field:{ref:ne,value:oe,onChange:z,...te}})=>(0,t.jsx)(o.D,{label:"Dashboard",description:"Select in which dashboard the panel will be created.",error:X.dashboardUid?.message,invalid:!!X.dashboardUid,children:(0,t.jsx)(m.b,{...te,inputId:"e2d-dashboard-picker",defaultOptions:!0,onChange:le=>z(le?.uid)})}),control:H,name:"dashboardUid",shouldUnregister:!0,rules:{required:{value:!0,message:"This field is required."}}}),B&&(0,t.jsx)(g.F,{severity:"error",title:"Error adding the panel",children:B.message}),(0,t.jsxs)(l.a.ButtonRow,{children:[(0,t.jsx)(p.$n,{type:"reset",onClick:w,fill:"outline",variant:"secondary",children:"Cancel"}),(0,t.jsx)(p.$n,{type:"submit",variant:"secondary",onClick:K((0,n.partial)(q,!0)),icon:"external-link-alt",children:"Open in new tab"}),(0,t.jsx)(p.$n,{type:"submit",variant:"primary",onClick:K((0,n.partial)(q,!1)),icon:"apps",children:"Open dashboard"})]})]})}},12881:(G,O,e)=>{"use strict";e.d(O,{t:()=>i});var t=e(16233),n=e(31678);function i(){const s=t.TP.hasPermission(n.AccessControlAction.DashboardsCreate),r=t.TP.hasPermission(n.AccessControlAction.DashboardsWrite);return s&&!r?"Add panel to new dashboard":r&&!s?"Add panel to existing dashboard":"Add panel to dashboard"}},24401:(G,O,e)=>{"use strict";e.d(O,{s:()=>a});var t=e(74848),n=e(71733),i=e(12131),s=e(37390),r=e(67061),f=e(55852);function a(c){const{onDismiss:o,path:h,title:g}=c,l=()=>{e.g.open(n.I.assureBaseUrl(h),"_blank"),o()},p=()=>i.Ny.push(h);return(0,t.jsxs)(s.a,{title:g,isOpen:!0,onDismiss:o,children:[(0,t.jsx)(r.B,{direction:"column",gap:1,children:(0,t.jsx)("p",{children:"Do you want to proceed in the current tab or open a new tab?"})}),(0,t.jsxs)(s.a.ButtonRow,{children:[(0,t.jsx)(f.$n,{onClick:o,fill:"outline",variant:"secondary",children:"Cancel"}),(0,t.jsx)(f.$n,{type:"submit",variant:"secondary",onClick:l,icon:"external-link-alt",children:"Open in new tab"}),(0,t.jsx)(f.$n,{type:"submit",variant:"primary",onClick:p,icon:"apps",children:"Open"})]})]})}},30973:(G,O,e)=>{"use strict";e.d(O,{w:()=>r});var t=e(74848),n=e(96540),i=e(38138),s=e(75462);function r({extensions:c,onSelect:o}){const{categorised:h,uncategorised:g}=a(c),l=g.length>0&&Object.keys(h).length>0;return(0,t.jsx)(i.W,{children:(0,t.jsxs)(t.Fragment,{children:[Object.keys(h).map(p=>(0,t.jsx)(i.W.Group,{label:(0,s.pL)(p,25),children:f(h[p],o)},p)),l&&(0,t.jsx)(i.W.Divider,{},"divider"),f(g,o)]})})}function f(c,o){return c.map(h=>(0,t.jsx)(i.W.Item,{ariaLabel:h.title,icon:h?.icon||"plug",label:(0,s.pL)(h.title,25),onClick:g=>{if(h.path)return o(h);h.onClick?.(g)}},h.id))}function a(c){return(0,n.useMemo)(()=>{const o=[],h={};for(const g of c){if(!g.category){o.push(g);continue}Array.isArray(h[g.category])||(h[g.category]=[]),h[g.category].push(g)}return{uncategorised:o,categorised:h}},[c])}},33368:(G,O,e)=>{"use strict";e.d(O,{h:()=>i});var t=e(96540),n=e(96192);const i=(s,r)=>(0,t.useMemo)(()=>(0,n.YV)(s,r),[s,r])},39590:(G,O,e)=>{"use strict";e.d(O,{m:()=>se,s:()=>q});var t=e(96540),n=e(76888),i=e(3169),s=e(31678),r=e(9955),f=e(34028);const a={parse:ne=>{if(!ne.left&&!ne.right)return{to:{left:{datasource:null,queries:[],range:{from:f.kn.from,to:f.kn.to}},schemaVersion:0},error:!1};let oe,z,te,le;return typeof ne.left=="string"&&([oe,te]=g(ne.left)),typeof ne.right=="string"?[z,le]=g(ne.right):ne.right&&(z=h,le=!0),oe||(oe=h),{to:{schemaVersion:0,left:oe,...z&&{right:z}},error:!!te||!!le}}},c=(ne,...oe)=>oe.some(z=>ne.hasOwnProperty(z));var o=(ne=>(ne[ne.RangeFrom=0]="RangeFrom",ne[ne.RangeTo=1]="RangeTo",ne[ne.Datasource=2]="Datasource",ne[ne.SegmentsStart=3]="SegmentsStart",ne))(o||{});const h={datasource:null,queries:[],range:f.kn};function g(ne){let oe;try{oe=JSON.parse(ne)}catch{return[h,!0]}if(!Array.isArray(oe))return[{queries:[],range:f.kn,...oe},!1];if(oe.length<=3)return[h,!0];const z={from:oe[0],to:oe[1]},te=oe[2],le=oe.slice(3),ie=le.filter(re=>!c(re,"ui","mode","__panelsState")),ae=le.find(re=>c(re,"__panelsState"))?.__panelsState;return[{datasource:te,queries:ie,range:z,panelsState:ae},!1]}var l=e(87490),p=e(15961);const m={parse:ne=>{if(!ne||!ne.panes||typeof ne.panes!="string")return{to:{schemaVersion:1,panes:{[(0,l.o$)()]:y}},error:!1};let oe;try{oe=JSON.parse(ne.panes)}catch{}if(oe==null||typeof oe!="object")return{to:{schemaVersion:1,panes:{[(0,l.o$)()]:y}},error:!0};const z=Object.entries(oe).map(([te,le])=>[te,d(le)]).reduce((te,[le,ie])=>{let ae=le;return(ae.length!==3||/^\d+$/.test(ae)||ae.split("").some(re=>l.WP.indexOf(re)===-1))&&(ae=(0,l.o$)()),{...te,[ae]:ie}},{});return Object.keys(z).length||(z[(0,l.o$)()]=y),{to:{schemaVersion:1,panes:z},error:!1}},migrate:ne=>({schemaVersion:1,panes:{[(0,l.o$)()]:ne.left,...ne.right&&{[(0,l.o$)()]:ne.right}}})},y={datasource:null,queries:[],range:f.kn};function d(ne){return!ne||typeof ne!="object"?y:{...y,...(0,p.C)("queries",ne)&&Array.isArray(ne.queries)&&{queries:ne.queries},...(0,p.C)("datasource",ne)&&typeof ne.datasource=="string"&&{datasource:ne.datasource},...(0,p.C)("panelsState",ne)&&!!ne.panelsState&&typeof ne.panelsState=="object"&&{panelsState:ne.panelsState},...(0,p.C)("range",ne)&&!!ne.range&&typeof ne.range=="object"&&(0,p.C)("from",ne.range)&&(0,p.C)("to",ne.range)&&typeof ne.range.from=="string"&&typeof ne.range.to=="string"&&{range:{from:ne.range.from,to:ne.range.to}}}}const v=ne=>D(ne),u=[a,m],D=ne=>{const oe=P(ne),[z,...te]=u.slice(oe),{error:le,to:ie}=z.parse(ne);return[te.reduce((re,ce)=>ce.migrate?ce.migrate(re):re,ie),le]};function P(ne){return!ne||!("schemaVersion"in ne)||!ne.schemaVersion?0:typeof ne.schemaVersion=="number"?ne.schemaVersion:typeof ne.schemaVersion=="string"?Number.parseInt(ne.schemaVersion,10):0}var x=e(2543),E=e(18226),C=e(62860),M=e(62256),S=e(29436),I=e(23994),T=e(89224),b=e(27649),R=e(39070),A=e(41987),L=e(31193),U=e(14678);const W=(ne,oe)=>{const z=!(0,x.isEqual)(oe?.datasource,ne?.datasource),te=!(0,x.isEqual)(oe?.queries,ne?.queries),le=!(0,x.isEqual)(oe?.range||f.kn,ne?.range||f.kn),ie=!(0,x.isEqual)(oe?.panelsState,ne?.panelsState);return{datasource:z,queries:te,range:le,panelsState:ie}};async function w(ne,oe,z){if(ne)try{return await(0,L.tR)().get(ne)}catch{}const te=[...new Set(oe.map(le=>le.datasource).filter(R.zz).map(le=>typeof le=="string"?le:le.uid))];try{if(te.length>=1){const le=(await Promise.allSettled(te.map(ie=>(0,L.tR)().get(ie)))).filter(p.s);if(le.length>1)return await(0,L.tR)().get(U.uv);if(le.length===1)return await(0,L.tR)().get(te[0])}}catch{}return(0,L.tR)().get((0,l.HQ)(z)).catch(()=>(0,L.tR)().get()).catch(()=>{})}function N(ne){return{...ne.getDefaultQuery?.(A.Jk.Explore),refId:"A",datasource:ne.getRef()}}function B(ne){return ne.name===U.uv}function V(ne){return ne&&B(ne)?oe=>!!oe.datasource:oe=>oe.datasource?typeof oe.datasource=="string"?oe.datasource===ne?.uid||oe.datasource===ne?.name:oe.datasource.uid===ne?.uid:!0}async function K(ne){return(await Promise.allSettled(ne.map(z=>(0,L.tR)().get(z.datasource).then(te=>({query:z,ds:te}))))).filter(p.s).map(({value:z})=>z.query)}function H(ne,oe,z){const te=Object.values(ne.panes);if(te.length>1){const le=te.some(({range:ie},ae,[{range:re}])=>!(0,x.isEqual)(ie,re));z((0,S.qz)({syncedTimes:!le}))}Object.entries(ne.panes).forEach(async([le,ie],ae)=>{const{datasource:re,queries:ce,range:me,panelsState:ee}=ie,de=oe[le];if(de!==void 0){const De=W(ie,se(de));Promise.resolve().then(async()=>{De.datasource&&re&&await z((0,C.wh)({exploreId:le,datasource:re}))}).then(async()=>{De.range&&z((0,T.JA)({exploreId:le,rawRange:(0,f.Z9)(me)})),De.queries&&z((0,I.h9)({exploreId:le,queries:(0,b.v)(ce)})),(De.queries||De.range)&&(await z((0,I.hS)(le)),z((0,I.Od)({exploreId:le}))),De.panelsState&&ee&&z((0,M.fx)({exploreId:le,panelsState:ee}))})}else z((0,M.Gd)({exploreId:le,datasource:re||"",queries:(0,b.v)(ce),range:(0,f.Z9)(me),panelsState:ee,position:ae,eventBridge:new E.o}))}),Object.keys(oe).filter(le=>!Object.keys(ne.panes).includes(le)).forEach(le=>z((0,S.J8)(le)))}function X(ne,oe,z,te,le){te((0,S.Ve)()),Promise.all(Object.entries(ne.panes).map(([ie,{datasource:ae,queries:re,range:ce,panelsState:me}])=>w(ae,re,z).then(ee=>Promise.resolve(ee?re.length?(0,b.v)(re).filter(V(ee)).map(B(ee)?x.identity:de=>({...de,datasource:ee.getRef()})):(0,L.tR)().get(B(ee)?void 0:ee.getRef()).then(de=>[N(de)]):[]).then(async de=>{let De=await K(de);return!De.length&&ee&&(De=[N(B(ee)?await(0,L.tR)().get():ee)]),{exploreId:ie,range:ce,panelsState:me,queries:De,datasource:ee}})))).then(async ie=>{const ae=await Promise.all(ie.map(({exploreId:de,range:De,panelsState:fe,queries:Te,datasource:je})=>te((0,M.Gd)({exploreId:de,datasource:je,queries:Te,range:(0,f.Z9)(De),panelsState:fe,eventBridge:new E.o})).unwrap()));if(ae.length>1){const de=ae.some(({state:De},fe,[{state:Te}])=>!(0,x.isEqual)(De.range.raw,Te.range.raw));te((0,S.qz)({syncedTimes:!de}))}const re=ae.reduce((de,{exploreId:De,state:fe})=>({...de,[De]:se(fe)}),{}),ce=le.getSearchObject();let me={};for(const[de,De]of Object.entries(ce).filter(([fe])=>!["schemaVersion","panes","orgId","left","right"].includes(fe)))me[de]=De;const ee=new URLSearchParams({schemaVersion:`${ne.schemaVersion}`,panes:JSON.stringify(re),orgId:`${z}`,...me});le.replace({pathname:le.getLocation().pathname,search:ee.toString()}),oe.current="done"})}function k(ne,oe){return ne.current=C.wh.pending.type===oe.type,[S.J8.type,S.ve.fulfilled.type,I.Od.pending.type,T.eM.type,M.fx.type,C.wh.fulfilled.type].includes(oe.type)&&!ne.current}function Y(ne,oe,z,te){const le=Object.entries(ne.panes).reduce((ie,[ae,re])=>re?{...ie,[ae]:se(re)}:ie,{});if(!(0,x.isEqual)(oe.current.panes,JSON.stringify(le))){const ie=!!oe.current.panes&&Object.values(oe.current.panes).filter(Boolean).length===0||z.current==="pending";oe.current={panes:JSON.stringify(le)},te.partial({panes:oe.current.panes},ie)}}var Z=e(76885);function se(ne){return{datasource:ne.datasourceInstance?.uid||"",queries:ne.queries.map(l.w4),range:(0,Z.sQ)(ne.range.raw),panelsState:j(ne.panelsState)}}function j(ne){let oe=(0,x.mapValues)(ne,z=>(0,x.isObject)(z)?j(z):z);if(oe=(0,x.omitBy)(oe,x.isEmpty),!(0,x.isEmpty)(oe))return oe}function q(ne){const{location:oe}=(0,n.Il)(),z=(0,s.useDispatch)(),te=(0,s.useSelector)(r.Qb),le=(0,t.useRef)(te),ie=(0,s.useSelector)(ee=>ee.user.orgId),ae=(0,t.useRef)(ne),re=(0,t.useRef)("notstarted"),ce=(0,t.useRef)(!1),{warning:me}=(0,i._2)();(0,t.useEffect)(()=>{ne.panes||(re.current="notstarted",ae.current=ne)},[ne]),(0,t.useEffect)(()=>{const ee=z((0,s.addListener)({predicate:de=>k(ce,de),effect:async(de,{cancelActiveListeners:De,delay:fe,getState:Te})=>{De(),await fe(200),Y(Te().explore,ae,re,oe)}}));return()=>ee()},[z,oe]),(0,t.useEffect)(()=>{le.current=te},[te]),(0,t.useEffect)(()=>{const ee=ae.current?.panes!==ne.panes,[de,De]=v(ne);De&&me("Could not parse Explore URL","The requested URL contains invalid parameters, a default Explore state has been loaded."),!ee&&re.current==="notstarted"&&(re.current="pending",X(de,re,ie,z,oe)),ae.current=ne,ee&&re.current==="done"&&H(de,le.current,z)},[z,ie,oe,ne,me])}},15961:(G,O,e)=>{"use strict";e.d(O,{C:()=>n,s:()=>t});const t=i=>i.status==="fulfilled";function n(i,s){return i in s}},324:(G,O,e)=>{"use strict";e.d(O,{M:()=>g,v:()=>p});var t=e(88483),n=e(19347),i=e(14110),s=e(82467),r=e(3169),f=e(18380),a=e(99140),c=e(62256),o=e(29436),h=e(23994);const g=m=>new t.c(y=>{const d=a.M_.getState().explore.panes[m]?.correlations;if(d)y.next(d),y.complete();else{const v=a.M_.subscribe(()=>{const u=a.M_.getState().explore.panes[m]?.correlations;u&&(v(),y.next(u),y.complete())})}});function l(m){return async(y,d)=>{const v=d().explore.panes[m];if(v.datasourceInstance?.uid!==void 0){let u=v.datasourceInstance.meta.mixed?v.queries.map(P=>P.datasource?.uid).filter(P=>P!==null):[v.datasourceInstance.uid];const D=await(0,f.J6)(u);y((0,c.Fb)({exploreId:m,correlations:D.correlations||[]}))}}}function p(m,y,d){return async(v,u)=>{const D=Object.keys(u().explore?.panes),P=u().explore?.panes[D[0]],x=u().explore?.panes[D[1]];if(!P||!x)return;const E=P.datasourceInstance?.meta.mixed?P.queries[0].datasource:P.datasourceInstance?.getRef(),C=x.datasourceInstance?.meta.mixed?x.queries[0].datasource:x.datasourceInstance?.getRef(),[M,S]=await Promise.all([(0,n.l)().get(E),(0,n.l)().get(C)]);if(M?.uid&&S?.uid&&x.correlationEditorHelperData?.resultField){const I={sourceUID:M.uid,targetUID:S.uid,label:m||await(0,f.tZ)(P,x),description:y,config:{field:x.correlationEditorHelperData.resultField,target:x.queries[0],type:"query",transformations:d}};await(0,f.$q)(M.uid,I).then(async()=>{v((0,o.J8)(D[1])),await v(l(D[0])),await v((0,h.Od)({exploreId:D[0]})),(0,i.rR)("grafana_explore_correlation_editor_saved",{sourceDatasourceType:M.type,targetDataSourceType:S.type})}).catch(T=>{v((0,s.dx)((0,r.gi)("Error creating correlation",T))),console.error(T)})}}}},62860:(G,O,e)=>{"use strict";e.d(O,{YR:()=>m,wh:()=>p});var t=e(65307),n=e(14110),i=e(11134),s=e(87490),r=e(18380),f=e(31678),a=e(57288),c=e(62256),o=e(23994),h=e(89224),g=e(34028);const l=(0,t.VP)("explore/updateDatasourceInstance"),p=(0,f.createAsyncThunk)("explore/changeDatasource",async({datasource:y,exploreId:d,options:v},{getState:u,dispatch:D})=>{const P=u().user.orgId,{history:x,instance:E}=await(0,g.BE)(P,y),C=u().explore.panes[d].datasourceInstance;(0,n.rR)("explore_change_ds",{from:(C?.meta?.mixed?"mixed":C?.type)||"unknown",to:E.meta.mixed?"mixed":E.type,exploreId:d}),D(l({exploreId:d,datasourceInstance:E,history:x}));const M=u().explore.panes[d].queries,S=(0,g.dq)(E.uid,M),I=await(0,r.J6)(S);D((0,c.Fb)({exploreId:d,correlations:I.correlations||[]})),v?.importQueries&&await D((0,o.y2)(d,M,C,E)),u().explore.panes[d].isLive&&D((0,h.hO)({exploreId:d,refreshInterval:i.cC.offOption.value})),v?.importQueries&&D((0,o.Od)({exploreId:d}))}),m=(y,d)=>{if(l.match(d)){const{datasourceInstance:v,history:u}=d.payload;return(0,s._u)(y.querySubscription),{...y,datasourceInstance:v,graphResult:null,tableResult:null,logsResult:null,supplementaryQueries:(0,a.Ez)(),queryResponse:(0,g.RA)(),queryKeys:[],history:u}}return y}},62256:(G,O,e)=>{"use strict";e.d(O,{EA:()=>l,Fb:()=>d,Gd:()=>u,LJ:()=>D,QZ:()=>v,fx:()=>g,nE:()=>p});var t=e(65307),n=e(87490),i=e(18380),s=e(32901),r=e(31678),f=e(62860),a=e(23994),c=e(89224),o=e(34028);const h=(0,t.VP)("explore/changeSize"),g=(0,t.VP)("explore/changePanels");function l(P,x,E){return async(C,M)=>{const S=M().explore.panes[P];if(S===void 0)return;const{panelsState:I}=S;C(g({exploreId:P,panelsState:{...I,[x]:E}}))}}const p=(0,t.VP)("explore/changeCorrelationHelperData"),m=(0,t.VP)("explore/initializeExploreAction"),y=(0,t.VP)("explore/setUrlReplaced"),d=(0,t.VP)("explore/saveCorrelationsAction");function v(P,{width:x}){return h({exploreId:P,width:x})}const u=(0,r.createAsyncThunk)("explore/initializeExplore",async({exploreId:P,datasource:x,queries:E,range:C,panelsState:M,correlationHelperData:S,eventBridge:I},{dispatch:T,getState:b,fulfillWithValue:R})=>{let A,L=[];if(x){const U=b().user.orgId,W=await(0,o.BE)(U,x);A=W.instance,L=W.history}if(T(m({exploreId:P,queries:E,range:(0,o.eO)(C,(0,s.O)(b().user)),datasourceInstance:A,history:L,eventBridge:I})),M!==void 0&&T(g({exploreId:P,panelsState:M})),T((0,c.JA)({exploreId:P})),A){const U=(0,o.dq)(A.uid,E),W=await(0,i.J6)(U);T(d({exploreId:P,correlations:W.correlations||[]})),T((0,a.Od)({exploreId:P}))}return S!==void 0&&b().explore.correlationEditorDetails?.editorMode&&T(p({exploreId:P,correlationEditorHelperData:S})),R({exploreId:P,state:b().explore.panes[P]})}),D=(P=(0,o.HZ)(),x)=>{if(P=(0,a.JQ)(P,x),P=(0,f.YR)(P,x),P=(0,c.QP)(P,x),h.match(x)){const E=x.payload.width;return{...P,containerWidth:E}}if(g.match(x)){const{panelsState:E}=x.payload;return{...P,panelsState:E}}if(p.match(x)){const{correlationEditorHelperData:E}=x.payload;return{...P,correlationEditorHelperData:E}}if(d.match(x))return{...P,correlations:x.payload.correlations};if(m.match(x)){const{queries:E,range:C,datasourceInstance:M,history:S,eventBridge:I}=x.payload;return{...P,range:C,queries:E,initialized:!0,eventBridge:I,queryKeys:(0,n.dY)(E),datasourceInstance:M,history:S,queryResponse:(0,o.RA)(),cache:[],correlations:[]}}return P}},72433:(G,O,e)=>{"use strict";e.d(O,{Bj:()=>v,H9:()=>o,PA:()=>y,Uu:()=>p,VM:()=>h,fP:()=>d,jX:()=>l,ri:()=>a,s1:()=>g,sh:()=>c,wk:()=>m});var t=e(65307),n=e(81523),i=e(11401),s=e(29436);const r=(0,t.VP)("explore/historyUpdated"),f=({updatedQuery:u,deletedId:D})=>async(P,x)=>{const E=x().explore.richHistory,C=E.map(S=>S.id===u?.id?u:S).filter(S=>S.id!==D),M=E.length-C.length;P((0,s.U2)({richHistoryResults:{richHistory:C,total:x().explore.richHistoryTotal-M}}))},a=(u,D,P,x,E)=>async(C,M)=>{const S=E?{quotaExceededError:!1,limitExceededWarning:!1,otherErrors:!1}:{quotaExceededError:!M().explore.richHistoryStorageFull,limitExceededWarning:!M().explore.richHistoryLimitExceededWarningShown},{richHistoryStorageFull:I,limitExceeded:T}=await(0,n.l0)({localOverride:u,datasource:{uid:D,name:P},queries:x,starred:!1,showNotif:S});E||(I&&C((0,s.fj)()),T&&C((0,s.D)()))},c=(u,D)=>async(P,x)=>{const E=await(0,n.oU)(u,D);P(f({updatedQuery:E}))},o=(u,D)=>async P=>{const x=await(0,n.cX)(u,D);P(f({updatedQuery:x}))},h=u=>async D=>{const P=await(0,n.NC)(u);D(f({deletedId:P}))},g=()=>async u=>{await(0,n.X1)(),u((0,s.U2)({richHistoryResults:{richHistory:[],total:0}})),u((0,s.U2)({richHistoryResults:{richHistory:[],total:0}}))},l=()=>async(u,D)=>{const P=D().explore.richHistorySearchFilters;if(P){const x=await(0,n.DI)(P);u((0,s.U2)({richHistoryResults:x}))}},p=()=>async(u,D)=>{const P=D().explore.richHistorySearchFilters,x=D().explore.richHistory;if(P&&x){const E={...P,page:(P?.page||1)+1},C=await(0,n.DI)(E),M=[...x,...C.richHistory];u((0,s.Ju)({filters:E})),u((0,s.U2)({richHistoryResults:{richHistory:M,total:C.total}}))}},m=()=>async u=>{u((0,s.Ju)({filters:void 0})),u((0,s.U2)({richHistoryResults:{richHistory:[],total:0}}))},y=()=>async(u,D)=>{let P=D().explore.richHistorySettings;P||(P=await(0,n.Gx)(),u((0,s.bZ)(P)))},d=u=>async D=>{D((0,s.bZ)(u)),await(0,n.rs)(u)},v=u=>async(D,P)=>{await D((0,s.Ju)({filters:{...u}}));const x=P().explore.richHistorySettings;(0,i.gQ)().lastUsedDataSourcesAvailable&&await D(d({...x,lastUsedDatasourceFilters:u.datasourceFilters}))}},29436:(G,O,e)=>{"use strict";e.d(O,{Ay:()=>L,D:()=>y,J8:()=>x,JA:()=>P,Ju:()=>v,U2:()=>p,Ve:()=>C,am:()=>I,bZ:()=>d,fj:()=>m,nD:()=>u,ow:()=>T,qz:()=>l,tP:()=>D,ve:()=>M});var t=e(65307),n=e(2543),i=e.n(n),s=e(18226),r=e(12131),f=e(87490),a=e(23989),c=e(31678),o=e(27649),h=e(62256),g=e(34028);const l=(0,t.VP)("explore/syncTimes"),p=(0,t.VP)("explore/richHistoryUpdated"),m=(0,t.VP)("explore/richHistoryStorageFullAction"),y=(0,t.VP)("explore/richHistoryLimitExceededAction"),d=(0,t.VP)("explore/richHistorySettingsUpdated"),v=(0,t.VP)("explore/richHistorySearchFiltersUpdatedAction"),u=(0,t.VP)("explore/splitSizeUpdateAction"),D=(0,t.VP)("explore/maximizePaneAction"),P=(0,t.VP)("explore/evenPaneResizeAction"),x=(0,t.VP)("explore/splitClose"),E=(0,t.VP)("explore/setPaneState"),C=(0,t.VP)("explore/clearPanes"),M=(0,c.createAsyncThunk)("explore/splitOpen",async(U,{getState:W,dispatch:w})=>{const N=Object.values(W().explore.panes)[0],B=U?.queries??N?.queries??[];Object.keys(W().explore.panes).forEach((H,X)=>{X>=1&&w(x(H))});const V=U?.range||N?.range.raw||g.kn;let K=(0,f.o$)();for(;W().explore.panes[K];)K=(0,f.o$)();await w(S({exploreId:K,datasource:U?.datasourceUid||N?.datasourceInstance?.getRef(),queries:(0,o.v)(B),range:V,panelsState:U?.panelsState||N?.panelsState,correlationHelperData:U?.correlationHelperData,eventBridge:new s.o})),N?.range&&await w(l({syncedTimes:(0,n.isEqual)(N.range.raw,V)}))}),S=(0,c.createAsyncThunk)("explore/createNewSplitOpen",async(U,{dispatch:W})=>{await W((0,h.Gd)(U))}),I=(0,t.VP)("explore/changeCorrelationEditorDetails"),T=(U,W)=>async w=>{const{timeRange:N,getExploreUrl:B,openInNewWindow:V}=W,K=await B({queries:U.targets,dsRef:U.datasource,scopedVars:U.scopedVars,timeRange:N,adhocFilters:(0,a.w)().getAdhocFilters(U.datasource?.uid??"",!0)});if(V&&K){V(K);return}r.Ny.push(K)},b=(0,g.HZ)(),R={syncedTimes:!1,panes:{},correlationEditorDetails:{editorMode:!1,correlationDirty:!1,queryEditorDirty:!1,isExiting:!1},richHistoryStorageFull:!1,richHistoryLimitExceededWarningShown:!1,largerExploreId:void 0,maxedExploreId:void 0,evenSplitPanes:!0,richHistory:[]},L={explore:(U=R,W)=>{if(x.match(W)){const{[W.payload]:N,...B}={...U.panes};return{...U,panes:B,largerExploreId:void 0,maxedExploreId:void 0,evenSplitPanes:!0,syncedTimes:!1}}if(u.match(W)){const{largerExploreId:N}=W.payload;return{...U,largerExploreId:N,maxedExploreId:void 0,evenSplitPanes:N===void 0}}if(D.match(W)){const{exploreId:N}=W.payload;return{...U,largerExploreId:N,maxedExploreId:N,evenSplitPanes:!1}}if(P.match(W))return{...U,largerExploreId:void 0,maxedExploreId:void 0,evenSplitPanes:!0};if(l.match(W))return{...U,syncedTimes:W.payload.syncedTimes};if(m.match(W))return{...U,richHistoryStorageFull:!0};if(y.match(W))return{...U,richHistoryLimitExceededWarningShown:!0};if(d.match(W)){const N=W.payload;return{...U,richHistorySettings:N}}if(p.match(W)){const{richHistory:N,total:B}=W.payload.richHistoryResults;return{...U,richHistory:N,richHistoryTotal:B}}if(v.match(W)){const N=W.payload.filters;return{...U,richHistorySearchFilters:N}}if(S.pending.match(W))return{...U,panes:{...U.panes,[W.meta.arg.exploreId]:b}};if(h.Gd?.pending.match(W)){const N=Object.entries(U.panes),B=N.slice(0,W.meta.arg.position),V=N.slice(B.length),K=[...B,[W.meta.arg.exploreId,b],...V].reduce((H,[X,k])=>({...H,[X]:k}),{});return{...U,panes:K}}if(C.match(W))return{...U,panes:{}};if(I.match(W)){const{editorMode:N,label:B,description:V,canSave:K,correlationDirty:H,queryEditorDirty:X,isExiting:k,postConfirmAction:Y,transformations:Z}=W.payload;return{...U,correlationEditorDetails:{editorMode:!!(N??U.correlationEditorDetails?.editorMode),canSave:!!(K??U.correlationEditorDetails?.canSave),label:B??U.correlationEditorDetails?.label,description:V??U.correlationEditorDetails?.description,transformations:Z??U.correlationEditorDetails?.transformations,correlationDirty:!!(H??U.correlationEditorDetails?.correlationDirty),queryEditorDirty:!!(X??U.correlationEditorDetails?.queryEditorDirty),isExiting:!!(k??U.correlationEditorDetails?.isExiting),postConfirmAction:Y}}}const w=W.payload?.exploreId;return typeof w=="string"?{...U,panes:Object.entries(U.panes).reduce((N,[B,V])=>({...N,[B]:B===w?(0,h.LJ)(V,W):V}),{})}:U}}},23994:(G,O,e)=>{"use strict";e.d(O,{_0:()=>he,He:()=>wt,hS:()=>ye,bO:()=>xe,IL:()=>zt,rR:()=>xt,y2:()=>Ae,Az:()=>on,PD:()=>Ee,JQ:()=>_n,S6:()=>ft,Od:()=>at,GI:()=>Jt,q9:()=>$e,h1:()=>de,qk:()=>pt,Rk:()=>Vt,h9:()=>Je,TO:()=>Pn});var t=e(65307),n=e(32017),i=e.n(n),s=e(2543),r=e(49510),f=e(62467),a=e(58307),c=e(69862),o=e(99165),h=e(39070),g=e(73372),l=e(47232),p=e(9557),m=e(40187),y=e(26272),d=e(14236),v=e(80822),u=e(19347),D=e(32264),P=e(14110),x=e(33390),E=e(87490),C=e(80582),M=e(18380),S=e(31193),I=e(32901),T=e(13137),b=e(14678),R=e(31678),A=e(82467),L=e(3169),U=e(39374),W=e(97186),w=e(81160),N=e(57875),B=e(91890),V=e(57934),K=e(11261),H=e(69147),X=e(91002),k=e(15162);const Y=Ye=>{const Dt=[],yt=[],Ft=[],an=[],un=[],hn=[],Un=[],Nn=[];for(const St of Ye.series){if(te(St)){Nn.push(St);continue}switch(St.meta?.preferredVisualisationType){case"logs":an.push(St);break;case"graph":Dt.push(St);break;case"trace":un.push(St);break;case"table":yt.push(St);break;case"rawPrometheus":Ft.push(St);break;case"nodeGraph":hn.push(St);break;case"flamegraph":Un.push(St);break;default:z(St)&&Dt.push(St),yt.push(St)}}return{...Ye,graphFrames:Dt,tableFrames:yt,logsFrames:an,traceFrames:un,nodeGraphFrames:hn,customFrames:Nn,flameGraphFrames:Un,rawPrometheusFrames:Ft,graphResult:null,tableResult:null,logsResult:null,rawPrometheusResult:null}},Z=({showCorrelationEditorLinks:Ye,queries:Dt,correlations:yt,defaultTargetDatasource:Ft})=>an=>{if(Ye&&Ft)for(const un of an.series)for(const hn of un.fields){hn.config.links=[],hn.display=hn.display||(0,N.H)();const Un={};un.fields.map(Nn=>{Un[`${Nn.name}`]=`\${__data.fields.['${Nn.name}']}`}),hn.config.links.push({url:"",origin:B.x0.ExploreCorrelationsEditor,title:`Correlate with ${hn.name}`,internal:{datasourceUid:Ft.uid,datasourceName:Ft.name,query:{datasource:{uid:Ft.uid}},meta:{correlationData:{resultField:hn.name,vars:Un,origVars:Un}}}})}else if(Dt?.length&&yt?.length){const un=(0,s.mapValues)((0,s.groupBy)(Dt,"refId"),"0.datasource.uid");(0,M.cA)(an.series,yt,un)}return an},se=Ye=>Ye.graphFrames.length?{...Ye,graphResult:Ye.graphFrames}:{...Ye,graphResult:null},j=Ye=>{if(Ye.tableFrames.length===0)return(0,f.of)({...Ye,tableResult:null});Ye.tableFrames.sort((an,un)=>{const hn=an.refId,Un=un.refId;return hn>Un?1:hn<Un?-1:0});const Dt=Ye.tableFrames.every(an=>z(an)),yt={interpolate:an=>an};return(Dt?(0,f.of)(Ye.tableFrames).pipe(V.c.joinByFieldTransformer.operator({},yt)):(0,f.of)(Ye.tableFrames).pipe(V.c.mergeTransformer.operator({},yt))).pipe((0,w.T)(an=>{for(const un of an)for(const hn of un.fields)hn.display=hn.display??(0,N.J)({field:hn,theme:D.$.theme2,timeZone:Ye.request?.timezone??"browser"});return{...Ye,tableResult:an}}))},q=Ye=>{const Dt=Ye.rawPrometheusFrames;if(!Dt||Dt.length===0)return(0,f.of)({...Ye,tableResult:null});Dt.sort((un,hn)=>{const Un=un.refId,Nn=hn.refId;return Un>Nn?1:Un<Nn?-1:0});const yt=Dt.every(un=>z(un)),Ft={interpolate:un=>un};return(yt?(0,f.of)(Dt).pipe(V.c.joinByFieldTransformer.operator({},Ft)):(0,f.of)(Dt).pipe(V.c.mergeTransformer.operator({},Ft))).pipe((0,w.T)(un=>{const hn=un[0];for(const Un of hn.fields)Un.display=Un.display??(0,N.J)({field:Un,theme:D.$.theme2,timeZone:Ye.request?.timezone??"browser"});return{...Ye,rawPrometheusResult:hn}}))},ne=(Ye={})=>Dt=>{if(Dt.logsFrames.length===0)return{...Dt,logsResult:null};const yt=Dt.request?.intervalMs,Ft=(0,H.HT)(Dt.logsFrames,yt,Ye.absoluteRange,Ye.queries,Ye.deduplicate),an=(0,E.uE)(Ye.refreshInterval),un=(0,X.zy)(Ft,an),hn=un.rows,Un=un.series,Nn={...un,rows:hn,series:Un};return{...Dt,logsResult:Nn}};function oe(Ye,Dt,yt,Ft,an,un,hn){return(0,f.of)(Ye).pipe((0,w.T)(Un=>(0,d.N$)(Un,Dt)),(0,w.T)(Z({defaultTargetDatasource:hn,showCorrelationEditorLinks:un,queries:Ft,correlations:an})),(0,w.T)(Y),(0,w.T)(se),(0,w.T)(yt),(0,c.Z)(q),(0,c.Z)(j))}function z(Ye){const Dt=(0,s.groupBy)(Ye.fields,yt=>yt.type);return!!(Object.keys(Dt).length===2&&Dt[K.PU.time]?.length===1&&Dt[K.PU.number])}function te(Ye){return Ye.meta?.preferredVisualisationPluginId?(0,k.oZ)(Ye.meta?.preferredVisualisationPluginId):!1}var le=e(57288),ie=e(324),ae=e(62256),re=e(72433),ce=e(29436),me=e(89224),ee=e(34028);const de=Ye=>Dt=>{const yt=Dt.explore.panes[Ye];return yt&&yt.queryResponse?yt.queryResponse.state===h.Gu.Loading||yt.queryResponse.state===h.Gu.Streaming:!1},De=(0,t.VP)("explore/addQueryRow"),fe=(0,t.VP)("explore/changeQueries"),Te=(0,t.VP)("explore/cancelQueries"),je=(0,t.VP)("explore/queriesImported"),He=(0,t.VP)("explore/queryStoreSubscription"),Be=(0,t.VP)("explore/setSupplementaryQueryEnabledAction"),Ne=(0,t.VP)("explore/storeSupplementaryQueryDataProviderAction"),Re=(0,t.VP)("explore/cleanSupplementaryQueryDataProviderAction"),Se=(0,t.VP)("explore/cleanSupplementaryQueryAction"),We=(0,t.VP)("explore/storeSupplementaryQueryDataSubscriptionAction"),Ke=(0,t.VP)("explore/updateSupplementaryQueryDataAction"),Xe=(0,t.VP)("explore/queryStreamUpdated"),Je=(0,t.VP)("explore/setQueries"),st=(0,t.VP)("changeLoadingState"),pt=(0,t.VP)("explore/setPausedState"),xt=(0,t.VP)("explore/clearLogs"),ot=(0,t.VP)("explore/scanStart"),$e=(0,t.VP)("explore/scanStop"),ve=(0,t.VP)("explore/addResultsToCache"),be=(0,t.VP)("explore/clearCache");function he(Ye,Dt){return async(yt,Ft)=>{const an=Ft().explore.panes[Ye];let un;an.datasourceInstance?.meta.mixed?un=(0,s.findLast)(an.queries,Un=>!!Un.datasource)?.datasource||void 0:un=an.datasourceInstance?.getRef();const hn=await(0,E.Ll)(an.queries,Dt,un);yt(De({exploreId:Ye,index:Dt,query:hn}))}}function ye(Ye){return(Dt,yt)=>{Dt($e({exploreId:Ye})),Dt(Te({exploreId:Ye}));const Ft=yt().explore.panes[Ye].supplementaryQueries;for(const an of le.VW)Dt(Re({exploreId:Ye,type:an})),Ft[an]?.data?.state!==h.Gu.Done&&Dt(Se({exploreId:Ye,type:an}))}}const Pe=(Ye,Dt)=>{const yt=Ye.getRef();return Dt.map(Ft=>({...Ft,datasource:yt}))},ge=async(Ye,Dt,yt)=>{let Ft=[];if(Dt.meta?.id===Ye.meta?.id)Ft=yt;else if((0,g.Ee)(Dt)&&(0,g.FL)(Ye)){const an=await Dt.exportToAbstractQueries(yt);Ft=await Ye.importFromAbstractQueries(an)}else Ye.importQueries&&(Ft=await Ye.importQueries(yt,Dt));return Pe(Ye,Ft)},xe=(0,R.createAsyncThunk)("explore/changeQueries",async({queries:Ye,exploreId:Dt},{getState:yt,dispatch:Ft})=>{let an=!1;const un=yt().explore.panes[Dt].queries,hn=yt().explore.panes[Dt].datasourceInstance?.uid,Un=yt().explore.correlationEditorDetails,Nn=Un?.editorMode||!1;!(Object.keys(yt().explore.panes)[0]===Dt)&&Nn&&!Un?.queryEditorDirty&&Ft((0,ce.am)({queryEditorDirty:!0}));for(const nn of Ye)for(const ht of un){if(nn.refId===ht.refId&&nn.datasource?.type!==ht.datasource?.type){const lt=await(0,u.l)().get(ht.datasource),gt=await(0,u.l)().get({uid:nn.datasource?.uid});await Ft(Ae(Dt,un,lt,gt,nn.refId)),an=!0}if(hn===b.uv&&nn.refId===ht.refId&&nn.datasource?.uid!==ht.datasource?.uid){const lt=(0,ee.dq)(b.uv,Ye),gt=await(0,M.J6)(lt);Ft((0,ae.Fb)({exploreId:Dt,correlations:gt.correlations||[]}))}}an||Ft(fe({queries:Ye,exploreId:Dt})),Ye.length<un.length&&Ft(at({exploreId:Dt}))}),Ae=(Ye,Dt,yt,Ft,an)=>async un=>{if(!yt){un(je({exploreId:Ye,queries:Dt}));return}let hn=Dt;if(Ft.uid===b.uv)hn=Dt.map(Nn=>({...Nn,datasource:yt.getRef()}));else if(yt.uid===b.uv){const Nn=(0,s.groupBy)(Dt,nn=>nn.datasource?.uid),St=await Promise.all(Object.keys(Nn).map(async nn=>{const ht=await(0,u.l)().get({uid:nn});return await ge(Ft,ht,Nn[nn])}));hn=(0,s.flatten)(St.filter(nn=>nn.length>0))}else{let Nn=Dt;if(an!==void 0){const St=Dt.find(nn=>nn.refId===an);St&&(Nn=[St])}hn=await ge(Ft,yt,Nn)}let Un=await(0,E.di)(hn,Ft.getRef());if(an!==void 0){hn.length===0&&(hn=[await(0,E.Ll)([],void 0,Ft.getRef())]);const Nn=Dt.findIndex(nn=>nn.refId===an),St={...Un[0],refId:Dt[Nn].refId};Un=[...Dt],Un[Nn]=St}return un(je({exploreId:Ye,queries:Un})),Un};function Ee(Ye,Dt,yt){return async(Ft,an)=>{const un=an().explore.panes[Ye],{queries:hn}=un,Nn=(await Promise.all(hn.map(St=>yt({...St},Dt)))).map((St,nn)=>(0,E.eF)(St,hn,nn));Ft(Je({exploreId:Ye,queries:Nn})),Dt.preventSubmit||Ft(at({exploreId:Ye}))}}function Ie(Ye,Dt){if(!(Ye.filterQuery&&!Ye.filterQuery(Dt)))return Dt}async function Qe(Ye,Dt,yt,Ft){const un=(await Promise.all(Ft.map(async hn=>{if(hn.datasource?.uid===yt.uid)return Ie(yt,hn);{const Un=await(0,S.tR)().get(hn.datasource);return Ie(Un,hn)}}))).filter(hn=>!!hn);un.length>0&&(Ye((0,re.ri)(!0,yt.uid,yt.name,un,D.$.queryHistoryEnabled)),D.$.queryHistoryEnabled&&Ye((0,re.ri)(!1,yt.uid,yt.name,un,!1)),await Ye((0,re.jX)()))}const at=(0,R.createAsyncThunk)("explore/runQueries",async({exploreId:Ye,preserveCache:Dt},{dispatch:yt,getState:Ft})=>{yt(ye(Ye));const{defaultCorrelationEditorDatasource:an,scopedVars:un,showCorrelationEditorLinks:hn}=await(0,ee.aj)(Ft(),Ye),Un=(0,ie.M)(Ye);yt((0,me.JA)({exploreId:Ye})),Dt!==!0&&yt(zt(Ye));const St=Ft().explore.panes[Ye],{datasourceInstance:nn,containerWidth:ht,isLive:lt,range:gt,scanning:$t,queryResponse:et,querySubscription:Et,refreshInterval:It,absoluteRange:Qt,cache:sn,supplementaryQueries:ln}=St;let yn,Sn;const En=St.queries.map(On=>({...On,datasource:On.datasource||nn?.getRef()}));nn!=null&&Qe(yt,Ft().explore,nn,En);const wn=(0,ee.rk)(sn,Qt);if(wn)yn=(0,r.z)([(0,f.of)(wn),Un]).pipe((0,c.Z)(([On,Rt])=>oe(On,et,ne({absoluteRange:Qt,refreshInterval:It,queries:En}),En,Rt,hn,an))),Sn=yn.subscribe(On=>{yt(Xe({exploreId:Ye,response:On}))});else{if(!(0,E.zT)(En)||!nn)return;const On=nn?.interval;(0,E._u)(Et);const Rt={minInterval:On,maxDataPoints:ht,liveStreaming:lt},Ot=(0,I.O)(Ft().user),jt=(0,E.bI)(Ye,En,Rt,gt,$t,Ot,un);if(yt(st({exploreId:Ye,loadingState:h.Gu.Loading})),yn=(0,r.z)([(0,U.BN)(nn,jt.request).pipe(lt?(0,o.c)(500):a.D),Un]).pipe((0,c.Z)(([rt,tn])=>oe(rt,et,ne({absoluteRange:Qt,refreshInterval:It,queries:En}),En,tn,hn,an))),Sn=yn.subscribe({next(rt){const tn=Ft().explore.panes[Ye];if(rt.logsResult!==null&&rt.state===h.Gu.Done&&(0,P.rR)("grafana_explore_logs_result_displayed",{datasourceType:nn.type,visualisationType:tn?.panelsState?.logs?.visualisationType??x.A.get(W.r)??"N/A",length:rt.logsResult.rows.length,defaultVisualisationType:D.$.featureToggles.logsExploreTableDefaultVisualization?"table":"logs"}),yt(Xe({exploreId:Ye,response:rt})),tn.scanning)if(rt.state===h.Gu.Done&&rt.series.length===0){const Mn=(0,C.Wb)(-1,tn.range);yt((0,me.JA)({exploreId:Ye,absoluteRange:Mn})),yt(at({exploreId:Ye}))}else yt($e({exploreId:Ye}))},error(rt){yt((0,A.dx)((0,L.gi)("Query processing error",rt))),yt(st({exploreId:Ye,loadingState:h.Gu.Error})),console.error(rt)},complete(){Ft().explore.panes[Ye].queryResponse.state===h.Gu.Loading&&yt(st({exploreId:Ye,loadingState:h.Gu.Done}))}}),lt)for(const rt of le.VW)yt(Re({exploreId:Ye,type:rt})),yt(Se({exploreId:Ye,type:rt}));else yt(vt({exploreId:Ye,datasourceInstance:nn,transaction:jt,newQuerySource:yn,supplementaryQueries:ln,queries:En,absoluteRange:Qt}))}yt(He({exploreId:Ye,querySubscription:Sn}))}),ft=(0,R.createAsyncThunk)("explore/runLoadMoreQueries",async({exploreId:Ye,absoluteRange:Dt},{dispatch:yt,getState:Ft})=>{yt(ye(Ye));const{datasourceInstance:an,containerWidth:un,queryResponse:hn}=Ft().explore.panes[Ye],{defaultCorrelationEditorDatasource:Un,scopedVars:Nn,showCorrelationEditorLinks:St}=await(0,ee.aj)(Ft(),Ye),nn=(0,ie.M)(Ye);let ht;const lt=hn.logsResult?.queries||[],gt=hn.logsFrames.map(sn=>sn.refId),$t=lt.filter(sn=>gt.includes(sn.refId)).map(sn=>({...sn,datasource:sn.datasource||an?.getRef(),refId:sn.refId,supportingQueryType:T.Q$.InfiniteScroll}));if(!(0,E.zT)($t)||!an)return;const et={minInterval:an?.interval,maxDataPoints:un},Et=(0,I.O)(Ft().user),It=(0,E.zq)(Et,{from:(0,l.oZ)(Et,Dt.from),to:(0,l.oZ)(Et,Dt.to)},(0,I.q)(Ft().user)),Qt=(0,E.bI)(Ye,$t,et,It,!1,Et,Nn);yt(st({exploreId:Ye,loadingState:h.Gu.Loading})),ht=(0,r.z)([(0,U.BN)(an,Qt.request),nn]).pipe((0,c.Z)(([sn,ln])=>sn.state!==h.Gu.Done?(0,f.of)({...hn,state:h.Gu.Loading}):oe((0,v._k)(hn,sn),hn,ne({absoluteRange:Dt,queries:lt,deduplicate:!0}),$t,ln,St,Un))),ht.subscribe({next(sn){yt(Xe({exploreId:Ye,response:sn}))},error(sn){yt((0,A.dx)((0,L.gi)("Query processing error",sn))),yt(st({exploreId:Ye,loadingState:h.Gu.Error})),console.error(sn)},complete(){yt(st({exploreId:Ye,loadingState:h.Gu.Done}))}})}),ct=async(Ye,Dt)=>{const yt=Ye.filter(an=>an.datasource?.uid!==b.uv),Ft=(0,s.groupBy)(yt,"datasource.uid");return await Promise.all(Object.values(Ft).map(async an=>({datasource:await(0,u.l)().get(an[0].datasource,Dt),targets:an})))},vt=(0,R.createAsyncThunk)("explore/handleSupplementaryQueries",async({datasourceInstance:Ye,exploreId:Dt,transaction:yt,newQuerySource:Ft,supplementaryQueries:an,queries:un,absoluteRange:hn},{dispatch:Un})=>{let Nn;Ye.meta.mixed?Nn=await ct(yt.request.targets,yt.request.scopedVars):Nn=[{datasource:Ye,targets:yt.request.targets}];for(const St of le.VW){const nn=(0,le.Pm)(Nn,St,{...yt.request,requestId:`${yt.request.requestId}_${(0,s.snakeCase)(St)}`},Ft);nn?(Un(Ne({exploreId:Dt,type:St,dataProvider:nn})),Pt(an[St].data,un,hn)||(Un(Se({exploreId:Dt,type:St})),an[St].enabled&&Un(on(Dt,St)))):Un(Re({exploreId:Dt,type:St}))}});function Pt(Ye,Dt,yt){if(!Ye)return!1;const Ft=(0,s.zipObject)((0,s.map)(Dt,"refId"),Dt),an=(0,s.mapValues)((0,s.groupBy)(Ye.data.map(Nn=>Nn.meta?.custom?.sourceQuery),"refId"),s.head),un=Ye.data.every(Nn=>Nn.meta?.custom?.logsVolumeType===p.Aj.FullRange),hn=i()(Ft,an),Un=Ye.data.every(Nn=>{const St=Nn.meta?.custom?.absoluteRange;return St?St&&St.from<=yt.from&&yt.to<=St.to:!0});return un&&hn&&Un}function Vt(Ye,Dt){return(yt,Ft)=>{const an=Ft().explore.panes[Ye].queries,un=Dt.map((hn,Un)=>(0,E.eF)(hn,an,Un));yt(Je({exploreId:Ye,queries:un})),yt(at({exploreId:Ye}))}}function Jt(Ye){return(Dt,yt)=>{Dt(ot({exploreId:Ye}));const Ft=(0,C.Wb)(-1,yt().explore.panes[Ye].range);Dt((0,me.JA)({exploreId:Ye,absoluteRange:Ft})),Dt(at({exploreId:Ye}))}}function wt(Ye){return(Dt,yt)=>{const Ft=yt().explore.panes[Ye].queryResponse,an=yt().explore.panes[Ye].absoluteRange,un=(0,ee.O2)(an);Ft.state===h.Gu.Done&&Dt(ve({exploreId:Ye,cacheKey:un,queryResponse:Ft}))}}function zt(Ye){return(Dt,yt)=>{Dt(be({exploreId:Ye}))}}function on(Ye,Dt){return(yt,Ft)=>{const{supplementaryQueries:an}=Ft().explore.panes[Ye],un=an[Dt].dataProvider;if(un){const hn=un.subscribe({next:Un=>{yt(Ke({exploreId:Ye,type:Dt,data:Un}))}});yt(We({exploreId:Ye,type:Dt,dataSubscription:hn}))}}}function Pn(Ye,Dt,yt){return(Ft,an)=>{Ft(Be({exploreId:Ye,enabled:Dt,type:yt})),(0,le.Oi)(Dt,yt),Dt&&Ft(on(Ye,yt))}}const _n=(Ye,Dt)=>{if(De.match(Dt)){const{queries:yt}=Ye,{index:Ft,query:an}=Dt.payload,un=[...yt.slice(0,Ft+1),{...an},...yt.slice(Ft+1)];return{...Ye,queries:un,queryKeys:(0,E.dY)(un)}}if(fe.match(Dt)){const{queries:yt}=Dt.payload;return{...Ye,queries:yt}}if(Te.match(Dt))return(0,E._u)(Ye.querySubscription),{...Ye,...Ye.queryResponse?{queryResponse:{...Ye.queryResponse,state:h.Gu.Done}}:{}};if(Je.match(Dt)){const{queries:yt}=Dt.payload;return{...Ye,queries:yt.slice(),queryKeys:(0,E.dY)(yt)}}if(He.match(Dt)){const{querySubscription:yt}=Dt.payload;return{...Ye,querySubscription:yt}}if(Be.match(Dt)){const{enabled:yt,type:Ft}=Dt.payload,{supplementaryQueries:an}=Ye,un=an[Ft].dataSubscription;!yt&&un&&un.unsubscribe();const hn={...an,[Ft]:{...an[Ft],enabled:yt,data:void 0}};return{...Ye,supplementaryQueries:hn}}if(Ne.match(Dt)){const{dataProvider:yt,type:Ft}=Dt.payload,{supplementaryQueries:an}=Ye,un=an[Ft];un?.dataSubscription&&un.dataSubscription.unsubscribe();const hn={...an,[Ft]:{...un,dataProvider:yt,dataSubscription:void 0}};return{...Ye,supplementaryQueries:hn}}if(Re.match(Dt)){const{type:yt}=Dt.payload,{supplementaryQueries:Ft}=Ye,an=Ft[yt];an?.dataSubscription&&an.dataSubscription.unsubscribe();const un={...Ft,[yt]:{...an,dataProvider:void 0,dataSubscription:void 0}};return{...Ye,supplementaryQueries:un}}if(Se.match(Dt)){const{type:yt}=Dt.payload,{supplementaryQueries:Ft}=Ye,an={...Ft,[yt]:{...Ft[yt],data:void 0}};return{...Ye,supplementaryQueries:an}}if(We.match(Dt)){const{dataSubscription:yt,type:Ft}=Dt.payload,{supplementaryQueries:an}=Ye,un={...an,[Ft]:{...an[Ft],dataSubscription:yt}};return{...Ye,supplementaryQueries:un}}if(Ke.match(Dt)){let{data:yt,type:Ft}=Dt.payload;const{supplementaryQueries:an}=Ye,un={...an,[Ft]:{...an[Ft],data:yt}};return{...Ye,supplementaryQueries:un}}if(Xe.match(Dt))return Cn(Ye,Dt);if(je.match(Dt)){const{queries:yt}=Dt.payload;return{...Ye,queries:yt,queryKeys:(0,E.dY)(yt)}}if(st.match(Dt)){const{loadingState:yt}=Dt.payload;return{...Ye,queryResponse:{...Ye.queryResponse,state:yt}}}if(pt.match(Dt)){const{isPaused:yt}=Dt.payload;return{...Ye,isPaused:yt}}if(ot.match(Dt))return{...Ye,scanning:!0};if($e.match(Dt))return{...Ye,scanning:!1,scanRange:void 0};if(ve.match(Dt)){const{cache:Ft}=Ye,{queryResponse:an,cacheKey:un}=Dt.payload;let hn=[...Ft];return hn.some(Nn=>Nn.key===un)||(hn=[{key:un,value:an},...hn].slice(0,5)),{...Ye,cache:hn}}if(be.match(Dt))return{...Ye,cache:[]};if(xt.match(Dt)){if(!Ye.logsResult)return{...Ye,clearedAtIndex:null};if(Ye.queryResponse.state===h.Gu.Loading)return{...Ye,clearedAtIndex:null,logsResult:{...Ye.logsResult,rows:[]}};const yt=Ye.clearedAtIndex?Ye.clearedAtIndex+Ye.logsResult.rows.length:Ye.logsResult.rows.length-1;return{...Ye,clearedAtIndex:yt,logsResult:{...Ye.logsResult,rows:[]}}}return Ye},Cn=(Ye,Dt)=>{const{response:yt}=Dt.payload,{request:Ft,series:an,error:un,graphResult:hn,logsResult:Un,tableResult:Nn,rawPrometheusResult:St,traceFrames:nn,nodeGraphFrames:ht,flameGraphFrames:lt,rawPrometheusFrames:gt,customFrames:$t}=yt;if(un){if(un.type===m.v2.Timeout||un.type===m.v2.Cancelled)return{...Ye};D.$.angularSupportEnabled&&Ye.datasourceInstance?.components?.QueryCtrl&&Ye.eventBridge.emit(y.ee.dataError,un)}if(!Ft)return{...Ye};if(D.$.angularSupportEnabled&&Ye.datasourceInstance?.components?.QueryCtrl){const et=an.map(Et=>(0,d.w3)(Et));Ye.eventBridge.emit(y.ee.dataReceived,et)}return{...Ye,queryResponse:yt,graphResult:hn,tableResult:Nn,rawPrometheusResult:St,logsResult:Ye.isLive&&Un?{...Un,rows:(0,ee.pg)(Ye.clearedAtIndex,Un.rows)}:Un,showLogs:!!Un,showMetrics:!!hn,showTable:!!Nn?.length,showTrace:!!nn.length,showNodeGraph:!!ht.length,showRawPrometheus:!!gt.length,showFlameGraph:!!lt.length,showCustom:!!$t?.length,clearedAtIndex:Ye.isLive?Ye.clearedAtIndex:null}}},9955:(G,O,e)=>{"use strict";e.d(O,{Jr:()=>h,K6:()=>a,Kl:()=>p,Qb:()=>s,i6:()=>f,pF:()=>c,qq:()=>g,st:()=>o,vC:()=>l});var t=e(25508),n=e(2543),i=e.n(n);const s=m=>m.explore.panes,r=m=>m.explore,f=m=>m.explore.richHistorySettings,a=(0,t.Mz)(s,Object.entries),c=(0,t.Mz)(a,m=>m.length>1),o=(0,t.Mz)(a,m=>m.some(y=>y[1].correlationEditorHelperData!==void 0)),h=m=>(0,t.Mz)(s,y=>Object.keys(y)[0]===m),g=m=>(0,t.Mz)(s,y=>y[m]),l=(0,t.Mz)(r,m=>m.correlationEditorDetails),p=(0,t.Mz)(a,m=>{const y=m.map(([u,D])=>{const P=[D?.datasourceInstance?.getRef()],x=D?.queries.map(C=>C.datasource)||[],E=[...P,...x].filter(C=>!!C);if(!(E===void 0||E.length===0))return{exploreId:u,datasources:(0,n.uniqBy)(E,C=>C.uid)}}).filter(u=>!!u),v=(0,n.uniqBy)((0,n.flatten)(y.map(u=>u.datasources)),u=>u.uid).map(u=>{let D=[];return y.forEach(P=>{P.datasources.some(x=>x.uid===u.uid)&&D.push(P.exploreId)}),{datasource:u,exploreIds:D}});return{exploreToDS:y,dsToExplore:v}})},89224:(G,O,e)=>{"use strict";e.d(O,{$_:()=>C,GA:()=>T,GH:()=>u,Iy:()=>M,JA:()=>P,QP:()=>b,Xk:()=>I,eM:()=>d,hO:()=>v,iO:()=>x,ke:()=>S,zY:()=>D});var t=e(65307),n=e(47232),i=e(26272),s=e(39070),r=e(72574),f=e(11134),a=e(76412),c=e(28138),o=e(87490),h=e(80582),g=e(74856),l=e(91002),p=e(32901),m=e(29436),y=e(23994);const d=(0,t.VP)("explore/changeRange"),v=(0,t.VP)("explore/changeRefreshInterval"),u=R=>(A,L)=>{const{syncedTimes:U}=L().explore;U?Object.keys(L().explore.panes).forEach(W=>{A(P({...R,exploreId:W})),A((0,y.Od)({exploreId:W,preserveCache:!0}))}):(A(P({...R})),A((0,y.Od)({exploreId:R.exploreId,preserveCache:!0})))},D=R=>A=>{A((0,y.S6)({...R}))},P=R=>(A,L)=>{const{exploreId:U,absoluteRange:W,rawRange:w}=R,N=L().explore.panes[U],B=(0,p.O)(L().user),V=(0,p.q)(L().user),{range:K}=N;let H=K.raw;W&&(H={from:(0,n.oZ)(B,W.from),to:(0,n.oZ)(B,W.to)}),w&&(H=w);const X=(0,o.zq)(B,H,V),k={from:X.from.valueOf(),to:X.to.valueOf()};(0,g.jG)().init({timepicker:{},getTimezone:()=>B,timeRangeUpdated(Y){},time:X.raw}),(0,r.w)().updateTimeRange(X),A(d({exploreId:U,range:X,absoluteRange:k}))};function x(R){return(A,L)=>{const U=L().explore.panes[R].range.raw;Object.keys(L().explore.panes).filter(w=>w!==R).forEach(w=>{A(u({exploreId:w,rawRange:U}))});const W=L().explore.syncedTimes;A((0,m.qz)({syncedTimes:!W}))}}function E(R){return(A,L)=>{const U=(0,p.O)(L().user),W=(0,p.q)(L().user);Object.entries(L().explore.panes).forEach(([w,N])=>{const B=(0,o.zq)(U,N.range.raw,W);R(w,N,B,A)})}}function C(){return E((R,A,L,U)=>{const W={from:L.from.valueOf(),to:L.to.valueOf()};U(u({exploreId:R,absoluteRange:W}))})}function M(R){return E((A,L,U,W)=>{const w=(0,h.Wb)(R,U);W(u({exploreId:A,absoluteRange:w}))})}function S(R){return E((A,L,U,W)=>{const w=(0,h.Zk)(U,R);W(u({exploreId:A,absoluteRange:w}))})}function I(){return(R,A)=>{const L=A().explore.panes[Object.keys(A().explore.panes)[0]].range.raw;navigator.clipboard.writeText(JSON.stringify(L)),c.A.emit(i.r1.alertSuccess,[(0,a.t)("time-picker.copy-paste.copy-success-message","Time range copied to clipboard")])}}function T(){return async(R,A)=>{const{range:L,isError:U}=await(0,h.zG)();if(U===!0){c.A.emit(i.r1.alertError,[(0,a.t)("time-picker.copy-paste.default-error-title","Invalid time range"),(0,a.t)("time-picker.copy-paste.default-error-message","{{error}} is not a valid time range",{error:L})]);return}if(A().explore.syncedTimes){R(u({exploreId:Object.keys(A().explore.panes)[0],rawRange:L})),R(u({exploreId:Object.keys(A().explore.panes)[1],rawRange:L}));return}R(u({exploreId:Object.keys(A().explore.panes)[0],rawRange:L}))}}const b=(R,A)=>{if(v.match(A)){const{refreshInterval:L}=A.payload,U=f.cC.isLive(L),W=(0,o.uE)(L),w=(0,l.zy)(R.logsResult,W);return f.cC.isLive(R.refreshInterval)&&!U&&(0,o._u)(R.querySubscription),{...R,refreshInterval:L,queryResponse:{...R.queryResponse,state:U?s.Gu.Streaming:s.Gu.Done},isLive:U,isPaused:U?!1:R.isPaused,logsResult:w}}if(d.match(A)){const{range:L,absoluteRange:U}=A.payload;return{...R,range:L,absoluteRange:U}}return R}},34028:(G,O,e)=>{"use strict";e.d(O,{BE:()=>E,HZ:()=>P,O2:()=>C,RA:()=>x,Z9:()=>I,aj:()=>A,dq:()=>R,eO:()=>S,kn:()=>v,ng:()=>D,pg:()=>b,rk:()=>M});var t=e(2543),n=e.n(t),i=e(39070),s=e(43127),r=e(85858),f=e(47232),a=e(32264),c=e(19347),o=e(11401),h=e(81523),g=e(14678),l=e(33390),p=e(87490),m=e(31193),y=e(57288);const d=100,v={from:`now-${a.$.exploreDefaultTimeOffset}`,to:"now"},u="grafana.explore.style.graph",D=L=>{l.A.set(u,L)},P=L=>({containerWidth:0,datasourceInstance:null,history:[],queries:[],initialized:!1,range:{from:null,to:null,raw:v},absoluteRange:{from:null,to:null},scanning:!1,queryKeys:[],isLive:!1,isPaused:!1,queryResponse:x(),tableResult:null,graphResult:null,logsResult:null,clearedAtIndex:null,rawPrometheusResult:null,eventBridge:null,cache:[],supplementaryQueries:(0,y.Ez)(),panelsState:{},correlations:void 0,...L}),x=()=>({state:i.Gu.NotStarted,series:[],timeRange:(0,s.E2)(),graphFrames:[],logsFrames:[],traceFrames:[],nodeGraphFrames:[],flameGraphFrames:[],customFrames:[],tableFrames:[],rawPrometheusFrames:[],rawPrometheusResult:null,graphResult:null,logsResult:null,tableResult:null});async function E(L,U){let W;try{W=await(0,m.tR)().get(U)}catch{W=await(0,m.tR)().get()}if(W.init)try{W.init()}catch(V){console.error(V)}let w=[];const N=(0,o.tU)(),B=await N.getRichHistory({search:"",sortOrder:h.xB.Ascending,datasourceFilters:[W.name],starred:!1});if((B.total||0)>0&&B.richHistory.forEach(V=>{V.queries.forEach(K=>{w.push({ts:parseInt(V.id,10),query:K})})}),w.length<d){const V=await N.getRichHistory({search:"",sortOrder:h.xB.Ascending,datasourceFilters:[g.uv],starred:!1});(V.total||0)>0&&V.richHistory.forEach(K=>{K.queries.forEach(H=>{H?.datasource?.uid===W.uid&&w.push({ts:parseInt(K.id,10),query:H})})})}if(w.length<d){const V=`grafana.explore.history.${W.meta?.id}`;w=[...w,...l.A.getObject(V,[])]}return w.length>d&&(w.length=d),(0,p.dr)(L,W.uid),{history:w,instance:W}}function C(L){const U={from:L.from,to:L.to};return Object.entries(U).map(([w,N])=>`${encodeURIComponent(w)}=${encodeURIComponent(N.toString())}`).join("&")}function M(L,U){const W=C(U),w=L.findIndex(B=>B.key===W);return w>=0?L[w].value:void 0}function S(L,U){return{from:r.parse(L.from,!1,U),to:r.parse(L.to,!0,U),raw:L}}function I(L){let U=v,W={from:T(L.from),to:T(L.to)};return W.from!==null&&W.to!==null&&(U={from:W.from,to:W.to}),U}function T(L){if(L===null)return null;if((0,f.Ar)(L))return L;if(typeof L!="string")return null;const U=L;if(U.indexOf("now")!==-1)return U;if(U.length===8)return(0,f.yT)(U,"YYYYMMDD");if(U.length===15)return(0,f.yT)(U,"YYYYMMDDTHHmmss");if(U.length===19)return(0,f.yT)(U,"YYYY-MM-DD HH:mm:ss");if(U.match(/^\d+$/)){const w=parseInt(U,10);return(0,f.yT)(w)}const W=(0,f.yT)(U);return W.isValid()?W:null}const b=(L,U)=>U?L?U.slice(L+1):U:[],R=(L,U)=>L===g.uv?(0,t.uniq)(U.map(W=>W.datasource?.uid).filter(W=>!!W)):[L];async function A(L,U){const W=L.explore.panes[U].correlationEditorHelperData,w=L.explore.correlationEditorDetails?.editorMode||!1,N=Object.keys(L.explore.panes)[0]===U,B=w&&N,V=B?await(0,c.l)().get():void 0,K=w&&!N&&W!==void 0;let H={};return K&&W!==void 0&&Object.entries(W?.vars).forEach(X=>{H[X[0]]={value:X[1]}}),{defaultCorrelationEditorDatasource:V,scopedVars:H,showCorrelationEditorLinks:B}}},96192:(G,O,e)=>{"use strict";e.d(O,{JQ:()=>x,O1:()=>C,QL:()=>D,YV:()=>u,_O:()=>I});var t=e(2543),n=e.n(t),i=e(96540),s=e(92461),r=e(91890),f=e(41987),a=e(6709),c=e(76885),o=e(72574),h=e(14110),g=e(16233),l=e(67023),p=e(6923),m=e(39590);const d=[T=>!T.internal||g.TP.hasAccessToExplore()],v="grafana_data_link_clicked",u=(T,b)=>A=>{const{field:L,dataLinkScopedVars:U,frame:W,link:w,linkModel:N}=A,{valueRowIndex:B}=A.config;if(!w.internal||B===void 0)return N;const V=D({field:L,rowIndex:B,splitOpenFn:T,range:b,vars:U,dataFrame:W,linksToProcess:[w]});return V.length?(0,t.first)(V):void 0},D=T=>{const{field:b,vars:R,splitOpenFn:A,range:L,rowIndex:U,dataFrame:W}=T,w={...R||{}};w.__value={value:{raw:b.values[U]},text:"Raw value"};let N;W&&(N=(0,s.F)({frame:W,rowIndex:U}),w.__data={value:{name:W.name,refId:W.refId,fields:N},text:"Data"},W.fields.forEach(V=>{N&&N[V.name]&&(w[V.name]={value:N[V.name]})}),w.__targetField={value:N[b.name]});const B=T.linksToProcess||b.config.links;return B?B.filter(H=>d.every(X=>X(H,w))).map(H=>{if(H.internal){let X={};H.internal?.transformations&&H.internal?.transformations.forEach(j=>{let q;j.field?q=W?.fields.find(oe=>oe.name===j.field)?.values[U]:q=b.values[U],X={...X,...(0,l.k)(j,q,b.name)}});const k={...w,...X},Y=C(H,k);let Z=[];if(Y.variables.length===0){const j=b.name.toString();Z.push({variableName:j,value:"",match:""})}else Z=Y.variables;const se=j=>{(0,h.rR)(v,{origin:H.origin||r.x0.Datasource,app:f.Jk.Explore,internal:!0}),A?.(j)};return Y.allVariablesDefined?{...(0,a.u)({link:H,internalLink:H.internal,scopedVars:k,range:L,field:b,onClickFn:T.splitOpenFn?q=>se(q):void 0,replaceVariables:(0,o.w)().replace.bind((0,o.w)())}),variables:Z}:void 0}else{const X=(Y,Z)=>(0,o.w)().replace(Y,{...Z,...w}),k=(0,p.mQ)().getDataLinkUIModel(H,X,b);return k.title||(k.title=P(k.href)),k}}).filter(H=>!!H):[]};function P(T){T.indexOf("://")<0&&(T=`http://${T}`);let b;try{b=new URL(T).hostname}catch{b=T}return b}function x(T,b){return(0,i.useCallback)((R,A)=>R.fields.flatMap(L=>L.config?.links&&L.config?.links.length?D({field:L,rowIndex:A,range:T,dataFrame:R,splitOpenFn:b}):[]),[T,b])}const E=["__from","__to","__interval","__interval_ms","__org","__user","__range","__rate_interval","__timeFilter","timeFilter"];function C(T,b){let R=[];return(0,o.w)().replace.bind((0,o.w)())(M(T),b,void 0,R),R=(0,t.uniqBy)(R,"variableName"),{variables:R,allVariablesDefined:R.filter(L=>!E.includes(L.variableName)).every(L=>L.found)}}function M(T){let b="",R;for(R in T)typeof T[R]=="string"?b+=" "+T[R]:typeof T[R]=="object"&&(b+=" "+M(T[R]));return b}const S=T=>T[1]!==void 0,I=T=>{const b=Object.entries(T).filter(S).map(([R,A])=>{const L=(0,m.m)(A);return L.range={to:A.range.to.valueOf().toString(),from:A.range.from.valueOf().toString()},[R,L]}).reduce((R,[A,L])=>({...R,[A]:L}),{});return c.kM.renderUrl("/explore",{schemaVersion:1,panes:JSON.stringify(b)})}},27649:(G,O,e)=>{"use strict";e.d(O,{v:()=>n});var t=e(77789);function n(i){const s=new Set(i.map(r=>r.refId).filter(Boolean));return s.size===i.length?i:(s.clear(),i.map(r=>{if(r.refId&&!s.has(r.refId))return s.add(r.refId),r;const f=(0,t.M)(i);return s.add(f),{...r,refId:f}}))}},57288:(G,O,e)=>{"use strict";e.d(O,{Ez:()=>m,Oi:()=>p,Pm:()=>v,VW:()=>g});var t=e(2543),n=e.n(t),i=e(88483),s=e(44240),r=e(6276),f=e(29405),a=e(9557),c=e(39070),o=e(33390),h=e(69147);const g=[a.cF.LogsVolume,a.cF.LogsSample],l=u=>`grafana.explore.logs.enable${u}`,p=(u,D)=>{o.A.set(l(D),u?"true":"false")},m=()=>{let u={[a.cF.LogsVolume]:{enabled:!0},[a.cF.LogsSample]:{enabled:!1}};for(const D of g){if(D===a.cF.LogsSample)continue;o.A.get(l(D))==="false"&&(u[D]={enabled:!1})}return u},y=(u,D,P)=>new i.c(x=>u.subscribe(E=>{if(E.logsResult&&E.logsResult.rows&&E.logsResult.visibleRange&&E.logsResult.bucketSize!==void 0&&E.state===c.Gu.Done){const C=E.logsResult.bucketSize,M=D.map(T=>T.refId),S=(0,t.groupBy)(E.logsResult.rows,"dataFrame.refId");let I=[];M.forEach(T=>{if(S[T]?.length){const b=(0,h.J9)(S[T],C);I=[...I,...b];const R={logsVolumeType:a.Aj.Limited,absoluteRange:E.logsResult?.visibleRange,datasourceName:P,sourceQuery:D.find(A=>A.refId===T)};x.next({data:I.map(A=>{const L=A.meta?.custom||{};return{...A,meta:{custom:{...L,...R}}}}),state:E.state})}}),x.complete()}})),d=(u,D,P,x)=>{if(u===a.cF.LogsVolume)return y(D,P,x)},v=(u,D,P,x)=>{const C=u.map(({datasource:M,targets:S},I)=>{const T=(0,t.cloneDeep)(P);if(T.requestId=`${T.requestId||""}_${I}`,T.targets=S,(0,a.Nc)(M,D)){if(M.getDataProvider)return M.getDataProvider(D,T);if(M.getSupplementaryRequest){const b=M.getSupplementaryRequest(D,T);return b?D===a.cF.LogsVolume?(0,h.sg)(M,b,{targets:T.targets}):(0,h.Wr)(M,b):void 0}else return}else return d(D,x,S,M.name)}).filter(c.zz);if(C.length!==0)return C.length===1?C[0]:(0,s.h)(...C).pipe((0,f.S)((M,S)=>M.errors&&M.errors.length||S.state===c.Gu.NotStarted?M:S.state===c.Gu.Loading&&M.state===c.Gu.NotStarted?{...M,state:c.Gu.Loading}:S.state&&S.state!==c.Gu.Done?M:{...M,data:[...M.data,...S.data],state:c.Gu.Done},{data:[],state:c.Gu.NotStarted}),(0,r.d)())}},53478:(G,O,e)=>{"use strict";e.d(O,{Ex:()=>M,$i:()=>C});var t=e(65474),n=e(69862),i=e(43429),s=e(26657),r=e(72574),f=e(19347),a=e(74848),c=e(96540),o=e(14186),h=e(90182),g=e(98808),l=e(71680),p=e(1712),m=e(34263),y=e(18225),d=e(76658),v=e(66718),u=e(76942);const D=15;function P(){const S=(0,c.useRef)({}),I=(0,c.useCallback)(b=>{switch(b){case v.Tz.math:case v.Tz.reduce:case v.Tz.resample:case v.Tz.threshold:case v.Tz.sql:return S.current[b];case v.Tz.classic:return}},[]),T=(0,c.useCallback)((b,R)=>{switch(b){case v.Tz.math:S.current.math=R;break;case v.Tz.reduce:case v.Tz.resample:case v.Tz.resample:S.current.reduce=R,S.current.resample=R,S.current.threshold=R;break;case v.Tz.sql:S.current.sql=R}},[]);return{getCachedExpression:I,setCachedExpression:T}}function x(S){const{query:I,queries:T,onRunQuery:b,onChange:R}=S,{getCachedExpression:A,setCachedExpression:L}=P();(0,c.useEffect)(()=>{L(I.type,I.expression)},[I.expression,I.type,L]);const U=(0,c.useCallback)(N=>{const B=A(N.value),V=(0,u.r)({...I,type:N.value});R({...V,expression:B??V.expression})},[I,R,A]),W=()=>{const N=T.filter(B=>I.refId!==B.refId).map(B=>({value:B.refId,label:B.refId}));switch(I.type){case v.Tz.math:return(0,a.jsx)(l.z,{onChange:R,query:I,labelWidth:D,onRunQuery:b});case v.Tz.reduce:return(0,a.jsx)(p.Z,{refIds:N,onChange:R,labelWidth:D,query:I});case v.Tz.resample:return(0,a.jsx)(m.C,{query:I,labelWidth:D,onChange:R,refIds:N});case v.Tz.classic:return(0,a.jsx)(g.z,{onChange:R,query:I,refIds:N});case v.Tz.threshold:return(0,a.jsx)(d.O,{onChange:R,query:I,labelWidth:D,refIds:N});case v.Tz.sql:return(0,a.jsx)(y.k,{onChange:R,query:I,refIds:N})}},w=v.uQ.find(N=>N.value===I.type);return(0,a.jsxs)("div",{children:[(0,a.jsx)(o.I,{label:"Operation",labelWidth:D,children:(0,a.jsx)(h.l6,{options:v.uQ,value:w,onChange:U,width:25})}),W()]})}class E extends s.iy{constructor(I){super(I),this.instanceSettings=I}applyTemplateVariables(I,T){const b=(0,r.w)();return{...I,expression:b.replace(I.expression,T),window:b.replace(I.window,T)}}getCollapsedText(I){return`Expression: ${I.type}`}query(I){let T=I.targets.map(async R=>{const A=await(0,f.l)().get(R.datasource);return A.interpolateVariablesInQueries?A?.interpolateVariablesInQueries([R],I.scopedVars,I.filters)[0]:R});return(0,t.H)(Promise.all(T)).pipe((0,n.Z)(R=>super.query({...I,targets:R})))}newQuery(I){return{refId:"--",datasource:s.dR,type:I?.type??v.Tz.math,...I}}}const C={id:-100,uid:v.Uj,name:s.dR.name,type:s.dR.type,access:"proxy",meta:{baseUrl:"",module:"",type:i.QE.datasource,name:s.dR.type,id:s.dR.type,info:{author:{name:"Grafana Labs"},logos:{small:"public/img/icn-datasource.svg",large:"public/img/icn-datasource.svg"},description:"Adds expression support to Grafana",screenshots:[],links:[],updated:"",version:""}},jsonData:{},readOnly:!0},M=new E(C);M.meta={id:s.dR.type,info:{logos:{small:"public/img/icn-datasource.svg",large:"public/img/icn-datasource.svg"}}},M.components={QueryEditor:x}},98808:(G,O,e)=>{"use strict";e.d(O,{z:()=>D});var t=e(74848),n=e(39268),i=e(14186),s=e(55852),r=e(14578),f=e(76942),a=e(32196),c=e(40845),o=e(67061),h=e(9261),g=e(90182),l=e(10354),p=e(55907);const m=p.A.reducerTypes.map(P=>({label:P.text,value:P.value})),y=p.A.evalOperators.map(P=>({label:P.text,value:P.value})),d=p.A.evalFunctions.map(P=>({label:P.text,value:P.value})),v=({condition:P,index:x,onChange:E,onRemoveCondition:C,refIds:M})=>{const S=(0,c.of)(u),I=W=>{E({...P,operator:{type:W.value}})},T=W=>{E({...P,reducer:{type:W.value,params:[]}})},b=W=>{E({...P,query:{params:[W.value]}})},R=W=>{E({...P,evaluator:{params:P.evaluator.params,type:W.value}})},A=(W,w)=>{const N=parseFloat(W.currentTarget.value),B=[...P.evaluator.params];B[w]=N,E({...P,evaluator:{...P.evaluator,params:B}})},L=(0,a.css)`
    width: 60px;
  `,U=P.evaluator.type===p.p.IsWithinRange||P.evaluator.type===p.p.IsOutsideRange;return(0,t.jsxs)(o.B,{children:[(0,t.jsxs)("div",{style:{flex:1},children:[(0,t.jsxs)(n.C,{children:[x===0?(0,t.jsx)("div",{className:(0,a.cx)(S.button,L),children:"WHEN"}):(0,t.jsx)(h.f,{className:(0,a.cx)(S.buttonSelectText,L),options:y,onChange:I,value:y.find(W=>W.value===P.operator.type)}),(0,t.jsx)(g.l6,{options:m,onChange:T,width:20,value:m.find(W=>W.value===P.reducer.type)}),(0,t.jsx)("div",{className:S.button,children:"OF"}),(0,t.jsx)(g.l6,{onChange:b,options:M,width:"auto",value:M.find(W=>W.value===P.query.params[0])})]}),(0,t.jsxs)(n.C,{children:[(0,t.jsx)(h.f,{className:S.buttonSelectText,options:d,onChange:R,value:d.find(W=>W.value===P.evaluator.type)}),U?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.p,{type:"number",width:10,onChange:W=>A(W,0),value:P.evaluator.params[0]}),(0,t.jsx)("div",{className:S.button,children:"TO"}),(0,t.jsx)(l.p,{type:"number",width:10,onChange:W=>A(W,1),value:P.evaluator.params[1]})]}):P.evaluator.type!==p.p.HasNoValue?(0,t.jsx)(l.p,{type:"number",width:10,onChange:W=>A(W,0),value:P.evaluator.params[0]}):null]})]}),(0,t.jsx)(s.$n,{variant:"secondary",type:"button",onClick:()=>C(x),children:(0,t.jsx)(r.I,{name:"trash-alt"})})]})},u=P=>{const x=(0,a.css)`
    color: ${P.colors.primary.text};
    font-size: ${P.typography.bodySmall.fontSize};
  `;return{buttonSelectText:x,button:(0,a.cx)((0,a.css)`
        display: flex;
        align-items: center;
        border-radius: ${P.shape.radius.default};
        font-weight: ${P.typography.fontWeightMedium};
        border: 1px solid ${P.colors.border.weak};
        white-space: nowrap;
        padding: 0 ${P.spacing(1)};
        background-color: ${P.colors.background.canvas};
      `,x)}},D=({onChange:P,query:x,refIds:E})=>{const C=(I,T)=>{x.conditions&&P({...x,conditions:[...x.conditions.slice(0,T),I,...x.conditions.slice(T+1)]})},M=()=>{if(x.conditions){const I=x.conditions.at(-1)?.query?.params??[],T={...f.P,query:{params:I}};P({...x,conditions:x.conditions.length>0?[...x.conditions,T]:[T]})}},S=I=>{if(x.conditions){const T=x.conditions[I],b=x.conditions.filter(R=>R!==T).map((R,A)=>A===0?{...R,operator:{type:"when"}}:R);P({...x,conditions:b})}};return(0,t.jsxs)("div",{children:[(0,t.jsx)(n.C,{children:(0,t.jsx)(i.I,{label:"Conditions",labelWidth:14,children:(0,t.jsx)("div",{children:x.conditions?.map((I,T)=>{if(I)return(0,t.jsx)(v,{index:T,condition:I,onChange:b=>C(b,T),onRemoveCondition:S,refIds:E},T)})})})}),(0,t.jsx)(s.$n,{variant:"secondary",type:"button",onClick:M,children:(0,t.jsx)(r.I,{name:"plus-circle"})})]})}},71680:(G,O,e)=>{"use strict";e.d(O,{z:()=>g});var t=e(74848),n=e(32196),i=e(40845),s=e(67061),r=e(14186),f=e(76892),a=e(60782),c=e(14578),o=e(21744);const h="Math operations on one or more queries. You reference the query by ${refId} ie. $A, $B, $C etc\nThe sum of two scalar values: $A + $B > 10",g=({labelWidth:y,onChange:d,query:v,onRunQuery:u})=>{const D=E=>{d({...v,expression:E.target.value})},P=(0,i.of)(p),x=()=>{v.expression&&u()};return(0,t.jsx)(s.B,{children:(0,t.jsx)(r.I,{label:(0,t.jsx)(f.c,{width:"auto",children:(0,t.jsx)(a.G,{fitContent:!0,content:(0,t.jsxs)("div",{className:P.documentationContainer,children:[(0,t.jsxs)("div",{children:["Run math operations on one or more queries. You reference the query by ","${refId}"," ie. $A, $B, $C etc.",(0,t.jsx)("br",{}),"Example: ",(0,t.jsx)("code",{children:"$A + $B"})]}),(0,t.jsx)("header",{className:P.documentationHeader,children:"Available Math functions"}),(0,t.jsxs)("div",{className:P.documentationFunctions,children:[(0,t.jsx)(l,{name:"abs",description:"returns the absolute value of its argument which can be a number or a series"}),(0,t.jsx)(l,{name:"is_inf",description:"returns 1 for Inf values (negative or positive) and 0 for other values. It's able to operate on series or scalar values."}),(0,t.jsx)(l,{name:"is_nan",description:"returns 1 for NaN values and 0 for other values. It's able to operate on series or scalar values."}),(0,t.jsx)(l,{name:"is_null",description:"returns 1 for null values and 0 for other values. It's able to operate on series or scalar values."}),(0,t.jsx)(l,{name:"is_number",description:"returns 1 for all real number values and 0 for non-number. It's able to operate on series or scalar values."}),(0,t.jsx)(l,{name:"log",description:"returns the natural logarithm of its argument, which can be a number or a series"}),(0,t.jsx)(l,{name:"inf, infn, nan, and null",description:"The inf for infinity positive, infn for infinity negative, nan, and null functions all return a single scalar value that matches its name."}),(0,t.jsx)(l,{name:"round",description:"returns a rounded integer value. It's able to operate on series or escalar values."}),(0,t.jsx)(l,{name:"ceil",description:"rounds the number up to the nearest integer value. It's able to operate on series or escalar values."}),(0,t.jsx)(l,{name:"floor",description:"rounds the number down to the nearest integer value. It's able to operate on series or escalar values."})]})]}),title:(0,t.jsxs)(s.B,{gap:1,direction:"row",children:[(0,t.jsx)(c.I,{name:"book-open"})," Math operator"]}),footer:(0,t.jsxs)("div",{children:["See our additional documentation on"," ",(0,t.jsxs)("a",{className:P.documentationLink,target:"_blank",href:"https://grafana.com/docs/grafana/latest/panels/query-a-data-source/use-expressions-to-manipulate-data/about-expressions/#math",rel:"noreferrer",children:[(0,t.jsx)(c.I,{size:"xs",name:"external-link-alt"})," Math expressions"]}),"."]}),closeButton:!0,placement:"bottom-start",children:(0,t.jsxs)("div",{className:P.info,children:["Expression ",(0,t.jsx)(c.I,{name:"info-circle"})]})})}),labelWidth:y,grow:!0,shrink:!0,children:(0,t.jsx)(o.f,{value:v.expression,onChange:D,rows:1,placeholder:h,onBlur:x,style:{minWidth:250,lineHeight:"26px",minHeight:32}})})})},l=({name:y,description:d})=>{const v=(0,i.of)(m);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:v.name,children:y}),(0,t.jsx)("span",{className:v.description,children:d})]})},p=y=>({documentationHeader:(0,n.css)`
    font-size: ${y.typography.h5.fontSize};
    font-weight: ${y.typography.h5.fontWeight};
  `,documentationLink:(0,n.css)`
    color: ${y.colors.text.link};
  `,documentationContainer:(0,n.css)`
    display: flex;
    flex: 1;
    flex-direction: column;
    gap: ${y.spacing(2)};

    padding: ${y.spacing(1)} ${y.spacing(2)};
  `,documentationFunctions:(0,n.css)`
    display: grid;
    grid-template-columns: max-content auto;
    column-gap: ${y.spacing(2)};
  `,info:(0,n.css)`
    display: flex;
    flex-direction: row;
    align-items: center;
    cursor: pointer;
    gap: ${y.spacing(1)};
  `}),m=y=>({name:(0,n.css)`
    font-weight: ${y.typography.fontWeightBold};
  `,description:(0,n.css)`
    font-size: ${y.typography.bodySmall.fontSize};
    color: ${y.colors.text.disabled};
  `})},1712:(G,O,e)=>{"use strict";e.d(O,{Z:()=>a});var t=e(74848),n=e(14186),i=e(10354),s=e(39268),r=e(90182),f=e(66718);const a=({labelWidth:c="auto",onChange:o,refIds:h,query:g})=>{const l=f.Cu.find(P=>P.value===g.reducer),p=P=>{o({...g,expression:P.value})},m=P=>{o({...g,reducer:P.value})},y=P=>{o({...g,settings:P})},d=P=>{let x;switch(P.value){case f.Mt.ReplaceNonNumbers:let E=0;g.settings?.mode===f.Mt.ReplaceNonNumbers&&(E=g.settings?.replaceWithValue??0),x={mode:f.Mt.ReplaceNonNumbers,replaceWithValue:E};break;default:x={mode:P.value}}y(x)},v=P=>{const x=P.currentTarget.valueAsNumber;y({mode:f.Mt.ReplaceNonNumbers,replaceWithValue:x??0})},u=g.settings?.mode??f.Mt.Strict,D=()=>{if(u===f.Mt.ReplaceNonNumbers)return(0,t.jsx)(n.I,{label:"Replace With",labelWidth:c,children:(0,t.jsx)(i.p,{type:"number",width:10,onChange:v,value:g.settings?.replaceWithValue??0})})};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.C,{children:(0,t.jsx)(n.I,{label:"Input",labelWidth:c,children:(0,t.jsx)(r.l6,{onChange:p,options:h,value:g.expression,width:"auto"})})}),(0,t.jsxs)(s.C,{children:[(0,t.jsx)(n.I,{label:"Function",labelWidth:c,children:(0,t.jsx)(r.l6,{options:f.Cu,value:l,onChange:m,width:20})}),(0,t.jsx)(n.I,{label:"Mode",labelWidth:c,children:(0,t.jsx)(r.l6,{onChange:d,options:f.HZ,value:u,width:25})}),D()]})]})}},34263:(G,O,e)=>{"use strict";e.d(O,{C:()=>a});var t=e(74848),n=e(39268),i=e(14186),s=e(90182),r=e(10354),f=e(66718);const a=({labelWidth:c="auto",onChange:o,refIds:h,query:g})=>{const l=f.PN.find(u=>u.value===g.downsampler),p=f.iX.find(u=>u.value===g.upsampler),m=u=>{o({...g,window:u.target.value})},y=u=>{o({...g,expression:u.value})},d=u=>{o({...g,downsampler:u.value})},v=u=>{o({...g,upsampler:u.value})};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.C,{children:(0,t.jsx)(i.I,{label:"Input",labelWidth:c,children:(0,t.jsx)(s.l6,{onChange:y,options:h,value:g.expression,width:20})})}),(0,t.jsxs)(n.C,{children:[(0,t.jsx)(i.I,{label:"Resample to",labelWidth:c,tooltip:"10s, 1m, 30m, 1h",children:(0,t.jsx)(r.p,{onChange:m,value:g.window,width:15})}),(0,t.jsx)(i.I,{label:"Downsample",children:(0,t.jsx)(s.l6,{options:f.PN,value:l,onChange:d,width:25})}),(0,t.jsx)(i.I,{label:"Upsample",children:(0,t.jsx)(s.l6,{options:f.iX,value:p,onChange:v,width:25})})]})]})}},18225:(G,O,e)=>{"use strict";e.d(O,{k:()=>s});var t=e(74848),n=e(96540),i=e(6867);const s=({onChange:r,refIds:f,query:a})=>{const o=`select * from ${(0,n.useMemo)(()=>f.map(g=>g.value),[f])[0]} limit 1`,h=g=>{r({...a,expression:g})};return(0,t.jsx)(i.Y,{query:a.expression||o,onChange:h})}},76658:(G,O,e)=>{"use strict";e.d(O,{O:()=>I});var t=e(74848),n=e(32196),i=e(96540),s=e(46819),r=e(40845),f=e(39268),a=e(14186),c=e(90182),o=e(9261),h=e(10354),g=e(15292),l=e(2913),p=e(55907),m=e(66718),y=e(65307);const d=(0,y.VP)("thresold/updateRefId"),v=(0,y.VP)("thresold/updateThresholdType"),u=(0,y.VP)("thresold/updateThresholdParams"),D=(0,y.VP)("thresold/updateHysteresis"),P=(0,y.VP)("thresold/updateUnloadParams"),x=(0,y.vy)({type:m.Tz.threshold,refId:"",conditions:[]},R=>{R.addCase(d,(A,L)=>{A.expression=L.payload}),R.addCase(v,(A,L)=>{const U=L.payload.evalFunction,W=L.payload.onError;if(A.conditions[0].evaluator.type=U,!!A.conditions[0].unloadEvaluator){const N=E(A.conditions[0].evaluator.type);W&&W(void 0),A.conditions[0].evaluator.type=U;const B={type:N,params:A.conditions[0].evaluator?.params??[0,0]};A.conditions[0].unloadEvaluator=B}}),R.addCase(u,(A,L)=>{const{param:U,index:W}=L.payload;A.conditions[0].evaluator.params[W]=U}),R.addCase(D,(A,L)=>{const{hysteresisChecked:U,onError:W}=L.payload;U?A.conditions[0].unloadEvaluator={type:E(A.conditions[0].evaluator.type),params:A.conditions[0].evaluator?.params??[0,0]}:(A.conditions[0].unloadEvaluator=void 0,W&&W(void 0))}),R.addCase(P,(A,L)=>{const{param:U,index:W,onError:w}=L.payload;A.conditions[0].unloadEvaluator?A.conditions[0].unloadEvaluator.params[W]=U:A.conditions[0].unloadEvaluator={type:E(A.conditions[0].evaluator.type),params:A.conditions[0].evaluator?.params??[0,0]};const N=C(A.conditions[0]),{errorMsg:B,errorMsgFrom:V,errorMsgTo:K}=N??{};w&&w(B||V||K)})});function E(R){return R===p.p.IsAbove?p.p.IsBelow:R===p.p.IsBelow?p.p.IsAbove:R===p.p.IsWithinRange?p.p.IsOutsideRange:R===p.p.IsOutsideRange?p.p.IsWithinRange:p.p.IsBelow}function C(R){const{unloadEvaluator:A,evaluator:L}=R;if(!L)return;if(A?.params[0]===void 0||Number.isNaN(A?.params[0]))return{errorMsg:"This value cannot be empty"};const{type:U,params:W}=L,{params:w}=A;if(U===p.p.IsWithinRange||U===p.p.IsOutsideRange){if(w[0]===void 0||Number.isNaN(w[0]))return{errorMsgFrom:"This value cannot be empty"};if(w[1]===void 0||Number.isNaN(w[1]))return{errorMsgTo:"This value cannot be empty"}}const[N,B]=A.params,[V,K]=W;switch(U){case p.p.IsAbove:if(N>V)return{errorMsg:`Enter a number less than or equal to ${V}`};break;case p.p.IsBelow:if(N<V)return{errorMsg:`Enter a number more than or equal to ${V}`};break;case p.p.IsOutsideRange:if(N<V)return{errorMsgFrom:`Enter a number more than or equal to ${V}`};if(B>K)return{errorMsgTo:`Enter a number less than or equal to ${K}`};break;case p.p.IsWithinRange:if(N>V)return{errorMsgFrom:`Enter a number less than or equal to ${V}`};if(B<K)return{errorMsgTo:`Enter a number be more than or equal to ${K}`};break;default:throw new Error(`evaluator function type ${U} not supported.`)}}const M=p.p.IsAbove,S={type:"query",evaluator:{type:M,params:[0,0]},query:{params:[]},reducer:{params:[],type:"last"}},I=({labelWidth:R,onChange:A,refIds:L,query:U,onError:W,useHysteresis:w=!1})=>{const N=(0,r.of)(b),B={...U,conditions:U.conditions?.length?U.conditions:[S]},[V,K]=(0,i.useReducer)(x,B),H=V.conditions[0],X=m.zd.find(ne=>ne.value===V.conditions[0].evaluator?.type),k=ne=>{K(d(ne.value))};(0,i.useEffect)(()=>{V&&A(V)},[V]);const Y=ne=>{K(v({evalFunction:ne.value??M,onError:W}))},Z=(ne,oe)=>{K(u({param:parseFloat(ne.currentTarget.value),index:oe}))},se=H.evaluator.type===p.p.IsWithinRange||H.evaluator.type===p.p.IsOutsideRange,j=!!l.config.featureToggles?.recoveryThreshold&&w;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.C,{children:(0,t.jsx)(a.I,{label:"Input",labelWidth:R,children:(0,t.jsx)(c.l6,{onChange:k,options:L,value:U.expression,width:20})})}),(0,t.jsxs)(f.C,{children:[(0,t.jsx)(o.f,{className:N.buttonSelectText,options:m.zd,onChange:Y,value:X}),se?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.p,{type:"number",width:10,onChange:ne=>Z(ne,0),defaultValue:H.evaluator.params[0]}),(0,t.jsx)("div",{className:N.button,children:"TO"}),(0,t.jsx)(h.p,{type:"number",width:10,onChange:ne=>Z(ne,1),defaultValue:H.evaluator.params[1]})]}):(0,t.jsx)(h.p,{type:"number",width:10,onChange:ne=>Z(ne,0),defaultValue:H.evaluator.params[0]||0})]}),j&&(0,t.jsx)(q,{isRange:se,onError:W})]});function q({isRange:ne,onError:oe}){const z=!!H.unloadEvaluator,te=ae=>{K(D({hysteresisChecked:ae.currentTarget.checked,onError:oe})),le.current=!0},le=i.useRef(!0),ie=()=>{le.current=!1};return(0,t.jsxs)("div",{className:N.hysteresis,children:[(0,t.jsx)("div",{onMouseDown:ie,children:(0,t.jsx)(g.K,{showLabel:!0,label:"Custom recovery threshold",value:z,onChange:te,className:N.switch})}),z&&(0,t.jsx)(T,{isRange:ne,condition:H,onError:oe,dispatch:K,allowOnblur:le})]})}};function T({isRange:R,condition:A,onError:L,dispatch:U,allowOnblur:W}){const w=(0,r.of)(b),N=(Y,Z)=>{const se=parseFloat(Y.currentTarget.value);U(P({param:se,index:Z,onError:L}))},B=C(A),{errorMsg:V,errorMsgFrom:K,errorMsgTo:H}=B??{};if(R)return(0,t.jsx)(X,{allowOnblur:W});return(0,t.jsx)(k,{allowOnblur:W});function X({allowOnblur:Y}){return A.evaluator.type===p.p.IsWithinRange?(0,t.jsx)(f.C,{className:w.hysteresis,children:(0,t.jsx)(a.I,{label:"Stop alerting when outside range",labelWidth:"auto",children:(0,t.jsxs)(s.B,{direction:"row",gap:0,children:[(0,t.jsx)("div",{className:w.range,children:(0,t.jsx)(a.I,{invalid:!!K,error:K,className:w.noMargin,children:(0,t.jsx)(h.p,{type:"number",width:10,onBlur:Z=>Y.current&&N(Z,0),defaultValue:A.unloadEvaluator?.params[0]})})}),(0,t.jsx)("div",{className:w.button,children:"TO"}),(0,t.jsx)("div",{className:w.range,children:(0,t.jsx)(a.I,{invalid:!!H,error:H,children:(0,t.jsx)(h.p,{type:"number",width:10,onBlur:Z=>Y.current&&N(Z,1),defaultValue:A.unloadEvaluator?.params[1]})})})]})})}):(0,t.jsx)(f.C,{className:w.hysteresis,children:(0,t.jsx)(a.I,{label:"Stop alerting when inside range",labelWidth:"auto",children:(0,t.jsxs)(s.B,{direction:"row",gap:0,children:[(0,t.jsx)("div",{className:w.range,children:(0,t.jsx)(a.I,{invalid:!!K,error:K,children:(0,t.jsx)(h.p,{type:"number",width:10,onBlur:Z=>Y.current&&N(Z,0),defaultValue:A.unloadEvaluator?.params[0]})})}),(0,t.jsx)("div",{className:w.button,children:"TO"}),(0,t.jsx)("div",{className:w.range,children:(0,t.jsx)(a.I,{invalid:!!H,error:H,children:(0,t.jsx)(h.p,{type:"number",width:10,onBlur:Z=>Y.current&&N(Z,1),defaultValue:A.unloadEvaluator?.params[1]})})})]})})})}function k({allowOnblur:Y}){return A.evaluator.type===p.p.IsAbove?(0,t.jsx)(f.C,{className:w.hysteresis,children:(0,t.jsx)(a.I,{label:"Stop alerting when below",labelWidth:"auto",invalid:!!V,error:V,children:(0,t.jsx)(h.p,{type:"number",width:10,onBlur:Z=>{Y.current&&N(Z,0)},defaultValue:A.unloadEvaluator?.params[0]})})}):(0,t.jsx)(f.C,{className:w.hysteresis,children:(0,t.jsx)(a.I,{label:"Stop alerting when above",labelWidth:"auto",invalid:!!V,error:V,children:(0,t.jsx)(h.p,{type:"number",width:10,onBlur:Z=>{Y.current&&N(Z,0)},defaultValue:A.unloadEvaluator?.params[0]})})})}}const b=R=>({buttonSelectText:(0,n.css)({color:R.colors.primary.text,fontSize:R.typography.bodySmall.fontSize,textTransform:"uppercase",padding:`0 ${R.spacing(1)}`}),button:(0,n.css)({height:"32px",color:R.colors.primary.text,fontSize:R.typography.bodySmall.fontSize,textTransform:"uppercase",display:"flex",alignItems:"center",borderRadius:R.shape.radius.default,fontWeight:R.typography.fontWeightBold,border:`1px solid ${R.colors.border.medium}`,whiteSpace:"nowrap",padding:`0 ${R.spacing(1)}`,backgroundColor:R.colors.background.primary}),range:(0,n.css)({width:"min-content"}),hysteresis:(0,n.css)({marginTop:R.spacing(2)}),switch:(0,n.css)({paddingLeft:R.spacing(1)}),noMargin:(0,n.css)({margin:0})})},69437:(G,O,e)=>{"use strict";e.d(O,{f:()=>i});var t=e(26657),n=e(66718);const i=s=>{if(!s)return!1;if((0,t.s9)(s.datasource))return!0;const r=s;return typeof r.type!="string"?!1:Object.values(n.Tz).includes(r.type)}},66718:(G,O,e)=>{"use strict";e.d(O,{Cu:()=>c,HZ:()=>h,Mt:()=>o,NI:()=>f,PN:()=>g,Tz:()=>r,Uj:()=>s,iX:()=>l,uQ:()=>a,zd:()=>p});var t=e(75059),n=e(2913),i=e(55907);const s="__expr__";var r=(m=>(m.math="math",m.reduce="reduce",m.resample="resample",m.classic="classic_conditions",m.threshold="threshold",m.sql="sql",m))(r||{});const f=m=>{switch(m){case"math":return"Math";case"reduce":return"Reduce";case"resample":return"Resample";case"classic_conditions":return"Classic condition (legacy)";case"threshold":return"Threshold";case"sql":return"SQL"}},a=[{value:"math",label:"Math",description:"Free-form math formulas on time series or number data."},{value:"reduce",label:"Reduce",description:"Takes one or more time series returned from a query or an expression and turns each series into a single number."},{value:"resample",label:"Resample",description:"Changes the time stamps in each time series to have a consistent time interval."},{value:"classic_conditions",label:"Classic condition (legacy)",description:"Takes one or more time series returned from a query or an expression and checks if any of the series match the condition. Disables multi-dimensional alerts for this rule."},{value:"threshold",label:"Threshold",description:"Takes one or more time series returned from a query or an expression and checks if any of the series match the threshold condition."},{value:"sql",label:"SQL",description:"Transform data using SQL. Supports Aggregate/Analytics functions from DuckDB"}].filter(m=>m.value==="sql"?n.config.featureToggles?.sqlExpressions:!0),c=[{value:t.gy.min,label:"Min",description:"Get the minimum value"},{value:t.gy.max,label:"Max",description:"Get the maximum value"},{value:t.gy.mean,label:"Mean",description:"Get the average value"},{value:t.gy.sum,label:"Sum",description:"Get the sum of all values"},{value:t.gy.count,label:"Count",description:"Get the number of values"},{value:t.gy.last,label:"Last",description:"Get the last value"}];var o=(m=>(m.Strict="",m.ReplaceNonNumbers="replaceNN",m.DropNonNumbers="dropNN",m))(o||{});const h=[{value:"",label:"Strict",description:"Result can be NaN if series contains non-numeric data"},{value:"dropNN",label:"Drop Non-numeric Values",description:"Drop NaN, +/-Inf and null from input series before reducing"},{value:"replaceNN",label:"Replace Non-numeric Values",description:"Replace NaN, +/-Inf and null with a constant value before reducing"}],g=[{value:t.gy.last,label:"Last",description:"Fill with the last value"},{value:t.gy.min,label:"Min",description:"Fill with the minimum value"},{value:t.gy.max,label:"Max",description:"Fill with the maximum value"},{value:t.gy.mean,label:"Mean",description:"Fill with the average value"},{value:t.gy.sum,label:"Sum",description:"Fill with the sum of all values"}],l=[{value:"pad",label:"pad",description:"fill with the last known value"},{value:"backfilling",label:"backfilling",description:"fill with the next known value"},{value:"fillna",label:"fillna",description:"Fill with NaNs"}],p=[{value:i.p.IsAbove,label:"Is above"},{value:i.p.IsBelow,label:"Is below"},{value:i.p.IsWithinRange,label:"Is within range"},{value:i.p.IsOutsideRange,label:"Is outside range"}]},76942:(G,O,e)=>{"use strict";e.d(O,{P:()=>r,r:()=>s});var t=e(75059),n=e(55907),i=e(66718);const s=f=>{switch(f.type){case i.Tz.reduce:f.reducer||(f.reducer=t.gy.mean);break;case i.Tz.resample:f.downsampler||(f.downsampler=t.gy.mean),f.upsampler||(f.upsampler="fillna"),f.reducer=void 0;break;case i.Tz.math:f.expression=void 0;break;case i.Tz.classic:f.conditions||(f.conditions=[r]);break;default:f.reducer=void 0}return f},r={type:"query",reducer:{params:[],type:"avg"},operator:{type:"and"},query:{params:[]},evaluator:{params:[0,0],type:n.p.IsAbove}}},71101:(G,O,e)=>{"use strict";e.d(O,{Cg:()=>a,Fk:()=>o,R4:()=>l,Rj:()=>f,pq:()=>c});var t=e(32264),n=e(8484),i=e(16233),s=e(36689),r=e(31678);const f="manage-folder",a=m=>`folder-dashboards-${m}`,c=m=>`folder-library-panels-${m}`,o=m=>`folder-alerting-${m}`,h=m=>`folder-permissions-${m}`,g=m=>`folder-settings-${m}`;function l(m,y=m.parents){const d={icon:"folder",id:f,subTitle:(0,s.o)("manage-folder"),url:m.url,text:m.title,children:[{active:!1,icon:"apps",id:a(m.uid),text:(0,n.t)("browse-dashboards.manage-folder-nav.dashboards","Dashboards"),url:m.url}]};if(y&&y.length>0){const v=y[y.length-1],u=y.slice(0,y.length-1);d.parentItem=l(v,u)}return d.children.push({active:!1,icon:"library-panel",id:c(m.uid),text:(0,n.t)("browse-dashboards.manage-folder-nav.panels","Panels"),url:`${m.url}/library-panels`}),i.TP.hasPermission(r.AccessControlAction.AlertingRuleRead)&&t.$.unifiedAlertingEnabled&&d.children.push({active:!1,icon:"bell",id:o(m.uid),text:(0,n.t)("browse-dashboards.manage-folder-nav.alert-rules","Alert rules"),url:`${m.url}/alerting`}),d}function p(m){const y=l({created:"",createdBy:"",hasAcl:!1,updated:"",updatedBy:"",id:1,uid:"loading",title:"Loading",url:"url",canSave:!0,canEdit:!0,canAdmin:!0,canDelete:!0,version:0});return y.children[m].active=!0,{main:y,node:y.children[m]}}},54650:(G,O,e)=>{"use strict";e.d(O,{Ay:()=>o,jl:()=>f});var t=e(65307),n=e(55314);const i={id:0,uid:"loading",title:"loading",url:"",canSave:!1,canDelete:!1,hasChanged:!1,version:1},s=(h,g)=>({...h,...g.payload,hasChanged:!1}),r=(0,t.Z0)({name:"folder",initialState:i,reducers:{loadFolder:s,setFolderTitle:(h,g)=>({...h,title:g.payload,hasChanged:g.payload.trim().length>0})},extraReducers:h=>{h.addMatcher(n.vZ.getFolder.matchFulfilled,s)}}),{loadFolder:f,setFolderTitle:a}=r.actions,o={folder:r.reducer}},84350:(G,O,e)=>{"use strict";e.d(O,{G:()=>o});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(90182),f=e(42418),a=e(67140);const c=[{label:"Countries",description:"Lookup countries by name, two letter code, or three letter code",value:a.fx},{label:"USA States",description:"Lookup states by name or 2 ",value:"public/gazetteer/usa-states.json"},{label:"Airports",description:"Lookup airports by id or code",value:"public/gazetteer/airports.geojson"}],o=({value:g,onChange:l,context:p,item:m})=>{const y=(0,s.of)(h),[d,v]=(0,i.useState)(),u=m.settings;(0,i.useEffect)(()=>{async function x(){const E=await(0,a.q3)(g);v(E)}x()},[g,v]);const{current:D,options:P}=(0,i.useMemo)(()=>{let x=u?.options?[...u.options]:[...c],E=x?.find(C=>C.value===d?.path);return!E&&d&&(E={label:d.path,value:d.path},x.push(E)),{options:x,current:E}},[d,u?.options]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.l6,{value:D,options:P,onChange:x=>l(x.value),allowCustomValue:!0,formatCreateLabel:x=>`Load from URL: ${x}`}),d&&(0,t.jsxs)(t.Fragment,{children:[d.error&&(0,t.jsx)(f.F,{title:d.error,severity:"warning"}),d.count&&(0,t.jsxs)("div",{className:y.keys,children:[(0,t.jsxs)("b",{children:["(",d.count,")"]}),d.examples(10).map(x=>(0,t.jsxs)("span",{children:[x,","]},x)),d.count>10&&" ..."]})]})]})},h=()=>({keys:(0,n.css)`
    margin-top: 4px;
    text-overflow: ellipsis;
    overflow: hidden;
    white-space: nowrap;

    > span {
      margin-left: 4px;
    }
  `})},61983:(G,O,e)=>{"use strict";e.d(O,{G:()=>u});var t=e(11261),n=e(52622),i=e(84350),s=e(74848),r=e(32196),f=e(96540),a=e(13544),c=e(40845),o=e(42418),h=e(14578),g=e(90182),l=e(66864),p=e(31484);const m=[{value:n.aG.Auto,label:"Auto",ariaLabel:a.Tp.components.Transforms.SpatialOperations.location.autoOption,description:"Automatically identify location data based on default field names"},{value:n.aG.Coords,label:"Coords",ariaLabel:a.Tp.components.Transforms.SpatialOperations.location.coords.option,description:"Specify latitude and longitude fields"},{value:n.aG.Geohash,label:"Geohash",ariaLabel:a.Tp.components.Transforms.SpatialOperations.location.geohash.option,description:"Specify geohash field"},{value:n.aG.Lookup,label:"Lookup",ariaLabel:a.Tp.components.Transforms.SpatialOperations.location.lookup.option,description:"Specify Gazetteer and lookup field"}],y="https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/geomap/#location",d=({value:D,onChange:P,context:x,item:E})=>{const[C,M]=(0,f.useState)();(0,f.useEffect)(()=>{E.settings?.source&&E.settings?.data?.length&&E.settings.data[0]&&(0,p.nE)(E.settings.source).then(T=>{E.settings&&E.settings.data&&M((0,p.FM)(E.settings.data[0],T))})},[E.settings]);const S=(0,c.of)(v),I=()=>{if(C){if(C.warning)return(0,s.jsx)(o.F,{title:C.warning,severity:"warning",buttonContent:(0,s.jsx)(h.I,{name:"question-circle",size:"xl"}),className:S.alert,onRemove:()=>{const T=window.open(y,"_blank","noopener,noreferrer");T&&(T.opener=null)}});if(D===n.aG.Auto&&C.description)return(0,s.jsx)("span",{children:C.description})}return null};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(g.l6,{options:m,value:D,onChange:T=>{P(T.value)}}),(0,s.jsx)(l.Gy,{className:S.hGroup,children:I()})]})},v=D=>({alert:(0,r.css)`
      & div {
        padding: 4px;
      }
      margin-bottom: 0px;
      margin-top: 5px;
      padding: 2px;
    `,hGroup:(0,r.css)`
      & div {
        width: 100%;
      }
    `});function u(D,P,x,E,C){switch(x.addCustomEditor({id:"modeEditor",path:`${P}mode`,name:"Location Mode",editor:d,settings:{data:C,source:E}}),E?.mode){case n.aG.Coords:x.addFieldNamePicker({path:`${P}latitude`,name:"Latitude field",settings:{filter:M=>M.type===t.PU.number,noFieldsMessage:"No numeric fields found"}}).addFieldNamePicker({path:`${P}longitude`,name:"Longitude field",settings:{filter:M=>M.type===t.PU.number,noFieldsMessage:"No numeric fields found"}});break;case n.aG.Geohash:x.addFieldNamePicker({path:`${P}geohash`,name:"Geohash field",settings:{filter:M=>M.type===t.PU.string,noFieldsMessage:"No strings fields found"}});break;case n.aG.Lookup:x.addFieldNamePicker({path:`${P}lookup`,name:"Lookup field",settings:{filter:M=>M.type===t.PU.string,noFieldsMessage:"No strings fields found"}}).addCustomEditor({id:"gazetteer",path:`${P}gazetteer`,name:"Gazetteer",editor:i.G})}}},96606:(G,O,e)=>{"use strict";e.d(O,{RA:()=>l,XR:()=>p,Dc:()=>g,qy:()=>o,Pz:()=>h});var t=e(44294),n=e(34338),i=e(11217),s=e(22796),r=e(11261),f=e(78134);function a(y){if(!y?.length)return;const d=[16,8,4,2,1],v="0123456789bcdefghjkmnpqrstuvwxyz";let u=!0;const D=[],P=[];D[0]=-90,D[1]=90,P[0]=-180,P[1]=180;let x;y.split("").forEach(M=>{x=v.indexOf(M),d.forEach(S=>{c(u?P:D,x,S),u=!u})});const E=(D[0]+D[1])/2;return[(P[0]+P[1])/2,E]}function c(y,d,v){d&v?y[0]=(y[0]+y[1])/2:y[1]=(y[0]+y[1])/2}function o(y){return{name:y.name??"Point",type:r.PU.geo,values:y.values.map(d=>{const v=a(d);if(v)return new t.A((0,s.Rb)(v))}),config:m}}function h(y,d){const v=new Array(y.values.length);for(let u=0;u<y.values.length;u++){const D=y.values[u],P=d.values[u];D===null||P===null||(v[u]=new t.A((0,s.Rb)([D,P])))}return{name:"Point",type:r.PU.geo,values:v,config:m}}function g(y,d){const v=d.values.length,u=new Array(v);for(let D=0;D<v;D++)u[D]=y.find(d.values[D])?.geometry();return{name:"Geometry",type:r.PU.geo,values:u,config:m}}function l(y,d){const v=y.values,u=d.values;if(!v||!u)throw"missing src/dest";if(v.length!==u.length)throw"Source and destination field lengths do not match";const D=y.values.length,P=new Array(D);for(let x=0;x<D;x++){const E=v[x],C=u[x];E&&C?P[x]=new n.A([E,C]):E?P[x]=E:C&&(P[x]=C)}return{name:"Geometry",type:r.PU.geo,values:P,config:m}}function p(y,d){const v=y.values,u=d.values;if(!v||!u)throw"missing src/dest";if(v.length!==u.length)throw"Source and destination field lengths do not match";const D=y.values.length,P=new Array(D);for(let x=0;x<D;x++){const E=v[x],C=u[x];E&&C&&(P[x]=new i.A([(0,f.EX)(E),(0,f.EX)(C)]))}return{name:"Geometry",type:r.PU.geo,values:P,config:m}}const m=Object.freeze({custom:{hideFrom:{tooltip:!0}}})},67140:(G,O,e)=>{"use strict";e.d(O,{fx:()=>y,q3:()=>d});var t=e(70915),n=e(44294),i=e(14236),s=e(11261),r=e(17172),f=e(11365);function a(v){const u=new f.A().readFeatures(v,{featureProjection:"EPSG:3857"}),D=u.length,P=new Array(D).fill(null),x=[],E=new Map,C=T=>{let b=E.get(T);return b||(b={types:new Set,values:new Array(D).fill(null),count:0},x.push(T),E.set(T,b)),b},M=(...T)=>{for(const b of T)if(!E.has(b))return b;return"___"+T[0]},S={types:new Set,values:new Array(D).fill(null),count:0};for(let T=0;T<D;T++){const b=u[T];P[T]=b.getGeometry();const R=b.getId();R!=null&&(S.values[T]=R,S.types.add((0,i.oE)(R)),S.count++);for(const A of b.getKeys()){const L=b.get(A);if(L===P[T]||L==null)continue;const U=C(A);U.values[T]=L,U.types.add((0,i.oE)(L)),U.count++}}const I=[];if(S.count>0){const T=c(S);I.push({name:M("id","_id","__id"),type:T,values:S.values,config:{}})}I.push({name:M("geo","geometry"),type:s.PU.geo,values:P,config:{}});for(const T of x){const b=E.get(T);if(!b)continue;const R=c(b);I.push({name:T,type:R,values:b.values,config:{}})}return{fields:I,length:D}}function c(v){return v.count<1?s.PU.other:v.types.size>1?(v.values=v.values.map(u=>u!=null?`${u}`:u),s.PU.string):v.types.values().next().value}var o=e(96606),h=e(22796);function g(v,u){let D=0;const P=new Map;for(const x of u){const E=new n.A((0,h.Rb)([x.longitude,x.latitude])),C={point:()=>E,geometry:()=>E};if(x.name&&(P.set(x.name,C),P.set(x.name.toUpperCase(),C)),x.key&&(P.set(x.key,C),P.set(x.key.toUpperCase(),C)),x.keys)for(const M of x.keys)P.set(M,C),P.set(M.toUpperCase(),C);D++}return{path:v,find:x=>{let E=P.get(x);return!E&&typeof x=="string"&&(E=P.get(x.toUpperCase())),E},count:D,examples:x=>{const E=[];if(P.size<1)E.push("no values found");else for(const C of P.keys())if(E.push(C),E.length>=x)break;return E}}}function l(v,u){let D;if(Array.isArray(u)){const P=u[0];if(P.latitude&&P.longitude&&(P.key||P.keys))return g(v,u)}else Array.isArray(u?.features)&&u?.type==="FeatureCollection"&&(D=a(u));if(!D)try{D=(0,i.Vc)(u)}catch(P){return{path:v,error:`${P}`,find:x=>{},examples:x=>[]}}return p(D,{path:v})}function p(v,u){const D=[];let P,x,E,C,M;for(const T of v.fields)if(T.type===s.PU.geo&&(P=T),!M&&T.type===s.PU.string&&(M=T),T.name){u.keys&&u.keys.includes(T.name)&&D.push(T);const b=T.name.toUpperCase();switch(b){case"LAT":case"LATITUTE":x=T;break;case"LON":case"LNG":case"LONG":case"LONGITUE":E=T;break;case"GEOHASH":C=T;break;case"ID":case"UID":case"KEY":case"CODE":u.keys||D.push(T);break;default:u.keys||(b.endsWith("_ID")||b.endsWith("_CODE"))&&D.push(T)}}!D.length&&M&&D.push(M);let S=!1;P?S=P.values[0]?.getType()==="Point":C?(P=(0,o.qy)(C),S=!0):x&&E&&(P=(0,o.Pz)(E,x),S=!0);const I=new Map;return D.forEach(T=>{T.values.forEach((b,R)=>{const A=`${b}`;I.set(A.toUpperCase(),R),I.set(A,R)})}),{path:u.path,find:T=>{const b=I.get(T);if(b!=null){const R=P?.values[b];return{frame:v,index:b,point:()=>!R||S?R:new n.A((0,t.q1)(R.getExtent())),geometry:()=>R}}},examples:T=>{const b=[];for(let R of I.keys())if(b.push(R),b.length>T)break;return b},frame:()=>v,count:v.length}}const m={},y="public/gazetteer/countries.json";async function d(v){v||(v=y);let u=m[v];if(!u){try{const D=await(0,r.AI)().get(v);u=l(v,D)}catch(D){console.warn("Error loading placename lookup",v,D),u={path:v,error:"Error loading URL",find:P=>{},examples:P=>[]}}m[v]=u}return u}},31484:(G,O,e)=>{"use strict";e.d(O,{FM:()=>p,nE:()=>g});var t=e(28240),n=e(11261),i=e(85200),s=e(1173),r=e(52622),f=e(96606),a=e(67140);function c(m){return y=>{for(const d of y.fields)if(m(d,y,[]))return d}}function o(m){return y=>{for(const d of y.fields){if(m.has(d.name.toLowerCase()))return d;const v=(0,t.Ct)(d,y);if(m.has(v))return d}}}const h={mode:r.aG.Auto,geohash:o(new Set(["geohash"])),latitude:o(new Set(["latitude","lat"])),longitude:o(new Set(["longitude","lon","lng"])),h3:o(new Set(["h3"])),wkt:o(new Set(["wkt"])),lookup:o(new Set(["lookup"])),geo:m=>m.fields.find(y=>y.type===n.PU.geo)};async function g(m){const y={...h,mode:m?.mode??r.aG.Auto};switch(y.gazetteer=await(0,a.q3)(m?.gazetteer),y.mode){case r.aG.Geohash:m?.geohash?y.geohash=c((0,i.NS)({id:s.Ct.byName,options:m.geohash})):y.geohash=()=>{};break;case r.aG.Lookup:const d=m?.lookup?.length?(0,i.NS)({id:s.Ct.byName,options:m.lookup}):(0,i.NS)({id:s.Ct.byType,options:n.PU.string});y.lookup=c(d);break;case r.aG.Coords:m?.latitude?y.latitude=c((0,i.NS)({id:s.Ct.byName,options:m.latitude})):y.latitude=()=>{},m?.longitude?y.longitude=c((0,i.NS)({id:s.Ct.byName,options:m.longitude})):y.longitude=()=>{};break}return y}function l(m,y){const d={mode:y.mode??r.aG.Auto};if(d.mode===r.aG.Auto){if(d.geo=y.geo(m),d.geo)return d;if(d.latitude=y.latitude(m),d.longitude=y.longitude(m),d.latitude&&d.longitude)return d.mode=r.aG.Coords,d;if(d.geohash=y.geohash(m),d.geohash)return d.mode=r.aG.Geohash,d;if(d.lookup=y.lookup(m),d.lookup)return d.mode=r.aG.Lookup,d}switch(d.mode){case r.aG.Coords:d.latitude=y.latitude(m),d.longitude=y.longitude(m);break;case r.aG.Geohash:d.geohash=y.geohash(m);break;case r.aG.Lookup:d.lookup=y.lookup(m);break}return d}function p(m,y){const d=l(m,y);switch(d.mode){case r.aG.Auto:return d.geo?{field:d.geo}:{warning:"Unable to find location fields"};case r.aG.Coords:return d.latitude&&d.longitude?{field:(0,f.Pz)(d.longitude,d.latitude),derived:!0,description:`${d.mode}: ${d.latitude.name}, ${d.longitude.name}`}:{warning:"Select latitude/longitude fields"};case r.aG.Geohash:return d.geohash?{field:(0,f.qy)(d.geohash),derived:!0,description:`${d.mode}`}:{warning:"Select geohash field"};case r.aG.Lookup:return d.lookup?y.gazetteer?{field:(0,f.Dc)(y.gazetteer,d.lookup),derived:!0,description:`${d.mode}: ${y.gazetteer.path}`}:{warning:"Gazetteer not found"}:{warning:"Select lookup field"}}return{warning:"unable to find geometry"}}},61453:(G,O,e)=>{"use strict";e.d(O,{q:()=>A});var t=e(74848),n=e(2543),i=e(96540),s=e(70713),r=e(18282),f=e(2514),a=e(90708),c=e(13544),o=e(14110),h=e(72574),g=e(55852),l=e(62930),p=e(77093),m=e(2913),y=e(8484),d=e(69147),v=e(28240),u=e(40845),D=e(66864),P=e(88575),x=e(90182),E=e(15292),C=e(7788),M=e(32196);const S=U=>(0,M.css)`
  padding: ${U.spacing(0,2)};
  font-size: ${U.typography.bodySmall.fontSize};
  color: ${U.colors.text.secondary};
  overflow: hidden;
  text-overflow: ellipsis;
`,I=({children:U})=>{const W=(0,u.of)(S);return(0,t.jsx)("div",{className:W,children:U})};var T=e(26323);const b=({options:U,actions:W,formattedDataDescription:w,onOptionsChange:N,hasTransformations:B,data:V,dataFrames:K,transformationOptions:H,selectedDataFrame:X,onDataFrameChange:k,downloadForExcel:Y,toggleDownloadForExcel:Z})=>{const se=(0,u.of)(T.A);let j=K;X===r.F.joinByField&&(j=V);const q=j.map((z,te)=>({value:te,label:`${(0,v.Ri)(z)} (${te})`})),ne=[...H,...q];function oe(){let z="";if(!V)return z;const te=[];return X===r.F.joinByField?te.push((0,y.t)("dashboard.inspect-data.series-to-columns","Series joined by time")):V.length>1&&te.push((0,v.Ri)(V[X])),(U.withTransforms||U.withFieldConfig)&&(U.withTransforms&&te.push((0,y.t)("dashboard.inspect-data.panel-transforms","Panel transforms")),U.withTransforms&&U.withFieldConfig,U.withFieldConfig&&te.push((0,y.t)("dashboard.inspect-data.formatted","Formatted data"))),Y&&te.push((0,y.t)("dashboard.inspect-data.excel-header","Excel header")),te.join(", ")}return(0,t.jsx)("div",{className:se.dataDisplayOptions,children:(0,t.jsx)(C.u,{id:"Data options",index:0,title:(0,y.t)("dashboard.inspect-data.data-options","Data options"),headerElement:(0,t.jsx)(I,{children:oe()}),isOpen:!1,actions:W,children:(0,t.jsx)("div",{className:se.options,"data-testid":"dataOptions",children:(0,t.jsxs)(D.gW,{spacing:"none",children:[V.length>1&&(0,t.jsx)(P.D,{label:(0,y.t)("dashboard.inspect-data.dataframe-label","Show data frame"),children:(0,t.jsx)(x.l6,{options:ne,value:X,onChange:k,width:30,"aria-label":(0,y.t)("dashboard.inspect-data.dataframe-aria-label","Select dataframe")})}),(0,t.jsxs)(D.Gy,{children:[B&&N&&(0,t.jsx)(P.D,{label:(0,y.t)("dashboard.inspect-data.transformations-label","Apply panel transformations"),description:(0,y.t)("dashboard.inspect-data.transformations-description","Table data is displayed with transformations defined in the panel Transform tab."),children:(0,t.jsx)(E.d,{value:!!U.withTransforms,onChange:()=>N({...U,withTransforms:!U.withTransforms})})}),N&&(0,t.jsx)(P.D,{label:(0,y.t)("dashboard.inspect-data.formatted-data-label","Formatted data"),description:w||(0,y.t)("dashboard.inspect-data.formatted-data-description","Table data is formatted with options defined in the Field and Override tabs."),children:(0,t.jsx)(E.d,{id:"formatted-data-toggle",value:!!U.withFieldConfig,onChange:()=>N({...U,withFieldConfig:!U.withFieldConfig})})}),(0,t.jsx)(P.D,{label:(0,y.t)("dashboard.inspect-data.download-excel-label","Download for Excel"),description:(0,y.t)("dashboard.inspect-data.download-excel-description","Adds header to CSV for use with Excel"),children:(0,t.jsx)(E.d,{id:"excel-toggle",value:Y,onChange:Z})})]})]})})})})};var R=e(18358);class A extends i.PureComponent{constructor(W){super(W),this.onExportLogsAsTxt=()=>{const{data:w,dataName:N,app:B}=this.props;(0,o.rR)("grafana_logs_download_logs_clicked",{app:B,format:"logs",area:"inspector"});const V=(0,d.HT)(w||[]);(0,R.Zy)(V,N)},this.onExportTracesAsJson=()=>{const{data:w,dataName:N,app:B}=this.props;if(w)for(const V of w){if(V.meta?.preferredVisualisationType!=="trace")continue;const K=(0,R.ek)(V,N+"-traces");(0,o.rR)("grafana_traces_download_traces_clicked",{app:B,grafana_version:m.config.buildInfo.version,trace_format:K,location:"inspector"})}},this.onExportServiceGraph=()=>{const{data:w,dataName:N,app:B}=this.props;(0,o.rR)("grafana_traces_download_service_graph_clicked",{app:B,grafana_version:m.config.buildInfo.version,location:"inspector"}),w&&(0,R.ny)(w,N)},this.onDataFrameChange=w=>{this.setState({transformId:w.value===r.F.joinByField?r.F.joinByField:r.F.noop,dataFrameIndex:typeof w.value=="number"?w.value:0,selectedDataFrame:w.value})},this.onToggleDownloadForExcel=()=>{this.setState(w=>({downloadForExcel:!w.downloadForExcel}))},this.state={selectedDataFrame:0,dataFrameIndex:0,transformId:r.F.noop,transformationOptions:L(),transformedData:W.data??[],downloadForExcel:!1}}componentDidUpdate(W,w){if(!this.props.data){this.setState({transformedData:[]});return}if(this.props.options.withTransforms){this.setState({transformedData:this.props.data});return}if(W.data!==this.props.data||w.transformId!==this.state.transformId){const N=this.state.transformationOptions.find(B=>B.value===this.state.transformId);if(N&&N.transformer.id!==r.F.noop){const B=this.state.selectedDataFrame,V=this.state.dataFrameIndex,K=(0,f.m)([N.transformer],this.props.data).subscribe(H=>{this.setState({transformedData:H,selectedDataFrame:B,dataFrameIndex:V},()=>K.unsubscribe())});return}this.setState({transformedData:this.props.data});return}}exportCsv(W,w){const{dataName:N}=this.props,{transformId:B}=this.state,V=W[this.state.dataFrameIndex];w&&(0,o.rR)("grafana_logs_download_clicked",{app:this.props.app,format:"csv"}),(0,R.EM)(V,N,{useExcelHeader:this.state.downloadForExcel},B)}getProcessedData(){const{options:W,panelPluginId:w,fieldConfig:N,timeZone:B}=this.props,V=this.state.transformedData;if(!W.withFieldConfig)return(0,a.K3)(V);let K=N??{defaults:{},overrides:[]};return w==="table"&&N&&(K=this.cleanTableConfigFromFieldConfig(N)),(0,a.we)({data:V,theme:m.config.theme2,fieldConfig:K,timeZone:B,replaceVariables:(H,X,k)=>(0,h.w)().replace(H,X,k)})}cleanTableConfigFromFieldConfig(W){W=(0,n.cloneDeep)(W),W.defaults.custom={};for(const w of W.overrides)for(const N of w.properties)if(N.id.startsWith("custom.")){const B=w.properties.indexOf(N);w.properties.slice(B,1)}return W}renderActions(W,w,N,B){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.$n,{variant:"primary",onClick:()=>this.exportCsv(W,w),size:"sm",children:(0,t.jsx)(y.x6,{i18nKey:"dashboard.inspect-data.download-csv",children:"Download CSV"})}),w&&(0,t.jsx)(g.$n,{variant:"primary",onClick:this.onExportLogsAsTxt,size:"sm",children:(0,t.jsx)(y.x6,{i18nKey:"dashboard.inspect-data.download-logs",children:"Download logs"})}),N&&(0,t.jsx)(g.$n,{variant:"primary",onClick:this.onExportTracesAsJson,size:"sm",children:(0,t.jsx)(y.x6,{i18nKey:"dashboard.inspect-data.download-traces",children:"Download traces"})}),B&&(0,t.jsx)(g.$n,{variant:"primary",onClick:this.onExportServiceGraph,size:"sm",children:(0,t.jsx)(y.x6,{i18nKey:"dashboard.inspect-data.download-service",children:"Download service graph"})})]})}render(){const{isLoading:W,options:w,data:N,formattedDataDescription:B,onOptionsChange:V,hasTransformations:K}=this.props,{dataFrameIndex:H,transformationOptions:X,selectedDataFrame:k,downloadForExcel:Y}=this.state,Z=(0,T.c)();if(W)return(0,t.jsxs)("div",{children:[(0,t.jsx)(l.y,{inline:!0})," Loading"]});const se=this.getProcessedData();if(!se||!se.length)return(0,t.jsx)("div",{children:"No Data"});const j=se[H]?H:0,q=se[j],ne=se.some(te=>te?.meta?.preferredVisualisationType==="logs"),oe=se.some(te=>te?.meta?.preferredVisualisationType==="trace"),z=se.some(te=>te?.meta?.preferredVisualisationType==="nodeGraph");return(0,t.jsxs)("div",{className:Z.wrap,"aria-label":c.Tp.components.PanelInspector.Data.content,children:[(0,t.jsx)("div",{className:Z.toolbar,children:(0,t.jsx)(b,{data:N,hasTransformations:K,options:w,dataFrames:se,transformationOptions:X,selectedDataFrame:k,downloadForExcel:Y,formattedDataDescription:B,onOptionsChange:V,onDataFrameChange:this.onDataFrameChange,toggleDownloadForExcel:this.onToggleDownloadForExcel,actions:this.renderActions(se,ne,oe,z)})}),(0,t.jsx)("div",{className:Z.content,children:(0,t.jsx)(s.Ay,{children:({width:te,height:le})=>te===0?null:(0,t.jsx)(p.X,{width:te,height:le,data:q,showTypeIcons:!0})})})]})}}function L(){return[{value:r.F.joinByField,label:(0,y.t)("dashboard.inspect-data.transformation","Series joined by time"),transformer:{id:r.F.joinByField,options:{byField:void 0}}}]}},32067:(G,O,e)=>{"use strict";e.d(O,{N:()=>m});var t=e(74848),n=e(32196),i=e(13544),s=e(8484),r=e(57875),f=e(11261),a=e(83195),c=e(40845);const o=({timeZone:d,name:v,stats:u})=>{const D=(0,c.$j)(),P=(0,c.of)(g);return!u||!u.length?null:(0,t.jsxs)("div",{className:P.wrapper,children:[(0,t.jsx)("div",{className:P.heading,children:v}),(0,t.jsx)("table",{className:"filter-table width-30",children:(0,t.jsx)("tbody",{children:u.map((x,E)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:x.displayName}),(0,t.jsx)("td",{className:P.cell,children:h(x,d,D)})]},`${x.displayName}-${E}`))})})]})};function h(d,v,u){const D=(0,r.J)({field:{type:f.PU.number,config:d},theme:u,timeZone:v});return(0,a.cN)(D(d.value))}const g=d=>({heading:(0,n.css)({fontSize:d.typography.body.fontSize,marginBottom:d.spacing(1)}),wrapper:(0,n.css)({paddingBottom:d.spacing(2)}),cell:(0,n.css)({textAlign:"right"})}),l=({name:d,traceIds:v})=>{const u=(0,c.of)(p);return v.length===0?null:(0,t.jsxs)("div",{className:u.wrapper,children:[(0,t.jsx)("div",{className:u.heading,children:d}),(0,t.jsx)("table",{className:"filter-table width-30",children:(0,t.jsx)("tbody",{children:v.map((D,P)=>(0,t.jsx)("tr",{children:(0,t.jsx)("td",{children:D})},`${D}-${P}`))})})]})},p=d=>({heading:(0,n.css)({fontSize:d.typography.body.fontSize,marginBottom:d.spacing(1)}),wrapper:(0,n.css)({paddingBottom:d.spacing(2)}),cell:(0,n.css)({textAlign:"right"})}),m=({data:d,timeZone:v})=>{if(!d.request)return null;let u=[];const D=d.request.endTime?d.request.endTime-d.request.startTime:-1,P=d.timings?.dataProcessingTime||-1;let x=0;for(const I of d.series)x+=I.length;D>0&&u.push({displayName:(0,s.t)("dashboard.inspect-stats.request-time","Total request time"),value:D,unit:"ms"}),P>0&&u.push({displayName:(0,s.t)("dashboard.inspect-stats.processing-time","Data processing time"),value:P,unit:"ms"}),u.push({displayName:(0,s.t)("dashboard.inspect-stats.queries","Number of queries"),value:d.request.targets?.length??0}),u.push({displayName:(0,s.t)("dashboard.inspect-stats.rows","Total number rows"),value:x});let E=[];for(const I of d.series)I.meta&&I.meta.stats&&(E=E.concat(I.meta.stats));const C=(0,s.t)("dashboard.inspect-stats.table-title","Stats"),M=(0,s.t)("dashboard.inspect-stats.data-title","Data source stats"),S=(0,s.t)("dashboard.inspect-stats.data-traceids","Trace IDs");return(0,t.jsxs)("div",{"aria-label":i.Tp.components.PanelInspector.Stats.content,className:y,children:[(0,t.jsx)(o,{timeZone:v,name:C,stats:u}),(0,t.jsx)(o,{timeZone:v,name:M,stats:E}),(0,t.jsx)(l,{name:S,traceIds:d.traceIds??[]})]})},y=(0,n.css)`
  height: 100%;
  overflow-y: scroll;
`},90820:(G,O,e)=>{"use strict";e.d(O,{e:()=>d});var t=e(74848),n=e(32196),i=e(96540),s=e(64423),r=e(39070),f=e(13544),a=e(32264),c=e(67061),o=e(55852),h=e(10534),g=e(39558),l=e(24022),p=e(8484),m=e(27677),y=e(26323);class d extends i.PureComponent{constructor(u){super(u),this.subs=new s.yU,this.setFormattedJson=D=>{this.formattedJson=D},this.getTextForClipboard=()=>JSON.stringify(this.formattedJson,null,2),this.onToggleExpand=()=>{this.setState(D=>({...D,allNodesExpanded:!this.state.allNodesExpanded}))},this.onToggleMocking=()=>{this.setState(D=>({...D,isMocking:!this.state.isMocking}))},this.getNrOfOpenNodes=()=>this.state.allNodesExpanded===null?3:this.state.allNodesExpanded?20:1,this.state={executedQueries:[],allNodesExpanded:null,isMocking:!1,mockedResponse:"",response:{}}}componentDidMount(){this.subs.add(m.IB.getInspectorStream().subscribe({next:u=>{let D=!0;if(this.props.instanceId&&u?.requestId&&(D=u.requestId.startsWith(this.props.instanceId)),D)return this.onDataSourceResponse(u.response)}}))}componentDidUpdate(u){this.props.data!==u.data&&this.updateQueryList()}updateQueryList(){const{data:u}=this.props,D=u.series,P=[];if(D?.length){let x;D.forEach((E,C)=>{const M=E.meta?.executedQueryString;if(M){const S=E.refId||"?";x?.refId===S?(x.frames++,x.rows+=E.length):(x={refId:S,frames:0,rows:E.length,query:M},P.push(x))}})}this.setState({executedQueries:P})}componentWillUnmount(){this.subs.unsubscribe()}onDataSourceResponse(u){u.config?.hideFromInspector||(u={...u},u.headers&&delete u.headers,u.config&&(u.request=u.config,delete u.config,delete u.request.transformRequest,delete u.request.transformResponse,delete u.request.paramSerializer,delete u.request.jsonpCallbackParam,delete u.request.headers,delete u.request.requestId,delete u.request.inspect,delete u.request.retry,delete u.request.timeout),u.data&&(u.response=u.data,delete u.config,delete u.data,delete u.status,delete u.statusText,delete u.ok,delete u.url,delete u.redirected,delete u.type,delete u.$$config),this.setState({response:u}))}renderExecutedQueries(u){if(!u.length)return null;const D={refId:(0,n.css)`
        font-weight: ${a.$.theme.typography.weight.semibold};
        color: ${a.$.theme.colors.textBlue};
        margin-right: 8px;
      `};return(0,t.jsx)("div",{children:u.map(P=>(0,t.jsxs)(c.B,{gap:1,direction:"column",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("span",{className:D.refId,children:[P.refId,":"]}),P.frames>1&&(0,t.jsxs)("span",{children:[P.frames," frames, "]}),(0,t.jsxs)("span",{children:[P.rows," rows"]})]}),(0,t.jsx)("pre",{children:P.query})]},P.refId))})}render(){const{allNodesExpanded:u,executedQueries:D,response:P}=this.state,{onRefreshQuery:x,data:E}=this.props,C=this.getNrOfOpenNodes(),M=(0,y.A)(a.$.theme2),S=Object.keys(P).length>0,I=E.state===r.Gu.Loading;return(0,t.jsxs)("div",{className:M.wrap,children:[(0,t.jsxs)("div",{"aria-label":f.Tp.components.PanelInspector.Query.content,children:[(0,t.jsx)("h3",{className:M.heading,children:"Query inspector"}),(0,t.jsx)("p",{className:"small muted",children:(0,t.jsx)(p.x6,{i18nKey:"inspector.query.description",children:"Query inspector allows you to view raw request and response. To collect this data Grafana needs to issue a new query. Click refresh button below to trigger a new query."})})]}),this.renderExecutedQueries(D),(0,t.jsxs)("div",{className:M.toolbar,children:[(0,t.jsx)(o.$n,{icon:"sync",onClick:x,"aria-label":f.Tp.components.PanelInspector.Query.refreshButton,children:(0,t.jsx)(p.x6,{i18nKey:"inspector.query.refresh",children:"Refresh"})}),S&&u&&(0,t.jsx)(o.$n,{icon:"minus",variant:"secondary",className:M.toolbarItem,onClick:this.onToggleExpand,children:(0,t.jsx)(p.x6,{i18nKey:"inspector.query.collapse-all",children:"Collapse all"})}),S&&!u&&(0,t.jsx)(o.$n,{icon:"plus",variant:"secondary",className:M.toolbarItem,onClick:this.onToggleExpand,children:(0,t.jsx)(p.x6,{i18nKey:"inspector.query.expand-all",children:"Expand all"})}),S&&(0,t.jsx)(h.b,{getText:this.getTextForClipboard,className:M.toolbarItem,icon:"copy",variant:"secondary",children:(0,t.jsx)(p.x6,{i18nKey:"inspector.query.copy-to-clipboard",children:"Copy to clipboard"})}),(0,t.jsx)("div",{className:"flex-grow-1"})]}),(0,t.jsxs)("div",{className:M.content,children:[I&&(0,t.jsx)(g._,{text:"Loading query inspector..."}),!I&&S&&(0,t.jsx)(l.B,{json:P,open:C,onDidRender:this.setFormattedJson}),!I&&!S&&(0,t.jsx)("p",{className:"muted",children:(0,t.jsx)(p.x6,{i18nKey:"inspector.query.no-data",children:"No request and response collected yet. Hit refresh button"})})]})]})}}},26323:(G,O,e)=>{"use strict";e.d(O,{A:()=>r,c:()=>s});var t=e(32196),n=e(3911),i=e(2913);const s=(0,n.N)(()=>r(i.config.theme2)),r=f=>({heading:(0,t.css)({fontSize:f.typography.body.fontSize,marginBottom:f.spacing(1)}),wrap:(0,t.css)({display:"flex",flexDirection:"column",height:"100%",width:"100%",flex:"1 1 0",minHeight:0}),toolbar:(0,t.css)({display:"flex",width:"100%",flexGrow:0,alignItems:"center",justifyContent:"flex-end",marginBottom:f.v1.spacing.sm}),toolbarItem:(0,t.css)({marginLeft:f.v1.spacing.md}),content:(0,t.css)({flexGrow:1,height:"100%"}),editor:(0,t.css)({fontFamily:"monospace",height:"100%",flexGrow:1}),viewer:(0,t.css)({overflow:"scroll"}),dataFrameSelect:(0,t.css)({flexGrow:2}),leftActions:(0,t.css)({display:"flex",flexGrow:1,maxWidth:"85%","@media (max-width: 1345px)":{maxWidth:"75%"}}),options:(0,t.css)({paddingTop:f.v1.spacing.sm}),dataDisplayOptions:(0,t.css)({flexGrow:1,minWidth:"300px",marginRight:f.v1.spacing.sm}),selects:(0,t.css)({display:"flex","> *":{marginRight:f.v1.spacing.sm}})})},16560:(G,O,e)=>{"use strict";e.d(O,{q:()=>t});var t=(n=>(n.Data="data",n.Meta="meta",n.Error="error",n.Stats="stats",n.JSON="json",n.Query="query",n.Help="help",n))(t||{})},18358:(G,O,e)=>{"use strict";e.d(O,{ny:()=>U,EM:()=>L,Zy:()=>A,ek:()=>W});var t=e(4213),n=e.n(t),i=e(72724),s=e(18282),r=e(72436),f=e(37471),a=e(19071),c=e(2543);const h=Object.defineProperty({archiveEnabled:!1,dependencies:{dagMaxNumServices:100,menuEnabled:!0},linkPatterns:[],search:{maxLookback:{label:"2 Days",value:"2d"},maxLimit:1500},tracking:{gaID:null,trackErrors:!0}},"__mergeFields",{value:["dependencies","search","tracking"]});function g(){return defaultConfig}function l(w){return _get(g(),w)}function p(w){let N;const B=new Set(w.map(({spanID:V})=>V));for(let V=0;V<w.length;V++){if(w[V].references&&w[V].references.some(({traceID:k,spanID:Y})=>k===w[V].traceID&&B.has(Y)))continue;if(!N){N=w[V];continue}const H=w[V].references&&w[V].references.length||0,X=N.references&&N.references.length||0;(H<X||H===X&&w[V].startTime<N.startTime)&&(N=w[V])}return N?`${N.process.serviceName}: ${N.operationName}`:""}const m=(0,c.memoize)(p,w=>w.length?w[0].traceID:0);function y(w){const N=new Map,B=w.reduce((K,H)=>(K.some(X=>X.key===H.key&&X.value===H.value)?N.set(`${H.key}:${H.value}`,`Duplicate tag "${H.key}:${H.value}"`):K.push(H),K),[]),V=Array.from(N.values());return{dedupedTags:B,warnings:V}}function d(w,N){const B=w?.slice()??[],V=(N||[]).map(K=>K.toLowerCase());return B.sort((K,H)=>{const X=K.key.toLowerCase(),k=H.key.toLowerCase();for(let Y=0;Y<V.length;Y++){const Z=V[Y];if(X.startsWith(Z)&&!k.startsWith(Z))return-1;if(!X.startsWith(Z)&&k.startsWith(Z))return 1}return X>k?1:X<k?-1:0}),B}function v(w){if(!w?.traceID)return null;const N=w.traceID.toLowerCase();let B=0,V=Number.MAX_SAFE_INTEGER;const K=new Map,H=new Map;w.spans=w.spans.filter(q=>!!q.startTime),w.processes=Object.entries(w.processes).reduce((q,[ne,oe])=>(q[ne]={...oe,tags:d(oe.tags)},q),{});const X=w.spans.length;for(let q=0;q<X;q++){const ne=w.spans[q],{startTime:oe,duration:z,processID:te}=ne;let le=ne.spanID;oe<V&&(V=oe),oe+z>B&&(B=oe+z);const ie=K.get(le);ie!=null?(console.warn(`Dupe spanID, ${ie+1} x ${le}`,ne,H.get(le)),_isEqual(ne,H.get(le))&&console.warn("	 two spans with same ID have `isEqual(...) === true`"),K.set(le,ie+1),le=`${le}_${ie}`,ne.spanID=le):K.set(le,1),ne.process=w.processes[te],H.set(le,ne)}const k=getTraceSpanIdsAsTree(w,H),Y=[],Z={};k.walk((q,ne,oe=0)=>{if(q==="__root__"||typeof q!="string")return;const z=H.get(q);if(!z)return;const{serviceName:te}=z.process;Z[te]=(Z[te]||0)+1,z.relativeStartTime=z.startTime-V,z.depth=oe-1,z.hasChildren=ne.children.length>0,z.childSpanCount=ne.children.length,z.warnings=z.warnings||[],z.tags=z.tags||[],z.references=z.references||[],z.childSpanIds=ne.children.slice().sort((ie,ae)=>{const re=H.get(ie.value),ce=H.get(ae.value);return ce.startTime+ce.duration-(re.startTime+re.duration)}).map(ie=>ie.value);const le=y(z.tags);z.tags=d(le.dedupedTags,getConfigValue("topTagPrefixes")),z.warnings=z.warnings.concat(le.warnings),z.references.forEach((ie,ae)=>{const re=H.get(ie.spanID);re&&(ie.span=re,ae>0&&(re.subsidiarilyReferencedBy=re.subsidiarilyReferencedBy||[],re.subsidiarilyReferencedBy.push({spanID:q,traceID:N,span:z,refType:ie.refType})))}),Y.push(z)});const se=getTraceName(Y);return{services:Object.keys(Z).map(q=>({name:q,numberOfSpans:Z[q]})),spans:Y,traceID:N,traceName:se,processes:w.processes,duration:B-V,startTime:V,endTime:B}}function u(w){const N=w.spans.map(V=>D(V,w.processes)),B=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string},{name:"spanID",type:FieldType.string},{name:"parentSpanID",type:FieldType.string},{name:"operationName",type:FieldType.string},{name:"serviceName",type:FieldType.string},{name:"serviceTags",type:FieldType.other},{name:"startTime",type:FieldType.number},{name:"duration",type:FieldType.number},{name:"logs",type:FieldType.other},{name:"tags",type:FieldType.other},{name:"warnings",type:FieldType.other},{name:"stackTraces",type:FieldType.other}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"jaeger"}}});for(const V of N)B.add(V);return B}function D(w,N){return{spanID:w.spanID,traceID:w.traceID,parentSpanID:w.references?.find(B=>B.refType==="CHILD_OF")?.spanID,operationName:w.operationName,startTime:w.startTime/1e3,duration:w.duration/1e3,logs:w.logs.map(B=>({...B,timestamp:B.timestamp/1e3})),tags:w.tags,warnings:w.warnings??void 0,stackTraces:w.stackTraces,serviceName:N[w.processID].serviceName,serviceTags:N[w.processID].tags}}function P(w,N){const B=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string,config:{unit:"string",displayNameFromDS:"Trace ID",links:[{title:"Trace: ${__value.raw}",url:"",internal:{datasourceUid:N.uid,datasourceName:N.name,query:{query:"${__value.raw}"}}}]}},{name:"traceName",type:FieldType.string,config:{displayNameFromDS:"Trace name"}},{name:"startTime",type:FieldType.time,config:{displayNameFromDS:"Start time"}},{name:"duration",type:FieldType.number,config:{displayNameFromDS:"Duration",unit:"\xB5s"}}],meta:{preferredVisualisationType:"table"}}),V=w.map(x).sort((K,H)=>H?.startTime-K?.startTime);for(const K of V)B.add(K);return B}function x(w){const N=transformTraceData(w);if(N)return{traceID:N.traceID,startTime:N.startTime/1e3,duration:N.duration,traceName:N.traceName}}function E(w){let N={traceID:"",spans:[],processes:{},warnings:null},B=[];for(let V=0;V<w.length;V++){const K=w.get(V);N.traceID||(N.traceID=K.traceID),B.find(H=>H===K.serviceName)||(B.push(K.serviceName),N.processes[`p${B.length}`]={serviceName:K.serviceName,tags:K.serviceTags}),N.spans.push({traceID:K.traceID,spanID:K.spanID,duration:K.duration*1e3,references:K.parentSpanID?[{refType:"CHILD_OF",spanID:K.parentSpanID,traceID:K.traceID}]:[],flags:0,logs:K.logs.map(H=>({...H,timestamp:H.timestamp*1e3})),operationName:K.operationName,processID:Object.keys(N.processes).find(H=>N.processes[H].serviceName===K.serviceName)||"",startTime:K.startTime*1e3,tags:K.tags,warnings:K.warnings?K.warnings:null})}return{data:[N],total:0,limit:0,offset:0,errors:null}}function C(w){const N=w.map(M),B=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string,values:[]},{name:"spanID",type:FieldType.string,values:[]},{name:"parentSpanID",type:FieldType.string,values:[]},{name:"operationName",type:FieldType.string,values:[]},{name:"serviceName",type:FieldType.string,values:[]},{name:"serviceTags",type:FieldType.other,values:[]},{name:"startTime",type:FieldType.number,values:[]},{name:"duration",type:FieldType.number,values:[]},{name:"logs",type:FieldType.other,values:[]},{name:"tags",type:FieldType.other,values:[]}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"zipkin"}}});for(const V of N)B.add(V);return B}function M(w){const N={traceID:w.traceId,spanID:w.id,parentSpanID:w.parentId,operationName:w.name,serviceName:w.localEndpoint?.serviceName||w.remoteEndpoint?.serviceName||"unknown",serviceTags:I(w),startTime:w.timestamp/1e3,duration:w.duration/1e3,logs:w.annotations?.map(S)??[],tags:Object.keys(w.tags||{}).reduce((B,V)=>V==="error"?(B.push({key:"error",value:!0}),B.push({key:"errorValue",value:w.tags.error}),B):(B.push({key:V,value:w.tags[V]}),B),[])};return w.kind&&(N.tags=[{key:"kind",value:w.kind},...N.tags??[]]),w.shared&&(N.tags=[{key:"shared",value:w.shared},...N.tags??[]]),N}function S(w){return{timestamp:w.timestamp,fields:[{key:"annotation",value:w.value}]}}function I(w){const N=w.localEndpoint||w.remoteEndpoint;return N?[T("ipv4",N.ipv4),T("ipv6",N.ipv6),T("port",N.port),T("endpointType",w.localEndpoint?"local":"remote")].filter(B=>!!B):[]}function T(w,N){if(N)return{key:w,value:N}}const b=w=>{let N=[];for(let B=0;B<w.length;B++){const V=w.get(B);N.push({traceId:V.traceID,parentId:V.parentSpanID,name:V.operationName,id:V.spanID,timestamp:V.startTime*1e3,duration:V.duration*1e3,...R(V),annotations:V.logs.length?V.logs.map(K=>({timestamp:K.timestamp,value:K.fields[0].value})):void 0,tags:V.tags.length?V.tags.filter(K=>K.key!=="kind"&&K.key!=="endpointType"&&K.key!=="shared").reduce((K,H)=>H.key==="error"?{...K,[H.key]:V.tags.find(X=>X.key==="errorValue").value||""}:{...K,[H.key]:H.value},{}):void 0,kind:V.tags.find(K=>K.key==="kind")?.value,shared:V.tags.find(K=>K.key==="shared")?.value})}return N},R=w=>{const N=w.serviceTags.find(B=>B.key==="endpointType")?.value==="local"?"localEndpoint":"remoteEndpoint";return w.serviceName!=="unknown"?{[N]:{serviceName:w.serviceName,ipv4:w.serviceTags.find(B=>B.key==="ipv4")?.value,ipv6:w.serviceTags.find(B=>B.key==="ipv6")?.value,port:w.serviceTags.find(B=>B.key==="port")?.value}}:void 0};function A(w,N){let B="";w.meta?.forEach(H=>{const X=`${H.label}: ${JSON.stringify(H.value)}
`;B=B+X}),B=B+`

`,w.rows.forEach(H=>{const X=(0,i.LE)(H.timeEpochMs,{defaultWithMS:!0})+"	"+H.entry+`
`;B=B+X});const V=new Blob([B],{type:"text/plain;charset=utf-8"}),K=`${N}-logs-${(0,i.LE)(new Date)}.txt`;n()(V,K)}function L(w,N,B,V=s.F.noop){const K=(0,r._O)([w],B),H=B?.useExcelHeader?"\uFEFF":"",X=new Blob([H,K],{type:"text/csv;charset=utf-8"}),k=V!==s.F.noop?"-as-"+V.toLocaleLowerCase():"",Y=`${N}-data${k}-${(0,i.LE)(new Date)}.csv`;n()(X,Y)}function U(w,N){const B=new Blob([JSON.stringify(w)],{type:"application/json"}),V=`${N}-${(0,i.LE)(new Date)}.json`;n()(B,V)}function W(w,N){let B="otlp";switch(w.meta?.custom?.traceFormat){case"jaeger":{let V=E(new f.k(w));U(V,N),B="jaeger";break}case"zipkin":{let V=b(new f.k(w));U(V,N),B="zipkin";break}case"otlp":default:{let V=(0,a.xw)(new f.k(w));U(V,N);break}}return B}},77938:(G,O,e)=>{"use strict";e.d(O,{p:()=>i});var t=e(26272),n=e(28138);function i(r){let f="";try{f=JSON.stringify(r,s(),2)}catch(a){a instanceof Error&&(a.toString().includes("RangeError")||a.toString().includes("allocation size overflow"))?n.A.emit(t.r1.alertError,[a.toString(),"Cannot display JSON, the object is too big."]):n.A.emit(t.r1.alertError,[a instanceof Error?a.toString():a])}return f}function s(){const r=new WeakSet;return(f,a)=>{if(f==="__dataContext"||f==="__sceneObject")return"Filtered out in JSON serialization";if(typeof a=="object"&&a!==null){if(r.has(a))return;r.add(a)}return a}}},47259:(G,O,e)=>{"use strict";e.d(O,{G7:()=>s,KU:()=>r,eb:()=>f});var t=e(17172),n=e(10096),i=e(31678);const s=(0,i.createAsyncThunk)("users/fetchInvitees",async()=>n.TP.hasPermission(i.AccessControlAction.OrgUsersAdd)?await(0,t.AI)().get("/api/org/invites"):[]),r=(0,i.createAsyncThunk)("users/addInvitee",async(a,{dispatch:c})=>{await(0,t.AI)().post("/api/org/invites",a),await c(s())}),f=(0,i.createAsyncThunk)("users/revokeInvite",async a=>(await(0,t.AI)().patch(`/api/org/invites/${a}/revoke`,{}),a))},40823:(G,O,e)=>{"use strict";e.d(O,{Ay:()=>c,Tp:()=>s});var t=e(65307),n=e(47259);const i=(0,t.pU)({selectId:o=>o.code}),s=i.getSelectors(),r=i.getInitialState({status:"idle"}),c={invites:(0,t.Z0)({name:"invites",initialState:r,reducers:{},extraReducers:o=>{o.addCase(n.G7.pending,h=>{h.status="loading"}).addCase(n.G7.fulfilled,(h,{payload:g})=>{i.setAll(h,g),h.status="succeeded"}).addCase(n.G7.rejected,h=>{h.status="failed"}).addCase(n.eb.fulfilled,(h,{payload:g})=>{i.removeOne(h,g),h.status="succeeded"})}}).reducer}},96227:(G,O,e)=>{"use strict";e.d(O,{b:()=>m,o:()=>y});var t=e(74848),n=e(96540),i=e(40996),s=e(16817),r=e(17172),f=e(88575),a=e(10354),c=e(37390),o=e(55852),h=e(36607),g=e(8484),l=e(57767),p=e(88861);const m=({panel:d,initialFolderUid:v,onCreateLibraryPanel:u,onDismiss:D})=>{const[P,x]=(0,n.useState)(v),[E,C]=(0,n.useState)(d.title),[M,S]=(0,n.useState)(d.title),[I,T]=(0,n.useState)(!1);(0,n.useEffect)(()=>T(!0),[E]),(0,i.A)(()=>S(E),350,[E]);const{saveLibraryPanel:b}=(0,p.b)(),R=(0,n.useCallback)(()=>{d.libraryPanel={uid:"",name:E},b(d,P).then(U=>{(0,r.NF)(U)?d.libraryPanel=void 0:(D?.(),u?.(U))})},[d,E,b,P,D,u]),A=(0,s.A)(async()=>{try{return!(await(0,l.e9)(E)).some(U=>U.folderUid===P)}catch(U){return(0,r.NF)(U)&&(U.isHandled=!0),!0}finally{T(!1)}},[M,P]);console.log("isValidName:",A);const L=!A?.value&&A.value!==void 0&&E===M&&!I;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.D,{label:(0,g.t)("library-panel.add-modal.name","Library panel name"),invalid:L,error:L?(0,g.t)("library-panel.add-modal.error","Library panel with this name already exists"):"",children:(0,t.jsx)(a.p,{id:"share-panel-library-panel-name-input",name:"name",value:E,onChange:U=>C(U.currentTarget.value)})}),(0,t.jsx)(f.D,{label:(0,g.t)("library-panel.add-modal.folder","Save in folder"),description:(0,g.t)("library-panel.add-modal.folder-description","Library panel permissions are derived from the folder permissions"),children:(0,t.jsx)(h.d,{onChange:U=>x(U),value:P,inputId:"share-panel-library-panel-folder-picker"})}),(0,t.jsxs)(c.a.ButtonRow,{children:[(0,t.jsx)(o.$n,{variant:"secondary",onClick:D,fill:"outline",children:(0,t.jsx)(g.x6,{i18nKey:"library-panel.add-modal.cancel",children:"Cancel"})}),(0,t.jsx)(o.$n,{onClick:R,disabled:L,children:(0,t.jsx)(g.x6,{i18nKey:"library-panel.add-modal.create",children:"Create library panel"})})]})]})},y=({isOpen:d=!1,panel:v,initialFolderUid:u,...D})=>(0,t.jsx)(c.a,{title:"Create library panel",isOpen:d,onDismiss:D.onDismiss,children:(0,t.jsx)(m,{panel:v,initialFolderUid:u,onDismiss:D.onDismiss})})},86474:(G,O,e)=>{"use strict";e.d(O,{E:()=>R});var t=e(74848),n=e(32196),i=e(96540),s=e(70255),r=e(32264),f=e(40845),a=e(14578),c=e(50720),o=e(72129),h=e(41394),g=e(25701),l=e(39070),p=e(37390),m=e(55852),y=e(43535),d=e(16547),v=e(57767),u=e(65307);const D={loadingState:l.Gu.Loading,dashboardTitles:[]},P=(0,u.VP)("libraryPanels/delete/searchCompleted"),x=(U=D,W)=>P.match(W)?{...U,dashboardTitles:W.payload.dashboards.map(w=>w.title),loadingState:l.Gu.Done}:U;function E(U){return async function(W){const w=await(0,v.xV)(U.uid);W(P({dashboards:w}))}}const C=({libraryPanel:U,onDismiss:W,onConfirm:w})=>{const N=(0,f.of)(y.o),[{dashboardTitles:B,loadingState:V},K]=(0,i.useReducer)(x,D),H=(0,i.useMemo)(()=>(0,d.QC)(K),[K]);(0,i.useEffect)(()=>{H(E(U))},[H,U]);const X=!!B.length,k=V===l.Gu.Done;return(0,t.jsxs)(p.a,{className:N.modal,title:"Delete library panel",icon:"trash-alt",onDismiss:W,isOpen:!0,children:[k?null:(0,t.jsx)(M,{}),k?(0,t.jsxs)("div",{children:[X?(0,t.jsx)(I,{dashboardTitles:B}):null,X?null:(0,t.jsx)(S,{}),(0,t.jsxs)(p.a.ButtonRow,{children:[(0,t.jsx)(m.$n,{variant:"secondary",onClick:W,fill:"outline",children:"Cancel"}),(0,t.jsx)(m.$n,{variant:"destructive",onClick:w,disabled:X,children:"Delete"})]})]}):null]})},M=()=>(0,t.jsx)("span",{children:"Loading library panel..."}),S=()=>{const U=(0,f.of)(y.o);return(0,t.jsx)("div",{className:U.modalText,children:"Do you want to delete this panel?"})},I=({dashboardTitles:U})=>{const W=(0,f.of)(y.o),w=U.length===1?"dashboard.":"dashboards.",N=`${U.length} ${w}`;return U.length===0?null:(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:W.textInfo,children:["This library panel can not be deleted because it is connected to ",(0,t.jsx)("strong",{children:N})," Remove the library panel from the dashboards listed below and retry."]}),(0,t.jsxs)("table",{className:W.myTable,children:[(0,t.jsx)("thead",{children:(0,t.jsx)("tr",{children:(0,t.jsx)("th",{children:"Dashboard name"})})}),(0,t.jsx)("tbody",{children:U.map((B,V)=>(0,t.jsx)("tr",{children:(0,t.jsx)("td",{children:B})},`dash-title-${V}`))})]})]})},T=({libraryPanel:U,onClick:W,onDelete:w,showSecondaryActions:N})=>{const[B,V]=(0,i.useState)(!1),K=()=>{w?.(U),V(!1)},H=r.$.panels[U.model.type]??(0,h.$)(U.model.type).meta;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.b,{isCurrent:!1,title:U.name,description:U.description,plugin:H,onClick:()=>W?.(U),onDelete:N?()=>V(!0):void 0,children:(0,t.jsx)(A,{libraryPanel:U})}),B&&(0,t.jsx)(C,{libraryPanel:U,onConfirm:K,onDismiss:()=>V(!1)})]})},b=({showSecondaryActions:U,rootProps:W})=>{const w=(0,f.of)(L);return(0,t.jsx)(g.b.Skeleton,{hasDelete:U,...W,children:(0,t.jsx)(s.A,{containerClassName:w.metaContainer,width:80})})},R=(0,o.j)(T,b);function A({libraryPanel:U}){const W=(0,f.of)(L);return!U.meta?.folderUid&&!U.meta?.folderName?null:U.meta.folderUid?(0,t.jsx)("span",{className:W.metaContainer,children:(0,t.jsxs)(c.N,{href:`/dashboards/f/${U.meta.folderUid}`,children:[(0,t.jsx)(a.I,{name:"folder-upload",size:"sm"}),(0,t.jsx)("span",{children:U.meta.folderName})]})}):(0,t.jsxs)("span",{className:W.metaContainer,children:[(0,t.jsx)(a.I,{name:"folder",size:"sm"}),(0,t.jsx)("span",{children:"Dashboards"})]})}function L(U){return{metaContainer:(0,n.css)({display:"flex",alignItems:"center",color:U.colors.text.secondary,fontSize:U.typography.bodySmall.fontSize,paddingTop:U.spacing(.5),svg:{marginRight:U.spacing(.5),marginBottom:3}})}}},16678:(G,O,e)=>{"use strict";e.d(O,{j:()=>M,s:()=>C});var t=e(74848),n=e(32196),i=e(96540),s=e(40996),r=e(40845),f=e(66864),a=e(67647),c=e(76459),o=e.n(c),h=e(55852),g=e(90182),l=e(14578),p=e(27677),m=e(64161),y=e(31678);function d({onChange:b,maxMenuHeight:R}){const A=(0,r.of)(u),[L,U]=(0,i.useState)(!1),W=(0,i.useCallback)(K=>v(K,U),[]),w=(0,i.useMemo)(()=>o()(W,300),[W]),[N,B]=(0,i.useState)([]),V=(0,i.useCallback)(K=>{const H=K.filter(X=>!!X.value).map(X=>X.value);b(H),B(K)},[b]);return(0,t.jsxs)("div",{className:A.container,children:[N.length>0&&(0,t.jsx)(h.$n,{size:"xs",icon:"trash-alt",fill:"text",className:A.clear,onClick:()=>b([]),"aria-label":"Clear folders",children:"Clear folders"}),(0,t.jsx)(g.Iv,{value:N,onChange:V,isLoading:L,loadOptions:w,maxMenuHeight:R,placeholder:"Filter by folder",noOptionsMessage:"No folders found",prefix:(0,t.jsx)(l.I,{name:"filter"}),"aria-label":"Folder filter",defaultOptions:!0})]})}async function v(b,R){R(!0);const A={query:b,type:m.G.DashFolder,permission:y.PermissionLevelString.View},U=(await(0,p.AI)().search(A)).map(W=>({label:W.title,value:{uid:W.uid,title:W.title}}));return(!b||"dashboards".includes(b.toLowerCase()))&&U.unshift({label:"Dashboards",value:{uid:"general",title:"Dashboards"}}),R(!1),U}function u(b){return{container:(0,n.css)({label:"container",position:"relative",minWidth:"180px",flexGrow:1}),clear:(0,n.css)({label:"clear",fontSize:b.spacing(1.5),position:"absolute",top:-b.spacing(4.5),right:0})}}var D=e(68313),P=e(73725),x=e(15054),E=e(83791),C=(b=>(b.Tight="tight",b.Spacious="spacious",b))(C||{});const M=({onClick:b,variant:R="spacious",currentPanelId:A,currentFolderUID:L,perPage:U=x.FG,showPanelFilter:W=!1,showFolderFilter:w=!1,showSort:N=!1,showSecondaryActions:B=!1})=>{const V=(0,r.of)(S,R),[K,H]=(0,i.useState)(""),[X,k]=(0,i.useState)("");(0,s.A)(()=>k(K),200,[K]);const[Y,Z]=(0,i.useState)({}),[se,j]=(0,i.useState)(L?[L]:[]),[q,ne]=(0,i.useState)([]),oe=N||W||w,z=R==="tight"?"lg":"xs";return(0,t.jsx)("div",{className:V.container,children:(0,t.jsxs)(f.gW,{spacing:z,children:[(0,t.jsxs)("div",{className:(0,n.cx)(V.gridContainer,{[V.tightLayout]:R==="tight"}),children:[(0,t.jsx)("div",{className:V.filterInputWrapper,children:(0,t.jsx)(a.Z,{value:K,onChange:H,placeholder:"Search by name or description",width:0,escapeRegex:!1})}),oe&&(0,t.jsx)(I,{showSort:N,showPanelFilter:W,showFolderFilter:w,onSortChange:Z,onFolderFilterChange:j,onPanelFilterChange:ne,sortDirection:Y.value,variant:R})]}),(0,t.jsx)("div",{className:V.libraryPanelsView,children:(0,t.jsx)(E.y,{onClickCard:b,searchString:X,sortDirection:Y.value,panelFilter:q,folderFilter:se,currentPanelId:A,showSecondaryActions:B,perPage:U})})]})})};function S(b,R){return{filterInputWrapper:(0,n.css)({flexGrow:R==="tight"?1:"initial"}),container:(0,n.css)({width:"100%",overflowY:"auto",padding:b.spacing(1)}),libraryPanelsView:(0,n.css)({width:"100%"}),gridContainer:(0,n.css)({display:"flex",flexDirection:"column",width:"100%",columnGap:b.spacing(1),rowGap:b.spacing(1),paddingBottom:b.spacing(2)}),tightLayout:(0,n.css)({flexDirection:"row",rowGap:b.spacing(1)})}}const I=(0,i.memo)(({variant:b="spacious",showSort:R,showPanelFilter:A,showFolderFilter:L,sortDirection:U,onSortChange:W,onFolderFilterChange:w,onPanelFilterChange:N})=>{const B=(0,r.of)(T),V=(0,i.useCallback)(H=>N(H.map(X=>X.id)),[N]),K=(0,i.useCallback)(H=>w(H.map(X=>X.uid??"")),[w]);return(0,t.jsxs)("div",{className:(0,n.cx)(B.container,{[B.containerTight]:b==="tight"}),children:[R&&(0,t.jsx)(P.r,{value:U,onChange:W,filter:["alpha-asc","alpha-desc"]}),(L||A)&&(0,t.jsxs)("div",{className:(0,n.cx)(B.filterContainer,{[B.filterContainerTight]:b==="tight"}),children:[L&&(0,t.jsx)(d,{onChange:K}),A&&(0,t.jsx)(D.$,{onChange:V})]})]})});I.displayName="SearchControls";function T(b){return{container:(0,n.css)({display:"flex",gap:b.spacing(1),flexGrow:1,flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap"}),containerTight:(0,n.css)({flexGrow:"initial",flexDirection:"column",justifyContent:"normal"}),filterContainer:(0,n.css)({display:"flex",flexDirection:"row",gap:b.spacing(1)}),filterContainerTight:(0,n.css)({flexDirection:"column",marginLeft:"initial"})}}},83791:(G,O,e)=>{"use strict";e.d(O,{y:()=>y});var t=e(74848),n=e(32196),i=e(96540),s=e(40996),r=e(39070),f=e(40845),a=e(69529),c=e(72109),o=e(67061),h=e(19384),g=e(8484),l=e(86474),p=e(16547),m=e(8184);const y=({onClickCard:v,searchString:u,sortDirection:D,panelFilter:P,folderFilter:x,showSecondaryActions:E,currentPanelId:C,perPage:M=40,isWidget:S})=>{const I=(0,f.of)(d),[{libraryPanels:T,page:b,perPage:R,numberOfPages:A,loadingState:L,currentPanelId:U},W]=(0,i.useReducer)(m.w_,{...m.Xb,currentPanelId:C,perPage:M}),w=(0,i.useMemo)(()=>(0,p.QC)(W),[W]);(0,s.A)(()=>w((0,p.IF)({searchString:u,sortDirection:D,panelFilter:P,folderFilterUIDs:x,page:b,perPage:R,currentPanelId:U,isWidget:S})),300,[u,D,P,x,b,w]);const N=({uid:K})=>w((0,p.h4)(K,{searchString:u,sortDirection:D,panelFilter:P,folderFilterUIDs:x,page:b,perPage:R})),B=K=>w((0,m.yd)({page:K}));return!(u||P?.length||x?.length)&&L===r.Gu.Done&&T.length<1?(0,t.jsx)(a.p,{variant:"call-to-action",message:(0,g.t)("library-panel.empty-state.message","You haven't created any library panels yet"),children:(0,t.jsxs)(g.x6,{i18nKey:"library-panel.empty-state.more-info",children:["Create a library panel from any existing dashboard panel through the panel context menu."," ",(0,t.jsx)(c.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/manage-library-panels/#create-a-library-panel",children:"Learn more"})]})}):(0,t.jsxs)(o.B,{direction:"column",wrap:"nowrap",children:[L===r.Gu.Loading?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.E.Skeleton,{showSecondaryActions:E}),(0,t.jsx)(l.E.Skeleton,{showSecondaryActions:E}),(0,t.jsx)(l.E.Skeleton,{showSecondaryActions:E})]}):T.length<1?(0,t.jsx)(a.p,{variant:"not-found",message:(0,g.t)("library-panels.empty-state.message","No library panels found")}):T?.map((K,H)=>(0,t.jsx)(l.E,{libraryPanel:K,onDelete:N,onClick:v,showSecondaryActions:E},`library-panel=${H}`)),T.length?(0,t.jsx)("div",{className:I.pagination,children:(0,t.jsx)(h.d,{currentPage:b,numberOfPages:A,onNavigate:B,hideWhenSinglePage:!0})}):null]})},d=v=>({pagination:(0,n.css)({alignSelf:"center",marginTop:v.spacing(1)})})},16547:(G,O,e)=>{"use strict";e.d(O,{IF:()=>d,QC:()=>u,h4:()=>v});var t=e(64423),n=e(65474),i=e(62467),s=e(44240),r=e(39697),f=e(69862),a=e(66847),c=e(69850),o=e(1005),h=e(65961),g=e(67791),l=e(32264),p=e(17706),m=e(57767),y=e(8184);function d(D){const P=(E,C)=>E.id===C.type,x=(E,C)=>{const M=(0,p.A4)();return E.filter(S=>{const I=M.find(T=>P(T,S));return C?!!I?.skipDataQuery:!I?.skipDataQuery})};return function(E){const C=new t.yU,M=(0,n.H)((0,m.dq)({searchString:D.searchString,perPage:D.perPage,page:D.page,excludeUid:D.currentPanelId,sortDirection:D.sortDirection,typeFilter:D.panelFilter,folderFilterUIDs:D.folderFilterUIDs})).pipe((0,f.Z)(S=>{const{elements:I}=S;if(l.$.featureToggles.vizAndWidgetSplit&&D.isWidget!==void 0){const T=x(I,D.isWidget);return(0,i.of)({...S,elements:T})}return(0,i.of)({...S,elements:I})}),(0,f.Z)(({perPage:S,elements:I,page:T,totalCount:b})=>(0,i.of)((0,y.c4)({libraryPanels:I,page:T,perPage:S,totalCount:b}))),(0,a.W)(S=>(console.error(S),(0,i.of)((0,y.c4)({...y.Xb,page:D.page,perPage:D.perPage})))),(0,c.j)(()=>C.unsubscribe()),(0,o.u)());C.add((0,s.h)((0,r.O)(50).pipe((0,h.u)((0,y.d9)()),(0,g.Q)(M)),M).subscribe(E))}}function v(D,P){return async function(x){try{await(0,m.h4)(D),d(P)(x)}catch(E){console.error(E)}}}function u(D){return function(P){return P instanceof Function?P(D):D(P)}}},8184:(G,O,e)=>{"use strict";e.d(O,{Xb:()=>i,c4:()=>r,d9:()=>s,w_:()=>a,yd:()=>f});var t=e(65307),n=e(39070);const i={loadingState:n.Gu.Loading,libraryPanels:[],totalCount:0,perPage:40,page:1,numberOfPages:0,currentPanelId:void 0},s=(0,t.VP)("libraryPanels/view/initSearch"),r=(0,t.VP)("libraryPanels/view/searchCompleted"),f=(0,t.VP)("libraryPanels/view/changePage"),a=(c,o)=>{if(s.match(o))return{...c,loadingState:n.Gu.Loading};if(r.match(o)){const{libraryPanels:h,page:g,perPage:l,totalCount:p}=o.payload,m=Math.ceil(p/l);return{...c,libraryPanels:h,perPage:l,totalCount:p,loadingState:n.Gu.Done,numberOfPages:m,page:g>m?g-1:g}}return f.match(o)?{...c,page:o.payload.page}:c}},82792:(G,O,e)=>{"use strict";e.d(O,{X:()=>t});function t(n){return!!n.libraryPanel?.uid}},57767:(G,O,e)=>{"use strict";e.d(O,{GN:()=>m,GX:()=>v,Yr:()=>o,d7:()=>g,dq:()=>c,e9:()=>h,h4:()=>p,jc:()=>l,xV:()=>y});var t=e(75505),n=e(79422),i=e(34214),s=e(41507),r=e(20455),f=e(27677),a=e(98796);async function c({searchString:u="",perPage:D=100,page:P=1,excludeUid:x="",sortDirection:E="",typeFilter:C=[],folderFilterUIDs:M=[]}={}){const S=new URLSearchParams;S.append("searchString",u),S.append("sortDirection",E),S.append("typeFilter",C.join(",")),S.append("folderFilterUIDs",M.join(",")),S.append("excludeUid",x),S.append("perPage",D.toString(10)),S.append("page",P.toString(10)),S.append("kind",a.i.Panel.toString(10));const{result:I}=await(0,f.AI)().get(`/api/library-elements?${S.toString()}`);return I}async function o(u,D=!1){const P=await(0,t.s)((0,f.AI)().fetch({method:"GET",url:`/api/library-elements/${u}`,showSuccessAlert:!D,showErrorAlert:!D})),{result:x}=P.data,E=new i.G({...n.Ye,schemaVersion:35,panels:[x.model]}),{scopedVars:C,...M}=E.panels[0].getSaveModel();return delete M.gridPos,delete M.id,delete M.libraryPanel,E.destroy(),{...x,model:M}}async function h(u){const{result:D}=await(0,f.AI)().get(`/api/library-elements/name/${u}`);return D}async function g(u,D){const{result:P}=await(0,f.AI)().post("/api/library-elements",{folderUid:D,name:u.libraryPanel.name,model:u,kind:a.i.Panel});return P}async function l(u){const{libraryPanel:D,...P}=u,{uid:x,name:E,version:C,folderUid:M}=D,S=a.i.Panel,{result:I}=await(0,f.AI)().patch(`/api/library-elements/${x}`,{folderUid:M,name:E,model:P,version:C,kind:S});return I}function p(u){return(0,f.AI)().delete(`/api/library-elements/${u}`)}async function m(u){const{result:D}=await(0,f.AI)().get(`/api/library-elements/${u}/connections`);return D}async function y(u){const D=await m(u);return D.length===0?[]:await(0,f.AI)().search({dashboardUIDs:D.map(x=>x.connectionUid)})}function d(u){const{panel:D,uid:P,name:x,_loadedPanel:E}=u.state,C=u.parent;if(!C||!(C instanceof s.U))throw new Error("LibraryVizPanel must be a child of DashboardGridItem");return{uid:P,folderUID:E?.folderUid,name:x,version:E?.version||0,model:(0,r.Z6)(D,{x:C.state.x??0,y:C.state.y??0,w:C.state.width??0,h:C.state.height??0},!1,C),kind:a.i.Panel}}async function v(u){const{uid:D,folderUID:P,name:x,model:E,version:C,kind:M}=d(u),{result:S}=await(0,f.AI)().patch(`/api/library-elements/${D}`,{folderUID:P,name:x,model:E,version:C,kind:M});return S}},43535:(G,O,e)=>{"use strict";e.d(O,{o:()=>n});var t=e(32196);function n(i){return{myTable:(0,t.css)`
      max-height: 204px;
      overflow-y: auto;
      margin-top: 11px;
      margin-bottom: 28px;
      border-radius: ${i.shape.radius.default};
      border: 1px solid ${i.colors.action.hover};
      background: ${i.colors.background.primary};
      color: ${i.colors.text.secondary};
      font-size: ${i.typography.h6.fontSize};
      width: 100%;

      thead {
        color: #538ade;
        font-size: ${i.typography.bodySmall.fontSize};
      }

      th,
      td {
        padding: 6px 13px;
        height: ${i.spacing(4)};
      }

      tbody > tr:nth-child(odd) {
        background: ${i.colors.background.secondary};
      }
    `,noteTextbox:(0,t.css)`
      margin-bottom: ${i.spacing(4)};
    `,textInfo:(0,t.css)`
      color: ${i.colors.text.secondary};
      font-size: ${i.typography.size.sm};
    `,dashboardSearch:(0,t.css)`
      margin-top: ${i.spacing(2)};
    `,modal:(0,t.css)`
      width: 500px;
    `,modalText:(0,t.css)`
      font-size: ${i.typography.h4.fontSize};
      color: ${i.colors.text.primary};
      margin-bottom: ${i.spacing(4)};
      padding-top: ${i.spacing(2)};
    `}}},98796:(G,O,e)=>{"use strict";e.d(O,{i:()=>t});var t=(i=>(i[i.Panel=1]="Panel",i))(t||{}),n=(i=>(i[i.Dashboard=1]="Dashboard",i))(n||{})},88861:(G,O,e)=>{"use strict";e.d(O,{b:()=>h});var t=e(5805),n=e(17172),i=e(3169),s=e(8484),r=e(57767);async function f(g,l){const p=a(g),m=await o(p,l);return c(g,m),m}function a(g){let{scopedVars:l,...p}=g.getSaveModel();return p={libraryPanel:{name:g.title,uid:void 0},...p},p}function c(g,l){g.restoreModel({...l.model,configRev:0,libraryPanel:l,title:g.title}),g.hasSavedPanelEditChange=!0,g.refresh()}function o(g,l){return g.libraryPanel?g.libraryPanel&&g.libraryPanel.uid===""?(0,r.d7)(g,l):(0,r.jc)(g):Promise.reject()}const h=()=>{const g=(0,i._2)(),[l,p]=(0,t.default)(async(m,y)=>{try{const d=await f(m,y);return g.success((0,s.t)("library-panels.save.success","Library panel saved")),d}catch(d){throw(0,n.NF)(d)&&(d.isHandled=!0,g.error((0,s.t)("library-panels.save.error",'Error saving library panel: "{{errorMsg}}"',{errorMsg:d.message??d.data.message}))),d}},[]);return{state:l,saveLibraryPanel:p}}},6473:(G,O,e)=>{"use strict";e.d(O,{t:()=>D});var t=e(62938),n=e(55004),i=e(26272),s=e(78731),r=e(12131),f=e(10096),a=e(28444),c=e(14792),o=e(74848),h=e(32196),g=e(40845),l=e(37390),p=e(55852),m=(P=>(P.Saved="saved",P.EditingStarted="editing-started",P.EditingCanceled="editing-cancelled",P.Deleted="deleted",P))(m||{});function y({onDismiss:P,event:x}){const E=(0,g.of)(d),C=()=>{if(x?.action===m.Deleted){r.Ny.push("/");return}D.reloadPage(),P()};return(0,o.jsxs)(l.a,{isOpen:!0,title:"Dashboard changed",icon:"copy",onDismiss:P,onClickBackdrop:()=>{},className:E.modal,children:[(0,o.jsx)("div",{className:E.description,children:"The dashboad has been updated by another session. Do you want to continue editing or discard your local changes?"}),(0,o.jsxs)(l.a.ButtonRow,{children:[(0,o.jsx)(p.$n,{onClick:P,variant:"secondary",fill:"outline",children:"Continue editing"}),(0,o.jsx)(p.$n,{onClick:C,variant:"destructive",children:"Discard local changes"})]})]})}const d=P=>({modal:(0,h.css)({width:"600px"}),description:(0,h.css)({color:P.colors.text.secondary,paddingBottom:P.spacing(1)})}),v=(0,t.A)();class u{constructor(){this.editing=!1,this.observer={next:x=>{if((0,n.ew)(x)&&this.editing&&x.state===n.ZF.Connected&&this.sendEditingState(),(0,n.Z7)(x)){if(x.message.sessionId===v)return;const{action:E}=x.message;switch(E){case m.EditingStarted:case m.Saved:{if(this.ignoreSave){this.ignoreSave=!1;return}const C=(0,c.UA)().getCurrent();if(C?.uid!==x.message.uid){console.log("dashboard event for different dashboard?",x,C);return}const M=this.editing||C.hasUnsavedChanges();if(E===m.Saved)M?f.lE.publish(new a.S8({component:y,props:{event:x}})):(f.lE.emit(i.r1.alertSuccess,["Dashboard updated"]),this.reloadPage());else if(M&&E===m.EditingStarted&&!this.hasSeenNotice){const S=x.message,I=this.getRecentEditingEvent();(!I||I.message!==S.message)&&(this.hasSeenNotice=!0,f.lE.emit(i.r1.alertWarning,["Another session is editing this dashboard",S.message])),this.lastEditing=S}return}}}}}}setEditingState(x){const E=this.editing=x;this.editing=x,this.hasSeenNotice=!1,E&&f.TP.isEditor&&this.sendEditingState()}sendEditingState(){const{channel:x,uid:E}=this;x&&E&&(0,s.oF)().publish(x,{sessionId:v,uid:E,action:this.editing?m.EditingStarted:m.EditingCanceled,timestamp:Date.now()})}watch(x){const E=(0,s.oF)();E&&x!==this.uid&&(this.channel={scope:n.qD.Grafana,namespace:"dashboard",path:`uid/${x}`},this.leave(),x&&(this.subscription=E.getStream(this.channel).subscribe(this.observer)),this.uid=x)}leave(){this.subscription&&this.subscription.unsubscribe(),this.subscription=void 0,this.uid=void 0}ignoreNextSave(){this.ignoreSave=!0}getRecentEditingEvent(){return this.lastEditing&&this.lastEditing.timestamp&&Date.now()-this.lastEditing.timestamp>5e3&&(this.lastEditing=void 0),this.lastEditing}reloadPage(){r.Ny.reload()}}const D=new u},47118:(G,O,e)=>{"use strict";e.d(O,{_w:()=>n,o$:()=>f,ot:()=>i});var t=e(14236),n=(a=>(a.NewValuesSameSchema="NewValuesSameSchema",a.FullFrame="FullFrame",a))(n||{});const i=(a,c)=>"type"in a&&a.type===c,s=Object.values(n),r=a=>"type"in a&&s.includes(a.type),f=a=>(0,t.ci)(a)&&"packetInfo"in a},39408:(G,O,e)=>{"use strict";e.d(O,{l:()=>i});var t=e(89667),n=e(17172);async function i(){return(0,n.AI)().get("api/live/list").then(s=>{const r=s.channels??[],f={},a=r.map(c=>{if(c.data){const o=new Set,h=(0,t.or)(c.data);for(const g of h.fields)o.add(g.name);f[c.channel]=Array.from(o).map(g=>({value:g,label:g}))}return{value:c.channel,label:c.channel+" ["+c.minute_rate+" msg/min]"}});return{channelFields:f,channels:a}})}},81073:(G,O,e)=>{"use strict";e.d(O,{I:()=>s});var t=e(74848),n=e(32196),i=e(62930);const s=({adjective:f="newer"})=>{const a=`Loading ${f} logs...`;return(0,t.jsx)("div",{className:r,children:(0,t.jsxs)("div",{children:[a," ",(0,t.jsx)(i.y,{inline:!0})]})})},r=(0,n.css)`
  display: flex;
  justify-content: center;
`},93463:(G,O,e)=>{"use strict";e.d(O,{A:()=>c,h:()=>a});var t=e(74848),n=e(32196),i=e(96540),s=e(40845),r=e(56034);const f=["level","lvl","filename"],a=(0,i.memo)(({labels:g,emptyMessage:l})=>{const p=(0,s.of)(h),m=(0,i.useMemo)(()=>Object.keys(g).filter(y=>!y.startsWith("_")&&!f.includes(y)).sort(),[g]);return m.length===0&&l?(0,t.jsx)("span",{className:(0,n.cx)([p.logsLabels]),children:(0,t.jsx)("span",{className:(0,n.cx)([p.logsLabel]),children:l})}):(0,t.jsx)("span",{className:(0,n.cx)([p.logsLabels]),children:m.map(y=>{const d=g[y];if(!d)return;const v=`${y}=${d}`;return(0,t.jsx)(r.m,{content:v,placement:"top",children:(0,t.jsx)(o,{styles:p,children:v})},y)})})});a.displayName="LogLabels";const c=(0,i.memo)(({labels:g})=>{const l=(0,s.of)(h);return(0,t.jsx)("span",{className:(0,n.cx)([l.logsLabels]),children:g.map(p=>(0,t.jsx)(o,{styles:l,tooltip:p,children:p},p))})});c.displayName="LogLabelsList";const o=(0,i.forwardRef)(({styles:g,tooltip:l,children:p},m)=>(0,t.jsx)("span",{className:(0,n.cx)([g.logsLabel]),ref:m,children:(0,t.jsx)("span",{className:(0,n.cx)([g.logsLabelValue]),title:l,children:p})}));o.displayName="LogLabel";const h=g=>({logsLabels:(0,n.css)`
      display: flex;
      flex-wrap: wrap;
      font-size: ${g.typography.size.xs};
    `,logsLabel:(0,n.css)`
      label: logs-label;
      display: flex;
      padding: ${g.spacing(0,.25)};
      background-color: ${g.colors.background.secondary};
      border-radius: ${g.shape.radius.default};
      margin: ${g.spacing(.125,.5,0,0)};
      text-overflow: ellipsis;
      white-space: nowrap;
      overflow: hidden;
    `,logsLabelValue:(0,n.css)`
      label: logs-label__value;
      display: inline-block;
      max-width: ${g.spacing(25)};
      text-overflow: ellipsis;
      overflow: hidden;
    `})},85492:(G,O,e)=>{"use strict";e.d(O,{$:()=>h});var t=e(74848),n=e(88838),i=e(96540),s=e(23257),r=e.n(s),f=e(21),a=e(40845);function c(g,l){return l.split(/;\s*/).reduce((p,m)=>{if(m==="color:rgba(0,0,0,0.5)")return{color:g.colors.text.secondary};const y=m.match(/([^:\s]+)\s*:\s*(.+)/);if(y&&y[1]&&y[2]){const d=y[1].replace(/-([a-z])/g,(v,u)=>u.toUpperCase());p[d]=y[2]}return p},{})}class o extends i.PureComponent{constructor(){super(...arguments),this.state={chunks:[],prevValue:""}}static getDerivedStateFromProps(l,p){return l.value===p.prevValue?null:{chunks:n.Ay.parse(l.value).spans.map(y=>y.css?{style:c(l.theme,y.css),text:y.text}:{text:y.text}),prevValue:l.value}}render(){const{chunks:l}=this.state;return l.map((p,m)=>{const y=this.props.highlight?.searchWords?(0,t.jsx)(r(),{textToHighlight:p.text,searchWords:this.props.highlight.searchWords,findChunks:f.Oq,highlightClassName:this.props.highlight.highlightClassName},m):p.text;return p.style?(0,t.jsx)("span",{style:p.style,"data-testid":"ansiLogLine",children:y},m):y})}}const h=(0,a.cV)(o);h.displayName="LogMessageAnsi"},42785:(G,O,e)=>{"use strict";e.d(O,{Q:()=>o});var t=e(74848),n=e(96540),i=e(76885),s=e(71733),r=e(43127),f=e(29158),a=e(10534),c=e(2913);const o=(0,n.memo)(({logText:h,onOpenContext:g,onPermalinkClick:l,onPinLine:p,onUnpinLine:m,pinLineButtonTooltipTitle:y,pinned:d,row:v,showContextToggle:u,styles:D,mouseIsOver:P,onBlur:x,getRowContextQuery:E})=>{const C=u?u(v):!1,M=(0,n.useCallback)(b=>{b.stopPropagation()},[]),S=(0,n.useCallback)(async b=>{if(b.stopPropagation(),E&&(b.nativeEvent.ctrlKey||b.nativeEvent.metaKey||b.nativeEvent.shiftKey)){const R=window.open("about:blank"),A=await E(v,void 0,!1);if(A&&R){const L=i.kM.renderUrl(s.I.assureBaseUrl(`${(0,c.zj)().appSubUrl}explore`),{left:JSON.stringify({datasource:A.datasource,queries:[A],range:(0,r.E2)()})});R.location=L;return}R?.close()}g(v)},[g,E,v]),I=(0,n.useCallback)(b=>{!b.currentTarget.contains(b.relatedTarget)&&x&&x()},[x]),T=(0,n.useCallback)(()=>h,[h]);return(0,t.jsxs)("span",{className:`log-row-menu ${D.rowMenu}`,onClick:M,onBlur:I,children:[d&&!P&&(0,t.jsx)(f.K,{className:D.unPinButton,size:"md",name:"gf-pin",onClick:()=>m&&m(v),tooltip:"Unpin line",tooltipPlacement:"top","aria-label":"Unpin line",tabIndex:0}),P&&(0,t.jsxs)(t.Fragment,{children:[C&&(0,t.jsx)(f.K,{size:"md",name:"gf-show-context",onClick:S,tooltip:"Show context",tooltipPlacement:"top","aria-label":"Show context",tabIndex:0}),(0,t.jsx)(a.b,{className:D.copyLogButton,icon:"copy",variant:"secondary",fill:"text",size:"md",getText:T,tooltip:"Copy to clipboard",tooltipPlacement:"top",tabIndex:0}),d&&m&&(0,t.jsx)(f.K,{className:D.unPinButton,size:"md",name:"gf-pin",onClick:()=>m&&m(v),tooltip:"Unpin line",tooltipPlacement:"top","aria-label":"Unpin line",tabIndex:0}),!d&&p&&(0,t.jsx)(f.K,{className:D.unPinButton,size:"md",name:"gf-pin",onClick:()=>p&&p(v),tooltip:y??"Pin line",tooltipPlacement:"top","aria-label":"Pin line",tabIndex:0}),l&&v.rowId!==void 0&&v.uid&&(0,t.jsx)(f.K,{tooltip:"Copy shortlink","aria-label":"Copy shortlink",tooltipPlacement:"top",size:"md",name:"share-alt",onClick:()=>l(v),tabIndex:0})]})]})});o.displayName="LogRowMenuCell"},40455:(G,O,e)=>{"use strict";e.d(O,{S:()=>c,a:()=>g});var t=e(74848),n=e(96540),i=e(23257),s=e.n(i),r=e(21),f=e(85492),a=e(42785);const c=1e5,o=({hasAnsi:l,entry:p,highlights:m,styles:y})=>{const d=m&&m.length>0&&m[0]&&m[0].length>0&&p.length<c,v=m??[];if(l){const u=d?{searchWords:v,highlightClassName:y.logsRowMatchHighLight}:void 0;return(0,t.jsx)(f.$,{value:p,highlight:u})}else if(d)return(0,t.jsx)(s(),{textToHighlight:p,searchWords:v,findChunks:r.Oq,highlightClassName:y.logsRowMatchHighLight});return(0,t.jsx)(t.Fragment,{children:p})},h=(l,p,m,y)=>{if(p)try{return JSON.stringify(JSON.parse(l),void 0,2)}catch{}return!m&&!y&&(l=l.replace(/(\r\n|\n|\r)/g,"")),l},g=(0,n.memo)(l=>{const{row:p,wrapLogMessage:m,prettifyLogMessage:y,showContextToggle:d,styles:v,onOpenContext:u,onPermalinkClick:D,onUnpinLine:P,onPinLine:x,pinLineButtonTooltipTitle:E,pinned:C,mouseIsOver:M,onBlur:S,getRowContextQuery:I,expanded:T}=l,{hasAnsi:b,raw:R}=p,A=(0,n.useMemo)(()=>h(R,y,m,!!T),[R,y,m,T]),L=(0,n.useMemo)(()=>M||C,[M,C]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("td",{className:v.logsRowMessage,children:(0,t.jsx)("div",{className:m?v.positionRelative:v.horizontalScroll,children:(0,t.jsx)("button",{className:`${v.logLine} ${v.positionRelative}`,children:(0,t.jsx)(o,{hasAnsi:b,entry:A,highlights:p.searchWords,styles:v})})})}),(0,t.jsx)("td",{className:`log-row-menu-cell ${v.logRowMenuCell}`,children:L&&(0,t.jsx)(a.Q,{logText:A,row:p,showContextToggle:d,getRowContextQuery:I,onOpenContext:u,onPermalinkClick:D,onPinLine:x,onUnpinLine:P,pinLineButtonTooltipTitle:E,pinned:C,styles:v,mouseIsOver:M,onBlur:S})})]})});g.displayName="LogRowMessage"},14647:(G,O,e)=>{"use strict";e.d(O,{k:()=>z});var t=e(74848),n=e(32196),i=e(41811),s=e(96540),r=e(52622),f=e(32264),a=e(40845),c=e(14110),o=e(38138),h=e(91002);const g=({x:te,y:le,onClickFilterString:ie,onClickFilterOutString:ae,selection:re,row:ce,close:me})=>{const ee=(0,s.useRef)(null),de=(0,a.of)(p);return(0,s.useEffect)(()=>{function fe(Te){Te.key==="Escape"&&me()}return document.addEventListener("keyup",fe),()=>{document.removeEventListener("keyup",fe)}},[me]),ie||ae?(0,t.jsx)("div",{className:de.menu,style:{top:le,left:te},children:(0,t.jsxs)(o.W,{ref:ee,children:[(0,t.jsx)(o.W.Item,{label:"Copy selection",onClick:()=>{(0,h.Dk)(re,ee),me(),l("copy",re.length,ce.datasourceType)}}),ie&&(0,t.jsx)(o.W.Item,{label:"Add as line contains filter",onClick:()=>{ie(re,ce.dataFrame.refId),me(),l("line_contains",re.length,ce.datasourceType)}}),ae&&(0,t.jsx)(o.W.Item,{label:"Add as line does not contain filter",onClick:()=>{ae(re,ce.dataFrame.refId),me(),l("line_does_not_contain",re.length,ce.datasourceType)}})]})}):null};function l(te,le,ie){(0,c.rR)("grafana_explore_logs_popover_menu",{action:te,selectionLength:le,datasourceType:ie||"unknown"})}const p=te=>({menu:(0,n.css)({position:"fixed",zIndex:te.zIndex.modal})});class m{constructor(){this.seen=new Set,this.count=0}getKey(le){this.count+=1;const ie=`k_${le}`;return this.seen.has(ie)?`i_${this.count}`:(this.seen.add(ie),ie)}}var y=e(2543),d=e(72724),v=e(56034),u=e(14578),D=e(41260),P=e(41987),x=e(10534),E=e(29158),C=e(14689),M=e(69147),S=e(3911);const I=te=>({logsStatsRow:(0,n.css)`
    label: logs-stats-row;
    margin: ${parseInt(te.spacing(2),10)/1.75}px 0;
  `,logsStatsRowActive:(0,n.css)`
    label: logs-stats-row--active;
    color: ${te.colors.primary.text};
    position: relative;
  `,logsStatsRowLabel:(0,n.css)`
    label: logs-stats-row__label;
    display: flex;
    margin-bottom: 1px;
  `,logsStatsRowValue:(0,n.css)`
    label: logs-stats-row__value;
    flex: 1;
    text-overflow: ellipsis;
    overflow: hidden;
  `,logsStatsRowCount:(0,n.css)`
    label: logs-stats-row__count;
    text-align: right;
    margin-left: ${te.spacing(.75)};
  `,logsStatsRowPercent:(0,n.css)`
    label: logs-stats-row__percent;
    text-align: right;
    margin-left: ${te.spacing(.75)};
    width: ${te.spacing(4.5)};
  `,logsStatsRowBar:(0,n.css)`
    label: logs-stats-row__bar;
    height: ${te.spacing(.5)};
    overflow: hidden;
    background: ${te.colors.text.disabled};
  `,logsStatsRowInnerBar:(0,n.css)`
    label: logs-stats-row__innerbar;
    height: ${te.spacing(.5)};
    overflow: hidden;
    background: ${te.colors.primary.main};
  `}),T=({active:te,count:le,proportion:ie,value:ae})=>{const re=(0,a.of)(I),ce=`${Math.round(ie*100)}%`,me={width:ce},ee=te?(0,n.cx)([re.logsStatsRow,re.logsStatsRowActive]):(0,n.cx)([re.logsStatsRow]);return(0,t.jsxs)("div",{className:ee,children:[(0,t.jsxs)("div",{className:(0,n.cx)([re.logsStatsRowLabel]),children:[(0,t.jsx)("div",{className:(0,n.cx)([re.logsStatsRowValue]),title:ae,children:ae}),(0,t.jsx)("div",{className:(0,n.cx)([re.logsStatsRowCount]),children:le}),(0,t.jsx)("div",{className:(0,n.cx)([re.logsStatsRowPercent]),children:ce})]}),(0,t.jsx)("div",{className:(0,n.cx)([re.logsStatsRowBar]),children:(0,t.jsx)("div",{className:(0,n.cx)([re.logsStatsRowInnerBar]),style:me})})]})};T.displayName="LogLabelStatsRow";const b=5,R=(0,S.N)(te=>({logsStats:(0,n.css)`
      label: logs-stats;
      background: inherit;
      color: ${te.colors.text.primary};
      word-break: break-all;
      width: fit-content;
      max-width: 100%;
    `,logsStatsHeader:(0,n.css)`
      label: logs-stats__header;
      border-bottom: 1px solid ${te.colors.border.medium};
      display: flex;
    `,logsStatsTitle:(0,n.css)`
      label: logs-stats__title;
      font-weight: ${te.typography.fontWeightMedium};
      padding-right: ${te.spacing(2)};
      display: inline-block;
      white-space: nowrap;
      text-overflow: ellipsis;
      flex-grow: 1;
    `,logsStatsClose:(0,n.css)`
      label: logs-stats__close;
      cursor: pointer;
    `,logsStatsBody:(0,n.css)`
      label: logs-stats__body;
      padding: 5px 0px;
    `}));class A extends s.PureComponent{render(){const{label:le,rowCount:ie,stats:ae,value:re,theme:ce,isLabel:me}=this.props,ee=R(ce),de=ae.slice(0,b);let De=de.find(Re=>Re.value===re),fe=ae.slice(b);const Te=!De;Te&&(De=fe.find(Re=>Re.value===re),fe=fe.filter(Re=>Re.value!==re));const je=fe.reduce((Re,Se)=>Re+Se.count,0),Be=de.reduce((Re,Se)=>Re+Se.count,0)+je,Ne=je/Be;return(0,t.jsxs)("div",{className:ee.logsStats,"data-testid":"logLabelStats",children:[(0,t.jsx)("div",{className:ee.logsStatsHeader,children:(0,t.jsxs)("div",{className:ee.logsStatsTitle,children:[le,": ",Be," of ",ie," rows have that ",me?"label":"field"]})}),(0,t.jsxs)("div",{className:ee.logsStatsBody,children:[de.map(Re=>(0,t.jsx)(T,{...Re,active:Re.value===re},Re.value)),Te&&De&&(0,t.jsx)(T,{...De,active:!0},De.value),je>0&&(0,t.jsx)(T,{count:je,value:"Other",proportion:Ne},"__OTHERS__")]})]})}}const L=(0,a.cV)(A);L.displayName="LogLabelStats";var U=e(77020);const W=(0,i.A)(te=>({wordBreakAll:(0,n.css)`
      label: wordBreakAll;
      word-break: break-all;
    `,copyButton:(0,n.css)`
      & > button {
        color: ${te.colors.text.secondary};
        padding: 0;
        justify-content: center;
        border-radius: ${te.shape.radius.circle};
        height: ${te.spacing(te.components.height.sm)};
        width: ${te.spacing(te.components.height.sm)};
        svg {
          margin: 0;
        }

        span > div {
          top: -5px;
          & button {
            color: ${te.colors.success.main};
          }
        }
      }
    `,adjoiningLinkButton:(0,n.css)`
      margin-left: ${te.spacing(1)};
    `,wrapLine:(0,n.css)`
      label: wrapLine;
      white-space: pre-wrap;
    `,logDetailsStats:(0,n.css)`
      padding: 0 ${te.spacing(1)};
    `,logDetailsValue:(0,n.css)`
      display: flex;
      align-items: center;
      line-height: 22px;

      .log-details-value-copy {
        visibility: hidden;
      }
      &:hover {
        .log-details-value-copy {
          visibility: visible;
        }
      }
    `,buttonRow:(0,n.css)`
      display: flex;
      flex-direction: row;
      gap: ${te.spacing(.5)};
      margin-left: ${te.spacing(.5)};
    `}));class w extends s.PureComponent{constructor(){super(...arguments),this.state={showFieldsStats:!1,fieldCount:0,fieldStats:null},this.showField=()=>{const{onClickShowField:le,parsedKeys:ie,row:ae}=this.props;le&&le(ie[0]),(0,c.rR)("grafana_explore_logs_log_details_replace_line_clicked",{datasourceType:ae.datasourceType,logRowUid:ae.uid,type:"enable"})},this.hideField=()=>{const{onClickHideField:le,parsedKeys:ie,row:ae}=this.props;le&&le(ie[0]),(0,c.rR)("grafana_explore_logs_log_details_replace_line_clicked",{datasourceType:ae.datasourceType,logRowUid:ae.uid,type:"disable"})},this.isFilterLabelActive=async()=>{const{isFilterLabelActive:le,parsedKeys:ie,parsedValues:ae,row:re}=this.props;return le?await le(ie[0],ae[0],re.dataFrame?.refId):!1},this.filterLabel=()=>{const{onClickFilterLabel:le,parsedKeys:ie,parsedValues:ae,row:re}=this.props;le&&le(ie[0],ae[0],(0,M.f8)(re)||void 0),(0,c.rR)("grafana_explore_logs_log_details_filter_clicked",{datasourceType:re.datasourceType,filterType:"include",logRowUid:re.uid})},this.filterOutLabel=()=>{const{onClickFilterOutLabel:le,parsedKeys:ie,parsedValues:ae,row:re}=this.props;le&&le(ie[0],ae[0],(0,M.f8)(re)||void 0),(0,c.rR)("grafana_explore_logs_log_details_filter_clicked",{datasourceType:re.datasourceType,filterType:"exclude",logRowUid:re.uid})},this.updateStats=()=>{const{getStats:le}=this.props,ie=le(),ae=ie?ie.reduce((re,ce)=>re+ce.count,0):0;(!(0,y.isEqual)(this.state.fieldStats,ie)||ae!==this.state.fieldCount)&&this.setState({fieldStats:ie,fieldCount:ae})},this.showStats=()=>{const{isLabel:le,row:ie,app:ae}=this.props,{showFieldsStats:re}=this.state;re||this.updateStats(),this.toggleFieldsStats(),(0,c.rR)("grafana_explore_logs_log_details_stats_clicked",{dataSourceType:ie.datasourceType,fieldType:le?"label":"detectedField",type:re?"close":"open",logRowUid:ie.uid,app:ae})}}componentDidUpdate(){this.state.showFieldsStats&&this.updateStats()}toggleFieldsStats(){this.setState(le=>({showFieldsStats:!le.showFieldsStats}))}generateClipboardButton(le){const{theme:ie}=this.props,ae=W(ie);return(0,t.jsx)("div",{className:`log-details-value-copy ${ae.copyButton}`,children:(0,t.jsx)(x.b,{getText:()=>le,title:"Copy value to clipboard",fill:"text",variant:"secondary",icon:"copy",size:"md"})})}generateMultiVal(le,ie){return(0,t.jsx)("table",{children:(0,t.jsx)("tbody",{children:le?.map((ae,re)=>(0,t.jsx)("tr",{children:(0,t.jsxs)("td",{children:[ae,ie&&ae!==""&&this.generateClipboardButton(ae)]})},`${ae}-${re}`))})})}render(){const{theme:le,parsedKeys:ie,parsedValues:ae,isLabel:re,links:ce,displayedFields:me,wrapLogMessage:ee,onClickFilterLabel:de,onClickFilterOutLabel:De,disableActions:fe,row:Te,app:je,onPinLine:He,pinLineButtonTooltipTitle:Be}=this.props,{showFieldsStats:Ne,fieldStats:Re,fieldCount:Se}=this.state,We=W(le),Ke=(0,U.D)(le),Xe=ie==null?!1:ie.length===1,Je=ae==null?!1:ae.length===1,st=!fe&&de&&De,pt=je===P.Jk.Explore&&Te.dataFrame?.refId?` in query ${Te.dataFrame?.refId}`:"",xt=!Je&&ae!=null&&!ae.every($e=>$e===""),ot=me&&ie!=null&&me.includes(ie[0])?(0,t.jsx)(E.K,{variant:"primary",tooltip:"Hide this field",name:"eye",onClick:this.hideField}):(0,t.jsx)(E.K,{tooltip:"Show this field instead of the message",name:"eye",onClick:this.showField});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("tr",{className:Ke.logDetailsValue,children:[(0,t.jsx)("td",{className:Ke.logsDetailsIcon,children:(0,t.jsxs)("div",{className:We.buttonRow,children:[st&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(N,{name:"search-plus",onClick:this.filterLabel,isActive:()=>this.isFilterLabelActive(),tooltipSuffix:pt}),(0,t.jsx)(E.K,{name:"search-minus",tooltip:`Filter out value${pt}`,onClick:this.filterOutLabel})]}),!fe&&me&&ot,!fe&&(0,t.jsx)(E.K,{variant:Ne?"primary":"secondary",name:"signal",tooltip:"Ad-hoc statistics",className:"stats-button",disabled:!Xe,onClick:this.showStats})]})}),(0,t.jsx)("td",{className:Ke.logDetailsLabel,children:Xe?ie[0]:this.generateMultiVal(ie)}),(0,t.jsx)("td",{className:(0,n.cx)(We.wordBreakAll,ee&&We.wrapLine),children:(0,t.jsxs)("div",{className:We.logDetailsValue,children:[Je?ae[0]:this.generateMultiVal(ae,!0),Je&&this.generateClipboardButton(ae[0]),(0,t.jsx)("div",{className:(0,n.cx)((Je||xt)&&We.adjoiningLinkButton),children:ce?.map(($e,ve)=>{if($e.onClick&&He){const be=$e.onClick;$e.onClick=(he,ye)=>{He(Te,!1),be(he,ye)}}return(0,t.jsx)("span",{children:(0,t.jsx)(C.R,{buttonProps:{tooltip:typeof Be=="object"&&$e.onClick?Be:void 0},link:$e})},`${$e.title}-${ve}`)})})]})})]}),Ne&&Xe&&Je&&(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:(0,t.jsx)(E.K,{variant:Ne?"primary":"secondary",name:"signal",tooltip:"Hide ad-hoc statistics",onClick:this.showStats})}),(0,t.jsx)("td",{colSpan:2,children:(0,t.jsx)("div",{className:We.logDetailsStats,children:(0,t.jsx)(L,{stats:Re,label:ie[0],value:ae[0],rowCount:Se,isLabel:re})})})]})]})}}const N=({isActive:te,tooltipSuffix:le,...ie})=>{const[ae,re]=(0,s.useState)(!1),ce=ae?"Remove filter":"Filter for value";return(0,s.useEffect)(()=>{te().then(re)},[te]),(0,t.jsx)(E.K,{...ie,variant:ae?"primary":void 0,tooltip:ce+le})},B=(0,a.cV)(w);B.displayName="LogDetailsRow";var V=e(70377);class K extends s.PureComponent{render(){const{app:le,row:ie,theme:ae,hasError:re,onClickFilterOutLabel:ce,onClickFilterLabel:me,getRows:ee,showDuplicates:de,className:De,onClickShowField:fe,onClickHideField:Te,displayedFields:je,getFieldLinks:He,wrapLogMessage:Be,onPinLine:Ne,styles:Re,pinLineButtonTooltipTitle:Se}=this.props,We=(0,U.L)(ae,ie.logLevel),Ke=ie.labels?ie.labels:{},Xe=Object.keys(Ke).length>0,Je=(0,V.jE)(ie,He);let st=Je.filter(ye=>ye.links?.length);const pt=st.filter(ye=>ye.fieldIndex!==ie.entryFieldIndex).sort(),xt=st.filter(ye=>ye.fieldIndex===ie.entryFieldIndex).sort(),ot=(0,V.qE)(xt),$e=pt&&pt.length>0||ot&&ot.length>0,ve=ie.dataFrame.meta?.type===D.m.LogLines?[]:Je.filter(ye=>ye.links?.length===0&&ye.fieldIndex!==ie.entryFieldIndex).sort(),be=ve&&ve.length>0,he=re?"":`${We.logsRowLevelColor} ${Re.logsRowLevel} ${Re.logsRowLevelDetails}`;return(0,t.jsxs)("tr",{className:(0,n.cx)(De,Re.logDetails),children:[de&&(0,t.jsx)("td",{}),(0,t.jsx)("td",{className:he,"aria-label":"Log level"}),(0,t.jsx)("td",{colSpan:4,children:(0,t.jsx)("div",{className:Re.logDetailsContainer,children:(0,t.jsx)("table",{className:Re.logDetailsTable,children:(0,t.jsxs)("tbody",{children:[(Xe||be)&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:100,className:Re.logDetailsHeading,"aria-label":"Fields",children:"Fields"})}),Object.keys(Ke).sort().map((ye,Pe)=>{const ge=Ke[ye];return(0,t.jsx)(B,{parsedKeys:[ye],parsedValues:[ge],isLabel:!0,getStats:()=>(0,h.Tj)(ee(),ye),onClickFilterOutLabel:ce,onClickFilterLabel:me,onClickShowField:fe,onClickHideField:Te,row:ie,app:le,wrapLogMessage:Be,displayedFields:je,disableActions:!1,isFilterLabelActive:this.props.isFilterLabelActive},`${ye}=${ge}-${Pe}`)}),ve.map((ye,Pe)=>{const{keys:ge,values:xe,fieldIndex:Ae}=ye;return(0,t.jsx)(B,{parsedKeys:ge,parsedValues:xe,onClickShowField:fe,onClickHideField:Te,onClickFilterOutLabel:ce,onClickFilterLabel:me,getStats:()=>(0,h.s2)(ie.dataFrame.fields[Ae].values),displayedFields:je,wrapLogMessage:Be,row:ie,app:le,disableActions:!1,isFilterLabelActive:this.props.isFilterLabelActive},`${ge[0]}=${xe[0]}-${Pe}`)}),$e&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:100,className:Re.logDetailsHeading,"aria-label":"Data Links",children:"Links"})}),pt.map((ye,Pe)=>{const{keys:ge,values:xe,links:Ae,fieldIndex:Ee}=ye;return(0,t.jsx)(B,{parsedKeys:ge,parsedValues:xe,links:Ae,onClickShowField:fe,onClickHideField:Te,onPinLine:Ne,pinLineButtonTooltipTitle:Se,getStats:()=>(0,h.s2)(ie.dataFrame.fields[Ee].values),displayedFields:je,wrapLogMessage:Be,row:ie,app:le,disableActions:!1},`${ge[0]}=${xe[0]}-${Pe}`)}),ot?.map((ye,Pe)=>{const{keys:ge,values:xe,links:Ae,fieldIndex:Ee}=ye;return(0,t.jsx)(B,{parsedKeys:ge,parsedValues:xe,links:Ae,onClickShowField:fe,onClickHideField:Te,onPinLine:Ne,pinLineButtonTooltipTitle:Se,getStats:()=>(0,h.s2)(ie.dataFrame.fields[Ee].values),displayedFields:je,wrapLogMessage:Be,row:ie,app:le,disableActions:!0},`${ge[0]}=${xe[0]}-${Pe}`)}),!be&&!Xe&&!$e&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:100,"aria-label":"No details",children:"No details available"})})]})})})})]})}}const H=(0,a.cV)(K);H.displayName="LogDetails";var X=e(93463),k=e(40455),Y=e(42785);const Z=(0,s.memo)(te=>{const{row:le,detectedFields:ie,getFieldLinks:ae,wrapLogMessage:re,styles:ce,mouseIsOver:me,pinned:ee,...de}=te,De=re?"":se.noWrap,fe=(0,s.useMemo)(()=>(0,V.jE)(le,ae),[ae,le]),Te=(0,s.useMemo)(()=>{let He="";for(let Be=0;Be<ie.length;Be++){const Ne=ie[Be],Re=fe.find(Se=>{const{keys:We}=Se;return We[0]===Ne});Re&&(He+=` ${Ne}=${Re.values}`),le.labels[Ne]!==void 0&&le.labels[Ne]!==null&&(He+=` ${Ne}=${le.labels[Ne]}`)}return He.trimStart()},[ie,fe,le.labels]),je=(0,s.useMemo)(()=>me||ee,[me,ee]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("td",{className:ce.logsRowMessage,children:(0,t.jsx)("div",{className:De,children:Te})}),(0,t.jsx)("td",{className:`log-row-menu-cell ${ce.logRowMenuCell}`,children:je&&(0,t.jsx)(Y.Q,{logText:Te,row:le,styles:ce,pinned:ee,mouseIsOver:me,...de})})]})}),se={noWrap:(0,n.css)`
    white-space: nowrap;
  `};Z.displayName="LogRowMessageDisplayedFields";class j extends s.PureComponent{constructor(le){super(le),this.state={permalinked:!1,showingContext:!1,showDetails:!1,mouseIsOver:!1},this.debouncedContextClose=(0,y.debounce)(()=>{this.setState({showingContext:!1})},3e3),this.onOpenContext=ie=>{this.setState({showingContext:!0}),this.props.onOpenContext(ie,this.debouncedContextClose)},this.onRowClick=ie=>{this.props.handleTextSelection?.(ie,this.props.row)||this.props.enableLogDetails&&((0,c.rR)("grafana_explore_logs_log_details_clicked",{datasourceType:this.props.row.datasourceType,type:this.state.showDetails?"close":"open",logRowUid:this.props.row.uid,app:this.props.app}),this.setState(ae=>({showDetails:!ae.showDetails})))},this.onMouseEnter=()=>{this.setState({mouseIsOver:!0}),this.props.onLogRowHover&&this.props.onLogRowHover(this.props.row)},this.onMouseMove=ie=>{this.props.handleTextSelection&&document.getSelection()?.toString()&&ie.buttons>0&&this.setState({mouseIsOver:!1})},this.onMouseLeave=()=>{this.setState({mouseIsOver:!1}),this.props.onLogRowHover&&this.props.onLogRowHover(void 0)},this.scrollToLogRow=(ie,ae=!1)=>{const{row:re,permalinkedRowId:ce,scrollIntoView:me,containerRendered:ee}=this.props;if(ce!==re.uid){(ie.permalinked||ae)&&this.setState({permalinked:!1});return}!this.state.permalinked&&ee&&this.logLineRef.current&&me&&(me(this.logLineRef.current),(0,c.rR)("grafana_explore_logs_permalink_opened",{datasourceType:re.datasourceType??"unknown",logRowUid:re.uid}),this.setState({permalinked:!0}))},this.escapeRow=(0,i.A)((ie,ae)=>ie.hasUnescapedContent&&ae?{...ie,entry:(0,h.Hw)(ie.entry),raw:(0,h.Hw)(ie.raw)}:ie),this.logLineRef=s.createRef()}renderTimeStamp(le){return(0,d.LE)(le,{timeZone:this.props.timeZone,defaultWithMS:!0})}componentDidMount(){this.scrollToLogRow(this.state,!0)}componentDidUpdate(le,ie){this.scrollToLogRow(ie)}render(){const{getRows:le,onClickFilterLabel:ie,onClickFilterOutLabel:ae,onClickShowField:re,onClickHideField:ce,enableLogDetails:me,row:ee,showDuplicates:de,showContextToggle:De,showLabels:fe,showTime:Te,displayedFields:je,wrapLogMessage:He,prettifyLogMessage:Be,theme:Ne,getFieldLinks:Re,forceEscape:Se,app:We,styles:Ke,getRowContextQuery:Xe,pinned:Je}=this.props,{showDetails:st,showingContext:pt,permalinked:xt}=this.state,ot=(0,U.L)(Ne,ee.logLevel),{errorMessage:$e,hasError:ve}=(0,h.Ei)(ee),{sampleMessage:be,isSampled:he}=(0,h.qR)(ee),ye=(0,n.cx)(Ke.logsRow,{[Ke.errorLogRow]:ve,[Ke.highlightBackground]:pt||xt||Je}),Pe=(0,n.cx)(Ke.logsRow,{[Ke.errorLogRow]:ve,[Ke.highlightBackground]:xt&&!this.state.showDetails}),ge=this.escapeRow(ee,Se);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("tr",{ref:this.logLineRef,className:ye,onClick:this.onRowClick,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onMouseMove:this.onMouseMove,onFocus:this.onMouseEnter,children:[de&&(0,t.jsx)("td",{className:Ke.logsRowDuplicates,children:ge.duplicates&&ge.duplicates>0?`${ge.duplicates+1}x`:null}),(0,t.jsxs)("td",{className:ve||he?Ke.logsRowWithError:`${ot.logsRowLevelColor} ${Ke.logsRowLevel}`,children:[ve&&(0,t.jsx)(v.m,{content:`Error: ${$e}`,placement:"right",theme:"error",children:(0,t.jsx)(u.I,{className:Ke.logIconError,name:"exclamation-triangle",size:"xs"})}),he&&(0,t.jsx)(v.m,{content:`${be}`,placement:"right",theme:"info",children:(0,t.jsx)(u.I,{className:Ke.logIconInfo,name:"info-circle",size:"xs"})})]}),(0,t.jsx)("td",{title:me?st?"Hide log details":"See log details":"",className:me?Ke.logsRowToggleDetails:"",children:me&&(0,t.jsx)(u.I,{className:Ke.topVerticalAlign,name:st?"angle-down":"angle-right"})}),Te&&(0,t.jsx)("td",{className:Ke.logsRowLocalTime,children:this.renderTimeStamp(ee.timeEpochMs)}),fe&&ge.uniqueLabels&&(0,t.jsx)("td",{className:Ke.logsRowLabels,children:(0,t.jsx)(X.h,{labels:ge.uniqueLabels})}),je&&je.length>0?(0,t.jsx)(Z,{row:ge,showContextToggle:De,detectedFields:je,getFieldLinks:Re,wrapLogMessage:He,onOpenContext:this.onOpenContext,onPermalinkClick:this.props.onPermalinkClick,styles:Ke,onPinLine:this.props.onPinLine,onUnpinLine:this.props.onUnpinLine,pinned:this.props.pinned,mouseIsOver:this.state.mouseIsOver,onBlur:this.onMouseLeave}):(0,t.jsx)(k.a,{row:ge,showContextToggle:De,getRowContextQuery:Xe,wrapLogMessage:He,prettifyLogMessage:Be,onOpenContext:this.onOpenContext,onPermalinkClick:this.props.onPermalinkClick,app:We,styles:Ke,onPinLine:this.props.onPinLine,onUnpinLine:this.props.onUnpinLine,pinLineButtonTooltipTitle:this.props.pinLineButtonTooltipTitle,pinned:this.props.pinned,mouseIsOver:this.state.mouseIsOver,onBlur:this.onMouseLeave,expanded:this.state.showDetails})]}),this.state.showDetails&&(0,t.jsx)(H,{onPinLine:this.props.onPinLine,className:Pe,showDuplicates:de,getFieldLinks:Re,onClickFilterLabel:ie,onClickFilterOutLabel:ae,onClickShowField:re,onClickHideField:ce,getRows:le,row:ge,wrapLogMessage:He,hasError:ve,displayedFields:je,app:We,styles:Ke,isFilterLabelActive:this.props.isFilterLabelActive,pinLineButtonTooltipTitle:this.props.pinLineButtonTooltipTitle})]})}}const q=(0,a.cV)(j);q.displayName="LogRow";const ne=100;class oe extends s.PureComponent{constructor(){super(...arguments),this.renderAllTimer=null,this.logRowsRef=(0,s.createRef)(),this.state={renderAll:!1,selection:"",selectedRow:null,popoverMenuCoordinates:{x:0,y:0}},this.openContext=(le,ie)=>{this.props.onOpenContext&&this.props.onOpenContext(le,ie)},this.handleSelection=(le,ie)=>{if(this.popoverMenuSupported()===!1)return!1;const ae=document.getSelection()?.toString();if(!ae||!this.logRowsRef.current)return!1;const re=270,ce=105,me=le.clientX+re>window.innerWidth?window.innerWidth-re:le.clientX,ee=le.clientY+ce>window.innerHeight?window.innerHeight-ce:le.clientY;return this.setState({selection:ae,popoverMenuCoordinates:{x:me,y:ee},selectedRow:ie}),document.addEventListener("click",this.handleDeselection),document.addEventListener("contextmenu",this.handleDeselection),!0},this.handleDeselection=le=>{if((0,h.a8)(le.target)&&!this.logRowsRef.current?.contains(le.target)){this.closePopoverMenu();return}document.getSelection()?.toString()||this.closePopoverMenu()},this.closePopoverMenu=()=>{document.removeEventListener("click",this.handleDeselection),document.removeEventListener("contextmenu",this.handleDeselection),this.setState({selection:"",popoverMenuCoordinates:{x:0,y:0},selectedRow:null})},this.makeGetRows=(0,i.A)(le=>()=>le),this.sortLogs=(0,i.A)((le,ie)=>(0,h.oR)(le,ie))}static{this.defaultProps={previewLimit:ne}}popoverMenuSupported(){return f.$.featureToggles.logRowsPopoverMenu?!!(this.props.onClickFilterOutString||this.props.onClickFilterString):!1}componentDidMount(){const{logRows:le,previewLimit:ie}=this.props,re=(le?le.length:0)<=ie*2;re?this.setState({renderAll:re}):this.renderAllTimer=window.setTimeout(()=>this.setState({renderAll:!0}),2e3)}componentWillUnmount(){document.removeEventListener("click",this.handleDeselection),document.removeEventListener("contextmenu",this.handleDeselection),document.removeEventListener("selectionchange",this.handleDeselection),this.renderAllTimer&&clearTimeout(this.renderAllTimer)}render(){const{deduplicatedRows:le,logRows:ie,dedupStrategy:ae,theme:re,logsSortOrder:ce,previewLimit:me,pinnedLogs:ee,...de}=this.props,{renderAll:De}=this.state,fe=(0,U.D)(re),Te=le||ie,je=ie&&ie.length>0,He=Te?Te.reduce((Je,st)=>st.duplicates?Je+st.duplicates:Je,0):0,Be=ae!==r.fY.none&&He>0,Ne=Te||[],Re=ce?this.sortLogs(Ne,ce):Ne,Se=Re.slice(0,me),We=Re.slice(me,Re.length),Ke=this.makeGetRows(Re),Xe=new m;return(0,t.jsxs)("div",{className:fe.logRows,ref:this.logRowsRef,children:[this.state.selection&&this.state.selectedRow&&(0,t.jsx)(g,{close:this.closePopoverMenu,row:this.state.selectedRow,selection:this.state.selection,...this.state.popoverMenuCoordinates,onClickFilterString:de.onClickFilterString,onClickFilterOutString:de.onClickFilterOutString}),(0,t.jsx)("table",{className:(0,n.cx)(fe.logsRowsTable,this.props.overflowingContent?"":fe.logsRowsTableContain),children:(0,t.jsxs)("tbody",{children:[je&&Se.map(Je=>(0,t.jsx)(q,{getRows:Ke,row:Je,showDuplicates:Be,logsSortOrder:ce,onOpenContext:this.openContext,styles:fe,onPermalinkClick:this.props.onPermalinkClick,scrollIntoView:this.props.scrollIntoView,permalinkedRowId:this.props.permalinkedRowId,onPinLine:this.props.onPinLine,onUnpinLine:this.props.onUnpinLine,pinLineButtonTooltipTitle:this.props.pinLineButtonTooltipTitle,pinned:this.props.pinnedRowId===Je.uid||ee?.some(st=>st===Je.rowId),isFilterLabelActive:this.props.isFilterLabelActive,handleTextSelection:this.popoverMenuSupported()?this.handleSelection:void 0,...de},Xe.getKey(Je.uid))),je&&De&&We.map(Je=>(0,t.jsx)(q,{getRows:Ke,row:Je,showDuplicates:Be,logsSortOrder:ce,onOpenContext:this.openContext,styles:fe,onPermalinkClick:this.props.onPermalinkClick,scrollIntoView:this.props.scrollIntoView,permalinkedRowId:this.props.permalinkedRowId,onPinLine:this.props.onPinLine,onUnpinLine:this.props.onUnpinLine,pinLineButtonTooltipTitle:this.props.pinLineButtonTooltipTitle,pinned:this.props.pinnedRowId===Je.uid||ee?.some(st=>st===Je.rowId),isFilterLabelActive:this.props.isFilterLabelActive,handleTextSelection:this.popoverMenuSupported()?this.handleSelection:void 0,...de},Xe.getKey(Je.uid))),je&&!De&&(0,t.jsx)("tr",{children:(0,t.jsxs)("td",{colSpan:5,children:["Rendering ",Re.length-me," rows..."]})})]})})]})}}const z=(0,a.cV)(oe);z.displayName="LogsRows"},77020:(G,O,e)=>{"use strict";e.d(O,{D:()=>c,L:()=>a});var t=e(32196),n=e(41811),i=e(84140),s=e(9557),r=e(23596),f=e(16797);const a=(o,h)=>{let g=o.isLight?o.v1.palette.gray5:o.v1.palette.gray2;switch(h){case s.$b.crit:case s.$b.critical:g="#705da0";break;case s.$b.error:case s.$b.err:g="#e24d42";break;case s.$b.warning:case s.$b.warn:g=o.colors.warning.main;break;case s.$b.info:g="#7eb26d";break;case s.$b.debug:g="#1f78c1";break;case s.$b.trace:g="#6ed0e0";break}return{logsRowLevelColor:(0,t.css)`
      &::after {
        background-color: ${g};
      }
    `}},c=(0,n.A)(o=>{const h=f.hoverColor(o.colors.background.secondary,o),g=(0,i.A)(o.components.dashboard.background).setAlpha(.7).toRgbString();return{logsRowLevel:(0,t.css)`
      label: logs-row__level;
      max-width: ${o.spacing(1.25)};
      cursor: default;
      &::after {
        content: '';
        display: block;
        position: absolute;
        top: 1px;
        bottom: 1px;
        width: 3px;
        left: ${o.spacing(.5)};
      }
    `,logsRowWithError:(0,t.css)({maxWidth:`${o.spacing(1.5)}`}),logsRowMatchHighLight:(0,t.css)`
      label: logs-row__match-highlight;
      background: inherit;
      padding: inherit;
      color: ${o.components.textHighlight.text}
      background-color: ${o.components.textHighlight};
    `,logRows:(0,t.css)({position:"relative"}),logsRowsTable:(0,t.css)`
      label: logs-rows;
      font-family: ${o.typography.fontFamilyMonospace};
      font-size: ${o.typography.bodySmall.fontSize};
      width: 100%;
      position: relative;
    `,logsRowsTableContain:(0,t.css)`
      contain: strict;
    `,highlightBackground:(0,t.css)`
      background-color: ${(0,i.A)(o.colors.info.transparent).setAlpha(.25).toString()};
    `,logsRow:(0,t.css)`
      label: logs-row;
      width: 100%;
      cursor: pointer;
      vertical-align: top;

      &:hover {
        .log-row-menu {
          z-index: 1;
        }

        background: ${h};
      }

      td:not(.log-row-menu-cell):last-child {
        width: 100%;
      }

      > td:not(.log-row-menu-cell) {
        position: relative;
        padding-right: ${o.spacing(1)};
        border-top: 1px solid transparent;
        border-bottom: 1px solid transparent;
        height: 100%;
      }
    `,logsRowDuplicates:(0,t.css)`
      label: logs-row__duplicates;
      text-align: right;
      width: 4em;
      cursor: default;
    `,logIconError:(0,t.css)({color:o.colors.warning.main,position:"relative",top:"-2px"}),logIconInfo:(0,t.css)({color:o.colors.info.main,position:"relative",top:"-2px"}),logsRowToggleDetails:(0,t.css)`
      label: logs-row-toggle-details__level;
      font-size: 9px;
      padding-top: 5px;
      max-width: 15px;
    `,logsRowLocalTime:(0,t.css)`
      label: logs-row__localtime;
      white-space: nowrap;
    `,logsRowLabels:(0,t.css)`
      label: logs-row__labels;
      white-space: nowrap;
      max-width: 22em;

      /* This is to make the labels vertical align */
      > span {
        margin-top: 0.75px;
      }
    `,logsRowMessage:(0,t.css)`
      label: logs-row__message;
      white-space: pre-wrap;
      word-break: break-all;
      overflow-wrap: anywhere;
      width: 100%;
      text-align: left;
    `,copyLogButton:(0,t.css)`
      padding: 0 0 0 ${o.spacing(.5)};
      height: ${o.spacing(3)};
      width: ${o.spacing(3.25)};
      line-height: ${o.spacing(2.5)};
      overflow: hidden;
      &:hover {
          background-color: ${r.MV.alpha(o.colors.text.primary,.12)};
        }
      }
    `,logDetailsContainer:(0,t.css)`
      label: logs-row-details-table;
      border: 1px solid ${o.colors.border.medium};
      padding: 0 ${o.spacing(1)} ${o.spacing(1)};
      border-radius: ${o.shape.radius.default};
      margin: ${o.spacing(2.5)} ${o.spacing(1)} ${o.spacing(2.5)} ${o.spacing(2)};
      cursor: default;
    `,logDetailsTable:(0,t.css)`
      label: logs-row-details-table;
      line-height: 18px;
      width: 100%;
      td:last-child {
        width: 100%;
      }
    `,logsDetailsIcon:(0,t.css)`
      label: logs-row-details__icon;
      position: relative;
      color: ${o.v1.palette.gray3};
      padding-top: 1px;
      padding-bottom: 1px;
      padding-right: ${o.spacing(.75)};
    `,logDetailsLabel:(0,t.css)`
      label: logs-row-details__label;
      max-width: 30em;
      min-width: 20em;
      padding: 0 ${o.spacing(1)};
      overflow-wrap: break-word;
    `,logDetailsHeading:(0,t.css)`
      label: logs-row-details__heading;
      font-weight: ${o.typography.fontWeightBold};
      padding: ${o.spacing(1)} 0 ${o.spacing(.5)};
    `,logDetailsValue:(0,t.css)`
      label: logs-row-details__row;
      position: relative;
      vertical-align: middle;
      cursor: default;

      &:hover {
        background-color: ${h};
      }
    `,topVerticalAlign:(0,t.css)`
      label: topVerticalAlign;
      margin-top: -${o.spacing(.9)};
      margin-left: -${o.spacing(.25)};
    `,detailsOpen:(0,t.css)`
      &:hover {
        background-color: ${f.hoverColor(o.colors.background.primary,o)};
      }
    `,errorLogRow:(0,t.css)`
      label: erroredLogRow;
      color: ${o.colors.text.secondary};
    `,positionRelative:(0,t.css)`
      label: positionRelative;
      position: relative;
    `,rowWithContext:(0,t.css)`
      label: rowWithContext;
      z-index: 1;
      outline: 9999px solid ${g};
      display: inherit;
    `,horizontalScroll:(0,t.css)`
      label: horizontalScroll;
      white-space: pre;
    `,contextNewline:(0,t.css)`
      display: block;
      margin-left: 0px;
    `,rowMenu:(0,t.css)`
      label: rowMenu;
      display: flex;
      flex-wrap: nowrap;
      flex-direction: row;
      align-content: flex-end;
      justify-content: space-evenly;
      align-items: center;
      position: absolute;
      top: 0;
      bottom: auto;
      background: ${o.colors.background.primary};
      box-shadow: ${o.shadows.z3};
      padding: ${o.spacing(.5,1,.5,1)};
      z-index: 100;
      gap: ${o.spacing(.5)};

      & > button {
        margin: 0;
      }
    `,logRowMenuCell:(0,t.css)`
      position: sticky;
      z-index: ${o.zIndex.dropdown};
      margin-top: -${o.spacing(.125)};
      right: 0px;

      & > span {
        transform: translateX(-100%);
      }
    `,logLine:(0,t.css)`
      background-color: transparent;
      border: none;
      diplay: inline;
      font-family: ${o.typography.fontFamilyMonospace};
      font-size: ${o.typography.bodySmall.fontSize};
      letter-spacing: ${o.typography.bodySmall.letterSpacing};
      text-align: left;
      padding: 0;
      user-select: text;
    `,logsRowLevelDetails:(0,t.css)`
      label: logs-row__level_details;
      &::after {
        top: -3px;
      }
    `,logDetails:(0,t.css)`
      label: logDetailsDefaultCursor;
      cursor: default;

      &:hover {
        background-color: ${o.colors.background.primary};
      }
    `,visibleRowMenu:(0,t.css)`
      label: visibleRowMenu;
      aspect-ratio: 1/1;
      z-index: 90;
    `,linkButton:(0,t.css)`
      label: linkButton;
      > button {
        padding-top: ${o.spacing(.5)};
      }
    `,hidden:(0,t.css)`
      label: hidden;
      visibility: hidden;
    `,unPinButton:(0,t.css)`
      height: ${o.spacing(3)};
      line-height: ${o.spacing(2.5)};
    `}})},81166:(G,O,e)=>{"use strict";e.d(O,{V:()=>U});var t=e(74848),n=e(32196),i=e(2543),s=e(96540),r=e(16817),f=e(39070),a=e(52622),c=e(9557),o=e(47232),h=e(14110),g=e(32264),l=e(40845),p=e(37390),m=e(55852),y=e(33390),d=e(97186),v=e(29436),u=e(31678),D=e(69147),P=e(91002),x=e(81073),E=e(14647),C=e(15292);function M(W){return{buttons:(0,n.css)({display:"flex",gap:W.spacing(1)})}}const S=W=>{const w=(0,l.of)(M),{wrapLines:N,onChangeWrapLines:B,onScrollCenterClick:V}=W,K=(0,s.useCallback)(H=>{const X=H.currentTarget.checked;(0,h.rR)("grafana_explore_logs_log_context_toggle_lines_clicked",{state:X}),B(X)},[B]);return(0,t.jsxs)("div",{className:w.buttons,children:[(0,t.jsx)(C.K,{showLabel:!0,value:N,onChange:K,label:"Wrap lines"}),(0,t.jsx)(m.$n,{variant:"secondary",onClick:V,children:"Center matched line"})]})},I=W=>({modal:(0,n.css)`
      width: 85vw;
      ${W.breakpoints.down("md")} {
        width: 100%;
      }
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    `,sticky:(0,n.css)`
      position: sticky;
      z-index: 1;
      top: -1px;
      bottom: -1px;
    `,entry:(0,n.css)`
      & > td {
        padding: ${W.spacing(1)} 0 ${W.spacing(1)} 0;
      }
      background: ${W.colors.emphasize(W.colors.background.secondary)};

      & > table {
        margin-bottom: 0;
      }

      & .log-row-menu {
        margin-top: -6px;
      }
    `,datasourceUi:(0,n.css)`
      padding-bottom: ${W.spacing(1.25)};
      display: flex;
      align-items: center;
    `,logRowGroups:(0,n.css)`
      overflow: auto;
      max-height: 75%;
      align-self: stretch;
      display: inline-block;
      border: 1px solid ${W.colors.border.weak};
      border-radius: ${W.shape.radius.default};
      & > table {
        min-width: 100%;
      }
    `,flexColumn:(0,n.css)`
      display: flex;
      flex-direction: column;
      padding: 0 ${W.spacing(3)} ${W.spacing(3)} ${W.spacing(3)};
    `,flexRow:(0,n.css)`
      display: flex;
      flex-direction: row;
      align-items: center;
      & > div:last-child {
        margin-left: auto;
      }
    `,noMarginBottom:(0,n.css)`
      & > table {
        margin-bottom: 0;
      }
    `,hidden:(0,n.css)`
      display: none;
    `,paddingTop:(0,n.css)`
      padding-top: ${W.spacing(1)};
    `,paddingBottom:(0,n.css)`
      padding-bottom: ${W.spacing(1)};
    `,link:(0,n.css)`
      color: ${W.colors.text.secondary};
      font-size: ${W.typography.bodySmall.fontSize};
      :hover {
        color: ${W.colors.text.link};
      }
    `,loadingCell:(0,n.css)`
      position: sticky;
      left: 50%;
      display: inline-block;
      transform: translateX(-50%);
    `}),T=()=>({above:{loadingState:f.Gu.NotStarted,rows:[]},below:{loadingState:f.Gu.NotStarted,rows:[]}}),b=(W,w)=>W==="above"&&w===a.uH.Descending||W==="below"&&w===a.uH.Ascending?c.ZF.Forward:c.ZF.Backward,R=(W,w)=>({...W,dataFrame:{...W.dataFrame,refId:`context_${w.above}_${w.below}`}}),A=(W,w)=>W.some(N=>N.entry===w.entry&&N.timeEpochNs===w.timeEpochNs),L=100,U=({row:W,open:w,logsSortOrder:N,timeZone:B,getLogRowContextUi:V,getRowContextQuery:K,onClose:H,getRowContext:X})=>{const k=(0,s.useRef)(null),Y=(0,s.useRef)(null),Z=(0,s.useRef)(null),se=(0,s.useRef)(null),j=(0,s.useRef)(null),q=(0,s.useRef)(null),ne=(0,s.useRef)(null),oe=(0,s.useRef)({above:0,below:0}),z=(0,u.useDispatch)(),te=(0,l.$j)(),le=I(te),[ie,ae]=(0,s.useState)(!0),[re,ce]=(0,s.useState)(T()),me=(ot,$e)=>{ce(ve=>{const be={...ve};return be[ot]=$e(ve[ot]),be})},ee=(0,s.useRef)(1),[de,De]=(0,s.useState)(null),[fe,Te]=(0,s.useState)(y.A.getBool(d.$.logContextWrapLogMessage,y.A.getBool(d.$.wrapLogMessage,!0))),je=(0,s.useCallback)(()=>{const{below:ot,above:$e}=re,ve=(0,P.oR)([...ot.rows,W,...$e.rows],a.uH.Ascending),be=ve[0].timeEpochMs;let he=ve[ve.length-1].timeEpochMs;be===he&&(he+=1);const ye=(0,o.KQ)(be),Pe=(0,o.KQ)(he);return{from:ye,to:Pe,raw:{from:ye,to:Pe}}},[re,W]),He=(0,s.useCallback)(async()=>{const ot=K?await K(W):null;De(ot)},[W,K]),Be=async()=>{await He(),ce(T()),oe.current={above:0,below:0},ee.current+=1},Ne=async(ot,$e)=>{oe.current[ot]+=1;const ve=$e.at(ot==="above"?0:-1);if(ve==null)throw new Error("should never happen. the array always contains at least 1 item (the middle row)");(0,h.rR)("grafana_explore_logs_log_context_load_more_called",{datasourceType:ve.datasourceType,above:oe.current.above,below:oe.current.below});const be=b(ot,N),he=await X(R(ve,oe.current),{limit:L,direction:be}),ye=(0,D.HT)(he.data).rows;return N===a.uH.Ascending&&ye.reverse(),ye.filter(ge=>!A($e,ge))};(0,s.useEffect)(()=>{w&&He()},[He,w]);const[Re,Se]=(0,s.useState)([]),We=ot=>{Re.indexOf(ot)===-1&&Se([...Re,ot])},Ke=ot=>{const $e=Re.indexOf(ot);$e>-1&&(Re.splice($e,1),Se([...Re]))},Xe=async ot=>{const{below:$e,above:ve}=re;if(re[ot].loadingState===f.Gu.Loading)return;me(ot,ye=>({...ye,loadingState:f.Gu.Loading}));const he=ee.current;try{const ye=[...ve.rows,W,...$e.rows],Pe=(await Ne(ot,ye)).map(Ie=>!Ie.searchWords||!Ie.searchWords?.length?{...Ie,searchWords:W.searchWords}:Ie),[ge,xe]=(0,i.partition)(Pe,Ie=>Ie.timeEpochNs>W.timeEpochNs),Ae=N===a.uH.Ascending?xe:ge,Ee=N===a.uH.Ascending?ge:xe;he===ee.current&&ce(Ie=>{const Qe=Ae.length>0?(0,P.oR)([...Ae,...Ie.above.rows],N):Ie.above.rows,at=Ee.length>0?(0,P.oR)([...Ie.below.rows,...Ee],N):Ie.below.rows;return{above:{rows:Qe,loadingState:ot==="above"?Pe.length===0?f.Gu.Done:f.Gu.NotStarted:Ie.above.loadingState},below:{rows:at,loadingState:ot==="below"?Pe.length===0?f.Gu.Done:f.Gu.NotStarted:Ie.below.loadingState}}})}catch{me(ot,ye=>({rows:ye.rows,loadingState:f.Gu.Error}))}},Je=async(ot,$e)=>{for(const ve of ot){if(!ve.isIntersecting)continue;const be=ve.target;be===q.current?Xe("above"):be===ne.current&&Xe("below")}};(0,s.useEffect)(()=>{const ot=k.current,$e=q.current,ve=ne.current;if(ot==null)return;const be=new IntersectionObserver(Je,{root:ot});return $e!=null&&be.observe($e),ve!=null&&be.observe(ve),()=>{be.disconnect()}});const st=(0,s.useCallback)(()=>{Z.current?.scrollIntoView({block:"center"}),Y.current?.scrollIntoView({block:"center"})},[Z,Y]);(0,s.useLayoutEffect)(()=>{const ot=k.current;if(ot==null)return;const $e=j.current,ve=ot.clientHeight;if(j.current=ve,$e!==ve){st();return}if(oe.current.above<=1&&oe.current.below<=1){st();return}const be=se.current,he=ot.scrollHeight;if(se.current=he,be!=null){const ye=ot.scrollTop+(he-be);ot.scrollTop=ye}},[re.above.rows,st]),(0,r.A)(He,[K,W]);const pt=re.above.loadingState,xt=re.below.loadingState;return(0,t.jsxs)(p.a,{isOpen:w,title:"Log context",contentClassName:le.flexColumn,className:le.modal,onDismiss:H,children:[g.$.featureToggles.logsContextDatasourceUi&&V&&(0,t.jsx)("div",{className:le.datasourceUi,children:V(W,Be)}),(0,t.jsx)("div",{className:(0,n.cx)(le.flexRow,le.paddingBottom),children:(0,t.jsx)("div",{children:(0,t.jsx)(S,{wrapLines:fe,onChangeWrapLines:Te,onScrollCenterClick:st})})}),(0,t.jsx)("div",{ref:k,className:le.logRowGroups,children:(0,t.jsx)("table",{children:(0,t.jsxs)("tbody",{children:[(0,t.jsx)("tr",{children:(0,t.jsxs)("td",{className:le.loadingCell,children:[pt!==f.Gu.Done&&pt!==f.Gu.Error&&(0,t.jsx)("div",{ref:q,children:(0,t.jsx)(x.I,{adjective:"newer"})}),pt===f.Gu.Error&&(0,t.jsx)("div",{children:"Error loading log more logs."}),pt===f.Gu.Done&&(0,t.jsx)("div",{children:"No more logs available."})]})}),(0,t.jsx)("tr",{children:(0,t.jsx)("td",{className:le.noMarginBottom,children:(0,t.jsx)(E.k,{logRows:re.above.rows,dedupStrategy:a.fY.none,showLabels:y.A.getBool(d.$.showLabels,!1),showTime:y.A.getBool(d.$.showTime,!0),wrapLogMessage:fe,prettifyLogMessage:y.A.getBool(d.$.prettifyLogMessage,!1),enableLogDetails:!0,timeZone:B,displayedFields:Re,onClickShowField:We,onClickHideField:Ke})})}),(0,t.jsx)("tr",{ref:Z}),(0,t.jsx)("tr",{ref:Y,className:(0,n.cx)(le.entry,ie?le.sticky:null),"data-testid":"entry-row",children:(0,t.jsx)("td",{className:le.noMarginBottom,children:(0,t.jsx)(E.k,{logRows:[W],dedupStrategy:a.fY.none,showLabels:y.A.getBool(d.$.showLabels,!1),showTime:y.A.getBool(d.$.showTime,!0),wrapLogMessage:fe,prettifyLogMessage:y.A.getBool(d.$.prettifyLogMessage,!1),enableLogDetails:!0,timeZone:B,displayedFields:Re,onClickShowField:We,onClickHideField:Ke,onUnpinLine:()=>ae(!1),onPinLine:()=>ae(!0),pinnedRowId:ie?W.uid:void 0,overflowingContent:!0})})}),(0,t.jsx)("tr",{children:(0,t.jsx)("td",{children:(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(E.k,{logRows:re.below.rows,dedupStrategy:a.fY.none,showLabels:y.A.getBool(d.$.showLabels,!1),showTime:y.A.getBool(d.$.showTime,!0),wrapLogMessage:fe,prettifyLogMessage:y.A.getBool(d.$.prettifyLogMessage,!1),enableLogDetails:!0,timeZone:B,displayedFields:Re,onClickShowField:We,onClickHideField:Ke})})})}),(0,t.jsx)("tr",{children:(0,t.jsxs)("td",{className:le.loadingCell,children:[xt!==f.Gu.Done&&xt!==f.Gu.Error&&(0,t.jsx)("div",{ref:ne,children:(0,t.jsx)(x.I,{adjective:"older"})}),xt===f.Gu.Error&&(0,t.jsx)("div",{children:"Error loading log more logs."}),xt===f.Gu.Done&&(0,t.jsx)("div",{children:"No more logs available."})]})})]})})}),(0,t.jsx)(p.a.ButtonRow,{children:de?.datasource?.uid&&(0,t.jsx)(m.$n,{variant:"secondary",onClick:async()=>{let ot=W.uid;W.dataFrame.refId&&(ot=W.uid.replace(W.dataFrame.refId,de.refId)),z((0,v.ve)({queries:[de],range:je(),datasourceUid:de.datasource.uid,panelsState:{logs:{id:ot}}})),H(),(0,h.rR)("grafana_explore_logs_log_context_open_split_view_clicked",{datasourceType:W.datasourceType,logRowUid:W.uid})},children:"Open in split view"})})]})}},70377:(G,O,e)=>{"use strict";e.d(O,{FE:()=>a,jE:()=>r,qE:()=>f});var t=e(2543),n=e.n(t),i=e(87490),s=e(98101);const r=(g,l)=>a(g,l),f=g=>{let l=[];return g.forEach(p=>{p.links?.forEach(m=>{if(m.variables){const y=m.variables.map(v=>{const u=v.variableName,D=v.fieldPath?`.${v.fieldPath}`:"";return`${u}${D}`}),d=m.variables.map(v=>v.found?v.value:"");l.push({keys:y,values:d,links:[m],fieldIndex:p.fieldIndex})}})}),l},a=(g,l)=>h(g).map(m=>{const y=l?l(m,g.rowIndex,g.dataFrame):[],d=m.values[g.rowIndex],v=typeof d=="string"||typeof d=="number"?d.toString():(0,i.MA)(d);return{keys:[m.name],values:[v],links:y,fieldIndex:m.index}});function c(g,l){const p=(0,s.O)(g);if(p===null)return new Set;const m=new Set(p.extraFields.map(y=>y.index));return p.severityField!==null&&m.add(p.severityField.index),l.keepBody&&m.add(p.bodyField.index),l.keepTimestamp&&m.add(p.timeField.index),m}function o(g,l){const p=g.fields.map((v,u)=>({...v,index:u})),m=c(g,l??{}),[y,d]=partition(p,v=>v.config.custom?.hidden?!1:(v.config.links??[]).length>0?!0:m.has(v.index));return{visible:y,hidden:d}}function h(g,l){const p=g.dataFrame,m=c(p,l??{}),y=[];for(let d=0;d<p.fields.length;d++){const v=p.fields[d];v.values[g.rowIndex]!=null&&(v.config.custom?.hidden||(v.config.links&&v.config.links.length>0||m.has(d))&&y.push({...v,index:d}))}return y}},98101:(G,O,e)=>{"use strict";e.d(O,{n:()=>p,O:()=>y});var t=e(85404),n=e(11261),i=e(41260);function s(d,v){const u=d.labels;if(u!==void 0){const D=new Array(v);return D.fill(u),D}else return null}function r(d,v,u){const D=d.getFieldByName("labels");if(D!==void 0&&D.type===n.PU.other){const P=D.values.map(p);return[D,()=>P]}else return[null,()=>s(v,u.length)]}function f(d){const v=new t.L(d),u=v.getFirstFieldOfType(n.PU.time),D=v.getFirstFieldOfType(n.PU.string);if(u===void 0||D===void 0)return null;const P=v.getFieldByName("tsNs")??null,x=v.getFieldByName("level")??null,E=v.getFieldByName("id")??null,[C,M]=r(v,D,d),S=v.fields.filter((I,T)=>T!==u.index&&T!==D.index&&T!==P?.index&&T!==x?.index&&T!==E?.index&&T!==C?.index);return{timeField:u,bodyField:D,timeNanosecondField:P,severityField:x,idField:E,getLogFrameLabels:M,getLogFrameLabelsAsLabels:M,getLabelFieldName:()=>C?.name??null,extraFields:S}}function a(d,v,u){const D=d.getFieldByName(v);if(D!==void 0)return D.type===u?D:void 0}const c="timestamp",o="body",h="severity",g="id",l="labels";function p(d){const v={};return Object.entries(d).forEach(([u,D])=>{v[u]=typeof D=="string"?D:JSON.stringify(D)}),v}function m(d){const v=new t.L(d),u=a(v,c,n.PU.time),D=a(v,o,n.PU.string);if(u===void 0||D===void 0)return null;const P=a(v,h,n.PU.string)??null,x=a(v,g,n.PU.string)??null,E=a(v,l,n.PU.other)??null,C=E===null?null:E.values,M=v.fields.filter((S,I)=>I!==u.index&&I!==D.index&&I!==P?.index&&I!==x?.index&&I!==E?.index);return{timeField:u,bodyField:D,severityField:P,idField:x,getLogFrameLabels:()=>C,timeNanosecondField:null,getLogFrameLabelsAsLabels:()=>C!==null?C.map(p):null,getLabelFieldName:()=>E!==null?E.name:null,extraFields:M}}function y(d){return d.meta?.type===i.m.LogLines?m(d):f(d)}},69147:(G,O,e)=>{"use strict";e.d(O,{yR:()=>I,cZ:()=>T,HT:()=>H,M0:()=>N,ct:()=>B,f8:()=>ie,J9:()=>V,Wr:()=>te,sg:()=>z});var t=e(2543),n=e(88483),i=e(50832),s=e(65474),r=e(9557),f=e(52622),a=e(14236),c=e(85404),o=e(11261),h=e(24293),g=e(47232),l=e(8249),p=e(80997),m=e(72724),y=e(65879),d=e(39070),v=e(26517),u=e(32264),D=e(24284),P=e(88838),x=e(2913);function E(ae,re){return x.Ay.bootData?.user?.lightTheme?re:ae}var C=e(98101),M=e(91002);const S="Line limit",I="Common labels",T={[r.$b.critical]:D.Tj[7],[r.$b.error]:D.Tj[4],[r.$b.warning]:D.Tj[1],[r.$b.info]:D.Tj[0],[r.$b.debug]:D.Tj[5],[r.$b.trace]:D.Tj[2],[r.$b.unknown]:E("#8e8e8e","#bdc4cd")},b=1,R=1e3*b,A=60*R,L=60*A,U=24*L,W=/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-6]\d[,\.]\d+([+-][0-2]\d:[0-5]\d|Z)/g;function w(ae,re,ce){switch(ce){case f.fY.exact:return ae.entry.replace(W,"")===re.entry.replace(W,"");case f.fY.numbers:return ae.entry.replace(/\d/g,"")===re.entry.replace(/\d/g,"");case f.fY.signature:return ae.entry.replace(/\w/g,"")===re.entry.replace(/\w/g,"");default:return!1}}function N(ae,re){return re===f.fY.none?ae:ae.reduce((ce,me,ee)=>{const de={...me},De=ce[ce.length-1];return ee>0&&w(me,De,re)?De.duplicates++:(de.duplicates=0,ce.push(de)),ce},[])}function B(ae,re){return re.size===0?ae:ae.filter(ce=>!re.has(ce.logLevel))}function V(ae,re){const ce={},me=[];for(const ee of ae){let de=ce[ee.logLevel];de||(ce[ee.logLevel]=de={lastTs:null,datapoints:[],target:ee.logLevel,color:T[ee.logLevel]},me.push(de));const De=Math.floor(ee.timeEpochMs/re)*re;De===de.lastTs?de.datapoints[de.datapoints.length-1][0]++:(de.datapoints.push([1,De]),de.lastTs=De);for(const fe of me)fe!==de&&fe.lastTs!==De&&(fe.datapoints.push([0,De]),fe.lastTs=De)}return me.map((ee,de)=>{ee.datapoints.sort((je,He)=>je[1]-He[1]);const De=(0,a.Vc)(ee),Te=new c.L(De).getFirstFieldOfType(o.PU.number);return De.fields[Te.index].config.min=0,De.fields[Te.index].config.decimals=0,De.fields[Te.index].config.color={mode:h.Y.Fixed,fixedColor:ee.color},De.fields[Te.index].config.custom={drawStyle:f.GR.Bars,barAlignment:f.Nj.Center,barWidthFactor:.9,barMaxWidth:5,lineColor:ee.color,pointColor:ee.color,fillColor:ee.color,lineWidth:0,fillOpacity:100,stacking:{mode:f.gs.Normal,group:"A"}},De})}function K(ae){return ae.fields.some(re=>re.type===o.PU.time)&&ae.fields.some(re=>re.type===o.PU.string)}function H(ae,re,ce,me,ee){const{logSeries:de}=k(ae),De=Z(de,me,!!ee);if(De){if(re&&De.rows.length>0){const fe=De.rows.sort(M.M1),{visibleRange:Te,bucketSize:je,visibleRangeMs:He,requestedRangeMs:Be}=X(fe,re,ce);De.visibleRange=Te,De.bucketSize=je,De.series=V(fe,je),De.meta&&(De.meta=se(De,He,Be))}else De.series=[];return De.queries=me,De}return{hasUniqueLabels:!1,rows:[],meta:[],series:[],queries:me}}function X(ae,re,ce,me=20,ee=1e3){let de=ce,De=re,fe=Math.max(De*me,ee),Te,je;if(ce){const He=ae[0].timeEpochMs;if(je=ce.to-ce.from,Te=ce.to-He,Te>0){const Be=Te/je;De*=Be,fe=Math.max(Math.ceil(De*me),ee),de={from:Math.floor(He/fe)*fe,to:ce.to}}else Te=1}return{bucketSize:fe,visibleRange:de,visibleRangeMs:Te,requestedRangeMs:je}}function k(ae){const re=[],ce=[];for(const me of ae){if(K(me)||!me.fields.length){ce.push(me);continue}me.length>0&&re.push(me)}return{logSeries:ce,metricSeries:re}}function Y(ae,re,ce){const me=ae.values[ce],de=(0,g.yT)(me).valueOf();if(re)return{ts:me,timeEpochMs:de,timeEpochNs:re.values[ce]};if(ae.nanos!==void 0){const De=ae.nanos[ce].toString().padStart(6,"0"),fe=`${de}${De}`;return{ts:me,timeEpochMs:de,timeEpochNs:fe}}return{ts:me,timeEpochMs:de,timeEpochNs:de+"000000"}}function Z(ae,re=[],ce=!1){if(ae.length===0)return;const me=[];let ee=[];const de=ae.filter(Je=>Je.fields.length);de.length&&de.forEach(Je=>{const st=(0,C.O)(Je);if(st!=null){const pt=st.getLogFrameLabelsAsLabels()??void 0,xt={rawFrame:Je,logsFrame:st,frameLabels:pt};ee.push(xt),pt&&pt.length>0&&me.push(pt)}});const De=me.flat(),fe=De.length>0?(0,l.yO)(De):{};let Te=[],je=!1;const He=(0,M.kA)();for(const Je of ee){const{logsFrame:st,rawFrame:pt,frameLabels:xt}=Je,{timeField:ot,timeNanosecondField:$e,bodyField:ve,severityField:be,idField:he}=st;for(let ye=0;ye<pt.length;ye++){const{ts:Pe,timeEpochMs:ge,timeEpochNs:xe}=Y(ot,$e??void 0,ye),Ae=ve.values[ye]??"",Ee=typeof Ae=="string"?Ae:JSON.stringify(Ae),Ie=p.sQ.hasAnsiCodes(Ee),Qe=!!Ee.match(/\\n|\\t|\\r/),at=pt.meta?.custom?.searchWords??pt.meta?.searchWords??[],ft=Ie?P.DB.strip(Ee):Ee,ct=xt?.[ye],vt=(0,l.s6)(ct,fe);Object.keys(vt).length>0&&(je=!0);let Pt=r.$b.unknown;const Vt=be&&be.values[ye]||ct&&ct.level;typeof Vt=="number"||typeof Vt=="string"?Pt=(0,M.EK)(Vt):Pt=(0,M.XM)(ft);const Jt=re.find(zt=>zt.refId===pt.refId)?.datasource?.type,wt={entryFieldIndex:ve.index,rowIndex:ye,dataFrame:pt,logLevel:Pt,timeFromNow:(0,m.fq)(Pe),timeEpochMs:ge,timeEpochNs:xe,timeLocal:(0,m.LE)(Pe,{timeZone:"browser"}),timeUtc:(0,m.LE)(Pe,{timeZone:"utc"}),uniqueLabels:vt,hasAnsi:Ie,hasUnescapedContent:Qe,searchWords:at,entry:ft,raw:Ee,labels:ct||{},uid:`${pt.refId}_${he?he.values[ye]:ye.toString()}`,datasourceType:Jt};he!==null&&(wt.rowId=he.values[ye]),!(ce&&He(wt))&&Te.push(wt)}}const Be=[];(0,t.size)(fe)>0&&Be.push({label:I,value:fe,kind:r.tG.LabelsMap});const Re=ae.filter(Je=>Je?.meta?.custom?.limit??Je?.meta?.limit).reduce((Je,st)=>(Je[st.refId??""]=st.meta?.custom?.limit??st.meta?.limit??0,Je),{}),Se=Object.values(Re).reduce((Je,st)=>Je+=st,0);Se>0&&Be.push({label:S,value:Se,kind:r.tG.Number});let We=0;const Ke={};let Xe=!1;for(const Je of ae){const st=Je.meta?.custom?.lokiQueryStatKey,{refId:pt}=Je;if(!Xe&&Je.meta?.custom?.error&&(Be.push({label:"",value:Je.meta?.custom.error,kind:r.tG.Error}),Xe=!0),pt&&!Ke[pt]){if(st&&Je.meta?.stats){const xt=Je.meta.stats.find(ot=>ot.displayName===st);xt&&(We+=xt.value)}Ke[pt]=!0}}if(We>0){const{text:Je,suffix:st}=(0,v.rT)("B")(We);Be.push({label:"Total bytes processed",value:`${Je} ${st}`,kind:r.tG.String})}return{hasUniqueLabels:je,meta:Be,rows:Te}}function se(ae,re,ce){if(!ae.meta)return[];let me=[...ae.meta];const ee=me.findIndex(De=>De.label===S),de=ee>=0&&me[ee]?.value;if(de&&typeof de=="number"&&de>0){let De;if(de===ae.rows.length&&re&&ce){const fe=(re/ce*100).toFixed(2);De=`${de} reached, received logs cover ${fe}% (${y.msRangeToTimeString(re)}) of your selected time range (${y.msRangeToTimeString(ce)})`}else{const fe=u.$.featureToggles.logsInfiniteScrolling?"displayed":"returned";De=`${de} (${ae.rows.length} ${fe})`}me[ee]={label:S,value:De,kind:r.tG.String}}return me}function j(ae,re){const ce=re&&ae===r.$b.unknown?"logs":ae,me=T[ae];return{displayNameFromDS:ce,color:{mode:h.Y.Fixed,fixedColor:me},custom:{drawStyle:f.GR.Bars,barAlignment:f.Nj.Center,lineColor:me,pointColor:me,fillColor:me,lineWidth:1,fillOpacity:100,stacking:{mode:f.gs.Normal,group:"A"}}}}const q=(ae,re,ce)=>(ae.fields=ae.fields.map(me=>(me.type===o.PU.number&&(me.config={...me.config,...j(re(ae),ce)}),me)),ae);function ne(ae){let re;try{re=new c.L(ae).getFirstFieldOfType(o.PU.number)}catch{}return re?.labels?oe(re.labels):r.$b.unknown}function oe(ae){const re=ae.level??ae.lvl??ae.loglevel??"";return re?(0,M.EK)(re):r.$b.unknown}function z(ae,re,ce){const me=re.range,ee=ce.targets,de=ne,De=me.to.valueOf()-me.from.valueOf(),fe=le(re.scopedVars,De);return re.interval=fe.interval,re.scopedVars.__interval={value:fe.interval,text:fe.interval},fe.intervalMs!==void 0&&(re.intervalMs=fe.intervalMs,re.scopedVars.__interval_ms={value:fe.intervalMs,text:fe.intervalMs}),re.hideFromInspector=!0,new n.c(Te=>{let je=[];Te.next({state:d.Gu.Loading,error:void 0,data:[]});const He=ae.query(re),Ne=((0,i.A)(He)?He:(0,s.H)(He)).subscribe({complete:()=>{Te.complete()},next:Re=>{const{error:Se}=Re;if(Se!==void 0)Te.next({state:d.Gu.Error,error:Se,data:[]}),Te.error(Se);else{const We=(0,t.groupBy)(Re.data,"refId");je=Re.data.map(Ke=>{if(Ke.meta?.dataTopic===f.QR.Annotations)return Ke;let Xe=Ke.refId||"";Xe.startsWith("log-volume-")&&(Xe=Xe.substr(11));const Je={logsVolumeType:r.Aj.FullRange,absoluteRange:{from:me.from.valueOf(),to:me.to.valueOf()},datasourceName:ae.name,sourceQuery:ee.find(st=>st.refId===Xe)};return Ke.meta={...Ke.meta,custom:{...Ke.meta?.custom,...Je}},q(Ke,de,We[Ke.refId].length===1)}),Te.next({state:Re.state,error:void 0,data:je})}},error:Re=>{Te.next({state:d.Gu.Error,error:Re,data:[]}),Te.error(Re)}});return()=>{Ne?.unsubscribe()}})}function te(ae,re){return re.hideFromInspector=!0,new n.c(ce=>{let me=[];ce.next({state:d.Gu.Loading,error:void 0,data:[]});const ee=ae.query(re),De=((0,i.A)(ee)?ee:(0,s.H)(ee)).subscribe({complete:()=>{ce.next({state:d.Gu.Done,error:void 0,data:me}),ce.complete()},next:fe=>{const{error:Te}=fe;Te!==void 0?(ce.next({state:d.Gu.Error,error:Te,data:[]}),ce.error(Te)):me=fe.data.map(je=>{const He=(0,a.Vc)(je),{timeIndex:Be}=(0,a.KR)(He);return(0,a.ES)(He,Be)})},error:fe=>{ce.next({state:d.Gu.Error,error:fe,data:[]}),ce.error(fe)}});return()=>{De?.unsubscribe()}})}function le(ae,re){if(ae.__interval_ms){let ce=ae.__interval_ms.value,me="";return re<R*5?(ce=b,me="1ms"):ce>L?(ce=U,me="1d"):ce>A?(ce=L,me="1h"):ce>R?(ce=A,me="1m"):(ce=R,me="1s"),{interval:me,intervalMs:ce}}else return{interval:"$__interval"}}function ie(ae){const re=ae.dataFrame;return re.length===0||re.length<=ae.rowIndex?null:(0,a.EI)({fields:re.fields.map(me=>({...me,values:[me.values[ae.rowIndex]]})),refId:re.refId})}},91002:(G,O,e)=>{"use strict";e.d(O,{Dg:()=>x,Dk:()=>I,Dm:()=>M,Dx:()=>E,EK:()=>h,Ei:()=>u,Hw:()=>P,M1:()=>m,Tj:()=>g,XM:()=>o,a8:()=>b,e3:()=>S,kA:()=>R,oR:()=>v,oT:()=>C,qR:()=>D,s2:()=>l,tX:()=>T,zy:()=>d});var t=e(2543),n=e.n(t),i=e(9557),s=e(52622),r=e(37471),f=e(11261),a=e(85404),c=e(70377);function o(A){if(!A)return i.$b.unknown;let L=i.$b.unknown,U;for(const[W,w]of Object.entries(i.$b)){const B=new RegExp(`\\b${W}\\b`,"i").exec(A);B&&(U===void 0||B.index<U)&&(L=w,U=B.index)}return L}function h(A){const L=i.$b[A.toString().toLowerCase()];if(L)return L;if(typeof A=="string"){const U=parseInt(A,10);if(A.length===U.toString().length)return i.s5[A]||i.$b.unknown}else if(typeof A=="number")return i.s5[A]||i.$b.unknown;return i.$b.unknown}function g(A,L){const U=A.filter(N=>N.labels[L]!==void 0),W=U.length,w=(0,t.countBy)(U,N=>N.labels[L]);return p(w,W)}function l(A){const L=A.filter(W=>W!=null),U=(0,t.countBy)(L);return p(U,L.length)}const p=(A,L)=>(0,t.chain)(A).map((U,W)=>({count:U,value:W,proportion:U/L})).sortBy("count").reverse().value(),m=(A,L)=>A.timeEpochMs<L.timeEpochMs?-1:A.timeEpochMs>L.timeEpochMs?1:A.timeEpochNs<L.timeEpochNs?-1:A.timeEpochNs>L.timeEpochNs?1:0,y=(A,L)=>A.timeEpochMs>L.timeEpochMs?-1:A.timeEpochMs<L.timeEpochMs?1:A.timeEpochNs>L.timeEpochNs?-1:A.timeEpochNs<L.timeEpochNs?1:0,d=(A,L)=>{const U=A?v(A.rows,L):[];return A?{...A,rows:U}:{hasUniqueLabels:!1,rows:U}},v=(A,L)=>L===s.uH.Ascending?A.sort(m):A.sort(y),u=A=>A.labels.__error__?{hasError:!0,errorMessage:A.labels.__error__}:{hasError:!1},D=A=>A.labels.__adaptive_logs_sampled__?{isSampled:!0,sampleMessage:A.labels.__adaptive_logs_sampled__==="true"?"Logs like this one have been dropped by Adaptive Logs":`${A.labels.__adaptive_logs_sampled__}% of logs like this one have been dropped by Adaptive Logs`}:{isSampled:!1},P=A=>A.replace(/\\r\\n|\\n|\\t|\\r/g,L=>L.slice(1)==="t"?"	":`
`);function x(A){return A.map(L=>{const U=(0,c.FE)(L).reduce((W,w)=>{const N=w.keys[0];return W[N]=w.values[0],W},{});return{line:L.entry,timestamp:L.timeEpochNs,fields:{...U,...L.labels}}})}const E=A=>{let L={from:1/0,to:-1/0};return A.forEach(U=>{const W=U.meta?.custom||{};W.absoluteRange?.from&&W.absoluteRange?.to&&(L={from:Math.min(L.from,W.absoluteRange.from),to:Math.max(L.to,W.absoluteRange.to)})}),L},C=A=>{if(A.length===0)throw new Error("Cannot aggregate data frames: there must be at least one data frame to aggregate");const L={},U={};let W=-1/0;const w={};let N=[];return A.forEach(B=>{const{level:V,valueField:K,timeField:H,length:X}=T(B);w[V]={meta:B.meta,valueFieldConfig:K.config,timeFieldConfig:H.config};for(let k=0;k<X;k++){const Y=H.values[k],Z=K.values[k];L[V]??={},L[V][Y]=(L[V][Y]||0)+Z,U[Y]=(U[Y]||0)+Z,W=Math.max(U[Y],W)}}),Object.keys(L).forEach(B=>{const V=new r.k,{meta:K,timeFieldConfig:H,valueFieldConfig:X}=w[B];V.name=B,V.meta=K,V.addField({name:"Time",type:f.PU.time,config:H}),V.addField({name:"Value",type:f.PU.number,config:X}),Object.entries(L[B]).sort((k,Y)=>Number(k[0])-Number(Y[0])).forEach(([k,Y])=>{V.add({Time:Number(k),Value:Y})}),N.push(V)}),{dataFrames:N,maximum:W}},M=A=>{const L=A[0]?.meta?.custom;return L&&L.datasourceName?{name:L.datasourceName}:null},S=A=>A[0]?.meta?.custom?.logsVolumeType===i.Aj.Limited,I=async(A,L)=>{if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(A);{const U=document.createElement("textarea");L.current?.appendChild(U),U.value=A,U.focus(),U.select(),document.execCommand("copy"),U.remove()}};function T(A){const L=new a.L(A),U=L.getFirstFieldOfType(f.PU.time),W=L.getFirstFieldOfType(f.PU.number);if(!U)throw new Error("Missing time field");if(!W)throw new Error("Missing value field");const w=W.config.displayNameFromDS||A.name||"logs",N=W.values.length;return{level:w,valueField:W,timeField:U,length:N}}function b(A){return A instanceof Element}function R(){const A=new Set;return function(L){let U=`${L.dataFrame.refId}_${L.rowId?L.rowId:`${L.timeEpochNs}_${L.entry}`}`;return A.has(U)?!0:(A.add(U),!1)}}},90591:(G,O,e)=>{"use strict";e.d(O,{m:()=>a});var t=e(74848),n=e(32196),i=e(40845),s=e(96374),r=e(8484);const f=({title:o})=>{const h=(0,i.of)(c);return(0,t.jsx)("p",{className:h.description,children:o?(0,r.t)("public-dashboard.delete-modal.revoke-nonorphaned-body-text","Are you sure you want to revoke this URL? The dashboard will no longer be public."):(0,r.t)("public-dashboard.delete-modal.revoke-orphaned-body-text","Orphaned public dashboard will no longer be public.")})},a=({dashboardTitle:o,onConfirm:h,onDismiss:g})=>{const l=(0,r.t)("public-dashboard.delete-modal.revoke-title","Revoke public URL");return(0,t.jsx)(s.u,{isOpen:!0,body:(0,t.jsx)(f,{title:o}),onConfirm:h,onDismiss:g,title:l,icon:"trash-alt",confirmText:l})},c=o=>({title:(0,n.css)`
    margin-bottom: ${o.spacing(1)};
  `,description:(0,n.css)`
    font-size: ${o.typography.body.fontSize};
  `})},71500:(G,O,e)=>{"use strict";e.d(O,{P:()=>s});var t=e(24439);class n extends Error{constructor(f,a){super(a),this.type=f}}class i{constructor(){this.rootName="general"}validateNewDashboardName(f,a){return this.validate(f,a,"A dashboard or a folder with the same name already exists")}validateNewFolderName(f){return this.validate(this.rootName,f,"A folder or dashboard in the general folder with the same name already exists")}async validate(f,a,c){a=(a||"").trim();const o=a.toLowerCase();if(a.length===0)throw new n("REQUIRED","Name is required");if(o===this.rootName)throw new n("EXISTING","This is a reserved name and cannot be used for a folder.");const g=await(0,t.getGrafanaSearcher)().search({kind:["dashboard"],query:a,location:f||"general"});for(const l of g.view)if(o===l.name.toLowerCase())throw new n("EXISTING",c)}}const s=new i},11230:(G,O,e)=>{"use strict";e.d(O,{A_:()=>w,FG:()=>P,Q9:()=>x,Ql:()=>U,c0:()=>L,iP:()=>l,rw:()=>g,vV:()=>b});var t=e(17172),n=e(19347),i=e(82467),s=e(3169),r=e(55314),f=e(28676),a=e(31678),c=e(57767),o=e(98796),h=e(88264);function g(B){return async V=>{try{V((0,h.f7)());const K=await(0,t.AI)().get(`/api/gnet/dashboards/${B}`);await V(u(K.json)),await V(y(K)),V(v())}catch(K){V((0,h.oQ)()),(0,t.NF)(K)&&V((0,i.dx)((0,s.gi)(K.data.message||K)))}}}function l(B){return async V=>{await V(u(B)),await V(d(B)),V(v())}}const p=(B,V)=>B?.usage?.libraryPanels?.filter(K=>V.inputs.libraryPanels.some(H=>H.state!==h.J7.Exists&&H.model.uid===K.uid));function m(B,V){let K=B.__inputs;if(V.inputs.libraryPanels?.length){const H=[];B.__inputs?.forEach(X=>{if(!X?.usage?.libraryPanels){H.push(X);return}const k=p(X,V);X.usage={libraryPanels:k},!!k?.length&&H.push(X)}),K=H}return{...B,__inputs:K}}function y(B){return(V,K)=>{const H=K().importDashboard,X=m(B.json,H);V((0,h.Rp)({...B,json:X}))}}function d(B){return(V,K)=>{const H=K().importDashboard,X=m(B,H);V((0,h.dd)(X))}}function v(){return(B,V)=>{const K=V().importDashboard.dashboard;if(K&&K.__inputs){const H=[];K.__inputs.forEach(X=>{const k={name:X.name,label:X.label,info:X.description,value:X.value,type:X.type,pluginId:X.pluginId,options:[]};k.description=C(X),X.type===h.NZ.DataSource?E(X,k):k.info||(k.info="Specify a string constant"),H.push(k)}),B((0,h.y3)(H))}}}function u(B){return async function(V){const K=await D(B);V((0,h.dW)(K))}}async function D(B){if(!B||!B.__elements)return[];const V=[];for(const K of Object.values(B.__elements)){if(K.kind!==o.i.Panel)continue;const H=K.model,{type:X,description:k}=H,{uid:Y,name:Z}=K,se={model:{model:H,uid:Y,name:Z,version:0,type:X,kind:o.i.Panel,description:k},state:h.J7.New};try{const j=await(0,c.Yr)(Y,!0);se.state=h.J7.Exists,se.model=j}catch(j){if(j.status!==404)throw j}V.push(se)}return V}function P(){return B=>{B((0,h.SN)())}}function x(B){return async(V,K)=>{const H=K().importDashboard.dashboard,X=K().importDashboard.inputs,k=[];B.dataSources?.forEach((Y,Z)=>{const se=X.dataSources[Z];k.push({name:se.name,type:se.type,pluginId:se.pluginId,value:Y.uid})}),B.constants?.forEach((Y,Z)=>{const se=X.constants[Z];k.push({value:Y,name:se.name,type:se.type})}),V(r.cU.endpoints.importDashboard.initiate({dashboard:{...H,title:B.title,uid:B.uid||H.uid},overwrite:!0,inputs:k,folderUid:B.folder.uid}))}}const E=(B,V)=>{(0,n.l)().getList({pluginId:B.pluginId}).length===0?V.info="No data sources of type "+B.pluginName+" found":V.info||(V.info="Select a "+B.pluginName+" data source")},C=B=>{if(B.usage&&B.usage.libraryPanels)return`List of affected library panels: ${B.usage.libraryPanels.reduce((K,H,X)=>X===0?H.name:`${K}, ${H.name}`,"")}`};async function M(B,V){const K={totalCount:B.length,successCount:0};for(const H of B)try{await R(H,V)!==null&&(K.successCount+=1)}catch(X){console.error("Failed to move a folder",X)}return K}function S(B,V,...K){return async H=>{try{const X=await B(...K);return Array.prototype.concat(H,[X])}catch(X){if(V)return H;throw X}}}function I(B,V){const K=[];for(const H of B)K.push(S(T,!0,H,!0));for(const H of V)K.push(S(w,!0,H,!0));return N(K)}function T(B,V){return getBackendSrv().delete(`/api/folders/${B}?forceDeleteRules=false`,void 0,{showSuccessAlert:V})}function b(B){return(0,t.AI)().post("/api/folders",B)}function R(B,V){const K={parentUid:V.uid};return getBackendSrv().post(`/api/folders/${B}/move`,K,{showErrorAlert:!1})}const A=1e3;function L(B,V,K=a.SearchQueryType.Folder){return(0,t.AI)().get("/api/search",{query:B,type:K,permission:V,limit:A})}function U(B){return(0,t.AI)().get(`/api/folders/${B}`)}function W(B){return getBackendSrv().get(`/api/folders/id/${B}`)}function w(B,V){return(0,f.n)().deleteDashboard(B,V)}function N(B){return B.reduce((V,K)=>Promise.resolve(V).then(K),[])}},88264:(G,O,e)=>{"use strict";e.d(O,{Ay:()=>d,J7:()=>r,NZ:()=>s,Rp:()=>h,SN:()=>c,V9:()=>f,dW:()=>l,dd:()=>g,f7:()=>m,oQ:()=>p,qx:()=>i,y3:()=>o});var t=e(65307),n=e(39070),i=(v=>(v[v.Gcom=0]="Gcom",v[v.Json=1]="Json",v))(i||{}),s=(v=>(v.DataSource="datasource",v.Constant="constant",v.LibraryPanel="libraryPanel",v))(s||{}),r=(v=>(v.New="new",v.Exists="exists",v.Different="different",v))(r||{});const f={meta:{updatedAt:"",orgName:""},dashboard:{},source:1,inputs:{},state:n.Gu.NotStarted},a=(0,t.Z0)({name:"manageDashboards",initialState:f,reducers:{setGcomDashboard:(v,u)=>{v.dashboard={...u.payload.json,id:null},v.meta={updatedAt:u.payload.updatedAt,orgName:u.payload.orgName},v.source=0,v.state=n.Gu.Done},setJsonDashboard:(v,u)=>{v.dashboard={...u.payload,id:null},v.meta=f.meta,v.source=1,v.state=n.Gu.Done},clearDashboard:v=>{v.dashboard={},v.state=n.Gu.NotStarted},setInputs:(v,u)=>{v.inputs={dataSources:u.payload.filter(D=>D.type==="datasource"),constants:u.payload.filter(D=>D.type==="constant"),libraryPanels:v.inputs.libraryPanels||[]}},setLibraryPanelInputs:(v,u)=>{v.inputs.libraryPanels=u.payload},fetchFailed:v=>{v.dashboard={},v.state=n.Gu.Error},fetchDashboard:v=>{v.state=n.Gu.Loading}}}),{clearDashboard:c,setInputs:o,setGcomDashboard:h,setJsonDashboard:g,setLibraryPanelInputs:l,fetchFailed:p,fetchDashboard:m}=a.actions,d={importDashboard:a.reducer}},59120:(G,O,e)=>{"use strict";e.d(O,{O5:()=>P,r3:()=>p,dX:()=>v,hZ:()=>c,ri:()=>g,WH:()=>u,AC:()=>o,YX:()=>d,bM:()=>D,SM:()=>a,M8:()=>y,YD:()=>l,aD:()=>m});var t=e(75816),n=e(75505),i=e(17172);function s({baseURL:E}){async function C(M){try{const{data:S,...I}=await(0,n.s)((0,i.AI)().fetch({...M,url:E+M.url,showErrorAlert:M.showErrorAlert,data:M.body}));return{data:S,meta:I}}catch(S){return M.manageError?M.manageError(S):{error:S}}}return C}const f=(0,t.xP)({reducerPath:"migrateToCloudGeneratedAPI",baseQuery:s({baseURL:"/api"}),endpoints:()=>({})}).injectEndpoints({endpoints:E=>({getSessionList:E.query({query:()=>({url:"/cloudmigration/migration"})}),createSession:E.mutation({query:C=>({url:"/cloudmigration/migration",method:"POST",body:C.cloudMigrationSessionRequestDto})}),deleteSession:E.mutation({query:C=>({url:`/cloudmigration/migration/${C.uid}`,method:"DELETE"})}),getSession:E.query({query:C=>({url:`/cloudmigration/migration/${C.uid}`})}),createSnapshot:E.mutation({query:C=>({url:`/cloudmigration/migration/${C.uid}/snapshot`,method:"POST"})}),getSnapshot:E.query({query:C=>({url:`/cloudmigration/migration/${C.uid}/snapshot/${C.snapshotUid}`,params:{resultPage:C.resultPage,resultLimit:C.resultLimit}})}),cancelSnapshot:E.mutation({query:C=>({url:`/cloudmigration/migration/${C.uid}/snapshot/${C.snapshotUid}/cancel`,method:"POST"})}),uploadSnapshot:E.mutation({query:C=>({url:`/cloudmigration/migration/${C.uid}/snapshot/${C.snapshotUid}/upload`,method:"POST"})}),getShapshotList:E.query({query:C=>({url:`/cloudmigration/migration/${C.uid}/snapshots`,params:{page:C.page,limit:C.limit}})}),getCloudMigrationToken:E.query({query:()=>({url:"/cloudmigration/token"})}),createCloudMigrationToken:E.mutation({query:()=>({url:"/cloudmigration/token",method:"POST"})}),deleteCloudMigrationToken:E.mutation({query:C=>({url:`/cloudmigration/token/${C.uid}`,method:"DELETE"})}),getDashboardByUid:E.query({query:C=>({url:`/dashboards/uid/${C.uid}`})})}),overrideExisting:!1}),{useGetSessionListQuery:a,useCreateSessionMutation:c,useDeleteSessionMutation:o,useGetSessionQuery:h,useCreateSnapshotMutation:g,useGetSnapshotQuery:l,useCancelSnapshotMutation:p,useUploadSnapshotMutation:m,useGetShapshotListQuery:y,useGetCloudMigrationTokenQuery:d,useCreateCloudMigrationTokenMutation:v,useDeleteCloudMigrationTokenMutation:u,useGetDashboardByUidQuery:D}=f,P=f.enhanceEndpoints({addTagTypes:["cloud-migration-token","cloud-migration-session","cloud-migration-snapshot"],endpoints:{getCloudMigrationToken(E){x(E),E.providesTags=["cloud-migration-token"]},createCloudMigrationToken(E){x(E),E.invalidatesTags=["cloud-migration-token"]},deleteCloudMigrationToken(E){x(E),E.invalidatesTags=["cloud-migration-token"]},getSessionList:{providesTags:["cloud-migration-session"]},createSession(E){x(E),E.invalidatesTags=["cloud-migration-session"]},getSession:{providesTags:["cloud-migration-session"]},deleteSession:{invalidatesTags:["cloud-migration-session","cloud-migration-snapshot"]},getSnapshot:{providesTags:["cloud-migration-snapshot"]},getShapshotList:{providesTags:["cloud-migration-snapshot"]},createSnapshot:{invalidatesTags:["cloud-migration-snapshot"]},uploadSnapshot:{invalidatesTags:["cloud-migration-snapshot"]},getDashboardByUid:x}});function x(E){if(!E.query)return;const C=E.query;E.query=(...M)=>{const S=C(...M);return S.showErrorAlert=!1,S}}},32931:(G,O,e)=>{"use strict";e.d(O,{EC:()=>a,L_:()=>r,YS:()=>s,bA:()=>f,wV:()=>c});var t=e(17172),n=e(82467),i=e(10943);function s(o={getBackendSrv:t.AI}){return async h=>{const g=await o.getBackendSrv().get("/api/org");return h((0,i.bK)(g)),g}}function r(o={getBackendSrv:t.AI}){return async(h,g)=>{const l=g().organization.organization;await o.getBackendSrv().put("/api/org",{name:l.name}),h((0,n.YA)(l.name)),h(s(o))}}function f(o,h={getBackendSrv:t.AI}){return async g=>{const l=await h.getBackendSrv().post("/api/user/using/"+o);g((0,n.YA)(l.name))}}function a(o,h={getBackendSrv:t.AI}){return async g=>{const l=await h.getBackendSrv().post("/api/orgs/",o);g(f(l.orgId))}}function c(o={getBackendSrv:t.AI}){return async h=>{const g=await o.getBackendSrv().get("/api/user/orgs");return h((0,i.Bz)(g)),g}}},10943:(G,O,e)=>{"use strict";e.d(O,{Ay:()=>c,Bz:()=>f,bK:()=>r,n:()=>s});var t=e(65307);const n={organization:{},userOrgs:[]},i=(0,t.Z0)({name:"organization",initialState:n,reducers:{organizationLoaded:(o,h)=>({...o,organization:h.payload}),setOrganizationName:(o,h)=>({...o,organization:{...o.organization,name:h.payload}}),userOrganizationsLoaded:(o,h)=>({...o,userOrgs:h.payload})}}),{setOrganizationName:s,organizationLoaded:r,userOrganizationsLoaded:f}=i.actions,c={organization:i.reducer}},17888:(G,O,e)=>{"use strict";e.d(O,{a:()=>P});var t=e(74848),n=e(32196),i=e(47070),s=e(41987),r=e(13544),f=e(12131),a=e(40845),c=e(79041),o=e(96540),h=e(14578);const g=o.forwardRef(({icon:C,children:M,onClick:S,...I},T)=>{const b=(0,a.of)(l);return(0,t.jsxs)("button",{...I,className:b.action,onClick:S,children:[(0,t.jsx)(h.I,{name:C,size:"xl"}),M]})});g.displayName="CardButton";const l=C=>({action:(0,n.css)({display:"flex",flexDirection:"column",height:"100%",justifySelf:"center",cursor:"pointer",background:C.colors.background.secondary,borderRadius:C.shape.radius.default,color:C.colors.text.primary,border:"unset",width:"100%",justifyContent:"center",alignItems:"center",textAlign:"center","&:hover":{background:C.colors.emphasize(C.colors.background.secondary)}})});var p=e(15054),m=e(33390),y=e(53466),d=e(32696),v=e(14792),u=e(31678),D=e(79971);function P(C){const M=(0,a.of)(E),S=(0,c.d2)(),I=new i.v2(C.data),{dataSummary:T}=I,b=x(C,T),R=(0,u.useDispatch)(),A=(0,v.UA)().getCurrent()?.getPanelById(C.panelId),L=()=>{m.A.setObject(p.wV,d.__.Suggestions),R((0,y.eK)(!0))},U=()=>{A&&R((0,D.gW)({panel:A,pluginId:"table"}))},W=w=>{A&&(R((0,D.gW)({...w,panel:A})),w.transformations&&setTimeout(()=>{f.Ny.partial({tab:"transform"})},100))};return(0,t.jsxs)("div",{className:M.wrapper,children:[(0,t.jsx)("div",{className:M.message,"data-testid":r.Tp.components.Panels.Panel.PanelDataErrorMessage,children:b}),S.app===s.Jk.PanelEditor&&T.hasData&&A&&(0,t.jsxs)("div",{className:M.actions,children:[C.suggestions&&(0,t.jsx)(t.Fragment,{children:C.suggestions.map(w=>(0,t.jsx)(g,{icon:"process",onClick:()=>W(w),children:w.name},w.name))}),(0,t.jsx)(g,{icon:"table",onClick:U,children:"Switch to table"}),(0,t.jsx)(g,{icon:"chart-line",onClick:L,children:"Open visualization suggestions"})]})]})}function x({data:C,fieldConfig:M,message:S,needsNumberField:I,needsTimeField:T,needsStringField:b},R){return S||(!C.series||C.series.length===0||C.series.every(A=>A.length===0)?M?.defaults.noValue??"No data":b&&!R.hasStringField?"Data is missing a string field":I&&!R.hasNumberField?"Data is missing a number field":T&&!R.hasTimeField?"Data is missing a time field":"Cannot visualize data")}const E=C=>({wrapper:(0,n.css)({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%",width:"100%"}),message:(0,n.css)({textAlign:"center",color:C.colors.text.secondary,fontSize:C.typography.size.lg,width:"100%"}),actions:(0,n.css)({marginTop:C.spacing(2),display:"flex",height:"50%",maxHeight:"150px",columnGap:C.spacing(1),rowGap:C.spacing(1),width:"100%",maxWidth:"600px"})})},41394:(G,O,e)=>{"use strict";e.d(O,{$:()=>o,W:()=>c});var t=e(74848),n=e(96540),i=e(65158),s=e(43429),r=e(42418),f=e(31678);class a extends n.PureComponent{constructor(g){super(g)}render(){const g={display:"flex",alignItems:"center",justifyContent:"center",height:"100%"};return(0,t.jsx)("div",{style:g,children:(0,t.jsx)(r.F,{severity:f.AppNotificationSeverity.Error,...this.props})})}}function c(h,g){const l=class extends n.PureComponent{render(){const y=(0,t.jsxs)(t.Fragment,{children:["Check the server startup logs for more information. ",(0,t.jsx)("br",{}),"If this plugin was loaded from Git, then make sure it was compiled."]});return(0,t.jsx)(a,{title:`Error loading: ${h.id}`,text:y})}},p=new i.m(l);return p.meta=h,p.loadError=!0,p}function o(h,g){const l=class extends n.PureComponent{render(){return(0,t.jsx)(a,{title:`Panel plugin not found: ${h}`})}},p=new i.m(g?()=>null:l);return p.meta={id:h,name:h,sort:100,type:s.QE.panel,module:"",baseUrl:"",info:{author:{name:""},description:"",links:[],logos:{large:"",small:"public/img/grafana_icon.svg"},screenshots:[],updated:"",version:""}},p}},20726:(G,O,e)=>{"use strict";e.d(O,{m:()=>m});var t=e(74848),n=e(96540),i=e(1933),s=e(90708),r=e(13834),f=e(581),a=e(72574),c=e(40845),o=e(79041),h=e(66602),g=e(10096),l=e(15162);const p={defaults:{},overrides:[]};function m(d){const{pluginId:v,data:u,timeZone:D=(0,i.O)(),options:P={},width:x,height:E,title:C,onOptionsChange:M=()=>{},onChangeTimeRange:S=()=>{},onFieldConfigChange:I=()=>{},fieldConfig:T=p}=d,b=(0,c.$j)(),R=(0,a.w)(),A=(0,n.useMemo)(()=>R.replace.bind(R),[R]),[L,U]=(0,n.useState)((0,l.PY)(v)),[W,w]=(0,n.useState)(),N=y(L,P,T),{dataLinkPostProcessor:B}=(0,o.d2)(),V=(0,s.rJ)(L,N?.fieldConfig,u,D,b,A,B);if((0,n.useEffect)(()=>{L&&L.hasPluginId(v)||(0,l.TV)(v).then(H=>U(H)).catch(H=>{w(H.message)})},[v,L]),W)return(0,t.jsxs)("div",{children:["Failed to load plugin: ",W]});if(!L||!L.hasPluginId(v))return(0,t.jsx)("div",{children:"Loading plugin panel..."});if(!L.panel)return(0,t.jsx)("div",{children:"Seems like the plugin you are trying to load does not have a panel component."});if(!V)return(0,t.jsx)("div",{children:"No panel data"});const K=L.panel;return(0,t.jsx)(h.Xw,{dependencies:[L,u],children:(0,t.jsx)(r.a,{meta:L.meta,children:(0,t.jsx)(K,{id:1,data:V,title:C,timeRange:V.timeRange,timeZone:D,options:N.options,fieldConfig:T,transparent:!1,width:x,height:E,renderCounter:0,replaceVariables:H=>H,onOptionsChange:M,onFieldConfigChange:I,onChangeTimeRange:S,eventBus:g.lE})})})}function y(d,v,u){return(0,n.useMemo)(()=>{if(d)return(0,f.F)({plugin:d,currentOptions:v,currentFieldConfig:u,isAfterPluginChange:!1})},[d,u,v])}},25701:(G,O,e)=>{"use strict";e.d(O,{b:()=>y});var t=e(74848),n=e(32196),i=e(70255),s=e(43429),r=e(51527),f=e(13544),a=e(40845),c=e(29158),o=e(98624),h=e(72129),g=e(10803);const l=38,p=({isCurrent:D,title:P,plugin:x,onClick:E,onDelete:C,disabled:M,showBadge:S,description:I,children:T})=>{const b=(0,a.of)(v),R=M||x.state===s.pn.deprecated,A=(0,n.cx)({[b.item]:!0,[b.itemDisabled]:R,[b.current]:D});return(0,t.jsxs)("div",{className:A,"aria-label":f.Tp.components.PluginVisualization.item(x.name),"data-testid":f.Tp.components.PluginVisualization.item(x.name),onClick:R?void 0:E,title:D?"Click again to close this section":x.name,children:[(0,t.jsx)("img",{className:(0,n.cx)(b.img,{[b.disabled]:R}),src:x.info.logos.small,alt:""}),(0,t.jsxs)("div",{className:(0,n.cx)(b.itemContent,{[b.disabled]:R}),children:[(0,t.jsx)("div",{className:b.name,children:P}),I?(0,t.jsx)("span",{className:b.description,children:I}):null,T]}),S&&(0,t.jsx)("div",{className:(0,n.cx)(b.badge,{[b.disabled]:R}),children:(0,t.jsx)(u,{plugin:x})}),C&&(0,t.jsx)(c.K,{name:"trash-alt",onClick:L=>{L.stopPropagation(),C()},className:b.deleteButton,"aria-label":"Delete button on panel type card",tooltip:"Delete"})]})};p.displayName="PanelTypeCard";const m=({children:D,hasDescription:P,hasDelete:x,rootProps:E})=>{const C=(0,a.of)(v),M=(0,a.of)(d);return(0,t.jsxs)("div",{className:C.item,...E,children:[(0,t.jsx)(i.A,{className:(0,n.cx)(C.img,M.image),width:l,height:l}),(0,t.jsxs)("div",{className:C.itemContent,children:[(0,t.jsx)("div",{className:C.name,children:(0,t.jsx)(i.A,{width:160})}),P?(0,t.jsx)(i.A,{containerClassName:C.description,width:80}):null,D]}),x&&(0,t.jsx)(i.A,{containerClassName:(0,n.cx)(C.deleteButton,M.deleteButton),width:16,height:16})]})},y=(0,h.j)(p,m),d=()=>({deleteButton:(0,n.css)({lineHeight:1}),image:(0,n.css)({lineHeight:1})}),v=D=>({item:(0,n.css)({position:"relative",display:"flex",flexShrink:0,cursor:"pointer",background:D.colors.background.secondary,borderRadius:D.shape.radius.default,boxShadow:D.shadows.z1,border:`1px solid ${D.colors.background.secondary}`,alignItems:"center",padding:D.spacing(1),width:"100%",overflow:"hidden",[D.transitions.handleMotion("no-preference","reduce")]:{transition:D.transitions.create(["background"],{duration:D.transitions.duration.short})},"&:hover":{background:D.colors.emphasize(D.colors.background.secondary,.03)}}),itemContent:(0,n.css)({overflow:"hidden",position:"relative",padding:D.spacing(0,1)}),itemDisabled:(0,n.css)({cursor:"default","&, &:hover":{background:D.colors.action.disabledBackground}}),current:(0,n.css)({label:"currentVisualizationItem",border:`1px solid ${D.colors.primary.border}`,background:D.colors.action.selected}),disabled:(0,n.css)({opacity:.6,filter:"grayscale(1)",cursor:"default",pointerEvents:"none"}),name:(0,n.css)({textOverflow:"ellipsis",overflow:"hidden",fontSize:D.typography.size.sm,fontWeight:D.typography.fontWeightMedium,width:"100%"}),description:(0,n.css)({display:"block",textOverflow:"ellipsis",overflow:"hidden",color:D.colors.text.secondary,fontSize:D.typography.bodySmall.fontSize,fontWeight:D.typography.fontWeightLight,width:"100%",maxHeight:"4.5em"}),img:(0,n.css)({maxHeight:l,width:l,display:"flex",alignItems:"center"}),badge:(0,n.css)({background:D.colors.background.primary}),deleteButton:(0,n.css)({cursor:"pointer",marginLeft:"auto"})}),u=({plugin:D})=>(0,r.x)(D.signature)?(0,t.jsx)(o.B,{status:D.signature}):(0,t.jsx)(g.p,{state:D.state});u.displayName="PanelPluginBadge"},56707:(G,O,e)=>{"use strict";e.d(O,{a:()=>u});var t=e(74848),n=e(32196),i=e(16817),s=e(70713),r=e(40845),f=e(47070),a=e(32264),c=e(15162);const o=["timeseries","barchart","gauge","stat","piechart","bargauge","table","state-timeline","status-history","logs","candlestick","flamegraph","traces","nodeGraph"];async function h(x,E){const C=new f.v2(x,E);for(const S of o){const T=(await(0,c.TV)(S)).getSuggestionsSupplier();T&&T.getSuggestionsForData(C)}const M=C.getList();if(!a.$.featureToggles.vizAndWidgetSplit&&C.dataSummary.fieldCount===0)for(const S of Object.values(a.$.panels))!S.skipDataQuery||S.hideFromList||M.push({name:S.name,pluginId:S.id,description:S.info.description,cardOptions:{imgSrc:S.info.logos.small}});return M.sort((S,I)=>{if(C.dataSummary.preferredVisualisationType){if(S.pluginId===C.dataSummary.preferredVisualisationType)return-1;if(I.pluginId===C.dataSummary.preferredVisualisationType)return 1}return(I.score??f.nQ.OK)-(S.score??f.nQ.OK)})}var g=e(2543),l=e(13544),p=e(56034),m=e(20726);function y({data:x,suggestion:E,onChange:C,width:M}){const S=(0,r.of)(d),{innerStyles:I,outerStyles:T,renderWidth:b,renderHeight:R}=v(M),A=E.cardOptions??{},L={"aria-label":E.name,className:S.vizBox,"data-testid":l.Tp.components.VisualizationPreview.card(E.name),style:T,onClick:()=>{C({pluginId:E.pluginId,options:E.options,fieldConfig:E.fieldConfig})}};if(A.imgSrc)return(0,t.jsx)(p.m,{content:E.description??E.name,children:(0,t.jsxs)("button",{...L,className:(0,n.cx)(S.vizBox,S.imgBox),children:[(0,t.jsx)("div",{className:S.name,children:E.name}),(0,t.jsx)("img",{className:S.img,src:A.imgSrc,alt:E.name})]})});let U=E;return E.cardOptions?.previewModifier&&(U=(0,g.cloneDeep)(E),E.cardOptions.previewModifier(U)),(0,t.jsx)("button",{...L,children:(0,t.jsx)(p.m,{content:E.name,children:(0,t.jsxs)("div",{style:I,className:S.renderContainer,children:[(0,t.jsx)(m.m,{title:"",data:x,pluginId:E.pluginId,width:b,height:R,options:U.options,fieldConfig:U.fieldConfig}),(0,t.jsx)("div",{className:S.hoverPane})]})})})}const d=x=>({hoverPane:(0,n.css)({position:"absolute",top:0,right:0,left:0,borderRadius:x.spacing(2),bottom:0}),vizBox:(0,n.css)`
      position: relative;
      background: none;
      border-radius: ${x.shape.radius.default};
      cursor: pointer;
      border: 1px solid ${x.colors.border.medium};

      transition: ${x.transitions.create(["background"],{duration:x.transitions.duration.short})};

      &:hover {
        background: ${x.colors.background.secondary};
      }
    `,imgBox:(0,n.css)`
      display: flex;
      flex-direction: column;
      height: 100%;

      justify-self: center;
      color: ${x.colors.text.primary};
      width: 100%;
      display: flex;

      justify-content: center;
      align-items: center;
      text-align: center;
    `,name:(0,n.css)`
      padding-bottom: ${x.spacing(.5)};
      margin-top: ${x.spacing(-1)};
      font-size: ${x.typography.bodySmall.fontSize};
      white-space: nowrap;
      overflow: hidden;
      color: ${x.colors.text.secondary};
      font-weight: ${x.typography.fontWeightMedium};
      text-overflow: ellipsis;
    `,img:(0,n.css)`
      max-width: ${x.spacing(8)};
      max-height: ${x.spacing(8)};
    `,renderContainer:(0,n.css)`
      position: absolute;
      transform-origin: left top;
      top: 6px;
      left: 6px;
    `});function v(x){const C=x,M=x*(1/1.6),S=350,I=S*(1/1.6),T=6,b=(C-T*2)/S,R=(M-T*2)/I;return{renderHeight:I,renderWidth:S,outerStyles:{width:C,height:M},innerStyles:{width:S,height:I,transform:`scale(${b}, ${R})`}}}function u({searchQuery:x,onChange:E,data:C,panel:M}){const S=(0,r.of)(P),{value:I}=(0,i.A)(()=>h(C,M),[C,M]),T=D(x,I);return(0,t.jsx)("div",{children:(0,t.jsx)(s.Ay,{disableHeight:!0,style:{width:"100%",height:"100%"},children:({width:b})=>{if(!b)return null;b=b-1;const R=Math.floor(b/200),A=8*(R-1),L=Math.floor((b-A)/R);return(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:S.filterRow,children:(0,t.jsx)("div",{className:S.infoText,children:"Based on current data"})}),(0,t.jsxs)("div",{className:S.grid,style:{gridTemplateColumns:`repeat(auto-fill, ${L}px)`},children:[T.map((U,W)=>(0,t.jsx)(y,{data:C,suggestion:U,onChange:E,width:L-1},W)),x&&T.length===0&&(0,t.jsx)("div",{className:S.infoText,children:"No results matched your query"})]})]})}})})}function D(x,E){if(!x||!E)return E||[];const C=new RegExp(x,"i");return E.filter(M=>C.test(M.name)||C.test(M.pluginId))}const P=x=>({heading:(0,n.css)({...x.typography.h5,margin:x.spacing(0,.5,1)}),filterRow:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",paddingBottom:"8px"}),infoText:(0,n.css)({fontSize:x.typography.bodySmall.fontSize,color:x.colors.text.secondary,fontStyle:"italic"}),grid:(0,n.css)({display:"grid",gridGap:x.spacing(1),gridTemplateColumns:"repeat(auto-fill, 144px)",marginBottom:x.spacing(1),justifyContent:"space-evenly"})})},86292:(G,O,e)=>{"use strict";e.d(O,{G:()=>o});var t=e(74848),n=e(32196),i=e(96540),s=e(32264),r=e(40845),f=e(41670),a=e(17706),c=e(48889);function o({pluginId:g,searchQuery:l,onChange:p,isWidget:m=!1}){const y=(0,r.of)(h),d=(0,i.useMemo)(()=>s.$.featureToggles.vizAndWidgetSplit?m?(0,a.nr)():(0,a.if)():(0,a.A4)(),[m]),v=(0,i.useMemo)(()=>(0,a.CO)(d,l,g),[d,l,g]);return v.length===0?(0,t.jsx)(f.Z,{children:"Could not find anything matching your query"}):(0,t.jsx)("div",{className:y.grid,children:v.map(u=>(0,t.jsx)(c.f,{disabled:!1,isCurrent:u.id===g,plugin:u,onClick:D=>p({pluginId:u.id,withModKey:D.metaKey||D.ctrlKey||D.altKey})},u.id))})}const h=g=>({grid:(0,n.css)({maxWidth:"100%",display:"grid",gridGap:g.spacing(.5)}),heading:(0,n.css)({...g.typography.h5,margin:g.spacing(0,.5,1)})})},48889:(G,O,e)=>{"use strict";e.d(O,{f:()=>i});var t=e(74848),n=e(25701);const i=({isCurrent:s,plugin:r,onClick:f,disabled:a})=>(0,t.jsx)(n.b,{title:r.name,plugin:r,description:r.info.description,onClick:f,isCurrent:s,disabled:a,showBadge:!0});i.displayName="VizTypePickerPlugin"},32349:(G,O,e)=>{"use strict";e.d(O,{CH:()=>c,E7:()=>a,EO:()=>f});var t=e(14236),n=e(83195),i=e(92461),s=e(32023),r=e(6923);const f=o=>{const h=o.field.links;if(!(!h||h.length===0))return{getLinks:g=>{const l={};if(o.view){const{dataFrame:m}=o.view;l.__series={value:{name:m.name,refId:m.refId},text:"Series"};const y=o.colIndex!==void 0?m.fields[o.colIndex]:void 0;if(y){if(l.__field={value:{name:y.name,labels:y.labels},text:"Field"},o.rowIndex!==void 0&&o.rowIndex>=0){const{timeField:d}=(0,t.KR)(m);l.__value={value:{raw:y.values[o.rowIndex],numeric:o.display.numeric,text:(0,n.cN)(o.display),time:d?d.values[o.rowIndex]:void 0},text:"Value"}}o.view&&(l.__data={value:{name:m.name,refId:m.refId,fields:(0,i.F)({frame:m,rowIndex:o.rowIndex})},text:"Data"})}else l.__value={value:{raw:o.display.numeric,numeric:o.display.numeric,text:(0,n.cN)(o.display),calc:o.name},text:"Value"}}else console.log("VALUE",o);const p=(m,y,d)=>{const v={...l,...y};return g(m,v,d)};return h.map(m=>(0,r.mQ)().getDataLinkUIModel(m,p,o))}}},a=(o,h)=>{const g=o.links;if(!(!g||g.length===0))return{getLinks:()=>g.map(l=>(0,r.mQ)().getDataLinkUIModel(l,h||o.replaceVariables,o))}},c=(o,h)=>{const g=s.b4.getPanelLinks(o)?.state.rawLinks;if(!(!g||g.length===0))return{getLinks:()=>g.map(l=>(0,r.mQ)().getDataLinkUIModel(l,h,o))}}},6923:(G,O,e)=>{"use strict";e.d(O,{Fq:()=>u,Hf:()=>x,mQ:()=>I});var t=e(2543),n=e.n(t),i=e(6709),s=e(91890),r=e(28240),f=e(11261),a=e(71733),c=e(80997),o=e(76885),h=e(95344),g=e(72574),l=e(52622),p=e(2913);const m=[{value:`${i.c.keepTime}`,label:"Time range",documentation:"Adds current time range",origin:s.$0.BuiltIn},{value:`${i.c.timeRangeFrom}`,label:"Time range: from",documentation:"Adds current time range's from value",origin:s.$0.BuiltIn},{value:`${i.c.timeRangeTo}`,label:"Time range: to",documentation:"Adds current time range's to value",origin:s.$0.BuiltIn}],y=[{value:`${i.c.seriesName}`,label:"Name",documentation:"Name of the series",origin:s.$0.Series}],d=[{value:`${i.c.valueNumeric}`,label:"Numeric",documentation:"Numeric representation of selected value",origin:s.$0.Value},{value:`${i.c.valueText}`,label:"Text",documentation:"Text representation of selected value",origin:s.$0.Value},{value:`${i.c.valueRaw}`,label:"Raw",documentation:"Raw value",origin:s.$0.Value}],v=T=>T.includes(".")||T.trim().includes(" ")?`["${T}"]`:`.${T}`,u=()=>[...(0,g.w)().getVariables().map(T=>({value:T.name,label:T.name,origin:s.$0.Template})),{value:`${i.c.includeVars}`,label:"All variables",documentation:"Adds current variables",origin:s.$0.Template},...m],D=T=>{const b=[];for(const A of T)for(const L of A.fields)if(L.labels)for(const U of Object.keys(L.labels))b.push(U);const R=(0,t.chain)(b).flatten().uniq().value();return[{value:`${i.c.fieldName}`,label:"Name",documentation:"Field name of the clicked datapoint (in ms epoch)",origin:s.$0.Field},...R.map(A=>({value:`__field.labels${v(A)}`,label:`labels.${A}`,documentation:`${A} label value`,origin:s.$0.Field}))]},P=T=>{let b,R;const A=[],L={};if(T.length!==1)return[];const U=T[0];for(const W of U.fields){const w=(0,r.Ct)(W,U,T);L[w]||(A.push({value:`__data.fields${v(w)}`,label:`${w}`,documentation:`Formatted value for ${w} on the same row`,origin:s.$0.Fields}),L[w]=!0,!b&&W.type===f.PU.number&&(b={...W,name:w}),!R&&W.config.displayName&&W.config.displayName!==W.name&&(R={...W,name:w}))}return A.length&&A.push({value:"__data.fields[0]",label:"Select by index",documentation:"Enter the field order",origin:s.$0.Fields}),b&&(A.push({value:`__data.fields${v(b.name)}.numeric`,label:"Show numeric value",documentation:"the numeric field value",origin:s.$0.Fields}),A.push({value:`__data.fields${v(b.name)}.text`,label:"Show text value",documentation:"the text value",origin:s.$0.Fields})),R&&A.push({value:`__data.fields${v(R.name)}`,label:"Select by title",documentation:"Use the title to pick the field",origin:s.$0.Fields}),A},x=(T,b)=>{const R={value:`${i.c.valueTime}`,label:"Time",documentation:"Time value of the clicked datapoint (in ms epoch)",origin:s.$0.Value};return b===s.uP.Values?[...y,...D(T),...d,R,...P(T),...u()]:[...y,...D(T),...P(T),...u()]},E=T=>{const b=D(T),R={value:`${DataLinkBuiltInVars.valueCalc}`,label:"Calculation name",documentation:"Name of the calculation the value is a result of",origin:VariableOrigin.Value};return[...y,...b,...d,R,...u()]};class C{constructor(){this.getDataLinkUIModel=(b,R,A)=>{let L=b.url;b.onBuildUrl&&(L=b.onBuildUrl({origin:A,replaceVariables:R}));const U={href:a.I.assureBaseUrl(L.replace(/\n/g,"")),title:b.title??"",target:b.targetBlank?"_blank":void 0,origin:A};return R&&(U.href=R(U.href,void 0,l.$m.UriEncode),U.title=R(b.title)),b.onClick&&(U.onClick=W=>{b.onClick({origin:A,replaceVariables:R,e:W})}),U.href=(0,p.zj)().disableSanitizeHtml?U.href:c.sQ.sanitizeUrl(U.href),U}}getLinkUrl(b){let R={};b.keepTime&&(R[`$${i.c.keepTime}`]=!0),b.includeVars&&(R[`$${i.c.includeVars}`]=!0);let A=a.I.assureBaseUrl(o.kM.appendQueryToUrl(b.url||"",o.kM.toUrlParams(R)));return A=(0,g.w)().replace(A),(0,p.zj)().disableSanitizeHtml?A:c.sQ.sanitizeUrl(A)}getAnchorInfo(b){const R=(0,g.w)();return{href:this.getLinkUrl(b),title:R.replace(b.title||""),tooltip:R.replace(b.tooltip||"")}}getPanelLinkAnchorInfo(b,R){(0,h.l)("link_srv.ts","getPanelLinkAnchorInfo","getDataLinkUIModel");const A=(L,U,W)=>(0,g.w)().replace(L,{...R,...U},W);return this.getDataLinkUIModel(b,A,{})}}let M;function S(T){M=T}function I(){return M||(M=new C),M}},79971:(G,O,e)=>{"use strict";e.d(O,{Ap:()=>a,O6:()=>c,Xk:()=>h,gW:()=>o});var t=e(581),n=e(57767),i=e(41394),s=e(20701),r=e(28444),f=e(80095);function a(l){return async(p,m)=>{if(l.libraryPanel?.uid&&!("model"in l.libraryPanel)){p(g(l));return}l.maxDataPoints&&(l.maxDataPoints=Number(l.maxDataPoints));let y=l.type,d=m().plugins.panels[y];if(!d)try{d=await p((0,s.y7)(y))}catch{d=(0,i.$)(y,y==="row")}l.plugin||await l.pluginLoaded(d),p((0,f.XM)({key:l.key,plugin:d}))}}function c(l){return p=>{p((0,f.FC)({key:l}))}}function o({panel:l,pluginId:p,options:m,fieldConfig:y,transformations:d}){return async(v,u)=>{if(l.type===p&&!m&&!y&&!d)return;let P=u().plugins.panels[p];if(P||(P=await v((0,s.y7)(p))),l.type!==p&&l.changePlugin(P),m||y||d){const x=(0,t.F)({plugin:P,currentOptions:m||l.options,currentFieldConfig:y||l.fieldConfig,isAfterPluginChange:!1});l.options=x.options,l.fieldConfig=x.fieldConfig,l.transformations=d||l.transformations,l.configRev++}l.generateNewKey(),v((0,f.XM)({key:l.key,plugin:P}))}}function h(l,p){return async(m,y)=>{const d=p.model.type,v=l.type;if(l.restoreModel({...p.model,gridPos:l.gridPos,id:l.id,libraryPanel:p}),l.getQueryRunner().clearLastResult(),v!==d){let D=y().plugins.panels[d];D||(D=await m((0,s.y7)(d))),await l.pluginLoaded(D),l.generateNewKey(),await m((0,f.XM)({key:l.key,plugin:D}))}else{const u=l.key;l.generateNewKey(),m((0,f.io)({oldKey:u,newKey:l.key}))}l.configRev=0,l.hasSavedPanelEditChange=!0,l.refresh(),l.events.publish(r.zq),l.events.publish(r.PR)}}function g(l){return async(p,m)=>{const y=l.libraryPanel.uid;try{const d=await(0,n.Yr)(y,!0);l.initLibraryPanel(d);const v=m().dashboard.getModel();if(l.repeat&&v){const u=v.panels.findIndex(D=>D.id===l.id);v.repeatPanel(l,u),v.sortPanelsByGridPos(),v.events.publish(new r.Q$)}await p(a(l))}catch(d){console.log("ERROR: ",d),p((0,f.XM)({key:l.key,plugin:(0,i.$)("Unable to load library panel: "+y,!1)}))}}}},80095:(G,O,e)=>{"use strict";e.d(O,{Ay:()=>g,FC:()=>c,S3:()=>r,XM:()=>s,io:()=>a,nF:()=>f,rG:()=>o});var t=e(65307);const n={},i=(0,t.Z0)({name:"panels",initialState:n,reducers:{panelModelAndPluginReady:(l,p)=>{l[p.payload.key]={plugin:p.payload.plugin}},changePanelKey:(l,p)=>{l[p.payload.newKey]=l[p.payload.oldKey],delete l[p.payload.oldKey]},removePanel:(l,p)=>{delete l[p.payload.key]},removeAllPanels:l=>{Object.keys(l).forEach(p=>delete l[p])},setPanelInstanceState:(l,p)=>{l[p.payload.key].instanceState=p.payload.value},setPanelAngularComponent:(l,p)=>{const m=l[p.payload.key];m.angularComponent=p.payload.angularComponent}}}),{panelModelAndPluginReady:s,setPanelAngularComponent:r,setPanelInstanceState:f,changePanelKey:a,removePanel:c,removeAllPanels:o}=i.actions,g={panels:i.reducer}},40334:(G,O,e)=>{"use strict";e.d(O,{U:()=>t});function t(n,i){return n.panels[i.key]}},17706:(G,O,e)=>{"use strict";e.d(O,{A4:()=>s,CO:()=>a,if:()=>f,nr:()=>r});var t=e(43429),n=e(54479),i=e(2913);function s(){const c=i.config.panels;return Object.keys(c).filter(o=>c[o].hideFromList===!1).map(o=>c[o]).sort((o,h)=>o.sort-h.sort)}function r(){return s().filter(c=>!!c.skipDataQuery)}function f(){return s().filter(c=>!c.skipDataQuery)}function a(c,o,h){if(!o.length)return c.filter(y=>y.state===t.pn.deprecated?h===y.id:!0);const g=(0,n.xb)(o).toLowerCase(),l=[],p=[],m="graph".startsWith(g);for(const y of c){if(y.state===t.pn.deprecated&&h!==y.id)continue;const v=y.name.toLowerCase().indexOf(g);v===0?l.push(y):v>0?p.push(y):m&&y.id==="timeseries"&&l.push(y)}return l.concat(p)}},2609:(G,O,e)=>{"use strict";e.d(O,{_o:()=>g});var t=e(2543),n=e.n(t),i=e(71733),s=e(76885),r=e(65879),f=e(12131),a=e(2619),c=e(86022);const o={kiosk:!0,autofitpanels:!0,orgId:!0,"_dash.hideTimePicker":!0,"_dash.hideVariables":!0,"_dash.hideLinks":!0};class h extends a.Q{constructor(){super({isPlaying:!1}),this.urls=[],this.index=0,this.numberOfLoops=0,this.locationUpdated=this.locationUpdated.bind(this),this.api=(0,c.NF)()}next(){if(clearTimeout(this.nextTimeoutId),this.index>this.urls.length-1){if(this.numberOfLoops++,this.numberOfLoops>=3){window.location.href=this.startUrl;return}this.index=0}const m=this.urls[this.index],y=f.Ny.getSearchObject(),d=(0,t.pickBy)(y,(u,D)=>o[D]),v=i.I.stripBaseFromUrl(m);this.index++,this.validPlaylistUrl=v,this.nextTimeoutId=setTimeout(()=>this.next(),this.interval),f.Ny.push(v+"?"+s.kM.toUrlParams(d))}prev(){this.index=Math.max(this.index-2,0),this.next()}locationUpdated(p){p.pathname!==this.validPlaylistUrl&&this.stop()}async start(p){this.stop(),this.startUrl=window.location.href,this.index=0,this.setState({isPlaying:!0}),this.locationListenerUnsub=f.Ny.getHistory().listen(this.locationUpdated);const m=[];let y=await this.api.getPlaylist(p);if(!y.items?.length)return;this.interval=r.intervalToMs(y.interval);const d=await(0,c.qY)(y.items);for(const v of d)if(v.dashboards)for(const u of v.dashboards)m.push(u.url);m.length&&(this.urls=m,this.setState({isPlaying:!0}),this.next())}stop(){this.state.isPlaying&&(this.index=0,this.setState({isPlaying:!1}),this.locationListenerUnsub&&this.locationListenerUnsub(),this.nextTimeoutId&&clearTimeout(this.nextTimeoutId),f.Ny.getSearchObject().kiosk&&f.Ny.partial({kiosk:null}))}}const g=new h},86022:(G,O,e)=>{"use strict";e.d(O,{GM:()=>D,NF:()=>P,aV:()=>u,qY:()=>v});var t=e(75505),n=e(78368),i=e(17172),s=e(32264),r=e(82467),f=e(3169),a=e(90183),c=e(68706),o=e(99140),h=e(2468),g=e(24439);class l{async getAllPlaylist(){return(0,i.AI)().get("/api/playlists/")}async getPlaylist(E){const C=await(0,i.AI)().get(`/api/playlists/${E}`);return await y(C),C}async createPlaylist(E){await d(()=>(0,i.AI)().post("/api/playlists",E))}async updatePlaylist(E){await d(()=>(0,i.AI)().put(`/api/playlists/${E.uid}`,E))}async deletePlaylist(E){await d(()=>(0,i.AI)().delete(`/api/playlists/${E}`),"Playlist deleted")}}class p{constructor(){this.playlistAsK8sResource=E=>({metadata:{name:E.uid},spec:{title:E.name,interval:E.interval,items:E.items??[]}}),this.server=new h.w({group:"playlist.grafana.app",version:"v0alpha1",resource:"playlists"})}async getAllPlaylist(){return(await this.server.list()).items.map(m)}async getPlaylist(E){const C=await this.server.get(E),M=m(C);return await y(M),M}async createPlaylist(E){const C=this.playlistAsK8sResource(E);await d(async()=>{await this.server.create(C)})}async updatePlaylist(E){const C=this.playlistAsK8sResource(E);await d(()=>this.server.update(C).then(()=>{}))}async deletePlaylist(E){await d(()=>this.server.delete(E).then(()=>{}),"Playlist deleted")}}function m(x){const{spec:E,metadata:C}=x;return{uid:C.name,name:E.title,interval:E.interval,items:E.items}}async function y(x){if(x?.items){for(const E of x.items)if(E.type==="dashboard_by_id"){E.type="dashboard_by_uid";const C=await(0,i.AI)().get(`/api/dashboards/ids/${E.value}`);C?.length&&(E.value=C[0])}}}async function d(x,E="Playlist saved"){try{await x(),(0,o.JD)((0,r.dx)((0,f.tZ)(E)))}catch(C){C instanceof Error&&(0,o.JD)((0,r.dx)((0,f.gi)("Unable to save playlist",C)))}}async function v(x){let E=0;if(!x?.length)return[];const C=[];for(const I of x){const T={query:"*",kind:["dashboard"],limit:1e3};switch(I.type){case"dashboard_by_id":throw new Error("invalid item (with id)");case"dashboard_by_uid":T.uid=[I.value];break;case"dashboard_by_tag":T.tags=[I.value];break}C.push({refId:`${E++}`,queryType:c.nj.Search,search:T})}if(!s.$.featureToggles.panelTitleSearch){const I=(0,g.getGrafanaSearcher)(),T=[];for(let b=0;b<C.length;b++){const R=(await I.search(C[b].search)).view;T.push({...x[b],dashboards:R.map(A=>({...A}))})}return T}const M=await(0,a.o)(),S=await(0,t.s)(M.query({targets:C}));if(S.data.length!==x.length)throw new Error("unexpected result size");return x.map((I,T)=>{const b=new n.R(S.data[T]);return{...I,dashboards:b.map(R=>({...R}))}})}function u(){return{items:[],interval:"5m",name:"",uid:""}}function D(x,E){return E?.length?(E=E.toLowerCase(),x.filter(C=>C.name.toLowerCase().includes(E))):x}function P(){return s.$.featureToggles.kubernetesPlaylists?new p:new l}},84684:(G,O,e)=>{"use strict";e.d(O,{Ap:()=>p,Bj:()=>c,CB:()=>f,Gd:()=>l,T_:()=>a,XP:()=>m,cu:()=>d,ij:()=>v,xZ:()=>y});var t=e(36663),n=e(17172),i=e(80714),s=e(6745),r=e(5129);async function f(D){const P=await o(D),x=!!P,[E,C,M]=await Promise.all([l(),h(D,x),g(D)]),S=E.find(T=>T.id===D),I=S?.dependencies||P?.json?.dependencies;return{grafanaDependency:I?.grafanaDependency??I?.grafanaVersion??"",pluginDependencies:I?.plugins||[],links:S?.info.links||P?.json?.info.links||[],readme:M||P?.readme,versions:C,statusContext:P?.statusContext??"",iam:P?.json?.iam}}async function a(){try{const{items:D}=await(0,n.AI)().get(`${s.P5}/plugins`,{includeDeprecated:!0});return D.filter(r.hY)}catch(D){if((0,n.NF)(D))return D.isHandled=!0,console.error("Failed to fetch plugins from catalog (default https://grafana.com/api/plugins)"),[];throw D}}async function c(){try{return await(0,n.AI)().get(`${s.Sw}/errors`)}catch{return[]}}async function o(D){try{return await(0,n.AI)().get(`${s.P5}/plugins/${D}`,{})}catch(P){(0,n.NF)(P)&&(P.isHandled=!0);return}}async function h(D,P){try{return P?((await(0,n.AI)().get(`${s.P5}/plugins/${D}/versions`)).items||[]).map(E=>({version:E.version,createdAt:E.createdAt,isCompatible:E.isCompatible,grafanaDependency:E.grafanaDependency})):[]}catch(x){return(0,n.NF)(x)&&(x.isHandled=!0),[]}}async function g(D){try{const P=await(0,n.AI)().get(`${s.Sw}/${D}/markdown/README`);return P?(0,t.G)(P):""}catch(P){return(0,n.NF)(P)&&(P.isHandled=!0),""}}async function l(){return(await(0,n.AI)().get(`${s.Sw}`,(0,i.F)({embedded:0}))).filter(r.Sq)}async function p(){const{items:D}=await(0,n.AI)().get(`${s.Mi}/plugins`);return D}async function m(){const{items:D}=await(0,n.AI)().get(`${s.Mi}/provisioned-plugins`);return D.map(P=>({slug:P.type}))}async function y(D){return await(0,n.AI)().post(`${s.Sw}/${D}/install`,void 0,{showErrorAlert:!1})}async function d(D){return await(0,n.AI)().post(`${s.Sw}/${D}/uninstall`)}async function v(D,P){return(await(0,n.AI)().datasourceRequest({url:`/api/plugins/${D}/settings`,method:"POST",data:P}))?.data}const u={getRemotePlugins:a,getInstalledPlugins:l,installPlugin:y,uninstallPlugin:d}},42930:(G,O,e)=>{"use strict";e.d(O,{G:()=>s});var t=e(74848),n=e(32196),i=e(40845);const s=({children:f,wrap:a,className:c})=>{const o=(0,i.$j)(),h=r(o,a);return(0,t.jsx)("div",{className:(0,n.cx)(h.container,c),children:f})},r=(f,a)=>({container:(0,n.css)`
    display: flex;
    flex-direction: row;
    flex-wrap: ${a?"wrap":"no-wrap"};
    & > * {
      margin-bottom: ${f.spacing()};
      margin-right: ${f.spacing()};
    }
    & > *:last-child {
      margin-right: 0;
    }
  `})},6745:(G,O,e)=>{"use strict";e.d(O,{Mi:()=>n,P5:()=>i,Sw:()=>t,fu:()=>s});const t="/api/plugins",n="/api/instance",i="/api/gnet",s="plugins"},5129:(G,O,e)=>{"use strict";e.d(O,{Gl:()=>E,H2:()=>d,N6:()=>M,Sq:()=>S,TD:()=>U,Xc:()=>u,by:()=>v,hY:()=>I,j_:()=>C,kH:()=>m,td:()=>g,tr:()=>x});var t=e(53076),n=e(43429),i=e(53531),s=e(32264),r=e(33378),f=e(2913),a=e(10096),c=e(27677),o=e(31678),h=e(66253);function g({local:W=[],remote:w=[],instance:N=[],provisioned:B=[],pluginErrors:V}){const K=[],H=D(V),X=N.reduce((Y,Z)=>(Y.set(Z.pluginSlug,Z),Y),new Map),k=B.reduce((Y,Z)=>(Y.add(Z.slug),Y),new Set);return W.forEach(Y=>{const Z=w.find(j=>j.slug===Y.id),se=H[Y.id];Z||K.push(l(Y,void 0,se))}),w.forEach(Y=>{const Z=W.find(q=>q.id===Y.slug),se=H[Y.slug];if(!(Y.status===h.Uy.Deprecated&&!Z)){const q=l(Z,Y,se);if(f.Ay.featureToggles.managedPluginsInstall&&s.$.pluginAdminExternalManageEnabled){q.isFullyInstalled=q.isCore?!0:(X.has(Y.slug)||k.has(Y.slug))&&q.isInstalled,q.isInstalled=X.has(Y.slug)||q.isInstalled;const ne=X.get(Y.slug);q.isUpdatingFromInstance=X.has(Y.slug)&&q.hasUpdate&&q.installedVersion!==ne?.version,ne?.version&&ne?.version!==Y.version&&(q.hasUpdate=!0),q.isUninstallingFromInstance=!!Z&&!X.has(Y.slug),q.isProvisioned=k.has(Y.slug)}K.push(q)}}),K}function l(W,w,N){return!W&&w?p(w,N):W&&!w?m(W,N):y(W,w,N)}function p(W,w){const{name:N,slug:B,description:V,version:K,orgName:H,popularity:X,downloads:k,typeCode:Y,updatedAt:Z,createdAt:se,status:j,angularDetected:q,keywords:ne}=W,oe=!!w||b(Y);return{description:V,downloads:k,id:B,info:{logos:{small:`${s.$.appSubUrl}/api/gnet/plugins/${B}/versions/${K}/logos/small`,large:`${s.$.appSubUrl}/api/gnet/plugins/${B}/versions/${K}/logos/large`},keywords:ne},name:N,orgName:H,popularity:X,publishedAt:se,signature:P({remote:W,error:w}),updatedAt:Z,hasUpdate:!1,isPublished:!0,isInstalled:oe,isDisabled:oe,isDeprecated:j===h.Uy.Deprecated,isCore:W.internal,isDev:!1,isEnterprise:j===h.Uy.Enterprise,type:Y,error:w?.errorCode,angularDetected:q,isFullyInstalled:oe}}function m(W,w){const{name:N,info:{description:B,version:V,logos:K,updated:H,author:X,keywords:k},id:Y,dev:Z,type:se,signature:j,signatureOrg:q,signatureType:ne,hasUpdate:oe,accessControl:z,angularDetected:te}=W,le=!!w||b(se);return{description:B,downloads:0,id:Y,info:{logos:K,keywords:k},name:N,orgName:X.name,popularity:0,publishedAt:"",signature:P({local:W,error:w}),signatureOrg:q,signatureType:ne,updatedAt:H,installedVersion:V,hasUpdate:oe,isInstalled:!0,isDisabled:le,isCore:j==="internal",isPublished:!1,isDeprecated:!1,isDev:!!Z,isEnterprise:!1,type:se,error:w?.errorCode,accessControl:z,angularDetected:te,isFullyInstalled:!0,iam:W.iam}}function y(W,w,N){const B=W?.info.version,V=w?.slug||W?.id||"",K=W?.type||w?.typeCode,H=!!N||b(K),X=w?.keywords||W?.info.keywords||[];let k={small:`/public/img/icn-${K}.svg`,large:`/public/img/icn-${K}.svg`};return w?k={small:`${s.$.appSubUrl}/api/gnet/plugins/${V}/versions/${w.version}/logos/small`,large:`${s.$.appSubUrl}/api/gnet/plugins/${V}/versions/${w.version}/logos/large`}:W&&W.info.logos&&(k=W.info.logos),{description:W?.info.description||w?.description||"",downloads:w?.downloads||0,hasUpdate:W?.hasUpdate||!1,id:V,info:{logos:k,keywords:X},isCore:!!(w?.internal||W?.signature===n.Ac.internal),isDev:!!W?.dev,isEnterprise:w?.status===h.Uy.Enterprise,isInstalled:!!W||H,isDisabled:H,isDeprecated:w?.status===h.Uy.Deprecated,isPublished:!0,name:w?.name||W?.name||"",orgName:w?.orgName||W?.info.author.name||"",popularity:w?.popularity||0,publishedAt:w?.createdAt||"",type:K,signature:P({local:W,remote:w,error:N}),signatureOrg:W?.signatureOrg||w?.versionSignedByOrgName,signatureType:W?.signatureType||w?.versionSignatureType||w?.signatureType||void 0,updatedAt:w?.updatedAt||W?.info.updated||"",installedVersion:B,error:N?.errorCode,accessControl:W?.accessControl,angularDetected:W?.angularDetected??w?.angularDetected,isFullyInstalled:!!W||H,iam:W?.iam}}const d=W=>`${s.$.pluginCatalogURL}${W}`;var v=(W=>(W.nameAsc="nameAsc",W.nameDesc="nameDesc",W.updated="updated",W.published="published",W.downloads="downloads",W))(v||{});const u=(W,w)=>{const N={nameAsc:(B,V)=>B.name.localeCompare(V.name),nameDesc:(B,V)=>V.name.localeCompare(B.name),updated:(B,V)=>(0,i.b)(V.updatedAt).valueOf()-(0,i.b)(B.updatedAt).valueOf(),published:(B,V)=>(0,i.b)(V.publishedAt).valueOf()-(0,i.b)(B.publishedAt).valueOf(),downloads:(B,V)=>V.downloads-B.downloads};return N[w]?W.sort(N[w]):W};function D(W=[]){return W.reduce((w,N)=>(w[N.pluginId]=N,w),{})}function P(W){const{error:w,local:N,remote:B}=W;if(w)switch(w.errorCode){case n.ZK.invalidSignature:return n.Ac.invalid;case n.ZK.missingSignature:return n.Ac.missing;case n.ZK.modifiedSignature:return n.Ac.modified}return N?.signature?N.signature:B?.signatureType&&B?.versionSignatureType?n.Ac.valid:n.Ac.missing}const x=()=>(0,c.AI)().get("/api/frontend/settings").then(W=>{s.$.panels=W.panels});function E(W){if(!W)return;const[w]=W.filter(N=>!!N.isCompatible);return w}const C=()=>s.$.pluginAdminEnabled,M=(W,w,N)=>{const B=s.$.pluginAdminExternalManageEnabled,V=a.TP.hasPermission(o.AccessControlAction.PluginsInstall),K=!!N;return W.type===n.QE.renderer||W.type===n.QE.secretsmanager||W.isEnterprise&&!(0,r.a)("enterprise.plugins")||W.isDev||!V&&!B||!W.isPublished||!K||!w},S=W=>T(W.id),I=W=>T(W.slug);function T(W){const{pluginCatalogHiddenPlugins:w}=s.$;return!w.includes(W)}function b(W){return W===n.QE.secretsmanager&&!s.$.secretsManagerPluginEnabled}function R(W){return W?.signature==="internal"}function A(W){return W.split(" - ")[0]}function L(W){return W.reduce((w,{id:N,name:B,type:V,orgName:K,info:H})=>{const X=H.keywords?.join(" ").toLowerCase(),k=`${N} - ${B} - ${V} - ${K} - ${X}`;return w.push(k),w},[])}function U(W,w){const N=L(W);let V=new t.A({intraMode:1,intraSub:0}).filter(N,w);return V===null?null:V.map(K=>A(N[K]))}},20701:(G,O,e)=>{"use strict";e.d(O,{JC:()=>I,JJ:()=>u,LR:()=>v,NJ:()=>b,aU:()=>P,ai:()=>M,h9:()=>T,mj:()=>d,nT:()=>S,t5:()=>D,y7:()=>R});var t=e(65307),n=e(65474),i=e(62467),s=e(66847),r=e(45650),f=e(90593),a=e(75505),c=e(32264),o=e(17172),h=e(2913),g=e(15162),l=e(81900),p=e(84684),m=e(6745),y=e(5129);const d=(0,t.zD)(`${m.fu}/fetchAll`,async(A,L)=>{try{L.dispatch({type:`${m.fu}/fetchLocal/pending`}),L.dispatch({type:`${m.fu}/fetchRemote/pending`});const U=c.$.pluginAdminExternalManageEnabled&&h.Ay.featureToggles.managedPluginsInstall?(0,n.H)((0,p.Ap)()):(0,i.of)(void 0),W=c.$.pluginAdminExternalManageEnabled&&h.Ay.featureToggles.managedPluginsInstall?(0,n.H)((0,p.XP)()):(0,i.of)(void 0),w=500,N=(0,n.H)((0,p.Bj)()),B=(0,n.H)((0,p.Gd)()),V=(0,n.H)((0,p.T_)()).pipe((0,s.W)(K=>(L.dispatch({type:`${m.fu}/fetchRemote/rejected`}),console.error(K),(0,i.of)([]))));return(0,r.p)({local:B,remote:V,instance:U,provisioned:W,pluginErrors:N}).pipe((0,f.w)({each:w,with:()=>(V.subscribe(async K=>{if(L.dispatch({type:`${m.fu}/fetchRemote/fulfilled`}),K.length>0){const H=await(0,a.s)(B),X=await(0,a.s)(U),k=await(0,a.s)(W),Y=await(0,a.s)(N);L.dispatch(P((0,y.td)({local:H,remote:K,instance:X,provisioned:k,pluginErrors:Y})))}}),(0,r.p)({local:B,instance:U,provisioned:W,pluginErrors:N}))})).subscribe(({local:K,remote:H,instance:X,provisioned:k,pluginErrors:Y})=>{K&&H?(L.dispatch({type:`${m.fu}/fetchLocal/fulfilled`}),L.dispatch({type:`${m.fu}/fetchRemote/fulfilled`}),L.dispatch(P((0,y.td)({local:K,remote:H,instance:X,provisioned:k,pluginErrors:Y})))):K&&(L.dispatch({type:`${m.fu}/fetchLocal/fulfilled`}),L.dispatch(P((0,y.td)({local:K,pluginErrors:Y}))))},K=>(console.log(K),L.dispatch({type:`${m.fu}/fetchLocal/rejected`}),L.dispatch({type:`${m.fu}/fetchRemote/rejected`}),L.rejectWithValue("Unknown error."))),null}catch{return L.rejectWithValue("Unknown error.")}}),v=(0,t.zD)(`${m.fu}/fetchAllLocal`,async(A,L)=>{try{return(await(0,p.Gd)()).map(W=>(0,y.kH)(W))}catch{return L.rejectWithValue("Unknown error.")}}),u=(0,t.zD)(`${m.fu}/fetchRemotePlugins`,async(A,L)=>{try{return await(0,p.T_)()}catch(U){return(0,o.NF)(U)&&(U.isHandled=!0),L.rejectWithValue([])}}),D=(0,t.zD)(`${m.fu}/fetchDetails`,async(A,L)=>{try{const U=await(0,p.CB)(A);return{id:A,changes:{details:U}}}catch{return L.rejectWithValue("Unknown error.")}}),P=(0,t.VP)(`${m.fu}/addPlugins`),x=(0,t.VP)(`${m.fu}/addLocalPlugins`),E=(0,t.VP)(`${m.fu}/addLocalPlugins`),C=(0,t.VP)(`${m.fu}/addLocalPlugins`),M=(0,t.zD)(`${m.fu}/install`,async({id:A,version:L,isUpdating:U=!1},W)=>{const w=U?{isInstalled:!0,installedVersion:L,hasUpdate:!1}:{isInstalled:!0,installedVersion:L};try{return await(0,p.xZ)(A),await(0,y.tr)(),U&&(0,l.sk)(A),{id:A,changes:w}}catch(N){return console.error(N),(0,o.NF)(N)?W.rejectWithValue(N.data):W.rejectWithValue("Unknown error.")}}),S=(0,t.zD)(`${m.fu}/install`,async()=>({})),I=(0,t.zD)(`${m.fu}/uninstall`,async(A,L)=>{try{return await(0,p.cu)(A),await(0,y.tr)(),(0,l.sk)(A),{id:A,changes:{isInstalled:!1,installedVersion:void 0}}}catch(U){return console.error(U),L.rejectWithValue("Unknown error.")}}),T=(0,t.zD)(`${m.fu}/loadPluginDashboards`,async(A,L)=>{const w=`api/plugins/${L.getState().dataSources.dataSource.type}/dashboards`;return(0,o.AI)().get(w)}),b=(0,t.VP)(`${m.fu}/panelPluginLoaded`),R=A=>async(L,U)=>{let W=U().plugins.panels[A];return W||(W=await(0,g.TV)(A),U().plugins.panels[A]||L(b(W))),W}},31326:(G,O,e)=>{"use strict";e.d(O,{AI:()=>r,Ff:()=>p,qo:()=>l});var t=e(65307),n=e(6745),i=e(66253),s=e(20701);const r=(0,t.pU)(),f=m=>new RegExp(`${n.fu}/(.*)/pending`).test(m.type),a=m=>new RegExp(`${n.fu}/(.*)/fulfilled`).test(m.type),c=m=>new RegExp(`${n.fu}/(.*)/rejected`).test(m.type),o=m=>{const y=m.lastIndexOf("/");return m.substring(0,y)},h={items:r.getInitialState(),requests:{},settings:{displayMode:i.fy.Grid},plugins:[],errors:[],searchQuery:"",hasFetched:!1,dashboards:[],isLoadingPluginDashboards:!1,panels:{}},g=(0,t.Z0)({name:"plugins",initialState:h,reducers:{setDisplayMode(m,y){m.settings.displayMode=y.payload}},extraReducers:m=>m.addCase(s.aU,(y,d)=>{r.upsertMany(y.items,d.payload)}).addCase(s.LR.fulfilled,(y,d)=>{r.upsertMany(y.items,d.payload)}).addCase(s.t5.fulfilled,(y,d)=>{r.updateOne(y.items,d.payload)}).addCase(s.ai.fulfilled,(y,d)=>{r.updateOne(y.items,d.payload)}).addCase(s.JC.fulfilled,(y,d)=>{r.updateOne(y.items,d.payload)}).addCase(s.NJ,(y,d)=>{y.panels[d.payload.meta.id]=d.payload}).addCase(s.h9.pending,(y,d)=>{y.isLoadingPluginDashboards=!0,y.dashboards=[]}).addCase(s.h9.fulfilled,(y,d)=>{y.isLoadingPluginDashboards=!1,y.dashboards=d.payload}).addMatcher(f,(y,d)=>{y.requests[o(d.type)]={status:i.IZ.Pending}}).addMatcher(a,(y,d)=>{y.requests[o(d.type)]={status:i.IZ.Fulfilled}}).addMatcher(c,(y,d)=>{y.requests[o(d.type)]={status:i.IZ.Rejected,error:d.payload}})}),{setDisplayMode:l}=g.actions,p=g.reducer},66253:(G,O,e)=>{"use strict";e.d(O,{IZ:()=>c,Ip:()=>i,LZ:()=>a,Uy:()=>s,fy:()=>t,og:()=>f,u8:()=>r,vk:()=>n});var t=(o=>(o.Grid="grid",o.List="list",o))(t||{}),n=(o=>(o.Home="plugins-home",o.Browse="plugins-browse",o.Details="plugins-details",o))(n||{}),i=(o=>(o.app="apps",o.datasource="database",o.panel="credit-card",o.renderer="capture",o.secretsmanager="key-skeleton-alt",o))(i||{}),s=(o=>(o.Deleted="deleted",o.Active="active",o.Pending="pending",o.Deprecated="deprecated",o.Enterprise="enterprise",o))(s||{}),r=(o=>(o.INSTALL="INSTALL",o.UNINSTALL="UNINSTALL",o.UPDATE="UPDATE",o.REINSTALL="REINSTALL",o))(r||{}),f=(o=>(o.OVERVIEW="Overview",o.VERSIONS="Version history",o.CONFIG="Config",o.DASHBOARDS="Dashboards",o.USAGE="Usage",o.IAM="IAM",o))(f||{}),a=(o=>(o.OVERVIEW="overview",o.VERSIONS="version-history",o.CONFIG="config",o.DASHBOARDS="dashboards",o.USAGE="usage",o.IAM="iam",o))(a||{}),c=(o=>(o.Pending="Pending",o.Fulfilled="Fulfilled",o.Rejected="Rejected",o))(c||{})},74106:(G,O,e)=>{"use strict";e.d(O,{c:()=>a});var t=e(74848),n=e(96540),i=e(43429),s=e(14110),r=e(42418);function f(c,o){let h;switch(c){case i.QE.app:h="app plugin";break;case i.QE.panel:h="panel plugin";break;case i.QE.datasource:h="data source plugin";break;default:h="plugin"}let g=`This ${h} uses a deprecated, legacy platform based on AngularJS and `;return o===void 0?g+" may be incompatible depending on your Grafana configuration.":o?g+" will stop working in future releases of Grafana.":g+" is incompatible with your current Grafana configuration."}function a(c){const{className:o,angularSupportEnabled:h,pluginId:g,pluginType:l,showPluginDetailsLink:p,interactionElementId:m}=c,[y,d]=(0,n.useState)(!1),v={};return g&&(v.pluginId=g),m&&(v.elementId=m),y?null:(0,t.jsxs)(r.F,{severity:"warning",title:"Angular plugin",className:o,onRemove:()=>d(!0),children:[(0,t.jsx)("p",{children:f(l,h)}),(0,t.jsx)("div",{className:"markdown-html",children:(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:(0,t.jsx)("a",{href:"https://grafana.com/docs/grafana/latest/developers/angular_deprecation/",className:"external-link",target:"_blank",rel:"noreferrer",onClick:()=>{(0,s.rR)("angular_deprecation_docs_clicked",v)},children:"Read our deprecation notice and migration advice."})}),p&&g?(0,t.jsx)("li",{children:(0,t.jsx)("a",{href:`plugins/${encodeURIComponent(g)}`,className:"external-link",target:"_blank",rel:"noreferrer",children:"View plugin details"})}):null]})})]})}},8480:(G,O,e)=>{"use strict";e.d(O,{Hv:()=>s,mz:()=>r});var t=e(32264);function n(f){return Object.values(t.$.datasources).find(a=>a.uid===f)??null}function i(f){return n(f)?.meta.angular?.detected??!1}function s(f){const a=n(f);return(a?.meta.angular?.detected&&!a?.meta.angular.hideDeprecation)??!1}const r=new Set(["autoMigrateOldPanels","autoMigrateGraphPanel","autoMigrateTablePanel","autoMigratePiechartPanel","autoMigrateWorldmapPanel","autoMigrateStatPanel","disableAngular"])},10803:(G,O,e)=>{"use strict";e.d(O,{p:()=>s});var t=e(74848),n=e(43429),i=e(39938);const s=f=>{const a=r(f.state);return a?(0,t.jsx)(i.E,{className:f.className,color:a.color,title:a.tooltip,text:a.text,icon:a.icon}):null};function r(f){switch(f){case n.pn.deprecated:return{text:"Deprecated",color:"red",tooltip:"This feature is deprecated and will be removed in a future release"};case n.pn.alpha:return{text:"Alpha",color:"blue",tooltip:"This feature is experimental and future updates might not be backward compatible"};case n.pn.beta:return{text:"Beta",color:"blue",tooltip:"This feature is close to complete but not fully tested"};default:return null}}},31193:(G,O,e)=>{"use strict";e.d(O,{tR:()=>v,xq:()=>m});var t=e(40187),n=e(26272),i=e(80147),s=e(72574),r=e(81634),f=e(17172),a=e(19347),c=e(26657),o=e(28138),h=e(2913),g=e(53478),l=e(66718),p=e(685);class m{constructor(D=(0,s.w)()){this.templateSrv=D,this.datasources={},this.settingsMapByName={},this.settingsMapByUid={},this.settingsMapById={},this.defaultName=""}init(D,P){this.datasources={},this.settingsMapByUid={},this.settingsMapByName=D,this.defaultName=P;for(const x of Object.values(D))x.uid||(x.uid=x.name),this.settingsMapByUid[x.uid]=x,this.settingsMapById[x.id]=x;this.datasources[c.dR.type]=g.Ex,this.datasources[l.Uj]=g.Ex,this.settingsMapByUid[c.dR.uid]=g.$i,this.settingsMapByUid[l.Uj]=g.$i}getDataSourceSettingsByUid(D){return this.settingsMapByUid[D]}getInstanceSettings(D,P){let x=y(D);if((0,c.s9)(x))return g.$i;if(x==="default"||x==null)return this.settingsMapByUid[this.defaultName]??this.settingsMapByName[this.defaultName];if(x[0]==="$"){const E=this.templateSrv.replace(x,P,d);let C;return E==="default"?C=this.settingsMapByName[this.defaultName]:C=this.settingsMapByUid[E]??this.settingsMapByName[E],C?{...C,isDefault:!1,name:x,uid:x,rawRef:{type:C.type,uid:C.uid}}:void 0}return this.settingsMapByUid[x]??this.settingsMapByName[x]??this.settingsMapById[x]}get(D,P){let x=y(D);if(!x)return this.get(this.defaultName);if((0,c.s9)(D))return Promise.resolve(this.datasources[l.Uj]);const E=this.settingsMapByName[x];return E&&(x=E.uid),this.datasources[x]?Promise.resolve(this.datasources[x]):(x=this.templateSrv.replace(x,P,d),x==="default"&&this.defaultName!=="default"?this.get(this.defaultName):this.datasources[x]?Promise.resolve(this.datasources[x]):this.loadDatasource(x))}async loadDatasource(D){if(this.datasources[D])return Promise.resolve(this.datasources[D]);const P=this.getInstanceSettings(D);if(!P)return Promise.reject({message:`Datasource ${D} was not found`});try{const x=await(0,p.cS)(P.meta);if(this.datasources[D])return this.datasources[D];const E=x.DataSourceClass.length!==1;let C;if(E?C=(0,r.C)().instantiate(x.DataSourceClass,{instanceSettings:P}):C=new x.DataSourceClass(P),C.components=x.components,!(C instanceof t.mA)){const M=C;M.name=P.name,M.id=P.id,M.type=P.type,M.meta=P.meta,M.uid=P.uid,C.getRef=t.mA.prototype.getRef}return this.datasources[D]=C,this.datasources[C.uid]=C,C}catch(x){return x instanceof Error&&o.A.emit(n.r1.alertError,[P.name+" plugin failed",x.toString()]),Promise.reject({message:`Datasource: ${D} was not found`})}}getAll(){return Object.values(this.settingsMapByName)}getList(D={}){const P=Object.values(this.settingsMapByName).filter(E=>!(E.meta.id==="grafana"||E.meta.id==="mixed"||E.meta.id==="dashboard"||D.metrics&&!E.meta.metrics||D.tracing&&!E.meta.tracing||D.logs&&E.meta.category!=="logging"&&!E.meta.logs||D.annotations&&!E.meta.annotations||D.alerting&&!E.meta.alerting||D.pluginId&&!(0,i._)(D.pluginId,E.meta)||D.filter&&!D.filter(E)||D.type&&(Array.isArray(D.type)?!D.type.includes(E.type):D.type!==E.type)||!D.all&&E.meta.metrics!==!0&&E.meta.annotations!==!0&&E.meta.tracing!==!0&&E.meta.logs!==!0&&E.meta.alerting!==!0));if(D.variables)for(const E of this.templateSrv.getVariables()){if(E.type!=="datasource")continue;let C=E.current.value==="default"?this.defaultName:E.current.value;Array.isArray(C)&&(C=C[0]);const M=!Array.isArray(C)&&(this.settingsMapByName[C]||this.settingsMapByUid[C]);if(M){const S=`\${${E.name}}`;P.push({...M,isDefault:!1,name:S,uid:S})}}const x=P.sort((E,C)=>E.name.toLowerCase()>C.name.toLowerCase()?1:E.name.toLowerCase()<C.name.toLowerCase()?-1:0);if(!D.pluginId&&!D.alerting){if(D.mixed){const E=this.getInstanceSettings("-- Mixed --");E&&P.push(E)}if(D.dashboard){const E=this.getInstanceSettings("-- Dashboard --");E&&P.push(E)}if(!D.tracing){const E=this.getInstanceSettings("-- Grafana --");E&&P.push(E)}}return x}getExternal(){return this.getList()}getAnnotationSources(){return this.getList({annotations:!0,variables:!0}).map(D=>({name:D.name,value:D.name,meta:D.meta}))}getMetricSources(D){return this.getList({metrics:!0,variables:!D?.skipVariables}).map(P=>({name:P.name,value:P.name,meta:P.meta}))}async reload(){const D=await(0,f.AI)().get("/api/frontend/settings");h.Ay.datasources=D.datasources,h.Ay.defaultDatasource=D.defaultDatasource,this.init(D.datasources,D.defaultDatasource)}}function y(u){return(0,c.s9)(u)?c.dR.uid:typeof u=="string"?u:u?.uid}function d(u){return Array.isArray(u)?u[0]:u}const v=()=>(0,a.l)()},75462:(G,O,e)=>{"use strict";e.d(O,{$Y:()=>M,FF:()=>p,N9:()=>A,WW:()=>d,io:()=>T,nv:()=>D,ol:()=>x,pL:()=>R,yS:()=>y,yb:()=>u,yt:()=>E,z1:()=>m});var t=e(74848),n=e(32196),i=e(2543),s=e.n(i),r=e(16817),f=e(74135),a=e(13834),c=e(47232),o=e(37390),h=e(28138),g=e(27716),l=e(28444);function p(L){console.warn(`[Plugin Extensions] ${L}`)}function m(L){return typeof L=="object"&&"type"in L&&L.type===f.u.link}function y(L){return typeof L=="object"&&"type"in L&&L.type===f.u.component}function d(L){return typeof L=="object"&&"type"in L&&L.type===f.u.component&&L.extensionPointId.startsWith("capabilities/")}function v(L,U=""){return(...W)=>{try{return L(...W)}catch(w){w instanceof Error&&console.warn(`${U}${w.message}`)}}}function u(L,U){return{openModal:async w=>{const{title:N,body:B,width:V,height:K}=w;h.A.publish(new l.S8({component:D(L,P({title:N,body:B,width:V,height:K}))}))},context:U}}const D=(L,U)=>w=>{const{error:N,loading:B,value:V}=(0,r.A)(()=>(0,g.x)(L,{showErrorAlert:!1}));return B?null:N?(p(`Could not fetch plugin meta information for "${L}", aborting. (${N.message})`),null):V?(0,t.jsx)(a.a,{meta:V,children:(0,t.jsx)(U,{...w})}):(p(`Fetched plugin meta information is empty for "${L}", aborting.`),null)},P=({title:L,body:U,width:W,height:w})=>{const N=(0,n.css)({width:W,height:w});return({onDismiss:V})=>(0,t.jsx)(o.a,{title:L,className:N,isOpen:!0,onDismiss:V,onClickBackdrop:V,children:(0,t.jsx)(U,{onDismiss:V})})};function x(L,U=new Map){if(!L||typeof L!="object"||Object.isFrozen(L))return L;const W=Array.isArray(L)?[...L]:{...L};if(U.has(L))return U.get(L);U.set(L,W);const w=Reflect.ownKeys(W);for(const N of w){const B=Array.isArray(W)?W[Number(N)]:W[N];B&&(typeof B=="object"||typeof B=="function")&&(Array.isArray(W)?W[Number(N)]=x(B,U):W[N]=x(B,U))}return Object.freeze(W)}function E(L,U){const W=`${L}${U.extensionPointId}${U.title}`;return Array.from(W).reduce((w,N)=>Math.imul(31,w)+N.charCodeAt(0)|0,0).toString()}const C=Symbol("isReadOnlyProxy");function M(L){if(!L||typeof L!="object"||I(L))return L;const U=new WeakMap;return new Proxy(L,{defineProperty:()=>!1,deleteProperty:()=>!1,isExtensible:()=>!1,set:()=>!1,get(W,w,N){if(w===C)return!0;const B=Reflect.get(W,w,N);return(0,c.Ar)(B)?(0,c.KQ)(B):(0,i.isObject)(B)||(0,i.isArray)(B)?(U.has(B)||U.set(B,M(B)),U.get(B)):B}})}function S(L){return typeof L=="object"&&L!==null}function I(L){return S(L)&&L[C]===!0}function T(L){const U={type:f.u.link,...L};return b(U),U}function b(L){if(L.type!==f.u.link)throw Error("config is not a extension link")}function R(L,U){return L.length<U?L:`${L.slice(0,U-3).trimEnd()}...`}function A(L){const U={},W=[];for(const N of L){const B=N.category;if(!B){W.push({text:R(N.title,25),href:N.path,onClick:N.onClick});continue}Array.isArray(U[B])||(U[B]=[]),U[B].push({text:R(N.title,25),href:N.path,onClick:N.onClick})}const w=Object.keys(U).reduce((N,B)=>(N.push({text:R(B,25),type:"group",subMenu:U[B]}),N),[]);return W.length>0&&(w.length>0&&w.push({text:"divider",type:"divider"}),Array.prototype.push.apply(w,W)),w}},15162:(G,O,e)=>{"use strict";e.d(O,{Kk:()=>h,PY:()=>g,TV:()=>a,d4:()=>o,f7:()=>m,oZ:()=>c});var t=e(65158),n=e(2913),i=e(41394),s=e(685);const r={},f={};function a(y){const d=r[y];if(d)return d;const v=o(y);if(!v)throw new Error(`Plugin ${y} not found`);return r[y]=l(v),y!==v.type&&(r[v.type]=r[y]),r[y]}function c(y){return!!o(y)}function o(y){const d=n.Ay.panels[y];if(!d){for(const v of Object.values(n.Ay.panels))if(v.aliasIDs?.includes(y))return v}return d}function h(y){return l(y)}function g(y){return f[y]}function l(y){return(0,s.j4)({path:y.module,version:y.info?.version,isAngular:y.angular?.detected,pluginId:y.id}).then(d=>{if(d.plugin)return d.plugin;if(d.PanelCtrl){const v=new t.m(null);return v.angularPanelCtrl=d.PanelCtrl,v}throw new Error("missing export: plugin or PanelCtrl")}).then(d=>(d.meta=y,f[y.id]=d,!d.panel&&d.angularPanelCtrl&&(d.panel=p(d)),d)).catch(d=>(console.warn("Error loading panel plugin: "+y.id,d),(0,i.W)(y,d)))}let p=y=>null;function m(y){p=y}},81900:(G,O,e)=>{"use strict";e.d(O,{GD:()=>s,QO:()=>a,ni:()=>f,sk:()=>r});var t=e(27716),n=e(45179);const i={};function s({pluginId:o,version:h,isAngular:g}){const l=o;l&&!i[l]&&(i[l]={version:encodeURI(h),isAngular:g,pluginId:o})}function r(o){const h=o;i[h]&&delete i[h],(0,t.o)(o)}function f(o,h=n.x8){const g=c(o);if(!g)return`${o}?_cache=${h}`;const p=i[g]?.version||h;return`${o}?_cache=${p}`}function a(o){const h=c(o);if(h)return i[h]}function c(o){const h=Object.keys(i).find(g=>o.includes(g));if(h)return h}},45179:(G,O,e)=>{"use strict";e.d(O,{$b:()=>n,Bu:()=>i,XV:()=>t,x8:()=>s});const t="package",n=/^plugins.+\.css$/i,i=/^(text|application)\/(x-)?javascript(;|$)/,s=Date.now()},63770:(G,O,e)=>{"use strict";e.d(O,{z:()=>a});var t=e(59511),n=e.n(t),i=e(65024),s=e.n(i),r=e(35135),f=e.n(r);const a=window.System},94429:(G,O,e)=>{"use strict";e.d(O,{kB:()=>g,OD:()=>l,Av:()=>p});var t=e(32264),n=e(66161),i=e(45179),s=e(34867);const r=new WeakMap,f={};function a(m,y,d){const v={get(u,D){if(document.currentScript===null&&typeof D!="symbol"&&D.toString()!=="__useDefault"){const x=`${y}.${String(D)}`,E=`${x}`;f[E]||(f[E]=!0,(0,s.fH)(`Plugin using ${x}`,{key:String(D),parent:y,packageName:d}))}let P=Reflect.get(u,D);return P!==null&&typeof P=="object"&&!(P instanceof RegExp)?(r.has(P)||r.set(P,a(P,`${y}.${String(D)}`,d)),r.get(P)):(typeof P=="function"&&(P=P.bind(u)),P)}};return typeof m=="object"&&m!==null?new Proxy(m,v):m}const c=/^(@grafana|app\/)/;function o(m,y){return c.test(y)?a(m,y,y):m}var h=e(63770);function g(m){return Object.keys(m).reduce((y,d)=>{const v=`${i.XV}:${d}`,u=t.$.featureToggles.pluginsAPIMetrics?o(m[d],d):m[d];return h.z.set(v,u),n.s.set(d,m[d]),y[d]=v,y},{})}function l(m){return!!t.$.pluginsCDNBaseURL&&m.startsWith(t.$.pluginsCDNBaseURL)}function p(m){return m.startsWith("http")||m.startsWith("/")?m:`${t.$.appSubUrl??""}/${m}`}},27716:(G,O,e)=>{"use strict";e.d(O,{o:()=>s,x:()=>i});var t=e(17172);const n={};function i(r,f){const a=n[r];return a?Promise.resolve(a):(0,t.AI)().get(`/api/plugins/${r}/settings`,void 0,void 0,f).then(c=>(n[r]=c,c)).catch(c=>typeof c=="object"&&c!==null&&"status"in c&&c.status===403?(c.isHandled=!0,Promise.reject(c)):Promise.reject(new Error("Unknown Plugin")))}const s=r=>r?delete n[r]:Object.keys(n).forEach(f=>delete n[f])},685:(G,O,e)=>{"use strict";e.d(O,{ui:()=>qg,cS:()=>Zg,j4:()=>kc});var t={};e.r(t),e.d(t,{plugin:()=>Ye});var n={};e.r(n),e.d(n,{plugin:()=>En});var i={};e.r(i),e.d(i,{plugin:()=>fr});var s={};e.r(s),e.d(s,{plugin:()=>Za});var r={};e.r(r),e.d(r,{plugin:()=>cl});var f={};e.r(f),e.d(f,{plugin:()=>Js});var a={};e.r(a),e.d(a,{plugin:()=>co});var c={};e.r(c),e.d(c,{plugin:()=>Uu});var o={};e.r(o),e.d(o,{plugin:()=>Wu});var h={};e.r(h),e.d(h,{plugin:()=>Fl});var g={};e.r(g),e.d(g,{plugin:()=>th});var l={};e.r(l),e.d(l,{plugin:()=>ph});var p={};e.r(p),e.d(p,{plugin:()=>pl});var m={};e.r(m),e.d(m,{plugin:()=>Oh});var y={};e.r(y),e.d(y,{plugin:()=>Lo});var d={};e.r(d),e.d(d,{plugin:()=>Zh});var v={};e.r(v),e.d(v,{plugin:()=>tr});var u={};e.r(u),e.d(u,{plugin:()=>kl});var D={};e.r(D),e.d(D,{plugin:()=>Df});var P={};e.r(P),e.d(P,{plugin:()=>Lf});var x={};e.r(x),e.d(x,{plugin:()=>Uf});var E={};e.r(E),e.d(E,{plugin:()=>Pp});var C={};e.r(C),e.d(C,{plugin:()=>Ff});var M=e(40187),S=e(41987),I=e(32264),T=e(74848),b=e(65158),R=e(67061),A=e(55852),L=e(85242),U=e(51612),W=e(31678),w=e(57220),N=e(2543),B=e.n(N),V=e(96540),K=e(90182),H=e(14578),X=e(61410),k=e(23770),Y=e(88467),Z=e(94822),se=e(75214);const j=J=>{const{onChange:pe,id:Me,defaultValue:Ue,dataSource:ze}=J,tt=(0,W.useDispatch)();(0,V.useEffect)(()=>{ze?ze&&tt((0,k.mB)({rulesSourceName:ze})):tt((0,k.nV)())},[tt,ze]);const it=(0,X.$)(Ht=>Ht.promRules),bt=(0,Y.p0)(it),Lt=(0,Y.Vf)(it),Nt=(0,V.useMemo)(()=>{if((0,N.isEmpty)(it))return[];if(!bt)return[];const Ht=Object.keys(it).flatMap(Xt=>it[Xt].result??[]).flatMap(Xt=>Xt.groups).flatMap(Xt=>Xt.rules.filter(cn=>cn.type===Z.JS.Alerting)).flatMap(Xt=>Xt.alerts??[]).map(Xt=>Object.keys(Xt.labels??{})).flatMap(Xt=>Xt.filter(cn=>!(0,se.F2)(cn)));return(0,N.uniq)(Ht)},[bt,it]);return(0,T.jsx)(K.KF,{id:Me,isLoading:Lt,defaultValue:Ue,"aria-label":"group by label keys",placeholder:"Group by",prefix:(0,T.jsx)(H.I,{name:"tag-alt"}),onChange:Ht=>{pe(Ht.map(Xt=>Xt.value??""))},options:Nt.map(Ht=>({label:Ht,value:Ht}))})};var q=e(32196),ne=e(42941),oe=e(94701),z=e(3591),te=e(40845),le=e(40276),ie=e(37494),ae=e(39558),re=e(42418),ce=e(2913),me=e(55907),ee=e(79938),de=e(75648),De=e(9518),fe=e(55740),Te=e(32642),je=e(23662),He=e(14792),Be=e(19073),Ne=e(64861),Re=e(15458),Se=e(55127),We=e.n(Se),Ke=e(2426),Xe=e(56361),Je=e(15054),st=e(98164),pt=e(54317);function xt(J,pe){const Me=(0,Te.Zc)(J);return(0,st.Av)(pe,Me)}function ot(J,pe){const{stateFilter:Me,alertInstanceLabelFilter:Ue}=J;return(0,N.isEmpty)(Me)?pe:pe.filter(ze=>(Me.firing&&((0,pt.S)(ze,Z.Gi.Alerting)||(0,pt.S)(ze,Z.cF.Firing))||Me.pending&&((0,pt.S)(ze,Z.Gi.Pending)||(0,pt.S)(ze,Z.cF.Pending))||Me.noData&&(0,pt.S)(ze,Z.Gi.NoData)||Me.normal&&(0,pt.S)(ze,Z.Gi.Normal)||Me.error&&(0,pt.S)(ze,Z.Gi.Error)||Me.inactive&&(0,pt.S)(ze,Z.cF.Inactive))&&(Ue?xt(J.alertInstanceLabelFilter,ze.labels):!0))}const $e=({rule:J,alerts:pe,options:Me,grafanaTotalInstances:Ue,handleInstancesLimit:ze,limitInstances:tt,grafanaFilteredInstancesTotal:it})=>{const bt=Me.groupMode===Ne.r6.Custom?!0:Me.showInstances,[Lt,Nt]=(0,V.useState)(bt),Ht=(0,te.of)(ve),Xt=(0,te.of)(A.my),cn=(0,V.useCallback)(()=>{Nt(la=>!la)},[]),Gt=(0,V.useMemo)(()=>ot(Me,(0,Xe.Cp)(Me.sortOrder,pe))??[],[pe,Me]),pn=Ue!==void 0,zn=Ue&&it?Ue-it:0,Ln=pe.length-Gt.length,Kn=pn?zn:Ln,Rn=Gt.length>0,mn=Rn?cn:N.noop;(0,V.useEffect)(()=>{Gt.length===0&&Nt(!1)},[Gt]);const bn=async()=>{ze&&(ze(!1),Nt(!0))},Ns=async()=>{ze&&(ze(!0),Nt(!0))},ts=tt?it:Gt.length,Es=Gt.length,Hn=pn?ts:Es,jn=tt?`Showing ${de.Ys} of ${Ue} instances`:`Showing all ${Ue} instances`,is=tt?"View all instances":`Limit the result to ${de.Ys} instances`,Zn=Ue&&de.Ys===Gt.length&&Ue>Gt.length,ps=Ue&&de.Ys<Gt.length&&!tt,Fs=Zn||ps?(0,T.jsxs)("div",{className:Ht.footerRow,children:[(0,T.jsx)("div",{children:jn}),(0,T.jsx)(A.$n,{size:"sm",variant:"secondary",onClick:tt?bn:Ns,children:is})]}):void 0;return(0,T.jsxs)("div",{children:[Me.groupMode===Ne.r6.Default&&(0,T.jsxs)("button",{className:(0,q.cx)(Xt,Rn?Ht.clickable:""),onClick:()=>mn(),children:[Rn&&(0,T.jsx)(H.I,{name:Lt?"angle-down":"angle-right",size:"md"}),(0,T.jsx)("span",{children:`${Hn} ${We()("instance",Hn)}`}),Kn>0&&(0,T.jsxs)("span",{children:[", ",`${Kn} hidden by filters`]})]}),Lt&&(0,T.jsx)(Ke.D,{rule:J,instances:Gt,pagination:{itemsPerPage:2*Je.FG},footerRow:Fs})]})},ve=J=>({clickable:(0,q.css)`
    cursor: pointer;
  `,footerRow:(0,q.css)`
    display: flex;
    flex-direction: column;
    gap: ${J.spacing(1)};
    justify-content: space-between;
    align-items: center;
    width: 100%;
  `}),be="__ungrouped__",he=({rules:J,options:pe})=>{const Me=(0,te.of)(Pn),Ue=pe.groupBy,ze=(0,V.useMemo)(()=>{const tt=new Map,it=Nt=>Ue?ge(Nt,Ue):!0;J.forEach(Nt=>{const Ht=(0,je.TU)(Nt),Xt=it(Nt);(Ht?.alerts??[]).forEach(cn=>{const Gt=Xt?ye(Ue,cn.labels):be,pn=tt.get(Gt)?.alerts??[];tt.set(Gt,{rule:Nt,alerts:[...pn,cn]})})});const bt=tt.get(be)?.alerts??[];return tt.delete(be),tt.set(be,{alerts:bt}),Array.from(tt.entries()).reduce((Nt,[Ht,{rule:Xt,alerts:cn}])=>{const Gt=ot(pe,cn);return Gt.length>0&&Nt.set(Ht,{rule:Xt,alerts:Gt}),Nt},new Map)},[Ue,J,pe]);return(0,T.jsx)(T.Fragment,{children:Array.from(ze).map(([tt,{rule:it,alerts:bt}])=>(0,T.jsx)("li",{className:Me.alertRuleItem,"data-testid":tt,children:(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{className:Me.customGroupDetails,children:(0,T.jsxs)("div",{className:Me.alertLabels,children:[tt!==be&&Pe(tt).map(([Lt,Nt])=>(0,T.jsx)(Re.R,{labelKey:Lt,value:Nt},Lt)),tt===be&&"No grouping"]})}),(0,T.jsx)($e,{rule:it,alerts:bt,options:pe})]})},tt))})};function ye(J,pe){return new URLSearchParams(J.map(Me=>[Me,pe[Me]])).toString()}function Pe(J){return[...new URLSearchParams(J)]}function ge(J,pe){const Me=(0,je.TU)(J);return pe.every(Ue=>(Me?.alerts??[]).some(ze=>ze.labels[Ue]))}const xe=he;var Ae=e(87586),Ee=e(70416),Ie=e(26058),Qe=e(18461),at=e(3704);function ft(J){return Object.values(J).filter(pe=>pe!==void 0).reduce((pe,Me)=>pe+Me,0)}const ct=({rules:J,options:pe,handleInstancesLimit:Me,limitInstances:Ue,hideViewRuleLinkText:ze})=>{const tt=(0,te.of)(Pn),it=(0,te.of)(vt),{href:bt}=(0,Ae.A)(),Lt=J.length<=pe.maxItems?J:J.slice(0,pe.maxItems);return(0,T.jsx)(T.Fragment,{children:(0,T.jsx)("ol",{className:tt.alertRuleList,children:Lt.map((Nt,Ht)=>{const{namespaceName:Xt,groupName:cn,dataSourceName:Gt}=Nt,pn=(0,je.Z8)(Nt.promRule)?Nt.promRule:void 0,zn=(0,je.Om)(pn),Ln=(0,Qe.UP)(Nt.dataSourceName,Nt),Kn=(0,Qe.$9)(Ln),Rn=Nt.dataSourceName===w.hY?ft(Nt.instanceTotals):void 0,mn=Nt.dataSourceName===w.hY?ft(Nt.filteredInstanceTotals):void 0,bn=(0,at.c)(`/alerting/${encodeURIComponent(Gt)}/${encodeURIComponent(Kn)}/view`,{returnTo:bt??""});return pn?(0,T.jsxs)("li",{className:tt.alertRuleItem,children:[(0,T.jsx)("div",{className:it.icon,children:(0,T.jsx)(H.I,{name:me.A.getStateDisplayModel(pn.state).iconClass,className:it[(0,je.Wy)(pn.state)],size:"lg"})}),(0,T.jsxs)("div",{className:tt.alertNameWrapper,children:[(0,T.jsxs)("div",{className:tt.instanceDetails,children:[(0,T.jsxs)(R.B,{direction:"row",gap:1,children:[(0,T.jsx)("div",{className:tt.alertName,title:Nt.name,children:Nt.name}),(0,T.jsx)(Ie.h,{}),bn&&(0,T.jsxs)("a",{href:bn,target:"__blank",className:tt.link,rel:"noopener","aria-label":"View alert rule",children:[(0,T.jsx)("span",{className:(0,q.cx)({[tt.hidden]:ze}),children:"View alert rule"}),(0,T.jsx)(H.I,{name:"external-link-alt",size:"sm"})]})]}),(0,T.jsxs)("div",{className:tt.alertDuration,children:[(0,T.jsx)("span",{className:it[(0,je.Wy)(pn.state)],children:(0,je.XI)(pn.state)})," ",zn&&pn.state!==Z.cF.Inactive&&(0,T.jsxs)(T.Fragment,{children:["for"," ",(0,T.jsx)("span",{children:(0,Ee.dU)({start:zn,end:Date.now()})})]})]})]}),(0,T.jsx)($e,{rule:Nt,alerts:pn.alerts??[],options:pe,grafanaTotalInstances:Rn,grafanaFilteredInstancesTotal:mn,handleInstancesLimit:Me,limitInstances:Ue})]})]},`alert-${Xt}-${cn}-${Nt.name}-${Ht}`):null})})})},vt=J=>({common:(0,q.css)`
    width: 70px;
    text-align: center;
    align-self: stretch;

    display: inline-block;
    color: white;
    border-radius: ${J.shape.radius.default};
    font-size: ${J.typography.bodySmall.fontSize};
    text-transform: capitalize;
    line-height: 1.2;
    flex-shrink: 0;

    display: flex;
    flex-direction: column;
    justify-content: center;
  `,icon:(0,q.css)`
    margin-top: ${J.spacing(2.5)};
    align-self: flex-start;
  `,good:(0,q.css)`
    color: ${J.colors.success.main};
  `,bad:(0,q.css)`
    color: ${J.colors.error.main};
  `,warning:(0,q.css)`
    color: ${J.colors.warning.main};
  `,neutral:(0,q.css)`
    color: ${J.colors.secondary.main};
  `,info:(0,q.css)`
    color: ${J.colors.primary.main};
  `}),Pt=ct;function Vt(J){const pe=(Me,[Ue,ze])=>ze?[...Me,Ue]:Me;return Object.entries(J).reduce(pe,[])}const Jt=({dispatch:J,limitInstances:pe,matcherList:Me,dataSourceName:Ue,stateList:ze})=>{J(Ue?(0,k.Lc)({rulesSourceName:Ue,limitAlerts:pe?de.Ys:void 0,matcher:Me,state:ze}):(0,k.yo)(!1,{limitAlerts:pe?de.Ys:void 0,matcher:Me,state:ze}))};function wt(J){const pe=(0,W.useDispatch)(),[Me,Ue]=(0,ne.A)(!0),[,ze]=(0,Be.Ej)(Be.RY.ViewAlertRule),{usePrometheusRulesByNamespaceQuery:tt}=ee.hK,it=(0,X.$)(Ts=>Ts.promRules),bt=(0,X.$)(Ts=>Ts.rulerRules),Lt=(0,Y.t4)(it),Nt=J.width<320;(0,V.useEffect)(()=>{J.options.stateFilter.inactive===!0&&(J.options.stateFilter.normal=!0),J.options.stateFilter.inactive=void 0},[J.options.stateFilter]);let Ht;(0,oe.A)(()=>{Ht=(0,He.UA)().getCurrent()});const Xt=(0,V.useMemo)(()=>Vt(J.options.stateFilter),[J.options.stateFilter]),{options:cn,replaceVariables:Gt}=J,pn=cn.datasource===w.vv?w.hY:cn.datasource,zn={...J.options,alertName:Gt(cn.alertName),alertInstanceLabelFilter:Gt(cn.alertInstanceLabelFilter)},Ln=(0,V.useMemo)(()=>(0,Te.Zc)(zn.alertInstanceLabelFilter),[zn.alertInstanceLabelFilter]),Kn=(!pn||pn===w.hY)&&ze,{currentData:Rn=[],isLoading:mn,refetch:bn}=tt({limitAlerts:Me?de.Ys:void 0,matcher:Ln,state:Xt},{skip:!Kn});(0,V.useEffect)(()=>{it.loading||Jt({dispatch:pe,limitInstances:Me,matcherList:Ln,dataSourceName:pn,stateList:Xt});const Ts=Ht?.events.subscribe(z.sR,()=>{Kn&&bn(),(!pn||pn!==w.hY)&&Jt({dispatch:pe,limitInstances:Me,matcherList:Ln,dataSourceName:pn,stateList:Xt})});return()=>{Ts?.unsubscribe()}},[pe,Ht,Ln,Xt,Me,pn,bn,Kn,it.loading]);const Ns=Ts=>{Ts?(Jt({dispatch:pe,limitInstances:Me,matcherList:Ln,dataSourceName:pn,stateList:Xt}),Ue(!0)):(Jt({dispatch:pe,limitInstances:!1,matcherList:Ln,dataSourceName:pn,stateList:Xt}),Ue(!1))},ts=(0,De.dy)(void 0,Rn),Es=(0,Y.t4)(bt),Hn=(0,Y.BU)(it),jn=Lt||Es,is=(0,Y.Vf)(it),Zn=(0,te.of)(Pn),ps=(0,je.dS)(ts),Fs=J.options.sortOrder,la=(0,V.useMemo)(()=>on(J,zt(Fs,ps)),[ps,Fs,J]),ia=la.length===0?"No alerts matching filters":void 0,Na=mn||jn&&is&&!Hn,aa=Object.values(it).some(Ts=>Ts.result);return(0,T.jsx)(le.E,{autoHeightMin:"100%",autoHeightMax:"100%",children:(0,T.jsxs)("div",{className:Zn.container,children:[aa&&ia&&(0,T.jsx)("div",{className:Zn.noAlertsMessage,children:ia}),aa&&(0,T.jsxs)("section",{children:[J.options.viewMode===Ne.nE.Stat&&(0,T.jsx)(ie.yV,{width:J.width,height:J.height,graphMode:ie.$p.None,textMode:ie.SV.Auto,justifyMode:ie.F8.Auto,theme:ce.config.theme2,value:{text:`${la.length}`,numeric:la.length}}),J.options.viewMode===Ne.nE.List&&J.options.groupMode===Ne.r6.Custom&&(0,T.jsx)(xe,{rules:la,options:zn}),J.options.viewMode===Ne.nE.List&&J.options.groupMode===Ne.r6.Default&&(0,T.jsx)(Pt,{rules:la,options:zn,handleInstancesLimit:Ns,limitInstances:Me,hideViewRuleLinkText:Nt})]}),Na&&(0,T.jsx)(ae._,{text:"Loading..."})]})})}function zt(J,pe){if(J===Ne.xB.Importance)return(0,N.sortBy)(pe,Ue=>me.A.alertStateSortScore[Ue.state]);if(J===Ne.xB.TimeAsc)return(0,N.sortBy)(pe,Ue=>{const ze=(0,je.TU)(Ue)??void 0;return(0,je.Om)(ze)||new Date});if(J===Ne.xB.TimeDesc)return(0,N.sortBy)(pe,Ue=>{const ze=(0,je.TU)(Ue)??void 0;return(0,je.Om)(ze)||new Date}).reverse();const Me=(0,N.sortBy)(pe,Ue=>Ue.name.toLowerCase());return J===Ne.xB.AlphaDesc&&Me.reverse(),Me}function on(J,pe){const{options:Me,replaceVariables:Ue}=J;let ze=[...pe];if(Me.dashboardAlerts){const tt=(0,He.UA)().getCurrent()?.uid;ze=ze.filter(({annotations:it={}})=>Object.entries(it).some(([bt,Lt])=>bt===fe.YH.dashboardUID&&Lt===tt))}if(Me.alertName){const tt=Ue(Me.alertName);ze=ze.filter(({name:it})=>it.toLocaleLowerCase().includes(tt.toLocaleLowerCase()))}if(ze=ze.filter(tt=>{const it=(0,je.TU)(tt);return it?Me.stateFilter.firing&&it.state===Z.cF.Firing||Me.stateFilter.pending&&it.state===Z.cF.Pending||Me.stateFilter.normal&&it.state===Z.cF.Inactive:!1}),Me.folder&&(ze=ze.filter(tt=>tt.namespaceName===Me.folder.title)),Me.datasource){const tt=Me.datasource===w.vv;ze=ze.filter(tt?({dataSourceName:it})=>it===w.hY:({dataSourceName:it})=>it===Me.datasource)}return ze=ze.reduce((tt,it)=>{const bt=(0,je.TU)(it);return(bt?ot({stateFilter:Me.stateFilter,alertInstanceLabelFilter:Ue(Me.alertInstanceLabelFilter)},bt.alerts??[]):[]).length&&tt.push(it),tt},[]),ze}const Pn=J=>({cardContainer:(0,q.css)`
    padding: ${J.spacing(.5)} 0 ${J.spacing(.25)} 0;
    line-height: ${J.typography.body.lineHeight};
    margin-bottom: 0px;
  `,container:(0,q.css)`
    overflow-y: auto;
    height: 100%;
  `,alertRuleList:(0,q.css)`
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    list-style-type: none;
  `,alertRuleItem:(0,q.css)`
    display: flex;
    align-items: center;
    width: 100%;
    height: 100%;
    background: ${J.colors.background.secondary};
    padding: ${J.spacing(.5)} ${J.spacing(1)};
    border-radius: ${J.shape.radius.default};
    margin-bottom: ${J.spacing(.5)};

    gap: ${J.spacing(2)};
  `,alertName:(0,q.css)`
    font-size: ${J.typography.h6.fontSize};
    font-weight: ${J.typography.fontWeightBold};

    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  `,alertNameWrapper:(0,q.css)`
    display: flex;
    flex: 1;
    flex-wrap: nowrap;
    flex-direction: column;

    min-width: 100px;
  `,alertLabels:(0,q.css)`
    > * {
      margin-right: ${J.spacing(.5)};
    }
  `,alertDuration:(0,q.css)`
    font-size: ${J.typography.bodySmall.fontSize};
  `,alertRuleItemText:(0,q.css)`
    font-weight: ${J.typography.fontWeightBold};
    font-size: ${J.typography.bodySmall.fontSize};
    margin: 0;
  `,alertRuleItemTime:(0,q.css)`
    color: ${J.colors.text.secondary};
    font-weight: normal;
    white-space: nowrap;
  `,alertRuleItemInfo:(0,q.css)`
    font-weight: normal;
    flex-grow: 2;
    display: flex;
    align-items: flex-end;
  `,noAlertsMessage:(0,q.css)`
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
  `,alertIcon:(0,q.css)`
    margin-right: ${J.spacing(.5)};
  `,instanceDetails:(0,q.css)`
    min-width: 1px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  `,customGroupDetails:(0,q.css)`
    margin-bottom: ${J.spacing(.5)};
  `,link:(0,q.css)`
    word-break: break-all;
    color: ${J.colors.primary.text};
    display: flex;
    align-items: center;
    gap: ${J.spacing(1)};
  `,hidden:(0,q.css)`
    display: none;
  `});function _n(J){const[,pe]=(0,Be.Ej)(Be.RY.ViewAlertRule),[,Me]=(0,Be.Ej)(Be.RY.ViewExternalAlertRule);return!pe&&!Me?(0,T.jsx)(re.F,{title:"Permission required",children:"Sorry, you do not have the required permissions to read alert rules"}):(0,T.jsx)(wt,{...J})}const Ye=new b.m(_n).setPanelOptions(J=>{J.addRadio({path:"viewMode",name:"View mode",description:"Toggle between list view and stat view",defaultValue:Ne.nE.List,settings:{options:[{label:"List",value:Ne.nE.List},{label:"Stat",value:Ne.nE.Stat}]},category:["Options"]}).addRadio({path:"groupMode",name:"Group mode",description:"How alert instances should be grouped",defaultValue:Ne.r6.Default,settings:{options:[{value:Ne.r6.Default,label:"Default grouping"},{value:Ne.r6.Custom,label:"Custom grouping"}]},category:["Options"]}).addCustomEditor({path:"groupBy",name:"Group by",description:"Filter alerts using label querying",id:"groupBy",defaultValue:[],showIf:pe=>pe.groupMode===Ne.r6.Custom,category:["Options"],editor:pe=>(0,T.jsx)(j,{id:pe.id??"groupBy",defaultValue:pe.value.map(Me=>({label:Me,value:Me})),onChange:pe.onChange,dataSource:pe.context.options.datasource})}).addNumberInput({name:"Max items",path:"maxItems",description:"Maximum alerts to display",defaultValue:20,category:["Options"]}).addSelect({name:"Sort order",path:"sortOrder",description:"Sort order of alerts and alert instances",settings:{options:[{label:"Alphabetical (asc)",value:Ne.xB.AlphaAsc},{label:"Alphabetical (desc)",value:Ne.xB.AlphaDesc},{label:"Importance",value:Ne.xB.Importance},{label:"Time (asc)",value:Ne.xB.TimeAsc},{label:"Time (desc)",value:Ne.xB.TimeDesc}]},defaultValue:Ne.xB.AlphaAsc,category:["Options"]}).addBooleanSwitch({path:"dashboardAlerts",name:"Alerts linked to this dashboard",description:"Only show alerts linked to this dashboard",defaultValue:!1,category:["Options"]}).addTextInput({path:"alertName",name:"Alert name",description:"Filter for alerts containing this text",defaultValue:"",category:["Filter"]}).addTextInput({path:"alertInstanceLabelFilter",name:"Alert instance label",description:'Filter alert instances using label querying, ex: {severity="critical", instance=~"cluster-us-.+"}',defaultValue:"",category:["Filter"]}).addCustomEditor({path:"datasource",name:"Datasource",description:"Filter from alert source",id:"datasource",defaultValue:null,editor:function(Me){return(0,T.jsxs)(R.B,{gap:1,children:[(0,T.jsx)(U.s,{...Me,type:["prometheus","loki","grafana"],noDefault:!0,current:Me.value,onChange:Ue=>Me.onChange(Ue.name)}),(0,T.jsx)(A.$n,{variant:"secondary",onClick:()=>Me.onChange(null),children:"Clear"})]})},category:["Filter"]}).addCustomEditor({showIf:pe=>pe.datasource===w.vv||!pe.datasource,path:"folder",name:"Folder",description:"Filter for alerts in the selected folder (only for Grafana alerts)",id:"folder",defaultValue:null,editor:function(Me){return(0,T.jsx)(L.sR,{enableReset:!0,showRoot:!1,allowEmpty:!0,initialTitle:Me.value?.title,initialFolderUid:Me.value?.uid,permissionLevel:W.PermissionLevelString.View,onClear:()=>Me.onChange(""),...Me})},category:["Filter"]}).addBooleanSwitch({path:"stateFilter.firing",name:"Alerting / Firing",defaultValue:!0,category:["Alert state filter"]}).addBooleanSwitch({path:"stateFilter.pending",name:"Pending",defaultValue:!0,category:["Alert state filter"]}).addBooleanSwitch({path:"stateFilter.noData",name:"No Data",defaultValue:!1,category:["Alert state filter"]}).addBooleanSwitch({path:"stateFilter.normal",name:"Normal",defaultValue:!1,category:["Alert state filter"]}).addBooleanSwitch({path:"stateFilter.error",name:"Error",defaultValue:!0,category:["Alert state filter"]})});var Dt=e(79924),yt=e(64423),Ft=e(71733),an=e(26272),un=e(69129),hn=e(47232),Un=e(12131),Nn=e(17172),St=e(64149),nn=e(3911),ht=e(85918),lt=e(28138),gt=e(10860),$t=e(44522),et=e(56034);const Et=({options:J,annotation:pe,formatDate:Me,onClick:Ue,onAvatarClick:ze,onTagClick:tt})=>{const it=(0,te.of)(sn),{showUser:bt,showTags:Lt,showTime:Nt}=J,{text:Ht="",login:Xt,email:cn,avatarUrl:Gt,tags:pn,time:zn,timeEnd:Ln}=pe,Kn=()=>{Ue(pe)},Rn=()=>{ze(pe)},mn=Xt&&bt,bn=zn&&Nt,Ns=Ln&&Ln!==zn&&Nt;return(0,T.jsxs)(gt.Z,{className:it.card,onClick:Kn,children:[(0,T.jsx)(gt.Z.Heading,{children:(0,T.jsx)($t.I,{className:it.heading,onClick:ts=>{ts.stopPropagation()},content:Ht})}),bn&&(0,T.jsxs)(gt.Z.Description,{className:it.timestamp,children:[(0,T.jsx)(Qt,{formatDate:Me,time:zn}),Ns&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("span",{className:it.time,children:"-"}),(0,T.jsx)(Qt,{formatDate:Me,time:Ln})," "]})]}),mn&&(0,T.jsx)(gt.Z.Meta,{className:it.meta,children:(0,T.jsx)(It,{email:cn,login:Xt,avatarUrl:Gt,onClick:Rn})}),Lt&&pn&&(0,T.jsx)(gt.Z.Tags,{children:(0,T.jsx)(St.L,{tags:pn,onClick:ts=>tt(ts,!1)})})]})},It=({onClick:J,avatarUrl:pe,login:Me,email:Ue})=>{const ze=(0,te.of)(sn),tt=bt=>{bt.stopPropagation(),J()},it=(0,T.jsxs)("span",{children:["Created by:",(0,T.jsx)("br",{})," ",Ue]});return(0,T.jsx)(et.m,{content:it,theme:"info",placement:"top",children:(0,T.jsx)("button",{onClick:tt,className:ze.avatar,children:(0,T.jsx)("img",{src:pe,alt:"avatar icon"})})})},Qt=({time:J,formatDate:pe})=>{const Me=(0,te.of)(sn);return(0,T.jsx)("span",{className:Me.time,children:(0,T.jsx)("span",{children:pe(J)})})};function sn(J){return{card:(0,q.css)({gridTemplateAreas:'"Heading Description Meta Tags"',gridTemplateColumns:"auto 1fr auto auto",padding:J.spacing(1),margin:J.spacing(.5),width:"inherit"}),heading:(0,q.css)({a:{zIndex:1,position:"relative",color:J.colors.text.link,"&:hover":{textDecoration:"underline"}}}),meta:(0,q.css)({margin:0,position:"relative",justifyContent:"end"}),timestamp:(0,q.css)({margin:0,alignSelf:"center"}),time:(0,q.css)({marginLeft:J.spacing(1),marginRight:J.spacing(1),fontSize:J.typography.bodySmall.fontSize,color:J.colors.text.secondary}),avatar:(0,q.css)({border:"none",background:"inherit",margin:0,padding:J.spacing(.5),img:{borderRadius:J.shape.radius.circle,width:J.spacing(2),height:J.spacing(2)}})}}class ln extends V.PureComponent{constructor(pe){super(pe),this.style=yn(I.$.theme2),this.subs=new yt.yU,this.tagListRef=(0,V.createRef)(),this.onAnnoClick=async Me=>{if(!Me.time)return;const{options:Ue}=this.props,tt=(0,He.UA)().getCurrent(),it={from:this._timeOffset(Me.time,Ue.navigateBefore,!0),to:this._timeOffset(Me.timeEnd??Me.time,Ue.navigateAfter,!1),viewPanel:Ue.navigateToPanel&&Me.panelId?Me.panelId:void 0};if(!Me.dashboardUID||tt?.uid===Me.dashboardUID){Un.Ny.partial(it);return}const bt=await(0,Nn.AI)().get("/api/search",{dashboardUIDs:Me.dashboardUID});if(bt&&bt.length&&bt[0].uid===Me.dashboardUID){const Lt=bt[0],Nt=new URL(Lt.url,window.location.origin);Nt.searchParams.set("from",String(it.from)),Nt.searchParams.set("to",String(it.to)),Un.Ny.push(Ft.I.stripBaseFromUrl(Nt.toString()));return}lt.A.emit(an.r1.alertWarning,["Unknown Dashboard: "+Me.dashboardUID])},this.onTagClick=(Me,Ue)=>{if(!Ue&&this.state.queryTags.includes(Me))return;const ze=Ue?this.state.queryTags.filter(it=>it!==Me):[...this.state.queryTags,Me];let tt;if(Ue){const it=document.activeElement,bt=it?.getAttribute("data-tag-id");if(this.tagListRef.current?.contains(it)&&bt){const Lt=Number.parseInt(bt,10),Nt=this.tagListRef.current.querySelector(`[data-tag-id="${Lt+1}"]`)??this.tagListRef.current.querySelector(`[data-tag-id="${Lt-1}"]`);Nt instanceof HTMLElement&&(tt=Nt)}}this.setState({queryTags:ze},()=>tt?.focus())},this.onUserClick=Me=>{this.setState({queryUser:{id:Me.userId,login:Me.login,email:Me.email}})},this.onClearUser=()=>{this.setState({queryUser:void 0})},this.renderItem=(Me,Ue)=>{const{options:ze}=this.props,tt=(0,He.UA)().getCurrent();return tt?(0,T.jsx)(Et,{annotation:Me,formatDate:tt.formatDate,onClick:this.onAnnoClick,onAvatarClick:this.onUserClick,onTagClick:this.onTagClick,options:ze}):(0,T.jsx)(T.Fragment,{})},this.state={annotations:[],timeInfo:"",loaded:!1,queryTags:[]}}componentDidMount(){this.doSearch(),this.subs.add(this.props.eventBus.getStream(un.We).subscribe({next:()=>{this.doSearch()}}))}componentWillUnmount(){this.subs.unsubscribe()}componentDidUpdate(pe,Me){const{options:Ue,timeRange:ze}=this.props;(Ue!==pe.options||this.state.queryTags!==Me.queryTags||this.state.queryUser!==Me.queryUser||pe.renderCounter!==this.props.renderCounter||Ue.onlyInTimeRange&&ze!==pe.timeRange)&&this.doSearch()}async doSearch(){const{options:pe}=this.props,{queryUser:Me,queryTags:Ue}=this.state,ze={tags:pe.tags,limit:pe.limit,type:"annotation"};pe.onlyFromThisDashboard&&(ze.dashboardUID=(0,He.UA)().getCurrent()?.uid);let tt="";if(pe.onlyInTimeRange){const{timeRange:bt}=this.props;ze.from=bt.from.valueOf(),ze.to=bt.to.valueOf()}else tt="All Time";Me&&(ze.userId=Me.id),pe.tags&&pe.tags.length&&(ze.tags=pe.tags.map(bt=>this.props.replaceVariables(bt))),Ue.length&&(ze.tags=ze.tags?[...ze.tags,...Ue]:Ue);const it=await(0,Nn.AI)().get("/api/annotations",ze,`anno-list-panel-${this.props.id}`);this.setState({annotations:it,timeInfo:tt,loaded:!0})}_timeOffset(pe,Me,Ue=!1){let ze=5,tt="m";const it=/^(\d+)(\w)/.exec(Me);it&&it.length===3&&(ze=parseInt(it[1],10),tt=it[2]);const bt=(0,hn.KQ)(pe);return Ue&&(ze*=-1),bt.add(ze,tt).valueOf()}render(){const{loaded:pe,annotations:Me,queryUser:Ue,queryTags:ze}=this.state;if(!pe)return(0,T.jsx)("div",{children:"loading..."});const tt=Ue||ze.length>0;return(0,T.jsxs)(le.E,{autoHeightMin:"100%",children:[tt&&(0,T.jsxs)("div",{className:this.style.filter,children:[(0,T.jsx)("b",{children:"Filter:"}),Ue&&(0,T.jsx)(A.$n,{size:"sm",variant:"secondary",fill:"text",onClick:this.onClearUser,"aria-label":`Remove filter: ${Ue.email}`,children:Ue.email}),ze.length>0&&(0,T.jsx)(St.L,{icon:"times",tags:ze,onClick:it=>this.onTagClick(it,!0),getAriaLabel:it=>`Remove ${it} tag`,className:this.style.tagList,ref:this.tagListRef})]}),Me.length<1&&(0,T.jsx)("div",{className:this.style.noneFound,children:"No Annotations Found"}),(0,T.jsx)(ht.p,{items:Me,renderItem:this.renderItem,getItemKey:it=>`${it.id}`})]})}}const yn=(0,nn.N)(J=>({noneFound:(0,q.css)({display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"calc(100% - 30px)"}),filter:(0,q.css)({alignItems:"center",display:"flex",flexWrap:"wrap",gap:J.spacing(.5),padding:J.spacing(.5)}),tagList:(0,q.css)({justifyContent:"flex-start","li > button":{paddingLeft:"3px"}})})),Sn={limit:10,navigateAfter:"10m",navigateBefore:"10m",navigateToPanel:!0,onlyFromThisDashboard:!1,onlyInTimeRange:!1,showTags:!0,showTime:!0,showUser:!0,tags:[]},En=new b.m(ln).setPanelOptions(J=>{J.addRadio({category:["Annotation query"],path:"onlyFromThisDashboard",name:"Query filter",defaultValue:Sn.onlyFromThisDashboard,settings:{options:[{value:!1,label:"All dashboards"},{value:!0,label:"This dashboard"}]}}).addRadio({category:["Annotation query"],path:"onlyInTimeRange",name:"Time range",defaultValue:Sn.onlyInTimeRange,settings:{options:[{value:!1,label:"None"},{value:!0,label:"This dashboard"}]}}).addCustomEditor({category:["Annotation query"],id:"tags",path:"tags",name:"Tags",description:"Match annotation tags",editor(pe){return(0,T.jsx)(Dt.u,{tags:pe.value,onChange:pe.onChange})}}).addNumberInput({category:["Annotation query"],path:"limit",name:"Limit",defaultValue:Sn.limit}).addBooleanSwitch({category:["Display"],path:"showUser",name:"Show user",defaultValue:Sn.showUser}).addBooleanSwitch({category:["Display"],path:"showTime",name:"Show time",defaultValue:Sn.showTime}).addBooleanSwitch({category:["Display"],path:"showTags",name:"Show tags",defaultValue:Sn.showTags}).addRadio({category:["Link behavior"],path:"navigateToPanel",name:"Link target",defaultValue:Sn.navigateToPanel,settings:{options:[{value:!0,label:"Panel"},{value:!1,label:"Dashboard"}]}}).addTextInput({category:["Link behavior"],path:"navigateBefore",name:"Time before",defaultValue:Sn.navigateBefore,description:""}).addTextInput({category:["Link behavior"],path:"navigateAfter",name:"Time after",defaultValue:Sn.navigateAfter,description:""})}).setPanelChangeHandler((J,pe,Me)=>pe==="ryantxu-annolist-panel"?Me:J.options);var wn=e(37055),On=e(24293),Rt=e(27310),Ot=e(47070),jt=e(11261),rt=e(52622),tn=e(52198),Mn=e(38248),kn=e(11404),Yn=e(89654),Wn=e(22680),Jn=e(71242),Ls=e(24882),fs=e(97152),ys=e(29413),Xn=e(30501),Ps=e(67266),Zs=e(81297),Ms=e(38761),ks=e(22731),wa=e(8066),Xa=e(96516),pa=e(16895),Ba=e(28895);function _a(J,pe){return pe[0].fields.slice(1).some(Me=>!Me.config.custom?.hideFrom?.legend)}const dr=(0,V.memo)(({data:J,placement:pe,calcs:Me,displayMode:Ue,colorField:ze,...tt})=>{const it=(0,te.$j)();if(ze!=null){const Lt=(0,Ba.jY)([ze],it);if(Lt?.length)return(0,T.jsx)(Ps.KU.Legend,{placement:pe,children:(0,T.jsx)(Xa.t,{placement:pe,items:Lt,displayMode:Ue})})}const bt=J[0].fields.slice(1).map((Lt,Nt)=>{const Xt=Nt+1;if(!Lt||Lt.config.custom?.hideFrom?.legend)return;const cn=Lt.state?.displayName??Lt.name,Gt=(0,wa.lz)(Lt,it).color;return{disabled:Lt.state?.hideFrom?.viz,color:Gt,label:cn,yAxis:Lt.config.custom?.axisPlacement===rt.vM.Right?2:1,getDisplayValues:()=>(0,pa.UO)(Me,Lt,it),getItemKey:()=>`${cn}-0-${Xt}`}}).filter(Lt=>Lt!==void 0);return(0,T.jsx)(Ps.KU.Legend,{placement:pe,...tt,children:(0,T.jsx)(Xa.t,{placement:pe,items:bt,displayMode:Ue,sortBy:tt.sortBy,sortDesc:tt.sortDesc,isSortable:!0})})});dr.displayName="BarChartLegend";var Wa=e(36613),en=e(28240),$n=e(73060),Qn=e(57875),Gn=e(83195),qn=e(73134),es=e(51336),Ss=e(52811),_s=e(82915),Pa=e(42994),Ea=e(72724),Ys=e(23596),ha=e(39758),ja=e(4134);const ua=Pa.WC.interval,za=ha.ur,Ja=ha.ur,pr=8,Wr=30,Fr=.65,Kr=.1,Ar=.15,$r=5,so=10,Zr=.1;function mo(J,pe,Me,Ue,ze){const tt=(0,ys.kD)(J,14),it=pe/(tt.width+2)*14,bt=Me/Ue,Lt=Math.min(bt,it);return{fontSize:Math.min(Lt,ze??Lt),textMetrics:tt}}function ao(J,pe){const{xOri:Me,xDir:Ue,rawValue:ze,getColor:tt,formatValue:it,formatShortValue:bt,fillOpacity:Lt=1,showValue:Nt,xSpacing:Ht=0,hoverMulti:Xt=!1,timeZone:cn="browser"}=J,Gt=Me===rt.Lt.Horizontal,pn=!J.text?.valueSize,zn=J.stacking!==rt.gs.None,Ln=J.stacking===rt.gs.Percent;let{groupWidth:Kn,barWidth:Rn,barRadius:mn=0}=J;zn&&([Kn,Rn]=[Rn,Kn]);let bn;const ts=Array(30).fill(null);let Es;const Hn=ms=>Array.from(ms.data[0].map((Vn,ls)=>ls)),jn=Ht===0?void 0:(ms,Vn)=>{const ls=ms.bbox.width,sa=Ue*(Gt?1:-1);let Qs=Vn.length,ca=Qs-1,Oa=0,Tr=ls/Wa.A.pxRatio,ho=Math.abs(Math.floor(Tr/Ht));Oa=Qs<ho?0:Math.ceil(Qs/ho);let Ui=Vn.map((To,Ni)=>Oa!==0&&(Ht>0?Ni:ca-Ni)%Oa>0?null:To);return sa===1?Ui:Ui.reverse()},is=(ms,Vn,ls,sa,Qs)=>{if(J.xTimeAuto){let ca=ua.year;return Qs<Xn.Zj.second?ca=ua.millisecond:Qs<Xn.Zj.minute?ca=ua.second:Qs<Xn.Zj.hour?ca=ua.minute:Qs<Xn.Zj.day?ca=ua.hour:Qs<Xn.Zj.month?ca=ua.day:Qs<Xn.Zj.year?ca=ua.month:ca=ua.year,Vn.map(Oa=>Oa==null?"":(0,Ea.LE)(Oa,{format:ca,timeZone:cn}))}return Vn.map(ca=>Gt?bt(0,ca):it(0,ca))},Zn=(ms,Vn,ls)=>{Vn=0,ls=Math.max(1,ms.data[0].length-1);let sa=0;(0,ha.mn)(ms.data[0].length,Kn,za,0,(ca,Oa,Tr)=>{sa=Oa+Tr/2});let Qs=ls-Vn;if(sa===.5)Vn-=Qs;else{let Oa=(1/(1-sa*2)*Qs-Qs)/2;Vn-=Oa,ls+=Oa}return[Vn,ls]};let ps=(ms,Vn)=>{let ls=Array.from({length:Vn},()=>({offs:Array(ms).fill(0),size:Array(ms).fill(0)}));return(0,ha.mn)(ms,Kn,za,null,(sa,Qs,ca)=>{(0,ha.mn)(Vn,Rn,Ja,null,(Oa,Tr,ho)=>{ls[Oa].offs[sa]=Qs+ca*Tr,ls[Oa].size[sa]=ca*ho})}),ls},Fs=(ms,Vn)=>{let ls=Array.from({length:Vn},()=>({offs:Array(ms).fill(0),size:Array(ms).fill(0)}));return(0,ha.mn)(ms,Kn,za,null,(sa,Qs,ca)=>{(0,ha.mn)(Vn,Rn,Ja,null,(Oa,Tr,ho)=>{ls[Oa].offs[sa]=Qs,ls[Oa].size[sa]=ca})}),ls};const la=Gt?Kr:Ar,ia=Gt?$r:so;let Na=[],aa=[],Ts=1,Is,ba=J.text?.valueSize??Wr,Va=ia,Vs=1/0,Rs=1/0,ra=tt!=null,Da=ra?{fill:{unit:3,values:(ms,Vn)=>aa[Vn].fill},stroke:{unit:3,values:(ms,Vn)=>aa[Vn].stroke}}:{},ga=Wa.A.paths.bars({radius:Ln?0:zn?(ms,Vn)=>Vn===ms.data.length-1?[mn,0]:[0,0]:mn,disp:{x0:{unit:2,values:(ms,Vn)=>Na[Vn].offs},size:{unit:2,values:(ms,Vn)=>Na[Vn].size},...Da},each:(ms,Vn,ls,sa,Qs,ca,Oa)=>{sa-=ms.bbox.left,Qs-=ms.bbox.top;let Tr=ms.data[Vn][ls];Gt?(Vs=Math.min(Vs,Tr<0?ms.bbox.height-(Qs+Oa):Qs),Rs=ca):(Vs=Oa,Rs=Math.min(Rs,Tr<0?sa:ms.bbox.width-(sa+ca)));let ho={x:sa,y:Qs,w:ca,h:Oa,sidx:Vn,didx:ls};if(!zn&&J.fullHighlight&&(J.xOri===rt.Lt.Horizontal?(ho.y=0,ho.h=ms.bbox.height):(ho.x=0,ho.w=ms.bbox.width)),bn.add(ho),Nt!==rt.yL.Never){const Ui=ze(Vn,ls);let To=1;Ln&&Ya[Vn][ls]&&(To=Ya[Vn][ls]);const Ni=To===0?0:Ui/To,Rl=it(Vn,Ni);if(Va=Math.min(Va,Math.round(la*(Gt?ca:Oa))),Is[ls]===void 0&&(Is[ls]={}),Is[ls][Vn]={text:Rl,value:ze(Vn,ls),hidden:!1},pn){const{fontSize:wi,textMetrics:qi}=mo(Is[ls][Vn].text,Rs*(Gt?Fr:1)-(Gt?0:Va),Vs*(Gt?1:Fr)-(Gt?Va:0),1);Is[ls][Vn].textMetrics=qi;let Jr=Math.round(Math.min(ba,Wr,wi));Ts=Jr/ba*(Jr/14),ba=Jr}else Is[ls][Vn].textMetrics=(0,ys.kD)(Is[ls][Vn].text,ba);let tc=Gt?0:-Math.round(Zr*ba),Bo=ze(Vn,ls);if(J.negY?.[Vn]&&Bo!=null&&(Bo*=-1),Bo!=null){const wi=ms.bbox.left+(Gt?sa+ca/2:Bo<0?sa-Va:sa+ca+Va),qi=ms.bbox.top+(Gt?Bo<0?Qs+Oa+Va:Qs-Va:Qs+Oa/2-tc),{textMetrics:Jr={width:1,actualBoundingBoxAscent:1,actualBoundingBoxDescent:1}}=Is[ls][Vn];let Ll=0,Gc=0;Gt?(Ll=Jr.width*Ts/2,Gc=Bo>0?(Jr.actualBoundingBoxAscent+Jr.actualBoundingBoxDescent)*Ts:0):(Gc=(Jr.actualBoundingBoxAscent+Jr.actualBoundingBoxDescent)*Ts/2,Ll=Bo<0?Jr.width*Ts:0),Is[ls][Vn].x=wi,Is[ls][Vn].y=qi,Is[ls][Vn].bbox={x:wi-Ll,y:qi-Gc,w:Jr.width*Ts,h:(Jr.actualBoundingBoxAscent+Jr.actualBoundingBoxDescent)*Ts}}}}});const Ia=ms=>{ms.root.querySelectorAll(".u-cursor-pt").forEach(Vn=>{Vn.style.borderRadius="0",J.fullHighlight&&(Vn.style.zIndex="-1")})},Ha={x:!1,y:!1,drag:{x:!1,y:!1},dataIdx:(ms,Vn)=>{if(Vn===0){ts.fill(null),Es=null;let ls=ms.cursor.left*Wa.A.pxRatio,sa=ms.cursor.top*Wa.A.pxRatio;bn.get(ls,sa,1,1,Qs=>{(0,ja.ur)(ls,sa,Qs.x,Qs.y,Qs.x+Qs.w,Qs.y+Qs.h)&&(Es=ts[0]=Qs,ts[Es.sidx]=Es,Xt&&(0,ja.Tr)(bn,void 0,Es.didx).forEach(ca=>{ts[ca.sidx]=ca}))})}return ts[Vn]?.didx},points:{fill:"rgba(255,255,255,0.4)",bbox:(ms,Vn)=>{let ls=ts[Vn],sa=ls!=null;return{left:sa?ls.x/Wa.A.pxRatio:-10,top:sa?ls.y/Wa.A.pxRatio:-10,width:sa?ls.w/Wa.A.pxRatio:0,height:sa?ls.h/Wa.A.pxRatio:0}}},focus:{prox:1e3,dist:(ms,Vn)=>Es?.sidx===Vn?0:1/0}},xa=ms=>{if(bn=bn||new ja.C$(0,0,ms.bbox.width,ms.bbox.height),bn.clear(),ms.series.forEach(Vn=>{Vn._paths=null}),zn?Na=[null,...Fs(ms.data[0].length,ms.data.length-1)]:Na=[null,...ps(ms.data[0].length,ms.data.length-1)],ra){aa=[null];for(let Vn=1;Vn<ms.data.length;Vn++){let ls=ms.data[Vn].map((sa,Qs)=>sa!=null?tt(Vn,Qs,sa):null);aa.push({fill:Lt<1?ls.map(sa=>sa!=null?(0,Ys.X4)(sa,Lt):null):ls,stroke:ls})}}Is={},ba=J.text?.valueSize??Wr,Va=ia,Vs=Rs=1/0},Qa=ms=>{if(Nt===rt.yL.Never||ba<pr)return;ms.ctx.save(),ms.ctx.fillStyle=pe.colors.text.primary,ms.ctx.font=`${ba}px ${pe.typography.fontFamily}`;let Vn,ls;for(const sa in Is){let Qs=!0;for(const ca in Is[sa]){const Oa=Is[sa][ca],{text:Tr,x:ho=0,y:Ui=0}=Oa;let{value:To}=Oa;J.negY?.[ca]&&To!=null&&(To*=-1);let Ni=Gt?"center":To!==null&&To<0?"right":"left",Rl=Gt?To!==null&&To<0?"top":"alphabetic":"middle";if(Ni!==Vn&&(ms.ctx.textAlign=Vn=Ni),Rl!==ls&&(ms.ctx.textBaseline=ls=Rl),Nt===rt.yL.Always)ms.ctx.fillText(Tr,ho,Ui);else if(Nt===rt.yL.Auto){let{bbox:tc}=Oa,Bo=!1;if(tc==null)Bo=!0,Oa.hidden=!0;else if(!Qs)for(const wi in Is[sa]){if(wi===ca)continue;const qi=Is[sa][wi],{bbox:Jr,hidden:Ll}=qi;if(!Ll&&Jr&&(0,ja.HY)(tc,Jr)){Bo=!0,Oa.hidden=!0;break}}Qs=!1,!Bo&&ms.ctx.fillText(Tr,ho,Ui)}}}ms.ctx.restore()};let Ya=null;function cr(ms,Vn){return Ya=null,(0,pa.bq)(ms[0],Vn,({totals:ls})=>{Ya=ls})}return{cursor:Ha,xRange:Zn,xValues:is,xSplits:Hn,hFilter:jn,barsBuilder:ga,init:Ia,drawClear:xa,draw:Qa,prepData:cr}}const Fa={barRadius:0,barWidth:.97,fullHighlight:!1,groupWidth:.7,orientation:rt.wV.Auto,showValue:rt.yL.Auto,stacking:rt.gs.None,xTickLabelRotation:0,xTickLabelSpacing:0},fo={fillOpacity:80,gradientMode:rt.on.None,lineWidth:1};function ko(J,pe,Me,Ue,ze,tt){if(J.length===0||J.every(Nt=>Nt.length===0))return{series:[],_rest:[],warn:"No data in response"};(0,en.Fm)(J),(0,en.j2)(J,pe);let it={...J[0]};const bt=it.fields.findIndex(Nt=>Nt.type===jt.PU.time);bt>=0&&J.length>1&&(it=(0,$n.Fd)({frames:J,keepDisplayNames:!0})??it);const Lt=it.fields.find(Nt=>Nt.state?.displayName===ze||Nt.name===ze)??it.fields.find(Nt=>Nt.type===jt.PU.string)??it.fields[bt];if(Lt!=null){const Nt=[Lt],Ht=[],Xt=tt==null?void 0:it.fields.find(pn=>pn.state?.displayName===tt||pn.name===tt);it.fields.forEach(pn=>{if(pn!==Lt)if(pn.type===jt.PU.number&&!pn.config.custom?.hideFrom?.viz){const zn={...pn,values:pn.values.map(Ln=>Number.isFinite(Ln)?Ln:null),config:{...pn.config,custom:{...pn.config.custom,stacking:{group:"_",mode:Me}}}};Nt.push(zn)}else Ht.push(pn)});let cn=null;Nt.length===1&&(cn="No numeric fields found"),it.fields=Nt;const Gt=[it];return(0,_s.O2)(Gt,Ue,0),{series:Gt,_rest:Ht,color:Xt,warn:cn}}return{series:[],_rest:[],color:null,warn:"Bar charts requires a string or time field"}}const Go=({series:J,totalSeries:pe,color:Me,orientation:Ue,options:ze,timeZone:tt,theme:it})=>{let{showValue:bt,groupWidth:Lt,barWidth:Nt,barRadius:Ht=0,stacking:Xt,text:cn,tooltip:Gt,xTickLabelRotation:pn,xTickLabelMaxLength:zn,xTickLabelSpacing:Ln=0,legend:Kn,fullHighlight:Rn}=ze,mn=J[0];const bn=new es.e,Ns=mn.fields.map((aa,Ts)=>Xt===rt.gs.Percent?(0,Qn.J)({field:{...aa,config:{...aa.config,unit:"percentunit"}},theme:it}):aa.display),ts=(aa,Ts)=>(0,Gn.cN)(Ns[aa](Ts)),Es=(aa,Ts)=>Ut(ts(aa,Ts),zn),Hn=Tn(Ue);mn.fields.length===2&&Xt===rt.gs.None&&(pe===1&&(Lt=Nt),Nt=1);const jn=(aa,Ts)=>mn.fields[aa].values[Ts];let is,Zn=1;if(Me!=null){const aa=Me.display;Zn=(Me.config.custom.fillOpacity??100)/100,is=(Ts,Is)=>aa(Me.values[Is]).color}else mn.fields.some(Ts=>Ts.config.custom?.gradientMode===rt.on.Scheme&&Ts.config.color?.mode===qn.Yb.Thresholds||Ts.config.mappings?.some(ba=>ba.type==="value"?Object.values(ba.options).some(Va=>Va.color!=null):ba.options.result.color!=null))&&(Zn=(mn.fields.find(Is=>Is.type===jt.PU.number).config.custom.fillOpacity??100)/100,is=(Is,ba)=>{let Va=mn.fields[Is];return Va.display(Va.values[ba]).color});const ps={xOri:Hn.xOri,xDir:Hn.xDir,groupWidth:Lt,barWidth:Nt,barRadius:Ht,stacking:Xt,rawValue:jn,getColor:is,fillOpacity:Zn,formatValue:ts,formatShortValue:Es,timeZone:tt,text:cn,showValue:bt,legend:Kn,xSpacing:Ln,xTimeAuto:mn.fields[0]?.type===jt.PU.time&&!mn.fields[0].config.unit?.startsWith("time:"),negY:mn.fields.map(aa=>aa.config.custom?.transform===rt.NU.NegativeY),fullHighlight:Rn,hoverMulti:Gt.mode===rt.$N.Multi},Fs=ao(ps,it);if(bn.setCursor(Fs.cursor),bn.addHook("init",Fs.init),bn.addHook("drawClear",Fs.drawClear),bn.addHook("draw",Fs.draw),pn!==0){let aa=50,Ts=Hn.xOri===rt.Lt.Horizontal?14:5;bn.setPadding(Yt(mn,pn,zn,aa,Ts))}bn.setPrepData(Fs.prepData),bn.addScale({scaleKey:"x",isTime:!1,range:Fs.xRange,distribution:rt.L4.Ordinal,orientation:Hn.xOri,direction:Hn.xDir});const la=mn.fields[0]?.config.custom?.axisPlacement!==rt.vM.Hidden?Hn.xOri===rt.Lt.Horizontal?rt.vM.Bottom:rt.vM.Left:rt.vM.Hidden,ia=mn.fields[0]?.config.custom?.axisPlacement!==rt.vM.Hidden;bn.addAxis({scaleKey:"x",isTime:!1,placement:la,label:mn.fields[0]?.config.custom?.axisLabel,splits:Fs.xSplits,filter:Hn.xOri===0?Fs.hFilter:void 0,values:Fs.xValues,timeZone:tt,grid:{show:!1},ticks:{show:!1},gap:15,tickLabelRotation:Hn.xOri===0?pn*-1:0,theme:it,show:ia});for(let aa=1;aa<mn.fields.length;aa++){const Ts=mn.fields[aa],Is={...fo,...Ts.config.custom},ba=Ts.config.unit||Ss.s,Va=(0,wa.Qi)(Ts),Rs=(0,wa.lz)(Ts,it).color;let ra=Is.axisSoftMin,Da=Is.axisSoftMax;if(ra==null&&Ts.config.min==null&&(ra=0),Da==null&&Ts.config.max==null&&(Da=0),Is.thresholdsStyle&&Ts.config.thresholds&&(Is.thresholdsStyle.mode??rt.Ly.Off)!==rt.Ly.Off&&bn.addThresholds({config:Is.thresholdsStyle,thresholds:Ts.config.thresholds,scaleKey:ba,theme:it,hardMin:Ts.config.min,hardMax:Ts.config.max,softMin:Is.axisSoftMin,softMax:Is.axisSoftMax}),bn.addSeries({scaleKey:ba,pxAlign:!0,lineWidth:Is.lineWidth,lineColor:Rs,fillOpacity:Is.fillOpacity,theme:it,colorMode:Va,pathBuilder:Fs.barsBuilder,show:!Is.hideFrom?.viz,gradientMode:Is.gradientMode,thresholds:Ts.config.thresholds,hardMin:Ts.config.min,hardMax:Ts.config.max,softMin:Is.axisSoftMin,softMax:Is.axisSoftMax}),bn.addScale({scaleKey:ba,min:Ts.config.min,max:Ts.config.max,softMin:ra,softMax:Da,centeredZero:Is.axisCenteredZero,orientation:Hn.yOri,direction:Hn.yDir,distribution:Is.scaleDistribution?.type,log:Is.scaleDistribution?.log}),Is.axisPlacement!==rt.vM.Hidden){let ga=Is.axisPlacement;(!ga||ga===rt.vM.Auto)&&(ga=rt.vM.Left),Hn.xOri===1&&(ga===rt.vM.Left&&(ga=rt.vM.Bottom),ga===rt.vM.Right&&(ga=rt.vM.Top));let Ia={scaleKey:ba,label:Is.axisLabel,size:Is.axisWidth,placement:ga,formatValue:(Ha,xa)=>(0,Gn.cN)(Ts.display(Ha,xa)),filter:Hn.yOri===0?Fs.hFilter:void 0,tickLabelRotation:Hn.xOri===1?pn*-1:0,theme:it,grid:{show:Is.axisGridShow}};Is.axisBorderShow&&(Ia.border={show:!0}),Is.axisColorMode===rt.Y$.Series&&(Ia.color=Rs),bn.addAxis(Ia)}}let Na=(0,pa.ro)(mn);return bn.setStackingGroups(Na),{builder:bn,prepData:(aa,Ts)=>(J=aa,mn=J[0],Me=Ts,bn.prepData(J))}};function Ut(J,pe){return J.length>pe?J.substring(0,pe).concat("..."):J}function Yt(J,pe,Me,Ue=0,ze=0){const tt=J.fields[0].values,it=Xn.pi,bt=J.fields[0].display,Lt=Gt=>bt?bt(tt[Gt]):tt[Gt];let Nt=0;for(let Gt=0;Gt<tt.length;Gt++){let pn=(0,ys.kD)(Ut((0,Gn.cN)(Lt(Gt)),Me),it);Nt=pn.width>Nt?pn.width:Nt}const Ht=pe>0?Math.cos(pe*Math.PI/180)*(0,ys.kD)(Ut((0,Gn.cN)(Lt(tt.length-1)),Me),it).width:0,Xt=pe<0?Math.cos(pe*-1*Math.PI/180)*(0,ys.kD)(Ut((0,Gn.cN)(Lt(0)),Me),it).width:0,cn=Math.sin((pe>=0?pe:pe*-1)*Math.PI/180)*Nt-ze;return[Math.round(Xn.pi*Wa.A.pxRatio),Ht,cn,Math.max(0,Xt-Ue)]}function Tn(J){return J===rt.wV.Vertical?{xOri:rt.Lt.Horizontal,xDir:rt.ON.Right,yOri:rt.Lt.Vertical,yDir:rt.ON.Up}:{xOri:rt.Lt.Vertical,xDir:rt.ON.Down,yOri:rt.Lt.Horizontal,yDir:rt.ON.Right}}const rn=(0,ys.kD)("M",Xn.pi).width,In=Math.PI/180,cs=J=>{const{data:pe,options:Me,fieldConfig:Ue,width:ze,height:tt,timeZone:it,id:bt}=J,Lt=(0,te.$j)(),{barWidth:Nt,barRadius:Ht=0,showValue:Xt,groupWidth:cn,stacking:Gt,legend:pn,tooltip:zn,text:Ln,xTickLabelRotation:Kn,xTickLabelSpacing:Rn,fullHighlight:mn,xField:bn,colorByField:Ns}=Me;let{orientation:ts,xTickLabelMaxLength:Es=0}=Me;ts=ts===Ot.wV.Auto?ze<tt?Ot.wV.Horizontal:Ot.wV.Vertical:ts,Es=Kn===0?1/0:Es||Math.floor(tt/2/Math.sin(Math.abs(Kn*In))/rn-3);const Hn=(0,V.useMemo)(()=>ko(pe.series,Ue,Gt,Lt,bn,Ns),[pe.series,Ue,Gt,Lt,bn,Ns]),jn=(0,V.useMemo)(()=>Hn.series.map(aa=>({...aa,fields:aa.fields.filter((Ts,Is)=>Is===0||!Ts.state?.hideFrom?.viz)})),[Hn.series]),is=jn[0]?.length??0,Zn=jn[0]?.fields.length??0,ps=Math.max(0,(Hn.series[0]?.fields.length??0)-1);let{builder:Fs,prepData:la}=(0,V.useMemo)(()=>is===0?{builder:null,prepData:null}:Go({series:jn,totalSeries:ps,color:Hn.color,orientation:ts,options:Me,timeZone:it,theme:Lt}),[ts,it,J.data.structureRev,ps,Zn,is,Nt,Ht,Xt,cn,Gt,pn,zn,Ln?.valueSize,Kn,Rn,mn,bn,Ns,Es]);const ia=(0,V.useMemo)(()=>la==null?[]:la(jn,Hn.color),[la,jn,Hn.color]);if(Hn.warn!=null||Fs==null)return(0,T.jsx)(fs.a,{panelId:bt,fieldConfig:Ue,data:pe,message:Hn.warn??"",needsNumberField:!0});const Na=pn.showLegend&&_a(Fs,Hn.series)?(0,T.jsx)(dr,{data:Hn.series,colorField:Hn.color,...pn}):null;return(0,T.jsx)(Ps.KU,{width:J.width,height:J.height,legend:Na,children:(aa,Ts)=>(0,T.jsx)(Zs.Z,{config:Fs,data:ia,width:aa,height:Ts,children:J.options.tooltip.mode!==rt.$N.None&&(0,T.jsx)(Ms.xl,{config:Fs,maxWidth:Me.tooltip.maxWidth,hoverMode:Me.tooltip.mode===rt.$N.Single?Ms.b3.xOne:Ms.b3.xAll,render:(Is,ba,Va,Vs,Rs,ra)=>(0,T.jsx)(ks.k,{series:jn[0],_rest:Hn._rest,dataIdxs:ba,seriesIdx:Va,mode:Me.tooltip.mode,sortOrder:Me.tooltip.sort,isPinned:Vs,maxHeight:Me.tooltip.maxHeight})})})})};var ds=e(66864),Gs=e(94354),js=e(10880);const Ca=[{label:"None",value:0,description:"Show all tick marks"},{label:"Small",value:100,description:"Require 100px spacing"},{label:"Medium",value:200,description:"Require 200px spacing"},{label:"Large",value:300,description:"Require 300px spacing"}],Aa=J=>{let pe=J.value??0;const Me=pe<0;Me&&(pe*=-1);let Ue=Ca[0];for(const it of Ca)if(Ue=it,pe<=Ue.value)break;const ze=it=>{J.onChange(it*(Me?-1:1))},tt=()=>{J.onChange(J.value*-1)};return(0,T.jsxs)(ds.Gy,{children:[(0,T.jsx)(Gs.z,{value:Ue.value,options:Ca,onChange:ze}),pe!==0&&(0,T.jsx)(et.m,{content:"Require space from the right side",placement:"top",children:(0,T.jsx)("div",{children:(0,T.jsx)(js.S,{value:Me,onChange:tt,label:"RTL"})})})]})},qs=(J,pe,Me,Ue)=>{if(pe==="graph"){const ze=Me.angular;if(ze.xaxis?.mode==="series"){const tt=J.transformations||[];tt.push({id:"reduce",options:{reducers:ze.xaxis?.values??["sum"]}}),J.transformations=tt}}return{}};var xs=e(38824);class Er{getListWithDefaults(pe){return pe.getListAppender({name:xs.m.BarChart,pluginId:"barchart",options:{showValue:rt.yL.Never,legend:{calcs:[],displayMode:rt.lm.List,showLegend:!0,placement:"right"}},fieldConfig:{defaults:{unit:"short",custom:{}},overrides:[]},cardOptions:{previewModifier:Me=>{Me.options.barWidth=.8}}})}getSuggestionsForData(pe){const Me=this.getListWithDefaults(pe),{dataSummary:Ue}=pe;Ue.frameCount===1&&(!Ue.hasNumberField||!Ue.hasStringField||Ue.rowCountTotal>50||(Me.append({name:xs.m.BarChart}),Ue.numberFieldCount>1&&(Me.append({name:xs.m.BarChartStacked,options:{stacking:rt.gs.Normal}}),Me.append({name:xs.m.BarChartStackedPercent,options:{stacking:rt.gs.Percent}})),Me.append({name:xs.m.BarChartHorizontal,options:{orientation:Ot.wV.Horizontal}}),Ue.numberFieldCount>1&&(Me.append({name:xs.m.BarChartHorizontalStacked,options:{stacking:rt.gs.Normal,orientation:Ot.wV.Horizontal}}),Me.append({name:xs.m.BarChartHorizontalStackedPercent,options:{orientation:Ot.wV.Horizontal,stacking:rt.gs.Percent}}))))}}const fr=new b.m(cs).setPanelChangeHandler(qs).useFieldConfig({standardOptions:{[wn.uo.Color]:{settings:{byValueSupport:!0,preferThresholdsMode:!1},defaultValue:{mode:On.Y.PaletteClassic}}},useCustomConfig:J=>{const pe=fo;J.addSliderInput({path:"lineWidth",name:"Line width",defaultValue:pe.lineWidth,settings:{min:0,max:10,step:1}}).addSliderInput({path:"fillOpacity",name:"Fill opacity",defaultValue:pe.fillOpacity,settings:{min:0,max:100,step:1}}).addRadio({path:"gradientMode",name:"Gradient mode",defaultValue:tn.t.fillGradient[0].value,settings:{options:tn.t.fillGradient}}),J.addSelect({category:["Graph styles"],name:"Transform",path:"transform",settings:{options:[{label:"Constant",value:rt.NU.Constant,description:"The first value will be shown as a constant line"},{label:"Negative Y",value:rt.NU.NegativeY,description:"Flip the results to negative values on the y axis"}],isClearable:!0},hideFromDefaults:!0}),J.addCustomEditor({id:"thresholdsStyle",path:"thresholdsStyle",name:"Show thresholds",category:["Thresholds"],defaultValue:{mode:rt.Ly.Off},settings:{options:tn.t.thresholdsDisplayModes},editor:Ls.D,override:Ls.D,process:Rt.hS,shouldApply:()=>!0}),Mn.r(J,pe,!1),kn.e(J)}}).setPanelOptions(J=>{J.addFieldNamePicker({path:"xField",name:"X Axis",settings:{placeholderText:"First string or time field"}}).addRadio({path:"orientation",name:"Orientation",settings:{options:[{value:Ot.wV.Auto,label:"Auto"},{value:Ot.wV.Horizontal,label:"Horizontal"},{value:Ot.wV.Vertical,label:"Vertical"}]},defaultValue:Fa.orientation}).addSliderInput({path:"xTickLabelRotation",name:"Rotate x-axis tick labels",defaultValue:Fa.xTickLabelRotation,settings:{min:-90,max:90,step:15,marks:{"-90":"-90\xB0","-45":"-45\xB0",0:"0\xB0",45:"45\xB0",90:"90\xB0"},included:!1}}).addNumberInput({path:"xTickLabelMaxLength",name:"X-axis tick label max length",description:"X-axis labels will be truncated to the length provided",settings:{placeholder:"None",min:0},showIf:pe=>pe.xTickLabelRotation!==0}).addCustomEditor({id:"xTickLabelSpacing",path:"xTickLabelSpacing",name:"X-axis labels minimum spacing",defaultValue:Fa.xTickLabelSpacing,editor:Aa}).addRadio({path:"showValue",name:"Show values",settings:{options:[{value:rt.yL.Auto,label:"Auto"},{value:rt.yL.Always,label:"Always"},{value:rt.yL.Never,label:"Never"}]},defaultValue:Fa.showValue}).addRadio({path:"stacking",name:"Stacking",settings:{options:tn.t.stacking},defaultValue:Fa.stacking}).addSliderInput({path:"groupWidth",name:"Group width",defaultValue:Fa.groupWidth,settings:{min:0,max:1,step:.01},showIf:(pe,Me)=>pe.stacking&&pe.stacking!==rt.gs.None?!1:gr(Me)!==1}).addSliderInput({path:"barWidth",name:"Bar width",defaultValue:Fa.barWidth,settings:{min:0,max:1,step:.01}}).addSliderInput({path:"barRadius",name:"Bar radius",defaultValue:Fa.barRadius,settings:{min:0,max:.5,step:.05}}).addBooleanSwitch({path:"fullHighlight",name:"Highlight full area on hover",defaultValue:Fa.fullHighlight,showIf:pe=>pe.stacking===rt.gs.None}),J.addFieldNamePicker({path:"colorByField",name:"Color by field",description:"Use the color value for a sibling field to color each bar value."}),Yn.D(J),Wn.H(J),Jn.I(J,!1)}).setSuggestionsSupplier(new Er);function gr(J){let pe=0;if(J)for(const Me of J)for(const Ue of Me.fields)Ue.type===jt.PU.number&&pe++;return pe}var Rr=e(63250),Dr=e(23799);const Mo=J=>(0,Rr._$)(J);var So=e(58384),Ka=e(17516);class Sa{getSuggestionsForData(pe){const{dataSummary:Me}=pe;if(!Me.hasData||!Me.hasNumberField)return;const Ue=pe.getListAppender({name:"",pluginId:"bargauge",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]}});Me.numberFieldCount>50||(Me.hasStringField&&Me.frameCount===1&&Me.rowCountTotal<30?(Ue.append({name:xs.m.BarGaugeBasic,options:{reduceOptions:{values:!0,calcs:[]},displayMode:rt.eX.Basic,orientation:Ot.wV.Horizontal},fieldConfig:{defaults:{color:{mode:"continuous-GrYlRd"}},overrides:[]}}),Ue.append({name:xs.m.BarGaugeLCD,options:{reduceOptions:{values:!0,calcs:[]},displayMode:rt.eX.Lcd,orientation:Ot.wV.Horizontal},fieldConfig:{defaults:{color:{mode:"continuous-GrYlRd"}},overrides:[]}})):(Ue.append({name:xs.m.BarGaugeBasic,options:{displayMode:rt.eX.Basic,orientation:Ot.wV.Horizontal,reduceOptions:{values:!1,calcs:["lastNotNull"]}},fieldConfig:{defaults:{color:{mode:"continuous-GrYlRd"}},overrides:[]}}),Ue.append({name:xs.m.BarGaugeLCD,options:{displayMode:rt.eX.Lcd,orientation:Ot.wV.Horizontal,reduceOptions:{values:!1,calcs:["lastNotNull"]}},fieldConfig:{defaults:{color:{mode:"continuous-GrYlRd"}},overrides:[]}})))}}const Za=new b.m(So.d).useFieldConfig().setPanelOptions(J=>{(0,Dr.L)(J),(0,Dr.h)(J),Jn.I(J),J.addRadio({path:"displayMode",name:"Display mode",settings:{options:[{value:rt.eX.Gradient,label:"Gradient"},{value:rt.eX.Lcd,label:"Retro LCD"},{value:rt.eX.Basic,label:"Basic"}]},defaultValue:Ka.K.displayMode}).addRadio({path:"valueMode",name:"Value display",settings:{options:[{value:rt.$l.Color,label:"Value color"},{value:rt.$l.Text,label:"Text color"},{value:rt.$l.Hidden,label:"Hidden"}]},defaultValue:Ka.K.valueMode}).addRadio({path:"namePlacement",name:"Name placement",settings:{options:[{value:rt.TZ.Auto,label:"Auto"},{value:rt.TZ.Top,label:"Top"},{value:rt.TZ.Left,label:"Left"}]},defaultValue:Ka.K.namePlacement,showIf:pe=>pe.orientation!==Ot.wV.Vertical}).addBooleanSwitch({path:"showUnfilled",name:"Show unfilled area",description:"When enabled renders the unfilled region as gray",defaultValue:Ka.K.showUnfilled,showIf:pe=>pe.displayMode!=="lcd"}).addRadio({path:"sizing",name:"Bar size",settings:{options:[{value:rt.T6.Auto,label:"Auto"},{value:rt.T6.Manual,label:"Manual"}]},defaultValue:Ka.K.sizing}).addSliderInput({path:"minVizWidth",name:"Min width",description:"Minimum column width (vertical orientation)",defaultValue:Ka.K.minVizWidth,settings:{min:0,max:300,step:1},showIf:pe=>pe.sizing===rt.T6.Manual&&(pe.orientation===Ot.wV.Auto||pe.orientation===Ot.wV.Vertical)}).addSliderInput({path:"minVizHeight",name:"Min height",description:"Minimum row height (horizontal orientation)",defaultValue:Ka.K.minVizHeight,settings:{min:0,max:300,step:1},showIf:pe=>pe.sizing===rt.T6.Manual&&(pe.orientation===Ot.wV.Auto||pe.orientation===Ot.wV.Horizontal)}).addSliderInput({path:"maxVizHeight",name:"Max height",description:"Maximum row height (horizontal orientation)",defaultValue:Ka.K.maxVizHeight,settings:{min:0,max:300,step:1},showIf:pe=>pe.sizing===rt.T6.Manual&&(pe.orientation===Ot.wV.Auto||pe.orientation===Ot.wV.Horizontal)})}).setPanelChangeHandler(Rr.gl).setMigrationHandler(Mo).setSuggestionsSupplier(new Sa);var ur=e(41706),da=e(79041),ro=e(23117),Uo=e(68268),No=e(24182),wo=e(30249),Di=e(74863),ii=e(55129);const Wo=new Set(["bytes","bits","kbytes","mbytes","gbytes","tbytes","pbytes","binBps","binbps","KiBs","Kibits","MiBs","Mibits","GiBs","Gibits","TiBs","Tibits","PiBs","Pibits"]),li=Array(53);for(let J=0;J<li.length;J++)li[J]=2**J;const nl=(J,pe=1)=>J==null?"-":J.toFixed(pe),Mr={drawStyle:rt.GR.Line,showPoints:rt.yL.Auto,axisPlacement:rt.vM.Auto},Fi=({frame:J,theme:pe,timeZones:Me,getTimeRange:Ue,allFrames:ze,renderers:tt,tweakScale:it=Ht=>Ht,tweakAxis:bt=Ht=>Ht,hoverProximity:Lt,orientation:Nt=rt.wV.Horizontal})=>{const Ht=Nt!==rt.wV.Vertical,Xt=new es.e(Me[0]);let cn;Xt.setPrepData(Hn=>(cn=Hn[0],(0,pa.bq)(Hn[0],Xt.getStackingGroups())));const Gt=J.fields[0];if(!Gt)return Xt;const pn="x";let zn="";const Ln=Gt.config.custom?.axisPlacement===rt.vM.Hidden?rt.vM.Hidden:Ht?rt.vM.Bottom:rt.vM.Left,Kn=Gt.config.custom?.axisPlacement!==rt.vM.Hidden;if(Gt.type===jt.PU.time){Xt.addScale({scaleKey:pn,orientation:Ht?rt.Lt.Horizontal:rt.Lt.Vertical,direction:Ht?rt.ON.Right:rt.ON.Up,isTime:!0,range:()=>{const jn=Ue();return[jn.from.valueOf(),jn.to.valueOf()]}});const Hn=Me.length>1?(jn,is)=>Ht?is.map((Zn,ps)=>ps<2?null:Zn):is:void 0;for(let jn=0;jn<Me.length;jn++){const is=Me[jn];Xt.addAxis({scaleKey:pn,isTime:!0,placement:Ln,show:Kn,label:Gt.config.custom?.axisLabel,timeZone:is,theme:pe,grid:{show:jn===0&&Gt.config.custom?.axisGridShow},filter:Hn})}Me.length>1&&Xt.addHook("drawAxes",jn=>{jn.ctx.save();let is=0;jn.axes.forEach(Zn=>{if(Ht&&Zn.side===2){jn.ctx.fillStyle=pe.colors.text.primary,jn.ctx.textAlign="left",jn.ctx.textBaseline="bottom";let ps=Zn._pos+Zn._size;jn.ctx.fillText(Me[is],jn.bbox.left,ps*Wa.A.pxRatio),is++}}),jn.ctx.restore()})}else Xt.addScale({scaleKey:pn,orientation:Ht?rt.Lt.Horizontal:rt.Lt.Vertical,direction:Ht?rt.ON.Right:rt.ON.Up,range:(Hn,jn,is)=>[Gt.config.min??jn,Gt.config.max??is]}),Xt.addAxis({scaleKey:pn,placement:Ln,show:Kn,label:Gt.config.custom?.axisLabel,theme:pe,grid:{show:Gt.config.custom?.axisGridShow},formatValue:(Hn,jn)=>(0,Gn.cN)(Gt.display(Hn,jn))});let Rn=tt?.flatMap(Hn=>Object.values(Hn.fieldMap).filter(jn=>Hn.indicesOnly.indexOf(jn)===-1))??[],mn;for(let Hn=1;Hn<J.fields.length;Hn++){const jn=J.fields[Hn],is={...jn.config,custom:{...Mr,...jn.config.custom}},Zn=is.custom;if(jn===Gt||jn.type!==jt.PU.number&&jn.type!==jt.PU.enum)continue;let ps=jn.display??nl;jn.config.custom?.stacking?.mode===rt.gs.Percent&&(ps=(0,Qn.J)({field:{...jn,config:{...jn.config,unit:"percentunit"}},theme:pe}));const Fs=(0,ii.M)(is,jn.type),la=(0,wa.Qi)(jn),Na=(0,wa.lz)(jn,pe).color;if(Xt.addScale(it({scaleKey:Fs,orientation:Ht?rt.Lt.Vertical:rt.Lt.Horizontal,direction:Ht?rt.ON.Up:rt.ON.Right,distribution:Zn.scaleDistribution?.type,log:Zn.scaleDistribution?.log,linearThreshold:Zn.scaleDistribution?.linearThreshold,min:jn.config.min,max:jn.config.max,softMin:Zn.axisSoftMin,softMax:Zn.axisSoftMax,centeredZero:Zn.axisCenteredZero,range:Zn.stacking?.mode===rt.gs.Percent?(Rs,ra,Da)=>(ra=ra<0?-1:0,Da=Da>0?1:0,[ra,Da]):jn.type===jt.PU.enum?(Rs,ra,Da)=>[-1,jn.config.type.enum.text.length]:void 0,decimals:jn.config.decimals},jn)),zn||(zn=Fs),Zn.axisPlacement!==rt.vM.Hidden){let Rs;Zn.axisColorMode===rt.Y$.Series&&(la.isByValue&&jn.config.custom?.gradientMode===rt.on.Scheme&&la.id===On.Y.Thresholds?Rs=(0,Di.pl)(1,pe,la,jn.config.thresholds):Rs=Na);const ra={border:{show:Zn.axisBorderShow||!1,width:1/devicePixelRatio,stroke:Rs||pe.colors.text.primary},ticks:{show:Zn.axisBorderShow||!1,stroke:Rs||pe.colors.text.primary},color:Rs||pe.colors.text.primary};let Da,ga,Ia;if(Wo.has(is.unit))Da=li;else if(jn.type===jt.PU.enum){let Ha=jn.config.type.enum.text;Ia=Ha.map((xa,Qa)=>Qa),ga=Ha}Xt.addAxis(bt({scaleKey:Fs,label:Zn.axisLabel,size:Zn.axisWidth,placement:Ht?Zn.axisPlacement??rt.vM.Auto:rt.vM.Bottom,formatValue:(Ha,xa)=>(0,Gn.cN)(ps(Ha,xa)),theme:pe,grid:{show:Zn.axisGridShow},decimals:jn.config.decimals,distr:Zn.scaleDistribution?.type,splits:Ia,values:ga,incrs:Da,...ra},jn))}const aa=Zn.drawStyle===rt.GR.Points?rt.yL.Always:Zn.showPoints;let Ts=()=>null;Zn.spanNulls!==!0&&(Ts=(Rs,ra,Da,ga)=>{let Ia=[],Ha=Rs.series[ra];if(!Da&&ga&&ga.length){const[xa,Qa]=Ha.idxs,Ya=Rs.data[0],cr=Rs.data[ra],ms=Math.round(Rs.valToPos(Ya[xa],"x",!0)),Vn=Math.round(Rs.valToPos(Ya[Qa],"x",!0));ga[0][0]===ms&&Ia.push(xa);for(let ls=0;ls<ga.length;ls++){let sa=ga[ls],Qs=ga[ls+1];if(Qs&&sa[1]===Qs[0]){let ca=Rs.posToIdx(sa[1],!0);if(cr[ca]==null)for(let Oa=1;Oa<100;Oa++){if(cr[ca+Oa]!=null){ca+=Oa;break}if(cr[ca-Oa]!=null){ca-=Oa;break}}Ia.push(ca)}}ga[ga.length-1][1]===Vn&&Ia.push(Qa)}return Ia.length?Ia:null});let{fillOpacity:Is}=Zn,ba=null,Va=null;if(jn.state?.origin){mn||(mn=Pi(J,ze));const Rs=ze[jn.state.origin.frameIndex],ra=Rs?.fields[jn.state.origin.fieldIndex],Da=(0,en.Ct)(ra??jn,Rs,ze);if(Rn.indexOf(Da)>=0)ba=()=>null,Va=()=>{};else if(Zn.transform===rt.NU.Constant){const ga=Wa.A.paths.linear();ba=(Ia,Ha)=>{const xa=Ia._data,Qa=Ue();let Ya=[Qa.from.valueOf(),Qa.to.valueOf()],cr=xa[Ha].find(ls=>ls!=null),ms=[cr,cr],Vn=xa.slice();return Vn[0]=Ya,Vn[Ha]=ms,ga({...Ia,_data:Vn},Ha,0,1)}}if(Zn.fillBelowTo){const ga=J.fields.find(Qa=>Zn.fillBelowTo===Qa.name||Zn.fillBelowTo===Qa.config?.displayNameFromDS||Zn.fillBelowTo===(0,en.Ct)(Qa,J,ze)),Ia=ga?(0,en.Ct)(ga,J,ze):Zn.fillBelowTo,Ha=mn.get(Da),xa=mn.get(Ia);(0,N.isNumber)(xa)&&(0,N.isNumber)(Ha)?(Xt.addBand({series:[Ha,xa],fill:void 0}),Is||(Is=35)):Is=0}}let Vs;la.id===On.Y.Thresholds&&(Vs=Rs=>(0,wa.lz)(cn.fields[Rs],pe).color),Xt.addSeries({pathBuilder:ba,pointsBuilder:Va,scaleKey:Fs,showPoints:aa,pointsFilter:Ts,colorMode:la,fillOpacity:Is,theme:pe,dynamicSeriesColor:Vs,drawStyle:Zn.drawStyle,lineColor:Zn.lineColor??Na,lineWidth:Zn.lineWidth,lineInterpolation:Zn.lineInterpolation,lineStyle:Zn.lineStyle,barAlignment:Zn.barAlignment,barWidthFactor:Zn.barWidthFactor,barMaxWidth:Zn.barMaxWidth,pointSize:Zn.pointSize,spanNulls:Zn.spanNulls||!1,show:!Zn.hideFrom?.viz,gradientMode:Zn.gradientMode,thresholds:is.thresholds,hardMin:jn.config.min,hardMax:jn.config.max,softMin:Zn.axisSoftMin,softMax:Zn.axisSoftMax,dataFrameFieldIndex:jn.state?.origin}),Zn.thresholdsStyle&&is.thresholds&&(Zn.thresholdsStyle.mode??rt.Ly.Off)!==rt.Ly.Off&&Xt.addThresholds({config:Zn.thresholdsStyle,thresholds:is.thresholds,scaleKey:Fs,theme:pe,hardMin:jn.config.min,hardMax:jn.config.max,softMin:Zn.axisSoftMin,softMax:Zn.axisSoftMax})}let bn=(0,pa.ro)(J);Xt.setStackingGroups(bn),tt?.forEach(Hn=>{mn||(mn=Pi(J,ze));let jn={};for(let is in Hn.fieldMap){let Zn=Hn.fieldMap[is];jn[is]=mn.get(Zn)}Hn.init(Xt,jn)});const Ns=15;let Es={hover:{prox:(Hn,jn,is)=>Lt??(Hn.data[jn][is]===null?Ns:null),skip:[null]},focus:{prox:Lt??30}};return Xt.setCursor(Es),Xt};function Pi(J,pe){const Me=new Map;return J.fields.forEach((Ue,ze)=>{const tt=Ue.state?.origin;if(tt){const it=pe[tt.frameIndex]?.fields[tt.fieldIndex];it&&Me.set((0,en.Ct)(it,pe[tt.frameIndex],pe),ze)}}),Me}const mr=["legend","options","theme"];class ci extends V.Component{constructor(){super(...arguments),this.prepConfig=(pe,Me,Ue)=>{const{theme:ze,timeZone:tt,options:it,renderers:bt,tweakAxis:Lt,tweakScale:Nt}=this.props;return Fi({frame:pe,theme:ze,timeZones:Array.isArray(tt)?tt:[tt],getTimeRange:Ue,allFrames:Me,renderers:bt,tweakScale:Nt,tweakAxis:Lt,hoverProximity:it?.tooltip?.hoverProximity,orientation:it?.orientation})},this.renderLegend=pe=>{const{legend:Me,frames:Ue}=this.props;return!pe||Me&&!Me.showLegend||!(0,No.t)(pe,Ue)?null:(0,T.jsx)(No.$,{data:Ue,config:pe,...Me})}}render(){return(0,T.jsx)(wo.o,{...this.props,prepConfig:this.prepConfig,propsToDiff:mr,renderLegend:this.renderLegend})}}const Qo=(0,te.cV)(ci);Qo.displayName="TimeSeries";var Vr=e(62567),Ki=e(78226),$i=e(34743),vo=e(36376),oo=e(7315),sr=e(13544),di=e(17464),sl=e(74007),Vi=e(25469);function al(J){const pe={position:"relative",top:"auto",right:"auto",marginRight:0};return(0,T.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"flex-end",paddingBottom:"6px"},children:(0,T.jsx)(Vi.J,{onClick:J.onClick,style:J.style??pe})})}const _i=({timeZone:J,dataFrame:pe,dataFrameFieldIndex:Me,config:Ue,exemplarColor:ze,clickedExemplarFieldIndex:tt,setClickedExemplarFieldIndex:it})=>{const bt=(0,te.of)(rl),[Lt,Nt]=(0,V.useState)(!1),[Ht,Xt]=(0,V.useState)(!1),cn=[(0,$i.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,$i.BN)()],{context:Gt,refs:pn,floatingStyles:zn}=(0,vo.we)({open:Lt,placement:"bottom",onOpenChange:Nt,middleware:cn,whileElementsMounted:oo.ll,strategy:"fixed"}),Ln=(0,vo.s9)(Gt),Kn=(0,vo.Mk)(Gt,{handleClose:(0,vo.iB)(),enabled:tt===void 0}),{getReferenceProps:Rn,getFloatingProps:mn}=(0,vo.bv)([Ln,Kn]);(0,V.useEffect)(()=>{tt?.fieldIndex===Me.fieldIndex&&tt?.frameIndex===Me.frameIndex||Xt(!1)},[tt,Me]);const bn=()=>{const jn=[(0,T.jsx)("rect",{fill:ze,x:"3.38672",width:"4.78985",height:"4.78985",transform:"rotate(45 3.38672 0)"},"diamond"),(0,T.jsx)("path",{fill:ze,d:"M1.94444 3.49988L0 5.44432L1.55552 6.99984L3.49996 5.05539L5.4444 6.99983L6.99992 5.44431L5.05548 3.49988L6.99983 1.55552L5.44431 0L3.49996 1.94436L1.5556 0L8.42584e-05 1.55552L1.94444 3.49988Z"},"x"),(0,T.jsx)("path",{fill:ze,d:"M4 0L7.4641 6H0.535898L4 0Z"},"triangle"),(0,T.jsx)("rect",{fill:ze,width:"5",height:"5"},"rectangle"),(0,T.jsx)("path",{fill:ze,d:"M3 0.5L5.85317 2.57295L4.76336 5.92705H1.23664L0.146831 2.57295L3 0.5Z"},"pentagon"),(0,T.jsx)("path",{fill:ze,d:"m2.35672,4.2425l0,2.357l1.88558,0l0,-2.357l2.3572,0l0,-1.88558l-2.3572,0l0,-2.35692l-1.88558,0l0,2.35692l-2.35672,0l0,1.88558l2.35672,0z"},"plus")];return jn[Me.frameIndex%jn.length]},Ns=()=>{Xt(!0)},ts=(0,V.useCallback)(()=>{const jn=pe.fields.filter(ia=>ia.config.links?.length&&ia.config.links?.length>0)||[],is=[...jn,...pe.fields.filter(ia=>!jn.includes(ia))],Zn=()=>{Xt(!1),Nt(!1),it(void 0)};let ps=[],Fs=[];is.map((ia,Na)=>{const aa=ia.values[Me.fieldIndex];ia.config.links?.length&&Fs?.push(...ia.getLinks?.({valueRowIndex:Me.fieldIndex})||[]);const Ts=ia.display?ia.display(aa):{text:`${aa}`,numeric:+aa};ps.push({name:ia.name,value:aa,valueString:(0,Gn.cN)(Ts),highlight:!1})});const la={position:"relative",top:"35px",right:"5px",marginRight:0};return(0,T.jsxs)("div",{className:bt.tooltip,ref:pn.setFloating,style:zn,...mn(),children:[Ht&&(0,T.jsx)(al,{onClick:Zn,style:la}),(0,T.jsx)(sl.i,{displayValues:ps,links:Fs})]})},[pe.fields,Me,bt,Ht,it,zn,mn,pn.setFloating]),Es=Ue.getSeries().find(jn=>jn.props.dataFrameFieldIndex?.frameIndex===Me.frameIndex)?.props.lineColor,Hn=()=>{it(Me),Ns()};return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("div",{ref:pn.setReference,className:bt.markerWrapper,"data-testid":sr.Tp.components.DataSource.Prometheus.exemplarMarker,role:"button",tabIndex:0,...Rn(),onClick:Hn,onKeyDown:jn=>{jn.key==="Enter"&&Hn()},children:(0,T.jsx)("svg",{viewBox:"0 0 7 7",width:"7",height:"7",style:{fill:Es},className:(0,q.cx)(bt.marble,(Lt||Ht)&&bt.activeMarble),children:bn()})}),(Lt||Ht)&&(0,T.jsx)(di.ZL,{children:ts()})]})},rl=J=>{const pe=J.isDark?J.v1.palette.dark2:J.v1.palette.white,Me=J.isDark?J.v1.palette.dark9:J.v1.palette.gray5,Ue=J.isDark?J.v1.palette.black:J.v1.palette.white,ze=J.isDark?J.v1.palette.dark3:J.v1.palette.gray6;return{markerWrapper:(0,q.css)({padding:"0 4px 4px 4px",width:"8px",height:"8px",boxSizing:"content-box",transform:"translate3d(-50%, 0, 0)","&:hover":{"> svg":{transform:"scale(1.3)",opacity:1,filter:"drop-shadow(0 0 8px rgba(0, 0, 0, 0.5))"}}}),marker:(0,q.css)({width:0,height:0,borderLeft:"4px solid transparent",borderRight:"4px solid transparent",borderBottom:`4px solid ${J.v1.palette.red}`,pointerEvents:"none"}),wrapper:(0,q.css)({background:pe,border:`1px solid ${Me}`,borderRadius:J.shape.borderRadius(2),boxShadow:`0 0 20px ${Ue}`,padding:J.spacing(1)}),exemplarsTable:(0,q.css)({width:"100%","tr td":{padding:"5px 10px",whiteSpace:"nowrap",borderBottom:`4px solid ${J.components.panel.background}`},tr:{backgroundColor:J.colors.background.primary,"&:nth-child(even)":{backgroundColor:ze}}}),valueWrapper:(0,q.css)({display:"flex",flexDirection:"row",flexWrap:"wrap",columnGap:J.spacing(1),"> span":{flexGrow:0},"> *":{flex:"1 1",alignSelf:"center"}}),tooltip:(0,q.css)({background:"none",padding:0,overflowY:"auto",maxHeight:"95vh"}),header:(0,q.css)({background:Me,padding:"6px 10px",display:"flex"}),title:(0,q.css)({fontWeight:J.typography.fontWeightMedium,paddingRight:J.spacing(2),overflow:"hidden",display:"inline-block",whiteSpace:"nowrap",textOverflow:"ellipsis",flexGrow:1}),body:(0,q.css)({fontWeight:J.typography.fontWeightMedium,borderRadius:J.shape.borderRadius(2),overflow:"hidden"}),marble:(0,q.css)({display:"block",opacity:.5,[J.transitions.handleMotion("no-preference")]:{transition:"transform 0.15s ease-out"}}),activeMarble:(0,q.css)({transform:"scale(1.3)",opacity:1,filter:"drop-shadow(0 0 8px rgba(0, 0, 0, 0.5))"})}},zi=({exemplars:J,timeZone:pe,config:Me,visibleSeries:Ue})=>{const ze=(0,V.useRef)(),[tt,it]=(0,V.useState)();(0,V.useLayoutEffect)(()=>{Me.addHook("init",Nt=>{ze.current=Nt})},[Me]);const bt=(0,V.useCallback)((Nt,Ht)=>{const Xt=Nt.fields.find(Kn=>Kn.name===jt.LE),cn=Nt.fields.find(Kn=>Kn.name===jt.Bc);if(!Xt||!cn||!ze.current)return;const Gt=Object.keys(ze.current.scales).find(Kn=>!["x","y"].some(Rn=>Rn===Kn))??Ss.s,pn=ze.current.scales[Gt].min,zn=ze.current.scales[Gt].max;let Ln=cn.values[Ht.fieldIndex];return pn!=null&&Ln<pn&&(Ln=pn),zn!=null&&Ln>zn&&(Ln=zn),{x:ze.current.valToPos(Xt.values[Ht.fieldIndex],"x"),y:ze.current.valToPos(Ln,Gt)}},[]),Lt=(0,V.useCallback)((Nt,Ht)=>{const Xt=Ue!==void 0?ki(Ue,Nt,Ht):!0,cn=Ue!==void 0?Hi(Nt,Ht,Ue):void 0;return Xt?(0,T.jsx)(_i,{setClickedExemplarFieldIndex:it,clickedExemplarFieldIndex:tt,timeZone:pe,dataFrame:Nt,dataFrameFieldIndex:Ht,config:Me,exemplarColor:cn}):(0,T.jsx)(T.Fragment,{})},[Me,pe,Ue,it,tt]);return(0,T.jsx)(Ki.a,{config:Me,id:"exemplars",events:J,renderEventMarker:Lt,mapEventToXYCoords:bt})},ol=(J,pe)=>{const Me=J.series.filter(ze=>ze.props.show),Ue=[];return pe?.length&&Me.forEach(ze=>{const tt=ze.props?.dataFrameFieldIndex?.frameIndex,it=ze.props?.dataFrameFieldIndex?.fieldIndex;if(tt!==void 0&&it!==void 0){const bt=pe[tt]?.fields[it];bt?.labels&&Ue.push({labels:bt.labels,color:ze.props?.lineColor??""})}}),{labels:Ue,totalSeriesCount:J.series.length}},Hi=(J,pe,Me)=>{let Ue;return Me.labels.some(ze=>{const tt=Object.keys(ze.labels),it=J.fields.filter(bt=>tt.find(Lt=>Lt===bt.name));return it.length&&it.every((Lt,Nt,Ht)=>{const Xt=Lt.values[pe.fieldIndex];return ze.labels[Lt.name]===Xt})?(Ue=ze.color,!0):!1}),Ue},ki=(J,pe,Me)=>{let Ue=!1;return J.labels.length===J.totalSeriesCount?Ue=!0:J.labels.some(ze=>{const tt=Object.keys(ze.labels);if(Object.keys(ze.labels).length===0)Ue=!0;else{const it=pe.fields.filter(bt=>tt.find(Lt=>Lt===bt.name));it.length&&(Ue=J.labels.some(bt=>Object.keys(bt.labels).every(Lt=>{const Nt=bt.labels[Lt];return it.find(Ht=>Ht.values[Me.fieldIndex]===Nt)})))}return Ue}),Ue};var Fo=e(7874),Ko=e(55794),yo=e.n(Ko);const Oo=({step:J,y:pe,dragBounds:Me,mapPositionToValue:Ue,formatValue:ze,onChange:tt})=>{const it=(0,te.$j)();let bt=pe,Lt="none";pe<(Me.top??0)&&(Lt="top"),pe>(Me.bottom??0)+22&&(Lt="bottom"),Lt==="bottom"&&(bt=Me.bottom??pe),Lt==="top"&&(bt=Me.top??pe);const Nt=typeof tt!="function",Ht=(0,te.of)(il,J,Lt,Nt),[Xt,cn]=(0,V.useState)(J.value),Gt=(0,V.useMemo)(()=>it.colors.getContrastText(it.visualization.getColorByName(J.color)),[J.color,it]);return(0,T.jsx)(yo(),{axis:"y",grid:[1,1],disabled:Nt,onStop:Nt?N.noop:(pn,zn)=>(tt(Ue(zn.lastY)),!1),onDrag:(pn,zn)=>cn(Ue(zn.lastY)),position:{x:0,y:bt},bounds:Me,children:(0,T.jsx)("div",{className:Ht.handle,style:{color:Gt},children:(0,T.jsx)("span",{className:Ht.handleText,children:ze(Xt)})})})};Oo.displayName="ThresholdDragHandle";const il=(J,pe,Me,Ue)=>{const ze=J.visualization.getColorByName(pe.color),tt=bi(Me),it=Me!=="none";return{handle:(0,q.css)`
      display: flex;
      align-items: center;
      position: absolute;
      left: 0;
      width: calc(100% - 9px);
      height: 18px;
      margin-top: -9px;
      border-color: ${ze};
      cursor: ${Ue?"initial":"grab"};
      border-top-right-radius: ${J.shape.radius.default};
      border-bottom-right-radius: ${J.shape.radius.default};
      ${it&&(0,q.css)`
        margin-top: 0;
        border-radius: ${J.shape.radius.default};
      `}
      background: ${ze};
      font-size: ${J.typography.bodySmall.fontSize};
      &:before {
        ${tt};
      }
    `,handleText:(0,q.css)`
      text-align: center;
      width: 100%;
      display: block;
      text-overflow: ellipsis;
      white-space: nowrap;
      overflow: hidden;
    `}};function bi(J){const pe=J==="none",Me=Ue=>(0,q.css)`
    content: '';
    position: absolute;

    bottom: 0;
    top: 0;
    width: 0;
    height: 0;
    left: 0;

    border-right-style: solid;
    border-right-width: ${Ue}px;
    border-right-color: inherit;
    border-top: ${Ue}px solid transparent;
    border-bottom: ${Ue}px solid transparent;
  `;return pe?(0,q.css)`
      ${Me(9)};
      left: -9px;
    `:J==="top"?(0,q.css)`
      ${Me(5)};
      left: calc(50% - 2.5px);
      top: -7px;
      transform: rotate(90deg);
    `:J==="bottom"?(0,q.css)`
      ${Me(5)};
      left: calc(50% - 2.5px);
      top: calc(100% - 2.5px);
      transform: rotate(-90deg);
    `:""}const go=60,$o=({config:J,fieldConfig:pe,onThresholdsChange:Me})=>{const Ue=(0,V.useRef)(),[ze,tt]=(0,V.useState)(0);(0,V.useLayoutEffect)(()=>{J.setPadding([0,go,0,0]),J.addHook("init",bt=>{Ue.current=bt}),J.addHook("draw",()=>{tt(bt=>bt+1)})},[J]);const it=(0,V.useMemo)(()=>{const bt=Ue.current;if(!bt)return null;const Lt=pe.defaults.thresholds;if(!Lt)return null;const Nt=(0,ii.M)(pe.defaults,jt.PU.number),Ht=pe.defaults.decimals,Xt=[];for(let cn=0;cn<Lt.steps.length;cn++){const Gt=Lt.steps[cn],pn=bt.valToPos(Gt.value,Nt);if(Number.isNaN(pn)||!Number.isFinite(pn))continue;const zn=bt.bbox.height/window.devicePixelRatio,Kn=typeof Me=="function"?mn=>{const bn=[...Lt.steps.slice(0,cn),...Lt.steps.slice(cn+1),{...Lt.steps[cn],value:mn}].sort((Ns,ts)=>Ns.value-ts.value);Me({...Lt,steps:bn})}:void 0,Rn=(0,T.jsx)(Oo,{step:Gt,y:pn,dragBounds:{top:0,bottom:zn},mapPositionToValue:mn=>bt.posToVal(mn,Nt),formatValue:mn=>(0,Gn.j_)(Nt)(mn,Ht).text,onChange:Kn},`${Gt.value}-${cn}`);Xt.push(Rn)}return Xt},[ze,pe,Me]);return Ue.current?(0,T.jsx)("div",{style:{position:"absolute",overflow:"visible",left:`${(Ue.current.bbox.left+Ue.current.bbox.width)/window.devicePixelRatio}px`,top:`${Ue.current.bbox.top/window.devicePixelRatio}px`,width:`${go}px`,height:`${Ue.current.bbox.height/window.devicePixelRatio}px`},children:it}):null};$o.displayName="ThresholdControlsPlugin";var Yo=e(63577),Sr=(J=>(J.Candles="candles",J.CandlesVolume="candles+volume",J.Volume="volume",J))(Sr||{}),Jo=(J=>(J.Candles="candles",J.OHLCBars="ohlcbars",J))(Jo||{}),xo=(J=>(J.CloseClose="close-close",J.OpenClose="open-close",J))(xo||{});const Xo={down:"red",flat:"gray",up:"green"},po={...{candleStyle:"candles",colorStrategy:"open-close",colors:{down:"red",up:"green",flat:"gray"},fields:{},includeAllFields:!1,mode:"candles+volume"},legend:{displayMode:rt.lm.List,showLegend:!0,placement:"bottom",calcs:[]},tooltip:{mode:rt.$N.Multi,sort:rt.xB.None}},zr={open:{key:"open",name:"Open",defaults:["open","o"],description:"Value at the start of the period"},high:{key:"high",name:"High",defaults:["high","h","max"],description:"Maximum value within the period"},low:{key:"low",name:"Low",defaults:["low","l","min"],description:"Minimum value within the period"},close:{key:"close",name:"Close",defaults:["close","c"],description:"Value at the end of the period"},volume:{key:"volume",name:"Volume",defaults:["volume","v"],description:"Sample count within the period"}};function Ci(J,pe,Me){const Ue=(0,Yo.findField)(J,Me[pe.key]);if(!Ue)for(const ze of J.fields){const tt=(0,en.Ct)(ze,J).toLowerCase();if(pe.defaults.includes(tt)||pe.defaults.includes(ze.name))return ze}return Ue}function Zo(J,pe,Me,Ue){if(!J?.length)return null;const ze=pe.fields??{},tt=J.length===1?(0,$n.Yj)(J[0],J[0].fields.findIndex(Gt=>Gt.type===jt.PU.time)):(0,$n.Fd)({frames:J});if(!tt?.length)return null;const it={aligned:tt,frame:tt,names:{}},bt=(0,_s.B_)([tt],Me,Ue);if(!bt)return null;const Lt=it.frame=bt[0],Nt=Lt.fields.findIndex(Gt=>Gt.type===jt.PU.time);if(Nt<0)return null;const Ht=new Set;for(const Gt of Object.values(zr)){const pn=Ci(Lt,Gt,ze);pn&&(it[Gt.key]=pn,Ht.add(pn))}if(!it.open&&!it.close&&(it.open=Lt.fields.find(Gt=>Gt.type===jt.PU.number),it.open&&Ht.add(it.open)),it.open&&!it.close&&!ze.close){const Gt=it.open.values.slice(1);Gt.push(Gt[Gt.length-1]),it.close={...it.open,values:Gt,name:"Next open",state:void 0},Ht.add(it.close),Lt.fields.push(it.close),it.autoOpenClose=!0}if(it.close&&!it.open&&!ze.open){const Gt=it.close.values.slice();Gt.unshift(Gt[0]),Gt.length=Lt.length,it.open={...it.close,values:Gt,name:"Previous close",state:void 0},Ht.add(it.open),Lt.fields.push(it.open),it.autoOpenClose=!0}!it.high&&!ze.high&&(it.high=it.open),!it.low&&!ze.low&&(it.low=it.open),pe.mode===Sr.Volume?(it.high&&(it.high!==it.open&&Ht.delete(it.high),it.high=void 0),it.low&&(it.low!==it.open&&Ht.delete(it.low),it.low=void 0)):pe.mode===Sr.Candles&&it.volume&&(Ht.delete(it.volume),it.volume=void 0);for(const Gt of Object.values(zr)){const pn=it[Gt.key];pn&&(it.names[Gt.key]=(0,en.Ct)(pn,it.frame))}const Xt=Lt.fields[Nt],cn=[Xt];pe.includeAllFields?cn.push(...Lt.fields.filter(Gt=>Gt!==Xt)):cn.push(...Ht),it.frame={...it.frame,fields:cn};for(let Gt=0;Gt<it.frame.fields.length;Gt++){const pn=it.frame.fields[Gt];pn.state={...pn.state,seriesIndex:Gt-1,origin:{fieldIndex:Gt,frameIndex:0}}}return it}const{alpha:Gi}=Ys.MV;function Io(J){let{mode:pe,candleStyle:Me,fields:Ue,colorStrategy:ze,upColor:tt,downColor:it,flatColor:bt,volumeAlpha:Lt,flatAsUp:Nt=!0}=J;const Ht=pe!==Sr.Volume&&Ue.high!=null&&Ue.low!=null,Xt=Ht&&Me===Jo.Candles,cn=pe!==Sr.Candles&&Ue.volume!=null;function Gt(bn,Ns,ts,Es,Hn){return bn>0?ts:bn<0?Es:Hn?ts:Ns}let pn=0,zn=Ue.open,Ln=Ue.high,Kn=Ue.low,Rn=Ue.close,mn=Ue.volume;return bn=>{let Ns,ts,Es,Hn,jn,is;Ht&&(Es=new Path2D,ts=new Path2D,Ns=new Path2D),cn&&(Hn=new Path2D,jn=new Path2D,is=new Path2D);let Zn=new Path2D,ps=bn.ctx,Fs=bn.data[pn],la=bn.data[zn],ia=bn.data[Rn],Na=Ht?bn.data[Ln]:null,aa=Ht?bn.data[Kn]:null,Ts=cn?bn.data[mn]:null,Is=mn!=null?Math.round(bn.valToPos(0,bn.series[mn].scale,!0)):null,[ba,Va]=bn.series[0].idxs,Vs=bn.data[0],Rs=la,ra=bn.bbox.width;if(Vs.length>1){let xa=null;for(let Qa=0,Ya=1/0;Qa<Vs.length;Qa++)if(Rs[Qa]!==void 0){if(xa!=null){let cr=Math.abs(Vs[Qa]-Vs[xa]);cr<Ya&&(Ya=cr,ra=Math.abs(bn.valToPos(Vs[Qa],"x",!0)-bn.valToPos(Vs[xa],"x",!0)))}xa=Qa}}let Da=Math.round(.6*ra),ga=2,Ia=2;Da<=12&&(ga=Ia=1);let Ha=Math.floor(Da/2);for(let xa=ba;xa<=Va;xa++){let Qa=Math.round(bn.valToPos(Fs[xa],"x",!0)),Ya=xa===ba?0:Math.sign(ia[xa]-ia[xa-1]),cr=Math.sign(ia[xa]-la[xa]);if(cn&&is&&jn&&Hn){let ms=Gt(ze===xo.CloseClose?Ya:cr,is,jn,Hn,xa===ba&&xo.CloseClose?!1:Nt),Vn=Math.round(bn.valToPos(Ts[xa],bn.series[mn].scale,!0));ms.rect(Qa-Ha,Vn,Da,Is-Vn)}if(Ht&&Es&&ts&&Ns){let ms=Gt(ze===xo.CloseClose?Ya:cr,Es,ts,Ns,xa===ba&&xo.CloseClose?!1:Nt),Vn=Math.round(bn.valToPos(Na[xa],bn.series[Ln].scale,!0)),ls=Math.round(bn.valToPos(aa[xa],bn.series[Kn].scale,!0));ms.rect(Qa-Math.floor(ga/2),Vn,ga,ls-Vn);let sa=Math.round(bn.valToPos(la[xa],bn.series[zn].scale,!0)),Qs=Math.round(bn.valToPos(ia[xa],bn.series[Rn].scale,!0));if(Xt){let ca=Math.min(sa,Qs),Oa=Math.max(sa,Qs),Tr=Math.max(1,Oa-ca);ms.rect(Qa-Ha,ca,Da,Tr),ze===xo.CloseClose&&cr>=0&&Tr>Ia*2&&Zn.rect(Qa-Ha+Ia,ca+Ia,Da-Ia*2,Tr-Ia*2)}else ms.rect(Qa-Ha,sa,Ha,ga),ms.rect(Qa,Qs,Ha,ga)}}ps.save(),ps.rect(bn.bbox.left,bn.bbox.top,bn.bbox.width,bn.bbox.height),ps.clip(),cn&&is&&jn&&Hn&&(ps.fillStyle=Gi(tt,Lt),ps.fill(jn),ps.fillStyle=Gi(it,Lt),ps.fill(Hn),ps.fillStyle=Gi(bt,Lt),ps.fill(is)),Ht&&Es&&ts&&Ns&&(ps.fillStyle=tt,ps.fill(ts),ps.fillStyle=it,ps.fill(Ns),ps.fillStyle=bt,ps.fill(Es),ps.globalCompositeOperation="destination-out",ps.fill(Zn)),ps.restore()}}const qr=({data:J,id:pe,timeRange:Me,timeZone:Ue,width:ze,height:tt,options:it,fieldConfig:bt,onChangeTimeRange:Lt,replaceVariables:Nt})=>{const{sync:Ht,eventsScope:Xt,canAddAnnotations:cn,onThresholdsChange:Gt,canEditThresholds:pn,showThresholds:zn,dataLinkPostProcessor:Ln,eventBus:Kn}=(0,da.d2)(),Rn=(0,te.$j)(),mn=(0,V.useMemo)(()=>Zo(J.series,it,Rn,Me),[J.series,it,Rn,Me]),[bn,Ns]=(0,V.useState)(null),ts=Ht?.()??qn.yV.Off,{renderers:Es,tweakScale:Hn,tweakAxis:jn,shouldRenderPrice:is}=(0,V.useMemo)(()=>{let ps=(Ya,cr)=>Ya,Fs=(Ya,cr)=>Ya,la={renderers:[],tweakScale:ps,tweakAxis:Fs,shouldRenderPrice:!1};if(!mn)return la;const ia=mn.names;if(!Object.keys(ia).length)return la;const{mode:Na,candleStyle:aa,colorStrategy:Ts}=it,Is={...Xo,...it.colors};let{open:ba,high:Va,low:Vs,close:Rs,volume:ra}=ia;if(ba==null||Rs==null)return la;let Da=.5,ga=-1,Ia=!1;if(ra!=null&&Na!==Sr.Candles){let Ya=mn.volume;if(Ya!=null){Ia=!0;let{fillOpacity:cr}=Ya.config.custom;cr&&(Da=cr/100),Na!==Sr.Volume&&(Ya.config={...Ya.config},Ya.config.unit="short",Ya.display=(0,Qn.J)({field:Ya,theme:ce.config.theme2}),Fs=(ms,Vn)=>{if(Vn.name===mn.volume?.name){let ls=(sa,Qs)=>{let ca=[],Oa=sa.series[ga].max;for(let Tr=0;Tr<Qs.length&&(ca.push(Qs[Tr]),!(Oa&&Qs[Tr]>Oa));Tr++);return ca};ms.space=20,ms.filter=ls,ms.ticks={...ms.ticks,filter:ls}}return ms},ps=(ms,Vn)=>(Vn.name===mn.volume?.name&&(ms.range=(ls,sa,Qs)=>[0,Qs*7]),ms))}}let Ha=Na!==Sr.Volume&&Va!=null&&Vs!=null;if(!Ha&&!Ia)return la;let xa={},Qa=[];return Ha?xa={open:ba,high:Va,low:Vs,close:Rs}:Qa.push(ba,Rs),Ia&&(xa.volume=ra,xa.open=ba,xa.close=Rs),{shouldRenderPrice:Ha,renderers:[{fieldMap:xa,indicesOnly:Qa,init:(Ya,cr)=>{ga=cr.volume,Ya.addHook("drawAxes",Io({mode:Na,fields:cr,upColor:ce.config.theme2.visualization.getColorByName(Is.up),downColor:ce.config.theme2.visualization.getColorByName(Is.down),flatColor:ce.config.theme2.visualization.getColorByName(Is.flat),volumeAlpha:Da,colorStrategy:Ts,candleStyle:aa,flatAsUp:!0}))}}],tweakScale:ps,tweakAxis:Fs}},[it,J.structureRev,J.series.length]);if(!mn)return(0,T.jsx)(fs.a,{panelId:pe,fieldConfig:bt,data:J,needsTimeField:!0,needsNumberField:!0});if(is)for(let ps in Es[0].fieldMap){let Fs=mn[ps];Fs.config={...Fs.config,custom:{...Fs.config.custom,hideFrom:{legend:!0,tooltip:!1,viz:!1}}}}const Zn=!!cn?.();return(0,T.jsx)(Qo,{frames:[mn.frame],structureRev:J.structureRev,timeRange:Me,timeZone:Ue,width:ze,height:tt,legend:it.legend,renderers:Es,tweakAxis:jn,tweakScale:Hn,options:it,replaceVariables:Nt,dataLinkPostProcessor:Ln,cursorSync:ts,children:(ps,Fs)=>(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(ro.Z,{config:ps}),ts!==qn.yV.Off&&(0,T.jsx)(Uo.K,{config:ps,eventBus:Kn,frame:Fs}),it.tooltip.mode!==rt.$N.None&&(0,T.jsx)(Ms.xl,{config:ps,hoverMode:it.tooltip.mode===rt.$N.Single?Ms.b3.xOne:Ms.b3.xAll,queryZoom:Lt,clientZoom:!0,syncMode:ts,syncScope:Xt,render:(la,ia,Na,aa=!1,Ts,Is,ba)=>{if(Zn&&Is!=null){Ns(Is),Ts();return}const Va=()=>{let Vs=la.posToVal(la.cursor.left,"x");Ns({from:Vs,to:Vs}),Ts()};return(0,T.jsx)(ks.k,{series:Fs,dataIdxs:ia,seriesIdx:Na,mode:ba?rt.$N.Multi:it.tooltip.mode,sortOrder:it.tooltip.sort,isPinned:aa,annotate:Zn?Va:void 0,maxHeight:it.tooltip.maxHeight})},maxWidth:it.tooltip.maxWidth}),(0,T.jsx)(Vr.W,{annotations:J.annotations??[],config:ps,timeZone:Ue,newRange:bn,setNewRange:Ns}),(0,T.jsx)(Fo.U,{config:ps,onChangeTimeRange:Lt}),J.annotations&&(0,T.jsx)(zi,{config:ps,exemplars:J.annotations,timeZone:Ue}),(pn&&Gt||zn)&&(0,T.jsx)($o,{config:ps,fieldConfig:bt,onThresholdsChange:pn?Gt:void 0})]})})};class Eo{getSuggestionsForData(pe){const{dataSummary:Me}=pe;if(!pe.data?.series||!Me.hasData||Me.timeFieldCount<1||Me.numberFieldCount<2||Me.numberFieldCount>10)return;const Ue=Zo(pe.data.series,po,I.$.theme2);if(!Ue||Ue.open===Ue.high&&Ue.open===Ue.low)return;pe.getListAppender({name:"",pluginId:"candlestick",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]}}).append({name:xs.m.Candlestick,options:po,fieldConfig:{defaults:{},overrides:[]},score:Ue.autoOpenClose?Ot.nQ.Good:Ot.nQ.Best})}}const vr=[{label:"Candles",value:Sr.Candles},{label:"Volume",value:Sr.Volume},{label:"Both",value:Sr.CandlesVolume}],ui=[{label:"Candles",value:Jo.Candles},{label:"OHLC Bars",value:Jo.OHLCBars}],Ti=[{label:"Since Open",value:xo.OpenClose},{label:"Since Prior Close",value:xo.CloseClose}],ll=J=>J.type===jt.PU.number;function hi(J,pe,Me){let Ue="Auto ";if(Me){const ze=Me[pe.key];ze?.config?(Ue+="= "+(0,en.Ct)(ze),ze===Me?.open&&pe.key!=="open"&&(Ue+=` (${pe.defaults.join(",")})`)):Ue+=`(${pe.defaults.join(",")})`}J.addFieldNamePicker({path:`fields.${pe.key}`,name:pe.name,description:pe.description,settings:{filter:ll,placeholderText:Ue}})}const cl=new b.m(qr).useFieldConfig((0,ur.V)(ur.S)).setPanelOptions((J,pe)=>{const Me=pe.options??po,Ue=Zo(pe.data,Me,I.$.theme2);J.addRadio({path:"mode",name:"Mode",description:"",defaultValue:po.mode,settings:{options:vr}}).addRadio({path:"candleStyle",name:"Candle style",description:"",defaultValue:po.candleStyle,settings:{options:ui},showIf:ze=>ze.mode!==Sr.Volume}).addRadio({path:"colorStrategy",name:"Color strategy",description:"",defaultValue:po.colorStrategy,settings:{options:Ti}}).addColorPicker({path:"colors.up",name:"Up color",defaultValue:Xo.up}).addColorPicker({path:"colors.down",name:"Down color",defaultValue:Xo.down}),hi(J,zr.open,Ue),Me.mode!==Sr.Volume&&(hi(J,zr.high,Ue),hi(J,zr.low,Ue)),hi(J,zr.close,Ue),Me.mode!==Sr.Candles&&hi(J,zr.volume,Ue),J.addRadio({path:"includeAllFields",name:"Additional fields",description:"Use standard timeseries options to configure any fields not mapped above",defaultValue:po.includeAllFields,settings:{options:[{label:"Ignore",value:!1},{label:"Include",value:!0}]}}),Yn.D(J,!1,!0,Me),Wn.H(J)}).setDataSupport({annotations:!0,alertStates:!0}).setSuggestionsSupplier(new Eo);var Mi=e(36607),Si=e(76885),Qi=e(80997),Oi=e(6709),qo=e(29158),Yi=e(82467),Fe=e(10096),Ve=e(16021),qe=e(91219),ut=e(28215),Tt=e(27677),_t=e(62301),Zt=e(80484);const dn=J=>({dashlistSectionHeader:(0,q.css)`
    padding: ${J.spacing(.25,1)};
    margin-right: ${J.spacing(1)};
  `,dashlistSection:(0,q.css)`
    margin-bottom: ${J.spacing(2)};
    padding-top: 3px;
  `,dashlistLink:(0,q.css)`
    display: flex;
    cursor: pointer;
    border-bottom: 1px solid ${J.colors.border.weak};
    margin-right: ${J.spacing(1)};
    padding: ${J.spacing(1)};
    align-items: center;

    &:hover {
      a {
        color: ${J.colors.text.link};
        text-decoration: underline;
      }
    }
  `,dashlistFolder:(0,q.css)`
    color: ${J.colors.text.secondary};
    font-size: ${J.typography.bodySmall.fontSize};
    line-height: ${J.typography.body.lineHeight};
  `,dashlistTitle:(0,q.css)`
    &::after {
      position: absolute;
      content: '';
      left: 0;
      top: 0;
      bottom: 0;
      right: 0;
    }
  `,dashlistLinkBody:(0,q.css)`
    flex-grow: 1;
    overflow: hidden;
    text-overflow: ellipsis;
  `,dashlistItem:(0,q.css)`
    position: relative;
    list-style: none;
  `});async function Dn(J,pe){let Me=Promise.resolve([]);if(J.showStarred){const Ht={limit:J.maxItems,starred:"true"};Me=(0,Tt.AI)().search(Ht)}let Ue=Promise.resolve([]),ze=[];if(J.showRecentlyViewed){let Ht=await _t.A.getDashboardOpened();ze=(0,N.take)(Ht,J.maxItems),Ue=(0,Tt.AI)().search({dashboardUIDs:ze,limit:J.maxItems})}let tt=Promise.resolve([]);if(J.showSearch){const Ht=J.folderUID===""?"general":J.folderUID,Xt={limit:J.maxItems,query:pe(J.query,{},"text"),folderUIDs:Ht,tag:J.tags.map(cn=>pe(cn,{},"text")),type:"dash-db"};tt=(0,Tt.AI)().search(Xt)}const[it,bt,Lt]=await Promise.all([Me,tt,Ue]);let Nt=new Map;for(const Ht of ze){const Xt=Lt.find(cn=>cn.uid===Ht);Xt&&Nt.set(Ht,{...Xt,isRecent:!0})}return bt.forEach(Ht=>{Ht.uid&&(Nt.has(Ht.uid)?Nt.get(Ht.uid).isSearchResult=!0:Nt.set(Ht.uid,{...Ht,isSearchResult:!0}))}),it.forEach(Ht=>{Ht.uid&&(Nt.has(Ht.uid)?Nt.get(Ht.uid).isStarred=!0:Nt.set(Ht.uid,{...Ht,isStarred:!0}))}),Nt}function An(J){const[pe,Me]=(0,V.useState)(new Map),Ue=(0,W.useDispatch)(),ze=(0,W.useSelector)(Rn=>Rn.navIndex);(0,V.useEffect)(()=>{Dn(J.options,J.replaceVariables).then(Rn=>{Me(Rn)})},[J.options,J.replaceVariables,J.renderCounter]);const tt=async(Rn,mn)=>{const{uid:bn,title:Ns,url:ts}=mn;Rn.preventDefault(),Rn.stopPropagation();const Es=await(0,He.UA)().starDashboard(mn.uid,mn.isStarred),Hn=new Map(pe);Hn.set(mn?.uid??"",{...mn,isStarred:Es}),Me(Hn),Ue((0,qe.ci)({id:bn??"",title:Ns,url:ts,isStarred:Es}));const jn=ze.starred;if(Es)jn.children?.push({id:qe.L1+bn,text:Ns,url:ts??"",parentItem:jn});else{Ue((0,ut.Im)(qe.L1+bn));const is=jn.children?.findIndex(Zn=>Zn.id===qe.L1+bn);is&&jn.children?.splice(is,1)}Ue((0,Yi.Vz)(jn))},[it,bt,Lt]=(0,V.useMemo)(()=>{const Rn=[...pe.values()];return[Rn.filter(mn=>mn.isStarred).sort((mn,bn)=>mn.title.localeCompare(bn.title)),Rn.filter(mn=>mn.isRecent),Rn.filter(mn=>mn.isSearchResult).sort((mn,bn)=>mn.title.localeCompare(bn.title))]},[pe]),{showStarred:Nt,showRecentlyViewed:Ht,showHeadings:Xt,showFolderNames:cn,showSearch:Gt}=J.options,pn=[{header:"Starred dashboards",dashboards:it,show:Nt},{header:"Recently viewed dashboards",dashboards:bt,show:Ht},{header:"Search",dashboards:Lt,show:Gt}],zn=(0,te.of)(dn),Ln=rs(J),Kn=Rn=>(0,T.jsx)("ul",{children:Rn.map(mn=>{let bn=mn.url;return bn=Si.kM.appendQueryToUrl(bn,Ln),bn=(0,ce.zj)().disableSanitizeHtml?bn:Qi.sQ.sanitizeUrl(bn),(0,T.jsx)("li",{className:zn.dashlistItem,children:(0,T.jsxs)("div",{className:zn.dashlistLink,children:[(0,T.jsxs)("div",{className:zn.dashlistLinkBody,children:[(0,T.jsx)("a",{className:zn.dashlistTitle,href:bn,children:mn.title}),cn&&mn.folderTitle&&(0,T.jsx)("div",{className:zn.dashlistFolder,children:mn.folderTitle})]}),(0,T.jsx)(qo.K,{tooltip:mn.isStarred?`Unmark "${mn.title}" as favorite`:`Mark "${mn.title}" as favorite`,name:mn.isStarred?"favorite":"star",iconType:mn.isStarred?"mono":"default",onClick:Ns=>tt(Ns,mn)})]})},`dash-${mn.uid}`)})});return(0,T.jsx)(le.E,{autoHeightMin:"100%",autoHeightMax:"100%",children:pn.map(({show:Rn,header:mn,dashboards:bn},Ns)=>Rn&&(0,T.jsxs)("div",{className:zn.dashlistSection,children:[Xt&&(0,T.jsx)("h6",{className:zn.dashlistSectionHeader,children:mn}),Kn(bn)]},`dash-group-${Ns}`))})}function rs(J){(0,Ve.u)(Fe.lE,Zt.og);let pe={};return J.options.keepTime&&(pe[`$${Oi.c.keepTime}`]=!0),J.options.includeVars&&(pe[`$${Oi.c.includeVars}`]=!0),J.replaceVariables(Si.kM.toUrlParams(pe))}async function os(J){return J===0?"":(await(0,Nn.AI)().get(`/api/folders/id/${J}`,void 0,void 0,{showErrorAlert:!1})).uid}async function us(J){const pe={...J.options,showStarred:J.options.showStarred??J.starred,showRecentlyViewed:J.options.showRecentlyViewed??J.recent,showSearch:J.options.showSearch??J.search,showHeadings:J.options.showHeadings??J.headings,maxItems:J.options.maxItems??J.limit,query:J.options.query??J.query,folderId:J.options.folderId??J.folderId,tags:J.options.tags??J.tags};if(parseFloat(J.pluginVersion||"6.1")<6.3&&["starred","recent","search","headings","limit","query","folderId"].forEach(ze=>delete J[ze]),pe.folderId!==void 0){const Ue=pe.folderId;try{const ze=await os(Ue);pe.folderUID=ze,delete pe.folderId}catch(ze){console.warn("Dashlist: Error migrating folder ID to UID",ze)}}return pe}const hs={includeVars:!1,keepTime:!1,maxItems:10,query:"",showFolderNames:!0,showHeadings:!0,showRecentlyViewed:!1,showSearch:!1,showStarred:!0,tags:[]},Js=new b.m(An).setPanelOptions(J=>{J.addBooleanSwitch({path:"keepTime",name:"Include current time range",defaultValue:hs.keepTime}).addBooleanSwitch({path:"includeVars",name:"Include current template variable values",defaultValue:hs.includeVars}).addBooleanSwitch({path:"showStarred",name:"Starred",defaultValue:hs.showStarred}).addBooleanSwitch({path:"showRecentlyViewed",name:"Recently viewed",defaultValue:hs.showRecentlyViewed}).addBooleanSwitch({path:"showSearch",name:"Search",defaultValue:hs.showSearch}).addBooleanSwitch({path:"showHeadings",name:"Show headings",defaultValue:hs.showHeadings}).addBooleanSwitch({path:"showFolderNames",name:"Show folder names",defaultValue:hs.showFolderNames}).addNumberInput({path:"maxItems",name:"Max items",defaultValue:hs.maxItems}).addTextInput({path:"query",name:"Query",defaultValue:hs.query}).addCustomEditor({path:"folderUID",name:"Folder",id:"folderUID",defaultValue:void 0,editor:function({value:Me,onChange:Ue}){return(0,T.jsx)(Mi.d,{clearable:!0,permission:W.PermissionLevelString.View,value:Me,onChange:ze=>Ue(ze)})}}).addCustomEditor({id:"tags",path:"tags",name:"Tags",description:"",defaultValue:hs.tags,editor(pe){return(0,T.jsx)(Dt.u,{tags:pe.value,onChange:pe.onChange})}})}).setMigrationHandler(us);var Os=e(47187),vs=e(14110),Cs=e(11503);const ea=({onBlur:J,placeholder:pe})=>{const Me=(0,V.useRef)(null);(0,V.useEffect)(()=>{Me.current&&Me.current.focus()});const Ue=ze=>{ze.key==="Enter"&&ze.currentTarget.blur()};return(0,T.jsx)("input",{type:"text",placeholder:pe,onBlur:J,ref:Me,onKeyDown:Ue,"data-testid":"column-input"})},oa=({divStyle:J,onColumnInputBlur:pe})=>{const[Me,Ue]=(0,V.useState)(!1),ze=()=>{Ue(!0)},tt=it=>{const bt=it.target.value;bt&&pe(bt),Ue(!1)};return(0,T.jsx)("div",{className:J,children:Me?(0,T.jsx)(ea,{placeholder:"Column Name",onBlur:tt}):(0,T.jsx)("button",{onClick:ze,children:"+"})})};var As=e(50311),ta=e(64539),Ra=e(59093),Ga=e(28122),ar=e(27183),La=e(69321);const na=()=>I.$.featureToggles.enableDatagridEditing,Or="600 13px Inter",Lr="400 13px Inter",qa=document.createElement("canvas"),_r=20,io=300,Pr=65,lo="both",ir="number",ss={isContextMenuOpen:!1},ws={isInputOpen:!1},Ds="datagrid_panel",Ws={EDIT_CELL:"edit_cell",GRID_SELECTED:"grid_selected",APPEND_ROW:"append_row",APPEND_COLUMN:"append_column",DELETE_BTN_PRESSED:"delete_btn_pressed",COLUMN_RESIZE:"column_resize",COLUMN_REORDER:"column_reorder",ROW_REORDER:"row_reorder",CONTEXT_MENU_ACTION:"context_menu_action",HEADER_MENU_ACTION:"header_menu_action"},Ge={name:"A",fields:[],length:0},Le={kind:La.dd.Text,data:"",allowOverlay:!0,readonly:!1,displayData:""},_e={columns:La.I1.empty(),rows:La.I1.empty()},nt={sticky:!1,tint:!0},At={fill:!0,sticky:!1};async function kt(J,pe){if(pe&&na()){for(let Me=0;Me<J.fields.length;Me++)delete J.fields[Me].config.displayName,delete J.fields[Me].config.displayNameFromDS;return await pe([J])}return!1}const qt=(J,pe=!1)=>{const Me=qa.getContext("2d");return Me.font=pe?Or:Lr,Me.measureText(J).width},gn=J=>Math.max(qt(J.name,!0)+Pr,Math.min(io,J.values.toArray().reduce((pe,Me)=>{const Ue=qt(Me?.toString()??"");return Ue>pe?Ue:pe},0)+_r)),Bn=(J,pe,Me=!1)=>{const Ue={...J,fields:J.fields.map(ze=>({...ze,values:ze.values.slice()}))};for(const ze of Ue.fields){const tt=ze.values.toArray();for(let it=pe.length-1;it>=0;it--)Me?tt.splice(pe[it],1):tt.splice(pe[it],1,null);ze.values=[...tt]}return{...Ue,length:Ue.fields[0]?.values.length??0}},xn=(J,pe)=>{const Me=pe.x,Ue=pe.y,ze=pe.x+pe.width-1,tt={...J,fields:J.fields.map(it=>({...it,values:it.values.slice()}))};for(let it=Me;it<=ze;it++){const bt=tt.fields[it],Lt=bt.values.toArray();Lt.splice(Ue,pe.height,...new Array(pe.height).fill(null)),bt.values=[...Lt]}return{...tt,length:tt.fields[0]?.values.length??0}},gs=J=>{const pe=J.values.toArray();J.values=pe.map(Me=>Me==="undefined"||Me==="null"?null:Me)};function as(J){return{accentColor:J.colors.primary.main,accentFg:J.colors.secondary.main,textDark:J.colors.text.primary,textMedium:J.colors.text.secondary,textLight:J.colors.text.secondary,textBubble:J.colors.text.primary,textHeader:J.colors.text.primary,bgCell:J.colors.background.primary,bgCellMedium:J.colors.background.primary,bgHeader:J.colors.background.primary,bgHeaderHasFocus:J.colors.background.secondary,bgHeaderHovered:J.colors.background.secondary,linkColor:J.colors.text.link,fontFamily:J.typography.fontFamily,headerFontStyle:`${J.typography.fontWeightMedium} ${J.typography.fontSize}px`,fgIconHeader:J.colors.secondary.contrastText,bgIconHeader:J.colors.secondary.main}}const $s=(J,pe,Me=!1)=>{const Ue=J.values.get(pe);switch(J.type){case jt.PU.boolean:return{kind:La.dd.Boolean,data:Ue||!1,allowOverlay:!1,readonly:!1};case jt.PU.number:return{kind:La.dd.Number,data:Ue||0,allowOverlay:na()&&!Me,readonly:!1,displayData:Ue!=null?Ue.toString():""};case jt.PU.string:return{kind:La.dd.Text,data:Ue||"",allowOverlay:na()&&!Me,readonly:!1,displayData:Ue!=null?Ue.toString():""};default:return{kind:La.dd.Text,data:Ue||"",allowOverlay:na()&&!Me,readonly:!1,displayData:Ue!=null?Ue.toString():""}}},Us=(J,pe)=>({dataEditor:(0,q.css)`
      .dvn-scroll-inner > div:nth-child(2) {
        pointer-events: none !important;
      }
      scrollbar-color: ${J.colors.background.secondary} ${J.colors.background.primary};
      ::-webkit-scrollbar {
        width: 10px;
        height: 10px;
      }
      ::-webkit-scrollbar-track {
        background: ${J.colors.background.primary};
      }
      ::-webkit-scrollbar-thumb {
        border-radius: 10px;
      }
      ::-webkit-scrollbar-corner {
        display: none;
      }
    `,addColumnDiv:(0,q.css)`
      width: 120px;
      display: flex;
      flex-direction: column;
      background-color: ${J.colors.background.primary};
      button {
        pointer-events: ${pe?"none":"auto"};
        border: none;
        outline: none;
        height: 37px;
        font-size: 20px;
        background-color: ${J.colors.background.primary};
        color: ${J.colors.text.primary};
        border-right: 1px solid ${J.components.panel.borderColor};
        border-bottom: 1px solid ${J.components.panel.borderColor};
        transition: background-color 200ms;
        cursor: pointer;
        :hover {
          background-color: ${J.colors.background.secondary};
        }
      }
      input {
        height: 37px;
        border: 1px solid ${J.colors.primary.main};
        :focus {
          outline: none;
        }
      }
    `,renameColumnInput:(0,q.css)`
      height: 37px;
      border: 1px solid ${J.colors.primary.main};
      :focus {
        outline: none;
      }
    `}),Ta=J=>J.rows.length||J.columns.length?!0:J.current===void 0?!1:J.current.range&&!(J.current.range.height===1&&J.current.range.width===1);var Xs=(J=>(J.columnResizeStart="columnResizeStart",J.columnResizeEnd="columnResizeEnd",J.columnMove="columnMove",J.updateColumns="updateColumns",J.showColumnRenameInput="showColumnRenameInput",J.hideColumnRenameInput="hideColumnRenameInput",J.openCellContextMenu="openCellContextMenu",J.openHeaderContextMenu="openHeaderContextMenu",J.openHeaderDropdownMenu="openHeaderDropdownMenu",J.closeContextMenu="closeContextMenu",J.multipleCellsSelected="multipleCellsSelected",J.gridSelectionCleared="gridSelectionCleared",J.columnFreezeReset="columnFreezeReset",J.columnFreezeChanged="columnFreezeChanged",J.openSearch="openSearch",J.closeSearch="closeSearch",J))(Xs||{});const fa={columns:[],contextMenuData:ss,renameColumnInputData:ws,gridSelection:_e,columnFreezeIndex:0,toggleSearch:!1,isResizeInProgress:!1},ma=new Map([[jt.PU.number,La.Gf.HeaderNumber],[jt.PU.string,La.Gf.HeaderTextTemplate],[jt.PU.boolean,La.Gf.HeaderBoolean],[jt.PU.time,La.Gf.HeaderDate],[jt.PU.other,La.Gf.HeaderReference]]),Ma=(J,pe)=>{let Me=[];switch(pe.type){case"columnResizeStart":Me=[...J.columns];const Ue=pe.payload;return Me[Ue.columnIndex]={...J.columns[Ue.columnIndex],width:Ue.width},{...J,columns:Me,isResizeInProgress:!0};case"columnMove":Me=[...J.columns];const ze=pe.payload,tt=J.columns[ze.from].width;let it=Me.splice(ze.from,1)[0];return it={...it,width:tt},Me.splice(ze.to,0,it),{...J,columns:Me};case"columnResizeEnd":return{...J,isResizeInProgress:!1};case"updateColumns":const bt=pe.payload;return Me=[...bt.frame.fields.map((Kn,Rn)=>{const mn=J.columns.find(Ns=>Ns.title===Kn.name)?.width;return{title:(0,en.Ct)(Kn,bt.frame),width:mn??gn(Kn),icon:ma.get(Kn.type),hasMenu:na(),trailingRowOptions:{targetColumn:--Rn}}})],{...J,columns:Me};case"showColumnRenameInput":return{...J,renameColumnInputData:{...J.renameColumnInputData,isInputOpen:!0}};case"hideColumnRenameInput":return{...J,renameColumnInputData:{...J.renameColumnInputData,isInputOpen:!1}};case"openCellContextMenu":const Lt=pe.payload,Nt=Lt.event,Ht=Lt.cell;return{...J,contextMenuData:{x:Nt.bounds.x+Nt.localEventX,y:Nt.bounds.y+Nt.localEventY,column:Ht[0]===-1?void 0:Ht[0],row:Ht[1],isContextMenuOpen:!0,isHeaderMenu:!1}};case"openHeaderContextMenu":const Xt=pe.payload,cn=Xt.event;return{...J,contextMenuData:{x:cn.bounds.x+cn.localEventX,y:cn.bounds.y+cn.localEventY,column:Xt.columnIndex,row:void 0,isContextMenuOpen:!0,isHeaderMenu:!1}};case"openHeaderDropdownMenu":const Gt=pe.payload,pn=Gt.screenPosition;return{...J,contextMenuData:{x:pn.x+pn.width,y:pn.y+pn.height,column:Gt.columnIndex,row:void 0,isContextMenuOpen:!0,isHeaderMenu:!0},renameColumnInputData:{x:pn.x,y:pn.y,width:pn.width,height:pn.height,columnIdx:Gt.columnIndex,isInputOpen:!1,inputValue:Gt.value}};case"closeContextMenu":return{...J,contextMenuData:{isContextMenuOpen:!1}};case"closeSearch":return{...J,toggleSearch:!1};case"openSearch":return{...J,toggleSearch:!0};case"multipleCellsSelected":const zn=pe.payload;return{...J,gridSelection:zn.selection};case"gridSelectionCleared":return{...J,gridSelection:_e};case"columnFreezeReset":return{...J,columnFreezeIndex:0};case"columnFreezeChanged":const Ln=pe.payload;return{...J,columnFreezeIndex:Ln.columnIndex};default:return J}},Ua=({menuData:J,data:pe,saveData:Me,closeContextMenu:Ue,dispatch:ze,gridSelection:tt,columnFreezeIndex:it,renameColumnClicked:bt})=>{let Lt=[],Nt=[];const{row:Ht,column:Xt,x:cn,y:Gt,isHeaderMenu:pn}=J;tt.rows&&(Lt=tt.rows.toArray()),tt.columns&&(Nt=tt.columns.toArray());let zn="Delete row";Lt.length&&Lt.length>1&&(zn=`Delete ${Lt.length} rows`);let Ln="Delete column";Nt.length&&Nt.length>1&&(Ln=`Delete ${Nt.length} columns`);const Kn=Ht!==void 0&&Ht>=0||Lt.length,Rn=Xt!==void 0&&Xt>=0&&Ht!==void 0||Nt.length,mn=Ht!==void 0&&Ht>=0&&!Lt.length,bn=Xt!==void 0&&Xt>=0&&Ht!==void 0&&!Nt.length,Ns=()=>(0,T.jsxs)(T.Fragment,{children:[Kn?(0,T.jsx)(ta.D,{label:zn,onClick:()=>{if(Lt.length){Me(Bn(pe,Lt,!0)),ze({type:Xs.gridSelectionCleared});return}Ht!==void 0&&Ht>=0&&((0,vs.rR)(Ds,{item:Ws.CONTEXT_MENU_ACTION,menu_action:"row_delete"}),Me(Bn(pe,[Ht],!0)))}}):null,Rn?(0,T.jsx)(ta.D,{label:Ln,onClick:()=>{if(Nt.length){Me({...pe,fields:pe.fields.filter((Es,Hn)=>!Nt.includes(Hn))}),ze({type:Xs.gridSelectionCleared});return}Xt!==void 0&&Xt>=0&&((0,vs.rR)(Ds,{item:Ws.CONTEXT_MENU_ACTION,menu_action:"column_delete"}),Me({...pe,fields:pe.fields.filter((Es,Hn)=>Hn!==Xt)}))}}):null,Rn||Kn?(0,T.jsx)(ar.N,{}):null,mn?(0,T.jsx)(ta.D,{label:"Clear row",onClick:()=>{(0,vs.rR)(Ds,{item:Ws.CONTEXT_MENU_ACTION,menu_action:"row_clear"}),Me(Bn(pe,[Ht]))}}):null,bn?(0,T.jsx)(ta.D,{label:"Clear column",onClick:()=>{const Es=pe.fields[Xt];Es.values=Es.values.map(()=>null),(0,vs.rR)(Ds,{item:Ws.CONTEXT_MENU_ACTION,menu_action:"column_clear"}),Me({...pe})}}):null,mn||bn?(0,T.jsx)(ar.N,{}):null,(0,T.jsx)(ta.D,{label:"Remove all data",onClick:()=>{(0,vs.rR)(Ds,{item:Ws.CONTEXT_MENU_ACTION,menu_action:"remove_all"}),Me(Ge)}}),(0,T.jsx)(ta.D,{label:"Search...",onClick:()=>{(0,vs.rR)(Ds,{item:Ws.CONTEXT_MENU_ACTION,menu_action:"open_search"}),ze({type:Xs.openSearch})}})]}),ts=()=>{if(Xt==null)return null;const Es=pe.fields[Xt].type,Hn=[],jn=ps=>{Hn.push({label:(0,N.capitalize)(ps),options:{targetField:pe.fields[Xt].name,destinationType:ps}})};Es===jt.PU.string?(jn(jt.PU.number),jn(jt.PU.boolean)):Es===jt.PU.number?(jn(jt.PU.string),jn(jt.PU.boolean)):Es===jt.PU.boolean?(jn(jt.PU.number),jn(jt.PU.string)):(jn(jt.PU.string),jn(jt.PU.number),jn(jt.PU.boolean));let is="Set column freeze position";const Zn=Xt+1;return it===Zn&&(is="Unset column freeze"),(0,T.jsxs)(T.Fragment,{children:[Hn.length?(0,T.jsx)(Ra.r,{label:"Set field type",children:Hn.map((ps,Fs)=>(0,T.jsx)(ta.D,{label:ps.label,onClick:()=>{const la=(0,As.s7)(pe.fields[Xt],ps.options);ps.options.destinationType===jt.PU.string&&gs(la);const ia={name:pe.name,fields:[...pe.fields],length:pe.length};ia.fields[Xt]=la,(0,vs.rR)(Ds,{item:Ws.HEADER_MENU_ACTION,menu_action:"convert_field"}),Me(ia)}},Fs))}):null,(0,T.jsx)(ar.N,{}),(0,T.jsx)(ta.D,{label:is,onClick:()=>{(0,vs.rR)(Ds,{item:Ws.HEADER_MENU_ACTION,menu_action:"column_freeze"}),ze(it===Zn?{type:Xs.columnFreezeReset}:{type:Xs.columnFreezeChanged,payload:{columnIndex:Zn}})}}),(0,T.jsx)(ta.D,{label:"Rename column",onClick:bt}),(0,T.jsx)(ar.N,{}),(0,T.jsx)(ta.D,{label:"Delete column",onClick:()=>{(0,vs.rR)(Ds,{item:Ws.HEADER_MENU_ACTION,menu_action:"delete_column"}),Me({...pe,fields:pe.fields.filter((ps,Fs)=>Fs!==Xt)}),ze({type:Xs.gridSelectionCleared})}}),(0,T.jsx)(ta.D,{label:"Clear column",onClick:()=>{const ps=pe.fields[Xt];ps.values=ps.values.map(()=>null),(0,vs.rR)(Ds,{item:Ws.HEADER_MENU_ACTION,menu_action:"clear_column"}),Me({...pe})}})]})};return(0,T.jsx)(Ga.t,{renderMenuItems:pn?ts:Ns,x:cn,y:Gt,onClose:Ue})},va=({renameColumnData:J,onColumnInputBlur:pe,classStyle:Me})=>{const{x:Ue,y:ze,width:tt,height:it,inputValue:bt,columnIdx:Lt}=J,[Nt,Ht]=(0,V.useState)({}),[Xt,cn]=(0,V.useState)(bt),Gt=(0,V.useRef)(null);(0,V.useLayoutEffect)(()=>{Gt.current?.focus();const Kn=Gt.current?.getBoundingClientRect();if(Kn){const Rn={right:window.innerWidth<Ue+Kn.width,bottom:window.innerHeight<ze+Kn.height};Ht({position:"fixed",left:Rn.right?Ue-Kn.width:Ue,top:Rn.bottom?ze-Kn.height:ze,width:tt,height:it})}},[it,tt,Ue,ze]);const pn=Kn=>{const Rn=Kn.target.value;Rn&&pe(Rn,Lt)},zn=Kn=>{cn(Kn.target.value)},Ln=Kn=>{Kn.key==="Enter"&&Kn.currentTarget.blur()};return(0,T.jsx)(di.ZL,{children:(0,T.jsx)("input",{type:"text",className:Me,value:Xt,onBlur:pn,ref:Gt,style:Nt,onChange:zn,onKeyDown:Ln})})};function lr({options:J,data:pe,id:Me,fieldConfig:Ue,width:ze,height:tt}){const[it,bt]=(0,V.useReducer)(Ma,fa),{onUpdateData:Lt}=(0,da.d2)(),{columns:Nt,contextMenuData:Ht,renameColumnInputData:Xt,gridSelection:cn,columnFreezeIndex:Gt,toggleSearch:pn,isResizeInProgress:zn}=it,Ln=pe.series[J.selectedSeries??0],Kn=(0,te.$j)(),Rn=as(Kn);(0,V.useEffect)(()=>{Ln&&bt({type:Xs.updateColumns,payload:{frame:Ln}})},[Ln]);const mn=([Vs,Rs])=>{const ra=Ln.fields[Vs];return!ra||Rs>Ln.length?Le:$s(ra,Rs,Ta(cn))},bn=(Vs,Rs)=>{if(Ta(cn))return;const[ra,Da]=Vs,ga={...Ln,fields:Ln.fields.map(xa=>({...xa,values:[...xa.values]}))},Ia=ga.fields[ra];if(!Ia)return;const Ha=Ia.values.toArray();Ha[Da]=Rs.data,Ia.values=[...Ha],(0,vs.rR)(Ds,{item:Ws.EDIT_CELL}),kt(ga,Lt)},Ns=Vs=>{const Rs=Ln.length??0;(0,vs.rR)(Ds,{item:Ws.APPEND_COLUMN}),kt({...Ln,fields:[...Ln.fields,{name:Vs,type:jt.PU.string,config:{},values:new Array(Rs).fill("")}]},Lt)},ts=()=>{const Vs=Ln.fields.map(Rs=>{const ra=Rs.values.slice();return ra.push(null),{...Rs,values:ra}});(0,vs.rR)(Ds,{item:Ws.APPEND_ROW}),kt({...Ln,fields:Vs,length:Ln.length+1},Lt)},Es=(Vs,Rs,ra,Da)=>{(0,vs.rR)(Ds,{item:Ws.COLUMN_RESIZE}),bt({type:Xs.columnResizeStart,payload:{columnIndex:ra,width:Rs}})},Hn=(Vs,Rs,ra,Da)=>{bt({type:Xs.columnResizeEnd})},jn=()=>{bt({type:Xs.closeContextMenu})},is=Vs=>{if(Vs.current&&Vs.current.range)return(0,vs.rR)(Ds,{item:Ws.DELETE_BTN_PRESSED,selection:"grid-cell"}),kt(xn(Ln,Vs.current.range),Lt),!0;const Rs=Vs.rows.toArray(),ra=Vs.columns.toArray();if(Rs.length)return(0,vs.rR)(Ds,{item:Ws.DELETE_BTN_PRESSED,selection:"rows"}),kt(Bn(Ln,Rs),Lt),!0;if(ra.length){const Da={...Ln,fields:Ln.fields.map((ga,Ia)=>ra.includes(Ia)?{...ga,values:new Array(Ln.length).fill(null)}:ga)};return(0,vs.rR)(Ds,{item:Ws.DELETE_BTN_PRESSED,selection:"columns"}),kt(Da,Lt),!0}return!1},Zn=(Vs,Rs)=>{Rs.preventDefault(),bt({type:Xs.openCellContextMenu,payload:{event:Rs,cell:Vs}})},ps=(Vs,Rs)=>{Rs.preventDefault(),bt({type:Xs.openHeaderContextMenu,payload:{event:Rs,columnIndex:Vs}})},Fs=(Vs,Rs)=>{bt({type:Xs.openHeaderDropdownMenu,payload:{screenPosition:Rs,columnIndex:Vs,value:it.columns[Vs].title}})},la=async(Vs,Rs)=>{const ra=Ln.fields.map(Ia=>Ia),Da=ra[Vs];ra.splice(Vs,1),ra.splice(Rs,0,Da),await kt({...Ln,fields:ra},Lt)&&((0,vs.rR)(Ds,{item:Ws.COLUMN_REORDER}),bt({type:Xs.columnMove,payload:{from:Vs,to:Rs}}))},ia=(Vs,Rs)=>{const ra=Ln.fields.map(Da=>({...Da,values:Da.values.slice()}));for(const Da of ra){const ga=Da.values[Vs];Da.values.splice(Vs,1),Da.values.splice(Rs,0,ga)}(0,vs.rR)(Ds,{item:Ws.ROW_REORDER}),kt({...Ln,fields:ra},Lt)},Na=()=>{(0,vs.rR)(Ds,{item:Ws.HEADER_MENU_ACTION,menu_action:"rename_column"}),bt({type:Xs.showColumnRenameInput})},aa=(Vs,Rs)=>{const ra=Ln.fields.map(Da=>Da);ra[Rs].name=Vs,bt({type:Xs.hideColumnRenameInput}),kt({...Ln,fields:ra},Lt)},Ts=()=>{bt({type:Xs.closeSearch})},Is=Vs=>{(0,vs.rR)(Ds,{item:Ws.GRID_SELECTED}),bt({type:Xs.multipleCellsSelected,payload:{selection:Vs}})},ba=Vs=>{kt(Vs,Lt)};if(!Ln)return(0,T.jsx)(fs.a,{panelId:Me,fieldConfig:Ue,data:pe});if(!na())return(0,T.jsx)(fs.a,{panelId:Me,message:"Datagrid is not enabled",fieldConfig:Ue,data:pe});if(!document.getElementById("portal")){const Vs=document.createElement("div");Vs.id="portal",document.body.appendChild(Vs)}const Va=Us(Kn,zn);return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Os.D,{className:Va.dataEditor,getCellContent:mn,columns:Nt,rows:Ln.length,width:ze,height:tt,initialSize:[ze,tt],theme:Rn,smoothScrollX:!0,smoothScrollY:!0,overscrollY:50,onCellEdited:na()?bn:void 0,getCellsForSelection:na()?!0:void 0,showSearch:na()?pn:!1,onSearchClose:Ts,gridSelection:cn,onGridSelectionChange:na()?Is:void 0,onRowAppended:na()?ts:void 0,onDelete:na()?is:void 0,rowMarkers:na()?lo:ir,onColumnResize:Es,onColumnResizeEnd:Hn,onCellContextMenu:na()?Zn:void 0,onHeaderContextMenu:na()?ps:void 0,onHeaderMenuClick:na()?Fs:void 0,trailingRowOptions:nt,rightElement:na()?(0,T.jsx)(oa,{onColumnInputBlur:Ns,divStyle:Va.addColumnDiv}):null,rightElementProps:At,freezeColumns:Gt,onRowMoved:na()?ia:void 0,onColumnMoved:na()?la:void 0}),Ht.isContextMenuOpen&&(0,T.jsx)(Ua,{menuData:Ht,data:Ln,saveData:ba,closeContextMenu:jn,dispatch:bt,gridSelection:cn,columnFreezeIndex:Gt,renameColumnClicked:Na}),Xt.isInputOpen?(0,T.jsx)(va,{onColumnInputBlur:aa,renameColumnData:Xt,classStyle:Va.renameColumnInput}):null]})}const rr={selectedSeries:0},co=new b.m(lr).setPanelOptions((J,pe)=>{const Me=pe.data.map((Ue,ze)=>({value:ze,label:Ue.refId}));return pe.options&&!Me.map(Ue=>Ue.value).includes(pe.options.selectedSeries??0)&&(pe.options.selectedSeries=rr.selectedSeries),J.addSelect({path:"selectedSeries",name:"Select series",defaultValue:rr.selectedSeries,settings:{options:Me}})});var yr=e(1819);class jr extends V.Component{constructor(){super(...arguments),this.subscription=new yt.yU,this.state={}}componentDidMount(){const{eventBus:pe}=this.props;this.subscription.add(pe.subscribe(un.b_,Me=>{this.setState({event:Me})})),this.subscription.add(pe.subscribe(un.ql,Me=>{this.setState({event:Me})})),this.subscription.add(pe.subscribe(an.kb,Me=>{this.setState({event:Me})})),this.subscription.add(pe.subscribe(an.Tq,Me=>{this.setState({event:Me})}))}componentWillUnmount(){this.subscription.unsubscribe()}render(){const{event:pe}=this.state;if(!pe)return(0,T.jsx)("div",{children:"no events yet"});const{type:Me,payload:Ue,origin:ze}=pe;return(0,T.jsxs)(le.E,{autoHeightMin:"100%",autoHeightMax:"100%",children:[(0,T.jsxs)("h3",{children:["Origin: ",ze?.path]}),(0,T.jsxs)("span",{children:["Type: ",Me]}),!!Ue&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("pre",{children:JSON.stringify(Ue.point,null,"  ")}),Ue.data&&(0,T.jsx)(yr.e,{data:Ue.data,rowIndex:Ue.rowIndex,columnIndex:Ue.columnIndex})]})]})}}var xr=e(36120);let Ul=100;class Lu extends V.PureComponent{constructor(pe){super(pe),this.history=new xr.$({capacity:40,append:"head"}),this.eventObserver={next:Ue=>{const ze=Ue.origin;this.history.add({key:Ul++,type:Ue.type,path:ze?.path,payload:Ue.payload}),this.setState({counter:Ul})}},this.state={counter:Ul};const Me=[];Me.push(pe.eventBus.getStream(un.b_).subscribe(this.eventObserver)),Me.push(pe.eventBus.getStream(un.ql).subscribe(this.eventObserver)),Me.push(pe.eventBus.getStream(un.LO).subscribe(this.eventObserver)),this.subs=Me}componentWillUnmount(){for(const pe of this.subs)pe.unsubscribe()}render(){return(0,T.jsx)(le.E,{autoHeightMin:"100%",autoHeightMax:"100%",children:this.history.map((pe,Me)=>(0,T.jsxs)("div",{children:[JSON.stringify(pe.path)," ",pe.type," / X:",JSON.stringify(pe.payload.x)," / Y:",JSON.stringify(pe.payload.y)]},pe.key))})}}var ac=e(21423),Ii=e(75059);class wr extends V.Component{constructor(){super(...arguments),this.lastRender=Date.now(),this.counters={render:0,dataChanged:0,schemaChanged:0},this.resetCounters=()=>{this.counters={render:0,dataChanged:0,schemaChanged:0},this.forceUpdate()}}shouldComponentUpdate(pe){const{data:Me,options:Ue}=this.props;if(pe.data!==Me&&(this.counters.dataChanged++,Ue.counters?.schemaChanged)){const ze=pe.data?.series,tt=Me.series;tt&&ze&&((0,ac.J3)(tt,ze,ac.bW)||this.counters.schemaChanged++)}return!0}render(){const{data:pe,options:Me}=this.props,Ue=Me.counters??{render:!1,dataChanged:!1,schemaChanged:!1};this.counters.render++;const ze=Date.now(),tt=ze-this.lastRender;this.lastRender=ze;const it=Ii.AS.get(Ii.gy.lastNotNull);return(0,T.jsxs)("div",{children:[(0,T.jsxs)("div",{children:[(0,T.jsx)(qo.K,{name:"step-backward",title:"reset counters",onClick:this.resetCounters,tooltip:"Step back"}),(0,T.jsxs)("span",{children:[Ue.render&&(0,T.jsxs)("span",{children:["Render: ",this.counters.render,"\xA0"]}),Ue.dataChanged&&(0,T.jsxs)("span",{children:["Data: ",this.counters.dataChanged,"\xA0"]}),Ue.schemaChanged&&(0,T.jsxs)("span",{children:["Schema: ",this.counters.schemaChanged,"\xA0"]}),(0,T.jsxs)("span",{children:["TIME: ",tt,"ms"]})]})]}),pe.series&&pe.series.map((bt,Lt)=>(0,T.jsxs)("div",{children:[(0,T.jsxs)("h4",{children:[(0,en.Ri)(bt,Lt)," (",bt.length,")"]}),(0,T.jsxs)("table",{className:"filter-table",children:[(0,T.jsx)("thead",{children:(0,T.jsxs)("tr",{children:[(0,T.jsx)("td",{children:"Field"}),(0,T.jsx)("td",{children:"Type"}),(0,T.jsx)("td",{children:"Last"})]})}),(0,T.jsx)("tbody",{children:bt.fields.map((Nt,Ht)=>{const Xt=it.reduce(Nt,!1,!1)[it.id];return(0,T.jsxs)("tr",{children:[(0,T.jsx)("td",{children:(0,en.Ct)(Nt,bt,pe.series)}),(0,T.jsx)("td",{children:Nt.type}),(0,T.jsx)("td",{children:`${Xt}`})]},`${Ht}/${Nt.name}`)})})]})]},`${Lt}/${bt.refId}`))]})}}var Do=e(88575),ya=e(10354);function ju(J){const pe=(0,da.d2)(),Me=Ue=>{pe.onInstanceStateChange({name:Ue.currentTarget.value})};return(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(Do.D,{label:"State name",children:(0,T.jsx)(ya.p,{value:pe.instanceState?.name??"",onChange:Me})})})}function Bu({value:J,context:pe,onChange:Me,item:Ue}){return(0,T.jsxs)("div",{children:["Current value: ",pe.instanceState?.name," "]})}var Hr=(J=>(J.Cursor="cursor",J.Events="events",J.Render="render",J.State="State",J.ThrowError="ThrowError",J))(Hr||{});class rc extends V.Component{render(){const{options:pe}=this.props;switch(pe.mode){case Hr.Events:return(0,T.jsx)(Lu,{eventBus:this.props.eventBus});case Hr.Cursor:return(0,T.jsx)(jr,{eventBus:this.props.eventBus});case Hr.State:return(0,T.jsx)(ju,{...this.props});case Hr.ThrowError:throw new Error("I failed you and for that i am deeply sorry");default:return(0,T.jsx)(wr,{...this.props})}}}const Uu=new b.m(rc).useFieldConfig().setPanelOptions(J=>{J.addSelect({path:"mode",name:"Mode",defaultValue:Hr.Render,settings:{options:[{label:"Render",value:Hr.Render},{label:"Events",value:Hr.Events},{label:"Cursor",value:Hr.Cursor},{label:"Cursor",value:Hr.Cursor},{label:"Share state",value:Hr.State},{label:"Throw error",value:Hr.ThrowError}]}}).addCustomEditor({id:"stateView",path:"stateView",name:"State view",defaultValue:"",showIf:({mode:pe})=>pe===Hr.State,editor:Bu}).addBooleanSwitch({path:"counters.render",name:"Render Count",defaultValue:!0,showIf:({mode:pe})=>pe===Hr.Render}).addBooleanSwitch({path:"counters.dataChanged",name:"Data Changed Count",defaultValue:!0,showIf:({mode:pe})=>pe===Hr.Render}).addBooleanSwitch({path:"counters.schemaChanged",name:"Schema Changed Count",defaultValue:!0,showIf:({mode:pe})=>pe===Hr.Render}).addDashboardPicker({path:"dashboardUID",name:"Dashboard",settings:{placeholder:"Select dashboard",isClearable:!0}})});var oc=e(76365),nd=e(85194);function Nl(J,pe={}){(0,vs.rR)(`grafana_flamegraph_${J}`,{app:S.Jk.Unknown,grafana_version:I.$.buildInfo.version,...pe})}const Nu=J=>{const pe=(0,oc.oA)(J.data.series[0]);return pe?(0,T.jsx)(fs.a,{panelId:J.id,data:J.data,message:(0,oc.Ik)(pe)}):(0,T.jsx)(nd.A,{data:J.data.series[0],stickyHeader:!1,getTheme:()=>I.$.theme2,showFlameGraphOnly:J.options?.showFlameGraphOnly??!1,onTableSymbolClick:()=>Nl("table_item_selected"),onViewSelected:Me=>Nl("view_selected",{view:Me}),onTextAlignSelected:Me=>Nl("text_align_selected",{align:Me}),onTableSort:Me=>Nl("table_sort_selected",{sort:Me})})};class wu{getListWithDefaults(pe){return pe.getListAppender({name:xs.m.FlameGraph,pluginId:"flamegraph"})}getSuggestionsForData(pe){if(!pe.data)return;const Me=pe.data.series[0];!Me||(0,oc.oA)(Me)||this.getListWithDefaults(pe).append({name:xs.m.FlameGraph})}}const Wu=new b.m(Nu).setSuggestionsSupplier(new wu);var Fu=e(14738),Ku=e(62930);const kr=(J,pe)=>{const Me="linear-gradient(to right, #5182CC 0%, #245BAF 100%)",Ue=pe?Me:"linear-gradient(to right, #f05a28 0%, #fbca0a 100%)",ze=pe?Me:"linear-gradient(to right, #FBCA0A 0%, #F05A28 100%)",tt=J.isDark?Ue:ze;return`
      background-color: ${J.colors.background.secondary};
      margin-right: ${J.spacing(4)};
      border: 1px solid ${J.colors.border.weak};
      border-bottom-left-radius: ${J.shape.borderRadius(2)};
      border-bottom-right-radius: ${J.shape.borderRadius(2)};
      position: relative;
      max-height: 230px;

      ${J.breakpoints.down("xxl")} {
        margin-right: ${J.spacing(2)};
      }
      &::before {
        display: block;
        content: ' ';
        position: absolute;
        left: 0;
        right: 0;
        height: 2px;
        top: 0;
        background-image: ${tt};
      }
`},sd=(0,q.css)`
  padding: 16px;
`,ic=({card:J})=>{const pe=(0,te.of)($u,J.done);return(0,T.jsxs)("div",{className:pe.card,children:[(0,T.jsx)("div",{className:sd,children:(0,T.jsxs)("a",{href:`${J.href}?utm_source=grafana_gettingstarted`,className:pe.url,onClick:()=>(0,vs.rR)("grafana_getting_started_docs",{title:J.title,link:J.href}),children:[(0,T.jsx)("div",{className:pe.heading,children:J.done?"complete":J.heading}),(0,T.jsx)("h4",{className:pe.title,children:J.title})]})}),(0,T.jsxs)("a",{href:`${J.learnHref}?utm_source=grafana_gettingstarted`,className:pe.learnUrl,target:"_blank",rel:"noreferrer",onClick:()=>(0,vs.rR)("grafana_getting_started_docs",{title:J.title,link:J.learnHref}),children:["Learn how in the docs ",(0,T.jsx)(H.I,{name:"external-link-alt"})]})]})},$u=(J,pe)=>({card:(0,q.css)`
      ${kr(J,pe)}

      min-width: 230px;

      ${J.breakpoints.down("md")} {
        min-width: 192px;
      }
    `,heading:(0,q.css)`
      text-transform: uppercase;
      color: ${pe?J.v1.palette.blue95:"#FFB357"};
      margin-bottom: ${J.spacing(2)};
    `,title:(0,q.css)`
      margin-bottom: ${J.spacing(2)};
    `,url:(0,q.css)`
      display: inline-block;
    `,learnUrl:(0,q.css)`
      border-top: 1px solid ${J.colors.border.weak};
      position: absolute;
      bottom: 0;
      padding: 8px 16px;
      width: 100%;
    `});var wl=e(33390);const Ao=({card:J})=>{const pe=(0,te.of)(Wl,J.done);return(0,T.jsx)("a",{className:pe.card,target:"_blank",rel:"noreferrer",href:`${J.href}?utm_source=grafana_gettingstarted`,onClick:Me=>Vu(Me,J),children:(0,T.jsxs)("div",{className:sd,children:[(0,T.jsx)("div",{className:pe.type,children:J.type}),(0,T.jsx)("div",{className:pe.heading,children:J.done?"complete":J.heading}),(0,T.jsx)("h4",{className:pe.cardTitle,children:J.title}),(0,T.jsx)("div",{className:pe.info,children:J.info})]})})},Vu=(J,pe)=>{J.preventDefault(),wl.A.get(pe.key)||wl.A.set(pe.key,!0),(0,vs.rR)("grafana_getting_started_tutorial",{title:pe.title})},Wl=(J,pe)=>({card:(0,q.css)`
      ${kr(J,pe)}
      width: 460px;
      min-width: 460px;

      ${J.breakpoints.down("xl")} {
        min-width: 368px;
      }

      ${J.breakpoints.down("lg")} {
        min-width: 272px;
      }
    `,type:(0,q.css)`
      color: ${J.colors.primary.text};
      text-transform: uppercase;
    `,heading:(0,q.css)`
      text-transform: uppercase;
      color: ${J.colors.primary.text};
      margin-bottom: ${J.spacing(1)};
    `,cardTitle:(0,q.css)`
      margin-bottom: ${J.spacing(2)};
    `,info:(0,q.css)`
      margin-bottom: ${J.spacing(2)};
    `,status:(0,q.css)`
      display: flex;
      justify-content: flex-end;
    `}),ad=({step:J})=>{const pe=(0,te.of)(_u);return(0,T.jsxs)("div",{className:pe.setup,children:[(0,T.jsxs)("div",{className:pe.info,children:[(0,T.jsx)("h2",{className:pe.title,children:J.title}),(0,T.jsx)("p",{children:J.info})]}),(0,T.jsx)("div",{className:pe.cards,children:J.cards.map((Me,Ue)=>{const ze=`${Me.title}-${Ue}`;return Me.type==="tutorial"?(0,T.jsx)(Ao,{card:Me},ze):(0,T.jsx)(ic,{card:Me},ze)})})]})},_u=J=>({setup:(0,q.css)({display:"flex",width:"95%"}),info:(0,q.css)({width:"172px",marginRight:"5%",[J.breakpoints.down("xxl")]:{marginRight:J.spacing(4)},[J.breakpoints.down("sm")]:{display:"none"}}),title:(0,q.css)({color:J.v1.palette.blue95}),cards:(0,q.css)({overflowX:"auto",overflowY:"hidden",width:"100%",display:"flex",justifyContent:"flex-start"})});var or=e(31193);const lc="Grafana fundamentals",$a="Create users and teams",Fn="getting.started.",cc=`${Fn}${lc.replace(" ","-").trim().toLowerCase()}`,dc=`${Fn}${$a.replace(" ","-").trim().toLowerCase()}`,zu=()=>[{heading:"Welcome to SyncCity",subheading:"The steps below will guide you to quickly finish setting up your Grafana installation.",title:"Basic",info:"The steps below will guide you to quickly finish setting up your Grafana installation.",done:!1,cards:[{type:"tutorial",heading:"Data source and dashboards",title:lc,info:"Set up and understand Grafana if you have no prior experience. This tutorial guides you through the entire process and covers the \u201CData source\u201D and \u201CDashboards\u201D steps to the right.",href:"https://grafana.com/tutorials/grafana-fundamentals",icon:"grafana",check:()=>Promise.resolve(wl.A.get(cc)),key:cc,done:!1},{type:"docs",title:"Add your first data source",heading:"data sources",icon:"database",learnHref:"https://grafana.com/docs/grafana/latest/features/datasources/add-a-data-source",href:"datasources/new",check:()=>new Promise(J=>{J((0,or.tR)().getMetricSources().filter(pe=>pe.meta.builtIn!==!0).length>0)}),done:!1},{type:"docs",heading:"dashboards",title:"Create your first dashboard",icon:"apps",href:"dashboard/new",learnHref:"https://grafana.com/docs/grafana/latest/guides/getting_started/#create-a-dashboard",check:async()=>(await(0,Tt.AI)().search({limit:1})).length>0,done:!1}]},{heading:"Setup complete!",subheading:"All necessary steps to use Grafana are done. Now tackle advanced steps or make the best use of this home dashboard \u2013 it is, after all, a fully customizable dashboard \u2013 and remove this panel.",title:"Advanced",info:" Manage your users and teams and add plugins. These steps are optional",done:!1,cards:[{type:"tutorial",heading:"Users",title:"Create users and teams",info:"Learn to organize your users in teams and manage resource access and roles.",href:"https://grafana.com/tutorials/create-users-and-teams",icon:"users-alt",key:dc,check:()=>Promise.resolve(wl.A.get(dc)),done:!1},{type:"docs",heading:"plugins",title:"Find and install plugins",learnHref:"https://grafana.com/docs/grafana/latest/plugins/installation",href:"plugins",icon:"plug",check:async()=>{const J=await(0,Tt.AI)().get("/api/plugins",{embedded:0,core:0});return Promise.resolve(J.length>0)},done:!1}]}];class Hu extends V.PureComponent{constructor(){super(...arguments),this.state={checksDone:!1,currentStep:0,steps:zu()},this.onForwardClick=()=>{(0,vs.rR)("grafana_getting_started_button_to_advanced_tutorials"),this.setState(pe=>({currentStep:pe.currentStep+1}))},this.onPreviousClick=()=>{(0,vs.rR)("grafana_getting_started_button_to_basic_tutorials"),this.setState(pe=>({currentStep:pe.currentStep-1}))},this.dismiss=()=>{const{id:pe}=this.props,Me=(0,He.UA)().getCurrent(),Ue=Me?.getPanelById(pe);(0,vs.rR)("grafana_getting_started_remove_panel"),Me?.removePanel(Ue),Tt.IB.put("/api/user/helpflags/1",void 0,{showSuccessAlert:!1}).then(ze=>{Fe.TP.user.helpFlags1=ze.helpFlags1})}}async componentDidMount(){const{steps:pe}=this.state,Me=pe.map(async ze=>{const tt=ze.cards.map(async bt=>bt.check().then(Lt=>({...bt,done:Lt}))),it=await Promise.all(tt);return{...ze,done:it.every(bt=>bt.done),cards:it}}),Ue=await Promise.all(Me);this.setState({currentStep:Ue[0].done?1:0,steps:Ue,checksDone:!0})}render(){const{checksDone:pe,currentStep:Me,steps:Ue}=this.state,ze=ku(),tt=Ue[Me];return(0,T.jsx)("div",{className:ze.container,children:pe?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(A.$n,{variant:"secondary",fill:"text",className:ze.dismiss,onClick:this.dismiss,children:"Remove this panel"}),Me===Ue.length-1&&(0,T.jsx)(A.$n,{className:(0,q.cx)(ze.backForwardButtons,ze.previous),onClick:this.onPreviousClick,"aria-label":"To basic tutorials",icon:"angle-left",variant:"secondary"}),(0,T.jsx)("div",{className:ze.content,children:(0,T.jsx)(ad,{step:tt})}),Me<Ue.length-1&&(0,T.jsx)(A.$n,{className:(0,q.cx)(ze.backForwardButtons,ze.forward),onClick:this.onForwardClick,"aria-label":"To advanced tutorials",icon:"angle-right",variant:"secondary"})]}):(0,T.jsxs)("div",{className:ze.loading,children:[(0,T.jsx)("div",{className:ze.loadingText,children:"Checking completed setup steps"}),(0,T.jsx)(Ku.y,{size:"xl",inline:!0})]})})}}const ku=(0,nn.N)(()=>{const J=I.$.theme2;return{container:(0,q.css)({display:"flex",flexDirection:"column",height:"100%",backgroundSize:"cover",padding:`${J.spacing(4)} ${J.spacing(2)} 0`}),content:(0,q.css)({label:"content",display:"flex",justifyContent:"center",[J.breakpoints.down("xxl")]:{marginLeft:J.spacing(3),justifyContent:"flex-start"}}),header:(0,q.css)({label:"header",marginBottom:J.spacing(3),display:"flex",flexDirection:"column",[J.breakpoints.down("lg")]:{flexDirection:"row"}}),headerLogo:(0,q.css)({height:"58px",paddingRight:J.spacing(2),display:"none",[J.breakpoints.up("md")]:{display:"block"}}),heading:(0,q.css)({label:"heading",marginRight:J.spacing(3),marginBottom:J.spacing(3),flexGrow:1,display:"flex",[J.breakpoints.up("md")]:{marginBottom:0}}),backForwardButtons:(0,q.css)({position:"absolute",top:"50%",transform:"translateY(-50%)"}),previous:(0,q.css)({left:"10px",[J.breakpoints.down("md")]:{left:0}}),forward:(0,q.css)({right:"10px",[J.breakpoints.down("md")]:{right:0}}),dismiss:(0,q.css)({alignSelf:"flex-end",textDecoration:"underline",marginBottom:J.spacing(1)}),loading:(0,q.css)({display:"flex",justifyContent:"center",alignItems:"center",height:"100%"}),loadingText:(0,q.css)({marginRight:J.spacing(1)})}}),Fl=new b.m(Hu).setNoPadding();var Ir=e(77678),uc=e(56675),fi=e(97706);const dl={bucketCount:30,bucketOffset:0},Kl={fillOpacity:80,gradientMode:rt.on.None,lineWidth:1};function rd(J,pe){return Math.floor(J/pe)*pe}function od(J,pe){return Math.ceil(J/pe)*pe}function id(J){return J.fields[0].type===jt.PU.string?1:(0,fi.h)(J.fields[1].values[0]-J.fields[0].values[0],9)}function Gu(J){return J.fields[0].type===jt.PU.string?1:(0,fi.h)(J.fields[1].values[1]-J.fields[0].values[1],9)}const Qu=(J,pe)=>{let{min:Me,max:Ue}=J.fields[2].config,ze=new es.e,tt=J.fields[0].type===jt.PU.string,it=id(J),bt=Gu(J),Lt=bt/it,Nt=bt!==it,Ht=(Rn,mn,bn,Ns,ts,Es)=>{let Hn=Rn.axes[mn]._space,jn=Rn.valToPos(Rn.data[0][0]+it,"x")-Rn.valToPos(Rn.data[0][0],"x"),is=rd(Me??Rn.data[0][0],it),Zn=od(Ue??Rn.data[0][Rn.data[0].length-1]+it,it),ps=[],Fs=Math.ceil(Hn/jn);for(let la=0,ia=is;ia<=Zn;la++,ia+=it)!(la%Fs)&&ps.push(ia);return ps};ze.addScale({scaleKey:"x",isTime:!1,distribution:tt?rt.L4.Ordinal:Nt?rt.L4.Log:rt.L4.Linear,log:2,orientation:rt.Lt.Horizontal,direction:rt.ON.Right,range:Nt?(Rn,mn,bn)=>Wa.A.rangeLog(mn,bn*Lt,2,!0):(Rn,mn,bn)=>{Me!=null&&(mn=Me),Ue!=null&&(bn=Ue);let Ns=Rn.data[0][Rn.data[0].length-1];return mn=od(mn,it),bn=!tt&&bn===Ns?bn+it:rd(bn,it),[mn,bn]}}),ze.addScale({scaleKey:"y",isTime:!1,distribution:rt.L4.Linear,orientation:rt.Lt.Vertical,direction:rt.ON.Up,softMin:0});const Xt=J.fields[0].display,cn=Rn=>(0,Gn.cN)(Xt(Rn));ze.addAxis({scaleKey:"x",isTime:!1,placement:rt.vM.Bottom,incrs:tt?[1]:Nt?void 0:Ir.rW,splits:Nt||tt?void 0:Ht,values:tt?(Rn,mn)=>mn:(Rn,mn)=>{const bn=mn.map(cn),Ns=bn.reduce((jn,is)=>Math.max((0,ys.kD)(is,Xn.pi).width,jn),0),Es=Rn.bbox.width/((Ns+10)*devicePixelRatio),Hn=Math.ceil(bn.length/Es);return bn.map((jn,is)=>is%Hn===0?jn:null)},theme:pe});let pn=J.fields[2].display;ze.addAxis({scaleKey:"y",isTime:!1,placement:rt.vM.Left,formatValue:(Rn,mn)=>(0,Gn.cN)(pn(Rn,mn)),theme:pe}),ze.setCursor({points:{show:!1},drag:{x:!0,y:!1,setScale:!0}});let zn=(0,pa.ro)(ld(J));ze.setStackingGroups(zn);let Ln=Wa.A.paths.bars({align:1,size:[1,1/0]}),Kn=0;for(let Rn=2;Rn<J.fields.length;Rn++){const mn=J.fields[Rn];mn.state=mn.state??{},mn.state.seriesIndex=Kn++;const bn={...Kl,...mn.config.custom},Ns="y",ts=(0,wa.Qi)(mn),Hn=(0,wa.lz)(mn,pe).color;ze.addSeries({scaleKey:Ns,lineWidth:bn.lineWidth,lineColor:Hn,fillOpacity:bn.fillOpacity,theme:pe,colorMode:ts,pathBuilder:Ln,show:!bn.hideFrom?.viz,gradientMode:bn.gradientMode,thresholds:mn.config.thresholds,hardMin:mn.config.min,hardMax:mn.config.max,softMin:bn.axisSoftMin,softMax:bn.axisSoftMax,dataFrameFieldIndex:mn.state.origin})}return ze},ld=J=>({...J,fields:J.fields.filter(pe=>pe.name!==Ir.dA)}),Yu=(J,pe)=>{for(let Me=1;Me<pe.fields.length;Me++){let Ue=pe.fields[Me].values;for(let ze=0;ze<Ue.length;ze++)Ue[ze]===0&&(Ue[ze]=null)}return(0,pa.bq)(pe,J.getStackingGroups())};class Ju extends V.Component{constructor(pe){super(pe),this.state=this.prepState(pe)}prepState(pe,Me=!0){const{alignedFrame:Ue}=pe,ze=Me?Qu(Ue,this.props.theme):this.state.config,tt=ld(Ue),it=Yu(ze,tt);return{alignedFrame:Ue,alignedData:it,config:ze,xMinOnlyFrame:tt}}renderLegend(pe){const{legend:Me}=this.props;if(!pe||Me.showLegend===!1)return null;const Ue=this.props.options.combine?[this.props.alignedFrame]:this.props.rawSeries;return(0,T.jsx)(No.$,{data:Ue,config:pe,maxHeight:"35%",maxWidth:"60%",...Me})}componentDidUpdate(pe){const{structureRev:Me,alignedFrame:Ue,bucketSize:ze,bucketCount:tt}=this.props;if(Ue!==pe.alignedFrame){const it=this.state.config==null||tt!==pe.bucketCount||ze!==pe.bucketSize||this.props.options!==pe.options||this.state.config===void 0||Me!==pe.structureRev||!Me,bt=this.prepState(this.props,it);this.setState(bt)}}render(){const{width:pe,height:Me,children:Ue,alignedFrame:ze}=this.props,{config:tt}=this.state;return tt?(0,T.jsx)(Ps.KU,{width:pe,height:Me,legend:this.renderLegend(tt),children:(it,bt)=>(0,T.jsx)(Zs.Z,{config:this.state.config,data:this.state.alignedData,width:it,height:bt,children:Ue?Ue(tt,ze,this.state.xMinOnlyFrame):null})}):null}}var cd=e(11389),dd=e(58749),ud=e(52415),hc=e(10875),hd=e(21164);const Xu=({series:J,xMinOnlyFrame:pe,dataIdxs:Me,seriesIdx:Ue,mode:ze=rt.$N.Single,sortOrder:tt=rt.xB.None,isPinned:it,maxHeight:bt})=>{const Lt=(0,te.of)(Zu),Nt=J.fields[0],Ht=J.fields[1],{display:Xt}=Nt.config.unit!=null?Nt:Ht,{display:cn}=Ht.config.unit!=null?Ht:Nt,Gt=(0,Gn.cN)(Xt(Nt.values[Me[0]])),pn=(0,Gn.cN)(cn(Ht.values[Me[1]])),zn=Nt.config.custom?.hideFrom?.tooltip?null:{label:"Bucket",value:`${Gt} - ${pn}`},Ln=(0,V.useMemo)(()=>(0,hc.cp)(pe.fields,Nt,Me,Ue,ze,tt),[pe.fields,Nt,Me,Ue,ze,tt]);let Kn;if(it&&Ue!=null){const Rn=J.fields[Ue],mn=Me[Ue],bn=(0,hd.u)(Rn,mn);Kn=(0,T.jsx)(dd.S,{dataLinks:bn})}return(0,T.jsxs)("div",{className:Lt.wrapper,children:[zn!=null&&(0,T.jsx)(ud.A,{item:zn,isPinned:it}),(0,T.jsx)(cd.o,{items:Ln,isPinned:it,scrollable:(0,_s.T5)({mode:ze,maxHeight:bt}),maxHeight:bt}),Kn]})},Zu=()=>({wrapper:(0,q.css)({display:"flex",flexDirection:"column"})}),qu=({data:J,options:pe,width:Me,height:Ue})=>{const ze=(0,te.$j)(),tt=(0,V.useMemo)(()=>{if(!J.series.length)return;if(J.series.forEach((Lt,Nt)=>{Lt.fields.forEach((Ht,Xt)=>{Ht.state={...Ht.state,origin:{frameIndex:Nt,fieldIndex:Xt}}})}),J.series.length===1){const Lt=(0,Ir.ix)(J.series[0]);if(Lt)return(0,Ir.cg)(Lt)}const bt=(0,Ir.p3)(J.series,pe);if(bt)return(0,Ir.cg)(bt,ze)},[J.series,pe,ze]);if(!tt||!tt.fields.length)return(0,T.jsx)("div",{className:"panel-empty",children:(0,T.jsx)("p",{children:"No histogram found in response"})});const it=id(tt);return(0,T.jsx)(Ju,{options:pe,theme:ze,legend:pe.legend,rawSeries:J.series,structureRev:J.structureRev,width:Me,height:Ue,alignedFrame:tt,bucketSize:it,bucketCount:pe.bucketCount,children:(bt,Lt,Nt)=>(0,T.jsx)(T.Fragment,{children:pe.tooltip.mode!==rt.$N.None&&(0,T.jsx)(Ms.xl,{config:bt,hoverMode:pe.tooltip.mode===rt.$N.Single?Ms.b3.xOne:Ms.b3.xAll,render:(Ht,Xt,cn,Gt=!1)=>(0,T.jsx)(Xu,{series:tt,xMinOnlyFrame:Nt,dataIdxs:Xt,seriesIdx:cn,mode:pe.tooltip.mode,sortOrder:pe.tooltip.sort,isPinned:Gt,maxHeight:pe.tooltip.maxHeight}),maxWidth:pe.tooltip.maxWidth})})})},ul={stacking:{mode:rt.gs.None,group:"A"}},fd=(J,pe,Me,Ue)=>{if(pe==="graph"&&Me.angular.xaxis?.mode==="histogram"){const{fieldConfig:tt,options:it}=eh({...Me.angular,fieldConfig:Ue});return J.fieldConfig=tt,it}return{}};function eh(J){const pe=J;let Me={};const Ue={legend:{displayMode:rt.lm.List,showLegend:!0,placement:"bottom",calcs:[]},tooltip:{mode:rt.$N.Single,sort:rt.xB.None},combine:!1};return pe.stack&&(Me.stacking={mode:pe.percentage?rt.gs.Percent:rt.gs.Normal,group:ul.stacking.group},Ue.combine=!1),{fieldConfig:{defaults:(0,N.omitBy)({custom:Me},N.isNil),overrides:[]},options:Ue}}function ei(J){if(J?.length!==1)return!1;const pe=J[0];if(pe.fields.length<3||!(0,Ir.NX)(pe.fields[0].name)||!(0,Ir.H1)(pe.fields[1].name))return!1;for(const Me of pe.fields)if(Me.type!==jt.PU.number)return!1;return!0}const th=new b.m(qu).setPanelChangeHandler(fd).setPanelOptions(J=>{J.addCustomEditor({id:"__calc__",path:"__calc__",name:"Values",description:"Showing frequencies that are calculated in the query",editor:()=>null,showIf:(pe,Me)=>ei(Me)}).addNumberInput({path:"bucketCount",name:Ir.Rt.bucketCount.name,description:Ir.Rt.bucketCount.description,settings:{placeholder:`Default: ${dl.bucketCount}`,min:0},showIf:(pe,Me)=>!ei(Me)}).addNumberInput({path:"bucketSize",name:Ir.Rt.bucketSize.name,description:Ir.Rt.bucketSize.description,settings:{placeholder:"Auto",min:0},defaultValue:dl.bucketSize,showIf:(pe,Me)=>!ei(Me)}).addNumberInput({path:"bucketOffset",name:Ir.Rt.bucketOffset.name,description:Ir.Rt.bucketOffset.description,settings:{placeholder:`Default: ${dl.bucketOffset}`,min:0},showIf:(pe,Me)=>!ei(Me)}).addBooleanSwitch({path:"combine",name:Ir.Rt.combine.name,description:Ir.Rt.combine.description,defaultValue:dl.combine,showIf:(pe,Me)=>!ei(Me)}),Yn.D(J),Wn.H(J)}).useFieldConfig({standardOptions:{[wn.uo.Color]:{settings:{byValueSupport:!1,bySeriesSupport:!0,preferThresholdsMode:!1},defaultValue:{mode:On.Y.PaletteClassic}}},useCustomConfig:J=>{const pe=Kl;J.addCustomEditor({id:"stacking",path:"stacking",name:"Stacking",category:["Histogram"],defaultValue:ul.stacking,editor:uc.m,override:uc.m,settings:{options:tn.t.stacking},process:Rt.hS,shouldApply:Me=>Me.type===jt.PU.number,showIf:(Me,Ue)=>!ei(Ue)}).addSliderInput({path:"lineWidth",name:"Line width",defaultValue:pe.lineWidth,settings:{min:0,max:10,step:1}}).addSliderInput({path:"fillOpacity",name:"Fill opacity",defaultValue:pe.fillOpacity,settings:{min:0,max:100,step:1}}).addRadio({path:"gradientMode",name:"Gradient mode",defaultValue:tn.t.fillGradient[0].value,settings:{options:tn.t.fillGradient}}),kn.e(J)}});var Gr=e(55004),hl=e(60029),nh=e(39408);const Br=[{label:"Grafana",value:Gr.qD.Grafana,description:"Core grafana live features"},{label:"Data Sources",value:Gr.qD.DataSource,description:"Data sources with live support"},{label:"Plugins",value:Gr.qD.Plugin,description:"Plugins with live support"},{label:"Stream",value:Gr.qD.Stream,description:"data streams (eg, influx style)"}];function sh(J){const[pe,Me]=(0,V.useState)([]),[Ue,ze]=(0,V.useMemo)(()=>{const cn=[],Gt=[],pn=J.value.scope,zn=J.value.namespace;if(!pn?.length)return[cn,Gt];const Ln={};for(let Kn of pe){const Rn=(0,Gr.DG)(Kn.value);!Rn||Rn.scope!==pn||(Ln[Rn.namespace]||(cn.push({value:Rn.namespace,label:Rn.namespace}),Ln[Rn.namespace]=!0),zn?.length&&zn===Rn.namespace&&Gt.push({...Kn,value:Rn.path}))}return[cn,Gt]},[pe,J.value.scope,J.value.namespace]);(0,V.useEffect)(()=>{(0,nh.l)().then(cn=>{Me(cn.channels)})},[J.value.scope]);const tt=cn=>{cn.value&&J.onChange({scope:cn.value,namespace:void 0,path:void 0})},it=cn=>{J.onChange({scope:J.value?.scope,namespace:cn?.value,path:void 0})},bt=cn=>{const{value:Gt,onChange:pn}=J;pn({scope:Gt.scope,namespace:Gt.namespace,path:cn?.value})},{scope:Lt,namespace:Nt,path:Ht}=J.value,Xt=rh(ce.config.theme2);return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(re.F,{title:"Grafana Live",severity:"info",children:"This supports real-time event streams in grafana core. This feature is under heavy development. Expect the intefaces and structures to change as this becomes more production ready."}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("div",{className:Xt.dropWrap,children:[(0,T.jsx)(hl.J,{children:"Scope"}),(0,T.jsx)(K.l6,{options:Br,value:Br.find(cn=>cn.value===Lt),onChange:tt})]}),Lt&&(0,T.jsxs)("div",{className:Xt.dropWrap,children:[(0,T.jsx)(hl.J,{children:"Namespace"}),(0,T.jsx)(K.l6,{options:Ue,value:Ue.find(cn=>cn.value===Nt)??(Nt?{label:Nt,value:Nt}:void 0),onChange:it,allowCustomValue:!0,backspaceRemovesValue:!0,isClearable:!0})]}),Lt&&Nt&&(0,T.jsxs)("div",{className:Xt.dropWrap,children:[(0,T.jsx)(hl.J,{children:"Path"}),(0,T.jsx)(K.l6,{options:ze,value:ah(ze,Ht),onChange:bt,allowCustomValue:!0,backspaceRemovesValue:!0,isClearable:!0})]})]})]})}function ah(J,pe){const Me=J.find(Ue=>Ue.value===pe);if(Me)return Me;if(pe)return{label:pe,value:pe}}const rh=(0,nn.N)(J=>({dropWrap:(0,q.css)`
    margin-bottom: ${J.spacing(1)};
  `}));var oh=e(9631),ih=e(90708),gd=e(39070),gi=e(78731),lh=e(24022),Ai=e(94624),pi=e(1173),ch=e(77093),$l=e(65885);function pd(J){const{data:pe,height:Me,width:Ue,options:ze,fieldConfig:tt,id:it,timeRange:bt}=J,Lt=(0,te.$j)(),Nt=(0,da.d2)(),Ht=(0,$l.gy)(pe.series)?(0,$l.S5)(pe.series):pe.series,Xt=Ht?.length,cn=Ht.some(mn=>mn.fields.length>0),Gt=dh(Ht,ze),pn=Ht[Gt];let zn=Me;if(!Xt||!cn)return(0,T.jsx)(fs.a,{panelId:it,fieldConfig:tt,data:pe});if(Xt>1){const mn=Lt.spacing.gridSize*Lt.components.height.md,bn=Lt.spacing.gridSize;zn=Me-mn-bn}const Ln=Nt.sync&&Nt.sync()!==Ai.y.Off,Kn=(0,T.jsx)(ch.X,{height:zn,width:Ue,data:pn,noHeader:!ze.showHeader,showTypeIcons:ze.showTypeIcons,resizable:!0,initialSortBy:ze.sortBy,onSortByChange:mn=>hh(mn,J),onColumnResize:(mn,bn)=>uh(mn,bn,J),onCellFilterAdded:Nt.onAddAdHocFilter,footerOptions:ze.footer,enablePagination:ze.footer?.enablePagination,cellHeight:ze.cellHeight,timeRange:bt,enableSharedCrosshair:I.$.featureToggles.tableSharedCrosshair&&Ln,fieldConfig:tt});if(Xt===1)return Kn;const Rn=Ht.map((mn,bn)=>({label:(0,en.Ri)(mn),value:bn}));return(0,T.jsxs)("div",{className:md.wrapper,children:[Kn,(0,T.jsx)("div",{className:md.selectWrapper,children:(0,T.jsx)(K.l6,{options:Rn,value:Rn[Gt],onChange:mn=>fh(mn,J)})})]})}function dh(J,pe){return pe.frameIndex>0&&pe.frameIndex<J.length?pe.frameIndex:0}function uh(J,pe,Me){const{fieldConfig:Ue}=Me,{overrides:ze}=Ue,tt=pi.Ct.byName,it="custom.width",bt=ze.find(Lt=>Lt.matcher.id===tt&&Lt.matcher.options===J);if(bt){const Lt=bt.properties.find(Nt=>Nt.id===it);Lt?Lt.value=pe:bt.properties.push({id:it,value:pe})}else ze.push({matcher:{id:tt,options:J},properties:[{id:it,value:pe}]});Me.onFieldConfigChange({...Ue,overrides:ze})}function hh(J,pe){pe.onOptionsChange({...pe.options,sortBy:J})}function fh(J,pe){pe.onOptionsChange({...pe.options,frameIndex:J.value||0})}const md={wrapper:(0,q.css)`
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    height: 100%;
  `,selectWrapper:(0,q.css)`
    padding: 8px 8px 0px 8px;
  `};var fc=e(32372),Vo=(J=>(J.Raw="raw",J.JSON="json",J.Auto="auto",J.None="none",J))(Vo||{}),Ro=(J=>(J.None="none",J.JSON="json",J.Influx="influx",J))(Ro||{});function gh({height:J,mode:pe,body:Me,addr:Ue,onSave:ze}){const tt=(0,V.useMemo)(()=>pe===Ro.JSON?Me?JSON.stringify(Me,null,2):"{ }":Me==null?"":`${Me}`,[pe,Me]),it=Lt=>{pe===Ro.JSON?ze(JSON.parse(Lt)):ze(Lt)},bt=async()=>{if(pe===Ro.Influx){if(Ue?.scope!=="stream"){alert("expected stream scope!");return}return(0,Nn.AI)().post(`api/live/push/${Ue.namespace}`,Me)}if(!(0,Gr.aj)(Ue)){alert("invalid address");return}const Lt=await(0,gi.oF)().publish(Ue,Me);console.log("onPublishClicked (response from publish)",Lt)};return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(fc.B,{height:J-32,language:pe===Ro.JSON?"json":"text",value:tt,onBlur:it,onSave:it,showMiniMap:!1,showLineNumbers:!0}),(0,T.jsx)("div",{style:{height:32},children:(0,T.jsx)(A.$n,{onClick:bt,children:"Publish"})})]})}class Bs extends V.PureComponent{constructor(pe){super(pe),this.styles=br(I.$.theme2),this.streamObserver={next:Me=>{(0,Gr.ew)(Me)?this.setState({status:Me,changed:Date.now()}):(0,Gr.Z7)(Me)?this.setState({message:Me.message,changed:Date.now()}):console.log("ignore",Me)}},this.unsubscribe=()=>{this.subscription&&(this.subscription.unsubscribe(),this.subscription=void 0)},this.isValid=!!(0,gi.oF)(),this.state={changed:0}}async componentDidMount(){this.loadChannel()}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe()}componentDidUpdate(pe){this.props.options?.channel!==pe.options?.channel&&this.loadChannel()}async loadChannel(){const pe=this.props.options?.channel;if(!(0,Gr.aj)(pe)){console.log("INVALID",pe),this.unsubscribe(),this.setState({addr:void 0});return}if((0,N.isEqual)(pe,this.state.addr)){console.log("Same channel",this.state.addr);return}const Me=(0,gi.oF)();if(!Me){console.log("INVALID",pe),this.unsubscribe(),this.setState({addr:void 0});return}this.unsubscribe(),console.log("LOAD",pe);try{this.subscription=Me.getStream(pe).subscribe(this.streamObserver),this.setState({addr:pe,error:void 0})}catch(Ue){this.setState({addr:void 0,error:Ue})}}renderNotEnabled(){return(0,T.jsxs)(re.F,{title:"Grafana Live",severity:"info",children:[(0,T.jsx)("p",{children:"Grafana live requires a feature flag to run"}),(0,T.jsx)("b",{children:"custom.ini:"}),(0,T.jsx)("pre",{children:`[feature_toggles]
    enable = live`})]})}renderMessage(pe){const{options:Me}=this.props,{message:Ue}=this.state;if(!Ue)return(0,T.jsxs)("div",{children:[(0,T.jsx)("h4",{children:"Waiting for data:"}),Me.channel?.scope,"/",Me.channel?.namespace,"/",Me.channel?.path]});if(Me.display===Vo.JSON)return(0,T.jsx)(lh.B,{json:Ue,open:5});if(Me.display===Vo.Auto&&Ue instanceof oh.k9){const ze={series:(0,ih.we)({data:[Ue],theme:I.$.theme2,replaceVariables:it=>it,fieldConfig:{defaults:{},overrides:[]}}),state:gd.Gu.Streaming},tt={...this.props,options:{frameIndex:0,showHeader:!0}};return(0,T.jsx)(pd,{...tt,data:ze,height:pe})}return(0,T.jsx)("pre",{children:JSON.stringify(Ue)})}renderPublish(pe){const{options:Me}=this.props;return(0,T.jsx)(gh,{height:pe,body:Me.message,mode:Me.publish??Ro.JSON,onSave:Ue=>this.props.onOptionsChange({...Me,message:Ue}),addr:this.state.addr})}renderStatus(){const{status:pe}=this.state;if(pe?.state===Gr.ZF.Connected)return;let Me="";return pe&&(Me=this.styles.status[pe.state]),(0,T.jsx)("div",{className:(0,q.cx)(Me,this.styles.statusWrap),children:pe?.state})}renderBody(){const{status:pe}=this.state,{options:Me,height:Ue}=this.props;if(Me.publish===Ro.JSON||Me.publish===Ro.Influx){if(Me.display===Vo.None)return this.renderPublish(Ue);const tt=Ue/2;return(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{style:{height:tt,overflow:"hidden"},children:(0,T.jsx)(le.E,{autoHeightMin:"100%",autoHeightMax:"100%",children:this.renderMessage(tt)})}),(0,T.jsx)("div",{children:this.renderPublish(tt)})]})}return Me.display===Vo.None?(0,T.jsx)("pre",{children:JSON.stringify(pe)}):(0,T.jsx)("div",{style:{overflow:"hidden",height:Ue},children:(0,T.jsx)(le.E,{autoHeightMin:"100%",autoHeightMax:"100%",children:this.renderMessage(Ue)})})}render(){if(!this.isValid)return this.renderNotEnabled();const{addr:pe,error:Me}=this.state;return pe?Me?(0,T.jsxs)("div",{children:[(0,T.jsx)("h2",{children:"ERROR"}),(0,T.jsx)("div",{children:JSON.stringify(Me)})]}):(0,T.jsxs)(T.Fragment,{children:[this.renderStatus(),this.renderBody()]}):(0,T.jsx)(re.F,{title:"Grafana Live",severity:"info",children:"Use the panel editor to pick a channel"})}}const br=(0,nn.N)(J=>({statusWrap:(0,q.css)`
    margin: auto;
    position: absolute;
    top: 0;
    right: 0;
    background: ${J.components.panel.background};
    padding: 10px;
    z-index: ${J.zIndex.modal};
  `,status:{[Gr.ZF.Pending]:(0,q.css)`
      border: 1px solid ${J.v1.palette.orange};
    `,[Gr.ZF.Connected]:(0,q.css)`
      border: 1px solid ${J.colors.success.main};
    `,[Gr.ZF.Connecting]:(0,q.css)`
      border: 1px solid ${J.v1.palette.brandWarning};
    `,[Gr.ZF.Disconnected]:(0,q.css)`
      border: 1px solid ${J.colors.warning.main};
    `,[Gr.ZF.Shutdown]:(0,q.css)`
      border: 1px solid ${J.colors.error.main};
    `,[Gr.ZF.Invalid]:(0,q.css)`
      border: 1px solid red;
    `}})),ph=new b.m(Bs).setPanelOptions(J=>{J.addCustomEditor({category:["Channel"],id:"channel",path:"channel",name:"Channel",editor:sh,defaultValue:{}}),J.addRadio({path:"display",name:"Show Message",description:"Display the last message received on this channel",settings:{options:[{value:Vo.Raw,label:"Raw Text"},{value:Vo.JSON,label:"JSON"},{value:Vo.Auto,label:"Auto"},{value:Vo.None,label:"None"}]},defaultValue:Vo.JSON}).addRadio({path:"publish",name:"Publish",description:"Display a form to publish values",settings:{options:[{value:Ro.None,label:"None"},{value:Ro.JSON,label:"JSON"},{value:Ro.Influx,label:"Influx"}]},defaultValue:Ro.None})});var er=e(9557),gc=e(96192),Ji=e(81166),mh=e(17888),vh=e(7030),yh=e(93463),Xi=e(14647),Ri=e(69147);function fl(J){return typeof J=="function"}function Vl(J){return typeof J=="function"}function pc(J){return typeof J=="function"}function xh(J){return typeof J=="function"}function vd(J){return typeof J=="function"}var yd=e(16817),xd=e(19347);const Eh=J=>{const[pe,Me]=(0,V.useState)(new Map);return(0,yd.A)(async()=>{if(!J){Me(new Map);return}const Ue=await Promise.all(J.filter(ze=>!!ze.datasource?.uid).map(ze=>(0,xd.l)().get(ze.datasource?.uid).then(tt=>({key:ze.refId,ds:tt}))));Me(new Map(Ue.map(({key:ze,ds:tt})=>[ze,tt])))},[J]),pe},Dh={},Ph=({data:J,timeZone:pe,fieldConfig:Me,options:{showLabels:Ue,showTime:ze,wrapLogMessage:tt,showCommonLabels:it,prettifyLogMessage:bt,sortOrder:Lt,dedupStrategy:Nt,enableLogDetails:Ht,showLogContextToggle:Xt,onClickFilterLabel:cn,onClickFilterOutLabel:Gt,onClickFilterOutString:pn,onClickFilterString:zn,isFilterLabelActive:Ln},id:Kn})=>{const Rn=Lt===rt.uH.Ascending,mn=(0,te.of)(bh),[bn,Ns]=(0,V.useState)(0),ts=(0,V.useRef)(null),[Es,Hn]=(0,V.useState)(null),jn=J.timeRange,is=Eh(J.request?.targets),[Zn,ps]=(0,V.useState)(null);let Fs=(0,V.useRef)();const{eventBus:la,onAddAdHocFilter:ia}=(0,da.d2)(),Na=(0,V.useCallback)(Vn=>{Vn?la.publish(new un.b_({point:{time:Vn.timeEpochMs}})):la.publish(new un.ql)},[la]),aa=(0,V.useCallback)(()=>{Hn(null),Fs.current&&Fs.current()},[Fs]),Ts=(0,V.useCallback)((Vn,ls)=>{Hn(Vn),Fs.current=ls},[Fs]),Is=(0,V.useCallback)(async Vn=>await Th(Vn,jn),[jn]),ba=(0,V.useCallback)(Vn=>{if(!Vn.dataFrame.refId||!is||!Xt&&J.request?.app!==S.Jk.Dashboard&&J.request?.app!==S.Jk.PanelEditor&&J.request?.app!==S.Jk.PanelViewer)return!1;const ls=is.get(Vn.dataFrame.refId);return(0,er.Ol)(ls)},[is,Xt,J.request?.app]),Va=(0,V.useCallback)(()=>!(J.request?.app!==S.Jk.Dashboard&&J.request?.app!==S.Jk.PanelEditor&&J.request?.app!==S.Jk.PanelViewer),[J.request?.app]),Vs=(0,V.useCallback)(async(Vn,ls,sa)=>{if(!ls.dataFrame.refId||!is)return Promise.resolve({data:[]});const Qs=J.request?.targets[0];if(!Qs)return Promise.resolve({data:[]});const ca=is.get(ls.dataFrame.refId);return(0,er.Ol)(ca)?ca.getLogRowContext(Vn,sa,Qs):Promise.resolve({data:[]})},[J.request?.targets,is]),Rs=(0,V.useCallback)((Vn,ls)=>{if(!Vn.dataFrame.refId||!is)return(0,T.jsx)(T.Fragment,{});const sa=J.request?.targets[0];if(!sa)return(0,T.jsx)(T.Fragment,{});const Qs=is.get(Vn.dataFrame.refId);return(0,er.wj)(Qs)?Qs.getLogRowContextUi?Qs.getLogRowContextUi(Vn,ls,sa):(0,T.jsx)(T.Fragment,{}):(0,T.jsx)(T.Fragment,{})},[J.request?.targets,is]),[ra,Da,ga]=(0,V.useMemo)(()=>{const Vn=J?(0,Ri.HT)(J.series,J.request?.intervalMs,void 0,J.request?.targets):null,ls=Vn?.rows||[],sa=Vn?.meta?.find(ca=>ca.label===Ri.yR),Qs=(0,Ri.M0)(ls,Nt);return[ls,Qs,sa]},[J,Nt]);(0,V.useLayoutEffect)(()=>{Rn&&ts.current?Ns(ts.current.offsetHeight):Ns(0)},[Rn,ra]);const Ia=(0,V.useCallback)((Vn,ls)=>(0,gc.QL)({field:Vn,rowIndex:ls,range:J.timeRange}),[J]),Ha=(0,V.useCallback)(Vn=>{Zn?.scrollTo({top:Vn.offsetTop,behavior:"smooth"})},[Zn]),xa=(0,V.useCallback)((Vn,ls)=>{ia?.({key:Vn,value:ls,operator:"="})},[ia]),Qa=(0,V.useCallback)((Vn,ls)=>{ia?.({key:Vn,value:ls,operator:"!="})},[ia]);if(!J||ra.length===0)return(0,T.jsx)(mh.a,{fieldConfig:Me,panelId:Kn,data:J,needsStringField:!0});const Ya=()=>(0,T.jsxs)("div",{className:(0,q.cx)(mn.labelContainer,Rn&&mn.labelContainerAscending),children:[(0,T.jsx)("span",{className:mn.label,children:"Common labels:"}),(0,T.jsx)(yh.h,{labels:typeof ga?.value=="object"?ga?.value:Dh,emptyMessage:"(no common labels)"})]}),cr=ia?xa:void 0,ms=ia?Qa:void 0;return(0,T.jsxs)(T.Fragment,{children:[Es&&(0,T.jsx)(Ji.V,{open:Es!==null,row:Es,onClose:aa,getRowContext:(Vn,ls)=>Vs(Vn,Es,ls),logsSortOrder:Lt,timeZone:pe,getLogRowContextUi:Rs}),(0,T.jsx)(le.E,{autoHide:!0,scrollTop:bn,scrollRefCallback:Vn=>ps(Vn),children:(0,T.jsxs)("div",{className:mn.container,ref:ts,children:[it&&!Rn&&Ya(),(0,T.jsx)(Xi.k,{containerRendered:ts.current!==null,scrollIntoView:Ha,permalinkedRowId:Ch()?.logs?.id??void 0,onPermalinkClick:Va()?Is:void 0,logRows:ra,showContextToggle:ba,deduplicatedRows:Da,dedupStrategy:Nt,showLabels:Ue,showTime:ze,wrapLogMessage:tt,prettifyLogMessage:bt,timeZone:pe,getFieldLinks:Ia,logsSortOrder:Lt,enableLogDetails:Ht,previewLimit:Rn?ra.length:void 0,onLogRowHover:Na,app:S.Jk.Dashboard,onOpenContext:Ts,onClickFilterLabel:fl(cn)?cn:cr,onClickFilterOutLabel:Vl(Gt)?Gt:ms,onClickFilterString:pc(zn)?zn:void 0,onClickFilterOutString:xh(pn)?pn:void 0,isFilterLabelActive:vd(Ln)?Ln:void 0}),it&&Rn&&Ya()]})})]})},bh=J=>({container:(0,q.css)({marginBottom:J.spacing(1.5)}),labelContainer:(0,q.css)({margin:J.spacing(0,0,.5,.5),display:"flex",alignItems:"center"}),labelContainerAscending:(0,q.css)({margin:J.spacing(.5,0,.5,0)}),label:(0,q.css)({marginRight:J.spacing(.5),fontSize:J.typography.bodySmall.fontSize,fontWeight:J.typography.fontWeightMedium})});function Ch(){const pe=Si.kM.getUrlSearchParams()?.panelState;if(pe&&Array.isArray(pe)&&pe?.length>0&&typeof pe[0]=="string")try{return JSON.parse(pe[0])}catch(Me){console.error("error parsing logsPanelState",Me)}}async function Th(J,pe){if(J.rowId===void 0||!J.dataFrame.refId)return;const Me={logs:{id:J.uid}},Ue=new URL(window.location.href);return Ue.searchParams.set("panelState",JSON.stringify(Me)),Ue.searchParams.set("from",(0,hn.yT)(pe.from).valueOf().toString(10)),Ue.searchParams.set("to",(0,hn.yT)(pe.to).valueOf().toString(10)),await(0,vh.VP)(Ue.toString()),Promise.resolve()}class gl{getSuggestionsForData(pe){const Me=pe.getListAppender({name:"",pluginId:"logs",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]}}),{dataSummary:Ue}=pe;!Ue.hasData||!Ue.hasTimeField||!Ue.hasStringField||(Ue.preferredVisualisationType==="logs"?Me.append({name:xs.m.Logs,score:Ot.nQ.Best}):Me.append({name:xs.m.Logs}))}}const pl=new b.m(Ph).setPanelOptions(J=>{J.addBooleanSwitch({path:"showTime",name:"Time",description:"",defaultValue:!1}).addBooleanSwitch({path:"showLabels",name:"Unique labels",description:"",defaultValue:!1}).addBooleanSwitch({path:"showCommonLabels",name:"Common labels",description:"",defaultValue:!1}).addBooleanSwitch({path:"wrapLogMessage",name:"Wrap lines",description:"",defaultValue:!1}).addBooleanSwitch({path:"prettifyLogMessage",name:"Prettify JSON",description:"",defaultValue:!1}).addBooleanSwitch({path:"enableLogDetails",name:"Enable log details",description:"",defaultValue:!0}).addRadio({path:"dedupStrategy",name:"Deduplication",description:"",settings:{options:[{value:rt.fY.none,label:"None",description:er._C[rt.fY.none]},{value:rt.fY.exact,label:"Exact",description:er._C[rt.fY.exact]},{value:rt.fY.numbers,label:"Numbers",description:er._C[rt.fY.numbers]},{value:rt.fY.signature,label:"Signature",description:er._C[rt.fY.signature]}]},defaultValue:rt.fY.none}).addRadio({path:"sortOrder",name:"Order",description:"",settings:{options:[{value:rt.uH.Descending,label:"Newest first"},{value:rt.uH.Ascending,label:"Oldest first"}]},defaultValue:rt.uH.Descending})}).setSuggestionsSupplier(new gl);var Mh=e(69386),Ed=e(62372),mc=e(4172);function Sh(J){const{width:pe,options:{feedUrl:Me=Ed.$,showImage:Ue}}=J,{state:ze,getNews:tt}=(0,mc.n)(Me);return(0,V.useEffect)(()=>{const it=J.eventBus.subscribe(z._,tt);return()=>{it.unsubscribe()}},[tt,J.eventBus]),(0,V.useEffect)(()=>{tt()},[tt]),ze.error?(0,T.jsxs)(re.F,{title:"Error loading RSS feed",children:["Make sure that the feed URL is correct and that CORS is configured correctly on the server. See"," ",(0,T.jsxs)("a",{style:{textDecoration:"underline"},href:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/news/",children:["News panel documentation. ",(0,T.jsx)(H.I,{name:"external-link-alt"})]})]}):ze.loading?(0,T.jsx)("div",{children:"Loading..."}):ze.value?(0,T.jsx)(le.E,{autoHeightMin:"100%",autoHeightMax:"100%",children:ze.value.map((it,bt)=>(0,T.jsx)(Mh.K,{index:bt,width:pe,showImage:Ue,data:ze.value},bt))}):null}const vc={showImage:!0},Oh=new b.m(Sh).setPanelOptions(J=>{J.addTextInput({path:"feedUrl",name:"URL",description:"Supports RSS and Atom feeds",settings:{placeholder:Ed.$},defaultValue:vc.feedUrl}).addBooleanSwitch({path:"showImage",name:"Show image",description:"Controls if the news item social (og:image) image is shown above text content",defaultValue:vc.showImage})});var Ih=e(56323),Ah=e(29995),Rh=e(89227),Lh=e(98361),jh=e(33434),Bh=e(44916),Uh=e(4118),Nh=e(35472),yc=e(84140),wh=e(59796),Dd=e(3139),Pd=e(16797);let Wh=0;const Fh=()=>Wh++;function Kh(J){const pe=(0,V.useRef)(null);return pe.current===null&&(pe.current=J+Fh()),pe.current.toString()}var _o=(J=>(J.Donut="donut",J.Pie="pie",J))(_o||{}),eo=(J=>(J.Name="name",J.Percent="percent",J.Value="value",J))(eo||{}),Po=(J=>(J.Percent="percent",J.Value="value",J))(Po||{});const vp={values:[]},yp={displayLabels:[]};function bd(J){return!J.field.custom?.hideFrom?.viz&&!isNaN(J.display.numeric)}function Cd(J,pe){return pe.display.numeric+J}const $h=({fieldDisplayValues:J,pieType:pe,width:Me,height:Ue,highlightedTitle:ze,displayLabels:tt=[],tooltipOptions:it})=>{const bt=(0,te.$j)(),Lt=Kh("PieChart"),Nt=(0,te.of)(ml),Ht=(0,Uh.A)(),{containerRef:Xt,TooltipInPortal:cn}=(0,Nh.A)({detectBounds:!0,scroll:!0}),Gt=J.filter(bd),pn=ts=>ts.display.numeric,zn=ts=>`${Lt}-${(0,yc.A)(ts).toHex()}`,Ln=ts=>`url(#${zn(ts)})`,Kn=tt.length>0,Rn=it.mode!=="none"&&Ht.tooltipOpen,mn=Gt.reduce(Cd,0),bn=kh(Me,Ue,pe),Ns=[...new Set(Gt.map(ts=>ts.display.color??On.F))];return(0,T.jsxs)("div",{className:Nt.container,children:[(0,T.jsx)("svg",{width:bn.size,height:bn.size,ref:Xt,style:{overflow:"visible"},children:(0,T.jsxs)(jh.A,{top:bn.position,left:bn.position,children:[Ns.map(ts=>(0,T.jsx)(Lh.A,{id:zn(ts),from:xc(ts,bt),to:Hh(ts,bt),fromOffset:bn.gradientFromOffset,toOffset:"1",gradientUnits:"userSpaceOnUse",cx:0,cy:0,radius:bn.outerRadius},ts)),(0,T.jsx)(Bh.A,{data:Gt,pieValue:pn,outerRadius:bn.outerRadius,innerRadius:bn.innerRadius,cornerRadius:3,padAngle:.005,children:ts=>(0,T.jsxs)(T.Fragment,{children:[ts.arcs.map(Es=>{const Hn=Es.data.display.color??On.F,jn=_l(ze,Es);return Es.data.hasLinks&&Es.data.getLinks?(0,T.jsx)(wh.e,{links:Es.data.getLinks,children:is=>(0,T.jsx)(Td,{tooltip:Ht,highlightState:jn,arc:Es,pie:ts,fill:Ln(Hn),openMenu:is.openMenu,tooltipOptions:it})},Es.index):(0,T.jsx)(Td,{highlightState:jn,tooltip:Ht,arc:Es,pie:ts,fill:Ln(Hn),tooltipOptions:it},Es.index)}),Kn&&ts.arcs.map(Es=>{const Hn=_l(ze,Es);return(0,T.jsx)(Vh,{arc:Es,highlightState:Hn,outerRadius:bn.outerRadius,innerRadius:bn.innerRadius,displayLabels:tt,total:mn,color:bt.colors.text.primary},Es.index)})]})})]})}),Rn?(0,T.jsx)(cn,{top:Ht.tooltipTop,className:Nt.tooltipPortal,left:Ht.tooltipLeft,unstyled:!0,applyPositionStyle:!0,children:(0,T.jsx)(Dd.o,{series:Ht.tooltipData})},Math.random()):null]})};function Td({arc:J,pie:pe,highlightState:Me,openMenu:Ue,fill:ze,tooltip:tt,tooltipOptions:it}){const bt=(0,te.$j)(),Lt=(0,te.of)(ml),{eventBus:Nt}=(0,da.d2)(),Ht=(0,V.useCallback)(Gt=>{Nt?.publish({type:un.ql.type,payload:{raw:Gt,x:0,y:0,dataId:J.data.display.title}}),tt.hideTooltip()},[Nt,J,tt]),Xt=(0,V.useCallback)(Gt=>{Nt?.publish({type:un.b_.type,payload:{raw:Gt,x:0,y:0,dataId:J.data.display.title}});const pn=Gt.currentTarget.ownerSVGElement;if(pn){const zn=(0,Rh.A)(pn,Gt);tt.showTooltip({tooltipLeft:zn.x,tooltipTop:zn.y,tooltipData:_h(pe,J,it)})}},[Nt,J,tt,pe,it]),cn=Md(Me,Lt);return(0,T.jsx)("g",{className:cn,onMouseMove:it.mode!=="none"?Xt:void 0,onMouseOut:Ht,onClick:Ue,"data-testid":sr.Tp.components.Panels.Visualization.PieChart.svgSlice,children:(0,T.jsx)("path",{d:pe.path({...J}),fill:ze,stroke:bt.colors.background.primary,strokeWidth:1})},J.data.display.title)}function Vh({arc:J,outerRadius:pe,innerRadius:Me,displayLabels:Ue,total:ze,color:tt,highlightState:it}){const bt=(0,te.of)(ml),Lt=Me===0?pe/6:Me,[Nt,Ht]=zh(J,pe,Lt);if(!(J.endAngle-J.startAngle>=.3))return null;let cn=Ue.includes(eo.Name)?Math.min(Math.max(pe/150*14,12),30):Math.min(Math.max(pe/100*14,12),36);return(0,T.jsx)("g",{className:Md(it,bt),children:(0,T.jsxs)("text",{fill:tt,x:Nt,y:Ht,dy:".33em",fontSize:cn,fontWeight:500,textAnchor:"middle",pointerEvents:"none",children:[Ue.includes(eo.Name)&&(0,T.jsx)("tspan",{x:Nt,dy:"1.2em",children:J.data.display.title}),Ue.includes(eo.Value)&&(0,T.jsx)("tspan",{x:Nt,dy:"1.2em",children:(0,Gn.cN)(J.data.display)}),Ue.includes(eo.Percent)&&(0,T.jsx)("tspan",{x:Nt,dy:"1.2em",children:(J.data.display.numeric/ze*100).toFixed(J.data.field.decimals??0)+"%"})]})})}function _h(J,pe,Me){return Me.mode==="multi"?J.arcs.filter(Ue=>{const ze=Ue.data.field;return ze&&!ze.custom?.hideFrom?.tooltip&&!ze.custom?.hideFrom?.viz}).map(Ue=>({color:Ue.data.display.color??On.F,label:Ue.data.display.title,value:(0,Gn.cN)(Ue.data.display),isActive:Ue.index===pe.index})):[{color:pe.data.display.color??On.F,label:pe.data.display.title,value:(0,Gn.cN)(pe.data.display)}]}function zh(J,pe,Me){const Ue=(pe+Me)/2,ze=(+J.startAngle+ +J.endAngle)/2-Math.PI/2;return[Math.cos(ze)*Ue,Math.sin(ze)*Ue]}function xc(J,pe){return(0,yc.A)(J).darken(20*(pe.isDark?1:-.7)).spin(4).toRgbString()}function Hh(J,pe){return(0,yc.A)(J).darken(10*(pe.isDark?1:-.7)).spin(-4).toRgbString()}function kh(J,pe,Me,Ue=16){const ze=Math.min(pe,J),tt=(ze-Ue*2)/2,it=Me===_o.Pie?tt:Math.max(tt/3,20),bt=tt-it,Lt=(ze-Ue*2)/2,Nt=1-(tt-bt)/tt;return{position:Lt+Ue,size:ze,outerRadius:tt,innerRadius:bt,gradientFromOffset:Nt}}var Gh=(J=>(J[J.Highlighted=0]="Highlighted",J[J.Deemphasized=1]="Deemphasized",J[J.Normal=2]="Normal",J))(Gh||{});function _l(J,pe){return J?J===pe.data.display.title?0:1:2}function Md(J,pe){switch(J){case 0:return pe.svgArg.highlighted;case 1:return pe.svgArg.deemphasized;case 2:default:return pe.svgArg.normal}}const ml=J=>({container:(0,q.css)`
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
    `,svgArg:{normal:(0,q.css)`
        transition: all 200ms ease-in-out;
      `,highlighted:(0,q.css)`
        transition: all 200ms ease-in-out;
        transform: scale3d(1.03, 1.03, 1);
      `,deemphasized:(0,q.css)`
        transition: all 200ms ease-in-out;
        fill-opacity: 0.5;
      `},tooltipPortal:(0,q.css)`
      ${(0,Pd.getTooltipContainerStyles)(J)}
    `}),Qh={displayMode:rt.lm.List,showLegend:!0,placement:"right",calcs:[],values:[Po.Percent]};function Yh(J){const{data:pe,timeZone:Me,fieldConfig:Ue,replaceVariables:ze,width:tt,height:it,options:bt,id:Lt}=J,Nt=(0,te.$j)(),Ht=Ec(),Xt=(0,Ih.PI)({fieldConfig:Ue,reduceOptions:bt.reduceOptions,data:pe.series,theme:Nt,replaceVariables:ze,timeZone:Me});return Jh(Xt)?(0,T.jsx)(Ps.KU,{width:tt,height:it,legend:zo(J,Xt),children:(cn,Gt)=>(0,T.jsx)($h,{width:cn,height:Gt,highlightedTitle:Ht,fieldDisplayValues:Xt,tooltipOptions:bt.tooltip,pieType:bt.pieType,displayLabels:bt.displayLabels})}):(0,T.jsx)(fs.a,{panelId:Lt,fieldConfig:Ue,data:pe})}function zo(J,pe){const Me=J.options.legend??Qh;if(Me.showLegend===!1)return;const Ue=pe.filter(bd).reduce(Cd,0),ze=pe.sort((tt,it)=>isNaN(tt.display.numeric)?1:isNaN(it.display.numeric)?-1:it.display.numeric-tt.display.numeric).map((tt,it)=>{const bt=tt.field.custom?.hideFrom??{};if(bt.legend)return;const Lt=!!bt.viz,Nt=tt.display;return{label:Nt.title??"",color:Nt.color??On.F,yAxis:1,disabled:Lt,getItemKey:()=>(Nt.title??"")+it,getDisplayValues:()=>{const Ht=Me.values??[];let Xt=[];if(Ht.includes(Po.Value)&&Xt.push({numeric:Nt.numeric,text:(0,Gn.cN)(Nt),title:"Value"}),Ht.includes(Po.Percent)){const cn=Lt?0:Nt.numeric/Ue,Gt=cn*100;Xt.push({numeric:cn,percent:Gt,text:Lt||isNaN(cn)?J.fieldConfig.defaults.noValue??"-":Gt.toFixed(tt.field.decimals??0)+"%",title:Ht.length>1?"Percent":""})}return Xt}}}).filter(tt=>!!tt);return(0,T.jsx)(Ps.KU.Legend,{placement:Me.placement,width:Me.width,children:(0,T.jsx)(Xa.t,{items:ze,seriesVisibilityChangeBehavior:Ah.K.Hide,placement:Me.placement,displayMode:Me.displayMode})})}function Jh(J){return J.some(pe=>pe.view?.dataFrame.length)}function Ec(){const[J,pe]=(0,V.useState)(),{eventBus:Me}=(0,da.d2)();return(0,V.useEffect)(()=>{const Ue=it=>{pe(it.payload.dataId)},ze=it=>{pe(void 0)},tt=new yt.yU;return tt.add(Me.getStream(un.b_).subscribe({next:Ue})),tt.add(Me.getStream(un.ql).subscribe({next:ze})),()=>{tt.unsubscribe()}},[pe,Me]),J}const Li=(J,pe,Me)=>{if(pe==="grafana-piechart-panel"&&Me.angular){const Ue=Me.angular,ze=[];let tt=J.options;if(Ue.aliasColors)for(const it of Object.keys(Ue.aliasColors)){const bt=Ue.aliasColors[it];bt&&ze.push({matcher:{id:pi.Ct.byName,options:it},properties:[{id:wn.uo.Color,value:{mode:On.Y.Fixed,fixedColor:bt}}]})}if(J.fieldConfig={overrides:ze,defaults:{unit:Ue.format,decimals:Ue.decimals?Ue.decimals:0}},tt.legend={placement:"right",values:[],displayMode:rt.lm.Table,showLegend:!0,calcs:[]},Ue.valueName)switch(tt.reduceOptions={calcs:[]},Ue.valueName){case"current":tt.reduceOptions.calcs=["lastNotNull"];break;case"min":tt.reduceOptions.calcs=["min"];break;case"max":tt.reduceOptions.calcs=["max"];break;case"avg":tt.reduceOptions.calcs=["mean"];break;case"total":tt.reduceOptions.calcs=["sum"];break}switch(Ue.legendType){case"Under graph":tt.legend.placement="bottom";break;case"Right side":tt.legend.placement="right";break}switch(Ue.pieType){case"pie":tt.pieType=_o.Pie;break;case"donut":tt.pieType=_o.Donut;break}return Ue.legend&&(Ue.legend.show||(tt.legend.showLegend=!1),Ue.legend.values&&tt.legend.values.push(Po.Value),Ue.legend.percentage&&tt.legend.values.push(Po.Percent)),Ue.legendType==="On graph"&&(tt.legend.showLegend=!1,tt.displayLabels=[eo.Name],Ue.legend.values&&tt.displayLabels.push(eo.Value),Ue.legend.percentage&&tt.displayLabels.push(eo.Percent)),tt}return{}};class Xh{getSuggestionsForData(pe){const Me=pe.getListAppender({name:xs.m.PieChart,pluginId:"piechart",options:{reduceOptions:{values:!1,calcs:["lastNotNull"]},displayLabels:[eo.Percent],legend:{calcs:[],displayMode:rt.lm.Hidden,placement:"right",values:[],showLegend:!1}}}),{dataSummary:Ue}=pe;if(Ue.hasNumberField){if(Ue.hasStringField&&Ue.frameCount===1){if(Ue.rowCountTotal>30||Ue.rowCountTotal<2)return;Me.append({name:xs.m.PieChart,options:{reduceOptions:{values:!0,calcs:[]}}}),Me.append({name:xs.m.PieChartDonut,options:{reduceOptions:{values:!0,calcs:[]},pieType:_o.Donut}});return}Ue.numberFieldCount>30||Ue.numberFieldCount<2||(Me.append({name:xs.m.PieChart}),Me.append({name:xs.m.PieChartDonut,options:{pieType:_o.Donut}}))}}}const Lo=new b.m(Yh).setPanelChangeHandler(Li).useFieldConfig({disableStandardOptions:[wn.uo.Thresholds],standardOptions:{[wn.uo.Color]:{settings:{byValueSupport:!1,bySeriesSupport:!0,preferThresholdsMode:!1},defaultValue:{mode:On.Y.PaletteClassic}}},useCustomConfig:J=>{kn.e(J)}}).setPanelOptions(J=>{(0,Dr.L)(J),J.addRadio({name:"Piechart type",description:"How the piechart should be rendered",path:"pieType",settings:{options:[{value:_o.Pie,label:"Pie"},{value:_o.Donut,label:"Donut"}]},defaultValue:_o.Pie}).addMultiSelect({name:"Labels",path:"displayLabels",description:"Select the labels to be displayed in the pie chart",settings:{options:[{value:eo.Percent,label:"Percent"},{value:eo.Name,label:"Name"},{value:eo.Value,label:"Value"}]}}),Yn.D(J),Wn.H(J,!1),J.addMultiSelect({name:"Legend values",path:"legend.values",category:["Legend"],settings:{options:[{value:Po.Percent,label:"Percent"},{value:Po.Value,label:"Value"}]},showIf:pe=>pe.legend.showLegend!==!1})}).setSuggestionsSupplier(new Xh);var xp=e(36373),Sd=e(11082),vl=e(34163),Od=e(82389);const Dc=({series:J,dataIdxs:pe,seriesIdx:Me,mode:Ue=rt.$N.Single,sortOrder:ze=rt.xB.None,isPinned:tt,annotate:it,timeRange:bt,withDuration:Lt,maxHeight:Nt})=>{const Ht=(0,te.of)(ks.$),Xt=J.fields[0],cn=Me!=null?pe[Me]:pe.find(Kn=>Kn!=null),Gt=Xt.display(Xt.values[cn]).text;Ue=tt?rt.$N.Single:Ue;const pn=(0,hc.cp)(J.fields,Xt,pe,Me,Ue,ze);if(Lt&&Ue===rt.$N.Single){const Kn=J.fields[Me],Rn=(0,Ba.GY)(Kn,cn);let mn;Rn&&(mn=Xt.values[Rn]);const bn=Xt.values[cn];let Ns;if(mn)Ns=mn&&(0,Ba.c5)(mn-bn);else{const ts=bt.to.valueOf();Ns=(0,Ba.c5)(ts-bn)}pn.push({label:"Duration",value:Ns})}let zn;if(tt&&Me!=null){const Kn=J.fields[Me],Rn=pe[Me],mn=(0,hd.u)(Kn,Rn);zn=(0,T.jsx)(dd.S,{dataLinks:mn,annotate:it})}const Ln={label:Xt.type===jt.PU.time?"":Xt.state?.displayName??Xt.name,value:Gt};return(0,T.jsxs)("div",{className:Ht.wrapper,children:[(0,T.jsx)(ud.A,{item:Ln,isPinned:tt}),(0,T.jsx)(cd.o,{items:pn,isPinned:tt,scrollable:(0,_s.T5)({mode:Ue,maxHeight:Nt}),maxHeight:Nt}),zn]})},Id=({data:J,timeRange:pe,timeZone:Me,options:Ue,width:ze,height:tt,replaceVariables:it,onChangeTimeRange:bt})=>{const Lt=(0,te.$j)(),[Nt,Ht]=(0,V.useState)(null),{sync:Xt,eventsScope:cn,canAddAnnotations:Gt,dataLinkPostProcessor:pn,eventBus:zn}=(0,da.d2)(),Ln=Xt?.()??Ai.y.Off,{frames:Kn,warn:Rn}=(0,V.useMemo)(()=>(0,Ba.Qe)(J.series,Ue.mergeValues??!0,pe,Lt),[J.series,Ue.mergeValues,pe,Lt]),mn=(0,V.useMemo)(()=>(0,Ba.Or)(Kn,Ue.legend,Lt),[Kn,Ue.legend,Lt]),bn=(0,V.useMemo)(()=>(0,_s.Fg)(Ue.timezone,Me),[Ue.timezone,Me]);if(!Kn||Rn)return(0,T.jsx)("div",{className:"panel-empty",children:(0,T.jsx)("p",{children:Rn??"No data found in response"})});if(Kn.length===1){const ts=(0,oh.wC)(Kn[0])}const Ns=!!(Gt&&Gt());return(0,T.jsx)(Od.I,{theme:Lt,frames:Kn,structureRev:J.structureRev,timeRange:pe,timeZone:bn,width:ze,height:tt,legendItems:mn,...Ue,mode:Ba.pm.Changes,replaceVariables:it,dataLinkPostProcessor:pn,cursorSync:Ln,children:(ts,Es)=>(0,T.jsxs)(T.Fragment,{children:[Ln!==Ai.y.Off&&(0,T.jsx)(Uo.K,{config:ts,eventBus:zn,frame:Es}),Ue.tooltip.mode!==rt.$N.None&&(0,T.jsx)(Ms.xl,{config:ts,hoverMode:Ue.tooltip.mode===rt.$N.Multi?Ms.b3.xAll:Ms.b3.xOne,queryZoom:bt,syncMode:Ln,syncScope:cn,render:(Hn,jn,is,Zn,ps,Fs,la)=>{if(Ns&&Fs!=null){Ht(Fs),ps();return}const ia=()=>{let Na=Hn.posToVal(Hn.cursor.left,"x");Ht({from:Na,to:Na}),ps()};return(0,T.jsx)(Dc,{series:Es,dataIdxs:jn,seriesIdx:is,mode:la?rt.$N.Multi:Ue.tooltip.mode,sortOrder:Ue.tooltip.sort,isPinned:Zn,timeRange:pe,annotate:Ns?ia:void 0,withDuration:!0,maxHeight:Ue.tooltip.maxHeight})},maxWidth:Ue.tooltip.maxWidth}),(0,T.jsx)(Vr.W,{annotations:J.annotations??[],config:ts,timeZone:Me,newRange:Nt,setNewRange:Ht,canvasRegionRendering:!1}),(0,T.jsx)(Fo.U,{config:ts,onChangeTimeRange:bt})]})})};var Pc=e(25019);const bc=(J,pe,Me)=>{let Ue=J.options??{};if(pe==="natel-discrete-panel"&&Me.angular){const ze=Me.angular,tt=J.fieldConfig??{defaults:{},overrides:[]};ze.units&&(tt.defaults.unit=ze.units);const it={fillOpacity:100,lineWidth:0};tt.defaults.custom=it,Ue.mergeValues=!0;const bt={type:Pc.d.ValueToText,options:{}};if(tt.defaults.mappings=[bt],(0,N.isArray)(ze.colorMaps))for(const Lt of ze.colorMaps){const Nt=Lt.color;Nt&&(bt.options[Lt.text]={color:Nt})}if((0,N.isArray)(ze.valueMaps))for(const Lt of ze.valueMaps){const Nt=Lt.text,Ht=Lt.value;if(Nt&&Ht){let Xt=bt.options[Ht];Xt?Xt.text=Nt:bt.options[Ht]={text:Nt}}}if((0,N.isArray)(ze.rangeMaps))for(const Lt of ze.rangeMaps){let Nt=+Lt.from,Ht=+Lt.to;const Xt=Lt.text;Xt&&tt.defaults.mappings.push({type:Pc.d.RangeToText,options:{from:Nt,to:Ht,result:{text:Xt}}})}J.fieldConfig=tt}return Ue},yl={alignValue:"left",mergeValues:!0,rowHeight:.9,showValue:rt.yL.Auto},Ad={fillOpacity:70,lineWidth:0};class Rd{getSuggestionsForData(pe){const{dataSummary:Me}=pe;if(!Me.hasData||!Me.hasTimeField||!Me.hasStringField&&!Me.hasNumberField||Me.numberFieldCount>=30||Me.preferredVisualisationType==="logs")return;pe.getListAppender({name:"",pluginId:"state-timeline",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]}}).append({name:xs.m.StateTimeline})}}const Zh=new b.m(Id).setPanelChangeHandler(bc).useFieldConfig({standardOptions:{[wn.uo.Color]:{settings:{byValueSupport:!0},defaultValue:{mode:On.Y.ContinuousGrYlRd}}},useCustomConfig:J=>{J.addSliderInput({path:"lineWidth",name:"Line width",defaultValue:Ad.lineWidth,settings:{min:0,max:10,step:1}}).addSliderInput({path:"fillOpacity",name:"Fill opacity",defaultValue:Ad.fillOpacity,settings:{min:0,max:100,step:1}}).addCustomEditor({id:"spanNulls",path:"spanNulls",name:"Connect null values",defaultValue:!1,editor:vl.e,override:vl.e,shouldApply:pe=>pe.type!==jt.PU.time,process:Rt.hS,settings:{isTime:!0}}).addCustomEditor({id:"insertNulls",path:"insertNulls",name:"Disconnect values",defaultValue:!1,editor:Sd.Z,override:Sd.Z,shouldApply:pe=>pe.type!==jt.PU.time,process:Rt.hS,settings:{isTime:!0}}),kn.e(J)}}).setPanelOptions(J=>{J.addBooleanSwitch({path:"mergeValues",name:"Merge equal consecutive values",defaultValue:yl.mergeValues}).addRadio({path:"showValue",name:"Show values",settings:{options:[{value:rt.yL.Auto,label:"Auto"},{value:rt.yL.Always,label:"Always"},{value:rt.yL.Never,label:"Never"}]},defaultValue:yl.showValue}).addRadio({path:"alignValue",name:"Align values",settings:{options:[{value:"left",label:"Left"},{value:"center",label:"Center"},{value:"right",label:"Right"}]},defaultValue:yl.alignValue}).addSliderInput({path:"rowHeight",name:"Row height",settings:{min:0,max:1,step:.01},defaultValue:yl.rowHeight}),Wn.H(J,!1),Yn.D(J)}).setSuggestionsSupplier(new Rd).setDataSupport({annotations:!0}),xl=({data:J,timeRange:pe,timeZone:Me,options:Ue,width:ze,height:tt,replaceVariables:it,onChangeTimeRange:bt})=>{const Lt=(0,te.$j)(),[Nt,Ht]=(0,V.useState)(null),{sync:Xt,eventsScope:cn,canAddAnnotations:Gt,dataLinkPostProcessor:pn,eventBus:zn}=(0,da.d2)(),Ln=Xt?.()??Ai.y.Off,Kn=!!(Gt&&Gt()),{frames:Rn,warn:mn}=(0,V.useMemo)(()=>(0,Ba.Qe)(J.series,!1,pe,Lt),[J.series,pe,Lt]),bn=(0,V.useMemo)(()=>(0,Ba.Or)(Rn,Ue.legend,Lt),[Rn,Ue.legend,Lt]),Ns=(0,V.useMemo)(()=>(0,_s.Fg)(Ue.timezone,Me),[Ue.timezone,Me]);return!Rn||mn?(0,T.jsx)("div",{className:"panel-empty",children:(0,T.jsx)("p",{children:mn??"No data found in response"})}):Rn[0].length>ze/2?(0,T.jsx)("div",{className:"panel-empty",children:(0,T.jsxs)("p",{children:["Too many points to visualize properly. ",(0,T.jsx)("br",{}),"Update the query to return fewer points. ",(0,T.jsx)("br",{}),"(",Rn[0].length," points received)"]})}):(0,T.jsx)(Od.I,{theme:Lt,frames:Rn,structureRev:J.structureRev,timeRange:pe,timeZone:Ns,width:ze,height:tt,legendItems:bn,...Ue,mode:Ba.pm.Samples,replaceVariables:it,dataLinkPostProcessor:pn,cursorSync:Ln,children:(ts,Es)=>(0,T.jsxs)(T.Fragment,{children:[Ln!==Ai.y.Off&&(0,T.jsx)(Uo.K,{config:ts,eventBus:zn,frame:Es}),Ue.tooltip.mode!==rt.$N.None&&(0,T.jsx)(Ms.xl,{config:ts,hoverMode:Ue.tooltip.mode===rt.$N.Multi?Ms.b3.xAll:Ms.b3.xOne,queryZoom:bt,syncMode:Ln,syncScope:cn,render:(Hn,jn,is,Zn,ps,Fs,la)=>{if(Kn&&Fs!=null){Ht(Fs),ps();return}const ia=()=>{let Na=Hn.posToVal(Hn.cursor.left,"x");Ht({from:Na,to:Na}),ps()};return(0,T.jsx)(Dc,{series:Es,dataIdxs:jn,seriesIdx:is,mode:la?rt.$N.Multi:Ue.tooltip.mode,sortOrder:Ue.tooltip.sort,isPinned:Zn,timeRange:pe,annotate:Kn?ia:void 0,withDuration:!1,maxHeight:Ue.tooltip.maxHeight})},maxWidth:Ue.tooltip.maxWidth}),(0,T.jsx)(Vr.W,{annotations:J.annotations??[],config:ts,timeZone:Me,newRange:Nt,setNewRange:Ht,canvasRegionRendering:!1}),(0,T.jsx)(Fo.U,{config:ts,onChangeTimeRange:bt})]})})},Ep={colWidth:.9,rowHeight:.9,showValue:rt.yL.Auto},Ld={fillOpacity:70,lineWidth:1};class jd{getSuggestionsForData(pe){const{dataSummary:Me}=pe;if(!Me.hasData||!Me.hasTimeField||!Me.hasStringField&&!Me.hasNumberField||Me.numberFieldCount>=30||Me.rowCountMax>100||Me.preferredVisualisationType==="logs")return;pe.getListAppender({name:"",pluginId:"status-history",options:{},fieldConfig:{defaults:{color:{mode:On.Y.ContinuousGrYlRd},custom:{}},overrides:[]},cardOptions:{previewModifier:ze=>{ze.options.colWidth=.7}}}).append({name:xs.m.StatusHistory})}}const tr=new b.m(xl).useFieldConfig({standardOptions:{[wn.uo.Color]:{settings:{byValueSupport:!0},defaultValue:{mode:On.Y.Thresholds}}},useCustomConfig:J=>{J.addSliderInput({path:"lineWidth",name:"Line width",defaultValue:Ld.lineWidth,settings:{min:0,max:10,step:1}}).addSliderInput({path:"fillOpacity",name:"Fill opacity",defaultValue:Ld.fillOpacity,settings:{min:0,max:100,step:1}}),kn.e(J)}}).setPanelOptions(J=>{J.addRadio({path:"showValue",name:"Show values",settings:{options:[{value:rt.yL.Auto,label:"Auto"},{value:rt.yL.Always,label:"Always"},{value:rt.yL.Never,label:"Never"}]},defaultValue:rt.yL.Auto}).addSliderInput({path:"rowHeight",name:"Row height",defaultValue:.9,settings:{min:0,max:1,step:.01}}).addSliderInput({path:"colWidth",name:"Column width",defaultValue:.9,settings:{min:0,max:1,step:.01}}),Wn.H(J,!1),Yn.D(J)}).setSuggestionsSupplier(new jd).setDataSupport({annotations:!0});var qh=e(69550),Zi=e(39651),zl=e(15292);function ef({onChange:J,value:pe,context:Me}){const Ue=ze=>{ze?.currentTarget.checked&&(Me.options.footer.show=!1),J(ze?.currentTarget.checked)};return(0,T.jsx)(zl.d,{value:!!pe,onChange:Ue})}var Bd=e(39938);const tf=({cellOptions:J,onChange:pe})=>{const Me=()=>{J.wrapText=!J.wrapText,pe(J)},Ue=(0,T.jsxs)(hl.J,{description:"If selected text will be wrapped to the width of text in the configured column",children:["Wrap text ",(0,T.jsx)(Bd.E,{text:"Alpha",color:"blue",style:{fontSize:"11px",marginLeft:"5px",lineHeight:"1.2"}})]});return(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(Do.D,{label:Ue,children:(0,T.jsx)(zl.d,{value:J.wrapText,onChange:Me})})})};function nf({cellOptions:J,onChange:pe}){const Me=ze=>{J.mode=ze,pe(J)},Ue=ze=>{J.valueDisplayMode=ze,pe(J)};return(0,T.jsxs)(R.B,{direction:"column",gap:0,children:[(0,T.jsx)(Do.D,{label:"Gauge display mode",children:(0,T.jsx)(Gs.z,{value:J?.mode??rt.eX.Gradient,onChange:Me,options:Ud})}),(0,T.jsx)(Do.D,{label:"Value display",children:(0,T.jsx)(Gs.z,{value:J?.valueDisplayMode??rt.$l.Text,onChange:Ue,options:mi})})]})}const Ud=[{value:rt.eX.Basic,label:"Basic"},{value:rt.eX.Gradient,label:"Gradient"},{value:rt.eX.Lcd,label:"Retro LCD"}],mi=[{value:rt.$l.Color,label:"Value color"},{value:rt.$l.Text,label:"Text color"},{value:rt.$l.Hidden,label:"Hidden"}],sf=[{value:rt.Wq.Basic,label:"Basic"},{value:rt.Wq.Gradient,label:"Gradient"}],af=({cellOptions:J,onChange:pe})=>{const Me=it=>{J.mode=it,pe(J)},Ue=()=>{J.applyToRow=!J.applyToRow,pe(J)},ze=()=>{J.wrapText=!J.wrapText,pe(J)},tt=(0,T.jsxs)(hl.J,{description:"If selected text will be wrapped to the width of text in the configured column",children:["Wrap text ",(0,T.jsx)(Bd.E,{text:"Alpha",color:"blue",style:{fontSize:"11px",marginLeft:"5px",lineHeight:"1.2"}})]});return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Do.D,{label:"Background display mode",children:(0,T.jsx)(Gs.z,{value:J?.mode??rt.Wq.Gradient,onChange:Me,options:sf})}),(0,T.jsx)(Do.D,{label:"Apply to entire row",description:"If selected the entire row will be colored as this cell would be.",children:(0,T.jsx)(zl.d,{value:J.applyToRow,onChange:Ue})}),(0,T.jsx)(Do.D,{label:tt,children:(0,T.jsx)(zl.d,{value:J.wrapText,onChange:ze})})]})},vi=({cellOptions:J,onChange:pe})=>{const Me=ze=>{J.alt=ze.currentTarget.value,pe(J)},Ue=ze=>{J.title=ze.currentTarget.value,pe(J)};return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Do.D,{label:"Alt text",description:"Alternative text that will be displayed if an image can't be displayed or for users who use a screen reader",children:(0,T.jsx)(ya.p,{onChange:Me,defaultValue:J.alt})}),(0,T.jsx)(Do.D,{label:"Title text",description:"Text that will be displayed when the image is hovered by a cursor",children:(0,T.jsx)(ya.p,{onChange:Ue,defaultValue:J.title})})]})};var rf=e(28528),Nd=e(30355);const of=["hideValue","drawStyle","lineInterpolation","barAlignment","lineWidth","fillOpacity","gradientMode","lineStyle","spanNulls","showPoints","pointSize"];function lf(J){const pe=(0,ur.V)(J);return{...pe,useCustomConfig:Me=>{pe.useCustomConfig?.(Me),Me.addBooleanSwitch({path:"hideValue",name:"Hide value"})}}}const cf=J=>{const{cellOptions:pe,onChange:Me}=J,Ue=(0,V.useMemo)(()=>{const it=lf(Nd.t);return(0,rf.O)(it,"ChartCell")},[]),ze=(0,te.of)(yi),tt={...Nd.t,...pe};return(0,T.jsx)(ds.gW,{children:Ue.list(of.map(it=>`custom.${it}`)).map(it=>{if(it.showIf&&!it.showIf(tt))return null;const bt=it.editor,Lt=it.path;return(0,T.jsx)(Do.D,{label:it.name,className:ze.field,children:(0,T.jsx)(bt,{onChange:Nt=>Me({...pe,[Lt]:Nt}),value:(El(Lt,tt)?tt[Lt]:void 0)??it.defaultValue,item:it,context:{data:[]}})},it.id)})})};function El(J,pe){return J in pe}const yi=()=>({field:(0,q.css)`
    width: 100%;

    // @TODO don't show "scheme" option for custom gradient mode.
    // it needs thresholds to work, which are not supported
    // for area chart cell right now
    [title='Use color scheme to define gradient'] {
      display: none;
    }
  `}),Cc=({value:J,onChange:pe})=>{const Me=J.type,Ue=(0,te.of)(wd),ze=Tc.find(Nt=>Nt.value.type===Me);let[tt,it]=(0,V.useState)({});const bt=Nt=>{Nt.value!==void 0&&(J=Nt.value,tt[J.type]!==void 0&&Object.keys(tt[J.type]).length>1&&(J=(0,N.merge)(J,tt[J.type])),pe(J))},Lt=Nt=>{tt[J.type]=(0,N.merge)(J,Nt),it(tt),pe(tt[J.type])};return(0,T.jsxs)("div",{className:Ue.fixBottomMargin,children:[(0,T.jsx)(Do.D,{children:(0,T.jsx)(K.l6,{options:Tc,value:ze,onChange:bt})}),(Me===rt.ob.Auto||Me===rt.ob.ColorText)&&(0,T.jsx)(tf,{cellOptions:J,onChange:Lt}),Me===rt.ob.Gauge&&(0,T.jsx)(nf,{cellOptions:J,onChange:Lt}),Me===rt.ob.ColorBackground&&(0,T.jsx)(af,{cellOptions:J,onChange:Lt}),Me===rt.ob.Sparkline&&(0,T.jsx)(cf,{cellOptions:J,onChange:Lt}),Me===rt.ob.Image&&(0,T.jsx)(vi,{cellOptions:J,onChange:Lt})]})},Tc=[{value:{type:rt.ob.Auto},label:"Auto"},{value:{type:rt.ob.Sparkline},label:"Sparkline"},{value:{type:rt.ob.ColorText},label:"Colored text"},{value:{type:rt.ob.ColorBackground},label:"Colored background"},{value:{type:rt.ob.Gauge},label:"Gauge"},{value:{type:rt.ob.DataLinks},label:"Data links"},{value:{type:rt.ob.JSONView},label:"JSON View"},{value:{type:rt.ob.Image},label:"Image"}],wd=J=>({fixBottomMargin:(0,q.css)({marginBottom:J.spacing(-2)})}),Hl={cellHeight:rt.qM.Sm,footer:{show:!1,countRows:!1,reducer:[]},frameIndex:0,showHeader:!0,showTypeIcons:!1,sortBy:[]};class df{getSuggestionsForData(pe){const Me=pe.getListAppender({name:xs.m.Table,pluginId:"table",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]},cardOptions:{previewModifier:Ue=>{Ue.fieldConfig.defaults.custom.minWidth=50}}});pe.dataSummary.fieldCount===0?Me.append({cardOptions:{imgSrc:"public/app/plugins/panel/table/img/icn-table-panel.svg"}}):Me.append({})}}const Dl="Table footer",Wd=["Cell options"],kl=new b.m(pd).setPanelChangeHandler($l.l1).setMigrationHandler($l.fq).useFieldConfig({useCustomConfig:J=>{J.addNumberInput({path:"minWidth",name:"Minimum column width",description:"The minimum width for column auto resizing",settings:{placeholder:"150",min:50,max:500},shouldApply:()=>!0,defaultValue:Zi.gB.minWidth}).addNumberInput({path:"width",name:"Column width",settings:{placeholder:"auto",min:20,max:300},shouldApply:()=>!0,defaultValue:Zi.gB.width}).addRadio({path:"align",name:"Column alignment",settings:{options:[{label:"Auto",value:"auto"},{label:"Left",value:"left"},{label:"Center",value:"center"},{label:"Right",value:"right"}]},defaultValue:Zi.gB.align}).addCustomEditor({id:"cellOptions",path:"cellOptions",name:"Cell type",editor:Cc,override:Cc,defaultValue:Zi.gB.cellOptions,process:Rt.hS,category:Wd,shouldApply:()=>!0}).addBooleanSwitch({path:"inspect",name:"Cell value inspect",description:"Enable cell value inspection in a modal window",defaultValue:!1,category:Wd,showIf:pe=>pe.cellOptions.type===rt.ob.Auto||pe.cellOptions.type===rt.ob.JSONView||pe.cellOptions.type===rt.ob.ColorText||pe.cellOptions.type===rt.ob.ColorBackground}).addBooleanSwitch({path:"filterable",name:"Column filter",description:"Enables/disables field filters in table",defaultValue:Zi.gB.filterable}).addBooleanSwitch({path:"hidden",name:"Hide in table",defaultValue:void 0,hideFromDefaults:!0})}}).setPanelOptions(J=>{J.addBooleanSwitch({path:"showHeader",name:"Show table header",defaultValue:Hl.showHeader}).addRadio({path:"cellHeight",name:"Cell height",defaultValue:Hl.cellHeight,settings:{options:[{value:rt.qM.Sm,label:"Small"},{value:rt.qM.Md,label:"Medium"},{value:rt.qM.Lg,label:"Large"}]}}).addBooleanSwitch({path:"footer.show",category:[Dl],name:"Show table footer",defaultValue:Hl.footer?.show}).addCustomEditor({id:"footer.reducer",category:[Dl],path:"footer.reducer",name:"Calculation",description:"Choose a reducer function / calculation",editor:qh.D.get("stats-picker").editor,defaultValue:[Ii.gy.sum],showIf:pe=>pe.footer?.show}).addBooleanSwitch({path:"footer.countRows",category:[Dl],name:"Count rows",description:"Display a single count for all data rows",defaultValue:Hl.footer?.countRows,showIf:pe=>pe.footer?.reducer?.length===1&&pe.footer?.reducer[0]===Ii.gy.count}).addMultiSelect({path:"footer.fields",category:[Dl],name:"Fields",description:"Select the fields that should be calculated",settings:{allowCustomValue:!1,options:[],placeholder:"All Numeric Fields",getOptions:async pe=>{const Me=[];if(pe&&pe.data&&pe.data.length>0){const Ue=pe.data[0];for(const ze of Ue.fields)if(ze.type===jt.PU.number){const tt=(0,en.Ct)(ze,Ue,pe.data),it=ze.name;Me.push({value:it,label:tt})}}return Me}},defaultValue:"",showIf:pe=>pe.footer?.show&&!pe.footer?.countRows}).addCustomEditor({id:"footer.enablePagination",path:"footer.enablePagination",name:"Enable pagination",editor:ef})}).setSuggestionsSupplier(new df);var uf=e(49880),Fd=e.n(uf),hf=e(40996),ff=e(36663),Qr=(J=>(J.Code="code",J.HTML="html",J.Markdown="markdown",J))(Qr||{}),Kd=(J=>(J.Go="go",J.Html="html",J.Json="json",J.Markdown="markdown",J.Plaintext="plaintext",J.Sql="sql",J.Typescript="typescript",J.Xml="xml",J.Yaml="yaml",J))(Kd||{});const gf="plaintext",Pl={language:"plaintext",showLineNumbers:!1,showMiniMap:!1},$d={content:`# Title

For markdown syntax help: [commonmark.org/help](https://commonmark.org/help/)`,mode:"markdown"};function pf(J){const pe=(0,te.of)(mf),[Me,Ue]=(0,V.useState)({mode:J.options.mode,content:Gl(J.options,J.replaceVariables,ce.Ay.disableSanitizeHtml)});if((0,hf.A)(()=>{const{options:ze,replaceVariables:tt}=J,it=Gl(ze,tt,ce.Ay.disableSanitizeHtml);(it!==Me.content||ze.mode!==Me.mode)&&Ue({mode:ze.mode,content:it})},100,[J]),Me.mode===Qr.Code){const ze=J.options.code??Pl;return(0,T.jsx)(fc.B,{value:Me.content,language:ze.language??Pl.language,width:J.width,height:J.height,containerStyles:pe.codeEditorContainer,showMiniMap:ze.showMiniMap,showLineNumbers:ze.showLineNumbers,readOnly:!0},`${ze.showLineNumbers}/${ze.showMiniMap}`)}return(0,T.jsx)(le.E,{autoHeightMin:"100%",className:pe.containStrict,children:(0,T.jsx)(Fd(),{allowRerender:!0,html:Me.content,className:pe.markdown,"data-testid":"TextPanel-converted-content"})})}function Gl(J,pe,Me){let{mode:Ue,content:ze}=J;if(!ze)return" ";switch(ze=pe(ze,{},J.code?.language==="json"?"json":"html"),Ue){case Qr.Code:break;case Qr.HTML:Me||(ze=Qi.sQ.sanitizeTextPanelContent(ze));break;case Qr.Markdown:default:ze=(0,ff.P)(ze,{noSanitize:Me})}return ze}const mf=J=>({codeEditorContainer:(0,q.css)`
    .monaco-editor .margin,
    .monaco-editor-background {
      background-color: ${J.colors.background.primary};
    }
  `,markdown:(0,q.cx)("markdown-html",(0,q.css)`
      height: 100%;
    `),containStrict:(0,q.css)({contain:"strict"})});var vf=e(70713),yf=e(99544);const Vd=({value:J,onChange:pe,context:Me})=>{const Ue=(0,V.useMemo)(()=>Me.options?.mode??Qr.Markdown,[Me]),ze=(0,te.of)(xf),tt=()=>Me.getSuggestions?Me.getSuggestions().map(it=>(0,yf.O)(it)):[];return(0,T.jsx)("div",{className:(0,q.cx)(ze.editorBox),children:(0,T.jsx)(vf.Ay,{disableHeight:!0,children:({width:it})=>it===0?null:(0,T.jsx)(fc.B,{value:J,onBlur:pe,onSave:pe,language:Ue,width:it,showMiniMap:!1,showLineNumbers:!1,height:"500px",getSuggestions:tt})})})},xf=J=>({editorBox:(0,q.css)`
    label: editorBox;
    border: 1px solid ${J.colors.border.medium};
    border-radius: ${J.shape.radius.default};
    margin: ${J.spacing(.5)} 0;
    width: 100%;
  `}),Ef=J=>{const pe=parseFloat(J.pluginVersion||"6.1");let Me=J.options;if(J.hasOwnProperty("content")&&J.hasOwnProperty("mode")){const ze=J,tt=ze.content,it=ze.mode;delete ze.content,delete ze.mode,pe<7.1&&(Me={content:tt,mode:it})}return[Qr.Code,Qr.HTML,Qr.Markdown].find(ze=>ze===Me.mode)||(Me={...Me,mode:Qr.Markdown}),Me},Df=new b.m(pf).setPanelOptions(J=>{J.addRadio({path:"mode",name:"Mode",settings:{options:[{value:Qr.Markdown,label:"Markdown"},{value:Qr.HTML,label:"HTML"},{value:Qr.Code,label:"Code"}]},defaultValue:$d.mode}).addSelect({path:"code.language",name:"Language",settings:{options:Object.values(Kd).map(pe=>({value:pe,label:pe}))},defaultValue:Pl.language,showIf:pe=>pe.mode===Qr.Code}).addBooleanSwitch({path:"code.showLineNumbers",name:"Show line numbers",defaultValue:Pl.showLineNumbers,showIf:pe=>pe.mode===Qr.Code}).addBooleanSwitch({path:"code.showMiniMap",name:"Show mini map",defaultValue:Pl.showMiniMap,showIf:pe=>pe.mode===Qr.Code}).addCustomEditor({id:"content",path:"content",name:"Content",editor:Vd,defaultValue:$d.content})}).setMigrationHandler(Ef);var Pf=e(41260),Ql=e(18282);class Yr{getSuggestionsForData(pe){const{dataSummary:Me}=pe;if(!Me.hasTimeField||!Me.hasNumberField||Me.rowCountTotal<2)return;const Ue=pe.getListAppender({name:xs.m.LineChart,pluginId:"timeseries",options:{legend:{calcs:[],displayMode:rt.lm.Hidden,placement:"right",showLegend:!1}},fieldConfig:{defaults:{custom:{}},overrides:[]},cardOptions:{previewModifier:tt=>{tt.fieldConfig?.defaults.custom?.drawStyle!==rt.GR.Bars&&(tt.fieldConfig.defaults.custom.lineWidth=Math.max(tt.fieldConfig.defaults.custom.lineWidth??1,2))}}}),ze=100;if(Ue.append({name:xs.m.LineChart}),Me.rowCountMax<200&&Ue.append({name:xs.m.LineChartSmooth,fieldConfig:{defaults:{custom:{lineInterpolation:rt.dx.Smooth}},overrides:[]}}),Me.numberFieldCount===1){Ue.append({name:xs.m.AreaChart,fieldConfig:{defaults:{custom:{fillOpacity:25}},overrides:[]}}),Ue.append({name:xs.m.LineChartGradientColorScheme,fieldConfig:{defaults:{color:{mode:On.Y.ContinuousGrYlRd},custom:{gradientMode:rt.on.Scheme,lineInterpolation:rt.dx.Smooth,lineWidth:3,fillOpacity:20}},overrides:[]}}),Me.rowCountMax<ze&&(Ue.append({name:xs.m.BarChart,fieldConfig:{defaults:{custom:{drawStyle:rt.GR.Bars,fillOpacity:100,lineWidth:1,gradientMode:rt.on.Hue}},overrides:[]}}),Ue.append({name:xs.m.BarChartGradientColorScheme,fieldConfig:{defaults:{color:{mode:On.Y.ContinuousGrYlRd},custom:{drawStyle:rt.GR.Bars,fillOpacity:90,lineWidth:1,gradientMode:rt.on.Scheme}},overrides:[]}}));return}Ue.append({name:xs.m.AreaChartStacked,fieldConfig:{defaults:{custom:{fillOpacity:25,stacking:{mode:rt.gs.Normal,group:"A"}}},overrides:[]}}),Ue.append({name:xs.m.AreaChartStackedPercent,fieldConfig:{defaults:{custom:{fillOpacity:25,stacking:{mode:rt.gs.Percent,group:"A"}}},overrides:[]}}),Me.rowCountTotal/Me.numberFieldCount<ze&&(Ue.append({name:xs.m.BarChartStacked,fieldConfig:{defaults:{custom:{drawStyle:rt.GR.Bars,fillOpacity:100,lineWidth:1,gradientMode:rt.on.Hue,stacking:{mode:rt.gs.Normal,group:"A"}}},overrides:[]}}),Ue.append({name:xs.m.BarChartStackedPercent,fieldConfig:{defaults:{custom:{drawStyle:rt.GR.Bars,fillOpacity:100,lineWidth:1,gradientMode:rt.on.Hue,stacking:{mode:rt.gs.Percent,group:"A"}}},overrides:[]}}))}}function Cr(J){const pe=(0,He.UA)().getCurrent()?.getPanelById(J);if(pe){const Me=pe.transformations?[...pe.transformations]:[];return Me.push({id:Ql.F.prepareTimeSeries,options:{format:"wide"}}),{name:"Transform to wide time series format",pluginId:"timeseries",transformations:Me}}}const bf=({data:J,timeRange:pe,timeZone:Me,width:Ue,height:ze,options:tt,fieldConfig:it,onChangeTimeRange:bt,replaceVariables:Lt,id:Nt})=>{const{sync:Ht,eventsScope:Xt,canAddAnnotations:cn,onThresholdsChange:Gt,canEditThresholds:pn,showThresholds:zn,dataLinkPostProcessor:Ln,eventBus:Kn}=(0,da.d2)(),Rn=tt.orientation===rt.wV.Vertical,mn=(0,V.useMemo)(()=>(0,_s.B_)(J.series,ce.config.theme2,pe),[J.series,pe]),bn=(0,V.useMemo)(()=>(0,_s.Fg)(tt.timezone,Me),[tt.timezone,Me]),Ns=(0,V.useMemo)(()=>{if(mn?.length&&mn.every(is=>is.meta?.type===Pf.m.TimeSeriesLong)){const is=Cr(Nt);return{message:"Long data must be converted to wide",suggestions:is?[is]:void 0}}},[mn,Nt]),ts=!!(cn&&cn()),[Es,Hn]=(0,V.useState)(null),jn=Ht?.()??Ai.y.Off;return!mn||Ns?(0,T.jsx)(fs.a,{panelId:Nt,message:Ns?.message,fieldConfig:it,data:J,needsTimeField:!0,needsNumberField:!0,suggestions:Ns?.suggestions}):(0,T.jsx)(Qo,{frames:mn,structureRev:J.structureRev,timeRange:pe,timeZone:bn,width:Ue,height:ze,legend:tt.legend,options:tt,replaceVariables:Lt,dataLinkPostProcessor:Ln,cursorSync:jn,children:(is,Zn)=>(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(ro.Z,{config:is}),jn!==Ai.y.Off&&(0,T.jsx)(Uo.K,{config:is,eventBus:Kn,frame:Zn}),tt.tooltip.mode!==rt.$N.None&&(0,T.jsx)(Ms.xl,{config:is,hoverMode:tt.tooltip.mode===rt.$N.Single?Ms.b3.xOne:Ms.b3.xAll,queryZoom:bt,clientZoom:!0,syncMode:jn,syncScope:Xt,render:(ps,Fs,la,ia=!1,Na,aa,Ts)=>{if(ts&&aa!=null){Hn(aa),Na();return}const Is=()=>{let ba=ps.posToVal(ps.cursor.left,"x");Hn({from:ba,to:ba}),Na()};return(0,T.jsx)(ks.k,{series:Zn,dataIdxs:Fs,seriesIdx:la,mode:Ts?rt.$N.Multi:tt.tooltip.mode,sortOrder:tt.tooltip.sort,isPinned:ia,annotate:ts?Is:void 0,maxHeight:tt.tooltip.maxHeight})},maxWidth:tt.tooltip.maxWidth}),!Rn&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Vr.W,{annotations:J.annotations??[],config:is,timeZone:Me,newRange:Es,setNewRange:Hn}),(0,T.jsx)(Fo.U,{config:is,onChangeTimeRange:bt}),J.annotations&&(0,T.jsx)(zi,{visibleSeries:ol(is,mn),config:is,exemplars:J.annotations,timeZone:Me}),(pn&&Gt||zn)&&(0,T.jsx)($o,{config:is,fieldConfig:it,onThresholdsChange:pn?Gt:void 0})]})]})})};var Yl=e(91410),_d=e(20333);const Mc=({value:J,onChange:pe})=>{const Me=(0,te.of)(zd);(!J||J.length<1)&&(J=[""]);const Ue=()=>{pe([...J,Yl.g$.default])},ze=it=>{const bt=J.slice();bt.splice(it,1),pe(bt)},tt=(it,bt)=>{const Lt=J.slice();Lt[it]=bt??Yl.g$.default,Lt.length===0||Lt.length===1&&Lt[0]===""?pe(void 0):pe(Lt)};return(0,T.jsx)("div",{children:J.map((it,bt)=>(0,T.jsxs)("div",{className:Me.wrapper,children:[(0,T.jsx)("span",{className:Me.first,children:(0,T.jsx)(_d.U,{onChange:Lt=>tt(bt,Lt),includeInternal:!0,value:it??Yl.g$.default})}),bt===J.length-1?(0,T.jsx)(qo.K,{name:"plus",onClick:Ue,tooltip:"Add timezone"}):(0,T.jsx)(qo.K,{name:"times",onClick:()=>ze(bt),tooltip:"Remove timezone"})]},`${bt}.${it}`))})},zd=J=>({wrapper:(0,q.css)`
    width: 100%;
    display: flex;
    flex-direction: rows;
    align-items: center;
  `,first:(0,q.css)`
    margin-right: 8px;
    flex-grow: 2;
  `});var Sc=e(50082),Cf=e(74856),Jl=e(38477),Hd=e(34842),kd=e(32023),Tf=e(68706);let ji=null;const Mf=(J,pe,Me,Ue)=>{if(pe==="graph"&&Me.angular){const{fieldConfig:ze,options:tt,annotations:it}=Sf({...Me.angular,fieldConfig:Ue,panel:J});return it?.length>0&&Rf(it),J.fieldConfig=ze,J.alert=Me.angular.alert,tt}return If(J),{}};function Sf(J){let pe=[];const Me=J.fieldConfig?.overrides??[],Ue=J.yaxes??[];let ze=Gd(Ue[0]);J.fieldConfig?.defaults&&(ze={...J.fieldConfig?.defaults,...ze});const tt={fill:J.dashes?"dash":"solid",dash:[J.dashLength??10,J.spaceLength??10]};if(J.aliasColors)for(const Xt of Object.keys(J.aliasColors)){const cn=J.aliasColors[Xt];cn&&Me.push({matcher:{id:pi.Ct.byName,options:Xt},properties:[{id:wn.uo.Color,value:{mode:On.Y.Fixed,fixedColor:cn}}]})}let it=!1;if(J.seriesOverrides?.length)for(const Xt of J.seriesOverrides){if(!Xt.alias)continue;const Gt={matcher:{id:/^([/~@;%#'])(.*?)\1([gimsuy]*)$/.test(Xt.alias)?pi.Ct.byRegexp:pi.Ct.byName,options:Xt.alias},properties:[]};let pn;for(const zn of Object.keys(Xt)){const Ln=Xt[zn];switch(zn){case"alias":case"$$hashKey":break;case"yaxis":if(Ln===2){const Kn=Gd(Ue[1]);Qd(ze,Kn,Gt.properties)}break;case"fill":Gt.properties.push({id:"custom.fillOpacity",value:Ln*10});break;case"fillBelowTo":it=!0,Gt.properties.push({id:"custom.fillBelowTo",value:Ln});break;case"fillGradient":Ln&&(Gt.properties.push({id:"custom.fillGradient",value:"opacity"}),Gt.properties.push({id:"custom.fillOpacity",value:Ln*10}));break;case"points":Gt.properties.push({id:"custom.showPoints",value:Ln?rt.yL.Always:rt.yL.Never});break;case"bars":Ln?(Gt.properties.push({id:"custom.drawStyle",value:rt.GR.Bars}),Gt.properties.push({id:"custom.fillOpacity",value:100})):Gt.properties.push({id:"custom.drawStyle",value:rt.GR.Line});break;case"lines":Ln?Gt.properties.push({id:"custom.drawStyle",value:"line"}):Gt.properties.push({id:"custom.lineWidth",value:0});break;case"linewidth":Gt.properties.push({id:"custom.lineWidth",value:Ln});break;case"pointradius":Gt.properties.push({id:"custom.pointSize",value:2+Ln*2});break;case"dashLength":case"spaceLength":case"dashes":switch(pn||(pn={fill:tt.fill,dash:[...tt.dash]}),zn){case"dashLength":pn.dash[0]=Ln;break;case"spaceLength":pn.dash[1]=Ln;break;case"dashes":pn.fill=Ln?"dash":"solid";break}break;case"stack":Gt.properties.push({id:"custom.stacking",value:Af(Ln)});break;case"color":Gt.properties.push({id:"color",value:{fixedColor:Ln,mode:On.Y.Fixed}});break;case"transform":Gt.properties.push({id:"custom.transform",value:Ln==="negative-Y"?rt.NU.NegativeY:rt.NU.Constant});break;default:console.log("Ignore override migration:",Xt.alias,zn,Ln)}}pn&&Gt.properties.push({id:"custom.lineStyle",value:pn}),Gt.properties.length&&Me.push(Gt)}const bt=ze.custom??{};bt.drawStyle=J.bars?rt.GR.Bars:J.lines?rt.GR.Line:rt.GR.Points,J.points?(bt.showPoints=rt.yL.Always,(0,N.isNumber)(J.pointradius)&&(bt.pointSize=2+J.pointradius*2)):bt.drawStyle!==rt.GR.Points&&(bt.showPoints=rt.yL.Never),bt.lineWidth=J.linewidth,tt.fill!=="solid"&&(bt.lineStyle=tt),it?bt.fillOpacity=35:(0,N.isNumber)(J.fill)&&(bt.fillOpacity=J.fill*10),(0,N.isNumber)(J.fillGradient)&&J.fillGradient>0&&(bt.gradientMode=rt.on.Opacity,bt.fillOpacity=J.fillGradient*10),bt.spanNulls=J.nullPointMode===gd.UW.Ignore,J.steppedLine&&(bt.lineInterpolation=rt.dx.StepAfter),bt.drawStyle===rt.GR.Bars&&(bt.fillOpacity=100),J.stack&&(bt.stacking={mode:J.percentage?rt.gs.Percent:rt.gs.Normal,group:ur.S.stacking.group},J.percentage&&J.yaxis&&(delete ze.min,delete ze.max,ze.decimals===0&&delete ze.decimals)),ze.custom=(0,N.omitBy)(bt,N.isNil),ze.nullValueMode=J.nullPointMode;const Lt={legend:{displayMode:rt.lm.List,showLegend:!0,placement:"bottom",calcs:[]},tooltip:{mode:rt.$N.Single,sort:rt.xB.None}},Nt=J.legend;if(Nt){if(Nt.show?Lt.legend.displayMode=Nt.alignAsTable?rt.lm.Table:rt.lm.List:Lt.legend.showLegend=!1,Nt.rightSide&&(Lt.legend.placement="right"),J.legend.values){const Xt=(0,N.pickBy)(J.legend);Lt.legend.calcs=Of(Xt)}J.legend.sideWidth&&(Lt.legend.width=J.legend.sideWidth),Nt.hideZero&&Me.push(Yd(Ii.gy.allIsZero)),Nt.hideEmpty&&Me.push(Yd(Ii.gy.allIsNull))}J.timeRegions?.length&&J.timeRegions.map((cn,Gt)=>({name:`T${Gt}`,color:cn.colorMode!=="custom"?cn.colorMode:cn.fillColor,line:cn.line,fill:cn.fill,fromDayOfWeek:cn.fromDayOfWeek,toDayOfWeek:cn.toDayOfWeek,from:cn.from,to:cn.to})).forEach((cn,Gt)=>{const pn={datasource:{type:"datasource",uid:"grafana"},enable:!0,hide:!0,filter:{exclude:!1,ids:[J.panel.id]},iconColor:cn.fillColor??cn.color,name:`Time region for panel ${J.panel.title}${Gt>0?` ${Gt}`:""}`,target:{queryType:Tf.nj.TimeRegions,refId:"Anno",timeRegion:{fromDayOfWeek:cn.fromDayOfWeek,toDayOfWeek:cn.toDayOfWeek,from:cn.from,to:cn.to,timezone:"utc"}}};cn.fill?pe.push(pn):cn.line&&(pn.iconColor=cn.lineColor??"white",pe.push(pn))});const Ht=J.tooltip;if(Ht&&(Ht.shared!==void 0&&(Lt.tooltip.mode=Ht.shared?rt.$N.Multi:rt.$N.Single),Ht.sort!==void 0&&Ht.shared))switch(Ht.sort){case 1:Lt.tooltip.sort=rt.xB.Ascending;break;case 2:Lt.tooltip.sort=rt.xB.Descending;break;default:Lt.tooltip.sort=rt.xB.None}if(J.thresholds&&J.thresholds.length>0){let Xt=[],cn=!1,Gt=!1;const pn=J.thresholds.sort((Ln,Kn)=>Ln.value>Kn.value?1:-1);for(let Ln=0;Ln<pn.length;Ln++){const Kn=pn[Ln],Rn=pn.length>Ln+1?pn[Ln+1]:null;Kn.fill&&(cn=!0),Kn.line&&(Gt=!0),Kn.op==="gt"&&Xt.push({value:Kn.value,color:Oc(Kn)}),Kn.op==="lt"&&(Xt.length===0&&Xt.push({value:-1/0,color:Oc(Kn)}),Rn&&Rn.op==="gt"&&Rn.value>Kn.value?Xt.push({value:Kn.value,color:"transparent"}):Rn&&Rn.op==="lt"?Xt.push({value:Kn.value,color:Oc(Rn)}):Xt.push({value:Kn.value,color:"transparent"}))}Xt.length>0&&Xt[0].value!==-1/0&&Xt.unshift({color:"transparent",value:-1/0});let zn=cn?rt.Ly.Area:rt.Ly.Line;Gt&&cn&&(zn=rt.Ly.LineAndArea),ze.custom.thresholdsStyle={mode:zn},ze.thresholds={mode:Sc.O.Absolute,steps:Xt}}return J.xaxis&&J.xaxis.show===!1&&J.xaxis.mode==="time"&&Me.push({matcher:{id:pi.Ct.byType,options:jt.PU.time},properties:[{id:"custom.axisPlacement",value:rt.vM.Hidden}]}),{fieldConfig:{defaults:(0,N.omitBy)(ze,N.isNil),overrides:Me},options:Lt,annotations:pe}}function Oc(J){return J.colorMode==="critical"?"red":J.colorMode==="warning"?"orange":J.colorMode==="custom"?J.fillColor||J.lineColor:"red"}function Gd(J){if(!J)return{};const pe={axisPlacement:J.show?rt.vM.Auto:rt.vM.Hidden};if(J.label&&(pe.axisLabel=J.label),J.logBase){const Me=J.logBase;(Me===2||Me===10)&&(pe.scaleDistribution={type:rt.L4.Log,log:Me})}return(0,N.omitBy)({unit:J.format,decimals:bl(J.decimals),min:bl(J.min),max:bl(J.max),custom:pe},N.isNil)}function Qd(J,pe,Me){for(const[tt,it]of Object.entries(pe))tt!=="custom"&&it!==J[tt]&&Me.push({id:tt,value:it});Me.push({id:"custom.axisPlacement",value:rt.vM.Right});const Ue=J.custom??{},ze=pe.custom??{};for(const[tt,it]of Object.entries(ze))it!==Ue[tt]&&Me.push({id:`custom.${tt}`,value:it})}function bl(J){if((0,N.isNumber)(J))return J;if((0,N.isString)(J)){const pe=Number(J);if(!isNaN(pe))return pe}}function Of(J){const pe=[];for(const Me in J){const Ue=Ii.AS.getIfExists(Me);Ue&&pe.push(Ue.id)}return pe}function If(J){J.fieldConfig?.defaults?.custom?.hideFrom?.graph!==void 0&&(J.fieldConfig.defaults.custom.hideFrom.viz=J.fieldConfig.defaults.custom.hideFrom.graph,delete J.fieldConfig.defaults.custom.hideFrom.graph),J.fieldConfig?.overrides&&(J.fieldConfig.overrides=J.fieldConfig.overrides.map(pe=>(pe.properties=pe.properties.map(Me=>(Me.id==="custom.hideFrom"&&Me.value.graph&&(Me.value.viz=Me.value.graph,delete Me.value.graph),Me)),pe)))}function Yd(J){return{matcher:{id:pi.Ct.byValue,options:{reducer:J,op:rt.zT.GTE,value:0}},properties:[{id:"custom.hideFrom",value:{tooltip:!0,viz:!1,legend:!0}}]}}function Af(J){const pe=ur.S.stacking?.group;return{mode:J?rt.gs.Normal:rt.gs.None,group:(0,N.isString)(J)?J:pe}}function Rf(J){const pe=window.__grafanaSceneContext;if(pe instanceof Hd.H$){const Ue=kd.b4.getDataLayers(pe),ze=[...Ue.state.annotationLayers];for(let tt of J){const it=new Jl.g({key:`annotations-${tt.name}`,query:tt,name:tt.name,isEnabled:tt.enable,isHidden:tt.hide});ze.push(it)}Ue.setState({annotationLayers:ze});return}const Me=(0,He.UA)().getCurrent();Me&&(Me.annotations.list=[...Me.annotations.list,...J],ji==null&&(ji=setTimeout(()=>{ji=null,(0,Cf.jG)().refreshTimeModel()})))}const Lf=new b.m(bf).setPanelChangeHandler(Mf).useFieldConfig((0,ur.V)(ur.S)).setPanelOptions(J=>{Yn.D(J,!1,!0),Wn.H(J),J.addCustomEditor({id:"timezone",name:"Time zone",path:"timezone",category:["Axis"],editor:Mc,defaultValue:void 0})}).setSuggestionsSupplier(new Yr).setDataSupport({annotations:!0,alertStates:!0});var Jd=e(92599),jf=e(35090);const Ic={wrapper:(0,q.css)`
    height: 100%;
    overflow: scroll;
  `},Bf=({data:J,options:pe})=>{const Me=(0,V.createRef)(),Ue=(0,V.useMemo)(()=>(0,jf.L)(J.series[0]),[J.series]),ze=(0,yd.A)(async()=>await(0,xd.l)().get(J.request?.targets[0].datasource?.uid));return!J||!J.series.length||!Ue?(0,T.jsx)("div",{className:"panel-empty",children:(0,T.jsx)("p",{children:"No data found in response"})}):(0,T.jsxs)("div",{className:Ic.wrapper,children:[(0,T.jsx)("div",{ref:Me}),(0,T.jsx)(Jd.V,{dataFrames:J.series,scrollElementClass:Ic.wrapper,traceProp:Ue,datasource:ze.value,topOfViewRef:Me,createSpanLink:pe.createSpanLink,focusedSpanId:pe.focusedSpanId,createFocusSpanLink:pe.createFocusSpanLink})]})};class Xd{getListWithDefaults(pe){return pe.getListAppender({name:xs.m.Trace,pluginId:"traces"})}getSuggestionsForData(pe){!pe.data||!pe.data.series[0]||pe.data.series[0].meta?.preferredVisualisationType==="trace"&&this.getListWithDefaults(pe).append({name:xs.m.Trace,score:Ot.nQ.Best})}}const Uf=new b.m(Bf).setSuggestionsSupplier(new Xd);var Nf=e(85200),wf=e(40458);const Dp=({data:J,timeRange:pe,timeZone:Me,width:Ue,height:ze,options:tt,fieldConfig:it,replaceVariables:bt,id:Lt})=>{const{dataLinkPostProcessor:Nt}=(0,da.d2)(),Ht=tt.xField??J.series[0].fields.find(Gt=>Gt.type===jt.PU.number)?.name,Xt=(Gt,pn,zn)=>(pn={...pn,x:Nf.sJ.get(pi.Ct.byName).get(Ht)},(0,wf.m)(Gt,pn)),cn=(0,V.useMemo)(()=>{if(J.series.length>1)return{warning:"Only one frame is supported, consider adding a join transformation",frames:J.series};let Gt=J.series,pn;if(tt.xField){if(pn=(0,Yo.findFieldIndex)(tt.xField,Gt[0]),pn==null)return{warning:"Unable to find field: "+tt.xField,frames:J.series}}else if(pn=Gt[0].fields.findIndex(zn=>zn.type===jt.PU.number),pn===-1)return{warning:"No numeric fields found for X axis",frames:Gt};if(pn!=null){const zn=Gt[0].fields[pn];if(zn.type===jt.PU.number&&!(0,$n.g2)(zn.values))return{warning:"Values must be in ascending order",frames:Gt}}return{frames:(0,_s.B_)(Gt,I.$.theme2,void 0,pn)}},[J.series,tt.xField]);return cn.warning||!cn.frames?(0,T.jsx)(fs.a,{panelId:Lt,fieldConfig:it,data:J,message:cn.warning,needsNumberField:!0}):(0,T.jsx)(Qo,{frames:cn.frames,structureRev:J.structureRev,timeRange:pe,timeZone:Me,width:Ue,height:ze,legend:tt.legend,options:tt,preparePlotFrame:Xt,replaceVariables:bt,dataLinkPostProcessor:Nt,children:(Gt,pn)=>(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(ro.Z,{config:Gt}),tt.tooltip.mode!==rt.$N.None&&(0,T.jsx)(Ms.xl,{config:Gt,hoverMode:tt.tooltip.mode===rt.$N.Single?Ms.b3.xOne:Ms.b3.xAll,render:(zn,Ln,Kn,Rn=!1)=>(0,T.jsx)(ks.k,{series:pn,dataIdxs:Ln,seriesIdx:Kn,mode:tt.tooltip.mode,sortOrder:tt.tooltip.sort,isPinned:Rn,maxHeight:tt.tooltip.maxHeight}),maxWidth:tt.tooltip.maxWidth})]})})};class Ac{getSuggestionsForData(pe){const{dataSummary:Me}=pe;return Me.numberFieldCount<2||Me.rowCountTotal<2||Me.rowCountTotal<2?void 0:pe.getListAppender({name:xs.m.LineChart,pluginId:"trend",options:{legend:{calcs:[],displayMode:rt.lm.Hidden,placement:"right",showLegend:!1}},fieldConfig:{defaults:{custom:{}},overrides:[]},cardOptions:{previewModifier:ze=>{ze.fieldConfig?.defaults.custom?.drawStyle!==rt.GR.Bars&&(ze.fieldConfig.defaults.custom.lineWidth=Math.max(ze.fieldConfig.defaults.custom.lineWidth??1,2))}}})}}const Pp=new b.m(Dp).useFieldConfig((0,ur.V)(ur.S,!1)).setPanelOptions(J=>{const pe=["X Axis"];J.addFieldNamePicker({path:"xField",name:"X Field",description:"An increasing numeric value",category:pe,defaultValue:void 0,settings:{isClearable:!0,placeholderText:"First numeric value",filter:Me=>Me.type===jt.PU.number}}),Yn.D(J,!1,!0),Wn.H(J)}).setSuggestionsSupplier(new Ac),bp=[{value:0,label:"Documentation",href:"https://grafana.com/docs/grafana/latest"},{value:1,label:"Tutorials",href:"https://grafana.com/tutorials"},{value:2,label:"Community",href:"https://community.grafana.com"},{value:3,label:"Public Slack",href:"http://slack.grafana.com"}],Cp=()=>{const J=(0,te.of)(Wf);return(0,T.jsxs)("div",{className:J.container,children:[(0,T.jsx)("h1",{className:J.title,children:"Welcome to SyncCity"}),(0,T.jsxs)("div",{className:J.help,children:[(0,T.jsx)("h3",{className:J.helpText,children:"Need help?"}),(0,T.jsx)("div",{className:J.helpLinks,children:bp.map((pe,Me)=>(0,T.jsx)("a",{className:J.helpLink,href:`${pe.href}?utm_source=grafana_gettingstarted`,children:pe.label},`${pe.label}-${Me}`))})]})]})},Wf=J=>({container:(0,q.css)`
      display: flex;
      /// background: url(public/img/g8_home_v2.svg) no-repeat;
      background-size: cover;
      height: 100%;
      align-items: center;
      padding: 0 16px;
      justify-content: space-between;
      padding: 0 ${J.spacing(3)};

      ${J.breakpoints.down("lg")} {
        background-position: 0px;
        flex-direction: column;
        align-items: flex-start;
        justify-content: center;
      }

      ${J.breakpoints.down("sm")} {
        padding: 0 ${J.spacing(1)};
      }
    `,title:(0,q.css)`
      margin-bottom: 0;

      ${J.breakpoints.down("lg")} {
        margin-bottom: ${J.spacing(1)};
      }

      ${J.breakpoints.down("md")} {
        font-size: ${J.typography.h2.fontSize};
      }
      ${J.breakpoints.down("sm")} {
        font-size: ${J.typography.h3.fontSize};
      }
    `,help:(0,q.css)`
      display: flex;
      align-items: baseline;
    `,helpText:(0,q.css)`
      margin-right: ${J.spacing(2)};
      margin-bottom: 0;

      ${J.breakpoints.down("md")} {
        font-size: ${J.typography.h4.fontSize};
      }

      ${J.breakpoints.down("sm")} {
        display: none;
      }
    `,helpLinks:(0,q.css)`
      display: flex;
      flex-wrap: wrap;
    `,helpLink:(0,q.css)`
      margin-right: ${J.spacing(2)};
      text-decoration: underline;
      text-wrap: no-wrap;

      ${J.breakpoints.down("sm")} {
        margin-right: 8px;
      }
    `}),Ff=new b.m(Cp).setNoPadding(),Bi={"core:plugin/graphite":async()=>await e.e(6134).then(e.bind(e,8652)),"core:plugin/cloudwatch":async()=>await Promise.all([e.e(1765),e.e(2651),e.e(3766)]).then(e.bind(e,92651)),"core:plugin/dashboard":async()=>await e.e(2058).then(e.bind(e,92058)),"core:plugin/elasticsearch":async()=>await Promise.all([e.e(1765),e.e(6144),e.e(8747),e.e(1717)]).then(e.bind(e,18747)),"core:plugin/opentsdb":async()=>await e.e(747).then(e.bind(e,24989)),"core:plugin/grafana":async()=>await e.e(3648).then(e.bind(e,62391)),"core:plugin/influxdb":async()=>await Promise.all([e.e(4669),e.e(9404)]).then(e.bind(e,21106)),"core:plugin/loki":async()=>await Promise.all([e.e(6144),e.e(9656),e.e(1477)]).then(e.bind(e,99656)),"core:plugin/mixed":async()=>await e.e(2513).then(e.bind(e,12870)),"core:plugin/mssql":async()=>await Promise.all([e.e(4669),e.e(9040)]).then(e.bind(e,56694)),"core:plugin/prometheus":async()=>await Promise.all([e.e(1765),e.e(6144),e.e(8314),e.e(9546)]).then(e.bind(e,88314)),"core:plugin/alertmanager":async()=>await Promise.all([e.e(1765),e.e(4737)]).then(e.bind(e,27013)),"core:plugin/text":D,"core:plugin/timeseries":P,"core:plugin/trend":E,"core:plugin/state-timeline":d,"core:plugin/status-history":v,"core:plugin/candlestick":r,"core:plugin/graph":async()=>await Promise.all([e.e(9362),e.e(8068)]).then(e.bind(e,229)),"core:plugin/xychart":async()=>I.$.featureToggles.autoMigrateXYChartPanel?await Promise.all([e.e(8891),e.e(3772)]).then(e.bind(e,80983)):await Promise.all([e.e(707),e.e(5594)]).then(e.bind(e,31552)),"core:plugin/geomap":async()=>await Promise.all([e.e(1698),e.e(707),e.e(7734),e.e(190)]).then(e.bind(e,7734)),"core:plugin/canvas":async()=>await Promise.all([e.e(707),e.e(7523)]).then(e.bind(e,44210)),"core:plugin/dashlist":f,"core:plugin/alertlist":t,"core:plugin/annolist":n,"core:plugin/heatmap":async()=>await Promise.all([e.e(8891),e.e(5857)]).then(e.bind(e,26235)),"core:plugin/table":u,"core:plugin/table-old":async()=>await e.e(8777).then(e.bind(e,78491)),"core:plugin/news":m,"core:plugin/live":l,"core:plugin/stat":xp,"core:plugin/datagrid":a,"core:plugin/debug":c,"core:plugin/flamegraph":o,"core:plugin/gettingstarted":h,"core:plugin/gauge":Fu,"core:plugin/piechart":y,"core:plugin/bargauge":s,"core:plugin/barchart":i,"core:plugin/logs":p,"core:plugin/traces":x,"core:plugin/welcome":C,"core:plugin/nodeGraph":async()=>await Promise.all([e.e(1698),e.e(5511),e.e(7317)]).then(e.bind(e,68403)),"core:plugin/histogram":g};var Cl=e(81900),Xl=e(63770),zf=e(52762),Hf=e(20582),kf=e(21313),Gf=e(72635),Ho=e(34796),eu=e.n(Ho),tu=e(95093),Qf=e.n(tu),Yf=e(28848),nu=e.n(Yf),Jf=e(40961),Xf=e(8867),jc=e(71468),Zf=e(54625),qf=e(24160),Bc=e(14644),Uc=e(75091),eg=e(32975),Nc=e(82611),tg=e(52845),wc=e(29317),Np=e(54087),ng=e(80851),wp=e(32176),su=e(31221),Wp=e(91520),Fp=e(92275),Kp=e(82013),Tl=e(2341),$p=e(19538),sg=e(33459),ag=e(85858),rg=e(7117),og=e(8984),au=e(91950),ru=e(31140),ig=e(78827),lg=e(68576),cg=e(92247);const Ml=og;Ml.PanelPlugin=b.m,Ml.DataSourcePlugin=M.tD,Ml.AppPlugin=S.hX,Ml.DataSourceApi=M.mA;const ou=["jquery.flot.crosshair","jquery.flot.events","jquery.flot.fillbelow","jquery.flot.gauge","jquery.flot.pie","jquery.flot.selection","jquery.flot.stack","jquery.flot.stackpercent","jquery.flot.time","jquery.flot"].reduce((J,pe)=>({...J,[pe]:{fakeDep:1}}),{}),dg={"@emotion/css":q,"@emotion/react":zf,"@grafana/data":sg,"@grafana/runtime":rg,"@grafana/slate-react":wc.Ay,"@grafana/ui":Ml,"@kusto/monaco-kusto":Hf,"app/core/app_events":{default:Fe.lE,__useDefault:!0},"app/core/config":{default:ce.Ay,__useDefault:!0},"app/core/core":{appEvents:Fe.lE,contextSrv:Fe.TP},"app/core/services/backend_srv":{BackendSrv:Tt.Mf,getBackendSrv:Tt.AI},"app/core/table_model":{default:au.A,__useDefault:!0},"app/core/time_series":{default:ru.A,__useDefault:!0},"app/core/time_series2":{default:ru.A,__useDefault:!0},"app/core/utils/datemath":ag,"app/core/utils/flatten":ig,"app/core/utils/kbn":{default:lg.A,__useDefault:!0},"app/core/utils/ticks":cg,"app/features/dashboard/impression_store":{impressions:_t.A},d3:kf,emotion:q,i18next:Gf,jquery:{default:eu(),__useDefault:!0},...ou,lodash:{default:B(),__useDefault:!0},moment:{default:Qf(),__useDefault:!0},prismjs:nu(),react:V,"react-dom":Jf,"react-inlinesvg":Xf,"react-redux":jc,"react-router-dom":Zf,"react-router":qf,redux:Bc,rxjs:Uc,"rxjs/operators":eg,slate:Nc.Ay,"slate-plain-serializer":tg.A,"slate-react":wc.Ay};function Sl({url:J,source:pe,transformSourceMapURL:Me=!1,transformAssets:Ue=!0}){const ze=J.split("/public/plugins/"),tt=ze[0],it=ze[1].split("/")[0];let bt=pe;return Ue&&(bt=bt.replace(/(\/?)(public\/plugins)/g,`${tt}/$2`),bt=bt.replace(/(["|'])(plugins\/.+?.css)(["|'])/g,`$1${tt}/public/$2$3`)),Me&&(bt=bt.replace(/(\/\/#\ssourceMappingURL=)(.+)\.map/g,`$1${tt}/public/plugins/${it}/$2.map`)),bt}var Wc=e(45179),xi=e(94429);async function iu(J,pe,Me){const Ue=await J(pe,Me),ze=Ue.headers.get("content-type")||"";if(Wc.Bu.test(ze)){let it=await Ue.text();if((0,xi.OD)(Ue.url)){const bt=Sl({url:Ue.url,source:it});return new Response(new Blob([bt],{type:"text/javascript"}))}return new Response(new Blob([it],{type:"text/javascript"}))}return Ue}function lu(J,pe,Me){try{const Ue=J.apply(this,[pe,Me]),ze=hg(Ue);return(ze.endsWith(".js")||ze.endsWith(".css"))&&!(0,xi.OD)(ze)?(0,Cl.ni)(ze):ze}catch{if(Wc.$b.test(pe)){const ze=`${I.$.appSubUrl??""}/public/${pe}`,tt=J.apply(this,[ze,Me]);return(0,Cl.ni)(tt)}return console.warn(`SystemJS: failed to resolve '${pe}'`),pe}}function ug(J,pe){if(new URL(pe,window.location.origin).pathname.endsWith(".css")&&!J){const ze=Xl.z.get(pe)?.default;ze&&(document.adoptedStyleSheets=[...document.adoptedStyleSheets,ze])}}function hg(J){return J.startsWith(`${Wc.XV}:`)?J:(J.endsWith("!")&&(J=J.slice(0,-1)),["css","js","json","wasm"].some(Ue=>J.endsWith(Ue))?J:J+".js")}var fg=e(22055),gg=e(6262),cu=e(35853),Ol=e(43429);function Fc(J){const pe=new URL(window.location.href),Me=new URL(J);return pe.host===Me.host}async function pg(J,pe){let Me="";if(Fc(J)?(Me=await(await fetch(J)).text(),Me=Sl({url:J,source:Me,transformSourceMapURL:!0,transformAssets:!1})):(0,xi.OD)(J)&&(Me=await(await fetch(J)).text(),Me=Sl({url:J,source:Me,transformSourceMapURL:!0,transformAssets:!0})),Me.length===0)throw new Error("Only same domain scripts are allowed in sandboxed plugins");Me=du(Me),pe.evaluate(Me)}async function mg(J){if((0,xi.OD)(J.module)){const pe=J.module;let Ue=await(await fetch(pe)).text();return Ue=Sl({url:pe,source:Ue,transformSourceMapURL:!0,transformAssets:!0}),Ue}else{let pe=(0,xi.Av)(J.module);const Me=(0,Cl.ni)(pe);let ze=await(await fetch(Me)).text();return ze=Sl({url:Me,source:ze,transformSourceMapURL:!0,transformAssets:!1}),ze=du(ze),ze}}function du(J){return J.replace(/window\.location/gi,"window.locationSandbox")}function vg(J){J.evaluate(`${cu.V.toString()};${cu.V.name}()`)}function yg(J){for(const pe of Object.values(I.$.datasources))if(pe.type===J)return pe.meta;for(const pe of Object.values(I.$.panels))if(pe.id===J)return pe;for(const pe of Object.values(I.$.apps))if(pe.id===J)return{id:J,type:Ol.QE.app,module:pe.path};throw new Error(`Could not find plugin ${J}`)}const bo=["iframe"];var Zl=e(7077),ql=e(29505),xg=e(34867),Eg=e(27716);const Dg=!!I.$.featureToggles.frontendSandboxMonitorOnly;function Pg(J){return!!J&&typeof J=="object"&&J?.hasOwnProperty("plugin")}function Vp(J){throw new Error(`Unexpected object: ${J}. This should never happen.`)}const Kc=(0,xg.DW)("sandbox",{monitorOnly:String(Dg)});function bg(J){return J instanceof V.Component}function jo(J,pe){Kc.logWarning(J,pe)}function Il(J,pe){Kc.logError(J,pe)}function $c(J,pe){Kc.logInfo(J,pe)}async function Cg({isAngular:J,pluginId:pe}){if(!I.$.featureToggles.pluginsFrontendSandbox||J||location.search.includes("nosandbox")&&I.$.buildInfo.env==="development"||I.$.disableFrontendSandboxForPlugins.includes(pe))return!1;const ze=await(0,Eg.x)(pe);return!(ze.type===Ol.QE.app&&ze.signatureType===Ol.kv.grafana)}function Tg(J){return J?.constructor?.name==="RegExp"}function Vc(J){return J&&(Tg(J)&&(0,Zl.U)(J)?new RegExp(J):Array.isArray(J)?J.map(Vc):typeof J=="object"?Object.keys(J).reduce((pe,Me)=>(Reflect.set(pe,Me,Vc(Reflect.get(J,Me))),pe),{}):J)}function _c(J){return J&&((0,Zl.U)(J)?(0,N.cloneDeep)(J):Array.isArray(J)?J.map(_c):typeof J=="object"?Object.keys(J).reduce((pe,Me)=>(Reflect.set(pe,Me,_c(Reflect.get(J,Me))),pe),{}):J)}const Ei=Symbol.for("@@SANDBOX_LIVE_VALUE"),uu=!!I.$.featureToggles.frontendSandboxMonitorOnly;function Mg(J,pe){const Me=Reflect.get(J,"nodeName");if(Me==="body"||J===document.body)return document.body;if(Me==="head"||J===document.head||J===document.documentElement)return J;if(bo.includes(Me)&&(jo("<"+Me+"> is not allowed in sandboxed plugins",{pluginId:pe,param:Me}),!uu))throw new Error("<"+Me+"> is not allowed in sandboxed plugins");if(gu(J,pe)||J.parentNode===document.body||J.closest("#reactRoot")===null||uu)return J;{const Ue=document.createElement(Me);return Ue.dataset.grafanaPluginSandboxElement="true",Ue}}function Sg(J){if(typeof J=="object"&&J instanceof Element)try{return J.nodeName!==void 0}catch{return!1}return!1}function Og(J){const pe=Reflect.get(J,"style");Object.hasOwn(pe,Ei)||Reflect.defineProperty(pe,Ei,{})}function zc(J){J&&(Array.isArray(J)?(J.forEach(zc),hu(J)):typeof J=="object"&&(Object.values(J).forEach(zc),hu(J)))}function hu(J){if(J)return Object.hasOwn(J,Ei)||Reflect.defineProperty(J,Ei,{}),J}function Ig(J){J&&(Object.hasOwn(J,Ei)||((0,Zl.U)(J)&&!(J instanceof Function)&&(bg(J)||J instanceof M.mA||J instanceof ql.f5)?Reflect.defineProperty(J,Ei,{}):J===nu().languages&&Object.defineProperty(J,Ei,{})))}function fu(J){return Object.hasOwn(J,Ei)}function gu(J,pe){return!document.contains(J)||J.closest(`[data-plugin-sandbox=${pe}]`)!==null}let Co;function pu(){return Co||(Co=document.createElement("div"),Co.setAttribute("id","grafana-plugin-sandbox-body"),Co.setAttribute("data-plugin-sandbox","true"),Co.dataset.pluginSandbox="sandboxed-plugin",Co.style.width="100%",Co.style.height="0%",Co.style.overflow="hidden",Co.style.top="0",Co.style.left="0",document.body.appendChild(Co)),Co}let mu=!1;function Ag(){mu||(mu=!0,yu(),vu())}function vu(){const J=Worker.prototype.postMessage;Object.defineProperty(Worker.prototype,"postMessage",{value:function(...pe){return J.apply(this,_c(pe))}})}function yu(){const J=window.history.replaceState;Object.defineProperty(window.history,"replaceState",{value:function(...pe){let Me=pe;try{Me=(0,N.cloneDeep)(pe)}catch(Ue){jo("Error cloning args in window.history.replaceState",{error:String(Ue)})}return Reflect.apply(J,this,Me)},writable:!0,configurable:!0,enumerable:!1})}const uo=new Map,ti=!!I.$.featureToggles.frontendSandboxMonitorOnly,xu=Symbol.for("@SANDBOX_LIVE_API_PATCHED");function Eu(){return uo.size===0&&(Rg(uo),Lg(uo),jg(uo),wg(uo),Ng(uo),Bg(uo),Ug(uo),Wg(uo),Fg(uo),Du(uo),Kg(uo),Vg(uo)),uo}function ec(J,pe){return jo(`Plugin ${pe.id} tried to set a sandboxed property`,{pluginId:pe.id,attrOrMethod:String(J),entity:"window"}),ti?J:()=>{throw new Error("Plugins are not allowed to set sandboxed properties")}}function Rg(J){const pe=["contentDocument","contentWindow","src","srcdoc","srcObject","srcset"];for(const Ue of pe){const ze=Object.getOwnPropertyDescriptor(HTMLIFrameElement.prototype,Ue);if(ze){let tt=function(it,bt){const Lt=bt.id;return jo(`Plugin ${Lt} tried to access iframe.${Ue}`,{pluginId:Lt,attrOrMethod:Ue,entity:"iframe"}),ti?it:()=>{throw new Error("iframe."+Ue+" is not allowed in sandboxed plugins")}};var Me=tt;ze.value&&J.set(ze.value,tt),ze.set&&J.set(ze.set,tt),ze.get&&J.set(ze.get,tt)}}}function Lg(J){const pe=Object.getOwnPropertyDescriptor(window,"console");if(pe?.value){let Ue=function(ze,tt){const it=tt.id;if(ti)return ze;function bt(...Lt){console.log(`[plugin ${it}]`,...Lt)}return{log:bt,warn:bt,error:bt,info:bt,debug:bt,table:bt}};var Me=Ue;J.set(pe.value,Ue)}pe?.set&&J.set(pe.set,ec)}function jg(J){function pe(Ue,ze){const tt=ze.id;return jo(`Plugin ${tt} accessed window.alert`,{pluginId:tt,attrOrMethod:"alert",entity:"window"}),ti?Ue:function(...it){console.log(`[plugin ${tt}]`,...it)}}const Me=Object.getOwnPropertyDescriptor(window,"alert");Me?.value&&J.set(Me.value,pe),Me?.set&&J.set(Me.set,ec)}function Bg(J){function pe(Ue,ze){const tt=ze.id;return function(...bt){for(const Lt of bt){const Nt=String(Lt||"").toLowerCase();for(const Ht of bo)if(Nt.includes("<"+Ht)){if(jo(`Plugin ${tt} tried to set ${Ht} in innerHTML`,{pluginId:tt,attrOrMethod:"innerHTML",param:Ht,entity:"HTMLElement"}),ti)continue;throw new Error("<"+Ht+"> is not allowed in sandboxed plugins")}}if((0,N.isFunction)(Ue))return Ue.apply(this,bt)}}const Me=[Object.getOwnPropertyDescriptor(Element.prototype,"innerHTML"),Object.getOwnPropertyDescriptor(Element.prototype,"outerHTML"),Object.getOwnPropertyDescriptor(Element.prototype,"insertAdjacentHTML"),Object.getOwnPropertyDescriptor(DOMParser.prototype,"parseFromString")];for(const Ue of Me)Ue?.set&&J.set(Ue.set,pe),Ue?.value&&J.set(Ue.value,pe)}function Ug(J){function pe(Ue,ze){const tt=ze.id;return function(bt,Lt){if(bt&&bo.includes(bt)&&(jo(`Plugin ${tt} tried to create ${bt}`,{pluginId:tt,attrOrMethod:"createElement",param:bt,entity:"document"}),!ti))return document.createDocumentFragment();if((0,N.isFunction)(Ue))return Ue.apply(this,[bt,Lt])}}const Me=Object.getOwnPropertyDescriptor(Document.prototype,"createElement");Me?.value&&J.set(Me.value,pe)}function Ng(J){function pe(tt,it){const bt=it.id;return function(Nt,Ht){const Xt=Nt?.nodeName?.toLowerCase()||"";if(Nt&&bo.includes(Xt)&&(jo(`Plugin ${bt} tried to insert ${Xt}`,{pluginId:bt,attrOrMethod:"insertChild",param:Xt,entity:"HTMLElement"}),!ti))return document.createDocumentFragment();if((0,N.isFunction)(tt))return tt.call(this,Nt,Ht)}}function Me(tt,it){const bt=it.id;return function(Nt,Ht){const Xt=Ht?.nodeName?.toLowerCase()||"";if(Ht&&bo.includes(Xt)&&(jo(`Plugin ${bt} tried to insert ${Xt}`,{pluginId:bt,attrOrMethod:"insertAdjacentElement",param:Xt,entity:"HTMLElement"}),!ti))return document.createDocumentFragment();if((0,N.isFunction)(tt))return tt.call(this,Nt,Ht)}}const Ue=[Object.getOwnPropertyDescriptor(Node.prototype,"insertBefore"),Object.getOwnPropertyDescriptor(Node.prototype,"replaceChild")];for(const tt of Ue)tt?.value&&J.set(tt.set,pe);const ze=Object.getOwnPropertyDescriptor(Element.prototype,"insertAdjacentElement");ze?.value&&J.set(ze.set,Me)}function wg(J){function pe(tt,it){const bt=it.id;return function(...Nt){let Ht=Nt;const Xt=Nt?.filter(cn=>!bo.includes(cn.nodeName.toLowerCase()));ti||(Ht=Xt),Ht.length!==Xt.length&&jo(`Plugin ${bt} tried to append fobiddenElements`,{pluginId:bt,attrOrMethod:"append",param:Nt?.filter(cn=>bo.includes(cn.nodeName.toLowerCase()))?.join(",")||"",entity:"HTMLElement"}),(0,N.isFunction)(tt)&&tt.apply(this,Ht)}}function Me(tt,it,bt){const Lt=it.id;return function(Ht){const Xt=Ht?.nodeName?.toLowerCase()||"";if(Ht&&bo.includes(Xt)&&(jo(`Plugin ${Lt} tried to append ${Xt}`,{pluginId:Lt,attrOrMethod:"appendChild",param:Xt,entity:"HTMLElement"}),!ti))return document.createDocumentFragment();if(bt&&Ht&&Xt==="script"&&Ht instanceof HTMLScriptElement){pg(Ht.src,bt).then(()=>{Ht.onload?.call(Ht,new Event("load"))}).catch(cn=>{Ht.onerror?.call(Ht,new ErrorEvent("error",{error:cn}))});return}if((0,N.isFunction)(tt))return tt.call(this,Ht)}}const Ue=[Object.getOwnPropertyDescriptor(Element.prototype,"append"),Object.getOwnPropertyDescriptor(Element.prototype,"prepend"),Object.getOwnPropertyDescriptor(Element.prototype,"after"),Object.getOwnPropertyDescriptor(Element.prototype,"before"),Object.getOwnPropertyDescriptor(Document.prototype,"append"),Object.getOwnPropertyDescriptor(Document.prototype,"prepend")];for(const tt of Ue)tt?.value&&J.set(tt.value,pe);const ze=Object.getOwnPropertyDescriptor(Node.prototype,"appendChild");ze?.value&&J.set(ze.value,Me)}function Wg(J){const pe=Object.getOwnPropertyDescriptor(Worker.prototype,"postMessage");function Me(Ue){return function(...tt){try{const it=(0,N.cloneDeep)(tt);(0,N.isFunction)(Ue)&&Ue.apply(this,it)}catch{throw new Error("postMessage arguments are invalid objects")}}}pe?.value&&J.set(pe.value,Me)}function Fg(J){const pe=Object.getOwnPropertyDescriptor(Document.prototype,"defaultView");pe?.get&&J.set(pe.get,()=>()=>window);const Me=["write"];for(const Ue of Me){const ze=Object.getOwnPropertyDescriptor(Document.prototype,Ue);ze?.set&&J.set(ze.set,ec),ze?.value&&J.set(ze.value,ec)}}async function Du(J){const pe=Reflect.get(window,"monaco");if(!pe||Object.hasOwn(pe,xu))return;const Me=pe.languages.setMonarchTokensProvider;function Ue(){return function(...ze){return ze.length!==2?Me.apply(pe,ze):Me.call(pe,ze[0],Vc(ze[1]))}}J.set(pe.languages.setMonarchTokensProvider,Ue),Reflect.set(pe,xu,{})}async function Kg(J){const pe=Object.getOwnPropertyDescriptor(window,"postMessage");function Me(Ue){return function(...tt){try{const it=(0,N.cloneDeep)(tt);(0,N.isFunction)(Ue)&&Ue.apply(this,it)}catch{throw new Error("postMessage arguments are invalid objects")}}}pe?.value&&J.set(pe.value,Me)}function $g(J){Du(uo)}function Vg(J){function pe(Me){return(0,N.isFunction)(Me)?function(...Ue){const ze=Me.apply(this,Ue);return zc(ze),ze}:Me}J.set(N.cloneDeep,pe)}var _g=e(66161);async function zg(J,pe){if(!Pg(J))return J;const Me=await Promise.resolve(J.plugin);if(Reflect.has(Me,"panel")&&Reflect.set(Me,"panel",Al(Reflect.get(Me,"panel"),pe)),Reflect.has(Me,"components")){const Ue=Reflect.get(Me,"components");Object.entries(Ue).forEach(([ze,tt])=>{Reflect.set(Ue,ze,Al(tt,pe))}),Reflect.set(Me,"components",Ue)}if(Reflect.has(Me,"root")&&Reflect.set(Me,"root",Al(Reflect.get(Me,"root"),pe)),Reflect.has(Me,"extensionConfigs")){const Ue=Reflect.get(Me,"extensionConfigs");for(const ze of Ue)Reflect.has(ze,"component")&&Reflect.set(ze,"component",Al(Reflect.get(ze,"component"),pe));Reflect.set(Me,"extensionConfigs",Ue)}if(Reflect.has(Me,"configPages")){const Ue=Reflect.get(Me,"configPages")??[];for(const[ze,tt]of Object.entries(Ue))!tt.body||!(0,N.isFunction)(tt.body)||Reflect.set(Ue,ze,{...tt,body:Al(tt.body,pe)});Reflect.set(Me,"configPages",Ue)}return J}const Al=(J,pe)=>{const Me=V.memo(Ue=>(0,T.jsx)("div",{"data-plugin-sandbox":pe.id,style:{height:pe.type===Ol.QE.app||pe.type===Ol.QE.panel?"100%":"auto"},children:(0,T.jsx)(J,{...Ue})}));return Me.displayName=`GrafanaSandbox(${J.displayName||J.name||"Component"})`,Me},Hc=new Map,Pu={};async function Hg({pluginId:J}){Ag();try{const pe=yg(J);return Hc.has(J)||Hc.set(J,kg(pe)),Hc.get(J)}catch(pe){const Me=new Error(`Could not import plugin ${J} inside sandbox: `+pe);throw Il(Me,{pluginId:J,error:String(pe)}),Me}}async function kg(J){return $c("Loading with sandbox",{pluginId:J.id}),new Promise(async(pe,Me)=>{const Ue=Eu();let ze;function tt(bt){if(Sg(bt)){const Ht=Mg(bt,J.id);return Og(Ht),Ht}else Ig(bt);const Lt=Ue.get(bt);if(Lt)return Lt(bt,J,ze);const Nt=$g(bt);return Nt||bt}ze=(0,fg.A)(window,{distortionCallback:tt,defaultPolicy:gg.G,liveTargetCallback:fu,endowments:Object.getOwnPropertyDescriptors({locationSandbox:window.location,setImmediate:function(bt,...Lt){return setTimeout(bt,0,...Lt)},get monaco(){return Reflect.get(window,"monaco")},get Prism(){return Reflect.get(window,"Prism")},get jQuery(){return Reflect.get(window,"jQuery")},get $(){return Reflect.get(window,"jQuery")},get grafanaBootData(){if(Pu[J.id+"-grafanaBootData"]||(Pu[J.id+"-grafanaBootData"]=!0,$c("Plugin using window.grafanaBootData",{sandbox:"true",pluginId:J.id,guessedPluginName:J.id,parent:"window",packageName:"window",key:"grafanaBootData"})),I.$.buildInfo.env==="development")throw new Error(`Error in ${J.id}: Plugins should not use window.grafanaBootData. Use "config" from "@grafana/runtime" instead.`);return console.error(`${J.id.toUpperCase()}: Plugins should not use window.grafanaBootData. Use "config" from "@grafana/runtime" instead.`),I.$.bootData},async define(bt,Lt,Nt){let Ht,Xt;Array.isArray(bt)?(Ht=bt,Xt=Lt):(Ht=Lt,Xt=Nt);try{const cn=Gg(Ht,J),Gt=Xt.apply(null,cn),pn=await zg(Gt,J);pe(pn)}catch(cn){const Gt=new Error(`Could not execute plugin's define ${J.id}: `+cn);Il(Gt,{pluginId:J.id,error:String(cn)}),Me(Gt)}}})}),vg(ze);let it="";try{it=await mg(J)}catch(bt){const Lt=new Error(`Could not load plugin code ${J.id}: `+bt);Il(Lt,{pluginId:J.id,error:String(bt)}),Me(Lt)}try{ze.evaluate(it)}catch(bt){const Lt=new Error(`Could not run plugin ${J.id} inside sandbox: `+bt);Il(Lt,{pluginId:J.id,error:String(bt)}),Me(Lt)}})}function Gg(J,pe){const Me={},Ue={id:pe.id,uri:pe.module,exports:Me},ze=[];for(const tt of J){let it=_g.s.get(tt);if(it?.__useDefault&&(it=it.default),tt==="module"&&(it=Ue),tt==="exports"&&(it=Me),!it){const bt=new Error(`[sandbox] Could not resolve dependency ${tt}`);throw Il(bt,{pluginId:pe.id,dependency:tt,error:String(bt)}),bt}ze.push(it)}return ze}const Qg=(0,xi.kB)(dg);Xl.z.addImportMap({imports:Qg});const ni=Xl.z.constructor.prototype;ni.shouldFetch=function(J){const pe=(0,Cl.QO)(J),Me=/^[^#?]+\.(js)([?#].*)?$/;return(0,xi.OD)(J)||!!pe?.isAngular||!Me.test(J)};const Yg=ni.import;ni.import=function(...J){return Yg.apply(this,J).then(pe=>pe&&pe.__useDefault?pe.default:pe)};const Jg=ni.fetch;ni.fetch=function(J,pe){return iu(Jg,J,pe)};const Xg=ni.resolve;ni.resolve=lu.bind(ni,Xg),ni.onload=ug;async function kc({path:J,version:pe,isAngular:Me,pluginId:Ue}){pe&&(0,Cl.GD)({pluginId:Ue,version:pe,isAngular:Me});const ze=Bi[J];if(ze)return typeof ze=="function"?await ze():ze;let tt=(0,xi.Av)(J);return await Cg({isAngular:Me,pluginId:Ue})?Hg({pluginId:Ue}):Xl.z.import(tt)}function Zg(J){const pe=J.angular?.detected??J.angularDetected;return kc({path:J.module,version:J.info?.version,isAngular:pe,pluginId:J.id}).then(Me=>{if(Me.plugin){const Ue=Me.plugin;return Ue.meta=J,Ue}if(Me.Datasource){const Ue=new M.tD(Me.Datasource);return Ue.setComponentsFromLegacyExports(Me),Ue.meta=J,Ue}throw new Error("Plugin module is missing DataSourcePlugin or Datasource constructor export")})}function qg(J){const pe=J.angular?.detected??J.angularDetected;return kc({path:J.module,version:J.info?.version,isAngular:pe,pluginId:J.id}).then(Me=>{const Ue=Me.plugin?Me.plugin:new S.hX;return Ue.init(J),Ue.meta=J,Ue.setComponentsFromLegacyExports(Me),Ue})}},66161:(G,O,e)=>{"use strict";e.d(O,{s:()=>t});const t=new Map([])},60677:(G,O,e)=>{"use strict";e.d(O,{W3:()=>f,Wy:()=>a,z4:()=>c});var t=e(43429),n=e(34867),i=e(15162),s=e(27716),r=e(685);async function f(o){const h=await(0,s.x)(o);let g;if(h.type===t.QE.app&&(g=await(0,r.ui)(h)),h.type===t.QE.datasource&&(g=await(0,r.cS)(h)),h.type===t.QE.panel&&(g=await(0,i.Kk)(h)),h.type===t.QE.renderer&&(g={meta:h}),!g)throw new Error("Unknown Plugin type: "+h.type);return g}function a(o,h,g){let p={...o},m;function y(v,u){return!u.startsWith(v.url??"")||m&&(m.url?.length??0)>(v.url?.length??0)?v:(m&&(m.active=!1),m={...v,active:!0},m)}function d(v,u=0){if(u>10)return v;if(v.children){const D=v.children.map(P=>d(P,u+1));return{...y(v,g),children:D}}return y(v,g)}return p.children=(p?.children??[]).map(d),{main:p,node:m??p}}const c=(0,n.DW)("features.plugins")},81862:(G,O,e)=>{"use strict";e.d(O,{Ay:()=>I,Cj:()=>g,HO:()=>u,Mj:()=>m,Nm:()=>p,Q9:()=>v,RS:()=>x,c1:()=>h,g$:()=>D,ny:()=>y,ri:()=>d,uh:()=>P,xu:()=>l});var t=e(65307),n=e(2543),i=e.n(n),s=e(72724),r=e(47232),f=e(2913),a=e(10096);const c={orgId:f.Ay.bootData.user.orgId,timeZone:f.Ay.bootData.user.timezone,weekStart:f.Ay.bootData.user.weekStart,fiscalYearStartMonth:0,orgsAreLoading:!1,sessionsAreLoading:!1,teamsAreLoading:!1,isUpdating:!1,orgs:[],sessions:[],teams:[],user:null},o=(0,t.Z0)({name:"user/profile",initialState:c,reducers:{updateTimeZone:(T,b)=>{T.timeZone=b.payload.timeZone},updateWeekStart:(T,b)=>{T.weekStart=b.payload.weekStart},updateFiscalYearStartMonth:(T,b)=>{T.fiscalYearStartMonth=b.payload.fiscalYearStartMonth},setUpdating:(T,b)=>{T.isUpdating=b.payload.updating},userLoaded:(T,b)=>{T.user=b.payload.user},initLoadTeams:(T,b)=>{T.teamsAreLoading=!0},teamsLoaded:(T,b)=>{T.teams=b.payload.teams,T.teamsAreLoading=!1},initLoadOrgs:(T,b)=>{T.orgsAreLoading=!0},orgsLoaded:(T,b)=>{T.orgs=b.payload.orgs,T.orgsAreLoading=!1},initLoadSessions:(T,b)=>{T.sessionsAreLoading=!0},sessionsLoaded:(T,b)=>{const R=b.payload.sessions.sort((A,L)=>Number(L.isActive)-Number(A.isActive));T.sessions=R.map(A=>({id:A.id,isActive:A.isActive,seenAt:(0,s.fq)(A.seenAt),createdAt:A.createdAt,clientIp:A.clientIp,browser:A.browser,browserVersion:A.browserVersion,os:A.os,osVersion:A.osVersion,device:A.device})),T.sessionsAreLoading=!1},userSessionRevoked:(T,b)=>{T.sessions=T.sessions.filter(R=>R.id!==b.payload.tokenId),T.isUpdating=!1}}}),h=T=>async b=>{(0,n.set)(a.TP,"user.fiscalYearStartMonth",T),b(M({fiscalYearStartMonth:T}))},g=T=>async b=>{(!(0,n.isString)(T)||(0,n.isEmpty)(T))&&(T=f.Ay?.bootData?.user?.timezone),(0,n.set)(a.TP,"user.timezone",T),b(E({timeZone:T}))},l=T=>async b=>{(!(0,n.isString)(T)||(0,n.isEmpty)(T))&&(T=f.Ay?.bootData?.user?.weekStart),(0,n.set)(a.TP,"user.weekStart",T),b(C({weekStart:T})),(0,r.$D)(T)},{setUpdating:p,initLoadOrgs:m,orgsLoaded:y,initLoadTeams:d,teamsLoaded:v,userLoaded:u,userSessionRevoked:D,initLoadSessions:P,sessionsLoaded:x,updateTimeZone:E,updateWeekStart:C,updateFiscalYearStartMonth:M}=o.actions,S=o.reducer,I={user:o.reducer}},32901:(G,O,e)=>{"use strict";e.d(O,{O:()=>t,q:()=>n});const t=i=>i.timeZone,n=i=>i.fiscalYearStartMonth},2858:(G,O,e)=>{"use strict";e.d(O,{g:()=>a});var t=e(75816),n=e(56389);const i="grafana.app/createdBy",s=c=>c||void 0,r=c=>c.items?c.items.map(o=>({uid:o.metadata.name||"",title:o.spec.title,targets:o.spec.targets.map(h=>h.properties),createdAtTimestamp:new Date(o.metadata.creationTimestamp||"").getTime(),user:s(o.metadata?.annotations?.[i])})):[],f=c=>{const{title:o,targets:h}=c;return{apiVersion:n.mG,kind:n.GY.QueryTemplate,metadata:{generateName:"A"+o},spec:{title:o,vars:[],targets:h.map(g=>({variables:{},properties:g}))}}},a=(0,t.xP)({baseQuery:n.Su,tagTypes:["QueryTemplatesList"],endpoints:c=>({allQueryTemplates:c.query({query:()=>({}),transformResponse:r,providesTags:["QueryTemplatesList"]}),addQueryTemplate:c.mutation({query:o=>({method:"POST",data:f(o)}),invalidatesTags:["QueryTemplatesList"]}),deleteQueryTemplate:c.mutation({query:({uid:o})=>({url:`${o}`,method:"DELETE"}),invalidatesTags:["QueryTemplatesList"]})}),reducerPath:"queryLibrary"})},56389:(G,O,e)=>{"use strict";e.d(O,{C1:()=>f,GY:()=>r,Su:()=>a,mG:()=>s});var t=e(75505),n=e(32264),i=e(17172);const s="peakq.grafana.app/v0alpha1";var r=(c=>(c.QueryTemplate="QueryTemplate",c))(r||{});const f=`/apis/${s}/namespaces/${n.$.namespace}/querytemplates/`,a=async c=>{try{const o=(0,i.AI)().fetch({url:`${f}${c.url??""}`,showErrorAlert:!0,method:c.method||"GET",data:c.data});return await(0,t.s)(o)}catch(o){return(0,i.NF)(o)?{error:new Error(o.data.message)}:o instanceof Error?{error:o}:{error:new Error("Unknown error")}}}},64152:(G,O,e)=>{"use strict";e.d(O,{d:()=>i,m:()=>n});class t{constructor(){this.extraRenderActions=[]}addExtraRenderAction(r){this.extraRenderActions=this.extraRenderActions.concat(r)}getAllExtraRenderAction(){return this.extraRenderActions}}const n=new t,i=new t},48514:(G,O,e)=>{"use strict";e.d(O,{c:()=>K,E:()=>X});var t=e(74848),n=e(46942),i=e.n(n),s=e(2543),r=e(55127),f=e.n(r),a=e(96540),c=e(41987),o=e(76287),h=e(22391),g=e(18226),l=e(39070),p=e(14236),m=e(26272),y=e(13544),d=e(19347),v=e(7376),u=e(14110),D=e(39938),P=e(66602),x=e(22214),E=e(10343),C=e(7788),M=e(8484),S=e(74856),I=e(84423),T=e(64152),b=e(32196),R=e(40845),A=e(14578),L=e(10354),U=e(72093),W=e(51612);const w=k=>{const{query:Y,queries:Z,onChange:se,collapsedText:j,renderExtras:q,hidden:ne}=k,oe=(0,R.of)(B),[z,te]=(0,a.useState)(!1),[le,ie]=(0,a.useState)(null),ae=De=>{te(!0)},re=De=>{if(te(!1),le){ie(null);return}Y.refId!==De&&se({...Y,refId:De})},ce=De=>{const fe=De.currentTarget.value.trim();if(fe.length===0){ie("An empty query name is not allowed");return}for(const Te of Z)if(Te!==Y&&fe===Te.refId){ie("Query name already exists");return}le&&ie(null)},me=De=>{re(De.currentTarget.value.trim())},ee=De=>{De.key==="Enter"&&re(De.currentTarget.value)},de=De=>{De.target.select()};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:oe.wrapper,children:[!z&&(0,t.jsxs)("button",{className:oe.queryNameWrapper,"aria-label":y.Tp.components.QueryEditorRow.title(Y.refId),title:"Edit query name",onClick:ae,"data-testid":"query-name-div",type:"button",children:[(0,t.jsx)("span",{className:oe.queryName,children:Y.refId}),(0,t.jsx)(A.I,{name:"pen",className:oe.queryEditIcon,size:"sm"})]}),z&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(L.p,{type:"text",defaultValue:Y.refId,onBlur:me,autoFocus:!0,onKeyDown:ee,onFocus:de,invalid:le!==null,onChange:ce,className:oe.queryNameInput,"data-testid":"query-name-input"}),le&&(0,t.jsx)(U.P,{horizontal:!0,children:le})]}),N(k,oe),q&&(0,t.jsx)("div",{className:oe.itemWrapper,children:q()}),ne&&(0,t.jsx)("em",{className:oe.contextInfo,children:"Hidden"})]}),j&&(0,t.jsx)("div",{className:oe.collapsedText,children:j})]})},N=(k,Y)=>{const{alerting:Z,dataSource:se,onChangeDataSource:j}=k;return j?(0,t.jsx)("div",{className:Y.itemWrapper,children:(0,t.jsx)(W.s,{variables:!0,alerting:Z,current:se.name,onChange:j})}):(0,t.jsxs)("em",{className:Y.contextInfo,children:["(",se.name,")"]})},B=k=>({wrapper:(0,b.css)`
      label: Wrapper;
      display: flex;
      align-items: center;
      margin-left: ${k.spacing(.5)};
      overflow: hidden;
    `,queryNameWrapper:(0,b.css)`
      display: flex;
      cursor: pointer;
      border: 1px solid transparent;
      border-radius: ${k.shape.borderRadius(2)};
      align-items: center;
      padding: 0 0 0 ${k.spacing(.5)};
      margin: 0;
      background: transparent;
      overflow: hidden;

      &:hover {
        background: ${k.colors.action.hover};
        border: 1px dashed ${k.colors.border.strong};
      }

      &:focus {
        border: 2px solid ${k.colors.primary.border};
      }

      &:hover,
      &:focus {
        .query-name-edit-icon {
          visibility: visible;
        }
      }
    `,queryName:(0,b.css)`
      font-weight: ${k.typography.fontWeightMedium};
      color: ${k.colors.primary.text};
      cursor: pointer;
      overflow: hidden;
      margin-left: ${k.spacing(.5)};
    `,queryEditIcon:(0,b.cx)((0,b.css)`
        margin-left: ${k.spacing(2)};
        visibility: hidden;
      `,"query-name-edit-icon"),queryNameInput:(0,b.css)`
      max-width: 300px;
      margin: -4px 0;
    `,collapsedText:(0,b.css)`
      font-weight: ${k.typography.fontWeightRegular};
      font-size: ${k.typography.bodySmall.fontSize};
      color: ${k.colors.text.secondary};
      padding-left: ${k.spacing(1)};
      align-items: center;
      overflow: hidden;
      font-style: italic;
      white-space: nowrap;
      text-overflow: ellipsis;
    `,contextInfo:(0,b.css)`
      font-size: ${k.typography.bodySmall.fontSize};
      font-style: italic;
      color: ${k.colors.text.secondary};
      padding-left: 10px;
      padding-right: 10px;
    `,itemWrapper:(0,b.css)`
      display: flex;
      margin-left: 4px;
    `});var V=e(84959);class K extends a.PureComponent{constructor(){super(...arguments),this.element=null,this.angularScope=null,this.angularQueryEditor=null,this.dataSourceSrv=(0,d.l)(),this.id="",this.state={datasource:null,hasTextEditMode:!1,data:void 0,isOpen:!0,showingHelp:!1},this.renderAngularQueryEditor=()=>{if(!this.element)return;this.angularQueryEditor&&(this.angularQueryEditor.destroy(),this.angularQueryEditor=null);const Y=(0,v.E)(),Z='<plugin-component type="query-ctrl" />',se={ctrl:this.getAngularQueryComponentScope()};this.angularQueryEditor=Y.load(this.element,se,Z),this.angularScope=se.ctrl},this.onOpen=()=>{this.renderAngularQueryEditor()},this.renderPluginEditor=()=>{const{query:Y,onChange:Z,queries:se,onRunQuery:j,onAddQuery:q,app:ne=c.Jk.PanelEditor,history:oe}=this.props,{datasource:z,data:te}=this.state;if(this.isWaitingForDatasourceToLoad())return null;if(z?.components?.QueryCtrl)return(0,t.jsx)("div",{ref:le=>this.element=le});if(z){let le=this.getReactQueryEditor(z);if(le)return(0,t.jsx)(o.p,{instanceSettings:this.props.dataSource,children:(0,t.jsx)(le,{query:Y,datasource:z,onChange:Z,onRunQuery:j,onAddQuery:q,data:te,range:(0,S.jG)().timeRange(),queries:se,app:ne,history:oe},z?.name)})}return(0,t.jsx)("div",{children:(0,t.jsx)(M.x6,{i18nKey:"query-operation.query-editor-not-exported",children:"Data source plugin does not export any Query Editor component"})})},this.onToggleEditMode=(Y,Z)=>{Y.stopPropagation(),this.angularScope&&this.angularScope.toggleEditorMode&&(this.angularScope.toggleEditorMode(),this.angularQueryEditor?.digest(),Z.isOpen||Z.onOpen())},this.onRemoveQuery=()=>{const{onRemoveQuery:Y,query:Z,onQueryRemoved:se}=this.props;Y(Z),se&&se()},this.onCopyQuery=()=>{const{query:Y,onAddQuery:Z,onQueryCopied:se}=this.props,j=(0,s.cloneDeep)(Y);Z(j),se&&se()},this.onHideQuery=()=>{const{query:Y,onChange:Z,onRunQuery:se,onQueryToggled:j}=this.props;Z({...Y,hide:!Y.hide}),se(),j&&j(Y.hide),(0,u.rR)("query_editor_row_hide_query_clicked",{hide:!Y.hide})},this.onToggleHelp=()=>{this.setState(Y=>({showingHelp:!Y.showingHelp}))},this.onClickExample=Y=>{Y.datasource===void 0&&(Y.datasource=(0,h.p$)(this.props.dataSource)),this.props.onChange({...Y,refId:this.props.query.refId}),this.onToggleHelp()},this.renderWarnings=()=>{const{data:Y,query:Z}=this.props,j=(X(Y,Z.refId)?.series??[]).reduce((z,te)=>{if(!te.meta?.notices)return z;const le=(0,s.filter)(te.meta.notices,{severity:"warning"})??[];return z.concat(le)},[]),q=(0,s.uniqBy)(j,"text");if(!(q.length>0))return null;const oe=q.map(z=>z.text).join(`
`);return(0,t.jsx)(D.E,{color:"orange",icon:"exclamation-triangle",text:(0,t.jsxs)(t.Fragment,{children:[q.length," ",f()("warning",q.length)]}),tooltip:oe},"query-warning")},this.renderExtraActions=()=>{const{query:Y,queries:Z,data:se,onAddQuery:j,dataSource:q}=this.props,ne=T.d.getAllExtraRenderAction().map((oe,z)=>oe({query:Y,queries:Z,timeRange:se.timeRange,onAddQuery:j,dataSource:q,key:z})).filter(Boolean);return ne.push(this.renderWarnings()),ne},this.renderActions=Y=>{const{query:Z,hideHideQueryButton:se=!1}=this.props,{hasTextEditMode:j,datasource:q,showingHelp:ne}=this.state,oe=!!Z.hide,z=q?.components?.QueryEditorHelp;return(0,t.jsxs)(t.Fragment,{children:[z&&(0,t.jsx)(E.A,{title:(0,M.t)("query-operation.header.datasource-help","Show data source help"),icon:"question-circle",onClick:this.onToggleHelp,active:ne}),j&&(0,t.jsx)(E.q,{title:(0,M.t)("query-operation.header.toggle-edit-mode","Toggle text edit mode"),icon:"pen",onClick:te=>{this.onToggleEditMode(te,Y)}}),this.renderExtraActions(),(0,t.jsx)(E.q,{title:(0,M.t)("query-operation.header.duplicate-query","Duplicate query"),icon:"copy",onClick:this.onCopyQuery}),se?null:(0,t.jsx)(E.A,{dataTestId:y.Tp.components.QueryEditorRow.actionButton("Hide response"),title:Z.hide?(0,M.t)("query-operation.header.show-response","Show response"):(0,M.t)("query-operation.header.hide-response","Hide response"),icon:oe?"eye-slash":"eye",active:oe,onClick:this.onHideQuery}),(0,t.jsx)(E.q,{title:(0,M.t)("query-operation.header.remove-query","Remove query"),icon:"trash-alt",onClick:this.onRemoveQuery})]})},this.renderHeader=Y=>{const{alerting:Z,query:se,dataSource:j,onChangeDataSource:q,onChange:ne,queries:oe,renderHeaderExtras:z}=this.props;return(0,t.jsx)(w,{query:se,queries:oe,onChangeDataSource:q,dataSource:j,hidden:se.hide,onClick:te=>this.onToggleEditMode(te,Y),onChange:ne,collapsedText:Y.isOpen?null:this.renderCollapsedText(),renderExtras:z,alerting:Z})}}componentDidMount(){const{data:Y,query:Z,id:se}=this.props,j=X(Y,Z.refId);this.id=(0,s.uniqueId)(se+"_"),this.setState({data:j}),this.loadDatasource()}componentWillUnmount(){this.angularQueryEditor&&this.angularQueryEditor.destroy()}getAngularQueryComponentScope(){const{query:Y,queries:Z}=this.props,{datasource:se}=this.state,j=new I.a9({targets:Z}),q={},ne=this;return{datasource:se,target:Y,panel:j,dashboard:q,refresh:()=>{Y.hide!==ne.props.query.hide&&(Y.hide=ne.props.query.hide),this.props.onChange(Y),this.props.onRunQuery()},render:()=>()=>console.log("legacy render function called, it does nothing"),events:this.props.eventBus||new g.o,range:(0,S.jG)().timeRange()}}getInterpolatedDataSourceUID(){if(this.props.query.datasource){const Y=this.dataSourceSrv.getInstanceSettings(this.props.query.datasource);return Y?.rawRef?.uid??Y?.uid}return this.props.dataSource.rawRef?.uid??this.props.dataSource.uid}async loadDatasource(){let Y;const Z=this.getInterpolatedDataSourceUID();try{Y=await this.dataSourceSrv.get(Z)}catch{Y=await this.dataSourceSrv.get()}typeof this.props.onDataSourceLoaded=="function"&&this.props.onDataSourceLoaded(Y),this.setState({datasource:Y,queriedDataSourceIdentifier:Z,hasTextEditMode:(0,s.has)(Y,"components.QueryCtrl.prototype.toggleEditorMode")})}componentDidUpdate(Y){const{datasource:Z,queriedDataSourceIdentifier:se}=this.state,{data:j,query:q}=this.props;if(Y.id!==this.props.id&&(this.id=(0,s.uniqueId)(this.props.id+"_")),j!==Y.data){const ne=X(j,q.refId);this.setState({data:ne}),this.angularScope&&(this.angularScope.range=(0,S.jG)().timeRange()),this.angularQueryEditor&&ne&&H(this.angularScope,ne,this.angularQueryEditor)}if(Z&&se!==this.getInterpolatedDataSourceUID()){this.angularQueryEditor&&(this.angularQueryEditor.destroy(),this.angularQueryEditor=null),this.loadDatasource();return}!this.element||this.angularQueryEditor||this.renderAngularQueryEditor()}getReactQueryEditor(Y){if(Y)switch(this.props.app){case c.Jk.Explore:return Y.components?.ExploreMetricsQueryField||Y.components?.ExploreLogsQueryField||Y.components?.ExploreQueryField||Y.components?.QueryEditor;case c.Jk.PanelEditor:case c.Jk.Dashboard:default:return Y.components?.QueryEditor}}isWaitingForDatasourceToLoad(){return this.getInterpolatedDataSourceUID()!==this.state.queriedDataSourceIdentifier}renderCollapsedText(){const{datasource:Y}=this.state;return Y?.getQueryDisplayText?Y.getQueryDisplayText(this.props.query):this.angularScope&&this.angularScope.getCollapsedText?this.angularScope.getCollapsedText():null}render(){const{query:Y,index:Z,visualization:se,collapsable:j}=this.props,{datasource:q,showingHelp:ne,data:oe}=this.state,z=Y.hide,te=oe?.error&&oe.error.refId===Y.refId?oe.error:oe?.errors?.find(re=>re.refId===Y.refId),le=i()("query-editor-row",{"query-editor-row--disabled":z,"gf-form-disabled":z});if(!q)return null;const ie=this.renderPluginEditor(),ae=q.components?.QueryEditorHelp;return(0,t.jsx)("div",{"data-testid":"query-editor-row","aria-label":y.Tp.components.QueryEditorRows.rows,children:(0,t.jsx)(C.u,{id:this.id,draggable:!0,collapsable:j,index:Z,headerElement:this.renderHeader,actions:this.renderActions,onOpen:this.onOpen,children:(0,t.jsxs)("div",{className:le,id:this.id,children:[(0,t.jsxs)(P.Xw,{children:[ne&&ae&&(0,t.jsx)(x.j,{children:(0,t.jsx)(ae,{onClickExample:re=>this.onClickExample(re),query:this.props.query,datasource:q})}),ie]}),te&&(0,t.jsx)(V.x,{error:te}),se]})})})}}function H(k,Y,Z){if(Y.state===l.Gu.Done){const se=Y.series.map(j=>(0,p.w3)(j));k.events.emit(m.ee.dataReceived,se)}else Y.state===l.Gu.Error&&k.events.emit(m.ee.dataError,Y.error);setTimeout(Z.digest)}function X(k,Y){const Z=k.series.filter(ne=>ne.refId===Y);if(k.state!==l.Gu.Loading&&(k.error||k.errors?.length)&&!k.series.length)return{...k,state:l.Gu.Error};let se=k.state,j=k.errors?.find(ne=>ne.refId===Y);!j&&k.error&&(j=k.error.refId===Y?k.error:void 0),se!==l.Gu.Loading&&(j?se=l.Gu.Error:k.state===l.Gu.Error&&(se=l.Gu.Done));const q=k.timeRange;return{...k,state:se,series:Z,error:j,errors:j?[j]:void 0,timeRange:q}}},44932:(G,O,e)=>{"use strict";e.d(O,{L:()=>c});var t=e(74848),n=e(38127),i=e(96540),s=e(22391),r=e(14110),f=e(19347),a=e(48514);class c extends i.PureComponent{constructor(){super(...arguments),this.onRemoveQuery=g=>{this.props.onQueriesChange(this.props.queries.filter(l=>l!==g))},this.onDragStart=g=>{const{queries:l,dsSettings:p}=this.props;(0,r.rR)("query_row_reorder_started",{startIndex:g.source.index,numberOfQueries:l.length,datasourceType:p.type})},this.onDragEnd=g=>{const{queries:l,onQueriesChange:p,dsSettings:m}=this.props;if(!g||!g.destination)return;const y=g.source.index,d=g.destination.index;if(y===d){(0,r.rR)("query_row_reorder_canceled",{startIndex:y,endIndex:d,numberOfQueries:l.length,datasourceType:m.type});return}const v=Array.from(l),[u]=v.splice(y,1);v.splice(d,0,u),p(v),(0,r.rR)("query_row_reorder_ended",{startIndex:y,endIndex:d,numberOfQueries:l.length,datasourceType:m.type})}}onChangeQuery(g,l){const{queries:p,onQueriesChange:m}=this.props;m(p.map((y,d)=>d===l?g:y))}onDataSourceChange(g,l){const{queries:p,onQueriesChange:m}=this.props;m(p.map((y,d)=>{if(d!==l)return y;const v=(0,s.p$)(g);return y.datasource&&(0,f.l)().getInstanceSettings(y.datasource)?.type===g.type?{...y,datasource:v}:{refId:y.refId,hide:y.hide,datasource:v}}))}render(){const{dsSettings:g,data:l,queries:p,app:m,history:y,eventBus:d,onAddQuery:v,onRunQueries:u,onQueryCopied:D,onQueryRemoved:P,onQueryToggled:x,queryRowWrapper:E}=this.props;return(0,t.jsx)(n.JY,{onDragStart:this.onDragStart,onDragEnd:this.onDragEnd,children:(0,t.jsx)(n.gL,{droppableId:"transformations-list",direction:"vertical",children:C=>(0,t.jsxs)("div",{"data-testid":"query-editor-rows",ref:C.innerRef,...C.droppableProps,children:[p.map((M,S)=>{const I=o(M,g),T=g.meta.mixed?R=>this.onDataSourceChange(R,S):void 0,b=(0,t.jsx)(a.c,{id:M.refId,index:S,data:l,query:M,dataSource:I,onChangeDataSource:T,onChange:R=>this.onChangeQuery(R,S),onRemoveQuery:this.onRemoveQuery,onAddQuery:v,onRunQuery:u,onQueryCopied:D,onQueryRemoved:P,onQueryToggled:x,queries:p,app:m,history:y,eventBus:d},M.refId);return E?E(b,M.refId):b}),C.placeholder]})})})}}const o=(h,g)=>h.datasource&&(0,f.l)().getInstanceSettings(h.datasource)||g},84959:(G,O,e)=>{"use strict";e.d(O,{x:()=>r});var t=e(74848),n=e(32196),i=e(40845),s=e(14578);function r({error:a}){const c=(0,i.of)(f),o=a?.message??a?.data?.message??"Query error";return(0,t.jsxs)("div",{className:c.wrapper,children:[(0,t.jsx)("div",{className:c.icon,children:(0,t.jsx)(s.I,{name:"exclamation-triangle"})}),(0,t.jsxs)("div",{className:c.message,children:[o,a.traceId!=null&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("br",{})," ",(0,t.jsxs)("span",{children:["(Trace ID: ",a.traceId,")"]})]})]})]})}const f=a=>({wrapper:(0,n.css)({marginTop:a.spacing(.5),background:a.colors.background.secondary,display:"flex"}),icon:(0,n.css)({background:a.colors.error.main,color:a.colors.error.contrastText,padding:a.spacing(1)}),message:(0,n.css)({fontSize:a.typography.bodySmall.fontSize,fontFamily:a.typography.fontFamilyMonospace,padding:a.spacing(1)})})},37464:(G,O,e)=>{"use strict";e.d(O,{g:()=>Z,K:()=>j});var t=e(74848),n=e(32196),i=e(96540),s=e(39070),r=e(43127),f=e(22391),a=e(41987),c=e(43429),o=e(13544),h=e(19347),g=e(12131),l=e(66864),p=e(55852),m=e(40276),y=e(37390),d=e(3911),v=e(38894),u=e(16817),D=e(36663),P=e(17172),x=e(39558);function E({pluginId:ne}){const{value:oe,loading:z,error:te}=(0,u.A)(async()=>(0,P.AI)().get(`/api/plugins/${ne}/markdown/query_help`),[]),le=(0,D.G)(oe);return z?(0,t.jsx)(x._,{text:"Loading help..."}):te?(0,t.jsx)("h3",{children:"An error occurred when loading help."}):oe===""?(0,t.jsx)("h3",{children:"No query help could be found."}):(0,t.jsx)("div",{className:"markdown-html",dangerouslySetInnerHTML:{__html:le}})}var C=e(2913),M=e(27677),S=e(21969),I=e(50481),T=e(51612),b=e(53478),R=e(74106),A=e(14348),L=e(8480),U=e(93117),W=e(64152),w=e(44932),N=e(65879),B=e(10354),V=e(15292),K=e(7788);class H extends i.PureComponent{constructor(oe){super(oe),this.onRelativeTimeChange=te=>{this.setState({timeRangeFrom:te.target.value})},this.onTimeShiftChange=te=>{this.setState({timeRangeShift:te.target.value})},this.onOverrideTime=te=>{const{options:le,onChange:ie}=this.props,ae=k(te.target.value),re=X(ae);re&&le.timeRange?.from!==ae&&ie({...le,timeRange:{...le.timeRange??{},from:ae}}),this.setState({relativeTimeIsValid:re})},this.onTimeShift=te=>{const{options:le,onChange:ie}=this.props,ae=k(te.target.value),re=X(ae);re&&le.timeRange?.shift!==ae&&ie({...le,timeRange:{...le.timeRange??{},shift:ae}}),this.setState({timeShiftIsValid:re})},this.onToggleTimeOverride=()=>{const{onChange:te,options:le}=this.props;this.setState({timeRangeHide:!this.state.timeRangeHide},()=>{te({...le,timeRange:{...le.timeRange??{},hide:this.state.timeRangeHide}})})},this.onCacheTimeoutBlur=te=>{const{options:le,onChange:ie}=this.props;ie({...le,cacheTimeout:k(te.target.value)})},this.onQueryCachingTTLBlur=te=>{const{options:le,onChange:ie}=this.props;let ae=parseInt(te.target.value,10);(isNaN(ae)||ae===0)&&(ae=null),ie({...le,queryCachingTTL:ae})},this.onMaxDataPointsBlur=te=>{const{options:le,onChange:ie}=this.props;let ae=parseInt(te.currentTarget.value,10);(isNaN(ae)||ae===0)&&(ae=null),ae!==le.maxDataPoints&&ie({...le,maxDataPoints:ae})},this.onMinIntervalBlur=te=>{const{options:le,onChange:ie}=this.props,ae=k(te.target.value);ae!==le.minInterval&&ie({...le,minInterval:ae})},this.onOpenOptions=()=>{this.setState({isOpen:!0})},this.onCloseOptions=()=>{this.setState({isOpen:!1})};const{options:z}=oe;this.state={timeRangeFrom:z.timeRange?.from||"",timeRangeShift:z.timeRange?.shift||"",timeRangeHide:z.timeRange?.hide??!1,isOpen:!1,relativeTimeIsValid:!0,timeShiftIsValid:!0}}renderCacheTimeoutOption(){const{dataSource:oe,options:z}=this.props,te=`If your time series store has a query cache this option can override the default cache timeout. Specify a
    numeric value in seconds.`;return oe.meta.queryOptions?.cacheTimeout?(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(v.I,{width:9,tooltip:te,children:"Cache timeout"}),(0,t.jsx)(B.p,{type:"text",className:"width-6",placeholder:"60",spellCheck:!1,onBlur:this.onCacheTimeoutBlur,defaultValue:z.cacheTimeout??""})]})}):null}renderQueryCachingTTLOption(){const{dataSource:oe,options:z}=this.props,te="Cache time-to-live: How long results from this queries in this panel will be cached, in milliseconds. Defaults to the TTL in the caching configuration for this datasource.";return oe.cachingConfig?.enabled?(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(v.I,{width:9,tooltip:te,children:"Cache TTL"}),(0,t.jsx)(B.p,{type:"number",className:"width-6",placeholder:`${oe.cachingConfig.TTLMs}`,spellCheck:!1,onBlur:this.onQueryCachingTTLBlur,defaultValue:z.queryCachingTTL??void 0})]})}):null}renderMaxDataPointsOption(){const{data:oe,options:z}=this.props,te=oe.request?.maxDataPoints,le=z.maxDataPoints??"",ie=le==="";return(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(v.I,{width:9,tooltip:(0,t.jsx)(t.Fragment,{children:"The maximum data points per series. Used directly by some data sources and used in calculation of auto interval. With streaming data this value is used for the rolling buffer."}),children:"Max data points"}),(0,t.jsx)(B.p,{type:"number",className:"width-6",placeholder:`${te}`,spellCheck:!1,onBlur:this.onMaxDataPointsBlur,defaultValue:le}),ie&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"gf-form-label query-segment-operator",children:"="}),(0,t.jsx)("div",{className:"gf-form-label",children:"Width of panel"})]})]})})}renderIntervalOption(){const{data:oe,dataSource:z,options:te}=this.props,le=oe.request?.interval,ie=z.interval??"No limit";return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(v.I,{width:9,tooltip:(0,t.jsxs)(t.Fragment,{children:["A lower limit for the interval. Recommended to be set to write frequency, for example ",(0,t.jsx)("code",{children:"1m"})," ","if your data is written every minute. Default value can be set in data source settings for most data sources."]}),children:"Min interval"}),(0,t.jsx)(B.p,{type:"text",className:"width-6",placeholder:`${ie}`,spellCheck:!1,onBlur:this.onMinIntervalBlur,defaultValue:te.minInterval??""})]})}),(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(v.I,{width:9,tooltip:(0,t.jsxs)(t.Fragment,{children:["The evaluated interval that is sent to data source and is used in ",(0,t.jsx)("code",{children:"$__interval"})," and"," ",(0,t.jsx)("code",{children:"$__interval_ms"}),". This value is not exactly equal to"," ",(0,t.jsx)("code",{children:"Time range / max data points"}),", it will approximate a series of magic number."]}),children:"Interval"}),(0,t.jsx)(v.I,{width:6,children:le}),(0,t.jsx)("div",{className:"gf-form-label query-segment-operator",children:"="}),(0,t.jsx)("div",{className:"gf-form-label",children:"Time range / max data points"})]})})]})}renderCollapsedText(oe){const{data:z,options:te}=this.props,{isOpen:le}=this.state;if(le)return;let ie=te.maxDataPoints??"";ie===""&&z.request&&(ie=`auto = ${z.request.maxDataPoints}`);let ae=te.minInterval;return z.request&&(ae=`${z.request.interval}`),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:oe.collapsedText,children:["MD = ",ie]}),(0,t.jsxs)("div",{className:oe.collapsedText,children:["Interval = ",ae]})]})}render(){const{timeRangeHide:oe,relativeTimeIsValid:z,timeShiftIsValid:te}=this.state,{timeRangeFrom:le,timeRangeShift:ie,isOpen:ae}=this.state,re=Y();return(0,t.jsxs)(K.u,{id:"Query options",index:0,title:"Query options",headerElement:this.renderCollapsedText(re),isOpen:ae,onOpen:this.onOpenOptions,onClose:this.onCloseOptions,children:[this.renderMaxDataPointsOption(),this.renderIntervalOption(),this.renderCacheTimeoutOption(),this.renderQueryCachingTTLOption(),(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(v.I,{width:9,tooltip:(0,t.jsxs)(t.Fragment,{children:["Overrides the relative time range for individual panels, which causes them to be different than what is selected in the dashboard time picker in the top-right corner of the dashboard. For example to configure the Last 5 minutes the Relative time should be ",(0,t.jsx)("code",{children:"now-5m"})," and ",(0,t.jsx)("code",{children:"5m"}),", or variables like ",(0,t.jsx)("code",{children:"$_relativeTime"}),"."]}),children:"Relative time"}),(0,t.jsx)(B.p,{type:"text",className:"width-6",placeholder:"1h",onChange:this.onRelativeTimeChange,onBlur:this.onOverrideTime,invalid:!z,value:le})]}),(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(v.I,{width:9,tooltip:(0,t.jsxs)(t.Fragment,{children:["Overrides the time range for individual panels by shifting its start and end relative to the time picker. For example to configure the Last 1h the Time shift should be ",(0,t.jsx)("code",{children:"now-1h"})," and"," ",(0,t.jsx)("code",{children:"1h"}),", or variables like ",(0,t.jsx)("code",{children:"$_timeShift"}),"."]}),children:"Time shift"}),(0,t.jsx)(B.p,{type:"text",className:"width-6",placeholder:"1h",onChange:this.onTimeShiftChange,onBlur:this.onTimeShift,invalid:!te,value:ie})]}),(ie||le)&&(0,t.jsxs)("div",{className:"gf-form-inline align-items-center",children:[(0,t.jsx)(v.I,{width:9,children:"Hide time info"}),(0,t.jsx)(V.d,{value:oe,onChange:this.onToggleTimeOverride})]})]})}}const X=ne=>ne?N.isValidTimeSpan(ne):!0,k=ne=>ne===""?null:ne,Y=(0,d.N)(()=>{const{theme:ne}=C.config;return{collapsedText:(0,n.css)`
      margin-left: ${ne.spacing.md};
      font-size: ${ne.typography.size.sm};
      color: ${ne.colors.textWeak};
    `}});class Z extends i.PureComponent{constructor(){super(...arguments),this.backendSrv=M.IB,this.dataSourceSrv=(0,h.l)(),this.querySubscription=null,this.state={isDataSourceModalOpen:!!g.Ny.getSearchObject().firstPanel,isLoadingHelp:!1,helpContent:null,isPickerOpen:!1,isHelpOpen:!1,queries:[],data:{state:s.Gu.NotStarted,series:[],timeRange:(0,r.E2)()}},this.onChangeDataSource=async(oe,z)=>{const{dsSettings:te}=this.state,le=te?await(0,h.l)().get(te.uid):void 0,ie=await(0,h.l)().get(oe.uid),ae=z||await(0,U.y)(ie,oe.uid,this.state.queries,le),re=await this.dataSourceSrv.get(oe.name);this.onChange({queries:ae,dataSource:{name:oe.name,uid:oe.uid,...(0,f.p$)(oe)}}),this.setState({queries:ae,dataSource:re,dsSettings:oe}),z&&this.props.onRunQueries()},this.onAddQueryClick=()=>{const{queries:oe}=this.state;this.onQueriesChange((0,S.U7)(oe,this.newQuery())),this.onScrollBottom()},this.onAddExpressionClick=()=>{this.onQueriesChange((0,S.U7)(this.state.queries,b.Ex.newQuery())),this.onScrollBottom()},this.onScrollBottom=()=>{setTimeout(()=>{this.state.scrollElement&&this.state.scrollElement.scrollTo({top:1e4})},20)},this.onUpdateAndRun=oe=>{this.props.onOptionsChange(oe),this.props.onRunQueries()},this.onOpenHelp=()=>{this.setState({isHelpOpen:!0})},this.onCloseHelp=()=>{this.setState({isHelpOpen:!1})},this.onCloseDataSourceModal=()=>{this.setState({isDataSourceModalOpen:!1})},this.onAddQuery=oe=>{const{dsSettings:z,queries:te}=this.state;this.onQueriesChange((0,S.U7)(te,oe,z?(0,f.p$)(z):{type:void 0,uid:void 0})),this.onScrollBottom()},this.onQueriesChange=oe=>{this.onChange({queries:oe}),this.setState({queries:oe})},this.setScrollRef=oe=>{this.setState({scrollElement:oe})}}async componentDidMount(){const{options:oe,queryRunner:z}=this.props;this.querySubscription=z.getData({withTransforms:!1,withFieldConfig:!1}).subscribe({next:te=>this.onPanelDataUpdate(te)}),this.setNewQueriesAndDatasource(oe)}componentWillUnmount(){this.querySubscription&&(this.querySubscription.unsubscribe(),this.querySubscription=null)}async componentDidUpdate(){const{options:oe}=this.props,z=await(0,h.l)().get(oe.dataSource);this.state.dataSource&&z.uid!==this.state.dataSource?.uid&&this.setNewQueriesAndDatasource(oe)}async setNewQueriesAndDatasource(oe){try{const z=await this.dataSourceSrv.get(oe.dataSource),te=this.dataSourceSrv.getInstanceSettings(oe.dataSource),le=await this.dataSourceSrv.get(),ie=z.getRef(),ae=oe.queries.map(re=>({...(0,S.Ih)(re)&&z?.getDefaultQuery?.(a.Jk.PanelEditor),datasource:ie,...re}));this.setState({queries:ae,dataSource:z,dsSettings:te,defaultDataSource:le})}catch(z){console.error("failed to load data source",z)}}onPanelDataUpdate(oe){this.setState({data:oe})}newQuery(){const{dsSettings:oe,defaultDataSource:z}=this.state,te=oe&&!oe.meta.mixed?(0,f.p$)(oe):z?z.getRef():{type:void 0,uid:void 0};return{...this.state.dataSource?.getDefaultQuery?.(a.Jk.PanelEditor),datasource:te}}onChange(oe){this.props.onOptionsChange({...this.props.options,...oe})}renderTopSection(oe){const{onOpenQueryInspector:z,options:te}=this.props,{dataSource:le,data:ie,dsSettings:ae}=this.state;return!ae||!le?null:(0,t.jsx)(j,{data:ie,dataSource:le,options:te,dsSettings:ae,onOptionsChange:this.onUpdateAndRun,onDataSourceChange:this.onChangeDataSource,onOpenQueryInspector:z})}renderQueries(oe){const{onRunQueries:z}=this.props,{data:te,queries:le}=this.state;return(0,t.jsx)("div",{"aria-label":o.Tp.components.QueryTab.content,children:(0,t.jsx)(w.L,{queries:le,dsSettings:oe,onQueriesChange:this.onQueriesChange,onAddQuery:this.onAddQuery,onRunQueries:z,data:te})})}isExpressionsSupported(oe){return(oe.meta.alerting||oe.meta.mixed)===!0}renderExtraActions(){return W.m.getAllExtraRenderAction().map((oe,z)=>oe({onAddQuery:this.onAddQuery,onChangeDataSource:this.onChangeDataSource,key:z})).filter(Boolean)}renderAddQueryRow(oe,z){const te=!(0,A.kN)(oe.name);return(0,t.jsxs)(l.Gy,{spacing:"md",align:"flex-start",children:[te&&(0,t.jsx)(p.$n,{icon:"plus",onClick:this.onAddQueryClick,variant:"secondary","data-testid":o.Tp.components.QueryTab.addQuery,children:"Add query"}),C.Ay.expressionsEnabled&&this.isExpressionsSupported(oe)&&(0,t.jsx)(p.$n,{icon:"plus",onClick:this.onAddExpressionClick,variant:"secondary",className:z.expressionButton,"data-testid":"query-tab-add-expression",children:(0,t.jsx)("span",{children:"Expression\xA0"})}),this.renderExtraActions()]})}render(){const{isHelpOpen:oe,dsSettings:z}=this.state,te=se();return(0,t.jsx)(m.E,{autoHeightMin:"100%",scrollRefCallback:this.setScrollRef,children:(0,t.jsxs)("div",{className:te.innerWrapper,children:[this.renderTopSection(te),z&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:te.queriesWrapper,children:this.renderQueries(z)}),this.renderAddQueryRow(z,te),oe&&(0,t.jsx)(y.a,{title:"Data source help",isOpen:!0,onDismiss:this.onCloseHelp,children:(0,t.jsx)(E,{pluginId:z.meta.id})})]})]})})}}const se=(0,d.N)(()=>{const{theme:ne}=C.Ay;return{innerWrapper:(0,n.css)`
      display: flex;
      flex-direction: column;
      padding: ${ne.spacing.md};
    `,dataSourceRow:(0,n.css)`
      display: flex;
      margin-bottom: ${ne.spacing.md};
    `,dataSourceRowItem:(0,n.css)`
      margin-right: ${ne.spacing.inlineFormMargin};
    `,dataSourceRowItemOptions:(0,n.css)`
      flex-grow: 1;
      margin-right: ${ne.spacing.inlineFormMargin};
    `,queriesWrapper:(0,n.css)`
      padding-bottom: 16px;
    `,expressionWrapper:(0,n.css)``,expressionButton:(0,n.css)`
      margin-right: ${ne.spacing.sm};
    `}});function j({dataSource:ne,options:oe,data:z,dsSettings:te,onDataSourceChange:le,onOptionsChange:ie,onOpenQueryInspector:ae}){const re=se(),[ce,me]=(0,i.useState)(!1);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{"data-testid":o.Tp.components.QueryTab.queryGroupTopSection,children:[(0,t.jsxs)("div",{className:re.dataSourceRow,children:[(0,t.jsx)(v.I,{htmlFor:"data-source-picker",width:"auto",children:"Data source"}),(0,t.jsx)("div",{className:re.dataSourceRowItem,children:(0,t.jsx)(q,{options:oe,onChange:async(ee,de)=>await le?.(ee,de),isDataSourceModalOpen:!!g.Ny.getSearchObject().firstPanel})}),ne&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:re.dataSourceRowItem,children:(0,t.jsx)(p.$n,{variant:"secondary",icon:"question-circle",title:"Open data source help",onClick:()=>me(!0),"data-testid":"query-tab-help-button"})}),(0,t.jsx)("div",{className:re.dataSourceRowItemOptions,children:(0,t.jsx)(H,{options:oe,dataSource:ne,data:z,onChange:ee=>{ie?.(ee)}})}),ae&&(0,t.jsx)("div",{className:re.dataSourceRowItem,children:(0,t.jsx)(p.$n,{variant:"secondary",onClick:ae,"aria-label":o.Tp.components.QueryTab.queryInspectorButton,children:"Query inspector"})})]})]}),ne&&(0,L.Hv)(ne.uid)&&(0,t.jsx)(R.c,{pluginId:ne.type,pluginType:c.QE.datasource,angularSupportEnabled:C.Ay?.angularSupportEnabled,showPluginDetailsLink:!0,interactionElementId:"datasource-query"})]}),ce&&(0,t.jsx)(y.a,{title:"Data source help",isOpen:!0,onDismiss:()=>me(!1),children:(0,t.jsx)(E,{pluginId:te.meta.id})})]})}function q({options:ne,onChange:oe,...z}){const[te,le]=(0,i.useState)(!!z.isDataSourceModalOpen);(0,i.useEffect)(()=>{g.Ny.getSearchObject().firstPanel&&g.Ny.partial({firstPanel:null},!0)},[]);const ie={metrics:!0,mixed:!0,dashboard:!0,variables:!0,current:ne.dataSource,uploadFile:!0,onChange:async(ae,re)=>{await oe(ae,re),le(!1)}};return(0,t.jsxs)(t.Fragment,{children:[te&&(0,t.jsx)(I.p,{...ie,onDismiss:()=>le(!1)}),(0,t.jsx)(T.s,{...ie})]})}},42972:(G,O,e)=>{"use strict";e.d(O,{nm:()=>le,Dh:()=>oe});var t=e(39741),n=e(13752),i=e(64423),s=e(44240),r=e(39697),f=e(81160),a=e(67791),c=e(93031),o=e(71030),h=e(69850),g=e(1005),l=e(65961),p=e(3591),m=e(2543);function y(ie){let ae=[];const re=(0,m.partition)(ie,"id"),ce=(0,m.groupBy)(re[0],"id");return ae=(0,m.map)(ce,me=>me.length>1&&!(0,m.every)(me,d)?(0,m.find)(me,ee=>ee.eventType!=="panel-alert"):(0,m.head)(me)),ae=(0,m.concat)(ae,re[1]),ae}function d(ie){return ie.eventType==="panel-alert"}var v=e(74856),u=e(62467),D=e(65474),P=e(66847),x=e(69862),E=e(16126),C=e(32264),M=e(19347),S=e(90569),I=e(28444),T=e(27302),b=e(7436);class R{canRun(ae){return ae?!!(!ae.annotationQuery||ae.annotations):!1}run({annotation:ae,datasource:re,dashboard:ce,range:me}){if(!this.canRun(re))return(0,u.of)([]);const ee={};return(0,T.b)({dashboard:ce,range:me,panel:ee},re,ae).pipe((0,f.T)(de=>de.events??[]),(0,P.W)(b.SD))}}var A=e(42493);class L{canRun(ae){return ae?(0,A.E7)(ae)?!0:!!(ae.annotationQuery&&!ae.annotations):!1}run({annotation:ae,datasource:re,dashboard:ce,range:me}){return this.canRun(re)?(0,D.H)(re.annotationQuery({range:me,rangeRaw:me.raw,annotation:ae,dashboard:ce})).pipe((0,P.W)(b.SD)):(0,u.of)([])}}class U{constructor(ae=[new L,new R]){this.runners=ae}canWork({dashboard:ae}){return!!ae.annotations.list.find(U.getAnnotationsToProcessFilter)}work(ae){if(!this.canWork(ae))return(0,b.$)();const{dashboard:re,range:ce}=ae;let me=re.annotations.list.filter(U.getAnnotationsToProcessFilter);C.$.publicDashboardAccessToken&&me.length>0&&(me=[me[0]]);const ee=me.map(de=>{let De;if(C.$.publicDashboardAccessToken){const fe=new S.X;De=(0,u.of)(fe).pipe((0,P.W)(b.H0))}else De=(0,D.H)((0,M.l)().get(de.datasource)).pipe((0,P.W)(b.H0));return De.pipe((0,x.Z)(fe=>{const Te=this.runners.find(je=>je.canRun(fe));return Te?(re.events.publish(new I.xc(de)),Te.run({annotation:de,datasource:fe,dashboard:re,range:ce}).pipe((0,a.Q)(oe().cancellations().pipe((0,E.p)(je=>je===de))),(0,f.T)(je=>(re.snapshot&&(de.snapshotData=(0,m.cloneDeep)(je)),C.$.publicDashboardAccessToken?je:(0,b.G9)(de,je))),(0,h.j)(()=>{re.events.publish(new I.yj(de))}))):(0,u.of)([])}))});return(0,s.h)(ee).pipe((0,c.U)(),(0,o.T)((de,De)=>de.concat(De)),(0,f.T)(de=>({annotations:de,alertStates:[]})))}static getAnnotationsToProcessFilter(ae){return ae.enable&&!ae.snapshotData}}var W=e(85595),w=e(43585),N=e(16233),B=e(79938),V=e(49498),K=e(55740),H=e(57220),X=e(23662),k=e(91309),Y=e(99140),Z=e(31678);class se{constructor(){this.hasAlertRules={}}canWork({dashboard:ae,range:re}){return!(!ae.uid||C.$.publicDashboardAccessToken||re.raw.to!=="now"||this.hasAlertRules[ae.uid]===!1||!(N.TP.hasPermission(Z.AccessControlAction.AlertingRuleRead)&&N.TP.hasPermission(Z.AccessControlAction.AlertingRuleExternalRead)))}work(ae){if(!this.canWork(ae))return(0,b.$)();const{dashboard:re}=ae,ce=async()=>(await(0,Y.JD)(B.hK.endpoints.prometheusRuleNamespaces.initiate({ruleSourceName:H.hY,dashboardUid:re.uid}))).data;return(0,D.H)(ce()).pipe((0,f.T)(ee=>(0,V.Kw)(ee))).pipe((0,f.T)(ee=>{this.hasAlertRules[re.uid]=!1;const de={};return ee.forEach(De=>De.rules.forEach(fe=>{if((0,X.Z8)(fe)&&fe.annotations&&fe.annotations[K.YH.panelID]){this.hasAlertRules[re.uid]=!0;const Te=Number(fe.annotations[K.YH.panelID]),je=(0,k.S)(fe.state);de[Te]?je===w.O.Alerting&&de[Te].state!==w.O.Alerting?de[Te].state=w.O.Alerting:je===w.O.Pending&&de[Te].state!==w.O.Alerting&&de[Te].state!==w.O.Pending&&(de[Te].state=w.O.Pending):de[Te]={state:je,id:Object.keys(de).length,panelId:Te,dashboardId:re.id}}})),{alertStates:Object.values(de),annotations:[]}}),(0,P.W)(b.Zr))}}class j{constructor(ae,re=(0,v.jG)(),ce=[new se,new W.F,new U]){this.dashboard=ae,this.timeSrv=re,this.workers=ce,this.run=this.run.bind(this),this.getResult=this.getResult.bind(this),this.cancel=this.cancel.bind(this),this.destroy=this.destroy.bind(this),this.executeRun=this.executeRun.bind(this),this.results=new t.m(1),this.runs=new n.B,this.cancellationStream=new n.B,this.runsSubscription=this.runs.subscribe(me=>this.executeRun(me)),this.eventsSubscription=ae.events.subscribe(p._,me=>{this.run({dashboard:this.dashboard,range:this.timeSrv.timeRange()})})}run(ae){this.runs.next(ae)}getResult(ae){return this.results.asObservable().pipe((0,f.T)(re=>{const ce=(0,b.FK)(re.annotations,ae),me=re.alertStates.find(ee=>!!ae&&ee.panelId===ae);return{annotations:y(ce),alertState:me}}))}executeRun(ae){const ce=this.workers.filter(fe=>fe.canWork(ae)).map(fe=>fe.work(ae)),me=new i.yU,ee=(0,s.h)(ce).pipe((0,a.Q)(this.runs.asObservable()),(0,c.U)(),(0,o.T)((fe,Te)=>(fe.annotations=fe.annotations.concat(Te.annotations),fe.alertStates=fe.alertStates.concat(Te.alertStates),fe)),(0,h.j)(()=>{me.unsubscribe()}),(0,g.u)()),de=new i.yU,De=(0,r.O)(200).pipe((0,l.u)({annotations:[],alertStates:[]}),(0,a.Q)(ee),(0,h.j)(()=>{de.unsubscribe()}));de.add(De.subscribe(fe=>{this.results.next(fe)})),me.add(ee.subscribe(fe=>{this.results.next(fe)}))}cancel(ae){this.cancellationStream.next(ae)}cancellations(){return this.cancellationStream.asObservable().pipe((0,g.u)())}destroy(){this.results.complete(),this.runs.complete(),this.cancellationStream.complete(),this.runsSubscription.unsubscribe(),this.eventsSubscription.unsubscribe()}}let q;function ne(ie){q&&q.destroy(),q=ie}function oe(){if(!q)throw new Error("getDashboardQueryRunner can only be used after Grafana instance has started.");return q}let z;function te(ie){z=ie}function le(ie){z||(z=({dashboard:re,timeSrv:ce,workers:me})=>new j(re,ce,me));const ae=z(ie);return ne(ae),ae}},90569:(G,O,e)=>{"use strict";e.d(O,{X:()=>h});var t=e(62467),n=e(65474),i=e(40187),s=e(14236),r=e(17172),f=e(32264),a=e(57220),c=e(68706);const o="-- Public --";class h extends i.mA{constructor(){let l={};super({name:"public-ds",id:0,type:"public-ds",meta:l,uid:o,jsonData:{},access:"proxy",readOnly:!0}),this.annotations={prepareQuery(p){return{...p,queryType:c.nj.Annotations,refId:"anno"}}}}query(l){return l.targets.length?l.targets[0]?.datasource?.uid===a.vv?(0,n.H)(this.getAnnotations(l)):(0,t.of)({data:[]}):(0,t.of)({data:[]})}async getAnnotations(l){const{range:{to:p,from:m}}=l,y={from:m.valueOf(),to:p.valueOf()},d=await(0,r.AI)().get(`/api/public/dashboards/${f.$.publicDashboardAccessToken}/annotations`,y);return{data:[(0,s.Vc)(d)]}}testDatasource(){return Promise.resolve({message:"",status:""})}}},85595:(G,O,e)=>{"use strict";e.d(O,{F:()=>i});var t=e(62467),n=e(7436);class i{canWork({dashboard:r}){return r?.annotations?.list?.some(f=>f.enable&&!!f.snapshotData)}work(r){if(!this.canWork(r))return(0,n.$)();const f=this.getAnnotationsFromSnapshot(r.dashboard);return(0,t.of)({annotations:f,alertStates:[]})}getAnnotationsFromSnapshot(r){return(r?.annotations?.list?.filter(o=>o.enable)).filter(o=>!!o.snapshotData).reduce((o,h)=>o.concat((0,n.G9)(h,h.snapshotData)),[])}getAnnotationsInSnapshot(r,f){const a=this.getAnnotationsFromSnapshot(r);return(0,n.FK)(a,f)}}},7436:(G,O,e)=>{"use strict";e.d(O,{$:()=>l,FK:()=>y,G9:()=>d,H:()=>v,H0:()=>g,SD:()=>h,Zr:()=>p});var t=e(2543),n=e.n(t),i=e(62467),s=e(78368),r=e(12091),f=e(32264),a=e(99140),c=e(3169),o=e(16001);function h(u){return u.cancelled?(0,i.of)([]):(m("AnnotationQueryRunner failed",u),(0,i.of)([]))}function g(u){return m("Failed to retrieve datasource",u),(0,i.of)(void 0)}const l=()=>(0,i.of)({annotations:[],alertStates:[]});function p(u){return u.cancelled||m("DashboardQueryRunner failed",u),l()}function m(u,D){const P=(0,r.u)(D);console.error("handleAnnotationQueryRunnerError",P);const x=(0,c.gi)(u,P.message);(0,a.JD)((0,o.dx)(x))}function y(u,D){return D==null?u:u.filter(P=>{let x;if(x=P.source,!x)return!0;if(x.filter){const E=(x.filter.ids??[]).includes(D);if(x.filter.exclude){if(E)return!1}else if(!E)return!1}return P.panelId&&P.source.type==="dashboard"?P.panelId===D:!0})}function d(u,D){u.snapshotData&&(u=(0,t.cloneDeep)(u),delete u.snapshotData);for(const P of D)switch(P.source=u,P.color=f.$.theme2.visualization.getColorByName(u.iconColor),P.type=u.name,P.isRegion=!!(P.timeEnd&&P.time!==P.timeEnd),P.newState?.toLowerCase()){case"pending":P.color="yellow";break;case"alerting":P.color="red";break;case"ok":P.color="green";break;case"normal":P.color="green";break;case"no_data":P.color="gray";break;case"nodata":P.color="gray";break}return D}function v(u){if(!u||!u.length)return[];const D=[];for(const P of u){const x=new s.R(P);for(let E=0;E<P.length;E++){const C=(0,t.cloneDeep)(x.get(E));D.push(C)}}return D}},80924:(G,O,e)=>{"use strict";e.d(O,{Z:()=>A,S:()=>R});var t=e(2543),n=e(39741),i=e(62467),s=e(69862),r=e(81160),f=e(66847),a=e(39070),c=e(14236),o=e(43127),h=e(90708),g=e(21423),l=e(52622),p=e(2514),m=e(41987),y=e(65879),d=e(12091),v=e(26657),u=e(47118),D=e(31193),P=e(23989),x=e(14348),E=e(42972),C=e(49510),M=e(33948);function S(U=[]){U.forEach(W=>{W.meta={...W.meta,dataTopic:l.QR.Annotations}})}function I(U,W){return(0,C.z)([U,W]).pipe((0,s.Z)(w=>{const[N,B]=w;if(B.annotations?.length||B.alertState){N.annotations||(N.annotations=[]);const V=N.annotations.concat((0,M.I)(B.annotations));S(V);const K=B.alertState;return(0,i.of)({...N,annotations:V,alertState:K})}return S(N.annotations),(0,i.of)(N)}))}var T=e(39374);let b=100;function R(){return"Q"+b++}class A{constructor(W){this.templateSrv=(0,P.w)(),this.resendLastResult=()=>{this.lastResult&&this.subject.next(this.lastResult)},this.subject=new n.m(1),this.dataConfigSource=W}getData(W){const{withFieldConfig:w,withTransforms:N}=W;let B=1,V,K=[],H=[],X,k=!0,Y=-1;if(this.dataConfigSource.snapshotData){const Z={state:a.Gu.Done,series:this.dataConfigSource.snapshotData.map(se=>(0,c.Vc)(se)),timeRange:(0,o.E2)(),structureRev:B};return(0,i.of)(Z)}return this.subject.pipe((0,s.Z)(Z=>{let se=this.dataConfigSource.getFieldOverrideOptions(),j=this.dataConfigSource.getTransformations();if(Z.series===H&&V?.fieldConfig===se?.fieldConfig&&X===j)return(0,i.of)({...Z,structureRev:B,series:K});V=se,X=j,H=Z.series;let q=(0,i.of)(Z);return N&&(q=this.applyTransformations(Z)),q.pipe((0,r.T)(ne=>{let oe=ne,z=!1;if(w&&ne.series?.length){if(Y===this.dataConfigSource.configRev){let te;for(const le of ne.series)if((0,u.o$)(le)){te=le;break}te&&!te.packetInfo.schemaChanged&&K[0].fields.length===te.fields.length&&(oe={...oe,series:K.map((le,ie)=>({...le,length:ne.series[ie].length,fields:le.fields.map((ae,re)=>({...ae,values:ne.series[ie].fields[re].values,state:{...ae.state,calcs:void 0,range:void 0}}))}))},z=!0)}se!=null&&(k||!z)&&(Y=this.dataConfigSource.configRev,oe={...oe,series:(0,h.we)({timeZone:ne.request?.timezone??"browser",data:oe.series,...se})},oe.annotations&&(oe.annotations=(0,h.we)({data:oe.annotations,...se,fieldConfig:{defaults:{},overrides:[]}})),k=!1)}return!z&&!(0,g.J3)(K,oe.series,g.bW)&&B++,K=oe.series,{...oe,structureRev:B}}))}))}applyTransformations(W){const w=this.dataConfigSource.getTransformations();if(w&&w.every(k=>k.disabled)||!w||w.length===0)return(0,i.of)(W);const B={interpolate:k=>this.templateSrv.replace(k,W?.request?.scopedVars)};let V=w.filter(k=>k.topic==null||k.topic===l.QR.Series),K=w.filter(k=>k.topic===l.QR.Annotations),H=(0,p.m)(V,W.series,B),X=(0,p.m)(K,W.annotations??[],B);return(0,t.merge)(H,X).pipe((0,r.T)(k=>{let Z=k.some(se=>se.meta?.dataTopic===l.QR.Annotations)?{annotations:k}:{series:k};return{...W,...Z}}),(0,f.W)(k=>(console.warn("Error running transformation:",k),(0,i.of)({...W,state:a.Gu.Error,errors:[(0,d.u)(k)]}))))}async run(W){const{queries:w,timezone:N,datasource:B,panelId:V,panelPluginId:K,dashboardUID:H,timeRange:X,timeInfo:k,cacheTimeout:Y,queryCachingTTL:Z,maxDataPoints:se,scopedVars:j,minInterval:q,app:ne}=W;if((0,x.kN)(B)){this.pipeToSubject((0,x.mw)(W,w[0]),V,!0);return}const oe=this.shouldAddErrorWhenDatasourceVariableIsMultiple(B,j),z={app:ne??m.Jk.Dashboard,requestId:R(),timezone:N,panelId:V,panelPluginId:K,dashboardUID:H,range:X,timeInfo:k,interval:"",intervalMs:0,targets:(0,t.cloneDeep)(w),maxDataPoints:se,scopedVars:j||{},cacheTimeout:Y,queryCachingTTL:Z,startTime:Date.now(),rangeRaw:X.raw};try{const te=await L(B,z.scopedVars),le=te.meta?.mixed;z.targets=z.targets.map(re=>{const ce=re.datasource?.type===v.dR.type;return(!re.datasource||re.datasource.uid!==te.uid&&!le&&!ce)&&(re.datasource=te.getRef()),re});const ie=q?this.templateSrv.replace(q,z.scopedVars):te.interval,ae=y.calculateInterval(X,se,ie);z.scopedVars=Object.assign({},z.scopedVars,{__interval:{text:ae.interval,value:ae.interval},__interval_ms:{text:ae.intervalMs.toString(),value:ae.intervalMs}}),z.interval=ae.interval,z.intervalMs=ae.intervalMs,z.filters=this.templateSrv.getAdhocFilters(te.name,!0),this.lastRequest=z,this.pipeToSubject((0,T.BN)(te,z),V,!1,oe)}catch(te){this.pipeToSubject((0,i.of)({state:a.Gu.Error,error:(0,d.u)(te),series:[],timeRange:z.range}),V)}}pipeToSubject(W,w,N=!1,B=!1){this.subscription&&this.subscription.unsubscribe();let V=W;const K=this.dataConfigSource.getDataSupport();if(K.alertStates||K.annotations){const H=this.dataConfigSource;V=I(W,(0,E.Dh)().getResult(H.id))}this.subscription=V.subscribe({next:H=>{const X=this.lastResult,k=N?H:(0,c.N$)(H,X);if(X!=null&&k.state!==a.Gu.Streaming){let Y=(0,g.J3)(X.series??[],k.series??[],(j,q)=>j===q),Z=(0,g.J3)(X.annotations??[],k.annotations??[],(j,q)=>j===q),se=X.state===k.state;if(Y&&(k.series=X.series),Z&&(k.annotations=X.annotations),Y&&Z&&se)return}this.lastResult=k,B&&(k.errors=[{message:"Panel is using a variable datasource with multiple values without repeat option. Please configure the panel to be repeated by the same datasource variable."}],k.state=a.Gu.Error),this.subject.next(k)}})}cancelQuery(){this.subscription&&(this.subscription.unsubscribe(),this.lastResult&&(this.lastResult.state===a.Gu.Loading||this.lastResult.state===a.Gu.Streaming)&&this.subject.next({...this.lastResult,state:a.Gu.Done}))}clearLastResult(){this.lastResult=void 0,this.subject=new n.m(1)}destroy(){this.subject&&this.subject.complete(),this.subscription&&this.subscription.unsubscribe()}useLastResultFrom(W){this.lastResult=W.getLastResult(),this.lastResult&&this.subject.next(this.lastResult)}setLastResult(W){this.lastResult=W}getLastResult(){return this.lastResult}getLastRequest(){return this.lastRequest}shouldAddErrorWhenDatasourceVariableIsMultiple(W,w){let N=!1;return W?.uid?.startsWith("${")&&this.templateSrv.replace(W.uid,w,B=>(Array.isArray(B)&&B.length>1&&(N=!0),"")),N}}async function L(U,W){return U&&typeof U=="object"&&"query"in U?U:await(0,D.tR)().get(U,W)}},81583:(G,O,e)=>{"use strict";e.d(O,{N:()=>n});var t=e(69850);function n(i,s){return(0,t.j)(()=>{s&&i.resolveCancelerIfExists(s)})}},72955:(G,O,e)=>{"use strict";e.d(O,{B:()=>n});var t=e(21423);const n=(i,s)=>{let r=1;return s?.structureRev&&s.series&&(r=s.structureRev,(0,t.J3)(i.series,s.series,t.bW)||r++),i.structureRev=r,i}},39374:(G,O,e)=>{"use strict";e.d(O,{BN:()=>W});var t=e(2543),n=e(62467),i=e(44240),s=e(39697),r=e(65474),f=e(81160),a=e(66847),c=e(59099),o=e(1005),h=e(65961),g=e(67791),l=e(39070),p=e(52622),m=e(85858),y=e(41987),d=e(12091),v=e(32264),u=e(26657),D=e(27677),P=e(21969),x=e(53478),E=e(34867);const C=(0,E.DW)("features.query");var M=e(81583),S=e(76885),I=e(61298),T=e(14110),b=e(14792);function R(N){let B=!1;return K=>{if(!K.request||B||S.kM.getUrlSearchParams().editPanel!=null||K.state!==l.Gu.Done&&K.state!==l.Gu.Error)return;const X={eventName:I.n_.DataRequest,source:K.request.app,datasourceName:N.name,datasourceId:N.id,datasourceUid:N.uid,datasourceType:N.type,dataSize:0,panelId:0,panelPluginId:K.request?.panelPluginId,duration:K.request.endTime-K.request.startTime};V(X,K),K.request.app!==y.Jk.Explore&&K.request.app!==y.Jk.Correlations&&A(X,K),K.series&&K.series.length>0&&(X.dataSize=K.series.length),(0,T.G$)(X),B=!0};function V(K,H){const X={};for(let Y=0;Y<H.series.length;Y++){const Z=H.series[Y].refId;Z&&!X[Z]&&(X[Z]=H.series[Y].meta?.isCachedResponse??!1)}K.totalQueries=Object.keys(X).length,K.cachedQueries=Object.values(X).filter(Y=>Y===!0).length,H.request&&Number.isInteger(H.request.panelId)&&(K.panelId=H.request.panelId);const k=(0,b.UA)().getCurrent();k&&(K.dashboardId=k.id,K.dashboardName=k.title,K.dashboardUid=k.uid,K.folderName=k.meta.folderTitle)}}function A(N,B){B.errors?.length?N.error=B.errors.join(", "):B.error&&(N.error=B.error.message)}function L(N,B){const V=B.panelData.request,K={...B.packets},H=N.key??N.data?.[0]?.refId??"A";K[H]=N;let X=N.state||l.Gu.Done,k,Y;const Z=[],se=[];for(const oe in K){const z=K[oe];if((z.error||z.errors?.length)&&(X=l.Gu.Error,k=z.error,Y=z.errors),z.data&&z.data.length)for(const te of z.data){if(te.meta?.dataTopic===p.QR.Annotations){se.push(te);continue}Z.push(te)}}const j=U(V,X),q={state:X,series:Z,annotations:se,error:k,errors:Y,request:V,timeRange:j},ne=new Set([...B.panelData.traceIds??[],...N.traceIds??[]]);return ne.size>0&&(q.traceIds=Array.from(ne)),{packets:K,panelData:q}}function U(N,B){const V=N.range;return!(0,t.isString)(V.raw.from)||B!==l.Gu.Streaming?V:{...V,from:m.parse(V.raw.from,!1),to:m.parse(V.raw.to,!0)}}function W(N,B,V){let K={panelData:{state:l.Gu.Loading,series:[],request:B,timeRange:B.range},packets:{}};if(!B.targets.length)return B.endTime=Date.now(),K.panelData.state=l.Gu.Done,(0,n.of)(K.panelData);const H=w(N,B,V).pipe((0,f.T)(X=>{if(!(0,t.map)(X.data))throw new Error(`Expected response data to be array, got ${typeof X.data}.`);const k=B.targets.filter(Y=>Y.hide);for(const Y of k)X.data=X.data.filter(Z=>Z.refId!==Y.refId);return B.endTime=Date.now(),K=L(X,K),K.panelData}),(0,a.W)(X=>(console.error("runRequest.catchError",X),C.logError(X),(0,n.of)({...K.panelData,state:l.Gu.Error,error:(0,d.u)(X)}))),(0,c.M)(R(N)),(0,M.N)(D.IB,B.requestId),(0,o.u)());return(0,i.h)((0,s.O)(200).pipe((0,h.u)(K.panelData),(0,g.Q)(H)),H)}function w(N,B,V){if(B.targets=B.targets.map(H=>(0,P.Ih)(H)?{...N?.getDefaultQuery?.(y.Jk.PanelEditor),...H}:H),v.$.publicDashboardAccessToken)return(0,r.H)(N.query(B));for(const H of B.targets)if((0,u.s9)(H.datasource))return x.Ex.query(B);if(V||(B.targets=B.targets.filter(H=>N.filterQuery?.(H)??!0)),B.targets.length===0)return(0,n.of)({data:[]});const K=V?V(B):N.query(B);return(0,r.H)(K)}},93117:(G,O,e)=>{"use strict";e.d(O,{y:()=>f});var t=e(41987),n=e(73372),i=e(77789),s=e(72574),r=e(26657);async function f(a,c,o,h){let g=o;const l={...a.getRef(),uid:c},p={...a?.getDefaultQuery?.(t.Jk.PanelEditor),datasource:l,refId:"A"};if(h?.meta.id!==a.meta.id){if(a.meta.mixed)return o;if((0,n.Ee)(h)&&(0,n.FL)(a)){const m=await h.exportToAbstractQueries(o);g=await a.importFromAbstractQueries(m)}else if(h&&a.importQueries)g=await a.importQueries(o,h);else{if(h){const m=(0,s.w)(),y=[];let d=a.uid;const v=m.containsTemplate(c);v&&(d=m.replace(a.uid));const u=o.reduce((D,P)=>{if(P.datasource){let x=P.datasource.uid;const E=m.containsTemplate(x);if(E&&(x=m.replace(P.datasource.uid)),x===d&&E===v)return P.refId=(0,i.M)(D),D.concat([P])}return D},y);if(u.length>0)return u}return[p]}}return g.length===0?[p]:g.map(m=>(!(0,r.s9)(m.datasource)&&!a.meta.mixed&&(m.datasource=l),m))}},53477:(G,O,e)=>{"use strict";e.d(O,{G3:()=>f,TF:()=>o,XJ:()=>m,YU:()=>l,d7:()=>g,if:()=>y,r4:()=>r,w7:()=>p});var t=e(64161);const n=null,i=58,s=8,r={label:"A\u2013Z",value:"alpha-asc"},f="search.sections",a="grafana.search.expanded-folder",c=0,o="general",h="Dashboards",g="grafana.search.include.panels",l="grafana.search.layout",p="grafana.search.sort",m={dashboard:t.G.DashDB,folder:t.G.DashFolder,home:t.G.DashHome},y=1e3},97427:(G,O,e)=>{"use strict";e.d(O,{d:()=>r,n:()=>f});var t=e(96540),n=e(13752),i=e(71733),s=e(12131);function r(){const a=(0,t.useRef)(new n.B);return{keyboardEvents:a.current,onKeyDown:c=>{switch(c.code){case"ArrowDown":case"ArrowUp":case"ArrowLeft":case"ArrowRight":case"Enter":a.current.next(c);default:}}}}function f(a,c,o){const h=(0,t.useRef)({x:0,y:-1}),[g,l]=(0,t.useState)({x:0,y:-1}),p=(0,t.useRef)();return(0,t.useEffect)(()=>{p.current=o.view.fields.url,h.current.x=0,h.current.y=-1,l({...h.current})},[o]),(0,t.useEffect)(()=>{const m=a.subscribe({next:y=>{switch(y?.code){case"ArrowDown":{h.current.y++,l({...h.current});break}case"ArrowUp":h.current.y=Math.max(0,h.current.y-1),l({...h.current});break;case"ArrowRight":{c>0&&(h.current.x=Math.min(c,h.current.x+1),l({...h.current}));break}case"ArrowLeft":{c>0&&(h.current.x=Math.max(0,h.current.x-1),l({...h.current}));break}case"Enter":if(!p.current)break;const d=h.current.x*c+h.current.y;if(d<0){h.current.x=0,h.current.y=0,l({...h.current});break}const v=p.current.values?.[d];typeof v=="string"&&s.Ny.push(i.I.stripBaseFromUrl(v))}}});return()=>m.unsubscribe()},[a,c]),g}},6204:(G,O,e)=>{"use strict";e.d(O,{B9:()=>f,J$:()=>s,KZ:()=>r,MK:()=>i,Pf:()=>n});var t=e(14110);const n=(c,o)=>{(0,t.rR)(`${c}_viewed`,a(o))},i=(c,o)=>{(0,t.rR)(`${c}_result_clicked`,a(o))},s=(c,o)=>{(0,t.rR)(`${c}_query_submitted`,a(o))},r=(c,{error:o,...h})=>{(0,t.rR)(`${c}_query_failed`,{...a(h),error:o})},f=(c,o,h)=>{(0,t.rR)(`grafana_panel_inspect_${c}_${o}_clicked`,h)},a=c=>({layout:c.layout,starredFilter:c.starred??!1,sort:c.sortValue??"",tagCount:c.tagCount??0,queryLength:c.query?.length??0,includePanels:c.includePanels??!1,deleted:c.deleted??!1})},24439:(G,O,e)=>{"use strict";e.d(O,{getGrafanaSearcher:()=>S});var t=e(32264),n=e(78368),i=e(14236),s=e(57875),r=e(17172),f=e(40957);const a="Loading",c="api/search-v2",o="name_sort";class h{constructor(T){this.fallbackSearcher=T}async search(T){if(T.facet?.length)throw new Error("facets not supported!");return this.doSearchQuery(T)}async starred(T){if(T.facet?.length)throw new Error("facets not supported!");const b=await(0,r.AI)().get("api/user/stars");return b?.length?this.doSearchQuery({uid:b,query:T.query??"*"}):{view:new n.R({length:0,fields:[]}),totalRows:0,loadMoreItems:async(R,A)=>{},isItemLoaded:R=>!0}}async tags(T){const b={...T,query:T.query??"*",sort:void 0,facet:[{field:"tag"}],limit:1},A=(await(0,r.AI)().post(c,b)).frames.map(L=>(0,i.Vc)(L));if(A[0]?.name===a)return this.fallbackSearcher.tags(T);for(const L of A)if(L.fields[0].name==="tag")return p(L);return[]}getSortOptions(){const T=[{value:o,label:"Alphabetically (A-Z)"},{value:"-name_sort",label:"Alphabetically (Z-A)"}];if(t.$.licenseInfo.enabledFeatures.analytics){for(const b of m)T.push({value:`-${b.name}`,label:`${b.display} (most)`}),T.push({value:`${b.name}`,label:`${b.display} (least)`});for(const b of y)T.push({value:`-${b.name}`,label:`${b.display} (recent)`}),T.push({value:`${b.name}`,label:`${b.display} (oldest)`})}return Promise.resolve(T)}async doSearchQuery(T){T=await(0,f.u4)(T);const b={...T,query:T.query??"*",limit:T.limit??g},A=(await(0,r.AI)().post(c,b)).frames.map(V=>(0,i.Vc)(V)),L=A.length?(0,i.Vc)(A[0]):{fields:[],length:0};if(L.name===a)return this.fallbackSearcher.search(T);for(const V of L.fields)V.display=(0,s.J)({field:V,theme:t.$.theme2});L.meta?.custom||(L.meta={...L.meta,custom:{count:L.length,max_score:1}});const U=L.meta.custom;if(U.locationInfo||(U.locationInfo={}),U.sortBy?.length){const V=L.fields.find(K=>K.name===U.sortBy);if(V){const K=d(V.name);U.sortBy=K,V.name=K}}let W=0,w;const N=async()=>{for(;W>B.dataFrame.length;){const V=B.dataFrame.length;if(V>=U.count)return;const K=await(0,r.AI)().post(c,{...b??{},from:V,limit:l}),H=(0,i.Vc)(K.frames[0]);if(!H){console.log("no results",H);return}if(H.fields.length!==B.dataFrame.fields.length){console.log("invalid shape",H,B.dataFrame);return}const X=H.length+B.dataFrame.length;for(let Y=0;Y<H.fields.length;Y++)B.dataFrame.fields[Y].values.push(...H.fields[Y].values);B.dataFrame.length=X;const k=H.meta?.custom;if(k?.locationInfo&&U)for(const[Y,Z]of Object.entries(k.locationInfo))U.locationInfo[Y]=Z}w=void 0},B=new n.R(L);return{totalRows:U.count??L.length,view:B,loadMoreItems:async(V,K)=>(W=Math.max(W,K),w||(w=N()),w),isItemLoaded:V=>V<B.dataFrame.length}}getFolderViewSort(){return"name_sort"}}const g=50,l=100;function p(I){const T=I.fields[0].values,b=I.fields[1].values,R=[];for(let A=0;A<I.length;A++)R.push({term:T[A],count:b[A]});return R}const m=[{name:"views_total",display:"Views total"},{name:"views_last_30_days",display:"Views 30 days"},{name:"errors_total",display:"Errors total"},{name:"errors_last_30_days",display:"Errors 30 days"}],y=[{name:"created_at",display:"Created time"},{name:"updated_at",display:"Updated time"}];function d(I){for(const T of m)if(T.name===I)return T.display;for(const T of y)if(T.name===I)return T.display;return I}var v=e(53076);class u{constructor(T){this.parent=T,this.cache=new Map,this.sortPlaceholder="Default (Relevance)"}async search(T){if(T.facet?.length)throw new Error("facets not supported!");if(T.sort!=null)throw new Error("custom sorting is not supported yet");if(T.tags?.length||T.ds_uid?.length)return this.parent.search(T);const R=(await this.getCache(T.kind)).search(T.query);return{isItemLoaded:()=>!0,loadMoreItems:async(A,L)=>{},totalRows:R.length,view:R}}async getCache(T){const b=T?T.sort().join(","):"*",R=this.cache.get(b);if(R)try{return await R}catch{return this.cache.delete(b),new D(new n.R({name:"error",fields:[],length:0}))}const A=this.parent.search({kind:T,limit:5e3}).then(L=>new D(L.view));return this.cache.set(b,A),A}async starred(T){return this.parent.starred(T)}async getSortOptions(){return this.parent.getSortOptions()}async tags(T){return this.parent.tags(T)}getFolderViewSort(){return this.parent.getFolderViewSort()}}class D{constructor(T){this.full=T,this.ufuzzy=new v.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1}),this.names=this.full.fields.name.values,this.empty=new n.R({...this.full.dataFrame,fields:this.full.dataFrame.fields.map(b=>({...b,values:[]})),length:0})}search(T){if(!T?.length||T==="*")return this.full;const b=this.full.dataFrame.fields,R=this.names,A=b.map(w=>[]);let[L,U,W]=this.ufuzzy.search(R,T,5);for(let w=0;w<b.length;w++){let N=b[w].values,B=A[w];if(U&&W)for(let V=0;V<W.length;V++){let K=U.idx[W[V]];B.push(N[K])}else if(L)for(let V=0;V<L.length;V++){let K=L[V];B.push(N[K])}}return this.empty.dataFrame.fields.forEach((w,N)=>{w.values=A[N]}),this.empty.dataFrame.length=this.empty.dataFrame.fields[0].values.length,this.empty}}var P=e(11261),x=e(27677),E=e(53477);class C{constructor(){this.locationInfo={general:{kind:"folder",name:"Dashboards",url:"/dashboards"}},this.getFolderViewSort=()=>""}async composeQuery(T,b){const R=await(0,f.u4)(b);return R.query?.length&&R.query!=="*"&&(T.query=R.query),R.kind?.length===1&&E.XJ[R.kind[0]]&&(T.type=E.XJ[R.kind[0]]),R.uid?T.dashboardUID=R.uid:R.location?.length&&(T.folderUIDs=[R.location]),T}async search(T){if(T.facet?.length)throw new Error("facets not supported!");if(T.from!==void 0){if(!T.limit)throw new Error("Must specify non-zero limit parameter when using from");if(T.from/T.limit%1!==0)throw new Error("From parameter must be a multiple of limit")}const b=T.limit??(T.from!==void 0?1:E.if),R=T.from!==void 0?T.from/b+1:void 0,A=await this.composeQuery({limit:b,tag:T.tags,sort:T.sort,permission:T.permission,page:R,deleted:T.deleted},T);return this.doAPIQuery(A)}async starred(T){if(T.facet?.length)throw new Error("facets not supported!");const b=await this.composeQuery({limit:T.limit??E.if,tag:T.tags,sort:T.sort,starred:T.starred},T);return this.doAPIQuery(b)}async getSortOptions(){return(await x.IB.get("/api/search/sorting")).sortOptions.map(b=>({value:b.name,label:b.displayName}))}async tags(T){return(await x.IB.get("/api/dashboards/tags")).sort((R,A)=>A.count-R.count)}async doAPIQuery(T){const b=await x.IB.get("/api/search",T),R=[],A=[],L=[],U=[],W=[],w=[],N=[],B=[],V=[];let K;for(let k of b){const Y=k.type==="dash-folder"?"folder":"dashboard";R.push(Y),A.push(k.title),L.push(k.uid),U.push(k.url),W.push(k.tags),N.push(k.sortMeta),B.push(k.isDeleted??!1),V.push(k.permanentlyDeleteDate?new Date(k.permanentlyDeleteDate):void 0);let Z=k.folderUid;!Z&&Y==="dashboard"&&(Z="general"),w.push(Z),k.sortMetaName?.length&&(K=k.sortMetaName),k.folderUid&&k.folderTitle?this.locationInfo[k.folderUid]={kind:"folder",name:k.folderTitle,url:k.folderUrl,folderUid:k.folderUid}:Y==="folder"&&(this.locationInfo[k.uid]={kind:Y,name:k.title,url:k.url,folderUid:k.folderUid})}const H={fields:[{name:"kind",type:P.PU.string,config:{},values:R},{name:"name",type:P.PU.string,config:{},values:A},{name:"uid",type:P.PU.string,config:{},values:L},{name:"url",type:P.PU.string,config:{},values:U},{name:"tags",type:P.PU.other,config:{},values:W},{name:"location",type:P.PU.string,config:{},values:w},{name:"isDeleted",type:P.PU.boolean,config:{},values:B},{name:"permanentlyDeleteDate",type:P.PU.time,config:{},values:V}],length:A.length,meta:{custom:{count:A.length,max_score:1,locationInfo:this.locationInfo}}};K?.length&&N.length&&(H.meta.custom.sortBy=K,H.fields.push({name:K,type:P.PU.number,config:{},values:N}));for(const k of H.fields)k.display=(0,s.J)({field:k,theme:t.$.theme2});const X=new n.R(H);return{totalRows:H.length,view:X,loadMoreItems:async(k,Y)=>{},isItemLoaded:k=>!0}}}let M;function S(){if(!M){const I=new C,T=t.$.featureToggles.panelTitleSearch;M=T?new h(I):I,T&&location.search.includes("do-frontend-query")&&(M=new u(M))}return M}},40957:(G,O,e)=>{"use strict";e.d(O,{TM:()=>f,cu:()=>a,hI:()=>o,u4:()=>i});var t=e(49952),n=e(14792);async function i(h){return h.query&&h.query.indexOf("folder:current")>=0&&(h={...h,location:await s(),query:h.query.replace("folder:current","").trim()},h.query?.length||(h.query="*")),Promise.resolve(h)}async function s(){try{let h=(0,n.UA)().getCurrent();return h||(await r(500),h=(0,n.UA)().getCurrent()),Promise.resolve(h?.meta?.folderUid)}catch(h){console.error(h)}}function r(h){return new Promise(g=>setTimeout(g,h))}function f(h,g){return h==="dashboard"?"apps":h==="folder"?g?"folder-open":"folder":"question-circle"}function a(h,g){return h&&(0,t.I)(h.uid)?"users-alt":f(h.kind,g)}function c(h){switch(h){case"dashboard":case"folder":case"panel":return h;default:return"dashboard"}}function o(h,g){const l=g?.dataFrame.meta?.custom,p={kind:c(h.kind),uid:h.uid,title:h.name,url:h.url,tags:h.tags??[]},m=l?.sortBy;if(m){const y=h[m];(typeof y=="string"||typeof y=="number")&&(p.sortMetaName=m,p.sortMeta=y)}if(h.location){const y=h.location.split("/"),d=y[y.length-1],v=l?.locationInfo[d];v&&(p.parentTitle=v.name,p.parentKind=v.kind,p.parentUID=d)}return p}},64161:(G,O,e)=>{"use strict";e.d(O,{G:()=>t,P:()=>n});var t=(i=>(i.DashDB="dash-db",i.DashHome="dash-home",i.DashFolder="dash-folder",i))(t||{}),n=(i=>(i.List="list",i.Folders="folders",i))(n||{})},16757:(G,O,e)=>{"use strict";e.d(O,{N1:()=>r,W1:()=>i});var t=e(53477);const n=f=>f?!!(f.query||f.tag?.length>0||f.starred||f.sort):!1,i=()=>{const f=t.G3+".";for(let a=0;a<window.localStorage.length;a++){const c=window.localStorage.key(a);c?.startsWith(f)&&window.localStorage.removeItem(c)}},s=(f="General")=>`${SECTION_STORAGE_KEY}.${f.toLowerCase()}`,r=f=>{const a=Object.entries(f).reduce((c,[o,h])=>{if(h){if(o==="tag"&&!Array.isArray(h))return{...c,tag:[h]}}else return c;return{...c,[o]:h}},{});if(f.folder){const c=`folder:${f.folder}`;return{...a,query:`${c} ${(a.query??"").replace(c,"")}`}}return{...a}}},1936:(G,O,e)=>{"use strict";e.d(O,{Ay:()=>E,EC:()=>D,FW:()=>y,G3:()=>c,L5:()=>x,QM:()=>f,Yh:()=>d,aD:()=>o,c3:()=>P,ch:()=>a,dJ:()=>h,ew:()=>u,jE:()=>g,zh:()=>v});var t=e(65307),n=e(31678);const i={serviceAccount:{},isLoading:!0,tokens:[]},s=(0,t.Z0)({name:"serviceaccount",initialState:i,reducers:{serviceAccountFetchBegin:C=>({...C,isLoading:!0}),serviceAccountFetchEnd:C=>({...C,isLoading:!1}),serviceAccountLoaded:(C,M)=>({...C,serviceAccount:M.payload,isLoading:!1}),serviceAccountTokensLoaded:(C,M)=>({...C,tokens:M.payload,isLoading:!1}),rolesFetchBegin:C=>({...C,rolesLoading:!0}),rolesFetchEnd:C=>({...C,rolesLoading:!1})}}),r=s.reducer,{serviceAccountLoaded:f,serviceAccountTokensLoaded:a,serviceAccountFetchBegin:c,serviceAccountFetchEnd:o,rolesFetchBegin:h,rolesFetchEnd:g}=s.actions,l={serviceAccounts:[],isLoading:!0,roleOptions:[],query:"",page:0,perPage:50,totalPages:1,showPaging:!1,serviceAccountStateFilter:n.ServiceAccountStateFilter.All},p=(0,t.Z0)({name:"serviceaccounts",initialState:l,reducers:{serviceAccountsFetched:(C,M)=>{const{totalCount:S,perPage:I,...T}=M.payload,b=Math.ceil(S/I);return{...C,...T,totalPages:b,perPage:I,showPaging:b>1,isLoading:!1}},serviceAccountsFetchBegin:C=>({...C,isLoading:!0}),serviceAccountsFetchEnd:C=>({...C,isLoading:!1}),acOptionsLoaded:(C,M)=>({...C,roleOptions:M.payload}),queryChanged:(C,M)=>({...C,query:M.payload,page:0}),pageChanged:(C,M)=>({...C,page:M.payload}),stateFilterChanged:(C,M)=>({...C,serviceAccountStateFilter:M.payload})}}),m=p.reducer,{serviceAccountsFetchBegin:y,serviceAccountsFetchEnd:d,serviceAccountsFetched:v,acOptionsLoaded:u,pageChanged:D,stateFilterChanged:P,queryChanged:x}=p.actions,E={serviceAccountProfile:r,serviceAccounts:m}},8212:(G,O,e)=>{"use strict";e.d(O,{Ay:()=>p,NV:()=>g,Y1:()=>c,j7:()=>a,kH:()=>f,pB:()=>h,s7:()=>o,sF:()=>r,sJ:()=>s});var t=e(65307);const n={supportBundles:[],isLoading:!1,supportBundleCollectors:[],createBundlePageLoading:!1,loadBundlesError:"",createBundleError:""},i=(0,t.Z0)({name:"supportBundles",initialState:n,reducers:{supportBundlesLoaded:(m,y)=>({...m,supportBundles:y.payload,isLoading:!1}),fetchBegin:m=>({...m,isLoading:!0}),fetchEnd:m=>({...m,isLoading:!1}),collectorsFetchBegin:m=>({...m,createBundlePageLoading:!0}),collectorsFetchEnd:m=>({...m,createBundlePageLoading:!1}),supportBundleCollectorsLoaded:(m,y)=>({...m,supportBundleCollectors:y.payload,createBundlePageLoading:!1}),setLoadBundleError:(m,y)=>({...m,loadBundlesError:y.payload,supportBundleCollectors:[]}),setCreateBundleError:(m,y)=>({...m,createBundleError:y.payload})}}),{supportBundlesLoaded:s,fetchBegin:r,fetchEnd:f,supportBundleCollectorsLoaded:a,collectorsFetchBegin:c,collectorsFetchEnd:o,setLoadBundleError:h,setCreateBundleError:g}=i.actions,p={supportBundles:i.reducer}},34655:(G,O,e)=>{"use strict";e.d(O,{$T:()=>p,$u:()=>a,Ay:()=>u,EC:()=>f,L5:()=>r,Q9:()=>s,dJ:()=>c,jE:()=>o,tC:()=>m});var t=e(65307);const n={teams:[],page:1,query:"",perPage:30,totalPages:0,noTeams:!1,hasFetched:!1},i=(0,t.Z0)({name:"teams",initialState:n,reducers:{teamsLoaded:(D,P)=>{const{totalCount:x,perPage:E,...C}=P.payload,M=Math.ceil(x/E);return{...D,...C,totalPages:M,perPage:E,hasFetched:!0}},queryChanged:(D,P)=>({...D,page:1,query:P.payload}),pageChanged:(D,P)=>({...D,page:P.payload}),sortChanged:(D,P)=>({...D,sort:P.payload,page:1}),rolesFetchBegin:D=>({...D,rolesLoading:!0}),rolesFetchEnd:D=>({...D,rolesLoading:!1})}}),{teamsLoaded:s,queryChanged:r,pageChanged:f,sortChanged:a,rolesFetchBegin:c,rolesFetchEnd:o}=i.actions,h=i.reducer,g={team:{},members:[],groups:[],searchMemberQuery:""},l=(0,t.Z0)({name:"team",initialState:g,reducers:{teamLoaded:(D,P)=>({...D,team:P.payload}),teamMembersLoaded:(D,P)=>({...D,members:P.payload}),setSearchMemberQuery:(D,P)=>({...D,searchMemberQuery:P.payload}),teamGroupsLoaded:(D,P)=>({...D,groups:P.payload})}}),{teamLoaded:p,teamGroupsLoaded:m,teamMembersLoaded:y,setSearchMemberQuery:d}=l.actions,v=l.reducer,u={teams:h,team:v}},23989:(G,O,e)=>{"use strict";e.d(O,{w:()=>ne});var t=e(2543),n=e(95344),i=e(19347),s=e(72574),r=e(80943),f=e(52622),a=e(73788),c=e(20601),o=e(13344),h=e(24240),g=e(87421),l=e(75096);let p={};function m(oe){const z=p[oe];return z||(p[oe]=(0,t.property)(oe))}class y{constructor(z,te,le){this.state={name:z.name,value:te,text:le,type:z.type}}getValue(z){let{value:te}=this.state;return te==="string"||te==="number"||te==="boolean"?te:String(te)}getValueText(){const{value:z,text:te}=this.state;return typeof te=="string"?z===o.To?o.Zm:te:Array.isArray(te)?te.join(" + "):(console.log("value",te),String(te))}}let d;function v(oe,z,te){return d?(d.state.name=oe.name,d.state.type=oe.type,d.state.value=z,d.state.text=te):d=new y(oe,z,te),d}function u(oe,z,te,le){if(te=te||{},oe==null||(0,h.EW)(te)&&z!==f.$m.QueryParam)return"";if(!Array.isArray(oe)&&typeof oe=="object"&&(oe=`${oe}`),typeof z=="function")return z(oe,te,u);z||(z=f.$m.Glob);let ie=z.split(":");ie.length>1?(z=ie[0],ie=ie.slice(1)):ie=[];let ae=r.vz.getIfExists(z);ae||(console.error(`Variable format ${z} not found. Using glob format as fallback.`),ae=r.vz.get(f.$m.Glob));const re=v(te,oe,le??oe);return ae.formatter(oe,ie,re)}var D=e(84743),P=e.n(D),x=e(6709),E=e(76885),C=e(1933),M=e(74856),S=e(25304),I=e(83195),T=e(11261),b=e(92461),R=e(57875),A=e(28240),L=e(8249);function U(oe,z,te){return new Proxy({},{get:(le,ie)=>{if(ie==="name")return oe.name;if(ie==="displayName")return(0,A.Ct)(oe,z,te);if(ie==="labels"||ie==="formattedLabels")return oe.labels?{...oe.labels,__values:Object.values(oe.labels).sort().join(", "),toString:()=>(0,L.h6)(oe.labels,"",!0)}:""}})}function W(oe,z,te,le){const ie=w(oe,z,te);return u(ie,le)}function w(oe,z,te){const le=te?.__dataContext;if(!le)return oe;const{frame:ie,rowIndex:ae,field:re,calculatedValue:ce}=le.value;if(ce)switch(z){case"numeric":return ce.numeric.toString();case"raw":return ce.numeric;case"time":return"";case"text":default:return(0,I.cN)(ce)}if(ae===void 0)return oe;if(z==="time"){const De=ie.fields.find(fe=>fe.type===T.PU.time);return De?De.values[ae]:void 0}const me=re.values[ae];if(z==="raw")return me;const de=(re.display??V())(me);switch(z){case"numeric":return de.numeric;case"text":return de.text;default:return(0,I.cN)(de)}}function N(oe,z,te,le){const ie=te?.__dataContext;if(!ie||!z)return oe;const{frame:ae,rowIndex:re}=ie.value;if(re===void 0||z===void 0)return oe;const ce={name:ae.name,refId:ae.refId,fields:(0,b.F)({frame:ae,rowIndex:re})},me=m(z)(ce)??"";return u(me,le)}let B;function V(){return B||(B=(0,R.J)()),B}function K(oe,z,te,le){const ie=te?.__dataContext;if(!ie||z!=="name")return oe;const{frame:ae,frameIndex:re}=ie.value,ce=(0,A.Ri)(ae,re);return u(ce,le)}function H(oe,z,te,le){const ie=te?.__dataContext;if(!ie||z===void 0||z==="")return oe;const{frame:ae,field:re,data:ce}=ie.value,me=U(re,ae,ce),ee=m(z)(me)??"";return u(ee,le)}const X={__value:W,__data:N,__series:K,__field:H,[x.c.includeVars]:k,[x.c.keepTime]:Y,__timezone:Z};function k(oe,z,te){const le=(0,S.z)(te);return E.kM.toUrlParams(le)}function Y(){return E.kM.toUrlParams((0,M.jG)().timeRangeForUrl())}function Z(){const oe=(0,C.O)({timeZone:(0,M.jG)().timeModel?.getTimezone()});return oe==="browser"?P().tz.guess():oe}const se={getFilteredVariables:g.bZ,getVariables:g.UN,getVariableWithName:g._2};class j{constructor(z=se){this.dependencies=z,this.regex=l.SY,this.index={},this.grafanaVariables=new Map,this._timeRange=null,this._adhocFiltersDeprecationWarningLogged=new Map,this._variables=[]}init(z,te){this._variables=z,this._timeRange=te,this.updateIndex()}get variables(){return(0,n.l)("template_srv.ts","variables","getVariables"),this.getVariables()}getVariables(){return window.__grafanaSceneContext?(0,a.E)(window.__grafanaSceneContext):this.dependencies.getVariables()}get timeRange(){return window.__grafanaSceneContext&&window.__grafanaSceneContext.isActive?r.jh.getTimeRange(window.__grafanaSceneContext).state.value:this._timeRange}updateIndex(){const z=te=>te||te==="";if(this.index=this._variables.reduce((te,le)=>(le.current&&(le.current.isNone||z(le.current.value))&&(te[le.name]=le),te),{}),this.timeRange){const te=this.timeRange.from.valueOf().toString(),le=this.timeRange.to.valueOf().toString();this.index={...this.index,__from:{current:{value:te,text:te}},__to:{current:{value:le,text:le}}}}}updateTimeRange(z){this._timeRange=z,this.updateIndex()}variableInitialized(z){this.index[z.name]=z}getAdhocFilters(z,te){let le=[],ie=(0,i.l)().getInstanceSettings(z);if(!ie)return[];!te&&!this._adhocFiltersDeprecationWarningLogged.get(ie.type)&&((0,n.l)(`DataSource ${ie.type}`,"templateSrv.getAdhocFilters","filters property on the request (DataQueryRequest). Or if this is called from interpolateVariablesInQueries or applyTemplateVariables it is passed as a new argument"),this._adhocFiltersDeprecationWarningLogged.set(ie.type,!0));for(const ae of this.getAdHocVariables()){const re=ae.datasource?.uid;(re===ie.uid||re?.indexOf("$")===0&&this.replace(re)===ie.uid)&&(le=le.concat(ae.filters))}return le}setGrafanaVariable(z,te){this.grafanaVariables.set(z,te)}setGlobalVariable(z,te){(0,n.l)("template_srv.ts","setGlobalVariable",""),this.index={...this.index,[z]:{current:te}}}getVariableName(z){this.regex.lastIndex=0;const te=this.regex.exec(z);return te?te.slice(1).find(ie=>ie!==void 0):null}containsTemplate(z){if(!z)return!1;const te=this.getVariableName(z),le=te&&this.getVariableAtIndex(te);return le!=null}variableExists(z){return(0,n.l)("template_srv.ts","variableExists","containsTemplate"),this.containsTemplate(z)}highlightVariablesAsHtml(z){return!z||!(0,t.isString)(z)?z:(z=(0,t.escape)(z),this._replaceWithVariableRegex(z,void 0,(te,le)=>this.getVariableAtIndex(le)?'<span class="template-variable">'+te+"</span>":te))}getAllValue(z){if(z.allValue)return z.allValue;const te=[];for(let le=1;le<z.options.length;le++)te.push(z.options[le].value);return te}getVariableValue(z,te){return te?m(te)(z.value):z.value}getVariableText(z,te){return z.value===te||typeof te!="string"?z.text:te}replace(z,te,le,ie){if(te&&te.__sceneObject){const ae=te.__sceneObject.value.valueOf();return r.jh.interpolate(ae,z,te,le,ie)}return window.__grafanaSceneContext&&window.__grafanaSceneContext.isActive?r.jh.interpolate(window.__grafanaSceneContext,z,te,le,ie):z?(this.regex.lastIndex=0,this._replaceWithVariableRegex(z,le,(ae,re,ce,me)=>{const ee=this._evaluateVariableExpression(ae,re,ce,me,te);return ie&&ie.push({match:ae,variableName:re,fieldPath:ce,format:me,value:ee,found:ee!==ae}),ee})):z??""}_evaluateVariableExpression(z,te,le,ie,ae){const re=this.getVariableAtIndex(te),ce=ae?.[te];if(ce){const De=this.getVariableValue(ce,le),fe=this.getVariableText(ce,De);if(De!=null)return u(De,ie,re,fe)}if(!re){const De=X[te];return De?De(z,le,ae,ie):z}if(ie===f.$m.QueryParam||(0,h.EW)(re)){const De=c.B.get(re.type).getValueForUrl(re),fe=(0,h.EW)(re)?re.id:re.current.text;return u(De,ie,re,fe)}const me=this.grafanaVariables.get(re.current.value);if(me)return u(me,ie,re);let ee=re.current.value,de=re.current.text;if(this.isAllValue(ee)&&(ee=this.getAllValue(re),de=o.Zm,re.allValue&&ie!==f.$m.Text&&ie!==f.$m.PercentEncode))return this.replace(ee);if(le){const De=this.getVariableValue({value:ee,text:de},le);if(De!=null)return u(De,ie,re,de)}return u(ee,ie,re,de)}_replaceWithVariableRegex(z,te,le){return this.regex.lastIndex=0,z.replace(this.regex,(ie,ae,re,ce,me,ee,de)=>le(ie,ae||re||me,ee,ce||de||te))}isAllValue(z){return z===o.To||Array.isArray(z)&&z[0]===o.To}replaceWithText(z,te){return(0,n.l)("template_srv.ts","replaceWithText()","replace(), and specify the :text format"),this.replace(z,te,"text")}getVariableAtIndex(z){if(z)return this.index[z]?this.index[z]:this.dependencies.getVariableWithName(z)}getAdHocVariables(){return this.dependencies.getFilteredVariables(h.EW)}}const q=new j;(0,s.d)(q);const ne=()=>q},29352:(G,O,e)=>{"use strict";e.d(O,{v:()=>A});var t=e(4200),n=e(80943);function i({title:L,unit:U}){return n.d0.timeseries().setTitle(L).setUnit(U).setOption("legend",{showLegend:!1}).setCustomFieldConfig("fillOpacity",9)}function s({description:L,mainQueryExpr:U,breakdownQueryExpr:W,unit:w}){const N={title:`${t.Rp}`,unit:w},B={refId:"A",expr:U,legendFormat:L},V={...N,title:L,queries:[B],variant:"main",vizBuilder:()=>i({...V})},K={...V,title:`${t.Rp}`,queries:[{...B,legendFormat:L}],vizBuilder:()=>i(K),variant:"preview"},H={...N,queries:[{refId:"A",expr:W,legendFormat:`{{${t.aZ}}}`}],vizBuilder:()=>i(H),variant:"breakdown"};return{preview:K,main:V,breakdown:H,variants:[]}}const r=`${t.Rp}${t.ui}`,f=`rate(${r}[$__rate_interval])`;function a(L){return L?f:r}const c={avg:"average",sum:"overall"};function o(L){return c[L]||L}function h({agg:L,rate:U,unit:W}){const w=a(U),N=U?`${o(L)} per-second rate`:`${o(L)}`,B=`${t.Rp} (${N})`,V=`${L}(${w})`,K=`${L}(${w})by(${t.aZ})`;return s({description:B,mainQueryExpr:V,breakdownQueryExpr:K,unit:W})}var g=e(8620);const l=new Set(["count","total"]),p=new Set(["sum","bucket"]),m={count:"sum",total:"sum"};function y(L){return L==="total"}function d(L){const U=L.at(-1);if(U==null||p.has(U))throw new Error(`This function does not support a metric suffix of "${U}"`);const W=l.has(U),w=m[U]||"avg",N=y(U)?L.at(-2):U,B=W?(0,g.MM)(N):(0,g.l_)(N);return{agg:w,unit:B,rate:W}}function v(L){const U=d(L);return h(U)}const u={generator:v};var D=e(52995);function P({title:L,unit:U}){return n.d0.heatmap().setTitle(L).setUnit(U).setOption("calculate",!1).setOption("color",{mode:D.P7.Scheme,exponent:.5,scheme:"Spectral",steps:32,reverse:!1})}function x({title:L,unit:U}){return n.d0.timeseries().setTitle(L).setUnit(U).setCustomFieldConfig("fillOpacity",9)}function E(L){const U=`${t.Rp}`,W=L.at(-2),w=(0,g.l_)(W),N={title:U,unit:w},B={...N,variant:"p50",queries:[I(50)],vizBuilder:()=>i(B)},V={...N,variant:"p50",queries:[I(50,[t.aZ])],vizBuilder:()=>i(V)},K={...N,variant:"percentiles",queries:[99,90,50].map(X=>I(X)),vizBuilder:()=>x(K)},H={...N,variant:"heatmap",queries:[S()],vizBuilder:()=>P(H)};return{preview:B,main:K,variants:[K,H],breakdown:V}}const C=`rate(${t.Rp}${t.ui}[$__rate_interval])`;function M(L=[]){return`sum by(${["le",...L].join(", ")}) (${C})`}function S(L=[]){return{refId:"Heatmap",expr:M(L),format:"heatmap"}}function I(L,U=[]){const W=L/100;let w=`${L}th Percentile`;return U[0]&&(w=`{{${U[0]}}}`),{refId:`Percentile${L}`,expr:`histogram_quantile(${W}, ${M(U)})`,legendFormat:w}}function T(L){if(L.at(-1)!=="sum")throw new Error('createSummaryQueryDefs is only to be used for metrics that end in "_sum"');const W=L.at(-2),w=(0,g.l_)(W),B=a(!0),V=L.slice(0,-1).join("_"),K=Y(`sum(${B})`),H=Y(`sum(${B})by(${t.aZ})`),k=`${V} (average)`;function Y(Z){const se=Z.replace(t.Rp,`${V}_sum`),j=Z.replace(t.Rp,`${V}_count`);return`${se}/${j}`}return s({description:k,mainQueryExpr:K,breakdownQueryExpr:H,unit:w})}const b={sum:T,bucket:E};function R(L){return L&&b[L]||u.generator}function A(L){const U=L.split("_"),W=U.at(-1),w=R(W);if(!w)throw new Error(`Unable to generate queries for metric "${L}" due to issues with derived suffix "${W}"`);return w(U)}},8620:(G,O,e)=>{"use strict";e.d(O,{MM:()=>c,l_:()=>i,vL:()=>n});const t="short";function n(o){const h=o.split("_"),g=h.at(-1)??"",l=h.at(-2)??"";return r.includes(g)?g:r.includes(l)?l:null}function i(o){return o&&s[o]||t}const s={bytes:"bytes",seconds:"s"},r=["bytes","seconds"],f={bytes:"Bps",seconds:"short"},a="cps";function c(o){return o&&f[o]||a}},56833:(G,O,e)=>{"use strict";e.d(O,{b:()=>S,B:()=>I});var t=e(74848),n=e(32196),i=e(76885),s=e(64388),r=e(12470),f=e(12131),a=e(23172),c=e(80943),o=e(40845),h=e(69444),g=e(15292),l=e(83122),p=e(27746),m=e(40588);class y extends c.Bs{constructor(L){super({stickyMainGraph:L.stickyMainGraph??!0,isOpen:L.isOpen??!1}),this.onToggleStickyMainGraph=()=>{const U=!this.state.stickyMainGraph;(0,m.z)("settings_changed",{stickyMainGraph:U}),this.setState({stickyMainGraph:U})},this.onToggleOpen=U=>{this.setState({isOpen:U})}}static{this.Component=({model:L})=>{const{stickyMainGraph:U,isOpen:W}=L.useState(),w=(0,o.of)(d),N=()=>(0,t.jsxs)("div",{className:w.popover,onClick:B=>B.stopPropagation(),children:[(0,t.jsx)("div",{className:w.heading,children:"Settings"}),(0,t.jsxs)("div",{className:w.options,children:[(0,t.jsx)("div",{children:"Always keep selected metric graph in-view"}),(0,t.jsx)(g.d,{value:U,onChange:L.onToggleStickyMainGraph})]})]});return(0,t.jsx)(l.m,{overlay:N,placement:"bottom",onVisibleChange:L.onToggleOpen,children:(0,t.jsx)(p.I,{icon:"cog",variant:"canvas",isOpen:W})})}}}function d(A){return{popover:(0,n.css)({display:"flex",padding:A.spacing(2),flexDirection:"column",background:A.colors.background.primary,boxShadow:A.shadows.z3,borderRadius:A.shape.borderRadius(),border:`1px solid ${A.colors.border.weak}`,zIndex:1,marginRight:A.spacing(2)}),heading:(0,n.css)({fontWeight:A.typography.fontWeightMedium,paddingBottom:A.spacing(2)}),options:(0,n.css)({display:"grid",gridTemplateColumns:"1fr 50px",rowGap:A.spacing(1),columnGap:A.spacing(2)})}}var v=e(13054),u=e(94383),D=e(21028),P=e(90623),x=e(74764),E=e(88434),C=e(4200),M=e(51080);class S extends c.Bs{constructor(L){super({$timeRange:L.$timeRange??new c.JZ({}),$variables:L.$variables??T(L.initialDS,L.metric,L.initialFilters),controls:L.controls??[new c.K8({layout:"vertical"}),new c.N0,new c.KE({}),new c.WM({})],history:L.history??new v.L({}),settings:L.settings??new y({}),createdAt:L.createdAt??new Date().getTime(),...L}),this._urlSync=new c.So(this,{keys:["metric","metricSearch"]}),this._variableDependency=new c.Sh(this,{variableNames:[C.EY],onReferencedVariableValueChanged:async U=>{const{name:W}=U.state;W===C.EY&&this.datasourceHelper.reset()}}),this._addingFilterWithoutReportingInteraction=!1,this.datasourceHelper=new E.q(this),this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){this.state.topScene||this.setState({topScene:I(this.state.metric)}),this.subscribeToEvent(C.OO,this._handleMetricSelectedEvent.bind(this));const L=c.jh.lookupVariable(C.Ao,this);L instanceof c.H9&&this._subs.add(L?.subscribeToState((W,w)=>{this._addingFilterWithoutReportingInteraction||(0,m.h)(W.filters,w.filters)}));const U=()=>(0,x._r)().setRecentTrail(this);return window.addEventListener("unload",U),()=>{this.state.embedded||U(),window.removeEventListener("unload",U)}}addFilterWithoutReportingInteraction(L){const U=c.jh.lookupVariable("filters",this);U instanceof c.H9&&(this._addingFilterWithoutReportingInteraction=!0,U.setState({filters:[...U.state.filters,L]}),this._addingFilterWithoutReportingInteraction=!1)}getMetricMetadata(L){return this.datasourceHelper.getMetricMetadata(L)}getCurrentMetricMetadata(){return this.getMetricMetadata(this.state.metric)}restoreFromHistoryStep(L){!L.topScene&&!L.metric&&(L.topScene=new D.t({})),this.setState(c.Go.cloneSceneObjectState(L,{history:this.state.history,metric:L.metric?L.metric:void 0,metricSearch:L.metricSearch?L.metricSearch:void 0}));const U=(0,c.Is)().getUrlState(this),W=i.kM.renderUrl(f.Ny.getLocation().pathname,U);f.Ny.replace(W)}_handleMetricSelectedEvent(L){this.setState(this.getSceneUpdatesForNewMetricValue(L.payload));const U=c.jh.lookupVariable(C.Ao,this);U instanceof c.H9&&U.setState({baseFilters:R(L.payload)})}getSceneUpdatesForNewMetricValue(L){const U={};return U.metric=L,U.topScene=I(L),U}getUrlState(){const{metric:L,metricSearch:U}=this.state;return{metric:L,metricSearch:U}}updateFromUrl(L){const U={};typeof L.metric=="string"?this.state.metric!==L.metric&&Object.assign(U,this.getSceneUpdatesForNewMetricValue(L.metric)):L.metric==null&&(U.metric=void 0,U.topScene=new D.t({})),typeof L.metricSearch=="string"?U.metricSearch=L.metricSearch:L.metric==null&&(U.metricSearch=void 0),this.setState(U)}static{this.Component=({model:L})=>{const{controls:U,topScene:W,history:w,settings:N,metric:B}=L.useState(),V=(0,a.k)(),K=(0,o.of)(b,V??0),H=(0,x._r)().recent.length<2;return(0,t.jsx)(h.Y,{navId:"explore/metrics",pageNav:{text:(0,M.aO)(B)},layout:s.k.Custom,children:(0,t.jsxs)("div",{className:K.container,children:[H&&(0,t.jsx)(P.p,{}),(0,t.jsx)(w.Component,{model:w}),U&&(0,t.jsxs)("div",{className:K.controls,children:[U.map(X=>(0,t.jsx)(X.Component,{model:X},X.state.key)),(0,t.jsx)(N.Component,{model:N})]}),(0,t.jsx)("div",{className:K.body,children:W&&(0,t.jsx)(W.Component,{model:W})})]})})}}}function I(A){return A?new u.R({metric:A}):new D.t({})}function T(A,L,U){return new c.Pj({variables:[new c.mI({name:C.EY,label:"Data source",description:"Only prometheus data sources are supported",value:A,pluginId:"prometheus"}),new c.H9({name:C.Ao,addFilterButtonText:"Add label",datasource:C.GH,hide:r.zL.hideLabel,layout:"vertical",filters:U??[],baseFilters:R(L)})]})}function b(A,L){return{container:(0,n.css)({flexGrow:1,display:"flex",gap:A.spacing(1),flexDirection:"column",background:A.isLight?A.colors.background.primary:A.colors.background.canvas,padding:A.spacing(2,3,2,3)}),body:(0,n.css)({flexGrow:1,display:"flex",flexDirection:"column"}),controls:(0,n.css)({display:"flex",gap:A.spacing(1),padding:A.spacing(1,0),alignItems:"flex-end",flexWrap:"wrap",position:"sticky",background:A.isDark?A.colors.background.canvas:A.colors.background.primary,zIndex:A.zIndex.navbarFixed,top:L})}}function R(A){return A?[{key:"__name__",operator:"=",value:A}]:[]}},13054:(G,O,e)=>{"use strict";e.d(O,{L:()=>p,h:()=>l});var t=e(74848),n=e(32196),i=e(96540),s=e(80943),r=e(67061),f=e(40845),a=e(56034),c=e(56833),o=e(40588),h=e(4200),g=e(51080);function l(v){return"currentStep"in v&&"steps"in v}class p extends s.Bs{constructor(u){super({steps:u.steps??[],currentStep:u.currentStep??0}),this.stepTransitionInProgress=!1,this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){const u=(0,g.kj)(this);if(this.state.steps.length===0&&(this.addTrailStep(u,"start"),u.state.metric)){const{metric:D,...P}=u.state;P.topScene=(0,c.B)(void 0),this.state.steps[0].trailState=P,this.addTrailStep(u,"metric")}u.subscribeToState((D,P)=>{D.metric!==P.metric&&(this.state.steps.length===1&&(this.state.steps[0].trailState=s.Go.cloneSceneObjectState(P,{history:this})),(D.metric||P.metric)&&this.addTrailStep(u,"metric"))}),u.subscribeToEvent(s.oh,D=>{D.payload.state.name===h.Ao&&this.addTrailStep(u,"filters")}),u.subscribeToEvent(s.bZ,D=>{if(D.payload.changedObject instanceof s.JZ){const{prevState:P,newState:x}=D.payload;if((0,g.iG)(P)&&(0,g.iG)(x)&&P.from===x.from&&P.to===x.to)return;this.addTrailStep(u,"time")}})}addTrailStep(u,D){if(this.stepTransitionInProgress)return;const P=this.state.steps.length,x=D==="start"?-1:this.state.currentStep;this.setState({currentStep:P,steps:[...this.state.steps,{description:"Test",type:D,trailState:s.Go.cloneSceneObjectState(u.state,{history:this}),parentIndex:x}]})}goBackToStep(u){if(u===this.state.currentStep)return;const D=this.state.steps[u],P=D.type==="metric"&&D.trailState.metric===void 0?"metric-clear":D.type;(0,o.z)("history_step_clicked",{type:P,step:u,numberOfSteps:this.state.steps.length}),this.stepTransitionInProgress=!0,this.setState({currentStep:u}),(0,g.kj)(this).restoreFromHistoryStep(D.trailState),this.stepTransitionInProgress=!1}renderStepTooltip(u){return(0,t.jsxs)(r.B,{direction:"column",children:[(0,t.jsx)("div",{children:u.type}),u.type==="metric"&&(0,t.jsx)("div",{children:u.trailState.metric||"Select new metric"})]})}static{this.Component=({model:u})=>{const{steps:D,currentStep:P}=u.useState(),x=(0,f.of)(m),{ancestry:E,alternatePredecessorStyle:C}=(0,i.useMemo)(()=>{const M=new Set;let S=P;for(;S>=0;){const T=D[S];if(!T)break;M.add(S),S=T.parentIndex}const I=new Map;return M.forEach(T=>{const b=D[T].parentIndex;b+1!==T&&I.set(T,d(T,b))}),{ancestry:M,alternatePredecessorStyle:I}},[P,D]);return(0,t.jsxs)("div",{className:x.container,children:[(0,t.jsx)("div",{className:x.heading,children:"History"}),D.map((M,S)=>{let I=M.type;return I==="metric"&&M.trailState.metric===void 0&&(I="start"),(0,t.jsx)(a.m,{content:()=>u.renderStepTooltip(M),children:(0,t.jsx)("button",{className:(0,n.cx)(x.step,x.stepTypes[I],P===S?x.stepSelected:"",C.get(S)??"",S!==M.parentIndex+1?x.stepOmitsDirectLeftLink:"",S===0?x.stepOmitsDirectLeftLink:"",E.has(S)?"":x.stepIsNotAncestorOfCurrent),onClick:()=>u.goBackToStep(S)})},S)})]})}}}function m(v){const u=v.visualization;return{container:(0,n.css)({display:"flex",gap:10,alignItems:"center"}),heading:(0,n.css)({}),step:(0,n.css)({flexGrow:0,cursor:"pointer",border:"none",boxShadow:"none",padding:0,margin:0,width:8,height:8,opacity:.7,borderRadius:v.shape.radius.circle,background:v.colors.primary.main,position:"relative","&:hover":{opacity:1},"&:hover:before":{opacity:.7},"&:before":{content:'""',position:"absolute",width:10,height:2,left:-10,top:3,background:v.colors.primary.border,pointerEvents:"none"}}),stepSelected:(0,n.css)({"&:after":{content:'""',borderStyle:"solid",borderWidth:2,borderRadius:"50%",position:"absolute",width:16,height:16,left:-4,top:-4,boxShadow:`0px 0px 0px 2px inset ${v.colors.background.canvas}`}}),stepOmitsDirectLeftLink:(0,n.css)({"&:before":{background:"none"}}),stepIsNotAncestorOfCurrent:(0,n.css)({opacity:.2,"&:hover:before":{opacity:.2}}),stepTypes:{start:y(u.getColorByName("green")),filters:y(u.getColorByName("purple")),metric:y(u.getColorByName("orange")),time:y(v.colors.primary.main)}}}function y(v){return(0,n.css)({background:v,"&:before":{background:v,borderColor:v},"&:after":{borderColor:v}})}function d(v,u){const x=(v-u)*18;return(0,n.css)({"&:before":{content:'""',width:x+2,height:10,borderStyle:"solid",borderWidth:2,borderBottom:"none",borderTopLeftRadius:8,borderTopRightRadius:8,top:-10,left:3-x,background:"none"}})}},94383:(G,O,e)=>{"use strict";e.d(O,{k:()=>be,R:()=>$e});var t=e(74848),n=e(32196),i=e(32264),s=e(80943),r=e(40845),f=e(90613),a=e(67061),c=e(27746),o=e(14578),h=e(55852),g=e(63021),l=e(40675),p=e(56034),m=e(87490),y=e(2543),d=e(11261),v=e(88575),u=e(13344),D=e(29352),P=e(77366),x=e(96540),E=e(29413),C=e(94354),M=e(90182);function S({options:Pe,value:ge,onChange:xe}){const Ae=(0,r.of)(I),Ee=(0,r.$j)(),[Ie,Qe]=(0,x.useState)(0),[at,ft]=(0,x.useState)(0),ct=at>Ie,vt=(0,x.useRef)(null);return(0,P.w)({ref:vt,onResize:()=>{const Pt=vt.current;Pt&&ft(Pt.clientWidth)}}),(0,x.useEffect)(()=>{const{fontSize:Pt}=Ee.typography,Vt=Pe.map(zt=>zt.label||zt.value||"").join(" "),Jt=(0,E.kD)(Vt,Pt).width;Qe(Jt+32*Pe.length)},[Pe,Ee]),(0,t.jsx)("div",{ref:vt,children:ct?(0,t.jsx)(C.z,{options:Pe,value:ge,onChange:xe}):(0,t.jsx)(M.l6,{options:Pe,value:ge,onChange:Pt=>xe(Pt.value),className:Ae.select})})}function I(Pe){return{select:(0,n.css)({maxWidth:Pe.spacing(16)})}}var T=e(69096),b=e(40588),R=e(4200),A=e(51080);class L extends s.Bs{constructor(){super(...arguments),this.onClick=()=>{if(!(s.jh.lookupVariable("filters",this)instanceof s.H9))return;const xe=this.state.frame.fields[1]?.labels??{};if(Object.keys(xe).length!==1)return;const Ae=Object.keys(xe)[0];(0,b.z)("label_filter_changed",{label:Ae,action:"added",cause:"breakdown"});const Ee=(0,A.kj)(this),Ie={key:Ae,operator:"=",value:xe[Ae]};Ee.addFilterWithoutReportingInteraction(Ie)}}static{this.Component=({model:ge})=>{const Ae=ge.useState().frame.fields[1]?.labels||{};return Object.keys(Ae).length!==0?(0,t.jsx)(h.$n,{variant:"secondary",size:"sm",fill:"solid",onClick:ge.onClick,children:"Add to filters"}):null}}}var U=e(39070);function W(Pe,ge){const xe=s.jh.lookupVariable(R.Ao,Pe),Ae=[];if(!(xe instanceof s.H9))return[];const Ee=xe.state.filters;for(const Ie of ge.getOptionsForSelect()){const Qe=Ee.find(at=>at.key===Ie.value);Ie.label!=="le"&&(Qe||Ae.push({label:Ie.label,value:String(Ie.value)}))}return Ae}function w(Pe,ge){const xe=sceneGraph.findObject(Pe,Ae=>Ae instanceof ge);return xe instanceof ge?xe:null}function N(Pe,ge){function xe(Ee){return Ee instanceof ge}return s.jh.findAllObjects(Pe,xe).filter(xe)}class B extends s.Bs{constructor(ge){super(ge),this.addActivationHandler(()=>{const xe=s.jh.getData(this);this._subs.add(xe.subscribeToState((Ae,Ee)=>{if(Ae.data===void 0)return;const Ie=Ae.data;Ae.data!==void 0&&Ae.data?.state!==Ee.data?.state&&N(this,s.Zv).forEach(Qe=>{Qe.setState({data:{...Qe.state.data,state:Ie.state}})}),Ie.state===U.Gu.Done&&this.performRepeat(Ie)})),xe.state.data&&this.performRepeat(xe.state.data)})}performRepeat(ge){const xe=[];for(let Ae=0;Ae<ge.series.length;Ae++){const Ee=ge.series[Ae];if(Ee.length<=1)continue;const Ie=this.state.getLayoutChild(ge,Ee,Ae);xe.push(Ie)}this.state.body.setState({children:xe}),this.setState({body:this.state.body})}static{this.Component=({model:ge})=>{const{body:xe}=ge.useState(),{children:Ae}=xe.useState(),Qe=s.jh.getData(ge).useState()?.data,at=Qe?.state==="Loading"&&Ae.length===0,ft=Qe?.state===U.Gu.Error?"Failed to load data.":void 0,ct=!at&&Ae.length===0&&!ft?"There is no data available. Try adjusting your filters, time range, or selecting a different label.":void 0;return(0,t.jsx)(T.O,{blockingMessage:ct,error:ft,isLoading:at,children:(0,t.jsx)(xe.Component,{model:xe})})}}}class V extends s.Bs{constructor(){super(...arguments),this.onLayoutChange=ge=>{(0,b.z)("breakdown_layout_changed",{layout:ge}),localStorage.setItem(R.Pp,ge),this.getMetricScene().setState({layout:ge})}}getMetricScene(){return s.jh.getAncestor(this,$e)}Selector({model:ge}){const{options:xe}=ge.useState(),Ae=ge.useActiveLayout();return(0,t.jsx)(v.D,{label:"View",children:(0,t.jsx)(C.z,{options:xe,value:Ae,onChange:ge.onLayoutChange})})}useActiveLayout(){const{options:ge}=this.useState(),{layout:xe}=this.getMetricScene().useState();return ge.map(Ee=>Ee.value).includes(xe)?xe:ge[0].value}static{this.Component=({model:ge})=>{const{layouts:xe,options:Ae}=ge.useState(),Ee=ge.useActiveLayout(),Ie=Ae.findIndex(at=>at.value===Ee);if(Ie===-1)return null;const Qe=xe[Ie];return(0,t.jsx)(Qe.Component,{model:Qe})}}}var K=e(52622);const H=s.zd.timeseries().setOption("tooltip",{mode:K.$N.Multi,sort:K.xB.Descending}).setOption("legend",{showLegend:!1}).build();var X=e(65463);class k extends X.x{static{this.type="selected-metric-query-results-event"}}const Y=Pe=>{const ge=s.jh.getAncestor(Pe,se);N(Pe,s.Eb).forEach(Ee=>{Ee.isActive?xe(Ee.state.$data):Ee.addActivationHandler(()=>{xe(Ee.state.$data)})}),N(Pe,s.Eb).forEach(Ee=>xe(Ee.state.$data));function xe(Ee){Ee&&(Ee.isActive||Ee.addActivationHandler(()=>{xe(Ee)}),Ee.state.data&&ge.reportBreakdownPanelData(Ee.state.data),Ee.subscribeToState(({data:Ie},Qe)=>{ge.reportBreakdownPanelData(Ie)}))}const Ae=ge.subscribeToEvent(k,Ee=>{if(!Pe.isActive){Ae.unsubscribe();return}const Ie=s.No.timeseries().setCustomFieldConfig("axisSoftMin",Ee.payload.min).setCustomFieldConfig("axisSoftMax",Ee.payload.max).build();N(Pe,s.Eb).forEach(Qe=>{function at(){Qe.onFieldConfigChange(Ie)}Qe.isActive?at():Qe.addActivationHandler(at)})})},Z=60;class se extends s.Bs{constructor(ge){super({labels:ge.labels??[],...ge}),this._variableDependency=new s.Sh(this,{variableNames:[R.Ao],onReferencedVariableValueChanged:this.onReferencedVariableValueChanged.bind(this)}),this._triggerAxisChangedEvent=(0,y.throttle)(()=>{const{breakdownPanelMinValue:xe,breakdownPanelMaxValue:Ae}=this;xe!==void 0&&Ae!==void 0&&this.publishEvent(new k({min:xe,max:Ae}))},1e3),this.onChange=xe=>{if(!xe)return;(0,b.z)("label_selected",{label:xe,cause:"selector"}),this.getVariable().changeValueTo(xe)},this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){const ge=this.getVariable();ge.subscribeToState((Ie,Qe)=>{(Ie.options!==Qe.options||Ie.value!==Qe.value||Ie.loading!==Qe.loading)&&this.updateBody(ge)});const xe=s.jh.getAncestor(this,$e),Ae=xe.state.metric;this._query=(0,D.v)(Ae).breakdown,(0,A.kj)(this).state.$timeRange?.subscribeToState(()=>{this.clearBreakdownPanelAxisValues()}),xe.subscribeToState(({layout:Ie},Qe)=>{Ie!==Qe.layout&&this.clearBreakdownPanelAxisValues()}),this.updateBody(ge)}reportBreakdownPanelData(ge){if(!ge)return;let xe=this.breakdownPanelMinValue,Ae=this.breakdownPanelMaxValue;ge.series.forEach(Ee=>{Ee.fields.forEach(Ie=>{if(Ie.type!==d.PU.number)return;const Qe=Ie.values.filter(y.isNumber),at=(0,y.max)(Qe),ft=(0,y.min)(Qe);Ae=(0,y.max)([Ae,at].filter(y.isNumber)),xe=(0,y.min)([xe,ft].filter(y.isNumber))})}),!(Ae===void 0||xe===void 0||!Number.isFinite(Ae+xe))&&(this.breakdownPanelMaxValue===Ae&&this.breakdownPanelMinValue===xe||(this.breakdownPanelMaxValue=Ae,this.breakdownPanelMinValue=xe,this._triggerAxisChangedEvent()))}clearBreakdownPanelAxisValues(){this.breakdownPanelMaxValue=void 0,this.breakdownPanelMinValue=void 0}getVariable(){const ge=s.jh.lookupVariable(R.yr,this);if(!(ge instanceof s.fS))throw new Error("Group by variable not found");return ge}onReferencedVariableValueChanged(){const ge=this.getVariable();ge.changeValueTo(u.To),this.updateBody(ge)}updateBody(ge){const xe=W(this,ge),Ae={loading:ge.state.loading,value:String(ge.state.value),labels:xe,error:ge.state.error,blockingMessage:void 0};!ge.state.loading&&ge.state.options.length?Ae.body=ge.hasAllValue()?q(xe,this._query):oe(this._query):ge.state.loading||(Ae.body=void 0,Ae.blockingMessage="Unable to retrieve label options for currently selected metric."),this.clearBreakdownPanelAxisValues(),this.setState(Ae)}static{this.Component=({model:ge})=>{const{labels:xe,body:Ae,loading:Ee,value:Ie,blockingMessage:Qe}=ge.useState(),at=(0,r.of)(j);return(0,t.jsx)("div",{className:at.container,children:(0,t.jsxs)(T.O,{isLoading:Ee,blockingMessage:Qe,children:[(0,t.jsxs)("div",{className:at.controls,children:[!Ee&&xe.length&&(0,t.jsx)("div",{className:at.controlsLeft,children:(0,t.jsx)(v.D,{label:"By label",children:(0,t.jsx)(S,{options:xe,value:Ie,onChange:ge.onChange})})}),Ae instanceof V&&(0,t.jsx)("div",{className:at.controlsRight,children:(0,t.jsx)(Ae.Selector,{model:Ae})})]}),(0,t.jsx)("div",{className:at.content,children:Ae&&(0,t.jsx)(Ae.Component,{model:Ae})})]})})}}}function j(Pe){return{container:(0,n.css)({flexGrow:1,display:"flex",minHeight:"100%",flexDirection:"column"}),content:(0,n.css)({flexGrow:1,display:"flex",paddingTop:Pe.spacing(0)}),controls:(0,n.css)({flexGrow:0,display:"flex",alignItems:"top",gap:Pe.spacing(2)}),controlsRight:(0,n.css)({flexGrow:0,display:"flex",justifyContent:"flex-end"}),controlsLeft:(0,n.css)({display:"flex",justifyContent:"flex-left",justifyItems:"left",width:"100%",flexDirection:"column"})}}function q(Pe,ge){const xe=[];for(const Ae of Pe){if(Ae.value===u.To)continue;if(xe.length===Z)break;const Ee=ge.queries[0].expr.replaceAll(R.aZ,String(Ae.value)),Ie=ge.unit,Qe=s.d0.timeseries().setTitle(Ae.label).setData(new s.dt({maxDataPoints:250,datasource:R.GH,queries:[{refId:"A",expr:Ee,legendFormat:`{{${Ae.label}}}`}]})).setHeaderActions(new le({labelName:String(Ae.value)})).setUnit(Ie).setBehaviors([ae]).build();Qe.addActivationHandler(()=>{Qe.onOptionsChange(H)}),xe.push(new s.xK({$behaviors:[Y],body:Qe}))}return new V({options:[{value:"grid",label:"Grid"},{value:"rows",label:"Rows"}],layouts:[new s.gF({templateColumns:ne,autoRows:"200px",children:xe,isLazy:!0}),new s.gF({templateColumns:"1fr",autoRows:"200px",children:xe.map(Ae=>Ae.clone()),isLazy:!0})]})}const ne="repeat(auto-fit, minmax(400px, 1fr))";function oe(Pe){const ge=Pe.unit;function xe(Ae,Ee,Ie){const Qe=Pe.vizBuilder().setTitle(z(Ee)).setData(new s.Zv({data:{...Ae,series:[Ee]}})).setColor({mode:"fixed",fixedColor:(0,A.Vy)(Ie)}).setHeaderActions(new L({frame:Ee})).setUnit(ge).build(),at=Ee.length<=1,ft=new s.xK({$behaviors:[Y],body:Qe,isHidden:at});return Qe.addActivationHandler(()=>{Qe.onOptionsChange(H)}),ft}return new V({$data:new s.dt({datasource:R.GH,maxDataPoints:300,queries:Pe.queries}),options:[{value:"single",label:"Single"},{value:"grid",label:"Grid"},{value:"rows",label:"Rows"}],layouts:[new s.G1({direction:"column",children:[new s.vA({minHeight:300,body:s.d0.timeseries().setTitle("$metric").build()})]}),new B({body:new s.gF({templateColumns:ne,autoRows:"200px",children:[]}),getLayoutChild:xe}),new B({body:new s.gF({templateColumns:"1fr",autoRows:"200px",children:[]}),getLayoutChild:xe})]})}function z(Pe){const ge=Pe.fields[1]?.labels||{},xe=Object.keys(ge);return xe.length===0?"<unspecified>":ge[xe[0]]}function te(){return new se({})}class le extends s.Bs{constructor(){super(...arguments),this.onClick=()=>{const ge=this.state.labelName;(0,b.z)("label_selected",{label:ge,cause:"breakdown_panel"}),ie(this).onChange(ge)}}static{this.Component=({model:ge})=>(0,t.jsx)(h.$n,{variant:"secondary",size:"sm",fill:"solid",onClick:ge.onClick,children:"Select"})}}function ie(Pe){if(Pe instanceof se)return Pe;if(Pe.parent)return ie(Pe.parent);throw new Error("Unable to find breakdown scene")}function ae(Pe){Pe.state.$data?.subscribeToState((ge,xe)=>{const Ae=ge.data?.request?.targets[0];if(re(Ae)){const{legendFormat:Ee}=Ae,Ie=Ee.slice(2,-2);ge.data?.series.forEach(Qe=>{if(!Qe.fields[1].labels?.[Ie]){const at=Qe.fields[1].labels;at&&(at[Ie]=`<unspecified ${Ie}>`)}})}})}function re(Pe){return Pe!==void 0&&"legendFormat"in Pe&&typeof Pe.legendFormat=="string"}var ce=e(94753),me=e(72109),ee=e(8484),de=e(8620);class De extends s.Bs{constructor(ge){super({...ge}),this._variableDependency=new s.Sh(this,{variableNames:[R.gR],onReferencedVariableValueChanged:this.onReferencedVariableValueChanged.bind(this)}),this.addActivationHandler(this._onActivate.bind(this))}getVariable(){const ge=s.jh.lookupVariable(R.yr,this);if(!(ge instanceof s.fS))throw new Error("Group by variable not found");return ge}_onActivate(){this.updateMetadata()}onReferencedVariableValueChanged(){this.updateMetadata()}async updateMetadata(){this.setState({metadataLoading:!0,metadata:void 0});const xe=(0,A.aM)(this).state.metric,Ee=await(0,A.kj)(this).getMetricMetadata(xe);this.setState({metadata:Ee,metadataLoading:!1})}static{this.Component=({model:ge})=>{const{metadata:xe,metadataLoading:Ae}=ge.useState(),Ee=ge.getVariable(),{loading:Ie,options:Qe}=Ee.useState(),ft=(0,A.aM)(ge).state.metric;let ct=(0,de.vL)(ft)??"Unknown";return(0,t.jsx)(T.O,{isLoading:Ie||Ae,children:(0,t.jsx)(a.B,{gap:6,children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(a.B,{direction:"column",gap:.5,children:[(0,t.jsx)(ce.E,{weight:"medium",children:(0,t.jsx)(ee.x6,{children:"Description"})}),(0,t.jsx)("div",{style:{maxWidth:360},children:xe?.help?(0,t.jsx)("div",{children:xe?.help}):(0,t.jsx)("i",{children:(0,t.jsx)(ee.x6,{children:"No description available"})})})]}),(0,t.jsxs)(a.B,{direction:"column",gap:.5,children:[(0,t.jsx)(ce.E,{weight:"medium",children:(0,t.jsx)(ee.x6,{children:"Type"})}),xe?.type?(0,t.jsx)("div",{children:xe?.type}):(0,t.jsx)("i",{children:(0,t.jsx)(ee.x6,{children:"Unknown"})})]}),(0,t.jsxs)(a.B,{direction:"column",gap:.5,children:[(0,t.jsx)(ce.E,{weight:"medium",children:(0,t.jsx)(ee.x6,{children:"Unit"})}),xe?.unit?(0,t.jsx)("div",{children:xe?.unit}):(0,t.jsx)("i",{children:(0,t.jsx)(ee.x6,{children:ct})})]}),(0,t.jsxs)(a.B,{direction:"column",gap:.5,children:[(0,t.jsx)(ce.E,{weight:"medium",children:(0,t.jsx)(ee.x6,{children:"Labels"})}),Qe.length===0&&"Unable to fetch labels.",Qe.map(vt=>(0,t.jsx)(me.Y,{href:`#View breakdown for ${vt.label}`,title:`View breakdown for ${vt.label}`,onClick:Pt=>{Pt.preventDefault(),Pt.stopPropagation(),s.jh.getAncestor(ge,$e).setActionView("breakdown");const Vt=s.jh.lookupVariable(R.yr,ge);return Vt instanceof s.fS&&vt.label!=null&&((0,b.z)("label_selected",{label:vt.label,cause:"overview_link"}),Vt.setState({value:vt.value})),!1},children:vt.label},vt.label))]})]})})})}}}function fe(){return new De({})}var Te=e(21028);function je(){return new Te.t({})}const He=["single","grid","rows"];function Be(Pe){return!!Pe&&Pe in He}var Ne=e(94624);class Re extends s.Bs{constructor(ge){super(ge),this.onChangeQuery=xe=>{const Ae=(0,A.aM)(this),Ee=Ae.state.autoQuery.variants.find(Ie=>Ie.variant===xe);this.setState({panel:this.getVizPanelFor(Ee)}),Ae.setState({queryDef:Ee})},this.addActivationHandler(this.onActivate.bind(this))}onActivate(){if(!this.state.panel){const{autoQuery:ge}=(0,A.aM)(this).state;this.setState({panel:this.getVizPanelFor(ge.main)})}}getQuerySelector(ge){const{autoQuery:xe}=(0,A.aM)(this).state;if(xe.variants.length===0)return;const Ae=xe.variants.map(Ee=>({label:Ee.variant,value:Ee.variant}));return(0,t.jsx)(C.z,{size:"sm",options:Ae,value:ge.variant,onChange:this.onChangeQuery})}getVizPanelFor(ge){return ge.vizBuilder().setData(new s.dt({datasource:R.GH,maxDataPoints:500,queries:ge.queries})).setHeaderActions(this.getQuerySelector(ge)).build()}static{this.Component=({model:ge})=>{const{panel:xe}=ge.useState();if(xe)return(0,t.jsx)(xe.Component,{model:xe})}}}const Se=280,We="40%";class Ke extends s.Bs{constructor(ge){super({topView:ge.topView??Je(),...ge})}static{this.Component=({model:ge})=>{const{topView:xe,selectedTab:Ae}=ge.useState(),{stickyMainGraph:Ee}=(0,A.KE)(ge).useState(),Ie=(0,r.of)(Xe);return(0,t.jsxs)("div",{className:Ie.container,children:[(0,t.jsx)("div",{className:Ee?Ie.sticky:Ie.nonSticky,children:(0,t.jsx)(xe.Component,{model:xe})}),Ae&&(0,t.jsx)(Ae.Component,{model:Ae})]})}}}function Xe(Pe){return{container:(0,n.css)({display:"flex",flexDirection:"column",position:"relative"}),sticky:(0,n.css)({display:"flex",flexDirection:"row",background:Pe.isLight?Pe.colors.background.primary:Pe.colors.background.canvas,position:"sticky",top:"70px",zIndex:10}),nonSticky:(0,n.css)({display:"flex",flexDirection:"row"})}}function Je(){return new s.G1({direction:"column",$behaviors:[new s.Gg.K2({key:"metricCrosshairSync",sync:Ne.y.Crosshair})],children:[new s.vA({minHeight:Se,maxHeight:We,body:new Re({})}),new s.vA({ySizing:"content",body:new be({})})]})}const st=({trail:Pe})=>{const[ge,xe]=(0,x.useState)("Copy url"),Ae=()=>{if(navigator.clipboard){(0,b.z)("selected_metric_action_clicked",{action:"share_url"});const Ie=(i.$.appUrl.endsWith("/")?i.$.appUrl.slice(0,-1):i.$.appUrl)+(0,A.xi)(Pe);navigator.clipboard.writeText(Ie),xe("Copied!"),setTimeout(()=>{xe("Copy url")},2e3)}};return(0,t.jsx)(c.I,{variant:"canvas",icon:"share-alt",tooltip:ge,onClick:Ae})};var pt=e(13054),xt=e(74764);function ot(Pe){const ge=()=>(0,xt._r)().getBookmarkIndex(Pe),xe=ge(),[Ae,Ee]=(0,x.useState)(xe);(0,x.useEffect)(()=>{const ft=Pe.subscribeToEvent(s.bZ,({payload:{prevState:ct,newState:vt}})=>{(0,pt.h)(ct)&&(0,pt.h)(vt)&&vt.steps.length>ct.steps.length&&Ee((0,xt._r)().getBookmarkIndex(Pe))});return()=>ft.unsubscribe()},[Pe]),xe!==Ae&&Ee(xe);const Ie=Ae!=null;return[Ie,()=>{if((0,b.z)("bookmark_changed",{action:Ie?"toggled_off":"toggled_on"}),Ie){let ft=ge();for(;ft!=null;)(0,xt._r)().removeBookmark(ft),ft=ge()}else(0,xt._r)().addBookmark(Pe);Ee(ge())}]}class $e extends s.Bs{constructor(ge){const xe=ge.autoQuery??(0,D.v)(ge.metric),Ae=localStorage.getItem(R.Pp);super({$variables:ge.$variables??ye(ge.metric),body:ge.body??new Ke({}),autoQuery:xe,queryDef:ge.queryDef??xe.main,layout:Be(Ae)?Ae:"grid",...ge}),this._urlSync=new s.So(this,{keys:["actionView","layout"]}),this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){this.state.actionView===void 0&&this.setActionView("overview")}getUrlState(){return{actionView:this.state.actionView,layout:this.state.layout}}updateFromUrl(ge){if(typeof ge.actionView=="string"){if(this.state.actionView!==ge.actionView){const xe=ve.find(Ae=>Ae.value===ge.actionView);xe&&this.setActionView(xe.value)}}else ge.actionView===null&&this.setActionView(void 0);if(typeof ge.layout=="string"){const xe=ge.layout;this.state.layout!==xe&&this.setState({layout:xe})}}setActionView(ge){const{body:xe}=this.state,Ae=ve.find(Ee=>Ee.value===ge);Ae&&Ae.value!==this.state.actionView?(xe.state.topView.state.children[0].setState({maxHeight:Se}),xe.setState({selectedTab:Ae.getScene()}),this.setState({actionView:Ae.value})):(xe.state.topView.state.children[0].setState({maxHeight:We}),xe.setState({selectedTab:void 0}),this.setState({actionView:void 0}))}static{this.Component=({model:ge})=>{const{body:xe}=ge.useState();return(0,t.jsx)(xe.Component,{model:xe})}}}const ve=[{displayName:"Overview",value:"overview",getScene:fe},{displayName:"Breakdown",value:"breakdown",getScene:te},{displayName:"Related metrics",value:"related",getScene:je,description:"Relevant metrics based on current label filters"}];class be extends s.Bs{constructor(){super(...arguments),this.getLinkToExplore=async()=>{const ge=s.jh.getAncestor(this,$e),xe=(0,A.kj)(this),Ae=(0,A.U4)(xe),Ee=ge.state.queryDef?.queries||[],Ie=s.jh.getTimeRange(this);return(0,m.Xe)({queries:Ee,dsRef:{uid:Ae},timeRange:Ie.state.value,scopedVars:{__sceneObject:{value:ge}}})},this.openExploreLink=async()=>{(0,b.z)("selected_metric_action_clicked",{action:"open_in_explore"}),this.getLinkToExplore().then(ge=>{const xe=`${i.$.appSubUrl}${ge}`;window.open(xe,"_blank")})}}static{this.Component=({model:ge})=>{const xe=s.jh.getAncestor(ge,$e),Ae=(0,r.of)(he),Ee=(0,A.kj)(ge),[Ie,Qe]=ot(Ee),{actionView:at}=xe.useState();return(0,t.jsxs)(f.a,{paddingY:1,children:[(0,t.jsx)("div",{className:Ae.actions,children:(0,t.jsxs)(a.B,{gap:1,children:[(0,t.jsx)(c.I,{variant:"canvas",tooltip:"Remove existing metric and choose a new metric",onClick:()=>{(0,b.z)("selected_metric_action_clicked",{action:"unselect"}),Ee.publishEvent(new R.OO(void 0))},children:"Select new metric"}),(0,t.jsx)(c.I,{variant:"canvas",icon:"compass",tooltip:"Open in explore",onClick:ge.openExploreLink}),(0,t.jsx)(st,{trail:Ee}),(0,t.jsx)(c.I,{variant:"canvas",icon:Ie?(0,t.jsx)(o.I,{name:"favorite",type:"mono",size:"lg"}):(0,t.jsx)(o.I,{name:"star",type:"default",size:"lg"}),tooltip:"Bookmark",onClick:Qe}),Ee.state.embedded&&(0,t.jsx)(h.z9,{href:(0,A.xi)(Ee),variant:"secondary",onClick:()=>(0,b.z)("selected_metric_action_clicked",{action:"open_from_embedded"}),children:"Open"})]})}),(0,t.jsx)(g.U,{children:ve.map((ft,ct)=>{const vt=(0,t.jsx)(l.o,{label:ft.displayName,active:at===ft.value,onChangeTab:()=>{(0,b.z)("metric_action_view_changed",{view:ft.value}),xe.setActionView(ft.value)}},ct);return ft.description?(0,t.jsx)(p.m,{content:ft.description,placement:"bottom-start",theme:"info",children:vt},ct):vt})})]})}}}function he(Pe){return{actions:(0,n.css)({[Pe.breakpoints.up(Pe.breakpoints.values.md)]:{position:"absolute",right:0,top:16,zIndex:2}})}}function ye(Pe){return new s.Pj({variables:[...(0,R.ym)(Pe),new s.fS({name:R.yr,label:"Group by",datasource:R.GH,includeAll:!0,defaultToAll:!0,query:{query:`label_names(${R.Rp})`,refId:"A"},value:"",text:""})]})}},21028:(G,O,e)=>{"use strict";e.d(O,{t:()=>te});var t=e(74848),n=e(32196),i=e(2543),s=e(96540),r=e(17172),f=e(80943),a=e(40845),c=e(56034),o=e(14578),h=e(88575),g=e(10354),l=e(29158),p=e(90182),m=e(15292),y=e(42418),d=e(8484),v=e(94383),u=e(69096);class D{constructor(){this.config={minGroupSize:3,idealMaxGroupSize:30,maxDepth:100}}parse(ce){if(this.config.maxDepth<=0)throw new Error("Max depth must be greater than 0");if(this.config.minGroupSize<1)throw new Error("Min group size must be greater than 0");if(this.config.idealMaxGroupSize<this.config.minGroupSize)throw new Error("Max group size must be greater than min group size");if(this.config.miscGroupKey&&this.config.miscGroupKey==="")throw new Error("miscGroupKey cannot be empty");return{root:this.parseStrings(ce,0)}}parseStrings(ce,me){const ee={groups:new Map,values:[],descendants:0};for(const De of ce){if(De.trim()==="")continue;const fe=P(De,me);let Te=ee.groups.get(fe);Te||(Te={groups:new Map,values:[],descendants:0},ee.groups.set(fe,Te)),Te.values.push(De),Te.descendants++}const de=[];for(let[De,fe]of ee.groups.entries())fe.values.length<this.config.minGroupSize?(this.config.miscGroupKey?de.push(...fe.values):ee.values.push(...fe.values),ee.descendants+=fe.values.length,ee.groups.delete(De)):(fe.values.length>this.config.idealMaxGroupSize&&me<this.config.maxDepth-1&&(fe=this.parseStrings(fe.values,me+1),ee.groups.set(De,fe)),ee.descendants+=fe.descendants);if(this.config.miscGroupKey&&de.length>0){const De={groups:new Map,values:de,descendants:de.length};ee.groups.set(this.config.miscGroupKey,De)}return ee}}function P(re,ce){let me=0;for(let ee=0;ee<re.length;ee++){const de=re.charCodeAt(ee);if(!(de>=48&&de<=57||de>=65&&de<=90||de>=97&&de<=122||de>=192&&de<=214||de>=216&&de<=246||de>=248&&de<=255||de>=256&&de<=383)&&(me++,me>ce))return re.slice(0,ee)}return re}var x=e(88434),E=e(40588),C=e(4200),M=e(51080),S=e(55852);class I extends f.Bs{constructor(){super(...arguments),this.onClick=()=>{this.publishEvent(new C.OO(this.state.metric),!0)}}static{this.Component=({model:ce})=>{const{title:me}=ce.useState();return(0,t.jsx)(S.$n,{variant:"secondary",size:"sm",fill:"solid",onClick:ce.onClick,children:me})}}}var T=e(81996);const b="results truncated due to limit";async function R(re,ce,me,ee){const de=`/api/datasources/uid/${re}/resources/api/v1/label/__name__/values`,De={start:(0,T.mv)(ce.from,!1),end:(0,T.mv)(ce.to,!0),...me&&me!=="{}"?{"match[]":me}:{},...ee?{limit:ee}:{}},fe=await(0,r.AI)().get(de,De,"explore-metrics-names");return ee&&fe.warnings?.includes(b)?{...fe,limitReached:!0}:{...fe,limitReached:!1}}var A=e(29352),L=e(39070),U=e(11261);function W(re){return ce=>{const me=f.jh.getData(ce);me&&me.subscribeToState(ee=>{if(ee.data?.state===L.Gu.Loading||ee.data?.state===L.Gu.Error)return;const de=f.jh.getAncestor(ce,te);if(!ee.data?.series.length){de.updateMetricPanel(re,!0,!0);return}let De=!1;for(const fe of ee.data.series){for(const Te of fe.fields)if(Te.type===U.PU.number&&(De=Te.values.some(je=>je!=null&&!isNaN(je)&&je!==0),De))break;if(De)break}de.updateMetricPanel(re,!0,!De)})}}function w(re,ce,me,ee){const de=(0,A.v)(re),De=de.preview.vizBuilder().setColor({mode:"fixed",fixedColor:(0,M.Vy)(ce)}).setDescription(ee).setHeaderActions(new I({metric:re,title:"Select"})).build(),fe=de.preview.queries.map(Te=>N(Te,me));return new f.xK({$variables:new f.Pj({variables:(0,C.ym)(re)}),$behaviors:[W(re)],$data:new f.dt({datasource:C.GH,maxDataPoints:200,queries:fe}),body:De})}function N(re,ce){const me=ce>0?'${filters},__ignore_usage__=""':'__ignore_usage__=""',ee=re.expr?.replace("${filters}",me);return{...re,expr:ee}}var B=e(51088);function V(re,ce){return re.sort((me,ee)=>{const de=H(me,ce),De=H(ee,ce);return de.halfLeven+de.wholeLeven-(De.halfLeven+De.wholeLeven)})}const K=new Map;function H(re,ce){let me=K.get(re);me||(me=new Map,K.set(re,me));let ee=me.get(ce);if(!ee){const de=re.split("_"),De=de.slice(0,de.length/2).join("_"),fe=(0,B.A)(De,ce)||0,Te=(0,B.A)(re,ce)||0;ee={halfLeven:fe,wholeLeven:Te},me.set(ce,ee)}return ee}const X=/[^a-z0-9_:]+/;function k(re){return re?.toLowerCase().split(X).filter(ce=>ce.length>0)||[]}function Y(re){const ce=k(re).map(ee=>`(?=(.*${ee.toLowerCase()}.*))`);if(ce.length===0)return null;const me=ce.join("");return new RegExp(me,"igy")}function Z(re){const ce=se(k(re)).filter(de=>de.length>0).map(de=>`(.*${de.toLowerCase()}.*)`),me=ce.length;return ce.length===0?null:`(?i:${ce.join("|")}){${me}}`}function se(re=[]){const ce=new Set(re.map(me=>me.toLowerCase().trim()));return Array.from(ce)}const j="175px",q="64px",ne="all",oe=2e4,z="View by the metric prefix. A metric prefix is a single word at the beginning of the metric name, relevant to the domain the metric belongs to.";class te extends f.Bs{constructor(ce){super({showPreviews:!0,$variables:ce.$variables,metricPrefix:ce.metricPrefix??ne,body:ce.body??new f.gF({children:[],templateColumns:"repeat(auto-fill, minmax(450px, 1fr))",autoRows:j,isLazy:!0}),...ce}),this.previewCache={},this.ignoreNextUpdate=!1,this._debounceRefreshMetricNames=(0,i.debounce)(()=>this._refreshMetricNames(),1e3),this._urlSync=new f.So(this,{keys:["metricPrefix"]}),this._variableDependency=new f.Sh(this,{variableNames:[C.EY,C.Ao],onReferencedVariableValueChanged:me=>{this._debounceRefreshMetricNames()}}),this.updateMetricPanel=(me,ee,de)=>{const De=this.previewCache[me];De&&(De.isEmpty=de,De.loaded=ee,this.previewCache[me]=De,this.state.metricPrefix==="All"&&this.buildLayout())},this.onSearchQueryChange=me=>{const ee=me.currentTarget.value;(0,M.kj)(this).setState({metricSearch:ee})},this.onPrefixFilterChange=me=>{this.setState({metricPrefix:me.value}),this.buildLayout()},this.reportPrefixFilterInteraction=me=>{const ee=(0,M.kj)(this),{steps:de,currentStep:De}=ee.state.history.state,Te=de[De]?.trailState.metric!==void 0;(0,E.z)("prefix_filter_clicked",{from:Te?"related_metrics":"metric_list",action:me?"open":"close"})},this.onTogglePreviews=()=>{this.setState({showPreviews:!this.state.showPreviews}),this.buildLayout()},this.addActivationHandler(this._onActivate.bind(this))}getUrlState(){return{metricPrefix:this.state.metricPrefix}}updateFromUrl(ce){typeof ce.metricPrefix=="string"&&this.state.metricPrefix!==ce.metricPrefix&&this.setState({metricPrefix:ce.metricPrefix})}_onActivate(){this.state.body.state.children.length===0?this.buildLayout():this.ignoreNextUpdate=!0;const ce=(0,M.kj)(this);this._subs.add(ce.subscribeToEvent(C.OO,me=>{const{steps:ee,currentStep:de}=ce.state.history.state,De=ee[de].parentIndex,Te=ee[De].trailState.metric!==void 0;if(me.payload!==void 0){const je=ae(ce),He=k(je).length;(0,E.z)("metric_selected",{from:Te?"related_metrics":"metric_list",searchTermCount:He})}})),this._subs.add(ce.subscribeToEvent(f.bZ,me=>{if(me.payload.changedObject instanceof f.JZ){const{prevState:ee,newState:de}=me.payload;if((0,M.iG)(ee)&&(0,M.iG)(de)&&ee.from===de.from&&ee.to===de.to)return}})),this._subs.add(ce.subscribeToState(({metricSearch:me},ee)=>{const de=k(ee.metricSearch),De=k(me);(0,i.isEqual)(de,De)||this._debounceRefreshMetricNames()})),this.subscribeToState((me,ee)=>{me.metricNames!==ee.metricNames&&this.onMetricNamesChanged()}),this._debounceRefreshMetricNames()}async _refreshMetricNames(){const ce=(0,M.kj)(this),me=ce.state.$timeRange?.state;if(!me)return;const ee=[],de=f.jh.lookupVariable(C.Ao,this);de instanceof f.H9&&de.getValue()?.valueOf()&&ee.push(f.jh.interpolate(ce,"${filters}"));const fe=Z(ce.state.metricSearch);fe&&ee.push(`__name__=~"${fe}"`);const Te=`{${ee.join(",")}}`,je=f.jh.interpolate(ce,C.gR);this.setState({metricNamesLoading:!0,metricNamesError:void 0,metricNamesWarning:void 0});try{const He=await R(je,me,Te,oe),Be=Y(ae(this)),Ne=Be?He.data.filter(Ke=>!Be||Be.test(Ke)):He.data,Re=He.limitReached?`This feature will only return up to ${oe} metric names for performance reasons. This limit is being exceeded for the current data source. Add search terms or label filters to narrow down the number of metric names returned.`:void 0;let Se=this.state.body;const We=await this.generateGroups(Ne);this.setState({metricNames:Ne,rootGroup:We,body:Se,metricNamesLoading:!1,metricNamesWarning:Re,metricNamesError:He.error})}catch(He){let Be="Unknown error";(0,r.NF)(He)&&(He.cancelled?Be="Request cancelled":He.statusText&&(Be=He.statusText)),this.setState({metricNames:void 0,metricNamesLoading:!1,metricNamesError:Be})}}async generateGroups(ce=[]){const me=new D;me.config={...me.config,maxDepth:2,minGroupSize:2,miscGroupKey:"misc"};const{root:ee}=me.parse(ce);return ee}onMetricNamesChanged(){const ce=this.state.metricNames||[],me=new Set(ce);Object.values(this.previewCache).forEach(Te=>{me.has(Te.name)||(Te.isEmpty=!0)});const ee=(0,M.kj)(this),de=ee.state.metric!==void 0?V(ce,ee.state.metric):ce,De={},fe=120;Object.keys(this.previewCache).forEach(Te=>{me.has(Te)||delete this.previewCache[Te]});for(let Te=0;Te<de.length;Te++){const je=de[Te];if(Object.keys(De).length>fe)break;const Be=this.previewCache[je]||{name:je,index:Te,loaded:!1};De[je]=Be}try{const Te=f.jh.getAncestor(this,v.R).state.metric;delete De[Te]}catch{}this.previewCache=De,this.buildLayout()}async buildLayout(){if(this.ignoreNextUpdate){this.ignoreNextUpdate=!1;return}if(!this.state.rootGroup){const ee=await this.generateGroups(this.state.metricNames);this.setState({rootGroup:ee})}const ce=await this.populateFilterableViewLayout(),me=this.state.showPreviews?j:q;this.state.body.setState({children:ce,autoRows:me})}async populateFilterableViewLayout(){const ce=(0,M.kj)(this),me=(0,M.gA)(this);let ee=this.state.rootGroup;ee||(ee=await this.generateGroups(this.state.metricNames),this.setState({rootGroup:ee}));const de=[];for(const[De,fe]of ee.groups){if(this.state.metricPrefix!==ne&&this.state.metricPrefix!==De)continue;for(const[je,He]of fe.groups){const Be=await this.populatePanels(ce,me,He.values);de.push(...Be)}const Te=await this.populatePanels(ce,me,fe.values);de.push(...Te)}return de}async populatePanels(ce,me,ee){const de=me?.length||0,De=[];for(let fe=0;fe<ee.length;fe++){const Te=ee[fe],je=this.previewCache[Te]??{name:Te,index:fe,loaded:!1},He=await ce.getMetricMetadata(Te),Be=(0,x.R)(He);if(this.state.showPreviews){if(je.itemRef&&je.isPanel){De.push(je.itemRef.resolve());continue}const Ne=w(je.name,fe,de,Be);je.itemRef=Ne.getRef(),je.isPanel=!0,De.push(Ne)}else{const Ne=new f.xK({$variables:new f.Pj({variables:(0,C.ym)(je.name)}),body:le(je.name,Be)});je.itemRef=Ne.getRef(),je.isPanel=!1,De.push(Ne)}}return De}static{this.Component=({model:ce})=>{const{showPreviews:me,body:ee,metricNames:de,metricNamesError:De,metricNamesLoading:fe,metricNamesWarning:Te,rootGroup:je,metricPrefix:He}=ce.useState(),{children:Be}=ee.useState(),Ne=(0,M.kj)(ce),Re=(0,a.of)(ie),[Se,We]=(0,s.useReducer)(()=>!0,!1),{metricSearch:Ke}=Ne.useState(),Xe=Be.length===0&&Ke,Je=!fe&&de&&de.length===0,st=fe&&Be.length===0,pt=st?void 0:Je&&"There are no results found. Try a different time range or a different data source."||Xe&&"There are no results found. Try adjusting your search or filters."||void 0,xt=Te?(0,t.jsx)(c.m,{content:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h4",{children:"Unable to retrieve metric names"}),(0,t.jsx)("p",{children:Te})]}),children:(0,t.jsx)(o.I,{className:Re.warningIcon,name:"exclamation-triangle"})}):void 0;return(0,t.jsxs)("div",{className:Re.container,children:[(0,t.jsxs)("div",{className:Re.header,children:[(0,t.jsx)(h.D,{label:"Search metrics",className:Re.searchField,children:(0,t.jsx)(g.p,{placeholder:"Search metrics",prefix:(0,t.jsx)(o.I,{name:"search"}),value:Ke,onChange:ce.onSearchQueryChange,suffix:xt})}),(0,t.jsx)(h.D,{label:(0,t.jsxs)("div",{className:Re.displayOptionTooltip,children:[(0,t.jsx)(d.x6,{i18nKey:"explore-metrics.viewBy",children:"View by"}),(0,t.jsx)(l.K,{name:"info-circle",size:"sm",variant:"secondary",tooltip:z})]}),className:Re.displayOption,children:(0,t.jsx)(p.l6,{value:He,onChange:ce.onPrefixFilterChange,onOpenMenu:()=>ce.reportPrefixFilterInteraction(!0),onCloseMenu:()=>ce.reportPrefixFilterInteraction(!1),options:[{label:"All metric names",value:ne},...Array.from(je?.groups.keys()??[]).map(ot=>({label:`${ot}_`,value:ot}))]})}),(0,t.jsx)(m.K,{showLabel:!0,label:"Show previews",value:me,onChange:ce.onTogglePreviews})]}),De&&(0,t.jsxs)(y.F,{title:"Unable to retrieve metric names",severity:"error",children:[(0,t.jsx)("div",{children:"We are unable to connect to your data source. Double check your data source URL and credentials."}),(0,t.jsxs)("div",{children:["(",De,")"]})]}),Te&&!Se&&(0,t.jsx)(y.F,{title:"Unable to retrieve all metric names",severity:"warning",onSubmit:We,onRemove:We,children:(0,t.jsx)("div",{children:Te})}),(0,t.jsxs)(u.O,{isLoading:st,blockingMessage:pt,children:[ee instanceof f.G1&&(0,t.jsx)(ee.Component,{model:ee}),ee instanceof f.gF&&(0,t.jsx)(ee.Component,{model:ee})]})]})}}}function le(re,ce){return f.d0.text().setTitle(re).setDescription(ce).setHeaderActions(new I({metric:re,title:"Select"})).setOption("content","").build()}function ie(re){return{container:(0,n.css)({display:"flex",flexDirection:"column"}),headingWrapper:(0,n.css)({marginBottom:re.spacing(.5)}),header:(0,n.css)({flexGrow:0,display:"flex",gap:re.spacing(2),marginBottom:re.spacing(2),alignItems:"flex-end"}),searchField:(0,n.css)({flexGrow:1,marginBottom:0}),metricTabGroup:(0,n.css)({marginBottom:re.spacing(2)}),displayOption:(0,n.css)({flexGrow:0,marginBottom:0,minWidth:"184px"}),displayOptionTooltip:(0,n.css)({display:"flex",gap:re.spacing(1)}),warningIcon:(0,n.css)({color:re.colors.warning.main})}}function ae(re){return(0,M.kj)(re).state.metricSearch||""}},90623:(G,O,e)=>{"use strict";e.d(O,{p:()=>s});var t=e(74848),n=e(67061),i=e(94753);const s=()=>(0,t.jsxs)(n.B,{direction:"column",gap:1,children:[(0,t.jsx)(i.E,{variant:"h1",children:"Metrics"}),(0,t.jsx)(i.E,{color:"secondary",children:"Explore your Prometheus-compatible metrics without writing a query"})]})},69096:(G,O,e)=>{"use strict";e.d(O,{O:()=>r});var t=e(74848),n=e(32196),i=e(40845),s=e(39558);function r({blockingMessage:a,isLoading:c,children:o}){const h=(0,i.of)(f);return c&&!a&&(a="Loading..."),c?(0,t.jsx)(s._,{className:h.statusMessage,text:a}):a?(0,t.jsx)("div",{className:h.statusMessage,children:a}):o}function f(a){return{statusMessage:(0,n.css)({fontStyle:"italic",marginTop:a.spacing(7),textAlign:"center",width:"100%"})}}},74764:(G,O,e)=>{"use strict";e.d(O,{yn:()=>u,_r:()=>P});var t=e(2543),n=e(76885),i=e(80943),s=e(99140),r=e(16001),f=e(56833),a=e(4200),c=e(51080),o=e(74848),h=e(67061),g=e(55852),l=e(3169);function p(){const E=(0,l.tZ)("Bookmark created");return E.component=(0,o.jsxs)(h.B,{gap:2,direction:"row",children:[(0,o.jsxs)("div",{children:["You can view bookmarks under ",(0,o.jsx)("i",{children:"Explore > Metrics"})]}),(0,o.jsx)(g.z9,{fill:"solid",variant:"secondary",href:a.QX,children:"View bookmarks"})]}),E}const m=20;class y{constructor(){this._recent=[],this._bookmarks=[],this._bookmarkIndexMap=new Map,this.load();const C=()=>{const M=this._recent.slice(0,m).map(S=>this._serializeTrail(S.resolve()));localStorage.setItem(a.sQ,JSON.stringify(M)),localStorage.setItem(a.jT,JSON.stringify(this._bookmarks))};this._save=(0,t.debounce)(C,1e3),window.addEventListener("beforeunload",M=>{this._save=C})}_loadRecentTrailsFromStorage(){const C=[],M=localStorage.getItem(a.sQ);if(M){const S=JSON.parse(M);for(const I of S){const T=this._deserializeTrail(I);C.push(T.getRef())}}return C}_loadBookmarksFromStorage(){const C=localStorage.getItem(a.jT);return(C?JSON.parse(C):[]).map(S=>{if(x(S)){const I=S.currentStep!=null?S.currentStep:S.history.length-1;return{urlValues:S.history[I].urlValues,createdAt:S.createdAt||Date.now()}}return S})}_deserializeTrail(C){const M=new f.b({createdAt:C.createdAt});C.history.map(I=>{this._loadFromUrl(M,I.urlValues);const T=I.parentIndex??M.state.history.state.steps.length-1;M.state.history.setState({currentStep:T}),M.state.history.addTrailStep(M,I.type)});const S=C.currentStep??M.state.history.state.steps.length-1;return M.state.history.setState({currentStep:S}),M.setState(i.Go.cloneSceneObjectState(M.state.history.state.steps[S].trailState,{history:M.state.history})),M}_serializeTrail(C){return{history:C.state.history.state.steps.map(S=>{const I=new f.b(i.Go.cloneSceneObjectState(S.trailState));return{urlValues:(0,i.Is)().getUrlState(I),type:S.type,description:S.description,parentIndex:S.parentIndex}}),currentStep:C.state.history.state.currentStep,createdAt:C.state.createdAt}}getTrailForBookmarkIndex(C){const M=this._bookmarks[C];return M?this.getTrailForBookmark(M):(0,c.ef)()}getTrailForBookmark(C){const M=u(C);for(const I of this._recent){const T=I.resolve();if(u(T)===M)return T}const S=new f.b({});return this._loadFromUrl(S,C.urlValues),S}_loadFromUrl(C,M){const S=n.kM.renderUrl("",M);i.Go.syncStateFromSearchParams(C,new URLSearchParams(S))}get recent(){return this._recent}load(){this._recent=this._loadRecentTrailsFromStorage(),this._bookmarks=this._loadBookmarksFromStorage(),this._refreshBookmarkIndexMap()}setRecentTrail(C){const{steps:M}=C.state.history.state;if(M.length===0||M.length===1&&M[0].type==="start")return;this._recent=this._recent.filter(I=>I!==C.getRef());const S=d(C);this._recent=this._recent.filter(I=>{const T=d(I.resolve());return!(0,t.isEqual)(S,T)}),this._recent.unshift(C.getRef()),this._save()}get bookmarks(){return this._bookmarks}addBookmark(C){const S={urlValues:(0,i.Is)().getUrlState(C),createdAt:Date.now()};this._bookmarks.unshift(S),this._refreshBookmarkIndexMap(),this._save(),(0,s.JD)((0,r.dx)(p()))}removeBookmark(C){C<this._bookmarks.length&&(this._bookmarks.splice(C,1),this._refreshBookmarkIndexMap(),this._save())}getBookmarkIndex(C){const M=u(C);return this._bookmarkIndexMap.get(M)}_refreshBookmarkIndexMap(){this._bookmarkIndexMap.clear(),this._bookmarks.forEach((C,M)=>{const S=u(C);this._bookmarkIndexMap.set(S,M)})}}function d(E){const C=(0,i.Is)().getUrlState(E);return v(C),C}function v(E){return delete E.actionView,delete E.layout,delete E.metricSearch,delete E.refresh,(E["var-groupby"]===""||E["var-groupby"]===void 0)&&(E["var-groupby"]="$__all"),typeof E["var-filters"]!="string"&&(E["var-filters"]=E["var-filters"]?.filter(C=>C!=="")),E}function u(E){return E instanceof f.b?JSON.stringify(d(E)):JSON.stringify(v({...E.urlValues}))}let D;function P(){return D||(D=new y),D}function x(E){return E!=null&&typeof E=="object"&&"history"in E}},88434:(G,O,e)=>{"use strict";e.d(O,{R:()=>r,q:()=>s});var t=e(50556),n=e(19347),i=e(4200);class s{constructor(a){this._trail=a}reset(){this._datasource=void 0,this._metricsMetadata=void 0}async getDatasource(){return this._datasource||(this._datasource=(0,n.l)().get(i.gR,{__sceneObject:{value:this._trail}})),await this._datasource}async _getMetricsMetadata(){const a=await this.getDatasource();if(a.languageProvider instanceof t.Ay)return a.languageProvider.metricsMetadata||await a.languageProvider.loadMetricsMetadata(),a.languageProvider.metricsMetadata}async getMetricMetadata(a){return a?(this._metricsMetadata||(this._metricsMetadata=this._getMetricsMetadata()),(await this._metricsMetadata)?.[a]):void 0}}function r(f){if(!f)return;const{type:a,help:c,unit:o}=f;return[c,a&&`**Type:** *${a}*`,o&&`**Unit:** ${o}`].join(`

`)}},40588:(G,O,e)=>{"use strict";e.d(O,{h:()=>s,z:()=>i});var t=e(14110);const n="grafana_explore_metrics_";function i(r,f){(0,t.rR)(`${n}${r}`,f)}function s(r,f){if(r.length===f.length)for(const a of f)for(const c of r)a.key===c.key&&a.value!==c.value&&i("label_filter_changed",{label:a.key,action:"changed",cause:"adhoc_filter"});else if(r.length<f.length)for(const a of f){let c=!1;for(const o of r)if(a.key===o.key){c=!0;break}c||i("label_filter_changed",{label:a.key,action:"removed",cause:"adhoc_filter"})}else for(const a of r){let c=!1;for(const o of f)if(o.key===a.key){c=!0;break}c||i("label_filter_changed",{label:a.key,action:"added",cause:"adhoc_filter"})}}},4200:(G,O,e)=>{"use strict";e.d(O,{Ao:()=>f,EY:()=>l,GH:()=>u,OO:()=>C,Pp:()=>x,QX:()=>r,Rp:()=>o,aZ:()=>g,gR:()=>p,jT:()=>P,km:()=>s,sQ:()=>D,td:()=>d,ui:()=>a,ym:()=>E,yr:()=>h});var t=e(65463),n=e(80943),i=e(79422);const s="/explore/metrics/trail",r="/explore/metrics",f="filters",a="{${filters}}",c="metric",o="${metric}",h="groupby",g="${groupby}",l="ds",p="${ds}",m="logsDs",y="${logsDs}",d="$__logs__",v="sqr-metric-viz-query",u={uid:p},D="grafana.trails.recent",P="grafana.trails.bookmarks",x="grafana.trails.breakdown.view";function E(M){return[new n.x0({name:c,value:M,hide:i.zL.hideVariable})]}class C extends t.x{static{this.type="metric-selected-event"}}},51080:(G,O,e)=>{"use strict";e.d(O,{KE:()=>g,U4:()=>d,Vy:()=>P,aM:()=>y,aO:()=>u,ef:()=>l,gA:()=>E,hR:()=>D,iG:()=>x,kj:()=>h,nH:()=>v,xi:()=>p});var t=e(76885),n=e(19347),i=e(32264),s=e(80943),r=e(31193),f=e(56833),a=e(94383),c=e(74764),o=e(4200);function h(C){return s.jh.getAncestor(C,f.b)}function g(C){return s.jh.getAncestor(C,f.b).state.settings}function l(C){return new f.b({initialDS:C,$timeRange:new s.JZ({from:"now-1h",to:"now"}),embedded:!1})}function p(C){const M=(0,s.Is)().getUrlState(C);return m(M)}function m(C){return t.kM.renderUrl(o.km,C)}function y(C){if(C instanceof a.R)return C;if(C.parent)return y(C.parent);throw console.error("Unable to find graph view for",C),new Error("Unable to find trail")}function d(C){return s.jh.interpolate(C,o.gR)}function v(C){return(0,n.l)().getInstanceSettings(C)?.name||C}function u(C){return C?C===o.td?"Logs":C:"Select metric"}function D(){const C=(0,c._r)().recent[0];if(C){const S=s.jh.interpolate(C.resolve(),o.gR);if(typeof S=="string"&&S.length>0)return S}const M=(0,r.tR)().getList({type:"prometheus"});if(M.length>0)return M.find(S=>S.uid===i.$.defaultDatasource)?.uid??M[0].uid}function P(C){const M=i.$.theme2.visualization;return M.getColorByName(M.palette[C%8])}function x(C){const M=Object.keys(C);return M.includes("from")&&M.includes("to")}function E(C){const M=s.jh.lookupVariable("filters",C);return M instanceof s.H9?M.state.filters:null}},27825:(G,O,e)=>{"use strict";e.d(O,{J:()=>d});var t=e(52622),n=e(38248),i=e(74848),s=e(96540),r=e(91890),f=e(72574),a=e(32264),c=e(66864),o=e(94354),h=e(10354),g=e(88841),l=e(94397);const p=[{label:"Size",value:t.J1.Size,description:"Split the buckets based on size"},{label:"Count",value:t.J1.Count,description:"Split the buckets based on count"}],m=[{label:"Split",value:t.J1.Size,description:"Split the buckets based on size"}],y=({value:v,onChange:u,item:D})=>{const[P,x]=(0,s.useState)(!1),E=S=>{x(!(0,l.N_)(S)),u({...v,value:S})},M=(0,f.w)().getVariables().map(S=>({value:S.name,label:S.label||S.name,origin:r.$0.Template}));return(0,i.jsxs)(c.Gy,{children:[(0,i.jsx)(o.z,{value:v?.mode||t.J1.Size,options:v?.scale?.type===t.L4.Log?m:p,onChange:S=>{u({...v,mode:S})}}),a.$.featureToggles.transformationsVariableSupport?(0,i.jsx)(g.y,{invalid:P,error:"Value needs to be an integer or a variable",value:v?.value??"",placeholder:"Auto",onChange:E,suggestions:M}):(0,i.jsx)(h.p,{value:v?.value??"",placeholder:"Auto",onChange:S=>{u({...v,value:S.currentTarget.value})}})]})};function d(v,u,D,P){u.addCustomEditor({id:"xBuckets",path:`${v}xBuckets`,name:"X Bucket",editor:y,category:P,defaultValue:{mode:t.J1.Size}}),u.addCustomEditor({id:"yBuckets",path:`${v}yBuckets`,name:"Y Bucket",editor:y,category:P,defaultValue:{mode:t.J1.Size}}),u.addCustomEditor({id:"yBuckets-scale",path:`${v}yBuckets.scale`,name:"Y Bucket scale",category:P,editor:n.W,defaultValue:{type:t.L4.Linear}})}},3290:(G,O,e)=>{"use strict";e.d(O,{VQ:()=>K,wY:()=>L,Nb:()=>N,eE:()=>w,yJ:()=>B});var t=e(81160),n=e(18282),i=e(81010),s=e(11261),r=e(28240),f=e(83195),a=e(41260),c=e(70416),o=e(77678),h=e(73060),g=e(32264),l=e(52622),p=e(97706);const{abs:m,pow:y}=Math,d=new Map;function v(Y,Z,se,j){let q=[],ne=j.map(p.E);for(let oe=Z;oe<se;oe++){let z=m(oe),te=(0,p.h)(y(Y,oe),z);for(let le=0;le<j.length;le++){let ie=j[le]*te,ae=(ie>=0&&oe>=0?0:z)+(oe>=ne[le]?0:ne[le]),re=(0,p.h)(ie,ae);q.push(re),d.set(re,ae)}}return q}const u=Y=>Y%1===0,D=[1,1.5,2,2.5,3,3.5,4,4.5,5,5.5,6,6.5,7,7.5,8,8.5,9,9.5],P=v(10,-16,0,D),x=v(10,0,16,D),E=x.filter(u),C=P.concat(x),M=P.concat(E),S=1*1e3,I=60*S,T=60*I,b=24*T,R=365*b,A=[1,2,4,5,10,20,25,40,50,100,200,250,400,500,S,2*S,4*S,5*S,10*S,15*S,20*S,30*S,I,2*I,4*I,5*I,10*I,15*I,20*I,30*I,T,2*T,4*T,6*T,8*T,12*T,18*T,b,2*b,3*b,4*b,5*b,6*b,7*b,10*b,15*b,30*b,45*b,60*b,90*b,180*b,R,2*R,3*R,4*R,5*R,6*R,7*R,8*R,9*R,10*R],L={id:n.F.heatmap,name:"Create heatmap",description:"Generate heatmap data from source data.",defaultOptions:{},isApplicable:Y=>{const{xField:Z,yField:se,xs:j,ys:q}=H(Y);return Z||se||!j.length||!q.length?i.M.NotPossible:i.M.Applicable},isApplicableDescription:"The Heatmap transformation requires fields with Heatmap compatible data. No fields with Heatmap data could be found.",operator:(Y,Z)=>se=>se.pipe((0,t.T)(j=>{if(g.$.featureToggles.transformationsVariableSupport){const q={...Y,xBuckets:{...Y.xBuckets},yBuckets:{...Y.yBuckets}};return q.xBuckets?.value&&(q.xBuckets.value=Z.interpolate(q.xBuckets.value)),q.yBuckets?.value&&(q.yBuckets.value=Z.interpolate(q.yBuckets.value)),L.transformer(q,Z)(j)}else return L.transformer(Y,Z)(j)})),transformer:Y=>Z=>{const se=K(Z,Y);return Y.keepOriginalData?[se,...Z]:[se]}};function U(Y){return Y==="+Inf"?1/0:Y==="-Inf"?-1/0:+(Y??0)}function W(Y,Z){return U(Y)-U(Z)}function w(Y){return Y?.meta?.custom??{}}function N(Y){let Z=!1;for(let se of Y.fields)switch(se.name){case"y":case"yMin":case"yMax":if(Z)return!1;Z=!0}return Z}function B(Y){const Z=Y.frame.fields[0],se=Z.values,j=Y.frame.fields.filter((ce,me)=>ce.type===s.PU.number&&me>0),q=se.length*j.length,ne=new Array(q),oe=new Array(q),z=new Array(q),te=j.map(ce=>ce.values.slice());te.forEach((ce,me)=>{for(let ee=0;ee<ce.length;ee++)z[te.length*ee+me]=ce[ee]});const le=Array.from({length:j.length},(ce,me)=>me);for(let ce=0,me=0,ee=0;ce<q;me=++ce%le.length)oe[ce]=le[me],me===0&&ce>=le.length&&ee++,ne[ce]=se[ee];let ie=j[0].labels?.le!=null?"yMax":"y";switch(Y.layout){case l.D7.le:ie="yMax";break;case l.D7.ge:ie="yMin";break;case l.D7.unknown:ie="y";break}const ae={yOrdinalDisplay:j.map(ce=>(0,r.Ct)(ce,Y.frame)),yMatchWithLabel:Object.keys(j[0].labels??{})[0]};if(ae.yMatchWithLabel&&(ae.yOrdinalLabel=j.map(ce=>ce.labels?.[ae.yMatchWithLabel]??""),ae.yMatchWithLabel==="le"&&(ae.yMinDisplay="0.0")),Y.unit?.length||Y.decimals!=null){const ce=(0,f.j_)(Y.unit??"short");ae.yMinDisplay&&(ae.yMinDisplay=(0,f.cN)(ce(0,Y.decimals))),ae.yOrdinalDisplay=ae.yOrdinalDisplay.map(me=>{let ee=+me;return Number.isNaN(ee)?me:(0,f.cN)(ce(ee,Y.decimals))})}const re={...j[0].config};return re.displayNameFromDS&&delete re.displayNameFromDS,{length:ne.length,refId:Y.frame.refId,meta:{type:a.m.HeatmapCells,custom:ae},fields:[{name:Z.type===s.PU.time?"xMax":"x",type:Z.type,values:ne,config:Z.config},{name:ie,type:s.PU.number,values:oe,config:{unit:"short"}},{name:Y.value?.length?Y.value:"Value",type:s.PU.number,values:z,config:re,display:j[0].display}]}}function V(Y){Y=Y.slice(),Y.sort((se,j)=>W(se.name,j.name));const Z=Y.map(se=>se.fields[1].values.slice());return Z.reverse(),Z.forEach((se,j)=>{if(j<Z.length-1)for(let q=0;q<se.length;q++)se[q]-=Z[j+1][q]}),Z.reverse(),Y.map((se,j)=>({...se,fields:[se.fields[0],{...se.fields[1],values:Z[j]}]}))}function K(Y,Z){const{xField:se,yField:j,xs:q,ys:ne}=H(Y);if(!se||!j)throw"no heatmap fields found";if(!q.length||!ne.length)throw"no values found";const oe=Z.xBuckets??{},z=Z.yBuckets??{};if(oe.scale?.type===l.L4.Log)throw"X axis only supports linear buckets";const te=Z.yBuckets?.scale??{type:l.L4.Linear},le=X(q,ne,{xSorted:(0,h.g2)(q),xTime:se.type===s.PU.time,xMode:oe.mode,xSize:oe.mode===l.J1.Size?(0,c.WT)((0,c.E9)(oe.value??"")):oe.value?+oe.value:void 0,yMode:z.mode,ySize:z.value?+z.value:void 0,yLog:te?.type===l.L4.Log?te?.log:void 0,xMin:Z.timeRange?.from.valueOf(),xMax:Z.timeRange?.to.valueOf()});return{length:le.x.length,name:(0,r.Ct)(j),meta:{type:a.m.HeatmapCells},fields:[{name:"xMin",type:se.type,values:le.x,config:se.config},{name:"yMin",type:s.PU.number,values:le.y,config:{...j.config,custom:{scaleDistribution:te}}},{name:"Count",type:s.PU.number,values:le.count,config:{unit:"short"}}]}}function H(Y){let Z,se,j=0;for(let z of Y)z.fields.find(le=>le.type===s.PU.time)&&(j+=z.length);let q=Array(j),ne=Array(j),oe=0;for(let z of Y){const te=z.fields.find(ie=>ie.type===s.PU.time);if(!te)continue;Z||(Z=te);const le=te.values;for(let ie of z.fields)if(ie!==te&&ie.type===s.PU.number){const ae=ie.values;for(let re=0;re<le.length;re++,oe++)q[oe]=le[re],ne[oe]=ae[re];se||(se=ie)}}return{xField:Z,yField:se,xs:q,ys:ne}}function X(Y,Z,se){let j=Y.length,q=se?.xSorted??!1,ne=se?.ySorted??!1,oe=se?.xMin??(q?Y[0]:1/0),z=ne?Z[0]:1/0,te=se?.xMax??(q?Y[j-1]:-1/0),le=ne?Z[j-1]:-1/0,ie=se?.yLog,ae=se?.xMin!=null&&se?.xMax!=null,re=se?.yMin!=null&&se?.yMax!=null;for(let Xe=0;Xe<j;Xe++)!q&&!ae&&(oe=Math.min(oe,Y[Xe]),te=Math.max(te,Y[Xe])),!ne&&!re&&(!ie||Z[Xe]>0)&&(z=Math.min(z,Z[Xe]),le=Math.max(le,Z[Xe]));let ce=se?.xSize??0,me=se?.ySize??0,ee=se?.xMode,de=se?.yMode;if((!Number.isFinite(ce)||ce<=0)&&(ee=l.J1.Count,ce=20),(!Number.isFinite(me)||me<=0)&&(de=l.J1.Count,me=10),ee===l.J1.Count){let Xe=(te-oe)/Math.max(ce-1,1),Je=se?.xTime?A:M,st=Je.findIndex(pt=>pt>Xe)-1;ce=Je[Math.max(st,0)]}if(de===l.J1.Count){let Xe=(le-z)/Math.max(me-1,1),Je=se?.yTime?A:M,st=Je.findIndex(pt=>pt>Xe)-1;me=Je[Math.max(st,0)]}let De=se?.xCeil?Xe=>(0,o.Uh)(Xe,ce):Xe=>(0,o.rs)(Xe,ce),fe=se?.yCeil?Xe=>(0,o.Uh)(Xe,me):Xe=>(0,o.rs)(Xe,me);if(ie){me=1/(se?.ySize??1);let Xe=ie===2?Math.log2:Math.log10;fe=se?.yCeil?Je=>(0,o.Uh)(Xe(Je),me):Je=>(0,o.rs)(Xe(Je),me)}let Te=De(oe),je=De(te),He=fe(z),Be=fe(le),Ne=Math.round((je-Te)/ce)+1,Re=Math.round((Be-He)/me)+1,[Se,We,Ke]=k(Ne,Re,Te,ce,He,me,ie);for(let Xe=0;Xe<j;Xe++){if(ie&&Z[Xe]<=0)continue;const Je=(De(Y[Xe])-Te)/ce,st=(fe(Z[Xe])-He)/me,pt=Je*Re+st;Ke[pt]++}return{x:Se,y:We,count:Ke}}function k(Y,Z,se,j,q,ne,oe){const z=Y*Z,te=new Array(z),le=new Array(z),ie=new Array(z);for(let ae=0,re=0,ce=se;ae<z;re=++ae%Z)ie[ae]=0,oe?le[ae]=oe**(q+re*ne):le[ae]=q+re*ne,re===0&&ae>=Z&&(ce+=j),te[ae]=ce;return[te,le,ie]}},91847:(G,O,e)=>{"use strict";e.d(O,{$n:()=>i,g_:()=>t,uk:()=>n});var t=(r=>(r.ShortcodeFigure="shortcodeFigure",r.UIImage="uiImage",r))(t||{});const n={calculateField:{name:"Add field from calculation",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to add a new field calculated from two other fields. Each transformation allows you to add one new field.

- **Mode** - Select a mode:
  - **Reduce row** - Apply selected calculation on each row of selected fields independently.
  - **Binary operation** - Apply basic binary operations (for example, sum or multiply) on values in a single row from two selected fields.
  - **Unary operation** - Apply basic unary operations on values in a single row from a selected field. The available operations are:
    - **Absolute value (abs)** - Returns the absolute value of a given expression. It represents its distance from zero as a positive number.
    - **Natural exponential (exp)** - Returns _e_ raised to the power of a given expression.
    - **Natural logarithm (ln)** - Returns the natural logarithm of a given expression.
    - **Floor (floor)** - Returns the largest integer less than or equal to a given expression.
    - **Ceiling (ceil)** - Returns the smallest integer greater than or equal to a given expression.
  - **Cumulative functions** - Apply functions on the current row and all preceding rows.
    - **Total** - Calculates the cumulative total up to and including the current row.
    - **Mean** - Calculates the mean up to and including the current row.
  - **Window functions** - Apply window functions. The window can either be **trailing** or **centered**.
    With a trailing window the current row will be the last row in the window.
    With a centered window the window will be centered on the current row.
    For even window sizes, the window will be centered between the current row, and the previous row.
    - **Mean** - Calculates the moving mean or running average.
    - **Stddev** - Calculates the moving standard deviation.
    - **Variance** - Calculates the moving variance.
  - **Row index** - Insert a field with the row index.
- **Field name** - Select the names of fields you want to use in the calculation for the new field.
- **Calculation** - If you select **Reduce row** mode, then the **Calculation** field appears. Click in the field to see a list of calculation choices you can use to create the new field. For information about available calculations, refer to [Calculation types][].
- **Operation** - If you select **Binary operation** or **Unary operation** mode, then the **Operation** fields appear. These fields allow you to apply basic math operations on values in a single row from selected fields. You can also use numerical values for binary operations.
- **As percentile** - If you select **Row index** mode, then the **As percentile** switch appears. This switch allows you to transform the row index as a percentage of the total number of rows.
- **Alias** - (Optional) Enter the name of your new field. If you leave this blank, then the field will be named to match the calculation.
- **Replace all fields** - (Optional) Select this option if you want to hide all other fields and display only your calculated field in the visualization.

> **Note:** **Cumulative functions** and **Window functions** modes are currently in public preview. Grafana Labs offers limited support, and breaking changes might occur prior to the feature being made generally available. Enable the \`addFieldFromCalculationStatFunctions\` feature toggle in Grafana to use this feature. Contact Grafana Support to enable this feature in Grafana Cloud.

In the example below, we added two fields together and named them Sum.

${s("/static/img/docs/transformations/add-field-from-calc-stat-example-7-0.png",r,"A stat visualization including one field called Sum")}
  `},links:[{title:"Calculation types",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/calculation-types/"}]},concatenate:{name:"Concatenate fields",getHelperDocs:function(){return`
Use this transformation to combine all fields from all frames into one result.

For example, if you have separate queries retrieving temperature and uptime data (Query A) and air quality index and error information (Query B), applying the concatenate transformation yields a consolidated data frame with all relevant information in one view.

Consider the following:

**Query A:**

| Temp  | Uptime  |
| ----- | ------- |
| 15.4  | 1230233 |

**Query B:**

| AQI   | Errors |
| ----- | ------ |
| 3.2   | 5      |

After you concatenate the fields, the data frame would be:

| Temp | Uptime  | AQI | Errors |
| ---- | ------- | --- | ------ |
| 15.4 | 1230233 | 3.2 | 5      |

This transformation simplifies the process of merging data from different sources, providing a comprehensive view for analysis and visualization.
  `}},configFromData:{name:"Config from query results",getHelperDocs:function(){return`
Use this transformation to select a query and extract standard options, such as **Min**, **Max**, **Unit**, and **Thresholds**, and apply them to other query results. This feature enables dynamic visualization configuration based on the data returned by a specific query.

#### Options

- **Config query** - Select the query that returns the data you want to use as configuration.
- **Apply to** - Select the fields or series to which the configuration should be applied.
- **Apply to options** - Specify a field type or use a field name regex, depending on your selection in **Apply to**.

#### Field mapping table

Below the configuration options, you'll find the field mapping table. This table lists all fields found in the data returned by the config query, along with **Use as** and **Select** options. It provides control over mapping fields to config properties, and for multiple rows, it allows you to choose which value to select.

#### Example

Input[0] (From query: A, name: ServerA)

| Time          | Value |
| ------------- | ----- |
| 1626178119127 | 10    |
| 1626178119129 | 30    |

Input[1] (From query: B)

| Time          | Value |
| ------------- | ----- |
| 1626178119127 | 100   |
| 1626178119129 | 100   |

Output (Same as Input[0] but now with config on the Value field)

| Time          | Value (config: Max=100) |
| ------------- | ----------------------- |
| 1626178119127 | 10                      |
| 1626178119129 | 30                      |

Each row in the source data becomes a separate field. Each field now has a maximum configuration option set. Options such as **Min**, **Max**, **Unit**, and **Thresholds** are part of the field configuration. If set, they are used by the visualization instead of any options manually configured in the panel editor options pane.

#### Value mappings

You can also transform a query result into value mappings. With this option, every row in the configuration query result defines a single value mapping row. See the following example.

Config query result:

| Value | Text   | Color |
| ----- | ------ | ----- |
| L     | Low    | blue  |
| M     | Medium | green |
| H     | High   | red   |

In the field mapping specify:

| Field | Use as                  | Select     |
| ----- | ----------------------- | ---------- |
| Value | Value mappings / Value  | All values |
| Text  | Value mappings / Text   | All values |
| Color | Value mappings / Color | All values |

Grafana builds value mappings from your query result and applies them to the real data query results. You should see values being mapped and colored according to the config query results.
  `}},convertFieldType:{name:"Convert field type",getHelperDocs:function(){return`
Use this transformation to modify the field type of a specified field.

This transformation has the following options:

- **Field** - Select from available fields
- **as** - Select the FieldType to convert to
  - **Numeric** - attempts to make the values numbers
  - **String** - will make the values strings
  - **Time** - attempts to parse the values as time
    - The input will be parsed according to the [Moment.js parsing format](https://momentjs.com/docs/#/parsing/)
    - It will parse the numeric input as a Unix epoch timestamp in milliseconds.
      You must multiply your input by 1000 if it's in seconds.
    - Will show an option to specify a DateFormat as input by a string like yyyy-mm-dd or DD MM YYYY hh:mm:ss
  - **Boolean** - will make the values booleans
  - **Enum** - will make the values enums
    - Will show a table to manage the enums
  - **Other** - attempts to parse the values as JSON

For example, consider the following query that could be modified by selecting the time field as Time and specifying Date Format as YYYY.

#### Sample Query

| Time       | Mark  | Value |
|------------|-------|-------|
| 2017-07-01 | above | 25    |
| 2018-08-02 | below | 22    |
| 2019-09-02 | below | 29    |
| 2020-10-04 | above | 22    |

The result:

#### Transformed Query

| Time                | Mark  | Value |
|---------------------|-------|-------|
| 2017-01-01 00:00:00 | above | 25    |
| 2018-01-01 00:00:00 | below | 22    |
| 2019-01-01 00:00:00 | below | 29    |
| 2020-01-01 00:00:00 | above | 22    |

This transformation allows you to flexibly adapt your data types, ensuring compatibility and consistency in your visualizations.
  `}},extractFields:{name:"Extract fields",getHelperDocs:function(){return`
Use this transformation to select a source of data and extract content from it in different formats. This transformation has the following fields:

- **Source** - Select the field for the source of data.
- **Format** - Choose one of the following:
  - **JSON** - Parse JSON content from the source.
  - **Key+value pairs** - Parse content in the format 'a=b' or 'c:d' from the source.
  - **Auto** - Discover fields automatically.
- **Replace All Fields** - (Optional) Select this option to hide all other fields and display only your calculated field in the visualization.
- **Keep Time** - (Optional) Available only if **Replace All Fields** is true. Keeps the time field in the output.

Consider the following dataset:

#### Dataset Example

| Timestamp           | json_data     |
|---------------------|---------------|
| 1636678740000000000 | {"value": 1}  |
| 1636678680000000000 | {"value": 5}  |
| 1636678620000000000 | {"value": 12} |

You could prepare the data to be used by a [Time series panel][] with this configuration:

- Source: json_data
- Format: JSON
  - Field: value
  - Alias: my_value
- Replace all fields: true
- Keep time: true

This will generate the following output:

#### Transformed Data

| Timestamp           | my_value |
|---------------------|----------|
| 1636678740000000000 | 1        |
| 1636678680000000000 | 5        |
| 1636678620000000000 | 12       |

This transformation allows you to extract and format data in various ways. You can customize the extraction format based on your specific data needs.
  `},links:[{title:"Time series panel",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/time-series/"}]},fieldLookup:{name:"Lookup fields from resource",getHelperDocs:function(){return`
Use this transformation to enrich a field value by looking up additional fields from an external source. 
  
This transformation has the following fields:

- **Field** - Select a text field from your dataset.
- **Lookup** - Choose from **Countries**, **USA States**, and **Airports**.

This transformation currently supports spatial data.

For example, if you have this data:

#### Dataset Example

| Location  | Values |
|-----------|--------|
| AL        | 0      |
| AK        | 10     |
| Arizona   | 5      |
| Arkansas  | 1      |
| Somewhere | 5      |

With this configuration:

- Field: location
- Lookup: USA States

You'll get the following output:

#### Transformed Data

| Location  | ID | Name     | Lng         | Lat       | Values |
|-----------|----|----------|-------------|-----------|--------|
| AL        | AL | Alabama  | -80.891064  | 12.448457 | 0      |
| AK        | AK | Arkansas | -100.891064 | 24.448457 | 10     |
| Arizona   |    |          |             |           | 5      |
| Arkansas  |    |          |             |           | 1      |
| Somewhere |    |          |             |           | 5      |

This transformation lets you augment your data by fetching additional information from external sources, providing a more comprehensive dataset for analysis and visualization.
  `}},filterByRefId:{name:"Filter data by query refId",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to hide one or more queries in panels that have multiple queries.

Grafana displays the query identification letters in dark gray text. Click a query identifier to toggle filtering. If the query letter is white, then the results are displayed. If the query letter is dark, then the results are hidden.

> **Note:** This transformation is not available for Graphite because this data source does not support correlating returned data with queries.

In the example below, the panel has three queries (A, B, C). We removed the B query from the visualization.

${s("/static/img/docs/transformations/filter-by-query-stat-example-7-0.png",r,"A stat visualization with results from two queries, A and C")}
  `}},filterByValue:{name:"Filter data by values",getHelperDocs:function(){return`
Use this transformation to selectively filter data points directly within your visualization. This transformation provides options to include or exclude data based on one or more conditions applied to a selected field.

This transformation is very useful if your data source does not natively filter by values. You might also use this to narrow values to display if you are using a shared query.

The available conditions for all fields are:

- **Regex** - Match a regex expression.
- **Is Null** - Match if the value is null.
- **Is Not Null** - Match if the value is not null.
- **Equal** - Match if the value is equal to the specified value.
- **Different** - Match if the value is different than the specified value.

The available conditions for string fields are:

- **Contains substring** - Match if the value contains the specified substring (case insensitive).
- **Does not contain substring** - Match if the value doesn't contain the specified substring (case insensitive).

The available conditions for number fields are:

- **Greater** - Match if the value is greater than the specified value.
- **Lower** - Match if the value is lower than the specified value.
- **Greater or equal** - Match if the value is greater or equal.
- **Lower or equal** - Match if the value is lower or equal.
- **Range** - Match a range between a specified minimum and maximum, min and max included.

Consider the following dataset:

#### Dataset Example

| Time                | Temperature | Altitude |
|---------------------|-------------|----------|
| 2020-07-07 11:34:23 | 32          | 101      |
| 2020-07-07 11:34:22 | 28          | 125      |
| 2020-07-07 11:34:21 | 26          | 110      |
| 2020-07-07 11:34:20 | 23          | 98       |
| 2020-07-07 10:32:24 | 31          | 95       |
| 2020-07-07 10:31:22 | 20          | 85       |
| 2020-07-07 09:30:57 | 19          | 101      |

If you **Include** the data points that have a temperature below 30\xB0C, the configuration will look as follows:

- Filter Type: 'Include'
- Condition: Rows where 'Temperature' matches 'Lower Than' '30'

And you will get the following result, where only the temperatures below 30\xB0C are included:

#### Transformed Data

| Time                | Temperature | Altitude |
|---------------------|-------------|----------|
| 2020-07-07 11:34:22 | 28          | 125      |
| 2020-07-07 11:34:21 | 26          | 110      |
| 2020-07-07 11:34:20 | 23          | 98       |
| 2020-07-07 10:31:22 | 20          | 85       |
| 2020-07-07 09:30:57 | 19          | 101      |

You can add more than one condition to the filter. For example, you might want to include the data only if the altitude is greater than 100. To do so, add that condition to the following configuration:

- Filter type: 'Include' rows that 'Match All' conditions
- Condition 1: Rows where 'Temperature' matches 'Lower' than '30'
- Condition 2: Rows where 'Altitude' matches 'Greater' than '100'

When you have more than one condition, you can choose if you want the action (include/exclude) to be applied on rows that **Match all** conditions or **Match any** of the conditions you added.

In the example above, we chose **Match all** because we wanted to include the rows that have a temperature lower than 30\xB0C *AND* an altitude higher than 100. If we wanted to include the rows that have a temperature lower than 30\xB0C *OR* an altitude higher than 100 instead, then we would select **Match any**. This would include the first row in the original data, which has a temperature of 32\xB0C (does not match the first condition) but an altitude of 101 (which matches the second condition), so it is included.

Conditions that are invalid or incompletely configured are ignored.

This versatile data filtering transformation lets you to selectively include or exclude data points based on specific conditions. Customize the criteria to tailor your data presentation to meet your unique analytical needs.
  `}},filterFieldsByName:{name:"Filter fields by name",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to selectively remove parts of your query results. There are three ways to filter field names:

- [Using a regular expression](#use-a-regular-expression)
- [Manually selecting included fields](#manually-select-included-fields)
- [Using a dashboard variable](#use-a-dashboard-variable)

#### Use a regular expression

When you filter using a regular expression, field names that match the regular expression are included. 

For example, from the input data:

| Time                | dev-eu-west | dev-eu-north | prod-eu-west | prod-eu-north |
| ------------------- | ----------- | ------------ | ------------ | ------------- |
| 2023-03-04 23:56:23 | 23.5        | 24.5         | 22.2         | 20.2          |
| 2023-03-04 23:56:23 | 23.6        | 24.4         | 22.1         | 20.1          |

The result from using the regular expression 'prod.*' would be:

| Time                | prod-eu-west | prod-eu-north |
| ------------------- | ------------ | ------------- |
| 2023-03-04 23:56:23 | 22.2         | 20.2          |
| 2023-03-04 23:56:23 | 22.1         | 20.1          |

The regular expression can include an interpolated dashboard variable by using the \${variableName} syntax.

#### Manually select included fields

Click and uncheck the field names to remove them from the result. Fields that are matched by the regular expression are still included, even if they're unchecked.

#### Use a dashboard variable

Enable 'From variable' to let you select a dashboard variable that's used to include fields. By setting up a [dashboard variable][] with multiple choices, the same fields can be displayed across multiple visualizations.

${s("/static/img/docs/transformations/filter-name-table-before-7-0.png",r,"A table visualization with time, value, Min, and Max columns")}

Here's the table after we applied the transformation to remove the Min field.

${s("/static/img/docs/transformations/filter-name-table-after-7-0.png",r,"A table visualization with time, value, and Max columns")}

Here is the same query using a Stat visualization.

${s("/static/img/docs/transformations/filter-name-stat-after-7-0.png",r,"A stat visualization with value and Max fields")}

This transformation provides flexibility in tailoring your query results to focus on the specific fields you need for effective analysis and visualization.
  `}},formatString:{name:"Format string",getHelperDocs:function(){return`
Use this transformation to customize the output of a string field. This transformation has the following fields:

- **Upper case** - Formats the entire string in uppercase characters.
- **Lower case** - Formats the entire string in lowercase characters.
- **Sentence case** - Formats the first character of the string in uppercase.
- **Title case** - Formats the first character of each word in the string in uppercase.
- **Pascal case** - Formats the first character of each word in the string in uppercase and doesn't include spaces between words.
- **Camel case** - Formats the first character of each word in the string in uppercase, except the first word, and doesn't include spaces between words.
- **Snake case** - Formats all characters in the string in lowercase and uses underscores instead of spaces between words.
- **Kebab case** - Formats all characters in the string in lowercase and uses dashes instead of spaces between words.
- **Trim** - Removes all leading and trailing spaces from the string.
- **Substring** - Returns a substring of the string, using the specified start and end positions.

This transformation provides a convenient way to standardize and tailor the presentation of string data for better visualization and analysis.

> **Note:** This transformation is currently in public preview. Grafana Labs offers limited support, and breaking changes might occur prior to the feature being made generally available. Enable the \`formatString\` feature toggle in Grafana to use this feature. Contact Grafana Support to enable this feature in Grafana Cloud.`}},formatTime:{name:"Format time",getHelperDocs:function(){return`
Use this transformation to customize the output of a time field. Output can be formatted using [Moment.js format strings](https://momentjs.com/docs/#/displaying/). For example, if you want to display only the year of a time field, the format string 'YYYY' can be used to show the calendar year (for example, 1999 or 2012).

**Before Transformation:**

| Timestamp           | Event        |
| ------------------- | ------------ |
| 1636678740000000000 | System Start |
| 1636678680000000000 | User Login   |
| 1636678620000000000 | Data Updated |

**After applying 'YYYY-MM-DD HH:mm:ss':**

| Timestamp           | Event        |
| ------------------- | ------------ |
| 2021-11-12 14:25:40 | System Start |
| 2021-11-12 14:24:40 | User Login   |
| 2021-11-12 14:23:40 | Data Updated |

This transformation lets you tailor the time representation in your visualizations, providing flexibility and precision in displaying temporal data.

> **Note:** This transformation is available in Grafana 10.1+ as an alpha feature.
  `}},groupBy:{name:"Group by",getHelperDocs:function(){return`
Use this transformation to group the data by a specified field (column) value and process calculations on each group. Click to see a list of calculation choices. For information about available calculations, refer to [Calculation types][].

Here's an example of original data.

| Time                | Server ID | CPU Temperature | Server Status |
| ------------------- | --------- | --------------- | ------------- |
| 2020-07-07 11:34:20 | server 1  | 80              | Shutdown      |
| 2020-07-07 11:34:20 | server 3  | 62              | OK            |
| 2020-07-07 10:32:20 | server 2  | 90              | Overload      |
| 2020-07-07 10:31:22 | server 3  | 55              | OK            |
| 2020-07-07 09:30:57 | server 3  | 62              | Rebooting     |
| 2020-07-07 09:30:05 | server 2  | 88              | OK            |
| 2020-07-07 09:28:06 | server 1  | 80              | OK            |
| 2020-07-07 09:25:05 | server 2  | 88              | OK            |
| 2020-07-07 09:23:07 | server 1  | 86              | OK            |

This transformation goes in two steps. First you specify one or multiple fields to group the data by. This will group all the same values of those fields together, as if you sorted them. For instance if we group by the Server ID field, then it would group the data this way:

| Time                | Server ID      | CPU Temperature | Server Status |
| ------------------- | -------------- | --------------- | ------------- |
| 2020-07-07 11:34:20 | **server 1**   | 80              | Shutdown      |
| 2020-07-07 09:28:06 | **server 1**   | 80              | OK            |
| 2020-07-07 09:23:07 | **server 1**   | 86              | OK            |
| 2020-07-07 10:32:20 | server 2       | 90              | Overload      |
| 2020-07-07 09:30:05 | server 2       | 88              | OK            |
| 2020-07-07 09:25:05 | server 2       | 88              | OK            |
| 2020-07-07 11:34:20 | **_server 3_** | 62              | OK            |
| 2020-07-07 10:31:22 | **_server 3_** | 55              | OK            |
| 2020-07-07 09:30:57 | **_server 3_** | 62              | Rebooting     |

All rows with the same value of Server ID are grouped together.

After choosing which field you want to group your data by, you can add various calculations on the other fields, and apply the calculation to each group of rows. For instance, we could want to calculate the average CPU temperature for each of those servers. So we can add the _mean_ calculation applied on the CPU Temperature field to get the following:

| Server ID | CPU Temperature (mean) |
| --------- | ---------------------- |
| server 1  | 82                     |
| server 2  | 88.6                   |
| server 3  | 59.6                   |

And we can add more than one calculation. For instance:

- For field Time, we can calculate the _Last_ value, to know when the last data point was received for each server
- For field Server Status, we can calculate the _Last_ value to know what is the last state value for each server
- For field Temperature, we can also calculate the _Last_ value to know what is the latest monitored temperature for each server

We would then get:

| Server ID | CPU Temperature (mean) | CPU Temperature (last) | Time (last)         | Server Status (last) |
| --------- | ---------------------- | ---------------------- | ------------------- | -------------------- |
| server 1  | 82                     | 80                     | 2020-07-07 11:34:20 | Shutdown             |
| server 2  | 88.6                   | 90                     | 2020-07-07 10:32:20 | Overload             |
| server 3  | 59.6                   | 62                     | 2020-07-07 11:34:20 | OK                   |

This transformation allows you to extract essential information from your time series and present it conveniently.
  `},links:[{title:"Calculation types",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/calculation-types/"}]},groupingToMatrix:{name:"Grouping to matrix",getHelperDocs:function(){return`
Use this transformation to combine three fields\u2014which are used as input for the **Column**, **Row**, and **Cell value** fields from the query output\u2014and generate a matrix. The matrix is calculated as follows:

**Original data**

| Server ID | CPU Temperature | Server Status |
| --------- | --------------- | ------------- |
| server 1  | 82              | OK            |
| server 2  | 88.6            | OK            |
| server 3  | 59.6            | Shutdown      |

We can generate a matrix using the values of 'Server Status' as column names, the 'Server ID' values as row names, and the 'CPU Temperature' as content of each cell. The content of each cell will appear for the existing column ('Server Status') and row combination ('Server ID'). For the rest of the cells, you can select which value to display between: **Null**, **True**, **False**, or **Empty**.

**Output**

| Server IDServer Status | OK   | Shutdown |
| ----------------------- | ---- | -------- |
| server 1                | 82   |          |
| server 2                | 88.6 |          |
| server 3                |      | 59.6     |

Use this transformation to construct a matrix by specifying fields from your query results. The matrix output reflects the relationships between the unique values in these fields. This helps you present complex relationships in a clear and structured matrix format.
  `}},groupToNestedTable:{name:"Group to nested tables",getHelperDocs:function(r="shortcodeFigure"){return`
  Use this transformation to group the data by a specified field (column) value and process calculations on each group. Records are generated that share the same grouped field value, to be displayed in a nested table.
    
  To calculate a statistic for a field, click the selection box next to it and select the **Calculate** option:

  ${s("/static/img/docs/transformations/nested-table-select-calculation.png",r,"A select box showing the Group and Calculate options for the transformation.")}

  Once **Calculate** has been selected, another selection box will appear next to the respective field which will allow statistics to be selected:

  ${s("/static/img/docs/transformations/nested-table-select-stat.png",r,"A select box showing available statistic calculations once the calculate option for the field has been selected.")}

  For information about available calculations, refer to [Calculation types][].

  Here's an example of original data:

  | Time                | Server ID | CPU Temperature | Server Status |
  | ------------------- | --------- | --------------- | ------------- |
  | 2020-07-07 11:34:20 | server 1  | 80              | Shutdown      |
  | 2020-07-07 11:34:20 | server 3  | 62              | OK            |
  | 2020-07-07 10:32:20 | server 2  | 90              | Overload      |
  | 2020-07-07 10:31:22 | server 3  | 55              | OK            |
  | 2020-07-07 09:30:57 | server 3  | 62              | Rebooting     |
  | 2020-07-07 09:30:05 | server 2  | 88              | OK            |
  | 2020-07-07 09:28:06 | server 1  | 80              | OK            |
  | 2020-07-07 09:25:05 | server 2  | 88              | OK            |
  | 2020-07-07 09:23:07 | server 1  | 86              | OK            |

  This transformation has two steps. First, specify one or more fields by which to group the data. This groups all the same values of those fields together, as if you sorted them. For instance, if you group by the Server ID field, Grafana groups the data this way:

  | Server ID      |  |
  | -------------- | ------------- |
  | server 1 | <table><th><tr><td>Time</td><td>CPU Temperature</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>80</td><td>Shutdown</td></tr><tr><td>2020-07-07 09:28:06</td><td>80</td><td>OK</td></tr><tr><td>2020-07-07 09:23:07</td><td>86</td><td>OK</td></tr></tbody></table> |
  | server 2 | <table><th><tr><td>Time</td><td>CPU Temperature</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 10:32:20</td><td>90</td><td>Overload</td></tr><tr><td>2020-07-07 09:30:05</td><td>88</td><td>OK</td></tr><tr><td>2020-07-07 09:25:05</td><td>88</td><td>OK</td></tr></tbody></table> |
  | server 3 | <table><th><tr><td>Time</td><td>CPU Temperature</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>62</td><td>OK</td></tr><tr><td>2020-07-07 10:31:22</td><td>55</td><td>OK</td></tr><tr><td>2020-07-07 09:30:57</td><td>62</td><td>Rebooting</td></tr></tbody></table> |

  After choosing the field by which you want to group your data, you can add various calculations on the other fields and apply the calculation to each group of rows. For instance, you might want to calculate the average CPU temperature for each of those servers. To do so, add the **mean calculation** applied on the CPU Temperature field to get the following result:

  | Server ID      | CPU Temperatute (mean) | |
  | -------------- | ------------- | ------------- |
  | server 1 | 82 | <table><th><tr><td>Time</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>Shutdown</td></tr><tr><td>2020-07-07 09:28:06</td><td>OK</td></tr><tr><td>2020-07-07 09:23:07</td><td>OK</td></tr></tbody></table> |
  | server 2 | 88.6 | <table><th><tr><td>Time</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 10:32:20</td><td>Overload</td></tr><tr><td>2020-07-07 09:30:05</td><td>OK</td></tr><tr><td>2020-07-07 09:25:05</td><td>OK</td></tr></tbody></table> |
  | server 3 | 59.6 | <table><th><tr><td>Time</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>OK</td></tr><tr><td>2020-07-07 10:31:22</td><td>OK</td></tr><tr><td>2020-07-07 09:30:57</td><td>Rebooting</td></tr></tbody></table> |
      `},links:[{title:"Calculation types",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/calculation-types/"}]},heatmap:{name:"Create heatmap",getHelperDocs:function(){return`
Use this transformation to prepare histogram data for visualizing trends over time. Similar to the heatmap visualization, this transformation converts histogram metrics into temporal buckets.

#### X Bucket

This setting determines how the x-axis is split into buckets.

- **Size** - Specify a time interval in the input field. For example, a time range of '1h' creates cells one hour wide on the x-axis.
- **Count** - For non-time-related series, use this option to define the number of elements in a bucket.

#### Y Bucket

This setting determines how the y-axis is split into buckets.

- **Linear**
- **Logarithmic** - Choose between log base 2 or log base 10.
- **Symlog** - Uses a symmetrical logarithmic scale. Choose between log base 2 or log base 10, allowing for negative values.

Assume you have the following dataset:

| Timestamp           | Value |
|-------------------- |-------|
| 2023-01-01 12:00:00 | 5     |
| 2023-01-01 12:15:00 | 10    |
| 2023-01-01 12:30:00 | 15    |
| 2023-01-01 12:45:00 | 8     |

- With X Bucket set to 'Size: 15m' and Y Bucket as 'Linear', the histogram organizes values into time intervals of 15 minutes on the x-axis and linearly on the y-axis.
- For X Bucket as 'Count: 2' and Y Bucket as 'Logarithmic (base 10)', the histogram groups values into buckets of two on the x-axis and use a logarithmic scale on the y-axis.
  `}},histogram:{name:"Histogram",getHelperDocs:function(){return`
Use this transformation to generate a histogram based on input data, allowing you to visualize the distribution of values.

- **Bucket size** - The range between the lowest and highest items in a bucket (xMin to xMax).
- **Bucket offset** - The offset for non-zero-based buckets.
- **Combine series** - Create a unified histogram using all available series.

**Original data**

Series 1:

| A | B | C |
| - | - | - |
| 1 | 3 | 5 |
| 2 | 4 | 6 |
| 3 | 5 | 7 |
| 4 | 6 | 8 |
| 5 | 7 | 9 |

Series 2:

| C |
| - |
| 5 |
| 6 |
| 7 |
| 8 |
| 9 |

**Output**

| xMin | xMax | A | B | C | C |
| ---- | ---- | --| --| --| --|
| 1    | 2    | 1 | 0 | 0 | 0 |
| 2    | 3    | 1 | 0 | 0 | 0 |
| 3    | 4    | 1 | 1 | 0 | 0 |
| 4    | 5    | 1 | 1 | 0 | 0 |
| 5    | 6    | 1 | 1 | 1 | 1 |
| 6    | 7    | 0 | 1 | 1 | 1 |
| 7    | 8    | 0 | 1 | 1 | 1 |
| 8    | 9    | 0 | 0 | 1 | 1 |
| 9    | 10   | 0 | 0 | 1 | 1 |

Visualize the distribution of values using the generated histogram, providing insights into the data's spread and density.
  `}},joinByField:{name:"Join by field",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to merge multiple results into a single table, enabling the consolidation of data from different queries.

This is especially useful for converting multiple time series results into a single wide table with a shared time field.

#### Inner join (for Time Series or SQL-like data)

An inner join merges data from multiple tables where all tables share the same value from the selected field. This type of join excludes data where values do not match in every result.

Use this transformation to combine the results from multiple queries (combining on a passed join field or the first time column) into one result, and drop rows where a successful join cannot occur. This is not optimized for large Time Series datasets.

In the following example, two queries return Time Series data. It is visualized as two separate tables before applying the inner join transformation.

**Query A:**

| Time                | Job     | Uptime    |
| ------------------- | ------- | --------- |
| 2020-07-07 11:34:20 | node    | 25260122  |
| 2020-07-07 11:24:20 | postgre | 123001233 |
| 2020-07-07 11:14:20 | postgre | 345001233 |

**Query B:**

| Time                | Server   | Errors |
| ------------------- | -------- | ------ |
| 2020-07-07 11:34:20 | server 1 | 15     |
| 2020-07-07 11:24:20 | server 2 | 5      |
| 2020-07-07 11:04:20 | server 3 | 10     |

The result after applying the inner join transformation looks like the following:

| Time                | Job     | Uptime    | Server   | Errors |
| ------------------- | ------- | --------- | -------- | ------ |
| 2020-07-07 11:34:20 | node    | 25260122  | server 1 | 15     |
| 2020-07-07 11:24:20 | postgre | 123001233 | server 2 | 5      |

This works in the same way for non-Time Series tabular data as well.

**Students**

| StudentID | Name     | Major            |
| --------- | -------- | ---------------- |
| 1         | John     | Computer Science |
| 2         | Emily    | Mathematics      |
| 3         | Michael  | Physics          |
| 4         | Jennifer | Chemistry        |

**Enrollments**

| StudentID | CourseID | Grade |
|-----------|----------|-------|
| 1         | CS101    | A     |
| 1         | CS102    | B     |
| 2         | MATH201  | A     |
| 3         | PHYS101  | B     |
| 5         | HIST101  | B     |

The result after applying the inner join transformation looks like the following:

| StudentID | Name    | Major            | CourseID | Grade |
| --------- | ------- | ---------------- | -------  | ----- |
| 1         | John    | Computer Science | CS101    | A     |
| 1         | John    | Computer Science | CS102    | B     |
| 2         | Emily   | Mathematics      | MATH201  | A     |
| 3         | Michael | Physics          | PHYS101  | B     |

The inner join only includes rows where there is a match between the "StudentID" in both tables. In this case, the result does not include "Jennifer" from the "Students" table because there are no matching enrollments for her in the "Enrollments" table.

#### Outer join (for Time Series data)

An outer join includes all data from an inner join and rows where values do not match in every input. While the inner join joins Query A and Query B on the time field, the outer join includes all rows that don't match on the time field.

In the following example, two queries return table data. It is visualized as two tables before applying the outer join transformation.

**Query A:**

| Time                | Job     | Uptime    |
| ------------------- | ------- | --------- |
| 2020-07-07 11:34:20 | node    | 25260122  |
| 2020-07-07 11:24:20 | postgre | 123001233 |
| 2020-07-07 11:14:20 | postgre | 345001233 |

**Query B:**

| Time                | Server   | Errors |
| ------------------- | -------- | ------ |
| 2020-07-07 11:34:20 | server 1 | 15     |
| 2020-07-07 11:24:20 | server 2 | 5      |
| 2020-07-07 11:04:20 | server 3 | 10     |

The result after applying the outer join transformation looks like the following:

| Time                | Job     | Uptime    | Server   | Errors |
| ------------------- | ------- | --------- | -------- | ------ |
| 2020-07-07 11:04:20 |         |           | server 3 | 10     |
| 2020-07-07 11:14:20 | postgre | 345001233 |          |        |
| 2020-07-07 11:34:20 | node    | 25260122  | server 1 | 15     |
| 2020-07-07 11:24:20 | postgre | 123001233 | server 2 | 5      |

In the following example, a template query displays time series data from multiple servers in a table visualization. The results of only one query can be viewed at a time.

${s("/static/img/docs/transformations/join-fields-before-7-0.png",r,"A table visualization showing results for one server")}

I applied a transformation to join the query results using the time field. Now I can run calculations, combine, and organize the results in this new table.

${s("/static/img/docs/transformations/join-fields-after-7-0.png",r,"A table visualization showing results for multiple servers")}

#### Outer join (for SQL-like data)

A tabular outer join combining tables so that the result includes matched and unmatched rows from either or both tables.

| StudentID | Name      | Major            |
| --------- | --------- | ---------------- |
| 1         | John      | Computer Science |
| 2         | Emily     | Mathematics      |
| 3         | Michael   | Physics          |
| 4         | Jennifer  | Chemistry        |

Can now be joined with:

| StudentID | CourseID | Grade |
| --------- | -------- | ----- |
| 1         | CS101    | A     |
| 1         | CS102    | B     |
| 2         | MATH201  | A     |
| 3         | PHYS101  | B     |
| 5         | HIST101  | B     |

The result after applying the outer join transformation looks like the following:

| StudentID | Name     | Major            | CourseID | Grade |
| --------- | -------- | ---------------- | -------- | ----- |
| 1         | John     | Computer Science | CS101    | A     |
| 1         | John     | Computer Science | CS102    | B     |
| 2         | Emily    | Mathematics      | MATH201  | A     |
| 3         | Michael  | Physics          | PHYS101  | B     |
| 4         | Jennifer | Chemistry        | NULL     | NULL  |
| 5         | NULL     | NULL             | HIST101  | B     |

Combine and analyze data from various queries with table joining for a comprehensive view of your information.
  `}},joinByLabels:{name:"Join by labels",getHelperDocs:function(){return`
Use this transformation to join multiple results into a single table.

This is especially useful for converting multiple time series results into a single wide table with a shared **Label** field.

- **Join** - Select the label to join by between the labels available or common across all time series.
- **Value** - The name for the output result.

#### Example

##### Input

series1{what="Temp", cluster="A", job="J1"}

| Time | Value |
| ---- | ----- |
| 1    | 10    |
| 2    | 200   |

series2{what="Temp", cluster="B", job="J1"}

| Time | Value |
| ---- | ----- |
| 1    | 10    |
| 2    | 200   |

series3{what="Speed", cluster="B", job="J1"}

| Time | Value |
| ---- | ----- |
| 22   | 22    |
| 28   | 77    |

##### Config

value: "what"

##### Output

| cluster | job | Temp | Speed |
| ------- | --- | ---- | ----- |
| A       | J1  | 10   |       |
| A       | J1  | 200  |       |
| B       | J1  | 10   | 22    |
| B       | J1  | 200  | 77    |

Combine and organize time series data effectively with this transformation for comprehensive insights.
  `}},labelsToFields:{name:"Labels to fields",getHelperDocs:function(){return`
Use this transformation to convert time series results with labels or tags into a table, including each label's keys and values in the result. Display labels as either columns or row values for enhanced data visualization.

Given a query result of two time series:

- Series 1: labels Server=Server A, Datacenter=EU
- Series 2: labels Server=Server B, Datacenter=EU

In "Columns" mode, the result looks like this:

| Time                | Server   | Datacenter | Value |
| ------------------- | -------- | ---------- | ----- |
| 2020-07-07 11:34:20 | Server A | EU         | 1     |
| 2020-07-07 11:34:20 | Server B | EU         | 2     |

In "Rows" mode, the result has a table for each series and show each label value like this:

| label      | value    |
| ---------- | -------- |
| Server     | Server A |
| Datacenter | EU       |

| label      | value    |
| ---------- | -------- |
| Server     | Server B |
| Datacenter | EU       |

#### Value field name

If you selected Server as the **Value field name**, then you would get one field for every value of the Server label.

| Time                | Datacenter | Server A | Server B |
| ------------------- | ---------- | -------- | -------- |
| 2020-07-07 11:34:20 | EU         | 1        | 2        |

#### Merging behavior

The labels to fields transformer is internally two separate transformations. The first acts on single series and extracts labels to fields. The second is the [merge](#merge) transformation that joins all the results into a single table. The merge transformation tries to join on all matching fields. This merge step is required and cannot be turned off.

To illustrate this, here is an example where you have two queries that return time series with no overlapping labels.

- Series 1: labels Server=ServerA
- Series 2: labels Datacenter=EU

This will first result in these two tables:

| Time                | Server  | Value |
| ------------------- | ------- | ----- |
| 2020-07-07 11:34:20 | ServerA | 10    |

| Time                | Datacenter | Value |
| ------------------- | ---------- | ----- |
| 2020-07-07 11:34:20 | EU         | 20    |

After merge:

| Time                | Server  | Value | Datacenter |
| ------------------- | ------- | ----- | ---------- |
| 2020-07-07 11:34:20 | ServerA | 10    |            |
| 2020-07-07 11:34:20 |         | 20    | EU         |

Convert your time series data into a structured table format for a clearer and more organized representation.
  `}},limit:{name:"Limit",getHelperDocs:function(){return`
Use this transformation to restrict the number of rows displayed, providing a more focused view of your data. This is particularly useful when dealing with large datasets.

Below is an example illustrating the impact of the **Limit** transformation on a response from a data source:

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |
| 2020-07-07 10:31:22 | Temperature | 22    |
| 2020-07-07 09:30:57 | Humidity    | 33    |
| 2020-07-07 09:30:05 | Temperature | 19    |

Here is the result after adding a Limit transformation with a value of '3':

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |

This transformation helps you tailor the visual presentation of your data to focus on the most relevant information.
  `}},merge:{name:"Merge series/tables",getHelperDocs:function(){return`
Use this transformation to combine the results from multiple queries into a single result, which is particularly useful when using the table panel visualization. This transformation merges values into the same row if the shared fields contain the same data.

Here's an example illustrating the impact of the **Merge series/tables** transformation on two queries returning table data:

**Query A:**

| Time                | Job     | Uptime    |
| ------------------- | ------- | --------- |
| 2020-07-07 11:34:20 | node    | 25260122  |
| 2020-07-07 11:24:20 | postgre | 123001233 |

**Query B:**

| Time                | Job     | Errors |
| ------------------- | ------- | ------ |
| 2020-07-07 11:34:20 | node    | 15     |
| 2020-07-07 11:24:20 | postgre | 5      |

Here is the result after applying the Merge transformation.

| Time                | Job     | Errors | Uptime    |
| ------------------- | ------- | ------ | --------- |
| 2020-07-07 11:34:20 | node    | 15     | 25260122  |
| 2020-07-07 11:24:20 | postgre | 5      | 123001233 |

This transformation combines values from Query A and Query B into a unified table, enhancing the presentation of data for better insights.
  `},links:[{title:"Table panel",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/table/"}]},organize:{name:"Organize fields by name",getHelperDocs:function(){return`
Use this transformation to provide the flexibility to rename, reorder, or hide fields returned by a single query in your panel. This transformation is applicable only to panels with a single query. If your panel has multiple queries, consider using an "Outer join" transformation or removing extra queries.

#### Transforming fields

Grafana displays a list of fields returned by the query, allowing you to perform the following actions:

- **Change field order** - Hover over a field, and when your cursor turns into a hand, drag the field to its new position.
- **Hide or show a field** - Use the eye icon next to the field name to toggle the visibility of a specific field.
- **Rename fields** - Type a new name in the "Rename <field>" box to customize field names.

#### Example:

##### Original Query Result

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |

##### After Applying Field Overrides

| Time                | Sensor      | Reading |
| ------------------- | ----------- | ------- |
| 2020-07-07 11:34:20 | Temperature | 25      |
| 2020-07-07 11:34:20 | Humidity    | 22      |
| 2020-07-07 10:32:20 | Humidity    | 29      |

This transformation lets you to tailor the display of query results, ensuring a clear and insightful representation of your data in Grafana.
  `}},partitionByValues:{name:"Partition by values",getHelperDocs:function(){return`
Use this transformation to streamline the process of graphing multiple series without the need for multiple queries with different 'WHERE' clauses.

This is particularly useful when dealing with a metrics SQL table, as illustrated below:

| Time                | Region | Value |
| ------------------- | ------ | ----- |
| 2022-10-20 12:00:00 | US     | 1520  |
| 2022-10-20 12:00:00 | EU     | 2936  |
| 2022-10-20 01:00:00 | US     | 1327  |
| 2022-10-20 01:00:00 | EU     | 912   |

With the **Partition by values** transformation, you can issue a single query and split the results by unique values in one or more columns (fields) of your choosing. The following example uses 'Region':

'SELECT Time, Region, Value FROM metrics WHERE Time > "2022-10-20"'

| Time                | Region | Value |
| ------------------- | ------ | ----- |
| 2022-10-20 12:00:00 | US     | 1520  |
| 2022-10-20 01:00:00 | US     | 1327  |

| Time                | Region | Value |
| ------------------- | ------ | ----- |
| 2022-10-20 12:00:00 | EU     | 2936  |
| 2022-10-20 01:00:00 | EU     | 912   |

This transformation simplifies the process and enhances the flexibility of visualizing multiple series within the same time series visualization.
  `}},prepareTimeSeries:{name:"Prepare time series",getHelperDocs:function(){return`
Use this transformation to address issues when a data source returns time series data in a format that isn't compatible with the desired visualization. This transformation allows you to convert time series data between wide and long formats, providing flexibility in data frame structures.

#### Available options

##### Multi-frame time series

Use this option to transform the time series data frame from the wide format to the long format. This is particularly helpful when your data source delivers time series information in a format that needs to be reshaped for optimal compatibility with your visualization.

**Example: Converting from wide to long format**

| Timestamp           | Value1 | Value2 |
|---------------------|--------|--------|
| 2023-01-01 00:00:00 | 10     | 20     |
| 2023-01-01 01:00:00 | 15     | 25     |

**Transformed to:**

| Timestamp           | Variable | Value |
|---------------------|----------|-------|
| 2023-01-01 00:00:00 | Value1   | 10    |
| 2023-01-01 00:00:00 | Value2   | 20    |
| 2023-01-01 01:00:00 | Value1   | 15    |
| 2023-01-01 01:00:00 | Value2   | 25    |


##### Wide time series

Select this option to transform the time series data frame from the long format to the wide format. If your data source returns time series data in a long format and your visualization requires a wide format, this transformation simplifies the process.

**Example: Converting from long to wide format**

| Timestamp           | Variable | Value |
|---------------------|----------|-------|
| 2023-01-01 00:00:00 | Value1   | 10    |
| 2023-01-01 00:00:00 | Value2   | 20    |
| 2023-01-01 01:00:00 | Value1   | 15    |
| 2023-01-01 01:00:00 | Value2   | 25    |

**Transformed to:**

| Timestamp           | Value1 | Value2 |
|---------------------|--------|--------|
| 2023-01-01 00:00:00 | 10     | 20     |
| 2023-01-01 01:00:00 | 15     | 25     |

> **Note:** This transformation is available in Grafana 7.5.10+ and Grafana 8.0.6+.
  `},links:[{title:"Data frames",url:"https://grafana.com/docs/grafana/latest/developers/plugins/introduction-to-plugin-development/data-frames/"}]},reduce:{name:"Reduce",getHelperDocs:function(){return`
Use this transformation to apply a calculation to each field in the data frame and return a single value. This transformation is particularly useful for consolidating multiple time series data into a more compact, summarized format. Time fields are removed when applying this transformation.

Consider the input:

**Query A:**

| Time                | Temp | Uptime  |
| ------------------- | ---- | ------- |
| 2020-07-07 11:34:20 | 12.3 | 256122  |
| 2020-07-07 11:24:20 | 15.4 | 1230233 |

**Query B:**

| Time                | AQI | Errors |
| ------------------- | --- | ------ |
| 2020-07-07 11:34:20 | 6.5 | 15     |
| 2020-07-07 11:24:20 | 3.2 | 5      |

The reduce transformer has two modes:

- **Series to rows** - Creates a row for each field and a column for each calculation.
- **Reduce fields** - Keeps the existing frame structure, but collapses each field into a single value.

For example, if you used the **First** and **Last** calculation with a **Series to rows** transformation, then
the result would be:

| Field  | First  | Last    |
| ------ | ------ | ------- |
| Temp   | 12.3   | 15.4    |
| Uptime | 256122 | 1230233 |
| AQI    | 6.5    | 3.2     |
| Errors | 15     | 5       |

The **Reduce fields** with the **Last** calculation,
results in two frames, each with one row:

**Query A:**

| Temp | Uptime  |
| ---- | ------- |
| 15.4 | 1230233 |

**Query B:**

| AQI | Errors |
| --- | ------ |
| 3.2 | 5      |

This flexible transformation simplifies the process of consolidating and summarizing data from multiple time series into a more manageable and organized format.
  `}},renameByRegex:{name:"Rename by regex",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to rename parts of the query results using a regular expression and replacement pattern.

You can specify a regular expression, which is only applied to matches, along with a replacement pattern that support back references. For example, let's imagine you're visualizing CPU usage per host and you want to remove the domain name. You could set the regex to '/^([^.]+).*/' and the replacement pattern to '$1', 'web-01.example.com' would become 'web-01'.

> **Note:** The Rename by regex transformation was improved in Grafana v9.0.0 to allow global patterns of the form '/<stringToReplace>/g'. Depending on the regex match used, this may cause some transformations to behave slightly differently. You can guarantee the same behavior as before by wrapping the match string in forward slashes '(/)', e.g. '(.*)' would become '/(.*)/'.

In the following example, we are stripping the 'A-' prefix from field names. In the before image, you can see everything is prefixed with 'A-':

${s("/media/docs/grafana/panels-visualizations/screenshot-rename-by-regex-before-v11.0.png",r,"A time series with full series names")}

With the transformation applied, you can see we are left with just the remainder of the string.

${s("/media/docs/grafana/panels-visualizations/screenshot-rename-by-regex-after-v11.0.png",r,"A time series with shortened series names")}

This transformation lets you to tailor your data to meet your visualization needs, making your dashboards more informative and user-friendly.
  `}},rowsToFields:{name:"Rows to fields",getHelperDocs:function(){return`
Use this transformation to convert rows into separate fields. This can be useful because fields can be styled and configured individually. It can also use additional fields as sources for dynamic field configuration or map them to field labels. The additional labels can then be used to define better display names for the resulting fields.

This transformation includes a field table which lists all fields in the data returned by the configuration query. This table gives you control over what field should be mapped to each configuration property (the **Use as** option). You can also choose which value to select if there are multiple rows in the returned data.

This transformation requires:

- One field to use as the source of field names.

  By default, the transform uses the first string field as the source. You can override this default setting by selecting **Field name** in the **Use as** column for the field you want to use instead.

- One field to use as the source of values.

  By default, the transform uses the first number field as the source. But you can override this default setting by selecting **Field value** in the **Use as** column for the field you want to use instead.

Useful when visualizing data in:

- Gauge
- Stat
- Pie chart

#### Map extra fields to labels

If a field does not map to config property Grafana will automatically use it as source for a label on the output field-

**Example:**

| Name    | DataCenter | Value |
| ------- | ---------- | ----- |
| ServerA | US         | 100   |
| ServerB | EU         | 200   |

**Output:**

| ServerA (labels: DataCenter: US) | ServerB (labels: DataCenter: EU) |
| -------------------------------- | -------------------------------- |
| 10                               | 20                               |

The extra labels can now be used in the field display name provide more complete field names.

If you want to extract config from one query and apply it to another you should use the config from query results transformation.

#### Example

**Input:**

| Name    | Value | Max |
| ------- | ----- | --- |
| ServerA | 10    | 100 |
| ServerB | 20    | 200 |
| ServerC | 30    | 300 |

**Output:**

| ServerA (config: max=100) | ServerB (config: max=200) | ServerC (config: max=300) |
| ------------------------- | ------------------------- | ------------------------- |
| 10                        | 20                        | 30                        |

As you can see each row in the source data becomes a separate field. Each field now also has a max config option set. Options like **Min**, **Max**, **Unit** and **Thresholds** are all part of field configuration and if set like this will be used by the visualization instead of any options manually configured in the panel editor options pane.

This transformation enables the conversion of rows into individual fields, facilitates dynamic field configuration, and maps additional fields to labels.
  `}},seriesToRows:{name:"Series to rows",getHelperDocs:function(){return`
Use this transformation to combine the result from multiple time series data queries into one single result. This is helpful when using the table panel visualization.

The result from this transformation will contain three columns: Time, Metric, and Value. The Metric column is added so you easily can see from which query the metric originates from. Customize this value by defining Label on the source query.

In the example below, we have two queries returning time series data. It is visualized as two separate tables before applying the transformation.

**Query A:**

| Time                | Temperature |
| ------------------- | ----------- |
| 2020-07-07 11:34:20 | 25          |
| 2020-07-07 10:31:22 | 22          |
| 2020-07-07 09:30:05 | 19          |

**Query B:**

| Time                | Humidity |
| ------------------- | -------- |
| 2020-07-07 11:34:20 | 24       |
| 2020-07-07 10:32:20 | 29       |
| 2020-07-07 09:30:57 | 33       |

Here is the result after applying the Series to rows transformation.

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |
| 2020-07-07 10:31:22 | Temperature | 22    |
| 2020-07-07 09:30:57 | Humidity    | 33    |
| 2020-07-07 09:30:05 | Temperature | 19    |

This transformation facilitates the consolidation of results from multiple time series queries, providing a streamlined and unified dataset for efficient analysis and visualization in a tabular format.

> **Note:** This transformation is available in Grafana 7.1+.
  `}},sortBy:{name:"Sort by",getHelperDocs:function(){return`
Use this transformation to sort each frame within a query result based on a specified field, making your data easier to understand and analyze. By configuring the desired field for sorting, you can control the order in which the data is presented in the table or visualization.

Use the **Reverse** switch to inversely order the values within the specified field. This functionality is particularly useful when you want to quickly toggle between ascending and descending order to suit your analytical needs.

For example, in a scenario where time-series data is retrieved from a data source, the **Sort by** transformation can be applied to arrange the data frames based on the timestamp, either in ascending or descending order, depending on the analytical requirements. This capability ensures that you can easily navigate and interpret time-series data, gaining valuable insights from the organized and visually coherent presentation.
  `}},spatial:{name:"Spatial",getHelperDocs:function(){return`
Use this transformation to apply spatial operations to query results.

- **Action** - Select an action:
  - **Prepare spatial field** - Set a geometry field based on the results of other fields.
    - **Location mode** - Select a location mode (these options are shared by the **Calculate value** and **Transform** modes):
      - **Auto** - Automatically identify location data based on default field names.
      - **Coords** - Specify latitude and longitude fields.
      - **Geohash** - Specify a geohash field.
      - **Lookup** - Specify Gazetteer location fields.
  - **Calculate value** - Use the geometry to define a new field (heading/distance/area).
    - **Function** - Choose a mathematical operation to apply to the geometry:
      - **Heading** - Calculate the heading (direction) between two points.
      - **Area** - Calculate the area enclosed by a polygon defined by the geometry.
      - **Distance** - Calculate the distance between two points.
  - **Transform** - Apply spatial operations to the geometry.
    - **Operation** - Choose an operation to apply to the geometry:
      - **As line** - Create a single line feature with a vertex at each row.
      - **Line builder** - Create a line between two points.

This transformation allows you to manipulate and analyze geospatial data, enabling operations such as creating lines between points, calculating spatial properties, and more.
  `}},timeSeriesTable:{name:"Time series to table transform",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to convert time series results into a table, transforming a time series data frame into a **Trend** field which can then be used with the [sparkline cell type][]. If there are multiple time series queries, each will result in a separate table data frame. These can be joined using join or merge transforms to produce a single table with multiple sparklines per row.

${s("/static/img/docs/transformations/table-sparklines.png",r,"A table panel showing multiple values and their corresponding sparklines.")}

For each generated **Trend** field value, a calculation function can be selected. This value is displayed next to the sparkline and will be used for sorting table rows.

${s("/static/img/docs/transformations/timeseries-table-select-stat.png",r,"A select box showing available statistics that can be calculated.")}


> **Note:** This transformation is available in Grafana 9.5+ as an opt-in beta feature. Modify the Grafana [configuration file][] to use it.
  `},links:[{title:"sparkline cell type",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/table/#sparkline"},{title:"configuration file",url:"https://grafana.com/docs/grafana/latest/setup-grafana/configure-grafana/"}]},regression:{name:"Regression analysis",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to create a new data frame containing values predicted by a statistical model. This is useful for finding a trend in chaotic data. It works by fitting a mathematical function to the data, using either linear or polynomial regression. The data frame can then be used in a visualization to display a trendline.

There are two different models:

- **Linear regression** - Fits a linear function to the data.
${s("/static/img/docs/transformations/linear-regression.png",r,"A time series visualization with a straight line representing the linear function")}
- **Polynomial regression** - Fits a polynomial function to the data.
${s("/static/img/docs/transformations/polynomial-regression.png",r,"A time series visualization with a curved line representing the polynomial function")}

> **Note:** This transformation is currently in public preview. Grafana Labs offers limited support, and breaking changes might occur prior to the feature being made generally available. Enable the \`regressionTransformation\` feature toggle in Grafana to use this feature. Contact Grafana Support to enable this feature in Grafana Cloud.
  `}}};function i(){return`
  Go to the <a href="https://grafana.com/docs/grafana/latest/panels/transformations/?utm_source=grafana" target="_blank" rel="noreferrer">
  transformation documentation
  </a> for more general documentation.
  `}function s(r,f,a){return f==="shortcodeFigure"?`{{< figure src="${r}" class="docs-image--no-shadow" max-width= "1100px" alt="${a}" >}}`:`![${a}](https://grafana.com${r})`}},9581:(G,O,e)=>{"use strict";e.d(O,{YD:()=>s,dy:()=>n,kD:()=>i});var t=e(52622),n=(f=>(f.Prepare="prepare",f.Calculate="calculate",f.Modify="modify",f))(n||{}),i=(f=>(f.Heading="heading",f.Distance="distance",f.Area="area",f))(i||{}),s=(f=>(f.AsLine="asLine",f.LineBuilder="lineBuilder",f))(s||{});const r={action:"prepare",source:{mode:t.aG.Auto}}},78134:(G,O,e)=>{"use strict";e.d(O,{EX:()=>h,pp:()=>l,tt:()=>c});var t=e(70915),n=e(11217),i=e(44294),s=e(22796),r=e(52490),f=e(11261),a=e(9581);function c(p){const m=[];for(const y of p.values)y&&m.push(h(y));return new n.A(m)}function o(p){const m=new Array(p.length);if(p.length>1){let y=g(p[0]);for(let d=1;d<p.length;d++){let v=g(p[d]);if(y&&v){let u=Math.atan2(v[0]-y[0],v[1]-y[1])*180/Math.PI;u<0&&(u+=360),m[d-1]=m[d]=u}}}else m.fill(0);return m}function h(p){return p instanceof i.A?p.getCoordinates():(0,t.q1)(p.getExtent())}function g(p){if(p)return(0,s.WP)(h(p))}function l(p,m){const y=p.values,d=new Array(p.values.length),v=m.calc??a.kD.Heading,u=m.field??v;switch(v){case a.kD.Area:{for(let D=0;D<y.length;D++){const P=y[D];P&&(d[D]=(0,r.UG)(P))}return{name:u,type:f.PU.number,config:{unit:"areaM2"},values:d}}case a.kD.Distance:{for(let D=0;D<y.length;D++){const P=y[D];P&&(d[D]=(0,r.R3)(P))}return{name:u,type:f.PU.number,config:{unit:"lengthm"},values:d}}case a.kD.Heading:default:return{name:u,type:f.PU.number,config:{unit:"degree"},values:o(y)}}}},88841:(G,O,e)=>{"use strict";e.d(O,{y:()=>d});var t=e(74848),n=e(32196),i=e(34743),s=e(36376),r=e(7315),f=e(96540),a=e(40845),c=e(17464),o=e(40276),h=e(72093),g=e(10354),l=e(43538);const p=(u,D)=>u-D*Math.floor(u/D),m=8,y=(u,D)=>({suggestionsWrapper:(0,n.css)({boxShadow:u.shadows.z2}),errorTooltip:(0,n.css)({position:"absolute",top:D+m+"px",zIndex:u.zIndex.tooltip}),inputWrapper:(0,n.css)({position:"relative"})}),d=({value:u="",onChange:D,suggestions:P,placeholder:x,error:E,invalid:C})=>{const[M,S]=(0,f.useState)(!1),[I,T]=(0,f.useState)(0),[b,R]=(0,f.useState)(u.toString()),[A,L]=(0,f.useState)(0),[U,W]=(0,f.useState)(0),[w,N]=(0,f.useState)(0),B=(0,a.$j)(),V=y(B,U),K=(0,f.useRef)(),H=[(0,i.UU)({fallbackAxisSideDirection:"start",crossAxis:!1,boundary:document.body}),(0,i.BN)()],{refs:X,floatingStyles:k}=(0,s.we)({open:M,placement:"bottom-start",onOpenChange:S,middleware:H,whileElementsMounted:r.ll,strategy:"fixed"}),Y=(0,f.useCallback)(oe=>{X.setReference(oe),K.current=oe},[X]),Z=(0,f.useRef)(null);(0,f.useEffect)(()=>{L(v(Z.current,I))},[I]);const se=f.useCallback((oe,z=K.current)=>{const te=z.selectionStart,le=z.value;le[w-1]==="$"?z.value=le.slice(0,w)+oe.value+le.slice(te):z.value=le.slice(0,w)+"$"+oe.value+le.slice(te),R(z.value),S(!1),T(0),D(z.value)},[D,w]),j=f.useCallback(oe=>{if(!M){if(oe.key==="$"||oe.key===" "&&oe.ctrlKey){N(K.current.selectionStart||0),S(!0);return}return}switch(oe.key){case"Backspace":case"Escape":case"ArrowLeft":case"ArrowRight":return S(!1),T(0);case"Enter":return oe.preventDefault(),se(P[I]);case"ArrowDown":case"ArrowUp":oe.preventDefault();const z=oe.key==="ArrowDown"?1:-1;return T(te=>p(te+z,P.length));default:return}},[M,P,I,se]),q=f.useCallback(oe=>{R(oe.currentTarget.value)},[]),ne=f.useCallback(oe=>{D(oe.currentTarget.value)},[D]);return(0,f.useEffect)(()=>{W(K.current.clientHeight)},[]),(0,t.jsxs)("div",{className:V.inputWrapper,children:[M&&(0,t.jsx)(c.ZL,{children:(0,t.jsx)("div",{ref:X.setFloating,style:k,className:V.suggestionsWrapper,children:(0,t.jsx)(o.E,{scrollTop:A,autoHeightMax:"300px",setScrollTop:({scrollTop:oe})=>L(oe),children:(0,t.jsx)(l.k,{activeRef:Z,suggestions:P,onSuggestionSelect:se,onClose:()=>S(!1),activeIndex:I})})})}),C&&E&&(0,t.jsx)("div",{className:V.errorTooltip,children:(0,t.jsx)(h.P,{children:E})}),(0,t.jsx)(g.p,{placeholder:x,invalid:C,ref:Y,value:b,onChange:q,onBlur:ne,onKeyDown:j})]})};d.displayName="SuggestionsInput";function v(u,D){return(u?.clientHeight??0)*D}},94397:(G,O,e)=>{"use strict";e.d(O,{N_:()=>c,ZI:()=>r,aG:()=>f,eJ:()=>a,qt:()=>o});var t=e(96540),n=e(28240),i=e(91410),s=e(32264);function r(h){return(0,t.useMemo)(()=>Array.isArray(h)?Object.keys(h.reduce((g,l)=>!l||!Array.isArray(l.fields)?g:l.fields.reduce((p,m)=>{const y=(0,n.Ct)(m,l,h);return p[y]=!0,p},g),{})):[],[h])}function f(h){const g=new Set;for(const l of h)for(const p of l.fields)if(p.labels)for(const m of Object.keys(p.labels))g.add(m);return g}const a={combine:"Combine",calculateNewFields:"Calculate new fields",createNewVisualization:"Create new visualization",filter:"Filter",performSpatialOperations:"Perform spatial operations",reformat:"Reformat",reorderAndRename:"Reorder and rename"},c=h=>!!(typeof h=="number"||!Number.isNaN(Number(h))||/^\$[A-Za-z0-9_]+$/.test(h)&&s.$.featureToggles.transformationsVariableSupport);function o(h){const g=[];h&&(g.push({label:"Browser",value:"browser"}),g.push({label:"UTC",value:"utc"}));const l=(0,i.P3)();for(const p of l)g.push({label:p,value:p});return g}},87617:(G,O,e)=>{"use strict";e.d(O,{$u:()=>g,Ay:()=>y,Cj:()=>c,EC:()=>h,Y_:()=>a,dJ:()=>l,g4:()=>o,jE:()=>p,t_:()=>r});var t=e(65307),n=e(2913);const i={users:[],searchQuery:"",page:0,perPage:30,totalPages:1,externalUserMngInfo:n.Ay.externalUserMngInfo,externalUserMngLinkName:n.Ay.externalUserMngLinkName,externalUserMngLinkUrl:n.Ay.externalUserMngLinkUrl,isLoading:!1,rolesLoading:!1},s=(0,t.Z0)({name:"users",initialState:i,reducers:{usersLoaded:(d,v)=>{const{totalCount:u,perPage:D,page:P,orgUsers:x}=v.payload,E=Math.ceil(u/D);return{...d,isLoading:!0,users:x,perPage:D,page:P,totalPages:E}},searchQueryChanged:(d,v)=>({...d,searchQuery:v.payload,page:i.page}),setUsersSearchPage:(d,v)=>({...d,page:v.payload}),pageChanged:(d,v)=>({...d,page:v.payload}),sortChanged:(d,v)=>({...d,sort:v.payload}),usersFetchBegin:d=>({...d,isLoading:!0}),usersFetchEnd:d=>({...d,isLoading:!1}),rolesFetchBegin:d=>({...d,rolesLoading:!0}),rolesFetchEnd:d=>({...d,rolesLoading:!1})}}),{searchQueryChanged:r,setUsersSearchPage:f,usersLoaded:a,usersFetchBegin:c,usersFetchEnd:o,pageChanged:h,sortChanged:g,rolesFetchBegin:l,rolesFetchEnd:p}=s.actions,y={users:s.reducer}},20601:(G,O,e)=>{"use strict";e.d(O,{B:()=>n});var t=e(83077);const n=new t.O},26260:(G,O,e)=>{"use strict";e.d(O,{$u:()=>m,D4:()=>v,Iv:()=>u,U2:()=>d,VT:()=>y,z_:()=>p});var t=e(2543),n=e.n(t),i=e(31193),s=e(3843),r=e(24240),f=e(72401),a=e(48594),c=e(87421),o=e(56968),h=e(75096),g=e(53699);const l="Filters",p=x=>async(E,C)=>{let M=P(x,C());if(!M&&(E(D(x)),M=P(x,C()),!M))return;const S=M.filters.findIndex(T=>T.key===x.key&&T.value===x.value);if(S===-1){const{value:T,key:b,operator:R}=x,A={value:T,key:b,operator:R};return await E(d((0,h.jX)(M),A))}const I={...M.filters[S],operator:x.operator};return await E(m((0,h.jX)(M),{index:S,filter:I}))},m=(x,E)=>async(C,M)=>{const S=(0,c.dn)(x,M());C((0,a.kb)(x.rootStateKey,(0,g.E2)((0,h.qD)(S,E)))),await C((0,f.us)((0,h.jX)(S),!0))},y=(x,E)=>async(C,M)=>{const S=(0,c.dn)(x,M());C((0,a.kb)(x.rootStateKey,(0,g.D$)((0,h.qD)(S,E)))),await C((0,f.us)((0,h.jX)(S),!0))},d=(x,E)=>async(C,M)=>{const S=(0,c.dn)(x,M());C((0,a.kb)(x.rootStateKey,(0,g.xt)((0,h.qD)(S,E)))),await C((0,f.us)((0,h.jX)(S),!0))},v=(x,E)=>async(C,M)=>{const S=(0,c.dn)(x,M());C((0,a.kb)(x.rootStateKey,(0,g.qZ)((0,h.qD)(S,E)))),await C((0,f.us)((0,h.jX)(S),!0))},u=(x,E)=>async(C,M)=>{const S=(0,c.dn)(x,M());C((0,a.kb)(x.rootStateKey,(0,o.QP)((0,h.qD)(S,{propName:"datasource",propValue:E}))));const T=(await(0,i.tR)().get(E))?.getTagKeys?"Ad hoc filters are applied automatically to all queries that target this data source":"This data source does not support ad hoc filters yet.";C((0,a.kb)(x.rootStateKey,(0,s.BC)({infoText:T})))},D=x=>(E,C)=>{const M=(0,c.y7)(C()),S={...(0,t.cloneDeep)(g.MK),datasource:x.datasource,name:l,id:l,rootStateKey:M},I=!1,T=(0,c.hk)(M,C()),b={type:"adhoc",id:S.id,rootStateKey:M};E((0,a.kb)(M,(0,o.QV)((0,h.qD)(b,{global:I,model:S,index:T}))))},P=(x,E)=>{const C=(0,c.y7)(E),M=(0,c.nx)(C,E);let S;for(const I of Object.values(M.variables))if((0,r.EW)(I)&&I.datasource?.uid===x.datasource.uid){S=I;break}return S}},53699:(G,O,e)=>{"use strict";e.d(O,{AA:()=>g,D$:()=>c,E2:()=>o,MK:()=>r,qZ:()=>h,xt:()=>a});var t=e(65307),n=e(80484),i=e(87421),s=e(83370);const r={...n.Vg,type:"adhoc",datasource:null,filters:[]},f=(0,t.Z0)({name:"templating/adhoc",initialState:s.j,reducers:{filterAdded:(l,p)=>{const m=(0,i.Fs)(l,p.payload.id);m.type==="adhoc"&&m.filters.push(p.payload.data)},filterRemoved:(l,p)=>{const m=(0,i.Fs)(l,p.payload.id);if(m.type!=="adhoc")return;const y=p.payload.data;m.filters.splice(y,1)},filterUpdated:(l,p)=>{const m=(0,i.Fs)(l,p.payload.id);if(m.type!=="adhoc")return;const{filter:y,index:d}=p.payload.data;m.filters[d]=y},filtersRestored:(l,p)=>{const m=(0,i.Fs)(l,p.payload.id);m.type==="adhoc"&&(m.filters=p.payload.data)}}}),{filterAdded:a,filterRemoved:c,filterUpdated:o,filtersRestored:h}=f.actions,g=f.reducer},13344:(G,O,e)=>{"use strict";e.d(O,{Ek:()=>r,To:()=>i,Zm:()=>n,ou:()=>s,qF:()=>t,qz:()=>f});const t="00000000-0000-0000-0000-000000000000",n="All",i="$__all",s="None",r="",f="var-"},35589:(G,O,e)=>{"use strict";e.d(O,{c:()=>c,z:()=>o});var t=e(74848),n=e(92145),i=e(96540),s=e(13544),r=e(40845),f=e(21744),a=e(85140);const c="Grafana-LegacyVariableQueryEditor",o=({onChange:h,query:g})=>{const l=(0,r.of)(a.$),[p,m]=(0,i.useState)(g),y=u=>{m(u.currentTarget.value)},d=(0,i.useCallback)(u=>{h(u.currentTarget.value,u.currentTarget.value)},[h]),v=(0,n.Bi)();return(0,t.jsx)(f.f,{id:v,rows:2,value:p,onChange:y,onBlur:d,placeholder:"Metric name or tags query",required:!0,"data-testid":s.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsQueryInput,cols:52,className:l.textarea})};o.displayName=c},70766:(G,O,e)=>{"use strict";e.d(O,{y:()=>a});var t=e(74848),n=e(96540),i=e(72574),s=e(685),r=e(24240),f=e(35589);async function a(o,h=s.cS){if((0,r.zs)(o))return o.variables.editor;if((0,r.X3)(o)){const g=await h(o.meta);if(!g.components.QueryEditor)throw new Error("Missing QueryEditor in plugin definition.");return g.components.QueryEditor??null}return(0,r.Hf)(o)?c:(0,r.d5)(o)?(await h(o.meta)).components.VariableQueryEditor??f.z:null}function c({datasource:o,query:h,onChange:g}){const l=(0,n.useCallback)(p=>{g({refId:"StandardVariableQuery",query:p})},[g]);return(0,t.jsx)(f.z,{query:h.query,onChange:l,datasource:o,templateSrv:(0,i.w)()})}},3843:(G,O,e)=>{"use strict";e.d(O,{BC:()=>o,DW:()=>f,Eo:()=>g,FN:()=>r,NY:()=>h,T7:()=>c,nS:()=>n,sJ:()=>a,wf:()=>s,y8:()=>l});var t=e(65307);const n={id:"",isValid:!0,errors:{},name:"",extended:null},i=(0,t.Z0)({name:"templating/editor",initialState:n,reducers:{variableEditorMounted:(p,m)=>{p.name=m.payload.name,p.id=m.payload.id},variableEditorUnMounted:(p,m)=>n,changeVariableNameSucceeded:(p,m)=>{p.name=m.payload.data.newName,delete p.errors.name,p.isValid=Object.keys(p.errors).length===0},changeVariableNameFailed:(p,m)=>{p.name=m.payload.newName,p.errors.name=m.payload.errorText,p.isValid=Object.keys(p.errors).length===0},addVariableEditorError:(p,m)=>{p.errors[m.payload.errorProp]=m.payload.errorText,p.isValid=Object.keys(p.errors).length===0},removeVariableEditorError:(p,m)=>{delete p.errors[m.payload.errorProp],p.isValid=Object.keys(p.errors).length===0},changeVariableEditorExtended:(p,m)=>{p.extended={...p.extended,...m.payload}},cleanEditorState:()=>n}}),s=i.reducer,{changeVariableNameSucceeded:r,changeVariableNameFailed:f,variableEditorMounted:a,variableEditorUnMounted:c,changeVariableEditorExtended:o,addVariableEditorError:h,removeVariableEditorError:g,cleanEditorState:l}=i.actions},85830:(G,O,e)=>{"use strict";e.d(O,{M:()=>t});var t=(n=>(n[n.MaxSize=50]="MaxSize",n))(t||{})},25304:(G,O,e)=>{"use strict";e.d(O,{z:()=>s});var t=e(72574),n=e(20601),i=e(13344);function s(r){const f={},a=(0,t.w)().getVariables();for(let c=0;c<a.length;c++){const o=a[c],h=r&&r[o.name];o.skipUrlSync||(h?f[i.qz+o.name]=h.value:f[i.qz+o.name]=n.B.get(o.type).getValueForUrl(o))}return f}},24240:(G,O,e)=>{"use strict";e.d(O,{CH:()=>y,EW:()=>s,Hf:()=>g,P4:()=>i,SP:()=>a,VN:()=>m,VO:()=>r,X3:()=>p,d5:()=>h,iv:()=>f,m8:()=>c,zs:()=>l});var t=e(29505),n=e(35589);const i=d=>d.type==="query",s=d=>d.type==="adhoc",r=d=>d.type==="constant",f=d=>"multi"in d,a=d=>"options"in d,c=d=>"current"in d;function o(d){return d===null?!1:typeof d=="string"}const h=d=>!!d.metricFindQuery&&!d.variables,g=d=>{if(!d.variables||d.variables.getType()!==t.Qz.Standard)return!1;const v=d.variables;return"toDataQuery"in v&&!!v.toDataQuery},l=d=>{if(!d.variables||d.variables.getType()!==t.Qz.Custom)return!1;const v=d.variables;return"query"in v&&"editor"in v&&!!v.query&&!!v.editor},p=d=>d.variables?d.variables.getType()===t.Qz.Datasource:!1;function m(d,v){return d?d.displayName===n.c||h(v):!1}function y(d,v){return d?d.displayName!==n.c&&(p(v)||g(v)||l(v)):!1}},2223:(G,O,e)=>{"use strict";e.d(O,{i:()=>a});var t=e(74848),n=e(96540),i=e(37390);const s=({nodes:c,edges:o,direction:h,width:g,height:l,onDoubleClick:p})=>{const m=(0,n.useRef)(null),y=(0,n.useRef)(null),d=(0,n.useCallback)(v=>{p&&p(v.nodes[0])},[p]);return(0,n.useEffect)(()=>((async()=>{const u=await e.e(5083).then(e.t.bind(e,83416,23)),D={nodes:r(u,c),edges:f(u,o)},P={width:"100%",height:"100%",autoResize:!0,layout:{improvedLayout:!0,hierarchical:{enabled:!0,direction:h??"DU",sortMethod:"directed"}},interaction:{navigationButtons:!0,dragNodes:!1}};m.current=new u.Network(y.current,D,P),m.current?.on("doubleClick",d)})(),()=>{m.current&&m.current.off("doubleClick")}),[h,o,c,d]),(0,t.jsx)("div",{children:(0,t.jsx)("div",{ref:y,style:{width:g??"100%",height:l??"60vh"}})})};function r(c,o){const h=o.map(g=>({...g,shape:"box"}));return new c.DataSet(h)}function f(c,o){const h=o.map(g=>({...g,arrows:"to",dashes:!0}));return new c.DataSet(h)}function a({edges:c,nodes:o,show:h,title:g,children:l}){const[p,m]=(0,n.useState)(h),y=(0,n.useCallback)(()=>m(!0),[m]),d=(0,n.useCallback)(()=>m(!1),[m]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.a,{isOpen:p,title:g,icon:"info-circle",iconTooltip:"The graph can be moved, zoomed in, and zoomed out.",onClickBackdrop:d,onDismiss:d,children:(0,t.jsx)(s,{nodes:o,edges:c})}),l({showModal:y})]})}},27238:(G,O,e)=>{"use strict";e.d(O,{WT:()=>n,bX:()=>r,t4:()=>s});var t=e(65307);const n={usages:[],usagesNetwork:[]},i=(0,t.Z0)({name:"templating/inspect",initialState:n,reducers:{initInspect:(f,a)=>{const{usages:c,usagesNetwork:o}=a.payload;f.usages=c,f.usagesNetwork=o}}}),s=i.reducer,{initInspect:r}=i.actions},12846:(G,O,e)=>{"use strict";e.d(O,{qJ:()=>g,hI:()=>o,hM:()=>d,H7:()=>h,xU:()=>D,P5:()=>I,g0:()=>v,PK:()=>M,Ow:()=>E});var t=e(6709);function n(T,b){const R=new Set;for(const A of T)R.add(b(A));return R}var i=e(84423),s=e(87490),r=e(34214),f=e(20601),a=e(24240),c=e(75096);const o=T=>{const b=[];for(const R of T)b.push({id:R.id,label:`${R.id}`});return b},h=(T,b)=>T.filter(R=>b.some(A=>A.from===R.id||A.to===R.id)),g=T=>{const b=[];for(const R of T)for(const A of T){if(R===A)continue;f.B.get(R.type).dependsOn(R,A)&&b.push({from:R.id,to:A.id})}return b};function l(T){const b=(0,c.t4)(T);if(!b)return;const R=b.slice(1).find(A=>A!==void 0);if(!(R in{}))return R}const p=(T,b)=>{c.SY.lastIndex=0;const R=[],L=(0,s.MA)(b,2).match(c.SY);if(!L)return R;for(const U of L){if(!U||U.indexOf("$__")!==-1||U.indexOf("${__")!==-1||U.indexOf("$hashKey")!==-1)continue;const W=l(U);T.some(w=>w.id===W)||R.find(w=>w===W)||W&&R.push(W)}return R},m={alias:[/^m$/,/^measurement$/,/^col$/,/^tag_(\w+|\d+)$/],query:[/^timeFilter$/]},y=(T,b,R)=>{const A=Object.keys(b.value).reduce((U,W)=>{const w=b.value[W];if(!w||typeof w!="string")return U;const N=m[W]?m[W].find(V=>V.test(T)):void 0;let B=(0,c.wJ)(w,T);return W==="repeat"&&w===T&&(B=!0),!N&&B&&(U={...U,[W]:w}),U},{}),L=Object.keys(b.value).reduce((U,W)=>{const w=b.value[W];if(w&&typeof w=="object"&&Object.keys(w).length){let N=w.title||w.name||w.id||W;Array.isArray(b.value)&&b.key==="panels"&&(N=`${N}[${w.id}]`);const B=y(T,{key:W,value:w},{});Object.keys(B).length&&(U={...U,[N]:B})}return U},{});return(Object.keys(A).length||Object.keys(L).length)&&(R={...R,...A,...L}),R},d=(T,b)=>{if(!b)return{unUsed:[],usages:[]};const R=[];let A=[];const L=b.getSaveModelCloneOld();for(const U of T){const W=U.id,w=y(W,{key:"model",value:L},{});!Object.keys(w).length&&!(0,a.EW)(U)&&R.push(U),Object.keys(w).length&&A.push({variable:U,tree:w})}return{unUsed:R,usages:A}};async function v(T,b){return new Promise((R,A)=>{setTimeout(()=>{try{const L=u(T,b);R(E(L))}catch(L){A(L)}},200)})}function u(T,b){if(!b)return[];let R=[];const A=b.getSaveModelCloneOld(),L=p(T,A);for(const U of L){const W=y(U,{key:"model",value:A},{});if(Object.keys(W).length){const w={id:U,name:U};R.push({variable:w,tree:W})}}return R}function D(T,b,R){const A=n(b.descendants(T),U=>U.name);A.add(t.c.includeVars);for(const U of T)A.add(U);return P([...A],R)}function P(T,b){const R=[];for(const A of T)b[A]&&R.push(...b[A]);return new Set(R)}const x=(T,b)=>{const{id:R,value:A}=b,{nodes:L,edges:U}=T;if(A&&typeof A=="string"){const W=`${b.id}-${A}`;return L.push({id:W,label:A}),U.push({from:W,to:R}),T}if(A&&typeof A=="object"){const W=Object.keys(A);for(const w of W){const N=`${b.id}-${w}`;L.push({id:N,label:w}),U.push({from:N,to:R}),T=x(T,{id:N,value:A[w]})}return T}return T},E=T=>{const b=[];for(const R of T){const{variable:A,tree:L}=R,U={variable:A,nodes:[{id:"dashboard",label:"dashboard"}],edges:[],showGraph:!1};b.push(x(U,{id:"dashboard",value:L}))}return b},C=T=>Object.values(T).reduce((R,A)=>typeof A=="object"?R+C(A):R+1,0),M=(T,b)=>{const R=b.find(A=>A.variable.id===T);return R?C(R.tree):0};function S(T){const b=[];for(const R of T)b.push(R),R.panels?.length&&b.push(...S(R.panels.map(A=>new PanelModel(A))));return b}function I(T){const b={};for(const R of T){const A=(0,i.tw)(R),L=[...A.matchAll(/"repeat":"([^"]+)"/g)].map(w=>w[1]),U=A.match(c.SY)?.map(w=>l(w))??[],W=[...L,...U];for(const w of W)w in b?b[w].add(R.id):b[w]=new Set([R.id])}return b}},81515:(G,O,e)=>{"use strict";e.d(O,{E5:()=>h,Ez:()=>c,mn:()=>g});var t=e(65307),n=e(2543),i=e.n(n),s=e(12470),r=e(87421),f=e(83370),a=e(80484);const c={...a.Vg,type:"interval",auto_count:30,auto_min:"10s",options:[],auto:!1,query:"1m,10m,30m,1h,6h,12h,1d,7d,14d,30d",refresh:s.CO.onTimeRangeChanged,current:{}},o=(0,t.Z0)({name:"templating/interval",initialState:f.j,reducers:{createIntervalOptions:(l,p)=>{const m=(0,r.Fs)(l,p.payload.id);if(m.type!=="interval")return;const y=(0,n.map)(m.query.match(/(["'])(.*?)\1|\w+/g),d=>(d=d.replace(/["']+/g,""),{text:d.trim(),value:d.trim(),selected:!1}));m.auto&&y.length&&y[0].text!=="auto"&&y.unshift({text:"auto",value:"$__auto_interval_"+m.name,selected:!1}),m.options=y}}}),h=o.reducer,{createIntervalOptions:g}=o.actions},24300:(G,O,e)=>{"use strict";e.d(O,{jR:()=>I,Fu:()=>P,$z:()=>c,O$:()=>x,ho:()=>T,MO:()=>D,an:()=>E,U9:()=>u,fx:()=>M,qh:()=>S,S8:()=>C});var t=e(53076),n=e(65307),i=e(2543),s=e(92053);const r=(b,...R)=>R.reduce((A,L)=>L(A),b);var f=e(13344),a=e(24240);const c={id:"",highlightIndex:-1,queryValue:"",selectedValues:[],options:[],multi:!1},o=1e3,h=new t.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1}),g=b=>Array.isArray(b)?b.reduce((R,A)=>((0,i.isString)(A.value)&&(R[A.value]=A),R),{}):{},l=b=>{if(!Array.isArray(b.options))return b.options=[],b;const R=g(b.selectedValues);return b.selectedValues=Object.values(R),b.options=b.options.map(A=>{if(!(0,i.isString)(A.value))return A;const L=!!R[A.value];return A.selected===L?A:{...A,selected:L}}),b.options=p(b.options),b},p=b=>Array.isArray(b)?b.length<=o?b:b.slice(0,o):[],m=b=>{const{options:R,selectedValues:A}=b;return R.length===0||A.length>0||!R[0]||R[0].value!==f.To||(b.selectedValues=[{...R[0],selected:!0}]),b},y=b=>{const{selectedValues:R}=b;return R.length>1&&(b.selectedValues=R.filter(A=>A.value!==f.To)),b},d=b=>b.filter(R=>R.value!==f.To).map(R=>({...R,selected:!0})),v=(0,n.Z0)({name:"templating/optionsPicker",initialState:c,reducers:{showOptions:(b,R)=>{const{query:A,options:L}=R.payload;if(b.highlightIndex=-1,b.options=(0,i.cloneDeep)(L),b.id=R.payload.id,b.queryValue="",b.multi=!1,(0,a.iv)(R.payload)&&(b.multi=R.payload.multi??!1),(0,a.P4)(R.payload)){const{queryValue:U}=R.payload,W=(0,s.E)(A);b.queryValue=W&&U?U:""}return b.selectedValues=b.options.filter(U=>U.selected),r(b,m,l)},hideOptions:(b,R)=>({...c}),toggleOption:(b,R)=>{const{option:A,clearOthers:L,forceSelect:U}=R.payload,{multi:W,selectedValues:w}=b;if(A){const N=!w.find(B=>B.value===A.value&&B.text===A.text);if(A.value===f.To||!W||L)return N||U?b.selectedValues=[{...A,selected:!0}]:b.selectedValues=[],r(b,m,y,l);if(U||N)return b.selectedValues.push({...A,selected:!0}),r(b,m,y,l);b.selectedValues=w.filter(B=>B.value!==A.value&&B.text!==A.text)}else b.selectedValues=[];return r(b,m,y,l)},moveOptionsHighlight:(b,R)=>{let A=b.highlightIndex+R.payload;return A<0?A=-1:A>=b.options.length&&(A=b.options.length-1),{...b,highlightIndex:A}},toggleAllOptions:(b,R)=>{const A=b.selectedValues.find(U=>U.value===f.To),L=b.options.find(U=>U.value===f.To);return b.selectedValues.length>0&&L&&!A?(b.selectedValues=[],b.selectedValues.push({text:L.text??"All",value:L.value,selected:!0}),r(b,l)):A&&b.selectedValues.length===1?(b.selectedValues=d(b.options),r(b,l)):b.selectedValues.length>0&&!L?(b.selectedValues=[],r(b,l)):(b.selectedValues=d(b.options),r(b,l))},updateSearchQuery:(b,R)=>(b.queryValue=R.payload,b),updateOptionsAndFilter:(b,R)=>{const A=b.queryValue.trim();let L=[];if(A==="")L=R.payload;else{const U=R.payload.map(({text:B})=>Array.isArray(B)?B.toString():B),[W,w,N]=h.search(U,A,5);W?.length&&(w&&N?L=N.map(B=>R.payload[w.idx[B]]):L=W.map(B=>R.payload[B]),L.sort((B,V)=>(B.value===f.To?-1:0)-(V.value===f.To?-1:0)))}if(b.highlightIndex=0,A!==""){let U=L.findIndex(W=>W.value!==f.To);(U===-1||L[U].value!==A)&&(L.unshift({selected:!1,text:"> "+A,value:A}),b.highlightIndex=U===-1?0:U+1)}return b.options=L,r(b,m,l)},updateOptionsFromSearch:(b,R)=>(b.options=R.payload,b.highlightIndex=0,r(b,m,l)),cleanPickerState:()=>c}}),{toggleOption:u,showOptions:D,hideOptions:P,moveOptionsHighlight:x,toggleAllOptions:E,updateSearchQuery:C,updateOptionsAndFilter:M,updateOptionsFromSearch:S,cleanPickerState:I}=v.actions,T=v.reducer},86886:(G,O,e)=>{"use strict";e.d(O,{C:()=>t});const t=(s,r)=>s&&(r&&!Array.isArray(s.value)?{...s,value:i(s.value),text:i(s.text)}:!r&&Array.isArray(s.value)?{...s,value:n(s.value),text:n(s.text)}:s),n=s=>Array.isArray(s)?s.length>0?s[0]:"":s,i=s=>Array.isArray(s)?s:[s]},72401:(G,O,e)=>{"use strict";e.d(O,{Y7:()=>Xe,TI:()=>j,_q:()=>Se,RK:()=>je,t9:()=>ce,x7:()=>ie,Hn:()=>Be,mZ:()=>Je,kl:()=>re,us:()=>ee});var t=e(2543),n=e(12470),i=e(92041),s=e(39070),r=e(22391),f=e(12131),a=e(32264),c=e(82467),o=e(16233),h=e(74856),g=e(99140),l=e(3169),p=e(10096),m=e(27677),y=e(34525),d=e(31193),v=e(23989),u=e(20601),D=e(13344),P=e(3843),x=e(24240),E=e(12846),C=e(24300),M=e(86886),S=e(80484),I=e(75096),T=e(73134),b=e(28601),R=e(48594),A=e(84014);const L=($e,ve=-1,be=!1,he=!1)=>{const ye={};if(he){const Pe={...initialVariableModelState,id:"__dashboard",name:"__dashboard",type:"system",index:-3,skipUrlSync:!0,hide:VariableHide.hideVariable,current:{value:{name:"A dashboard title",uid:"An dashboard UID",toString:()=>"A dashboard title"}}},ge={...initialVariableModelState,id:"__org",name:"__org",type:"system",index:-2,skipUrlSync:!0,hide:VariableHide.hideVariable,current:{value:{name:"An org name",id:1,toString:()=>"1"}}},xe={...initialVariableModelState,id:"__user",name:"__user",type:"system",index:-1,skipUrlSync:!0,hide:VariableHide.hideVariable,current:{value:{login:"admin",id:1,email:"admin@test",toString:()=>"1"}}};ye[Pe.id]=Pe,ye[ge.id]=ge,ye[xe.id]=xe}for(let Pe=0;Pe<$e;Pe++)ye[Pe]=createQueryVariable({id:Pe.toString(),name:`Name-${Pe}`,label:`Label-${Pe}`,index:Pe});return be&&(ye[NEW_VARIABLE_ID]=createQueryVariable({id:NEW_VARIABLE_ID,name:`Name-${NEW_VARIABLE_ID}`,label:`Label-${NEW_VARIABLE_ID}`,index:$e})),ye},U=($e,ve={})=>{const be={id:"0",rootStateKey:"key",index:0,name:"0"};return{initialState:{0:{...{...$e.initialState,...be},...ve}}}},W=()=>combineReducers({dashboard:dashboardReducer,templating:keyedVariablesReducer}),w=()=>combineReducers({templating:keyedVariablesReducer});function N($e,ve){return{templating:{lastKey:$e,keys:{[$e]:{...getInitialTemplatingState(),...ve}}}}}function B($e,ve){return $e.find(he=>he.name===ve)}function V($e){return($e.type==="query"||$e.type==="datasource"||$e.type==="interval")&&$e.refresh===T.CO.onTimeRangeChanged}var K=e(87421),H=e(56968),X=e(85675),k=e(15120);const Y=($e,ve)=>(be,he)=>{let ye=0;const Pe=ve.templating.list;for(let xe=0;xe<Pe.length;xe++){const Ae=Z(Pe[xe]);Ae.rootStateKey=$e,u.B.getIfExists(Ae.type)&&be((0,R.kb)($e,(0,H.QV)((0,I.qD)(Ae,{global:!1,index:ye++,model:Ae}))))}(0,v.w)().updateTimeRange((0,h.jG)().timeRange());const ge=(0,K.SS)($e,he());for(const xe of ge)be((0,R.kb)($e,(0,H.wB)((0,I.qD)(xe))))};function Z($e){if(!(0,x.SP)($e))return $e;let ve=!1;for(const be of $e.options)if(be.selected=!1,Array.isArray($e.current.value))for(const he of $e.current.value)be.value===he&&(be.selected=ve=!0);else be.value===$e.current.value&&(be.selected=ve=!0);return!ve&&$e.options.length&&($e.options[0].selected=!0),$e}const se=($e,ve)=>be=>{const he={...S.Vg,id:"__dashboard",name:"__dashboard",type:"system",index:-3,skipUrlSync:!0,hide:n.zL.hideVariable,current:{value:{name:ve.title,uid:ve.uid,toString:()=>ve.title}}};be((0,R.kb)($e,(0,H.QV)((0,I.qD)(he,{global:he.global,index:he.index,model:he}))));const ye={...S.Vg,id:"__org",name:"__org",type:"system",index:-2,skipUrlSync:!0,hide:n.zL.hideVariable,current:{value:{name:o.TP.user.orgName,id:o.TP.user.orgId,toString:()=>o.TP.user.orgId.toString()}}};be((0,R.kb)($e,(0,H.QV)((0,I.qD)(ye,{global:ye.global,index:ye.index,model:ye}))));const Pe={...S.Vg,id:"__user",name:"__user",type:"system",index:-1,skipUrlSync:!0,hide:n.zL.hideVariable,current:{value:{login:o.TP.user.login,id:o.TP.user.id,email:o.TP.user.email,toString:()=>o.TP.user.id.toString()}}};be((0,R.kb)($e,(0,H.QV)((0,I.qD)(Pe,{global:Pe.global,index:Pe.index,model:Pe}))))},j=($e,ve)=>(be,he)=>{const{rootStateKey:ye}=$e,Pe=(0,K.dn)($e,he());if(!(0,x.iv)(Pe)||(0,i.R)(Pe.current))return;const ge=(0,M.C)(Pe.current,ve);be((0,R.kb)(ye,(0,H.QP)((0,I.qD)($e,{propName:"multi",propValue:ve})))),be((0,R.kb)(ye,(0,H.QP)((0,I.qD)($e,{propName:"current",propValue:ge}))))},q=async($e,ve)=>{if(!$e.rootStateKey)throw new Error(`rootStateKey not found for variable with id:${$e.id}`);if(ne($e,ve))throw new Error("Circular dependency in dashboard variables detected. Dashboard may not work as expected.");const be=oe($e,ve);z($e.rootStateKey,be,ve)&&await new Promise(he=>{const ye=g.M_.subscribe(()=>{if(!$e.rootStateKey)throw new Error(`rootStateKey not found for variable with id:${$e.id}`);z($e.rootStateKey,be,g.M_.getState())||(ye(),he())})})},ne=($e,ve,be=new Set)=>be.has($e.id)?!0:(be=new Set([...be,$e.id]),oe($e,ve).some(he=>ne(he,ve,be))),oe=($e,ve)=>{if(!$e.rootStateKey)return[];const be=[];for(const he of(0,K.SS)($e.rootStateKey,ve))$e!==he&&u.B.getIfExists($e.type)&&u.B.get($e.type).dependsOn($e,he)&&be.push(he);return be},z=($e,ve,be)=>{if(ve.length===0)return!1;const he=(0,K.SS)($e,be);return ve.filter(Pe=>he.some(ge=>ge.id===Pe.id&&(ge.state===s.Gu.NotStarted||ge.state===s.Gu.Loading))).length>0},te=($e,ve)=>async(be,he)=>{const ye=(0,K.dn)($e,he());await q(ye,he());const Pe=ve[D.qz+ye.name];if(Pe!==void 0){const ge=(0,I.QT)(Pe);await u.B.get(ye.type).setValueFromUrl(ye,ge);return}if(ye.hasOwnProperty("refresh")){const ge=ye;if(ge.refresh===n.CO.onDashboardLoad||ge.refresh===n.CO.onTimeRangeChanged){await be(Je((0,I.jX)(ge)));return}}if(ye.type==="custom"){await be(Je((0,I.jX)(ye)));return}be(pt($e))},le=$e=>async(ve,be)=>{const he=f.Ny.getSearchObject(),ye=(0,K.SS)($e,be()).map(async Pe=>await ve(te((0,I.jX)(Pe),he)));await Promise.all(ye)},ie=($e,ve)=>async(be,he)=>{const ye=(0,I.QT)(ve),Pe=(0,K.dn)($e,he());(0,I.q$)(Pe)!==n.CO.never&&await be(Je((0,I.jX)(Pe)));const ge=(0,K.dn)((0,I.jX)(Pe),he());if(!(0,x.SP)(ge))return;if(!ge)throw new Error(`Couldn't find variable with name: ${Pe.name}`);let xe=ge.options.find(Ae=>Ae.text===ye||Ae.value===ye);if(!xe&&(0,x.iv)(ge)&&ge.allValue&&ye===ge.allValue&&(xe={text:D.Zm,value:D.To,selected:!1}),!xe){let Ae=ye;const Ee=ye;Array.isArray(ye)&&(Ae=ye.reduce((Ie,Qe)=>{const at=ge.options.find(ft=>ft.value===Qe);return at?[].concat(Ie,[at.text]):[].concat(Ie,[Qe])},[])),xe={text:Ae,value:Ee,selected:!1}}(0,x.iv)(ge)&&(xe=(0,M.C)({text:(0,t.castArray)(xe.text),value:(0,t.castArray)(xe.value),selected:!1},ge.multi)),await u.B.get(Pe.type).setValue(ge,xe)},ae=$e=>{let ve,be,he,ye;const Pe=[];for(ve=0;ve<$e.options.length;ve++)if(ye={...$e.options[ve]},ye.selected=!1,Array.isArray($e.current.value))for(be=0;be<$e.current.value.length;be++)he=$e.current.value[be],ye.value===he&&(ye.selected=!0,Pe.push(ye));else ye.value===$e.current.value&&(ye.selected=!0,Pe.push(ye));return Pe},re=($e,ve)=>(be,he)=>{const ye=(0,K.dn)($e,he());if(!(0,x.SP)(ye))return Promise.resolve();const Pe=ye.current||{},ge=u.B.get(ye.type).setValue;if(Array.isArray(Pe.value)){const Ie=ae(ye);if(Ie.length===0){const at=ye.options[0];return ge(ye,{value:typeof at.value=="string"?[at.value]:at.value,text:typeof at.text=="string"?[at.text]:at.text,selected:!0})}const Qe={value:Ie.map(at=>at.value),text:Ie.map(at=>at.text),selected:!0};return ge(ye,Qe)}let xe=null;const Ae=(0,I.Nz)(ye),Ee=(0,I.Lz)(ye);if(xe=ye.options?.find(Ie=>Ie.text===Ae||Ie.value===Ee),xe||ve&&(xe=ye.options?.find(Ie=>Ie.text===ve||Ie.value===ve),xe))return ge(ye,xe);if(ye.options){const Ie=ye.options[0];if(Ie)return ge(ye,Ie)}return Promise.resolve()},ce=($e,ve,be)=>async he=>{const{rootStateKey:ye}=$e;return he((0,R.kb)(ye,(0,H.dE)((0,I.qD)($e,{option:ve})))),await he(ee($e,be))},me=$e=>{const ve=new y.TS;return $e.forEach(be=>{ve.createNode(be.name)}),$e.forEach(be=>{$e.forEach(he=>{be!==he&&u.B.get(be.type).dependsOn(be,he)&&ve.link(be.name,he.name)})}),ve},ee=($e,ve,be=p.lE)=>async(he,ye)=>{const Pe=ye(),{rootStateKey:ge}=$e,xe=(0,K.dn)($e,Pe);if((0,K.nx)(ge,Pe).transaction.status===S.x8.Fetching)return(0,I.q$)(xe)===n.CO.never&&(await he(xt((0,I.jX)(xe))),he(pt($e))),Promise.resolve();const Ae=(0,K.SS)(ge,Pe),Ee=me(Ae),Ie=Pe.dashboard?.getModel()?.panels??[],Qe=(0,E.P5)(Ie),at=xe.type==="adhoc"?{refreshAll:!0,panelIds:[]}:{refreshAll:!1,panelIds:Array.from((0,E.xU)([xe.id],Ee,Qe)),variable:(0,K.dn)($e,Pe)},ft=Ee.getNode(xe.name);let ct=[];return ft&&(ct=ft.getOptimizedInputEdges().map(vt=>{const Pt=Ae.find(Vt=>Vt.name===vt.inputNode?.name);return Pt?he(Je((0,I.jX)(Pt))):Promise.resolve()})),Promise.all(ct).then(()=>{ve&&(be.publish(new S.og(at)),f.Ny.partial(Re(ge,ye)))})},de=($e,ve,be,he)=>(ve.includes($e.name)||ve.push($e.name),$e.outputEdges.forEach(ye=>{const Pe=ye.outputNode;if(Pe&&!ve.includes(Pe.name)){const ge=be.find(xe=>xe.name===Pe.name);ge&&ge.refresh===n.CO.onTimeRangeChanged&&he.indexOf(ge)===-1?(he.push(ge),ve.push(Pe.name)):de(Pe,ve,be,he)}}),he),De=($e,ve)=>$e.outputEdges.every(be=>{const he=be.outputNode;if(he){const ye=B(ve,he.name);if(ye&&ye.type==="query")return ye.refresh!==n.CO.onTimeRangeChanged}return!0}),fe=($e,ve)=>{const be=(0,K.SS)($e,ve),he=me(be),ye=[],Pe=[];return be.forEach(ge=>{const xe=he.getNode(ge.name);if(!ye.includes(ge.name)&&xe){const Ae=B(be,xe.name);if(!Ae)return;const Ee=V(Ae);Ee&&xe.outputEdges.length===0&&Pe.push(Ae),Ee&&Pe.includes(Ae)&&xe.outputEdges.length>0&&(Pe.push(Ae),de(xe,ye,be,Pe)),Ee&&xe.outputEdges.length>0&&De(xe,be)&&(Pe.includes(Ae)||Pe.push(Ae)),!Ee&&xe.outputEdges.length>0&&de(xe,ye,be,Pe)}}),Pe},Te=($e,ve)=>(0,K.SS)($e,ve).filter(ye=>"refresh"in ye&&"options"in ye?ye.refresh===n.CO.onTimeRangeChanged:!1),je=($e,ve,be={templateSrv:(0,v.w)(),events:p.lE})=>async(he,ye)=>{be.templateSrv.updateTimeRange(ve);let Pe=[];a.$.featureToggles.refactorVariablesTimeRange?Pe=fe($e,ye()):Pe=Te($e,ye());const ge=Pe.map(Ae=>Ae.id),xe=Pe.map(Ae=>he(He((0,I.jX)(Ae))));try{await Promise.all(xe),be.events.publish(new S.BS({variableIds:ge}))}catch(Ae){console.error(Ae),he((0,c.dx)(st("Template variable service failed",Ae)))}},He=$e=>async(ve,be)=>{const he=(0,K.dn)($e,be());if(!(0,x.SP)(he))return;const ye=he.options.slice();await ve(Je((0,I.jX)(he),!0));const Pe=(0,K.dn)($e,be());if(!(0,x.SP)(Pe))return;const ge=Pe.options;JSON.stringify(ye)!==JSON.stringify(ge)&&be().dashboard.getModel()?.templateVariableValueUpdated()},Be=($e,ve,be=p.lE)=>async(he,ye)=>{const Pe=[],ge=ye().dashboard.getModel(),xe=(0,K.SS)($e,ye());for(const at of xe){const ft=D.qz+at.name;if(!ve.hasOwnProperty(ft)||!Ne(at,ve[ft].value))continue;let ct=ve[ft].value;if(ve[ft].removed){const Pt=ge?.templating.list.find(Vt=>Vt.name===at.name);Pt&&(0,x.m8)(Pt)&&(ct=Pt.current.value),Pt&&Pt.type==="constant"&&(ct=Pt.query)}const vt=u.B.get(at.type).setValueFromUrl(at,ct);Pe.push(vt)}const Ae=xe.filter(at=>{const ft=D.qz+at.name;return ve.hasOwnProperty(ft)&&Ne(at,ve[ft].value)&&at.type!=="adhoc"}),Ee=me(xe),Ie=(0,E.P5)(ge?.panels??[]),Qe=(0,E.xU)(Ae.map(at=>at.id),Ee,Ie);Pe.length&&(await Promise.all(Pe),be.publish(new S.eF({refreshAll:Qe.size===0,panelIds:Array.from(Qe)})))};function Ne($e,ve){const be=u.B.get($e.type).getValueForUrl($e);let he=(0,I.QT)(ve);return Array.isArray(be)&&!Array.isArray(he)&&(he=[he]),!(0,t.isEqual)(be,he)}const Re=($e,ve)=>{const be=f.Ny.getSearchObject(),he=Object.keys(be).filter(ye=>ye.indexOf(D.qz)===-1).reduce((ye,Pe)=>(ye[Pe]=be[Pe],ye),{});for(const ye of(0,K.SS)($e,ve())){if(ye.skipUrlSync)continue;const Pe=u.B.get(ye.type);he[D.qz+ye.name]=Pe.getValueForUrl(ye)}return he},Se=($e,ve)=>async(be,he)=>{try{const ye=(0,I.q4)($e),Pe=he(),ge=(0,K.Tk)(Pe);ge&&(0,K.nx)(ge,Pe).transaction.status===S.x8.Fetching&&be(Xe(ge)),be((0,R.kb)(ye,(0,X.kH)({uid:ye}))),be(se(ye,ve)),be(Y(ye,ve)),be(We(ye)),await be(le(ye)),be((0,R.kb)(ye,(0,X.$O)({uid:ye})))}catch(ye){be((0,c.dx)(st("Templating init failed",ye))),console.error(ye)}};function We($e,ve=d.tR){return(be,he)=>{const ye=(0,K.SS)($e,he());for(const Pe of ye){if(Pe.type!=="adhoc"&&Pe.type!=="query")continue;const{datasource:ge}=Pe;if((0,r.fN)(ge))continue;const xe=ve().getInstanceSettings(ge),Ae=xe?(0,r.p$)(xe):{uid:ge};be((0,R.kb)($e,(0,H.QP)((0,I.qD)(Pe,{propName:"datasource",propValue:Ae}))))}}}const Ke=$e=>ve=>{ve((0,R.kb)($e,(0,k.v)())),ve((0,R.kb)($e,(0,P.y8)())),ve((0,R.kb)($e,(0,C.jR)())),ve((0,R.kb)($e,(0,X.pu)()))},Xe=($e,ve={getBackendSrv:m.AI})=>be=>{ve.getBackendSrv().cancelAllInFlightRequests(),be(Ke($e))},Je=($e,ve=!1)=>async(be,he)=>{const{rootStateKey:ye}=$e;try{if(!(0,I.sN)(ye,he()))return;const Pe=(0,K.dn)($e,he());be((0,R.kb)(ye,(0,H.a7)((0,I.qD)(Pe)))),await be(xt((0,I.jX)(Pe))),await u.B.get(Pe.type).updateOptions(Pe),be(pt($e))}catch(Pe){if(be((0,R.kb)(ye,(0,H.Te)((0,I.qD)($e,{error:Pe})))),ve||(console.error(Pe),be((0,c.dx)(st("Error updating options:",Pe,$e)))),ve)throw Pe}},st=($e,ve,be)=>(0,l.gi)(`${be?`Templating [${be.id}]`:"Templating"}`,ve instanceof Error?`${$e} ${ve.message}`:`${$e}`),pt=$e=>(ve,be)=>{const{rootStateKey:he}=$e;if(!(0,I.sN)(he,be()))return;const ye=(0,K.dn)($e,be());ye.state!==s.Gu.Done&&ve((0,R.kb)($e.rootStateKey,(0,H.Pu)((0,I.qD)(ye))))};function xt($e,ve=d.tR){return async function(be,he){const{id:ye,rootStateKey:Pe}=$e;if(!(0,I.sN)(Pe,he()))return;const ge=(0,K.dn)($e,he());if(ge.type==="query")try{const xe=await ve().get(ge.datasource??"");if((0,x.d5)(xe)||!(0,x.Hf)(xe)||ot(ge.query))return;const Ae={refId:`${xe.name}-${ye}-Variable-Query`,query:ge.query};be((0,R.kb)(Pe,(0,H.QP)((0,I.qD)($e,{propName:"query",propValue:Ae}))))}catch(xe){be((0,c.dx)(st("Failed to upgrade legacy queries",xe))),console.error(xe)}}}function ot($e){return(0,s.Gv)($e)&&"refId"in $e&&typeof $e.refId=="string"}},48594:(G,O,e)=>{"use strict";e.d(O,{Ay:()=>o,L1:()=>s,kb:()=>f});var t=e(75096),n=e(84014),i=e(85675);const s={keys:{}},r=h=>({type:`templating/keyed/${h.action.type.replace(/^templating\//,"")}`,payload:h});function f(h,g){const l=(0,t.q4)(h);return r({key:l,action:g})}const a=h=>typeof h.type=="string"&&h.type.startsWith("templating/keyed")&&"payload"in h&&typeof h.payload.key=="string";function c(h=s,g){if(a(g)){const{key:l,action:p}=g.payload,m=(0,t.q4)(l),y=i.kH.match(p)?m:h.lastKey,d=(0,n.H)(),v=h.keys[m],u=d(v,p);return{...h,lastKey:y,keys:{...h.keys,[m]:u}}}return h}const o={templating:c}},84014:(G,O,e)=>{"use strict";e.d(O,{H:()=>o,x:()=>h});var t=e(14644),n=e(3843),i=e(27238),s=e(24300),r=e(85675),f=e(83370),a=e(15120);let c;function o(){return c||(c=(0,t.combineReducers)({editor:n.wf,variables:a.Y,optionsPicker:s.ho,transaction:r.Dd,inspect:i.t4})),c}function h(){return{editor:n.nS,variables:f.j,optionsPicker:s.$z,transaction:r.i3,inspect:i.WT}}},87421:(G,O,e)=>{"use strict";e.d(O,{Fs:()=>P,SS:()=>c,Tk:()=>y,UN:()=>u,_2:()=>D,bZ:()=>v,dn:()=>r,hk:()=>l,nS:()=>g,nx:()=>a,pi:()=>h,wk:()=>p,y7:()=>d});var t=e(41811),n=e(99140),i=e(75096),s=e(84014);function r(x,E=(0,n.Gu)(),C=!0){const{id:M,rootStateKey:S}=x,T=a(S,E).variables[M];if(!T){if(C)throw new Error(`Couldn't find variable with id:${M}`);return}return T}function f(x,E,C=(0,n.Gu)()){return Object.values(a(E,C).variables).filter(x).sort((M,S)=>M.index-S.index)}function a(x,E=(0,n.Gu)()){return E.templating.keys[(0,i.q4)(x)]??(0,s.x)()}function c(x,E=(0,n.Gu)()){return f(o,x,E)}function o(x){return x.type!=="system"}const h=(0,t.A)((x,E)=>c(x,(0,n.Gu)())),g=(x,E)=>c(x,E);function l(x,E=(0,n.Gu)()){return p(Object.values(a(x,E).variables))}function p(x){const E=x.filter(o).sort((C,M)=>C.index-M.index);return E.length>0?E[E.length-1].index+1:0}function m(x,E=getState()){return a(x,E).transaction.isDirty}function y(x=(0,n.Gu)()){return x.templating?.lastKey}function d(x=(0,n.Gu)()){if(!x.templating?.lastKey)throw new Error("Accessing lastKey without initializing it variables");return x.templating.lastKey}function v(x,E=(0,n.Gu)()){const C=y(E);return C?f(x,C,E):[]}function u(x=(0,n.Gu)()){const E=y(x);return E?c(E,x):[]}function D(x,E=(0,n.Gu)()){const C=y(E);if(C)return r({id:x,rootStateKey:C,type:"query"},E,!1)}function P(x,E){return x[E]}},56968:(G,O,e)=>{"use strict";e.d(O,{Hr:()=>p,Pu:()=>E,QP:()=>y,QV:()=>m,Te:()=>C,a7:()=>x,dE:()=>u,hj:()=>d,l_:()=>D,qi:()=>l,ut:()=>v,wB:()=>P});var t=e(65307),n=e(2543),i=e.n(n),s=e(39070),r=e(20601),f=e(3843),a=e(24240),c=e(75096),o=e(87421),h=e(83370);const g=(0,t.Z0)({name:"templating/shared",initialState:h.j,reducers:{addVariable:(M,S)=>{const I=S.payload.id??S.payload.data.model.name,T=r.B.get(S.payload.type),b=(0,n.cloneDeep)(T.initialState),R=T.beforeAdding?T.beforeAdding(S.payload.data.model):(0,n.cloneDeep)(S.payload.data.model),A={...(0,n.defaults)({},R,b),id:I,index:S.payload.data.index,global:S.payload.data.global};M[I]=A},variableStateNotStarted:(M,S)=>{const I=(0,o.Fs)(M,S.payload.id);I.state=s.Gu.NotStarted,I.error=null},variableStateFetching:(M,S)=>{const I=(0,o.Fs)(M,S.payload.id);I.state=s.Gu.Loading,I.error=null},variableStateCompleted:(M,S)=>{const I=(0,o.Fs)(M,S.payload.id);I&&(I.state=s.Gu.Done,I.error=null)},variableStateFailed:(M,S)=>{const I=(0,o.Fs)(M,S.payload.id);I&&(I.state=s.Gu.Error,I.error=S.payload.data.error)},removeVariable:(M,S)=>{if(delete M[S.payload.id],!S.payload.data.reIndex)return;const I=Object.values(M).sort((T,b)=>T.index-b.index);for(let T=0;T<I.length;T++)I[T].index=T},duplicateVariable:(M,S)=>{function I(N){return N.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const T=(0,n.cloneDeep)(M[S.payload.id]),b=new RegExp(`^copy_of_${I(T.name)}(_(\\d+))?$`),R=Object.values(M).map(({name:N})=>N.match(b)).filter(N=>N!=null),A=R.map(N=>N[2]).filter(N=>N!=null),L=R.length===0?null:A.length===0?1:A.map(N=>+N).sort((N,B)=>B-N)[0]+1,U=`copy_of_${T.name}${L?`_${L}`:""}`,W=S.payload.data?.newId??U,w=(0,o.wk)(Object.values(M));M[W]={...(0,n.cloneDeep)(r.B.get(S.payload.type).initialState),...T,id:W,name:U,index:w}},changeVariableOrder:(M,S)=>{const{toIndex:I,fromIndex:T}=S.payload.data,b=Object.values(M);for(let R=0;R<b.length;R++){const A=b[R];A.index===T?A.index=I:A.index>T&&A.index<=I?A.index--:A.index<T&&A.index>=I&&A.index++}},changeVariableType:(M,S)=>{const{id:I}=S.payload,{label:T,name:b,index:R,description:A,rootStateKey:L}=M[I];M[I]={...(0,n.cloneDeep)(r.B.get(S.payload.data.newType).initialState),id:I,rootStateKey:L,label:T,name:b,index:R,description:A}},setCurrentVariableValue:(M,S)=>{if(!S.payload.data.option)return;const I=(0,o.Fs)(M,S.payload.id);if(!(0,a.SP)(I))return;const{option:T}=S.payload.data,b={...T,text:(0,c.QT)(T?.text),value:(0,c.QT)(T?.value)};I.current=b,I.options=I.options.map(R=>{R.value=(0,c.QT)(R.value),R.text=(0,c.QT)(R.text);let A=!1;if(Array.isArray(b.value))for(let L=0;L<b.value.length;L++){const U=b.value[L];if(R.value===U){A=!0;break}}else R.value===b.value&&(A=!0);return R.selected=A,R})},changeVariableProp:(M,S)=>{const I=(0,o.Fs)(M,S.payload.id);I[S.payload.data.propName]=S.payload.data.propValue}},extraReducers:M=>M.addCase(f.FN,(S,I)=>{const T=(0,o.Fs)(S,I.payload.id);T.name=I.payload.data.newName})}),l=g.reducer,{removeVariable:p,addVariable:m,changeVariableProp:y,changeVariableOrder:d,duplicateVariable:v,setCurrentVariableValue:u,changeVariableType:D,variableStateNotStarted:P,variableStateFetching:x,variableStateCompleted:E,variableStateFailed:C}=g.actions},85675:(G,O,e)=>{"use strict";e.d(O,{$O:()=>o,Dd:()=>h,i3:()=>s,kH:()=>a,pu:()=>c});var t=e(65307),n=e(80484),i=e(56968);const s={uid:null,status:n.x8.NotStarted,isDirty:!1},r=(0,t.Z0)({name:"templating/transaction",initialState:s,reducers:{variablesInitTransaction:(g,l)=>{g.uid=l.payload.uid,g.status=n.x8.Fetching},variablesCompleteTransaction:(g,l)=>{g.uid===l.payload.uid&&(g.status=n.x8.Completed)},variablesClearTransaction:(g,l)=>{g.uid=null,g.status=n.x8.NotStarted,g.isDirty=!1}},extraReducers:g=>g.addMatcher(f,(l,p)=>{l.status===n.x8.Completed&&(l.isDirty=!0)})});function f(g){return i.Hr.match(g)||i.QV.match(g)||i.QP.match(g)||i.hj.match(g)||i.ut.match(g)||i.l_.match(g)}const{variablesInitTransaction:a,variablesClearTransaction:c,variablesCompleteTransaction:o}=r.actions,h=r.reducer},83370:(G,O,e)=>{"use strict";e.d(O,{j:()=>t});const t={}},15120:(G,O,e)=>{"use strict";e.d(O,{Y:()=>f,v:()=>r});var t=e(65307),n=e(20601),i=e(56968),s=e(83370);const r=(0,t.VP)("templating/cleanVariables"),f=(a=s.j,c)=>{if(r.match(c)){const o=Object.values(a).filter(g=>g.global);return o?o.reduce((g,l)=>(g[l.id]=l,g),{}):s.j}return c?.payload?.type&&n.B.getIfExists(c?.payload?.type)?n.B.get(c.payload.type).reducer((0,i.qi)(a,c),c):a}},80484:(G,O,e)=>{"use strict";e.d(O,{BS:()=>c,Vg:()=>f,eF:()=>o,og:()=>a,x8:()=>r});var t=e(12470),n=e(39070),i=e(65463),s=e(13344),r=(h=>(h.NotStarted="Not started",h.Fetching="Fetching",h.Completed="Completed",h))(r||{});const f={id:s.qF,rootStateKey:null,name:"",type:"query",global:!1,index:-1,hide:t.zL.dontHide,skipUrlSync:!1,state:n.Gu.NotStarted,error:null,description:null};class a extends i.x{static{this.type="variables-changed"}}class c extends i.x{static{this.type="variables-time-range-process-done"}}class o extends i.x{static{this.type="variables-changed-in-url"}}},75096:(G,O,e)=>{"use strict";e.d(O,{AX:()=>P,Lz:()=>d,ML:()=>m,Nz:()=>y,QT:()=>C,SY:()=>g,Wz:()=>E,iP:()=>u,jX:()=>I,q$:()=>D,q4:()=>S,qD:()=>T,sN:()=>M,t4:()=>l,u7:()=>v,wJ:()=>p});var t=e(2543),n=e.n(t),i=e(12470),s=e(72574),r=e(87490),f=e(99140),a=e(20601),c=e(13344),o=e(87421),h=e(80484);const g=/\$(\w+)|\[\[(\w+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g,l=R=>(g.lastIndex=0,g.exec(R));function p(...R){const A=R[R.length-1];R[0]=typeof R[0]=="string"?R[0]:(0,r.MA)(R[0]);const U=R.slice(0,-1).join(" ").match(g);return!!(U!==null?U.find(w=>{const N=l(w);return N!==null&&N.indexOf(A)>-1}):!1)}const m=R=>{if(!R||!R.current)return!1;if(R.current.value){const A=Array.isArray(R.current.value);if(A&&R.current.value.length&&R.current.value[0]===c.To||!A&&R.current.value===c.To)return!0}if(R.current.text){const A=Array.isArray(R.current.text);if(A&&R.current.text.length&&R.current.text[0]===c.Zm||!A&&R.current.text===c.Zm)return!0}return!1},y=R=>!R||!R.current||!R.current.text?"":Array.isArray(R.current.text)?R.current.text.toString():typeof R.current.text!="string"?"":R.current.text,d=R=>!R||!R.current||R.current.value===void 0||R.current.value===null?null:Array.isArray(R.current.value)?R.current.value.toString():typeof R.current.value!="string"?null:R.current.value;function v(R,A=(0,s.w)()){return!R||!R.regex?"":A.replace(R.regex,{},"regex")}function u(R,A,L,U){const W={range:void 0,variable:R,searchFilter:A,scopedVars:U};return(R.refresh===i.CO.onTimeRangeChanged||R.refresh===i.CO.onDashboardLoad)&&(W.range=L.timeRange()),W}function D(R){return R?.type==="custom"?i.CO.onDashboardLoad:!R||!("refresh"in R)||R.refresh!==i.CO.onTimeRangeChanged&&R.refresh!==i.CO.onDashboardLoad?i.CO.never:R.refresh}function P(){return a.B.list().filter(R=>R.id!=="system").map(({id:R,name:A,description:L})=>({label:A,value:R,description:L}))}function x(R){return(0,t.isArray)(R)&&(R.length===0?R=void 0:R.length===1&&(R=R[0])),R}function E(R,A){let L=0;const U={};for(const W in R){if(!W.startsWith(c.qz))continue;let w=x(A[W]),N=x(R[W]);(0,t.isEqual)(N,w)||(U[W]={value:R[W]},L++)}for(const W in A){if(!W.startsWith(c.qz))continue;const w=A[W];(0,t.isArray)(w)&&w.length===0||R.hasOwnProperty(W)||(U[W]={value:"",removed:!0},L++)}return L?U:void 0}function C(R){return Array.isArray(R)?R.map(String):R==null?"":typeof R=="number"?R.toString(10):typeof R=="string"?R:typeof R=="boolean"?R.toString():""}function M(R,A=(0,f.Gu)()){return(0,o.nx)(R,A).transaction.status!==h.x8.NotStarted}function S(R){return String(R)}const I=R=>{if(!R.rootStateKey)throw new Error(`rootStateKey not found for variable with id:${R.id}`);return{type:R.type,id:R.id,rootStateKey:R.rootStateKey}};function T(R,A){return{type:R.type,id:R.id,data:A}}function b(){const R=getTemplateSrv().getVariables(),A=locationService.getSearchObject();return Object.keys(A).filter(L=>L.indexOf(VARIABLE_PREFIX)!==-1&&R.some(U=>U.name===L.replace(VARIABLE_PREFIX,""))).reduce((L,U)=>{const W=U.replace(VARIABLE_PREFIX,"");return L[W]=A[U],L},{})}},1819:(G,O,e)=>{"use strict";e.d(O,{e:()=>l});var t=e(74848),n=e(32196),i=e(28240),s=e(83195),r=e(14588),f=e(52622),a=e(40845),c=e(72109),o=e(61994),h=e(74007);function g(m,y,d,v,u){const D=m.fields,P=d!=null?D[d]:null,x=D.filter(T=>!T.config.custom?.hideFrom?.tooltip),E=x.find(T=>T.name==="traceID")||D[0],C=[];if(x.filter(T=>E===T).length>0&&C.push(E),C.push(...x.filter(T=>E!==T)),C.length===0)return null;const M=[],S=[],I=new Set;for(const T of C){if(u===f.$N.Single&&T!==P)continue;const b=T.values[y],R=T.display?T.display(b):{text:`${b}`,numeric:+b};T.getLinks&&T.getLinks({calculatedValue:R,valueRowIndex:y}).forEach(A=>{const L=`${A.title}/${A.href}`;I.has(L)||(S.push(A),I.add(L))}),M.push({name:(0,i.Ct)(T,m),value:b,valueString:(0,s.cN)(R),highlight:T===P})}return v&&v!==f.xB.None&&M.sort((T,b)=>r.sortValues(v)(T.value,b.value)),{displayValues:M,links:S}}const l=({data:m,rowIndex:y,columnIndex:d,sortOrder:v,mode:u,header:D,padding:P=0})=>{const x=(0,a.of)(p,P);if(!m||y==null)return null;const E=g(m,y,d,v,u);if(E==null)return null;const{displayValues:C,links:M}=E;return D==="Exemplar"?(0,t.jsx)(h.i,{displayValues:C,links:M,header:D}):(0,t.jsxs)("div",{className:x.wrapper,children:[D&&(0,t.jsx)("div",{className:x.header,children:(0,t.jsx)("span",{className:x.title,children:D})}),(0,t.jsx)("table",{className:x.infoWrap,children:(0,t.jsxs)("tbody",{children:[C.map((S,I)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:S.name}),(0,t.jsx)("td",{children:(0,o.A)(S.valueString)})]},`${I}/${y}`)),M.map((S,I)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Link"}),(0,t.jsx)("td",{colSpan:2,children:(0,t.jsx)(c.Y,{href:S.href,external:S.target==="_blank",weight:"medium",inline:!1,children:S.title})})]},I))]})})]})},p=(m,y=0)=>({wrapper:(0,n.css)({padding:`${y}px`,background:m.components.tooltip.background,borderRadius:m.shape.borderRadius(2)}),header:(0,n.css)({background:m.colors.background.secondary,alignItems:"center",alignContent:"center",display:"flex",paddingBottom:m.spacing(1)}),title:(0,n.css)({fontWeight:m.typography.fontWeightMedium,overflow:"hidden",display:"inline-block",whiteSpace:"nowrap",textOverflow:"ellipsis",flexGrow:1}),infoWrap:(0,n.css)({padding:m.spacing(1),background:"transparent",border:"none",th:{fontWeight:m.typography.fontWeightMedium,padding:m.spacing(.25,2,.25,0)},tr:{borderBottom:`1px solid ${m.colors.border.weak}`,"&:last-child":{borderBottom:"none"}}}),link:(0,n.css)({color:m.colors.text.link})})},74007:(G,O,e)=>{"use strict";e.d(O,{i:()=>a});var t=e(74848),n=e(32196),i=e(40845),s=e(14689),r=e(13471),f=e(61994);const a=({displayValues:o,links:h,header:g="Exemplar"})=>{const l=(0,i.of)(c),p=o.find(m=>m.name==="Time");return o=o.filter(m=>m.name!=="Time"),(0,t.jsxs)("div",{className:l.exemplarWrapper,children:[(0,t.jsxs)("div",{className:l.exemplarHeader,children:[(0,t.jsx)("span",{className:l.title,children:g}),p&&(0,t.jsx)("span",{className:l.time,children:(0,f.A)(p.valueString)})]}),(0,t.jsx)("div",{className:l.exemplarContent,children:o.map((m,y)=>(0,t.jsx)(r.B,{label:m.name,value:(0,f.A)(m.valueString),justify:"space-between",isPinned:!1},y))}),h&&h.length>0&&(0,t.jsx)("div",{className:l.exemplarFooter,children:h.map((m,y)=>(0,t.jsx)(s.R,{link:m,buttonProps:{size:"md"}},y))})]})},c=(o,h=0)=>({exemplarWrapper:(0,n.css)({display:"flex",flexDirection:"column",flex:1,gap:4,whiteSpace:"pre",borderRadius:o.shape.radius.default,background:o.colors.background.primary,border:`1px solid ${o.colors.border.weak}`,boxShadow:`0 4px 8px ${o.colors.background.primary}`}),exemplarHeader:(0,n.css)({display:"flex",flexDirection:"column",alignItems:"flex-start",gap:o.spacing(.5),color:o.colors.text.secondary,padding:o.spacing(1)}),time:(0,n.css)({color:o.colors.text.primary}),exemplarContent:(0,n.css)({display:"flex",flexDirection:"column",flex:1,gap:4,borderTop:`1px solid ${o.colors.border.medium}`,padding:o.spacing(1)}),exemplarFooter:(0,n.css)({display:"flex",flexDirection:"column",padding:o.spacing(1),borderTop:`1px solid ${o.colors.border.medium}`,gap:4}),linkButton:(0,n.css)({width:"fit-content"}),label:(0,n.css)({color:o.colors.text.secondary,fontWeight:400,textOverflow:"ellipsis",overflow:"hidden",marginRight:o.spacing(.5)}),value:(0,n.css)({fontWeight:500,textOverflow:"ellipsis",overflow:"hidden"}),title:(0,n.css)({fontWeight:o.typography.fontWeightMedium,overflow:"hidden",display:"inline-block",whiteSpace:"nowrap",textOverflow:"ellipsis",flexGrow:1})})},20293:(G,O,e)=>{"use strict";var t=e(6262),n=e(9423),i=e(7452),s=e(78624),r=e(4213),f=e(34796),a=e(13609),c=e(31193),o=e(17493),h=e(14792),g=e(15858),l=e(16495),p=e(62639),m=e(2543),y=e.n(m),d=e(96540),v=e(5338),u=e(47232),D=e(1933),P=e(69550),x=e(97497),E=e(96915),C=e(71733),M=e(17172),S=e(23509),I=e(12131),T=e(96937),b=e(61706),R=e(3591),A=e(63639),L=e(89191),U=e(19347),W=e(4402),w=e(3197),N=e(79396),B=e(14778),V=e(23172),K=e(63415),H=e(97152),X=e(24308),k=e(46235),Y=e(2913),Z=e(94041),se=e(32264),j=e(74848),q=e(11261),ne=e(85200),oe=e(1173),z=e(28240),te=e(18282),le=e(57934),ie=e(73376),ae=e(14186),re=e(94354),ce=e(90613),me=e(55852),ee=e(91847);function de(F){if(F in ee.uk){const{name:_,getHelperDocs:Q,links:ue}=ee.uk[F],Ce=Q(ee.g_.UIImage),Oe=De(Ce);if(ue?.length){const we=ue.map(ke=>`
  Or visit <a href="${ke.url}" target="_blank">${ke.title}</a>

  `).join("");return{name:_,helperDocs:`
        ${Oe}
        ${(0,ee.$n)()}
  ${we}
        `}}return{name:_,helperDocs:`
      ${Oe}
      ${(0,ee.$n)()}
      `}}return{name:"No documentation found",helperDocs:(0,ee.$n)()}}const De=F=>F.replace(/\[(.*?)\]\(#.*?\)/g,"$1").replace(/\[[^\]]*\]\[\]/g,"");var fe=e(39268),Te=e(90182),je=e(83077),He=e(91890),Be=e(72574),Ne=e(10354),Re=e(88841),Se=e(94397);function We(F,_){switch(_.type){case q.PU.boolean:return(0,m.isUndefined)(F)?!1:Ke(F);case q.PU.number:return isNaN(F)?0:parseFloat(F);case q.PU.string:return F?String(F):"";default:return F}}const Ke=F=>(0,m.isString)(F)?!(F[0]==="F"||F[0]==="f"||F[0]==="0"):!!F;function Xe(F){return function({options:Q,onChange:ue,field:Ce}){const{validator:Oe,converter:we=We}=F,{value:ke}=Q,[Ze,dt]=(0,d.useState)(!Oe(ke)),Ct=(0,Be.w)().getVariables().map(Wt=>({value:Wt.name,label:Wt.label||Wt.name,origin:He.$0.Template})),Kt=(0,d.useCallback)(Wt=>{dt(!Oe(Wt.currentTarget.value))},[dt,Oe]),Bt=(0,d.useCallback)(Wt=>{if(Ze)return;const{value:vn}=Wt.currentTarget;ue({...Q,value:we(vn,Ce)})},[Q,ue,Ze,Ce,we]),Mt=(0,d.useCallback)(Wt=>{dt(!Oe(Wt)),ue({...Q,value:Wt})},[dt,Oe,ue,Q]);return se.$.featureToggles.transformationsVariableSupport?(0,j.jsx)(Re.y,{invalid:Ze,value:ke,error:"Value needs to be an integer or a variable",onChange:Mt,placeholder:"Value or variable",suggestions:Ct}):(0,j.jsx)(Ne.p,{className:"flex-grow-1",invalid:Ze,defaultValue:String(Q.value),placeholder:"Value",onChange:Kt,onBlur:Bt})}}const Je=()=>[{name:"Is greater",id:oe.Js.greater,component:Xe({validator:Se.N_})},{name:"Is greater or equal",id:oe.Js.greaterOrEqual,component:Xe({validator:Se.N_})},{name:"Is lower",id:oe.Js.lower,component:Xe({validator:Se.N_})},{name:"Is lower or equal",id:oe.Js.lowerOrEqual,component:Xe({validator:Se.N_})},{name:"Is equal",id:oe.Js.equal,component:Xe({validator:()=>!0})},{name:"Is not equal",id:oe.Js.notEqual,component:Xe({validator:()=>!0})},{name:"Is Substring",id:oe.Js.substring,component:Xe({validator:()=>!0})},{name:"Is not substring",id:oe.Js.notSubstring,component:Xe({validator:()=>!0})}],st=()=>null,pt=()=>[{name:"Is null",id:oe.Js.isNull,component:st},{name:"Is not null",id:oe.Js.isNotNull,component:st}];var xt=e(76892);function ot(F){return function({options:Q,onChange:ue,field:Ce}){const{validator:Oe}=F,[we,ke]=(0,d.useState)({from:!Oe(Q.from),to:!Oe(Q.to)}),dt=(0,Be.w)().getVariables().map(Bt=>({value:Bt.name,label:Bt.label||Bt.name,origin:He.$0.Template})),mt=(0,d.useCallback)((Bt,Mt)=>{ke({...we,[Mt]:!Oe(Bt.currentTarget.value)})},[ke,Oe,we]),Ct=(0,d.useCallback)((Bt,Mt)=>{if(we[Mt])return;const{value:Wt}=Bt.currentTarget;ue({...Q,[Mt]:We(Wt,Ce)})},[Q,ue,we,Ce]),Kt=(0,d.useCallback)((Bt,Mt)=>{const Wt=!Oe(Bt);ke({...we,[Mt]:Wt}),!Wt&&ue({...Q,[Mt]:Bt})},[Q,ue,we,ke,Oe]);return se.$.featureToggles.transformationsVariableSupport?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(Re.y,{value:String(Q.from),invalid:we.from,error:"Value needs to be an integer or a variable",placeholder:"From",onChange:Bt=>Kt(Bt,"from"),suggestions:dt}),(0,j.jsx)(xt.c,{children:"and"}),(0,j.jsx)(Re.y,{invalid:we.to,error:"Value needs to be an integer or a variable",value:String(Q.to),placeholder:"To",suggestions:dt,onChange:Bt=>Kt(Bt,"to")})]}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(Ne.p,{invalid:we.from,defaultValue:String(Q.from),placeholder:"From",onChange:Bt=>mt(Bt,"from"),onBlur:Bt=>Ct(Bt,"from")}),(0,j.jsx)(xt.c,{children:"and"}),(0,j.jsx)(Ne.p,{invalid:we.to,defaultValue:String(Q.to),placeholder:"To",onChange:Bt=>mt(Bt,"to"),onBlur:Bt=>Ct(Bt,"to")})]})}}const $e=()=>[{name:"Is between",id:oe.Js.between,component:ot({validator:Se.N_})}];function ve(F){return function({options:Q,onChange:ue,field:Ce}){const{validator:Oe,converter:we=We}=F,{value:ke}=Q,[Ze,dt]=(0,d.useState)(!Oe(ke)),mt=(0,d.useCallback)(Kt=>{dt(!Oe(Kt.currentTarget.value))},[dt,Oe]),Ct=(0,d.useCallback)(Kt=>{if(Ze)return;const{value:Bt}=Kt.currentTarget;ue({...Q,value:we(Bt,Ce)})},[Q,ue,Ze,Ce,we]);return(0,j.jsx)(Ne.p,{className:"flex-grow-1",invalid:Ze,defaultValue:String(Q.value),placeholder:"Value",onChange:mt,onBlur:Ct})}}const be=()=>[{name:"Regex",id:oe.Js.regex,component:ve({validator:()=>!0,converter:F=>String(F)})}],he=new je.O(()=>[...Je(),...pt(),...$e(),...be()]),ye=F=>{const{onDelete:_,onChange:Q,filter:ue,fieldsInfo:Ce}=F,{fieldsAsOptions:Oe,fieldByDisplayName:we}=Ce,ke=xe(ue,Oe)??"",Ze=we[ke],dt=Ze?Pe(Ze):[],mt=ge(ue,dt),Ct=he.getIfExists(mt),Kt=(0,d.useCallback)(Wt=>{Wt?.value&&Q({...ue,fieldName:Wt.value})},[Q,ue]),Bt=(0,d.useCallback)(Wt=>{if(!Wt?.value)return;const vn=Wt.value,ns=ne.hI.get(vn).getDefaultOptions(Ze);Q({...ue,config:{id:vn,options:ns}})},[Q,ue,Ze]),Mt=(0,d.useCallback)(Wt=>{Q({...ue,config:{...ue.config,options:Wt}})},[Q,ue]);return!Ze||!Ct||!Ct.component?null:(0,j.jsxs)(fe.C,{children:[(0,j.jsx)(ae.I,{label:"Field",labelWidth:14,children:(0,j.jsx)(Te.l6,{className:"min-width-15 max-width-24",placeholder:"Field Name",options:Oe,value:ue.fieldName,onChange:Kt})}),(0,j.jsx)(ae.I,{label:"Match",children:(0,j.jsx)(Te.l6,{className:"width-12",placeholder:"Select test",options:dt,value:mt,onChange:Bt})}),(0,j.jsx)(ae.I,{label:"Value",grow:!0,children:(0,j.jsx)(Ct.component,{field:Ze,options:ue.config.options??{},onChange:Mt})}),(0,j.jsx)(ce.a,{marginBottom:.5,children:(0,j.jsx)(me.$n,{icon:"times",onClick:_,variant:"secondary"})})]})},Pe=F=>{const _=[];for(const Q of ne.hI.list())!Q.isApplicable(F)||!he.getIfExists(Q.id)||_.push({value:Q.id,label:Q.name,description:Q.description});return _},ge=(F,_)=>{const Q=_.find(ue=>ue.value===F.config.id);if(Q&&Q.value)return Q.value;if(_[0]?.value)return _[0]?.value},xe=(F,_)=>{const Q=_.find(ue=>ue.value===F.fieldName);if(Q&&Q.value)return Q.value;if(_[0]?.value)return _[0]?.value},Ae=[{label:"Include",value:ie.j4.include},{label:"Exclude",value:ie.j4.exclude}],Ee=[{label:"Match all",value:ie.Sm.all},{label:"Match any",value:ie.Sm.any}],Ie=F=>{const{input:_,options:Q,onChange:ue}=F,Ce=at(_),Oe=(0,d.useCallback)(()=>{const mt=_[0],Ct=mt.fields.find(Mt=>Mt.type!==q.PU.time);if(!Ct)return;const Kt=(0,m.cloneDeep)(Q.filters),Bt=ne.hI.get(oe.Js.isNull);Kt.push({fieldName:(0,z.Ct)(Ct,mt,_),config:{id:Bt.id,options:Bt.getDefaultOptions(Ct)}}),ue({...Q,filters:Kt})},[ue,Q,_]),we=(0,d.useCallback)(mt=>{let Ct=(0,m.cloneDeep)(Q.filters);Ct.splice(mt,1),ue({...Q,filters:Ct})},[Q,ue]),ke=(0,d.useCallback)((mt,Ct)=>{let Kt=(0,m.cloneDeep)(Q.filters);Kt[Ct]=mt,ue({...Q,filters:Kt})},[Q,ue]),Ze=(0,d.useCallback)(mt=>{ue({...Q,type:mt??ie.j4.include})},[Q,ue]),dt=(0,d.useCallback)(mt=>{ue({...Q,match:mt??ie.Sm.all})},[Q,ue]);return(0,j.jsxs)("div",{children:[(0,j.jsx)(ae.I,{label:"Filter type",labelWidth:16,children:(0,j.jsx)("div",{className:"width-15",children:(0,j.jsx)(re.z,{options:Ae,value:Q.type,onChange:Ze,fullWidth:!0})})}),(0,j.jsx)(ae.I,{label:"Conditions",labelWidth:16,children:(0,j.jsx)("div",{className:"width-15",children:(0,j.jsx)(re.z,{options:Ee,value:Q.match,onChange:dt,fullWidth:!0})})}),(0,j.jsxs)(ce.a,{paddingLeft:2,children:[Q.filters.map((mt,Ct)=>(0,j.jsx)(ye,{filter:mt,fieldsInfo:Ce,onChange:Kt=>ke(Kt,Ct),onDelete:()=>we(Ct)},Ct)),(0,j.jsx)(me.$n,{icon:"plus",size:"sm",onClick:Oe,variant:"secondary",children:"Add condition"})]})]})},Qe={id:te.F.filterByValue,editor:Ie,transformation:le.c.filterByValueTransformer,name:le.c.filterByValueTransformer.name,description:"Removes rows of the query results using user-defined filters. This is useful if you can not filter your data in the data source.",categories:new Set([x.m.Filter]),help:de(te.F.filterByValue).helperDocs},at=F=>(0,d.useMemo)(()=>{const _={fieldsAsOptions:[],fieldByDisplayName:{}};return Array.isArray(F)?F.reduce((Q,ue)=>ue.fields.reduce((Ce,Oe)=>{const we=(0,z.Ct)(Oe,ue,F);return Ce.fieldByDisplayName[we]||(Ce.fieldsAsOptions.push({label:we,value:we,type:Oe.type}),Ce.fieldByDisplayName[we]=Oe),Ce},Q),_):_},[F]);var ft=e(43429),ct=e(60264),vt=e(48192),Pt=e(66211),Vt=e(54612);function Jt(F,_){const Q={data:F.input,options:F.options},ue=new vt.C({id:"root",title:"root"}),Ce=we=>{if(we?.length){const ke=we[0];let Ze=ue.categories.find(dt=>dt.props.id===ke);return Ze||(Ze=new vt.C({id:ke,title:ke}),ue.categories.push(Ze)),Ze}return ue},Oe={getValue:we=>(0,m.get)(F.options,we),onChange:(we,ke)=>{F.onChange((0,Vt.Sf)(F.options,we,ke))}};return(0,Pt.g5)(_,Oe,Ce,Q),ue}function wt(F){const _={data:[],options:{}},Q={},ue=new ct.pv;F(ue,_);for(const Ce of ue.getItems())Ce.defaultValue!=null&&(0,m.set)(Q,Ce.path,Ce.defaultValue);return Q}var zt=e(27825),on=e(3290);const Pn=(F,_)=>{const Q=_.options??{};(0,zt.J)("",F,Q)},_n=F=>{(0,d.useEffect)(()=>{if(!F.options.xBuckets?.mode){const Q=wt(Pn);F.onChange({...Q,...F.options})}});const _=Jt(F,Pn);return(0,j.jsx)("div",{children:(0,j.jsx)("div",{children:_.items.map(Q=>Q.render())})})},Cn={id:on.wY.id,editor:_n,transformation:on.wY,name:on.wY.name,description:on.wY.description,state:ft.pn.alpha,categories:new Set([x.m.CreateNewVisualization]),help:de(on.wY.id).helperDocs};var Ye=e(32196),Dt=e(40845),yt=e(84349),Ft=e(75059),an=e(42734),un=e(24293),hn=e(28802),Un=e(50082),Nn=e(25019);function St(F,_,Q){const ue={},Ce={};for(const Oe of F.fields){const we=(0,z.Ct)(Oe,F),ke=Q.index[we],Ze=ke.handler;if(!Ze)continue;const dt=Oe.values[_];if(dt==null)continue;const mt=Ze.processor(dt,ue,Ce,ke.handlerArguments);mt!=null&&(ue[Ze.targetProperty??Ze.key]=mt)}return Ce.mappingValues&&(ue.mappings=lt(Ce)),ue}var nn=(F=>(F.Name="field.name",F.Value="field.value",F.Label="field.label",F.Ignore="__ignore",F))(nn||{});const ht=[{key:"field.name",name:"Field name",processor:()=>{}},{key:"field.value",name:"Field value",processor:()=>{}},{key:"field.label",name:"Field label",processor:()=>{}},{key:"__ignore",name:"Ignore",processor:()=>{}},{key:"max",processor:et},{key:"min",processor:et},{key:"unit",processor:F=>F.toString()},{key:"decimals",processor:et},{key:"displayName",name:"Display name",processor:F=>F.toString()},{key:"color",processor:F=>({fixedColor:F,mode:un.Y.Fixed})},{key:"threshold1",name:"Threshold",targetProperty:"thresholds",processor:(F,_,Q,ue)=>{const Ce=(0,hn.t)(F);if(!isNaN(Ce))return _.thresholds||(_.thresholds={mode:Un.O.Absolute,steps:[{value:-1/0,color:"green"}]}),_.thresholds.steps.push({value:Ce,color:ue.threshold?.color??"red"}),_.thresholds}},{key:"mappings.value",name:"Value mappings / Value",targetProperty:"mappings",defaultReducer:Ft.gy.allValues,processor:(F,_,Q)=>{if((0,m.isArray)(F))return Q.mappingValues=F,_.mappings}},{key:"mappings.color",name:"Value mappings / Color",targetProperty:"mappings",defaultReducer:Ft.gy.allValues,processor:(F,_,Q)=>{if((0,m.isArray)(F))return Q.mappingColors=F,_.mappings}},{key:"mappings.text",name:"Value mappings / Display text",targetProperty:"mappings",defaultReducer:Ft.gy.allValues,processor:(F,_,Q)=>{if((0,m.isArray)(F))return Q.mappingTexts=F,_.mappings}}];function lt(F){const _={type:Nn.d.ValueToText,options:{}};if(!F.mappingValues)return[];for(let Q=0;Q<F.mappingValues.length;Q++){const ue=F.mappingValues[Q];ue!=null&&(_.options[ue.toString()]={color:F.mappingColors&&F.mappingColors[Q],text:F.mappingTexts&&F.mappingTexts[Q],index:Q})}return[_]}let gt=null;function $t(){if(gt===null){gt={};for(const F of ht)gt[F.key]=F}return gt}function et(F){const _=(0,hn.t)(F);if(!isNaN(_))return _}function Et(F,_){for(const Q of _)if(F===Q.fieldName)return Q.handlerKey;return F.toLowerCase()}function It(F){return F?$t()[F]:null}function Qt(F,_,Q){const ue={index:{}};let Ce=_.find(we=>we.handlerKey==="field.name"),Oe=_.find(we=>we.handlerKey==="field.value");for(const we of F.fields){const ke=(0,z.Ct)(we,F),Ze=_.find(Ct=>Ct.fieldName===ke),dt=Ze?Ze.handlerKey:ke.toLowerCase();let mt=It(dt);Q&&(mt?(mt.key==="field.name"&&(ue.nameField=we),mt.key==="field.value"&&(ue.valueField=we)):Ze||(!ue.nameField&&!Ce&&we.type===q.PU.string&&(ue.nameField=we,mt=It("field.name")),!ue.valueField&&!Oe&&we.type===q.PU.number&&(ue.valueField=we,mt=It("field.value")))),!mt&&Q&&(mt=It("field.label")),ue.index[ke]={automatic:!Ze,handler:mt,handlerArguments:Ze?.handlerArguments??{},reducerId:Ze?.reducerId??mt?.defaultReducer??Ft.gy.lastNotNull}}return ue}var sn=e(83598);function ln(F){switch(F){case"threshold1":return!0;default:return!1}}function yn({handlerArguments:F,handlerKey:_,onChange:Q}){const ue=Ce=>{Q(Ce?{...F,threshold:{...F.threshold,color:Ce}}:{...F,threshold:void 0})};return(0,j.jsx)(j.Fragment,{children:_==="threshold1"&&(0,j.jsx)(Ne.p,{type:"text",value:"Threshold color","aria-label":"Threshold color",disabled:!0,width:20,prefix:(0,j.jsx)(sn.sk,{color:F.threshold?.color??"red",onChange:ue,enableNamedColors:!0})})})}function Sn({frame:F,mappings:_,onChange:Q,withReducers:ue,withNameAndValue:Ce}){const Oe=(0,Dt.of)(On),we=En(F,_,Ce),ke=ht.map(Kt=>wn(Kt,!1)),Ze=_.reduce((Kt,Bt)=>Kt||ln(Bt.handlerKey),!1),dt=(Kt,Bt)=>{const Mt=_.findIndex(Wt=>Wt.fieldName===Kt.fieldName);if(Bt)if(Mt!==-1){const Wt=[..._];Wt.splice(Mt,1,{..._[Mt],handlerKey:Bt.value}),Q(Wt)}else Q([..._,{fieldName:Kt.fieldName,handlerKey:Bt.value}]);else Q(Mt!==-1?_.filter((Wt,vn)=>vn!==Mt):[..._,{fieldName:Kt.fieldName,handlerKey:"__ignore"}])},mt=(Kt,Bt)=>{const Mt=_.findIndex(Wt=>Wt.fieldName===Kt.fieldName);if(Mt!==-1){const Wt=[..._];Wt.splice(Mt,1,{..._[Mt],reducerId:Bt}),Q(Wt)}else Q([..._,{fieldName:Kt.fieldName,handlerKey:Kt.handlerKey,reducerId:Bt}])},Ct=(Kt,Bt)=>{const Mt=_.findIndex(Wt=>Wt.fieldName===Kt.fieldName);if(Mt!==-1){const Wt=[..._];Wt.splice(Mt,1,{..._[Mt],handlerArguments:Bt}),Q(Wt)}else Q([..._,{fieldName:Kt.fieldName,handlerKey:Kt.handlerKey,handlerArguments:Bt}])};return(0,j.jsxs)("table",{className:Oe.table,children:[(0,j.jsx)("thead",{children:(0,j.jsxs)("tr",{children:[(0,j.jsx)("th",{children:"Field"}),(0,j.jsx)("th",{children:"Use as"}),ue&&(0,j.jsx)("th",{children:"Select"}),Ze&&(0,j.jsx)("th",{children:"Additional settings"})]})}),(0,j.jsx)("tbody",{children:we.map(Kt=>(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{className:Oe.labelCell,children:Kt.fieldName}),(0,j.jsx)("td",{className:Oe.selectCell,"data-testid":`${Kt.fieldName}-config-key`,children:(0,j.jsx)(Te.l6,{options:ke,value:Kt.configOption,placeholder:Kt.placeholder,isClearable:!0,onChange:Bt=>dt(Kt,Bt)})}),ue&&(0,j.jsx)("td",{"data-testid":`${Kt.fieldName}-reducer`,className:Oe.selectCell,children:(0,j.jsx)(an.S,{stats:[Kt.reducerId],defaultStat:Kt.reducerId,onChange:Bt=>mt(Kt,Bt[0])})}),Ze&&(0,j.jsx)("td",{"data-testid":`${Kt.fieldName}-handler-arg`,className:Oe.selectCell,children:(0,j.jsx)(yn,{handlerKey:Kt.handlerKey,handlerArguments:Kt.handlerArguments,onChange:Bt=>Ct(Kt,Bt)})})]},Kt.fieldName))})]})}function En(F,_,Q){const ue=[],Ce=Qt(F,_??[],Q);for(const Oe of F.fields){const we=(0,z.Ct)(Oe,F),ke=Ce.index[we],Ze=wn(ke.handler,ke.automatic);ue.push({fieldName:we,configOption:ke.automatic?null:Ze,placeholder:ke.automatic?Ze?.label:"Choose",handlerKey:ke.handler?.key??null,reducerId:ke.reducerId,handlerArguments:ke.handlerArguments})}for(const Oe of _)if(!ue.find(we=>we.fieldName===Oe.fieldName)){const we=It(Oe.handlerKey);ue.push({fieldName:Oe.fieldName,handlerKey:Oe.handlerKey,configOption:wn(we,!1),missingInFrame:!0,reducerId:Oe.reducerId??Ft.gy.lastNotNull,handlerArguments:{}})}return Object.values(ue)}function wn(F,_){if(!F)return null;let Q=F.name??(0,m.capitalize)(F.key);return _&&(Q=`${Q} (auto)`),{label:Q,value:F.key}}const On=F=>({table:(0,Ye.css)`
    margin-top: ${F.spacing(1)};

    td,
    th {
      border-right: 4px solid ${F.colors.background.primary};
      border-bottom: 4px solid ${F.colors.background.primary};
      white-space: nowrap;
    }
    th {
      font-size: ${F.typography.bodySmall.fontSize};
      line-height: ${F.spacing(4)};
      padding: ${F.spacing(0,1)};
    }
  `,labelCell:(0,Ye.css)`
    font-size: ${F.typography.bodySmall.fontSize};
    background: ${F.colors.background.secondary};
    padding: ${F.spacing(0,1)};
    max-width: 400px;
    overflow: hidden;
    text-overflow: ellipsis;
    min-width: 140px;
  `,selectCell:(0,Ye.css)`
    padding: 0;
    min-width: 161px;
  `});var Rt=e(81160);function Ot(F,_){let Q=null;for(const ke of _)if(ke.refId===F.configRefId){Q=ke;break}if(!Q)return _;const ue={fields:[],length:1},Ce=Qt(Q,F.mappings??[],!1);for(const ke of Q.fields){const Ze={...ke},dt=(0,z.Ct)(ke,Q),mt=Ce.index[dt],Ct=(0,Ft.Nw)({field:ke,reducers:[mt.reducerId]});Ze.values=[Ct[mt.reducerId]],ue.fields.push(Ze)}const Oe=[],we=(0,ne.NS)(F.applyTo||{id:oe.Ct.numeric});for(const ke of _){if(ke===Q&&_.length>1)continue;const Ze={fields:[],length:ke.length,refId:ke.refId};for(const dt of ke.fields)if(we(dt,ke,_)){const mt=St(ue,0,Ce);Ze.fields.push({...dt,config:{...dt.config,...mt}})}else Ze.fields.push(dt);Oe.push(Ze)}return Oe}const jt={id:te.F.configFromData,name:"Config from query results",description:"Set unit, min, max and more from data.",defaultOptions:{configRefId:"config",mappings:[]},operator:F=>_=>_.pipe((0,Rt.T)(Q=>Ot(F,Q)))};function rt({input:F,onChange:_,options:Q}){const ue=(0,Dt.of)(Mn),Ce=F.map(Bt=>Bt.refId).filter(Bt=>Bt!=null).map(Bt=>({label:Bt,value:Bt})),Oe=Q.configRefId||"config",we=Q.applyTo??{id:oe.Ct.byType,options:"number"},ke=yt.g.get(we.id),Ze=F.find(Bt=>Bt.refId===Oe),dt=Bt=>{_({...Q,configRefId:Bt.value||"config"})},mt=Bt=>{_({...Q,applyTo:{id:Bt.value}})},Ct=Bt=>{_({...Q,applyTo:{id:we.id,options:Bt}})},Kt=yt.g.list().filter(Bt=>!Bt.excludeFromPicker).map(Bt=>({label:Bt.name,value:Bt.id,description:Bt.description}));return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{label:"Config query",labelWidth:20,children:(0,j.jsx)(Te.l6,{onChange:dt,options:Ce,value:Oe,width:30})})}),(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{label:"Apply to",labelWidth:20,children:(0,j.jsx)(Te.l6,{onChange:mt,options:Kt,value:we.id,width:30})})}),(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{label:"Apply to options",labelWidth:20,className:ue.matcherOptions,children:(0,j.jsx)(ke.component,{matcher:ke.matcher,data:F,options:we.options,onChange:Ct})})}),(0,j.jsx)(fe.C,{children:Ze&&(0,j.jsx)(Sn,{frame:Ze,mappings:Q.mappings,onChange:Bt=>_({...Q,mappings:Bt}),withReducers:!0})})]})}const tn={id:jt.id,editor:rt,transformation:jt,name:jt.name,description:jt.description,state:ft.pn.beta,categories:new Set([x.m.CalculateNewFields]),help:de(jt.id).helperDocs},Mn=F=>({matcherOptions:(0,Ye.css)`
    min-width: 404px;
  `});var kn=e(62467),Yn=e(58307),Wn=e(66350),Jn=e(15292),Ls=e(11710);const fs=16,ys=F=>{const{options:_,onChange:Q}=F,{binary:ue}=_;let Ce=!ue?.left,Oe=!ue?.right;const we=F.names.map(Mt=>(Mt===ue?.left&&(Ce=!0),Mt===ue?.right&&(Oe=!0),{label:Mt,value:Mt})),ke=Ce?we:[...we,{label:ue?.left,value:ue?.left}],Ze=Oe?we:[...we,{label:ue?.right,value:ue?.right}],dt=Ls.b.list().map(Mt=>({label:Mt.binaryOperationID,value:Mt.binaryOperationID})),mt=Mt=>{Q({..._,mode:Wn.UY.BinaryOperation,binary:Mt})},Ct=Mt=>{mt({...ue,left:Mt.value})},Kt=Mt=>{mt({...ue,right:Mt.value})},Bt=Mt=>{mt({...ue,operator:Mt.value})};return(0,j.jsx)(j.Fragment,{children:(0,j.jsxs)(fe.C,{children:[(0,j.jsx)(ae.I,{label:"Operation",labelWidth:fs,children:(0,j.jsx)(Te.l6,{allowCustomValue:!0,placeholder:"Field or number",options:ke,className:"min-width-18",value:ue?.left,onChange:Ct})}),(0,j.jsx)(ae.I,{children:(0,j.jsx)(Te.l6,{className:"width-4",options:dt,value:ue?.operator??dt[0].value,onChange:Bt})}),(0,j.jsx)(ae.I,{children:(0,j.jsx)(Te.l6,{allowCustomValue:!0,placeholder:"Field or number",className:"min-width-10",options:Ze,value:ue?.right,onChange:Kt})})]})})},Xn=F=>{const{names:_,onChange:Q,options:ue}=F,{cumulative:Ce}=ue,Oe=_.map(dt=>({label:dt,value:dt})),we=dt=>{const mt=dt.length?dt[0]:Ft.gy.sum;ke({...Ce,reducer:mt})},ke=dt=>{Q({...ue,mode:Wn.UY.CumulativeFunctions,cumulative:dt})},Ze=dt=>{ke({...Ce,field:dt.value})};return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(ae.I,{label:"Field",labelWidth:fs,children:(0,j.jsx)(Te.l6,{placeholder:"Field",options:Oe,className:"min-width-18",value:Ce?.field,onChange:Ze})}),(0,j.jsx)(ae.I,{label:"Calculation",labelWidth:fs,children:(0,j.jsx)(an.S,{allowMultiple:!1,className:"width-18",stats:[Ce?.reducer||Ft.gy.sum],onChange:we,defaultStat:Ft.gy.sum,filterOptions:dt=>dt.id===Ft.gy.sum||dt.id===Ft.gy.mean})})]})},Ps=F=>{const{options:_,onChange:Q}=F,{index:ue}=_,Ce=Oe=>{Q({..._,index:{asPercentile:Oe.currentTarget.checked}})};return(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(ae.I,{labelWidth:fs,label:"As percentile",tooltip:"Transform the row index as a percentile.",children:(0,j.jsx)(Jn.K,{value:!!ue?.asPercentile,onChange:Ce})})})};var Zs=e(66864),Ms=e(92174);const ks=F=>{const{names:_,selected:Q,onChange:ue,options:Ce}=F,{reduce:Oe}=Ce,we=mt=>{ue({...Ce,reduce:mt})},ke=mt=>{Q.indexOf(mt)>-1?Ze(Q.filter(Ct=>Ct!==mt)):Ze([...Q,mt])},Ze=mt=>{we({...Oe,include:mt})},dt=mt=>{const Ct=mt.length?mt[0]:Ft.gy.sum,{reduce:Kt}=Ce;we({...Kt,reducer:Ct})};return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(ae.I,{label:"Operation",labelWidth:fs,grow:!0,children:(0,j.jsx)(Zs.Gy,{spacing:"xs",align:"flex-start",wrap:!0,children:_.map((mt,Ct)=>(0,j.jsx)(Ms.m,{onClick:()=>{ke(mt)},label:mt,selected:Q.indexOf(mt)>-1},`${mt}/${Ct}`))})}),(0,j.jsx)(ae.I,{label:"Calculation",labelWidth:fs,children:(0,j.jsx)(an.S,{allowMultiple:!1,className:"width-18",stats:[Oe?.reducer||Ft.gy.sum],onChange:dt,defaultStat:Ft.gy.sum})})]})};var wa=e(27618);const Xa=F=>{const{options:_,onChange:Q}=F,{unary:ue}=_,Ce=Ct=>{Q({..._,mode:Wn.UY.UnaryOperation,unary:Ct})},Oe=Ct=>{Ce({...ue,operator:Ct.value})},we=Ct=>{Ce({...ue,fieldName:Ct.value})};let ke=!ue?.fieldName;const Ze=F.names.map(Ct=>(Ct===ue?.fieldName&&(ke=!0),{label:Ct,value:Ct})),dt=wa.j.list().map(Ct=>({label:Ct.unaryOperationID,value:Ct.unaryOperationID})),mt=ke?Ze:[...Ze,{label:ue?.fieldName,value:ue?.fieldName}];return(0,j.jsx)(j.Fragment,{children:(0,j.jsxs)(fe.C,{children:[(0,j.jsx)(ae.I,{label:"Operation",labelWidth:fs,children:(0,j.jsx)(Te.l6,{options:dt,value:ue?.operator??dt[0].value,onChange:Oe})}),(0,j.jsx)(ae.I,{label:"(",labelWidth:2,children:(0,j.jsx)(Te.l6,{placeholder:"Field",className:"min-width-11",options:mt,value:ue?.fieldName,onChange:we})}),(0,j.jsx)(xt.c,{width:2,children:")"})]})})};var pa=e(60188);const Ba=F=>{const{options:_,names:Q,onChange:ue}=F,{window:Ce}=_,Oe=Q.map(Mt=>({label:Mt,value:Mt})),we=[{label:"Trailing",value:Wn.ip.Trailing},{label:"Centered",value:Wn.ip.Centered}],ke=[{label:"Percentage",value:Wn.Bp.Percentage},{label:"Fixed",value:Wn.Bp.Fixed}],Ze=Mt=>{ue({..._,mode:Wn.UY.WindowFunctions,window:Mt})},dt=Mt=>{Ze({...Ce,field:Mt.value})},mt=Mt=>{Ze({...Ce,windowSize:Mt&&Ce?.windowSizeMode===Wn.Bp.Percentage?Mt/100:Mt})},Ct=Mt=>{Ze({...Ce,windowSize:Ce?.windowSize?Mt===Wn.Bp.Percentage?Ce.windowSize/100:Ce.windowSize*100:void 0,windowSizeMode:Mt})},Kt=Mt=>{const Wt=Mt.length?Mt[0]:Ft.gy.sum;Ze({...Ce,reducer:Wt})},Bt=Mt=>{Ze({...Ce,windowAlignment:Mt})};return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(ae.I,{label:"Field",labelWidth:fs,children:(0,j.jsx)(Te.l6,{placeholder:"Field",options:Oe,className:"min-width-18",value:Ce?.field,onChange:dt})}),(0,j.jsx)(ae.I,{label:"Calculation",labelWidth:fs,children:(0,j.jsx)(an.S,{allowMultiple:!1,className:"width-18",stats:[Ce?.reducer||Ft.gy.mean],onChange:Kt,defaultStat:Ft.gy.mean,filterOptions:Mt=>Mt.id===Ft.gy.mean||Mt.id===Ft.gy.variance||Mt.id===Ft.gy.stdDev})}),(0,j.jsx)(ae.I,{label:"Type",labelWidth:fs,children:(0,j.jsx)(re.z,{value:Ce?.windowAlignment??Wn.ip.Trailing,options:we,onChange:Bt})}),(0,j.jsx)(ae.I,{label:"Window size mode",children:(0,j.jsx)(re.z,{value:Ce?.windowSizeMode??Wn.Bp.Percentage,options:ke,onChange:Ct})}),(0,j.jsx)(ae.I,{label:Ce?.windowSizeMode===Wn.Bp.Percentage?"Window size %":"Window size",labelWidth:fs,tooltip:Ce?.windowSizeMode===Wn.Bp.Percentage?"Set the window size as a percentage of the total data":"Window size",children:(0,j.jsx)(pa.Q,{placeholder:"Auto",min:.1,value:Ce?.windowSize&&Ce.windowSizeMode===Wn.Bp.Percentage?Ce.windowSize*100:Ce?.windowSize,onChange:mt})})]})},_a=[{value:Wn.UY.BinaryOperation,label:"Binary operation"},{value:Wn.UY.UnaryOperation,label:"Unary operation"},{value:Wn.UY.ReduceRow,label:"Reduce row"},{value:Wn.UY.Index,label:"Row index"}];se.$.featureToggles.addFieldFromCalculationStatFunctions&&_a.push({value:Wn.UY.CumulativeFunctions,label:"Cumulative functions"},{value:Wn.UY.WindowFunctions,label:"Window functions"});const dr=new Set([q.PU.time,q.PU.number,q.PU.string]),Wa=F=>{const{options:_,onChange:Q,input:ue}=F,Ce=_?.reduce?.include,[Oe,we]=(0,d.useState)({names:[],selected:[]});(0,d.useEffect)(()=>{const Mt={interpolate:vn=>vn},Wt=(0,kn.of)(ue).pipe(le.c.ensureColumnsTransformer.operator(null,Mt),Ze(),ke(),dt(Ce||[])).subscribe(({selected:vn,names:ns})=>{we({names:ns,selected:vn})});return()=>{Wt.unsubscribe()}},[ue,Ce]);const ke=()=>{if(!se.$.featureToggles.transformationsVariableSupport)return Yn.D;const Mt=(0,Be.w)();return Wt=>Wt.pipe((0,Rt.T)(vn=>(vn.push(...Mt.getVariables().map(ns=>"$"+ns.name)),vn)))},Ze=()=>Mt=>Mt.pipe((0,Rt.T)(Wt=>{const vn=[],ns={};for(const Ks of Wt)for(const bs of Ks.fields){if(!dr.has(bs.type))continue;const Hs=(0,z.Ct)(bs,Ks,Wt);ns[Hs]||(ns[Hs]=!0,vn.push(Hs))}return vn})),dt=Mt=>Wt=>Wt.pipe((0,Rt.T)(vn=>{if(!Mt.length)return{names:vn,selected:[]};const ns=[],Ks=[];for(const bs of vn)Mt.includes(bs)&&Ks.push(bs),ns.push(bs);return{names:ns,selected:Ks}})),mt=Mt=>{Q({..._,replaceFields:Mt.currentTarget.checked})},Ct=Mt=>{const Wt=Mt.value??Wn.UY.BinaryOperation;Wt===Wn.UY.WindowFunctions&&(_.window=_.window??Wn.Uj),Q({..._,mode:Wt})},Kt=Mt=>{Q({..._,alias:Mt.target.value})},Bt=_.mode??Wn.UY.BinaryOperation;return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(ae.I,{labelWidth:fs,label:"Mode",children:(0,j.jsx)(Te.l6,{className:"width-18",options:_a,value:_a.find(Mt=>Mt.value===Bt),onChange:Ct})}),Bt===Wn.UY.BinaryOperation&&(0,j.jsx)(ys,{options:_,names:Oe.names,onChange:F.onChange}),Bt===Wn.UY.UnaryOperation&&(0,j.jsx)(Xa,{names:Oe.names,options:_,onChange:F.onChange}),Bt===Wn.UY.ReduceRow&&(0,j.jsx)(ks,{names:Oe.names,selected:Oe.selected,options:_,onChange:F.onChange}),Bt===Wn.UY.CumulativeFunctions&&(0,j.jsx)(Xn,{names:Oe.names,options:_,onChange:F.onChange}),Bt===Wn.UY.WindowFunctions&&(0,j.jsx)(Ba,{names:Oe.names,options:_,onChange:F.onChange}),Bt===Wn.UY.Index&&(0,j.jsx)(Ps,{options:_,onChange:F.onChange}),(0,j.jsx)(ae.I,{labelWidth:fs,label:"Alias",children:(0,j.jsx)(Ne.p,{className:"width-18",value:_.alias??"",placeholder:(0,Wn.sw)(_),onChange:Kt})}),(0,j.jsx)(ae.I,{labelWidth:fs,label:"Replace all fields",children:(0,j.jsx)(Jn.K,{value:!!_.replaceFields,onChange:mt})})]})},en={id:te.F.calculateField,editor:Wa,transformation:le.c.calculateFieldTransformer,name:le.c.calculateFieldTransformer.name,description:"Use the row values to calculate a new field.",categories:new Set([x.m.CalculateNewFields]),help:de(te.F.calculateField).helperDocs};var $n=e(82150);const Qn=[{value:$n.x1.FieldName,label:"Copy frame name to field name"},{value:$n.x1.Label,label:"Add a label with the frame name"},{value:$n.x1.Drop,label:"Ignore the frame name"}];class Gn extends d.PureComponent{constructor(_){super(_),this.onModeChanged=Q=>{const{options:ue,onChange:Ce}=this.props,Oe=Q.value??$n.x1.FieldName;Ce({...ue,frameNameMode:Oe})},this.onLabelChanged=Q=>{const{options:ue}=this.props;this.props.onChange({...ue,frameNameLabel:Q.target.value})}}render(){const{options:_}=this.props,Q=_.frameNameMode??$n.x1.FieldName;return(0,j.jsxs)("div",{children:[(0,j.jsx)(ae.I,{label:"Name",labelWidth:16,grow:!0,children:(0,j.jsx)(Te.l6,{width:36,options:Qn,value:Qn.find(ue=>ue.value===Q),onChange:this.onModeChanged})}),Q===$n.x1.Label&&(0,j.jsx)(ae.I,{label:"Label",labelWidth:16,grow:!0,children:(0,j.jsx)(Ne.p,{width:36,value:_.frameNameLabel??"",placeholder:"frame",onChange:this.onLabelChanged})})]})}}const qn={id:te.F.concatenate,editor:Gn,transformation:le.c.concatenateTransformer,name:le.c.concatenateTransformer.name,description:"Combine all fields into a single frame.  Values will be appended with undefined values if not the same length.",categories:new Set([x.m.Combine]),help:de(te.F.concatenate).helperDocs};var es=e(91410),Ss=e(76218),_s=e(9988),Pa=e(63577),Ea=e(38127),Ys=e(14578),ha=e(72093),ja=e(29158);const ua=({transformIndex:F,value:_,index:Q,mappedIndex:ue,onChangeEnumValue:Ce,onRemoveEnumRow:Oe,checkIsEnumUniqueValue:we})=>{const ke=(0,Dt.of)(za),[Ze,dt]=(0,d.useState)(_),[mt,Ct]=(0,d.useState)(Ze===""),[Kt,Bt]=(0,d.useState)(null),Mt=(0,d.useRef)(null);(0,d.useEffect)(()=>{Mt.current&&Mt.current.focus()},[Mt]);const Wt=Hs=>{Hs.currentTarget.value!==""&&we(Hs.currentTarget.value)&&Hs.currentTarget.value!==_?Bt("Enum value already exists"):Bt(null),dt(Hs.currentTarget.value)},vn=()=>{if(Ct(!1),Bt(null),Ze===""||Kt!==null){Oe(ue);return}Ce(ue,Ze)},ns=Hs=>{Hs.key==="Enter"&&(Hs.preventDefault(),vn())},Ks=()=>{Ct(!0)},bs=()=>{Oe(ue)};return(0,j.jsx)(Ea.sx,{draggableId:`${F}/${_}`,index:Q,children:Hs=>(0,j.jsxs)("tr",{ref:Hs.innerRef,...Hs.draggableProps,children:[(0,j.jsx)("td",{children:(0,j.jsx)("div",{className:ke.dragHandle,...Hs.dragHandleProps,children:(0,j.jsx)(Ys.I,{name:"draggabledots",size:"lg"})})}),mt?(0,j.jsxs)("td",{children:[(0,j.jsx)(Ne.p,{ref:Mt,type:"text",value:Ze,onChange:Wt,onBlur:vn,onKeyDown:ns}),Kt&&(0,j.jsx)(ha.P,{children:Kt})]}):(0,j.jsx)("td",{onClick:Ks,className:ke.clickableTableCell,children:_&&_!==""?_:"Click to edit"}),(0,j.jsx)("td",{className:ke.textAlignCenter,children:(0,j.jsx)(Zs.Gy,{spacing:"sm",children:(0,j.jsx)(ja.K,{name:"trash-alt",onClick:bs,"data-testid":"remove-enum-row","aria-label":"Delete enum row",tooltip:"Delete"})})})]},Q)},`${F}/${_}`)},za=F=>({dragHandle:(0,Ye.css)({cursor:"grab"}),textAlignCenter:(0,Ye.css)({textAlign:"center"}),clickableTableCell:(0,Ye.css)({cursor:"pointer",width:"100px","&:hover":{color:F.colors.text.maxContrast}})}),Ja=ua,pr=({input:F,options:_,transformIndex:Q,onChange:ue})=>{const Ce=(0,Dt.of)(Wr),[Oe,we]=(0,d.useState)(_.conversions[Q].enumConfig?.text??[]);(0,d.useEffect)(()=>{!_.conversions[Q].enumConfig?.text?.length&&F.length&&ke()},[F]),(0,d.useEffect)(()=>{(()=>{const Wt=Oe.map(Ks=>Ks),vn=_.conversions,ns={text:Wt};vn[Q]={...vn[Q],enumConfig:ns},ue({..._,conversions:vn})})()},[Q,Oe]);const ke=()=>{const Mt=F.flatMap(vn=>vn?.fields??[]).find(vn=>vn.name===_.conversions[Q].targetField);if(!Mt)return;const Wt=new Set(Mt?.values);Oe.length>0&&!(0,m.isEqual)(Oe,Array.from(Wt))&&!window.confirm("This action will overwrite the existing configuration. Are you sure you want to continue?")||we([...Wt])},Ze=(Mt,Wt)=>{const vn=[...Oe];vn.splice(Mt,1,Wt),we(vn)},dt=Mt=>{const Wt=[...Oe];Wt.splice(Mt,1),we(Wt)},mt=()=>{we(["",...Oe])},Ct=(Mt,Wt)=>{Oe.includes(Wt)||Ze(Mt,Wt)},Kt=Mt=>Oe.includes(Mt),Bt=Mt=>{if(!Mt.destination)return;const Wt=Oe.length-Mt.source.index-1,vn=Oe.length-Mt.destination.index-1,ns=[...Oe],Ks=ns[Wt];ns.splice(Wt,1),ns.splice(vn,0,Ks),we(ns)};return(0,j.jsxs)(fe.C,{children:[(0,j.jsxs)(Zs.Gy,{children:[(0,j.jsx)(me.$n,{size:"sm",icon:"plus",onClick:()=>ke(),className:Ce.button,children:"Generate enum values from data"}),(0,j.jsx)(me.$n,{size:"sm",icon:"plus",onClick:()=>mt(),className:Ce.button,children:"Add enum value"})]}),(0,j.jsx)(Zs.gW,{children:(0,j.jsx)("table",{className:Ce.compactTable,children:(0,j.jsx)(Ea.JY,{onDragEnd:Bt,children:(0,j.jsx)(Ea.gL,{droppableId:"sortable-enum-config-mappings",direction:"vertical",children:Mt=>(0,j.jsxs)("tbody",{ref:Mt.innerRef,...Mt.droppableProps,children:[[...Oe].reverse().map((Wt,vn)=>{const ns=Oe.length-vn-1;return(0,j.jsx)(Ja,{transformIndex:Q,value:Wt,index:vn,mappedIndex:ns,onChangeEnumValue:Ct,onRemoveEnumRow:dt,checkIsEnumUniqueValue:Kt},`${Q}/${Wt}`)}),Mt.placeholder]})})})})})]})},Wr=F=>({compactTable:(0,Ye.css)({"tbody td":{padding:F.spacing(.5)},marginTop:F.spacing(1),marginBottom:F.spacing(2)}),button:(0,Ye.css)({marginTop:F.spacing(1)})}),Fr={settings:{width:24,isClearable:!1}},Kr=({input:F,options:_,onChange:Q})=>{const ue=_s.bx.filter(Bt=>Bt.value!==q.PU.trace),Ce=(0,Se.qt)(!0),Oe=(0,es.P3)();Ce.push({label:"Browser",value:"browser"}),Ce.push({label:"UTC",value:"utc"});for(const Bt of Oe)Ce.push({label:Bt,value:Bt});const we=(0,d.useCallback)(Bt=>Mt=>{const Wt=_.conversions;Wt[Bt]={...Wt[Bt],targetField:Mt??"",dateFormat:void 0},Q({..._,conversions:Wt})},[Q,_]),ke=(0,d.useCallback)(Bt=>Mt=>{const Wt=_.conversions;Wt[Bt]={...Wt[Bt],destinationType:Mt.value},Q({..._,conversions:Wt})},[Q,_]),Ze=(0,d.useCallback)(Bt=>Mt=>{const Wt=_.conversions;Wt[Bt]={...Wt[Bt],dateFormat:Mt.currentTarget.value},Q({..._,conversions:Wt})},[Q,_]),dt=(0,d.useCallback)(Bt=>Mt=>{const Wt=_.conversions;Wt[Bt]={...Wt[Bt],joinWith:Mt.currentTarget.value},Q({..._,conversions:Wt})},[Q,_]),mt=(0,d.useCallback)(()=>{Q({..._,conversions:[..._.conversions,{targetField:void 0,destinationType:void 0,dateFormat:void 0}]})},[Q,_]),Ct=(0,d.useCallback)(Bt=>{const Mt=_.conversions;Mt.splice(Bt,1),Q({..._,conversions:Mt})},[Q,_]),Kt=(0,d.useCallback)(Bt=>Mt=>{const Wt=_.conversions;Wt[Bt]={...Wt[Bt],timezone:Mt?.value},Q({..._,conversions:Wt})},[Q,_]);return(0,j.jsxs)(j.Fragment,{children:[_.conversions.map((Bt,Mt)=>{const Wt=(0,Pa.findField)(F?.[0],Bt.targetField);return(0,j.jsxs)("div",{children:[(0,j.jsxs)(fe.C,{children:[(0,j.jsx)(ae.I,{label:"Field",children:(0,j.jsx)(Ss.O,{context:{data:F},value:Bt.targetField??"",onChange:we(Mt),item:Fr})}),(0,j.jsx)(ae.I,{label:"as",children:(0,j.jsx)(Te.l6,{options:ue,value:Bt.destinationType,placeholder:"Type",onChange:ke(Mt),width:18})}),Bt.destinationType===q.PU.time&&(0,j.jsx)(ae.I,{label:"Input format",tooltip:"Specify the format of the input field so Grafana can parse the date string correctly.",children:(0,j.jsx)(Ne.p,{value:Bt.dateFormat,placeholder:"e.g. YYYY-MM-DD",onChange:Ze(Mt),width:24})}),Bt.destinationType===q.PU.string&&(0,j.jsxs)(j.Fragment,{children:[(Bt.joinWith?.length||Wt?.type===q.PU.other)&&(0,j.jsx)(ae.I,{label:"Join with",tooltip:"Use an explicit separator when joining array values",children:(0,j.jsx)(Ne.p,{value:Bt.joinWith,placeholder:"JSON",onChange:dt(Mt),width:9})}),Bt.dateFormat||Wt?.type===q.PU.time&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(ae.I,{label:"Date format",tooltip:"Specify the output format.",children:(0,j.jsx)(Ne.p,{value:Bt.dateFormat,placeholder:"e.g. YYYY-MM-DD",onChange:Ze(Mt),width:24})}),(0,j.jsx)(ae.I,{label:"Set timezone",tooltip:"Set the timezone of the date manually",children:(0,j.jsx)(Te.l6,{options:Ce,value:Bt.timezone,onChange:Kt(Mt),isClearable:!0})})]})]}),(0,j.jsx)(me.$n,{size:"md",icon:"trash-alt",variant:"secondary",onClick:()=>Ct(Mt),"aria-label":"Remove convert field type transformer"})]}),Bt.destinationType===q.PU.enum&&(0,j.jsx)(pr,{input:F,options:_,transformIndex:Mt,onChange:Q})]},`${Bt.targetField}-${Mt}`)}),(0,j.jsx)(me.$n,{size:"sm",icon:"plus",onClick:mt,variant:"secondary","aria-label":"Add a convert field type transformer",children:"Convert field type"})]})},Ar={id:te.F.convertFieldType,editor:Kr,transformation:le.c.convertFieldTypeTransformer,name:le.c.convertFieldTypeTransformer.name,description:le.c.convertFieldTypeTransformer.description,categories:new Set([x.m.Reformat]),help:de(te.F.convertFieldType).helperDocs};var $r=e(54479);class so extends d.PureComponent{constructor(_){super(_),this.onFieldToggle=Q=>{const{selected:ue}=this.state;ue.indexOf(Q)>-1?this.onChange(ue.filter(Ce=>Ce!==Q)):this.onChange([...ue,Q])},this.onChange=Q=>{const{regex:ue,isRegexValid:Ce}=this.state,Oe={...this.props.options,include:{names:Q}};ue&&Ce&&(Oe.include=Oe.include??{},Oe.include.pattern=ue),this.setState({selected:Q},()=>{this.props.onChange(Oe)})},this.onInputBlur=Q=>{const{selected:ue,regex:Ce}=this.state;let Oe=!0;try{Ce&&(0,$r.dO)(Ce)}catch{Oe=!1}Oe?this.props.onChange({...this.props.options,include:{pattern:Ce}}):this.props.onChange({...this.props.options,include:{names:ue}}),this.setState({isRegexValid:Oe})},this.onVariableChange=Q=>{this.props.onChange({...this.props.options,include:{variable:Q.value}}),this.setState({variable:Q.value})},this.onFromVariableChange=Q=>{const ue=Q.currentTarget.checked;this.props.onChange({...this.props.options,byVariable:ue}),this.setState({byVariable:ue})},this.state={include:_.options.include?.names||[],regex:_.options.include?.pattern,variable:_.options.include?.variable,byVariable:_.options.byVariable||!1,options:[],variables:[],selected:[],isRegexValid:!0}}componentDidMount(){this.initOptions()}componentDidUpdate(_){this.props.input!==_.input&&this.initOptions()}initOptions(){const{input:_,options:Q}=this.props,ue=Array.from(Q.include?.names??[]),Ce=(0,Be.w)().getVariables().map(ke=>({label:"$"+ke.name,value:"$"+ke.name})),Oe=[],we={};for(const ke of _)for(const Ze of ke.fields){const dt=(0,z.Ct)(Ze,ke,_);let mt=we[dt];mt||(mt=we[dt]={name:dt,count:0},Oe.push(mt)),mt.count++}if(Q.include?.pattern)try{const ke=(0,$r.dO)(Q.include.pattern);for(const Ze of Oe)ke.test(Ze.name)&&ue.push(Ze.name)}catch(ke){console.error(ke)}if(ue.length){const ke=Oe.filter(Ze=>ue.includes(Ze.name));this.setState({options:Oe,selected:ke.map(Ze=>Ze.name),variables:Ce,byVariable:Q.byVariable||!1,variable:Q.include?.variable,regex:Q.include?.pattern})}else this.setState({options:Oe,selected:Oe.map(ke=>ke.name),variables:Ce,byVariable:Q.byVariable||!1,variable:Q.include?.variable,regex:Q.include?.pattern})}render(){const{options:_,selected:Q,isRegexValid:ue}=this.state;return(0,j.jsxs)("div",{children:[(0,j.jsx)(fe.C,{label:"Use variable",children:(0,j.jsx)(ae.I,{label:"From variable",children:(0,j.jsx)(Jn.K,{value:this.state.byVariable,onChange:this.onFromVariableChange})})}),this.state.byVariable?(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{label:"Variable",children:(0,j.jsx)(Te.l6,{value:this.state.variable,onChange:this.onVariableChange,options:this.state.variables||[]})})}):(0,j.jsxs)(fe.C,{label:"Identifier",children:[(0,j.jsx)(ae.I,{label:"Identifier",invalid:!ue,error:ue?void 0:"Invalid pattern",children:(0,j.jsx)(Ne.p,{placeholder:"Regular expression pattern",value:this.state.regex||"",onChange:Ce=>this.setState({regex:Ce.currentTarget.value}),onBlur:this.onInputBlur,width:25})}),_.map((Ce,Oe)=>{const we=`${Ce.name}${Ce.count>1?" ("+Ce.count+")":""}`,ke=Q.indexOf(Ce.name)>-1;return(0,j.jsx)(Ms.m,{onClick:()=>{this.onFieldToggle(Ce.name)},label:we,selected:ke},`${Ce.name}/${Oe}`)})]})]})}}const Zr={id:te.F.filterFieldsByName,editor:so,transformation:le.c.filterFieldsByNameTransformer,name:le.c.filterFieldsByNameTransformer.name,description:"Removes part of the query results using a regex pattern. The pattern can be inclusive or exclusive.",categories:new Set([x.m.Filter]),help:de(te.F.filterFieldsByName).helperDocs};class mo extends d.PureComponent{constructor(_){super(_),this.onFieldToggle=Q=>{const{selected:ue}=this.state;ue.indexOf(Q)>-1?this.onChange(ue.filter(Ce=>Ce!==Q)):this.onChange([...ue,Q])},this.onChange=Q=>{this.setState({selected:Q}),this.props.onChange({...this.props.options,include:Q.join("|")})},this.state={include:_.options.include||"",options:[],selected:[]}}componentDidMount(){this.initOptions()}componentDidUpdate(_){this.props.input!==_.input&&this.initOptions()}initOptions(){const{input:_,options:Q}=this.props,ue=Q.include?Q.include.split("|"):[],Ce=[],Oe={};for(const we of _)if(we.refId){let ke=Oe[we.refId];ke||(ke=Oe[we.refId]={refId:we.refId,count:0},Ce.push(ke)),ke.count++}if(ue.length){const we=[],ke=[];for(const Ze of Ce)ue.includes(Ze.refId)&&ke.push(Ze),we.push(Ze);this.setState({options:we,selected:ke.map(Ze=>Ze.refId)})}else this.setState({options:Ce,selected:[]})}render(){const{options:_,selected:Q}=this.state,{input:ue}=this.props;return(0,j.jsxs)(j.Fragment,{children:[ue.length<=1&&(0,j.jsx)("div",{children:(0,j.jsx)(ha.P,{children:"Filter data by query expects multiple queries in the input."})}),(0,j.jsx)(ae.I,{label:"Series refId",labelWidth:16,shrink:!0,children:(0,j.jsx)(Zs.Gy,{spacing:"xs",align:"flex-start",wrap:!0,children:_.map((Ce,Oe)=>{const we=`${Ce.refId}${Ce.count>1?" ("+Ce.count+")":""}`,ke=Q.indexOf(Ce.refId)>-1;return(0,j.jsx)(Ms.m,{onClick:()=>{this.onFieldToggle(Ce.refId)},label:we,selected:ke},`${Ce.refId}/${Oe}`)})})})]})}}const ao={id:te.F.filterByRefId,editor:mo,transformation:le.c.filterFramesByRefIdTransformer,name:le.c.filterFramesByRefIdTransformer.name,description:"Filter data by query. This is useful if you are sharing the results from a different panel that has many queries and you want to only visualize a subset of that in this panel.",categories:new Set([x.m.Filter]),help:de(te.F.filterByRefId).helperDocs};var Fa=e(15400);const fo={settings:{width:30,filter:F=>F.type===q.PU.string,placeholderText:"Select text field",noFieldsMessage:"No text fields found"},name:"",id:"",editor:()=>null};function ko({input:F,options:_,onChange:Q}){const ue=(0,d.useCallback)(Ze=>{Q({..._,stringField:Ze??""})},[Q,_]),Ce=(0,d.useCallback)(Ze=>{const dt=Ze.value??Fa.gs.UpperCase;Q({..._,outputFormat:dt})},[Q,_]),Oe=(0,d.useCallback)(Ze=>{Q({..._,substringStart:Ze??0})},[Q,_]),we=(0,d.useCallback)(Ze=>{Q({..._,substringEnd:Ze??0})},[Q,_]),ke=Object.values(Fa.gs).map(Ze=>({label:Ze,value:Ze}));return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(fe.C,{children:[(0,j.jsx)(ae.I,{label:"Field",labelWidth:10,children:(0,j.jsx)(Ss.O,{context:{data:F},value:_.stringField??"",onChange:ue,item:fo})}),(0,j.jsx)(ae.I,{label:"Format",labelWidth:10,children:(0,j.jsx)(Te.l6,{options:ke,value:_.outputFormat,onChange:Ce,width:20})})]}),_.outputFormat===Fa.gs.Substring&&(0,j.jsxs)(fe.C,{children:[(0,j.jsx)(ae.I,{label:"Substring range",labelWidth:15,children:(0,j.jsx)(pa.Q,{min:0,value:_.substringStart??0,onChange:Oe,width:7})}),(0,j.jsx)(ae.I,{children:(0,j.jsx)(pa.Q,{min:0,value:_.substringEnd??0,onChange:we,width:7})})]})]})}const Go={id:te.F.formatString,editor:ko,transformation:le.c.formatStringTransformer,name:le.c.formatStringTransformer.name,state:ft.pn.beta,description:le.c.formatStringTransformer.description,categories:new Set([x.m.Reformat])};function Ut({input:F,options:_,onChange:Q}){const ue=[],Ce=(0,Se.qt)(!0);for(const Ze of F)for(const dt of Ze.fields)if(dt.type==="time"){const mt=(0,z.Ct)(dt,Ze,F);ue.push({label:mt,value:mt})}const Oe=(0,d.useCallback)(Ze=>{const dt=Ze?.value!==void 0?Ze.value:"";Q({..._,timeField:dt})},[Q,_]),we=(0,d.useCallback)(Ze=>{const dt=Ze.target.value;Q({..._,outputFormat:dt})},[Q,_]),ke=(0,d.useCallback)(Ze=>{const dt=Ze?.value!==void 0?Ze.value:"";Q({..._,timezone:dt})},[Q,_]);return(0,j.jsx)(j.Fragment,{children:(0,j.jsxs)(fe.C,{children:[(0,j.jsx)(ae.I,{label:"Time Field",labelWidth:15,grow:!0,children:(0,j.jsx)(Te.l6,{options:ue,value:_.timeField,onChange:Oe,placeholder:"time",isClearable:!0})}),(0,j.jsx)(ae.I,{label:"Format",labelWidth:10,tooltip:(0,j.jsxs)(j.Fragment,{children:["The output format for the field specified as a"," ",(0,j.jsx)("a",{href:"https://momentjs.com/docs/#/displaying/",target:"_blank",rel:"noopener noreferrer",children:"Moment.js format string"}),"."]}),interactive:!0,children:(0,j.jsx)(Ne.p,{onChange:we,value:_.outputFormat})}),(0,j.jsx)(ae.I,{label:"Set Timezone",tooltip:"Set the timezone of the date manually",labelWidth:20,children:(0,j.jsx)(Te.l6,{options:Ce,value:_.timezone,onChange:ke,isClearable:!0})})]})})}const Yt={id:te.F.formatTime,editor:Ut,transformation:le.c.formatTimeTransformer,name:le.c.formatTimeTransformer.name,state:ft.pn.alpha,description:le.c.formatTimeTransformer.description,help:de(te.F.formatTime).helperDocs};var Tn=e(25094),rn=e(67061),In=e(42418);const cs=({input:F,options:_,onChange:Q})=>{const ue=(0,Se.ZI)(F),Ce=(0,d.useCallback)(Ze=>dt=>{Q({..._,fields:{..._.fields,[Ze]:dt}})},[Q]);let Oe,we=!1;for(const Ze of Object.values(_.fields))Ze.aggregations.length>0&&Ze.operation!==null&&(we=!0),Ze.operation===Tn.R3.groupBy&&(Oe=!0);const ke=we&&!Oe;return(0,j.jsxs)(rn.B,{direction:"column",children:[ke&&(0,j.jsx)(In.F,{title:"Calculations will not have an effect if no fields are being grouped on.",severity:"warning"}),ue.map(Ze=>(0,j.jsx)(Gs,{onConfigChange:Ce(Ze),fieldName:Ze,config:_.fields[Ze]},Ze))]})},ds=[{label:"Group by",value:Tn.R3.groupBy},{label:"Calculate",value:Tn.R3.aggregate}],Gs=({fieldName:F,config:_,onConfigChange:Q})=>{const ue=(0,Dt.$j)(),Ce=js(ue),Oe=(0,d.useCallback)(we=>{Q({aggregations:_?.aggregations??[],operation:we?.value??null})},[_,Q]);return(0,j.jsx)(ae.I,{className:Ce.label,label:F,grow:!0,shrink:!0,children:(0,j.jsxs)(rn.B,{gap:.5,direction:"row",children:[(0,j.jsx)("div",{className:Ce.operation,children:(0,j.jsx)(Te.l6,{options:ds,value:_?.operation,placeholder:"Ignored",onChange:Oe,isClearable:!0})}),_?.operation===Tn.R3.aggregate&&(0,j.jsx)(an.S,{className:Ce.aggregations,placeholder:"Select Stats",allowMultiple:!0,stats:_.aggregations,onChange:we=>{Q({..._,aggregations:we})}})]})})},js=F=>({label:(0,Ye.css)`
      label {
        min-width: ${F.spacing(32)};
      }
    `,operation:(0,Ye.css)`
      flex-shrink: 0;
      height: 100%;
      width: ${F.spacing(24)};
    `,aggregations:(0,Ye.css)`
      flex-grow: 1;
    `}),Ca={id:te.F.groupBy,editor:cs,transformation:le.c.groupByTransformer,name:le.c.groupByTransformer.name,description:le.c.groupByTransformer.description,categories:new Set([x.m.Combine,x.m.CalculateNewFields,x.m.Reformat]),help:de(te.F.groupBy).helperDocs};var Aa=e(68133),qs=e(88575);const xs=({input:F,options:_,onChange:Q})=>{const ue=(0,Se.ZI)(F),Ce=_.showSubframeHeaders===void 0?Aa.l:_.showSubframeHeaders,Oe=(0,d.useCallback)(mt=>Ct=>{Q({..._,fields:{..._.fields,[mt]:Ct}})},[Q]),we=(0,d.useCallback)(()=>{const mt=_.showSubframeHeaders===void 0?!Aa.l:!_.showSubframeHeaders;Q({showSubframeHeaders:mt,fields:{..._.fields}})},[Q]);let ke,Ze=!1;for(const mt of Object.values(_.fields))mt.aggregations.length>0&&mt.operation!==null&&(Ze=!0),mt.operation===Tn.R3.groupBy&&(ke=!0);const dt=Ze&&!ke;return(0,j.jsxs)(rn.B,{direction:"column",children:[dt&&(0,j.jsx)(In.F,{title:"Calculations will not have an effect if no fields are being grouped on.",severity:"warning"}),(0,j.jsx)("div",{children:ue.map(mt=>(0,j.jsx)(fr,{onConfigChange:Oe(mt),fieldName:mt,config:_.fields[mt]},mt))}),(0,j.jsx)(qs.D,{label:"Show field names in nested tables",description:"If enabled nested tables will show field names as a table header",children:(0,j.jsx)(Jn.d,{value:Ce,onChange:we})})]})},Er=[{label:"Group by",value:Tn.R3.groupBy},{label:"Calculate",value:Tn.R3.aggregate}],fr=({fieldName:F,config:_,onConfigChange:Q})=>{const ue=(0,Dt.$j)(),Ce=gr(ue),Oe=(0,d.useCallback)(we=>{Q({aggregations:_?.aggregations??[],operation:we?.value??null})},[_,Q]);return(0,j.jsx)(ae.I,{className:Ce.label,label:F,grow:!0,shrink:!0,children:(0,j.jsxs)(rn.B,{gap:.5,direction:"row",wrap:!1,children:[(0,j.jsx)("div",{className:Ce.operation,children:(0,j.jsx)(Te.l6,{options:Er,value:_?.operation,placeholder:"Ignored",onChange:Oe,isClearable:!0})}),_?.operation===Tn.R3.aggregate&&(0,j.jsx)(an.S,{className:Ce.aggregations,placeholder:"Select Stats",allowMultiple:!0,stats:_.aggregations,onChange:we=>{Q({..._,aggregations:we})}})]})})},gr=F=>({label:(0,Ye.css)({minWidth:F.spacing(32)}),operation:(0,Ye.css)({flexShrink:0,height:"100%",width:F.spacing(24)}),aggregations:(0,Ye.css)({flexGrow:1})}),Rr={id:te.F.groupToNestedTable,editor:xs,transformation:le.c.groupToNestedTable,name:le.c.groupToNestedTable.name,description:le.c.groupToNestedTable.description,categories:new Set([x.m.Combine,x.m.CalculateNewFields,x.m.Reformat]),state:ft.pn.beta};var Dr=e(81010);const Mo=({input:F,options:_,onChange:Q})=>{const ue=(0,Se.ZI)(F).map(dt=>({label:dt,value:dt})),Ce=(0,d.useCallback)(dt=>{Q({..._,columnField:dt?.value})},[Q,_]),Oe=(0,d.useCallback)(dt=>{Q({..._,rowField:dt?.value})},[Q,_]),we=(0,d.useCallback)(dt=>{Q({..._,valueField:dt?.value})},[Q,_]),ke=[{label:"Null",value:Dr.N.Null,description:"Null value"},{label:"True",value:Dr.N.True,description:"Boolean true value"},{label:"False",value:Dr.N.False,description:"Boolean false value"},{label:"Empty",value:Dr.N.Empty,description:"Empty string"}],Ze=(0,d.useCallback)(dt=>{Q({..._,emptyValue:dt?.value})},[Q,_]);return(0,j.jsx)(j.Fragment,{children:(0,j.jsxs)(fe.C,{children:[(0,j.jsx)(ae.I,{label:"Column",labelWidth:8,children:(0,j.jsx)(Te.l6,{options:ue,value:_.columnField,onChange:Ce,isClearable:!0})}),(0,j.jsx)(ae.I,{label:"Row",labelWidth:8,children:(0,j.jsx)(Te.l6,{options:ue,value:_.rowField,onChange:Oe,isClearable:!0})}),(0,j.jsx)(ae.I,{label:"Cell Value",labelWidth:10,children:(0,j.jsx)(Te.l6,{options:ue,value:_.valueField,onChange:we,isClearable:!0})}),(0,j.jsx)(ae.I,{label:"Empty Value",children:(0,j.jsx)(Te.l6,{options:ke,value:_.emptyValue,onChange:Ze,isClearable:!0})})]})})},So={id:te.F.groupingToMatrix,editor:Mo,transformation:le.c.groupingToMatrixTransformer,name:le.c.groupingToMatrixTransformer.name,description:"Takes a three fields combination and produces a Matrix.",categories:new Set([x.m.Combine,x.m.Reformat]),help:de(te.F.groupingToMatrix).helperDocs};var Ka=e(77678);const Sa=({input:F,options:_,onChange:Q})=>{const[Ce,Oe]=(0,d.useState)({bucketCount:!(0,Se.N_)(_.bucketCount||""),bucketSize:!(0,Se.N_)(_.bucketSize||""),bucketOffset:!(0,Se.N_)(_.bucketOffset||"")}),we=(0,d.useCallback)(Wt=>{Q({..._,bucketCount:Wt})},[Q,_]),ke=(0,d.useCallback)(Wt=>{Q({..._,bucketSize:Wt})},[Q,_]),Ze=(0,d.useCallback)(Wt=>{Q({..._,bucketOffset:Wt})},[Q,_]),dt=(0,d.useCallback)(Wt=>{Oe({...Ce,bucketCount:!(0,Se.N_)(Wt)}),Q({..._,bucketCount:Number(Wt)===0?void 0:Number(Wt)})},[Q,_,Ce]),mt=(0,d.useCallback)(Wt=>{Oe({...Ce,bucketSize:!(0,Se.N_)(Wt)}),Q({..._,bucketSize:Wt})},[Q,_,Ce,Oe]),Ct=(0,d.useCallback)(Wt=>{Oe({...Ce,bucketOffset:!(0,Se.N_)(Wt)}),Q({..._,bucketOffset:Wt})},[Q,_,Ce,Oe]),Kt=(0,d.useCallback)(()=>{Q({..._,combine:!_.combine})},[Q,_]),Mt=(0,Be.w)().getVariables().map(Wt=>({value:Wt.name,label:Wt.label||Wt.name,origin:He.$0.Template}));if(!se.$.featureToggles.transformationsVariableSupport){let Wt;typeof _.bucketSize=="string"?Wt=parseInt(_.bucketSize,10):Wt=_.bucketSize;let vn;return typeof _.bucketOffset=="string"?vn=parseInt(_.bucketOffset,10):vn=_.bucketOffset,(0,j.jsxs)("div",{children:[(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{labelWidth:18,label:Ka.Rt.bucketCount.name,tooltip:Ka.Rt.bucketCount.description,children:(0,j.jsx)(pa.Q,{value:_.bucketCount,placeholder:"Default: 30",onChange:we,min:0})})}),(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{labelWidth:18,label:Ka.Rt.bucketSize.name,tooltip:Ka.Rt.bucketSize.description,children:(0,j.jsx)(pa.Q,{value:Wt,placeholder:"auto",onChange:ke,min:0})})}),(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{labelWidth:18,label:Ka.Rt.bucketOffset.name,tooltip:Ka.Rt.bucketOffset.description,children:(0,j.jsx)(pa.Q,{value:vn,placeholder:"none",onChange:Ze,min:0})})}),(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{labelWidth:18,label:Ka.Rt.combine.name,tooltip:Ka.Rt.combine.description,children:(0,j.jsx)(Jn.K,{value:_.combine??!1,onChange:Kt})})})]})}return(0,j.jsxs)("div",{children:[(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{invalid:Ce.bucketCount,error:"Value needs to be an integer or a variable",labelWidth:18,label:Ka.Rt.bucketCount.name,tooltip:Ka.Rt.bucketCount.description,children:(0,j.jsx)(Re.y,{suggestions:Mt,value:_.bucketCount,placeholder:"Default: 30",onChange:dt})})}),(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{invalid:Ce.bucketSize,error:"Value needs to be an integer or a variable",labelWidth:18,label:Ka.Rt.bucketSize.name,tooltip:Ka.Rt.bucketSize.description,children:(0,j.jsx)(Re.y,{suggestions:Mt,value:_.bucketSize,placeholder:"auto",onChange:mt})})}),(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{labelWidth:18,label:Ka.Rt.bucketOffset.name,tooltip:Ka.Rt.bucketOffset.description,invalid:Ce.bucketOffset,error:"Value needs to be an integer or a variable",children:(0,j.jsx)(Re.y,{suggestions:Mt,value:_.bucketOffset,placeholder:"none",onChange:Ct})})}),(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{labelWidth:18,label:Ka.Rt.combine.name,tooltip:Ka.Rt.combine.description,children:(0,j.jsx)(Jn.K,{value:_.combine??!1,onChange:Kt})})})]})},Za={id:te.F.histogram,editor:Sa,transformation:le.c.histogramTransformer,name:le.c.histogramTransformer.name,description:le.c.histogramTransformer.description,categories:new Set([x.m.CreateNewVisualization]),help:de(te.F.histogram).helperDocs};var ur=e(41511),da=e(64278);const ro=[{value:ur.W.outer,label:"OUTER (TIME SERIES)",description:"Keep all rows from any table with a value. Join on distinct field values. Performant and best used for time series."},{value:ur.W.outerTabular,label:"OUTER (TABULAR)",description:"Join on a field value with duplicated values. Non performant outer join best used for tabular(SQL like) data."},{value:ur.W.inner,label:"INNER",description:"Combine data from two tables whenever there are matching values in a fields common to both tables."}];function Uo({input:F,options:_,onChange:Q}){const ue=(0,da.sE)(F),Ce=(0,da.m3)(ue),Oe=(0,Be.w)().getVariables().map(Ze=>({value:"$"+Ze.name,label:"$"+Ze.name})),we=(0,d.useCallback)(Ze=>{Q({..._,byField:Ze?.value})},[Q,_]),ke=(0,d.useCallback)(Ze=>{Q({..._,mode:Ze?.value})},[Q,_]);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{label:"Mode",labelWidth:8,grow:!0,children:(0,j.jsx)(Te.l6,{options:ro,value:_.mode??ur.W.outer,onChange:ke})})}),(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{label:"Field",labelWidth:8,grow:!0,children:(0,j.jsx)(Te.l6,{options:[...Ce,...Oe],value:_.byField,onChange:we,placeholder:"time",isClearable:!0})})})]})}const No={id:te.F.joinByField,aliasIds:[te.F.seriesToColumns],editor:Uo,transformation:le.c.joinByFieldTransformer,name:le.c.joinByFieldTransformer.name,description:le.c.joinByFieldTransformer.description,categories:new Set([x.m.Combine]),help:de(te.F.joinByField).helperDocs};var wo=e(6829);const Di=[{value:wo.n.Columns,label:"Columns"},{value:wo.n.Rows,label:"Rows"}],ii=({input:F,options:_,onChange:Q})=>{const{labelNames:Ce,selected:Oe}=(0,d.useMemo)(()=>{let Ze=[],dt={};for(const Ct of F)for(const Kt of Ct.fields)if(Kt.labels)for(const Bt of Object.keys(Kt.labels))dt[Bt]||(Ze.push({value:Bt,label:Bt}),dt[Bt]=!0);const mt=new Set(_.keepLabels?.length?_.keepLabels:Object.keys(dt));return{labelNames:Ze,selected:mt}},[_.keepLabels,F]),we=Ze=>{Q({..._,valueLabel:Ze?.value})},ke=Ze=>{if(Oe.has(Ze)?Oe.delete(Ze):Oe.add(Ze),Oe.size===Ce.length||!Oe.size){const{keepLabels:dt,...mt}=_;Q(mt)}else Q({..._,keepLabels:[...Oe]})};return(0,j.jsxs)("div",{children:[(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{label:"Mode",labelWidth:20,children:(0,j.jsx)(re.z,{options:Di,value:_.mode??wo.n.Columns,onChange:Ze=>Q({..._,mode:Ze})})})}),(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{label:"Labels",labelWidth:20,children:(0,j.jsx)(rn.B,{gap:1,wrap:"wrap",children:Ce.map((Ze,dt)=>{const mt=Ze.label;return(0,j.jsx)(Ms.m,{onClick:()=>ke(mt),label:mt,selected:Oe.has(mt)},`${mt}/${dt}`)})})})}),_.mode!==wo.n.Rows&&(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{label:"Value field name",labelWidth:20,tooltip:"Replace the value field name with a label",htmlFor:"labels-to-fields-as-name",children:(0,j.jsx)(Te.l6,{inputId:"labels-to-fields-as-name",isClearable:!0,allowCustomValue:!1,placeholder:"(Optional) Select label",options:Ce,value:_?.valueLabel,onChange:we,className:"min-width-16"})})})]})},Wo={id:te.F.labelsToFields,editor:ii,transformation:le.c.labelsToFieldsTransformer,name:le.c.labelsToFieldsTransformer.name,description:`Groups series by time and return labels or tags as fields.
                Useful for showing time series with labels in a table where each label key becomes a separate column.`,categories:new Set([x.m.Reformat]),help:de(te.F.labelsToFields).helperDocs},li=({options:F,onChange:_})=>{const[Q,ue]=(0,d.useState)(!1),Ce=(0,d.useCallback)(Ze=>{_({...F,limitField:Number(Ze.currentTarget.value)})},[_,F]),Oe=(0,d.useCallback)(Ze=>{ue(!(0,Se.N_)(Ze)),_({...F,limitField:Ze})},[_,F]),ke=(0,Be.w)().getVariables().map(Ze=>({value:Ze.name,label:Ze.label||Ze.name,origin:He.$0.Template}));return se.$.featureToggles.transformationsVariableSupport?(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(fe.C,{children:(0,j.jsx)(Re.y,{invalid:Q,error:"Value needs to be an integer or a variable",value:String(F.limitField),onChange:Oe,placeholder:"Value or variable",suggestions:ke})})}):(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{label:"Limit",labelWidth:8,children:(0,j.jsx)(Ne.p,{placeholder:"Limit count",pattern:"[0-9]*",value:F.limitField,onChange:Ce,width:25})})})})},nl={id:te.F.limit,editor:li,transformation:le.c.limitTransformer,name:le.c.limitTransformer.name,description:"Limit the number of items displayed.",categories:new Set([x.m.Filter]),help:de(te.F.limit).helperDocs},Mr=({input:F,options:_,onChange:Q})=>F.length<=1?(0,j.jsx)(ha.P,{children:"Merge has no effect when applied on a single frame."}):null,Fi={id:te.F.merge,editor:Mr,transformation:le.c.mergeTransformer,name:le.c.mergeTransformer.name,description:`Merge many series/tables and return a single table where mergeable values will be combined into the same row.
                Useful for showing multiple series, tables or a combination of both visualized in a table.`,categories:new Set([x.m.Combine]),help:de(te.F.merge).helperDocs};var Pi=e(82280),mr=e(94753);const ci=({options:F,input:_,onChange:Q})=>{const{indexByName:ue,excludeByName:Ce,renameByName:Oe,includeByName:we}=F,ke=(0,Se.ZI)(_),Ze=(0,d.useMemo)(()=>$i(ke,ue),[ke,ue]),dt=we&&Object.keys(we).length>0?"include":"exclude",mt=(0,d.useCallback)((Mt,Wt)=>{Q({...F,excludeByName:{...Ce,[Mt]:Wt}})},[Q,F,Ce]),Ct=(0,d.useCallback)((Mt,Wt)=>{const vn={...F,includeByName:{...we,[Mt]:!Wt}};Q(vn)},[Q,F,we]),Kt=(0,d.useCallback)(Mt=>{if(!Mt||!Mt.destination)return;const Wt=Mt.source.index,vn=Mt.destination.index;Wt!==vn&&Q({...F,indexByName:Ki(ke,Wt,vn)})},[Q,F,ke]),Bt=(0,d.useCallback)((Mt,Wt)=>{Q({...F,renameByName:{...F.renameByName,[Mt]:Wt}})},[Q,F]);return _.length>1?(0,j.jsx)(ha.P,{children:"Organize fields only works with a single frame. Consider applying a join transformation or filtering the input first."}):(0,j.jsx)(Ea.JY,{onDragEnd:Kt,children:(0,j.jsx)(Ea.gL,{droppableId:"sortable-fields-transformer",direction:"vertical",children:Mt=>(0,j.jsxs)("div",{ref:Mt.innerRef,...Mt.droppableProps,children:[Ze.map((Wt,vn)=>{const ns=we&&Wt in we?we[Wt]:!1,Ks=dt==="include"?ns:!Ce[Wt],bs=dt==="include"?Ct:mt;return(0,j.jsx)(Qo,{fieldName:Wt,renamedFieldName:Oe[Wt],index:vn,onToggleVisibility:bs,onRenameField:Bt,visible:Ks},Wt)}),Mt.placeholder]})})})};ci.displayName="OrganizeFieldsTransformerEditor";const Qo=({fieldName:F,renamedFieldName:_,index:Q,visible:ue,onToggleVisibility:Ce,onRenameField:Oe})=>{const we=(0,Dt.of)(Vr);return(0,j.jsx)(Ea.sx,{draggableId:F,index:Q,children:ke=>(0,j.jsxs)(ce.a,{marginBottom:.5,display:"flex",gap:0,ref:ke.innerRef,...ke.draggableProps,children:[(0,j.jsx)(xt.c,{width:60,as:"div",children:(0,j.jsxs)(rn.B,{gap:0,justifyContent:"flex-start",alignItems:"center",width:"100%",children:[(0,j.jsx)("span",{...ke.dragHandleProps,children:(0,j.jsx)(Ys.I,{name:"draggabledots",title:"Drag and drop to reorder",size:"lg",className:we.draggable})}),(0,j.jsx)(ja.K,{className:we.toggle,size:"md",name:ue?"eye":"eye-slash",onClick:()=>Ce(F,ue),tooltip:ue?"Disable":"Enable"}),(0,j.jsx)(mr.E,{truncate:!0,element:"p",variant:"bodySmall",weight:"bold",children:F})]})}),(0,j.jsx)(Ne.p,{defaultValue:_||"",placeholder:`Rename ${F}`,onBlur:Ze=>Oe(F,Ze.currentTarget.value)})]})})};Qo.displayName="DraggableFieldName";const Vr=F=>({toggle:(0,Ye.css)({margin:F.spacing(0,1),color:F.colors.text.secondary}),draggable:(0,Ye.css)({opacity:.4,"&:hover":{color:F.colors.text.maxContrast}})}),Ki=(F,_,Q)=>{const ue=Array.from(F),[Ce]=ue.splice(_,1);return ue.splice(Q,0,Ce),ue.reduce((Oe,we,ke)=>(Oe[we]=ke,Oe),{})},$i=(F,_={})=>{if(!_||Object.keys(_).length===0)return F;const Q=(0,Pi.X)(_);return F.sort(Q)},vo={id:te.F.organize,editor:ci,transformation:le.c.organizeFieldsTransformer,name:le.c.organizeFieldsTransformer.name,description:"Allows the user to re-order, hide, or rename fields / columns. Useful when data source doesn't allow overrides for visualizing data.",categories:new Set([x.m.ReorderAndRename]),help:de(te.F.organize).helperDocs};var oo=e(21128),sr=e(13544);const di=({options:F,onChange:_})=>{const Q=[{label:"Series to rows",value:oo.rV.SeriesToRows,description:"Create a table with one row for each series value"},{label:"Reduce fields",value:oo.rV.ReduceFields,description:"Collapse each field into a single value"}],ue=(0,d.useCallback)(we=>{const ke=we.value;_({...F,mode:ke,includeTimeField:ke===oo.rV.ReduceFields?!!F.includeTimeField:!1})},[_,F]),Ce=(0,d.useCallback)(()=>{_({...F,includeTimeField:!F.includeTimeField})},[_,F]),Oe=(0,d.useCallback)(()=>{_({...F,labelsToFields:!F.labelsToFields})},[_,F]);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(ae.I,{label:"Mode","data-testid":sr.Tp.components.Transforms.Reduce.modeLabel,grow:!0,labelWidth:16,children:(0,j.jsx)(Te.l6,{options:Q,value:Q.find(we=>we.value===F.mode)||Q[0],onChange:ue})}),(0,j.jsx)(ae.I,{label:"Calculations","data-testid":sr.Tp.components.Transforms.Reduce.calculationsLabel,grow:!0,labelWidth:16,children:(0,j.jsx)(an.S,{placeholder:"Choose Stat",allowMultiple:!0,stats:F.reducers||[],onChange:we=>{_({...F,reducers:we})}})}),F.mode===oo.rV.ReduceFields&&(0,j.jsx)(ae.I,{htmlFor:"include-time-field",labelWidth:16,label:"Include time",children:(0,j.jsx)(Jn.K,{id:"include-time-field",value:!!F.includeTimeField,onChange:Ce})}),F.mode!==oo.rV.ReduceFields&&(0,j.jsx)(ae.I,{htmlFor:"labels-to-fields",labelWidth:16,label:"Labels to fields",children:(0,j.jsx)(Jn.K,{id:"labels-to-fields",value:!!F.labelsToFields,onChange:Oe})})]})},sl={id:te.F.reduce,editor:di,transformation:le.c.reduceTransformer,name:le.c.reduceTransformer.name,description:le.c.reduceTransformer.description,categories:new Set([x.m.CalculateNewFields]),help:de(te.F.reduce).helperDocs};class Vi extends d.PureComponent{constructor(_){super(_),this.handleRegexChange=Q=>{const ue=Q.currentTarget.value;let Ce=!0;if(ue)try{ue&&(0,$r.dO)(ue)}catch{Ce=!1}this.setState(Oe=>({...Oe,regex:ue,isRegexValid:Ce}))},this.handleRenameChange=Q=>{const ue=Q.currentTarget.value;this.setState(Ce=>({...Ce,renamePattern:ue}))},this.handleRegexBlur=Q=>{const ue=Q.currentTarget.value;let Ce=!0;try{ue&&(0,$r.dO)(ue)}catch{Ce=!1}this.setState({isRegexValid:Ce},()=>{Ce&&this.props.onChange({...this.props.options,regex:ue})})},this.handleRenameBlur=Q=>{const ue=Q.currentTarget.value;this.setState({renamePattern:ue},()=>this.props.onChange({...this.props.options,renamePattern:ue}))},this.state={regex:_.options.regex,renamePattern:_.options.renamePattern,isRegexValid:!0}}render(){const{regex:_,renamePattern:Q,isRegexValid:ue}=this.state;return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(ae.I,{label:"Match",labelWidth:16,invalid:!ue,error:ue?void 0:"Invalid pattern",children:(0,j.jsx)(Ne.p,{placeholder:"Regular expression pattern",value:_||"",onChange:this.handleRegexChange,onBlur:this.handleRegexBlur,width:25})}),(0,j.jsx)(ae.I,{label:"Replace",labelWidth:16,children:(0,j.jsx)(Ne.p,{placeholder:"Replacement pattern",value:Q||"",onChange:this.handleRenameChange,onBlur:this.handleRenameBlur,width:25})})]})}}const al={id:te.F.renameByRegex,editor:Vi,transformation:le.c.renameByRegexTransformer,name:le.c.renameByRegexTransformer.name,description:"Renames part of the query result by using regular expression with placeholders.",categories:new Set([x.m.ReorderAndRename]),help:de(te.F.renameByRegex).helperDocs},_i=({input:F,options:_,onChange:Q})=>null,rl={id:te.F.seriesToRows,editor:_i,transformation:le.c.seriesToRowsTransformer,name:le.c.seriesToRowsTransformer.name,description:`Merge many series and return a single series with time, metric and value as columns.
                Useful for showing multiple time series visualized in a table.`,categories:new Set([x.m.Combine,x.m.Reformat]),help:de(te.F.seriesToRows).helperDocs},zi=({input:F,options:_,onChange:Q})=>{const ue=(0,Se.ZI)(F).map(Ze=>({label:Ze,value:Ze})),Oe=(0,Be.w)().getVariables().map(Ze=>({label:"$"+Ze.name,value:"$"+Ze.name})),we=(0,d.useCallback)((Ze,dt)=>{Q({..._,sort:[dt]})},[Q,_]),ke=_.sort?.length?_.sort:[{}];return(0,j.jsx)("div",{children:ke.map((Ze,dt)=>(0,j.jsxs)(fe.C,{children:[(0,j.jsx)(ae.I,{label:"Field",labelWidth:10,grow:!0,children:(0,j.jsx)(Te.l6,{options:se.$.featureToggles.transformationsVariableSupport?[...ue,...Oe]:ue,value:Ze.field,placeholder:"Select field",onChange:mt=>{we(dt,{...Ze,field:mt.value})}})}),(0,j.jsx)(ae.I,{label:"Reverse",children:(0,j.jsx)(Jn.K,{value:!!Ze.desc,onChange:()=>{we(dt,{...Ze,desc:!Ze.desc})}})})]},`${Ze.field}/${dt}`))})},ol={id:te.F.sortBy,editor:zi,transformation:le.c.sortByTransformer,name:le.c.sortByTransformer.name,description:le.c.sortByTransformer.description,categories:new Set([x.m.ReorderAndRename]),help:de(te.F.sortBy).helperDocs};function Hi({options:F,onChange:_}){const[Q,ue]=(0,d.useState)(F),Ce=ki(),Oe=Fo(),we=()=>{Q.push({path:""}),ue([...Q]),dt()},ke=mt=>{Q&&(Q.splice(mt,1),ue([...Q]),dt())},Ze=(mt,Ct,Kt)=>{Q&&(Kt==="alias"?Q[Ct].alias=mt.currentTarget.value??"":Q[Ct].path=mt.currentTarget.value??"",ue([...Q]))},dt=()=>{_(Q)};return(0,j.jsxs)("ol",{className:(0,Ye.cx)(Oe.list),children:[Q&&Q.map((mt,Ct)=>(0,j.jsx)("li",{children:(0,j.jsxs)(fe.C,{children:[(0,j.jsx)(ae.I,{label:"Field",tooltip:Ce.field,grow:!0,children:(0,j.jsx)(Ne.p,{onBlur:dt,onChange:Kt=>Ze(Kt,Ct,"path"),value:mt.path,placeholder:'A valid json path, e.g. "object.value1" or "object.value2[0]"'})}),(0,j.jsx)(ae.I,{label:"Alias",tooltip:Ce.alias,children:(0,j.jsx)(Ne.p,{width:12,value:mt.alias,onBlur:dt,onChange:Kt=>Ze(Kt,Ct,"alias")})}),(0,j.jsx)(ae.I,{className:(0,Ye.cx)(Oe.removeIcon),children:(0,j.jsx)(ja.K,{onClick:()=>ke(Ct),name:"trash-alt",tooltip:"Remove path"})})]})},Ct)),(0,j.jsx)(ae.I,{children:(0,j.jsx)(me.$n,{icon:"plus",onClick:()=>we(),variant:"secondary",children:"Add path"})})]})}const ki=()=>{const F=[{path:"object",description:"=> extract fields from object"},{path:"object.value1",description:"=> extract value1"},{path:"object.value2",description:"=> extract value2"},{path:"object.value2[0]",description:"=> extract value2 first element"},{path:"object.value2[1]",description:"=> extract value2 second element"}];return{field:(0,j.jsxs)("div",{children:["A valid path of an json object.",(0,j.jsx)("div",{children:(0,j.jsx)("strong",{children:"JSON Value:"})}),(0,j.jsx)("pre",{children:(0,j.jsx)("code",{children:["{",'  "object": {','    "value1": "hello world"','    "value2": [1, 2, 3, 4]',"  }","}"].join(`
`)})}),(0,j.jsx)("strong",{children:"Valid Paths:"}),F.map((_,Q)=>(0,j.jsxs)("p",{children:[(0,j.jsx)("code",{children:_.path}),(0,j.jsx)("i",{children:_.description})]},Q))]}),alias:"An alias name for the variable in the dashboard. If left blank the given path will be used."}};function Fo(){return{list:(0,Ye.css)`
      margin-left: 20px;
    `,removeIcon:(0,Ye.css)`
      margin: 0 0 0 4px;
      align-items: center;
    `}}var Ko=e(14236),yo=(F=>(F.JSON="json",F.KeyValues="kvp",F.Auto="auto",F))(yo||{});const Oo={id:yo.JSON,name:"JSON",description:"Parse JSON string",parse:F=>JSON.parse(F)};function il(F){const _=[];let Q="",ue="";const Ce={};for(let Oe=0;Oe<F.length;Oe++){let we=F[Oe];we===Q&&(Q="",we=F[++Oe]);const ke=we==="\\";if(ke&&(we=F[++Oe]),ke||Q.length){_.push(we);continue}switch((we==='"'||we==="'")&&(Q=we),we){case":":case"=":_.length&&(ue&&(Ce[ue]=""),ue=_.join(""),_.length=0);break;case'"':case"'":case" ":case`
`:case"	":case"\r":case`
`:_.length&&ue===""&&(Ce[_.join("")]="",_.length=0);case",":case";":case"&":case"{":case"}":if(_.length){const Ze=_.join("");ue.length?(Ce[ue]=Ze,ue=""):ue=Ze,_.length=0}break;default:_.push(we),Oe===F.length-1&&ue===""&&_.length&&(Ce[_.join("")]="",_.length=0)}}return ue.length&&(Ce[ue]=_.join("")),Ce}const bi={id:yo.KeyValues,name:"Key+value pairs",description:"Look for a=b, c: d values in the line",parse:il},go=[Oo,bi],$o={id:yo.Auto,name:"Auto",description:"parse new fields automatically",parse:F=>{for(const _ of go)try{const Q=_.parse(F);if(Q!=null)return Q}catch{}}},Yo=new je.O(()=>[...go,$o]),Sr={id:te.F.extractFields,name:"Extract fields",description:"Parse fields from the contends of another",defaultOptions:{},operator:(F,_)=>Q=>Q.pipe((0,Rt.T)(ue=>Sr.transformer(F,_)(ue))),transformer:F=>_=>_.map(Q=>Jo(Q,F))};function Jo(F,_){if(!_.source)return F;const Q=(0,Pa.findField)(F,_.source);if(!Q)return F;const ue=Yo.getIfExists(_.format??yo.Auto);if(!ue)throw new Error("unkonwn extractor");const Ce=F.length,Oe=[],we=new Map;for(let Ze=0;Ze<Ce;Ze++){let dt=Q.values[Ze];if((0,m.isString)(dt))try{dt=ue.parse(dt)}catch{dt={}}if(dt!=null){if(_.format===yo.JSON&&_.jsonPaths&&_.jsonPaths?.length>0){const mt={},Ct=_.jsonPaths.filter(Kt=>Kt.path);Ct.length>0&&(Ct.forEach(Kt=>{const Bt=Kt.alias&&Kt.alias.length>0?Kt.alias:Kt.path;mt[Bt]=(0,m.get)(dt,Kt.path)??"Not Found"}),dt=mt)}for(const[mt,Ct]of Object.entries(dt)){let Kt=we.get(mt);Kt==null&&(Kt=new Array(Ce).fill(void 0),we.set(mt,Kt),Oe.push(mt)),Kt[Ze]=Ct}}}const ke=Oe.map(Ze=>{const dt=we.get(Ze),mt={name:Ze,values:dt,type:dt?(0,Ko.oE)(dt.find(Ct=>Ct!=null)):q.PU.other,config:{}};return se.$.featureToggles.extractFieldsNameDeduplication&&(mt.name=(0,z.fk)(mt,F)),mt});if(_.keepTime){const Ze=(0,Pa.findField)(F,"Time")||(0,Pa.findField)(F,"time");Ze&&ke.unshift(Ze)}return _.replace||ke.unshift(...F.fields),{...F,fields:ke}}const xo={settings:{width:30,placeholderText:"Select field"},name:"",id:"",editor:()=>null},Xo=({input:F,options:_,onChange:Q})=>{const ue=dt=>{Q({..._,source:dt})},Ce=dt=>{Q({..._,format:dt?.value})},Oe=dt=>{Q({..._,jsonPaths:dt})},we=()=>{_.replace&&(_.keepTime=!1),Q({..._,replace:!_.replace})},ke=()=>{Q({..._,keepTime:!_.keepTime})},Ze=Yo.selectOptions(_.format?[_.format]:void 0);return(0,j.jsxs)("div",{children:[(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{label:"Source",labelWidth:16,children:(0,j.jsx)(Ss.O,{context:{data:F},value:_.source??"",onChange:ue,item:xo})})}),(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{label:"Format",labelWidth:16,children:(0,j.jsx)(Te.l6,{value:Ze.current[0],options:Ze.options,onChange:Ce,width:24,placeholder:"Auto"})})}),_.format==="json"&&(0,j.jsx)(Hi,{options:_.jsonPaths??[],onChange:Oe}),(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{label:"Replace all fields",labelWidth:16,children:(0,j.jsx)(Jn.K,{value:_.replace??!1,onChange:we})})}),_.replace&&(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{label:"Keep time",labelWidth:16,children:(0,j.jsx)(Jn.K,{value:_.keepTime??!1,onChange:ke})})})]})},Bl={id:te.F.extractFields,editor:Xo,transformation:Sr,name:Sr.name,description:"Parse fields from content (JSON, labels, etc).",categories:new Set([x.m.Reformat]),help:de(te.F.extractFields).helperDocs};var po=e(51986);const zr={id:te.F.joinByLabels,name:"Join by labels",description:"Flatten labeled results into a table joined by labels.",defaultOptions:{},operator:(F,_)=>Q=>Q.pipe((0,Rt.T)(ue=>zr.transformer(F,_)(ue))),transformer:F=>_=>!_||!_.length?_:[Ci(F,_)]};function Ci(F,_){if(!F.value?.length)return Zo("No value labele configured");const Q=(0,Se.aG)(_);if(Q.size<1)return Zo("No labels in result");if(!Q.has(F.value))return Zo("Value label not found");let ue=F.join?.length?F.join:Array.from(Q);ue=ue.filter(Ct=>Ct!==F.value);const Ce=new Set,Oe=new Map,we={};for(const Ct of _)for(const Kt of Ct.fields)if(Kt.labels&&Kt.type!==q.PU.time){const Bt=ue.map(bs=>Kt.labels[bs]),Mt=Bt.join(",");let Wt=Oe.get(Mt);Wt||(Wt={keys:Bt,values:{}},Oe.set(Mt,Wt));const vn=Kt.labels[F.value],ns=Kt.values,Ks=Wt.values[vn];Ks?Wt.values[vn]=Ks.concat(ns):Wt.values[vn]=ns,we[vn]||(we[vn]=Kt),Ce.add(vn)}const ke=Array.from(Ce),Ze=ue.map(()=>[]),dt=ke.map(()=>[]);for(const Ct of Oe.values()){let Kt=-1,Bt=!1;for(;!Bt;){Kt++,Bt=!0;for(let Mt=0;Mt<ue.length;Mt++)Ze[Mt].push(Ct.keys[Mt]);for(let Mt=0;Mt<ke.length;Mt++){const Wt=ke[Mt],vn=Ct.values[Wt]??[];dt[Mt].push(vn[Kt]),vn.length>Kt+1&&(Bt=!1)}}}const mt={fields:[],length:dt[0].length};for(let Ct=0;Ct<ue.length;Ct++)mt.fields.push({name:ue[Ct],config:{},type:q.PU.string,values:Ze[Ct]});for(let Ct=0;Ct<ke.length;Ct++){const Kt=we[ke[Ct]];mt.fields.push({name:ke[Ct],config:{},type:Kt.type??q.PU.number,values:dt[Ct]})}return mt}function Zo(F){return{meta:{notices:[{severity:"error",text:F}]},fields:[{name:"Error",type:q.PU.string,config:{},values:[F]}],length:0}}function Gi({input:F,options:_,onChange:Q}){const ue=(0,d.useMemo)(()=>{let Ze;const dt=(0,Se.aG)(F),mt=Array.from(dt).map(vn=>({label:vn,value:vn}));let Ct=mt.find(vn=>vn.value===_.value);!Ct&&_.value&&(Ct={label:`${_.value} (not found)`,value:_.value},mt.push(Ct)),F.length?dt.size===0&&(Ze=(0,j.jsx)(In.F,{title:"No labels found",children:"The input does not contain any labels"})):Ze=(0,j.jsx)(In.F,{title:"No input found",children:"No input (or labels) found"}),dt.delete(_.value);const Kt=Array.from(dt).map(vn=>({label:vn,value:vn}));let Bt=Kt;const Mt=!!_.join?.length;let Wt="Join";return Mt?Bt=Kt.filter(vn=>!_.join.includes(vn.value)):Wt=Kt.map(vn=>vn.value).join(", "),{warn:Ze,valueOptions:mt,valueOption:Ct,joinOptions:Kt,addOptions:Bt,addText:Wt,hasJoin:Mt,key:Date.now()}},[_,F]),Ce=(Ze,dt)=>{if(!_.join)return;const mt=_.join.slice();if(dt)mt[Ze]=dt;else if(mt.splice(Ze,1),!mt.length){Q({..._,join:void 0});return}const Ct=new Set(mt);_.value&&Ct.delete(_.value),Q({..._,join:Array.from(Ct)})},Oe=Ze=>{const dt=Ze?.value;if(!dt)return;const mt=_.join?_.join.slice():[];mt.push(dt),Q({..._,join:mt})},we=10,ke="No labels found";return(0,j.jsxs)("div",{children:[ue.warn,(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{error:"required",invalid:!_.value?.length,label:"Value",labelWidth:we,tooltip:"Select the label indicating the values name",children:(0,j.jsx)(Te.l6,{options:ue.valueOptions,value:ue.valueOption,onChange:Ze=>Q({..._,value:Ze.value}),noOptionsMessage:ke})})}),ue.hasJoin?_.join.map((Ze,dt)=>(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{label:"Join",labelWidth:we,error:"Unable to join by the value label",invalid:Ze===_.value,children:(0,j.jsxs)(Zs.Gy,{children:[(0,j.jsx)(Te.l6,{options:ue.joinOptions,value:ue.joinOptions.find(mt=>mt.value===Ze),isClearable:!0,onChange:mt=>Ce(dt,mt?.value),noOptionsMessage:ke}),!!(ue.addOptions.length&&dt===_.join.length-1)&&(0,j.jsx)(po.i,{icon:"plus",label:"",options:ue.addOptions,onChange:Oe,variant:"secondary"})]})})},Ze+dt)):(0,j.jsx)(j.Fragment,{children:!!ue.addOptions.length&&(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{label:"Join",labelWidth:we,children:(0,j.jsx)(Te.l6,{options:ue.addOptions,placeholder:ue.addText,onChange:Oe,noOptionsMessage:ke})})})})]})}const Io={id:zr.id,editor:Gi,transformation:zr,name:zr.name,description:zr.description,state:ft.pn.beta,categories:new Set([x.m.Combine]),help:de(zr.id).helperDocs};var qr=e(84350),Eo=e(69862),vr=e(65474),ui=e(67140);const Ti={id:te.F.fieldLookup,name:"Lookup fields from resource",description:"Retrieve matching data based on specified field",defaultOptions:{},operator:F=>_=>_.pipe((0,Eo.Z)(Q=>(0,vr.H)(ll(Q,F))))};async function ll(F,_){const Q=ne.sJ.get(oe.Ct.byName).get(_?.lookupField),ue=await(0,ui.q3)(_?.gazetteer??ui.fx);return ue.frame?hi(F,ue,Q):Promise.reject("missing frame in gazetteer")}function hi(F,_,Q){const ue=_.frame()?.fields;return ue?F.map(Ce=>{const Oe=Ce.length,we=[];for(const ke of Ce.fields)if(we.push(ke),Q(ke,Ce,F)){const Ze=ke.values,dt=[];for(const mt of ue){const Ct=new Array(Oe);dt.push(Ct),we.push({...mt,values:Ct})}for(let mt=0;mt<_.count;mt++){const Ct=_.find(Ze[mt]);if(Ct?.index!=null)for(let Kt=0;Kt<ue.length;Kt++)dt[Kt][mt]=ue[Kt].values[Ct.index]}}return{...Ce,fields:we}}):F}const cl={settings:{width:30,filter:F=>F.type===q.PU.string,placeholderText:"Select text field",noFieldsMessage:"No text fields found"},name:"",id:"",editor:()=>null},Mi={settings:{}},Si=({input:F,options:_,onChange:Q})=>{const ue=(0,d.useCallback)(Oe=>{Q({..._,lookupField:Oe})},[Q,_]),Ce=(0,d.useCallback)(Oe=>{Q({..._,gazetteer:Oe})},[Q,_]);return(0,j.jsxs)("div",{children:[(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{label:"Field",labelWidth:12,children:(0,j.jsx)(Ss.O,{context:{data:F},value:_?.lookupField??"",onChange:ue,item:cl})})}),(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{label:"Lookup",labelWidth:12,children:(0,j.jsx)(qr.G,{value:_?.gazetteer??"",context:{data:F},item:Mi,onChange:Ce})})})]})},Qi={id:te.F.fieldLookup,editor:Si,transformation:Ti,name:Ti.name,description:"Use a field value to lookup additional fields from an external source. This currently supports spatial data, but will eventually support more formats.",state:ft.pn.alpha,categories:new Set([x.m.PerformSpatialOperations]),help:de(te.F.fieldLookup).helperDocs};var Oi=e(35602),qo=e(64586);const Yi=(F,_,Q=[])=>(_===0?Q.push(F):F.forEach(ue=>{Yi(ue,_-1,Q)}),Q);function Fe(F){const _=F[0].length,Q=F.length,ue=new Map;for(let Ce=0;Ce<_;Ce++){let Oe=ue;for(let we=0;we<Q;we++){let ke=F[we][Ce],Ze=Oe.get(ke);Ze==null&&(Ze=we===Q-1?[]:new Map,Oe.set(ke,Ze)),Oe=Ze}Oe.push(Ce)}return Yi(ue,Q)}const Ve={asLabels:!0,append:!1,withNames:!1,separator1:"=",separator2:" "};function qe(F,_,Q){return _.map((ue,Ce)=>F.withNames?`${ue}${F.separator1}${Q[Ce]}`:Q[Ce]).join(F.separator2)}function ut(F,_){const Q={};return F.forEach((ue,Ce)=>{Q[ue]=String(_[Ce])}),Q}const Tt={id:te.F.partitionByValues,name:"Partition by values",description:"Splits a one-frame dataset into multiple series discriminated by unique/enum values in one or more fields.",defaultOptions:{keepFields:!1},operator:(F,_)=>Q=>Q.pipe((0,Rt.T)(ue=>Tt.transformer(F,_)(ue))),transformer:(F,_)=>{const Q=(0,Oi.R)(_,{names:F.fields});if(!Q)return qo.W.transformer({},_);const ue=(0,ne.NS)(Q);return Ce=>Ce.length?_t(Ce[0],ue,F):Ce}};function _t(F,_,Q){const ue=F.fields.filter(ke=>_(ke,F,[F]));if(!ue.length)return[F];const Ce=ue.map(ke=>ke.values),Oe=ue.map(ke=>ke.name),we={...Ve,...Q?.naming};return Fe(Ce).map(ke=>{let Ze=F.name,dt={};if(we.asLabels)dt=ut(Oe,ue.map((Ct,Kt)=>Ce[Kt][ke[0]]));else{let Ct=qe(we,Oe,ue.map((Kt,Bt)=>Ce[Bt][ke[0]]));we?.append&&F.name&&(Ct=`${F.name} ${Ct}`),Ze=Ct}let mt=F.fields;if(!Q?.keepFields){const Ct=new Set(Oe);mt=F.fields.filter(Kt=>!Ct.has(Kt.name))}return{name:Ze,meta:F.meta,length:ke.length,fields:mt.map(Ct=>{const Kt=Ct.values,Bt=Array(ke.length);for(let Mt=0;Mt<ke.length;Mt++)Bt[Mt]=Kt[ke[Mt]];return{name:Ct.name,type:Ct.type,config:Ct.config,labels:{...Ct.labels,...dt},values:Bt}})}})}function Zt({input:F,options:_,onChange:Q}){const ue=(0,da.sE)(F),Ce=(0,da.m3)(ue),Oe=(0,d.useMemo)(()=>{const Kt=new Set(_.fields);return Kt.size<1?Ce:Ce.filter(Bt=>!Kt.has(Bt.value))},[Ce,_]),we=(0,d.useCallback)(Kt=>{if(!Kt.value)return;const Bt=new Set(_.fields);Bt.add(Kt.value),Q({..._,fields:[...Bt]})},[Q,_]);let ke;(Kt=>{Kt[Kt.asLabels=0]="asLabels",Kt[Kt.frameName=1]="frameName"})(ke||(ke={}));const Ze=[{label:"As label",value:0},{label:"As frame name",value:1}],dt=[{label:"Yes",value:!0},{label:"No",value:!1}],mt=(0,d.useCallback)(Kt=>{if(!Kt)return;const Bt=new Set(_.fields);Bt.delete(Kt),Q({..._,fields:[...Bt]})},[Q,_]);if(F.length>1)return(0,j.jsx)(ha.P,{children:"Partition by values only works with a single frame."});const Ct=[...new Set(_.fields)];return(0,j.jsxs)("div",{children:[(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{label:"Field",labelWidth:10,grow:!0,children:(0,j.jsxs)(Zs.Gy,{children:[Ct.map(Kt=>(0,j.jsx)(me.$n,{icon:"times",variant:"secondary",size:"md",onClick:()=>mt(Kt),children:Kt},Kt)),Oe.length&&(0,j.jsx)(po.i,{variant:"secondary",size:"md",options:Oe,onChange:we,label:"Select field",icon:"plus"})]})})}),(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{tooltip:"Sets how the names of the selected fields are displayed. As frame name is usually better for tabular data",label:"Naming",labelWidth:10,children:(0,j.jsx)(re.z,{options:Ze,value:_.naming?.asLabels===void 0||_.naming.asLabels?0:1,onChange:Kt=>Q({..._,naming:{..._.naming,asLabels:Kt===0}})})})}),(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{tooltip:"Keeps the partition fields in the frames.",label:"Keep fields",labelWidth:16,children:(0,j.jsx)(re.z,{options:dt,value:_.keepFields,onChange:Kt=>Q({..._,keepFields:Kt})})})})]})}const dn={id:te.F.partitionByValues,editor:Zt,transformation:Tt,name:Tt.name,description:Tt.description,state:ft.pn.alpha,categories:new Set([x.m.Reformat]),help:de(te.F.partitionByValues).helperDocs};var Dn=e(41260),An=e(37471),rs=e(73060),os=(F=>(F.TimeSeriesWide="wide",F.TimeSeriesLong="long",F.TimeSeriesMulti="multi",F.TimeSeriesMany="many",F))(os||{});function us(F){if(!Array.isArray(F)||F.length===0)return F;const _=[];for(const Q of hs(F)){const ue=Q.fields[0];if(!ue||ue.type!==q.PU.time)continue;const Ce=[],Oe=[];for(const we of Q.fields)switch(we.type){case q.PU.number:case q.PU.boolean:Ce.push(we);break;case q.PU.string:Oe.push(we);break}for(const we of Ce)if(Oe.length){const ke=new Map;for(let Ze=0;Ze<Q.length;Ze++){const dt=ue.values[Ze],mt=we.values[Ze];if(mt===void 0||dt==null)continue;const Ct=Oe.map(Bt=>Bt.values[Ze]).join("/");let Kt=ke.get(Ct);if(!Kt){Kt={key:Ct,time:[],value:[],labels:{}};for(const Bt of Oe)Kt.labels[Bt.name]=Bt.values[Ze];ke.set(Ct,Kt)}Kt.time.push(dt),Kt.value.push(mt)}for(const Ze of ke.values())_.push({name:Q.name,refId:Q.refId,meta:{...Q.meta,type:Dn.m.TimeSeriesMulti},fields:[{...ue,values:Ze.time},{...we,values:Ze.value,labels:Ze.labels}],length:Ze.time.length})}else _.push({name:Q.name,refId:Q.refId,meta:{...Q.meta,type:Dn.m.TimeSeriesMulti},fields:[ue,we],length:Q.length})}return _}function hs(F){if(!Array.isArray(F)||F.length===0)return F;const _=[];for(const Q of F){let ue;const Ce=[],Oe={},we={},ke={},Ze={};for(let Mt=0;Mt<Q.fields.length;Mt++){const Wt=Q.fields[Mt];switch(Wt.type){case q.PU.string:case q.PU.boolean:Wt.name in Ze||(Ze[Wt.name]=Mt,we[Wt.name]=!0);break;case q.PU.time:if(!ue){ue=Wt;break}default:if(Wt.name in Oe){const Ks=Oe[Wt.name];if(Wt.type!==Ks)continue}else Oe[Wt.name]=Wt.type,Ce.push(Wt.name);const vn=JSON.stringify(Wt.labels),ns=ke[vn];if(ns!==void 0?ns.push(Mt):ke[vn]=[Mt],Wt.labels!=null)for(const Ks in Wt.labels)we[Ks]=!0}}if(!ue)continue;const dt=[],mt=[],Ct=[],Kt=[];for(let Mt=0;Mt<Q.length;Mt++)dt.push({time:ue.values[Mt],wideRowIndex:Mt});for(const Mt in ke)mt.push(Mt);for(const Mt in we)Ct.push(Mt);for(const Mt in Ze)Kt.push(Mt);dt.sort((Mt,Wt)=>Mt.time-Wt.time),mt.sort(),Ct.sort(),Ce.sort();const Bt=new An.k({...Q,meta:{...Q.meta,type:Dn.m.TimeSeriesLong},fields:[{name:ue.name,type:ue.type}]});for(const Mt of Ce)Bt.addField({name:Mt,type:Oe[Mt]});for(const Mt of Ct)Bt.addField({name:Mt,type:q.PU.string});for(const Mt of dt){const{time:Wt,wideRowIndex:vn}=Mt;for(const ns of mt){const Ks={};for(const Hs of Kt)Ks[Hs]=Q.fields[Ze[Hs]].values[vn];let bs=0;for(const Hs of ke[ns]){const Nr=Q.fields[Hs];if(bs++===0&&Nr.labels!=null)for(const no in Nr.labels)Ks[no]=Nr.labels[no];Ks[Nr.name]=Nr.values[vn]}Ks[ue.name]=Wt,Bt.add(Ks)}}_.push(Bt)}return _}function Js(F){return _t(F,Q=>Q.type===q.PU.string).map(Q=>(Q.meta||(Q.meta={}),Q.meta.type=Dn.m.TimeSeriesMulti,Q))}const Os={id:te.F.prepareTimeSeries,name:"Prepare time series",description:"Will stretch data frames from the wide format into the long format. This is really helpful to be able to keep backwards compatibility for panels not supporting the new wide format.",defaultOptions:{},operator:(F,_)=>Q=>Q.pipe((0,Rt.T)(ue=>Os.transformer(F,_)(ue))),transformer:F=>{const _=F?.format??"wide";if(_==="many"||_==="multi")return us;if(_==="long")return hs;const Q=ne.sJ.get(oe.Ct.firstTimeField).get({});return ue=>{if(!ue.length)return[];const Ce=[];for(const we of ue)we.meta?.type===Dn.m.TimeSeriesLong?Js(we).forEach(ke=>Ce.push(ke)):Ce.push(we);const Oe=(0,rs.Fd)({frames:Ce,joinBy:Q,keepOriginIndices:!0});return Oe?(Oe.meta||(Oe.meta={}),Oe.meta.type=Dn.m.TimeSeriesWide,[Oe]):[]}}},vs={label:"Wide time series",value:os.TimeSeriesWide,description:"Creates a single frame joined by time",info:(0,j.jsxs)("ul",{children:[(0,j.jsx)("li",{children:"Single frame"}),(0,j.jsx)("li",{children:"1st field is shared time field"}),(0,j.jsx)("li",{children:"Time in ascending order"}),(0,j.jsx)("li",{children:"Multiple value fields of any type"})]})},Cs={label:"Multi-frame time series",value:os.TimeSeriesMulti,description:"Creates a new frame for each time/number pair",info:(0,j.jsxs)("ul",{children:[(0,j.jsx)("li",{children:"Multiple frames"}),(0,j.jsx)("li",{children:"Each frame has two fields: time, value"}),(0,j.jsx)("li",{children:"Time in ascending order"}),(0,j.jsx)("li",{children:"String values are represented as labels"}),(0,j.jsx)("li",{children:"All values are numeric"})]})},ea={label:"Long time series",value:os.TimeSeriesLong,description:"Convert each frame to long format",info:(0,j.jsxs)("ul",{children:[(0,j.jsx)("li",{children:"Single frame"}),(0,j.jsx)("li",{children:"1st field is time field"}),(0,j.jsx)("li",{children:"Time in ascending order, but may have duplictes"}),(0,j.jsx)("li",{children:"String values are represented as separate fields rather than as labels"}),(0,j.jsx)("li",{children:"Multiple value fields may exist"})]})},oa=[vs,Cs,ea];function As(F){const{options:_,onChange:Q}=F,ue=(0,Dt.of)(ta),Ce=(0,d.useCallback)(Oe=>{Q({..._,format:Oe.value})},[Q,_]);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{label:"Format",labelWidth:12,children:(0,j.jsx)(Te.l6,{width:35,options:oa,value:oa.find(Oe=>Oe.value===os.TimeSeriesMulti&&_.format===os.TimeSeriesMany?!0:Oe.value===_.format)||oa[0],onChange:Ce,className:"flex-grow-1"})})}),(0,j.jsx)(fe.C,{children:(0,j.jsx)(ae.I,{label:"Info",labelWidth:12,children:(0,j.jsx)("div",{className:ue.info,children:(oa.find(Oe=>Oe.value===_.format)||oa[0]).info})})})]})}const ta=F=>({info:(0,Ye.css)`
    margin-left: 20px;
  `}),Ra={id:Os.id,editor:As,transformation:Os,name:Os.name,description:Os.description,categories:new Set([x.m.Reformat]),help:de(Os.id).helperDocs};var Ga=e(66648),ar=e(48817),La=(F=>(F.linear="linear",F.polynomial="polynomial",F))(La||{});const na={predictionCount:100,modelType:"linear",degree:2},Or={id:te.F.regression,name:"Regression analysis",operator:(F,_)=>Q=>Q.pipe((0,Rt.T)(ue=>Or.transformer(F,_)(ue))),transformer:(F,_)=>Q=>{const{predictionCount:ue,modelType:Ce,degree:Oe}={...na,...F};if(Q.length===0)return Q;const we=ne.sJ.get(oe.Ct.byName).get(F.yFieldName),ke=ne.sJ.get(oe.Ct.byName).get(F.xFieldName);let Ze,dt,mt;for(const Hs of Q){const Nr=Hs.fields.find(no=>we(no,Hs,Q));if(Nr){dt=Nr;const no=Hs.fields.find(mp=>ke(mp,Hs,Q));if(no){Ze=no,mt=Hs;break}else throw"X and Y fields must be part of the same frame"}}if(!Ze||!dt)return Q;let Ct=Ze.values[0],Kt=Ze.values[0];for(let Hs=1;Hs<Ze.values.length;Hs++)Ze.values[Hs]<Ct&&(Ct=Ze.values[Hs]),Ze.values[Hs]>Kt&&(Kt=Ze.values[Hs]);const Bt=(Kt-Ct)/(ue-1),Mt=[...[...Array(ue-1).keys()].map((Hs,Nr)=>Nr*Bt+Ct),Kt],Wt=Ze.type===q.PU.time?Ct:0,vn=[],ns=[];for(let Hs=0;Hs<Ze.values.length;Hs++)dt.values[Hs]!==null&&!isNaN(dt.values[Hs])&&(ns.push(Ze.values[Hs]-Wt),vn.push(dt.values[Hs]));let Ks;switch(Ce){case"linear":Ks=new ar.X(ns,vn);break;case"polynomial":Ks=new Ga.Y(ns,vn,Oe);break;default:return Q}const bs={name:`${Ce} regression`,length:Mt.length,fields:[{name:Ze.name,type:Ze.type,values:Mt,config:{}},{name:`${(0,z.Ct)(dt,mt,Q)} predicted`,type:dt.type,values:Mt.map(Hs=>Ks.predict(Hs-Wt)),config:{}}]};return[...Q,bs]}},Lr={editor:Ss.O,id:"",name:"",settings:{width:24,isClearable:!1}},qa=20,_r=({input:F,options:_,onChange:Q})=>{const ue=[{label:"Linear",value:La.linear},{label:"Polynomial",value:La.polynomial}];return(0,d.useEffect)(()=>{let Ce,Oe;if(!_.xFieldName){const we=ne.sJ.get(oe.Ct.firstTimeField).get({});for(const ke of F)if(Ce=ke.fields.find(Ze=>we(Ze,ke,F)),Ce)break;if(!Ce){const ke=ne.sJ.get(oe.Ct.numeric).get({});for(const Ze of F)if(Ce=Ze.fields.find(dt=>ke(dt,Ze,F)),Ce)break}}if(!_.yFieldName){const we=ne.sJ.get(oe.Ct.numeric).get({});for(const ke of F)if(Oe=ke.fields.find(Ze=>we(Ze,ke,F)&&Ze!==Ce),Oe)break}Ce&&Oe&&Q({..._,xFieldName:Ce.name,yFieldName:Oe.name})}),(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(ae.I,{labelWidth:qa,label:"X field",children:(0,j.jsx)(Ss.O,{context:{data:F},value:_.xFieldName??"",item:Lr,onChange:Ce=>{Q({..._,xFieldName:Ce})}})}),(0,j.jsx)(ae.I,{labelWidth:qa,label:"Y field",children:(0,j.jsx)(Ss.O,{context:{data:F},value:_.yFieldName??"",item:Lr,onChange:Ce=>{Q({..._,yFieldName:Ce})}})}),(0,j.jsx)(ae.I,{labelWidth:qa,label:"Model type",children:(0,j.jsx)(Te.l6,{value:_.modelType??na.modelType,onChange:Ce=>{Q({..._,modelType:Ce.value??na.modelType})},options:ue})}),(0,j.jsx)(ae.I,{labelWidth:qa,label:"Predicted points",tooltip:"Number of X,Y points to predict",children:(0,j.jsx)(pa.Q,{value:_.predictionCount??na.predictionCount,onChange:Ce=>{Q({..._,predictionCount:Ce})}})}),_.modelType===La.polynomial&&(0,j.jsx)(ae.I,{labelWidth:qa,label:"Degree",children:(0,j.jsx)(Te.l6,{value:_.degree??na.degree,options:[{label:"Quadratic",value:2},{label:"Cubic",value:3},{label:"Quartic",value:4},{label:"Quintic",value:5}],onChange:Ce=>{Q({..._,degree:Ce.value})}})})]})},io={id:te.F.regression,editor:_r,transformation:Or,name:Or.name,description:Or.description,categories:new Set([x.m.CalculateNewFields]),help:de(te.F.regression).helperDocs},Pr={id:te.F.rowsToFields,name:"Rows to fields",description:"Convert each row into a field with dynamic config.",defaultOptions:{},operator:F=>_=>_.pipe((0,Rt.T)(Q=>Q.map(ue=>lo(F,ue))))};function lo(F,_){const Q=Qt(_,F.mappings??[],!0),{nameField:ue,valueField:Ce}=Q;if(!ue||!Ce)return _;const Oe=[];for(let we=0;we<ue.values.length;we++){const ke=ue.values[we],Ze=Ce.values[we],dt=St(_,we,Q),mt=ir(_,we,Q),Ct={name:`${ke}`,type:Ce.type,values:[Ze],config:dt,labels:mt};Oe.push(Ct)}return{fields:Oe,length:1}}function ir(F,_,Q){const ue={...Q.nameField.labels};for(let Ce=0;Ce<F.fields.length;Ce++){const Oe=F.fields[Ce],we=(0,z.Ct)(Oe,F),ke=Q.index[we];if(ke.handler&&ke.handler.key!==nn.Label)continue;const Ze=Oe.values[_];Ze!=null&&(ue[we]=Ze)}return ue}function ss({input:F,options:_,onChange:Q}){return F.length===0?null:(0,j.jsx)("div",{children:(0,j.jsx)(Sn,{frame:F[0],mappings:_.mappings??[],onChange:ue=>Q({..._,mappings:ue}),withNameAndValue:!0})})}const ws={id:Pr.id,editor:ss,transformation:Pr,name:Pr.name,description:Pr.description,state:ft.pn.beta,categories:new Set([x.m.Reformat]),help:de(Pr.id).helperDocs};var Ds=e(52622),Ws=e(61983),Ge=e(9581),Le=e(96606),_e=e(31484),nt=e(78134);const At={id:te.F.spatial,name:"Spatial operations",description:"Apply spatial operations to query results.",defaultOptions:{},operator:F=>_=>_.pipe((0,Eo.Z)(Q=>(0,vr.H)(qt(Q,F))))};function kt(F){return F.action===Ge.dy.Modify&&F.modify?.op===Ge.YD.LineBuilder}async function qt(F,_){const Q=await(0,_e.nE)(_.source);if(kt(_)){const ue=await(0,_e.nE)(_.modify?.target);return F.map(Ce=>{const Oe=(0,_e.FM)(Ce,Q),we=(0,_e.FM)(Ce,ue);if(Oe.field&&we.field){const ke=[...Ce.fields],Ze=(0,Le.XR)(Oe.field,we.field),dt=ke[0];return dt.type===q.PU.geo&&dt!==Oe.field&&dt!==we.field?ke[0]=(0,Le.RA)(dt,Ze):ke.unshift(Ze),{...Ce,fields:ke}}return Ce})}return F.map(ue=>{let Ce=(0,_e.FM)(ue,Q);if(Ce.field){if(_.action===Ge.dy.Modify){switch(_.modify?.op){case Ge.YD.AsLine:let we=Ce.field.name;return(!we||we==="Point")&&(we="Line"),{...ue,length:1,fields:[{...Ce.field,name:we,type:q.PU.geo,values:[(0,nt.tt)(Ce.field)]}]}}return ue}const Oe=Ce.derived?[Ce.field,...ue.fields]:ue.fields.slice(0);if(_.action===Ge.dy.Calculate&&(Oe.push((0,nt.pp)(Ce.field,_.calculate??{})),Ce.derived=!0),Ce.derived)return{...ue,fields:Oe}}return ue})}const gn=(F,_)=>{const Q=_.options??{};F.addSelect({path:"action",name:"Action",description:"",defaultValue:Ge.dy.Prepare,settings:{options:[{value:Ge.dy.Prepare,label:"Prepare spatial field",description:"Set a geometry field based on the results of other fields"},{value:Ge.dy.Calculate,label:"Calculate value",description:"Use the geometry to define a new field (heading/distance/area)"},{value:Ge.dy.Modify,label:"Transform",description:"Apply spatial operations to the geometry"}]}}),Q.action===Ge.dy.Calculate?F.addSelect({path:"calculate.calc",name:"Function",description:"",defaultValue:Ge.kD.Heading,settings:{options:[{value:Ge.kD.Heading,label:"Heading"},{value:Ge.kD.Area,label:"Area"},{value:Ge.kD.Distance,label:"Distance"}]}}):Q.action===Ge.dy.Modify&&F.addSelect({path:"modify.op",name:"Operation",description:"",defaultValue:Ge.YD.AsLine,settings:{options:[{value:Ge.YD.AsLine,label:"As line",description:"Create a single line feature with a vertex at each row"},{value:Ge.YD.LineBuilder,label:"Line builder",description:"Create a line between two points"}]}}),kt(Q)?(F.addNestedOptions({category:["Source"],path:"source",build:(ue,Ce)=>{const Oe=Q.source??{mode:Ds.aG.Auto};(0,Ws.G)("Point","",ue,Oe)}}),F.addNestedOptions({category:["Target"],path:"modify",build:(ue,Ce)=>{const Oe=Q.modify?.target??{mode:Ds.aG.Auto};(0,Ws.G)("Point","target.",ue,Oe)}})):(0,Ws.G)("Location","source.",F,Q.source)},Bn=F=>{(0,d.useEffect)(()=>{if(!F.options.source?.mode){const ue=wt(gn);F.onChange({...ue,...F.options}),console.log("geometry useEffect",ue)}},[]);const _=xn((0,Dt.$j)()),Q=Jt(F,gn);return(0,j.jsxs)("div",{children:[(0,j.jsx)("div",{children:Q.items.map(ue=>ue.render())}),(0,j.jsx)("div",{children:Q.categories.map(ue=>(0,j.jsxs)("div",{className:_.wrap,children:[(0,j.jsx)("h5",{children:ue.props.title}),(0,j.jsx)("div",{className:_.item,children:ue.items.map(Ce=>Ce.render())})]},ue.props.id))})]})},xn=F=>({wrap:(0,Ye.css)`
      margin-bottom: 20px;
    `,item:(0,Ye.css)`
      border-left: 4px solid ${F.colors.border.strong};
      padding-left: 10px;
    `}),gs={id:te.F.spatial,editor:Bn,transformation:At,name:At.name,description:At.description,state:ft.pn.alpha,categories:new Set([x.m.PerformSpatialOperations]),help:de(te.F.spatial).helperDocs};var as=e(19845);const $s={id:te.F.timeSeriesTable,name:"Time series to table",description:"Convert time series data to table rows so that they can be viewed in tabular or sparkline format.",defaultOptions:{},isApplicable:F=>{for(const _ of F)if((0,as.aH)(_))return Dr.M.Applicable;return Dr.M.NotApplicable},isApplicableDescription:"The Time series to table transformation requires at least one time series frame to function. You currently have none.",operator:F=>_=>_.pipe((0,Rt.T)(Q=>Us(F,Q)))};function Us(F,_){const Q={},ue={},Ce=[];let Oe=Xs(_);for(const we of Object.keys(Oe)){const ke=_.filter(dt=>dt.refId===we);Q[we]={},ue[we]={};const Ze=[];ke.forEach(dt=>{dt.fields.forEach(mt=>{mt.type===q.PU.number&&mt.labels&&Object.keys(mt.labels).forEach(Ct=>{Ze.includes(Ct)||(ue[we][Ct]=Ta(Ct,q.PU.string),Ze.push(Ct))})})});for(let dt=0;dt<ke.length;dt++){const mt=ke[dt];let Ct=null,Kt=F[we]?.timeField;if(Kt&&Kt.length>0?Ct=mt.fields.find(Bt=>Bt.name===Kt):Ct=mt.fields.find(Bt=>(0,as.hF)(Bt)),!(0,as.aH)(mt)){Ce.push(mt);continue}for(const Bt of mt.fields){if(Bt.type!==q.PU.number)continue;const Mt=F[we]?.stat??Ft.gy.lastNotNull,Wt=(0,Ft.Nw)({field:Bt,reducers:[Mt]})[Mt]??null,vn=new An.k;Ct!==void 0&&(vn.addField(Ct),vn.addField(Bt),Q[we][`Trend #${we}`]===void 0&&(Q[we][`Trend #${we}`]=Ta(`Trend #${we}`,q.PU.frame)),Q[we][`Trend #${we}`].values.push({...vn,value:Wt,length:Bt.values.length})),Ze.forEach(ns=>{ue[we][ns].values.push(Bt.labels?.[ns]??"")})}}}for(const we of Object.keys(Oe)){const ke={},Ze=new An.k;Ze.refId=we;const dt=ue[we];if(dt!==void 0)for(const[Ct,Kt]of Object.entries(dt))ke[Ct]===void 0&&(ke[Ct]=Kt);for(const Ct of Object.values(ke))Ze.addField(Ct);const mt=Q[we];for(const Ct of Object.values(mt))Ze.addField(Ct);Ze.fields.length>0&&Ce.push(Ze)}return Ce}function Ta(F,_){return{name:F,type:_,config:{},values:[]}}function Xs(F){let _={};for(const Q of F)Q.refId!==void 0&&(_[Q.refId]===void 0?_[Q.refId]=1:_[Q.refId]++);return _}function fa({input:F,options:_,onChange:Q}){const ue=Xs(F),Ce=(0,d.useCallback)((ke,Ze)=>{const dt=Ze?.value!==void 0?Ze.value:"";Q({..._,[ke]:{..._[ke],timeField:dt}})},[Q,_]),Oe=(0,d.useCallback)((ke,Ze)=>{const dt=Ze[0];dt&&(0,Ft.Em)(dt)&&Q({..._,[ke]:{..._[ke],stat:dt}})},[Q,_]);let we=[];for(const ke of Object.keys(ue)){const Ze={},dt=[];for(const mt of F)if(mt.refId===ke)for(const Ct of mt.fields)(0,as.hF)(Ct)&&(Ze[Ct.name]=Ct);for(const mt of Object.values(Ze)){const{name:Ct}=mt;dt.push({label:Ct,value:Ct})}we.push((0,j.jsxs)(fe.C,{children:[(0,j.jsx)(ae.I,{children:(0,j.jsx)(xt.c,{children:`Trend #${ke}`})}),(0,j.jsx)(ae.I,{label:"Time field",tooltip:"The time field that will be used for the time series. If not selected the first found will be used.",children:(0,j.jsx)(Te.l6,{onChange:Ce.bind(null,ke),options:dt,value:_[ke]?.timeField,isClearable:!0})}),(0,j.jsx)(ae.I,{label:"Stat",tooltip:"The statistic that should be calculated for this time series.",children:(0,j.jsx)(an.S,{stats:[_[ke]?.stat??Ft.gy.lastNotNull],onChange:Oe.bind(null,ke),filterOptions:mt=>mt.id!==Ft.gy.allValues&&mt.id!==Ft.gy.uniqueValues})})]},ke))}return(0,j.jsx)(j.Fragment,{children:we})}const ma={id:$s.id,editor:fa,transformation:$s,name:$s.name,description:$s.description,state:ft.pn.beta,help:de($s.id).helperDocs},Ma=()=>[sl,Zr,al,ao,Qe,vo,No,rl,qn,en,Wo,Ca,ol,Fi,Za,ws,tn,Ra,Ar,gs,Qi,Bl,Cn,So,nl,Io,dn,...se.$.featureToggles.formatString?[Go]:[],...se.$.featureToggles.regressionTransformation?[io]:[],...se.$.featureToggles.groupToNestedTableTransformation?[Rr]:[],Yt,ma];var Ua=e(67278);function va(){return new Ua.c(new URL(e.p+e.u(7887),e.b))}function lr(){return[{id:"kusto",name:"kusto",init:va}]}var rr=e(1503),co=e(71468),yr=e(24180),jr=e(24160),xr=e(14110),Ul=e(66602),Lu=e(63211),ac=e(71678),Ii=e(17464),wr=e(39070),Do=e(19361),ya=e(8484),ju=e(53153),Bu=e(87570),Hr=e(4691),rc=e(20851),Uu=e(58649);const oc=()=>{const F=!!Y.Ay.oauth;return{saml:{bgColor:"#464646",enabled:Y.Ay.samlEnabled,name:Y.Ay.samlName||Uu.En,icon:"key-skeleton-alt"},google:{bgColor:"#e84d3c",enabled:F&&!!Y.Ay.oauth.google,name:Y.Ay.oauth?.google?.name||"Google",icon:Y.Ay.oauth?.google?.icon||"google"},azuread:{bgColor:"#2f2f2f",enabled:F&&!!Y.Ay.oauth.azuread,name:Y.Ay.oauth?.azuread?.name||"Microsoft",icon:Y.Ay.oauth?.azuread?.icon||"microsoft"},github:{bgColor:"#464646",enabled:F&&!!Y.Ay.oauth.github,name:Y.Ay.oauth?.github?.name||"GitHub",icon:Y.Ay.oauth?.github?.icon||"github"},gitlab:{bgColor:"#fc6d26",enabled:F&&!!Y.Ay.oauth.gitlab,name:Y.Ay.oauth?.gitlab?.name||"GitLab",icon:Y.Ay.oauth?.gitlab?.icon||"gitlab"},grafanacom:{bgColor:"#262628",enabled:F&&!!Y.Ay.oauth.grafana_com,name:Y.Ay.oauth?.grafana_com?.name||"Grafana.com",icon:Y.Ay.oauth?.grafana_com?.icon||"grafana",hrefName:"grafana_com"},okta:{bgColor:"#2f2f2f",enabled:F&&!!Y.Ay.oauth.okta,name:Y.Ay.oauth?.okta?.name||"Okta",icon:Y.Ay.oauth?.okta?.icon||"okta"},oauth:{bgColor:"#262628",enabled:F&&!!Y.Ay.oauth.generic_oauth,name:Y.Ay.oauth?.generic_oauth?.name||"OAuth",icon:Y.Ay.oauth?.generic_oauth?.icon||"signin",hrefName:"generic_oauth"}}},nd=F=>({button:(0,Ye.css)({color:"#d8d9da",position:"relative"}),buttonIcon:(0,Ye.css)({position:"absolute",left:F.spacing(1),top:"50%",transform:"translateY(-50%)"}),divider:{base:(0,Ye.css)({color:F.colors.text.primary,display:"flex",marginBottom:F.spacing(1),justifyContent:"space-between",textAlign:"center",width:"100%"}),line:(0,Ye.css)({width:100,height:10,borderBottom:`1px solid ${F.colors.text}`})}}),Nl=()=>{const F=(0,Dt.of)(nd);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)("div",{className:F.divider.base,children:[(0,j.jsx)("div",{children:(0,j.jsx)("div",{className:F.divider.line})}),(0,j.jsx)("div",{children:(0,j.jsx)("span",{children:!Y.Ay.disableLoginForm&&(0,j.jsx)("span",{children:"or"})})}),(0,j.jsx)("div",{children:(0,j.jsx)("div",{className:F.divider.line})})]}),(0,j.jsx)("div",{className:"clearfix"})]})};function Nu(F,_,Q){return(0,Ye.cx)(_.button,(0,Ye.css)({backgroundColor:F.bgColor,color:Q.colors.getContrastText(F.bgColor),"&:hover":{backgroundColor:Q.colors.emphasize(F.bgColor,.15),boxShadow:Q.shadows.z1}}))}const wu=()=>{const F=(0,m.pickBy)(oc(),Ce=>Ce.enabled),_=Object.keys(F).length>0,Q=(0,Dt.$j)(),ue=(0,Dt.of)(nd);return _?(0,j.jsxs)(rn.B,{direction:"column",width:"100%",children:[(0,j.jsx)(Nl,{}),Object.entries(F).map(([Ce,Oe])=>{const we=Oe.name;return(0,j.jsxs)(me.z9,{className:Nu(Oe,ue,Q),href:`login/${Oe.hrefName?Oe.hrefName:Ce}`,target:"_self",fullWidth:!0,children:[(0,j.jsx)(Ys.I,{className:ue.buttonIcon,name:Oe.icon}),(0,j.jsxs)(ya.x6,{i18nKey:"login.services.sing-in-with-prefix",children:["Sign in with ",{serviceName:we}]})]},Ce)})]}):null},Wu=()=>{const F=(0,Y.zj)().verifyEmailEnabled?`${(0,Y.zj)().appSubUrl}/verify`:`${(0,Y.zj)().appSubUrl}/signup`,_=(0,Ye.css)({paddingTop:"16px"});return(0,j.jsxs)(rn.B,{direction:"column",children:[(0,j.jsx)("div",{className:_,children:(0,j.jsx)(ya.x6,{i18nKey:"login.signup.new-to-question",children:"New to Grafana?"})}),(0,j.jsx)(me.z9,{className:(0,Ye.css)({width:"100%",justifyContent:"center"}),href:F,variant:"secondary",fill:"outline",children:(0,j.jsx)(ya.x6,{i18nKey:"login.signup.button-label",children:"Sign up"})})]})},Fu=()=>{const F=(0,Dt.of)(Ku);return document.title=Do.M.AppTitle,(0,j.jsx)(Bu.A,{children:({loginHint:_,passwordHint:Q,disableLoginForm:ue,disableUserSignUp:Ce,login:Oe,isLoggingIn:we,changePassword:ke,skipPasswordChange:Ze,isChangingPassword:dt,showDefaultPasswordWarning:mt,loginErrorMessage:Ct})=>(0,j.jsxs)(rc.GU,{isChangingPassword:dt,children:[!dt&&(0,j.jsxs)(rc.qm,{children:[Ct&&(0,j.jsx)(In.F,{className:F.alert,severity:"error",title:(0,ya.t)("login.error.title","Login failed"),children:Ct}),!ue&&(0,j.jsx)(Hr.Q,{onSubmit:Oe,loginHint:_,passwordHint:Q,isLoggingIn:we,children:(0,j.jsx)(rn.B,{justifyContent:"flex-end",children:!se.$.auth.disableLogin&&(0,j.jsx)(me.z9,{className:F.forgottenPassword,fill:"text",href:`${se.$.appSubUrl}/user/password/send-reset-email`,children:(0,j.jsx)(ya.x6,{i18nKey:"login.forgot-password",children:"Forgot your password?"})})})}),(0,j.jsx)(wu,{}),!Ce&&(0,j.jsx)(Wu,{})]}),dt&&(0,j.jsx)(rc.qm,{children:(0,j.jsx)(ju.S,{showDefaultPasswordWarning:mt,onSubmit:ke,onSkip:()=>Ze()})})]})})},Ku=F=>({forgottenPassword:(0,Ye.css)({padding:0,marginTop:F.spacing(.5)}),alert:(0,Ye.css)({width:"100%"})});var kr=e(69444),sd=e(25249),ic=e(10860);function $u({description:F,text:_,url:Q}){const ue=(0,Dt.of)(wl);return(0,j.jsxs)(ic.Z,{className:ue.card,href:Q,children:[(0,j.jsx)(ic.Z.Heading,{children:_}),(0,j.jsx)(ic.Z.Description,{className:ue.description,children:F})]})}const wl=F=>({card:(0,Ye.css)({marginBottom:0,gridTemplateRows:"1fr 0 2fr"}),description:(0,Ye.css)({WebkitLineClamp:3,WebkitBoxOrient:"vertical",display:"-webkit-box",overflow:"hidden"})});function Ao({navId:F,header:_}){const{node:Q}=(0,sd.C)(F),ue=(0,Dt.of)(Vu),Ce=Q.children?.filter(Oe=>!Oe.hideFromTabs);return(0,j.jsx)(kr.Y,{navId:Q.id,children:(0,j.jsx)(kr.Y.Contents,{children:(0,j.jsxs)("div",{className:ue.content,children:[_,Ce&&Ce.length>0&&(0,j.jsx)("section",{className:ue.grid,children:Ce?.map(Oe=>(0,j.jsx)($u,{description:Oe.subTitle,text:Oe.text,url:Oe.url??""},Oe.id))})]})})})}const Vu=F=>({content:(0,Ye.css)({display:"flex",flexDirection:"column",gap:F.spacing(2)}),grid:(0,Ye.css)({display:"grid",gap:F.spacing(3),gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gridAutoRows:"138px",padding:F.spacing(2,0)})});var Wl=e(64388),ad=e(7392);function _u(){return(0,j.jsx)(kr.Y,{navId:"home",layout:Wl.k.Canvas,pageNav:{text:"Page not found"},children:(0,j.jsx)(ad.L,{entity:"Page"})})}var or=e(16233),lc=e(33378),$a=e(10096),Fn=e(31678),cc=e(72724),dc=e(46334);const zu="dddd YYYY-MM-DD HH:mm zz",Hu="/admin/authentication/ldap";class ku extends d.PureComponent{constructor(){super(...arguments),this.onUserSync=()=>{this.props.onUserSync()}}render(){const{ldapSyncInfo:_,user:Q}=this.props,Ce=_&&_.nextSync?(0,cc.LE)(_.nextSync,{format:zu}):"",Oe=`${Hu}?user=${Q&&Q.login}`,we=$a.TP.hasPermission(Fn.AccessControlAction.LDAPUsersRead),ke=$a.TP.hasPermission(Fn.AccessControlAction.LDAPUsersSync);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("h3",{className:"page-heading",children:"LDAP Synchronisation"}),(0,j.jsxs)("div",{className:"gf-form-group",children:[(0,j.jsx)("div",{className:"gf-form",children:(0,j.jsx)("table",{className:"filter-table form-inline",children:(0,j.jsxs)("tbody",{children:[(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{children:"External sync"}),(0,j.jsx)("td",{children:"User synced via LDAP. Some changes must be done in LDAP or mappings."}),(0,j.jsx)("td",{children:(0,j.jsx)(dc.E,{label:"LDAP",removeIcon:!1,count:0,onClick:void 0})})]}),(0,j.jsx)("tr",{children:_.enabled?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("td",{children:"Next scheduled synchronization"}),(0,j.jsx)("td",{colSpan:2,children:Ce})]}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("td",{children:"Next scheduled synchronization"}),(0,j.jsx)("td",{colSpan:2,children:"Not enabled"})]})})]})})}),(0,j.jsxs)("div",{className:"gf-form-button-row",children:[ke&&(0,j.jsx)(me.$n,{variant:"secondary",onClick:this.onUserSync,children:"Sync user"}),we&&(0,j.jsx)(me.z9,{variant:"secondary",href:Oe,children:"Debug LDAP Mapping"})]})]})]})}}var Fl=e(3911),Ir=e(82702),uc=e(37390),fi=e(56034),dl=e(89062),Kl=e(85927),rd=e(41053);function od({onSelected:F,className:_,inputId:Q,autoFocus:ue,excludeOrgs:Ce}){(0,d.useEffect)(()=>{ue&&Q&&document.getElementById(Q)?.focus()},[ue,Q]);const[Oe,we]=(0,rd.A)(async()=>{const Ze=(await(0,M.AI)().get("/api/orgs")).map(dt=>({value:{id:dt.id,name:dt.name},label:dt.name}));if(Ce){let dt=Ce.map(Ct=>Ct.orgId);return Ze.filter(Ct=>!dt.includes(Ct.value.id))}else return Ze});return(0,j.jsx)(Te.DW,{inputId:Q,className:_,isLoading:Oe.loading,defaultOptions:!0,loadOptions:we,filterOption:(ke,Ze)=>{const dt=Ze.toLowerCase();return!!ke.value?.name.toLowerCase().includes(dt)},onChange:F,placeholder:"Select organization",noOptionsMessage:"No organizations found"})}var id=e(5133);class Gu extends d.PureComponent{constructor(){super(...arguments),this.addToOrgButtonRef=(0,d.createRef)(),this.state={showAddOrgModal:!1},this.showOrgAddModal=()=>{this.setState({showAddOrgModal:!0})},this.dismissOrgAddModal=()=>{this.setState({showAddOrgModal:!1},()=>{this.addToOrgButtonRef.current?.focus()})}}render(){const{user:_,orgs:Q,isExternalUser:ue,onOrgRoleChange:Ce,onOrgRemove:Oe,onOrgAdd:we}=this.props,{showAddOrgModal:ke}=this.state,Ze=$a.TP.hasPermission(Fn.AccessControlAction.OrgUsersAdd)&&!ue;return(0,j.jsxs)("div",{children:[(0,j.jsx)("h3",{className:"page-heading",children:"Organizations"}),(0,j.jsxs)(rn.B,{gap:1.5,direction:"column",children:[(0,j.jsx)("table",{className:"filter-table form-inline",children:(0,j.jsx)("tbody",{children:Q.map((dt,mt)=>(0,j.jsx)(Yu,{isExternalUser:ue,user:_,org:dt,onOrgRoleChange:Ce,onOrgRemove:Oe},`${dt.orgId}-${mt}`))})}),(0,j.jsx)("div",{children:Ze&&(0,j.jsx)(me.$n,{variant:"secondary",onClick:this.showOrgAddModal,ref:this.addToOrgButtonRef,children:"Add user to organization"})}),(0,j.jsx)(cd,{user:_,userOrgs:Q,isOpen:ke,onOrgAdd:we,onDismiss:this.dismissOrgAddModal})]})]})}}const Qu=(0,Fl.N)(F=>({removeButton:(0,Ye.css)({marginRight:"0.6rem",textDecoration:"underline",color:F.v1.palette.blue95}),label:(0,Ye.css)({fontWeight:500}),disabledTooltip:(0,Ye.css)({display:"flex"}),tooltipItem:(0,Ye.css)({marginLeft:"5px"}),tooltipItemLink:(0,Ye.css)({color:F.v1.palette.blue95}),rolePickerWrapper:(0,Ye.css)({display:"flex"}),rolePicker:(0,Ye.css)({flex:"auto",marginRight:F.spacing(1)})}));class ld extends d.PureComponent{constructor(){super(...arguments),this.state={currentRole:this.props.org.role,isChangingRole:!1,roleOptions:[]},this.onOrgRemove=async()=>{const{org:_}=this.props;this.props.onOrgRemove(_.orgId)},this.onChangeRoleClick=()=>{const{org:_}=this.props;this.setState({isChangingRole:!0,currentRole:_.role})},this.onOrgRoleChange=_=>{this.setState({currentRole:_})},this.onOrgRoleSave=()=>{this.props.onOrgRoleChange(this.props.org.orgId,this.state.currentRole)},this.onCancelClick=()=>{this.setState({isChangingRole:!1})},this.onBasicRoleChange=_=>{this.props.onOrgRoleChange(this.props.org.orgId,_)}}componentDidMount(){$a.TP.licensedAccessControlEnabled()&&$a.TP.hasPermission(Fn.AccessControlAction.ActionRolesList)&&(0,Kl.RL)(this.props.org.orgId).then(_=>this.setState({roleOptions:_})).catch(_=>console.error(_))}render(){const{user:_,org:Q,isExternalUser:ue,theme:Ce}=this.props,Oe=_?.authLabels?.length&&_?.authLabels[0],we=Oe?`Synced via ${Oe}`:"",{currentRole:ke,isChangingRole:Ze}=this.state,dt=Qu(Ce),mt=(0,Ye.cx)("width-16",dt.label),Ct=$a.TP.hasPermission(Fn.AccessControlAction.OrgUsersWrite),Kt=$a.TP.hasPermission(Fn.AccessControlAction.OrgUsersRemove)&&!ue,Bt=ue||!Ct,Mt=`${Q.name}-input`;return(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{className:mt,children:(0,j.jsx)("label",{htmlFor:Mt,children:Q.name})}),$a.TP.licensedAccessControlEnabled()?(0,j.jsx)("td",{children:(0,j.jsxs)("div",{className:dt.rolePickerWrapper,children:[(0,j.jsx)("div",{className:dt.rolePicker,children:(0,j.jsx)(dl.y,{userId:_?.id||0,orgId:Q.orgId,basicRole:Q.role,roleOptions:this.state.roleOptions,onBasicRoleChange:this.onBasicRoleChange,basicRoleDisabled:Bt,basicRoleDisabledMessage:`This user's role is not editable because it is synchronized from your auth provider.
                    Refer to the Grafana authentication docs for details.`})}),ue&&(0,j.jsx)(hc,{lockMessage:we})]})}):(0,j.jsxs)(j.Fragment,{children:[Ze?(0,j.jsx)("td",{children:(0,j.jsx)(id.r,{inputId:Mt,value:ke,onChange:this.onOrgRoleChange,autoFocus:!0})}):(0,j.jsx)("td",{className:"width-25",children:Q.role}),(0,j.jsx)("td",{colSpan:1,children:Ct&&(0,j.jsx)(ud,{lockMessage:we,isExternalUser:ue,onChangeRoleClick:this.onChangeRoleClick,onCancelClick:this.onCancelClick,onOrgRoleSave:this.onOrgRoleSave})})]}),(0,j.jsx)("td",{colSpan:1,children:Kt&&(0,j.jsx)(Ir.Z,{confirmText:"Confirm removal",confirmVariant:"destructive",onCancel:this.onCancelClick,onConfirm:this.onOrgRemove,children:"Remove from organization"})})]})}}const Yu=(0,Dt.cV)(ld),Ju=(0,Fl.N)(()=>({modal:(0,Ye.css)({width:"500px"}),buttonRow:(0,Ye.css)({textAlign:"center"}),modalContent:(0,Ye.css)({overflow:"visible"})}));class cd extends d.PureComponent{constructor(){super(...arguments),this.state={selectedOrg:null,role:Fn.OrgRole.Viewer,roleOptions:[],pendingOrgId:null,pendingUserId:null,pendingRoles:[]},this.onOrgSelect=_=>{const Q=this.props.userOrgs.find(ue=>ue.orgId===_.value?.id);this.setState({selectedOrg:_.value,role:Q?.role||Fn.OrgRole.Viewer}),$a.TP.licensedAccessControlEnabled()&&$a.TP.hasPermission(Fn.AccessControlAction.ActionRolesList)&&(0,Kl.RL)(_.value?.id).then(ue=>this.setState({roleOptions:ue})).catch(ue=>console.error(ue))},this.onOrgRoleChange=_=>{this.setState({role:_})},this.onAddUserToOrg=async()=>{const{selectedOrg:_,role:Q}=this.state;this.props.onOrgAdd(_.id,Q),$a.TP.licensedAccessControlEnabled()&&$a.TP.hasPermission(Fn.AccessControlAction.ActionUserRolesAdd)&&this.state.pendingUserId&&(await(0,Kl.eA)(this.state.pendingRoles,this.state.pendingUserId,this.state.pendingOrgId),this.setState({pendingOrgId:null,pendingRoles:[],pendingUserId:null}))},this.onCancel=()=>{this.setState({selectedOrg:null,pendingRoles:[],pendingOrgId:null,pendingUserId:null}),this.props.onDismiss&&this.props.onDismiss()},this.onRoleUpdate=async(_,Q,ue)=>{this.setState({pendingRoles:_,pendingOrgId:ue,pendingUserId:Q})}}render(){const{isOpen:_,user:Q,userOrgs:ue}=this.props,{role:Ce,roleOptions:Oe,selectedOrg:we}=this.state,ke=Ju();return(0,j.jsxs)(uc.a,{className:ke.modal,contentClassName:ke.modalContent,title:"Add to an organization",isOpen:_,onDismiss:this.onCancel,children:[(0,j.jsx)(qs.D,{label:"Organization",children:(0,j.jsx)(od,{inputId:"new-org-input",onSelected:this.onOrgSelect,excludeOrgs:ue,autoFocus:!0})}),(0,j.jsx)(qs.D,{label:"Role",disabled:we===null,children:(0,j.jsx)(dl.y,{userId:Q?.id||0,orgId:we?.id,basicRole:Ce,onBasicRoleChange:this.onOrgRoleChange,basicRoleDisabled:!1,roleOptions:Oe,apply:!0,onApplyRoles:this.onRoleUpdate,pendingRoles:this.state.pendingRoles})}),(0,j.jsx)(uc.a.ButtonRow,{children:(0,j.jsxs)(rn.B,{gap:2,justifyContent:"center",children:[(0,j.jsx)(me.$n,{variant:"secondary",fill:"outline",onClick:this.onCancel,children:"Cancel"}),(0,j.jsx)(me.$n,{variant:"primary",disabled:we===null,onClick:this.onAddUserToOrg,children:"Add to organization"})]})})]})}}const dd=F=>({disabledTooltip:(0,Ye.css)({display:"flex"}),tooltipItemLink:(0,Ye.css)({color:F.v1.palette.blue95}),lockMessageClass:(0,Ye.css)({fontStyle:"italic",marginLeft:"1.8rem",marginRight:"0.6rem"}),icon:(0,Ye.css)({lineHeight:2})});function ud({lockMessage:F,onChangeRoleClick:_,isExternalUser:Q,onOrgRoleSave:ue,onCancelClick:Ce}){const Oe=(0,Dt.of)(dd);return(0,j.jsx)("div",{className:Oe.disabledTooltip,children:Q?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("span",{className:Oe.lockMessageClass,children:F}),(0,j.jsx)(fi.m,{placement:"right-end",interactive:!0,content:(0,j.jsxs)("div",{children:["This user's role is not editable because it is synchronized from your auth provider. Refer to the\xA0",(0,j.jsx)("a",{className:Oe.tooltipItemLink,href:"https://grafana.com/docs/grafana/latest/auth",rel:"noreferrer",target:"_blank",children:"Grafana authentication docs"}),"\xA0for details."]}),children:(0,j.jsx)("div",{className:Oe.icon,children:(0,j.jsx)(Ys.I,{name:"question-circle"})})})]}):(0,j.jsx)(Ir.Z,{confirmText:"Save",onClick:_,onCancel:Ce,onConfirm:ue,disabled:Q,children:"Change role"})})}const hc=({lockMessage:F})=>{const _=(0,Dt.of)(hd);return(0,j.jsxs)("div",{className:_.disabledTooltip,children:[(0,j.jsx)("span",{className:_.lockMessageClass,children:F}),(0,j.jsx)(fi.m,{placement:"right-end",interactive:!0,content:(0,j.jsxs)("div",{children:["This user's built-in role is not editable because it is synchronized from your auth provider. Refer to the\xA0",(0,j.jsx)("a",{className:_.tooltipItemLink,href:"https://grafana.com/docs/grafana/latest/auth",rel:"noreferrer noopener",target:"_blank",children:"Grafana authentication docs"}),"\xA0for details."]}),children:(0,j.jsx)(Ys.I,{name:"question-circle"})})]})},hd=F=>({disabledTooltip:(0,Ye.css)({display:"flex"}),tooltipItemLink:(0,Ye.css)({color:F.v1.palette.blue95}),lockMessageClass:(0,Ye.css)({fontStyle:"italic",marginLeft:"1.8rem",marginRight:"0.6rem"})}),Xu=[{label:"Yes",value:!0},{label:"No",value:!1}];function Zu({isGrafanaAdmin:F,isExternalUser:_,lockMessage:Q,onGrafanaAdminChange:ue}){const[Ce,Oe]=(0,d.useState)(!1),[we,ke]=(0,d.useState)(F),Ze=()=>Oe(!0),dt=()=>{Oe(!1),ke(F)},mt=()=>ue(we),Ct=$a.TP.hasPermission(Fn.AccessControlAction.UsersPermissionsUpdate)&&!_,Kt=(0,Dt.of)(qu);return(0,j.jsxs)("div",{children:[(0,j.jsx)("h3",{className:"page-heading",children:"Permissions"}),(0,j.jsx)("table",{className:"filter-table form-inline",children:(0,j.jsx)("tbody",{children:(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{className:"width-16",children:"Grafana Admin"}),Ce?(0,j.jsx)("td",{colSpan:2,children:(0,j.jsx)(re.z,{options:Xu,value:we,onChange:ke,autoFocus:!0})}):(0,j.jsx)("td",{colSpan:2,children:F?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(Ys.I,{name:"shield"})," Yes"]}):(0,j.jsx)(j.Fragment,{children:"No"})}),(0,j.jsxs)("td",{children:[Ct&&(0,j.jsx)(Ir.Z,{onClick:Ze,onConfirm:mt,onCancel:dt,confirmText:"Change",children:"Change"}),_&&(0,j.jsx)("div",{className:Kt.lockMessageClass,children:(0,j.jsx)(hc,{lockMessage:Q})})]})]})})})]})}const qu=F=>({lockMessageClass:(0,Ye.css)`
    display: flex;
    justify-content: flex-end;
    font-style: italic;
    margin-right: ${F.spacing(.6)};
  `});var ul=e(96374),fd=e(91634);function eh({user:F,onUserUpdate:_,onUserDelete:Q,onUserDisable:ue,onUserEnable:Ce,onPasswordChange:Oe}){const[we,ke]=(0,d.useState)(!1),[Ze,dt]=(0,d.useState)(!1),mt=(0,d.useRef)(null),Ct=oi=>()=>{ke(oi),!oi&&mt.current&&mt.current.focus()},Kt=(0,d.useRef)(null),Bt=oi=>()=>{dt(oi),!oi&&Kt.current&&Kt.current.focus()},Mt=()=>Q(F.id),Wt=()=>ue(F.id),vn=()=>Ce(F.id),ns=oi=>{_({...F,name:oi})},Ks=oi=>{_({...F,email:oi})},bs=oi=>{_({...F,login:oi})},Hs=F.authLabels?.length&&F.authLabels[0],Nr=Hs?`Synced via ${Hs}`:"",no=F.isExternal||!$a.TP.hasPermissionInMetadata(Fn.AccessControlAction.UsersWrite,F),mp=F.isExternal||!$a.TP.hasPermissionInMetadata(Fn.AccessControlAction.UsersPasswordUpdate,F),kD=$a.TP.hasPermissionInMetadata(Fn.AccessControlAction.UsersDelete,F),GD=$a.TP.hasPermissionInMetadata(Fn.AccessControlAction.UsersDisable,F),QD=$a.TP.hasPermissionInMetadata(Fn.AccessControlAction.UsersEnable,F);return(0,j.jsxs)("div",{children:[(0,j.jsx)("h3",{className:"page-heading",children:"User information"}),(0,j.jsxs)(rn.B,{direction:"column",gap:1.5,children:[(0,j.jsx)("div",{children:(0,j.jsx)("table",{className:"filter-table form-inline",children:(0,j.jsxs)("tbody",{children:[(0,j.jsx)(ei,{label:"Name",value:F.name,locked:no,lockMessage:Nr,onChange:ns}),(0,j.jsx)(ei,{label:"Email",value:F.email,locked:no,lockMessage:Nr,onChange:Ks}),(0,j.jsx)(ei,{label:"Username",value:F.login,locked:no,lockMessage:Nr,onChange:bs}),(0,j.jsx)(ei,{label:"Password",value:"********",inputType:"password",locked:mp,lockMessage:Nr,onChange:Oe})]})})}),(0,j.jsxs)(rn.B,{gap:2,children:[kD&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(me.$n,{variant:"destructive",onClick:Ct(!0),ref:mt,children:"Delete user"}),(0,j.jsx)(ul.u,{isOpen:we,title:"Delete user",body:"Are you sure you want to delete this user?",confirmText:"Delete user",onConfirm:Mt,onDismiss:Ct(!1)})]}),F.isDisabled&&QD&&(0,j.jsx)(me.$n,{variant:"secondary",onClick:vn,children:"Enable user"}),!F.isDisabled&&GD&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(me.$n,{variant:"secondary",onClick:Bt(!0),ref:Kt,children:"Disable user"}),(0,j.jsx)(ul.u,{isOpen:Ze,title:"Disable user",body:"Are you sure you want to disable this user?",confirmText:"Disable user",onConfirm:Wt,onDismiss:Bt(!1)})]})]})]})]})}class ei extends d.PureComponent{constructor(){super(...arguments),this.state={editing:!1,value:this.props.value||""},this.setInputElem=_=>{this.inputElem=_},this.onEditClick=()=>{this.props.inputType==="password"?this.setState({editing:!0,value:""},this.focusInput):this.setState({editing:!0},this.focusInput)},this.onCancelClick=()=>{this.setState({editing:!1,value:this.props.value||""})},this.onInputChange=(_,Q)=>{Q!==fd.O.Invalid&&this.setState({value:_.target.value})},this.onInputBlur=(_,Q)=>{Q!==fd.O.Invalid&&this.setState({value:_.target.value})},this.focusInput=()=>{this.inputElem&&this.inputElem.focus&&this.inputElem.focus()},this.onSave=()=>{this.props.onChange&&this.props.onChange(this.state.value)}}static{this.defaultProps={value:"",locked:!1,lockMessage:"",inputType:"text"}}render(){const{label:_,locked:Q,lockMessage:ue,inputType:Ce}=this.props,{value:Oe}=this.state,we=(0,Ye.cx)("width-16",(0,Ye.css)`
        font-weight: 500;
      `);if(Q)return(0,j.jsx)(th,{label:_,value:Oe,lockMessage:ue});const ke=`${_}-input`;return(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{className:we,children:(0,j.jsx)("label",{htmlFor:ke,children:_})}),(0,j.jsx)("td",{className:"width-25",colSpan:2,children:this.state.editing?(0,j.jsx)(Ne.p,{id:ke,type:Ce,defaultValue:Oe,onBlur:this.onInputBlur,onChange:this.onInputChange,ref:this.setInputElem,width:30}):(0,j.jsx)("span",{children:this.props.value})}),(0,j.jsx)("td",{children:(0,j.jsx)(Ir.Z,{confirmText:"Save",onClick:this.onEditClick,onConfirm:this.onSave,onCancel:this.onCancelClick,children:"Edit"})})]})}}const th=({label:F,value:_,lockMessage:Q})=>{const ue=(0,Ye.css)`
    font-style: italic;
    margin-right: 0.6rem;
  `,Ce=(0,Ye.cx)("width-16",(0,Ye.css)`
      font-weight: 500;
    `);return(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{className:Ce,children:F}),(0,j.jsx)("td",{className:"width-25",colSpan:2,children:_}),(0,j.jsx)("td",{children:(0,j.jsx)("span",{className:ue,children:Q})})]})};var Gr=e(84753);class hl extends d.PureComponent{constructor(){super(...arguments),this.forceAllLogoutButton=(0,d.createRef)(),this.state={showLogoutModal:!1},this.showLogoutConfirmationModal=()=>{this.setState({showLogoutModal:!0})},this.dismissLogoutConfirmationModal=()=>{this.setState({showLogoutModal:!1},()=>{this.forceAllLogoutButton.current?.focus()})},this.onSessionRevoke=_=>()=>{this.props.onSessionRevoke(_)},this.onAllSessionsRevoke=()=>{this.setState({showLogoutModal:!1}),this.props.onAllSessionsRevoke()}}render(){const{sessions:_}=this.props,{showLogoutModal:Q}=this.state,ue=$a.TP.hasPermission(Fn.AccessControlAction.UsersLogout);return(0,j.jsxs)("div",{children:[(0,j.jsx)("h3",{className:"page-heading",children:"Sessions"}),(0,j.jsxs)(rn.B,{direction:"column",gap:1.5,children:[(0,j.jsx)("div",{children:(0,j.jsxs)("table",{className:"filter-table form-inline",children:[(0,j.jsx)("thead",{children:(0,j.jsxs)("tr",{children:[(0,j.jsx)("th",{children:"Last seen"}),(0,j.jsx)("th",{children:"Logged on"}),(0,j.jsx)("th",{children:"IP address"}),(0,j.jsx)("th",{colSpan:2,children:"Browser and OS"})]})}),(0,j.jsx)("tbody",{children:_&&_.map((Ce,Oe)=>(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{children:Ce.isActive?"Now":Ce.seenAt}),(0,j.jsx)("td",{children:(0,Gr.Y)(Ce.createdAt,{dateStyle:"long"})}),(0,j.jsx)("td",{children:Ce.clientIp}),(0,j.jsx)("td",{children:`${Ce.browser} on ${Ce.os} ${Ce.osVersion}`}),(0,j.jsx)("td",{children:ue&&(0,j.jsx)(Ir.Z,{confirmText:"Confirm logout",confirmVariant:"destructive",onConfirm:this.onSessionRevoke(Ce.id),children:"Force logout"})})]},`${Ce.id}-${Oe}`))})]})}),(0,j.jsxs)("div",{children:[ue&&_.length>0&&(0,j.jsx)(me.$n,{variant:"secondary",onClick:this.showLogoutConfirmationModal,ref:this.forceAllLogoutButton,children:"Force logout from all devices"}),(0,j.jsx)(ul.u,{isOpen:Q,title:"Force logout from all devices",body:"Are you sure you want to force logout from all devices?",confirmText:"Force logout",onConfirm:this.onAllSessionsRevoke,onDismiss:this.dismissLogoutConfirmationModal})]})]})]})}}const nh=hl;var Br=e(57334);class sh extends d.PureComponent{constructor(){super(...arguments),this.onUserUpdate=_=>{this.props.updateUser(_)},this.onPasswordChange=_=>{const{user:Q,setUserPassword:ue}=this.props;Q&&ue(Q.id,_)},this.onUserDelete=_=>{this.props.deleteUser(_)},this.onUserDisable=_=>{this.props.disableUser(_)},this.onUserEnable=_=>{this.props.enableUser(_)},this.onGrafanaAdminChange=_=>{const{user:Q,updateUserPermissions:ue}=this.props;Q&&ue(Q.id,_)},this.onOrgRemove=_=>{const{user:Q,deleteOrgUser:ue}=this.props;Q&&ue(Q.id,_)},this.onOrgRoleChange=(_,Q)=>{const{user:ue,updateOrgUserRole:Ce}=this.props;ue&&Ce(ue.id,_,Q)},this.onOrgAdd=(_,Q)=>{const{user:ue,addOrgUser:Ce}=this.props;ue&&Ce(ue,_,Q)},this.onSessionRevoke=_=>{const{user:Q,revokeSession:ue}=this.props;Q&&ue(_,Q.id)},this.onAllSessionsRevoke=()=>{const{user:_,revokeAllSessions:Q}=this.props;_&&Q(_.id)},this.onUserSync=()=>{const{user:_,syncLdapUser:Q}=this.props;_&&Q(_.id)}}async componentDidMount(){const{match:_,loadAdminUserPage:Q}=this.props;Q(parseInt(_.params.id,10))}render(){const{user:_,orgs:Q,sessions:ue,ldapSyncInfo:Ce,isLoading:Oe}=this.props,we=_?.isExternal&&_?.authLabels?.includes("LDAP"),ke=$a.TP.hasPermission(Fn.AccessControlAction.UsersAuthTokenList),Ze=$a.TP.hasPermission(Fn.AccessControlAction.LDAPStatusRead),dt=_?.authLabels?.[0],mt=dt?`Synced via ${dt}`:"",Ct={text:_?.login??"",icon:"shield",subTitle:"Manage settings for an individual user."};return(0,j.jsx)(kr.Y,{navId:"global-users",pageNav:Ct,children:(0,j.jsx)(kr.Y.Contents,{isLoading:Oe,children:(0,j.jsxs)(rn.B,{gap:5,direction:"column",children:[_&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(eh,{user:_,onUserUpdate:this.onUserUpdate,onUserDelete:this.onUserDelete,onUserDisable:this.onUserDisable,onUserEnable:this.onUserEnable,onPasswordChange:this.onPasswordChange}),we&&_?.isExternallySynced&&(0,lc.a)("ldapsync")&&Ce&&Ze&&(0,j.jsx)(ku,{ldapSyncInfo:Ce,user:_,onUserSync:this.onUserSync}),(0,j.jsx)(Zu,{isGrafanaAdmin:_.isGrafanaAdmin,isExternalUser:_?.isGrafanaAdminExternallySynced,lockMessage:mt,onGrafanaAdminChange:this.onGrafanaAdminChange})]}),Q&&(0,j.jsx)(Gu,{user:_,orgs:Q,isExternalUser:_?.isExternallySynced,onOrgRemove:this.onOrgRemove,onOrgRoleChange:this.onOrgRoleChange,onOrgAdd:this.onOrgAdd}),ue&&ke&&(0,j.jsx)(nh,{sessions:ue,onSessionRevoke:this.onSessionRevoke,onAllSessionsRevoke:this.onAllSessionsRevoke})]})})})}}const ah=F=>({user:F.userAdmin.user,sessions:F.userAdmin.sessions,orgs:F.userAdmin.orgs,ldapSyncInfo:F.ldap.syncInfo,isLoading:F.userAdmin.isLoading,error:F.userAdmin.error}),rh={loadAdminUserPage:Br.kz,updateUser:Br.TK,setUserPassword:Br.ly,disableUser:Br.MV,enableUser:Br.nr,deleteUser:Br.hG,updateUserPermissions:Br.N6,addOrgUser:Br.nh,updateOrgUserRole:Br.P3,deleteOrgUser:Br.Pi,revokeSession:Br.T$,revokeAllSessions:Br.VR,syncLdapUser:Br.mI},ih=(0,co.connect)(ah,rh)(sh);var gd=e(49785),gi=e(48840);const lh=({ldapConnectionInfo:F})=>{const _=(0,d.useMemo)(()=>[{id:"host",header:"Host",disableGrow:!0},{id:"port",header:"Port",disableGrow:!0},{id:"available",cell:ue=>ue.cell.value?(0,j.jsx)(rn.B,{justifyContent:"end",children:(0,j.jsx)(fi.m,{content:"Connection is available",children:(0,j.jsx)(Ys.I,{name:"check"})})}):(0,j.jsx)(rn.B,{justifyContent:"end",children:(0,j.jsx)(fi.m,{content:"Connection is not available",children:(0,j.jsx)(Ys.I,{name:"exclamation-triangle"})})})}],[]),Q=(0,d.useMemo)(()=>F,[F]);return(0,j.jsx)("section",{children:(0,j.jsxs)(rn.B,{direction:"column",gap:2,children:[(0,j.jsx)(mr.E,{color:"primary",element:"h3",children:"LDAP Connection"}),(0,j.jsx)(gi.j,{data:Q,columns:_,getRowId:ue=>ue.host+ue.port}),(0,j.jsx)(Ai,{ldapConnectionInfo:F})]})})},Ai=({ldapConnectionInfo:F})=>{if(!F.some(Ce=>Ce.error))return null;const Q=[];F.forEach(Ce=>{Ce.error&&Q.push(Ce)});const ue=Q.map((Ce,Oe)=>(0,j.jsxs)("div",{children:[(0,j.jsxs)("span",{style:{fontWeight:500},children:[Ce.host,":",Ce.port,(0,j.jsx)("br",{})]}),(0,j.jsx)("span",{children:Ce.error}),Oe!==Q.length-1&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("br",{}),(0,j.jsx)("br",{})]})]},Oe));return(0,j.jsx)(In.F,{title:"Connection error",severity:Fn.AppNotificationSeverity.Error,children:ue})},pi="dddd YYYY-MM-DD HH:mm zz",ch=({ldapSyncInfo:F})=>{const _=(0,cc.LE)(F.nextSync,{format:pi}),Q=[{id:"syncAttribute"},{id:"syncValue"}],ue=[{syncAttribute:"Active synchronization",syncValue:F.enabled?"Enabled":"Disabled"},{syncAttribute:"Scheduled",syncValue:F.schedule},{syncAttribute:"Next synchronization",syncValue:_}];return(0,j.jsxs)("section",{children:[(0,j.jsx)(mr.E,{element:"h3",children:"LDAP Synchronization"}),(0,j.jsx)(gi.j,{data:ue,columns:Q,getRowId:Ce=>Ce.syncAttribute})]})},$l=({groups:F})=>{const _=(0,d.useMemo)(()=>F,[F]),Q=(0,d.useMemo)(()=>[{id:"groupDN",header:"LDAP Group"},{id:"orgName",header:"Organization",cell:ue=>ue.value&&ue.row.original.orgRole?ue.value:""},{id:"orgRole",header:"Role",cell:ue=>ue.value||(0,j.jsxs)(j.Fragment,{children:["No match"," ",(0,j.jsx)(fi.m,{content:"No matching organizations found",children:(0,j.jsx)(Ys.I,{name:"info-circle"})})]})}],[]);return(0,j.jsx)(gi.j,{headerTooltips:{orgName:{content:"Only the first match for an Organization will be used",iconName:"info-circle"}},columns:Q,data:_,getRowId:ue=>ue.orgId+ue.orgRole+ue.groupDN})},pd=({info:F})=>{const _=(0,d.useMemo)(()=>[{id:"userInfo",header:"User Information",disableGrow:!0},{id:"ldapValue"},{id:"cfgAttrValue",header:"LDAP attribute"}],[]),Q=(0,d.useMemo)(()=>[{userInfo:"First name",ldapValue:F.name.ldapValue,cfgAttrValue:F.name.cfgAttrValue},{userInfo:"Surname",ldapValue:F.surname.ldapValue,cfgAttrValue:F.surname.cfgAttrValue},{userInfo:"Username",ldapValue:F.login.ldapValue,cfgAttrValue:F.login.cfgAttrValue},{userInfo:"Email",ldapValue:F.email.ldapValue,cfgAttrValue:F.email.cfgAttrValue}],[F]);return(0,j.jsx)(gi.j,{columns:_,data:Q,getRowId:ue=>ue.userInfo})},dh=({permissions:F})=>{const _=(0,d.useMemo)(()=>[{id:"permission",header:"Permissions",disableGrow:!0},{id:"value"}],[]),Q=(0,d.useMemo)(()=>[{permission:"Grafana admin",value:F.isGrafanaAdmin?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(Ys.I,{name:"shield"})," Yes"]}):"No"},{permission:"Status",value:F.isDisabled?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(Ys.I,{name:"times"})," Inactive"]}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(Ys.I,{name:"check"})," Active"]})}],[F]);return(0,j.jsx)(gi.j,{data:Q,columns:_,getRowId:ue=>ue.permission})},uh=({teams:F})=>{const _=(0,d.useMemo)(()=>[{id:"groupDN",header:"LDAP Group"},{id:"orgName",header:"Organization",cell:({row:{original:{orgName:Q}}})=>(0,j.jsx)(j.Fragment,{children:Q||"No matching teams found"})},{id:"teamName",header:"Team",cell:({row:{original:{teamName:Q,orgName:ue}}})=>Q&&ue?Q:""}],[]);return(0,j.jsx)(gi.j,{data:F,columns:_,getRowId:Q=>Q.teamName})},hh=({ldapUser:F})=>(0,j.jsxs)(rn.B,{direction:"column",gap:4,children:[(0,j.jsx)(pd,{info:F.info}),(0,j.jsx)(dh,{permissions:F.permissions}),F.roles&&F.roles.length>0&&(0,j.jsx)($l,{groups:F.roles}),F.teams&&F.teams.length>0?(0,j.jsx)(uh,{teams:F.teams}):(0,j.jsx)(ce.a,{children:(0,j.jsx)(mr.E,{children:"No teams found via LDAP"})})]}),fh={text:"LDAP",subTitle:"Verify your LDAP and user mapping configuration.",icon:"book",id:"LDAP"},md=({clearUserMappingInfo:F,queryParams:_,loadLdapState:Q,loadLdapSyncStatus:ue,loadUserMapping:Ce,clearUserError:Oe,ldapUser:we,userError:ke,ldapError:Ze,ldapSyncInfo:dt,ldapConnectionInfo:mt})=>{const[Ct,Kt]=(0,d.useState)(!0),{register:Bt,handleSubmit:Mt}=(0,gd.mN)(),Wt=(0,d.useCallback)(async bs=>Ce(bs),[Ce]);(0,d.useEffect)(()=>{const bs=async()=>Promise.all([Q(),ue()]);async function Hs(){await F(),await bs(),_.username&&await Wt(_.username),Kt(!1)}Hs()},[F,Wt,Q,ue,_]);const vn=({username:bs})=>{bs&&Wt(bs)},ns=()=>{Oe()},Ks=$a.TP.hasPermission(Fn.AccessControlAction.LDAPUsersRead);return(0,j.jsx)(kr.Y,{navId:"authentication",pageNav:fh,children:(0,j.jsx)(kr.Y.Contents,{isLoading:Ct,children:(0,j.jsxs)(rn.B,{direction:"column",gap:4,children:[Ze&&Ze.title&&(0,j.jsx)(In.F,{title:Ze.title,severity:Fn.AppNotificationSeverity.Error,children:Ze.body}),(0,j.jsx)(lh,{ldapConnectionInfo:mt}),(0,lc.a)("ldapsync")&&dt&&(0,j.jsx)(ch,{ldapSyncInfo:dt}),Ks&&(0,j.jsxs)("section",{children:[(0,j.jsx)("h3",{children:"Test user mapping"}),(0,j.jsx)("form",{onSubmit:Mt(vn),children:(0,j.jsx)(qs.D,{label:"Username",children:(0,j.jsx)(Ne.p,{...Bt("username",{required:!0}),width:34,id:"username",type:"text",defaultValue:_.username,addonAfter:(0,j.jsx)(me.$n,{variant:"primary",type:"submit",children:"Run"})})})}),ke&&ke.title&&(0,j.jsx)(In.F,{title:ke.title,severity:Fn.AppNotificationSeverity.Error,onRemove:ns,children:ke.body}),we&&(0,j.jsx)(hh,{ldapUser:we})]})]})})})},fc=F=>({ldapConnectionInfo:F.ldap.connectionInfo,ldapUser:F.ldap.user,ldapSyncInfo:F.ldap.syncInfo,userError:F.ldap.userError,ldapError:F.ldap.ldapError}),Vo={loadLdapState:Br.JI,loadLdapSyncStatus:Br.pm,loadUserMapping:Br.Kg,clearUserError:Br.DX,clearUserMappingInfo:Br.Jc},gh=(0,co.connect)(fc,Vo)(md);var Bs=e(27921),br=e(75471);function ph(F=Y.config){return[{path:"/alerting",component:er(()=>e.e(3236).then(e.bind(e,86695)))},{path:"/alerting/home",exact:!1,component:er(()=>e.e(3236).then(e.bind(e,86695)))},{path:"/alerting/list",roles:(0,br.C0)([Fn.AccessControlAction.AlertingRuleRead,Fn.AccessControlAction.AlertingRuleExternalRead]),component:er(()=>Promise.all([e.e(7049),e.e(3511)]).then(e.bind(e,76543)))},{path:"/alerting/routes",roles:(0,br.C0)([Fn.AccessControlAction.AlertingNotificationsRead,Fn.AccessControlAction.AlertingNotificationsExternalRead]),component:er(()=>e.e(6719).then(e.bind(e,34708)))},{path:"/alerting/routes/mute-timing/new",roles:(0,br.C0)([Fn.AccessControlAction.AlertingNotificationsWrite,Fn.AccessControlAction.AlertingNotificationsExternalWrite]),component:er(()=>e.e(4501).then(e.bind(e,39349)))},{path:"/alerting/routes/mute-timing/edit",roles:(0,br.C0)([Fn.AccessControlAction.AlertingNotificationsWrite,Fn.AccessControlAction.AlertingNotificationsExternalWrite]),component:er(()=>e.e(4501).then(e.bind(e,39349)))},{path:"/alerting/silences",roles:(0,br.C0)([Fn.AccessControlAction.AlertingInstanceRead,Fn.AccessControlAction.AlertingInstancesExternalRead,Fn.AccessControlAction.AlertingSilenceRead]),component:er(()=>e.e(9347).then(e.bind(e,69645)))},{path:"/alerting/silence/new",roles:(0,br.C0)([Fn.AccessControlAction.AlertingInstanceCreate,Fn.AccessControlAction.AlertingInstancesExternalWrite]),component:er(()=>e.e(9347).then(e.bind(e,69645)))},{path:"/alerting/silence/:id/edit",component:er(()=>e.e(9347).then(e.bind(e,69645)))},{path:"/alerting/notifications",roles:(0,br.C0)([Fn.AccessControlAction.AlertingNotificationsRead,Fn.AccessControlAction.AlertingNotificationsExternalRead]),component:er(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/templates/*",roles:(0,br.C0)([Fn.AccessControlAction.AlertingNotificationsRead,Fn.AccessControlAction.AlertingNotificationsExternalRead]),component:er(()=>e.e(9224).then(e.bind(e,35868)))},{path:"/alerting/notifications/:type/new",roles:(0,br.C0)([Fn.AccessControlAction.AlertingNotificationsWrite,Fn.AccessControlAction.AlertingNotificationsExternalWrite]),component:er(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/receivers/:id/edit",roles:(0,br.C0)([Fn.AccessControlAction.AlertingNotificationsWrite,Fn.AccessControlAction.AlertingNotificationsExternalWrite,Fn.AccessControlAction.AlertingNotificationsRead,Fn.AccessControlAction.AlertingNotificationsExternalRead]),component:er(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/:type/:id/edit",roles:(0,br.C0)([Fn.AccessControlAction.AlertingNotificationsWrite,Fn.AccessControlAction.AlertingNotificationsExternalWrite]),component:er(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/:type/:id/duplicate",roles:(0,br.C0)([Fn.AccessControlAction.AlertingNotificationsWrite,Fn.AccessControlAction.AlertingNotificationsExternalWrite]),component:er(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/:type",roles:(0,br.C0)([Fn.AccessControlAction.AlertingNotificationsWrite,Fn.AccessControlAction.AlertingNotificationsExternalWrite]),component:er(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/groups/",roles:(0,br.C0)([Fn.AccessControlAction.AlertingInstanceRead,Fn.AccessControlAction.AlertingInstancesExternalRead]),component:er(()=>e.e(8427).then(e.bind(e,12564)))},{path:"/alerting/history/",roles:(0,br.C0)([Fn.AccessControlAction.AlertingRuleRead]),component:er(()=>Promise.all([e.e(285),e.e(44)]).then(e.bind(e,53666)))},{path:"/alerting/new/:type?",pageClass:"page-alerting",roles:(0,br.C0)([Fn.AccessControlAction.AlertingRuleCreate,Fn.AccessControlAction.AlertingRuleExternalWrite]),component:er(()=>Promise.all([e.e(6562),e.e(9947),e.e(7049),e.e(4009)]).then(e.bind(e,50166)))},{path:"/alerting/:id/edit",pageClass:"page-alerting",roles:(0,br.C0)([Fn.AccessControlAction.AlertingRuleUpdate,Fn.AccessControlAction.AlertingRuleExternalWrite]),component:er(()=>Promise.all([e.e(6562),e.e(9947),e.e(7049),e.e(4009)]).then(e.bind(e,50166)))},{path:"/alerting/:id/modify-export",pageClass:"page-alerting",roles:(0,br.C0)([Fn.AccessControlAction.AlertingRuleRead]),component:er(()=>Promise.all([e.e(6562),e.e(9947),e.e(7049),e.e(4009)]).then(e.bind(e,69179)))},{path:"/alerting/:sourceName/:id/view",pageClass:"page-alerting",roles:(0,br.C0)([Fn.AccessControlAction.AlertingRuleRead,Fn.AccessControlAction.AlertingRuleExternalRead]),component:er(()=>Promise.resolve().then(e.bind(e,79741)))},{path:"/alerting/:sourceName/:name/find",pageClass:"page-alerting",roles:(0,br.C0)([Fn.AccessControlAction.AlertingRuleRead,Fn.AccessControlAction.AlertingRuleExternalRead]),component:er(()=>e.e(5516).then(e.bind(e,6165)))},{path:"/alerting/admin",roles:()=>["Admin"],component:er(()=>e.e(9438).then(e.bind(e,53191)))}]}function er(F){const _=()=>e.e(9029).then(e.bind(e,5961));return(0,Bs.A)(Y.config.unifiedAlertingEnabled?F:_)}var gc=e(56361),Ji=e(6320);const mh=F=>({alertContent:(0,Ye.css)`
    display: flex;
    flex-direction: row;
    padding: 0;
    justify-content: space-between;
    align-items: center;
  `,alertParagraph:(0,Ye.css)`
    margin: 0 ${F.spacing(1)} 0 0;
    line-height: ${F.spacing(F.components.height.sm)};
  `});function vh(){const F=(0,Dt.of)(mh),[_,Q]=(0,d.useState)(!0);return _?(0,j.jsx)(In.F,{severity:"info",title:"",onRemove:()=>Q(!1),children:(0,j.jsxs)("div",{className:F.alertContent,children:[(0,j.jsx)("p",{className:F.alertParagraph,children:"Data sources have a new home! You can discover new data sources or manage existing ones in the Connections page, accessible from the main menu."}),(0,j.jsx)(me.z9,{"aria-label":"Link to Connections",icon:"arrow-right",href:Ji.b.DataSources,fill:"text",children:"Go to connections"})]})}):(0,j.jsx)(j.Fragment,{})}function yh(){return[{path:`/${Ji.q}`,exact:!1,component:(0,Bs.A)(()=>Promise.all([e.e(6359),e.e(3418),e.e(2154)]).then(e.bind(e,19514)))}]}var Xi=e(83883),Ri=e(57220),fl=(F=>(F.ViewIRMMainPage="grafana_irm_configuration_tracker_main_page_view",F.OpenEssentials="grafana_irm_configuration_tracker_essentials_open",F.CloseEssentials="grafana_irm_configuration_tracker_essentials_closed",F.ClickDataSources="grafana_irm_configuration_tracker_data_sources_clicked",F))(fl||{});function Vl(F,_){(0,xr.rR)(F,{..._})}var pc=e(3704),xh=e(79938),vd=e(82843),yd=e(37534),xd=e(730);function Eh(){const[F,{data:_,isLoading:Q}]=xh.hK.endpoints.rulerRules.useLazyQuery({refetchOnFocus:!0,refetchOnReconnect:!0}),{dsFeatures:ue,isLoadingDsFeatures:Ce}=(0,xd.O3)(Ri.hY),Oe=ue?.rulerConfig;return(0,d.useEffect)(()=>{Oe&&F({rulerConfig:Oe})},[Oe,F]),{isDone:(_?Object.entries(_).flatMap(([Ze,dt])=>dt.flatMap(mt=>mt.rules)):[]).length>0,isLoading:Q||Ce}}function Dh(F){return F.some(_=>_.grafana_managed_receiver_configs?.some(Q=>Q.type===yd.J4.OnCall))}function Ph(){const F=vd.m.endpoints.getAlertmanagerConfiguration.useQuery(Ri.hY,{refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{contactPoints:F.data?.alertmanager_config?.receivers??[],isLoading:F.isLoading}}function bh(){const F=vd.m.endpoints.getAlertmanagerConfiguration.useQuery(Ri.hY,{refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{defaultContactpoint:F.data?.alertmanager_config?.route?.receiver??"",isLoading:F.isLoading}}const Ch="<example@email.com>";function Th(F,_){return _.some(ue=>ue.name===F&&ue.grafana_managed_receiver_configs?.some(Ce=>Ce.name===F&&Ce.settings?.address!==Ch))}var gl=e(99494),pl=e(49962);const Mh=F=>`/api/plugins/${gl.W.Incident}/resources${F}`,Ed=pl.Hr.injectEndpoints({endpoints:F=>({getIncidentsPluginConfig:F.query({query:()=>({url:Mh("/api/ConfigurationTrackerService.GetConfigurationTracker"),data:{},method:"POST",showErrorAlert:!1})})})});var mc=e(12210);function Sh(){const{installed:F,loading:_}=(0,mc._)(gl.W.Incident),{data:Q,isLoading:ue}=Ed.endpoints.getIncidentsPluginConfig.useQuery();return{isInstalled:F??!1,isChatOpsInstalled:Q?.isChatOpsInstalled??!1,isIncidentCreated:Q?.isIncidentCreated??!1,isLoading:_||ue}}var vc=e(26423);function Oh(){const{installed:F}=(0,mc._)(gl.W.OnCall),{data:_}=vc.WG.endpoints.grafanaOnCallIntegrations.useQuery(void 0,{skip:!F,refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return _??[]}function Ih(){const{data:F,isLoading:_}=vc.WG.endpoints.onCallConfigChecks.useQuery(void 0,{refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{isLoading:_,onCallConfigChecks:F??{is_chatops_connected:!1,is_integration_chatops_connected:!1}}}function Ah(){return Oh().map(_=>({label:_.display_name,value:_.value}))}function Rh(){const{onCallConfigChecks:{is_chatops_connected:F,is_integration_chatops_connected:_},isLoading:Q}=Ih();return{is_chatops_connected:F,is_integration_chatops_connected:_,isLoading:Q}}const Lh=`/api/plugins/${gl.W.Slo}/resources/v1`,jh=pl.Hr.injectEndpoints({endpoints:F=>({getSlos:F.query({query:()=>({url:`${Lh}/slo`,showErrorAlert:!1}),providesTags:["GrafanaSlo"]})})});function Bh(){const{installed:F}=(0,mc._)(gl.W.Slo),{data:_,isLoading:Q}=jh.endpoints.getSlos.useQuery(void 0,{skip:!F,refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{isLoading:Q,hasSlo:!!_?.slos.length,hasSloWithAlert:!!_?.slos?.some(ue=>ue.alerting)}}function Uh(){const{contactPoints:F,isLoading:_}=Ph(),{defaultContactpoint:Q,isLoading:ue}=bh(),{isDone:Ce,isLoading:Oe}=Eh(),{isChatOpsInstalled:we,isInstalled:ke,isLoading:Ze}=Sh(),dt=Ah(),{is_chatops_connected:mt,is_integration_chatops_connected:Ct,isLoading:Kt}=Rh(),{hasSlo:Bt,hasSloWithAlert:Mt,isLoading:Wt}=Bh();return{alerting:{contactPoints:F,defaultContactpoint:Q,isCreateAlertRuleDone:Ce},incidents:{isChatOpsInstalled:we,isIncidentsInstalled:ke},onCall:{onCallOptions:dt,is_chatops_connected:mt,is_integration_chatops_connected:Ct},slo:{hasSlo:Bt,hasSloWithAlert:Mt},isLoading:_||ue||Oe||Ze||Kt||Wt}}function Nh(){const{alerting:{contactPoints:F,defaultContactpoint:_,isCreateAlertRuleDone:Q},incidents:{isChatOpsInstalled:ue,isIncidentsInstalled:Ce},onCall:{onCallOptions:Oe,is_chatops_connected:we,is_integration_chatops_connected:ke},slo:{hasSlo:Ze,hasSloWithAlert:dt},isLoading:mt}=Uh();function Ct(Wt,vn){const ns=(0,pc.c)(vn+Wt,{returnTo:location.pathname+location.search});I.Ny.push(ns)}const Kt={sections:[{title:"Detect",description:"Configure Grafana Alerting",steps:[{title:"Update default email contact point",description:"Add a valid email to the default email contact point.",button:{type:"openLink",urlLink:{url:`/alerting/notifications/receivers/${_}/edit`,queryParams:{alertmanager:"grafana"}},label:"Edit",labelOnDone:"View",urlLinkOnDone:{url:"/alerting/notifications"}},done:Th(_,F)},{title:"Connect alerting to OnCall",description:"Create an OnCall integration for an alerting contact point.",button:{type:"openLink",urlLink:{url:"/alerting/notifications/receivers/new"},label:"Connect",urlLinkOnDone:{url:"/alerting/notifications"},labelOnDone:"View"},done:Dh(F)},{title:"Create alert rule",description:"Create an alert rule to monitor your system.",button:{type:"openLink",urlLink:{url:"/alerting/new"},label:"Create",urlLinkOnDone:{url:"/alerting/list"},labelOnDone:"View"},done:Q},{title:"Create your first SLO",description:"Create SLOs to monitor your service.",button:{type:"openLink",urlLink:{url:"/a/grafana-slo-app/wizard/new"},label:"Create",urlLinkOnDone:{url:"/a/grafana-slo-app/manage-slos"},labelOnDone:"View"},done:Ze},{title:"Enable SLO alerting",description:"Configure SLO alerting to receive notifications when your SLOs are breached.",button:{type:"openLink",urlLink:{queryParams:{alertsEnabled:"disabled"},url:"/a/grafana-slo-app/manage-slos"},label:"Enable",urlLinkOnDone:{queryParams:{alertsEnabled:"enabled"},url:"/a/grafana-slo-app/manage-slos"},labelOnDone:"View"},done:dt}]},{title:"Respond",description:"Configure OnCall and Incident",steps:[{title:"Initialize Incident plugin",description:"Initialize the Incident plugin to declare and manage incidents.",button:{type:"openLink",urlLink:{url:"/a/grafana-incident-app/walkthrough/generate-key"},label:"Initialize",urlLinkOnDone:{url:"/a/grafana-incident-app"},labelOnDone:"View"},done:Ce},{title:"Connect your Messaging workspace to OnCall",description:"Receive alerts and oncall notifications within your chat environment.",button:{type:"openLink",urlLink:{url:"/a/grafana-oncall-app/settings",queryParams:{tab:"ChatOps",chatOpsTab:"Slack"}},label:"Connect",urlLinkOnDone:{url:"/a/grafana-oncall-app/settings",queryParams:{tab:"ChatOps"}},labelOnDone:"View"},done:we},{title:"Connect your Messaging workspace to Incident",description:"Automatically create an incident channel and manage incidents directly within your chat environment.",button:{type:"openLink",urlLink:{url:"/a/grafana-incident-app/integrations/grate.slack"},label:"Connect",urlLinkOnDone:{url:"/a/grafana-incident-app/integrations"}},done:ue},{title:"Add Messaging workspace channel to OnCall Integration",description:"Select ChatOps channels to route notifications",button:{type:"openLink",urlLink:{url:"/a/grafana-oncall-app/integrations/"},label:"Add",urlLinkOnDone:{url:"/a/grafana-oncall-app/integrations/"},labelOnDone:"View"},done:ke}]},{title:"Test your configuration",description:"",steps:[{title:"Send OnCall demo alert via Alerting integration",description:"In the integration page, click Send demo alert, to review your notification",button:{type:"dropDown",label:"Select integration",options:Oe,onClickOption:Wt=>Ct(Wt,"/a/grafana-oncall-app/integrations/"),stepNotAvailableText:"No integrations available"}},{title:"Create Incident drill",description:"Practice solving an Incident",button:{type:"openLink",urlLink:{url:"/a/grafana-incident-app",queryParams:{declare:"new",drill:"1"}},label:"Start drill"}}]}]},{stepsDone:Bt,totalStepsToDo:Mt}=Kt.sections.reduce((Wt,vn)=>{const ns=vn.steps.filter(bs=>bs.done).length,Ks=vn.steps.reduce((bs,Hs)=>Hs.done!==void 0?bs+1:bs,0);return{stepsDone:Wt.stepsDone+ns,totalStepsToDo:Wt.totalStepsToDo+Ks}},{stepsDone:0,totalStepsToDo:0});return{essentialContent:Kt,stepsDone:Bt,totalStepsToDo:Mt,isLoading:mt}}const yc=({dataSourceConfigurationData:{dataSourceCompatibleWithAlerting:F},essentialsConfigurationData:{stepsDone:_,totalStepsToDo:Q}})=>(0,d.useMemo)(()=>{function ue(){const Ce=F?"You have connected a datasource.":"Connect at least one data source to start receiving data",Oe=F?"View":"Connect";return{id:xc.CONNECT_DATASOURCE,title:"Connect data source",description:Ce,actionButtonTitle:Oe,isDone:F}}return[ue(),{id:xc.ESSENTIALS,title:"Essentials",titleIcon:"star",description:"Set up the necessary features to start using Grafana IRM workflows",actionButtonTitle:_===Q?"View":"Configure",stepsDone:_,totalStepsToDo:Q}]},[F,_,Q]);var wh=e(39558);function Dd({stepsDone:F,totalStepsToDo:_}){const Q=(0,Dt.of)(Wh);return _===0?null:(0,j.jsx)("div",{className:Q.containerStyles,role:"progressbar","aria-valuenow":F,"aria-valuemax":_,children:(0,j.jsx)("div",{className:Q.fillerStyles(F/_*100)})})}function Pd({stepsDone:F,totalStepsToDo:_}){return(0,j.jsxs)("div",{children:[(0,j.jsx)(mr.E,{color:"success",children:F})," of ",_]})}function Wh(F){return{containerStyles:(0,Ye.css)({height:F.spacing(2),borderRadius:F.shape.radius.pill,backgroundColor:F.colors.border.weak,flex:"auto"}),fillerStyles:_=>(0,Ye.css)({height:"100%",width:`${_}%`,backgroundColor:F.colors.success.main,borderRadius:F.shape.radius.pill,textAlign:"right"})}}function Fh({config:F,handleActionClick:_,isLoading:Q=!1}){const ue=(0,Dt.of)(Kh);return(0,j.jsx)(rn.B,{direction:"column",gap:1,justifyContent:"space-around",children:(0,j.jsxs)("div",{className:ue.cardContent,children:[(0,j.jsxs)(rn.B,{direction:"column",gap:1,children:[(0,j.jsxs)(rn.B,{direction:"row",alignItems:"center",justifyContent:"space-between",gap:1,children:[(0,j.jsxs)(rn.B,{direction:"row",gap:1,alignItems:"center",children:[F.title,F.titleIcon&&(0,j.jsx)(Ys.I,{name:F.titleIcon}),F.isDone&&!Q&&(0,j.jsx)(Ys.I,{name:"check-circle",color:"green",size:"lg"})]}),F.stepsDone&&F.totalStepsToDo&&!Q&&(0,j.jsxs)(rn.B,{direction:"row",gap:.5,children:[(0,j.jsx)(Pd,{stepsDone:F.stepsDone,totalStepsToDo:F.totalStepsToDo}),"complete"]})]}),(0,j.jsxs)(rn.B,{direction:"column",children:[Q?(0,j.jsx)(wh._,{text:"Loading configuration...."}):F.description,!Q&&F.stepsDone&&F.totalStepsToDo&&(0,j.jsx)(Dd,{stepsDone:F.stepsDone,totalStepsToDo:F.totalStepsToDo})]})]}),(0,j.jsx)(rn.B,{direction:"row",gap:1,justifyContent:"flex-start",alignItems:"flex-end",children:(0,j.jsx)(me.$n,{variant:"secondary",onClick:()=>_(F.id,F.isDone),children:F.actionButtonTitle})})]})})}const Kh=F=>({cardTitle:(0,Ye.css)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"}),cardContent:(0,Ye.css)({background:F.colors.background.secondary,padding:F.spacing(2),borderRadius:F.shape.radius.default,height:"100%",gap:F.spacing(1),display:"flex",flexDirection:"column",justifyContent:"space-between"})});var _o=e(87978),eo=e(83122),Po=e(38138);function vp({onClose:F,essentialsConfig:_,stepsDone:Q,totalStepsToDo:ue}){return(0,j.jsx)(_o._,{title:"Essentials",subtitle:"Complete the following configuration tasks",onClose:F,children:(0,j.jsx)(yp,{essentialContent:_,stepsDone:Q,totalStepsToDo:ue})})}function yp({essentialContent:F,stepsDone:_,totalStepsToDo:Q}){return(0,j.jsxs)(rn.B,{direction:"column",gap:1,children:[(0,j.jsx)(_h,{stepsDone:_,totalStepsToDo:Q}),F.sections.map(ue=>(0,j.jsx)(bd,{section:ue},ue.title))]})}function bd({section:F}){const _=(0,Dt.of)(zh);return(0,j.jsxs)("div",{className:_.wrapper,children:[(0,j.jsx)(mr.E,{element:"h4",children:F.title}),(0,j.jsx)(mr.E,{color:"secondary",children:F.description}),(0,j.jsx)(rn.B,{direction:"column",gap:2,children:F.steps.map((Q,ue)=>(0,j.jsx)($h,{step:Q},ue))})]})}function Cd({done:F}){return F?(0,j.jsx)(Ys.I,{name:"check-circle",color:"green","data-testid":"checked-step"}):(0,j.jsx)(Ys.I,{name:"circle","data-testid":"unckecked-step"})}function $h({step:F}){return(0,j.jsxs)(rn.B,{direction:"row",justifyContent:"space-between","data-testid":"step",children:[(0,j.jsxs)(rn.B,{direction:"row",alignItems:"center",children:[F.done!==void 0&&(0,j.jsx)(Cd,{done:F.done}),(0,j.jsx)(mr.E,{variant:"body",children:F.title}),(0,j.jsx)(fi.m,{content:F.description,placement:"right",children:(0,j.jsx)(Ys.I,{name:"question-circle"})})]}),(0,j.jsx)(Vh,{...F.button,done:F.done,"data-testid":"step-button"})]})}function Td(F){const{urlLink:_,label:Q,urlLinkOnDone:ue,labelOnDone:Ce,done:Oe}=F,we=_?.url?(0,pc.c)(_.url,{returnTo:location.pathname+location.search,..._.queryParams}):"",ke=ue?.url?(0,pc.c)(ue.url,{returnTo:location.pathname+location.search,...ue.queryParams}):"",Ze=Oe?ke:we;return(0,j.jsx)(me.z9,{href:Ze,variant:"secondary",children:Oe?Ce??Q:Q})}function Vh({type:F,urlLink:_,urlLinkOnDone:Q,label:ue,labelOnDone:Ce,options:Oe,onClickOption:we,done:ke,stepNotAvailableText:Ze}){switch(F){case"openLink":return(0,j.jsx)(Td,{urlLink:_,label:ue,urlLinkOnDone:Q,labelOnDone:Ce,done:ke});case"dropDown":return Oe?.length?(0,j.jsx)(eo.m,{overlay:(0,j.jsx)(Po.W,{children:Oe?.map(dt=>(0,j.jsx)(Po.W.Item,{label:dt.label,onClick:()=>{we?.(dt.value)}},dt.value))}),children:(0,j.jsxs)(me.$n,{variant:"secondary",size:"md",children:[ue,(0,j.jsx)(Ys.I,{name:"angle-down"})]})}):(0,j.jsxs)(mr.E,{children:[Ze??"No options available"," "]})}}function _h({stepsDone:F,totalStepsToDo:_}){return(0,j.jsxs)(rn.B,{direction:"row",gap:1,alignItems:"center",children:["Your progress",(0,j.jsx)(Dd,{stepsDone:F,totalStepsToDo:_}),(0,j.jsx)(Pd,{stepsDone:F,totalStepsToDo:_})]})}const zh=F=>({wrapper:(0,Ye.css)({margin:F.spacing(2,0),padding:F.spacing(2),border:`1px solid ${F.colors.border.medium}`,borderRadius:F.shape.radius.default,display:"flex",flexDirection:"column",gap:F.spacing(2)})});var xc=(F=>(F[F.CONNECT_DATASOURCE=0]="CONNECT_DATASOURCE",F[F.ESSENTIALS=1]="ESSENTIALS",F))(xc||{});function Hh(){return{dataSourceCompatibleWithAlerting:!!(0,Ri.k5)()}}function kh(){const F=(0,Dt.of)(Gh),_=(0,yr.W6)(),Q=Hh(),ue=Nh(),Ce=yc({dataSourceConfigurationData:Q,essentialsConfigurationData:ue});(0,d.useEffect)(()=>{Vl(fl.ViewIRMMainPage,{essentialStepsDone:0,essentialStepsToDo:0,dataSourceCompatibleWithAlerting:Q.dataSourceCompatibleWithAlerting})},[Q.dataSourceCompatibleWithAlerting]);const[Oe,we]=(0,d.useState)(!1),ke=(dt,mt)=>{switch(Vl(fl.ClickDataSources,{essentialStepsDone:ue.stepsDone,essentialStepsToDo:ue.totalStepsToDo,dataSourceCompatibleWithAlerting:Q.dataSourceCompatibleWithAlerting}),dt){case 0:mt?_.push(Xi.I.List):_.push(Xi.I.New);break;case 1:we(!0),Vl(fl.OpenEssentials,{essentialStepsDone:ue.stepsDone,essentialStepsToDo:ue.totalStepsToDo,dataSourceCompatibleWithAlerting:Q.dataSourceCompatibleWithAlerting});break;default:return}};function Ze(){we(!1),Vl(fl.CloseEssentials,{essentialStepsDone:ue.stepsDone,essentialStepsToDo:ue.totalStepsToDo,dataSourceCompatibleWithAlerting:Q.dataSourceCompatibleWithAlerting})}return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(mr.E,{element:"h4",variant:"h4",children:"Configure"}),(0,j.jsxs)("section",{className:F.container,children:[Ce.map(dt=>(0,j.jsx)(Fh,{config:dt,handleActionClick:ke,isLoading:ue.isLoading},dt.id)),Oe&&(0,j.jsx)(vp,{onClose:Ze,essentialsConfig:ue.essentialContent,stepsDone:ue.stepsDone,totalStepsToDo:ue.totalStepsToDo})]}),(0,j.jsx)(mr.E,{element:"h4",variant:"h4",children:"IRM apps"})]})}const Gh=F=>({container:(0,Ye.css)({marginBottom:0,display:"grid",gap:F.spacing(3),gridTemplateColumns:" 1fr 1fr"})});var _l=e(66253);const Md=[{path:"/plugins",navId:"plugins",roles:ml([Fn.AccessControlAction.PluginsInstall,Fn.AccessControlAction.PluginsWrite],["Admin","ServerAdmin"]),routeName:_l.vk.Home,component:(0,Bs.A)(()=>e.e(4519).then(e.bind(e,65965)))},{path:"/plugins/browse",navId:"plugins",roles:ml([Fn.AccessControlAction.PluginsInstall,Fn.AccessControlAction.PluginsWrite],["Admin","ServerAdmin"]),routeName:_l.vk.Browse,component:(0,Bs.A)(()=>e.e(4519).then(e.bind(e,65965)))},{path:"/plugins/:pluginId/",navId:"plugins",roles:ml([Fn.AccessControlAction.PluginsInstall,Fn.AccessControlAction.PluginsWrite],["Admin","ServerAdmin"]),routeName:_l.vk.Details,component:(0,Bs.A)(()=>Promise.all([e.e(6359),e.e(3418),e.e(7891)]).then(e.bind(e,86400)))}];function ml(F,_){return()=>F.some(Q=>$a.TP.hasPermission(Q))?[]:_}function Qh(){return Md}var Yh=e(17422),zo=e(65307),Jh=e(13834),Ec=e(62625),Li=e(26272),Xh=e(39419),Lo=e(76888);function xp(F){return console.error(F),vl("Exception thrown","See console for details")}function Sd(){return vl("Page not found","404 Error")}function vl(F,_){const Q={text:F,subTitle:_,icon:"exclamation-triangle"};return{node:Q,main:Q}}var Od=e(94954),Dc=e(27716),Id=e(685),Pc=e(60677);const bc=(0,d.createContext)(yl());bc.displayName="PluginPageContext";function yl(){return{sectionNav:{main:{text:"Plugin page"},node:{text:"Plugin page"}}}}function Ad(F){return{sectionNav:F??yl().sectionNav}}const Rd={loading:!0,loadingError:!1,pluginNav:null,plugin:null};function Zh({pluginId:F,pluginNavSection:_}){const Q=(0,yr.W5)(),ue=(0,yr.zy)(),[Ce,Oe]=(0,d.useReducer)(xl.reducer,Rd),we=se.$.appSubUrl+ue.pathname+ue.search,{plugin:ke,loading:Ze,loadingError:dt,pluginNav:mt}=Ce,Ct=(0,Pc.Wy)(_,mt,we),Kt=(0,d.useMemo)(()=>(0,I.SE)(ue.search),[ue.search]),Bt=(0,d.useMemo)(()=>Ad(Ct),[Ct]),Mt=(0,Lo.Il)();(0,d.useEffect)(()=>{Ep(F,Oe)},[F]);const Wt=(0,d.useCallback)(bs=>Oe(xl.actions.changeNav(bs)),[]);if(!ke||F!==ke.meta.id){const bs=Mt.chrome.state.getValue().layout;return(0,j.jsxs)(kr.Y,{navModel:Ct,pageNav:{text:""},layout:bs,children:[Ze&&(0,j.jsx)(Xh.A,{}),!Ze&&dt&&(0,j.jsx)(ad.L,{entity:"App"})]})}if(!ke.root)return(0,j.jsx)(kr.Y,{navModel:Ct??vl("Plugin load error"),children:(0,j.jsx)("div",{children:"No root app page component found"})});const vn=ke.root&&(0,j.jsx)(Jh.a,{meta:ke.meta,children:(0,j.jsx)(ke.root,{meta:ke.meta,basename:Q.url,onNavChanged:Wt,query:Kt,path:ue.pathname})}),ns=()=>{if(!ke.meta?.includes)return!0;const bs=ke.meta?.includes.find(Nr=>Nr.path===ue.pathname);if(!bs)return!0;if(bs?.action&&se.$.featureToggles.accessControlOnCall)return $a.TP.hasPermission(bs.action);if($a.TP.isGrafanaAdmin||$a.TP.user.orgRole===Ec.X.Admin)return!0;const Hs=bs?.role||"";return!Hs||$a.TP.isEditor&&Hs===Ec.X.Viewer?!0:$a.TP.hasRole(Hs)},Ks=()=>(0,j.jsx)(In.F,{severity:"warning",title:"Access denied",children:"You do not have permission to see this page."});return ns()?mt?(0,j.jsx)(j.Fragment,{children:Ct?(0,j.jsx)(kr.Y,{navModel:Ct,pageNav:mt?.node,children:(0,j.jsx)(kr.Y.Contents,{isLoading:Ze,children:vn})}):(0,j.jsx)(kr.Y,{children:vn})}):(0,j.jsx)(bc.Provider,{value:Bt,children:vn}):(0,j.jsx)(Ks,{})}const xl=(0,zo.Z0)({name:"prom-builder-container",initialState:Rd,reducers:{setState:(F,_)=>{Object.assign(F,_.payload)},changeNav:(F,_)=>{let Q=_.payload;Q&&Q.node.children&&(Q={...Q,node:{...Q.main,hideFromBreadcrumbs:!0}}),F.pluginNav=Q}}});async function Ep(F,_){try{const Q=await(0,Dc.x)(F).then(ue=>{const Ce=Ld(ue);return Ce?($a.lE.emit(Li.r1.alertError,[Ce]),_(xl.actions.setState({pluginNav:vl(Ce)})),null):(0,Id.ui)(ue)});_(xl.actions.setState({plugin:Q,loading:!1,loadingError:!1,pluginNav:null}))}catch(Q){_(xl.actions.setState({plugin:null,loading:!1,loadingError:!0,pluginNav:Sd()}));const ue=Q instanceof Error?Q:new Error((0,Od.q)(Q));Pc.z4.logError(ue),console.error(ue)}}function Ld(F){return F?F.type!==ft.QE.app?"Plugin must be an app":F.enabled?null:"Application Not Enabled":"Unknown Plugin"}const jd=Zh;var tr=e(99140);function qh(){const F=(0,tr.Gu)(),{navIndex:_}=F,Q=Oe=>Oe.startsWith("standalone-plugin-page-/"),ue=Oe=>"pluginId"in Oe&&"id"in Oe;return[...Object.values(_).filter(ue).map(Oe=>{const we=(0,Yh.rH)(Oe),ke=`/a/${Oe.pluginId}`,Ze=Q(Oe.id)&&Oe.url||ke,dt=Q(Oe.id)&&!Oe.url?.startsWith("/a/");return{path:Ze,exact:!1,sensitive:dt,component:()=>(0,j.jsx)(jd,{pluginId:Oe.pluginId,pluginNavSection:we})}}),{path:"/a/:pluginId",exact:!1,component:({match:Oe})=>(0,j.jsx)(jd,{pluginId:Oe.params.pluginId,pluginNavSection:_.home})}]}const Zi=[{path:"/profile",component:(0,Bs.A)(()=>e.e(2472).then(e.bind(e,48357)))},{path:"/profile/password",component:(0,Bs.A)(()=>e.e(8107).then(e.bind(e,28107)))},{path:"/profile/select-org",component:(0,Bs.A)(()=>e.e(7430).then(e.bind(e,44613)))},{path:"/profile/notifications",component:(0,Bs.A)(()=>e.e(4140).then(e.bind(e,78015)))}];function zl(F=Y.config){return F.profileEnabled?Zi:(0,m.uniq)(Zi.map(Q=>Q.path)).map(Q=>({path:Q,component:(0,Bs.A)(()=>e.e(5173).then(e.bind(e,35208)))}))}const ef=()=>!Y.config.publicDashboardsEnabled||!Y.config.featureToggles.publicDashboards?[]:[{path:"/dashboard/public",pageClass:"page-dashboard",routeName:Fn.DashboardRoutes.Public,component:(0,Bs.A)(()=>e.e(5761).then(e.bind(e,53371)))},{path:"/public-dashboards/:accessToken",pageClass:"page-dashboard",routeName:Fn.DashboardRoutes.Public,chromeless:!0,component:(0,Bs.A)(()=>Promise.all([e.e(9569),e.e(6263),e.e(7197)]).then(e.bind(e,20302)))}],Bd=[];function tf(){return[...qh(),{path:"/",pageClass:"page-dashboard",routeName:Fn.DashboardRoutes.Home,component:(0,Bs.A)(()=>Promise.all([e.e(9569),e.e(660),e.e(6263),e.e(9136)]).then(e.bind(e,77709)))},{path:"/d/:uid/:slug?",pageClass:"page-dashboard",routeName:Fn.DashboardRoutes.Normal,component:(0,Bs.A)(()=>Promise.all([e.e(9569),e.e(660),e.e(6263),e.e(9136)]).then(e.bind(e,77709)))},{path:"/dashboard/new",roles:()=>or.TP.evaluatePermission([Fn.AccessControlAction.DashboardsCreate]),pageClass:"page-dashboard",routeName:Fn.DashboardRoutes.New,component:(0,Bs.A)(()=>Promise.all([e.e(9569),e.e(660),e.e(6263),e.e(9136),e.e(2976)]).then(e.bind(e,77709)))},{path:"/dashboard/new-with-ds/:datasourceUid",roles:()=>or.TP.evaluatePermission([Fn.AccessControlAction.DashboardsCreate]),component:(0,Bs.A)(()=>Promise.all([e.e(9569),e.e(660),e.e(6263),e.e(9136),e.e(2976)]).then(e.bind(e,30798)))},{path:"/dashboard/:type/:slug",pageClass:"page-dashboard",routeName:Fn.DashboardRoutes.Normal,component:(0,Bs.A)(()=>Promise.all([e.e(9569),e.e(660),e.e(6263),e.e(9136),e.e(2976)]).then(e.bind(e,77709)))},{path:"/dashboards/embedding-test",component:(0,Bs.A)(()=>Promise.all([e.e(9569),e.e(660),e.e(6263),e.e(9136),e.e(2976)]).then(e.bind(e,14962)))},{path:"/d-solo/:uid/:slug?",routeName:Fn.DashboardRoutes.Normal,chromeless:!0,component:(0,Bs.A)(()=>Y.Ay.featureToggles.dashboardSceneSolo?Promise.all([e.e(9569),e.e(7849)]).then(e.bind(e,24880)):Promise.all([e.e(9569),e.e(4492)]).then(e.bind(e,55087)))},{path:"/dashboard-solo/:type/:slug",routeName:Fn.DashboardRoutes.Normal,chromeless:!0,component:(0,Bs.A)(()=>Promise.all([e.e(9569),e.e(7849)]).then(e.bind(e,55087)))},{path:"/dashboard/import",component:(0,Bs.A)(()=>e.e(2550).then(e.bind(e,23390)))},{path:Xi.I.List,component:()=>(0,j.jsx)(yr.rd,{to:Ji.b.DataSources})},{path:Xi.I.Edit,component:F=>(0,j.jsx)(yr.rd,{to:Ji.b.DataSourcesEdit.replace(":uid",F.match.params.uid)})},{path:Xi.I.Dashboards,component:F=>(0,j.jsx)(yr.rd,{to:Ji.b.DataSourcesDashboards.replace(":uid",F.match.params.uid)})},{path:Xi.I.New,component:()=>(0,j.jsx)(yr.rd,{to:Ji.b.DataSourcesNew})},{path:"/datasources/correlations",component:(0,Bs.A)(()=>Y.Ay.featureToggles.correlations?e.e(9981).then(e.bind(e,32429)):e.e(8014).then(e.bind(e,55244)))},{path:"/dashboards",component:(0,Bs.A)(()=>Promise.all([e.e(6359),e.e(152)]).then(e.bind(e,2471)))},{path:"/dashboards/f/:uid/:slug",component:(0,Bs.A)(()=>Promise.all([e.e(6359),e.e(152)]).then(e.bind(e,2471)))},{path:"/dashboards/f/:uid",component:(0,Bs.A)(()=>Promise.all([e.e(6359),e.e(152)]).then(e.bind(e,2471)))},{path:"/explore",pageClass:"page-explore",roles:()=>or.TP.evaluatePermission([Fn.AccessControlAction.DataSourcesExplore]),component:(0,Bs.A)(()=>Y.Ay.exploreEnabled?Promise.all([e.e(660),e.e(1698),e.e(5511),e.e(9604)]).then(e.bind(e,47902)):e.e(4422).then(e.bind(e,53518)))},{path:"/apps",component:()=>(0,j.jsx)(Ao,{navId:"apps"})},{path:"/alerts-and-incidents",component:()=>(0,j.jsx)(Ao,{navId:"alerts-and-incidents",header:!(0,gc.y$)()&&(0,gc.qc)()||(0,gc.ES)()?(0,j.jsx)(kh,{}):void 0})},{path:"/testing-and-synthetics",component:()=>(0,j.jsx)(Ao,{navId:"testing-and-synthetics"})},{path:"/monitoring",component:()=>(0,j.jsx)(Ao,{navId:"monitoring"})},{path:"/infrastructure",component:()=>(0,j.jsx)(Ao,{navId:"infrastructure"})},{path:"/frontend",component:()=>(0,j.jsx)(Ao,{navId:"frontend"})},{path:"/admin/general",component:()=>(0,j.jsx)(Ao,{navId:"cfg/general"})},{path:"/admin/plugins",component:()=>(0,j.jsx)(Ao,{navId:"cfg/plugins"})},{path:"/admin/access",component:()=>(0,j.jsx)(Ao,{navId:"cfg/access"})},{path:"/org",component:(0,Bs.A)(()=>e.e(1510).then(e.bind(e,69047)))},{path:"/org/new",component:(0,Bs.A)(()=>e.e(7930).then(e.bind(e,25913)))},{path:"/org/users",component:(0,Bs.A)(()=>e.e(9856).then(e.bind(e,31083)))},{path:"/org/users/invite",component:(0,Bs.A)(()=>e.e(7720).then(e.bind(e,91230)))},{path:"/org/apikeys",roles:()=>or.TP.evaluatePermission([Fn.AccessControlAction.ActionAPIKeysRead]),component:(0,Bs.A)(()=>e.e(4196).then(e.bind(e,9699)))},{path:"/org/serviceaccounts",roles:()=>or.TP.evaluatePermission([Fn.AccessControlAction.ServiceAccountsRead,Fn.AccessControlAction.ServiceAccountsCreate]),component:(0,Bs.A)(()=>e.e(6777).then(e.bind(e,23645)))},{path:"/org/serviceaccounts/create",component:(0,Bs.A)(()=>e.e(4176).then(e.bind(e,63606)))},{path:"/org/serviceaccounts/:id",component:(0,Bs.A)(()=>e.e(6576).then(e.bind(e,82936)))},{path:"/org/teams",roles:()=>or.TP.evaluatePermission([Fn.AccessControlAction.ActionTeamsRead,Fn.AccessControlAction.ActionTeamsCreate]),component:(0,Bs.A)(()=>e.e(1036).then(e.bind(e,52576)))},{path:"/org/teams/new",roles:()=>or.TP.evaluatePermission([Fn.AccessControlAction.ActionTeamsCreate]),component:(0,Bs.A)(()=>e.e(5436).then(e.bind(e,80011)))},{path:"/org/teams/edit/:id/:page?",roles:()=>or.TP.evaluatePermission([Fn.AccessControlAction.ActionTeamsRead,Fn.AccessControlAction.ActionTeamsCreate]),component:(0,Bs.A)(()=>e.e(2212).then(e.bind(e,92886)))},{path:"/admin",component:()=>(0,j.jsx)(Ao,{navId:"cfg",header:(0,j.jsx)(vh,{})})},{path:"/admin/authentication",roles:()=>or.TP.evaluatePermission([Fn.AccessControlAction.SettingsWrite]),component:Y.Ay.licenseInfo.enabledFeatures?.saml||Y.Ay.ldapEnabled||Y.Ay.featureToggles.ssoSettingsApi?(0,Bs.A)(()=>e.e(5592).then(e.bind(e,51332))):()=>(0,j.jsx)(yr.rd,{to:"/admin"})},{path:"/admin/authentication/ldap",component:gh},{path:"/admin/authentication/:provider",roles:()=>or.TP.evaluatePermission([Fn.AccessControlAction.SettingsWrite]),component:Y.Ay.featureToggles.ssoSettingsApi?(0,Bs.A)(()=>e.e(5592).then(e.bind(e,22468))):()=>(0,j.jsx)(yr.rd,{to:"/admin"})},{path:"/admin/settings",component:(0,Bs.A)(()=>e.e(7659).then(e.bind(e,98493)))},{path:"/admin/upgrading",component:(0,Bs.A)(()=>e.e(5356).then(e.bind(e,55356)))},{path:"/admin/users",component:(0,Bs.A)(()=>e.e(1743).then(e.bind(e,20972)))},{path:"/admin/users/create",component:(0,Bs.A)(()=>e.e(9239).then(e.bind(e,64665)))},{path:"/admin/users/edit/:id",component:ih},{path:"/admin/orgs",component:(0,Bs.A)(()=>e.e(9736).then(e.bind(e,24870)))},{path:"/admin/orgs/edit/:id",component:(0,Bs.A)(()=>e.e(9119).then(e.bind(e,57582)))},{path:"/admin/featuretoggles",component:Y.Ay.featureToggles.featureToggleAdminPage?(0,Bs.A)(()=>e.e(7024).then(e.bind(e,47295))):()=>(0,j.jsx)(yr.rd,{to:"/admin"})},{path:"/admin/storage/:path*",roles:()=>["Admin"],component:(0,Bs.A)(()=>e.e(1927).then(e.bind(e,68932)))},{path:"/admin/stats",component:(0,Bs.A)(()=>e.e(9299).then(e.bind(e,51372)))},Y.Ay.featureToggles.onPremToCloudMigrations&&{path:"/admin/migrate-to-cloud",roles:()=>["Admin"],component:(0,Bs.A)(()=>e.e(3704).then(e.bind(e,19925)))},{path:"/login",component:Fu,pageClass:"login-page",chromeless:!0},{path:"/invite/:code",component:(0,Bs.A)(()=>e.e(8576).then(e.bind(e,14383))),chromeless:!0},{path:"/verify",component:Y.Ay.verifyEmailEnabled?(0,Bs.A)(()=>e.e(8786).then(e.bind(e,78786))):()=>(0,j.jsx)(yr.rd,{to:"/signup"}),pageClass:"login-page",chromeless:!0},{path:"/signup",component:Y.Ay.disableUserSignUp?()=>(0,j.jsx)(yr.rd,{to:"/login"}):(0,Bs.A)(()=>e.e(7914).then(e.bind(e,27914))),pageClass:"login-page",chromeless:!0},{path:"/user/password/send-reset-email",chromeless:!0,component:(0,Bs.A)(()=>e.e(3818).then(e.bind(e,2713)))},{path:"/user/password/reset",component:(0,Bs.A)(()=>e.e(641).then(e.bind(e,37344))),pageClass:"login-page",chromeless:!0},{path:"/dashboard/snapshots",component:(0,Bs.A)(()=>e.e(6590).then(e.bind(e,72602)))},Y.Ay.featureToggles.dashboardRestoreUI&&{path:"/dashboard/recently-deleted",roles:()=>["Admin"],component:(0,Bs.A)(()=>Promise.all([e.e(6359),e.e(6299)]).then(e.bind(e,10421)))},{path:"/playlists",component:(0,Bs.A)(()=>e.e(1168).then(e.bind(e,44450)))},{path:"/playlists/play/:uid",component:(0,Bs.A)(()=>e.e(1374).then(e.bind(e,93129)))},{path:"/playlists/new",component:(0,Bs.A)(()=>e.e(7616).then(e.bind(e,62579)))},{path:"/playlists/edit/:uid",component:(0,Bs.A)(()=>e.e(7620).then(e.bind(e,84535)))},{path:"/sandbox/benchmarks",component:(0,Bs.A)(()=>e.e(9354).then(e.bind(e,98351)))},{path:"/sandbox/test",component:(0,Bs.A)(()=>e.e(5354).then(e.bind(e,65802)))},{path:"/dashboards/f/:uid/:slug/library-panels",component:(0,Bs.A)(()=>e.e(5804).then(e.bind(e,15111)))},{path:"/dashboards/f/:uid/:slug/alerting",roles:()=>or.TP.evaluatePermission([Fn.AccessControlAction.AlertingRuleRead]),component:(0,Bs.A)(()=>e.e(4333).then(e.bind(e,30027)))},{path:"/library-panels",component:(0,Bs.A)(()=>e.e(8516).then(e.bind(e,45434)))},{path:"/notifications",component:(0,Bs.A)(()=>e.e(4140).then(e.bind(e,78015)))},Y.Ay.featureToggles.exploreMetrics&&{path:"/explore/metrics",chromeless:!1,exact:!1,roles:()=>or.TP.evaluatePermission([Fn.AccessControlAction.DataSourcesExplore]),component:(0,Bs.A)(()=>e.e(4785).then(e.bind(e,89858)))},{path:"/bookmarks",component:()=>(0,j.jsx)(Ao,{navId:"bookmarks"})},...Qh(),...nf(),...ph(),...zl(),...Bd,...ef(),...yh(),{path:"/*",component:_u}].filter(wr.zz)}function nf(F=Y.Ay){return F.supportBundlesEnabled?[{path:"/support-bundles",component:(0,Bs.A)(()=>e.e(123).then(e.bind(e,21821)))},{path:"/support-bundles/create",component:(0,Bs.A)(()=>e.e(1515).then(e.bind(e,33809)))}]:[]}const Ud=(0,d.forwardRef)((F,_)=>(0,j.jsx)("div",{id:"ngRoot",ref:_,dangerouslySetInnerHTML:{__html:"<grafana-app ng-cloak></grafana-app>"}}));Ud.displayName="AngularRoot";var mi=e(95344),sf=e(7376),af=e(81634),vi=e(74856),rf=e(71500),Nd=e(6923);async function of(){if(se.$.angularSupportEnabled){const{AngularApp:F}=await Promise.all([e.e(9362),e.e(7808),e.e(8888)]).then(e.bind(e,27808)),_=new F;_.init(),_.bootstrap()}else(0,sf.w)({load:(F,_,Q)=>({destroy:()=>{},digest:()=>{},getScope:()=>({})})}),(0,af.j)({get:F=>{switch(F){case"backendSrv":return(0,mi.l)("getLegacyAngularInjector","backendSrv","use getBackendSrv() in @grafana/runtime"),(0,M.AI)();case"contextSrv":return(0,mi.l)("getLegacyAngularInjector","contextSrv"),$a.TP;case"dashboardSrv":return(0,mi.l)("getLegacyAngularInjector","getDashboardSrv"),(0,h.UA)();case"datasourceSrv":return(0,mi.l)("getLegacyAngularInjector","datasourceSrv","use getDataSourceSrv() in @grafana/runtime"),(0,U.l)();case"linkSrv":return(0,mi.l)("getLegacyAngularInjector","linkSrv"),(0,Nd.mQ)();case"validationSrv":return(0,mi.l)("getLegacyAngularInjector","validationSrv"),rf.P;case"timeSrv":return(0,mi.l)("getLegacyAngularInjector","timeSrv"),(0,vi.jG)();case"templateSrv":return(0,mi.l)("getLegacyAngularInjector","templateSrv","use getTemplateSrv() in @grafana/runtime"),(0,Be.w)()}throw"Angular is disabled.  Unable to expose: "+F}})}var lf=e(46942),cf=e.n(lf),El=e(60619),yi=e(33390),Cc=e(18828),Tc=e(85690),wd=e(93225),Hl=e(57514),df=e(69529),Dl=e(65178),Wd=e(35822);const kl=0,uf=F=>{const _=d.useRef(null),Q=d.useRef(null),ue=d.useRef(F.items);ue.current=F.items;const Ce=(0,Wd.useVirtual)({size:ue.current.length,parentRef:Q}),{query:Oe,search:we,currentRootActionId:ke,activeIndex:Ze,options:dt}=(0,rr.useKBar)(Bt=>({search:Bt.searchQuery,currentRootActionId:Bt.currentRootActionId,activeIndex:Bt.activeIndex}));d.useEffect(()=>{const Bt=Mt=>{Mt.key==="ArrowUp"||Mt.ctrlKey&&Mt.key==="p"?(Mt.preventDefault(),Oe.setActiveIndex(Wt=>{let vn=Wt>kl?Wt-1:Wt;if(typeof ue.current[vn]=="string"){if(vn===0)return Wt;vn-=1}return vn})):Mt.key==="ArrowDown"||Mt.ctrlKey&&Mt.key==="n"?(Mt.preventDefault(),Oe.setActiveIndex(Wt=>{let vn=Wt<ue.current.length-1?Wt+1:Wt;if(typeof ue.current[vn]=="string"){if(vn===ue.current.length-1)return Wt;vn+=1}return vn})):Mt.key==="Enter"&&(Mt.preventDefault(),_.current?.click())};return window.addEventListener("keydown",Bt),()=>window.removeEventListener("keydown",Bt)},[Oe]);const{scrollToIndex:mt}=Ce;d.useEffect(()=>{mt(Ze,{align:Ze<=1?"end":"auto"})},[Ze,mt]),d.useEffect(()=>{Oe.setActiveIndex(typeof F.items[kl]=="string"?kl+1:kl)},[we,ke,F.items,Oe]);const Ct=d.useCallback((Bt,Mt)=>{if(typeof Mt=="string")return;const Wt=Mt.url;Mt.command?(Mt.command.perform(Mt),Oe.toggle()):Wt?Bt.ctrlKey||Bt.metaKey||Bt.shiftKey||Oe.toggle():(Oe.setSearch(""),Oe.setCurrentRootAction(Mt.id)),dt.callbacks?.onSelectAction?.(Mt)},[Oe,dt]),Kt=(0,Dl.usePointerMovedSinceMount)();return(0,j.jsx)("div",{ref:Q,style:{maxHeight:F.maxHeight||400,position:"relative",overflow:"auto"},children:(0,j.jsx)("div",{role:"listbox",id:rr.KBAR_LISTBOX,style:{height:`${Ce.totalSize}px`,width:"100%"},children:Ce.virtualItems.map(Bt=>{const Mt=ue.current[Bt.index],{target:Wt,url:vn}=Mt,ns=typeof Mt!="string"&&{onPointerMove:()=>Kt&&Ze!==Bt.index&&Oe.setActiveIndex(Bt.index),onPointerDown:()=>Oe.setActiveIndex(Bt.index),onClick:Nr=>Ct(Nr,Mt)},Ks=Bt.index===Ze,bs={id:(0,rr.getListboxItemId)(Bt.index),role:"option","aria-selected":Ks,style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${Bt.start}px)`},...ns},Hs=d.cloneElement(F.onRender({item:Mt,active:Ks}),{ref:Bt.measureRef});return vn?(0,j.jsx)("a",{href:typeof vn=="function"?vn(we):vn,target:Wt,ref:Ks?_:null,...bs,children:Hs},Bt.index):(0,j.jsx)("div",{ref:Ks?_:null,...bs,children:Hs},Bt.index)})})})},Fd=d.forwardRef(({action:F,active:_,currentRootActionId:Q},ue)=>{const Ce=d.useMemo(()=>{if(!Q)return F.ancestors;const Ze=F.ancestors.findIndex(dt=>dt.id===Q);return F.ancestors.slice(Ze+1)},[F.ancestors,Q]),Oe=(0,Dt.of)(hf);let we=F.name;const ke=Ze=>!!(Ze.command?.perform||Ze.url);return F.children.length&&!ke(F)&&!we.endsWith("...")&&(we+="..."),(0,j.jsx)("div",{ref:ue,className:(0,Ye.cx)(Oe.row,_&&Oe.activeRow),children:(0,j.jsxs)("div",{className:Oe.actionContainer,children:[F.icon,(0,j.jsxs)("div",{className:Oe.textContainer,children:[Ce.map(Ze=>(0,j.jsx)(d.Fragment,{children:!ke(Ze)&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("span",{className:Oe.breadcrumbAncestor,children:Ze.name}),(0,j.jsx)("span",{className:Oe.breadcrumbSeparator,children:"\u203A"})]})},Ze.id)),(0,j.jsx)("span",{children:we})]}),F.subtitle&&(0,j.jsx)("span",{className:Oe.subtitleText,children:F.subtitle})]})})});Fd.displayName="ResultItem";const hf=F=>({row:(0,Ye.css)({padding:F.spacing(1,2),display:"flex",alightItems:"center",justifyContent:"space-between",cursor:"pointer",position:"relative",borderRadius:F.shape.radius.default,margin:F.spacing(0,1)}),activeRow:(0,Ye.css)({color:F.colors.text.maxContrast,background:F.colors.emphasize(F.colors.background.primary,.03),"&:before":{display:"block",content:'" "',position:"absolute",left:0,top:0,bottom:0,width:F.spacing(.5),borderRadius:F.shape.radius.default,backgroundImage:F.colors.gradients.brandVertical}}),actionContainer:(0,Ye.css)({display:"flex",gap:F.spacing(1),alignItems:"baseline",fontSize:F.typography.fontSize,width:"100%"}),textContainer:(0,Ye.css)({display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),breadcrumbAncestor:(0,Ye.css)({color:F.colors.text.secondary}),breadcrumbSeparator:(0,Ye.css)({color:F.colors.text.secondary,marginLeft:F.spacing(1),marginRight:F.spacing(1)}),subtitleText:(0,Ye.css)({...F.typography.bodySmall,color:F.colors.text.secondary,display:"block",flexBasis:"20%",flexGrow:1,flexShrink:0,maxWidth:"fit-content",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"})});var ff=e(76459),Qr=e.n(ff),Kd=e(62301),gf=e(24439);const Pl=6,$d=5,pf=4,Gl=3,mf=2,vf=1,yf=100,Vd=5,xf=Qr()(Df,200);async function Ef(){if(!or.TP.user.isSignedIn)return[];const F=(await Kd.A.getDashboardOpened()).slice(0,Vd),Q=(await(0,gf.getGrafanaSearcher)().search({kind:["dashboard"],limit:Vd,uid:F})).view.toArray();return Q.sort((Ce,Oe)=>{const we=F.indexOf(Ce.uid),ke=F.indexOf(Oe.uid);return we-ke}),Q.map(Ce=>{const{url:Oe,name:we}=Ce;return{id:`recent-dashboards${Oe}`,name:`${we}`,section:(0,ya.t)("command-palette.section.recent-dashboards","Recent dashboards"),priority:Pl,url:Oe}})}async function Df(F){if(F.length===0||!or.TP.user.isSignedIn&&!se.$.bootData.settings.anonymousEnabled)return[];const _=await(0,gf.getGrafanaSearcher)().search({kind:["dashboard","folder"],query:F,limit:yf});return _.view.map(ue=>{const{url:Ce,name:Oe,kind:we,location:ke}=ue;return{id:`go/${we}${Ce}`,name:`${Oe}`,section:we==="dashboard"?(0,ya.t)("command-palette.section.dashboard-search-results","Dashboards"):(0,ya.t)("command-palette.section.folder-search-results","Folders"),priority:vf,url:Ce,subtitle:_.view.dataFrame.meta?.custom?.locationInfo[ke]?.name}})}function Pf(F,_){const[Q,ue]=(0,d.useState)([]),[Ce,Oe]=(0,d.useState)(!1),we=(0,d.useRef)(0);return(0,d.useEffect)(()=>{const ke=Date.now();_&&F.length>0?(Oe(!0),xf(F).then(Ze=>{ke>we.current&&(ue(Ze),Oe(!1),we.current=ke)})):(ue([]),Oe(!1),we.current=ke)},[_,F]),{searchResults:Q,isFetchingSearchResults:Ce}}var Ql=e(28215),Yr=e(28444),Cr=e(28138),bf=e(38645),Yl=e(93522);const _d=F=>{let _=F.children||[];if(F.id==="help"){const Q=()=>{Cr.A.publish(new Yr.S8({component:Yl.N}))};F.children=[..._,...(0,bf.Dd)(),...Cf(),{id:"keyboard-shortcuts",text:(0,ya.t)("nav.help/keyboard-shortcuts","Keyboard shortcuts"),icon:"keyboard",onClick:Q}]}return F},Mc=(F,_)=>{const Q={...F},ue=Q.onClick;return Q.onClick=()=>{(0,xr.rR)("grafana_navigation_item_clicked",{path:Q.url??Q.id,menuIsDocked:_,itemIsBookmarked:!!(se.$.featureToggles.pinNavItems&&Q?.parentItem?.id==="bookmarks")}),ue?.()},Q.children&&(Q.children=Q.children.map(Ce=>Mc(Ce,_))),Q},zd=(F,_)=>!!F.children?.some(Q=>Q===_?!0:zd(Q,_)),Sc=(F,_,Q)=>{const{id:ue,parentItem:Ce}=_;if(Q==="/")return F.find(Oe=>Oe.id===Ql.Id);if(_.id!=="profile"){for(const Oe of F){const we=!!(Oe.id&&Oe.id===ue),ke=Oe.text===_.text&&Oe.url===_.url;if(we||ke)return Oe;if(Oe.children){const Ze=Sc(Oe.children,_);if(Ze)return Ze}}if(Ce)return Sc(F,Ce)}};function Cf(){const{buildInfo:F,licenseInfo:_}=se.$,Q=_.stateInfo?` (${_.stateInfo})`:"",ue=[];return ue.push({target:"_blank",id:"version",text:`${F.edition}${Q}`,url:_.licenseUrl,icon:"external-link-alt"}),F.hasUpdate&&ue.push({target:"_blank",id:"updateVersion",text:"New version available!",icon:"download-alt",url:"https://grafana.com/grafana/download?utm_source=grafana_footer"}),ue}var Jl=e(2769);function Hd(F){return"navModel."+F.id}function kd(F,_=[]){const Q=[];for(let ue of F){ue.id==="help"&&(ue=_d({...ue}),delete ue.url);const{url:Ce,target:Oe,text:we,isCreateAction:ke,children:Ze,onClick:dt,keywords:mt}=ue,Ct=!!Ze?.length;if(!(Ce||dt||Ct))continue;let Kt=Ce;Ce&&(ue.id==="connections-add-new-connection"||ue.id==="standalone-plugin-page-/connections/add-new-connection")&&(Kt=ns=>{const Ks=mt?.find(bs=>bs.toLowerCase().includes(ns.toLowerCase()));return Ks?`${Ce}?search=${Ks}`:Ce});const Bt=ke?(0,ya.t)("command-palette.section.actions","Actions"):(0,ya.t)("command-palette.section.pages","Pages"),Mt=ke?$d:pf,Wt=_.map(ns=>ns.text).join(" > "),vn={id:Hd(ue),name:we,section:Bt,url:Kt,target:Oe,parent:_.length>0&&!ke?Hd(_[_.length-1]):void 0,perform:dt,keywords:mt?.join(" "),priority:Mt,subtitle:ke?void 0:Wt};if(Q.push(vn),Ze?.length){const ns=kd(Ze,[..._,ue]);Q.push(...ns)}}return Q}const Tf=(F,_)=>{const Q=[{id:"preferences/theme",name:(0,ya.t)("command-palette.action.change-theme","Change theme..."),keywords:"interface color dark light",section:(0,ya.t)("command-palette.section.preferences","Preferences"),priority:Gl},{id:"preferences/dark-theme",name:(0,ya.t)("command-palette.action.dark-theme","Dark"),keywords:"dark theme",perform:()=>(0,Jl.K)("dark"),parent:"preferences/theme",priority:Gl},{id:"preferences/light-theme",name:(0,ya.t)("command-palette.action.light-theme","Light"),keywords:"light theme",perform:()=>(0,Jl.K)("light"),parent:"preferences/theme",priority:Gl}],ue=kd(F);return[...Q,..._,...ue]};var ji=e(74135);const Mf={};function Sf(){const{extensions:F}=(0,w.vl)({extensionPointId:ji.S.CommandPalette,context:Mf,limitPerPlugin:3});return(0,d.useMemo)(()=>F.map(_=>({section:_.category??"Extensions",priority:mf,id:_.id,name:_.title,target:_.path,perform:()=>_.onClick&&_.onClick()})),[F])}function Oc(F){const[_,Q]=(0,d.useState)([]),[ue,Ce]=(0,d.useState)([]),Oe=Sf(),we=(0,Fn.useSelector)(ke=>ke.navBarTree);return(0,d.useEffect)(()=>{const ke=Tf(we,Oe);Q(ke)},[we,Oe]),(0,d.useEffect)(()=>{F||Ef().then(ke=>Ce(ke)).catch(ke=>{console.error("Error loading recent dashboard actions",ke)})},[F]),F?_:[...ue,..._]}var Gd=e(53076);const Qd={name:"none",priority:rr.Priority.NORMAL};function bl(F,_){return _.priority-F.priority}function Of(){const{search:F,actions:_,rootActionId:Q}=(0,rr.useKBar)(mt=>({search:mt.searchQuery,actions:mt.actions,rootActionId:mt.currentRootActionId})),ue=d.useMemo(()=>Object.keys(_).reduce((mt,Ct)=>{const Kt=_[Ct];if(!Kt.parent&&!Q&&mt.push(Kt),Kt.id===Q)for(let Bt=0;Bt<Kt.children.length;Bt++)mt.push(Kt.children[Bt]);return mt},[]).sort(bl),[_,Q]),Ce=d.useCallback(mt=>{let Ct=[];for(let Kt=0;Kt<mt.length;Kt++)Ct.push(mt[Kt]);return function Kt(Bt,Mt=Ct){for(let Wt=0;Wt<Bt.length;Wt++)if(Bt[Wt].children.length>0){let vn=Bt[Wt].children;for(let ns=0;ns<vn.length;ns++)Mt.push(vn[ns]);Kt(Bt[Wt].children,Mt)}return Mt}(mt)},[]),Oe=!F,we=d.useMemo(()=>Oe?ue:Ce(ue),[Ce,ue,Oe]),ke=If(we,F),Ze=d.useMemo(()=>{let mt={},Ct=[],Kt=[];for(let Mt=0;Mt<ke.length;Mt++){const Wt=ke[Mt],vn=Wt.action,ns=Wt.score||rr.Priority.NORMAL,Ks={name:typeof vn.section=="string"?vn.section:vn.section?.name||Qd.name,priority:typeof vn.section=="string"?ns:vn.section?.priority||0+ns};mt[Ks.name]||(mt[Ks.name]=[],Ct.push(Ks)),mt[Ks.name].push({priority:vn.priority+ns,action:vn})}Kt=Ct.sort(bl).map(Mt=>({name:Mt.name,actions:mt[Mt.name].sort(bl).map(Wt=>Wt.action)}));let Bt=[];for(let Mt=0;Mt<Kt.length;Mt++){let Wt=Kt[Mt];Wt.name!==Qd.name&&Bt.push(Wt.name);for(let vn=0;vn<Wt.actions.length;vn++)Bt.push(Wt.actions[vn])}return Bt},[ke]),dt=d.useMemo(()=>Q,[Ze]);return d.useMemo(()=>({results:Ze,rootActionId:dt}),[dt,Ze])}function If(F,_){const Q=Af(),ue=d.useMemo(()=>({filtered:F,search:_}),[F,_]),{filtered:Ce,search:Oe}=(0,Dl.useThrottledValue)(ue);return d.useMemo(()=>{if(Oe.trim()==="")return Ce.map(Ze=>({score:0,action:Ze}));const we=Ce.map(({name:Ze,keywords:dt})=>`${Ze} ${dt??""}`.toLowerCase()),ke=[];if(Oe.length>Yd){const Ze=Oe.toLowerCase();for(let dt=0;dt<we.length;dt++){const Ct=we[dt].indexOf(Ze);if(Ct>-1){const Kt=Ct*-1,Bt=Ce[dt];ke.push({score:Kt,action:Bt})}}}else{const Ze=Q.split(Oe).length,dt=1/0,mt=Ze<5?4:0,[,Ct,Kt]=Q.search(we,Oe,mt,dt);if(Ct&&Kt)for(let Bt=0;Bt<Kt.length;Bt++){const Mt=Kt[Bt],Wt=Kt.length-Bt,vn=Ce[Ct.idx[Mt]];ke.push({score:Wt,action:vn})}}return ke},[Ce,Oe,Q])}const Yd=25;function Af(){const F=d.useRef();return F.current||(F.current=new Gd.A({intraMode:0,intraIns:0})),F.current}function Rf(){const F=(0,Dt.of)(Jd),{query:_,showing:Q,searchQuery:ue}=(0,rr.useKBar)(mt=>({showing:mt.visualState===rr.VisualState.showing,searchQuery:mt.searchQuery})),Ce=Oc(ue);(0,rr.useRegisterActions)(Ce,[Ce]);const{searchResults:Oe,isFetchingSearchResults:we}=Pf(ue,Q),ke=(0,d.useRef)(null),{overlayProps:Ze}=(0,wd.e)({isOpen:Q,onClose:()=>_.setVisualState(rr.VisualState.animatingOut)},ke),{dialogProps:dt}=(0,Cc.s)({},ke);return(0,d.useEffect)(()=>{Q&&(0,xr.rR)("command_palette_opened")},[Q]),Ce.length>0?(0,j.jsx)(rr.KBarPortal,{children:(0,j.jsx)(rr.KBarPositioner,{className:F.positioner,children:(0,j.jsx)(rr.KBarAnimator,{className:F.animator,children:(0,j.jsx)(Tc.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,j.jsxs)("div",{...Ze,...dt,children:[(0,j.jsxs)("div",{className:F.searchContainer,children:[(0,j.jsx)(Ys.I,{name:"search",size:"md"}),(0,j.jsx)(rr.KBarSearch,{defaultPlaceholder:(0,ya.t)("command-palette.search-box.placeholder","Search or jump to..."),className:F.search}),(0,j.jsx)("div",{className:F.loadingBarContainer,children:we&&(0,j.jsx)(Hl.G,{width:500,delay:0})})]}),(0,j.jsx)("div",{className:F.resultsContainer,children:(0,j.jsx)(Lf,{isFetchingSearchResults:we,searchResults:Oe})})]})})})})}):null}const Lf=({isFetchingSearchResults:F,searchResults:_})=>{const{results:Q,rootActionId:ue}=Of(),Ce=(0,Dt.of)(Jd),Oe=(0,ya.t)("command-palette.section.dashboard-search-results","Dashboards"),we=(0,ya.t)("command-palette.section.folder-search-results","Folders"),ke=(0,d.useMemo)(()=>_.filter(Ct=>Ct.id.startsWith("go/dashboard")).map(Ct=>new rr.ActionImpl(Ct,{store:{}})),[_]),Ze=(0,d.useMemo)(()=>_.filter(Ct=>Ct.id.startsWith("go/folder")).map(Ct=>new rr.ActionImpl(Ct,{store:{}})),[_]),dt=(0,d.useMemo)(()=>{const Ct=[...Q];return Ze.length>0&&(Ct.push(we),Ct.push(...Ze)),ke.length>0&&(Ct.push(Oe),Ct.push(...ke)),Ct},[Q,Oe,ke,we,Ze]);return!F&&dt.length===0?(0,j.jsx)(df.p,{variant:"not-found",role:"alert",message:(0,ya.t)("command-palette.empty-state.message","No results found")}):(0,j.jsx)(uf,{items:dt,maxHeight:650,onRender:({item:Ct,active:Kt})=>{const Bt=dt[0]===Ct;return typeof Ct=="string"?(0,j.jsx)("div",{className:(0,Ye.cx)(Ce.sectionHeader,Bt&&Ce.sectionHeaderFirst),children:Ct}):(0,j.jsx)(Fd,{action:Ct,active:Kt,currentRootActionId:ue})}})},Jd=F=>({positioner:(0,Ye.css)({zIndex:F.zIndex.portal,marginTop:"0px",paddingTop:"4px !important","&::before":{content:'""',position:"fixed",top:0,right:0,bottom:0,left:0,background:F.components.overlay.background,backdropFilter:"blur(1px)"}}),animator:(0,Ye.css)({maxWidth:F.breakpoints.values.md,width:"100%",background:F.colors.background.primary,color:F.colors.text.primary,borderRadius:F.shape.radius.default,border:`1px solid ${F.colors.border.weak}`,overflow:"hidden",boxShadow:F.shadows.z3}),loadingBarContainer:(0,Ye.css)({position:"absolute",left:0,right:0,bottom:0}),searchContainer:(0,Ye.css)({alignItems:"center",background:F.components.input.background,borderBottom:`1px solid ${F.colors.border.weak}`,display:"flex",gap:F.spacing(1),padding:F.spacing(1,2),position:"relative"}),search:(0,Ye.css)({fontSize:F.typography.fontSize,width:"100%",boxSizing:"border-box",outline:"none",border:"none",color:F.components.input.text}),spinner:(0,Ye.css)({height:"22px"}),resultsContainer:(0,Ye.css)({paddingBottom:F.spacing(1)}),sectionHeader:(0,Ye.css)({padding:F.spacing(1.5,2,2,2),fontSize:F.typography.bodySmall.fontSize,fontWeight:F.typography.fontWeightMedium,color:F.colors.text.secondary,borderTop:`1px solid ${F.colors.border.weak}`,marginTop:F.spacing(1)}),sectionHeaderFirst:(0,Ye.css)({paddingBottom:F.spacing(1),borderTop:"none",marginTop:0})});var jf=e(59875),Ic=e(86634),Bf=e(40276),Xd=e(91219),Uf=e(75816),Nf=e(75505);function wf({baseURL:F}){async function _(Q){try{const{data:ue,...Ce}=await(0,Nf.s)((0,M.AI)().fetch({...Q,url:F+Q.url,showErrorAlert:Q.showErrorAlert,data:Q.body}));return{data:ue,meta:Ce}}catch(ue){return Q.manageError?Q.manageError(ue):{error:ue}}}return _}const Ac=(0,Uf.xP)({reducerPath:"userPreferencesAPI",baseQuery:wf({baseURL:"/api"}),endpoints:()=>({})}).injectEndpoints({endpoints:F=>({getUserPreferences:F.query({query:()=>({url:"/user/preferences"})}),patchUserPreferences:F.mutation({query:_=>({url:"/user/preferences",method:"PATCH",body:_.patchPrefsCmd})}),updateUserPreferences:F.mutation({query:_=>({url:"/user/preferences",method:"PUT",body:_.updatePrefsCmd})})}),overrideExisting:!1}),{useGetUserPreferencesQuery:Pp,usePatchUserPreferencesMutation:bp,useUpdateUserPreferencesMutation:Cp}=Ac,{useGetUserPreferencesQuery:Wf,usePatchUserPreferencesMutation:Ff,useUpdateUserPreferencesMutation:Wm}=Ac,Zd=Ac.enhanceEndpoints({addTagTypes:["UserPreferences"],endpoints:{getUserPreferences:{providesTags:["UserPreferences"]},updateUserPreferences:{invalidatesTags:["UserPreferences"]},patchUserPreferences:{invalidatesTags:["UserPreferences"]}}});var Tp=e(78685),Mp=e(8887),Sp=e(18759);const Op=({children:F})=>{const _=(0,Dt.of)(Ip);return(0,j.jsxs)(j.Fragment,{children:[F,(0,j.jsx)("span",{className:_.highlight})]})},Ip=F=>({highlight:(0,Ye.css)({backgroundColor:F.colors.success.main,borderRadius:F.shape.radius.circle,width:"6px",height:"6px",display:"inline-block;",position:"absolute",top:"50%",transform:"translateY(-50%)"})});var Ap=e(50720);function Kf({children:F,isActive:_,onClick:Q,target:ue,url:Ce,id:Oe,onPin:we,isPinned:ke}){const Ze=(0,Dt.$j)(),dt=Rp(Ze,_),mt=!ue&&Ce.startsWith("/")?Ap.N:"a",Ct=(0,j.jsxs)("div",{className:dt.linkContent,children:[F,ue==="_blank"&&(0,j.jsx)(Ys.I,{"data-testid":"external-link-icon",name:"external-link-alt"}),se.$.featureToggles.pinNavItems&&(0,j.jsx)(Ys.I,{name:"bookmark",type:ke?"solid":"default",className:"pin-icon",onClick:Kt=>{Kt.preventDefault(),Kt.stopPropagation(),we(Oe)}})]});return(0,j.jsx)(mt,{"data-testid":sr.Tp.components.NavMenu.item,className:(0,Ye.cx)(dt.container,{[dt.containerActive]:_}),href:Ce,target:ue,onClick:Q,..._&&{"aria-current":"page"},children:Ct})}Kf.displayName="MegaMenuItemText";const Rp=(F,_)=>({container:(0,Ye.css)({alignItems:"center",color:_?F.colors.text.primary:F.colors.text.secondary,height:"100%",position:"relative",width:"100%","&:hover, &:focus-visible":{color:F.colors.text.primary,textDecoration:"underline"},"&:focus-visible":{boxShadow:"none",outline:`2px solid ${F.colors.primary.main}`,outlineOffset:"-2px",transition:"none"}}),containerActive:(0,Ye.css)({backgroundColor:F.colors.background.secondary,borderTopRightRadius:F.shape.radius.default,borderBottomRightRadius:F.shape.radius.default,position:"relative","&::before":{backgroundImage:F.colors.gradients.brandVertical,borderRadius:F.shape.radius.default,content:'" "',display:"block",height:"100%",position:"absolute",transform:"translateX(-50%)",width:F.spacing(.5)}}),linkContent:(0,Ye.css)({alignItems:"center",display:"flex",gap:"0.5rem",height:"100%",width:"100%",justifyContent:"space-between",".pin-icon":{display:"none",padding:F.spacing(.5),width:F.spacing(3),height:F.spacing(3)},"&:hover":{".pin-icon":{display:"block"}}})}),Rc=2;function $f({link:F,activeItem:_,level:Q=0,onClick:ue,onPin:Ce,isPinned:Oe}){const{chrome:we}=(0,Lo.Il)(),Ze=we.useState().megaMenuDocked,dt=(0,yr.zy)(),mt=F.highlightText?Op:d.Fragment,Ct=zd(F,_),Kt=F===_||Q===Rc&&Ct,[Bt,Mt]=(0,Tp.A)(`grafana.navigation.expanded[${F.text}]`,!!Ct),Wt=Q<Rc&&!!(Vf(F)||F.emptyMessage),vn=(0,d.useRef)(null),ns=(0,Dt.of)(Lp);if((0,d.useEffect)(()=>{Ct&&Mt(!0)},[Ct,dt,Ze,Mt]),(0,d.useEffect)(()=>{Kt&&vn.current&&jp(vn.current)&&vn.current.scrollIntoView({block:"center"})},[Kt]),!F.url)return null;let Ks=null;return F.icon?Ks=(0,j.jsx)(Ys.I,{className:ns.icon,name:(0,Mp.Uo)(F.icon)??"link",size:"lg"}):F.img&&(Ks=(0,j.jsx)(rn.B,{width:3,justifyContent:"center",children:(0,j.jsx)("img",{className:ns.img,src:F.img,alt:""})})),(0,j.jsxs)("li",{ref:vn,className:ns.listItem,children:[(0,j.jsxs)("div",{className:(0,Ye.cx)(ns.menuItem,{[ns.menuItemWithIcon]:!!(Q===0&&Ks)}),children:[Q!==0&&(0,j.jsx)(Sp.T,{level:Q===Rc?Q-1:Q,spacing:3}),Q===Rc&&(0,j.jsx)("div",{className:ns.itemConnector}),(0,j.jsx)("div",{className:ns.collapseButtonWrapper,children:Wt&&(0,j.jsx)(ja.K,{"aria-label":`${Bt?"Collapse":"Expand"} section ${F.text}`,className:ns.collapseButton,onClick:()=>Mt(!Bt),name:Bt?"angle-down":"angle-right",size:"md",variant:"secondary"})}),(0,j.jsx)("div",{className:ns.collapsibleSectionWrapper,children:(0,j.jsx)(Kf,{isActive:Kt,onClick:()=>{F.onClick?.(),ue?.()},target:F.target,url:F.url,id:F.id,onPin:()=>Ce(F),isPinned:Oe(F.id),children:(0,j.jsxs)("div",{className:(0,Ye.cx)(ns.labelWrapper,{[ns.hasActiveChild]:Ct,[ns.labelWrapperWithIcon]:!!(Q===0&&Ks)}),children:[Q===0&&Ks&&(0,j.jsx)(mt,{children:Ks}),(0,j.jsx)(mr.E,{truncate:!0,children:F.text})]})})})]}),Wt&&Bt&&(0,j.jsx)("ul",{className:ns.children,children:Vf(F)?F.children.filter(bs=>!bs.isCreateAction).map(bs=>(0,j.jsx)($f,{link:bs,activeItem:_,onClick:ue,level:Q+1,onPin:Ce,isPinned:Oe},`${F.text}-${bs.text}`)):(0,j.jsx)("div",{className:ns.emptyMessage,"aria-live":"polite",children:F.emptyMessage})})]})}const Lp=F=>({icon:(0,Ye.css)({width:F.spacing(3)}),img:(0,Ye.css)({height:F.spacing(2),width:F.spacing(2)}),listItem:(0,Ye.css)({flex:1,maxWidth:"100%"}),menuItem:(0,Ye.css)({display:"flex",alignItems:"center",gap:F.spacing(1),height:F.spacing(4),paddingLeft:F.spacing(.5),position:"relative"}),menuItemWithIcon:(0,Ye.css)({paddingLeft:F.spacing(0)}),collapseButtonWrapper:(0,Ye.css)({display:"flex",justifyContent:"center",width:F.spacing(3),flexShrink:0}),itemConnector:(0,Ye.css)({position:"relative",height:"100%",width:F.spacing(1.5),"&::before":{borderLeft:`1px solid ${F.colors.border.medium}`,content:'""',height:"100%",right:0,position:"absolute",transform:"translateX(50%)"}}),collapseButton:(0,Ye.css)({margin:0}),collapsibleSectionWrapper:(0,Ye.css)({alignItems:"center",display:"flex",flex:1,height:"100%",minWidth:0}),labelWrapper:(0,Ye.css)({display:"flex",alignItems:"center",gap:F.spacing(2),minWidth:0,paddingLeft:F.spacing(1)}),labelWrapperWithIcon:(0,Ye.css)({paddingLeft:F.spacing(.5)}),hasActiveChild:(0,Ye.css)({color:F.colors.text.primary}),children:(0,Ye.css)({display:"flex",listStyleType:"none",flexDirection:"column"}),emptyMessage:(0,Ye.css)({color:F.colors.text.secondary,fontStyle:"italic",padding:F.spacing(1,1.5,1,7)})});function Vf(F){return!!(F.children&&F.children.length>0)}function jp(F){const _=F.getBoundingClientRect();return _.bottom<0||_.top>=window.innerHeight}const Bp=()=>{const F=Wf(),_=(0,d.useMemo)(()=>F.data?.navbar?.bookmarkIds||[],[F]);return se.$.featureToggles.pinNavItems?_:[]},_f="300px",qd=(0,d.memo)((0,d.forwardRef)(({onClose:F,..._},Q)=>{const ue=(0,Fn.useSelector)(vn=>vn.navBarTree),Ce=(0,Dt.of)(Up),Oe=(0,yr.zy)(),{chrome:we}=(0,Lo.Il)(),ke=(0,Fn.useDispatch)(),Ze=we.useState(),[dt]=Ff(),mt=Bp(),Ct=ue.filter(vn=>vn.id!=="profile"&&vn.id!=="help").map(vn=>Mc(vn,Ze.megaMenuDocked)),Kt=Sc(Ct,Ze.sectionNav.node,Oe.pathname),Bt=()=>{we.setMegaMenuDocked(!Ze.megaMenuDocked),Ze.megaMenuDocked&&we.setMegaMenuOpen(!1),setTimeout(()=>{document.getElementById(Ze.megaMenuDocked?"mega-menu-toggle":"dock-menu-button")?.focus()})},Mt=(0,d.useCallback)(vn=>!vn||!mt?.length?!1:mt?.includes(vn),[mt]),Wt=vn=>{const ns=vn.id;if(ns&&se.$.featureToggles.pinNavItems){const Ks=ue.find(no=>no.id===ns),bs=Mt(ns),Hs=bs?mt.filter(no=>ns!==no):[...mt,ns],Nr=bs?"grafana_nav_item_unpinned":"grafana_nav_item_pinned";(0,xr.rR)(Nr,{path:Ks?.url??ns}),dt({patchPrefsCmd:{navbar:{bookmarkIds:Hs}}}).then(no=>{no.error||ke((0,Xd.ve)({item:vn,isSaved:!bs}))})}};return(0,j.jsxs)("div",{"data-testid":sr.Tp.components.NavMenu.Menu,ref:Q,..._,children:[(0,j.jsxs)("div",{className:Ce.mobileHeader,children:[(0,j.jsx)(Ys.I,{name:"bars",size:"xl"}),(0,j.jsx)(ja.K,{tooltip:(0,ya.t)("navigation.megamenu.close","Close menu"),name:"times",onClick:F,size:"xl",variant:"secondary"})]}),(0,j.jsx)("nav",{className:Ce.content,children:(0,j.jsx)(Bf.E,{showScrollIndicators:!0,hideHorizontalTrack:!0,children:(0,j.jsx)("ul",{className:Ce.itemList,"aria-label":(0,ya.t)("navigation.megamenu.list-label","Navigation"),children:Ct.map((vn,ns)=>(0,j.jsxs)(rn.B,{direction:ns===0?"row-reverse":"row",alignItems:"center",children:[ns===0&&(0,j.jsx)(ja.K,{id:"dock-menu-button",className:Ce.dockMenuButton,tooltip:Ze.megaMenuDocked?(0,ya.t)("navigation.megamenu.undock","Undock menu"):(0,ya.t)("navigation.megamenu.dock","Dock menu"),name:"web-section-alt",onClick:Bt,variant:"secondary"}),(0,j.jsx)($f,{link:vn,isPinned:Mt,onClick:Ze.megaMenuDocked?void 0:F,activeItem:Kt,onPin:Wt})]},vn.text))})})})]})}));qd.displayName="MegaMenu";const Up=F=>({content:(0,Ye.css)({display:"flex",flexDirection:"column",height:"100%",minHeight:0,position:"relative"}),mobileHeader:(0,Ye.css)({display:"flex",justifyContent:"space-between",padding:F.spacing(1,1,1,2),borderBottom:`1px solid ${F.colors.border.weak}`,[F.breakpoints.up("md")]:{display:"none"}}),itemList:(0,Ye.css)({boxSizing:"border-box",display:"flex",flexDirection:"column",listStyleType:"none",padding:F.spacing(1,1,2,1),[F.breakpoints.up("md")]:{width:_f}}),dockMenuButton:(0,Ye.css)({display:"none",[F.breakpoints.up("xl")]:{display:"inline-flex"}})});var Lc=e(13390),Bi=e(27746);function Cl({href:F,isCurrent:_,text:Q,index:ue,flexGrow:Ce}){const Oe=(0,Dt.of)(Xl),we=()=>{(0,xr.rR)("grafana_breadcrumb_clicked",{url:F})};return(0,j.jsx)("li",{className:Oe.breadcrumbWrapper,style:{flexGrow:Ce},children:_?(0,j.jsx)("span",{"data-testid":Lc.X.Breadcrumbs.breadcrumb(Q),className:Oe.breadcrumb,"aria-current":"page",title:Q,children:Q}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("a",{onClick:we,"data-testid":Lc.X.Breadcrumbs.breadcrumb(Q),className:(0,Ye.cx)(Oe.breadcrumb,Oe.breadcrumbLink),title:Q,href:F,children:Q}),(0,j.jsx)("div",{className:Oe.separator,"aria-hidden":!0,children:(0,j.jsx)(Ys.I,{name:"angle-right"})})]})})}const Xl=F=>({breadcrumb:(0,Ye.css)({display:"block",textOverflow:"ellipsis",overflow:"hidden",padding:F.spacing(0,.5),whiteSpace:"nowrap",color:F.colors.text.secondary}),breadcrumbLink:(0,Ye.css)({color:F.colors.text.primary,"&:hover":{textDecoration:"underline"}}),breadcrumbWrapper:(0,Ye.css)({alignItems:"center",color:F.colors.text.primary,display:"flex",flex:1,minWidth:0,maxWidth:"max-content",[F.breakpoints.down("sm")]:{display:"none","&:nth-last-child(2)":{display:"flex",minWidth:"40px"},"&:last-child":{display:"flex"}}}),separator:(0,Ye.css)({color:F.colors.text.secondary})});function zf({breadcrumbs:F,className:_}){const Q=(0,Dt.of)(kf);return(0,j.jsx)("nav",{"aria-label":"Breadcrumbs",className:_,children:(0,j.jsx)("ol",{className:Q.breadcrumbs,children:F.map((ue,Ce)=>(0,d.createElement)(Cl,{...ue,isCurrent:Ce===F.length-1,key:Ce,index:Ce,flexGrow:Hf(Ce,F.length)}))})})}function Hf(F,_){return _<5&&F>0&&F<_-2||_>6&&F>1&&F<_-3?4:10}const kf=F=>({breadcrumbs:(0,Ye.css)({display:"flex",alignItems:"center",flexWrap:"nowrap",overflow:"hidden"})});var Gf=e(3984),Ho=e(57571),eu=e(10804);const tu="mega-menu-toggle";function Qf({actions:F,searchBarHidden:_,sectionNav:Q,pageNav:ue,onToggleMegaMenu:Ce,onToggleSearchBar:Oe,onToggleKioskMode:we}){const{chrome:ke}=(0,Lo.Il)(),Ze=ke.useState(),dt=(0,Fn.useSelector)(Kt=>Kt.navIndex)[Ql.Id],mt=(0,Dt.of)(Yf),Ct=(0,Gf.Z)(Q,ue,dt);return(0,j.jsxs)("div",{"data-testid":Lc.X.NavToolbar.container,className:mt.pageToolbar,children:[(0,j.jsx)("div",{className:mt.menuButton,children:(0,j.jsx)(ja.K,{id:tu,name:"bars",tooltip:Ze.megaMenuOpen?(0,ya.t)("navigation.toolbar.close-menu","Close menu"):(0,ya.t)("navigation.toolbar.open-menu","Open menu"),tooltipPlacement:"bottom",size:"xl",onClick:Ce,"data-testid":Lc.X.NavBar.Toggle.button})}),(0,j.jsx)(zf,{breadcrumbs:Ct,className:mt.breadcrumbsWrapper}),(0,j.jsxs)("div",{className:mt.actions,children:[F,_&&(0,j.jsx)(Bi.I,{onClick:we,narrow:!0,title:(0,ya.t)("navigation.toolbar.enable-kiosk","Enable kiosk mode"),icon:"monitor"}),F&&(0,j.jsx)(eu.K,{}),(0,j.jsx)(Bi.I,{onClick:Oe,narrow:!0,title:(0,ya.t)("navigation.toolbar.toggle-search-bar","Toggle top search bar"),children:(0,j.jsx)(Ys.I,{name:_?"angle-down":"angle-up",size:"xl"})})]})]})}const Yf=F=>({breadcrumbsWrapper:(0,Ye.css)({display:"flex",overflow:"hidden",[F.breakpoints.down("sm")]:{minWidth:"50%"}}),pageToolbar:(0,Ye.css)({height:Ho.l,display:"flex",padding:F.spacing(0,1,0,2),alignItems:"center",borderBottom:`1px solid ${F.colors.border.weak}`}),menuButton:(0,Ye.css)({display:"flex",alignItems:"center",marginRight:F.spacing(1)}),actions:(0,Ye.css)({label:"NavToolbar-actions",display:"flex",alignItems:"center",flexWrap:"nowrap",justifyContent:"flex-end",paddingLeft:F.spacing(1),flexGrow:1,gap:F.spacing(1),minWidth:0,".body-drawer-open &":{display:"none"}})});function nu({}){const F=(0,Dt.$j)(),{chrome:_}=(0,Lo.Il)(),Q=_.useState(),ue=Q.searchBarHidden||Q.kioskMode===Fn.KioskMode.TV,Ce=(0,d.useRef)(null),Oe=(0,d.useRef)(null),we=F.transitions.duration.shortest,ke=(0,Dt.of)(Xf,we),Ze=Q.megaMenuOpen&&!Q.megaMenuDocked,dt=()=>_.setMegaMenuOpen(!1),{overlayProps:mt,underlayProps:Ct}=(0,wd.e)({isDismissable:!0,isOpen:!0,onClose:dt,shouldCloseOnInteractOutside:Mt=>!document.getElementById(tu)?.contains(Mt)},Ce),{dialogProps:Kt}=(0,Cc.s)({},Ce),Bt=(0,Dt.of)(Jf,ue);return(0,j.jsx)("div",{className:Bt.wrapper,children:(0,j.jsxs)(jf.Sf,{children:[(0,j.jsx)(Ic.A,{nodeRef:Ce,in:Ze,unmountOnExit:!0,classNames:ke.overlay,timeout:{enter:we,exit:0},children:(0,j.jsx)(Tc.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,j.jsx)(qd,{className:Bt.menu,onClose:dt,ref:Ce,...mt,...Kt})})}),(0,j.jsx)(Ic.A,{nodeRef:Oe,in:Ze,unmountOnExit:!0,classNames:ke.backdrop,timeout:{enter:we,exit:0},children:(0,j.jsx)("div",{ref:Oe,className:Bt.backdrop,...Ct})})]})})}const Jf=(F,_)=>{const Q=_?Ho.l:Ho.l*2;return{backdrop:(0,Ye.css)({backdropFilter:"blur(1px)",backgroundColor:F.components.overlay.background,bottom:0,left:0,position:"fixed",right:0,top:_?0:Ho.l,zIndex:F.zIndex.modalBackdrop,[F.breakpoints.up("md")]:{top:Q}}),menu:(0,Ye.css)({display:"flex",bottom:0,flexDirection:"column",left:0,right:0,zIndex:F.zIndex.modal,position:"fixed",top:_?0:Ho.l,backgroundColor:F.colors.background.primary,boxSizing:"content-box",flex:"1 1 0",[F.breakpoints.up("md")]:{right:"unset",borderRight:`1px solid ${F.colors.border.weak}`,top:Q}}),wrapper:(0,Ye.css)({position:"fixed",display:"grid",gridAutoFlow:"column",height:"100%",zIndex:F.zIndex.sidemenu})}},Xf=(F,_)=>{const Q={[F.transitions.handleMotion("no-preference")]:{transitionDuration:`${_}ms`,transitionTimingFunction:F.transitions.easing.easeInOut},[F.breakpoints.down("md")]:{overflow:"hidden"}},ue={...Q,transitionProperty:"box-shadow, width",".scrollbar-view":{overflow:"hidden !important"}},Ce={...Q,transitionProperty:"opacity"},Oe={width:"100%",[F.breakpoints.up("md")]:{boxShadow:F.shadows.z3,width:_f}},we={boxShadow:"none",width:0},ke={opacity:1},Ze={opacity:0};return{backdrop:{enter:(0,Ye.css)(Ze),enterActive:(0,Ye.css)(Ce,ke),enterDone:(0,Ye.css)(ke)},overlay:{enter:(0,Ye.css)(we),enterActive:(0,Ye.css)(ue,Oe),enterDone:(0,Ye.css)(Oe)}}};var jc=e(24120),Zf=e(49426);function qf(F,_){if(F===_)return!0;if(!(F instanceof Object)||!(_ instanceof Object))return!1;const Q=Object.keys(F),ue=Q.length;for(let Ce=0;Ce<ue;Ce++)if(!(Q[Ce]in _))return!1;for(let Ce=0;Ce<ue;Ce++)if(F[Q[Ce]]!==_[Q[Ce]])return!1;return ue===Object.keys(_).length}const Bc="grafana.navigation.docked",Uc="grafana.navigation.open";class eg{constructor(){this.searchBarStorageKey="SearchBar_Hidden",this.routeChangeHandled=!0,this.megaMenuDocked=!!(window.innerWidth>=se.$.theme2.breakpoints.values.xl&&yi.A.getBool(Bc,window.innerWidth>=se.$.theme2.breakpoints.values.xxl)),this.sessionStorageData=window.sessionStorage.getItem("returnToPrevious"),this.returnToPreviousData=this.sessionStorageData?JSON.parse(this.sessionStorageData):void 0,this.state=new Zf.t({chromeless:!0,sectionNav:{node:{text:(0,ya.t)("nav.home.title","Home")},main:{text:""}},searchBarHidden:yi.A.getBool(this.searchBarStorageKey,!1),megaMenuOpen:this.megaMenuDocked&&yi.A.getBool(Uc,!0),megaMenuDocked:this.megaMenuDocked,kioskMode:null,layout:Wl.k.Canvas,returnToPrevious:this.returnToPreviousData}),this.setReturnToPrevious=_=>{const Q=this.state.getValue().returnToPrevious;(0,xr.rR)("grafana_return_to_previous_button_created",{page:_.href,previousPage:Q?.href}),this.update({returnToPrevious:_}),window.sessionStorage.setItem("returnToPrevious",JSON.stringify(_))},this.clearReturnToPrevious=_=>{const Q=this.state.getValue().returnToPrevious;Q&&(0,xr.rR)("grafana_return_to_previous_button_dismissed",{action:_,page:Q.href}),this.update({returnToPrevious:void 0}),window.sessionStorage.removeItem("returnToPrevious")},this.setMegaMenuOpen=_=>{const{megaMenuDocked:Q}=this.state.getValue();Q&&yi.A.set(Uc,_),(0,xr.rR)("grafana_mega_menu_open",{state:_}),this.update({megaMenuOpen:_})},this.setMegaMenuDocked=(_,Q=!0)=>{Q&&yi.A.set(Bc,_),(0,xr.rR)("grafana_mega_menu_docked",{state:_}),this.update({megaMenuDocked:_})},this.onToggleSearchBar=()=>{const{searchBarHidden:_,kioskMode:Q}=this.state.getValue(),ue=!_;yi.A.set(this.searchBarStorageKey,ue),Q&&I.Ny.partial({kiosk:null}),this.update({searchBarHidden:ue,kioskMode:null})},this.onToggleKioskMode=()=>{const _=this.getNextKioskMode();this.update({kioskMode:_}),I.Ny.partial({kiosk:this.getKioskUrlValue(_)})}}setMatchedRoute(_){this.currentRoute!==_&&(this.currentRoute=_,this.routeChangeHandled=!1)}update(_){const Q=this.state.getValue(),ue={...Q};this.routeChangeHandled||(ue.actions=void 0,ue.pageNav=void 0,ue.sectionNav={node:{text:(0,ya.t)("nav.home.title","Home")},main:{text:""}},ue.chromeless=this.currentRoute?.chromeless,ue.layout=Wl.k.Standard,this.routeChangeHandled=!0),Object.assign(ue,_),ue.chromeless=ue.kioskMode===Fn.KioskMode.Full||this.currentRoute?.chromeless,this.ignoreStateUpdate(ue,Q)||this.state.next(ue)}ignoreStateUpdate(_,Q){return!!(qf(_,Q)||(_.sectionNav!==Q.sectionNav||_.pageNav!==Q.pageNav)&&_.actions===Q.actions&&_.layout===Q.layout&&Nc(_.sectionNav.node,Q.sectionNav.node)&&Nc(_.pageNav,Q.pageNav))}useState(){return(0,jc.A)(this.state,this.state.getValue())}exitKioskMode(){this.update({kioskMode:void 0}),I.Ny.partial({kiosk:null})}setKioskModeFromUrl(_){let Q;switch(_){case"tv":Q=Fn.KioskMode.TV;break;case"1":case!0:Q=Fn.KioskMode.Full}Q&&Q!==this.state.getValue().kioskMode&&this.update({kioskMode:Q})}getKioskUrlValue(_){switch(_){case Fn.KioskMode.TV:return"tv";case Fn.KioskMode.Full:return!0;default:return null}}getNextKioskMode(){const{kioskMode:_,searchBarHidden:Q}=this.state.getValue();return Q||_===Fn.KioskMode.TV?(Cr.A.emit(Li.r1.alertInfo,[(0,ya.t)("navigation.kiosk.tv-alert","Press ESC to exit kiosk mode")]),Fn.KioskMode.Full):_?null:Fn.KioskMode.TV}}function Nc(F,_){if(F===_)return!0;const Q=F?.children?.find(Ce=>Ce.active),ue=_?.children?.find(Ce=>Ce.active);return F?.text===_?.text&&F?.url===_?.url&&Q?.url===ue?.url&&Nc(F?.parentItem,_?.parentItem)}var tg=e(19727);const wc=({label:F,onClick:_,onDismiss:Q})=>{const ue=(0,Dt.of)(Np);return(0,j.jsxs)(tg.e,{className:ue.buttonGroup,children:[(0,j.jsx)(me.$n,{icon:"angle-left",size:"sm",variant:"primary",fill:"outline",onClick:_,title:F,className:ue.mainDismissableButton,"data-testid":sr.Tp.components.ReturnToPrevious.backButton,children:F}),(0,j.jsx)(me.$n,{icon:"times","aria-label":(0,ya.t)("return-to-previous.dismissable-button","Close"),variant:"primary",fill:"outline",size:"sm",onClick:Q,"data-testid":sr.Tp.components.ReturnToPrevious.dismissButton})]})},Np=F=>({mainDismissableButton:(0,Ye.css)({width:"100%","> span":{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"270px",display:"inline-block"}}),buttonGroup:(0,Ye.css)({width:"fit-content",backgroundColor:F.colors.background.secondary})});wc.displayName="DismissableButton";const ng=({href:F,title:_})=>{const Q=(0,Dt.of)(wp),{chrome:ue}=(0,Lo.Il)(),Ce=(0,d.useCallback)(()=>{I.Ny.push(F),ue.clearReturnToPrevious("clicked")},[F,ue]),Oe=(0,d.useCallback)(()=>{ue.clearReturnToPrevious("dismissed")},[ue]);return(0,j.jsx)("div",{className:Q.returnToPrevious,"data-testid":sr.Tp.components.ReturnToPrevious.buttonGroup,children:(0,j.jsx)(wc,{label:(0,ya.t)("return-to-previous.button.label","Back to {{title}}",{title:_}),onClick:Ce,onDismiss:Oe})})},wp=F=>({returnToPrevious:(0,Ye.css)({label:"return-to-previous",display:"flex",justifyContent:"center",left:"50%",transform:"translateX(-50%)",zIndex:F.zIndex.tooltip,position:"fixed",bottom:F.spacing.x4,boxShadow:F.shadows.z3})});ng.displayName="ReturnToPrevious";var su=e(80997),Wp=e(42941),Fp=e(62372),Kp=e(49185),Tl=e(69386),$p=e(4172);function sg({feedUrl:F}){const _=(0,Dt.of)(ag),{state:Q,getNews:ue}=(0,$p.n)(F),[Ce,Oe]=(0,Kp.A)();return(0,d.useEffect)(()=>{ue()},[ue]),Q.error?(0,j.jsx)("div",{className:_.innerWrapper,children:Q.error&&Q.error.message}):(0,j.jsxs)("div",{ref:Ce,children:[Q.loading?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(Tl.K.Skeleton,{showImage:!0,width:Oe.width}),(0,j.jsx)(Tl.K.Skeleton,{showImage:!0,width:Oe.width}),(0,j.jsx)(Tl.K.Skeleton,{showImage:!0,width:Oe.width}),(0,j.jsx)(Tl.K.Skeleton,{showImage:!0,width:Oe.width}),(0,j.jsx)(Tl.K.Skeleton,{showImage:!0,width:Oe.width})]}):(0,j.jsx)(j.Fragment,{children:Oe.width>0&&Q.value?.map((we,ke)=>(0,j.jsx)(Tl.K,{index:ke,showImage:!0,width:Oe.width,data:Q.value},ke))}),(0,j.jsx)("div",{className:_.grot,children:(0,j.jsx)("a",{href:"https://grafana.com/blog/",target:"_blank",rel:"noreferrer",title:"Go to Grafana labs blog",children:(0,j.jsx)("img",{src:"public/img/grot-news.svg",alt:"Grot reading news"})})})]})}const ag=F=>({innerWrapper:(0,Ye.css)({width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}),grot:(0,Ye.css)({display:"flex",alignItems:"center",justifyContent:"center",padding:F.spacing(5,0),img:{width:"186px",height:"186px"}})});function rg({className:F}){const[_,Q]=(0,Wp.A)(!1),ue=(0,Dt.of)(og);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(Bi.I,{className:F,onClick:Q,iconOnly:!0,icon:"rss","aria-label":"News"}),_&&(0,j.jsx)(_o._,{title:(0,j.jsxs)("div",{className:ue.title,children:[(0,j.jsx)(mr.E,{element:"h2",children:(0,ya.t)("news.title","Latest from the blog")}),(0,j.jsx)("a",{href:"https://grafana.com/blog/",target:"_blank",rel:"noreferrer",title:"Go to Grafana labs blog",className:ue.grot,children:(0,j.jsx)("img",{src:"public/img/grot-news.svg",alt:"Grot reading news"})}),(0,j.jsx)("div",{className:ue.actions,children:(0,j.jsx)(ja.K,{name:"times",variant:"secondary",onClick:Q,"data-testid":sr.Tp.components.Drawer.General.close,tooltip:(0,ya.t)("news.drawer.close","Close Drawer")})})]}),onClose:Q,size:"md",children:(0,j.jsx)(sg,{feedUrl:Fp.$})})]})}const og=F=>({title:(0,Ye.css)({display:"flex",alignItems:"center",justifyContent:"center",gap:F.spacing(2),borderBottom:`1px solid ${F.colors.border.weak}`}),grot:(0,Ye.css)({display:"flex",alignItems:"center",justifyContent:"center",padding:F.spacing(2,0),img:{width:"75px",height:"75px"}}),actions:(0,Ye.css)({position:"absolute",right:F.spacing(1),top:F.spacing(2)})});var au=e(32931);function ru({orgs:F,onSelectChange:_}){const Q=(0,Dt.of)(ig);return(0,j.jsx)(po.i,{"aria-label":"Change organization",variant:"secondary",buttonCss:Q.buttonCss,size:"md",label:"",fill:"text",isFullWidth:!1,options:F.map(ue=>({label:ue.name,description:ue.role,value:ue})),onChange:_,icon:"building"})}const ig=F=>({buttonCss:(0,Ye.css)({color:F.colors.text.secondary,"&:hover":{color:F.colors.text.primary}})});function lg({orgs:F,onSelectChange:_}){const Q=(0,Dt.of)(cg),{orgName:ue,orgId:Ce,orgRole:Oe}=or.TP.user,[we,ke]=(0,d.useState)(()=>({label:ue,value:{role:Oe,orgId:Ce,name:ue},description:Oe})),Ze=dt=>{ke(dt),_(dt)};return(0,j.jsx)(Te.l6,{"aria-label":"Change organization",width:"auto",value:we,prefix:(0,j.jsx)(Ys.I,{className:"prefix-icon",name:"building"}),className:Q.select,options:F.map(dt=>({label:dt.name,description:dt.role,value:dt})),onChange:Ze})}const cg=F=>({select:(0,Ye.css)({border:"none",background:"none",color:F.colors.text.secondary,"&:hover":{color:F.colors.text.primary,"& .prefix-icon":(0,Ye.css)({color:F.colors.text.primary})}})});function Ml(){const F=(0,Dt.$j)(),_=(0,Fn.useDispatch)(),Q=(0,Fn.useSelector)(Ze=>Ze.organization.userOrgs),ue=Ze=>{Ze.value&&((0,au.bA)(Ze.value.orgId),I.Ny.push(`/?orgId=${Ze.value.orgId}`),window.location.reload())};(0,d.useEffect)(()=>{or.TP.isSignedIn&&_((0,au.wV)())},[_]);const Ce=F.breakpoints.values.sm,[Oe,we]=(0,d.useState)(!window.matchMedia(`(min-width: ${Ce}px)`).matches);if((0,El.Y)({breakpoint:Ce,onChange:Ze=>{we(!Ze.matches)}}),Q?.length<=1)return null;const ke=Oe?ru:lg;return(0,j.jsx)(ke,{orgs:Q,onSelectChange:ue})}function ou(F){const _=[];for(const Q of F)Q.isCreateAction&&_.push(Q),Q.children&&_.push(...ou(Q.children));return _}const dg=({})=>{const F=(0,Dt.of)(Sl),_=(0,Dt.$j)(),Q=(0,Fn.useSelector)(mt=>mt.navBarTree),ue=_.breakpoints.values.sm,[Ce,Oe]=(0,d.useState)(!1),[we,ke]=(0,d.useState)(!window.matchMedia(`(min-width: ${ue}px)`).matches),Ze=(0,d.useMemo)(()=>ou(Q),[Q]);(0,El.Y)({breakpoint:ue,onChange:mt=>{ke(!mt.matches)}});const dt=()=>(0,j.jsx)(Po.W,{children:Ze.map((mt,Ct)=>(0,j.jsx)(Po.W.Item,{url:mt.url,label:mt.text,onClick:()=>(0,xr.rR)("grafana_menu_item_clicked",{url:mt.url,from:"quickadd"})},Ct))});return Ze.length>0?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(eo.m,{overlay:dt,placement:"bottom-end",onVisibleChange:Oe,children:(0,j.jsx)(Bi.I,{iconOnly:!0,icon:we?"plus-circle":"plus",isOpen:we?void 0:Ce,"aria-label":"New"})}),(0,j.jsx)(eu.K,{className:F.separator})]}):null},Sl=F=>({buttonContent:(0,Ye.css)({alignItems:"center",display:"flex"}),buttonText:(0,Ye.css)({[F.breakpoints.down("md")]:{display:"none"}}),separator:(0,Ye.css)({[F.breakpoints.down("sm")]:{display:"none"}})});function Wc(){const F=(0,yr.zy)(),_=(0,Dt.of)(xi);let Q=su.sQ.sanitizeUrl(C.I.getUrlForPartial(F,{forceLogin:"true"}));return Q.startsWith("//")&&(Q=Q.replace(/\/+/g,"/")),(0,j.jsx)("a",{className:_.link,href:Q,target:"_self",children:"Sign in"})}const xi=F=>({link:(0,Ye.css)({paddingRight:F.spacing(1),whiteSpace:"nowrap","&:hover":{textDecoration:"underline"}})});var iu=e(64539);function lu({node:F}){const _=(0,Dt.of)(ug),Q=Mc((0,m.cloneDeep)(F),!1);return Q?(0,j.jsx)(Po.W,{header:(0,j.jsxs)("div",{onClick:ue=>ue.stopPropagation(),className:_.header,children:[(0,j.jsx)("div",{children:Q.text}),Q.subTitle&&(0,j.jsx)("div",{className:_.subTitle,children:Q.subTitle})]}),children:Q.children?.map(ue=>ue.url?(0,j.jsx)(iu.D,{url:ue.url,label:ue.text,icon:ue.icon,target:ue.target},ue.id):(0,j.jsx)(iu.D,{icon:ue.icon,onClick:ue.onClick,label:ue.text},ue.id))}):null}const ug=F=>({header:(0,Ye.css)({fontSize:F.typography.h5.fontSize,fontWeight:F.typography.h5.fontWeight,padding:F.spacing(.5,1),whiteSpace:"nowrap"}),subTitle:(0,Ye.css)({color:F.colors.text.secondary,fontSize:F.typography.bodySmall.fontSize})});var hg=e(16797),fg=e(63917);function gg(){const F=(0,Dt.$j)(),{query:_}=(0,rr.useKBar)(we=>({kbarSearchQuery:we.searchQuery,kbarIsOpen:we.visualState===rr.VisualState.showing})),Q=F.breakpoints.values.sm,[ue,Ce]=(0,d.useState)(!window.matchMedia(`(min-width: ${Q}px)`).matches);(0,El.Y)({breakpoint:Q,onChange:we=>{Ce(!we.matches)}});const Oe=()=>{_.toggle()};return ue?(0,j.jsx)(Bi.I,{iconOnly:!0,icon:"search","aria-label":(0,ya.t)("nav.search.placeholderCommandPalette","Search or jump to..."),onClick:Oe}):(0,j.jsx)(cu,{onClick:Oe})}function cu({onClick:F}){const _=(0,Dt.of)(Ol),Q=(0,d.useMemo)(()=>(0,fg.gn)(),[]);return(0,j.jsx)("div",{className:_.wrapper,children:(0,j.jsxs)("div",{className:_.inputWrapper,children:[(0,j.jsx)("div",{className:_.prefix,children:(0,j.jsx)(Ys.I,{name:"search"})}),(0,j.jsx)("button",{className:_.fakeInput,onClick:F,children:(0,ya.t)("nav.search.placeholderCommandPalette","Search or jump to...")}),(0,j.jsxs)("div",{className:_.suffix,children:[(0,j.jsx)(Ys.I,{name:"keyboard"}),(0,j.jsxs)(mr.E,{variant:"bodySmall",children:[Q,"+k"]})]})]})})}const Ol=F=>{const _=(0,Ne.n)({theme:F});return{wrapper:_.wrapper,inputWrapper:_.inputWrapper,prefix:_.prefix,suffix:(0,Ye.css)([_.suffix,{display:"flex",gap:F.spacing(.5)}]),fakeInput:(0,Ye.css)([_.input,{textAlign:"left",paddingLeft:28,color:F.colors.text.disabled,"&:focus":{outline:"unset",boxShadow:"unset"},"&:focus-visible":(0,Ye.css)`
          ${(0,hg.focusCss)(F)}
        `}]),button:(0,Ye.css)({width:"100%",textAlign:"center","> *":{width:"100%",textAlign:"center",justifyContent:"center",gap:"1ch"}})}};function Fc({children:F,align:_="left"}){const Q=(0,Dt.of)(pg),Ce=(0,Dt.$j)().breakpoints.values.sm,[Oe,we]=(0,d.useState)(!window.matchMedia(`(min-width: ${Ce}px)`).matches);return(0,El.Y)({breakpoint:Ce,onChange:ke=>{we(!ke.matches)}}),Oe?(0,j.jsx)(j.Fragment,{children:F}):(0,j.jsx)("div",{"data-testid":"wrapper",className:(0,Ye.cx)(Q.wrapper,{[Q[_]]:_==="right"}),children:F})}const pg=F=>({wrapper:(0,Ye.css)({display:"flex",gap:F.spacing(.5),alignItems:"center"}),right:(0,Ye.css)({justifyContent:"flex-end"}),left:(0,Ye.css)({}),center:(0,Ye.css)({})}),mg=(0,d.memo)(function(){const _=(0,Dt.of)(du),Q=(0,Fn.useSelector)(Ze=>Ze.navIndex),ue=(0,yr.zy)(),Ce=(0,m.cloneDeep)(Q.help),Oe=Ce?_d(Ce):void 0,we=Q.profile;let ke=Y.config.appSubUrl||"/";return!Y.config.bootData.user.isSignedIn&&!Y.config.anonymousEnabled&&(ke=su.sQ.sanitizeUrl(C.I.getUrlForPartial(ue,{forceLogin:"true"}))),(0,j.jsxs)("div",{className:_.layout,children:[(0,j.jsxs)(Fc,{children:[(0,j.jsx)("a",{className:_.logo,href:ke,title:"Go to home",children:(0,j.jsx)(Do.M.MenuLogo,{className:_.img})}),(0,j.jsx)(Ml,{})]}),(0,j.jsx)(Fc,{children:(0,j.jsx)(gg,{})}),(0,j.jsxs)(Fc,{align:"right",children:[(0,j.jsx)(dg,{}),Oe&&(0,j.jsx)(eo.m,{overlay:()=>(0,j.jsx)(lu,{node:Oe}),placement:"bottom-end",children:(0,j.jsx)(Bi.I,{iconOnly:!0,icon:"question-circle","aria-label":"Help"})}),Y.config.newsFeedEnabled&&(0,j.jsx)(rg,{}),!$a.TP.user.isSignedIn&&(0,j.jsx)(Wc,{}),we&&(0,j.jsx)(eo.m,{overlay:()=>(0,j.jsx)(lu,{node:we}),placement:"bottom-end",children:(0,j.jsx)(Bi.I,{className:_.profileButton,imgSrc:$a.TP.user.gravatarUrl,imgAlt:"User avatar","aria-label":"Profile"})})]})]})}),du=F=>({layout:(0,Ye.css)({height:Ho.l,display:"flex",gap:F.spacing(1),alignItems:"center",padding:F.spacing(0,1,0,2),borderBottom:`1px solid ${F.colors.border.weak}`,justifyContent:"space-between",[F.breakpoints.up("sm")]:{gridTemplateColumns:"1.5fr minmax(240px, 1fr) 1.5fr",display:"grid",justifyContent:"flex-start"}}),img:(0,Ye.css)({height:F.spacing(3),width:F.spacing(3)}),logo:(0,Ye.css)({display:"flex"}),profileButton:(0,Ye.css)({padding:F.spacing(0,.25),img:{borderRadius:F.shape.radius.circle,height:"24px",marginRight:0,width:"24px"}})});function vg({children:F}){const{chrome:_}=(0,Lo.Il)(),Q=_.useState(),ue=Q.searchBarHidden||Q.kioskMode===Fn.KioskMode.TV,Ce=(0,Dt.$j)(),Oe=(0,Dt.of)(yg,ue),we=Ce.breakpoints.values.xl,ke=yi.A.getBool(Bc,!0),Ze=!Q.chromeless&&Q.megaMenuDocked&&Q.megaMenuOpen;(0,El.Y)({breakpoint:we,onChange:Wt=>{ke&&(_.setMegaMenuDocked(Wt.matches,!1),_.setMegaMenuOpen(Wt.matches?yi.A.getBool(Uc,Q.megaMenuOpen):!1))}});const dt=(0,Ye.cx)({[Oe.content]:!0,[Oe.contentNoSearchBar]:ue,[Oe.contentChromeless]:Q.chromeless}),mt=()=>{_.setMegaMenuOpen(!Q.megaMenuOpen)},{pathname:Ct,search:Kt}=I.Ny.getLocation(),Bt=Ct+Kt,Mt=Q.returnToPrevious&&Bt!==Q.returnToPrevious.href;return(0,d.useEffect)(()=>{Q.returnToPrevious&&Bt===Q.returnToPrevious.href&&_.clearReturnToPrevious("auto_dismissed")},[_,Bt]),(0,d.useEffect)(()=>{const Wt=(0,I.SE)(Kt);_.setKioskModeFromUrl(Wt.kiosk)},[_,Kt]),(0,j.jsxs)("div",{className:cf()("main-view",{"main-view--search-bar-hidden":ue&&!Q.chromeless,"main-view--chrome-hidden":Q.chromeless}),children:[!Q.chromeless&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(me.z9,{className:Oe.skipLink,href:"#pageContent",children:"Skip to main content"}),(0,j.jsxs)("header",{className:(0,Ye.cx)(Oe.topNav),children:[!ue&&(0,j.jsx)(mg,{}),(0,j.jsx)(Qf,{searchBarHidden:ue,sectionNav:Q.sectionNav.node,pageNav:Q.pageNav,actions:Q.actions,onToggleSearchBar:_.onToggleSearchBar,onToggleMegaMenu:mt,onToggleKioskMode:_.onToggleKioskMode})]})]}),(0,j.jsx)("div",{className:dt,children:(0,j.jsxs)("div",{className:Oe.panes,children:[Ze&&(0,j.jsx)(qd,{className:Oe.dockedMegaMenu,onClose:()=>_.setMegaMenuOpen(!1)}),(0,j.jsx)("main",{className:(0,Ye.cx)(Oe.pageContainer,{[Oe.pageContainerMenuDocked]:se.$.featureToggles.bodyScrolling&&Ze}),id:"pageContent",children:F})]})}),!Q.chromeless&&!Q.megaMenuDocked&&(0,j.jsx)(nu,{}),!Q.chromeless&&(0,j.jsx)(Rf,{}),Mt&&Q.returnToPrevious&&(0,j.jsx)(ng,{href:Q.returnToPrevious.href,title:Q.returnToPrevious.title})]})}const yg=(F,_)=>({content:(0,Ye.css)({display:"flex",flexDirection:"column",paddingTop:Ho.l*2,flexGrow:1,height:se.$.featureToggles.bodyScrolling?"auto":"100%"}),contentNoSearchBar:(0,Ye.css)({paddingTop:Ho.l}),contentChromeless:(0,Ye.css)({paddingTop:0}),dockedMegaMenu:(0,Ye.css)(se.$.featureToggles.bodyScrolling?{background:F.colors.background.primary,borderRight:`1px solid ${F.colors.border.weak}`,display:"none",position:"fixed",height:`calc(100% - ${_?Ho.l:Ho.l*2}px)`,zIndex:F.zIndex.navbarFixed,[F.breakpoints.up("xl")]:{display:"block"}}:{background:F.colors.background.primary,borderRight:`1px solid ${F.colors.border.weak}`,display:"none",zIndex:F.zIndex.navbarFixed,[F.breakpoints.up("xl")]:{display:"block"}}),topNav:(0,Ye.css)({display:"flex",position:"fixed",zIndex:F.zIndex.navbarFixed,left:0,right:0,background:F.colors.background.primary,flexDirection:"column"}),panes:(0,Ye.css)(se.$.featureToggles.bodyScrolling?{display:"flex",flexDirection:"column",flexGrow:1,label:"page-panes"}:{label:"page-panes",display:"flex",height:"100%",width:"100%",flexGrow:1,minHeight:0,flexDirection:"column",[F.breakpoints.up("md")]:{flexDirection:"row"}}),pageContainerMenuDocked:(0,Ye.css)({paddingLeft:"300px"}),pageContainer:(0,Ye.css)(se.$.featureToggles.bodyScrolling?{label:"page-container",display:"flex",flexDirection:"column",flexGrow:1}:{label:"page-container",display:"flex",flexDirection:"column",flexGrow:1,minHeight:0,minWidth:0,overflow:"auto","@media print":{overflow:"visible"},"@page":{margin:0,size:"auto",padding:0}}),skipLink:(0,Ye.css)({position:"fixed",top:-1e3,":focus":{left:F.spacing(1),top:F.spacing(1),zIndex:F.zIndex.portal}})});var bo=e(82467),Zl=e(16001),ql=e(3169),xg=e(94701);function Eg({appNotification:F,onClearNotification:_}){const Q=(0,Dt.of)(Dg);(0,xg.A)(()=>{setTimeout(()=>{_(F.id)},Fn.timeoutMap[F.severity])});const ue=F.component||F.text||F.traceId;return(0,j.jsx)(In.F,{severity:F.severity,title:F.title,onRemove:()=>_(F.id),elevated:!0,children:ue&&(0,j.jsxs)("div",{className:Q.wrapper,children:[(0,j.jsx)("span",{children:F.component||F.text}),F.traceId&&(0,j.jsxs)("span",{className:Q.trace,children:["Trace ID: ",F.traceId]})]})})}function Dg(F){return{wrapper:(0,Ye.css)({display:"flex",flexDirection:"column"}),trace:(0,Ye.css)({fontSize:F.typography.pxToRem(10)})}}function Pg(){const F=(0,Fn.useSelector)(Ce=>(0,Zl.fX)(Ce.appNotifications)),_=(0,Fn.useDispatch)(),Q=(0,Dt.of)(Vp);(0,d.useEffect)(()=>{Cr.A.on(Li.r1.alertWarning,Ce=>_((0,bo.dx)((0,ql.q8)(...Ce)))),Cr.A.on(Li.r1.alertSuccess,Ce=>_((0,bo.dx)((0,ql.tZ)(...Ce)))),Cr.A.on(Li.r1.alertError,Ce=>_((0,bo.dx)((0,ql.gi)(...Ce)))),Cr.A.on(Li.r1.alertInfo,Ce=>_((0,bo.dx)((0,ql.Cf)(...Ce))))},[_]);const ue=Ce=>{_((0,bo.Do)(Ce))};return(0,j.jsx)("div",{className:Q.wrapper,children:(0,j.jsx)(rn.B,{direction:"column",children:F.map((Ce,Oe)=>(0,j.jsx)(Eg,{appNotification:Ce,onClearNotification:ue},`${Ce.id}-${Oe}`))})})}function Vp(F){return{wrapper:(0,Ye.css)({label:"app-notifications-list",zIndex:F.zIndex.portal,minWidth:400,maxWidth:600,position:"fixed",right:6,top:88})}}function Kc(F){const[_,Q]=(0,d.useState)({component:null,props:{}}),ue=(0,d.useMemo)(()=>{function Ce(we,ke){Q({component:we,props:ke})}function Oe(){Q({component:null,props:{}})}return{component:_.component,props:{..._.props,isOpen:!0,onDismiss:Oe},showModal:Ce,hideModal:Oe}},[_]);return(0,d.useEffect)(()=>{Cr.A.subscribe(Yr.S8,({payload:Oe})=>{Q({component:Oe.component,props:Oe.props})}),Cr.A.subscribe(Yr.bY,Oe=>{bg(Oe,Q)});let Ce="";I.Ny.getHistory().listen(Oe=>{Oe.pathname!==Ce&&Q({component:null,props:{}}),Ce=Oe.pathname})},[]),(0,j.jsx)(ac.wE.Provider,{value:ue,children:F.children})}function bg({payload:F},_){const{confirmText:Q,onConfirm:ue=()=>{},onDismiss:Ce,text2:Oe,altActionText:we,onAltAction:ke,noText:Ze,text:dt,text2htmlBind:mt,yesText:Ct="Yes",icon:Kt,title:Bt="Confirm",yesButtonVariant:Mt}=F,Wt=()=>_({component:null,props:{}}),vn={confirmText:Ct,confirmButtonVariant:Mt,confirmationText:Q,icon:Kt,title:Bt,body:dt,description:Oe&&mt?su.sQ.sanitize(Oe):Oe,isOpen:!0,dismissText:Ze,onConfirm:()=>{ue(),Wt()},onDismiss:()=>{Ce?.(),Wt()},onAlternative:ke?()=>{ke(),Wt()}:void 0,alternativeText:we};_({component:ul.u,props:vn})}var jo=e(66899),Il=e.n(jo),$c=e(52446);function Cg({error:F,errorInfo:_}){const Q=(0,yr.zy)(),ue=F?.name==="ChunkLoadError",Ce=(0,Dt.of)(Tg);return(0,d.useEffect)(()=>{ue&&Q.search.indexOf("chunkNotFound")===-1&&(window.location.href=C.I.getUrlForPartial(Q,{chunkNotFound:!0}))},[Q,ue]),(0,j.jsx)(kr.Y,{navId:"error",layout:Wl.k.Canvas,children:(0,j.jsxs)("div",{className:Ce.container,children:[ue&&(0,j.jsxs)("div",{children:[(0,j.jsx)("h2",{children:"Unable to find application file"}),(0,j.jsx)("br",{}),(0,j.jsx)("h2",{className:"page-heading",children:"Grafana has likely been updated. Please try reloading the page."}),(0,j.jsx)("br",{}),(0,j.jsx)(me.$n,{size:"md",variant:"secondary",icon:"repeat",onClick:()=>window.location.reload(),children:"Reload"}),(0,j.jsx)($c.D,{title:"Error details",error:F,errorInfo:_})]}),!ue&&(0,j.jsx)($c.D,{title:"An unexpected error happened",error:F,errorInfo:_})]})})}const Tg=F=>({container:(0,Ye.css)({width:"500px",margin:F.spacing(8,"auto")})});function Vc(){const F=(0,Dt.of)(Sg);return(0,j.jsx)("div",{className:F.container,"aria-live":"polite",role:"status","aria-label":(0,ya.t)("bouncing-loader.label","Loading"),children:(0,j.jsx)("div",{className:F.bounce,children:(0,j.jsx)("img",{alt:"",src:"public/img/grafana_icon.svg",className:F.logo})})})}const _c=(0,Ye.keyframes)({"0%":{opacity:0,animationTimingFunction:"cubic-bezier(0, 0, 0.5, 1)"},"100%":{opacity:1}}),Ei=(0,Ye.keyframes)({"0%":{opacity:0},"50%":{opacity:1},"100%":{opacity:0}}),uu=(0,Ye.keyframes)({"from, to":{transform:"translateY(0px)",animationTimingFunction:"cubic-bezier(0.3, 0, 0.1, 1)"},"50%":{transform:"translateY(-50px)",animationTimingFunction:"cubic-bezier(0.9, 0, 0.7, 1)"}}),Mg=(0,Ye.keyframes)({"0%":{transform:"scaleX(1.3) scaleY(0.8)",animationTimingFunction:"cubic-bezier(0.3, 0, 0.1, 1)"},"15%":{transform:"scaleX(0.75) scaleY(1.25)",animationTimingFunction:"cubic-bezier(0, 0, 0.7, 0.75)"},"55%":{transform:"scaleX(1.05) scaleY(0.95)",animationTimingFunction:"cubic-bezier(0.9, 0, 1, 1)"},"95%":{transform:"scaleX(0.75) scaleY(1.25)",animationTimingFunction:"cubic-bezier(0, 0, 0, 1)"},"100%":{transform:"scaleX(1.3) scaleY(0.8)",animationTimingFunction:"cubic-bezier(0, 0, 0.7, 1)"}}),Sg=F=>({container:(0,Ye.css)({opacity:0,[F.transitions.handleMotion("no-preference")]:{animationName:_c,animationIterationCount:1,animationDuration:"0.9s",animationDelay:"0.5s",animationFillMode:"forwards"},[F.transitions.handleMotion("reduce")]:{animationName:Ei,animationIterationCount:"infinite",animationDuration:"4s",animationDelay:"0.5s"}}),bounce:(0,Ye.css)({textAlign:"center",[F.transitions.handleMotion("no-preference")]:{animationName:uu,animationDuration:"0.9s",animationIterationCount:"infinite"}}),logo:(0,Ye.css)({display:"inline-block",[F.transitions.handleMotion("no-preference")]:{animationName:Mg,animationDuration:"0.9s",animationIterationCount:"infinite"},width:"250px",height:"250px"})});function Og(){const F=(0,Dt.of)(zc);return(0,j.jsx)("div",{className:(0,Ye.cx)({[F.loadingPage]:!se.$.featureToggles.bodyScrolling,[F.loadingPageBodyScrolling]:se.$.featureToggles.bodyScrolling}),children:(0,j.jsx)(Vc,{})})}const zc=F=>({loadingPage:(0,Ye.css)({backgroundColor:F.colors.background.primary,height:"100%",flexDrection:"column",display:"flex",justifyContent:"center",alignItems:"center"}),loadingPageBodyScrolling:(0,Ye.css)({backgroundColor:F.colors.background.primary,flex:1,flexDrection:"column",display:"flex",justifyContent:"center",alignItems:"center"})});function hu(F){const{chrome:_,keybindings:Q}=(0,Lo.Il)();return _.setMatchedRoute(F.route),(0,d.useLayoutEffect)(()=>{Q.clearAndInitGlobalBindings(F.route)},[Q,F.route]),(0,d.useEffect)(()=>(fu(F.route),gu(),(0,I.Lc)("GrafanaRoute",!1,"Mounted",F.match),()=>{(0,I.Lc)("GrafanaRoute",!1,"Unmounted",F.route),fu(F.route,!0)}),[]),(0,d.useEffect)(()=>{gu(),(0,xr.Jy)(),(0,I.Lc)("GrafanaRoute",!1,"Updated",F)}),(0,I.Lc)("GrafanaRoute",!1,"Rendered",F.route),(0,j.jsx)(Ul.tH,{children:({error:ue,errorInfo:Ce})=>ue?(0,j.jsx)(Cg,{error:ue,errorInfo:Ce}):(0,j.jsx)(d.Suspense,{fallback:(0,j.jsx)(Og,{}),children:(0,j.jsx)(F.route.component,{...F,queryParams:(0,I.SE)(F.location.search)})})})}function Ig(F){return F.pageClass?F.pageClass.split(" "):[]}function fu(F,_=!1){for(const Q of Ig(F))_?document.body.classList.remove(Q):document.body.classList.add(Q)}function gu(){document.body.classList.remove("sidemenu-open--xs");const F=document.getElementById("tooltip");F?.parentElement?.removeChild(F);const _=document.querySelectorAll(".tooltip");for(let Q=0;Q<_.length;Q++){const ue=_[Q];ue.parentElement?.removeChild(ue)}for(const Q of Il().drops)Q.destroy()}var Co=e(96378),pu=e(78731);class mu extends d.PureComponent{constructor(){super(...arguments),this.styles=Ag(se.$.theme2),this.state={},this.initListener=()=>{const _=(0,pu.oF)();_&&(this.subscription=_.getConnectionState().subscribe({next:Q=>{this.setState({show:!Q})}}))}}componentDidMount(){}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe()}render(){const{show:_}=this.state;return _?!or.TP.isSignedIn||!se.$.liveEnabled||or.TP.user.orgRole===Ec.X.None?null:(0,j.jsx)("div",{className:this.styles.foot,children:(0,j.jsx)(In.F,{severity:"warning",className:this.styles.warn,title:"connection to server is lost..."})}):null}}const Ag=(0,Fl.N)(F=>({foot:(0,Ye.css)({position:"fixed",bottom:0,left:0,right:0,zIndex:1e4,cursor:"wait",margin:F.spacing(2)}),warn:(0,Ye.css)({maxWidth:"400px",margin:"auto"})}));let vu=[],yu=[];function uo(F){vu.push(F)}function ti(F){yu.push(F)}class xu extends d.Component{constructor(_){super(_),this.renderRoute=Q=>{const ue=Q.roles?Q.roles():[];return(0,j.jsx)(jr.CompatRoute,{exact:Q.exact===void 0?!0:Q.exact,sensitive:Q.sensitive===void 0?!1:Q.sensitive,path:Q.path,render:Ce=>ue?.length&&!ue.some(Oe=>or.TP.hasRole(Oe))?(0,j.jsx)(yr.rd,{to:"/"}):(0,j.jsx)(hu,{...Ce,route:Q})},Q.path)},this.state={}}async componentDidMount(){await of(),this.setState({ready:!0}),$(".preloader").remove()}renderRoutes(){return(0,j.jsx)(yr.dO,{children:tf().map(_=>this.renderRoute(_))})}render(){const{app:_}=this.props,{ready:Q}=this.state;(0,I.Lc)("AppWrapper",!1,"rendering");const ue=Ce=>{(0,xr.rR)("command_palette_action_selected",{actionId:Ce.id,actionName:Ce.name})};return(0,j.jsx)(co.Provider,{store:tr.M_,children:(0,j.jsx)(Ul.Xw,{style:"page",children:(0,j.jsx)(Lo.YE.Provider,{value:_.context,children:(0,j.jsx)(Co.N,{value:se.$.theme2,children:(0,j.jsx)(rr.KBarProvider,{actions:[],options:{enableHistory:!0,callbacks:{onSelectAction:ue}},children:(0,j.jsx)(yr.Ix,{history:I.Ny.getHistory(),children:(0,j.jsx)(jr.CompatRouter,{children:(0,j.jsxs)(Kc,{children:[(0,j.jsx)(Lu.k,{}),(0,j.jsx)("div",{className:"grafana-app",children:(0,j.jsxs)(vg,{children:[(0,j.jsx)(Ud,{}),(0,j.jsx)(Pg,{}),(0,j.jsxs)(rn.B,{gap:0,grow:1,direction:"column",children:[yu.map((Ce,Oe)=>(0,j.jsx)(Ce,{},Oe.toString())),Q&&this.renderRoutes()]}),vu.map((Ce,Oe)=>(0,j.jsx)(Ce,{},Oe.toString()))]})}),(0,j.jsx)(mu,{}),(0,j.jsx)(ac.EO,{}),(0,j.jsx)(Ii.qB,{})]})})})})})})})})}}var Eu=e(33919);function ec({actions:F,children:_,info:Q,pageNav:ue,layout:Ce,renderTitle:Oe,subTitle:we}){const ke=(0,d.useContext)(bc);return(0,j.jsx)(kr.Y,{navModel:ke.sectionNav,pageNav:ue,layout:Ce,actions:F,renderTitle:Oe,info:Q,subTitle:we,children:(0,j.jsx)(kr.Y.Contents,{children:_})})}var Rg=e(8867),Lg=e(91324),jg=e(23227),Bg=e(83712),Ug=e(93455),Ng=e(99443),wg=e(70699),Wg=e(63997),Fg=e(5798),Du=e(61061),Kg=e(85346),$g=e(41731),Vg=e(36294),_g=e(62575),zg=e(27798),Al=e(53392),Hc=e(17694),Pu=e(27743),Hg=e(66509),kg=e(98368),Gg=e(67341),Qg=e(51472),ni=e(90517),Yg=e(78412),Jg=e(24548),Xg=e(41366),kc=e(63892),Zg=e(22965),qg=e(19336),J=e(66163),pe=e(30259),Me=e(96725),Ue=e(30283),ze=e(53141),tt=e(69382),it=e(88790),bt=e(388),Lt=e(58689),Nt=e(29342),Ht=e(27583),Xt=e(34153),cn=e(13852),Gt=e(5614),pn=e(34715),zn=e(25853),Ln=e(98020),Kn=e(90088),Rn=e(79764),mn=e(5422),bn=e(61987),Ns=e(88225),ts=e(13896),Es=e(68018),Hn=e(63023),jn=e(32437),is=e(99996),Zn=e(99641),ps=e(70649),Fs=e(98828),la=e(79151),ia=e(53663),Na=e(27193),aa=e(53123),Ts=e(4458),Is=e(28643),ba=e(33311),Va=e(90841),Vs=e(49018),Rs=e(63738),ra=e(63263),Da=e(29340),ga=e(45937),Ia=e(29339),Ha=e(6820),xa=e(77444),Qa=e(3327),Ya=e(70794),cr=e(11273),ms=e(80641),Vn=e(28867),ls=e(11220),sa=e(23544),Qs=e(48339),ca=e(4240),Oa=e(95224),Tr=e(82382),ho=e(87048),Ui=e(53007),To=e(12179),Ni=e(17226),Rl=e(42982),tc=e(42806),Bo=e(50459),wi=e(84879),qi=e(52664),Jr=e(26868),Ll=e(72805),Gc=e(73575),Fm=e(56811),Km=e(53896),$m=e(97918),Vm=e(81422),_m=e(29130),zm=e(45376),Hm=e(73642),km=e(83267),Gm=e(80021),Qm=e(41684),Ym=e(72215),Jm=e(81656),Xm=e(29424),Zm=e(7682),qm=e(51764),e0=e(76151),t0=e(30781),n0=e(65972),s0=e(90756),a0=e(24289),r0=e(84472),o0=e(71533),i0=e(45298),l0=e(96906),c0=e(95311),d0=e(82349),u0=e(21101),h0=e(49935),f0=e(48761),g0=e(97231),p0=e(13835),m0=e(91381),v0=e(52859),y0=e(25928),x0=e(36714),E0=e(30815),D0=e(3465),P0=e(39012),b0=e(94675),C0=e(40051),T0=e(4543),M0=e(89579),S0=e(82524),O0=e(31115),I0=e(99003),A0=e(95684),R0=e(1624),L0=e(93644),j0=e(96619),B0=e(61748),U0=e(57169),N0=e(11769),w0=e(26551),W0=e(40295),F0=e(38514),K0=e(81312),$0=e(64298),V0=e(70866),_0=e(30587),z0=e(44850),H0=e(54556),k0=e(81615),G0=e(82798),Q0=e(8687),Y0=e(77270),J0=e(10742),X0=e(41404),Z0=e(72579),q0=e(39973),ev=e(56963),tv=e(8807),nv=e(24109),sv=e(46255),av=e(68636),rv=e(74305);let _p=!1;function fn(F,_){Rg.cacheStore[_]={content:F,status:"loaded"}}function ov(){let F="public/img/icons/";const _=typeof window<"u"&&window.__grafana_public_path__;return _&&(F=_+"img/icons/"),Q=>F+Q}function iv(){if(_p)return;_p=!0;const F=ov();fn(Lg,F("unicons/at.svg")),fn(jg,F("unicons/adjust-circle.svg")),fn(Bg,F("unicons/align-left.svg")),fn(Ug,F("unicons/align-right.svg")),fn(Ng,F("unicons/angle-double-down.svg")),fn(wg,F("unicons/angle-double-right.svg")),fn(Wg,F("unicons/angle-down.svg")),fn(Fg,F("unicons/angle-left.svg")),fn(Du,F("unicons/angle-right.svg")),fn(Kg,F("unicons/angle-up.svg")),fn($g,F("unicons/apps.svg")),fn(Vg,F("unicons/arrow.svg")),fn(_g,F("unicons/arrow-down.svg")),fn(zg,F("unicons/arrow-from-right.svg")),fn(Al,F("unicons/arrow-left.svg")),fn(Hc,F("unicons/arrow-random.svg")),fn(Pu,F("unicons/arrow-right.svg")),fn(Hg,F("unicons/arrow-to-right.svg")),fn(kg,F("unicons/arrow-up.svg")),fn(Gg,F("unicons/arrows-h.svg")),fn(Qg,F("unicons/backward.svg")),fn(ni,F("unicons/bars.svg")),fn(Yg,F("unicons/bell.svg")),fn(Jg,F("unicons/bell-slash.svg")),fn(Xg,F("unicons/bolt.svg")),fn(kc,F("unicons/book.svg")),fn(Zg,F("unicons/book-open.svg")),fn(qg,F("unicons/brackets-curly.svg")),fn(J,F("unicons/bug.svg")),fn(pe,F("unicons/building.svg")),fn(Me,F("unicons/calculator-alt.svg")),fn(Ue,F("unicons/calendar-alt.svg")),fn(ze,F("unicons/calendar-slash.svg")),fn(tt,F("unicons/camera.svg")),fn(it,F("unicons/channel-add.svg")),fn(bt,F("unicons/chart-line.svg")),fn(Lt,F("unicons/check.svg")),fn(Nt,F("unicons/check-circle.svg")),fn(Ht,F("unicons/circle.svg")),fn(Xt,F("unicons/clipboard-alt.svg")),fn(cn,F("unicons/clock-nine.svg")),fn(Gt,F("unicons/cloud.svg")),fn(pn,F("unicons/cloud-download.svg")),fn(zn,F("unicons/code-branch.svg")),fn(Ln,F("unicons/cog.svg")),fn(Kn,F("unicons/columns.svg")),fn(Rn,F("unicons/comment-alt.svg")),fn(mn,F("unicons/comment-alt-share.svg")),fn(bn,F("unicons/comments-alt.svg")),fn(Ns,F("unicons/compass.svg")),fn(ts,F("unicons/copy.svg")),fn(Es,F("unicons/corner-down-right-alt.svg")),fn(Hn,F("unicons/cube.svg")),fn(jn,F("unicons/dashboard.svg")),fn(is,F("unicons/database.svg")),fn(Zn,F("unicons/document-info.svg")),fn(ps,F("unicons/download-alt.svg")),fn(Fs,F("unicons/draggabledots.svg")),fn(la,F("unicons/edit.svg")),fn(ia,F("unicons/ellipsis-v.svg")),fn(Na,F("unicons/ellipsis-h.svg")),fn(aa,F("unicons/envelope.svg")),fn(Ts,F("unicons/exchange-alt.svg")),fn(Is,F("unicons/exclamation-circle.svg")),fn(ba,F("unicons/exclamation-triangle.svg")),fn(Va,F("unicons/external-link-alt.svg")),fn(Vs,F("unicons/eye.svg")),fn(Rs,F("unicons/eye-slash.svg")),fn(ra,F("unicons/file-alt.svg")),fn(Da,F("unicons/file-blank.svg")),fn(ga,F("unicons/filter.svg")),fn(Ia,F("unicons/folder.svg")),fn(Ha,F("unicons/folder-open.svg")),fn(xa,F("unicons/folder-plus.svg")),fn(Qa,F("unicons/folder-upload.svg")),fn(Ya,F("unicons/forward.svg")),fn(cr,F("unicons/graph-bar.svg")),fn(ms,F("unicons/history.svg")),fn(Vn,F("unicons/history-alt.svg")),fn(ls,F("unicons/home-alt.svg")),fn(sa,F("unicons/import.svg")),fn(Qs,F("unicons/info.svg")),fn(ca,F("unicons/info-circle.svg")),fn(Oa,F("unicons/k6.svg")),fn(Tr,F("unicons/key-skeleton-alt.svg")),fn(ho,F("unicons/keyboard.svg")),fn(Ui,F("unicons/link.svg")),fn(To,F("unicons/list-ul.svg")),fn(Ni,F("unicons/lock.svg")),fn(Rl,F("unicons/minus.svg")),fn(tc,F("unicons/minus-circle.svg")),fn(Bo,F("unicons/mobile-android.svg")),fn(wi,F("unicons/monitor.svg")),fn(qi,F("unicons/pause.svg")),fn(Jr,F("unicons/pen.svg")),fn(Ll,F("unicons/play.svg")),fn(Gc,F("unicons/plug.svg")),fn(Fm,F("unicons/plus.svg")),fn(Km,F("unicons/plus-circle.svg")),fn($m,F("unicons/power.svg")),fn(Vm,F("unicons/presentation-play.svg")),fn(_m,F("unicons/process.svg")),fn(zm,F("unicons/question-circle.svg")),fn(Hm,F("unicons/repeat.svg")),fn(km,F("unicons/rocket.svg")),fn(Gm,F("unicons/rss.svg")),fn(Qm,F("unicons/save.svg")),fn(Ym,F("unicons/search.svg")),fn(Jm,F("unicons/search-minus.svg")),fn(Xm,F("unicons/search-plus.svg")),fn(Zm,F("unicons/share-alt.svg")),fn(qm,F("unicons/shield.svg")),fn(e0,F("unicons/signal.svg")),fn(t0,F("unicons/signin.svg")),fn(n0,F("unicons/signout.svg")),fn(s0,F("unicons/sitemap.svg")),fn(a0,F("unicons/slack.svg")),fn(r0,F("unicons/sliders-v-alt.svg")),fn(o0,F("unicons/sort-amount-down.svg")),fn(i0,F("unicons/sort-amount-up.svg")),fn(l0,F("unicons/square-shape.svg")),fn(c0,F("unicons/star.svg")),fn(d0,F("unicons/step-backward.svg")),fn(u0,F("unicons/sync.svg")),fn(h0,F("unicons/stopwatch.svg")),fn(f0,F("unicons/table.svg")),fn(g0,F("unicons/tag-alt.svg")),fn(p0,F("unicons/times.svg")),fn(m0,F("unicons/trash-alt.svg")),fn(v0,F("unicons/unlock.svg")),fn(y0,F("unicons/upload.svg")),fn(x0,F("unicons/user.svg")),fn(E0,F("unicons/users-alt.svg")),fn(D0,F("unicons/wrap-text.svg")),fn(P0,F("unicons/cloud-upload.svg")),fn(b0,F("unicons/credit-card.svg")),fn(C0,F("unicons/file-copy-alt.svg")),fn(T0,F("unicons/fire.svg")),fn(M0,F("unicons/hourglass.svg")),fn(S0,F("unicons/layer-group.svg")),fn(O0,F("unicons/layers-alt.svg")),fn(I0,F("unicons/line-alt.svg")),fn(A0,F("unicons/list-ui-alt.svg")),fn(R0,F("unicons/message.svg")),fn(L0,F("unicons/palette.svg")),fn(j0,F("unicons/percentage.svg")),fn(B0,F("unicons/shield-exclamation.svg")),fn(U0,F("unicons/plus-square.svg")),fn(N0,F("unicons/x.svg")),fn(w0,F("unicons/capture.svg")),fn(W0,F("custom/gf-grid.svg")),fn(F0,F("custom/gf-landscape.svg")),fn(K0,F("custom/gf-layout-simple.svg")),fn($0,F("custom/gf-portrait.svg")),fn(V0,F("custom/gf-show-context.svg")),fn(_0,F("custom/gf-bar-alignment-after.svg")),fn(z0,F("custom/gf-bar-alignment-before.svg")),fn(H0,F("custom/gf-bar-alignment-center.svg")),fn(k0,F("custom/gf-interpolation-linear.svg")),fn(G0,F("custom/gf-interpolation-smooth.svg")),fn(Q0,F("custom/gf-interpolation-step-after.svg")),fn(Y0,F("custom/gf-interpolation-step-before.svg")),fn(J0,F("custom/gf-logs.svg")),fn(X0,F("custom/gf-movepane-left.svg")),fn(Z0,F("custom/gf-movepane-right.svg")),fn(q0,F("mono/favorite.svg")),fn(ev,F("mono/grafana.svg")),fn(tv,F("mono/heart.svg")),fn(nv,F("mono/heart-break.svg")),fn(sv,F("mono/panel-add.svg")),fn(av,F("mono/library-panel.svg")),fn(rv,F("unicons/record-audio.svg"))}function lv(){self.MonacoEnvironment={getWorker(F,_){const Q=E.l.getIfExists(_);return Q?Q.init():_==="json"?new Ua.c(new URL(e.p+e.u(1162),e.b)):_==="css"||_==="scss"||_==="less"?new Ua.c(new URL(e.p+e.u(9044),e.b)):_==="html"||_==="handlebars"||_==="razor"?new Ua.c(new URL(e.p+e.u(4064),e.b)):_==="typescript"||_==="javascript"?new Ua.c(new URL(e.p+e.u(2150),e.b)):new Ua.c(new URL(e.p+e.u(1821),e.b))}}}var ep=e(76885);function cv(F){const _=F.target instanceof Element&&dv(F.target);if(!(F.ctrlKey||F.metaKey||F.defaultPrevented)&&_){let Q=_.getAttribute("href");const ue=_.getAttribute("target");if(Q&&!ue){const Ce=ep.kM.parseKeyValue(Q.split("?")[1]),Oe=Ce.orgId&&Number(Ce.orgId)!==Y.config.bootData.user.orgId;if((0,I.Lc)("utils",!1,"intercepting link click",F),F.preventDefault(),Q=C.I.stripBaseFromUrl(Q),Q[0]!=="/"||Oe)if(Q.indexOf("://")>0||Q.indexOf("mailto:")===0||Oe){window.location.href=Q;return}else if(Q.indexOf("#")===0){window.location.hash=Q;return}else Q=`/${Q}`;I.Ny.push(Q)}}}function dv(F){for(;F!==null&&F.tagName;){if(F.tagName.toUpperCase()==="A")return F;F=F.parentElement}return null}class uv{constructor(_){this.hasUpdates=!1,this.checked=Date.now(),this.prevLocationPath="",this.interval=_??1e3*60*5}start(){const _=(0,pu.oF)();_&&_.getConnectionState().subscribe(Q=>{Q&&this._checkForUpdates()}),I.Ny.getHistory().listen(this.locationUpdated.bind(this)),this.prevLocationPath=I.Ny.getLocation().pathname}locationUpdated(_){if(this.prevLocationPath===_.pathname)return;const Q=_.pathname.split("/");Q[1]==="/"&&this.prevLocationPath!=="/"?this.reloadIfUpdateDetected():Q[1]==="d"?this.reloadIfUpdateDetected():this.hasUpdates&&(0,xr.rR)("new_frontend_assets_reload_ignored",{newLocation:_.pathname,prevLocation:this.prevLocationPath}),this.prevLocationPath=_.pathname}async _checkForUpdates(){if(this.hasUpdates||Date.now()-this.checked<this.interval)return;this.checked=Date.now();const _=this.previous,Q=await(0,M.AI)().get("/api/frontend/assets");_&&!(0,m.isEqual)(_,Q)&&(this.hasUpdates=!0,(0,xr.rR)("new_frontend_assets_detected",{assets:_.assets!==Q.assets,plugins:_.plugins!==Q.plugins,version:_.version!==Q.version,flags:_.flags!==Q.flags})),this.previous=Q}reloadIfUpdateDetected(){this.hasUpdates&&((0,xr.rR)("new_frontend_assets_reload",{}),window.location.reload()),this._checkForUpdates()}}var tp=e(27677),hv=e(91040),fv=e(40621);function np(F,_=!1){return new Promise(Q=>{const ue=document.createElement("script");ue.onload=Q,ue.src=F,ue.async=_,document.head.appendChild(ue)})}const zp=(0,hv.h)("EchoSrv"),Hp=zp.logger;(0,fv.h)("echo",void 0,zp);class gv{constructor(_){this.config={flushInterval:1e4,debug:!1},this.backends=[],this.flush=()=>{for(const Q of this.backends)Q.flush()},this.addBackend=Q=>{Hp("Adding backend",!1,Q),this.backends.push(Q)},this.addEvent=(Q,ue)=>{const Ce=this.getMeta(),Oe={...Q,meta:{...Ce,...ue}};for(const we of this.backends)(we.supportedEvents.length===0||we.supportedEvents.indexOf(Oe.type)>-1)&&we.addEvent(Oe);Hp(`${Q.type} event`,!1,{...Q.payload,meta:Oe.meta})},this.getMeta=()=>({sessionId:"",userId:or.TP.user.id,userLogin:or.TP.user.login,userSignedIn:or.TP.user.isSignedIn,screenSize:{width:window.innerWidth,height:window.innerHeight},windowSize:{width:window.screen.width,height:window.screen.height},userAgent:window.navigator.userAgent,ts:new Date().getTime(),timeSinceNavigationStart:performance.now(),path:window.location.pathname,url:window.location.href}),this.config={...this.config,..._},setInterval(this.flush,this.config.flushInterval)}}var pv=e(42614);class mv{constructor(_){this.options=_,this.buffer=[],this.supportedEvents=[K.on.Performance],this.addEvent=Q=>{this.buffer.push(Q.payload)},this.flush=()=>{this.buffer.length!==0&&(tp.IB.post("/api/frontend-metrics",{events:this.buffer},{showErrorAlert:!1}).catch(()=>{}),this.buffer=[])}}}var Qc=e(61298);class vv{constructor(_){this.options=_,this.supportedEvents=[K.on.Pageview,K.on.Interaction],this.addEvent=Ce=>{window.applicationInsights&&((0,Qc.nB)(Ce)&&window.applicationInsights.trackPageView?.(),(0,Qc.fX)(Ce)&&window.applicationInsights.trackEvent?.({name:Ce.payload.interactionName,properties:Ce.payload.properties}))},this.flush=()=>{};const Q={config:{connectionString:_.connectionString,endpointUrl:_.endpointUrl}};System.import("https://js.monitor.azure.com/scripts/b/ai.2.min.js").then(Ce=>Ce.default?Ce.default:Ce).then(({ApplicationInsights:Ce})=>{const Oe=new Ce(Q);window.applicationInsights=Oe.loadAppInsights()})}}class yv{constructor(_){this.options=_,this.supportedEvents=[K.on.Pageview],this.googleAnalytics4SendManualPageViews=!1,this.addEvent=Ce=>{window.gtag&&this.googleAnalytics4SendManualPageViews&&window.gtag("event","page_view",{page_path:Ce.payload.page})},this.flush=()=>{};const Q=`https://www.googletagmanager.com/gtag/js?id=${_.googleAnalyticsId}`;np(Q,!0),window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},window.gtag("js",new Date);const ue={page_path:window.location.pathname};_.user&&(ue.user_id=_.user.analytics.identifier),this.googleAnalytics4SendManualPageViews=_.googleAnalytics4SendManualPageViews,window.gtag("config",_.googleAnalyticsId,ue)}}class xv{constructor(_){this.options=_,this.supportedEvents=[K.on.Pageview],this.trackedUserId=null,this.addEvent=Ce=>{if(!window.ga)return;window.ga("set",{page:Ce.payload.page}),window.ga("send","pageview");const{userSignedIn:Oe,userId:we}=Ce.meta;Oe&&we!==this.trackedUserId&&(this.trackedUserId=we,window.ga("set","userId",we))},this.flush=()=>{};const Q=`https://www.google-analytics.com/analytics${_.debug?"_debug":""}.js`;np(Q);const ue=window.ga=window.ga||function(){(ue.q=ue.q||[]).push(arguments)};ue.l=+new Date,ue("create",_.googleAnalyticsId,"auto"),ue("set","anonymizeIp",!0)}}class Ev{constructor(_){this.options=_,this.supportedEvents=[K.on.Pageview,K.on.Interaction,K.on.ExperimentView],this.addEvent=Oe=>{window.rudderanalytics&&((0,Qc.nB)(Oe)&&window.rudderanalytics.page?.(),(0,Qc.fX)(Oe)&&window.rudderanalytics.track?.(Oe.payload.interactionName,Oe.payload.properties),(0,Qc.p6)(Oe)&&window.rudderanalytics.track?.("experiment_viewed",{experiment_id:Oe.payload.experimentId,experiment_group:Oe.payload.experimentGroup,experiment_variant:Oe.payload.experimentVariant}))},this.flush=()=>{};const Q=_.sdkUrl||"https://cdn.rudderlabs.com/v1/rudder-analytics.min.js";np(Q);const ue=window.rudderanalytics=[],Ce=["load","page","track","identify","alias","group","ready","reset","getAnonymousId","setAnonymousId"];for(let Oe=0;Oe<Ce.length;Oe++){const we=Ce[Oe];ue[we]=function(ke){return function(){ue.push([ke].concat(Array.prototype.slice.call(arguments)))}}(we)}if(window.rudderanalytics?.load?.(_.writeKey,_.dataPlaneUrl,{configUrl:_.configUrl,destSDKBaseURL:_.integrationsUrl}),_.user){const{identifier:Oe,intercomIdentifier:we}=_.user.analytics,ke={};we&&(ke.Intercom={user_hash:we}),window.rudderanalytics?.identify?.(Oe,{email:_.user.email,orgId:_.user.orgId,language:_.user.language,version:_.buildInfo.version,edition:_.buildInfo.edition},ke)}}}var Dv=e(13515),Pv=e(88285),bv=e(74940),Cv=e(36043),Tv=e(8593),Mv=e(26539),Sv=e(21736),Ov=e(20467);class Iv extends Ov.j{constructor(){super(...arguments),this.name="EchoSrvTransport",this.version=se.$.buildInfo.version}send(_){(0,K.x$)().addEvent({type:K.on.GrafanaJavascriptAgent,payload:_})}isBatched(){return!0}getIgnoreUrls(){return[]}}class Av{constructor(_){this.options=_,this.supportedEvents=[K.on.GrafanaJavascriptAgent],this.addEvent=Oe=>{},this.flush=()=>{};const Q=[],ue=[new Iv];_.customEndpoint&&ue.push(new Pv.m({url:_.customEndpoint,apiKey:_.apiKey})),_.errorInstrumentalizationEnabled&&Q.push(new bv.W),_.consoleInstrumentalizationEnabled&&Q.push(new Cv._),_.webVitalsInstrumentalizationEnabled&&Q.push(new Tv.I),Q.push(new Mv.D);const Ce={globalObjectKey:_.globalObjectKey||"faro",preventGlobalExposure:_.preventGlobalExposure||!1,app:{version:_.buildInfo.version,environment:_.buildInfo.env},instrumentations:Q,transports:ue,ignoreErrors:["ResizeObserver loop limit exceeded","ResizeObserver loop completed","Non-Error exception captured with keys"],sessionTracking:{persistent:!0},batching:{sendTimeout:1e3},internalLoggerLevel:_.internalLoggerLevel||Dv.vI};this.faroInstance=(0,Sv.p)(Ce),_.user&&this.faroInstance.api.setUser({id:_.user.id,attributes:{orgId:String(_.user.orgId)||""}})}}var Rv=e(69129),Lv=e(87490),jv=e(70497),Bv=e(1702),bu=e(4898);class Uv{constructor(_,Q){this.locationService=_,this.chromeService=Q,this.panelId=null,Cr.A.subscribe(Rv.Tp,ue=>{this.panelId=ue.payload.panelId})}clearAndInitGlobalBindings(_){bu.R.reset(),_.chromeless||(this.bind("?",this.showHelpModal),this.bind("g h",this.goToHome),this.bind("g d",this.goToDashboards),this.bind("g e",this.goToExplore),this.bind("g a",this.openAlerting),this.bind("g p",this.goToProfile),this.bind("esc",this.exit),this.bindGlobalEsc()),this.bind("c t",()=>(0,Jl.O)(!1)),this.bind("c r",()=>(0,Jl.O)(!0))}bindGlobalEsc(){this.bindGlobal("esc",this.globalEsc)}globalEsc(){const Q=document.activeElement;if(!(document.querySelectorAll(".slate-typeahead--open").length>0)){if(Q&&Q instanceof HTMLElement&&(Q.nodeName==="INPUT"||Q.nodeName==="TEXTAREA"||Q.hasAttribute("data-slate-editor"))){Q.blur();return}this.exit()}}closeSearch(){this.locationService.partial({search:null})}openAlerting(){this.locationService.push("/alerting")}goToDashboards(){this.locationService.push("/dashboards")}goToHome(){this.locationService.push("/")}goToProfile(){this.locationService.push("/profile")}goToExplore(){this.locationService.push("/explore")}showHelpModal(){Cr.A.publish(new Yr.S8({component:Yl.N}))}exit(){const _=this.locationService.getSearchObject();if(_.editview){this.locationService.partial({editview:null,editIndex:null});return}if(_.inspect){this.locationService.partial({inspect:null,inspectTab:null});return}if(_.editPanel){this.locationService.partial({editPanel:null,tab:null});return}if(_.viewPanel){this.locationService.partial({viewPanel:null,tab:null});return}const{kioskMode:Q}=this.chromeService.state.getValue();Q&&this.chromeService.exitKioskMode(),_.search&&this.closeSearch()}showDashEditView(){this.locationService.partial({editview:"settings"})}bind(_,Q){bu.R.bind(_,ue=>{ue.preventDefault(),ue.stopPropagation(),ue.returnValue=!1,Q.call(this)},"keydown")}bindGlobal(_,Q){bu.R.bindGlobal(_,ue=>{ue.preventDefault(),ue.stopPropagation(),ue.returnValue=!1,Q.call(this)},"keydown")}unbind(_,Q){bu.R.unbind(_,Q)}bindWithPanelId(_,Q){this.bind(_,this.withFocusedPanel(Q))}withFocusedPanel(_){return()=>{if(typeof this.panelId=="number"){_(this.panelId);return}}}setupTimeRangeBindings(_=!0){this.bind("t a",()=>{Cr.A.publish(new Yr.Rh({updateUrl:_}))}),this.bind("t z",()=>{Cr.A.publish(new Yr.U0({scale:2,updateUrl:_}))}),this.bind("ctrl+z",()=>{Cr.A.publish(new Yr.U0({scale:2,updateUrl:_}))}),this.bind("t left",()=>{Cr.A.publish(new Yr.Io({direction:Yr.xL.Left,updateUrl:_}))}),this.bind("t right",()=>{Cr.A.publish(new Yr.Io({direction:Yr.xL.Right,updateUrl:_}))}),this.bind("t c",()=>{Cr.A.publish(new Yr.Bt)}),this.bind("t v",()=>{Cr.A.publish(new Yr.VZ({updateUrl:_}))})}setupDashboardBindings(_){this.bind("mod+o",()=>{_.graphTooltip=(_.graphTooltip+1)%3,_.events.publish(new Li.Tq),_.startRefresh()}),this.bind("mod+s",()=>{_.meta.canSave&&Cr.A.publish(new Yr.S8({component:jv.$,props:{dashboard:_}}))}),this.setupTimeRangeBindings(),this.bindWithPanelId("e",Q=>{if(_.canEditPanelById(Q)){const ue=this.locationService.getSearchObject().editPanel!==void 0;this.locationService.partial({editPanel:ue?null:Q})}}),this.bindWithPanelId("v",Q=>{const ue=this.locationService.getSearchObject().viewPanel!==void 0;this.locationService.partial({viewPanel:ue?null:Q})}),this.bindWithPanelId("p l",Q=>{const ue=_.getPanelById(Q),Ce={...ue.options};Ce.legend.showLegend?Ce.legend.showLegend=!1:Ce.legend.showLegend=!0,ue.updateOptions(Ce)}),this.bindWithPanelId("i",Q=>{this.locationService.partial({inspect:Q})}),$a.TP.hasAccessToExplore()&&this.bindWithPanelId("p x",async Q=>{const ue=_.getPanelById(Q),Ce=await(0,Lv.Xe)({queries:ue.targets,dsRef:ue.datasource,scopedVars:ue.scopedVars,timeRange:(0,vi.jG)().timeRange()});if(Ce){const Oe=C.I.stripBaseFromUrl(Ce);Oe&&this.locationService.push(Oe)}}),this.bindWithPanelId("p r",Q=>{_.canEditPanelById(Q)&&!(_.panelInView||_.panelInEdit)&&Cr.A.publish(new Yr.Vz(Q))}),this.bindWithPanelId("p d",Q=>{if(_.canEditPanelById(Q)){const ue=_.getPanelInfoById(Q).index;_.duplicatePanel(_.panels[ue])}}),this.bindWithPanelId("p s",Q=>{const ue=_.getPanelInfoById(Q);Cr.A.publish(new Yr.S8({component:Bv.ShareModal,props:{dashboard:_,panel:ue?.panel}}))}),this.bind("d l",()=>{_.toggleLegendsForAll()}),this.bind("d x",()=>{_.toggleExemplarsForAll()}),this.bind("d shift+c",()=>{_.collapseRows()}),this.bind("d shift+e",()=>{_.expandRows()}),this.bind("d n",()=>{this.locationService.push("/dashboard/new")}),this.bind("d r",()=>{_.startRefresh()}),this.bind("d s",()=>{this.showDashEditView()}),this.bind("d k",()=>{this.chromeService.onToggleKioskMode()}),this.bind("d a",()=>{const ue=this.locationService.getSearchObject().autofitpanels?"":"&autofitpanels";window.location.href=window.location.href+ue})}}var nc=e(78160);async function YD(){if(window.location.search.indexOf("why-render")!==-1){const{default:F}=await e.e(3718).then(e.t.bind(e,13718,23));F(React,{trackAllPureComponents:!0})}}var Nv=e(20120);const wv=(0,d.lazy)(()=>e.e(192).then(e.bind(e,57029)));function Wv(){const F=(0,br.Wd)(Ri.hY),_=se.$.unifiedAlertingEnabled;or.TP.hasPermission(F.read)&&(0,Nv.fP)({show:()=>_,component:({dashboard:Q})=>_?(0,j.jsx)(d.Suspense,{fallback:null,children:Q&&(0,j.jsx)(wv,{dashboardUid:Q.uid})},"alert-rules-button"):null,index:-2})}var Fv=e(73399);function Kv(F){return(0,j.jsx)($v,{...F})}const $v=(0,d.lazy)(async()=>{const{EmbeddedDashboard:F}=await e.e(2859).then(e.bind(e,13251));return{default:F}});var Vv=e(61582),_v=e(67027),zv=e(97527),JD=e(99355),Yc=e(14590),Hv=e(19895),kv=e(44838);const Gv=()=>new Ua.c(new URL(e.p+e.u(5358),e.b));var Qv=e(88483),kp=e(63720);const Yv=F=>new Qv.c(_=>{const Q=F.subscribe(Yc.BX(ue=>{_.next(ue)}),Yc.BX(ue=>{_.error(ue)}),Yc.BX(()=>{_.complete()}));return{unsubscribe:()=>{Q.then(ue=>ue.unsubscribe())}}}),sp=F=>(0,vr.H)(F).pipe((0,kp.n)(_=>Yv(_)));class Jv{constructor(_){this.getConnectionState=()=>sp(this.centrifugeWorker.getConnectionState()),this.getDataStream=Q=>sp(this.centrifugeWorker.getDataStream(Q)).pipe((0,Hv.Q)(kv.E)),this.getQueryData=async Q=>{const ue=JSON.parse(JSON.stringify(Q));return this.centrifugeWorker.getQueryData(ue)},this.getPresence=Q=>this.centrifugeWorker.getPresence(Q),this.getStream=Q=>sp(this.centrifugeWorker.getStream(Q)),this.centrifugeWorker=Yc.LV(Gv()),this.centrifugeWorker.initialize(_,Yc.BX(_.dataStreamSubscriberReadiness))}}var Gp=e(9631),Xv=e(55004),Zv=e(47773),Qp=e(26657),Cu=e(47118);class qv{constructor(_){this.deps=_,this.getConnectionState=()=>this.deps.centrifugeSrv.getConnectionState(),this.getDataStream=Q=>{let ue;const Ce=Oe=>{const we=Oe.data[0];if(!ue&&!(0,Cu.ot)(we,Cu._w.FullFrame)){console.warn(`expected first packet to contain a full frame, received ${we?.type}`);return}switch(we.type){case Cu._w.FullFrame:{ue=Gp.k9.deserialize(we.frame);return}case Cu._w.NewValuesSameSchema:{ue.pushNewValues(we.values);return}}};return this.deps.centrifugeSrv.getDataStream(Q).pipe((0,Rt.T)(Oe=>(Ce(Oe),{...Oe,data:[ue??Gp.k9.empty()]})))},this.getStream=Q=>this.deps.centrifugeSrv.getStream(Q),this.getQueryData=Q=>(0,vr.H)(this.deps.centrifugeSrv.getQueryData(Q)).pipe((0,kp.n)(ue=>{const Ce=(0,Zv.bE)(ue,Q.request.targets);return Ce.data?.length&&Ce.data.find(we=>we.meta?.channel)?(0,Qp.x7)(Ce,Q.request,Qp.ph):(0,kn.of)(Ce)})),this.publish=async(Q,ue)=>this.deps.backendSrv.post("api/live/publish",{channel:(0,Xv.Qp)(Q),data:ue}),this.getPresence=Q=>this.deps.centrifugeSrv.getPresence(Q)}}function ey(){const F={appUrl:`${window.location.origin}${se.$.appSubUrl}`,orgId:or.TP.user.orgId,orgRole:or.TP.user.orgRole,liveEnabled:se.$.liveEnabled,dataStreamSubscriberReadiness:Vv.a.ok.asObservable(),grafanaAuthToken:(0,_v.r)()},_=se.$.featureToggles["live-service-web-worker"]?new Jv(F):new zv.w(F);(0,pu.S8)(new qv({centrifugeSrv:_,backendSrv:(0,M.AI)()}))}function XD(){return getGrafanaLiveSrv()}var ty=e(17888),ny=e(20726),hr=e(75462),Yp=e(29436),sy=e(23994),ay=e(11140),ry=e(12881);function oy(){try{return[(0,hr.io)({title:"Add to dashboard",description:"Use the query and panel from explore and create/add it to a dashboard",extensionPointId:ji.S.ExploreToolbarAction,icon:"apps",category:"Dashboards",configure:()=>{if($a.TP.hasPermission(Fn.AccessControlAction.DashboardsCreate)||$a.TP.hasPermission(Fn.AccessControlAction.DashboardsWrite))return{}},onClick:(F,{context:_,openModal:Q})=>{Q({title:(0,ry.t)(),body:({onDismiss:ue})=>(0,j.jsx)(ay.v,{onClose:ue,exploreId:_?.exploreId})})}}),(0,hr.io)({title:"Add correlation",description:"Create a correlation from this query",extensionPointId:ji.S.ExploreToolbarAction,icon:"link",configure:F=>F?.shouldShowAddCorrelation?{}:void 0,onClick:(F,{context:_})=>{(0,tr.JD)((0,Yp.am)({editorMode:!0})),(0,tr.JD)((0,sy.Od)({exploreId:_.exploreId}))}})]}catch(F){return(0,hr.FF)(`Could not configure extensions for Explore due to: "${F}"`),[]}}function iy(){return[...oy()]}function ZD(F,_="extension is not a link extension"){if(!isPluginExtensionLink(F))throw new Error(_)}function qD(F,_="extension is not a command extension config"){if(!isPluginExtensionLinkConfig(F))throw new Error(_)}function Jp(F,_){if(!uy(F,_))throw new Error(`Invalid link extension. The "path" is required and should start with "/a/${F}/" (currently: "${_}"). Skipping the extension.`)}function Xp(F){if(!my(F))throw new Error('Invalid component extension, the "component" property needs to be a valid React component.')}function ly(F,_){if(!hy(F,_))throw new Error(`Invalid extension "${_.title}". The extensionPointId should start with either "grafana/", "plugins/" or "capabilities/${F}" (currently: "${_.extensionPointId}"). Skipping the extension.`)}function cy(F){if(!fy(F))throw new Error(`Invalid extension "${F.title}". The "configure" property must be a function. Skipping the extension.`)}function Zp(F,_){for(const Q of _)if(!gy(F[Q]))throw new Error(`Invalid extension "${F.title}". Property "${Q}" must be a string and cannot be empty. Skipping the extension.`)}function dy(F,_="The provided value is a Promise."){if(qp(F))throw new Error(_)}function uy(F,_){return!!(typeof _=="string"&&_.length>0&&_.startsWith(`/a/${F}/`))}function hy(F,_){return!!(_.extensionPointId?.startsWith("grafana/")||_.extensionPointId?.startsWith("plugins/")||_.extensionPointId?.startsWith(`capabilities/${F}/`))}function fy(F){return F.configure?typeof F.configure=="function":!0}function gy(F){return typeof F=="string"&&F.length>0}function py(F,_){try{if(Zp(_,["title","description","extensionPointId"]),ly(F,_),(0,hr.z1)(_)){if(cy(_),!_.path&&!_.onClick)return(0,hr.FF)(`Invalid extension "${_.title}". Either "path" or "onClick" is required.`),!1;_.path&&Jp(F,_.path)}return(0,hr.yS)(_)&&Xp(_.component),!0}catch(Q){return Q instanceof Error&&(0,hr.FF)(Q.message),!1}}function qp(F){return F instanceof Promise||typeof F=="object"&&F!==null&&"then"in F&&"catch"in F}function my(F){const _=ue=>typeof ue=="object"&&ue!==null&&"$$typeof"in ue;return typeof F=="function"||(ue=>_(ue)&&ue.$$typeof===Symbol.for("react.memo"))(F)}function vy(F){let _={id:"",extensions:{}};return F.asObservable().subscribe(Q=>{_=Q}),Q=>em({...Q,registry:_})}const em=({context:F,extensionPointId:_,limitPerPlugin:Q,registry:ue})=>{const Ce=F?(0,hr.$Y)(F):{},Oe=ue.extensions[_]??[],we=[],ke={};for(const Ze of Oe)try{const dt=Ze.config,{pluginId:mt}=Ze;if(Q&&ke[mt]>=Q)continue;if(ke[mt]===void 0&&(ke[mt]=0),(0,hr.z1)(dt)){const Ct=yy(mt,dt,Ce);if(dt.configure&&Ct===void 0)continue;const Kt=Ct?.path||dt.path,Bt={id:(0,hr.yt)(mt,dt),type:ji.u.link,pluginId:mt,onClick:xy(mt,dt,Ce),icon:Ct?.icon||dt.icon,title:Ct?.title||dt.title,description:Ct?.description||dt.description,path:(0,m.isString)(Kt)?Ey(mt,Kt,dt):void 0,category:Ct?.category||dt.category};we.push(Bt),ke[mt]+=1}if((0,hr.yS)(dt)){Xp(dt.component);const Ct={id:(0,hr.yt)(Ze.pluginId,dt),type:ji.u.component,pluginId:Ze.pluginId,title:dt.title,description:dt.description,component:(0,hr.nv)(mt,dt.component)};we.push(Ct),ke[mt]+=1}}catch(dt){dt instanceof Error&&(0,hr.FF)(dt.message)}return{extensions:we}};function yy(F,_,Q){try{const ue=_.configure?.(Q);if(ue===void 0)return;let{title:Ce=_.title,description:Oe=_.description,path:we=_.path,icon:ke=_.icon,category:Ze=_.category,...dt}=ue;return dy(ue,`The configure() function for "${_.title}" returned a promise, skipping updates.`),we&&Jp(F,we),Zp({title:Ce,description:Oe},["title","description"]),Object.keys(dt).length>0&&(0,hr.FF)(`Extension "${_.title}", is trying to override restricted properties: ${Object.keys(dt).join(", ")} which will be ignored.`),{title:Ce,description:Oe,path:we,icon:ke,category:Ze}}catch(ue){ue instanceof Error&&(0,hr.FF)(ue.message);return}}function xy(F,_,Q){const{onClick:ue}=_;if(ue)return function(Oe){try{(0,xr.rR)("ui_extension_link_clicked",{pluginId:F,extensionPointId:_.extensionPointId,title:_.title,category:_.category});const we=ue(Oe,(0,hr.yb)(F,Q));qp(we)&&we.catch(ke=>{ke instanceof Error&&(0,hr.FF)(ke.message)})}catch(we){we instanceof Error&&(0,hr.FF)(we.message)}}}function Ey(F,_,Q){return ep.kM.appendQueryToUrl(_,ep.kM.toUrlParams({uel_pid:F,uel_epid:Q.extensionPointId}))}var Tu=e(13752),tm=e(39741),Dy=e(29405),Py=e(96222),by=e(72985),nm=e(62938);class Cy{constructor(){this.resultSubject=new Tu.B,this.registrySubject=new tm.m(1),this.resultSubject.pipe((0,Dy.S)(Ty,{id:"",extensions:{}}),(0,Py.Z)({id:"",extensions:{}}),(0,Rt.T)(_=>(0,hr.ol)(_))).subscribe(this.registrySubject)}register(_){this.resultSubject.next(_)}asObservable(){return this.registrySubject.asObservable()}getRegistry(){return(0,by._)(this.asObservable())}}function Ty(F,_){const{pluginId:Q,extensionConfigs:ue,error:Ce}=_;if(Ce)return(0,hr.FF)(`"${Q}" plugin failed to load, skip registering its extensions.`),F;for(const Oe of ue){const{extensionPointId:we}=Oe;if((0,hr.WW)(Oe)){const dt=/capabilities\/([a-zA-Z0-9_.\-\/]+)$/.exec(we);if(!dt){(0,hr.FF)(`"${Q}" plugin has an invalid capability ID: ${we.replace("capabilities/","")} (It must be a string)`);continue}Oe.extensionPointId=`capabilities/${dt[1]}`}if(!Oe||!py(Q,Oe))return F;let ke={config:Oe,pluginId:Q};(0,hr.WW)(Oe)?F.extensions[we]=[ke]:Array.isArray(F.extensions[we])?F.extensions[we].push(ke):F.extensions[we]=[ke]}return F.id=(0,nm.A)(),F}function My(F){const _=F.asObservable();return function(ue){const Ce=(0,jc.A)(_);return(0,d.useMemo)(()=>{if(!Ce)return{isLoading:!1,component:null};const Oe=`capabilities/${ue}`,we=Ce.extensions[Oe],ke=Array.isArray(we)?we[0]:null;return ke&&(0,hr.yS)(ke.config)?{isLoading:!1,component:(0,hr.nv)(ke.pluginId,ke.config.component)}:{isLoading:!1,component:null}},[ue,Ce])}}function Sy(F){const _=F.asObservable(),Q={id:"",extensions:{}};return function(Ce){const Oe=(0,jc.A)(_);if(!Oe)return{extensions:[],isLoading:!1};Oe.id!==Q.id&&(Q.id=Oe.id,Q.extensions={});const we=`${Ce.extensionPointId}-${Ce.limitPerPlugin}`;if(Q.extensions[we]&&Q.extensions[we].context===Ce.context)return{extensions:Q.extensions[we].extensions,isLoading:!1};const{extensions:ke}=em({...Ce,registry:Oe});return Q.extensions[we]={context:Ce.context,extensions:ke},{extensions:ke,isLoading:!1}}}var sm=e(15162);async function am(F=[],_,Q="frontend_plugins_preload"){(0,nc.j)(Q);const ue=F.filter(Oe=>Oe.preload).map(Oe=>Oy(Oe)),Ce=await Promise.all(ue);for(const Oe of Ce)_.register(Oe);(0,nc.z)(Q)}async function Oy(F){const{path:_,version:Q,id:ue}=F;try{(0,nc.j)(`frontend_plugin_preload_${ue}`);const{plugin:Ce}=await Id.j4({path:_,version:Q,isAngular:F.angular.detected,pluginId:ue}),{extensionConfigs:Oe=[]}=Ce;return(0,Dc.x)(ue),{pluginId:ue,extensionConfigs:Oe}}catch(Ce){return console.error(`[Plugins] Failed to preload plugin: ${_} (version: ${Q})`,Ce),{pluginId:ue,extensionConfigs:[],error:Ce}}finally{(0,nc.z)(`frontend_plugin_preload_${ue}`)}}var Iy=e(57532),rm=e(41987),om=e(65879),Ay=e(80924),Ry=e(72955),ap=e(39374);class Ly{constructor(){this.subject=new tm.m(1)}get(){return this.subject.asObservable()}run(_){const{queries:Q,timezone:ue,datasource:Ce,panelId:Oe,app:we,dashboardUID:ke,timeRange:Ze,timeInfo:dt,cacheTimeout:mt,queryCachingTTL:Ct,maxDataPoints:Kt,scopedVars:Bt,minInterval:Mt}=_;this.subscription&&this.subscription.unsubscribe();const Wt={app:we??rm.Jk.Unknown,requestId:(0,Ay.S)(),timezone:ue,panelId:Oe,dashboardUID:ke,range:Ze,timeInfo:dt,interval:"",intervalMs:0,targets:(0,m.cloneDeep)(Q),maxDataPoints:Kt,scopedVars:Bt||{},cacheTimeout:mt,queryCachingTTL:Ct,startTime:Date.now()};Wt.rangeRaw=Ze.raw,(0,vr.H)(jy(Ce,Wt.scopedVars)).pipe((0,Iy.$)()).subscribe({next:vn=>{Wt.targets=Wt.targets.map(bs=>(bs.datasource||(bs.datasource=vn.getRef()),bs));const ns=Mt?(0,Be.w)().replace(Mt,Wt.scopedVars):vn.interval,Ks=om.calculateInterval(Ze,Kt,ns);Wt.scopedVars=Object.assign({},Wt.scopedVars,{__interval:{text:Ks.interval,value:Ks.interval},__interval_ms:{text:Ks.intervalMs.toString(),value:Ks.intervalMs}}),Wt.interval=Ks.interval,Wt.intervalMs=Ks.intervalMs,this.subscription=(0,ap.BN)(vn,Wt).subscribe({next:bs=>{const Hs=(0,Ko.N$)(bs,this.lastResult);this.lastResult=(0,Ry.B)(Hs,this.lastResult),this.subject.next(this.lastResult)}})},error:vn=>console.error("PanelQueryRunner Error",vn)})}cancel(){this.subscription&&(this.subscription.unsubscribe(),this.lastResult&&this.lastResult.state===wr.Gu.Loading&&this.subject.next({...this.lastResult,state:wr.Gu.Done}))}destroy(){this.subject&&this.subject.complete(),this.subscription&&this.subscription.unsubscribe()}}async function jy(F,_){return F&&"query"in F?F:(0,c.tR)().get(F,_)}function By(){window.grafanaRuntime={getDashboardSaveModel:()=>{const F=(0,h.UA)().getCurrent();if(F)return F.getSaveModelCloneOld()},getDashboardTimeRange:()=>{const F=(0,vi.jG)().timeRange();return{from:F.from.valueOf(),to:F.to.valueOf(),raw:F.raw}},getPanelData:()=>{const F=(0,h.UA)().getCurrent();if(F)return F.panels.reduce((_,Q)=>(_[Q.id]=Q.getQueryRunner().getLastResult(),_),{})}}}var Uy=e(16757),Jc=e(20601),zs=e(75096),im=e(22391),Ny=e(27803),Wi=e(3843);function lm(F){return F.extended&&"infoText"in F.extended?F.extended:null}function cm(F){return F.extended&&"dataSourceTypes"in F.extended?F.extended:null}function rp(F){return F.extended&&"dataSource"in F.extended?F.extended:null}var ka=e(87421),Xc=e(26260);const wy=(F,_)=>{const{rootStateKey:Q}=_.variable;if(!Q)return console.error("AdHocVariableEditor: variable has no rootStateKey"),{extended:lm(Wi.nS)};const{editor:ue}=(0,ka.nx)(Q,F);return{extended:lm(ue)}},Wy={changeVariableDatasource:Xc.Iv},Fy=(0,co.connect)(wy,Wy);class Ky extends d.PureComponent{constructor(){super(...arguments),this.onDatasourceChanged=_=>{this.props.changeVariableDatasource((0,zs.jX)(this.props.variable),(0,im.p$)(_))}}componentDidMount(){const{rootStateKey:_}=this.props.variable;if(!_){console.error("AdHocVariableEditor: variable has no rootStateKey");return}}render(){const{variable:_,extended:Q}=this.props;return(0,j.jsx)(Ny.Q,{datasource:_.datasource??void 0,onDataSourceChange:this.onDatasourceChanged,infoText:Q?.infoText})}}const $y=Fy(Ky);var dm=e(38401),op=e(83684);const um=90,hm=({datasource:F,onChange:_,disabled:Q,filterKey:ue,allFilters:Ce})=>{const Oe=()=>fm(F,ue,Ce),we=()=>zy(F,ue,Ce);return ue===null?(0,j.jsx)("div",{className:"gf-form","data-testid":"AdHocFilterKey-add-key-wrapper",children:(0,j.jsx)(op.s,{disabled:Q,className:"query-segment-key",Component:_y,value:ue,onChange:_,loadOptions:Oe,inputMinWidth:um})}):(0,j.jsx)("div",{className:"gf-form","data-testid":"AdHocFilterKey-key-wrapper",children:(0,j.jsx)(op.s,{disabled:Q,className:"query-segment-key",value:ue,onChange:_,loadOptions:we,inputMinWidth:um})})},Mu="-- remove filter --",Vy={label:Mu,value:Mu},_y=(0,j.jsx)("span",{className:"gf-form-label query-part","aria-label":"Add Filter",children:(0,j.jsx)(Ys.I,{name:"plus"})}),fm=async(F,_,Q)=>{const ue=await(0,c.tR)().get(F);if(!ue||!ue.getTagKeys)return[];const Ce=Q.filter(ke=>ke.key!==_),Oe=await ue.getTagKeys({filters:Ce});return(Array.isArray(Oe)?Oe:Oe.data).map(ke=>({label:ke.text,value:ke.text}))},zy=async(F,_,Q)=>{const ue=await fm(F,_,Q);return[Vy,...ue]},Hy=({datasource:F,disabled:_,onChange:Q,filterKey:ue,filterValue:Ce,placeHolder:Oe,allFilters:we})=>{const ke=(0,Dt.of)(Gy),Ze=()=>ky(F,ue,we);return(0,j.jsx)("div",{className:"gf-form","data-testid":"AdHocFilterValue-value-wrapper",children:(0,j.jsx)(op.s,{className:ke.segment,disabled:_,placeholder:Oe,value:Ce,onChange:Q,loadOptions:Ze})})},ky=async(F,_,Q)=>{const ue=await(0,c.tR)().get(F);if(!ue||!ue.getTagValues)return[];const Ce=(0,vi.jG)().timeRange(),Oe=Q.filter(Ze=>Ze.key!==_),we=await ue.getTagValues({key:_,filters:Oe,timeRange:Ce});return(Array.isArray(we)?we:we.data).map(Ze=>({label:Ze.text,value:Ze.text}))};function Gy(){return{segment:(0,Ye.css)({display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"500px"})}}const Qy=["=","!=","<",">","=~","!~"].map(F=>({label:F,value:F})),Yy=({value:F,disabled:_,onChange:Q})=>(0,j.jsx)(dm.Y,{className:"query-segment-operator",value:F,disabled:_,options:Qy,onChange:Q}),gm=({datasource:F,filter:{key:_,operator:Q,value:ue},onKeyChange:Ce,onOperatorChange:Oe,onValueChange:we,placeHolder:ke,allFilters:Ze,disabled:dt})=>(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(hm,{disabled:dt,datasource:F,filterKey:_,onChange:Ce,allFilters:Ze}),(0,j.jsx)("div",{className:"gf-form",children:(0,j.jsx)(Yy,{disabled:dt,value:Q,onChange:Oe})}),(0,j.jsx)(Hy,{disabled:dt,datasource:F,filterKey:_,filterValue:ue,allFilters:Ze,onChange:we,placeHolder:ke})]}),Jy=({datasource:F,appendBefore:_,onCompleted:Q,allFilters:ue})=>{const[Ce,Oe]=(0,d.useState)(null),[we,ke]=(0,d.useState)("="),Ze=(0,d.useCallback)(Ct=>{if(Ct.value!==Mu){Oe(Ct.value??"");return}Oe(null)},[Oe]),dt=(0,d.useCallback)(Ct=>ke(Ct.value??""),[ke]),mt=(0,d.useCallback)(Ct=>{Q({value:Ct.value??"",operator:we,key:Ce}),Oe(null),ke("=")},[Q,we,Ce]);return Ce===null?(0,j.jsx)(hm,{datasource:F,filterKey:Ce,onChange:Ze,allFilters:ue}):(0,j.jsxs)(d.Fragment,{children:[_,(0,j.jsx)(gm,{datasource:F,filter:{key:Ce,value:"",operator:we},placeHolder:(0,ya.t)("variable.adhoc.placeholder","Select value"),onKeyChange:Ze,onOperatorChange:dt,onValueChange:mt,allFilters:ue})]},"filter-builder")},pm=({label:F})=>(0,j.jsx)("div",{className:"gf-form",children:(0,j.jsx)("span",{className:"gf-form-label query-keyword",children:F})});class Xy extends d.PureComponent{constructor(){super(...arguments),this.onChange=(_,Q)=>ue=>{const{filters:Ce}=this.props,{value:Oe}=ue;return ue.value===Mu?this.props.removeFilter(_):this.props.changeFilter(_,{...Ce[_],[Q]:Oe})},this.appendFilterToVariable=_=>{this.props.addFilter(_)}}render(){const{filters:_,disabled:Q}=this.props;return(0,j.jsxs)("div",{className:"gf-form-inline",children:[this.renderFilters(_,Q),!Q&&(0,j.jsx)(Jy,{datasource:this.props.datasource,appendBefore:_.length>0?(0,j.jsx)(pm,{label:"AND"}):null,onCompleted:this.appendFilterToVariable,allFilters:this.getAllFilters()})]})}getAllFilters(){return this.props.baseFilters?this.props.baseFilters.concat(this.props.filters):this.props.filters}renderFilters(_,Q){return _.length===0&&Q?(0,j.jsx)(dm.Y,{disabled:Q,value:"No filters",options:[],onChange:()=>{}}):_.reduce((ue,Ce,Oe)=>(ue.length>0&&ue.push((0,j.jsx)(pm,{label:"AND"},`condition-${Oe}`)),ue.push(this.renderFilterSegments(Ce,Oe,Q)),ue),[])}renderFilterSegments(_,Q,ue){return(0,j.jsx)(d.Fragment,{children:(0,j.jsx)(gm,{disabled:ue,datasource:this.props.datasource,filter:_,onKeyChange:this.onChange(Q,"key"),onOperatorChange:this.onChange(Q,"operator"),onValueChange:this.onChange(Q,"value"),allFilters:this.getAllFilters()})},`filter-${Q}`)}}const Zy={addFilter:Xc.U2,removeFilter:Xc.VT,changeFilter:Xc.$u},qy=(0,co.connect)(null,Zy);class ex extends d.PureComponent{constructor(){super(...arguments),this.addFilter=_=>{this.props.addFilter((0,zs.jX)(this.props.variable),_)},this.removeFilter=_=>{this.props.removeFilter((0,zs.jX)(this.props.variable),_)},this.changeFilter=(_,Q)=>{this.props.changeFilter((0,zs.jX)(this.props.variable),{index:_,filter:Q})}}render(){const{filters:_,datasource:Q,baseFilters:ue}=this.props.variable;return(0,j.jsx)(Xy,{datasource:Q,filters:_,baseFilters:ue,disabled:this.props.readOnly,addFilter:this.addFilter,removeFilter:this.removeFilter,changeFilter:this.changeFilter})}}const mm=qy(ex);mm.displayName="AdHocPicker";var vm=e(53699);const tx=F=>F.map(_=>rx(_).map(sx).join("|")),nx=F=>{if((0,m.isArray)(F))return F.map(ym).filter(ox);const _=ym(F);return _===null?[]:[_]};function sx(F){return F==null?"":/\|/g[Symbol.replace](F,"__gfp__")}function ax(F){return F==null?"":/__gfp__/g[Symbol.replace](F,"|")}function rx(F){return[F.key,F.operator,F.value]}function ym(F){if(!(0,m.isString)(F)||F.length===0)return null;const _=F.split("|").map(ax);return{key:_[0],operator:_[1],value:_[2]}}function ox(F){return F!==null&&(0,m.isString)(F.value)}const xm=async()=>{},ix=()=>({id:"adhoc",description:"Add key/value filters on the fly.",name:"Ad hoc filters",initialState:vm.MK,reducer:vm.AA,picker:mm,editor:$y,dependsOn:()=>!1,setValue:xm,setValueFromUrl:async(F,_)=>{const Q=nx(_);await(0,tr.JD)((0,Xc.D4)((0,zs.jX)(F),Q))},updateOptions:xm,getSaveModel:F=>{const{index:_,id:Q,state:ue,global:Ce,rootStateKey:Oe,...we}=(0,m.cloneDeep)(F);return we},getValueForUrl:F=>{const _=F?.filters??[];return tx(_)}});var Su=e(14644),lx=e(8866),to=e(13344),Xr=e(24240),Em=e(13288),cx=e(44240),Ou=e(16126),dx=e(38975),ux=e(67791),hx=e(66847),fx=e(69850),Ur=e(72401),nr=e(48594),jl=e(12470),Zc=e(83370),sc=e(80484);const gx={...sc.Vg,type:"query",datasource:null,query:"",regex:"",sort:jl.ZG.disabled,refresh:jl.CO.onDashboardLoad,multi:!1,includeAll:!1,allValue:null,options:[],current:{},definition:""},px=(F,_)=>{if(_===jl.ZG.disabled)return F;const Q=Math.ceil(_/2),ue=_%2===0;return Q===1?F=(0,m.sortBy)(F,"text"):Q===2?F=(0,m.sortBy)(F,Ce=>{if(!Ce.text)return-1;const Oe=Ce.text.match(/.*?(\d+).*/);return!Oe||Oe.length<2?-1:parseInt(Oe[1],10)}):Q===3?F=(0,m.sortBy)(F,Ce=>(0,m.toLower)(Ce.text)):Q===4&&F.sort((Ce,Oe)=>Ce.text?Oe.text?Ce.text.localeCompare(Oe.text,void 0,{numeric:!0}):1:-1),ue&&(F=F.reverse()),F},mx=(F,_)=>{const Q=[];let ue=null;_.lastIndex=0;do ue=_.exec(F),ue&&Q.push(ue);while(_.global&&ue&&ue[0]!==""&&ue[0]!==void 0);return Q},vx=(F,_,Q)=>{let ue,Ce=[];F&&(ue=(0,$r.dO)(F));for(let Oe=0;Oe<Q.length;Oe++){const we=Q[Oe];let ke=we.text===void 0||we.text===null?we.value:we.text,Ze=we.value===void 0||we.value===null?we.text:we.value;if((0,m.isNumber)(Ze)&&(Ze=Ze.toString()),(0,m.isNumber)(ke)&&(ke=ke.toString()),ue){const dt=mx(Ze,ue);if(!dt.length)continue;const mt=dt.find(Mt=>Mt.groups&&Mt.groups.value),Ct=dt.find(Mt=>Mt.groups&&Mt.groups.text),Kt=dt.find(Mt=>Mt.length>1),Bt=dt.length>1&&Kt;if(mt||Ct)Ze=mt?.groups?.value??Ct?.groups?.text,ke=Ct?.groups?.text??mt?.groups?.value;else if(Bt){for(let Mt=0;Mt<dt.length;Mt++){const Wt=dt[Mt];Ce.push({text:Wt[1],value:Wt[1],selected:!1})}continue}else Kt&&(ke=Kt[1],Ze=Kt[1])}Ce.push({text:ke,value:Ze,selected:!1})}return Ce=(0,m.uniqBy)(Ce,"value"),px(Ce,_)},Dm=(0,zo.Z0)({name:"templating/query",initialState:Zc.j,reducers:{updateVariableOptions:(F,_)=>{const{results:Q,templatedRegex:ue}=_.payload.data,Ce=(0,ka.Fs)(F,_.payload.id);if(Ce.type!=="query")return;const{includeAll:Oe,sort:we}=Ce,ke=vx(ue,we,Q);Oe&&ke.unshift({text:to.Zm,value:to.To,selected:!1}),ke.length||ke.push({text:to.ou,value:to.Ek,isNone:!0,selected:!1}),Ce.options=ke}}}),yx=Dm.reducer,{updateVariableOptions:xx}=Dm.actions;function Ex(){return F=>F.pipe((0,Rt.T)(Dx))}function Dx(F){const _=F.series;if(!_||!_.length)return[];if(Cx(_))return _;const Q=(0,Ko.Bt)(_),ue=[];let Ce=-1,Oe=-1,we=-1,ke=-1;for(const Ze of Q)for(let dt=0;dt<Ze.fields.length;dt++){const mt=Ze.fields[dt],Ct=(0,z.Ct)(mt,Ze,_).toLowerCase();mt.type===q.PU.string&&we===-1&&(we=dt),Ct==="text"&&mt.type===q.PU.string&&Oe===-1&&(Oe=dt),Ct==="value"&&mt.type===q.PU.string&&Ce===-1&&(Ce=dt),Ct==="expandable"&&(mt.type===q.PU.boolean||mt.type===q.PU.number)&&ke===-1&&(ke=dt)}if(we===-1)throw new Error("Couldn't find any field of type string in the results.");for(const Ze of Q)for(let dt=0;dt<Ze.length;dt++){const mt=ke!==-1?Ze.fields[ke].values[dt]:void 0,Ct=Ze.fields[we].values[dt],Kt=Oe!==-1?Ze.fields[Oe].values[dt]:null,Bt=Ce!==-1?Ze.fields[Ce].values[dt]:null;if(Ce===-1&&Oe===-1){ue.push({text:Ct,value:Ct,expandable:mt});continue}if(Ce===-1&&Oe!==-1){ue.push({text:Kt,value:Kt,expandable:mt});continue}if(Ce!==-1&&Oe===-1){ue.push({text:Bt,value:Bt,expandable:mt});continue}ue.push({text:Kt,value:Bt,expandable:mt})}return ue}function Px(F){return _=>_.pipe((0,Rt.T)(Q=>{const{variable:ue,dispatch:Ce,getTemplatedRegexFunc:Oe}=F;if(!ue.rootStateKey){console.error("updateOptionsState: variable.rootStateKey is not defined");return}const we=Oe(ue),ke=(0,zs.qD)(ue,{results:Q,templatedRegex:we});Ce((0,nr.kb)(ue.rootStateKey,xx(ke)))}))}function bx(F){return _=>_.pipe((0,Eo.Z)(()=>{const{dispatch:Q,variable:ue,searchFilter:Ce}=F;return Ce?(0,kn.of)():(0,vr.H)(Q((0,Ur.kl)((0,zs.jX)(ue))))}))}function Cx(F){if(!F)return!1;if(!F.length)return!0;const _=F[0];if((0,Ko.ci)(_))return!1;for(const Q in _){if(!_.hasOwnProperty(Q)||_[Q]!==null&&typeof _[Q]!="string"&&typeof _[Q]!="number")continue;const ue=Q.toLowerCase();if(ue==="text"||ue==="value")return!0}return!1}var Iu=e(29505),Tx=e(43127);class Mx{constructor(){this.runners=[new Sx,new Ox,new Ix,new Rx]}getRunnerForDatasource(_){const Q=this.runners.find(ue=>ue.canRun(_));if(Q)return Q;throw new Error("Couldn't find a query runner that matches supplied arguments.")}isQueryRunnerAvailableForDatasource(_){return this.runners.some(Q=>Q.canRun(_))}}class Sx{constructor(){this.type=Iu.Qz.Legacy}canRun(_){return(0,Xr.d5)(_)}getTarget({datasource:_,variable:Q}){if((0,Xr.d5)(_))return Q.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:_,variable:Q,searchFilter:ue,timeSrv:Ce},Oe){if(!(0,Xr.d5)(_))return qc();const we=(0,zs.iP)(Q,ue,Ce,Oe.scopedVars);return(0,vr.H)(_.metricFindQuery(Q.query,we)).pipe((0,Eo.Z)(ke=>{if(!ke||!ke.length)return qc();const Ze=ke;return(0,kn.of)({series:Ze,state:wr.Gu.Done,timeRange:we.range})}))}}class Ox{constructor(){this.type=Iu.Qz.Standard}canRun(_){return(0,Xr.Hf)(_)}getTarget({datasource:_,variable:Q}){if((0,Xr.Hf)(_))return _.variables.toDataQuery(Q.query);throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:_,runRequest:Q},ue){return(0,Xr.Hf)(_)?_.variables.query?Q(_,ue,_.variables.query.bind(_.variables)):Q(_,ue):qc()}}class Ix{constructor(){this.type=Iu.Qz.Custom}canRun(_){return(0,Xr.zs)(_)}getTarget({datasource:_,variable:Q}){if((0,Xr.zs)(_))return Q.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:_,runRequest:Q},ue){return(0,Xr.zs)(_)?Q(_,ue,_.variables.query.bind(_.variables)):qc()}}const Ax="variable-query";class Rx{constructor(){this.type=Iu.Qz.Datasource}canRun(_){return(0,Xr.X3)(_)}getTarget({datasource:_,variable:Q}){if((0,Xr.X3)(_))return{...Q.query,refId:Q.query.refId??Ax};throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:_,runRequest:Q},ue){return(0,Xr.X3)(_)?Q(_,ue):qc()}}function qc(){return(0,kn.of)({state:wr.Gu.Done,series:[],timeRange:(0,Tx.E2)()})}class Lx{constructor(_={dispatch:tr.JD,getState:tr.Gu,getVariable:ka.dn,getTemplatedRegex:zs.u7,getTimeSrv:vi.jG,queryRunners:new Mx,runRequest:ap.BN}){this.dependencies=_,this.updateOptionsRequests=new Tu.B,this.updateOptionsResults=new Tu.B,this.cancelRequests=new Tu.B,this.onNewRequest=this.onNewRequest.bind(this),this.subscription=this.updateOptionsRequests.subscribe(this.onNewRequest)}queueRequest(_){this.updateOptionsRequests.next(_)}getResponse(_){return this.updateOptionsResults.asObservable().pipe((0,Ou.p)(Q=>Q.identifier===_))}cancelRequest(_){this.cancelRequests.next({identifier:_})}destroy(){this.subscription.unsubscribe()}onNewRequest(_){const{datasource:Q,identifier:ue,searchFilter:Ce}=_;try{const{dispatch:Oe,runRequest:we,getTemplatedRegex:ke,getVariable:Ze,queryRunners:dt,getTimeSrv:mt,getState:Ct}=this.dependencies,Kt=(0,ka.y7)(Ct());this.updateOptionsResults.next({identifier:ue,state:wr.Gu.Loading});const Bt=Ze(ue,Ct());if(Bt.type!=="query")return;const Mt=mt(),Wt={variable:Bt,datasource:Q,searchFilter:Ce,timeSrv:Mt,runRequest:we};if(!dt.isQueryRunnerAvailableForDatasource(Q)){const bs=new Error("Query Runner is not available for datasource.");this.updateOptionsResults.next({identifier:ue,state:wr.Gu.Error,error:bs});return}const vn=dt.getRunnerForDatasource(Q),ns=vn.getTarget({datasource:Q,variable:Bt}),Ks=this.getRequest(Bt,_,ns);vn.runRequest(Wt,Ks).pipe((0,Ou.p)(()=>{const bs=(0,ka.y7)(Ct());return Kt===bs}),(0,Ou.p)(bs=>bs.state===wr.Gu.Done||bs.state===wr.Gu.Error),(0,dx.s)(1),(0,Eo.Z)(bs=>bs.state===wr.Gu.Error?(0,Em.$)(()=>bs.error):(0,kn.of)(bs)),Ex(),Px({variable:Bt,dispatch:Oe,getTemplatedRegexFunc:ke}),bx({variable:Bt,dispatch:Oe,searchFilter:Ce}),(0,ux.Q)((0,cx.h)(this.updateOptionsRequests,this.cancelRequests).pipe((0,Ou.p)(bs=>{let Hs=!1;return bs.identifier.id===ue.id&&(Hs=!0,this.updateOptionsResults.next({identifier:ue,state:wr.Gu.Loading,cancelled:Hs})),Hs}))),(0,hx.W)(bs=>bs.cancelled?(0,kn.of)({}):(this.updateOptionsResults.next({identifier:ue,state:wr.Gu.Error,error:bs}),(0,Em.$)(()=>bs))),(0,fx.j)(()=>{this.updateOptionsResults.next({identifier:ue,state:wr.Gu.Done})})).subscribe()}catch(Oe){this.updateOptionsResults.next({identifier:ue,state:wr.Gu.Error,error:Oe})}}getRequest(_,Q,ue){const{searchFilter:Ce}=Q,Oe={variable:{text:_.current.text,value:_.current.value}},Ze={...Ce?{searchFilter:{text:Ce,value:Ce}}:{},...Oe},dt=this.dependencies.getTimeSrv().timeRange();return{app:rm.Jk.Dashboard,requestId:(0,nm.A)(),timezone:"",range:dt,interval:"",intervalMs:0,targets:[ue],scopedVars:Ze,startTime:Date.now()}}}let Pm;function jx(F){Pm=F}function ip(){return Pm}const Bx=F=>{if(!Ux(F))return F.name;const{current:_}=F;return Array.isArray(_.text)?_.text.join(" + "):_.text},Ux=F=>Array.isArray(F?.options)||typeof F?.current=="object";var el=(F=>(F[F.moveUp=38]="moveUp",F[F.moveDown=40]="moveDown",F[F.select=32]="select",F[F.cancel=27]="cancel",F[F.selectAndClose=13]="selectAndClose",F))(el||{});class Nx extends d.PureComponent{constructor(){super(...arguments),this.onKeyDown=_=>{if(el[_.keyCode]&&_.keyCode!==el.select){const Q=_.ctrlKey||_.metaKey||_.shiftKey;this.props.onNavigate(_.keyCode,Q),_.preventDefault()}},this.onChange=_=>{this.props.onChange(_.target.value)}}render(){const{value:_,id:Q,onNavigate:ue,...Ce}=this.props;return(0,j.jsx)("input",{...Ce,ref:Oe=>{Oe&&(Oe.focus(),Oe.setAttribute("style",`width:${Math.max(Oe.width,150)}px`))},id:Q,type:"text",className:"gf-form-input",value:_??"",onChange:this.onChange,onKeyDown:this.onKeyDown,placeholder:(0,ya.t)("variable.dropdown.placeholder","Enter variable value")})}}var wx=e(89963);const Wx=({loading:F,disabled:_,onClick:Q,text:ue,onCancel:Ce,id:Oe})=>{const we=(0,Dt.of)(Cm),ke=(0,d.useCallback)(Ze=>{Ze.stopPropagation(),Ze.preventDefault(),Q()},[Q]);return F?(0,j.jsxs)("div",{className:we.container,"data-testid":sr.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${ue}`),title:ue,id:Oe,children:[(0,j.jsx)(bm,{text:ue}),(0,j.jsx)(wx.I,{loading:!0,onCancel:Ce})]}):(0,j.jsxs)("button",{onClick:ke,className:we.container,"data-testid":sr.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${ue}`),"aria-expanded":!1,"aria-controls":`options-${Oe}`,id:Oe,title:ue,disabled:_,children:[(0,j.jsx)(bm,{text:ue}),(0,j.jsx)(Ys.I,{"aria-hidden":!0,name:"angle-down",size:"sm"})]})},bm=({text:F})=>{const _=(0,Dt.of)(Cm);return(0,j.jsx)("span",{className:_.textAndTags,children:F===to.Zm?(0,ya.t)("variable.picker.link-all","All"):F})},Cm=F=>{const _=(0,dc.$)(F);return{container:(0,Ye.css)({maxWidth:"500px",paddingRight:"10px",padding:F.spacing(0,1),backgroundColor:F.components.input.background,border:`1px solid ${F.components.input.borderColor}`,borderRadius:F.shape.radius.default,display:"flex",alignItems:"center",color:F.colors.text.primary,height:F.spacing(F.components.height.md),[`.${_.badge}`]:{margin:"0 5px"},"&:disabled":{backgroundColor:F.colors.action.disabledBackground,color:F.colors.action.disabledText,border:`1px solid ${F.colors.action.disabledBackground}`}}),textAndTags:(0,Ye.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginRight:F.spacing(.25),userSelect:"none"})}};class Fx extends d.PureComponent{constructor(){super(...arguments),this.onToggle=_=>Q=>{const ue=Q.shiftKey||Q.ctrlKey||Q.metaKey;this.handleEvent(Q),this.props.onToggle(_,ue)},this.onToggleAll=_=>{this.handleEvent(_),this.props.onToggleAll()}}handleEvent(_){_.preventDefault(),_.stopPropagation()}render(){const{multi:_,values:Q,highlightIndex:ue,selectedValues:Ce,onToggle:Oe,onToggleAll:we,theme:ke,...Ze}=this.props,dt=lp(ke);return(0,j.jsx)("div",{className:dt.variableValueDropdown,children:(0,j.jsx)("div",{className:dt.variableOptionsWrapper,children:(0,j.jsxs)("ul",{className:dt.variableOptionsColumn,"aria-label":sr.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownDropDown,...Ze,children:[this.renderMultiToggle(),Q.map((mt,Ct)=>this.renderOption(mt,Ct))]})})})}renderOption(_,Q){const{highlightIndex:ue,multi:Ce,theme:Oe}=this.props,we=lp(Oe),ke=_.value===to.To;return(0,j.jsx)("li",{children:(0,j.jsxs)("button",{"data-testid":sr.Tp.components.Variables.variableOption,role:"checkbox",type:"button","aria-checked":_.selected,className:(0,Ye.cx)((0,me.my)(Oe),we.variableOption,{[we.highlighted]:Q===ue,[we.variableAllOption]:ke},we.noStyledButton),onClick:this.onToggle(_),children:[(0,j.jsx)("span",{className:(0,Ye.cx)(we.variableOptionIcon,{[we.variableOptionIconSelected]:_.selected,[we.hideVariableOptionIcon]:!Ce})}),(0,j.jsx)("span",{"data-testid":sr.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownOptionTexts(`${_.text}`),children:ke?(0,ya.t)("variable.picker.option-all","All"):_.text})]})},`${_.value}`)}renderMultiToggle(){const{multi:_,selectedValues:Q,theme:ue,values:Ce}=this.props,Oe=lp(ue),we=Ce.some(Ze=>Ze.value===to.To);if(!_)return null;const ke=()=>(0,j.jsx)(ya.x6,{i18nKey:"variable.picker.option-tooltip",children:"Clear selections"});return(0,j.jsx)(fi.m,{content:ke,placement:"top",children:(0,j.jsxs)("button",{className:(0,Ye.cx)((0,me.my)(ue),Oe.variableOption,Oe.variableOptionColumnHeader,Oe.noStyledButton,{[Oe.noPaddingBotton]:we}),role:"checkbox","aria-checked":Q.length>1?"mixed":"false",onClick:this.onToggleAll,"aria-label":"Toggle all values","data-placement":"top",children:[(0,j.jsx)("span",{className:(0,Ye.cx)(Oe.variableOptionIcon,{[Oe.variableOptionIconManySelected]:Q.length>1})}),(0,j.jsx)(ya.x6,{i18nKey:"variable.picker.option-selected-values",children:"Selected"})," (",Q.length,")"]})})}}const lp=(0,Fl.N)(F=>{const _=F.isDark?"public/img/checkbox.png":"public/img/checkbox_white.png";return{hideVariableOptionIcon:(0,Ye.css)({display:"none"}),highlighted:(0,Ye.css)({backgroundColor:F.colors.action.hover}),noStyledButton:(0,Ye.css)({width:"100%",textAlign:"left"}),variableOption:(0,Ye.css)({display:"block",padding:"2px 27px 0 8px",position:"relative",whiteSpace:"nowrap",minWidth:"115px","&:hover":{backgroundColor:F.colors.action.hover}}),variableOptionColumnHeader:(0,Ye.css)({paddingTop:"5px",paddingBottom:"5px",marginBottom:"5px"}),variableOptionIcon:(0,Ye.css)({display:"inline-block",width:"24px",height:"18px",position:"relative",top:"4px",background:`url(${_}) left top no-repeat`}),variableOptionIconManySelected:(0,Ye.css)({background:`url(${_}) 0px -36px no-repeat`}),variableOptionIconSelected:(0,Ye.css)({background:`url(${_}) 0px -18px no-repeat`}),variableValueDropdown:(0,Ye.css)({backgroundColor:F.colors.background.primary,border:`1px solid ${F.colors.border.weak}`,borderRadius:F.shape.borderRadius(2),boxShadow:F.shadows.z2,position:"absolute",top:F.spacing(F.components.height.md),maxHeight:"400px",minHeight:"150px",minWidth:"150px",overflowY:"auto",overflowX:"hidden",zIndex:F.zIndex.typeahead}),variableOptionsColumn:(0,Ye.css)({maxHeight:"350px",display:"table-cell",lineHeight:"26px",listStyleType:"none"}),variableOptionsWrapper:(0,Ye.css)({display:"table",width:"100%"}),variableAllOption:(0,Ye.css)({borderBottom:`1px solid ${F.colors.border.weak}`,paddingBottom:F.spacing(1)}),noPaddingBotton:(0,Ye.css)({paddingBottom:0})}}),Kx=(0,Dt.cV)(Fx);var $x=e(92053),Tm=e(92041),tl=e(56968),si=e(24300);const Vx=(F,_,Q)=>async(ue,Ce)=>{if(_===el.cancel)return await ue(Au(F));if(_===el.select)return ue(cp(F,Q));if(_===el.selectAndClose)return(0,ka.nx)(F,Ce()).optionsPicker.multi?ue(cp(F,Q)):(ue(cp(F,Q,!0)),ue(Au(F)));if(_===el.moveDown)return ue((0,nr.kb)(F,(0,si.O$)(1)));if(_===el.moveUp)return ue((0,nr.kb)(F,(0,si.O$)(-1)))},_x=(F,_="")=>async(Q,ue)=>{const{rootStateKey:Ce}=F,{id:Oe,queryValue:we}=(0,ka.nx)(Ce,ue()).optionsPicker,ke={id:Oe,rootStateKey:Ce,type:"query"},Ze=(0,ka.dn)(ke,ue());if(!("options"in Ze)||(Q((0,nr.kb)(Ce,(0,si.S8)(_))),(0,m.trim)(we)===(0,m.trim)(_)))return;const{query:dt,options:mt}=Ze,Ct=typeof dt=="string"?dt:dt.target;return(0,$x.E)(Ct)?Gx(Q,ue,_,Ce):Q((0,nr.kb)(Ce,(0,si.fx)(mt)))},zx=async F=>{if((0,Tm.R)(F.current))return;await Jc.B.get(F.type).setValue(F,F.current,!0)},Au=(F,_)=>async(Q,ue)=>{const Ce=(0,ka.nx)(F,ue()).optionsPicker,Oe={id:Ce.id,rootStateKey:F,type:"query"},we=(0,ka.dn)(Oe,ue());if(!(0,Xr.SP)(we))return;const ke={option:Qx(Ce)},Ze={propName:"queryValue",propValue:Ce.queryValue};Q((0,nr.kb)(F,(0,tl.dE)((0,zs.qD)(we,ke)))),Q((0,nr.kb)(F,(0,tl.QP)((0,zs.qD)(we,Ze))));const dt=(0,ka.dn)(Oe,ue());if((0,Xr.SP)(dt)&&(Q((0,nr.kb)(F,(0,si.Fu)())),(0,zs.Lz)(we)!==(0,zs.Lz)(dt)))return _?_(dt):await zx(dt)},Hx=(F,_)=>async(Q,ue)=>{const{id:Ce,rootStateKey:Oe}=F,we=(0,ka.nx)(Oe,ue()).optionsPicker;we.id&&we.id!==Ce&&await Q(Au(Oe,_));const ke=(0,ka.dn)(F,ue());(0,Xr.SP)(ke)&&Q((0,nr.kb)(Oe,(0,si.MO)(ke)))},cp=(F,_,Q=!1)=>(ue,Ce)=>{const{highlightIndex:Oe,options:we}=(0,ka.nx)(F,Ce()).optionsPicker,ke=we[Oe];ue((0,nr.kb)(F,(0,si.U9)({option:ke,forceSelect:Q,clearOthers:_})))},kx=async(F,_,Q,ue)=>{try{const{id:Ce}=(0,ka.nx)(ue,_()).optionsPicker,Oe={id:Ce,rootStateKey:ue,type:"query"},we=(0,ka.dn)(Oe,_());if(!(0,Xr.SP)(we))return;await Jc.B.get(we.type).updateOptions(we,Q);const Ze=(0,ka.dn)(Oe,_());if(!(0,Xr.SP)(Ze))return;F((0,nr.kb)(ue,(0,si.qh)(Ze.options)))}catch(Ce){console.error(Ce)}},Gx=(0,m.debounce)(kx,500);function Qx(F){const{options:_,selectedValues:Q,queryValue:ue,multi:Ce}=F;if(_.length===0&&ue&&ue.length>0)return{text:ue,value:ue,selected:!1};if(!Ce)return Q.find(ke=>ke.selected);const Oe=[],we=[];for(const ke of Q)ke.selected&&(Oe.push(ke.text.toString()),we.push(ke.value.toString()));return{value:we,text:Oe,selected:!0}}const ed=()=>{const F=Oe=>({...(0,Su.bindActionCreators)({openOptions:Hx,commitChangesToVariable:Au,navigateOptions:Vx},Oe),filterOrSearchOptions:(we,ke="")=>{Oe(_x(we,ke))},toggleAllOptions:we=>Oe((0,nr.kb)(we.rootStateKey,(0,si.an)())),toggleOption:(we,ke,Ze,dt)=>Oe((0,nr.kb)(we.rootStateKey,(0,si.U9)({option:ke,clearOthers:Ze,forceSelect:dt})))}),_=(Oe,we)=>{const{rootStateKey:ke}=we.variable;return ke?{picker:(0,ka.nx)(ke,Oe).optionsPicker}:(console.error("OptionPickerFactory: variable has no rootStateKey"),{picker:si.$z})},Q=(0,co.connect)(_,F);class ue extends d.PureComponent{constructor(){super(...arguments),this.onShowOptions=()=>this.props.openOptions((0,zs.jX)(this.props.variable),this.props.onVariableChange),this.onHideOptions=()=>{if(!this.props.variable.rootStateKey){console.error("Variable has no rootStateKey");return}this.props.commitChangesToVariable(this.props.variable.rootStateKey,this.props.onVariableChange)},this.onToggleOption=(we,ke)=>{((0,Xr.iv)(this.props.variable)&&this.props.variable.multi?this.onToggleMultiValueVariable:this.onToggleSingleValueVariable)(we,ke)},this.onToggleSingleValueVariable=(we,ke)=>{this.props.toggleOption((0,zs.jX)(this.props.variable),we,ke,!1),this.onHideOptions()},this.onToggleMultiValueVariable=(we,ke)=>{this.props.toggleOption((0,zs.jX)(this.props.variable),we,ke,!1)},this.onToggleAllOptions=()=>{this.props.toggleAllOptions((0,zs.jX)(this.props.variable))},this.onFilterOrSearchOptions=we=>{this.props.filterOrSearchOptions((0,zs.jX)(this.props.variable),we)},this.onNavigate=(we,ke)=>{if(!this.props.variable.rootStateKey){console.error("Variable has no rootStateKey");return}this.props.navigateOptions(this.props.variable.rootStateKey,we,ke)},this.onCancel=()=>{ip().cancelRequest((0,zs.jX)(this.props.variable))}}render(){const{variable:we,picker:ke}=this.props,Ze=ke.id===we.id,dt=Yx();return(0,j.jsx)("div",{className:dt.variableLinkWrapper,"data-testid":sr.Tp.components.Variables.variableLinkWrapper,children:Ze?this.renderOptions(ke):this.renderLink(we)})}renderLink(we){const ke=Bx(we),Ze=we.state===wr.Gu.Loading;return(0,j.jsx)(Wx,{id:to.qz+we.id,text:ke,onClick:this.onShowOptions,loading:Ze,onCancel:this.onCancel,disabled:this.props.readOnly})}renderOptions(we){const{id:ke}=this.props.variable;return(0,j.jsxs)(lx.N,{onClick:this.onHideOptions,children:[(0,j.jsx)(Nx,{id:to.qz+ke,value:we.queryValue,onChange:this.onFilterOrSearchOptions,onNavigate:this.onNavigate,"aria-expanded":!0,"aria-controls":`options-${ke}`}),(0,j.jsx)(Kx,{values:we.options,onToggle:this.onToggleOption,onToggleAll:this.onToggleAllOptions,highlightIndex:we.highlightIndex,multi:we.multi,selectedValues:we.selectedValues,id:`options-${ke}`})]})}}const Ce=Q(ue);return Ce.displayName="OptionsPicker",Ce},Yx=()=>({variableLinkWrapper:(0,Ye.css)({display:"inline-block",position:"relative"})});var Jx=e(95802);class Xx extends d.PureComponent{constructor(){super(...arguments),this.onChange=_=>{this.props.onPropChange({propName:"query",propValue:_.currentTarget.value,updateOptions:!0})}}render(){return(0,j.jsx)(Jx.d,{constantValue:this.props.variable.query,onChange:this.onChange})}}const Zx={...sc.Vg,type:"constant",hide:jl.zL.hideVariable,query:"",current:{},options:[]},Mm=(0,zo.Z0)({name:"templating/constant",initialState:Zc.j,reducers:{createConstantOptionsFromQuery:(F,_)=>{const Q=(0,ka.Fs)(F,_.payload.id);Q.type==="constant"&&(Q.options=[{text:Q.query.trim(),value:Q.query.trim(),selected:!1}])}}}),qx=Mm.reducer,{createConstantOptionsFromQuery:eE}=Mm.actions,tE=F=>async _=>{const{rootStateKey:Q}=F;await _((0,nr.kb)(Q,eE((0,zs.qD)(F)))),await _((0,Ur.kl)(F))},nE=()=>({id:"constant",description:"Define a hidden constant variable, useful for metric prefixes in dashboards you want to share.",name:"Constant",initialState:Zx,reducer:qx,picker:ed(),editor:Xx,dependsOn:()=>!1,setValue:async(F,_,Q=!1)=>{await(0,tr.JD)((0,Ur.t9)((0,zs.jX)(F),_,Q))},setValueFromUrl:async(F,_)=>{await(0,tr.JD)((0,Ur.x7)((0,zs.jX)(F),_))},updateOptions:async F=>{await(0,tr.JD)(tE((0,zs.jX)(F)))},getSaveModel:F=>{const{index:_,id:Q,state:ue,global:Ce,current:Oe,options:we,rootStateKey:ke,...Ze}=(0,m.cloneDeep)(F);return Ze},getValueForUrl:F=>F.current.value,beforeAdding:F=>{const{current:_,options:Q,query:ue,...Ce}=(0,m.cloneDeep)(F),Oe={selected:!0,text:ue,value:ue};return{...Ce,current:Oe,options:[Oe],query:ue}}});function sE(F,..._){const Q=(0,co.connect)(..._)(F);return ue=>(0,j.jsx)(Q,{...ue,store:tr.M_})}function eP(F,..._){const Q=connect(..._)(F);return ue=>jsx(Provider,{store,children:jsx(Q,{...ue,store})})}var aE=e(58711);class rE extends d.PureComponent{constructor(){super(...arguments),this.onSelectionOptionsChange=async({propName:_,propValue:Q})=>{this.props.onPropChange({propName:_,propValue:Q,updateOptions:!0})},this.onQueryChange=_=>{this.props.onPropChange({propName:"query",propValue:_.currentTarget.value,updateOptions:!0})}}render(){return(0,j.jsx)(aE.w,{query:this.props.variable.query,multi:this.props.variable.multi,allValue:this.props.variable.allValue,includeAll:this.props.variable.includeAll,onQueryChange:this.onQueryChange,onMultiChange:_=>this.onSelectionOptionsChange({propName:"multi",propValue:_.currentTarget.checked}),onIncludeAllChange:_=>this.onSelectionOptionsChange({propName:"includeAll",propValue:_.currentTarget.checked}),onAllValueChange:_=>this.onSelectionOptionsChange({propName:"allValue",propValue:_.currentTarget.value})})}}const oE=(F,_)=>({}),iE={changeVariableMultiValue:Ur.TI},lE=sE(rE,oE,iE),cE={...sc.Vg,type:"custom",multi:!1,includeAll:!1,allValue:null,query:"",options:[],current:{}},Sm=(0,zo.Z0)({name:"templating/custom",initialState:Zc.j,reducers:{createCustomOptionsFromQuery:(F,_)=>{const Q=(0,ka.Fs)(F,_.payload.id);if(Q.type!=="custom")return;const{includeAll:ue}=Q,we=(_.payload.data.match(/(?:\\,|[^,])+/g)??[]).map(ke=>{ke=ke.replace(/\\,/g,",");const Ze=/^(.+)\s:\s(.+)$/g.exec(ke)??[];if(Ze.length===3){const[,dt,mt]=Ze;return{text:dt.trim(),value:mt.trim(),selected:!1}}else return{text:ke.trim(),value:ke.trim(),selected:!1}});ue&&we.unshift({text:to.Zm,value:to.To,selected:!1}),Q.options=we}}}),dE=Sm.reducer,{createCustomOptionsFromQuery:uE}=Sm.actions,hE=F=>async(_,Q)=>{const{rootStateKey:ue}=F,Ce=(0,ka.dn)(F,Q());if(Ce.type!=="custom")return;const Oe=(0,Be.w)().replace(Ce.query);await _((0,nr.kb)(ue,uE((0,zs.qD)(F,Oe)))),await _((0,Ur.kl)(F))},fE=()=>({id:"custom",description:"Define variable values manually",name:"Custom",initialState:cE,reducer:dE,picker:ed(),editor:lE,dependsOn:(F,_)=>(0,zs.wJ)(F.query,_.name),setValue:async(F,_,Q=!1)=>{await(0,tr.JD)((0,Ur.t9)((0,zs.jX)(F),_,Q))},setValueFromUrl:async(F,_)=>{await(0,tr.JD)((0,Ur.x7)((0,zs.jX)(F),_))},updateOptions:async F=>{await(0,tr.JD)(hE((0,zs.jX)(F)))},getSaveModel:F=>{const{index:_,id:Q,state:ue,global:Ce,rootStateKey:Oe,...we}=(0,m.cloneDeep)(F);return we},getValueForUrl:F=>(0,zs.ML)(F)?to.Zm:F.current.value});var gE=e(98917),pE=e(80147);const mE={...sc.Vg,type:"datasource",current:{},regex:"",options:[],query:"",multi:!1,includeAll:!1,refresh:jl.CO.onDashboardLoad},Om=(0,zo.Z0)({name:"templating/datasource",initialState:Zc.j,reducers:{createDataSourceOptions:(F,_)=>{const{sources:Q,regex:ue}=_.payload.data,Ce=[],Oe=(0,ka.Fs)(F,_.payload.id);if(Oe.type==="datasource"){for(let we=0;we<Q.length;we++){const ke=Q[we];(0,pE._)(Oe.query,ke.meta)&&(vE(ke,ue)&&Ce.push({text:ke.name,value:ke.uid,selected:!1}),yE(ke,ue)&&Ce.push({text:"default",value:"default",selected:!1}))}Ce.length===0&&Ce.push({text:"No data sources found",value:"",selected:!1}),Oe.includeAll&&Ce.unshift({text:to.Zm,value:to.To,selected:!1}),Oe.options=Ce}}}});function vE(F,_){return _?_.exec(F.name):!0}function yE(F,_){return F.isDefault?_?_.exec("default"):!0:!1}const xE=Om.reducer,{createDataSourceOptions:EE}=Om.actions,DE=(F,_={getDatasourceSrv:c.tR})=>async(Q,ue)=>{const{rootStateKey:Ce}=F,Oe=_.getDatasourceSrv().getList({metrics:!0,variables:!1}),we=(0,ka.dn)(F,ue());if(we.type!=="datasource")return;let ke;we.regex&&(ke=(0,Be.w)().replace(we.regex,void 0,"regex"),ke=(0,$r.dO)(ke)),Q((0,nr.kb)(Ce,EE((0,zs.qD)(F,{sources:Oe,regex:ke})))),await Q((0,Ur.kl)(F))},PE=(F,_={getDatasourceSrv:c.tR})=>Q=>{const ue=_.getDatasourceSrv().getList({metrics:!0,variables:!0}),Ce=(0,m.chain)(ue).uniqBy("meta.id").map(Oe=>({text:Oe.meta.name,value:Oe.meta.id})).value();Ce.unshift({text:"",value:""}),Q((0,nr.kb)(F,(0,Wi.BC)({dataSourceTypes:Ce})))},bE=(F,_)=>{const{variable:{rootStateKey:Q}}=_;if(!Q)return console.error("DataSourceVariableEditor: variable has no rootStateKey"),{extended:cm(Wi.nS)};const{editor:ue}=(0,ka.nx)(Q,F);return{extended:cm(ue)}},CE={initDataSourceVariableEditor:PE,changeVariableMultiValue:Ur.TI},TE=(0,co.connect)(bE,CE);class ME extends d.PureComponent{constructor(){super(...arguments),this.onRegExBlur=_=>{this.props.onPropChange({propName:"regex",propValue:_.currentTarget.value,updateOptions:!0})},this.onSelectionOptionsChange=async({propValue:_,propName:Q})=>{this.props.onPropChange({propName:Q,propValue:_,updateOptions:!0})},this.onMultiChanged=_=>{this.props.changeVariableMultiValue((0,zs.jX)(this.props.variable),_.currentTarget.checked)},this.onIncludeAllChanged=_=>{this.onSelectionOptionsChange({propName:"includeAll",propValue:_.currentTarget.checked})},this.onAllValueChanged=_=>{this.onSelectionOptionsChange({propName:"allValue",propValue:_.currentTarget.value})},this.getSelectedDataSourceTypeValue=()=>{const{extended:_}=this.props;if(!_?.dataSourceTypes.length)return"";const Q=_.dataSourceTypes.find(Ce=>Ce.value===this.props.variable.query);return(Q?Q.value:_.dataSourceTypes[0].value)??""},this.onDataSourceTypeChanged=_=>{this.props.onPropChange({propName:"query",propValue:_.value,updateOptions:!0})}}componentDidMount(){const{rootStateKey:_}=this.props.variable;if(!_){console.error("DataSourceVariableEditor: variable has no rootStateKey");return}this.props.initDataSourceVariableEditor(_)}render(){const{variable:_,extended:Q}=this.props,ue=Q?.dataSourceTypes?.length?Q.dataSourceTypes?.map(Ce=>({value:Ce.value??"",label:Ce.text})):[];return(0,j.jsx)(gE.y,{query:_.query,regex:_.regex,multi:_.multi,includeAll:_.includeAll,optionTypes:ue,onChange:this.onDataSourceTypeChanged,onRegExBlur:this.onRegExBlur,onMultiChange:this.onMultiChanged,onIncludeAllChange:this.onIncludeAllChanged,onAllValueChange:this.onAllValueChanged})}}const SE=TE(ME),OE=()=>({id:"datasource",description:"Enables you to dynamically switch the data source for multiple panels.",name:"Data source",initialState:mE,reducer:xE,picker:ed(),editor:SE,dependsOn:(F,_)=>F.regex?(0,zs.wJ)(F.regex,_.name):!1,setValue:async(F,_,Q=!1)=>{await(0,tr.JD)((0,Ur.t9)((0,zs.jX)(F),_,Q))},setValueFromUrl:async(F,_)=>{await(0,tr.JD)((0,Ur.x7)((0,zs.jX)(F),_))},updateOptions:async F=>{await(0,tr.JD)(DE((0,zs.jX)(F)))},getSaveModel:F=>{const{index:_,id:Q,state:ue,global:Ce,rootStateKey:Oe,...we}=(0,m.cloneDeep)(F);return{...we,options:[]}},getValueForUrl:F=>(0,zs.ML)(F)?to.Zm:F.current.value});var IE=e(25304),AE=e(49317);const Im=(0,d.memo)(({onPropChange:F,variable:_})=>{const Q=we=>{F({propName:"auto",propValue:we.target.checked,updateOptions:!0})},ue=we=>{F({propName:"query",propValue:we.currentTarget.value,updateOptions:!0})},Ce=we=>{F({propName:"auto_count",propValue:we.value,updateOptions:!0})},Oe=we=>{F({propName:"auto_min",propValue:we.currentTarget.value,updateOptions:!0})};return(0,j.jsx)(AE.s,{intervals:_.query,autoStepCount:_.auto_count,autoEnabled:_.auto,onAutoCountChanged:Ce,onIntervalsChange:ue,onAutoEnabledChange:Q,onAutoMinIntervalChanged:Oe,autoMinInterval:_.auto_min})});Im.displayName="IntervalVariableEditor";var RE=e(23989),dp=e(81515);const LE=F=>async _=>{const{rootStateKey:Q}=F;await _((0,nr.kb)(Q,(0,dp.mn)((0,zs.qD)(F)))),await _(up(F)),await _((0,Ur.kl)(F))},up=(F,_={calculateInterval:om.calculateInterval,getTimeSrv:vi.jG,templateSrv:(0,RE.w)()})=>(Q,ue)=>{const Ce=(0,ka.dn)(F,ue());if(Ce.type==="interval"&&Ce.auto){const Oe=_.calculateInterval(_.getTimeSrv().timeRange(),Ce.auto_count,Ce.auto_min);_.templateSrv.setGrafanaVariable("$__auto_interval_"+Ce.name,Oe.interval),_.templateSrv.setGrafanaVariable("$__auto_interval",Oe.interval)}},jE=()=>({id:"interval",description:"Define a timespan interval (ex 1m, 1h, 1d)",name:"Interval",initialState:dp.Ez,reducer:dp.E5,picker:ed(),editor:Im,dependsOn:()=>!1,setValue:async(F,_,Q=!1)=>{await(0,tr.JD)(up((0,zs.jX)(F))),await(0,tr.JD)((0,Ur.t9)((0,zs.jX)(F),_,Q))},setValueFromUrl:async(F,_)=>{await(0,tr.JD)(up((0,zs.jX)(F))),await(0,tr.JD)((0,Ur.x7)((0,zs.jX)(F),_))},updateOptions:async F=>{await(0,tr.JD)(LE((0,zs.jX)(F)))},getSaveModel:F=>{const{index:_,id:Q,state:ue,global:Ce,rootStateKey:Oe,...we}=(0,m.cloneDeep)(F);return we},getValueForUrl:F=>F.current.value});var BE=e(44890),UE=e(64423),NE=e(12091),wE=e(70766);function WE(F,_,Q){return{next:Ce=>{if(Ce.state===wr.Gu.Error){Q.unsubscribe(),_(Ce.error);return}if(Ce.state===wr.Gu.Done){Q.unsubscribe(),F();return}},error:Ce=>{Q.unsubscribe(),_(Ce)},complete:()=>{Q.unsubscribe(),F()}}}const FE=(F,_)=>async(Q,ue)=>{try{const{rootStateKey:Ce}=F;if(!(0,zs.sN)(Ce,ue()))return;const Oe=(0,ka.dn)(F,ue());if(Oe.type!=="query")return;(0,ka.nx)(Ce,ue()).editor.id===Oe.id&&Q((0,nr.kb)(Ce,(0,Wi.Eo)({errorProp:"update"})));const we=await(0,U.l)().get(Oe.datasource??"");await new Promise((ke,Ze)=>{const dt=new UE.yU,mt=WE(ke,Ze,dt),Ct=ip().getResponse(F).subscribe(mt);dt.add(Ct),ip().queueRequest({identifier:F,datasource:we,searchFilter:_})})}catch(Ce){if(Ce instanceof Error){const Oe=(0,NE.u)(Ce),{rootStateKey:we}=F;throw(0,ka.nx)(we,ue()).editor.id===F.id&&Q((0,nr.kb)(we,(0,Wi.NY)({errorProp:"update",errorText:Oe.message}))),Oe}}},KE=F=>async(_,Q)=>{const ue=(0,ka.dn)(F,Q());ue.type==="query"&&await _(Am((0,zs.jX)(ue),ue.datasource))},Am=(F,_)=>async(Q,ue)=>{try{const{rootStateKey:Ce}=F,{editor:Oe}=(0,ka.nx)(Ce,ue()),ke=rp(Oe)?.dataSource,Ze=await(0,U.l)().get(_??"");ke&&ke.type!==Ze?.type&&Q((0,nr.kb)(Ce,(0,tl.QP)((0,zs.qD)(F,{propName:"query",propValue:""}))));const dt=await(0,wE.y)(Ze);Q((0,nr.kb)(Ce,(0,Wi.BC)({dataSource:Ze,VariableQueryEditor:dt})))}catch(Ce){console.error(Ce)}},$E=(F,_,Q)=>async(ue,Ce)=>{const{rootStateKey:Oe}=F,we=(0,ka.dn)(F,Ce());if(we.type==="query"){if(VE(we.name,_)){const ke="Query cannot contain a reference to itself. Variable: $"+we.name;ue((0,nr.kb)(Oe,(0,Wi.NY)({errorProp:"query",errorText:ke})));return}ue((0,nr.kb)(Oe,(0,Wi.Eo)({errorProp:"query"}))),ue((0,nr.kb)(Oe,(0,tl.QP)((0,zs.qD)(F,{propName:"query",propValue:_})))),Q!==void 0?ue((0,nr.kb)(Oe,(0,tl.QP)((0,zs.qD)(F,{propName:"definition",propValue:Q})))):typeof _=="string"&&ue((0,nr.kb)(Oe,(0,tl.QP)((0,zs.qD)(F,{propName:"definition",propValue:_})))),await ue((0,Ur.mZ)(F))}};function VE(F,_){if(typeof _=="string"&&_.match(new RegExp("\\$"+F+"(/| |$)")))return!0;const Q=Rm(_);for(let ue in Q)if(Q.hasOwnProperty(ue)){const Ce=Q[ue];if(typeof Ce=="string"&&Ce.match(new RegExp("\\$"+F+"(/| |$)")))return!0}return!1}function Rm(F){return typeof F!="object"||F===null?{query:F}:Object.keys(F).reduce((ue,Ce)=>{const Oe=F[Ce];if(typeof Oe!="object"||Oe===null)return ue[Ce]=Oe,ue;const we=Rm(Oe);for(let ke in we)we.hasOwnProperty(ke)&&(ue[`${Ce}_${ke}`]=we[ke]);return ue},{})}const _E=(F,_)=>{const{rootStateKey:Q}=_.variable;if(!Q)return console.error("QueryVariableEditor: variable has no rootStateKey"),{extended:rp(Wi.nS)};const{editor:ue}=(0,ka.nx)(Q,F);return{extended:rp(ue)}},zE={initQueryVariableEditor:KE,changeQueryVariableDataSource:Am,changeQueryVariableQuery:$E,changeVariableMultiValue:Ur.TI},HE=(0,co.connect)(_E,zE);class kE extends d.PureComponent{constructor(){super(...arguments),this.state={regex:null,tagsQuery:null,tagValuesQuery:null},this.onDataSourceChange=_=>{this.props.onPropChange({propName:"datasource",propValue:_.isDefault?null:(0,im.p$)(_)})},this.onLegacyQueryChange=async(_,Q)=>{this.props.variable.query!==_&&this.props.changeQueryVariableQuery((0,zs.jX)(this.props.variable),_,Q)},this.onQueryChange=async _=>{if(this.props.variable.query!==_){let Q="";_&&_.hasOwnProperty("query")&&typeof _.query=="string"&&(Q=_.query),this.props.changeQueryVariableQuery((0,zs.jX)(this.props.variable),_,Q)}},this.onRegExBlur=async _=>{const Q=_.currentTarget.value;this.props.variable.regex!==Q&&this.props.onPropChange({propName:"regex",propValue:Q,updateOptions:!0})},this.onRefreshChange=_=>{this.props.onPropChange({propName:"refresh",propValue:_})},this.onSortChange=async _=>{this.props.onPropChange({propName:"sort",propValue:_.value,updateOptions:!0})},this.onMultiChange=_=>{this.props.onPropChange({propName:"multi",propValue:_.currentTarget.checked})},this.onIncludeAllChange=_=>{this.props.onPropChange({propName:"includeAll",propValue:_.currentTarget.checked})},this.onAllValueChange=_=>{this.props.onPropChange({propName:"allValue",propValue:_.currentTarget.value})}}async componentDidMount(){await this.props.initQueryVariableEditor((0,zs.jX)(this.props.variable))}componentDidUpdate(_){_.variable.datasource!==this.props.variable.datasource&&this.props.changeQueryVariableDataSource((0,zs.jX)(this.props.variable),this.props.variable.datasource)}render(){const{extended:_,variable:Q}=this.props;if(!_||!_.dataSource)return null;const ue=(0,vi.jG)().timeRange();return(0,j.jsx)(BE.u,{datasource:Q.datasource??void 0,onDataSourceChange:this.onDataSourceChange,query:Q.query,onQueryChange:this.onQueryChange,onLegacyQueryChange:this.onLegacyQueryChange,timeRange:ue,regex:Q.regex,onRegExChange:this.onRegExBlur,sort:Q.sort,onSortChange:this.onSortChange,refresh:Q.refresh,onRefreshChange:this.onRefreshChange,isMulti:Q.multi,includeAll:Q.includeAll,allValue:Q.allValue??"",onMultiChange:this.onMultiChange,onIncludeAllChange:this.onIncludeAllChange,onAllValueChange:this.onAllValueChange})}}const GE=HE(kE),QE=()=>({id:"query",description:"Variable values are fetched from a datasource query",name:"Query",initialState:gx,reducer:yx,picker:ed(),editor:GE,dependsOn:(F,_)=>(0,zs.wJ)(F.query,F.datasource?.uid,F.regex,_.name),setValue:async(F,_,Q=!1)=>{await(0,tr.JD)((0,Ur.t9)((0,zs.jX)(F),_,Q))},setValueFromUrl:async(F,_)=>{await(0,tr.JD)((0,Ur.x7)((0,zs.jX)(F),_))},updateOptions:async(F,_)=>{await(0,tr.JD)(FE((0,zs.jX)(F),_))},getSaveModel:F=>{const{index:_,id:Q,state:ue,global:Ce,queryValue:Oe,rootStateKey:we,...ke}=(0,m.cloneDeep)(F);return F.refresh!==jl.CO.never?{...ke,options:[]}:ke},getValueForUrl:F=>(0,zs.ML)(F)?to.Zm:F.current.value}),YE=()=>({id:"system",description:"",name:"system",initialState:{...sc.Vg,type:"system",hide:jl.zL.hideVariable,skipUrlSync:!0,current:{value:{toString:()=>""}},state:wr.Gu.Done},reducer:F=>F,picker:null,editor:null,dependsOn:()=>!1,setValue:async(F,_,Q=!1)=>{},setValueFromUrl:async(F,_)=>{},updateOptions:async F=>{},getSaveModel:F=>({}),getValueForUrl:F=>""});var JE=e(58975),XE=e(14329);function ZE({onPropChange:F,variable:{query:_}}){const Q=(0,d.useCallback)((Oe,we)=>{Oe.preventDefault(),F({propName:"originalQuery",propValue:Oe.currentTarget.value,updateOptions:!1}),F({propName:"query",propValue:Oe.currentTarget.value,updateOptions:we})},[F]),ue=(0,d.useCallback)(Oe=>Q(Oe,!1),[Q]),Ce=(0,d.useCallback)(Oe=>Q(Oe,!0),[Q]);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(JE.Y,{children:"Text options"}),(0,j.jsx)(XE._,{value:_,name:"Default value",placeholder:"default value, if any",onChange:ue,onBlur:Ce,width:30,testId:sr.Tp.pages.Dashboard.Settings.Variables.Edit.TextBoxVariable.textBoxOptionsQueryInputV2})]})}function qE({variable:F,onVariableChange:_,readOnly:Q}){const ue=(0,Fn.useDispatch)(),[Ce,Oe]=(0,d.useState)(F.current.value);(0,d.useEffect)(()=>{Oe(F.current.value)},[F]);const we=(0,d.useCallback)(()=>{if(!F.rootStateKey){console.error("Cannot update variable without rootStateKey");return}if(F.current.value!==Ce){if(ue((0,nr.kb)(F.rootStateKey,(0,tl.QP)((0,zs.qD)({id:F.id,type:F.type},{propName:"query",propValue:Ce})))),_){_({...F,current:(0,Tm.R)(F.current)?{}:{...F.current,value:Ce}});return}Jc.B.get(F.type).updateOptions(F)}},[F,Ce,ue,_]),ke=(0,d.useCallback)(mt=>Oe(mt.target.value),[Oe]),Ze=mt=>we(),dt=mt=>{mt.keyCode===13&&(mt.preventDefault(),we())};return(0,j.jsx)(Ne.p,{type:"text",value:Ce,onChange:ke,onBlur:Ze,disabled:Q,onKeyDown:dt,placeholder:(0,ya.t)("variable.textbox.placeholder","Enter variable value"),id:to.qz+F.id})}const eD={...sc.Vg,type:"textbox",query:"",current:{},options:[],originalQuery:null},Lm=(0,zo.Z0)({name:"templating/textbox",initialState:Zc.j,reducers:{createTextBoxOptions:(F,_)=>{const Q=(0,ka.Fs)(F,_.payload.id);if(Q.type!=="textbox")return;const ue={text:Q.query.trim(),value:Q.query.trim(),selected:!1};Q.options=[ue],Q.current=ue}}}),tD=Lm.reducer,{createTextBoxOptions:nD}=Lm.actions,sD=F=>async(_,Q)=>{const{rootStateKey:ue,type:Ce}=F;_((0,nr.kb)(ue,nD((0,zs.qD)(F))));const Oe=(0,ka.dn)(F,Q());Oe.type==="textbox"&&await Jc.B.get(Ce).setValue(Oe,Oe.options[0],!0)},aD=(F,_)=>async(Q,ue)=>{const{rootStateKey:Ce}=F,Oe=(0,ka.dn)(F,ue());if(Oe.type!=="textbox")return;const we=(0,zs.QT)(_);Q((0,nr.kb)(Ce,(0,tl.QP)((0,zs.qD)(Oe,{propName:"query",propValue:we})))),await Q((0,Ur.x7)((0,zs.jX)(Oe),we))},rD=()=>({id:"textbox",description:"Define a textbox variable, where users can enter any arbitrary string",name:"Text box",initialState:eD,reducer:tD,picker:qE,editor:ZE,dependsOn:(F,_)=>!1,setValue:async(F,_,Q=!1)=>{await(0,tr.JD)((0,Ur.t9)((0,zs.jX)(F),_,Q))},setValueFromUrl:async(F,_)=>{await(0,tr.JD)(aD((0,zs.jX)(F),_))},updateOptions:async F=>{await(0,tr.JD)(sD((0,zs.jX)(F)))},getSaveModel:(F,_)=>{const{index:Q,id:ue,state:Ce,global:Oe,originalQuery:we,rootStateKey:ke,...Ze}=(0,m.cloneDeep)(F);if(F.query!==we&&!_){const dt=we??"",mt={selected:!1,text:dt,value:dt};return{...Ze,query:dt,current:mt,options:[mt]}}return Ze},getValueForUrl:F=>F.current.value,beforeAdding:F=>({...(0,m.cloneDeep)(F),originalQuery:F.query})});var oD=e(10378),hp=e(55314),fp=e(72686),gp=e(59120);const iD={navBarTree:Xd.I_,navIndex:Ql._h,appNotifications:Zl.g5};var lD=e(44672),ai=e(88467),ri=e(23770);const cD=(0,Su.combineReducers)({dataSources:(0,ai.Xw)("dataSources",ri.DC,({rulesSourceName:F})=>F).reducer,promRules:(0,ai.Xw)("promRules",ri.mB,({rulesSourceName:F})=>F).reducer,rulerRules:(0,ai.Xw)("rulerRules",ri.eB,({rulesSourceName:F})=>F).reducer,ruleForm:(0,Su.combineReducers)({saveRule:(0,ai.J7)("saveRule",ri._$).reducer}),grafanaNotifiers:(0,ai.J7)("grafanaNotifiers",ri.mF).reducer,saveAMConfig:(0,ai.J7)("saveAMConfig",ri.RW).reducer,deleteAMConfig:(0,ai.J7)("deleteAMConfig",ri.nO).reducer,folders:(0,ai.Xw)("folders",ri.Tp,F=>F).reducer,amAlertGroups:(0,ai.Xw)("amAlertGroups",ri.D3,F=>F).reducer,testReceivers:(0,ai.J7)("testReceivers",ri.bO).reducer,managedAlertStateHistory:(0,ai.J7)("managedAlertStateHistory",ri.JH).reducer});var dD=e(55907);const uD={items:[],searchQuery:"",isLoading:!1},hD={notificationChannelTypes:[],notificationChannel:{},notifiers:[]};function fD(F,_){const Q=dD.A.getStateDisplayModel(_),ue={...F,stateText:Q.text,stateIcon:Q.iconClass,stateClass:Q.stateClass,stateAge:(0,u.KQ)(F.newStateDate).fromNow(!0)};return ue.state!=="paused"&&(ue.executionError&&(ue.info="Execution Error: "+ue.executionError),ue.evalData&&ue.evalData.noData&&(ue.info="Query returned no data")),ue}const jm=(0,zo.Z0)({name:"alertRules",initialState:uD,reducers:{loadAlertRules:F=>({...F,isLoading:!0}),loadedAlertRules:(F,_)=>{const ue=_.payload.map(Ce=>fD(Ce,Ce.state));return{...F,items:ue,isLoading:!1}},setSearchQuery:(F,_)=>({...F,searchQuery:_.payload})}}),Bm=(0,zo.Z0)({name:"notificationChannel",initialState:hD,reducers:{setNotificationChannels:(F,_)=>({...F,notificationChannelTypes:yD(_.payload),notifiers:_.payload}),notificationChannelLoaded:(F,_)=>{const Q=_.payload,Ce=F.notifiers.find(Oe=>Oe.type===Q.type).options.filter(Oe=>Oe.secure);return Ce.length>0&&Ce.some(Oe=>Q.settings[Oe.propertyName]!=="")?vD(F,_.payload,Ce):{...F,notificationChannel:Q}},resetSecureField:(F,_)=>({...F,notificationChannel:{...F.notificationChannel,secureFields:{...F.notificationChannel.secureFields,[_.payload]:!1}}})}}),{loadAlertRules:nP,loadedAlertRules:sP,setSearchQuery:aP}=jm.actions,{setNotificationChannels:rP,notificationChannelLoaded:oP,resetSecureField:iP}=Bm.actions,gD=jm.reducer,pD=Bm.reducer,mD={alertRules:gD,notificationChannel:pD,unifiedAlerting:cD};function vD(F,_,Q){const ue={},Ce={};return Q.forEach(Oe=>{Ce[Oe.propertyName]=_.settings[Oe.propertyName],ue[Oe.propertyName]=""}),{...F,notificationChannel:{..._,settings:{..._.settings,...ue},secureSettings:{...Ce}}}}function yD(F){return F.map(_=>({value:_.type,label:_.name,..._,typeName:_.type})).sort((_,Q)=>_.name>Q.name?1:-1)}var xD=e(93584),ED=e(20604),DD=e(79763),PD=e(53466),bD=e(28601),CD=e(36227),TD=e(54650),MD=e(40823),SD=e(88264),OD=e(10943),ID=e(80095),AD=e(31326),RD=e(81862),LD=e(1936),jD=e(8212),BD=e(34655),UD=e(87617),pp=e(2858),ND=e(97007);const wD={...iD,...mD,...BD.Ay,...xD.Ay,...TD.Ay,...bD.Ay,...Yp.Ay,...CD.Ay,...UD.Ay,...LD.Ay,...RD.Ay,...MD.Ay,...OD.Ay,...DD.Ay,...lD.Ay,...SD.Ay,...PD.Ay,...ID.Ay,...nr.Ay,...jD.Ay,...ED.Ay,plugins:AD.Ff,[pl.Hr.reducerPath]:pl.Hr.reducer,[fp.Sm.reducerPath]:fp.Sm.reducer,[hp.cU.reducerPath]:hp.cU.reducer,[gp.O5.reducerPath]:gp.O5.reducer,[pp.g.reducerPath]:pp.g.reducer,[Zd.reducerPath]:Zd.reducer},Um={},lP=F=>{Object.assign(Um,F)},WD=()=>{const F=(0,Su.combineReducers)({...wD,...Um});return(_,Q)=>{if(Q.type!==ND.N.type)return F(_,Q);const{cleanupAction:ue}=Q.payload;return ue(_),F(_,Q)}};function cP(F){addReducer(F)}const FD=(0,zo.Nc)(),Nm=[];function dP(F){Nm.push(F)}function KD(F){const _=(0,zo.U1)({reducer:WD(),middleware:Q=>Q({thunk:!0,serializableCheck:!1,immutableCheck:!1}).concat(FD.middleware,pl.Hr.middleware,fp.Sm.middleware,hp.cU.middleware,gp.O5.middleware,pp.g.middleware,Zd.middleware,...Nm),devTools:!1,preloadedState:{navIndex:(0,Ql.s2)(),...F}});return(0,oD.$k)(_.dispatch),(0,tr.k3)(_),_}y().move=Z.b;const wm=e(39572),Ru=wm.keys().map(F=>wm(F));class $D{async init(){try{parent.postMessage("GrafanaAppInit","*");const _=(0,ya.JL)(Y.Ay.bootData.user.language);_.then(({language:dt})=>(0,Y._R)({language:dt})),(0,M.u5)(tp.IB),zD(),iv(),(0,nc.j)("frontend_app_init"),(0,u.xS)(Y.Ay.bootData.user.locale),(0,u.$D)(Y.Ay.bootData.user.weekStart),(0,X.Y)(ny.m),(0,k.l)(ec),(0,H.e)(ty.a),(0,S.T)(I.Ny),(0,T.p)(Kv),(0,D.G)(()=>Y.Ay.bootData.user.timezone),ey(),(0,b.l)(or.TP.user),(0,Fv.initAuthConfig)(),(0,R.H8)(Cr.A),await _,VD(),KD(),_D(),Wv(),P.D.setInit(Eu.H),P.G.setInit(Eu.u),x.h.setInit(Ma),Jc.B.setInit(()=>[QE(),fE(),rD(),nE(),OE(),jE(),ix(),YE()]),E.l.setInit(lr),lv(),(0,A.HC)(()=>new Ly),jx(new Lx),(0,A.pC)(ap.BN),(0,L.se)({importPanelPlugin:sm.TV,getPanelPluginFromCache:sm.PY}),C.I.initialize({config:Y.Ay,getTimeRangeForUrl:(0,vi.jG)().timeRangeForUrl,getVariablesUrlParams:IE.z}),document.addEventListener("click",cv);const Q=new c.xq;Q.init(Y.Ay.datasources,Y.Ay.defaultDatasource),(0,U.h)(Q),By();const ue=new Cy;if(ue.register({pluginId:"grafana",extensionConfigs:iy()}),or.TP.user.orgRole!==""){const dt=["cloud-home-app"],mt=Object.values(Y.Ay.apps).filter(Kt=>dt.includes(Kt.id)),Ct=Object.values(Y.Ay.apps).filter(Kt=>!dt.includes(Kt.id));am(Ct,ue),await am(mt,ue,"frontend_awaited_plugins_preload")}(0,W.cE)(vy(ue)),(0,w.Vu)(Sy(ue)),(0,N.A)(My(ue));const Ce=I.Ny.getSearchObject(),Oe=new eg,we=new Uv(I.Ny,Oe),ke=new uv;ke.start(),Oe.setKioskModeFromUrl(Ce.kiosk);try{(0,Uy.W1)()}catch(dt){console.warn("Failed to clean up old expanded folders",dt)}this.context={backend:tp.IB,location:I.Ny,chrome:Oe,keybindings:we,newAssetsChecker:ke,config:Y.Ay},(0,B._)(Lo.ni),(0,V._)(Lo.k9),(0,v.H)(document.getElementById("reactRoot")).render((0,d.createElement)(xu,{app:this}))}catch(_){console.error("Failed to start Grafana",_),window.__grafana_load_failed()}finally{(0,nc.z)("frontend_app_init")}}}function VD(){Ru.length>0&&Ru[0].addExtensionReducers()}function _D(){Ru.length>0&&Ru[0].init()}function zD(){(0,K.H2)(new gv({debug:!1})),window.addEventListener("load",F=>{const _="frontend_boot_load_time_seconds";performance&&(performance.mark(_),td("first-paint","frontend_boot_","_time_seconds"),td("first-contentful-paint","frontend_boot_","_time_seconds"),td(_),td("frontend_boot_js_done_time_seconds"),td("frontend_boot_css_time_seconds"))}),or.TP.user.orgRole!==""&&(0,K.pl)(new mv({})),Y.Ay.grafanaJavascriptAgent.enabled&&(0,K.pl)(new Av({...Y.Ay.grafanaJavascriptAgent,app:{version:Y.Ay.buildInfo.version,environment:Y.Ay.buildInfo.env},buildInfo:Y.Ay.buildInfo,user:{id:String(Y.Ay.bootData.user?.id),email:Y.Ay.bootData.user?.email}})),Y.Ay.googleAnalyticsId&&(0,K.pl)(new xv({googleAnalyticsId:Y.Ay.googleAnalyticsId})),Y.Ay.googleAnalytics4Id&&(0,K.pl)(new yv({googleAnalyticsId:Y.Ay.googleAnalytics4Id,googleAnalytics4SendManualPageViews:Y.Ay.googleAnalytics4SendManualPageViews})),Y.Ay.rudderstackWriteKey&&Y.Ay.rudderstackDataPlaneUrl&&(0,K.pl)(new Ev({writeKey:Y.Ay.rudderstackWriteKey,dataPlaneUrl:Y.Ay.rudderstackDataPlaneUrl,user:Y.Ay.bootData.user,sdkUrl:Y.Ay.rudderstackSdkUrl,configUrl:Y.Ay.rudderstackConfigUrl,integrationsUrl:Y.Ay.rudderstackIntegrationsUrl,buildInfo:Y.Ay.buildInfo})),Y.Ay.applicationInsightsConnectionString&&(0,K.pl)(new vv({connectionString:Y.Ay.applicationInsightsConnectionString,endpointUrl:Y.Ay.applicationInsightsEndpointUrl}))}function td(F,_="",Q=""){const ue=y().first(performance.getEntriesByName(F));if(ue){const Ce=ue.name.replace(/-/g,"_");(0,pv.n)(`${_}${Ce}${Q}`,Math.round(ue.startTime)/1e3)}}const HD=new $D;window.public_cdn_path&&(e.p=window.public_cdn_path),window.__grafana_public_path__=e.p.substring(0,e.p.lastIndexOf("build/"))||e.p,window.nonce&&(e.nc=window.nonce),window.__grafana_app_bundle_loaded=!0,HD.init()},60021:(G,O,e)=>{"use strict";e.d(O,{Or:()=>n,Oz:()=>r,RC:()=>t,ho:()=>i,nA:()=>s});var t=(f=>(f.Active="active",f.Expired="expired",f.Pending="pending",f))(t||{}),n=(f=>(f.Unprocessed="unprocessed",f.Active="active",f.Suppressed="suppressed",f))(n||{}),i=(f=>(f.equal="=",f.notEqual="!=",f.regex="=~",f.notRegex="!~",f))(i||{}),s=(f=>(f.Internal="internal",f.External="external",f.All="all",f))(s||{}),r=(f=>(f.cortex="cortex",f.mimir="mimir",f.prometheus="prometheus",f))(r||{})},91621:(G,O,e)=>{"use strict";e.d(O,{Dw:()=>f,Rx:()=>i,_W:()=>r,d$:()=>n});const t={statistics:[]};var n=(c=>(c[c.Insights=1]="Insights",c[c.Search=0]="Search",c))(n||{}),i=(c=>(c[c.Builder=0]="Builder",c[c.Code=1]="Code",c))(i||{});const s={parameters:[]};var r=(c=>(c.And="and",c.Function="function",c.FunctionParameter="functionParameter",c.GroupBy="groupBy",c.Operator="operator",c.Or="or",c.Property="property",c))(r||{}),f=(c=>(c.String="string",c))(f||{});const a={logGroupNames:[],logGroups:[],statsGroups:[]}},25640:(G,O,e)=>{"use strict";e.d(O,{Rx:()=>t.Rx,YZ:()=>n,b4:()=>i,d$:()=>t.d$});var t=e(91621),n=(s=>(s.Scheduled="Scheduled",s.Running="Running",s.Complete="Complete",s.Failed="Failed",s.Cancelled="Cancelled",s.Timeout="Timeout",s))(n||{}),i=(s=>(s.Regions="regions",s.Namespaces="namespaces",s.Metrics="metrics",s.DimensionKeys="dimensionKeys",s.DimensionValues="dimensionValues",s.EBSVolumeIDs="ebsVolumeIDs",s.EC2InstanceAttributes="ec2InstanceAttributes",s.ResourceArns="resourceARNs",s.Statistics="statistics",s.LogGroups="logGroups",s.Accounts="accounts",s))(i||{})},36666:(G,O,e)=>{"use strict";e.d(O,{A:()=>I});var t=e(74848),n=e(32196),i=e(92145),s=e(55127),r=e.n(s),f=e(96540),a=e(16817),c=e(52622),o=e(21103),h=e(40845),g=e(67061),l=e(88575),p=e(90182),m=e(94354),y=e(15292),d=e(62930),v=e(2913),u=e(14792),D=e(34842),P=e(31193),x=e(48514),E=e(45994);function C(b){return JSON.stringify(b)}function M(b,R){let A=R;return window.__grafanaSceneContext&&window.__grafanaSceneContext instanceof D.H$&&(A=window.__grafanaSceneContext.state.editPanel?.state.panelId),b===A}const S=[{label:"All data",value:!1},{label:"Annotations",value:!0,description:"Include annotations as regular data"}];function I({data:b,query:R,onChange:A,onRunQuery:L}){const{value:U}=(0,a.A)(()=>(0,P.tR)().get()),W=(0,f.useMemo)(()=>(0,u.UA)().getCurrent()?.getPanelById(R.panelId??-124134),[R.panelId]),{value:w,loading:N}=(0,a.A)(async()=>{if(!W||!b)return[];const ne=await(0,P.tR)().get(W.datasource);return Promise.all(W.targets.map(async oe=>{const z=oe.datasource?await(0,P.tR)().get(oe.datasource):ne,te=z.getQueryDisplayText||C,le=(0,x.E)(b,oe.refId)??b;return{refId:oe.refId,query:te(oe),name:z.name,img:z.meta.info.logos.small,data:le.series,error:le.error}}))},[b,W]),B=(0,f.useCallback)(ne=>{A(ne),L()},[A,L]),V=(0,f.useCallback)(ne=>{B({...R,panelId:ne})},[R,B]),K=(0,f.useCallback)(()=>{B({...R,withTransforms:!R.withTransforms})},[R,B]),H=(0,f.useCallback)(ne=>{B({...R,topic:ne?c.QR.Annotations:void 0})},[R,B]),X=(0,f.useCallback)(ne=>{const oe=ne.datasource??U,z=(0,P.tR)().getInstanceSettings(oe)?.name,te=ne.targets.length;return`${te} ${r()("query",te)} to ${z}`},[U]),k=(0,u.UA)().getCurrent(),Y=!!(R.withTransforms||W?.transformations?.length),Z=(0,f.useMemo)(()=>k?.panels.filter(ne=>v.Ay.panels[ne.type]&&ne.targets&&!M(ne.id,k.panelInEdit?.id)&&ne.datasource?.uid!==E.K).map(ne=>({value:ne.id,label:ne.title??"Panel "+ne.id,description:X(ne),imgUrl:v.Ay.panels[ne.type].info.logos.small}))??[],[k,X]),se=(0,h.of)(T),j=(0,i.Bi)();if(!k)return null;if(Z.length<1)return(0,t.jsx)("p",{className:se.noQueriesText,children:"This dashboard does not have any other panels. Add queries to other panels and try again."});const q=Z.find(ne=>ne.value===R.panelId);return(0,t.jsx)(o.i,{children:(0,t.jsxs)(g.B,{direction:"column",children:[(0,t.jsxs)(g.B,{gap:3,children:[(0,t.jsx)(l.D,{label:"Source panel",description:"Use query results from another panel",children:(0,t.jsx)(p.l6,{inputId:j,placeholder:"Choose panel",isSearchable:!0,options:Z,value:q,onChange:ne=>V(ne.value)})}),(0,t.jsx)(l.D,{label:"Data",description:"Use data or annotations from the panel",children:(0,t.jsx)(m.z,{options:S,value:R.topic===c.QR.Annotations,onChange:H})}),Y&&(0,t.jsx)(l.D,{label:"Transform",description:"Apply transformations from the source panel",children:(0,t.jsx)(y.K,{value:!!R.withTransforms,onChange:K})})]}),N?(0,t.jsx)(d.y,{}):(0,t.jsx)(t.Fragment,{children:w&&!!w.length&&(0,t.jsx)(l.D,{label:"Queries from panel",children:(0,t.jsx)(g.B,{direction:"column",children:w.map((ne,oe)=>(0,t.jsxs)(g.B,{alignItems:"center",gap:1,children:[(0,t.jsx)("div",{children:ne.refId}),(0,t.jsx)("img",{src:ne.img,alt:ne.name,title:ne.name,width:16}),(0,t.jsx)("div",{children:ne.query})]},oe))})})})]})})}function T(b){return{noQueriesText:(0,n.css)({padding:b.spacing(1.25)})}}},14348:(G,O,e)=>{"use strict";e.d(O,{K:()=>a.K,kN:()=>c,mw:()=>o});var t=e(88483),n=e(52622),i=e(39070),s=e(43127),r=e(14792),f=e(34214),a=e(45994);function c(p){return p?typeof p=="string"?p===a.K:"meta"in p&&p.meta.name===a.K||p.uid===a.K:!1}function o(p,m){return new t.c(y=>{const d=(0,r.UA)().getCurrent(),v=h(p.queries);if(!v){y.next(g("Missing panel reference ID"));return}let u=d?.getPanelById(v,!0);if(u instanceof f.a||(u=new f.a(u)),!u){y.next(g("Unknown Panel: "+v));return}const D=u.getQueryRunner(),P=D.getData({withTransforms:!!m?.withTransforms,withFieldConfig:!1}).subscribe({next:x=>{m?.topic===n.QR.Annotations&&(x={...x,series:x.annotations??[],annotations:void 0}),y.next(x)}});if(!u.isInView&&u.refreshWhenInView||d?.otherPanelInFullscreen(u)){const{datasource:x,targets:E}=u,C={...p,datasource:x,panelId:v,queries:E};u.refreshWhenInView=!1,D.run(C)}return()=>{P.unsubscribe()}})}function h(p){if(!(!p||!p.length))return p[0].panelId}function g(p){return{state:i.Gu.Error,series:[],request:{},error:{message:p},timeRange:(0,s.E2)()}}var l=e(36666)},45994:(G,O,e)=>{"use strict";e.d(O,{K:()=>t});const t="-- Dashboard --",n="dashboard"},90183:(G,O,e)=>{"use strict";e.d(O,{i:()=>fe,o:()=>Te});var t=e(2543),n=e(65474),i=e(62467),s=e(44240),r=e(81160),f=e(89667),a=e(39070),c=e(55004),o=e(37471),h=e(78368),g=e(14236),l=e(26657),p=e(72574),m=e(78731),y=e(17172),d=e(19347),v=e(79056),u=e(14792),D=e(74848),P=e(32196),x=e(96540),E=e(40845),C=e(84167),M=e(88575),S=e(90182),I=e(15292),T=e(99818),b=e(10154),R=e(68706),A=e(95093),L=e.n(A),U=e(91410),W=e(20333),w=e(55852),N=e(67061),B=e(17624),V=e(67459),K=e(79770),H=e(14578),X=e(87266),k=e(16797);const Y="time-of-day-picker-panel",Z=({minuteStep:je=1,showHour:He=!0,showSeconds:Be=!1,onChange:Ne,value:Re,size:Se="auto",disabled:We,disabledHours:Ke,disabledMinutes:Xe,disabledSeconds:Je,placeholder:st,format:pt="HH:mm",defaultValue:xt=void 0,allowEmpty:ot=!1,width:$e})=>{const ve=(0,E.of)(j),be=()=>$e?(0,P.css)`
        width: ${$e}px;
      `:(0,X.lH)()[Se];return(0,D.jsx)(K.A,{value:Re,defaultValue:xt,onChange:he=>Ne(he),showHour:He,showSecond:Be,format:pt,allowEmpty:ot,className:(0,P.cx)(be(),ve.input),popupClassName:(0,P.cx)(ve.picker,Y),minuteStep:je,inputIcon:(0,D.jsx)(se,{wrapperStyle:ve.caretWrapper}),disabled:We,disabledHours:Ke,disabledMinutes:Xe,disabledSeconds:Je,placeholder:st})},se=({wrapperStyle:je=""})=>(0,D.jsx)("div",{className:je,children:(0,D.jsx)(H.I,{name:"angle-down"})}),j=je=>{const He=je.components.input.background,Be=je.v1.palette.black,Ne=je.colors.background.secondary,Re=je.shape.radius.default,Se=je.components.input.borderColor;return{caretWrapper:(0,P.css)`
      position: absolute;
      right: 8px;
      top: 50%;
      transform: translateY(-50%);
      display: inline-block;
      text-align: right;
      color: ${je.colors.text.secondary};
    `,picker:(0,P.css)`
      .rc-time-picker-panel-select {
        font-size: 14px;
        background-color: ${He};
        border-color: ${Se};
        li {
          outline-width: 2px;
          &.rc-time-picker-panel-select-option-selected {
            background-color: inherit;
            border: 1px solid ${je.v1.palette.orange};
            border-radius: ${Re};
          }

          &:hover {
            background: ${Ne};
          }

          &.rc-time-picker-panel-select-option-disabled {
            color: ${je.colors.action.disabledText};
          }
        }
      }

      .rc-time-picker-panel-inner {
        box-shadow: 0px 4px 4px ${Be};
        background-color: ${He};
        border-color: ${Se};
        border-radius: ${Re};
        margin-top: 3px;

        .rc-time-picker-panel-input-wrap {
          margin-right: 2px;

          &,
          .rc-time-picker-panel-input {
            background-color: ${He};
            padding-top: 2px;
          }
        }

        .rc-time-picker-panel-combobox {
          display: flex;
        }
      }
    `,input:(0,P.css)`
      .rc-time-picker-input {
        background-color: ${He};
        border-radius: ${Re};
        border-color: ${Se};
        height: ${je.spacing(4)};

        &:focus {
          ${(0,k.focusCss)(je)}
        }

        &:disabled {
          background-color: ${je.colors.action.disabledBackground};
          color: ${je.colors.action.disabledText};
          border: 1px solid ${je.colors.action.disabledBackground};
          &:focus {
            box-shadow: none;
          }
        }
      }

      .rc-time-picker-clear {
        position: absolute;
        right: 20px;
        top: 50%;
        cursor: pointer;
        overflow: hidden;
        transform: translateY(-50%);
        color: ${je.colors.text.secondary};
      }
    `}},q=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].map((je,He)=>({label:je,value:He+1})),ne=({value:je,onChange:He})=>{const Be=(0,E.of)(oe),Ne=Date.now(),Re=(0,U.QZ)(je.timezone??"utc",Ne),Se=(0,u.UA)().getCurrent()?.getTimezone()===je.timezone,[We,Ke]=(0,x.useState)(!1),Xe=()=>{Ke(!We)},Je=he=>{if(!he)return;const ye=L()();if(he){const Pe=he.split(":");ye.set("hour",parseInt(Pe[0],10)),ye.set("minute",parseInt(Pe[1],10))}return ye},st=()=>{let he="Everyday";return je.fromDayOfWeek&&!je.toDayOfWeek&&(he=q[je.fromDayOfWeek-1].label),he},pt=()=>{const he=(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(V.U,{title:Re?.name}),(0,D.jsx)(B.X,{timeZone:je.timezone,timestamp:Ne})]});return Se?(0,D.jsxs)(D.Fragment,{children:["Dashboard timezone (",he,")"]}):he},xt=(he,ye)=>{const Pe=he?he.format("HH:mm"):void 0;He(ye==="from"?{...je,from:Pe}:{...je,to:Pe})},ot=he=>{He({...je,timezone:he})},$e=he=>{const ye=he?he.value:void 0,Pe=he?je.toDayOfWeek:void 0;He({...je,fromDayOfWeek:ye,toDayOfWeek:Pe})},ve=he=>{He({...je,toDayOfWeek:he?he.value:void 0})},be=()=>We?(0,D.jsx)(W.U,{value:je.timezone,includeInternal:!0,onChange:he=>ot(he),onBlur:()=>Ke(!1),openMenuOnFocus:!1,width:100,autoFocus:!0}):(0,D.jsxs)("div",{className:Be.timezoneContainer,children:[(0,D.jsx)("div",{className:Be.timezone,children:pt()}),(0,D.jsx)(w.$n,{variant:"secondary",onClick:Xe,size:"sm",children:"Change timezone"})]});return(0,D.jsxs)(C.n,{className:Be.wrapper,children:[(0,D.jsx)(M.D,{label:"From",children:(0,D.jsxs)(N.B,{gap:.5,children:[(0,D.jsx)(S.l6,{options:q,isClearable:!0,placeholder:"Everyday",value:je.fromDayOfWeek??null,onChange:he=>$e(he),width:20}),(0,D.jsx)(Z,{value:Je(je.from),onChange:he=>xt(he,"from"),allowEmpty:!0,placeholder:"HH:mm",width:100})]})}),(0,D.jsx)(M.D,{label:"To",children:(0,D.jsxs)(N.B,{gap:.5,children:[(je.fromDayOfWeek||je.toDayOfWeek)&&(0,D.jsx)(S.l6,{options:q,isClearable:!0,placeholder:st(),value:je.toDayOfWeek??null,onChange:he=>ve(he),width:20}),(0,D.jsx)(Z,{value:Je(je.to),onChange:he=>xt(he,"to"),allowEmpty:!0,placeholder:"HH:mm",width:100})]})}),(0,D.jsx)(M.D,{label:"Timezone",children:be()})]})},oe=je=>({wrapper:(0,P.css)({maxWidth:je.spacing(60),marginBottom:je.spacing(2)}),timezoneContainer:(0,P.css)`
      padding: 5px;
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
    `,timezone:(0,P.css)`
      margin-right: 5px;
    `}),z="Enabling this returns annotations that match any of the tags specified below",te=(0,D.jsx)("div",{children:"Specify a list of tags to match. To specify a key and value tag use `key:value` syntax."}),le=[{label:"Dashboard",value:R.St.Dashboard,description:"Query for events created on this dashboard and show them in the panels where they where created"},{label:"Tags",value:R.St.Tags,description:"This will fetch any annotation events that match the tags filter"}],ie=[{label:"Annotations & Alerts",value:R.nj.Annotations,description:"Show annotations or alerts managed by grafana"},{label:"Time regions",value:R.nj.TimeRegions,description:"Configure a repeating time region"}],ae=[10,50,100,200,300,500,1e3,2e3].map(je=>({label:String(je),value:je}));function re({query:je,onChange:He}){const Be=je,{limit:Ne,matchAny:Re,tags:Se,type:We,queryType:Ke}=Be;let Xe=Ke??R.nj.Annotations;const Je=(0,x.useMemo)(()=>(0,u.UA)().dashboard?.getTimezone(),[]),st=(0,E.of)(ce),pt=he=>He({...Be,type:he.value}),xt=he=>He({...Be,limit:he.value}),ot=he=>He({...Be,matchAny:he.target.checked}),$e=he=>He({...Be,tags:he}),ve=he=>{const ye={...Be,queryType:he.value};ye.queryType===R.nj.TimeRegions?ye.timeRegion||(ye.timeRegion={timezone:Je}):delete ye.timeRegion,He(ye)},be=he=>{He({...Be,timeRegion:he})};return(0,D.jsxs)(C.n,{className:st.container,children:[(0,D.jsx)(M.D,{label:"Query type",children:(0,D.jsx)(S.l6,{inputId:"grafana-annotations__query-type",options:ie,value:Xe,onChange:ve})}),Xe===R.nj.Annotations&&(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(M.D,{label:"Filter by",children:(0,D.jsx)(S.l6,{inputId:"grafana-annotations__filter-by",options:le,value:We,onChange:pt})}),(0,D.jsx)(M.D,{label:"Max limit",children:(0,D.jsx)(S.l6,{inputId:"grafana-annotations__limit",width:16,options:ae,value:Ne,onChange:xt})}),We===R.St.Tags&&(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(M.D,{label:"Match any",description:z,children:(0,D.jsx)(I.d,{id:"grafana-annotations__match-any",value:Re,onChange:ot})}),(0,D.jsx)(M.D,{label:"Tags",description:te,children:(0,D.jsx)(T.$,{allowCustomValue:!0,inputId:"grafana-annotations__tags",onChange:$e,tagOptions:b.vy,tags:Se??[]})})]})]}),Xe===R.nj.TimeRegions&&Be.timeRegion&&(0,D.jsx)(ne,{value:Be.timeRegion,onChange:be})]})}const ce=je=>({container:(0,P.css)({maxWidth:je.spacing(60),marginBottom:je.spacing(2)})});var me=e(11261),ee=e(94515);function de(je,He,Be,Ne){if(!He)return;const Re=(0,ee.iU)(He,Be);if(!Re.length)return;const Se=[],We=[],Ke=[],Xe=He.timezone??Ne;for(const Je of Re){let st=Je.from,pt=Je.to;const xt=(0,U.QZ)(Xe,st);if(xt){const ot=xt.offsetInMins*60*1e3;st+=ot,pt+=ot}Se.push(st),We.push(pt),Ke.push(je)}return{fields:[{name:"time",type:me.PU.time,values:Se,config:{}},{name:"timeEnd",type:me.PU.time,values:We,config:{}},{name:"text",type:me.PU.string,values:Ke,config:{}}],length:Se.length}}let De=100;class fe extends l.iy{constructor(He){super(He),this.annotations={QueryEditor:re,prepareAnnotation(Be){return Be.target=Be.target??{type:Be.type??R.St.Dashboard,limit:Be.limit??100,tags:Be.tags??[],matchAny:Be.matchAny??!1},Be},prepareQuery(Be){let Ne;if((0,t.isString)(Be.datasource)){const We=(0,v.og)(Be.datasource,{returnDefaultAsNull:!1});We&&(Ne=We)}else Ne=Be.datasource;const{filter:Re,...Se}=Be;return{...Se,refId:Be.name,queryType:R.nj.Annotations,datasource:Ne}}}}getDefaultQuery(){return{queryType:R.nj.RandomWalk}}query(He){const Be=[],Ne=[],Re=(0,p.w)();for(const Se of He.targets){if(Se.queryType===R.nj.Annotations)return(0,n.H)(this.getAnnotations({range:He.range,rangeRaw:He.range.raw,annotation:Se,dashboard:(0,u.UA)().getCurrent()}));if(!Se.hide){if(Se.queryType===R.nj.Snapshot){Be.push((0,i.of)({data:(Se.snapshot??[]).map(We=>(0,f.or)(We)),state:a.Gu.Done}));continue}if(Se.queryType===R.nj.TimeRegions){const We=de("",Se.timeRegion,He.range,He.timezone);Be.push((0,i.of)({data:We?[We]:[],state:a.Gu.Done}));continue}if(Se.queryType===R.nj.LiveMeasurements){let We=Re.replace(Se.channel,He.scopedVars);const{filter:Ke}=Se,Xe=(0,c.DG)(We);if(!(0,c.aj)(Xe))continue;const Je={maxLength:He.maxDataPoints??500};Se.buffer?(Je.maxDelta=Se.buffer,Je.maxLength=Je.maxLength*2):He.rangeRaw?.to==="now"&&(Je.maxDelta=He.range.to.valueOf()-He.range.from.valueOf()),Be.push((0,m.oF)().getDataStream({key:`${He.requestId}.${De++}`,addr:Xe,filter:Ke,buffer:Je}))}else Se.queryType||(Se.queryType=R.nj.RandomWalk),Ne.push(Se)}}return Ne.length&&Be.push(super.query({...He,targets:Ne})),Be.length?Be.length===1?Be[0]:(0,s.h)(...Be):(0,i.of)()}listFiles(He,Be){return this.query({targets:[{refId:"A",queryType:R.nj.List,path:He}],maxDataPoints:Be}).pipe((0,r.T)(Ne=>{const Re=Ne.data[0]??new o.k;return new h.R(Re)}))}metricFindQuery(){return Promise.resolve([])}async getAnnotations(He){const Be=He.annotation.target;if(Be?.queryType===R.nj.TimeRegions){const Ke=de(He.annotation.name,Be.timeRegion,He.range,(0,u.UA)().getCurrent()?.timezone);return Promise.resolve({data:Ke?[Ke]:[]})}const Ne=He.annotation,Re=Ne.target,Se={from:He.range.from.valueOf(),to:He.range.to.valueOf(),limit:Re.limit,tags:Re.tags,matchAny:Re.matchAny};if(Re.type===R.St.Dashboard){if(!He.dashboard?.uid)return Promise.resolve({data:[]});Se.dashboardUID=He.dashboard.uid,delete Se.tags}else{if(!Array.isArray(Re.tags)||Re.tags.length===0)return Promise.resolve({data:[]});const Ke=(0,p.w)(),Xe="__delimiter__",Je=[];for(const st of Se.tags){const pt=Ke.replace(st,{},xt=>typeof xt=="string"?xt:xt.join(Xe));for(const xt of pt.split(Xe))Je.push(xt)}Se.tags=Je}const We=await(0,y.AI)().get("/api/annotations",Se,`grafana-data-source-annotations-${Ne.name}-${He.dashboard?.uid}`);return{data:[(0,g.Vc)(We)]}}testDatasource(){return Promise.resolve({message:"",status:""})}}async function Te(){return await(0,d.l)().get("-- Grafana --")}},68706:(G,O,e)=>{"use strict";e.d(O,{St:()=>s,dx:()=>i,nj:()=>t,uJ:()=>n});var t=(r=>(r.LiveMeasurements="measurements",r.Annotations="annotations",r.Snapshot="snapshot",r.TimeRegions="timeRegions",r.RandomWalk="randomWalk",r.List="list",r.Read="read",r.Search="search",r))(t||{});const n={refId:"A",queryType:"randomWalk"},i={refId:"A",datasource:{type:"grafana",uid:"grafana"},queryType:"snapshot",snapshot:[]};var s=(r=>(r.Dashboard="dashboard",r.Tags="tags",r))(s||{})},90478:(G,O,e)=>{"use strict";e.d(O,{H:()=>a,j:()=>o});var t=e(89667),n=e(28138),i=e(57220),s=e(40489),r=e(28444),f=e(68706);function a(h,g){return new Promise(l=>{if(h.datasource?.uid===i.vv){c(g,h),l(!0);return}n.A.publish(new r.bY({title:"Change to panel embedded data",text:"If you want to change the data shown in this panel Grafana will need to remove the panels current query and replace it with a snapshot of the current data. This enables you to edit the data.",yesText:"Continue",icon:"pen",onConfirm:()=>{c(g,h),l(!0)},onDismiss:()=>{l(!1)}}))})}function c(h,g){const l=h.map(m=>(0,t.Nw)(m)),p={refId:"A",queryType:f.nj.Snapshot,snapshot:l,datasource:{uid:i.vv}};g.updateQueries({dataSource:{uid:i.vv},queries:[p]}),g.refresh()}function o(h){return(g,l,p)=>{s.vI(g).subscribe(async m=>{const y=[];m.dataFrames.forEach(d=>{const v=(0,t.Nw)(d);y.push(v)}),h({...f.dx,snapshot:y,file:m.file},l)})}}},64100:(G,O,e)=>{"use strict";e.d(O,{Q$:()=>i,U3:()=>n,ti:()=>s});var t=(r=>(r.Builder="builder",r.Code="code",r))(t||{}),n=(r=>(r.Instant="instant",r.Range="range",r.Stream="stream",r))(n||{}),i=(r=>(r.DataSample="dataSample",r.InfiniteScroll="infiniteScroll",r.LogsSample="logsSample",r.LogsVolume="logsVolume",r))(i||{}),s=(r=>(r.Backward="backward",r.Forward="forward",r))(s||{})},71713:(G,O,e)=>{"use strict";e.d(O,{AW:()=>f,Ay:()=>c,RQ:()=>s,dZ:()=>t,fV:()=>r,vB:()=>a});const t=[{label:"avg",insertText:"avg",documentation:"Calculate the average over dimensions"},{label:"bottomk",insertText:"bottomk",documentation:"Smallest k elements by sample value"},{label:"count",insertText:"count",documentation:"Count number of elements in the vector"},{label:"max",insertText:"max",documentation:"Select maximum over dimensions"},{label:"min",insertText:"min",documentation:"Select minimum over dimensions"},{label:"stddev",insertText:"stddev",documentation:"Calculate population standard deviation over dimensions"},{label:"stdvar",insertText:"stdvar",documentation:"Calculate population standard variance over dimensions"},{label:"sum",insertText:"sum",documentation:"Calculate sum over dimensions"},{label:"topk",insertText:"topk",documentation:"Largest k elements by sample value"}],n=[{label:"json",insertText:"json",documentation:"Extracting labels from the log line using json parser."},{label:"regexp",insertText:'regexp ""',documentation:"Extracting labels from the log line using regexp parser.",move:-1},{label:"logfmt",insertText:"logfmt",documentation:"Extracting labels from the log line using logfmt parser."},{label:"pattern",insertText:"pattern",documentation:"Extracting labels from the log line using pattern parser. Only available in Loki 2.3+."},{label:"unpack",insertText:"unpack",detail:"unpack identifier",documentation:'Parses a JSON log line, unpacking all embedded labels in the pack stage. A special property "_entry" will also be used to replace the original log line. Only available in Loki 2.2+.'}],i=[{label:"unwrap",insertText:"unwrap",detail:"unwrap identifier",documentation:"Take labels and use the values as sample data for metric aggregations."},{label:"label_format",insertText:"label_format",documentation:"Use to rename, modify or add labels. For example, | label_format foo=bar ."},{label:"line_format",insertText:"line_format",documentation:'Rewrites log line content. For example, | line_format "{{.query}} {{.duration}}" .'}],s=[{insertText:"avg_over_time",label:"avg_over_time",detail:"avg_over_time(range-vector)",documentation:"The average of all values in the specified interval."},{insertText:"bytes_over_time",label:"bytes_over_time",detail:"bytes_over_time(range-vector)",documentation:"Counts the amount of bytes used by each log stream for a given range"},{insertText:"bytes_rate",label:"bytes_rate",detail:"bytes_rate(range-vector)",documentation:"Calculates the number of bytes per second for each stream."},{insertText:"first_over_time",label:"first_over_time",detail:"first_over_time(range-vector)",documentation:"The first of all values in the specified interval. Only available in Loki 2.3+."},{insertText:"last_over_time",label:"last_over_time",detail:"last_over_time(range-vector)",documentation:"The last of all values in the specified interval. Only available in Loki 2.3+."},{insertText:"sum_over_time",label:"sum_over_time",detail:"sum_over_time(range-vector)",documentation:"The sum of all values in the specified interval."},{insertText:"count_over_time",label:"count_over_time",detail:"count_over_time(range-vector)",documentation:"The count of all values in the specified interval."},{insertText:"max_over_time",label:"max_over_time",detail:"max_over_time(range-vector)",documentation:"The maximum of all values in the specified interval."},{insertText:"min_over_time",label:"min_over_time",detail:"min_over_time(range-vector)",documentation:"The minimum of all values in the specified interval."},{insertText:"quantile_over_time",label:"quantile_over_time",detail:"quantile_over_time(scalar, range-vector)",documentation:"The \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) of the values in the specified interval."},{insertText:"rate",label:"rate",detail:"rate(v range-vector)",documentation:"Calculates the number of entries per second."},{insertText:"stddev_over_time",label:"stddev_over_time",detail:"stddev_over_time(range-vector)",documentation:"The population standard deviation of the values in the specified interval."},{insertText:"stdvar_over_time",label:"stdvar_over_time",detail:"stdvar_over_time(range-vector)",documentation:"The population standard variance of the values in the specified interval."}],r=[{insertText:"vector",label:"vector",detail:"vector(scalar)",documentation:"Returns the scalar as a vector with no labels."}],f=[...t,...s,...r],a={comment:{pattern:/#.*/},"context-aggregation":{pattern:/((without|by)\s*)\([^)]*\)/,lookbehind:!0,inside:{"label-key":{pattern:/[^(),\s][^,)]*[^),\s]*/,alias:"attr-name"},punctuation:/[()]/}},"context-labels":{pattern:/\{[^}]*(?=}?)/,greedy:!0,inside:{comment:{pattern:/#.*/},"label-key":{pattern:/[a-zA-Z_]\w*(?=\s*(=|!=|=~|!~))/,alias:"attr-name",greedy:!0},"label-value":{pattern:/"(?:\\.|[^\\"])*"/,greedy:!0,alias:"attr-value"},punctuation:/[{]/}},"context-pipe":{pattern:/\s\|[^=~]\s?\w*/i,inside:{"pipe-operator":{pattern:/\|/i,alias:"operator"},"pipe-operations":{pattern:new RegExp(`${[...n,...i].map(o=>o.label).join("|")}`,"i"),alias:"keyword"}}},function:new RegExp(`\\b(?:${f.map(o=>o.label).join("|")})(?=\\s*\\()`,"i"),"context-range":[{pattern:/\[[^\]]*(?=\])/,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}},{pattern:/(offset\s+)\w+/,lookbehind:!0,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}}],quote:{pattern:/"(?:\\.|[^\\"])*"/,alias:"string",greedy:!0},backticks:{pattern:/`(?:\\.|[^\\`])*`/,alias:"string",greedy:!0},number:/\b-?\d+((\.\d*)?([eE][+-]?\d+)?)?\b/,operator:/\s?(\|[=~]?|!=?|<(?:=>?|<|>)?|>[>=]?)\s?/i,punctuation:/[{}(),.]/},c=a},13137:(G,O,e)=>{"use strict";e.d(O,{HD:()=>i,Q$:()=>t.Q$,U3:()=>t.U3,ie:()=>s,ti:()=>t.ti});var t=e(64100),n=(r=>(r.Stream="streams",r.Vector="vector",r.Matrix="matrix",r))(n||{}),i=(r=>(r.Indexed="I",r.StructuredMetadata="S",r.Parsed="P",r))(i||{}),s=(r=>(r[r.LabelNames=0]="LabelNames",r[r.LabelValues=1]="LabelValues",r))(s||{})},14678:(G,O,e)=>{"use strict";e.d(O,{N8:()=>D,qM:()=>u,uv:()=>v});var t=e(2543),n=e.n(t),i=e(62467),s=e(65474),r=e(45650),f=e(69862),a=e(81160),c=e(9084),o=e(66847),h=e(93031),g=e(71030),l=e(40187),p=e(39070),m=e(72574),y=e(19347),d=e(12091);const v="-- Mixed --",u=(x,E)=>`mixed-${x}-${E||""}`;class D extends l.mA{constructor(E){super(E)}query(E){const C=E.targets.filter(I=>I.datasource?.uid!==v);if(!C.length)return(0,i.of)({data:[]});const M=(0,t.groupBy)(C,"datasource.uid"),S=[];for(const I in M)S.push(...this.getBatchesForQueries(M[I],E));return S.length?this.batchQueries(S,E):(0,i.of)({data:[]})}getBatchesForQueries(E,C){const M=E[0].datasource,S=[],I=(0,m.w)().replace(M?.uid,C.scopedVars,(T,b)=>{if(!Array.isArray(T))return T;for(const R of T){if(R==="default")continue;const A=(0,y.l)().getInstanceSettings(R);S.push({datasource:(0,y.l)().get(R),queries:(0,t.cloneDeep)(E),scopedVars:{...C.scopedVars,[b.name]:{value:R,text:A?.name}}})}return""});return I!==""&&S.push({datasource:(0,y.l)().get(I),queries:(0,t.cloneDeep)(E),scopedVars:{...C.scopedVars}}),S}batchQueries(E,C){const M=E.filter(this.isQueryable).map((S,I)=>(0,s.H)(S.datasource).pipe((0,f.Z)(T=>{const b=(0,t.cloneDeep)(C);return b.requestId=u(I,b.requestId),b.targets=S.queries,b.scopedVars=S.scopedVars,(0,s.H)(T.query(b)).pipe((0,a.T)(R=>({...R,data:R.data||[],state:p.Gu.Loading,key:u(I,R.key)})),(0,c.$)(),(0,o.W)(R=>(R=(0,d.u)(R),R.message=`${T.name}: ${R.message}`,(0,i.of)([{data:[],state:p.Gu.Error,error:R,key:u(I,b.requestId)}]))))})));return(0,r.p)(M).pipe(P(),(0,a.T)(this.finalizeResponses),(0,h.U)())}testDatasource(){return Promise.resolve({message:"",status:""})}isQueryable(E){return E&&Array.isArray(E.queries)&&E.queries.length>0}finalizeResponses(E){const{length:C}=E;if(C===0)return E;const M=E.find(S=>S.state===p.Gu.Error);return M?E.push(M):E[C-1].state=p.Gu.Done,E}}function P(){return(0,g.T)((x,E)=>E.reduce((C,M)=>(C.push.apply(C,M),C),x),[])}},19071:(G,O,e)=>{"use strict";e.d(O,{cd:()=>H,xw:()=>U});var t=e(37471),n=e(11261);const i={filters:[],groupBy:[]};var s=(ie=>(ie.Done="done",ie.Error="error",ie.Pending="pending",ie.Streaming="streaming",ie))(s||{}),r=(ie=>(ie.Raw="raw",ie.Spans="spans",ie.Traces="traces",ie))(r||{}),f=(ie=>(ie.Intrinsic="intrinsic",ie.Resource="resource",ie.Span="span",ie.Unscoped="unscoped",ie))(f||{});function a(ie){const{nodes:ae,edges:re}=c(ie),[ce,me]=makeFrames();for(const ee of ae)ce.add(ee);for(const ee of re)me.add(ee);return[ce,me]}function c(ie){const ae=[],re=[],ce=new DataFrameView(ie),me=o(ce),ee=makeSpanMap(de=>{if(de>=ie.length)return;const De=ce.get(de);return{span:{...De},id:De.spanID,parentIds:De.parentSpanID?[De.parentSpanID]:[]}});for(let de=0;de<ce.length;de++){const De=ce.get(de),fe=ee[De.spanID].children.map(Be=>{const Ne=ee[Be].span;return[Ne.startTime,Ne.startTime+Ne.duration]}),Te=getNonOverlappingDuration(fe),je=De.duration-Te,He=getStats(De.duration,me,je);ae.push({[Fields.id]:De.spanID,[Fields.title]:De.serviceName??"",[Fields.subTitle]:De.operationName,[Fields.mainStat]:He.main,[Fields.secondaryStat]:He.secondary,[Fields.color]:je/me}),De.parentSpanID&&ee[De.parentSpanID].span&&re.push({[Fields.id]:De.parentSpanID+"--"+De.spanID,[Fields.target]:De.spanID,[Fields.source]:De.parentSpanID})}return{nodes:ae,edges:re}}function o(ie){let ae=0,re=1/0;for(let ce=0;ce<ie.length;ce++){const me=ie.get(ce);me.startTime<re&&(re=me.startTime),me.startTime+me.duration>ae&&(ae=me.startTime+me.duration)}return ae-re}const h="traces_service_graph_request_server_seconds_sum",g="traces_service_graph_request_total",l="traces_service_graph_request_failed_total",p="traces_service_graph_request_server_seconds_bucket",m={expr:"sum(rate(traces_spanmetrics_calls_total{}[$__range])) by (span_name)",topk:5,params:[]},y={expr:"sum(rate(traces_spanmetrics_calls_total{}[$__range])) by (span_name)",topk:5,params:['status_code="STATUS_CODE_ERROR"']},d={expr:"histogram_quantile(.9, sum(rate(traces_spanmetrics_latency_bucket{}[$__range])) by (le))",params:[]},v='span_kind="SPAN_KIND_SERVER"',u=[h,g,l,p];function D(ie,ae){const re=x(ie),ce={},me={};return C(re[g],"total",g,ce,me),C(re[h],"seconds",h,ce,me),C(re[l],"failed",l,ce,me),M(ce,me,ae)}function P(){function ie(ce,me){return new MutableDataFrame({name:ce,fields:me,meta:{preferredVisualisationType:"nodeGraph"}})}const ae=ie("Nodes",[{name:Fields.id,type:FieldType.string,values:[]},{name:Fields.title,type:FieldType.string,config:{displayName:"Service name"},values:[]},{name:Fields.subTitle,type:FieldType.string,config:{displayName:"Service namespace"},values:[]},{name:Fields.mainStat,type:FieldType.number,config:{unit:"ms/r",displayName:"Average response time"},values:[]},{name:Fields.secondaryStat,type:FieldType.number,config:{unit:"r/sec",displayName:"Requests per second"},values:[]},{name:Fields.arc+"success",type:FieldType.number,config:{displayName:"Success",color:{fixedColor:"green",mode:FieldColorModeId.Fixed}},values:[]},{name:Fields.arc+"failed",type:FieldType.number,config:{displayName:"Failed",color:{fixedColor:"red",mode:FieldColorModeId.Fixed}},values:[]}]),re=ie("Edges",[{name:Fields.id,type:FieldType.string,values:[]},{name:Fields.source,type:FieldType.string,values:[]},{name:"sourceName",type:FieldType.string,values:[]},{name:"sourceNamespace",type:FieldType.string,values:[]},{name:Fields.target,type:FieldType.string,values:[]},{name:"targetName",type:FieldType.string,values:[]},{name:"targetNamespace",type:FieldType.string,values:[]},{name:Fields.mainStat,type:FieldType.number,config:{unit:"ms/r",displayName:"Average response time"},values:[]},{name:Fields.secondaryStat,type:FieldType.number,config:{unit:"r/sec",displayName:"Requests per second"},values:[]}]);return[ae,re]}function x(ie){return(ie[0]?.data||[]).reduce((ae,re)=>{const ce=toDataFrame(re);return ae[ce.refId??"A"]=new DataFrameView(ce),ae},{})}var E=(ie=>(ie.sourceName="sourceName",ie.sourceNamespace="sourceNamespace",ie.targetName="targetName",ie.targetNamespace="targetNamespace",ie))(E||{});function C(ie,ae,re,ce,me){if(!ie)return;const ee=`Value #${re}`;for(let de=0;de<ie.length;de++){const De=ie.get(de),fe=De.server_service_namespace?`${De.server_service_namespace}/${De.server}`:De.server,Te=De.client_service_namespace?`${De.client_service_namespace}/${De.client}`:De.client,je=`${Te}_${fe}`;me[je]?me[je][ae]=(me[je][ae]||0)+De[ee]:me[je]={target:fe,targetName:De.server,targetNamespace:De.server_service_namespace,source:Te,sourceName:De.client,sourceNamespace:De.client_service_namespace,[ae]:De[ee]},ce[fe]?ce[fe][ae]=(ce[fe][ae]||0)+De[ee]:ce[fe]={name:De.server,namespace:De.server_service_namespace,[ae]:De[ee]},ce[Te]||(ce[Te]={name:De.client,namespace:De.client_service_namespace,[ae]:0})}}function M(ie,ae,re){const[ce,me]=P();for(const ee of Object.keys(ie)){const de=ie[ee];ce.add({[Fields.id]:ee,[Fields.title]:de.name,[Fields.subTitle]:de.namespace,[Fields.mainStat]:de.total?de.seconds/de.total*1e3:Number.NaN,[Fields.secondaryStat]:de.total?Math.round(de.total*100)/100:Number.NaN,[Fields.arc+"success"]:de.total?(de.total-Math.min(de.failed||0,de.total))/de.total:1,[Fields.arc+"failed"]:de.total?Math.min(de.failed||0,de.total)/de.total:0})}for(const ee of Object.keys(ae)){const de=ae[ee];me.add({[Fields.id]:ee,[Fields.source]:de.source,sourceName:de.sourceName,sourceNamespace:de.sourceNamespace,[Fields.target]:de.target,targetName:de.targetName,targetNamespace:de.targetNamespace,[Fields.mainStat]:de.total?de.seconds/de.total*1e3:Number.NaN,[Fields.secondaryStat]:de.total?Math.round(de.total*100)/100:Number.NaN})}return{nodes:ce,edges:me}}function S(ie){if(ie.stringValue)return ie.stringValue;if(ie.boolValue!==void 0)return!!ie.boolValue;if(ie.intValue!==void 0)return Number.parseInt(ie.intValue,10);if(ie.doubleValue)return Number.parseFloat(ie.doubleValue);if(ie.arrayValue){const ae=[];for(const re of ie.arrayValue.values)ae.push(S(re));return ae}return""}function I(ie){const ae=[];let re="OTLPResourceNoServiceName";if(!ie)return{serviceName:re,serviceTags:ae};for(const ce of ie.attributes)ce.key===SemanticResourceAttributes.SERVICE_NAME&&(re=ce.value.stringValue||re),ae.push({key:ce.key,value:S(ce.value)});return{serviceName:re,serviceTags:ae}}function T(ie){const ae=[];if(ie.attributes)for(const re of ie.attributes)ae.push({key:re.key,value:S(re.value)});return ae}function b(ie){let ae;if(ie.kind){const re=ie.kind.toString().toLowerCase().split("_");ae=re.length?re[re.length-1]:ie.kind.toString()}return ae}function R(ie){const ae=[];if(ie.links)for(const re of ie.links){const{traceId:ce,spanId:me}=re,ee=[];if(re.attributes)for(const de of re.attributes)ee.push({key:de.key,value:S(de.value)});ae.push({traceID:ce,spanID:me,tags:ee})}return ae}function A(ie){const ae=[];if(ie.events)for(const re of ie.events){const ce=[];if(re.attributes)for(const me of re.attributes)ce.push({key:me.key,value:S(me.value)});ae.push({fields:ce,timestamp:re.timeUnixNano/1e6})}return ae}function L(ie,ae=!1){const re=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string,values:[]},{name:"spanID",type:FieldType.string,values:[]},{name:"parentSpanID",type:FieldType.string,values:[]},{name:"operationName",type:FieldType.string,values:[]},{name:"serviceName",type:FieldType.string,values:[]},{name:"kind",type:FieldType.string,values:[]},{name:"statusCode",type:FieldType.number,values:[]},{name:"statusMessage",type:FieldType.string,values:[]},{name:"instrumentationLibraryName",type:FieldType.string,values:[]},{name:"instrumentationLibraryVersion",type:FieldType.string,values:[]},{name:"traceState",type:FieldType.string,values:[]},{name:"serviceTags",type:FieldType.other,values:[]},{name:"startTime",type:FieldType.number,values:[]},{name:"duration",type:FieldType.number,values:[]},{name:"logs",type:FieldType.other,values:[]},{name:"references",type:FieldType.other,values:[]},{name:"tags",type:FieldType.other,values:[]}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"otlp"}}});try{for(const me of ie){const{serviceName:ee,serviceTags:de}=I(me.resource);for(const De of me.instrumentationLibrarySpans)for(const fe of De.spans)re.add({traceID:fe.traceId.length>16?fe.traceId.slice(16):fe.traceId,spanID:fe.spanId,parentSpanID:fe.parentSpanId||"",operationName:fe.name||"",serviceName:ee,kind:b(fe),statusCode:fe.status?.code,statusMessage:fe.status?.message,instrumentationLibraryName:De.instrumentationLibrary?.name,instrumentationLibraryVersion:De.instrumentationLibrary?.version,traceState:fe.traceState,serviceTags:de,startTime:fe.startTimeUnixNano/1e6,duration:(fe.endTimeUnixNano-fe.startTimeUnixNano)/1e6,tags:T(fe),logs:A(fe),references:R(fe)})}}catch(me){return console.error(me),{error:{message:"JSON is not valid OpenTelemetry format: "+me},data:[]}}let ce=[re];return ae&&ce.push(...createGraphFrames(re)),{data:ce}}function U(ie){let ae={batches:[]},re={};for(let ce=0;ce<ie.length;ce++){const me=ie.get(ce);re[me.serviceName]||(re[me.serviceName]=ae.batches.length,ae.batches.push({resource:{attributes:[],droppedAttributesCount:0},instrumentationLibrarySpans:[{spans:[]}]}));let ee=re[me.serviceName];ae.batches[ee].resource.attributes.length===0&&(ae.batches[ee].resource.attributes=w(me.serviceTags)),ae.batches[ee].instrumentationLibrarySpans[0].instrumentationLibrary||me.instrumentationLibraryName&&(ae.batches[ee].instrumentationLibrarySpans[0].instrumentationLibrary={name:me.instrumentationLibraryName,version:me.instrumentationLibraryVersion?me.instrumentationLibraryVersion:""}),ae.batches[ee].instrumentationLibrarySpans[0].spans.push({traceId:me.traceID.padStart(32,"0"),spanId:me.spanID,parentSpanId:me.parentSpanID||"",traceState:me.traceState||"",name:me.operationName,kind:W(me.kind),startTimeUnixNano:me.startTime*1e6,endTimeUnixNano:(me.startTime+me.duration)*1e6,attributes:me.tags?w(me.tags):[],droppedAttributesCount:0,droppedEventsCount:0,droppedLinksCount:0,status:B(me),events:V(me.logs),links:K(me.references)})}return ae}function W(ie){let ae;if(ie)switch(ie){case"server":ae="SPAN_KIND_SERVER";break;case"client":ae="SPAN_KIND_CLIENT";break;case"producer":ae="SPAN_KIND_PRODUCER";break;case"consumer":ae="SPAN_KIND_CONSUMER";break;case"internal":ae="SPAN_KIND_INTERNAL";break}return ae}function w(ie){return ie.reduce((ae,re)=>[...ae,{key:re.key,value:N(re)}],[])}function N(ie){if(typeof ie.value=="string")return{stringValue:ie.value};if(typeof ie.value=="boolean")return{boolValue:ie.value};if(typeof ie.value=="number")return ie.value%1===0?{intValue:ie.value}:{doubleValue:ie.value};if(typeof ie.value=="object"&&Array.isArray(ie.value)){const ae=[];for(const re of ie.value)ae.push(N(re));return{arrayValue:{values:ae}}}return{stringValue:ie.value}}function B(ie){let ae;return ie.statusCode!==void 0&&(ae={code:ie.statusCode,message:ie.statusMessage?ie.statusMessage:""}),ae}function V(ie){if(!ie||!ie.length)return;let ae=[];for(const re of ie){let ce={timeUnixNano:re.timestamp*1e6,attributes:[],droppedAttributesCount:0,name:""};for(const me of re.fields)ce.attributes.push({key:me.key,value:N(me)});ae.push(ce)}return ae}function K(ie){if(!ie||!ie.length)return;let ae=[];for(const re of ie){let ce={traceId:re.traceID,spanId:re.spanID,attributes:[],droppedAttributesCount:0};if(re.tags?.length)for(const me of re.tags)ce.attributes?.push({key:me.key,value:N(me)});ae.push(ce)}return ae}const H="Related profiles";function X(ie,ae,re=!1){const ce=ie.data[0];if(!ce)return le;const ee=ae?.jsonData?.tracesToProfiles;let de;if(ee?.datasourceUid&&(de=getDataSourceSrv().getInstanceSettings(ee.datasourceUid)),ee&&de){const fe=ee.customQuery?ee.query:void 0,Te={title:H,url:"",internal:{datasourceUid:de.uid,datasourceName:de.name,query:{labelSelector:fe||"{${__tags}}",groupBy:[],profileTypeId:ee.profileTypeId??"",queryType:"profile",spanSelector:['${__span.tags["pyroscope.profile.id"]}'],refId:"profile"}},origin:DataLinkConfigOrigin.Datasource};ce.fields.forEach(je=>{je.name==="tags"&&(je.config.links=[Te])})}let De=[...ie.data];return re&&De.push(...createGraphFrames(toDataFrame(ce))),{...ie,data:De}}function k(ie){return{traceID:ie.traceID,startTime:parseInt(ie.startTimeUnixNano,10)/1e6,traceDuration:ie.durationMs,traceService:ie.rootServiceName||"",traceName:ie.rootTraceName||""}}const Y=ie=>ie.stringValue?`"${ie.stringValue}"`:""+(ie.intValue||ie.doubleValue||ie.boolValue||'""');function Z(ie,ae){return ae.series.map((ce,me)=>{const ee={};ce.labels?.forEach(De=>{ee[De.key]=Y(De.value)});let de=ae.series.length===1?ie:"";return ce.labels&&(ce.labels.length===1?de=Y(ce.labels[0].value):de=`{${ce.labels.map(De=>`${De.key}=${Y(De.value)}`).join(", ")}}`),createDataFrame({refId:de||`A${me}`,fields:[{name:"time",type:FieldType.time,values:ce.samples.map(De=>parseInt(De.timestampMs,10))},{name:de,labels:ee,type:FieldType.number,values:ce.samples.map(De=>De.value),config:{displayNameFromDS:de}}],meta:{preferredVisualisationType:"graph"}})})}function se(ie,ae,re){switch(re){case SearchTableType.Spans:return ne(ie,ae);case SearchTableType.Raw:return j(ie);default:return q(ie,ae)}}function j(ie){return[createDataFrame({name:"Raw response",refId:"raw",fields:[{name:"response",type:FieldType.string,values:[JSON.stringify(ie,null,2)]}]})]}function q(ie,ae){const re=createDataFrame({name:"Traces",refId:"traces",fields:[{name:"traceID",type:FieldType.string,config:{unit:"string",displayNameFromDS:"Trace ID",custom:{width:200},links:[{title:"Trace: ${__value.raw}",url:"",internal:{datasourceUid:ae.uid,datasourceName:ae.name,query:{query:"${__value.raw}",queryType:"traceql"}}}]}},{name:"startTime",type:FieldType.time,config:{displayNameFromDS:"Start time",custom:{width:200}}},{name:"traceService",type:FieldType.string,config:{displayNameFromDS:"Service"}},{name:"traceName",type:FieldType.string,config:{displayNameFromDS:"Name"}},{name:"traceDuration",type:FieldType.number,config:{displayNameFromDS:"Duration",unit:"ms",custom:{width:120}}},{name:"nested",type:FieldType.nestedFrames}],meta:{preferredVisualisationType:"table",uniqueRowIdFields:[0]}});return ie?.length?(re.length=ie.length,ie.sort((ce,me)=>parseInt(me?.startTimeUnixNano,10)/1e6-parseInt(ce?.startTimeUnixNano,10)/1e6).forEach(ce=>{const me=k(ce);re.fields[0].values.push(me.traceID),re.fields[1].values.push(me.startTime),re.fields[2].values.push(me.traceService),re.fields[3].values.push(me.traceName),re.fields[4].values.push(me.traceDuration?me.traceDuration:"<1ms"),ce.spanSets?re.fields[5].values.push(ce.spanSets.map(ee=>z(ce,ee,ae))):ce.spanSet&&re.fields[5].values.push([z(ce,ce.spanSet,ae)])}),[re]):[re]}function ne(ie,ae){const re={};let ce=!1;ie?.forEach(ee=>oe(ee).forEach(de=>{de.attributes?.forEach(De=>{re[De.key]={name:De.key,type:FieldType.string,config:{displayNameFromDS:De.key}}}),de.spans.forEach(De=>{De.name&&(ce=!0),De.attributes?.forEach(fe=>{re[fe.key]={name:fe.key,type:FieldType.string,config:{displayNameFromDS:fe.key}}})})}));const me=new MutableDataFrame({name:"Spans",refId:"traces",fields:[{name:"traceIdHidden",type:FieldType.string,config:{custom:{hidden:!0}}},{name:"traceService",type:FieldType.string,config:{displayNameFromDS:"Trace Service",custom:{width:200}}},{name:"traceName",type:FieldType.string,config:{displayNameFromDS:"Trace Name",custom:{width:200}}},{name:"spanID",type:FieldType.string,config:{unit:"string",displayNameFromDS:"Span ID",custom:{width:200},links:[{title:"Span: ${__value.raw}",url:"",internal:{datasourceUid:ae.uid,datasourceName:ae.name,query:{query:"${__data.fields.traceIdHidden}",queryType:"traceql"},panelsState:{trace:{spanId:"${__value.raw}"}}}}]}},{name:"time",type:FieldType.time,config:{displayNameFromDS:"Start time"}},{name:"name",type:FieldType.string,config:{displayNameFromDS:"Name",custom:{hidden:!ce}}},...Object.values(re).sort((ee,de)=>ee.name.localeCompare(de.name)),{name:"duration",type:FieldType.number,config:{displayNameFromDS:"Duration",unit:"ns",custom:{width:120}}}],meta:{preferredVisualisationType:"table"}});return!ie||!ie.length?[me]:(ie.sort((ee,de)=>parseInt(de?.startTimeUnixNano,10)/1e6-parseInt(ee?.startTimeUnixNano,10)/1e6).forEach(ee=>{oe(ee).forEach(de=>{de.spans.forEach(De=>{me.add(te(De,de,ee))})})}),[me])}const oe=ie=>ie.spanSets||(ie.spanSet?[ie.spanSet]:[]),z=(ie,ae,re)=>{const ce={};let me=!1;ae.attributes?.map(De=>{ce[De.key]={name:De.key,type:FieldType.string,config:{displayNameFromDS:De.key},values:[]}}),ae.spans.forEach(De=>{De.name&&(me=!0),De.attributes?.forEach(fe=>{ce[fe.key]={name:fe.key,type:FieldType.string,config:{displayNameFromDS:fe.key},values:[]}})});const ee=new MutableDataFrame({fields:[{name:"traceIdHidden",type:FieldType.string,config:{custom:{hidden:!0}},values:[]},{name:"spanID",type:FieldType.string,values:[],config:{unit:"string",displayNameFromDS:"Span ID",custom:{width:200},links:[{title:"Span: ${__value.raw}",url:"",internal:{datasourceUid:re.uid,datasourceName:re.name,query:{query:"${__data.fields.traceIdHidden}",queryType:"traceql"},panelsState:{trace:{spanId:"${__value.raw}"}}}}]}},{name:"time",type:FieldType.time,config:{displayNameFromDS:"Start time",custom:{width:200}}},{name:"name",type:FieldType.string,values:[],config:{displayNameFromDS:"Name",custom:{hidden:!me}}},...Object.values(ce).sort((De,fe)=>De.name.localeCompare(fe.name)),{name:"duration",type:FieldType.number,values:[],config:{displayNameFromDS:"Duration",unit:"ns",custom:{width:120}}}],meta:{preferredVisualisationType:"table"}}),de=createTheme();for(const De of ee.fields)De.display=getDisplayProcessor({field:De,theme:de});return ae.spans.forEach(De=>{ee.add(te(De,ae,ie))}),ee};function te(ie,ae,re){const ce=parseInt(ie.startTimeUnixNano,10)/1e6,me={traceIdHidden:re.traceID,traceService:re.rootServiceName||"",traceName:re.rootTraceName||"",spanID:ie.spanID,time:ce,duration:parseInt(ie.durationNanos,10),name:ie.name};let ee=[];return ae.attributes&&(ee=ee.concat(ae.attributes)),ie.attributes&&(ee=ee.concat(ie.attributes)),ee.forEach(de=>{(de.value.boolValue||de.value.Value?.bool_value)&&(me[de.key]=de.value.boolValue||de.value.Value?.bool_value),(de.value.doubleValue||de.value.Value?.double_value)&&(me[de.key]=de.value.doubleValue||de.value.Value?.double_value),(de.value.intValue||de.value.Value?.int_value)&&(me[de.key]=de.value.intValue||de.value.Value?.int_value),(de.value.stringValue||de.value.Value?.string_value)&&(me[de.key]=de.value.stringValue||de.value.Value?.string_value)}),me}const le={data:[new t.k({fields:[{name:"trace",type:n.PU.trace,values:[]}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"otlp"}}})]}},64861:(G,O,e)=>{"use strict";e.d(O,{nE:()=>s,r6:()=>i,xB:()=>t});var t=(r=>(r[r.AlphaAsc=1]="AlphaAsc",r[r.AlphaDesc=2]="AlphaDesc",r[r.Importance=3]="Importance",r[r.TimeAsc=4]="TimeAsc",r[r.TimeDesc=5]="TimeDesc",r))(t||{}),n=(r=>(r.Current="current",r.RecentChanges="changes",r))(n||{}),i=(r=>(r.Default="default",r.Custom="custom",r))(i||{}),s=(r=>(r.List="list",r.Stat="stat",r))(s||{})},39758:(G,O,e)=>{"use strict";e.d(O,{mn:()=>f,ur:()=>n});var t=e(97706);const n=1,i=2,s=3,r=(a,c,o,h)=>(0,t.h)(c+a*(o+h),6);function f(a,c,o,h,g){let l=1-c,p=o===n?l/(a-1):o===i?l/a:o===s?l/(a+1):0;(isNaN(p)||p===1/0)&&(p=0);let m=o===n?0:o===i?p/2:o===s?p:0,y=c/a,d=(0,t.h)(y,6);if(h==null)for(let v=0;v<a;v++)g(v,r(v,m,y,p),d);else g(h,r(h,m,y,p),d)}},4134:(G,O,e)=>{"use strict";e.d(O,{C$:()=>f,HY:()=>r,Tr:()=>s,ur:()=>i});const t=10,n=4;function i(a,c,o,h,g,l){return a>=o&&a<=g&&c>=h&&c<=l}function s(a,c,o){let h=[];if(a.o.length&&h.push(...a.o.filter(g=>(c==null||g.sidx===c)&&(o==null||g.didx===o))),a.q)for(let g=0;g<a.q.length;g++)h.push(...s(a.q[g],c,o));return h}function r(a,c){return a.x<=c.x+c.w&&a.x+a.w>=c.x&&a.y+a.h>=c.y&&a.y<=c.y+c.h}class f{constructor(c,o,h,g,l=0){this.x=c,this.y=o,this.w=h,this.h=g,this.l=l,this.o=[],this.q=null}split(){let c=this,o=c.x,h=c.y,g=c.w/2,l=c.h/2,p=c.l+1;c.q=[new f(o+g,h,g,l,p),new f(o,h,g,l,p),new f(o,h+l,g,l,p),new f(o+g,h+l,g,l,p)]}quads(c,o,h,g,l){let p=this,m=p.q,y=p.x+p.w/2,d=p.y+p.h/2,v=o<d,u=c<y,D=c+h>y,P=o+g>d;v&&D&&l(m[0]),u&&v&&l(m[1]),u&&P&&l(m[2]),D&&P&&l(m[3])}add(c){let o=this;if(o.q!=null)o.quads(c.x,c.y,c.w,c.h,h=>{h.add(c)});else{let h=o.o;if(h.push(c),h.length>t&&o.l<n){o.split();for(let g=0;g<h.length;g++){let l=h[g];o.quads(l.x,l.y,l.w,l.h,p=>{p.add(l)})}o.o.length=0}}}get(c,o,h,g,l){let p=this,m=p.o;for(let y=0;y<m.length;y++)l(m[y]);p.q!=null&&p.quads(c,o,h,g,y=>{y.get(c,o,h,g,l)})}clear(){this.o.length=0,this.q=null}}},58384:(G,O,e)=>{"use strict";e.d(O,{d:()=>p,l:()=>m});var t=e(74848),n=e(2543),i=e.n(n),s=e(96540),r=e(47070),f=e(56323),a=e(52622),c=e(97696),o=e(59796),h=e(12509),g=e(2913),l=e(17516);class p extends s.PureComponent{constructor(){super(...arguments),this.renderComponent=(d,v)=>{const{options:u,fieldConfig:D}=this.props,{value:P,alignmentFactors:x,orientation:E,width:C,height:M,count:S}=d,{field:I,display:T,view:b,colIndex:R}=P,{openMenu:A,targetClassName:L}=v;let U;return b&&(0,n.isNumber)(R)&&(U=b.getFieldDisplayProcessor(R)),(0,t.jsx)(c.xE,{value:m(S,D.defaults,T),width:C,height:M,orientation:E,field:I,text:u.text,display:U,theme:g.config.theme2,itemSpacing:this.getItemSpacing(),displayMode:u.displayMode,onClick:A,className:L,alignmentFactors:S>1?x:void 0,showUnfilled:u.showUnfilled,valueDisplayMode:u.valueMode,namePlacement:u.namePlacement})},this.renderValue=d=>{const{value:v,orientation:u}=d,{hasLinks:D,getLinks:P}=v;return D&&P?(0,t.jsx)("div",{style:{width:"100%",display:u===r.wV.Vertical?"flex":"initial"},children:(0,t.jsx)(o.e,{style:{height:"100%"},links:P,children:x=>this.renderComponent(d,x)})}):this.renderComponent(d,{})},this.getValues=()=>{const{data:d,options:v,replaceVariables:u,fieldConfig:D,timeZone:P}=this.props;return(0,f.PI)({fieldConfig:D,reduceOptions:v.reduceOptions,replaceVariables:u,theme:g.config.theme2,data:d.series,timeZone:P})}}getItemSpacing(){return this.props.options.displayMode==="lcd"?2:10}getOrientation(){const{options:d,width:v,height:u}=this.props,{orientation:D}=d;return D===r.wV.Auto?v>u?r.wV.Vertical:r.wV.Horizontal:D}calcBarSize(){const{options:d}=this.props,v=this.getOrientation(),u=d.sizing===a.T6.Manual,D=v===r.wV.Vertical,P=v===r.wV.Horizontal,x=u&&D?d.minVizWidth:l.K.minVizWidth,E=u&&P?d.minVizHeight:l.K.minVizHeight,C=u&&P?d.maxVizHeight:l.K.maxVizHeight;return{minVizWidth:x,minVizHeight:E,maxVizHeight:C}}render(){const{height:d,width:v,options:u,data:D,renderCounter:P}=this.props,{minVizWidth:x,minVizHeight:E,maxVizHeight:C}=this.calcBarSize();return(0,t.jsx)(h.S,{source:D,getAlignmentFactors:f.XS,getValues:this.getValues,renderValue:this.renderValue,renderCounter:P,width:v,height:d,maxVizHeight:C,minVizWidth:x,minVizHeight:E,itemSpacing:this.getItemSpacing(),orientation:u.orientation})}}function m(y,d,v){return y===1&&!d.displayName?{...v,title:void 0}:v}},17516:(G,O,e)=>{"use strict";e.d(O,{K:()=>n});var t=e(52622);const n={displayMode:t.eX.Gradient,maxVizHeight:300,minVizHeight:16,minVizWidth:8,namePlacement:t.TZ.Auto,showUnfilled:!0,sizing:t.T6.Auto,valueMode:t.$l.Color}},14738:(G,O,e)=>{"use strict";e.r(O),e.d(O,{plugin:()=>E});var t=e(65158),n=e(52622),i=e(71242),s=e(23799),r=e(63250);const f=C=>(0,r._$)(C),a=(C,M,S)=>{const I=(0,r.gl)(C,M,S);if(M==="singlestat"&&S.angular){const T=S.angular.gauge;T&&(I.showThresholdMarkers=T.thresholdMarkers,I.showThresholdLabels=T.thresholdLabels)}return I};var c=e(74848),o=e(96540),h=e(57875),g=e(56323),l=e(95164),p=e(59796),m=e(12509),y=e(2913),d=e(58384);const v={minVizHeight:75,minVizWidth:75,showThresholdLabels:!1,showThresholdMarkers:!0,sizing:n.T6.Auto};class u extends o.PureComponent{constructor(){super(...arguments),this.renderComponent=(M,S)=>{const{options:I,fieldConfig:T}=this.props,{width:b,height:R,count:A,value:L}=M,{field:U,display:W}=L,{openMenu:w,targetClassName:N}=S;return(0,c.jsx)(l._,{value:(0,d.l)(A,T.defaults,W),width:b,height:R,field:U,text:I.text,showThresholdLabels:I.showThresholdLabels,showThresholdMarkers:I.showThresholdMarkers,theme:y.config.theme2,onClick:w,className:N,orientation:I.orientation})},this.renderValue=M=>{const{value:S}=M,{getLinks:I,hasLinks:T}=S;return T&&I?(0,c.jsx)(p.e,{links:I,style:{flexGrow:1},children:b=>this.renderComponent(M,b)}):this.renderComponent(M,{})},this.getValues=()=>{const{data:M,options:S,replaceVariables:I,fieldConfig:T,timeZone:b}=this.props;for(let R of M.series)for(let A of R.fields)if(A.config.unit==="percent"||A.config.unit==="percentunit"){const L=A.config.min??0,U=A.config.max??(A.config.unit==="percent"?100:1);A.state=A.state??{},A.state.range={min:L,max:U,delta:U-L},A.display=(0,h.J)({field:A,theme:y.config.theme2})}return(0,g.PI)({fieldConfig:T,reduceOptions:S.reduceOptions,replaceVariables:I,theme:y.config.theme2,data:M.series,timeZone:b})},this.calculateGaugeSize=()=>{const{options:M}=this.props,S=M.orientation,I=M.sizing===n.T6.Manual,T=S===n.wV.Vertical,b=S===n.wV.Horizontal,R=I&&T?M.minVizWidth:v.minVizWidth,A=I&&b?M.minVizHeight:v.minVizHeight;return{minVizWidth:R,minVizHeight:A}}}render(){const{height:M,width:S,data:I,renderCounter:T,options:b}=this.props,{minVizHeight:R,minVizWidth:A}=this.calculateGaugeSize();return(0,c.jsx)(m.S,{getValues:this.getValues,renderValue:this.renderValue,width:S,height:M,source:I,autoGrid:!0,renderCounter:T,orientation:b.orientation,minVizHeight:R,minVizWidth:A})}}var D=e(50082),P=e(38824);class x{getSuggestionsForData(M){const{dataSummary:S}=M;if(!S.hasData||!S.hasNumberField||S.numberFieldCount>=50)return;const I=M.getListAppender({name:P.m.Gauge,pluginId:"gauge",options:{},fieldConfig:{defaults:{thresholds:{steps:[{value:-1/0,color:"green"},{value:70,color:"orange"},{value:85,color:"red"}],mode:D.O.Percentage},custom:{}},overrides:[]},cardOptions:{previewModifier:T=>{T.options.reduceOptions.values&&(T.options.reduceOptions.limit=2)}}});S.hasStringField&&S.frameCount===1&&S.rowCountTotal<10?(I.append({name:P.m.Gauge,options:{reduceOptions:{values:!0,calcs:[]}}}),I.append({name:P.m.GaugeNoThresholds,options:{reduceOptions:{values:!0,calcs:[]},showThresholdMarkers:!1}})):(I.append({name:P.m.Gauge,options:{reduceOptions:{values:!1,calcs:["lastNotNull"]}}}),I.append({name:P.m.GaugeNoThresholds,options:{reduceOptions:{values:!1,calcs:["lastNotNull"]},showThresholdMarkers:!1}}))}}const E=new t.m(u).useFieldConfig({useCustomConfig:C=>{C.addNumberInput({path:"neutral",name:"Neutral",description:"Leave empty to use Min as neutral point",category:["Gauge"],settings:{placeholder:"auto"}})}}).setPanelOptions(C=>{(0,s.L)(C),(0,s.h)(C),C.addBooleanSwitch({path:"showThresholdLabels",name:"Show threshold labels",description:"Render the threshold values around the gauge bar",defaultValue:v.showThresholdLabels}).addBooleanSwitch({path:"showThresholdMarkers",name:"Show threshold markers",description:"Renders the thresholds as an outer bar",defaultValue:v.showThresholdMarkers}).addRadio({path:"sizing",name:"Gauge size",settings:{options:[{value:n.T6.Auto,label:"Auto"},{value:n.T6.Manual,label:"Manual"}]},defaultValue:v.sizing,showIf:M=>M.orientation!==n.wV.Auto}).addSliderInput({path:"minVizWidth",name:"Min width",description:"Minimum column width (vertical orientation)",defaultValue:v.minVizWidth,settings:{min:0,max:600,step:1},showIf:M=>M.sizing===n.T6.Manual&&M.orientation===n.wV.Vertical}).addSliderInput({path:"minVizHeight",name:"Min height",description:"Minimum row height (horizontal orientation)",defaultValue:v.minVizHeight,settings:{min:0,max:600,step:1},showIf:M=>M.sizing===n.T6.Manual&&M.orientation===n.wV.Horizontal}),i.I(C)}).setPanelChangeHandler(a).setSuggestionsSupplier(new x).setMigrationHandler(f)},19743:(G,O,e)=>{"use strict";e.d(O,{x:()=>r});var t=e(74848),n=e(96540),i=e(1173),s=e(74668);const r=({value:f,context:a,onChange:c})=>{const o=(0,n.useCallback)(h=>{c(h?.length?{id:i.jR.byRefId,options:h}:void 0)},[c]);return(0,t.jsx)(s.X,{value:f?.options,onChange:o,data:a.data,placeholder:"Change filter"})}},33744:(G,O,e)=>{"use strict";e.d(O,{DY:()=>s,G4:()=>a,Sq:()=>o,T5:()=>c,W_:()=>n,_7:()=>i,fX:()=>r,wq:()=>f,yQ:()=>h,yu:()=>g});var t=e(52622),n=(l=>(l.Point="point",l.Line="line",l.Polygon="polygon",l.Any="*any*",l))(n||{});const i=5;var s=(l=>(l.Left="left",l.Center="center",l.Right="right",l))(s||{}),r=(l=>(l.Top="top",l.Middle="middle",l.Bottom="bottom",l))(r||{}),f=(l=>(l.Left="left",l.Center="center",l.Right="right",l))(f||{}),a=(l=>(l.Top="top",l.Center="center",l.Bottom="bottom",l))(a||{});const c=Object.freeze({size:{fixed:i,min:2,max:15},color:{fixed:"dark-green"},opacity:.4,symbol:{mode:t.q_.Fixed,fixed:"img/icons/marker/circle.svg"},symbolAlign:{horizontal:"center",vertical:"center"},textConfig:{fontSize:12,textAlign:"center",textBaseline:"middle",offsetX:0,offsetY:0},rotation:{fixed:0,mode:t.WQ.Mod,min:-360,max:360}});var o=(l=>(l.color="fill",l.opacity="fill-opacity",l.lineWidth="stroke-width",l))(o||{}),h=(l=>(l.color="marker-color",l.size="marker-size",l))(h||{}),g=(l=>(l.color="stroke",l.lineWidth="stroke-width",l))(g||{})},61994:(G,O,e)=>{"use strict";e.d(O,{A:()=>s});var t=e(74848),n=e(32196),i=e(5636);const s=r=>(0,i.gU)(r)?(0,t.jsx)("a",{href:r,target:"_blank",className:(0,n.cx)("external-link"),rel:"noreferrer",children:r}):r},5636:(G,O,e)=>{"use strict";e.d(O,{Bz:()=>l,G_:()=>c,cA:()=>g,gU:()=>y,o3:()=>m,q:()=>p,rd:()=>h,ue:()=>f});var t=e(92347),n=e(40239),i=e(63577),s=e(90183),r=e(33744);function f(d,v,u,D){const P={};return D&&Object.keys(D).length?(P.color=(0,i.getColorDimension)(d,D.color??r.T5.color,u),P.size=(0,i.getScaledDimension)(d,D.size??r.T5.size),P.rotation=(0,i.getScalarDimension)(d,D.rotation??r.T5.rotation),D.text&&(D.text.field||D.text.fixed)&&(P.text=(0,i.getTextDimension)(d,D.text))):v.fields&&(v.fields.color&&(P.color=(0,i.getColorDimension)(d,v.config.color??r.T5.color,u)),v.fields.size&&(P.size=(0,i.getScaledDimension)(d,v.config.size??r.T5.size)),v.fields.text&&(P.text=(0,i.getTextDimension)(d,v.config.text)),v.fields.rotation&&(P.rotation=(0,i.getScalarDimension)(d,v.config.rotation??r.T5.rotation))),P}let a;function c(){return a||(a=[],o()),a}async function o(){const d=await(0,s.o)();for(let v of["maps","gazetteer"])d.listFiles(v).subscribe({next:u=>{u.forEach(D=>{if(D.name.endsWith(".geojson")){const P=`public/${v}/${D.name}`;a.push({value:P,label:P})}})}})}const h=(d,v,u)=>{const D=d.initMapView(v.view);return d.map=new t.A({view:D,pixelRatio:1,layers:[],controls:[],target:u,interactions:(0,n.N)({mouseWheelZoom:!1})})},g=(d,v)=>{d.initControls(v.controls),d.forceUpdate()},l=(d,v,u)=>{d.panelContext&&d.panelContext.onInstanceStateChange&&d.panelContext.onInstanceStateChange({map:d.map,layers:v,selected:u,actions:d.actions})},p=d=>{let v=d.layers.length;for(;v<100;){const u=`Layer ${v++}`;if(!d.byName.has(u))return u}return`Layer ${Date.now()}`};function m(d,v,u,D){const P=d.getPixelFromCoordinate(u),x=d.getPixelFromCoordinate(D),E=Math.abs(P[0]-x[0]),C=Math.abs(P[1]-x[1]);return E>v||C>v}const y=d=>{try{return new URL(d).protocol.includes("http")}catch{return!1}}},52995:(G,O,e)=>{"use strict";e.d(O,{P7:()=>n,uM:()=>i,iS:()=>s,KQ:()=>f});var t=e(52622),n=(a=>(a.Opacity="opacity",a.Scheme="scheme",a))(n||{}),i=(a=>(a.Exponential="exponential",a.Linear="linear",a))(i||{}),s=(a=>(a.X="x",a.Xy="xy",a.Y="y",a))(s||{});const r={calculate:!1,cellGap:1,cellValues:{},color:{scheme:"Oranges",fill:"dark-orange",reverse:!1,exponent:.5,steps:64},exemplars:{color:"rgba(255,0,255,0.7)"},filterValues:{le:1e-9},legend:{show:!0},selectionMode:"x",showValue:t.yL.Auto,tooltip:{mode:t.$N.Single,yHistogram:!1,showColorScale:!1}},f={...r,color:{...r.color,mode:n.Scheme,scale:i.Exponential},yAxis:{...r.yAxis,axisPlacement:t.vM.Left},rowsFrame:{...r.rowsFrame,layout:t.D7.auto}}},69386:(G,O,e)=>{"use strict";e.d(O,{K:()=>h});var t=e(74848),n=e(32196),i=e(70255),s=e(80997),r=e(72724),f=e(40845),a=e(72129);function c({width:l,showImage:p,data:m,index:y}){const d=(0,f.of)(g),v=l>600,u=m.get(y),D=encodeURI(u.title);return(0,t.jsxs)("article",{"aria-labelledby":D,className:(0,n.cx)(d.item,v&&d.itemWide),children:[p&&u.ogImage&&(0,t.jsx)("a",{tabIndex:-1,href:s.sQ.sanitizeUrl(u.link),target:"_blank",rel:"noopener noreferrer",className:(0,n.cx)(d.socialImage,v&&d.socialImageWide),"aria-hidden":!0,children:(0,t.jsx)("img",{src:u.ogImage,alt:u.title})}),(0,t.jsxs)("div",{className:d.body,children:[(0,t.jsxs)("time",{className:d.date,dateTime:(0,r.LE)(u.date,{format:"MMM DD"}),children:[(0,r.LE)(u.date,{format:"MMM DD"})," "]}),(0,t.jsx)("a",{className:d.link,href:s.sQ.sanitizeUrl(u.link),target:"_blank",rel:"noopener noreferrer",children:(0,t.jsx)("h3",{className:d.title,id:D,children:u.title})}),(0,t.jsx)("div",{className:d.content,dangerouslySetInnerHTML:{__html:s.sQ.sanitize(u.content)}})]})]})}const o=({width:l,showImage:p,rootProps:m})=>{const y=(0,f.of)(g),d=l>600;return(0,t.jsxs)("div",{className:(0,n.cx)(y.item,d&&y.itemWide),...m,children:[p&&(0,t.jsx)(i.A,{containerClassName:(0,n.cx)(y.socialImage,d&&y.socialImageWide),width:d?"250px":"100%",height:d?"150px":l*.5}),(0,t.jsxs)("div",{className:y.body,children:[(0,t.jsx)(i.A,{containerClassName:y.date,width:60}),(0,t.jsx)(i.A,{containerClassName:y.title,width:250}),(0,t.jsx)(i.A,{containerClassName:y.content,width:"100%",count:6})]})]})},h=(0,a.j)(c,o),g=l=>({container:(0,n.css)({height:"100%"}),item:(0,n.css)({display:"flex",padding:l.spacing(1),position:"relative",marginBottom:l.spacing(.5),marginRight:l.spacing(1),borderBottom:`2px solid ${l.colors.border.weak}`,background:l.colors.background.primary,flexDirection:"column",flexShrink:0}),itemWide:(0,n.css)({flexDirection:"row"}),body:(0,n.css)({display:"flex",flexDirection:"column",flex:1}),socialImage:(0,n.css)({display:"flex",alignItems:"center",marginBottom:l.spacing(1),"> img":{width:"100%",borderRadius:`${l.shape.radius.default} ${l.shape.radius.default} 0 0`}}),socialImageWide:(0,n.css)({marginRight:l.spacing(2),marginBottom:0,"> img":{width:"250px",borderRadius:l.shape.radius.default}}),link:(0,n.css)({color:l.colors.text.link,display:"inline-block","&:hover":{color:l.colors.text.link,textDecoration:"underline"}}),title:(0,n.css)({fontSize:"16px",marginBottom:l.spacing(.5)}),content:(0,n.css)({p:{marginBottom:l.spacing(.5),color:l.colors.text.primary}}),date:(0,n.css)({marginBottom:l.spacing(.5),fontWeight:500,borderRadius:`0 0 0 ${l.shape.radius.default}`,color:l.colors.text.secondary})})},62372:(G,O,e)=>{"use strict";e.d(O,{$:()=>t});const t="https://grafana.com/blog/news.xml"},4172:(G,O,e)=>{"use strict";e.d(O,{n:()=>l});var t=e(41053),n=e(78368);function i(p){const y=new DOMParser().parseFromString(p,"text/xml");return{items:Array.from(y.querySelectorAll("entry")).map(v=>({title:a(v,"title"),link:v.querySelector("link")?.getAttribute("href")??"",content:a(v,"content"),pubDate:a(v,"published"),ogImage:v.querySelector("meta[property='og:image']")?.getAttribute("content")}))}}function s(p){const y=new DOMParser().parseFromString(p,"text/xml");return{items:Array.from(y.querySelectorAll("item")).map(v=>({title:a(v,"title"),link:a(v,"link"),content:a(v,"description"),pubDate:a(v,"pubDate"),ogImage:v.querySelector("meta[property='og:image']")?.getAttribute("content")}))}}async function r(p){return await(await fetch(p)).text()}function f(p){return new DOMParser().parseFromString(p,"text/xml").querySelector("feed")!==null}function a(p,m){return p.querySelector(m)?.textContent??""}async function c(p){const m=await r(p);return f(m)?i(m):s(m)}var o=e(47232),h=e(11261);function g(p){const m=[],y=[],d=[],v=[],u=[];for(const D of p.items){const P=(0,o.KQ)(D.pubDate);try{if(m.push(P.valueOf()),y.push(D.title),d.push(D.link),u.push(D.ogImage),D.content){const x=D.content.replace(/<\/?[^>]+(>|$)/g,"");v.push(x)}}catch(x){console.warn("Error reading news item:",x,D)}}return{fields:[{name:"date",type:h.PU.time,config:{displayName:"Date"},values:m},{name:"title",type:h.PU.string,config:{},values:y},{name:"link",type:h.PU.string,config:{},values:d},{name:"content",type:h.PU.string,config:{},values:v},{name:"ogImage",type:h.PU.string,config:{},values:u}],length:m.length}}function l(p){const[m,y]=(0,t.A)(async()=>{const d=await c(p),v=g(d);return new n.R(v)},[p],{loading:!0});return{state:m,getNews:y}}},23799:(G,O,e)=>{"use strict";e.d(O,{L:()=>f,h:()=>a});var t=e(69550),n=e(75059),i=e(28240),s=e(54479),r=e(52622);function f(c,o=!0){const h=["Value options"];c.addRadio({path:"reduceOptions.values",name:"Show",description:"Calculate a single value per column or series or show each row",settings:{options:[{value:!1,label:"Calculate"},{value:!0,label:"All values"}]},category:h,defaultValue:!1}),c.addNumberInput({path:"reduceOptions.limit",name:"Limit",description:"Max number of rows to display",category:h,settings:{placeholder:"25",integer:!0,min:1,max:5e3},showIf:g=>g.reduceOptions.values===!0}),c.addCustomEditor({id:"reduceOptions.calcs",path:"reduceOptions.calcs",name:"Calculation",description:"Choose a reducer function / calculation",category:h,editor:t.D.get("stats-picker").editor,defaultValue:[n.gy.lastNotNull],showIf:g=>g.reduceOptions.values===!1}),o&&c.addSelect({path:"reduceOptions.fields",name:"Fields",description:"Select the fields that should be included in the panel",category:h,settings:{allowCustomValue:!0,options:[],getOptions:async g=>{const l=[{value:"",label:"Numeric Fields"},{value:"/.*/",label:"All Fields"}];if(g&&g.data)for(const p of g.data)for(const m of p.fields){const y=(0,i.Ct)(m,p,g.data),d=`/^${(0,s.jD)(y)}$/`;l.push({value:d,label:y})}return Promise.resolve(l)}},defaultValue:""})}function a(c,o){c.addRadio({path:"orientation",name:"Orientation",description:"Layout orientation",category:o,settings:{options:[{value:r.wV.Auto,label:"Auto"},{value:r.wV.Horizontal,label:"Horizontal"},{value:r.wV.Vertical,label:"Vertical"}]},defaultValue:r.wV.Auto})}},36373:(G,O,e)=>{"use strict";e.r(O),e.d(O,{plugin:()=>E});var t=e(65158),n=e(52622),i=e(71242),s=e(63250),r=e(24293);const f=(C,M,S)=>{const I=(0,s.gl)(C,M,S);if(S.angular&&(M==="singlestat"||M==="grafana-singlestat-panel")){const T=S.angular;if(I.graphMode=n.$p.None,T.sparkline&&T.sparkline.show&&(I.graphMode=n.$p.Area),T.colorBackground)I.colorMode=n.yp.Background;else if(T.colorValue)I.colorMode=n.yp.Value;else if(I.colorMode=n.yp.None,T.sparkline?.lineColor&&I.graphMode===n.$p.Area){const b=C.fieldConfig??{};b.defaults.color={mode:r.Y.Fixed,fixedColor:T.sparkline.lineColor},C.fieldConfig=b}T.valueName==="name"&&(I.textMode=n.SV.Name)}return I};var a=e(74848),c=e(2543),o=e(96540),h=e(11261),g=e(56323),l=e(90708),p=e(37494),m=e(59796),y=e(12509),d=e(2913);class v extends o.PureComponent{constructor(){super(...arguments),this.renderComponent=(M,S)=>{const{timeRange:I,options:T}=this.props,{value:b,alignmentFactors:R,width:A,height:L,count:U}=M,{openMenu:W,targetClassName:w}=S;let N=b.sparkline;return N&&(N.timeRange=I),(0,a.jsx)(p.yV,{value:b.display,count:U,sparkline:N,colorMode:T.colorMode,graphMode:T.graphMode,justifyMode:T.justifyMode,textMode:this.getTextMode(),alignmentFactors:R,text:T.text,width:A,height:L,theme:d.config.theme2,onClick:W,className:w,disableWideLayout:!T.wideLayout,percentChangeColorMode:T.percentChangeColorMode})},this.renderValue=M=>{const{value:S}=M,{getLinks:I,hasLinks:T}=S;return T&&I?(0,a.jsx)(m.e,{links:I,children:b=>this.renderComponent(M,b)}):this.renderComponent(M,{})},this.getValues=()=>{const{data:M,options:S,replaceVariables:I,fieldConfig:T,timeZone:b}=this.props;let R;for(let A of M.series)for(let L of A.fields){let{config:U}=L;if(L.type===h.PU.number){if(L.state?.range)continue;!R&&(!(0,c.isNumber)(U.min)||!(0,c.isNumber)(U.max))&&(R=(0,l.nJ)(M.series));const W=U.min??R.min,w=U.max??R.max;L.state=L.state??{},L.state.range={min:W,max:w,delta:w-W}}}return(0,g.PI)({fieldConfig:T,reduceOptions:S.reduceOptions,replaceVariables:I,theme:d.config.theme2,data:M.series,sparkline:S.graphMode!==n.$p.None,percentChange:S.showPercentChange,timeZone:b})}}getTextMode(){const{options:M,fieldConfig:S,title:I}=this.props;return M.textMode===n.SV.Auto&&(S.defaults.displayName||!I)?n.SV.ValueAndName:M.textMode}render(){const{height:M,options:S,width:I,data:T,renderCounter:b}=this.props;return(0,a.jsx)(y.S,{getValues:this.getValues,getAlignmentFactors:g.XS,renderValue:this.renderValue,width:I,height:M,source:T,itemSpacing:3,renderCounter:b,autoGrid:!0,orientation:S.orientation})}}var u=e(23799);const D={colorMode:n.yp.Value,graphMode:n.$p.Area,justifyMode:n.F8.Auto,percentChangeColorMode:n.CD.Standard,showPercentChange:!1,textMode:n.SV.Auto,wideLayout:!0};var P=e(38824);class x{getSuggestionsForData(M){const{dataSummary:S}=M;if(!S.hasData)return;const I=M.getListAppender({name:P.m.Stat,pluginId:"stat",options:{},fieldConfig:{defaults:{unit:"short",custom:{}},overrides:[]},cardOptions:{previewModifier:T=>{T.options.reduceOptions.values&&(T.options.reduceOptions.limit=1)}}});S.hasStringField&&S.hasNumberField&&S.frameCount===1&&S.rowCountTotal<10&&(I.append({name:P.m.Stat,options:{reduceOptions:{values:!0,calcs:[],fields:"/.*/"}}}),I.append({name:P.m.StatColoredBackground,options:{reduceOptions:{values:!0,calcs:[],fields:"/.*/"},colorMode:n.yp.Background}})),S.stringFieldCount===1&&S.frameCount===1&&S.rowCountTotal<10&&S.fieldCount===1&&I.append({name:P.m.Stat,options:{reduceOptions:{values:!0,calcs:[],fields:"/.*/"},colorMode:n.yp.None}}),S.hasNumberField&&S.hasTimeField&&(I.append({options:{reduceOptions:{values:!1,calcs:["lastNotNull"]}}}),I.append({name:P.m.StatColoredBackground,options:{reduceOptions:{values:!1,calcs:["lastNotNull"]},graphMode:n.$p.None,colorMode:n.yp.Background}}))}}const E=new t.m(v).useFieldConfig().setPanelOptions(C=>{const M=["Stat styles"];(0,u.L)(C),(0,u.h)(C,M),i.I(C),C.addSelect({path:"textMode",name:"Text mode",description:"Control if name and value is displayed or just name",category:M,settings:{options:[{value:n.SV.Auto,label:"Auto"},{value:n.SV.Value,label:"Value"},{value:n.SV.ValueAndName,label:"Value and name"},{value:n.SV.Name,label:"Name"},{value:n.SV.None,label:"None"}]},defaultValue:D.textMode}).addRadio({path:"wideLayout",name:"Wide layout",category:M,settings:{options:[{value:!0,label:"On"},{value:!1,label:"Off"}]},defaultValue:D.wideLayout,showIf:S=>S.textMode===n.SV.ValueAndName}),C.addSelect({path:"colorMode",name:"Color mode",defaultValue:n.yp.Value,category:M,settings:{options:[{value:n.yp.None,label:"None"},{value:n.yp.Value,label:"Value"},{value:n.yp.Background,label:"Background Gradient"},{value:n.yp.BackgroundSolid,label:"Background Solid"}]}}).addRadio({path:"graphMode",name:"Graph mode",description:"Stat panel graph / sparkline mode",category:M,defaultValue:D.graphMode,settings:{options:[{value:n.$p.None,label:"None"},{value:n.$p.Area,label:"Area"}]}}).addRadio({path:"justifyMode",name:"Text alignment",defaultValue:D.justifyMode,category:M,settings:{options:[{value:n.F8.Auto,label:"Auto"},{value:n.F8.Center,label:"Center"}]}}).addBooleanSwitch({path:"showPercentChange",name:"Show percent change",defaultValue:D.showPercentChange,category:M,showIf:S=>!S.reduceOptions.values}).addSelect({path:"percentChangeColorMode",name:"Percent change color mode",defaultValue:D.percentChangeColorMode,category:M,settings:{options:[{value:n.CD.Standard,label:"Standard"},{value:n.CD.Inverted,label:"Inverted"},{value:n.CD.SameAsValue,label:"Same as Value"}]},showIf:S=>S.showPercentChange})}).setNoPadding().setPanelChangeHandler(f).setSuggestionsSupplier(new x).setMigrationHandler(s._$)},21164:(G,O,e)=>{"use strict";e.d(O,{u:()=>t});const t=(n,i)=>{const s=[],r=new Set;if((n.config.links?.length??0)>0&&n.getLinks!=null){const f=n.values[i],a=n.display?n.display(f):{text:`${f}`,numeric:+f};n.getLinks({calculatedValue:a,valueRowIndex:i}).forEach(c=>{const o=`${c.title}/${c.href}`;r.has(o)||(s.push(c),r.add(o))})}return s}},65885:(G,O,e)=>{"use strict";e.d(O,{S5:()=>d,fq:()=>f,gy:()=>v,l1:()=>m});var t=e(2543),n=e.n(t),i=e(1173),s=e(50082),r=e(11261);const f=u=>(!u.pluginVersion&&"columns"in u&&console.log("Was angular table",u),u.options),a={timeseries_to_rows:"seriesToRows",timeseries_to_columns:"seriesToColumns",timeseries_aggregations:"reduce",table:"merge"},c={avg:"mean",min:"min",max:"max",total:"sum",current:"lastNotNull",count:"count"},o={cell:"color-background",row:"color-background",value:"color-text"},h=(u,D)=>[-1/0,...u].map((P,x)=>({color:D[x],value:(0,t.isNumber)(P)?P:parseInt(P,10)})),g=(u,D)=>{const P=u.transformations??[];if(Object.keys(a).includes(D.transform)){const x={reducers:[]};D.transform==="timeseries_aggregations"&&(x.includeTimeField=!1,x.reducers=D.columns.map(E=>c[E.value])),P.push({id:a[D.transform],options:x})}return P},l=u=>{const P={matcher:{id:/^\/.*\/$/.test(u.pattern)?i.Ct.byRegexp:i.Ct.byName,options:u.pattern},properties:[]};return u.alias&&P.properties.push({id:"displayName",value:u.alias}),u.unit&&P.properties.push({id:"unit",value:u.unit}),u.decimals&&P.properties.push({id:"decimals",value:u.decimals}),u.type==="date"&&P.properties.push({id:"unit",value:`time: ${u.dateFormat}`}),u.type==="hidden"&&P.properties.push({id:"custom.hidden",value:!0}),u.link&&P.properties.push({id:"links",value:[{title:(0,t.defaultTo)(u.linkTooltip,""),url:(0,t.defaultTo)(u.linkUrl,""),targetBlank:(0,t.defaultTo)(u.linkTargetBlank,!1)}]}),u.colorMode&&P.properties.push({id:"custom.cellOptions",value:{type:o[u.colorMode]}}),u.align&&P.properties.push({id:"custom.align",value:u.align==="auto"?null:u.align}),u.thresholds?.length&&P.properties.push({id:"thresholds",value:{mode:s.O.Absolute,steps:h(u.thresholds,u.colors)}}),P},p=u=>{let D={custom:{}};if(u){if(D=(0,t.omitBy)({unit:u.unit,decimals:u.decimals,displayName:u.alias,custom:{align:u.align==="auto"?null:u.align}},t.isNil),u.thresholds.length){const P={mode:s.O.Absolute,steps:h(u.thresholds,u.colors)};D.thresholds=P}u.colorMode&&(D.custom.cellOptions={type:o[u.colorMode]})}return D},m=(u,D,P)=>{if(D==="table-old"&&P.angular){const x=P.angular,E=g(u,x),C=x.styles.find(I=>I.pattern==="/.*/"),M=p(C),S=x.styles.filter(I=>I.pattern!=="/.*/").map(l);u.transformations=E,u.fieldConfig={defaults:M,overrides:S}}return{}},y=u=>u?.filter(D=>D.meta?.custom?.parentRowIndex===void 0)||[u?.[0]],d=u=>{const D=[];return y(u).filter(x=>!!x&&x.length!==0)?.forEach(x=>{const E=u?.filter(I=>x.refId===I.refId&&I.meta?.custom?.parentRowIndex!==void 0),C=(0,t.groupBy)(E,I=>I.meta?.custom?.parentRowIndex),M=Object.keys(C).map(I=>C[I]),S={...x};E&&E.length>0&&S.fields.push({name:"nested",type:r.PU.nestedFrames,config:{},values:M}),D.push(S)}),D},v=u=>u?.some(D=>D.meta?.custom?.parentRowIndex!==void 0)},11082:(G,O,e)=>{"use strict";e.d(O,{Z:()=>f});var t=e(74848),n=e(66864),i=e(94354),s=e(51275);const r=[{label:"Never",value:!1},{label:"Threshold",value:36e5}],f=({value:a,onChange:c,item:o})=>{const h=typeof a=="number";return r[1].value=h?a:36e5,(0,t.jsxs)(n.Gy,{children:[(0,t.jsx)(i.z,{value:a,options:r,onChange:c}),h&&(0,t.jsx)(s.g,{value:a,onChange:c,inputPrefix:s.F.GreaterThan,isTime:o.settings?.isTime??!1})]})}},43228:(G,O,e)=>{"use strict";e.d(O,{F:()=>h});var t=e(74848),n=e(96540),i=e(66864),s=e(94354),r=e(90182),f=e(29158);const a=[{label:"Solid",value:"solid"},{label:"Dash",value:"dash"},{label:"Dots",value:"dot"}],c=["10, 10","10, 15","10, 20","10, 25","10, 30","10, 40","15, 10","20, 10","25, 10","30, 10","40, 10","50, 10","5, 10","30, 3, 3"].map(l=>({label:l,value:l})),o=["0, 10","0, 20","0, 30","0, 40","0, 3, 3"].map(l=>({label:l,value:l})),h=({value:l,onChange:p})=>{const m=(0,n.useMemo)(()=>l?.fill==="dash"?c:o,[l]),y=(0,n.useMemo)(()=>{if(!l?.dash?.length)return m[0];const d=l.dash?.join(", "),v=m.find(u=>u.value===d);return v||{label:d,value:d}},[l,m]);return(0,t.jsxs)(i.Gy,{children:[(0,t.jsx)(s.z,{value:l?.fill||"solid",options:a,onChange:d=>{let v;d==="dot"?v=g(o[0].value):d==="dash"&&(v=g(c[0].value)),p({...l,fill:d,dash:v})}}),l?.fill&&l?.fill!=="solid"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.l6,{allowCustomValue:!0,options:m,value:y,width:20,onChange:d=>{p({...l,dash:g(d.value??"")})},formatCreateLabel:d=>`Segments: ${g(d).join(", ")}`}),(0,t.jsxs)("div",{children:["\xA0",(0,t.jsx)("a",{title:"The input expects a segment list",href:"https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/setLineDash#Parameters",target:"_blank",rel:"noreferrer",children:(0,t.jsx)(f.K,{name:"question-circle",tooltip:"Help"})})]})]})]})};function g(l){const p=[];for(const m of l.split(/(?:,| )+/)){const y=Number.parseInt(m,10);isNaN(y)||p.push(y)}return p}},51275:(G,O,e)=>{"use strict";e.d(O,{F:()=>s,g:()=>r});var t=e(74848),n=e(65879),i=e(10354),s=(f=>(f.LessThan="lessthan",f.GreaterThan="greaterthan",f))(s||{});const r=({value:f,onChange:a,inputPrefix:c,isTime:o})=>{let h=n.secondsToHms(f/1e3);o||(h="10");const g=y=>{let d=!1;if(y)try{o&&n.isValidTimeSpan(y)?d=n.intervalToMs(y):d=Number(y)}catch(v){console.warn("ERROR",v)}a(d)},l=y=>{y.key==="Enter"&&g(y.currentTarget.value)},p=y=>{g(y.currentTarget.value)},m=c==="greaterthan"?(0,t.jsx)("div",{children:">"}):c==="lessthan"?(0,t.jsx)("div",{children:"<"}):null;return(0,t.jsx)(i.p,{autoFocus:!1,placeholder:"never",width:10,defaultValue:h,onKeyDown:l,onBlur:p,prefix:m,spellCheck:!1})}},34163:(G,O,e)=>{"use strict";e.d(O,{e:()=>f});var t=e(74848),n=e(66864),i=e(94354),s=e(51275);const r=[{label:"Never",value:!1},{label:"Always",value:!0},{label:"Threshold",value:36e5}],f=({value:a,onChange:c,item:o})=>{const h=typeof a=="number";return r[2].value=h?a:36e5,(0,t.jsxs)(n.Gy,{children:[(0,t.jsx)(i.z,{value:a,options:r,onChange:c}),h&&(0,t.jsx)(s.g,{value:a,onChange:c,inputPrefix:s.F.LessThan,isTime:o.settings?.isTime??!1})]})}},24882:(G,O,e)=>{"use strict";e.d(O,{D:()=>s});var t=e(74848),n=e(96540),i=e(90182);const s=({item:r,value:f,onChange:a,id:c})=>{const o=(0,n.useCallback)(h=>{a({mode:h.value})},[a]);return(0,t.jsx)(i.l6,{inputId:c,value:f.mode,options:r.settings?.options??[],onChange:o})}},22731:(G,O,e)=>{"use strict";e.d(O,{$:()=>y,k:()=>m});var t=e(74848),n=e(32196),i=e(83195),s=e(11261),r=e(52622),f=e(40845),a=e(11389),c=e(58749),o=e(52415),h=e(10875),g=e(21164),l=e(5514),p=e(82915);const m=({series:d,_rest:v,dataIdxs:u,seriesIdx:D,mode:P=r.$N.Single,sortOrder:x=r.xB.None,isPinned:E,annotate:C,maxHeight:M})=>{const S=(0,f.of)(y),I=d.fields[0],T=(0,i.cN)(I.display(I.values[u[0]])),b=(0,h.cp)(d.fields,I,u,D,P,x,L=>L.type===s.PU.number||L.type===s.PU.enum);v?.forEach(L=>{L.config.custom?.hideFrom?.tooltip||b.push({label:L.state?.displayName??L.name,value:(0,l.S)(L,L.values[u[0]])})});let R;if(E&&D!=null){const L=d.fields[D],U=u[D],W=(0,g.u)(L,U);R=(0,t.jsx)(c.S,{dataLinks:W,annotate:C})}const A=I.config.custom?.hideFrom?.tooltip?null:{label:I.type===s.PU.time?"":I.state?.displayName??I.name,value:T};return(0,t.jsxs)("div",{className:S.wrapper,children:[A!=null&&(0,t.jsx)(o.A,{item:A,isPinned:E}),(0,t.jsx)(a.o,{items:b,isPinned:E,scrollable:(0,p.T5)({mode:P,maxHeight:M}),maxHeight:M}),R]})},y=()=>({wrapper:(0,n.css)({display:"flex",flexDirection:"column"})})},41706:(G,O,e)=>{"use strict";e.d(O,{S:()=>m,V:()=>d});var t=e(37055),n=e(24293),i=e(11261),s=e(27310),r=e(52622),f=e(52198),a=e(56675),c=e(38248),o=e(11404),h=e(11082),g=e(43228),l=e(34163),p=e(24882);const m={drawStyle:r.GR.Line,lineInterpolation:r.dx.Linear,lineWidth:1,fillOpacity:0,gradientMode:r.on.None,barAlignment:r.Nj.Center,barWidthFactor:.6,stacking:{mode:r.gs.None,group:"A"},axisGridShow:!0,axisCenteredZero:!1,axisBorderShow:!1},y=["Graph styles"];function d(v,u=!0){return{standardOptions:{[t.uo.Color]:{settings:{byValueSupport:!0,bySeriesSupport:!0,preferThresholdsMode:!1},defaultValue:{mode:n.Y.PaletteClassic}}},useCustomConfig:D=>{D.addRadio({path:"drawStyle",name:"Style",category:y,defaultValue:v.drawStyle,settings:{options:f.t.drawStyle}}).addRadio({path:"lineInterpolation",name:"Line interpolation",category:y,defaultValue:v.lineInterpolation,settings:{options:f.t.lineInterpolation},showIf:P=>P.drawStyle===r.GR.Line}).addRadio({path:"barAlignment",name:"Bar alignment",category:y,defaultValue:v.barAlignment,settings:{options:f.t.barAlignment},showIf:P=>P.drawStyle===r.GR.Bars}).addSliderInput({path:"barWidthFactor",name:"Bar width factor",category:y,defaultValue:v.barWidthFactor,settings:{min:.1,max:1,step:.1,ariaLabelForHandle:"Bar width factor"},showIf:P=>P.drawStyle===r.GR.Bars}).addSliderInput({path:"lineWidth",name:"Line width",category:y,defaultValue:v.lineWidth,settings:{min:0,max:10,step:1,ariaLabelForHandle:"Line width"},showIf:P=>P.drawStyle!==r.GR.Points}).addSliderInput({path:"fillOpacity",name:"Fill opacity",category:y,defaultValue:v.fillOpacity,settings:{min:0,max:100,step:1,ariaLabelForHandle:"Fill opacity"},showIf:P=>P.drawStyle!==r.GR.Points}).addRadio({path:"gradientMode",name:"Gradient mode",category:y,defaultValue:f.t.fillGradient[0].value,settings:{options:f.t.fillGradient},showIf:P=>P.drawStyle!==r.GR.Points}).addFieldNamePicker({path:"fillBelowTo",name:"Fill below to",category:y,hideFromDefaults:!0,settings:{filter:P=>P.type===i.PU.number}}).addCustomEditor({id:"lineStyle",path:"lineStyle",name:"Line style",category:y,showIf:P=>P.drawStyle===r.GR.Line,editor:g.F,override:g.F,process:s.hS,shouldApply:P=>P.type===i.PU.number}).addCustomEditor({id:"spanNulls",path:"spanNulls",name:"Connect null values",category:y,defaultValue:!1,editor:l.e,override:l.e,showIf:P=>P.drawStyle===r.GR.Line,shouldApply:P=>P.type!==i.PU.time,process:s.hS,settings:{isTime:u}}).addCustomEditor({id:"insertNulls",path:"insertNulls",name:"Disconnect values",category:y,defaultValue:!1,editor:h.Z,override:h.Z,showIf:P=>P.drawStyle===r.GR.Line,shouldApply:P=>P.type!==i.PU.time,process:s.hS,settings:{isTime:u}}).addRadio({path:"showPoints",name:"Show points",category:y,defaultValue:f.t.showPoints[0].value,settings:{options:f.t.showPoints},showIf:P=>P.drawStyle!==r.GR.Points}).addSliderInput({path:"pointSize",name:"Point size",category:y,defaultValue:5,settings:{min:1,max:40,step:1,ariaLabelForHandle:"Point size"},showIf:P=>P.showPoints!==r.yL.Never||P.drawStyle===r.GR.Points}),a.I(D,v.stacking,y),D.addSelect({category:y,name:"Transform",path:"transform",settings:{options:[{label:"Constant",value:r.NU.Constant,description:"The first value will be shown as a constant line"},{label:"Negative Y",value:r.NU.NegativeY,description:"Flip the results to negative values on the y axis"}],isClearable:!0},hideFromDefaults:!0}),c.r(D,v),o.e(D),D.addCustomEditor({id:"thresholdsStyle",path:"thresholdsStyle",name:"Show thresholds",category:["Thresholds"],defaultValue:{mode:r.Ly.Off},settings:{options:f.t.thresholdsDisplayModes},editor:p.D,override:p.D,process:s.hS,shouldApply:()=>!0})}}}},62567:(G,O,e)=>{"use strict";e.d(O,{W:()=>ne});var t=e(74848),n=e(32196),i=e(96540),s=e(40961),r=e(84140),f=e(36613),a=e(33948),c=e(52622),o=e(23596),h=e(24284),g=e(17464),l=e(40845),p=e(7315),m=e(36376),y=e(13544),d=e(49785),v=e(29647),u=e(41053),D=e(72724),P=e(42994),x=e(79041),E=e(67061),C=e(88575),M=e(21744),S=e(55852),I=e(72235),T=e(99818),b=e(10154);const R=({annoVals:z,annoIdx:te,dismiss:le,timeZone:ie,...ae})=>{const re=(0,l.of)(A),{onAnnotationCreate:ce,onAnnotationUpdate:me}=(0,x.d2)(),ee=(0,i.useRef)(null);(0,v.A)(ee,le);const[de,De]=(0,u.A)(async Ke=>{const Xe=await ce(Ke);return le(),Xe}),[fe,Te]=(0,u.A)(async Ke=>{const Xe=await me(Ke);return le(),Xe}),je=Ke=>(0,D.LE)(Ke,{format:P.WC.fullDate,timeZone:ie}),He=z.id?.[te]!=null,Be=z.isRegion?.[te],Ne=He?Te:De,Re=He?fe:de,Se=Be?`${je(z.time[te])} - ${je(z.timeEnd[te])}`:je(z.time[te]),We=({tags:Ke,description:Xe})=>{Ne({id:z.id?.[te]??void 0,tags:Ke,description:Xe,from:Math.round(z.time[te]),to:Math.round(z.timeEnd?.[te]??z.time[te])})};return(0,t.jsxs)("div",{ref:ee,className:re.editor,...ae,children:[(0,t.jsx)("div",{className:re.header,children:(0,t.jsxs)(E.B,{justifyContent:"space-between",alignItems:"center",children:[(0,t.jsx)("div",{children:He?"Edit annotation":"Add annotation"}),(0,t.jsx)("div",{children:Se})]})}),(0,t.jsx)(I.l,{onSubmit:We,defaultValues:{description:z.text?.[te],tags:z.tags?.[te]||[]},children:({register:Ke,errors:Xe,control:Je})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:re.content,children:[(0,t.jsx)(C.D,{label:"Description",invalid:!!Xe.description,error:Xe?.description?.message,children:(0,t.jsx)(M.f,{className:re.textarea,...Ke("description",{required:"Annotation description is required"})})}),(0,t.jsx)(C.D,{label:"Tags",children:(0,t.jsx)(d.xI,{control:Je,name:"tags",render:({field:{ref:st,onChange:pt,...xt}})=>(0,t.jsx)(T.$,{allowCustomValue:!0,placeholder:"Add tags",onChange:pt,tagOptions:b.vy,tags:xt.value})})})]}),(0,t.jsx)("div",{className:re.footer,children:(0,t.jsxs)(E.B,{justifyContent:"flex-end",children:[(0,t.jsx)(S.$n,{size:"sm",variant:"secondary",onClick:le,fill:"outline",children:"Cancel"}),(0,t.jsx)(S.$n,{size:"sm",type:"submit",disabled:Re?.loading,children:Re?.loading?"Saving":"Save"})]})})]})})]})},A=z=>({editor:(0,n.css)({background:z.colors.background.primary,border:`1px solid ${z.colors.border.weak}`,borderRadius:z.shape.radius.default,boxShadow:z.shadows.z3,userSelect:"text",width:"460px"}),content:(0,n.css)({padding:z.spacing(1)}),header:(0,n.css)({borderBottom:`1px solid ${z.colors.border.weak}`,padding:z.spacing(.5,1),fontWeight:z.typography.fontWeightBold,fontSize:z.typography.fontSize,color:z.colors.text.primary}),footer:(0,n.css)({borderTop:`1px solid ${z.colors.border.weak}`,padding:z.spacing(1,1)}),textarea:(0,n.css)({color:z.colors.text.secondary,fontSize:z.typography.bodySmall.fontSize})});var L=e(80997),U=e(66864),W=e(29158),w=e(78369),N=e(55907);const B=()=>!1,V=({annoVals:z,annoIdx:te,timeZone:le,onEdit:ie})=>{const ae=z.id?.[te],re=(0,l.of)(K),{canEditAnnotations:ce=B,canDeleteAnnotations:me=B,onAnnotationDelete:ee}=(0,x.d2)(),de=z.dashboardUID?.[te],De=ce(de),fe=me(de)&&ee!=null,Te=Se=>(0,D.LE)(Se,{format:P.WC.fullDate,timeZone:le});let je=Te(z.time[te]),He=z.text?.[te]??"";z.isRegion?.[te]&&(je+=" - "+Te(z.timeEnd[te]));let Be;z.login?.[te]&&z.avatarUrl?.[te]&&(Be=(0,t.jsx)("img",{className:re.avatar,alt:"Annotation avatar",src:z.avatarUrl[te]}));let Ne=null,Re="";if(z.alertId?.[te]!==void 0&&z.newState?.[te]){const Se=N.A.getStateDisplayModel(z.newState[te]);Ne=(0,t.jsx)("div",{className:re.alertState,children:(0,t.jsx)("i",{className:Se.stateClass,children:Se.text})}),Re=z.data?.[te]?N.A.getAlertAnnotationText(z.data[te]):""}else z.title?.[te]&&(He=z.title[te]+(He?`<br />${He}`:""));return(0,t.jsxs)("div",{className:re.wrapper,children:[(0,t.jsx)("div",{className:re.header,children:(0,t.jsxs)(U.Gy,{justify:"space-between",align:"center",spacing:"md",children:[(0,t.jsxs)("div",{className:re.meta,children:[(0,t.jsxs)("span",{children:[Be,Ne]}),je]}),(De||fe)&&(0,t.jsxs)("div",{className:re.editControls,children:[De&&(0,t.jsx)(W.K,{name:"pen",size:"sm",onClick:ie,tooltip:"Edit"}),fe&&(0,t.jsx)(W.K,{name:"trash-alt",size:"sm",onClick:()=>ee(ae),tooltip:"Delete"})]})]})}),(0,t.jsxs)("div",{className:re.body,children:[He&&(0,t.jsx)("div",{className:re.text,dangerouslySetInnerHTML:{__html:L.sQ.sanitize(He)}}),Re,(0,t.jsx)("div",{children:(0,t.jsx)(U.Gy,{spacing:"xs",wrap:!0,children:z.tags?.[te]?.map((Se,We)=>(0,t.jsx)(w.v,{name:Se},`${Se}-${We}`))})})]})]})},K=z=>({wrapper:(0,n.css)({zIndex:z.zIndex.tooltip,whiteSpace:"initial",borderRadius:z.shape.radius.default,background:z.colors.background.primary,border:`1px solid ${z.colors.border.weak}`,boxShadow:z.shadows.z2,userSelect:"text"}),header:(0,n.css)({padding:z.spacing(.5,1),borderBottom:`1px solid ${z.colors.border.weak}`,fontWeight:z.typography.fontWeightBold,fontSize:z.typography.fontSize,color:z.colors.text.primary,display:"flex"}),meta:(0,n.css)({display:"flex",justifyContent:"space-between",color:z.colors.text.primary,fontWeight:400}),editControls:(0,n.css)({display:"flex",alignItems:"center","> :last-child":{marginLeft:0}}),body:(0,n.css)({padding:z.spacing(1),fontSize:z.typography.bodySmall.fontSize,color:z.colors.text.secondary,fontWeight:400,a:{color:z.colors.text.link,"&:hover":{textDecoration:"underline"}}}),text:(0,n.css)({paddingBottom:z.spacing(1)}),avatar:(0,n.css)({borderRadius:z.shape.radius.circle,width:16,height:16,marginRight:z.spacing(1)}),alertState:(0,n.css)({paddingRight:z.spacing(1),fontWeight:z.typography.fontWeightMedium})}),H=0,X=1,k=2,Y=({annoVals:z,annoIdx:te,className:le,style:ie,exitWipEdit:ae,timeZone:re,portalRoot:ce})=>{const me=(0,l.of)(Z),[ee,de]=(0,i.useState)(ae!=null?X:H),{refs:De,floatingStyles:fe}=(0,m.we)({open:!0,placement:"bottom",middleware:[(0,p.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,p.BN)()],whileElementsMounted:p.ll,strategy:"fixed"}),Te=ee===k?(0,t.jsx)(V,{annoIdx:te,annoVals:z,timeZone:re,onEdit:()=>de(X)}):ee===X?(0,t.jsx)(R,{annoIdx:te,annoVals:z,timeZone:re,dismiss:()=>{ae?.(),de(H)}}):null;return(0,t.jsx)("div",{ref:De.setReference,className:le,style:ie,onMouseEnter:()=>ee!==X&&de(k),onMouseLeave:()=>ee!==X&&de(H),"data-testid":y.Tp.pages.Dashboard.Annotations.marker,children:Te&&(0,s.createPortal)((0,t.jsx)("div",{ref:De.setFloating,className:me.annoBox,style:fe,"data-testid":"annotation-marker",children:Te}),ce)})},Z=z=>({annoBox:(0,n.css)({top:0,left:0,zIndex:z.zIndex.tooltip,borderRadius:z.shape.radius.default,position:"absolute",background:z.colors.background.primary,border:`1px solid ${z.colors.border.weak}`,boxShadow:z.shadows.z2,userSelect:"text",minWidth:"300px"})}),se=(z,te,le,ie,ae)=>{z.beginPath(),z.moveTo(ie,te),z.lineTo(ie,le),z.strokeStyle=ae,z.stroke()},j=(0,r.A)(h.Mk).toHex8String();function q(z){let te={};return z.fields.forEach(le=>{te[le.name]=le.values}),te}const ne=({annotations:z,timeZone:te,config:le,newRange:ie,setNewRange:ae,canvasRegionRendering:re=!0})=>{const[ce,me]=(0,i.useState)(),[ee]=(0,i.useState)(()=>(0,g.gF)()),de=(0,l.of)(oe),De=(0,l.$j)().visualization.getColorByName,[fe,Te]=(0,i.useReducer)(Se=>Se+1,0),je=(0,i.useMemo)(()=>{let Se=z.filter(We=>We.name!=="exemplar"&&We.length>0&&We.fields.some(Ke=>Ke.name==="time"));if(ie){let We=ie.to>ie.from;const Ke=(0,a.I)([{time:ie.from,timeEnd:We?ie.to:null,isRegion:We,color:j}]);Ke.meta={dataTopic:c.QR.Annotations,custom:{isWip:!0}},Se.push(Ke)}return Se},[z,ie]),He=(0,i.useCallback)(()=>{ae(null)},[ae]),Be=(0,i.useRef)(je);Be.current=je;const Ne=(0,i.useRef)(ie);Ne.current=ie;const Re=(0,i.useRef)();if((0,i.useLayoutEffect)(()=>{le.addHook("ready",Se=>{let We=Se.root.querySelector(".u-axis");Re.current=We,me(Se)}),le.addHook("draw",Se=>{let We=Be.current;const Ke=Se.ctx;Ke.save(),Ke.beginPath(),Ke.rect(Se.bbox.left,Se.bbox.top,Se.bbox.width,Se.bbox.height),Ke.clip(),We.forEach(Xe=>{let Je=q(Xe);if(Xe.name==="xymark"){let st=le.scales[0].props.scaleKey,pt=le.scales[1].props.scaleKey;for(let xt=0;xt<Xe.length;xt++){let ot=De(Je.color?.[xt]||j),$e=Se.valToPos(Je.xMin[xt],st,!0),ve=Se.valToPos(Je.xMax[xt],st,!0),be=Se.valToPos(Je.yMax[xt],pt,!0),he=Se.valToPos(Je.yMin[xt],pt,!0);Ke.fillStyle=o.MV.alpha(ot,Je.fillOpacity[xt]),Ke.fillRect($e,be,ve-$e,he-be),Ke.lineWidth=Math.round(Je.lineWidth[xt]*f.A.pxRatio),Je.lineStyle[xt]==="dash"?Ke.setLineDash([5,5]):Ke.setLineDash([]),Ke.strokeStyle=ot,Ke.strokeRect($e,be,ve-$e,he-be)}}else{let st=Se.bbox.top,pt=st+Se.bbox.height;Ke.lineWidth=2,Ke.setLineDash([5,5]);for(let xt=0;xt<Je.time.length;xt++){let ot=De(Je.color?.[xt]||j),$e=Se.valToPos(Je.time[xt],"x",!0);if(!Je.isRegion?.[xt])se(Ke,st,pt,$e,ot);else if(re){se(Ke,st,pt,$e,ot);let ve=Se.valToPos(Je.timeEnd[xt],"x",!0);se(Ke,st,pt,ve,ot),Ke.fillStyle=o.MV.alpha(ot,.1),Ke.fillRect($e,st,ve-$e,Se.bbox.height)}}}}),Ke.restore()})},[le,re,De]),(0,i.useEffect)(()=>{ce&&(ce.redraw(),setTimeout(()=>{Te()},0))},[je,ce]),ce){let Se=je.flatMap((We,Ke)=>{let Xe=q(We),Je=[];for(let st=0;st<Xe.time.length;st++){let pt=De(Xe.color?.[st]||h.Mk),xt=Math.round(ce.valToPos(Xe.time[st],"x"))||0,ot=null,$e="",ve=!0;if(Xe.isRegion?.[st]){let be=Math.round(ce.valToPos(Xe.timeEnd?.[st],"x"))||0;if(ve=xt<ce.rect.width&&be>0,ve){let he=Math.max(0,xt),ye=Math.min(ce.rect.width,be);ot={left:he,background:pt,width:ye-he},$e=de.annoRegion}}else ve=xt>=0&&xt<=ce.rect.width,ve&&(ot={left:xt,borderBottomColor:pt},$e=de.annoMarker);if(ve){let be=We.meta?.custom?.isWip;Je.push((0,t.jsx)(Y,{annoIdx:st,annoVals:Xe,className:$e,style:ot,timeZone:te,exitWipEdit:be?He:null,portalRoot:ee},`${Ke}:${st}`))}}return Je});return(0,s.createPortal)(Se,Re.current)}return null},oe=()=>({annoMarker:(0,n.css)({position:"absolute",width:0,height:0,borderLeft:"5px solid transparent",borderRight:"5px solid transparent",borderBottomWidth:"5px",borderBottomStyle:"solid",transform:"translateX(-50%)",cursor:"pointer",zIndex:1}),annoRegion:(0,n.css)({position:"absolute",height:"5px",cursor:"pointer",zIndex:1})})},7874:(G,O,e)=>{"use strict";e.d(O,{U:()=>s});var t=e(74848),n=e(96540),i=e(55852);const s=({config:r,onChangeTimeRange:f})=>{const a=(0,n.useRef)(),[c,o]=(0,n.useState)([]),[h,g]=(0,n.useState)();if((0,n.useLayoutEffect)(()=>{r.addHook("init",u=>{a.current=u}),r.addHook("setScale",u=>{o(u.data?.[0]??[]),g(u.scales.x??void 0)})},[r]),c.length<2||!f||!h||!h.time||!h.min||!h.max)return null;let l=0,p=c.length-1;for(;l<=p&&c[l]==null;)l++;for(;p>=0&&c[p]==null;)p--;const m=c[l],y=c[p],d=h.min,v=h.max;return m==null||y==null||m<=v&&y>=d?null:(0,t.jsx)("div",{style:{position:"absolute",top:"50%",transform:"translateY(-50%)",width:"100%",textAlign:"center"},children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{children:"Data outside time range"}),(0,t.jsx)(i.$n,{onClick:u=>f({from:m,to:y}),variant:"secondary","data-testid":"time-series-zoom-to-data",children:"Zoom to data"})]})})};s.displayName="OutsideRangePlugin"},82915:(G,O,e)=>{"use strict";e.d(O,{B_:()=>g,Fg:()=>m,O2:()=>p,T5:()=>y});var t=e(11261),n=e(28240),i=e(83195),s=e(57875),r=e(50311),f=e(46294),a=e(39624),c=e(52622),o=e(55129);function h(d){let v=new Map;return d.map(D=>({...D,fields:D.fields.map(P=>{if(P.type===t.PU.enum){let x=(0,o.M)(P.config,P.type),E=v.get(x);E||(E=[],v.set(x,E));let C=P.values.toArray().slice(),M=P.config.type.enum.text;if(E.length>0)for(let S=0;S<C.length;S++)C[S]+=E.length;return E.push(...M),P.config.type.enum.text=E,{...P,values:C}}return P})}))}function g(d,v,u,D){if(!d?.length)return null;(0,n.Fm)(d);let P=D!=null;D!=null&&D>0&&(d=[{...d[0],fields:[d[0].fields[D],...d[0].fields.filter((M,S)=>S!==D)]}]);for(let M of d)for(let S of M.fields)S.type===t.PU.time&&typeof S.values[0]!="number"&&(S.values=(0,r.s7)(S,{destinationType:t.PU.time}).values);let x=0;e:for(let M of d)for(let S of M.fields)if(S.type===t.PU.enum&&++x>1){d=h(d);break e}let E;const C=[];for(let M of d){const S=[];let I=!1,T=!1,b=P?M:(0,f.M)({frame:M,refFieldPseudoMin:u?.from.valueOf(),refFieldPseudoMax:u?.to.valueOf()});const R=(0,a.C)(b).fields;for(let A=0;A<R?.length;A++){const L=R[A];switch(L.type){case t.PU.time:I=!0,S.push(L);break;case t.PU.number:T=P?A>0:!0,E={...L,values:L.values.map(w=>Number.isFinite(w)||w==null?w:null)},S.push(E);break;case t.PU.enum:T=!0;case t.PU.string:E={...L,values:L.values},S.push(E);break;case t.PU.boolean:T=!0;const U=L.config?.custom??{},W={...L.config,max:1,min:0,custom:U};U.lineInterpolation!==c.dx.StepBefore&&(U.lineInterpolation=c.dx.StepAfter),E={...L,config:W,type:t.PU.number,values:L.values.map(w=>w==null?w:w?1:0)},(0,i.j9)(W.unit)||(W.unit="bool",E.display=(0,s.J)({field:E,theme:v})),S.push(E);break}}(P||I)&&T&&C.push({...M,length:b.length,fields:S})}return C.length?(p(C,v,0),l(C,v),C):null}const l=(d,v)=>{const{palette:u}=v.visualization;for(const D of d)for(const P of D.fields)if(P.type===t.PU.enum){const x=u[P.state?.seriesIndex%u.length],E=v.visualization.getColorByName(x),C=P.config.type.enum;C.color=Array(C.text.length).fill(E),P.display=(0,s.J)({field:P,theme:v})}},p=(d,v,u)=>{let D=0;d.forEach(P=>{P.fields.forEach((x,E)=>{E!==u&&(x.type===t.PU.number||x.type===t.PU.boolean||x.type===t.PU.enum)&&(x.state={...x.state,seriesIndex:D++},x.display=(0,s.J)({field:x,theme:v}))})})};function m(d,v){return!d||!d.length?[v]:d.map(u=>u?.length?u:v)}const y=d=>d.mode===c.$N.Multi&&d.maxHeight!=null},5514:(G,O,e)=>{"use strict";e.d(O,{S:()=>n});var t=e(83195);function n(i,s){return i.display?(0,t.cN)(i.display(s)):`${s}`}},99140:(G,O,e)=>{"use strict";e.d(O,{Gu:()=>s,JD:()=>r,M_:()=>n,k3:()=>i});var t=e(48594);let n;function i(f){n=f}function s(){return!n||!n.getState?{templating:{...t.L1,lastKey:"key"}}:n.getState()}function r(f){if(!(!n||!n.getState))return n.dispatch(f)}},24897:(G,O,e)=>{"use strict";e.d(O,{RG:()=>i,Vz:()=>s,XT:()=>t.X,Xe:()=>n});var t=e(62625),n=(r=>(r[r.Admin=4]="Admin",r[r.Editor=2]="Editor",r[r.Member=0]="Member",r[r.Viewer=1]="Viewer",r))(n||{}),i=(r=>(r.View="View",r.Edit="Edit",r.Admin="Admin",r))(i||{}),s=(r=>(r.Folder="dash-folder",r.Dashboard="dash-db",r.AlertFolder="dash-folder-alerting",r))(s||{})},50271:()=>{"use strict"},18625:()=>{"use strict"},14276:()=>{"use strict"},95425:(G,O,e)=>{"use strict";e.d(O,{Z4:()=>t,_g:()=>n,d9:()=>i});var t=(s=>(s.Home="home-dashboard",s.New="new-dashboard",s.Normal="normal-dashboard",s.Path="path-dashboard",s.Scripted="scripted-dashboard",s.Public="public-dashboard",s.Embedded="embedded-dashboard",s.Report="report-dashboard",s))(t||{}),n=(s=>(s.NotStarted="Not started",s.Fetching="Fetching",s.Services="Services",s.Failed="Failed",s.Completed="Completed",s))(n||{}),i=(s=>(s.TV="tv",s.Full="full",s))(i||{})},62543:()=>{"use strict"},28444:(G,O,e)=>{"use strict";e.d(O,{Bt:()=>u,Cf:()=>l,Eu:()=>I,Io:()=>v,JI:()=>o,PR:()=>h,Ps:()=>E,Q$:()=>g,Rh:()=>P,S8:()=>M,U0:()=>y,VZ:()=>D,Vz:()=>x,XM:()=>m,Yn:()=>f,aP:()=>S,bG:()=>r,bY:()=>C,i0:()=>A,sL:()=>R,u4:()=>a,vk:()=>p,xL:()=>d,xc:()=>T,yj:()=>b,zq:()=>c});var t=e(89550),n=e(65463);const i=(0,t.R)("ds-request-response"),s=(0,t.R)("ds-request-error"),r=(0,t.R)("template-variable-value-updated"),f=(0,t.R)("graph-click"),a=(0,t.R)("threshold-changed");class c extends n.a{static{this.type="panel-queries-changed"}}class o extends n.a{static{this.type="panel-transformations-changed"}}class h extends n.a{static{this.type="panels-options-changed"}}class g extends n.a{static{this.type="dashboard-panels-changed"}}class l extends n.a{static{this.type="dashboard-meta-changed"}}class p extends n.a{static{this.type="panel-directive-ready"}}class m extends n.a{static{this.type="render"}}class y extends n.x{static{this.type="zoom-out"}}var d=(L=>(L[L.Left=-1]="Left",L[L.Right=1]="Right",L))(d||{});class v extends n.x{static{this.type="shift-time"}}class u extends n.a{static{this.type="copy-time"}}class D extends n.x{static{this.type="paste-time"}}class P extends n.x{static{this.type="absolute-time"}}class x extends n.x{static{this.type="remove-panel"}}class E extends n.x{static{this.type="show-modal"}}class C extends n.x{static{this.type="show-confirm-modal"}}class M extends n.x{static{this.type="show-react-modal"}}class S extends n.a{static{this.type="hide-modal"}}class I extends n.a{static{this.type="dashboard-saved"}}class T extends n.x{static{this.type="annotation-query-started"}}class b extends n.x{static{this.type="annotation-query-finished"}}class R extends n.x{static{this.type="panel-edit-started"}}class A extends n.x{static{this.type="panel-edit-finished"}}},76698:(G,O,e)=>{"use strict";e.d(O,{IW:()=>t,aA:()=>i,jH:()=>s,sG:()=>n});var t=(r=>(r[r.CLOSE_PANE=0]="CLOSE_PANE",r[r.CHANGE_DATASOURCE=1]="CHANGE_DATASOURCE",r[r.CLOSE_EDITOR=2]="CLOSE_EDITOR",r))(t||{});const n=["lines","bars","points","stacked_lines","stacked_bars"];var i=(r=>(r.table="table",r.raw="raw",r))(i||{});const s=["table","raw"]},8904:()=>{"use strict"},31678:(G,O,e)=>{"use strict";e.d(O,{AccessControlAction:()=>P,AppNotificationSeverity:()=>l,CORRELATION_EDITOR_POST_CONFIRM_ACTION:()=>y.IW,CoreEvents:()=>x,DashboardInitPhase:()=>s._g,DashboardRoutes:()=>s.Z4,EXPLORE_GRAPH_STYLES:()=>y.sG,KioskMode:()=>s.d9,OrgRole:()=>r.XT,PermissionLevelString:()=>r.RG,SearchQueryType:()=>r.Vz,ServiceAccountStateFilter:()=>c,TABLE_RESULTS_STYLE:()=>y.aA,TeamPermissionLevel:()=>r.Xe,addListener:()=>d.ch,createAsyncThunk:()=>d.zD,timeoutMap:()=>m,useDispatch:()=>d.wA,useSelector:()=>d.d4});var t=e(50271),n=e(54034),i=e(8904),s=e(95425),r=e(24897),f=e(18625),a=e(64998),c=(E=>(E.All="All",E.WithExpiredTokens="WithExpiredTokens",E.External="External",E.Disabled="Disabled",E))(c||{}),o=e(62543),h=e(77237),g=e(75330),l=(E=>(E.Success="success",E.Warning="warning",E.Error="error",E.Info="info",E))(l||{}),p=(E=>(E[E.Success=3e3]="Success",E[E.Warning=5e3]="Warning",E[E.Error=7e3]="Error",E))(p||{});const m={success:3e3,warning:5e3,error:7e3,info:3e3};var y=e(76698),d=e(64756),v=e(13868),u=e(14276),D=e(90697),P=(E=>(E.UsersRead="users:read",E.UsersWrite="users:write",E.UsersAuthTokenList="users.authtoken:read",E.UsersAuthTokenUpdate="users.authtoken:write",E.UsersPasswordUpdate="users.password:write",E.UsersDelete="users:delete",E.UsersCreate="users:create",E.UsersEnable="users:enable",E.UsersDisable="users:disable",E.UsersPermissionsUpdate="users.permissions:write",E.UsersLogout="users:logout",E.UsersQuotasList="users.quotas:read",E.UsersQuotasUpdate="users.quotas:write",E.ServiceAccountsRead="serviceaccounts:read",E.ServiceAccountsCreate="serviceaccounts:create",E.ServiceAccountsWrite="serviceaccounts:write",E.ServiceAccountsDelete="serviceaccounts:delete",E.ServiceAccountsPermissionsRead="serviceaccounts.permissions:read",E.ServiceAccountsPermissionsWrite="serviceaccounts.permissions:write",E.OrgsRead="orgs:read",E.OrgsPreferencesRead="orgs.preferences:read",E.OrgsWrite="orgs:write",E.OrgsPreferencesWrite="orgs.preferences:write",E.OrgsCreate="orgs:create",E.OrgsDelete="orgs:delete",E.OrgUsersRead="org.users:read",E.OrgUsersAdd="org.users:add",E.OrgUsersRemove="org.users:remove",E.OrgUsersWrite="org.users:write",E.LDAPUsersRead="ldap.user:read",E.LDAPUsersSync="ldap.user:sync",E.LDAPStatusRead="ldap.status:read",E.DataSourcesExplore="datasources:explore",E.DataSourcesRead="datasources:read",E.DataSourcesCreate="datasources:create",E.DataSourcesWrite="datasources:write",E.DataSourcesDelete="datasources:delete",E.DataSourcesPermissionsRead="datasources.permissions:read",E.DataSourcesCachingRead="datasources.caching:read",E.DataSourcesInsightsRead="datasources.insights:read",E.ActionServerStatsRead="server.stats:read",E.ActionTeamsCreate="teams:create",E.ActionTeamsDelete="teams:delete",E.ActionTeamsRead="teams:read",E.ActionTeamsWrite="teams:write",E.ActionTeamsPermissionsRead="teams.permissions:read",E.ActionTeamsPermissionsWrite="teams.permissions:write",E.ActionRolesList="roles:read",E.ActionTeamsRolesList="teams.roles:read",E.ActionTeamsRolesAdd="teams.roles:add",E.ActionTeamsRolesRemove="teams.roles:remove",E.ActionUserRolesList="users.roles:read",E.ActionUserRolesAdd="users.roles:add",E.ActionUserRolesRemove="users.roles:remove",E.DashboardsRead="dashboards:read",E.DashboardsWrite="dashboards:write",E.DashboardsDelete="dashboards:delete",E.DashboardsCreate="dashboards:create",E.DashboardsPermissionsRead="dashboards.permissions:read",E.DashboardsPermissionsWrite="dashboards.permissions:write",E.DashboardsPublicWrite="dashboards.public:write",E.FoldersRead="folders:read",E.FoldersWrite="folders:write",E.FoldersDelete="folders:delete",E.FoldersCreate="folders:create",E.FoldersPermissionsRead="folders.permissions:read",E.FoldersPermissionsWrite="folders.permissions:write",E.ActionSupportBundlesCreate="support.bundles:create",E.ActionSupportBundlesRead="support.bundles:read",E.ActionSupportBundlesDelete="support.bundles:delete",E.AlertingRuleCreate="alert.rules:create",E.AlertingRuleRead="alert.rules:read",E.AlertingRuleUpdate="alert.rules:write",E.AlertingRuleDelete="alert.rules:delete",E.AlertingInstanceCreate="alert.instances:create",E.AlertingInstanceUpdate="alert.instances:write",E.AlertingInstanceRead="alert.instances:read",E.AlertingSilenceCreate="alert.silences:create",E.AlertingSilenceUpdate="alert.silences:write",E.AlertingSilenceRead="alert.silences:read",E.AlertingNotificationsRead="alert.notifications:read",E.AlertingNotificationsWrite="alert.notifications:write",E.AlertingRuleExternalWrite="alert.rules.external:write",E.AlertingRuleExternalRead="alert.rules.external:read",E.AlertingInstancesExternalWrite="alert.instances.external:write",E.AlertingInstancesExternalRead="alert.instances.external:read",E.AlertingNotificationsExternalWrite="alert.notifications.external:write",E.AlertingNotificationsExternalRead="alert.notifications.external:read",E.AlertingProvisioningReadSecrets="alert.provisioning.secrets:read",E.AlertingProvisioningRead="alert.provisioning:read",E.AlertingProvisioningWrite="alert.provisioning:write",E.ActionAPIKeysRead="apikeys:read",E.ActionAPIKeysCreate="apikeys:create",E.ActionAPIKeysDelete="apikeys:delete",E.PluginsInstall="plugins:install",E.PluginsWrite="plugins:write",E.SettingsRead="settings:read",E.SettingsWrite="settings:write",E))(P||{}),x=e(28444)},13868:()=>{"use strict"},54034:()=>{"use strict"},75330:()=>{"use strict"},77237:()=>{"use strict"},90697:()=>{"use strict"},64756:(G,O,e)=>{"use strict";e.d(O,{ch:()=>f,d4:()=>s,wA:()=>i,zD:()=>r});var t=e(65307),n=e(71468);const i=n.useDispatch,s=n.useSelector,r=(a,c,o)=>(0,t.zD)(a,c,o),f=t.ch},38824:(G,O,e)=>{"use strict";e.d(O,{m:()=>t});var t=(n=>(n.LineChart="Line chart",n.LineChartSmooth="Line chart smooth",n.LineChartGradientColorScheme="Line chart with gradient color scheme",n.AreaChart="Area chart",n.AreaChartStacked="Area chart stacked",n.AreaChartStackedPercent="Area chart 100% stacked",n.BarChart="Bar chart",n.BarChartGradientColorScheme="Bar chart with gradient color scheme",n.BarChartStacked="Bar chart stacked",n.BarChartStackedPercent="Bar chart 100% stacked",n.BarChartHorizontal="Bar chart horizontal",n.BarChartHorizontalStacked="Bar chart horizontal stacked",n.BarChartHorizontalStackedPercent="Bar chart horizontal 100% stacked",n.Candlestick="Candlestick",n.PieChart="Pie chart",n.PieChartDonut="Pie chart donut",n.Stat="Stat",n.StatColoredBackground="Stat colored background",n.Gauge="Gauge",n.GaugeNoThresholds="Gauge no thresholds",n.BarGaugeBasic="Bar gauge basic",n.BarGaugeLCD="Bar gauge LCD",n.Table="Table",n.StateTimeline="State timeline",n.StatusHistory="Status history",n.TextPanel="Text",n.DashboardList="Dashboard list",n.Logs="Logs",n.FlameGraph="Flame graph",n.Trace="Trace",n.NodeGraph="Node graph",n))(t||{})},94822:(G,O,e)=>{"use strict";e.d(O,{$k:()=>f,Gi:()=>n,JS:()=>c,N1:()=>o,Q8:()=>h,Si:()=>i,cF:()=>t,lh:()=>a,qr:()=>r,s1:()=>s});var t=(g=>(g.Firing="firing",g.Inactive="inactive",g.Pending="pending",g))(t||{}),n=(g=>(g.Normal="Normal",g.Alerting="Alerting",g.Pending="Pending",g.NoData="NoData",g.Error="Error",g))(n||{});function i(g){return Object.values(t).includes(g)}function s(g){return Object.values(n).some(l=>l===g)}function r(g){const l=Object.values(t);return g!=null&&!l.includes(g)}function f(g){const l=g.match(/\((.*?)\)/);return l?l[1]:""}function a(g){return r(g)?g.split(" ")[0]:g}var c=(g=>(g.Alerting="alerting",g.Recording="recording",g))(c||{}),o=(g=>(g.Cortex="Cortex",g.Mimir="Mimir",g.Prometheus="Prometheus",g.Thanos="Thanos",g))(o||{}),h=(g=>(g.Alerting="Alerting",g.NoData="NoData",g.KeepLast="KeepLast",g.OK="OK",g.Error="Error",g))(h||{})},54317:(G,O,e)=>{"use strict";e.d(O,{$:()=>s,S:()=>n});var t=e(94822);function n(r,f){return(0,t.lh)(r.state)===f}var i=(r=>(r.Firing="firing",r))(i||{}),s=(r=>(r.Alerting="alerting",r.Pending="pending",r.Normal="inactive",r.NoData="nodata",r.Error="error",r))(s||{})},64998:()=>{"use strict"},72834:G=>{const O="    ";function e(s){let r="";return s&&Object.keys(s).forEach(function(f){r+=f+":"+s[f]+";"}),r}function t(s){function r(a){return'class="'+a+'"'}function f(a){return'style="'+e(s["."+a])+'"'}return s?f:r}function n(s){return s===null?"null":Array.isArray(s)?"array":typeof s=="string"&&/^https?:/.test(s)?"link":typeof s=="object"&&typeof s.toISOString=="function"?"date":typeof s}function i(s){return s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}G.exports=function(s,r){let f="";const a=t(r);let c=function(h,g,l,p){if(!h.length)return g+" "+l;let m=g+`
`;return f+=O,h.forEach(function(y,d){m+=f+p(y)+(d<h.length-1?",":"")+`
`}),f=f.slice(0,-O.length),m+f+l};function o(h){if(h===void 0)return"";switch(n(h)){case"boolean":return"<span "+a("json-markup-bool")+">"+h+"</span>";case"number":return"<span "+a("json-markup-number")+">"+h+"</span>";case"date":return'<span class="json-markup-string">"'+i(h.toISOString())+'"</span>';case"null":return"<span "+a("json-markup-null")+">null</span>";case"string":return"<span "+a("json-markup-string")+'>"'+i(h.replace(/\n/g,`
`+f))+'"</span>';case"link":return"<span "+a("json-markup-string")+'>"<a href="'+encodeURI(h)+'">'+i(h)+'</a>"</span>';case"array":return c(h,"[","]",o);case"object":const g=Object.keys(h).filter(function(l){return h[l]!==void 0});return c(g,"{","}",function(l){return"<span "+a("json-markup-key")+'>"'+i(l)+'":</span> '+o(h[l])})}return""}return"<div "+a("json-markup")+">"+o(s)+"</div>"}},13609:()=>{(function(G){"use strict";G(function(){G.support.transition=function(){var O=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},n;for(n in t)if(e.style[n]!==void 0)return t[n]}();return O&&{end:O}}()})})(window.jQuery),function(G){"use strict";var O="[data-toggle=dropdown]",e=function(s){var r=G(s).on("click.dropdown.data-api",this.toggle);G("html").on("click.dropdown.data-api",function(){r.parent().removeClass("open")})};e.prototype={constructor:e,toggle:function(s){var r=G(this),f,a;if(!r.is(".disabled, :disabled"))return f=n(r),a=f.hasClass("open"),t(),a||("ontouchstart"in document.documentElement&&G('<div class="dropdown-backdrop"/>').insertBefore(G(this)).on("click",t),f.toggleClass("open")),r.focus(),!1},keydown:function(s){var r,f,a,c,o,h;if(/(38|40|27)/.test(s.keyCode)&&(r=G(this),s.preventDefault(),s.stopPropagation(),!r.is(".disabled, :disabled"))){if(c=n(r),o=c.hasClass("open"),!o||o&&s.keyCode==27)return s.which==27&&c.find(O).focus(),r.click();f=G("[role=menu] li:not(.divider):visible a",c),f.length&&(h=f.index(f.filter(":focus")),s.keyCode==38&&h>0&&h--,s.keyCode==40&&h<f.length-1&&h++,~h||(h=0),f.eq(h).focus())}}};function t(){G(".dropdown-backdrop").remove(),G(O).each(function(){n(G(this)).removeClass("open")})}function n(s){var r=s.attr("data-target"),f;return r||(r=s.attr("href"),r=r&&/#[A-Za-z]/.test(r)&&r.replace(/.*(?=#[^\s]*$)/,"")),f=r&&G.find(r),(!f||!f.length)&&(f=s.parent()),f}var i=G.fn.dropdown;G.fn.dropdown=function(s){return this.each(function(){var r=G(this),f=r.data("dropdown");f||r.data("dropdown",f=new e(this)),typeof s=="string"&&f[s].call(r)})},G.fn.dropdown.Constructor=e,G.fn.dropdown.noConflict=function(){return G.fn.dropdown=i,this},G(document).on("click.dropdown.data-api",t).on("click.dropdown.data-api",".dropdown form",function(s){s.stopPropagation()}).on("click.dropdown.data-api",O,e.prototype.toggle).on("keydown.dropdown.data-api",O+", [role=menu]",e.prototype.keydown)}(window.jQuery),function(G){"use strict";var O=function(t,n){this.options=n,this.$element=G(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",G.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};O.prototype={constructor:O,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,n=G.Event("show");this.$element.trigger(n),!(this.isShown||n.isDefaultPrevented())&&(this.isShown=!0,this.escape(),this.backdrop(function(){var i=G.support.transition&&t.$element.hasClass("fade");t.$element.parent().length||t.$element.appendTo(document.body),t.$element.show(),i&&t.$element[0].offsetWidth,t.$element.addClass("in").attr("aria-hidden",!1),t.enforceFocus(),i?t.$element.one(G.support.transition.end,function(){t.$element.focus().trigger("shown")}):t.$element.focus().trigger("shown")}))},hide:function(t){t&&t.preventDefault();var n=this;t=G.Event("hide"),this.$element.trigger(t),!(!this.isShown||t.isDefaultPrevented())&&(this.isShown=!1,this.escape(),G(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),G.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal())},enforceFocus:function(){var t=this;G(document).on("focusin.modal",function(n){t.$element[0]!==n.target&&!t.$element.has(n.target).length&&t.$element.focus()})},escape:function(){var t=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(n){n.which==27&&t.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var t=this,n=setTimeout(function(){t.$element.off(G.support.transition.end),t.hideModal()},500);this.$element.one(G.support.transition.end,function(){clearTimeout(n),t.hideModal()})},hideModal:function(){var t=this;this.$element.hide(),this.backdrop(function(){t.removeBackdrop(),t.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(t){var n=this,i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var s=G.support.transition&&i;if(this.$backdrop=G('<div class="modal-backdrop '+i+'" />').appendTo(document.body),this.$backdrop.click(this.options.backdrop=="static"?G.proxy(this.$element[0].focus,this.$element[0]):G.proxy(this.hide,this)),s&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;s?this.$backdrop.one(G.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),G.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(G.support.transition.end,t):t()):t&&t()}};var e=G.fn.modal;G.fn.modal=function(t){return this.each(function(){var n=G(this),i=n.data("modal"),s=G.extend({},G.fn.modal.defaults,n.data(),typeof t=="object"&&t);i||n.data("modal",i=new O(this,s)),typeof t=="string"?i[t]():s.show&&i.show()})},G.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},G.fn.modal.Constructor=O,G.fn.modal.noConflict=function(){return G.fn.modal=e,this},G(document).on("click.modal.data-api",'[data-toggle="modal"]',function(t){var n=G(this),i=n.attr("href"),s=G.find(n.attr("data-target")||i&&i.replace(/.*(?=#[^\s]+$)/,"")),r=s.data("modal")?"toggle":G.extend({remote:!/#/.test(i)&&i},s.data(),n.data());t.preventDefault(),s.modal(r).one("hide",function(){n.focus()})})}(window.jQuery),function(G){"use strict";var O=function(t,n){this.init("tooltip",t,n)};O.prototype={constructor:O,init:function(t,n,i){var s,r,f,a,c;for(this.type=t,this.$element=G(n),this.options=this.getOptions(i),this.enabled=!0,f=this.options.trigger.split(" "),c=f.length;c--;)a=f[c],a=="click"?this.$element.on("click."+this.type,this.options.selector,G.proxy(this.toggle,this)):a!="manual"&&(s=a=="hover"?"mouseenter":"focus",r=a=="hover"?"mouseleave":"blur",this.$element.on(s+"."+this.type,this.options.selector,G.proxy(this.enter,this)),this.$element.on(r+"."+this.type,this.options.selector,G.proxy(this.leave,this)));this.options.selector?this._options=G.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){return t=G.extend({},G.fn[this.type].defaults,this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},enter:function(t){var n=G.fn[this.type].defaults,i={},s;if(this._options&&G.each(this._options,function(r,f){n[r]!=f&&(i[r]=f)},this),s=G(t.currentTarget)[this.type](i).data(this.type),!s.options.delay||!s.options.delay.show)return s.show();clearTimeout(this.timeout),s.hoverState="in",this.timeout=setTimeout(function(){s.hoverState=="in"&&s.show()},s.options.delay.show)},leave:function(t){var n=G(t.currentTarget)[this.type](this._options).data(this.type);if(this.timeout&&clearTimeout(this.timeout),!n.options.delay||!n.options.delay.hide)return n.hide();n.hoverState="out",this.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},show:function(){var t,n,i,s,r,f,a=G.Event("show");if(this.hasContent()&&this.enabled){if(this.$element.trigger(a),a.isDefaultPrevented())return;switch(t=this.tip(),this.setContent(),this.options.animation&&t.addClass("fade"),r=typeof this.options.placement=="function"?this.options.placement.call(this,t[0],this.$element[0]):this.options.placement,t.detach().css({top:0,left:0,display:"block"}),this.options.container?t.appendTo(G.find(this.options.container)):t.insertAfter(this.$element),n=this.getPosition(),i=t[0].offsetWidth,s=t[0].offsetHeight,r){case"bottom":f={top:n.top+n.height,left:n.left+n.width/2-i/2};break;case"top":f={top:n.top-s,left:n.left+n.width/2-i/2};break;case"left":f={top:n.top+n.height/2-s/2,left:n.left-i};break;case"right":f={top:n.top+n.height/2-s/2,left:n.left+n.width};break;case"topLeft":f={top:n.top-s,left:n.left+n.width/2-i*.1};break;case"topRight":f={top:n.top-s,left:n.left+n.width/2-i*.9};break;case"rightTop":f={top:n.top+n.height/2-s*.1,left:n.left+n.width};break;case"rightBottom":f={top:n.top+n.height/2-s*.9,left:n.left+n.width};break;case"bottomLeft":f={top:n.top+n.height,left:n.left+n.width/2-i*.1};break;case"bottomRight":f={top:n.top+n.height,left:n.left+n.width/2-i*.9};break;case"leftTop":f={top:n.top+n.height/2-s*.1,left:n.left-i};break;case"leftBottom":f={top:n.top+n.height/2-s*.9,left:n.left-i};break}this.applyPlacement(f,r),this.$element.trigger("shown")}},applyPlacement:function(t,n){var i=this.tip(),s=i[0].offsetWidth,r=i[0].offsetHeight,f,a,c,o;i.offset(t).addClass(n).addClass("in"),f=i[0].offsetWidth,a=i[0].offsetHeight,n=="top"&&a!=r&&(t.top=t.top+r-a,o=!0),n=="bottom"||n=="top"?(c=0,t.left<0&&(c=t.left*-2,t.left=0,i.offset(t),f=i[0].offsetWidth,a=i[0].offsetHeight),this.replaceArrow(c-s+f,f,"left")):this.replaceArrow(a-r,a,"top"),o&&i.offset(t)},replaceArrow:function(t,n,i){this.arrow().css(i,t?50*(1-t/n)+"%":"")},setContent:function(){var t=this.tip(),n=this.getTitle();t.find(".tooltip-inner").text(n),t.removeClass("fade in top bottom left right")},hide:function(){var t=this,n=this.tip(),i=G.Event("hide");if(this.$element.trigger(i),i.isDefaultPrevented())return;n.removeClass("in");function s(){var r=setTimeout(function(){n.off(G.support.transition.end).detach()},500);n.one(G.support.transition.end,function(){clearTimeout(r),n.detach()})}return G.support.transition&&this.$tip.hasClass("fade")?s():n.detach(),this.$element.trigger("hidden"),this},fixTitle:function(){var t=this.$element;(t.attr("title")||typeof t.attr("data-original-title")!="string")&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},hasContent:function(){return this.getTitle()},getPosition:function(){var t=this.$element[0];return G.extend({},typeof t.getBoundingClientRect=="function"?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},getTitle:function(){var t,n=this.$element,i=this.options;return t=n.attr("data-original-title")||(typeof i.title=="function"?i.title.call(n[0]):i.title),t},tip:function(){return this.$tip=this.$tip||G(this.options.template)},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(t){var n=t?G(t.currentTarget)[this.type](this._options).data(this.type):this;n.tip().hasClass("in")?n.hide():n.show()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};var e=G.fn.tooltip;G.fn.tooltip=function(t){return this.each(function(){var n=G(this),i=n.data("tooltip"),s=typeof t=="object"&&t;i||n.data("tooltip",i=new O(this,s)),typeof t=="string"&&i[t]()})},G.fn.tooltip.Constructor=O,G.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},G.fn.tooltip.noConflict=function(){return G.fn.tooltip=e,this}}(window.jQuery),function(G){"use strict";var O=function(t){this.element=G(t)};O.prototype={constructor:O,show:function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),i=t.attr("data-target"),s,r,f;i||(i=t.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")&&(s=n.find(".active:last a")[0],f=G.Event("show",{relatedTarget:s}),t.trigger(f),!f.isDefaultPrevented()&&(r=G.find(i),this.activate(t.parent("li"),n),this.activate(r,r.parent(),function(){t.trigger({type:"shown",relatedTarget:s})})))},activate:function(t,n,i){var s=n.find("> .active"),r=i&&G.support.transition&&s.hasClass("fade");function f(){s.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),r?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),i&&i()}r?s.one(G.support.transition.end,f):f(),s.removeClass("in")}};var e=G.fn.tab;G.fn.tab=function(t){return this.each(function(){var n=G(this),i=n.data("tab");i||n.data("tab",i=new O(this)),typeof t=="string"&&i[t]()})},G.fn.tab.Constructor=O,G.fn.tab.noConflict=function(){return G.fn.tab=e,this},G(document).on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),G(this).tab("show")})}(window.jQuery),function(G){"use strict";var O=function(t,n){this.$element=G(t),this.options=G.extend({},G.fn.typeahead.defaults,n),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.source=this.options.source,this.$menu=G(this.options.menu),this.shown=!1,this.listen()};O.prototype={constructor:O,select:function(){var t=this.$menu.find(".active").attr("data-value")||this.$element.val();return this.$element.val(this.updater(t)).change(),this.hide()},updater:function(t){return t},show:function(){var t=G.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return this.$menu.insertAfter(this.$element).css({top:t.top+t.height,left:t.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(t){var n;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(n=G.isFunction(this.source)?this.source(this.query,G.proxy(this.process,this)):this.source,n?this.process(n):this)},process:function(t){var n=this;return t=G.grep(t,function(i){return n.matcher(i)}),t=this.sorter(t),t.length?this.render(t.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(t){return~t.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(t){for(var n=[],i=[],s=[],r;r=t.shift();)r.toLowerCase().indexOf(this.query.toLowerCase())?~r.indexOf(this.query)?i.push(r):s.push(r):n.push(r);return n.concat(i,s)},highlighter:function(t){var n=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return n?t.replace(new RegExp("("+n+")","ig"),function(i,s){return"<strong>"+s+"</strong>"}):t},render:function(t){var n=this;return t=G(t).map(function(i,s){return i=G(n.options.item).attr("data-value",s),i.find("a").html(n.highlighter(s)),i[0]}),this.$menu.html(t),this},next:function(t){var n=this.$menu.find(".active").removeClass("active"),i=n.next();i.length||(i=G(this.$menu.find("li")[0])),i.addClass("active")},prev:function(t){var n=this.$menu.find(".active").removeClass("active"),i=n.prev();i.length||(i=this.$menu.find("li").last()),i.addClass("active")},listen:function(){this.$element.on("focus",G.proxy(this.focus,this)).on("blur",G.proxy(this.blur,this)).on("keypress",G.proxy(this.keypress,this)).on("keyup",G.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",G.proxy(this.keydown,this)),this.$menu.on("click",G.proxy(this.click,this)).on("mouseenter","li",G.proxy(this.mouseenter,this)).on("mouseleave","li",G.proxy(this.mouseleave,this))},destroy:function(){this.$element.off().removeData("typeahead"),this.$menu.off()},eventSupported:function(t){var n=t in this.$element;return n||(this.$element.setAttribute(t,"return;"),n=typeof this.$element[t]=="function"),n},move:function(t){if(this.shown&&!(t.shiftKey&&t.keyCode===40)){switch(t.keyCode){case 9:case 13:case 27:t.preventDefault();break;case 38:t.preventDefault(),this.prev();break;case 40:t.preventDefault(),this.next();break}t.stopPropagation()}},keydown:function(t){this.suppressKeyPressRepeat=~G.inArray(t.keyCode,[40,38,9,13,27,57]),this.move(t)},keypress:function(t){this.suppressKeyPressRepeat||this.move(t)},keyup:function(t){switch(t.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}t.keyCode===13&&typeof this.$menu.find(".active").attr("data-value")>"u"?this.$element.submit():(t.stopPropagation(),t.preventDefault())},focus:function(t){this.focused=!0},blur:function(t){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(t){t.stopPropagation(),t.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(t){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),G(t.currentTarget).addClass("active")},mouseleave:function(t){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var e=G.fn.typeahead;G.fn.typeahead=function(t){return this.each(function(){var n=G(this),i=n.data("typeahead"),s=typeof t=="object"&&t;i||n.data("typeahead",i=new O(this,s)),typeof t=="string"&&i[t]()})},G.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},G.fn.typeahead.Constructor=O,G.fn.typeahead.noConflict=function(){return G.fn.typeahead=e,this},G(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var n=G(this);n.data("typeahead")||n.typeahead(n.data())})}(window.jQuery),function(G){"use strict";var O=function(t,n){this.options=G.extend({},G.fn.affix.defaults,n),this.$window=G(window).on("scroll.affix.data-api",G.proxy(this.checkPosition,this)).on("click.affix.data-api",G.proxy(function(){setTimeout(G.proxy(this.checkPosition,this),1)},this)),this.$element=G(t),this.checkPosition()};O.prototype.checkPosition=function(){if(this.$element.is(":visible")){var t=G(document).height(),n=this.$window.scrollTop(),i=this.$element.offset(),s=this.options.offset,r=s.bottom,f=s.top,a="affix affix-top affix-bottom",c;typeof s!="object"&&(r=f=s),typeof f=="function"&&(f=s.top()),typeof r=="function"&&(r=s.bottom()),c=this.unpin!=null&&n+this.unpin<=i.top?!1:r!=null&&i.top+this.$element.height()>=t-r?"bottom":f!=null&&n<=f?"top":!1,this.affixed!==c&&(this.affixed=c,this.unpin=c=="bottom"?i.top-n:null,this.$element.removeClass(a).addClass("affix"+(c?"-"+c:"")))}};var e=G.fn.affix;G.fn.affix=function(t){return this.each(function(){var n=G(this),i=n.data("affix"),s=typeof t=="object"&&t;i||n.data("affix",i=new O(this,s)),typeof t=="string"&&i[t]()})},G.fn.affix.Constructor=O,G.fn.affix.defaults={offset:0},G.fn.affix.noConflict=function(){return G.fn.affix=e,this},G(window).on("load",function(){G('[data-spy="affix"]').each(function(){var t=G(this),n=t.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),t.affix(n)})})}(window.jQuery)},82013:()=>{(function(G){var O={crosshair:{mode:null,color:"rgba(170, 0, 0, 0.80)",lineWidth:1}};function e(t){var n={x:-1,y:-1,locked:!1};t.setCrosshair=function(f){if(!f)n.x=-1;else{var a=t.p2c(f);n.x=Math.max(0,Math.min(a.left,t.width())),n.y=Math.max(0,Math.min(a.top,t.height()))}t.triggerRedrawOverlay()},t.clearCrosshair=t.setCrosshair,t.lockCrosshair=function(f){f&&t.setCrosshair(f),n.locked=!0},t.unlockCrosshair=function(){n.locked=!1};function i(r){n.locked||n.x!=-1&&(n.x=-1,t.triggerRedrawOverlay())}function s(r){if(!n.locked){if(t.getSelection&&t.getSelection()){n.x=-1;return}var f=t.offset();n.x=Math.max(0,Math.min(r.pageX-f.left,t.width())),n.y=Math.max(0,Math.min(r.pageY-f.top,t.height())),t.triggerRedrawOverlay()}}t.hooks.bindEvents.push(function(r,f){r.getOptions().crosshair.mode&&(f.mouseout(i),f.mousemove(s))}),t.hooks.drawOverlay.push(function(r,f){var a=r.getOptions().crosshair;if(a.mode){var c=r.getPlotOffset();if(f.save(),f.translate(c.left,c.top),n.x!=-1){var o=r.getOptions().crosshair.lineWidth%2?.5:0;if(f.strokeStyle=a.color,f.lineWidth=a.lineWidth,f.lineJoin="round",f.beginPath(),a.mode.indexOf("x")!=-1){var h=Math.floor(n.x)+o;f.moveTo(h,0),f.lineTo(h,r.height())}if(a.mode.indexOf("y")!=-1){var g=Math.floor(n.y)+o;f.moveTo(0,g),f.lineTo(r.width(),g)}f.stroke()}f.restore()}}),t.hooks.shutdown.push(function(r,f){f.unbind("mouseout",i),f.unbind("mousemove",s)})}G.plot.plugins.push({init:e,options:O,name:"crosshair",version:"1.0"})})(jQuery)},2341:()=>{(function(G){function O(e){e.hooks.processDatapoints.push(function(t,n,i){n.dashes.show&&t.hooks.draw.push(function(s,r){var f=s.getPlotOffset(),a=n.xaxis,c=n.yaxis;function o(p,m){var y=i.points,d=i.pointsize,v=null,u=null,D=0,P=!0,x,E;n.dashes.dashLength[0]?(x=n.dashes.dashLength[0],n.dashes.dashLength[1]?E=n.dashes.dashLength[1]:E=x):E=x=n.dashes.dashLength,r.beginPath();for(var C=d;C<y.length;C+=d){let w=function(N){var B=Math.sqrt(Math.pow(A-b,2)+Math.pow(L-R,2));if(B<=N)return{deltaX:A-b,deltaY:L-R,distance:B,remainder:N-B};var V=A>b?1:-1,K=L>R?1:-1;return{deltaX:V*Math.sqrt(Math.pow(N,2)/(1+Math.pow((L-R)/(A-b),2))),deltaY:K*Math.sqrt(Math.pow(N,2)-Math.pow(N,2)/(1+Math.pow((L-R)/(A-b),2))),distance:N,remainder:0}};var W=w,M=y[C-d],S=y[C-d+1],I=y[C],T=y[C+1];if(!(M==null||I==null)){if(S<=T&&S<c.min){if(T<c.min)continue;M=(c.min-S)/(T-S)*(I-M)+M,S=c.min}else if(T<=S&&T<c.min){if(S<c.min)continue;I=(c.min-S)/(T-S)*(I-M)+M,T=c.min}if(S>=T&&S>c.max){if(T>c.max)continue;M=(c.max-S)/(T-S)*(I-M)+M,S=c.max}else if(T>=S&&T>c.max){if(S>c.max)continue;I=(c.max-S)/(T-S)*(I-M)+M,T=c.max}if(M<=I&&M<a.min){if(I<a.min)continue;S=(a.min-M)/(I-M)*(T-S)+S,M=a.min}else if(I<=M&&I<a.min){if(M<a.min)continue;T=(a.min-M)/(I-M)*(T-S)+S,I=a.min}if(M>=I&&M>a.max){if(I>a.max)continue;S=(a.max-M)/(I-M)*(T-S)+S,M=a.max}else if(I>=M&&I>a.max){if(M>a.max)continue;T=(a.max-M)/(I-M)*(T-S)+S,I=a.max}(M!=v||S!=u)&&r.moveTo(a.p2c(M)+p,c.p2c(S)+m);var b=a.p2c(M)+p,R=c.p2c(S)+m,A=a.p2c(I)+p,L=c.p2c(T)+m,U;do U=w(D>0?D:P?x:E),(U.deltaX!=0||U.deltaY!=0)&&(P?r.lineTo(b+U.deltaX,R+U.deltaY):r.moveTo(b+U.deltaX,R+U.deltaY)),P=!P,D=U.remainder,b+=U.deltaX,R+=U.deltaY;while(U.distance>0);v=I,u=T}}r.stroke()}r.save(),r.translate(f.left,f.top),r.lineJoin="round";var h=n.dashes.lineWidth,g=n.shadowSize;if(h>0&&g>0){r.lineWidth=g,r.strokeStyle="rgba(0,0,0,0.1)";var l=Math.PI/18;o(Math.sin(l)*(h/2+g/2),Math.cos(l)*(h/2+g/2)),r.lineWidth=g/2,o(Math.sin(l)*(h/2+g/4),Math.cos(l)*(h/2+g/4))}r.lineWidth=h,r.strokeStyle=n.color,h>0&&o(0,0),r.restore()})})}G.plot.plugins.push({init:O,options:{series:{dashes:{show:!1,lineWidth:2,dashLength:10}}},name:"dashes",version:"0.1"})})(jQuery)},92275:()=>{(function(G){"use strict";var O={series:{fillBelowTo:null}};function e(t){function n(r,f){var a;for(a=0;a<f.length;++a)if(f[a].id===r.fillBelowTo)return f[a];return null}function i(r,f,a,c,o,h,g,l){var p,m,y,d,v,u;return p=a-r,m=c-f,y=g-o,d=l-h,v=(-m*(r-o)+p*(f-h))/(-y*m+p*d),u=(y*(f-h)-d*(r-o))/(-y*m+p*d),v>=0&&v<=1&&u>=0&&u<=1?[r+u*p,f+u*m]:null}function s(r,f,a){if(a.fillBelowTo===null)return;var c,o,h,g,l,p,m;function y(E,C){f.beginPath(),f.moveTo(a.xaxis.p2c(E)+p.left,a.yaxis.p2c(C)+p.top)}function d(){f.closePath(),f.fill()}function v(){if(h.length/o!==l.length/g)return console.error("Refusing to graph inconsistent number of points"),!1;var E;for(E=0;E<h.length/o;E++)if(h[E*o]!==null&&l[E*g]!==null&&h[E*o]!==l[E*g])return console.error("Refusing to graph points without matching value"),!1;return!0}function u(E,C){console.assert(C>E,"expects the end index to be greater than the start index");var M=E===0||h[E-1]===null||l[E-1]===null,S=!1,I,T;for(I=E;I<C;I++)if(h[I*o+1]===null||l[I*o+1]===null)S=!1,M=!0;else if(h[I*o+1]===l[I*g+1])S=!0,M=!1;else if(h[I*o+1]>l[I*g+1]){M?y(h[I*o],h[I*o+1]):S?y(h[(I-1)*o],h[(I-1)*o+1]):(T=D(I),y(T[0],T[1])),x(I,C);return}else M=!1,S=!1}function D(E){console.assert(E>0,"expects the second point in the series line segment");var C,M;for(C=1;C<l.length/g;C++)if(M=i(h[(E-1)*o],h[(E-1)*o+1],h[E*o],h[E*o+1],l[(C-1)*g],l[(C-1)*g+1],l[C*g],l[C*g+1]),M!==null)return M;console.error("intersectionPoint() should only be called when an intersection happens")}function P(E,C){console.assert(E>=C,"the start should be the rightmost point, and the end should be the leftmost (excluding the equal or intersecting point)");var M;for(M=E;M>=C;M--)f.lineTo(c.xaxis.p2c(l[M*g])+p.left,c.yaxis.p2c(l[M*g+1])+p.top);d()}function x(E,C){console.assert(E<=C,"the start should be the rightmost point, and the end should be the leftmost (excluding the equal or intersecting point)");var M,S;for(M=E;M<C;M++)if(h[M*o+1]===null&&M>E){P(M-1,E),u(M,C);return}else if(h[M*o+1]===l[M*g+1]){P(M,E),u(M,C);return}else if(h[M*o+1]<l[M*g+1]){S=D(M),f.lineTo(a.xaxis.p2c(S[0])+p.left,a.yaxis.p2c(S[1])+p.top),P(M,E),u(M,C);return}else f.lineTo(a.xaxis.p2c(h[M*o])+p.left,a.yaxis.p2c(h[M*o+1])+p.top);P(C,E)}c=n(a,r.getData()),c&&(o=a.datapoints.pointsize,h=a.datapoints.points,g=c.datapoints.pointsize,l=c.datapoints.points,p=r.getPlotOffset(),v()&&(m=G.color.parse(a.color),m.a=.4,m.normalize(),f.fillStyle=m.toString(),u(0,h.length/o)))}t.hooks.drawSeries.push(s)}G.plot.plugins.push({init:e,options:O,name:"fillbelow",version:"0.1.0"})})(jQuery)},19538:()=>{/*!
 * jquery.flot.gauge v1.1.0 *
 *
 * Flot plugin for rendering gauge charts.
 *
 * Copyright (c) 2015 @toyoty99.
 * Licensed under the MIT license.
 */(function(G){var O=function(){var a,c,o,h,g,l,p=function(E,C){a=C,c=E.getPlaceholder(),o=E.getOptions(),h=o.series.gauges,g=E.getData(),l=e(h.debug)};p.prototype.calculateLayout=function(){var E=c.width(),C=c.height(),M=Math.min(g.length,h.layout.columns),S=Math.ceil(g.length/M),I=h.layout.margin,T=h.layout.hMargin,b=h.layout.vMargin,R=(E-I*2-T*(M-1))/M,A=(C-I*2-b*(S-1))/S;if(h.layout.square){var L=Math.min(R,A);R=L,A=L}m(h,R);var U=h.cell.margin,W=0,w=0;h.label.show&&(W=h.label.margin,w=h.label.font.size);var N=0,B=0;h.value.show&&(N=h.value.margin,B=h.value.font.size);var V=0;h.threshold.show&&(V=h.threshold.width);var K=0,H=0;h.threshold.label.show&&(K=h.threshold.label.margin,H=h.threshold.label.font.size);for(var X=R/2-U-V-K*2-H,k=h.gauge.startAngle,Y=h.gauge.endAngle,Z=(Y-k)/100,se=-1,j=k;j<Y;j+=Z)se=Math.max(se,Math.sin(i(j)));se=Math.max(se,Math.sin(i(Y)));var q=(A-U*2-W*2-w)/(1+se);q*se<N+B/2&&(q=A-U*2-W*2-w-N-B/2);var ne=q-K*2-H-V,oe=Math.min(X,ne),z=h.gauge.width;z>=oe&&(z=Math.max(3,oe/3));var te=K*2+H+V+oe,le=Math.max(te*(1+se),te+N+B/2);return{canvasWidth:E,canvasHeight:C,margin:I,hMargin:T,vMargin:b,columns:M,rows:S,cellWidth:R,cellHeight:A,cellMargin:U,labelMargin:W,labelFontSize:w,valueMargin:N,valueFontSize:B,width:z,radius:oe,thresholdWidth:V,thresholdLabelMargin:K,thresholdLabelFontSize:H,gaugeOuterHeight:le}};function m(E,C){E.gauge.width==="auto"&&(E.gauge.width=Math.max(5,C/8)),E.label.margin==="auto"&&(E.label.margin=Math.max(1,C/20)),E.label.font.size==="auto"&&(E.label.font.size=Math.max(5,C/8)),E.value.margin==="auto"&&(E.value.margin=Math.max(1,C/30)),E.value.font.size==="auto"&&(E.value.font.size=Math.max(5,C/9)),E.threshold.width==="auto"&&(E.threshold.width=Math.max(3,C/100)),E.threshold.label.margin==="auto"&&(E.threshold.label.margin=Math.max(3,C/40)),E.threshold.label.font.size==="auto"&&(E.threshold.label.font.size=Math.max(5,C/15))}p.prototype.calculateAutoValues=m,p.prototype.calculateCellLayout=function(E,C,M){var S=t(C.columns,M),I=n(C.columns,M),T=C.margin+(C.cellWidth+C.hMargin)*S,b=C.margin+(C.cellHeight+C.vMargin)*I,R=T+C.cellWidth/2,A=b+C.cellMargin+C.labelMargin*2+C.labelFontSize+C.thresholdWidth+C.thresholdLabelFontSize+C.thresholdLabelMargin*2+C.radius,L=C.cellHeight-C.cellMargin*2-C.labelMargin*2-C.labelFontSize-C.gaugeOuterHeight,U=0;return E.cell.vAlign==="middle"?U=L/2:E.cell.vAlign==="bottom"&&(U=L),A+=U,{col:S,row:I,x:T,y:b,offsetY:U,cellWidth:C.cellWidth,cellHeight:C.cellHeight,cellMargin:C.cellMargin,cx:R,cy:A}},p.prototype.drawBackground=function(E){h.frame.show&&(a.save(),a.strokeStyle=o.grid.borderColor,a.lineWidth=o.grid.borderWidth,a.strokeRect(0,0,E.canvasWidth,E.canvasHeight),o.grid.backgroundColor&&(a.fillStyle=o.grid.backgroundColor,a.fillRect(0,0,E.canvasWidth,E.canvasHeight)),a.restore())},p.prototype.drawCellBackground=function(E,C){a.save(),E.cell.border&&E.cell.border.show&&E.cell.border.color&&E.cell.border.width&&(a.strokeStyle=E.cell.border.color,a.lineWidth=E.cell.border.width,a.strokeRect(C.x,C.y,C.cellWidth,C.cellHeight)),E.cell.background&&E.cell.background.color&&(a.fillStyle=E.cell.background.color,a.fillRect(C.x,C.y,C.cellWidth,C.cellHeight)),a.restore()},p.prototype.drawGauge=function(E,C,M,S,I){var T=E.gauge.shadow.show?E.gauge.shadow.blur:0,b=v(E,I),R=y(E,C,I);D(M.cx,M.cy,C.radius,C.width,i(E.gauge.startAngle),i(E.gauge.endAngle),E.gauge.border.color,E.gauge.border.width,E.gauge.background.color,T),D(M.cx,M.cy,C.radius-1,C.width-2,i(R.a1),i(R.a2),b,1,b,T),E.gauge.neutralValue!=null&&d(E,C,M,b)};function y(E,C,M){let S={};var I=E.gauge.neutralValue;return I!=null?M<I?(S.a1=u(E,C,M),S.a2=u(E,C,I)):(S.a1=u(E,C,I),S.a2=u(E,C,M)):(S.a1=E.gauge.startAngle,S.a2=u(E,C,M)),S}function d(E,C,M,S){var I=(E.gauge.max-E.gauge.min)/600;s(a,M.cx,M.cy,C.radius-2,C.width-4,i(u(E,C,E.gauge.neutralValue-I)),i(u(E,C,E.gauge.neutralValue+I)),S,2,E.gauge.background.color)}function v(E,C){for(var M,S=0;S<E.threshold.values.length;S++){var I=E.threshold.values[S];if(M=I.color,C<I.value)break}return M}function u(E,C,M){var S=E.gauge.startAngle+(E.gauge.endAngle-E.gauge.startAngle)*((M-E.gauge.min)/(E.gauge.max-E.gauge.min));return S<E.gauge.startAngle?S=E.gauge.startAngle:S>E.gauge.endAngle&&(S=E.gauge.endAngle),S}p.prototype.drawThreshold=function(E,C,M){for(var S=E.gauge.startAngle,I=0;I<E.threshold.values.length;I++){var T=E.threshold.values[I];c1=T.color,a2=u(E,C,T.value),s(a,M.cx,M.cy,C.radius+C.thresholdWidth,C.thresholdWidth-2,i(S),i(a2),c1,1,c1),S=a2}};function D(E,C,M,S,I,T,b,R,A,L){I!==T&&(a.save(),s(a,E,C,M,S,I,T,b,R,A),L&&(s(a,E,C,M,S,I,T),a.clip(),a.shadowOffsetX=0,a.shadowOffsetY=0,a.shadowBlur=10,a.shadowColor="gray",s(a,E,C,M+1,S+2,I,T,b,1)),a.restore())}p.prototype.drawLable=function(E,C,M,S,I){x(M.cx,M.y+M.cellMargin+C.labelMargin+M.offsetY,"flotGaugeLabel"+S,E.label.formatter?E.label.formatter(I.label,I.data[0][1]):text,E.label)},p.prototype.drawValue=function(E,C,M,S,I){x(M.cx,M.cy-E.value.font.size/2,"flotGaugeValue"+S,E.value.formatter?E.value.formatter(I.label,I.data[0][1]):text,E.value)},p.prototype.drawThresholdValues=function(E,C,M,S){P(E,C,M,"Min"+S,E.gauge.min,E.gauge.startAngle),P(E,C,M,"Max"+S,E.gauge.max,E.gauge.endAngle);for(var I=0;I<E.threshold.values.length;I++){var T=E.threshold.values[I];if(T.value>E.gauge.min&&T.value<E.gauge.max){var b=u(E,C,T.value);P(E,C,M,S+"_"+I,T.value,b)}}var R=E.gauge.neutralValue;R!=null&&R>E.gauge.min&&R<E.gauge.max&&P(E,C,M,"Neutral"+S,R,u(E,C,R))};function P(E,C,M,S,I,T){x(M.cx+(C.thresholdLabelMargin+C.thresholdLabelFontSize/2+C.radius)*Math.cos(i(T)),M.cy+(C.thresholdLabelMargin+C.thresholdLabelFontSize/2+C.radius)*Math.sin(i(T)),"flotGaugeThresholdValue"+S,E.threshold.label.formatter?E.threshold.label.formatter(I):I,E.threshold.label,T)}function x(E,C,M,S,I,T){var b=G(c).find("#"+M),R=b.length;R||(b=G("<span></span>"),b.attr("id",M),b.attr("class","flot-temp-elem"),c.append(b)),b.css("position","absolute"),b.css("top",C+"px"),b.css("white-space","nowrap"),I.font.size&&b.css("font-size",I.font.size+"px"),I.font.family&&b.css("font-family",I.font.family),I.color&&b.css("color",I.color),I.background.color&&b.css("background-color",I.background.color),I.background.opacity&&b.css("opacity",I.background.opacity),b.text(S),b.css("left",E+"px"),b.css("left",parseInt(b.css("left"))-b.width()/2+"px"),!R&&T&&(b.css("top",parseInt(b.css("top"))-b.height()/2+"px"),b.css("transform","rotate("+(180*T+90)+"deg)"))}return p}();function e(a){return typeof Logger<"u"?new Logger(a):null}function t(a,c){return c%a}function n(a,c){return Math.floor(c/a)}function i(a){return a*Math.PI}function s(a,c,o,h,g,l,p,m,y,d){if(l!==p){var v=!1;a.save(),a.beginPath(),a.arc(c,o,h,l,p,v),a.lineTo(c+(h-g)*Math.cos(p),o+(h-g)*Math.sin(p)),a.arc(c,o,h-g,p,l,!v),a.closePath(),y&&(a.lineWidth=y),m&&(a.strokeStyle=m,a.stroke()),d&&(a.fillStyle=d,a.fill()),a.restore()}}function r(a){a.hooks.processOptions.push(function(c,o){var h=e(o.series.gauges.debug);o.series.gauges.show&&(o.grid.show=!1,o.legend.show=!1);var g=o.series.gauges.threshold.values;g.sort(function(l,p){return l.value<p.value?-1:l.value>p.value?1:0})}),a.hooks.draw.push(function(c,o){var h=c.getOptions(),g=h.series.gauges,l=e(g.debug);if(g.show){var p=c.getData();if(!(!p||!p.length)){var m=new O(c,o),y=m.calculateLayout();g.debug.layout,m.drawBackground(y);for(var d=0;d<p.length;d++){var v=p[d],u=G.extend({},g,v.gauges);v.gauges&&m.calculateAutoValues(u,y.cellWidth);var D=m.calculateCellLayout(u,y,d);m.drawCellBackground(u,D),u.debug.layout,u.label.show&&m.drawLable(u,y,D,d,v),m.drawGauge(u,y,D,v.label,v.data[0][1]),u.threshold.show&&m.drawThreshold(u,y,D),u.threshold.label.show&&m.drawThresholdValues(u,y,D,d),u.value.show&&m.drawValue(u,y,D,d,v)}}}})}var f={series:{gauges:{debug:{log:!1,layout:!1,alert:!1},show:!1,layout:{margin:5,columns:3,hMargin:5,vMargin:5,square:!1},frame:{show:!0},cell:{background:{color:null},border:{show:!0,color:"black",width:1},margin:5,vAlign:"middle"},gauge:{width:"auto",startAngle:.9,endAngle:2.1,min:0,max:100,background:{color:"white"},border:{color:"lightgray",width:2},shadow:{show:!0,blur:5}},label:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:"sans-serif"},color:null,formatter:function(a,c){return a}},value:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:"sans-serif"},color:null,formatter:function(a,c){return parseInt(c)}},threshold:{show:!0,width:"auto",label:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:",sans-serif"},color:null,formatter:function(a){return a}},values:[]}}}};G.plot.plugins.push({init:r,options:f,name:"gauge",version:"1.1.0"})})(jQuery)},54087:()=>{(function(G){G.color={},G.color.make=function(e,t,n,i){var s={};return s.r=e||0,s.g=t||0,s.b=n||0,s.a=i??1,s.add=function(r,f){for(var a=0;a<r.length;++a)s[r.charAt(a)]+=f;return s.normalize()},s.scale=function(r,f){for(var a=0;a<r.length;++a)s[r.charAt(a)]*=f;return s.normalize()},s.toString=function(){return s.a>=1?"rgb("+[s.r,s.g,s.b].join(",")+")":"rgba("+[s.r,s.g,s.b,s.a].join(",")+")"},s.normalize=function(){function r(f,a,c){return a<f?f:a>c?c:a}return s.r=r(0,parseInt(s.r),255),s.g=r(0,parseInt(s.g),255),s.b=r(0,parseInt(s.b),255),s.a=r(0,s.a,1),s},s.clone=function(){return G.color.make(s.r,s.b,s.g,s.a)},s.normalize()},G.color.extract=function(e,t){var n;do{if(n=e.css(t).toLowerCase(),n!=""&&n!="transparent")break;e=e.parent()}while(e.length&&!G.nodeName(e.get(0),"body"));return n=="rgba(0, 0, 0, 0)"&&(n="transparent"),G.color.parse(n)},G.color.parse=function(e){var t,n=G.color.make;if(t=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(e))return n(parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10));if(t=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(e))return n(parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10),parseFloat(t[4]));if(t=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(e))return n(parseFloat(t[1])*2.55,parseFloat(t[2])*2.55,parseFloat(t[3])*2.55);if(t=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(e))return n(parseFloat(t[1])*2.55,parseFloat(t[2])*2.55,parseFloat(t[3])*2.55,parseFloat(t[4]));if(t=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(e))return n(parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16));if(t=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(e))return n(parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16));var i=G.trim(e).toLowerCase();return i=="transparent"?n(255,255,255,0):(t=O[i]||[0,0,0],n(t[0],t[1],t[2]))};var O={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery),function(G){var O=Object.prototype.hasOwnProperty;G.fn.detach||(G.fn.detach=function(){return this.each(function(){this.parentNode&&this.parentNode.removeChild(this)})});function e(i,s){var r=s.children("."+i)[0];if(r==null&&(r=document.createElement("canvas"),r.className=i,G(r).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(s),!r.getContext))if(window.G_vmlCanvasManager)r=window.G_vmlCanvasManager.initElement(r);else throw new Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");this.element=r;var f=this.context=r.getContext("2d"),a=window.devicePixelRatio||1,c=f.webkitBackingStorePixelRatio||f.mozBackingStorePixelRatio||f.msBackingStorePixelRatio||f.oBackingStorePixelRatio||f.backingStorePixelRatio||1;this.pixelRatio=a/c,this.resize(s.width(),s.height()),this.textContainer=null,this.text={},this._textCache={},this._textSizeCache=window.flotTextSizeCache=window.flotTextSizeCache||{}}e.prototype.resize=function(i,s){if(i<=0||s<=0)throw new Error("Invalid dimensions for plot, width = "+i+", height = "+s);var r=this.element,f=this.context,a=this.pixelRatio;this.width!=i&&(r.width=i*a,r.style.width=i+"px",this.width=i),this.height!=s&&(r.height=s*a,r.style.height=s+"px",this.height=s),f.restore(),f.save(),f.scale(a,a)},e.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},e.prototype.render=function(){var i=this._textCache;for(var s in i)if(O.call(i,s)){var r=this.getTextLayer(s),f=i[s];r.hide();for(var a in f)if(O.call(f,a)){var c=f[a];for(var o in c)if(O.call(c,o)){for(var h=c[o].positions,g=0,l;l=h[g];g++)l.active?l.rendered||(r.append(l.element),l.rendered=!0):(h.splice(g--,1),l.rendered&&l.element.detach());h.length==0&&delete c[o]}}r.show()}},e.prototype.getTextLayer=function(i){var s=this.text[i];return s==null&&(this.textContainer==null&&(this.textContainer=G("<div class='flot-text flot-temp-elem'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),s=this.text[i]=G("<div></div>").addClass(i).css({position:"absolute",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer)),s},e.prototype.getTextInfo=function(i,s,r,f,a){var c,o,h,g;if(s=""+s,typeof r=="object"?c=r.style+" "+r.variant+" "+r.weight+" "+r.size+"px/"+r.lineHeight+"px "+r.family:c=r,o=this._textCache[i],o==null&&(o=this._textCache[i]={}),h=o[c],h==null&&(h=o[c]={}),g=h[s],g==null){var l=G("<div></div>").html(s).css({position:"absolute","max-width":a,top:-9999}).appendTo(this.getTextLayer(i));typeof r=="object"?l.css({font:c,color:r.color}):typeof r=="string"&&l.addClass(r),g=h[s]={element:l,positions:[]};var p=this._textSizeCache[s];p?(g.width=p.width,g.height=p.height):(g.width=l.outerWidth(!0),g.height=l.outerHeight(!0),this._textSizeCache[s]={width:g.width,height:g.height}),l.detach()}return g},e.prototype.addText=function(i,s,r,f,a,c,o,h,g){var l=this.getTextInfo(i,f,a,c,o),p=l.positions;h=="center"?s-=l.width/2:h=="right"&&(s-=l.width),g=="middle"?r-=l.height/2:g=="bottom"&&(r-=l.height);for(var m=0,y;y=p[m];m++)if(y.x==s&&y.y==r){y.active=!0;return}y={active:!0,rendered:!1,element:p.length?l.element.clone():l.element,x:s,y:r},p.push(y),y.element.css({top:Math.round(r),left:Math.round(s),"text-align":h})},e.prototype.removeText=function(i,s,r,f,a,c){if(f==null){var o=this._textCache[i];if(o!=null){for(var h in o)if(O.call(o,h)){var g=o[h];for(var l in g)if(O.call(g,l))for(var p=g[l].positions,m=0,y;y=p[m];m++)y.active=!1}}}else for(var p=this.getTextInfo(i,f,a,c).positions,m=0,y;y=p[m];m++)y.x==s&&y.y==r&&(y.active=!1)};function t(i,s,r,f){var a=[],c={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,eventSectionHeight:0,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:16.666666666666668},hooks:{}},o=null,h=null,g=null,l=null,p=null,m=[],y=[],d={left:0,right:0,top:0,bottom:0},v=0,u=0,D={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],processRange:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},P=this;P.setData=M,P.setupGrid=k,P.draw=ne,P.getPlaceholder=function(){return i},P.getCanvas=function(){return o.element},P.getPlotOffset=function(){return d},P.width=function(){return v},P.height=function(){return u},P.offset=function(){var ve=g.offset();return ve.left+=d.left,ve.top+=d.top,ve},P.getData=function(){return a},P.getAxes=function(){var ve={},be;return G.each(m.concat(y),function(he,ye){ye&&(ve[ye.direction+(ye.n!=1?ye.n:"")+"axis"]=ye)}),ve},P.getXAxes=function(){return m},P.getYAxes=function(){return y},P.c2p=b,P.p2c=R,P.getOptions=function(){return c},P.highlight=Je,P.unhighlight=st,P.triggerRedrawOverlay=Ke,P.pointOffset=function(ve){return{left:parseInt(m[I(ve,"x")-1].p2c(+ve.x)+d.left,10),top:parseInt(y[I(ve,"y")-1].p2c(+ve.y)+d.top,10)}},P.shutdown=N,P.destroy=function(){N(),i.removeData("plot").empty(),a=[],c=null,o=null,h=null,g=null,l=null,p=null,m=[],y=[],D=null,fe=[],P=null},P.resize=function(){var ve=i.width(),be=i.height();o.resize(ve,be),h.resize(ve,be)},P.hooks=D,E(P),C(r),W(),M(s),k(),ne(),w();function x(ve,be){be=[P].concat(be);for(var he=0;he<ve.length;++he)ve[he].apply(this,be)}function E(){for(var ve={Canvas:e},be=0;be<f.length;++be){var he=f[be];he.init(P,ve),he.options&&G.extend(!0,c,he.options)}}function C(ve){G.extend(!0,c,ve),ve&&ve.colors&&(c.colors=ve.colors),c.xaxis.color==null&&(c.xaxis.color=G.color.parse(c.grid.color).scale("a",.22).toString()),c.yaxis.color==null&&(c.yaxis.color=G.color.parse(c.grid.color).scale("a",.22).toString()),c.xaxis.tickColor==null&&(c.xaxis.tickColor=c.grid.tickColor||c.xaxis.color),c.yaxis.tickColor==null&&(c.yaxis.tickColor=c.grid.tickColor||c.yaxis.color),c.grid.borderColor==null&&(c.grid.borderColor=c.grid.color),c.grid.tickColor==null&&(c.grid.tickColor=G.color.parse(c.grid.color).scale("a",.22).toString());var be,he,ye,Pe=i.css("font-size"),ge=Pe?+Pe.replace("px",""):13,xe={style:i.css("font-style"),size:Math.round(.8*ge),variant:i.css("font-variant"),weight:i.css("font-weight"),family:i.css("font-family")};for(ye=c.xaxes.length||1,be=0;be<ye;++be)he=c.xaxes[be],he&&!he.tickColor&&(he.tickColor=he.color),he=G.extend(!0,{},c.xaxis,he),c.xaxes[be]=he,he.font&&(he.font=G.extend({},xe,he.font),he.font.color||(he.font.color=he.color),he.font.lineHeight||(he.font.lineHeight=Math.round(he.font.size*1.15)));for(ye=c.yaxes.length||1,be=0;be<ye;++be)he=c.yaxes[be],he&&!he.tickColor&&(he.tickColor=he.color),he=G.extend(!0,{},c.yaxis,he),c.yaxes[be]=he,he.font&&(he.font=G.extend({},xe,he.font),he.font.color||(he.font.color=he.color),he.font.lineHeight||(he.font.lineHeight=Math.round(he.font.size*1.15)));for(c.xaxis.noTicks&&c.xaxis.ticks==null&&(c.xaxis.ticks=c.xaxis.noTicks),c.yaxis.noTicks&&c.yaxis.ticks==null&&(c.yaxis.ticks=c.yaxis.noTicks),c.x2axis&&(c.xaxes[1]=G.extend(!0,{},c.xaxis,c.x2axis),c.xaxes[1].position="top",c.x2axis.min==null&&(c.xaxes[1].min=null),c.x2axis.max==null&&(c.xaxes[1].max=null)),c.y2axis&&(c.yaxes[1]=G.extend(!0,{},c.yaxis,c.y2axis),c.yaxes[1].position="right",c.y2axis.min==null&&(c.yaxes[1].min=null),c.y2axis.max==null&&(c.yaxes[1].max=null)),c.grid.coloredAreas&&(c.grid.markings=c.grid.coloredAreas),c.grid.coloredAreasColor&&(c.grid.markingsColor=c.grid.coloredAreasColor),c.lines&&G.extend(!0,c.series.lines,c.lines),c.points&&G.extend(!0,c.series.points,c.points),c.bars&&G.extend(!0,c.series.bars,c.bars),c.shadowSize!=null&&(c.series.shadowSize=c.shadowSize),c.highlightColor!=null&&(c.series.highlightColor=c.highlightColor),be=0;be<c.xaxes.length;++be)A(m,be+1).options=c.xaxes[be];for(be=0;be<c.yaxes.length;++be)A(y,be+1).options=c.yaxes[be];for(var Ae in D)c.hooks[Ae]&&c.hooks[Ae].length&&(D[Ae]=D[Ae].concat(c.hooks[Ae]));x(D.processOptions,[c])}function M(ve){a=S(ve),L(),U()}function S(ve){for(var be=[],he=0;he<ve.length;++he){var ye=G.extend(!0,{},c.series);ve[he].data!=null?(ye.data=ve[he].data,delete ve[he].data,G.extend(!0,ye,ve[he]),ve[he].data=ye.data):ye.data=ve[he],be.push(ye)}return be}function I(ve,be){var he=ve[be+"axis"];return typeof he=="object"&&(he=he.n),typeof he!="number"&&(he=1),he}function T(){return G.grep(m.concat(y),function(ve){return ve})}function b(ve){var be={},he,ye;for(he=0;he<m.length;++he)ye=m[he],ye&&(be["x"+ye.n]=ye.c2p(ve.left));for(he=0;he<y.length;++he)ye=y[he],ye&&(be["y"+ye.n]=ye.c2p(ve.top));return be.x1!==void 0&&(be.x=be.x1),be.y1!==void 0&&(be.y=be.y1),be}function R(ve){var be={},he,ye,Pe;for(he=0;he<m.length;++he)if(ye=m[he],ye&&ye.used&&(Pe="x"+ye.n,ve[Pe]==null&&ye.n==1&&(Pe="x"),ve[Pe]!=null)){be.left=ye.p2c(ve[Pe]);break}for(he=0;he<y.length;++he)if(ye=y[he],ye&&ye.used&&(Pe="y"+ye.n,ve[Pe]==null&&ye.n==1&&(Pe="y"),ve[Pe]!=null)){be.top=ye.p2c(ve[Pe]);break}return be}function A(ve,be){return ve[be-1]||(ve[be-1]={n:be,direction:ve==m?"x":"y",options:G.extend(!0,{},ve==m?c.xaxis:c.yaxis)}),ve[be-1]}function L(){var ve=a.length,be=-1,he;for(he=0;he<a.length;++he){var ye=a[he].color;ye!=null&&(ve--,typeof ye=="number"&&ye>be&&(be=ye))}ve<=be&&(ve=be+1);var Pe,ge=[],xe=c.colors,Ae=xe.length,Ee=0;for(he=0;he<ve;he++)Pe=G.color.parse(xe[he%Ae]||"#666"),he%Ae==0&&he&&(Ee>=0?Ee<.5?Ee=-Ee-.2:Ee=0:Ee=-Ee),ge[he]=Pe.scale("rgb",1+Ee);var Ie=0,Qe;for(he=0;he<a.length;++he){if(Qe=a[he],Qe.color==null?(Qe.color=ge[Ie].toString(),++Ie):typeof Qe.color=="number"&&(Qe.color=ge[Qe.color].toString()),Qe.lines.show==null){var at,ft=!0;for(at in Qe)if(Qe[at]&&Qe[at].show){ft=!1;break}ft&&(Qe.lines.show=!0)}Qe.lines.zero==null&&(Qe.lines.zero=!!Qe.lines.fill),Qe.xaxis=A(m,I(Qe,"x")),Qe.yaxis=A(y,I(Qe,"y"))}}function U(){var ve=Number.POSITIVE_INFINITY,be=Number.NEGATIVE_INFINITY,he=Number.MAX_VALUE,ye,Pe,ge,xe,Ae,Ee,Ie,Qe,at,ft,ct,vt,Pt,Vt,Jt,wt;function zt(an,un,hn){un<an.datamin&&un!=-he&&(an.datamin=un),hn>an.datamax&&hn!=he&&(an.datamax=hn)}for(G.each(T(),function(an,un){un.datamin=ve,un.datamax=be,un.used=!1}),ye=0;ye<a.length;++ye)Ee=a[ye],Ee.datapoints={points:[]},x(D.processRawData,[Ee,Ee.data,Ee.datapoints]);for(ye=0;ye<a.length;++ye){if(Ee=a[ye],Jt=Ee.data,wt=Ee.datapoints.format,!wt){if(wt=[],wt.push({x:!0,number:!0,required:!0}),wt.push({y:!0,number:!0,required:!0}),Ee.stack||Ee.bars.show||Ee.lines.show&&Ee.lines.fill){var on=!!(Ee.bars.show&&Ee.bars.zero||Ee.lines.show&&Ee.lines.zero);wt.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:on}),Ee.bars.horizontal&&(delete wt[wt.length-1].y,wt[wt.length-1].x=!0)}Ee.datapoints.format=wt}if(Ee.datapoints.pointsize==null){Ee.datapoints.pointsize=wt.length,Qe=Ee.datapoints.pointsize,Ie=Ee.datapoints.points;var Pn=Ee.lines.show&&Ee.lines.steps;for(Ee.xaxis.used=Ee.yaxis.used=!0,Pe=ge=0;Pe<Jt.length;++Pe,ge+=Qe){Vt=Jt[Pe];var _n=Vt==null;if(!_n)for(xe=0;xe<Qe;++xe)vt=Vt[xe],Pt=wt[xe],Pt&&(Pt.number&&vt!=null&&(vt=+vt,isNaN(vt)?vt=null:vt==1/0?vt=he:vt==-1/0&&(vt=-he)),vt==null&&(Pt.required&&(_n=!0),Pt.defaultValue!=null&&(vt=Pt.defaultValue))),Ie[ge+xe]=vt;if(_n)for(xe=0;xe<Qe;++xe)vt=Ie[ge+xe],vt!=null&&(Pt=wt[xe],Pt.autoscale!==!1&&(Pt.x&&zt(Ee.xaxis,vt,vt),Pt.y&&zt(Ee.yaxis,vt,vt))),Ie[ge+xe]=null;if(Pn&&ge>0&&(!_n||Ie[ge-Qe]!=null)){for(xe=0;xe<Qe;++xe)Ie[ge+Qe+xe]=Ie[ge+xe];Ie[ge+1]=Ie[ge-Qe+1]||0,_n&&(Ie[ge]=Vt[0]),ge+=Qe}}}}for(ye=0;ye<a.length;++ye){if(Ee=a[ye],Ie=Ee.datapoints.points,Qe=Ee.datapoints.pointsize,Ee.transform==="negative-Y")for(Pe=0;Pe<Ie.length;Pe+=Qe)Ie[Pe]!=null&&(vt=Ie[Pe+1],Ie[Pe+1]=-vt);x(D.processDatapoints,[Ee,Ee.datapoints])}for(ye=0;ye<a.length;++ye){Ee=a[ye],Ie=Ee.datapoints.points,Qe=Ee.datapoints.pointsize,wt=Ee.datapoints.format;var Cn=ve,Ye=ve,Dt=be,yt=be;for(Pe=0;Pe<Ie.length;Pe+=Qe)if(Ie[Pe]!=null)for(xe=0;xe<Qe;++xe)vt=Ie[Pe+xe],Pt=wt[xe],!(!Pt||Pt.autoscale===!1||vt==he||vt==-he)&&(Pt.x&&(vt<Cn&&(Cn=vt),vt>Dt&&(Dt=vt)),Pt.y&&(vt<Ye&&(Ye=vt),vt>yt&&(yt=vt)));if(Ee.bars.show){var Ft;switch(Ee.bars.align){case"left":Ft=0;break;case"right":Ft=-Ee.bars.barWidth;break;default:Ft=-Ee.bars.barWidth/2}Ee.bars.horizontal?(Ye+=Ft,yt+=Ft+Ee.bars.barWidth):(Cn+=Ft,Dt+=Ft+Ee.bars.barWidth)}zt(Ee.xaxis,Cn,Dt),zt(Ee.yaxis,Ye,yt)}G.each(T(),function(an,un){un.datamin==ve&&(un.datamin=null),un.datamax==be&&(un.datamax=null)})}function W(){i.find(".flot-temp-elem").remove(),i.css("position")=="static"&&i.css("position","relative"),o=new e("flot-base",i),h=new e("flot-overlay",i),l=o.context,p=h.context,g=G(h.element).unbind();var ve=i.data("plot");ve&&(ve.shutdown(),h.clear()),i.data("plot",P)}function w(){c.grid.hoverable&&(g.mousemove(He),g.bind("mouseleave",Be),G(document).bind("touchend",Re)),c.grid.clickable&&g.click(Ne),x(D.bindEvents,[g])}function N(){Te&&clearTimeout(Te),g.unbind("mousemove",He),g.unbind("mouseleave",Be),g.unbind("click",Ne),G(document).unbind("touchend",Re),x(D.shutdown,[g])}function B(ve){function be(xe){return xe}var he,ye,Pe=ve.options.transform||be,ge=ve.options.inverseTransform;ve.direction=="x"?(he=ve.scale=v/Math.abs(Pe(ve.max)-Pe(ve.min)),ye=Math.min(Pe(ve.max),Pe(ve.min))):(he=ve.scale=u/Math.abs(Pe(ve.max)-Pe(ve.min)),he=-he,ye=Math.max(Pe(ve.max),Pe(ve.min))),Pe==be?ve.p2c=function(xe){return(xe-ye)*he}:ve.p2c=function(xe){return(Pe(xe)-ye)*he},ge?ve.c2p=function(xe){return ge(ye+xe/he)}:ve.c2p=function(xe){return ye+xe/he}}function V(ve){for(var be=ve.options,he=ve.ticks||[],ye=be.labelWidth||0,Pe=be.labelHeight||0,ge=ye||(ve.direction=="x"?Math.floor(o.width/(he.length||1)):null),xe=ve.direction+"Axis "+ve.direction+ve.n+"Axis",Ae="flot-"+ve.direction+"-axis flot-"+ve.direction+ve.n+"-axis "+xe,Ee=be.font||"flot-tick-label tickLabel",Ie=0;Ie<he.length;++Ie){var Qe=he[Ie];if(Qe.label){var at=o.getTextInfo(Ae,Qe.label,Ee,null,ge);ye=Math.max(ye,at.width+1),Pe=Math.max(Pe,at.height)}}ve.labelWidth=be.labelWidth||ye,ve.labelHeight=be.labelHeight||Pe}function K(ve){var be=ve.labelWidth,he=ve.labelHeight,ye=ve.options.position,Pe=ve.direction==="x",ge=ve.options.tickLength,xe=c.grid.axisMargin,Ae=c.grid.labelMargin,Ee=c.grid.eventSectionHeight,Ie=!0,Qe=!0,at=!0,ft=!1;G.each(Pe?m:y,function(ct,vt){vt&&(vt.show||vt.reserveSpace)&&(vt===ve?ft=!0:vt.options.position===ye&&(ft?Qe=!1:Ie=!1),ft||(at=!1))}),Qe&&(xe=0),ge==null&&(ge=at?"full":5),isNaN(+ge)||(Ae+=+ge),Pe?(he+=Ae,he+=Ee,ye=="bottom"?(d.bottom+=he+xe,ve.box={top:o.height-d.bottom,height:he}):(ve.box={top:d.top+xe,height:he},d.top+=he+xe)):(be+=Ae,ye=="left"?(ve.box={left:d.left+xe,width:be},d.left+=be+xe):(d.right+=be+xe,ve.box={left:o.width-d.right,width:be})),ve.position=ye,ve.tickLength=ge,ve.box.padding=Ae,ve.box.eventSectionPadding=Ee,ve.innermost=Ie}function H(ve){ve.direction=="x"?(ve.box.left=d.left-ve.labelWidth/2,ve.box.width=o.width-d.left-d.right+ve.labelWidth):(ve.box.top=d.top-ve.labelHeight/2,ve.box.height=o.height-d.bottom-d.top+ve.labelHeight)}function X(){var ve=c.grid.minBorderMargin,be,he;if(ve==null)for(ve=0,he=0;he<a.length;++he)ve=Math.max(ve,2*(a[he].points.radius+a[he].points.lineWidth/2));var ye={left:ve,right:ve,top:ve,bottom:ve};G.each(T(),function(Pe,ge){ge.reserveSpace&&ge.ticks&&ge.ticks.length&&(ge.direction==="x"?(ye.left=Math.max(ye.left,ge.labelWidth/2),ye.right=Math.max(ye.right,ge.labelWidth/2)):(ye.bottom=Math.max(ye.bottom,ge.labelHeight/2),ye.top=Math.max(ye.top,ge.labelHeight/2)))}),d.left=Math.ceil(Math.max(ye.left,d.left)),d.right=Math.ceil(Math.max(ye.right,d.right)),d.top=Math.ceil(Math.max(ye.top,d.top)),d.bottom=Math.ceil(Math.max(ye.bottom,d.bottom))}function k(){var ve,be=T(),he=c.grid.show;for(var ye in d){var Pe=c.grid.margin||0;d[ye]=typeof Pe=="number"?Pe:Pe[ye]||0}x(D.processOffset,[d]);for(var ye in d)typeof c.grid.borderWidth=="object"?d[ye]+=he?c.grid.borderWidth[ye]:0:d[ye]+=he?c.grid.borderWidth:0;if(G.each(be,function(Ae,Ee){var Ie=Ee.options;Ee.show=Ie.show==null?Ee.used:Ie.show,Ee.reserveSpace=Ie.reserveSpace==null?Ee.show:Ie.reserveSpace,Y(Ee)}),x(D.processRange,[]),he){for(var ge=G.grep(be,function(Ae){return Ae.show||Ae.reserveSpace}),xe=!1,ve=0;ve<2&&(G.each(ge,function(Ee,Ie){se(Ie),j(Ie),xe=q(Ie,Ie.ticks)||xe,V(Ie)}),xe&&D.processRange.length>0);ve++)x(D.processRange,[]),xe=!1;for(ve=ge.length-1;ve>=0;--ve)K(ge[ve]);X(),G.each(ge,function(Ae,Ee){H(Ee)})}v=o.width-d.left-d.right,u=o.height-d.bottom-d.top,G.each(be,function(Ae,Ee){B(Ee)}),he&&le(),De()}function Y(ve){var be=ve.options,he=+(be.min!=null?be.min:ve.datamin),ye=+(be.max!=null?be.max:ve.datamax),Pe=ye-he;if(Pe==0){var ge=.25,xe=Math.abs(ye==0?1:ye*ge);be.min==null&&(he-=xe),(be.max==null||be.min!=null)&&(ye+=xe)}else{var Ae=be.autoscaleMargin;Ae!=null&&(be.min==null&&(he-=Pe*Ae,he<0&&ve.datamin!=null&&ve.datamin>=0&&(he=0)),be.max==null&&(ye+=Pe*Ae,ye>0&&ve.datamax!=null&&ve.datamax<=0&&(ye=0)))}ve.min=he,ve.max=ye}function Z(ve){if(ve=Math.abs(String(ve).replace(".","")),ve==0)return 0;for(;ve!=0&&ve%10==0;)ve/=10;return Math.floor(Math.log(ve)/Math.LN10)+1}function se(ve){var be=ve.options,he;typeof be.ticks=="number"&&be.ticks>0?he=be.ticks:he=.3*Math.sqrt(ve.direction=="x"?o.width:o.height);var ye=(ve.max-ve.min)/he,Pe=-Math.floor(Math.log(ye)/Math.LN10),ge=be.tickDecimals;ge!=null&&Pe>ge&&(Pe=ge);var xe=Math.pow(10,-Pe),Ae=ye/xe,Ee;if(Ae<1.5?Ee=1:Ae<3?(Ee=2,Ae>2.25&&(ge==null||Pe+1<=ge)&&(Ee=2.5,++Pe)):Ae<7.5?Ee=5:Ee=10,Ee*=xe,be.minTickSize!=null&&Ee<be.minTickSize&&(Ee=be.minTickSize),ve.delta=ye,ve.tickDecimals=Math.max(0,ge??Pe),ve.tickSize=be.tickSize||Ee,be.mode=="time"&&!ve.tickGenerator)throw new Error("Time mode requires the flot.time plugin.");if(ve.tickGenerator||(ve.tickGenerator=function(ct){var vt=[],Pt=n(ct.min,ct.tickSize),Vt=0,Jt=Number.NaN,wt;do wt=Jt,Jt=Pt+Vt*ct.tickSize,vt.push(Jt),++Vt;while(Jt<ct.max&&Jt!=wt);return vt},ve.tickFormatter=function(ct,vt){var Pt=vt.tickDecimals?Math.pow(10,vt.tickDecimals):1,Vt=""+Math.round(ct*Pt)/Pt;if(vt.tickDecimals!=null){var Jt=Vt.indexOf("."),wt=Jt==-1?0:Vt.length-Jt-1;if(wt<vt.tickDecimals)return(wt?Vt:Vt+".")+(""+Pt).substr(1,vt.tickDecimals-wt)}return Vt}),G.isFunction(be.tickFormatter)&&(ve.tickFormatter=function(ct,vt){return""+be.tickFormatter(ct,vt)}),be.alignTicksWithAxis!=null){var Ie=(ve.direction=="x"?m:y)[be.alignTicksWithAxis-1];if(Ie&&Ie.used&&Ie!=ve){var Qe=ve.tickGenerator(ve);if(Qe.length>0&&(be.min==null&&(ve.min=Math.min(ve.min,Qe[0])),be.max==null&&Qe.length>1&&(ve.max=Math.max(ve.max,Qe[Qe.length-1]))),ve.tickGenerator=function(ct){var vt=[],Pt,Vt;for(Vt=0;Vt<Ie.ticks.length;++Vt)Pt=(Ie.ticks[Vt].v-Ie.min)/(Ie.max-Ie.min),Pt=ct.min+Pt*(ct.max-ct.min),vt.push(Pt);return vt},!ve.mode&&be.tickDecimals==null){var at=Math.max(0,-Math.floor(Math.log(ve.delta)/Math.LN10)+1),ft=ve.tickGenerator(ve);ft.length>1&&/\..*0$/.test((ft[1]-ft[0]).toFixed(at))||(ve.tickDecimals=at)}}}}function j(ve){var be=ve.options.ticks,he=[];be==null||typeof be=="number"&&be>0?he=ve.tickGenerator(ve):be&&(G.isFunction(be)?he=be(ve):he=be);var ye,Pe;for(ve.ticks=[],ye=0;ye<he.length;++ye){var ge=null,xe=he[ye];typeof xe=="object"?(Pe=+xe[0],xe.length>1&&(ge=xe[1])):Pe=+xe,ge==null&&(ge=ve.tickFormatter(Pe,ve)),isNaN(Pe)||ve.ticks.push({v:Pe,label:ge})}}function q(ve,be){var he=!1;return ve.options.autoscaleMargin&&be.length>0&&(ve.options.min==null&&(ve.min=Math.min(ve.min,be[0].v),he=!0),ve.options.max==null&&be.length>1&&(ve.max=Math.max(ve.max,be[be.length-1].v),he=!0)),he}function ne(){o.clear(),x(D.drawBackground,[l]);var ve=c.grid;ve.show&&ve.backgroundColor&&z(),ve.show&&!ve.aboveData&&te();for(var be=0;be<a.length;++be)x(D.drawSeries,[l,a[be]]),ae(a[be]);x(D.draw,[l]),ve.show&&ve.aboveData&&te(),o.render(),Ke()}function oe(ve,be){for(var he,ye,Pe,ge,xe=T(),Ae=0;Ae<xe.length;++Ae)if(he=xe[Ae],he.direction==be&&(ge=be+he.n+"axis",!ve[ge]&&he.n==1&&(ge=be+"axis"),ve[ge])){ye=ve[ge].from,Pe=ve[ge].to;break}if(ve[ge]||(he=be=="x"?m[0]:y[0],ye=ve[be+"1"],Pe=ve[be+"2"]),ye!=null&&Pe!=null&&ye>Pe){var Ee=ye;ye=Pe,Pe=Ee}return{from:ye,to:Pe,axis:he}}function z(){l.save(),l.translate(d.left,d.top),l.fillStyle=$e(c.grid.backgroundColor,u,0,"rgba(255, 255, 255, 0)"),l.fillRect(0,0,v,u),l.restore()}function te(){var ve,be,he,ye;l.save(),l.translate(d.left,d.top);var Pe=c.grid.markings;if(Pe)for(G.isFunction(Pe)&&(be=P.getAxes(),be.xmin=be.xaxis.min,be.xmax=be.xaxis.max,be.ymin=be.yaxis.min,be.ymax=be.yaxis.max,Pe=Pe(be)),ve=0;ve<Pe.length;++ve){var ge=Pe[ve],xe=oe(ge,"x"),Ae=oe(ge,"y");if(xe.from==null&&(xe.from=xe.axis.min),xe.to==null&&(xe.to=xe.axis.max),Ae.from==null&&(Ae.from=Ae.axis.min),Ae.to==null&&(Ae.to=Ae.axis.max),!(xe.to<xe.axis.min||xe.from>xe.axis.max||Ae.to<Ae.axis.min||Ae.from>Ae.axis.max)){xe.from=Math.max(xe.from,xe.axis.min),xe.to=Math.min(xe.to,xe.axis.max),Ae.from=Math.max(Ae.from,Ae.axis.min),Ae.to=Math.min(Ae.to,Ae.axis.max);var Ee=xe.from===xe.to,Ie=Ae.from===Ae.to;if(!(Ee&&Ie))if(xe.from=Math.floor(xe.axis.p2c(xe.from)),xe.to=Math.floor(xe.axis.p2c(xe.to)),Ae.from=Math.floor(Ae.axis.p2c(Ae.from)),Ae.to=Math.floor(Ae.axis.p2c(Ae.to)),Ee||Ie){var Qe=ge.lineWidth||c.grid.markingsLineWidth,at=Qe%2?.5:0;l.beginPath(),l.strokeStyle=ge.color||c.grid.markingsColor,l.lineWidth=Qe,Ee?(l.moveTo(xe.to+at,Ae.from),l.lineTo(xe.to+at,Ae.to)):(l.moveTo(xe.from,Ae.to+at),l.lineTo(xe.to,Ae.to+at)),l.stroke()}else l.fillStyle=ge.color||c.grid.markingsColor,l.fillRect(xe.from,Ae.to,xe.to-xe.from,Ae.from-Ae.to)}}be=T(),he=c.grid.borderWidth;for(var ft=0;ft<be.length;++ft){var ct=be[ft],vt=ct.box,Pt=ct.tickLength,Vt,Jt,wt,zt;if(!(!ct.show||ct.ticks.length==0)){for(l.lineWidth=1,ct.direction=="x"?(Vt=0,Pt=="full"?Jt=ct.position=="top"?0:u:Jt=vt.top-d.top+(ct.position=="top"?vt.height:0)):(Jt=0,Pt=="full"?Vt=ct.position=="left"?0:v:Vt=vt.left-d.left+(ct.position=="left"?vt.width:0)),ct.innermost||(l.strokeStyle=ct.options.color,l.beginPath(),wt=zt=0,ct.direction=="x"?wt=v+1:zt=u+1,l.lineWidth==1&&(ct.direction=="x"?Jt=Math.floor(Jt)+.5:Vt=Math.floor(Vt)+.5),l.moveTo(Vt,Jt),l.lineTo(Vt+wt,Jt+zt),l.stroke()),l.strokeStyle=ct.options.tickColor,l.beginPath(),ve=0;ve<ct.ticks.length;++ve){var on=ct.ticks[ve].v;wt=zt=0,!(isNaN(on)||on<ct.min||on>ct.max||Pt=="full"&&(typeof he=="object"&&he[ct.position]>0||he>0)&&(on==ct.min||on==ct.max))&&(ct.direction=="x"?(Vt=ct.p2c(on),zt=Pt=="full"?-u:Pt,ct.position=="top"&&(zt=-zt)):(Jt=ct.p2c(on),wt=Pt=="full"?-v:Pt,ct.position=="left"&&(wt=-wt)),l.lineWidth==1&&(ct.direction=="x"?Vt=Math.floor(Vt)+.5:Jt=Math.floor(Jt)+.5),l.moveTo(Vt,Jt),l.lineTo(Vt+wt,Jt+zt))}l.stroke()}}he&&(ye=c.grid.borderColor,typeof he=="object"||typeof ye=="object"?(typeof he!="object"&&(he={top:he,right:he,bottom:he,left:he}),typeof ye!="object"&&(ye={top:ye,right:ye,bottom:ye,left:ye}),he.top>0&&(l.strokeStyle=ye.top,l.lineWidth=he.top,l.beginPath(),l.moveTo(0-he.left,0-he.top/2),l.lineTo(v,0-he.top/2),l.stroke()),he.right>0&&(l.strokeStyle=ye.right,l.lineWidth=he.right,l.beginPath(),l.moveTo(v+he.right/2,0-he.top),l.lineTo(v+he.right/2,u),l.stroke()),he.bottom>0&&(l.strokeStyle=ye.bottom,l.lineWidth=he.bottom,l.beginPath(),l.moveTo(v+he.right,u+he.bottom/2),l.lineTo(0,u+he.bottom/2),l.stroke()),he.left>0&&(l.strokeStyle=ye.left,l.lineWidth=he.left,l.beginPath(),l.moveTo(0-he.left/2,u+he.bottom),l.lineTo(0-he.left/2,0),l.stroke())):(l.lineWidth=he,l.strokeStyle=c.grid.borderColor,l.strokeRect(-he/2,-he/2,v+he,u+he))),l.restore()}function le(){G.each(T(),function(ve,be){var he=be.box,ye=be.direction+"Axis "+be.direction+be.n+"Axis",Pe="flot-"+be.direction+"-axis flot-"+be.direction+be.n+"-axis "+ye,ge=be.options.font||"flot-tick-label tickLabel",xe,Ae,Ee,Ie,Qe;if(o.removeText(Pe),!(!be.show||be.ticks.length==0))for(var at=0;at<be.ticks.length;++at)xe=be.ticks[at],!(!xe.label||xe.v<be.min||xe.v>be.max)&&(be.direction=="x"?(Ie="center",Ae=d.left+be.p2c(xe.v),be.position=="bottom"?Ee=he.top+he.padding+he.eventSectionPadding:(Ee=he.top+he.height-he.padding,Qe="bottom")):(Qe="middle",Ee=d.top+be.p2c(xe.v),be.position=="left"?(Ae=he.left+he.width-he.padding,Ie="right"):Ae=he.left+he.padding),o.addText(Pe,Ae,Ee,xe.label,ge,null,null,Ie,Qe))})}function ie(ve){for(var be=[],he=null,ye=null,Pe=ve.datapoints,ge=[],xe=0;xe<Pe.pointsize-2;xe++)ge.push(0);for(var Ae=0;Ae<Pe.points.length;Ae+=Pe.pointsize){var Ee=Pe.points[Ae],Ie=Pe.points[Ae+1];Ae===Pe.points.length-Pe.pointsize?ye=null:ye=Pe.points[Ae+Pe.pointsize],Ee!==null&&Ie!==null&&he===null&&ye===null&&(be.push(Ee),be.push(Ie),be.push.apply(be,ge)),he=Ee}var Qe=Pe.points;Pe.points=be,ve.points.radius=ve.lines.lineWidth/2,ce(ve),Pe.points=Qe}function ae(ve){ve.lines.show&&(re(ve),!ve.points.show&&!ve.bars.show&&ie(ve)),ve.bars.show&&ee(ve),ve.points.show&&ce(ve)}function re(ve){function be(Ae,Ee,Ie,Qe,at){var ft=Ae.points,ct=Ae.pointsize,vt=null,Pt=null;l.beginPath();for(var Vt=ct;Vt<ft.length;Vt+=ct){var Jt=ft[Vt-ct],wt=ft[Vt-ct+1],zt=ft[Vt],on=ft[Vt+1];if(!(Jt==null||zt==null)){if(wt<=on&&wt<at.min){if(on<at.min)continue;Jt=(at.min-wt)/(on-wt)*(zt-Jt)+Jt,wt=at.min}else if(on<=wt&&on<at.min){if(wt<at.min)continue;zt=(at.min-wt)/(on-wt)*(zt-Jt)+Jt,on=at.min}if(wt>=on&&wt>at.max){if(on>at.max)continue;Jt=(at.max-wt)/(on-wt)*(zt-Jt)+Jt,wt=at.max}else if(on>=wt&&on>at.max){if(wt>at.max)continue;zt=(at.max-wt)/(on-wt)*(zt-Jt)+Jt,on=at.max}if(Jt<=zt&&Jt<Qe.min){if(zt<Qe.min)continue;wt=(Qe.min-Jt)/(zt-Jt)*(on-wt)+wt,Jt=Qe.min}else if(zt<=Jt&&zt<Qe.min){if(Jt<Qe.min)continue;on=(Qe.min-Jt)/(zt-Jt)*(on-wt)+wt,zt=Qe.min}if(Jt>=zt&&Jt>Qe.max){if(zt>Qe.max)continue;wt=(Qe.max-Jt)/(zt-Jt)*(on-wt)+wt,Jt=Qe.max}else if(zt>=Jt&&zt>Qe.max){if(Jt>Qe.max)continue;on=(Qe.max-Jt)/(zt-Jt)*(on-wt)+wt,zt=Qe.max}(Jt!=vt||wt!=Pt)&&l.moveTo(Qe.p2c(Jt)+Ee,at.p2c(wt)+Ie),vt=zt,Pt=on,l.lineTo(Qe.p2c(zt)+Ee,at.p2c(on)+Ie)}}l.stroke()}function he(Ae,Ee,Ie){for(var Qe=Ae.points,at=Ae.pointsize,ft=Math.min(Math.max(0,Ie.min),Ie.max),ct=0,vt,Pt=!1,Vt=1,Jt=0,wt=0;!(at>0&&ct>Qe.length+at);){ct+=at;var zt=Qe[ct-at],on=Qe[ct-at+Vt],Pn=Qe[ct],_n=Qe[ct+Vt];if(Pt){if(at>0&&zt!=null&&Pn==null){wt=ct,at=-at,Vt=2;continue}if(at<0&&ct==Jt+at){l.fill(),Pt=!1,at=-at,Vt=1,ct=Jt=wt+at;continue}}if(!(zt==null||Pn==null)){if(zt<=Pn&&zt<Ee.min){if(Pn<Ee.min)continue;on=(Ee.min-zt)/(Pn-zt)*(_n-on)+on,zt=Ee.min}else if(Pn<=zt&&Pn<Ee.min){if(zt<Ee.min)continue;_n=(Ee.min-zt)/(Pn-zt)*(_n-on)+on,Pn=Ee.min}if(zt>=Pn&&zt>Ee.max){if(Pn>Ee.max)continue;on=(Ee.max-zt)/(Pn-zt)*(_n-on)+on,zt=Ee.max}else if(Pn>=zt&&Pn>Ee.max){if(zt>Ee.max)continue;_n=(Ee.max-zt)/(Pn-zt)*(_n-on)+on,Pn=Ee.max}if(Pt||(l.beginPath(),l.moveTo(Ee.p2c(zt),Ie.p2c(ft)),Pt=!0),on>=Ie.max&&_n>=Ie.max){l.lineTo(Ee.p2c(zt),Ie.p2c(Ie.max)),l.lineTo(Ee.p2c(Pn),Ie.p2c(Ie.max));continue}else if(on<=Ie.min&&_n<=Ie.min){l.lineTo(Ee.p2c(zt),Ie.p2c(Ie.min)),l.lineTo(Ee.p2c(Pn),Ie.p2c(Ie.min));continue}var Cn=zt,Ye=Pn;on<=_n&&on<Ie.min&&_n>=Ie.min?(zt=(Ie.min-on)/(_n-on)*(Pn-zt)+zt,on=Ie.min):_n<=on&&_n<Ie.min&&on>=Ie.min&&(Pn=(Ie.min-on)/(_n-on)*(Pn-zt)+zt,_n=Ie.min),on>=_n&&on>Ie.max&&_n<=Ie.max?(zt=(Ie.max-on)/(_n-on)*(Pn-zt)+zt,on=Ie.max):_n>=on&&_n>Ie.max&&on<=Ie.max&&(Pn=(Ie.max-on)/(_n-on)*(Pn-zt)+zt,_n=Ie.max),zt!=Cn&&l.lineTo(Ee.p2c(Cn),Ie.p2c(on)),l.lineTo(Ee.p2c(zt),Ie.p2c(on)),l.lineTo(Ee.p2c(Pn),Ie.p2c(_n)),Pn!=Ye&&(l.lineTo(Ee.p2c(Pn),Ie.p2c(_n)),l.lineTo(Ee.p2c(Ye),Ie.p2c(_n)))}}}l.save(),l.translate(d.left,d.top),l.lineJoin="round";var ye=ve.lines.lineWidth,Pe=ve.shadowSize;if(ye>0&&Pe>0){l.lineWidth=Pe,l.strokeStyle="rgba(0,0,0,0.1)";var ge=Math.PI/18;be(ve.datapoints,Math.sin(ge)*(ye/2+Pe/2),Math.cos(ge)*(ye/2+Pe/2),ve.xaxis,ve.yaxis),l.lineWidth=Pe/2,be(ve.datapoints,Math.sin(ge)*(ye/2+Pe/4),Math.cos(ge)*(ye/2+Pe/4),ve.xaxis,ve.yaxis)}l.lineWidth=ye,l.strokeStyle=ve.color;var xe=de(ve.lines,ve.color,0,u);xe&&(l.fillStyle=xe,he(ve.datapoints,ve.xaxis,ve.yaxis)),ye>0&&be(ve.datapoints,0,0,ve.xaxis,ve.yaxis),l.restore()}function ce(ve){function be(Ae,Ee,Ie,Qe,at,ft,ct,vt){for(var Pt=Ae.points,Vt=Ae.pointsize,Jt=0;Jt<Pt.length;Jt+=Vt){var wt=Pt[Jt],zt=Pt[Jt+1];wt==null||wt<ft.min||wt>ft.max||zt<ct.min||zt>ct.max||(l.beginPath(),wt=ft.p2c(wt),zt=ct.p2c(zt)+Qe,vt=="circle"?l.arc(wt,zt,Ee,0,at?Math.PI:Math.PI*2,!1):vt(l,wt,zt,Ee,at),l.closePath(),Ie&&(l.fillStyle=Ie,l.fill()),l.stroke())}}l.save(),l.translate(d.left,d.top);var he=ve.points.lineWidth,ye=ve.shadowSize,Pe=ve.points.radius,ge=ve.points.symbol;if(he==0&&(he=1e-4),he>0&&ye>0){var xe=ye/2;l.lineWidth=xe,l.strokeStyle="rgba(0,0,0,0.1)",be(ve.datapoints,Pe,null,xe+xe/2,!0,ve.xaxis,ve.yaxis,ge),l.strokeStyle="rgba(0,0,0,0.2)",be(ve.datapoints,Pe,null,xe/2,!0,ve.xaxis,ve.yaxis,ge)}l.lineWidth=he,l.strokeStyle=ve.color,be(ve.datapoints,Pe,de(ve.points,ve.color),0,!1,ve.xaxis,ve.yaxis,ge),l.restore()}function me(ve,be,he,ye,Pe,ge,xe,Ae,Ee,Ie,Qe){var at,ft,ct,vt,Pt,Vt,Jt,wt,zt;Ie?(wt=Vt=Jt=!0,Pt=!1,at=he,ft=ve,vt=be+ye,ct=be+Pe,ft<at&&(zt=ft,ft=at,at=zt,Pt=!0,Vt=!1)):(Pt=Vt=Jt=!0,wt=!1,at=ve+ye,ft=ve+Pe,ct=he,vt=be,vt<ct&&(zt=vt,vt=ct,ct=zt,wt=!0,Jt=!1)),!(ft<xe.min||at>xe.max||vt<Ae.min||ct>Ae.max)&&(at<xe.min&&(at=xe.min,Pt=!1),ft>xe.max&&(ft=xe.max,Vt=!1),ct<Ae.min&&(ct=Ae.min,wt=!1),vt>Ae.max&&(vt=Ae.max,Jt=!1),at=xe.p2c(at),ct=Ae.p2c(ct),ft=xe.p2c(ft),vt=Ae.p2c(vt),ge&&(Ee.fillStyle=ge(ct,vt),Ee.fillRect(at,vt,ft-at,ct-vt)),Qe>0&&(Pt||Vt||Jt||wt)&&(Ee.beginPath(),Ee.moveTo(at,ct),Pt?Ee.lineTo(at,vt):Ee.moveTo(at,vt),Jt?Ee.lineTo(ft,vt):Ee.moveTo(ft,vt),Vt?Ee.lineTo(ft,ct):Ee.moveTo(ft,ct),wt?Ee.lineTo(at,ct):Ee.moveTo(at,ct),Ee.stroke()))}function ee(ve){function be(Pe,ge,xe,Ae,Ee,Ie){for(var Qe=Pe.points,at=Pe.pointsize,ft=0;ft<Qe.length;ft+=at)Qe[ft]!=null&&me(Qe[ft],Qe[ft+1],Qe[ft+2],ge,xe,Ae,Ee,Ie,l,ve.bars.horizontal,ve.bars.lineWidth)}l.save(),l.translate(d.left,d.top),l.lineWidth=ve.bars.lineWidth,l.strokeStyle=ve.color;var he;switch(ve.bars.align){case"left":he=0;break;case"right":he=-ve.bars.barWidth;break;default:he=-ve.bars.barWidth/2}var ye=ve.bars.fill?function(Pe,ge){return de(ve.bars,ve.color,Pe,ge)}:null;be(ve.datapoints,he,he+ve.bars.barWidth,ye,ve.xaxis,ve.yaxis),l.restore()}function de(ve,be,he,ye){var Pe=ve.fill;if(!Pe)return null;if(ve.fillColor)return $e(ve.fillColor,he,ye,be);var ge=G.color.parse(be);return ge.a=typeof Pe=="number"?Pe:.4,ge.normalize(),ge.toString()}function De(){if(c.legend.container!=null?G.find(c.legend.container).html(""):i.find(".legend").remove(),!!c.legend.show){for(var ve=[],be=[],he=!1,ye=c.legend.labelFormatter,Pe,ge,xe=0;xe<a.length;++xe)Pe=a[xe],Pe.label&&(ge=ye?ye(Pe.label,Pe):Pe.label,ge&&be.push({label:ge,color:Pe.color}));if(c.legend.sorted)if(G.isFunction(c.legend.sorted))be.sort(c.legend.sorted);else if(c.legend.sorted=="reverse")be.reverse();else{var Ae=c.legend.sorted!="descending";be.sort(function(Vt,Jt){return Vt.label==Jt.label?0:Vt.label<Jt.label!=Ae?1:-1})}for(var xe=0;xe<be.length;++xe){var Ee=be[xe];xe%c.legend.noColumns==0&&(he&&ve.push("</tr>"),ve.push("<tr>"),he=!0),ve.push('<td class="legendColorBox"><div style="border:1px solid '+c.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+Ee.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+Ee.label+"</td>")}if(he&&ve.push("</tr>"),ve.length!=0){var Ie='<table style="font-size:smaller;color:'+c.grid.color+'">'+ve.join("")+"</table>";if(c.legend.container!=null)G(c.legend.container).html(Ie);else{var Qe="",at=c.legend.position,ft=c.legend.margin;ft[0]==null&&(ft=[ft,ft]),at.charAt(0)=="n"?Qe+="top:"+(ft[1]+d.top)+"px;":at.charAt(0)=="s"&&(Qe+="bottom:"+(ft[1]+d.bottom)+"px;"),at.charAt(1)=="e"?Qe+="right:"+(ft[0]+d.right)+"px;":at.charAt(1)=="w"&&(Qe+="left:"+(ft[0]+d.left)+"px;");var ct=G('<div class="legend">'+Ie.replace('style="','style="position:absolute;'+Qe+";")+"</div>").appendTo(i);if(c.legend.backgroundOpacity!=0){var vt=c.legend.backgroundColor;vt==null&&(vt=c.grid.backgroundColor,vt&&typeof vt=="string"?vt=G.color.parse(vt):vt=G.color.extract(ct,"background-color"),vt.a=1,vt=vt.toString());var Pt=ct.children();G('<div style="position:absolute;width:'+Pt.width()+"px;height:"+Pt.height()+"px;"+Qe+"background-color:"+vt+';"> </div>').prependTo(ct).css("opacity",c.legend.backgroundOpacity)}}}}}var fe=[],Te=null;function je(ve,be,he){var ye=c.grid.mouseActiveRadius,Pe=ye*ye+1,ge=null,xe=!1,Ae,Ee,Ie;for(Ae=a.length-1;Ae>=0;--Ae)if(he(a[Ae])){var Qe=a[Ae],at=Qe.xaxis,ft=Qe.yaxis,ct=Qe.datapoints.points,vt=at.c2p(ve),Pt=ft.c2p(be),Vt=ye/at.scale,Jt=ye/ft.scale;if(Ie=Qe.datapoints.pointsize,at.options.inverseTransform&&(Vt=Number.MAX_VALUE),ft.options.inverseTransform&&(Jt=Number.MAX_VALUE),Qe.lines.show||Qe.points.show)for(Ee=0;Ee<ct.length;Ee+=Ie){var wt=ct[Ee],zt=ct[Ee+1];if(wt!=null&&!(wt-vt>Vt||wt-vt<-Vt||zt-Pt>Jt||zt-Pt<-Jt)){var on=Math.abs(at.p2c(wt)-ve),Pn=Math.abs(ft.p2c(zt)-be),_n=on*on+Pn*Pn;_n<Pe&&(Pe=_n,ge=[Ae,Ee/Ie])}}if(Qe.bars.show&&!ge){var Cn,Ye;switch(Qe.bars.align){case"left":Cn=0;break;case"right":Cn=-Qe.bars.barWidth;break;default:Cn=-Qe.bars.barWidth/2}for(Ye=Cn+Qe.bars.barWidth,Ee=0;Ee<ct.length;Ee+=Ie){var wt=ct[Ee],zt=ct[Ee+1],Dt=ct[Ee+2];wt!=null&&(a[Ae].bars.horizontal?vt<=Math.max(Dt,wt)&&vt>=Math.min(Dt,wt)&&Pt>=zt+Cn&&Pt<=zt+Ye:vt>=wt+Cn&&vt<=wt+Ye&&Pt>=Math.min(Dt,zt)&&Pt<=Math.max(Dt,zt))&&(ge=[Ae,Ee/Ie])}}}return ge?(Ae=ge[0],Ee=ge[1],Ie=a[Ae].datapoints.pointsize,{datapoint:a[Ae].datapoints.points.slice(Ee*Ie,(Ee+1)*Ie),dataIndex:Ee,series:a[Ae],seriesIndex:Ae}):null}function He(ve){c.grid.hoverable&&We("plothover",ve,function(be){return be.hoverable!=!1})}function Be(ve){c.grid.hoverable&&We("plothover",ve,function(be){return!1})}function Ne(ve){P.isSelecting||We("plotclick",ve,function(be){return be.clickable!=!1})}function Re(ve){if(ve.cancelable){if(!g.is(ve.target)&&g.has(ve.target).length===0){We("plotleave",ve,function(be){});return}He(Se(ve)),ve.preventDefault()}}function Se(ve){if(!ve||!ve.originalEvent||ve.pageX&&ve.pageY)return ve;var be=ve.originalEvent;if(be.changedTouches.length===0)return ve;var he=be.changedTouches[0];return ve.pageX=he.pageX,ve.pageY=he.pageY,ve}function We(ve,be,he){var ye=g.offset(),Pe=be.pageX-ye.left-d.left,ge=be.pageY-ye.top-d.top,xe=b({left:Pe,top:ge});xe.pageX=be.pageX,xe.pageY=be.pageY,xe.ctrlKey=be.ctrlKey,xe.metaKey=be.metaKey;var Ae=je(Pe,ge,he);if(Ae&&(Ae.pageX=parseInt(Ae.series.xaxis.p2c(Ae.datapoint[0])+ye.left+d.left,10),Ae.pageY=parseInt(Ae.series.yaxis.p2c(Ae.datapoint[1])+ye.top+d.top,10)),c.grid.autoHighlight){for(var Ee=0;Ee<fe.length;++Ee){var Ie=fe[Ee];Ie.auto==ve&&!(Ae&&Ie.series==Ae.series&&Ie.point[0]==Ae.datapoint[0]&&Ie.point[1]==Ae.datapoint[1])&&st(Ie.series,Ie.point)}Ae&&Je(Ae.series,Ae.datapoint,ve)}i.trigger(ve,[xe,Ae])}function Ke(){var ve=c.interaction.redrawOverlayInterval;if(ve==-1){Xe();return}Te||(Te=setTimeout(Xe,ve))}function Xe(){Te=null,p.save(),h.clear(),p.translate(d.left,d.top);var ve,be;for(ve=0;ve<fe.length;++ve)be=fe[ve],be.series.bars.show?ot(be.series,be.point):xt(be.series,be.point);p.restore(),x(D.drawOverlay,[p])}function Je(ve,be,he){if(typeof ve=="number"&&(ve=a[ve]),typeof be=="number"){var ye=ve.datapoints.pointsize;be=ve.datapoints.points.slice(ye*be,ye*(be+1))}var Pe=pt(ve,be);Pe==-1?(fe.push({series:ve,point:be,auto:he}),Ke()):he||(fe[Pe].auto=!1)}function st(ve,be){if(ve==null&&be==null){fe=[],Ke();return}if(typeof ve=="number"&&(ve=a[ve]),typeof be=="number"){var he=ve.datapoints.pointsize;be=ve.datapoints.points.slice(he*be,he*(be+1))}var ye=pt(ve,be);ye!=-1&&(fe.splice(ye,1),Ke())}function pt(ve,be){for(var he=0;he<fe.length;++he){var ye=fe[he];if(ye.series==ve&&ye.point[0]==be[0]&&ye.point[1]==be[1])return he}return-1}function xt(ve,be){var he=be[0],ye=be[1],Pe=ve.xaxis,ge=ve.yaxis,xe=typeof ve.highlightColor=="string"?ve.highlightColor:G.color.parse(ve.color).scale("a",.5).toString();if(!(he<Pe.min||he>Pe.max||ye<ge.min||ye>ge.max)){var Ae=ve.points.radius+ve.points.lineWidth/2;p.lineWidth=Ae,p.strokeStyle=xe;var Ee=1.5*Ae;he=Pe.p2c(he),ye=ge.p2c(ye),p.beginPath(),ve.points.symbol=="circle"?p.arc(he,ye,Ee,0,2*Math.PI,!1):ve.points.symbol(p,he,ye,Ee,!1),p.closePath(),p.stroke()}}function ot(ve,be){var he=typeof ve.highlightColor=="string"?ve.highlightColor:G.color.parse(ve.color).scale("a",.5).toString(),ye=he,Pe;switch(ve.bars.align){case"left":Pe=0;break;case"right":Pe=-ve.bars.barWidth;break;default:Pe=-ve.bars.barWidth/2}p.lineWidth=ve.bars.lineWidth,p.strokeStyle=he,me(be[0],be[1],be[2]||0,Pe,Pe+ve.bars.barWidth,function(){return ye},ve.xaxis,ve.yaxis,p,ve.bars.horizontal,ve.bars.lineWidth)}function $e(ve,be,he,ye){if(typeof ve=="string")return ve;for(var Pe=l.createLinearGradient(0,he,0,be),ge=0,xe=ve.colors.length;ge<xe;++ge){var Ae=ve.colors[ge];if(typeof Ae!="string"){var Ee=G.color.parse(ye);Ae.brightness!=null&&(Ee=Ee.scale("rgb",Ae.brightness)),Ae.opacity!=null&&(Ee.a*=Ae.opacity),Ae=Ee.toString()}Pe.addColorStop(ge/(xe-1),Ae)}return Pe}}G.plot=function(i,s,r){var f=new t(G(i),s,r,G.plot.plugins);return f},G.plot.version="0.8.3",G.plot.plugins=[],G.fn.plot=function(i,s){return this.each(function(){G.plot(this,i,s)})};function n(i,s){return s*Math.floor(i/s)}}(jQuery)},80851:()=>{(function(G){function O(e){var t={first:{x:-1,y:-1},second:{x:-1,y:-1},show:!1,active:!1},n={},i=null;function s(d){t.active&&(g(d),e.getPlaceholder().trigger("plotselecting",[a()]))}function r(d){d.which==1&&(document.body.focus(),document.onselectstart!==void 0&&n.onselectstart==null&&(n.onselectstart=document.onselectstart,document.onselectstart=function(){return!1}),document.ondrag!==void 0&&n.ondrag==null&&(n.ondrag=document.ondrag,document.ondrag=function(){return!1}),h(t.first,d),t.active=!0,i=function(v){f(v)},G(document).one("mouseup",i))}function f(d){return i=null,document.onselectstart!==void 0&&(document.onselectstart=n.onselectstart),document.ondrag!==void 0&&(document.ondrag=n.ondrag),t.active=!1,g(d),y()?c(d):(e.getPlaceholder().trigger("plotunselected",[]),e.getPlaceholder().trigger("plotselecting",[null])),setTimeout(function(){e.isSelecting=!1},10),!1}function a(){if(!y()||!t.show)return null;var d={},v=t.first,u=t.second,D=e.getAxes(),P=!0;return G.each(D,function(x,E){E.used&&(anyUsed=!1)}),G.each(D,function(x,E){if(E.used||P){var C=E.c2p(v[E.direction]),M=E.c2p(u[E.direction]);d[x]={from:Math.min(C,M),to:Math.max(C,M)}}}),d}function c(d){var v=a();v.ctrlKey=d.ctrlKey,v.metaKey=d.metaKey,e.getPlaceholder().trigger("plotselected",[v]),v.xaxis&&v.yaxis&&e.getPlaceholder().trigger("selected",[{x1:v.xaxis.from,y1:v.yaxis.from,x2:v.xaxis.to,y2:v.yaxis.to}])}function o(d,v,u){return v<d?d:v>u?u:v}function h(d,v){var u=e.getOptions(),D=e.getPlaceholder().offset(),P=e.getPlotOffset();d.x=o(0,v.pageX-D.left-P.left,e.width()),d.y=o(0,v.pageY-D.top-P.top,e.height()),u.selection.mode=="y"&&(d.x=d==t.first?0:e.width()),u.selection.mode=="x"&&(d.y=d==t.first?0:e.height())}function g(d){d.pageX!=null&&(h(t.second,d),y()?(e.isSelecting=!0,t.show=!0,e.triggerRedrawOverlay()):l(!0))}function l(d){t.show&&(t.show=!1,e.triggerRedrawOverlay(),d||e.getPlaceholder().trigger("plotunselected",[]))}function p(d,v){var u,D,P,x,E=e.getAxes();for(var C in E)if(u=E[C],u.direction==v&&(x=v+u.n+"axis",!d[x]&&u.n==1&&(x=v+"axis"),d[x])){D=d[x].from,P=d[x].to;break}if(d[x]||(u=v=="x"?e.getXAxes()[0]:e.getYAxes()[0],D=d[v+"1"],P=d[v+"2"]),D!=null&&P!=null&&D>P){var M=D;D=P,P=M}return{from:D,to:P,axis:u}}function m(d,v){var u,D,P=e.getOptions();P.selection.mode=="y"?(t.first.x=0,t.second.x=e.width()):(D=p(d,"x"),t.first.x=D.axis.p2c(D.from),t.second.x=D.axis.p2c(D.to)),P.selection.mode=="x"?(t.first.y=0,t.second.y=e.height()):(D=p(d,"y"),t.first.y=D.axis.p2c(D.from),t.second.y=D.axis.p2c(D.to)),t.show=!0,e.triggerRedrawOverlay(),!v&&y()&&c()}function y(){var d=e.getOptions().selection.minSize;return Math.abs(t.second.x-t.first.x)>=d&&Math.abs(t.second.y-t.first.y)>=d}e.clearSelection=l,e.setSelection=m,e.getSelection=a,e.hooks.bindEvents.push(function(d,v){var u=d.getOptions();u.selection.mode!=null&&(v.mousemove(s),v.mousedown(r))}),e.hooks.drawOverlay.push(function(d,v){if(t.show&&y()){var u=d.getPlotOffset(),D=d.getOptions();v.save(),v.translate(u.left,u.top);var P=G.color.parse(D.selection.color);v.strokeStyle=P.scale("a",.8).toString(),v.lineWidth=1,v.lineJoin=D.selection.shape,v.fillStyle=P.scale("a",.4).toString();var x=Math.min(t.first.x,t.second.x)+.5,E=Math.min(t.first.y,t.second.y)+.5,C=Math.abs(t.second.x-t.first.x)-1,M=Math.abs(t.second.y-t.first.y)-1;v.fillRect(x,E,C,M),v.strokeRect(x,E,C,M),v.restore()}}),e.hooks.shutdown.push(function(d,v){v.unbind("mousemove",s),v.unbind("mousedown",r),i&&(G(document).unbind("mouseup",i),document.onselectstart!==void 0&&(document.onselectstart=n.onselectstart),document.ondrag!==void 0&&(document.ondrag=n.ondrag))})}G.plot.plugins.push({init:O,options:{selection:{mode:null,color:"#e8cfac",shape:"round",minSize:5}},name:"selection",version:"1.1"})})(jQuery)},31221:()=>{(function(G){var O={series:{stack:null}};function e(t){function n(s,r){for(var f=null,a=0;a<r.length&&s!=r[a];++a)r[a].stack==s.stack&&(f=r[a]);return f}function i(s,r,f){if(!(r.stack==null||r.stack===!1)){var a=n(r,s.getData());if(a){for(var c=f.pointsize,o=f.points,h=a.datapoints.pointsize,g=a.datapoints.points,l=[],p,m,y,d,v,u,D=r.lines.show,P=r.bars.horizontal,x=c>2&&(P?f.format[2].x:f.format[2].y),E=D&&r.lines.steps,C=P?1:0,M=P?0:1,S=0,I=0,T,b;!(S>=o.length&&I>=g.length);){if(T=l.length,S<o.length&&o[S]==null){for(b=0;b<c;++b)l.push(o[S+b]);S+=c}else if(S>=o.length){for(b=0;b<c;++b)l.push(g[I+b]);x&&(l[T+2]=g[I+M]),I+=h}else if(I>=g.length){for(b=0;b<c;++b)l.push(o[S+b]);S+=c}else if(I<g.length&&g[I]==null)I+=h;else{if(p=o[S+C],m=o[S+M],d=g[I+C],v=g[I+M],u=0,p==d){for(b=0;b<c;++b)l.push(o[S+b]);l[T+M]+=v,u=v,S+=c,I+=h}else if(p>d){if(S==0){for(b=0;b<c;++b)l.push(g[I+b]);u=v}if(S>0&&o[S-c]!=null){for(y=0,l.push(d),l.push(y+v),b=2;b<c;++b)l.push(o[S+b]);u=v}I+=h}else{for(b=0;b<c;++b)l.push(o[S+b]);I>0&&g[I-h]!=null&&(u=0),l[T+M]+=u,S+=c}fromgap=!1,T!=l.length&&x&&(l[T+2]=u)}if(E&&T!=l.length&&T>0&&l[T]!=null&&l[T]!=l[T-c]&&l[T+1]!=l[T-c+1]){for(b=0;b<c;++b)l[T+c+b]=l[T+b];l[T+1]=l[T-c+1]}}f.points=l}}}t.hooks.processDatapoints.push(i)}G.plot.plugins.push({init:e,options:O,name:"stack",version:"1.2"})})(jQuery)},91520:()=>{(function(G){var O={series:{stackpercent:null}};function e(t){var n={},i=!1,s={};function r(c,o,h,g){if(i||(i=!0,s=f(c.getData())),o.stackpercent==!0){var l=h.length;o.percents=[];var p=0,m=1;o.bars&&o.bars.horizontal&&o.bars.horizontal===!0&&(p=1,m=0);for(var y=0;y<l;y++){var d=s[h[y][p]+""];d>0?o.percents.push(h[y][m]*100/d):o.percents.push(0)}}}function f(c){var o=c.length,h={};if(o>0){for(var g=0;g<o;g++)if(c[g].stackpercent){var l=0,p=1;c[g].bars&&c[g].bars.horizontal&&c[g].bars.horizontal===!0&&(l=1,p=0);for(var m=c[g].data.length,y=0;y<m;y++){var d=0;c[g].data[y][1]!=null&&(d=c[g].data[y][p]),h[c[g].data[y][l]+""]?h[c[g].data[y][l]+""]+=d:h[c[g].data[y][l]+""]=d}}}return h}function a(c,o,h){if(o.stackpercent){i||(s=f(c.getData()));var g=[],l=0,p=1;o.bars&&o.bars.horizontal&&o.bars.horizontal===!0&&(l=1,p=0);for(var m=0;m<h.points.length;m+=3)n[h.points[m+l]]||(n[h.points[m+l]]=0),g[m+l]=h.points[m+l],g[m+p]=h.points[m+p]+n[h.points[m+l]],g[m+2]=n[h.points[m+l]],n[h.points[m+l]]+=h.points[m+p],s[g[m+l]+""]>0?(g[m+p]=g[m+p]*100/s[g[m+l]+""],g[m+2]=g[m+2]*100/s[g[m+l]+""]):(g[m+p]=0,g[m+2]=0);h.points=g}}t.hooks.processRawData.push(r),t.hooks.processDatapoints.push(a)}G.plot.plugins.push({init:e,options:O,name:"stackpercent",version:"0.1"})})(jQuery)},32176:()=>{(function(G){var O={xaxis:{timezone:null,timeformat:null,twelveHourClock:!1,monthNames:null}};function e(o,h){return h*Math.floor(o/h)}function t(o,h,g,l){if(typeof o.strftime=="function")return o.strftime(h);var p=function(x,E){return x=""+x,E=""+(E??"0"),x.length==1?E+x:x},m=[],y=!1,d=o.getHours(),v=d<12;g==null&&(g=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]),l==null&&(l=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]);var u;d>12?u=d-12:d==0?u=12:u=d;for(var D=0;D<h.length;++D){var P=h.charAt(D);if(y){switch(P){case"a":P=""+l[o.getDay()];break;case"b":P=""+g[o.getMonth()];break;case"d":P=p(o.getDate(),"");break;case"e":P=p(o.getDate()," ");break;case"h":case"H":P=p(d);break;case"I":P=p(u);break;case"l":P=p(u," ");break;case"m":P=p(o.getMonth()+1,"");break;case"M":P=p(o.getMinutes());break;case"q":P=""+(Math.floor(o.getMonth()/3)+1);break;case"S":P=p(o.getSeconds());break;case"y":P=p(o.getFullYear()%100);break;case"Y":P=""+o.getFullYear();break;case"p":P=v?"am":"pm";break;case"P":P=v?"AM":"PM";break;case"w":P=""+o.getDay();break}m.push(P),y=!1}else P=="%"?y=!0:m.push(P)}return m.join("")}function n(o){function h(m,y,d,v){m[y]=function(){return d[v].apply(d,arguments)}}var g={date:o};o.strftime!=null&&h(g,"strftime",o,"strftime"),h(g,"getTime",o,"getTime"),h(g,"setTime",o,"setTime");for(var l=["Date","Day","FullYear","Hours","Milliseconds","Minutes","Month","Seconds"],p=0;p<l.length;p++)h(g,"get"+l[p],o,"getUTC"+l[p]),h(g,"set"+l[p],o,"setUTC"+l[p]);return g}function i(o,h){if(h.timezone=="browser")return new Date(o);if(!h.timezone||h.timezone=="utc")return n(new Date(o));if(typeof timezoneJS<"u"&&typeof timezoneJS.Date<"u"){var g=new timezoneJS.Date;return g.setTimezone(h.timezone),g.setTime(o),g}else return n(new Date(o))}var s={second:1e3,minute:60*1e3,hour:60*60*1e3,day:24*60*60*1e3,month:30*24*60*60*1e3,quarter:3*30*24*60*60*1e3,year:365.2425*24*60*60*1e3},r=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[.25,"month"],[.5,"month"],[1,"month"],[2,"month"]],f=r.concat([[3,"month"],[6,"month"],[1,"year"]]),a=r.concat([[1,"quarter"],[2,"quarter"],[1,"year"]]);function c(o){o.hooks.processOptions.push(function(h,g){G.each(h.getAxes(),function(l,p){var m=p.options;m.mode=="time"&&(p.tickGenerator=function(y){var d=[],v=i(y.min,m),u=0,D=m.tickSize&&m.tickSize[1]==="quarter"||m.minTickSize&&m.minTickSize[1]==="quarter"?a:f;m.minTickSize!=null&&(typeof m.tickSize=="number"?u=m.tickSize:u=m.minTickSize[0]*s[m.minTickSize[1]]);for(var P=0;P<D.length-1&&!(y.delta<(D[P][0]*s[D[P][1]]+D[P+1][0]*s[D[P+1][1]])/2&&D[P][0]*s[D[P][1]]>=u);++P);var x=D[P][0],E=D[P][1];if(E=="year"){if(m.minTickSize!=null&&m.minTickSize[1]=="year")x=Math.floor(m.minTickSize[0]);else{var C=Math.pow(10,Math.floor(Math.log(y.delta/s.year)/Math.LN10)),M=y.delta/s.year/C;M<1.5?x=1:M<3?x=2:M<7.5?x=5:x=10,x*=C}x<1&&(x=1)}y.tickSize=m.tickSize||[x,E];var S=y.tickSize[0];E=y.tickSize[1];var I=S*s[E];E=="second"?v.setSeconds(e(v.getSeconds(),S)):E=="minute"?v.setMinutes(e(v.getMinutes(),S)):E=="hour"?v.setHours(e(v.getHours(),S)):E=="month"?v.setMonth(e(v.getMonth(),S)):E=="quarter"?v.setMonth(3*e(v.getMonth()/3,S)):E=="year"&&v.setFullYear(e(v.getFullYear(),S)),v.setMilliseconds(0),I>=s.minute&&v.setSeconds(0),I>=s.hour&&v.setMinutes(0),I>=s.day&&v.setHours(0),I>=s.day*4&&v.setDate(1),I>=s.month*2&&v.setMonth(e(v.getMonth(),3)),I>=s.quarter*2&&v.setMonth(e(v.getMonth(),6)),I>=s.year&&v.setMonth(0);var T=0,b=Number.NaN,R;do if(R=b,b=v.getTime(),d.push(b),E=="month"||E=="quarter")if(S<1){v.setDate(1);var A=v.getTime();v.setMonth(v.getMonth()+(E=="quarter"?3:1));var L=v.getTime();v.setTime(b+T*s.hour+(L-A)*S),T=v.getHours(),v.setHours(0)}else v.setMonth(v.getMonth()+S*(E=="quarter"?3:1));else E=="year"?v.setFullYear(v.getFullYear()+S):v.setTime(b+I);while(b<y.max&&b!=R);return d},p.tickFormatter=function(y,d){var v=i(y,d.options);if(m.timeformat!=null)return t(v,m.timeformat,m.monthNames,m.dayNames);var u=d.options.tickSize&&d.options.tickSize[1]=="quarter"||d.options.minTickSize&&d.options.minTickSize[1]=="quarter",D=d.tickSize[0]*s[d.tickSize[1]],P=d.max-d.min,x=m.twelveHourClock?" %p":"",E=m.twelveHourClock?"%I":"%H",C;D<s.minute?C=E+":%M:%S"+x:D<s.day?P<2*s.day?C=E+":%M"+x:C="%b %d "+E+":%M"+x:D<s.month?C="%b %d":u&&D<s.quarter||!u&&D<s.year?P<s.year?C="%b":C="%b %Y":u&&D<s.year?P<s.year?C="Q%q":C="Q%q %Y":C="%Y";var M=t(v,C,m.monthNames,m.dayNames);return M})})})}G.plot.plugins.push({init:c,options:O,name:"time",version:"1.0"}),G.plot.formatDate=t})(jQuery)}}]);

//# sourceMappingURL=4721.2e9c36e7af25fe1c3824.js.map